var Qfe=Object.defineProperty;var jfe=(r,e,n)=>e in r?Qfe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n;var Nc=(r,e,n)=>(jfe(r,typeof e!="symbol"?e+"":e,n),n);function Yfe(r,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in r)){const o=Object.getOwnPropertyDescriptor(i,s);o&&Object.defineProperty(r,s,o.get?o:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();/**
* @vue/shared v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function PC(r,e){const n=new Set(r.split(","));return i=>n.has(i)}const wn={},tg=[],xo=()=>{},qfe=()=>!1,bb=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),ZR=r=>r.startsWith("onUpdate:"),zn=Object.assign,KR=(r,e)=>{const n=r.indexOf(e);n>-1&&r.splice(n,1)},Zfe=Object.prototype.hasOwnProperty,rn=(r,e)=>Zfe.call(r,e),Vt=Array.isArray,ig=r=>t0(r)==="[object Map]",bp=r=>t0(r)==="[object Set]",GB=r=>t0(r)==="[object Date]",Kfe=r=>t0(r)==="[object RegExp]",pi=r=>typeof r=="function",Yn=r=>typeof r=="string",yh=r=>typeof r=="symbol",Sn=r=>r!==null&&typeof r=="object",JR=r=>(Sn(r)||pi(r))&&pi(r.then)&&pi(r.catch),y7=Object.prototype.toString,t0=r=>y7.call(r),Jfe=r=>t0(r).slice(8,-1),b7=r=>t0(r)==="[object Object]",eI=r=>Yn(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,ng=PC(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),RC=r=>{const e=Object.create(null);return n=>e[n]||(e[n]=r(n))},epe=/-(\w)/g,Ks=RC(r=>r.replace(epe,(e,n)=>n?n.toUpperCase():"")),tpe=/\B([A-Z])/g,Yo=RC(r=>r.replace(tpe,"-$1").toLowerCase()),xb=RC(r=>r.charAt(0).toUpperCase()+r.slice(1)),Jy=RC(r=>r?`on${xb(r)}`:""),vl=(r,e)=>!Object.is(r,e),rg=(r,e)=>{for(let n=0;n<r.length;n++)r[n](e)},x7=(r,e,n,i=!1)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,writable:i,value:n})},aS=r=>{const e=parseFloat(r);return isNaN(e)?r:e},lS=r=>{const e=Yn(r)?Number(r):NaN;return isNaN(e)?r:e};let HB;const w7=()=>HB||(HB=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ipe="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error",npe=PC(ipe);function pd(r){if(Vt(r)){const e={};for(let n=0;n<r.length;n++){const i=r[n],s=Yn(i)?ape(i):pd(i);if(s)for(const o in s)e[o]=s[o]}return e}else if(Yn(r)||Sn(r))return r}const rpe=/;(?![^(]*\))/g,spe=/:([^]+)/,ope=/\/\*[^]*?\*\//g;function ape(r){const e={};return r.replace(ope,"").split(rpe).forEach(n=>{if(n){const i=n.split(spe);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function i0(r){let e="";if(Yn(r))e=r;else if(Vt(r))for(let n=0;n<r.length;n++){const i=i0(r[n]);i&&(e+=i+" ")}else if(Sn(r))for(const n in r)r[n]&&(e+=n+" ");return e.trim()}function lpe(r){if(!r)return null;let{class:e,style:n}=r;return e&&!Yn(e)&&(r.class=i0(e)),n&&(r.style=pd(n)),r}const cpe="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",hpe=PC(cpe);function _7(r){return!!r||r===""}function upe(r,e){if(r.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<r.length;i++)n=Ku(r[i],e[i]);return n}function Ku(r,e){if(r===e)return!0;let n=GB(r),i=GB(e);if(n||i)return n&&i?r.getTime()===e.getTime():!1;if(n=yh(r),i=yh(e),n||i)return r===e;if(n=Vt(r),i=Vt(e),n||i)return n&&i?upe(r,e):!1;if(n=Sn(r),i=Sn(e),n||i){if(!n||!i)return!1;const s=Object.keys(r).length,o=Object.keys(e).length;if(s!==o)return!1;for(const a in r){const l=r.hasOwnProperty(a),h=e.hasOwnProperty(a);if(l&&!h||!l&&h||!Ku(r[a],e[a]))return!1}}return String(r)===String(e)}function IC(r,e){return r.findIndex(n=>Ku(n,e))}const bh=r=>Yn(r)?r:r==null?"":Vt(r)||Sn(r)&&(r.toString===y7||!pi(r.toString))?JSON.stringify(r,O7,2):String(r),O7=(r,e)=>e&&e.__v_isRef?O7(r,e.value):ig(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,s],o)=>(n[ME(i,o)+" =>"]=s,n),{})}:bp(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>ME(n))}:yh(e)?ME(e):Sn(e)&&!Vt(e)&&!b7(e)?String(e):e,ME=(r,e="")=>{var n;return yh(r)?`Symbol(${(n=r.description)!=null?n:e})`:r};/**
* @vue/reactivity v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ho;class tI{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ho,!e&&Ho&&(this.index=(Ho.scopes||(Ho.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=Ho;try{return Ho=this,e()}finally{Ho=n}}}on(){Ho=this}off(){Ho=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function dpe(r){return new tI(r)}function S7(r,e=Ho){e&&e.active&&e.effects.push(r)}function NC(){return Ho}function iI(r){Ho&&Ho.cleanups.push(r)}let Rf;class Rg{constructor(e,n,i,s){this.fn=e,this.trigger=n,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,S7(this,s)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,md();for(let e=0;e<this._depsLength;e++){const n=this.deps[e];if(n.computed&&(fpe(n.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),gd()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=Hu,n=Rf;try{return Hu=!0,Rf=this,this._runnings++,QB(this),this.fn()}finally{jB(this),this._runnings--,Rf=n,Hu=e}}stop(){this.active&&(QB(this),jB(this),this.onStop&&this.onStop(),this.active=!1)}}function fpe(r){return r.value}function QB(r){r._trackId++,r._depsLength=0}function jB(r){if(r.deps.length>r._depsLength){for(let e=r._depsLength;e<r.deps.length;e++)C7(r.deps[e],r);r.deps.length=r._depsLength}}function C7(r,e){const n=r.get(e);n!==void 0&&e._trackId!==n&&(r.delete(e),r.size===0&&r.cleanup())}function ppe(r,e){r.effect instanceof Rg&&(r=r.effect.fn);const n=new Rg(r,xo,()=>{n.dirty&&n.run()});e&&(zn(n,e),e.scope&&S7(n,e.scope)),(!e||!e.lazy)&&n.run();const i=n.run.bind(n);return i.effect=n,i}function mpe(r){r.effect.stop()}let Hu=!0,Dk=0;const T7=[];function md(){T7.push(Hu),Hu=!1}function gd(){const r=T7.pop();Hu=r===void 0?!0:r}function nI(){Dk++}function rI(){for(Dk--;!Dk&&Lk.length;)Lk.shift()()}function E7(r,e,n){if(e.get(r)!==r._trackId){e.set(r,r._trackId);const i=r.deps[r._depsLength];i!==e?(i&&C7(i,r),r.deps[r._depsLength++]=e):r._depsLength++}}const Lk=[];function M7(r,e,n){nI();for(const i of r.keys()){let s;i._dirtyLevel<e&&(s??(s=r.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=e),i._shouldSchedule&&(s??(s=r.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&Lk.push(i.scheduler)))}rI()}const A7=(r,e)=>{const n=new Map;return n.cleanup=r,n.computed=e,n},cS=new WeakMap,If=Symbol(""),Bk=Symbol("");function Mo(r,e,n){if(Hu&&Rf){let i=cS.get(r);i||cS.set(r,i=new Map);let s=i.get(n);s||i.set(n,s=A7(()=>i.delete(n))),E7(Rf,s)}}function hh(r,e,n,i,s,o){const a=cS.get(r);if(!a)return;let l=[];if(e==="clear")l=[...a.values()];else if(n==="length"&&Vt(r)){const h=Number(i);a.forEach((u,f)=>{(f==="length"||!yh(f)&&f>=h)&&l.push(u)})}else switch(n!==void 0&&l.push(a.get(n)),e){case"add":Vt(r)?eI(n)&&l.push(a.get("length")):(l.push(a.get(If)),ig(r)&&l.push(a.get(Bk)));break;case"delete":Vt(r)||(l.push(a.get(If)),ig(r)&&l.push(a.get(Bk)));break;case"set":ig(r)&&l.push(a.get(If));break}nI();for(const h of l)h&&M7(h,4);rI()}function gpe(r,e){const n=cS.get(r);return n&&n.get(e)}const vpe=PC("__proto__,__v_isRef,__isVue"),k7=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(yh)),YB=ype();function ype(){const r={};return["includes","indexOf","lastIndexOf"].forEach(e=>{r[e]=function(...n){const i=nn(this);for(let o=0,a=this.length;o<a;o++)Mo(i,"get",o+"");const s=i[e](...n);return s===-1||s===!1?i[e](...n.map(nn)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{r[e]=function(...n){md(),nI();const i=nn(this)[e].apply(this,n);return rI(),gd(),i}}),r}function bpe(r){yh(r)||(r=String(r));const e=nn(this);return Mo(e,"has",r),e.hasOwnProperty(r)}class P7{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){const s=this._isReadonly,o=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return o;if(n==="__v_raw")return i===(s?o?B7:L7:o?D7:N7).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const a=Vt(e);if(!s){if(a&&rn(YB,n))return Reflect.get(YB,n,i);if(n==="hasOwnProperty")return bpe}const l=Reflect.get(e,n,i);return(yh(n)?k7.has(n):vpe(n))||(s||Mo(e,"get",n),o)?l:kr(l)?a&&eI(n)?l:l.value:Sn(l)?s?Yf(l):xp(l):l}}class R7 extends P7{constructor(e=!1){super(!1,e)}set(e,n,i,s){let o=e[n];if(!this._isShallow){const h=Ig(o);if(!w1(i)&&!Ig(i)&&(o=nn(o),i=nn(i)),!Vt(e)&&kr(o)&&!kr(i))return h?!1:(o.value=i,!0)}const a=Vt(e)&&eI(n)?Number(n)<e.length:rn(e,n),l=Reflect.set(e,n,i,s);return e===nn(s)&&(a?vl(i,o)&&hh(e,"set",n,i):hh(e,"add",n,i)),l}deleteProperty(e,n){const i=rn(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&i&&hh(e,"delete",n,void 0),s}has(e,n){const i=Reflect.has(e,n);return(!yh(n)||!k7.has(n))&&Mo(e,"has",n),i}ownKeys(e){return Mo(e,"iterate",Vt(e)?"length":If),Reflect.ownKeys(e)}}class I7 extends P7{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const xpe=new R7,wpe=new I7,_pe=new R7(!0),Ope=new I7(!0),sI=r=>r,DC=r=>Reflect.getPrototypeOf(r);function ow(r,e,n=!1,i=!1){r=r.__v_raw;const s=nn(r),o=nn(e);n||(vl(e,o)&&Mo(s,"get",e),Mo(s,"get",o));const{has:a}=DC(s),l=i?sI:n?aI:_1;if(a.call(s,e))return l(r.get(e));if(a.call(s,o))return l(r.get(o));r!==s&&r.get(e)}function aw(r,e=!1){const n=this.__v_raw,i=nn(n),s=nn(r);return e||(vl(r,s)&&Mo(i,"has",r),Mo(i,"has",s)),r===s?n.has(r):n.has(r)||n.has(s)}function lw(r,e=!1){return r=r.__v_raw,!e&&Mo(nn(r),"iterate",If),Reflect.get(r,"size",r)}function qB(r){r=nn(r);const e=nn(this);return DC(e).has.call(e,r)||(e.add(r),hh(e,"add",r,r)),this}function ZB(r,e){e=nn(e);const n=nn(this),{has:i,get:s}=DC(n);let o=i.call(n,r);o||(r=nn(r),o=i.call(n,r));const a=s.call(n,r);return n.set(r,e),o?vl(e,a)&&hh(n,"set",r,e):hh(n,"add",r,e),this}function KB(r){const e=nn(this),{has:n,get:i}=DC(e);let s=n.call(e,r);s||(r=nn(r),s=n.call(e,r)),i&&i.call(e,r);const o=e.delete(r);return s&&hh(e,"delete",r,void 0),o}function JB(){const r=nn(this),e=r.size!==0,n=r.clear();return e&&hh(r,"clear",void 0,void 0),n}function cw(r,e){return function(i,s){const o=this,a=o.__v_raw,l=nn(a),h=e?sI:r?aI:_1;return!r&&Mo(l,"iterate",If),a.forEach((u,f)=>i.call(s,h(u),h(f),o))}}function hw(r,e,n){return function(...i){const s=this.__v_raw,o=nn(s),a=ig(o),l=r==="entries"||r===Symbol.iterator&&a,h=r==="keys"&&a,u=s[r](...i),f=n?sI:e?aI:_1;return!e&&Mo(o,"iterate",h?Bk:If),{next(){const{value:p,done:m}=u.next();return m?{value:p,done:m}:{value:l?[f(p[0]),f(p[1])]:f(p),done:m}},[Symbol.iterator](){return this}}}}function eu(r){return function(...e){return r==="delete"?!1:r==="clear"?void 0:this}}function Spe(){const r={get(o){return ow(this,o)},get size(){return lw(this)},has:aw,add:qB,set:ZB,delete:KB,clear:JB,forEach:cw(!1,!1)},e={get(o){return ow(this,o,!1,!0)},get size(){return lw(this)},has:aw,add:qB,set:ZB,delete:KB,clear:JB,forEach:cw(!1,!0)},n={get(o){return ow(this,o,!0)},get size(){return lw(this,!0)},has(o){return aw.call(this,o,!0)},add:eu("add"),set:eu("set"),delete:eu("delete"),clear:eu("clear"),forEach:cw(!0,!1)},i={get(o){return ow(this,o,!0,!0)},get size(){return lw(this,!0)},has(o){return aw.call(this,o,!0)},add:eu("add"),set:eu("set"),delete:eu("delete"),clear:eu("clear"),forEach:cw(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{r[o]=hw(o,!1,!1),n[o]=hw(o,!0,!1),e[o]=hw(o,!1,!0),i[o]=hw(o,!0,!0)}),[r,n,e,i]}const[Cpe,Tpe,Epe,Mpe]=Spe();function LC(r,e){const n=e?r?Mpe:Epe:r?Tpe:Cpe;return(i,s,o)=>s==="__v_isReactive"?!r:s==="__v_isReadonly"?r:s==="__v_raw"?i:Reflect.get(rn(n,s)&&s in i?n:i,s,o)}const Ape={get:LC(!1,!1)},kpe={get:LC(!1,!0)},Ppe={get:LC(!0,!1)},Rpe={get:LC(!0,!0)},N7=new WeakMap,D7=new WeakMap,L7=new WeakMap,B7=new WeakMap;function Ipe(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Npe(r){return r.__v_skip||!Object.isExtensible(r)?0:Ipe(Jfe(r))}function xp(r){return Ig(r)?r:BC(r,!1,xpe,Ape,N7)}function $7(r){return BC(r,!1,_pe,kpe,D7)}function Yf(r){return BC(r,!0,wpe,Ppe,L7)}function Dpe(r){return BC(r,!0,Ope,Rpe,B7)}function BC(r,e,n,i,s){if(!Sn(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const o=s.get(r);if(o)return o;const a=Npe(r);if(a===0)return r;const l=new Proxy(r,a===2?i:n);return s.set(r,l),l}function sg(r){return Ig(r)?sg(r.__v_raw):!!(r&&r.__v_isReactive)}function Ig(r){return!!(r&&r.__v_isReadonly)}function w1(r){return!!(r&&r.__v_isShallow)}function oI(r){return r?!!r.__v_raw:!1}function nn(r){const e=r&&r.__v_raw;return e?nn(e):r}function U7(r){return Object.isExtensible(r)&&x7(r,"__v_skip",!0),r}const _1=r=>Sn(r)?xp(r):r,aI=r=>Sn(r)?Yf(r):r;class V7{constructor(e,n,i,s){this.getter=e,this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new Rg(()=>e(this._value),()=>og(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=i}get value(){const e=nn(this);return(!e._cacheable||e.effect.dirty)&&vl(e._value,e._value=e.effect.run())&&og(e,4),lI(e),e.effect._dirtyLevel>=2&&og(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function Lpe(r,e,n=!1){let i,s;const o=pi(r);return o?(i=r,s=xo):(i=r.get,s=r.set),new V7(i,s,o||!s,n)}function lI(r){var e;Hu&&Rf&&(r=nn(r),E7(Rf,(e=r.dep)!=null?e:r.dep=A7(()=>r.dep=void 0,r instanceof V7?r:void 0)))}function og(r,e=4,n){r=nn(r);const i=r.dep;i&&M7(i,e)}function kr(r){return!!(r&&r.__v_isRef===!0)}function ot(r){return F7(r,!1)}function Qn(r){return F7(r,!0)}function F7(r,e){return kr(r)?r:new Bpe(r,e)}class Bpe{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:nn(e),this._value=n?e:_1(e)}get value(){return lI(this),this._value}set value(e){const n=this.__v_isShallow||w1(e)||Ig(e);e=n?e:nn(e),vl(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:_1(e),og(this,4))}}function $pe(r){og(r,4)}function oi(r){return kr(r)?r.value:r}function Upe(r){return pi(r)?r():oi(r)}const Vpe={get:(r,e,n)=>oi(Reflect.get(r,e,n)),set:(r,e,n,i)=>{const s=r[e];return kr(s)&&!kr(n)?(s.value=n,!0):Reflect.set(r,e,n,i)}};function cI(r){return sg(r)?r:new Proxy(r,Vpe)}class Fpe{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:n,set:i}=e(()=>lI(this),()=>og(this));this._get=n,this._set=i}get value(){return this._get()}set value(e){this._set(e)}}function hI(r){return new Fpe(r)}function wb(r){const e=Vt(r)?new Array(r.length):{};for(const n in r)e[n]=z7(r,n);return e}class zpe{constructor(e,n,i){this._object=e,this._key=n,this._defaultValue=i,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return gpe(nn(this._object),this._key)}}class Xpe{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Wpe(r,e,n){return kr(r)?r:pi(r)?new Xpe(r):Sn(r)&&arguments.length>1?z7(r,e,n):ot(r)}function z7(r,e,n){const i=r[e];return kr(i)?i:new zpe(r,e,n)}const Gpe={GET:"get",HAS:"has",ITERATE:"iterate"},Hpe={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"};/**
* @vue/runtime-core v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Qpe(r,e){}const jpe={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",WATCH_GETTER:2,2:"WATCH_GETTER",WATCH_CALLBACK:3,3:"WATCH_CALLBACK",WATCH_CLEANUP:4,4:"WATCH_CLEANUP",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER"},Ype={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush. This is likely a Vue internals bug. Please open an issue at https://github.com/vuejs/core ."};function uh(r,e,n,i){try{return i?r(...i):r()}catch(s){wp(s,e,n)}}function na(r,e,n,i){if(pi(r)){const s=uh(r,e,n,i);return s&&JR(s)&&s.catch(o=>{wp(o,e,n)}),s}if(Vt(r)){const s=[];for(let o=0;o<r.length;o++)s.push(na(r[o],e,n,i));return s}}function wp(r,e,n,i=!0){const s=e?e.vnode:null;if(e){let o=e.parent;const a=e.proxy,l=`https://vuejs.org/error-reference/#runtime-${n}`;for(;o;){const u=o.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](r,a,l)===!1)return}o=o.parent}const h=e.appContext.config.errorHandler;if(h){md(),uh(h,null,10,[r,a,l]),gd();return}}qpe(r,n,s,i)}function qpe(r,e,n,i=!0){console.error(r)}let O1=!1,$k=!1;const As=[];let Kl=0;const ag=[];let Su=null,yf=0;const X7=Promise.resolve();let uI=null;function n0(r){const e=uI||X7;return r?e.then(this?r.bind(this):r):e}function Zpe(r){let e=Kl+1,n=As.length;for(;e<n;){const i=e+n>>>1,s=As[i],o=S1(s);o<r||o===r&&s.pre?e=i+1:n=i}return e}function $C(r){(!As.length||!As.includes(r,O1&&r.allowRecurse?Kl+1:Kl))&&(r.id==null?As.push(r):As.splice(Zpe(r.id),0,r),W7())}function W7(){!O1&&!$k&&($k=!0,uI=X7.then(G7))}function Kpe(r){const e=As.indexOf(r);e>Kl&&As.splice(e,1)}function hS(r){Vt(r)?ag.push(...r):(!Su||!Su.includes(r,r.allowRecurse?yf+1:yf))&&ag.push(r),W7()}function e6(r,e,n=O1?Kl+1:0){for(;n<As.length;n++){const i=As[n];if(i&&i.pre){if(r&&i.id!==r.uid)continue;As.splice(n,1),n--,i()}}}function uS(r){if(ag.length){const e=[...new Set(ag)].sort((n,i)=>S1(n)-S1(i));if(ag.length=0,Su){Su.push(...e);return}for(Su=e,yf=0;yf<Su.length;yf++)Su[yf]();Su=null,yf=0}}const S1=r=>r.id==null?1/0:r.id,Jpe=(r,e)=>{const n=S1(r)-S1(e);if(n===0){if(r.pre&&!e.pre)return-1;if(e.pre&&!r.pre)return 1}return n};function G7(r){$k=!1,O1=!0,As.sort(Jpe);try{for(Kl=0;Kl<As.length;Kl++){const e=As[Kl];e&&e.active!==!1&&uh(e,null,14)}}finally{Kl=0,As.length=0,uS(),O1=!1,uI=null,(As.length||ag.length)&&G7()}}let Dm,uw=[];function H7(r,e){var n,i;Dm=r,Dm?(Dm.enabled=!0,uw.forEach(({event:s,args:o})=>Dm.emit(s,...o)),uw=[]):typeof window<"u"&&window.HTMLElement&&!((i=(n=window.navigator)==null?void 0:n.userAgent)!=null&&i.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(o=>{H7(o,e)}),setTimeout(()=>{Dm||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,uw=[])},3e3)):uw=[]}function eme(r,e,...n){if(r.isUnmounted)return;const i=r.vnode.props||wn;let s=n;const o=e.startsWith("update:"),a=o&&e.slice(7);if(a&&a in i){const f=`${a==="modelValue"?"model":a}Modifiers`,{number:p,trim:m}=i[f]||wn;m&&(s=n.map(v=>Yn(v)?v.trim():v)),p&&(s=n.map(aS))}let l,h=i[l=Jy(e)]||i[l=Jy(Ks(e))];!h&&o&&(h=i[l=Jy(Yo(e))]),h&&na(h,r,6,s);const u=i[l+"Once"];if(u){if(!r.emitted)r.emitted={};else if(r.emitted[l])return;r.emitted[l]=!0,na(u,r,6,s)}}function Q7(r,e,n=!1){const i=e.emitsCache,s=i.get(r);if(s!==void 0)return s;const o=r.emits;let a={},l=!1;if(!pi(r)){const h=u=>{const f=Q7(u,e,!0);f&&(l=!0,zn(a,f))};!n&&e.mixins.length&&e.mixins.forEach(h),r.extends&&h(r.extends),r.mixins&&r.mixins.forEach(h)}return!o&&!l?(Sn(r)&&i.set(r,null),null):(Vt(o)?o.forEach(h=>a[h]=null):zn(a,o),Sn(r)&&i.set(r,a),a)}function UC(r,e){return!r||!bb(e)?!1:(e=e.slice(2).replace(/Once$/,""),rn(r,e[0].toLowerCase()+e.slice(1))||rn(r,Yo(e))||rn(r,e))}let Tr=null,VC=null;function C1(r){const e=Tr;return Tr=r,VC=r&&r.type.__scopeId||null,e}function _p(r){VC=r}function Op(){VC=null}const tme=r=>qe;function qe(r,e=Tr,n){if(!e||r._n)return r;const i=(...s)=>{i._d&&Qk(-1);const o=C1(e);let a;try{a=r(...s)}finally{C1(o),i._d&&Qk(1)}return a};return i._n=!0,i._c=!0,i._d=!0,i}function wO(r){const{type:e,vnode:n,proxy:i,withProxy:s,propsOptions:[o],slots:a,attrs:l,emit:h,render:u,renderCache:f,props:p,data:m,setupState:v,ctx:y,inheritAttrs:x}=r,w=C1(r);let S,O;try{if(n.shapeFlag&4){const T=s||i,A=T;S=jo(u.call(A,T,f,p,v,m,y)),O=l}else{const T=e;S=jo(T.length>1?T(p,{attrs:l,slots:a,emit:h}):T(p,null)),O=e.props?l:nme(l)}}catch(T){i1.length=0,wp(T,r,1),S=Pe(gs)}let _=S;if(O&&x!==!1){const T=Object.keys(O),{shapeFlag:A}=_;T.length&&A&7&&(o&&T.some(ZR)&&(O=rme(O,o)),_=uc(_,O,!1,!0))}return n.dirs&&(_=uc(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&(_.transition=n.transition),S=_,C1(w),S}function ime(r,e=!0){let n;for(let i=0;i<r.length;i++){const s=r[i];if(Ju(s)){if(s.type!==gs||s.children==="v-if"){if(n)return;n=s}}else return}return n}const nme=r=>{let e;for(const n in r)(n==="class"||n==="style"||bb(n))&&((e||(e={}))[n]=r[n]);return e},rme=(r,e)=>{const n={};for(const i in r)(!ZR(i)||!(i.slice(9)in e))&&(n[i]=r[i]);return n};function sme(r,e,n){const{props:i,children:s,component:o}=r,{props:a,children:l,patchFlag:h}=e,u=o.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&h>=0){if(h&1024)return!0;if(h&16)return i?t6(i,a,u):!!a;if(h&8){const f=e.dynamicProps;for(let p=0;p<f.length;p++){const m=f[p];if(a[m]!==i[m]&&!UC(u,m))return!0}}}else return(s||l)&&(!l||!l.$stable)?!0:i===a?!1:i?a?t6(i,a,u):!0:!!a;return!1}function t6(r,e,n){const i=Object.keys(e);if(i.length!==Object.keys(r).length)return!0;for(let s=0;s<i.length;s++){const o=i[s];if(e[o]!==r[o]&&!UC(n,o))return!0}return!1}function dI({vnode:r,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===r&&(i.el=r.el),i===r)(r=e.vnode).el=n,e=e.parent;else break}}const fI="components",ome="directives";function bt(r,e){return pI(fI,r,!0,e)||r}const j7=Symbol.for("v-ndc");function Uk(r){return Yn(r)?pI(fI,r,!1)||r:r||j7}function ame(r){return pI(ome,r)}function pI(r,e,n=!0,i=!1){const s=Tr||Ur;if(s){const o=s.type;if(r===fI){const l=Kk(o,!1);if(l&&(l===e||l===Ks(e)||l===xb(Ks(e))))return o}const a=i6(s[r]||o[r],e)||i6(s.appContext[r],e);return!a&&i?o:a}}function i6(r,e){return r&&(r[e]||r[Ks(e)]||r[xb(Ks(e))])}const Y7=r=>r.__isSuspense;let Vk=0;const lme={name:"Suspense",__isSuspense:!0,process(r,e,n,i,s,o,a,l,h,u){if(r==null)cme(e,n,i,s,o,a,l,h,u);else{if(o&&o.deps>0&&!r.suspense.isInFallback){e.suspense=r.suspense,e.suspense.vnode=e,e.el=r.el;return}hme(r,e,n,i,s,a,l,h,u)}},hydrate:ume,create:mI,normalize:dme},q7=lme;function T1(r,e){const n=r.props&&r.props[e];pi(n)&&n()}function cme(r,e,n,i,s,o,a,l,h){const{p:u,o:{createElement:f}}=h,p=f("div"),m=r.suspense=mI(r,s,i,e,p,n,o,a,l,h);u(null,m.pendingBranch=r.ssContent,p,null,i,m,o,a),m.deps>0?(T1(r,"onPending"),T1(r,"onFallback"),u(null,r.ssFallback,e,n,i,null,o,a),lg(m,r.ssFallback)):m.resolve(!1,!0)}function hme(r,e,n,i,s,o,a,l,{p:h,um:u,o:{createElement:f}}){const p=e.suspense=r.suspense;p.vnode=e,e.el=r.el;const m=e.ssContent,v=e.ssFallback,{activeBranch:y,pendingBranch:x,isInFallback:w,isHydrating:S}=p;if(x)p.pendingBranch=m,ll(m,x)?(h(x,m,p.hiddenContainer,null,s,p,o,a,l),p.deps<=0?p.resolve():w&&(S||(h(y,v,n,i,s,null,o,a,l),lg(p,v)))):(p.pendingId=Vk++,S?(p.isHydrating=!1,p.activeBranch=x):u(x,s,p),p.deps=0,p.effects.length=0,p.hiddenContainer=f("div"),w?(h(null,m,p.hiddenContainer,null,s,p,o,a,l),p.deps<=0?p.resolve():(h(y,v,n,i,s,null,o,a,l),lg(p,v))):y&&ll(m,y)?(h(y,m,n,i,s,p,o,a,l),p.resolve(!0)):(h(null,m,p.hiddenContainer,null,s,p,o,a,l),p.deps<=0&&p.resolve()));else if(y&&ll(m,y))h(y,m,n,i,s,p,o,a,l),lg(p,m);else if(T1(e,"onPending"),p.pendingBranch=m,m.shapeFlag&512?p.pendingId=m.component.suspenseId:p.pendingId=Vk++,h(null,m,p.hiddenContainer,null,s,p,o,a,l),p.deps<=0)p.resolve();else{const{timeout:O,pendingId:_}=p;O>0?setTimeout(()=>{p.pendingId===_&&p.fallback(v)},O):O===0&&p.fallback(v)}}function mI(r,e,n,i,s,o,a,l,h,u,f=!1){const{p,m,um:v,n:y,o:{parentNode:x,remove:w}}=u;let S;const O=fme(r);O&&e&&e.pendingBranch&&(S=e.pendingId,e.deps++);const _=r.props?lS(r.props.timeout):void 0,T=o,A={vnode:r,parent:e,parentComponent:n,namespace:a,container:i,hiddenContainer:s,deps:0,pendingId:Vk++,timeout:typeof _=="number"?_:-1,activeBranch:null,pendingBranch:null,isInFallback:!f,isHydrating:f,isUnmounted:!1,effects:[],resolve(P=!1,N=!1){const{vnode:k,activeBranch:R,pendingBranch:E,pendingId:D,effects:$,parentComponent:I,container:L}=A;let U=!1;A.isHydrating?A.isHydrating=!1:P||(U=R&&E.transition&&E.transition.mode==="out-in",U&&(R.transition.afterLeave=()=>{D===A.pendingId&&(m(E,L,o===T?y(R):o,0),hS($))}),R&&(x(R.el)!==A.hiddenContainer&&(o=y(R)),v(R,I,A,!0)),U||m(E,L,o,0)),lg(A,E),A.pendingBranch=null,A.isInFallback=!1;let V=A.parent,X=!1;for(;V;){if(V.pendingBranch){V.effects.push(...$),X=!0;break}V=V.parent}!X&&!U&&hS($),A.effects=[],O&&e&&e.pendingBranch&&S===e.pendingId&&(e.deps--,e.deps===0&&!N&&e.resolve()),T1(k,"onResolve")},fallback(P){if(!A.pendingBranch)return;const{vnode:N,activeBranch:k,parentComponent:R,container:E,namespace:D}=A;T1(N,"onFallback");const $=y(k),I=()=>{A.isInFallback&&(p(null,P,E,$,R,null,D,l,h),lg(A,P))},L=P.transition&&P.transition.mode==="out-in";L&&(k.transition.afterLeave=I),A.isInFallback=!0,v(k,R,null,!0),L||I()},move(P,N,k){A.activeBranch&&m(A.activeBranch,P,N,k),A.container=P},next(){return A.activeBranch&&y(A.activeBranch)},registerDep(P,N){const k=!!A.pendingBranch;k&&A.deps++;const R=P.vnode.el;P.asyncDep.catch(E=>{wp(E,P,0)}).then(E=>{if(P.isUnmounted||A.isUnmounted||A.pendingId!==P.suspenseId)return;P.asyncResolved=!0;const{vnode:D}=P;qk(P,E,!1),R&&(D.el=R);const $=!R&&P.subTree.el;N(P,D,x(R||P.subTree.el),R?null:y(P.subTree),A,a,h),$&&w($),dI(P,D.el),k&&--A.deps===0&&A.resolve()})},unmount(P,N){A.isUnmounted=!0,A.activeBranch&&v(A.activeBranch,n,P,N),A.pendingBranch&&v(A.pendingBranch,n,P,N)}};return A}function ume(r,e,n,i,s,o,a,l,h){const u=e.suspense=mI(e,i,n,r.parentNode,document.createElement("div"),null,s,o,a,l,!0),f=h(r,u.pendingBranch=e.ssContent,n,u,o,a);return u.deps===0&&u.resolve(!1,!0),f}function dme(r){const{shapeFlag:e,children:n}=r,i=e&32;r.ssContent=n6(i?n.default:n),r.ssFallback=i?n6(n.fallback):Pe(gs)}function n6(r){let e;if(pi(r)){const n=Kf&&r._c;n&&(r._d=!1,ri()),r=r(),n&&(r._d=!0,e=wo,IX())}return Vt(r)&&(r=ime(r)),r=jo(r),e&&!r.dynamicChildren&&(r.dynamicChildren=e.filter(n=>n!==r)),r}function Z7(r,e){e&&e.pendingBranch?Vt(r)?e.effects.push(...r):e.effects.push(r):hS(r)}function lg(r,e){r.activeBranch=e;const{vnode:n,parentComponent:i}=r;let s=e.el;for(;!s&&e.component;)e=e.component.subTree,s=e.el;n.el=s,i&&i.subTree===n&&(i.vnode.el=s,dI(i,s))}function fme(r){const e=r.props&&r.props.suspensible;return e!=null&&e!==!1}const K7=Symbol.for("v-scx"),J7=()=>hg(K7);function dh(r,e){return _b(r,null,e)}function eX(r,e){return _b(r,null,{flush:"post"})}function tX(r,e){return _b(r,null,{flush:"sync"})}const dw={};function Gi(r,e,n){return _b(r,e,n)}function _b(r,e,{immediate:n,deep:i,flush:s,once:o,onTrack:a,onTrigger:l}=wn){if(e&&o){const P=e;e=(...N)=>{P(...N),A()}}const h=Ur,u=P=>i===!0?P:Cf(P,i===!1?1:void 0);let f,p=!1,m=!1;if(kr(r)?(f=()=>r.value,p=w1(r)):sg(r)?(f=()=>u(r),p=!0):Vt(r)?(m=!0,p=r.some(P=>sg(P)||w1(P)),f=()=>r.map(P=>{if(kr(P))return P.value;if(sg(P))return u(P);if(pi(P))return uh(P,h,2)})):pi(r)?e?f=()=>uh(r,h,2):f=()=>(v&&v(),na(r,h,3,[y])):f=xo,e&&i){const P=f;f=()=>Cf(P())}let v,y=P=>{v=_.onStop=()=>{uh(P,h,4),v=_.onStop=void 0}},x;if(Cb)if(y=xo,e?n&&na(e,h,3,[f(),m?[]:void 0,y]):f(),s==="sync"){const P=J7();x=P.__watcherHandles||(P.__watcherHandles=[])}else return xo;let w=m?new Array(r.length).fill(dw):dw;const S=()=>{if(!(!_.active||!_.dirty))if(e){const P=_.run();(i||p||(m?P.some((N,k)=>vl(N,w[k])):vl(P,w)))&&(v&&v(),na(e,h,3,[P,w===dw?void 0:m&&w[0]===dw?[]:w,y]),w=P)}else _.run()};S.allowRecurse=!!e;let O;s==="sync"?O=S:s==="post"?O=()=>cs(S,h&&h.suspense):(S.pre=!0,h&&(S.id=h.uid),O=()=>$C(S));const _=new Rg(f,xo,O),T=NC(),A=()=>{_.stop(),T&&KR(T.effects,_)};return e?n?S():w=_.run():s==="post"?cs(_.run.bind(_),h&&h.suspense):_.run(),x&&x.push(A),A}function pme(r,e,n){const i=this.proxy,s=Yn(r)?r.includes(".")?iX(i,r):()=>i[r]:r.bind(i,i);let o;pi(e)?o=e:(o=e.handler,n=e);const a=Jf(this),l=_b(s,o.bind(i),n);return a(),l}function iX(r,e){const n=e.split(".");return()=>{let i=r;for(let s=0;s<n.length&&i;s++)i=i[n[s]];return i}}function Cf(r,e=1/0,n){if(e<=0||!Sn(r)||r.__v_skip||(n=n||new Set,n.has(r)))return r;if(n.add(r),e--,kr(r))Cf(r.value,e,n);else if(Vt(r))for(let i=0;i<r.length;i++)Cf(r[i],e,n);else if(bp(r)||ig(r))r.forEach(i=>{Cf(i,e,n)});else if(b7(r))for(const i in r)Cf(r[i],e,n);return r}function mme(r,e){if(Tr===null)return r;const n=GC(Tr)||Tr.proxy,i=r.dirs||(r.dirs=[]);for(let s=0;s<e.length;s++){let[o,a,l,h=wn]=e[s];o&&(pi(o)&&(o={mounted:o,updated:o}),o.deep&&Cf(a),i.push({dir:o,instance:n,value:a,oldValue:void 0,arg:l,modifiers:h}))}return r}function jl(r,e,n,i){const s=r.dirs,o=e&&e.dirs;for(let a=0;a<s.length;a++){const l=s[a];o&&(l.oldValue=o[a].value);let h=l.dir[i];h&&(md(),na(h,n,8,[r.el,l,r,e]),gd())}}const Cu=Symbol("_leaveCb"),fw=Symbol("_enterCb");function gI(){const r={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Xn(()=>{r.isMounted=!0}),Sb(()=>{r.isUnmounting=!0}),r}const ma=[Function,Array],vI={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ma,onEnter:ma,onAfterEnter:ma,onEnterCancelled:ma,onBeforeLeave:ma,onLeave:ma,onAfterLeave:ma,onLeaveCancelled:ma,onBeforeAppear:ma,onAppear:ma,onAfterAppear:ma,onAppearCancelled:ma},gme={name:"BaseTransition",props:vI,setup(r,{slots:e}){const n=oa(),i=gI();return()=>{const s=e.default&&FC(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const m of s)if(m.type!==gs){o=m;break}}const a=nn(r),{mode:l}=a;if(i.isLeaving)return AE(o);const h=r6(o);if(!h)return AE(o);const u=Ng(h,a,i,n);qf(h,u);const f=n.subTree,p=f&&r6(f);if(p&&p.type!==gs&&!ll(h,p)){const m=Ng(p,a,i,n);if(qf(p,m),l==="out-in"&&h.type!==gs)return i.isLeaving=!0,m.afterLeave=()=>{i.isLeaving=!1,n.update.active!==!1&&(n.effect.dirty=!0,n.update())},AE(o);l==="in-out"&&h.type!==gs&&(m.delayLeave=(v,y,x)=>{const w=rX(i,p);w[String(p.key)]=p,v[Cu]=()=>{y(),v[Cu]=void 0,delete u.delayedLeave},u.delayedLeave=x})}return o}}},nX=gme;function rX(r,e){const{leavingVNodes:n}=r;let i=n.get(e.type);return i||(i=Object.create(null),n.set(e.type,i)),i}function Ng(r,e,n,i){const{appear:s,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:h,onAfterEnter:u,onEnterCancelled:f,onBeforeLeave:p,onLeave:m,onAfterLeave:v,onLeaveCancelled:y,onBeforeAppear:x,onAppear:w,onAfterAppear:S,onAppearCancelled:O}=e,_=String(r.key),T=rX(n,r),A=(k,R)=>{k&&na(k,i,9,R)},P=(k,R)=>{const E=R[1];A(k,R),Vt(k)?k.every(D=>D.length<=1)&&E():k.length<=1&&E()},N={mode:o,persisted:a,beforeEnter(k){let R=l;if(!n.isMounted)if(s)R=x||l;else return;k[Cu]&&k[Cu](!0);const E=T[_];E&&ll(r,E)&&E.el[Cu]&&E.el[Cu](),A(R,[k])},enter(k){let R=h,E=u,D=f;if(!n.isMounted)if(s)R=w||h,E=S||u,D=O||f;else return;let $=!1;const I=k[fw]=L=>{$||($=!0,L?A(D,[k]):A(E,[k]),N.delayedLeave&&N.delayedLeave(),k[fw]=void 0)};R?P(R,[k,I]):I()},leave(k,R){const E=String(r.key);if(k[fw]&&k[fw](!0),n.isUnmounting)return R();A(p,[k]);let D=!1;const $=k[Cu]=I=>{D||(D=!0,R(),I?A(y,[k]):A(v,[k]),k[Cu]=void 0,T[E]===r&&delete T[E])};T[E]=r,m?P(m,[k,$]):$()},clone(k){return Ng(k,e,n,i)}};return N}function AE(r){if(Ob(r))return r=uc(r),r.children=null,r}function r6(r){if(!Ob(r))return r;const{shapeFlag:e,children:n}=r;if(n){if(e&16)return n[0];if(e&32&&pi(n.default))return n.default()}}function qf(r,e){r.shapeFlag&6&&r.component?qf(r.component.subTree,e):r.shapeFlag&128?(r.ssContent.transition=e.clone(r.ssContent),r.ssFallback.transition=e.clone(r.ssFallback)):r.transition=e}function FC(r,e=!1,n){let i=[],s=0;for(let o=0;o<r.length;o++){let a=r[o];const l=n==null?a.key:String(n)+String(a.key!=null?a.key:o);a.type===yn?(a.patchFlag&128&&s++,i=i.concat(FC(a.children,e,l))):(e||a.type!==gs)&&i.push(l!=null?uc(a,{key:l}):a)}if(s>1)for(let o=0;o<i.length;o++)i[o].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function xh(r,e){return pi(r)?zn({name:r.name},e,{setup:r}):r}const Nf=r=>!!r.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function vme(r){pi(r)&&(r={loader:r});const{loader:e,loadingComponent:n,errorComponent:i,delay:s=200,timeout:o,suspensible:a=!0,onError:l}=r;let h=null,u,f=0;const p=()=>(f++,h=null,m()),m=()=>{let v;return h||(v=h=e().catch(y=>{if(y=y instanceof Error?y:new Error(String(y)),l)return new Promise((x,w)=>{l(y,()=>x(p()),()=>w(y),f+1)});throw y}).then(y=>v!==h&&h?h:(y&&(y.__esModule||y[Symbol.toStringTag]==="Module")&&(y=y.default),u=y,y)))};return xh({name:"AsyncComponentWrapper",__asyncLoader:m,get __asyncResolved(){return u},setup(){const v=Ur;if(u)return()=>kE(u,v);const y=O=>{h=null,wp(O,v,13,!i)};if(a&&v.suspense||Cb)return m().then(O=>()=>kE(O,v)).catch(O=>(y(O),()=>i?Pe(i,{error:O}):null));const x=ot(!1),w=ot(),S=ot(!!s);return s&&setTimeout(()=>{S.value=!1},s),o!=null&&setTimeout(()=>{if(!x.value&&!w.value){const O=new Error(`Async component timed out after ${o}ms.`);y(O),w.value=O}},o),m().then(()=>{x.value=!0,v.parent&&Ob(v.parent.vnode)&&(v.parent.effect.dirty=!0,$C(v.parent.update))}).catch(O=>{y(O),w.value=O}),()=>{if(x.value&&u)return kE(u,v);if(w.value&&i)return Pe(i,{error:w.value});if(n&&!S.value)return Pe(n)}}})}function kE(r,e){const{ref:n,props:i,children:s,ce:o}=e.vnode,a=Pe(r,i,s);return a.ref=n,a.ce=o,delete e.vnode.ce,a}const Ob=r=>r.type.__isKeepAlive,yme={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(r,{slots:e}){const n=oa(),i=n.ctx;if(!i.renderer)return()=>{const O=e.default&&e.default();return O&&O.length===1?O[0]:O};const s=new Map,o=new Set;let a=null;const l=n.suspense,{renderer:{p:h,m:u,um:f,o:{createElement:p}}}=i,m=p("div");i.activate=(O,_,T,A,P)=>{const N=O.component;u(O,_,T,0,l),h(N.vnode,O,_,T,N,l,A,O.slotScopeIds,P),cs(()=>{N.isDeactivated=!1,N.a&&rg(N.a);const k=O.props&&O.props.onVnodeMounted;k&&go(k,N.parent,O)},l)},i.deactivate=O=>{const _=O.component;u(O,m,null,1,l),cs(()=>{_.da&&rg(_.da);const T=O.props&&O.props.onVnodeUnmounted;T&&go(T,_.parent,O),_.isDeactivated=!0},l)};function v(O){PE(O),f(O,n,l,!0)}function y(O){s.forEach((_,T)=>{const A=Kk(_.type);A&&(!O||!O(A))&&x(T)})}function x(O){const _=s.get(O);!a||!ll(_,a)?v(_):a&&PE(a),s.delete(O),o.delete(O)}Gi(()=>[r.include,r.exclude],([O,_])=>{O&&y(T=>Dy(O,T)),_&&y(T=>!Dy(_,T))},{flush:"post",deep:!0});let w=null;const S=()=>{w!=null&&s.set(w,RE(n.subTree))};return Xn(S),XC(S),Sb(()=>{s.forEach(O=>{const{subTree:_,suspense:T}=n,A=RE(_);if(O.type===A.type&&O.key===A.key){PE(A);const P=A.component.da;P&&cs(P,T);return}v(O)})}),()=>{if(w=null,!e.default)return null;const O=e.default(),_=O[0];if(O.length>1)return a=null,O;if(!Ju(_)||!(_.shapeFlag&4)&&!(_.shapeFlag&128))return a=null,_;let T=RE(_);const A=T.type,P=Kk(Nf(T)?T.type.__asyncResolved||{}:A),{include:N,exclude:k,max:R}=r;if(N&&(!P||!Dy(N,P))||k&&P&&Dy(k,P))return a=T,_;const E=T.key==null?A:T.key,D=s.get(E);return T.el&&(T=uc(T),_.shapeFlag&128&&(_.ssContent=T)),w=E,D?(T.el=D.el,T.component=D.component,T.transition&&qf(T,T.transition),T.shapeFlag|=512,o.delete(E),o.add(E)):(o.add(E),R&&o.size>parseInt(R,10)&&x(o.values().next().value)),T.shapeFlag|=256,a=T,Y7(_.type)?_:T}}},bme=yme;function Dy(r,e){return Vt(r)?r.some(n=>Dy(n,e)):Yn(r)?r.split(",").includes(e):Kfe(r)?r.test(e):!1}function sX(r,e){aX(r,"a",e)}function oX(r,e){aX(r,"da",e)}function aX(r,e,n=Ur){const i=r.__wdc||(r.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return r()});if(zC(e,i,n),n){let s=n.parent;for(;s&&s.parent;)Ob(s.parent.vnode)&&xme(i,e,n,s),s=s.parent}}function xme(r,e,n,i){const s=zC(e,r,i,!0);Po(()=>{KR(i[e],s)},n)}function PE(r){r.shapeFlag&=-257,r.shapeFlag&=-513}function RE(r){return r.shapeFlag&128?r.ssContent:r}function zC(r,e,n=Ur,i=!1){if(n){const s=n[r]||(n[r]=[]),o=e.__weh||(e.__weh=(...a)=>{if(n.isUnmounted)return;md();const l=Jf(n),h=na(e,n,r,a);return l(),gd(),h});return i?s.unshift(o):s.push(o),o}}const Ph=r=>(e,n=Ur)=>(!Cb||r==="sp")&&zC(r,(...i)=>e(...i),n),lX=Ph("bm"),Xn=Ph("m"),cX=Ph("bu"),XC=Ph("u"),Sb=Ph("bum"),Po=Ph("um"),hX=Ph("sp"),uX=Ph("rtg"),dX=Ph("rtc");function fX(r,e=Ur){zC("ec",r,e)}function hc(r,e,n,i){let s;const o=n&&n[i];if(Vt(r)||Yn(r)){s=new Array(r.length);for(let a=0,l=r.length;a<l;a++)s[a]=e(r[a],a,void 0,o&&o[a])}else if(typeof r=="number"){s=new Array(r);for(let a=0;a<r;a++)s[a]=e(a+1,a,void 0,o&&o[a])}else if(Sn(r))if(r[Symbol.iterator])s=Array.from(r,(a,l)=>e(a,l,void 0,o&&o[l]));else{const a=Object.keys(r);s=new Array(a.length);for(let l=0,h=a.length;l<h;l++){const u=a[l];s[l]=e(r[u],u,l,o&&o[l])}}else s=[];return n&&(n[i]=s),s}function wme(r,e){for(let n=0;n<e.length;n++){const i=e[n];if(Vt(i))for(let s=0;s<i.length;s++)r[i[s].name]=i[s].fn;else i&&(r[i.name]=i.key?(...s)=>{const o=i.fn(...s);return o&&(o.key=i.key),o}:i.fn)}return r}function pX(r,e,n={},i,s){if(Tr.isCE||Tr.parent&&Nf(Tr.parent)&&Tr.parent.isCE)return e!=="default"&&(n.name=e),Pe("slot",n,i&&i());let o=r[e];o&&o._c&&(o._d=!1),ri();const a=o&&mX(o(n)),l=Ar(yn,{key:n.key||a&&a.key||`_${e}`},a||(i?i():[]),a&&r._===1?64:-2);return!s&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),o&&o._c&&(o._d=!0),l}function mX(r){return r.some(e=>Ju(e)?!(e.type===gs||e.type===yn&&!mX(e.children)):!0)?r:null}function _me(r,e){const n={};for(const i in r)n[e&&/[A-Z]/.test(i)?`on:${i}`:Jy(i)]=r[i];return n}const Fk=r=>r?UX(r)?GC(r)||r.proxy:Fk(r.parent):null,e1=zn(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>Fk(r.parent),$root:r=>Fk(r.root),$emit:r=>r.emit,$options:r=>bI(r),$forceUpdate:r=>r.f||(r.f=()=>{r.effect.dirty=!0,$C(r.update)}),$nextTick:r=>r.n||(r.n=n0.bind(r.proxy)),$watch:r=>pme.bind(r)}),IE=(r,e)=>r!==wn&&!r.__isScriptSetup&&rn(r,e),zk={get({_:r},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:s,props:o,accessCache:a,type:l,appContext:h}=r;let u;if(e[0]!=="$"){const v=a[e];if(v!==void 0)switch(v){case 1:return i[e];case 2:return s[e];case 4:return n[e];case 3:return o[e]}else{if(IE(i,e))return a[e]=1,i[e];if(s!==wn&&rn(s,e))return a[e]=2,s[e];if((u=r.propsOptions[0])&&rn(u,e))return a[e]=3,o[e];if(n!==wn&&rn(n,e))return a[e]=4,n[e];Xk&&(a[e]=0)}}const f=e1[e];let p,m;if(f)return e==="$attrs"&&Mo(r.attrs,"get",""),f(r);if((p=l.__cssModules)&&(p=p[e]))return p;if(n!==wn&&rn(n,e))return a[e]=4,n[e];if(m=h.config.globalProperties,rn(m,e))return m[e]},set({_:r},e,n){const{data:i,setupState:s,ctx:o}=r;return IE(s,e)?(s[e]=n,!0):i!==wn&&rn(i,e)?(i[e]=n,!0):rn(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(o[e]=n,!0)},has({_:{data:r,setupState:e,accessCache:n,ctx:i,appContext:s,propsOptions:o}},a){let l;return!!n[a]||r!==wn&&rn(r,a)||IE(e,a)||(l=o[0])&&rn(l,a)||rn(i,a)||rn(e1,a)||rn(s.config.globalProperties,a)},defineProperty(r,e,n){return n.get!=null?r._.accessCache[e]=0:rn(n,"value")&&this.set(r,e,n.value,null),Reflect.defineProperty(r,e,n)}},Ome=zn({},zk,{get(r,e){if(e!==Symbol.unscopables)return zk.get(r,e,r)},has(r,e){return e[0]!=="_"&&!npe(e)}});function Sme(){return null}function Cme(){return null}function Tme(r){}function Eme(r){}function Mme(){return null}function Ame(){}function kme(r,e){return null}function yI(){return vX().slots}function gX(){return vX().attrs}function vX(){const r=oa();return r.setupContext||(r.setupContext=zX(r))}function E1(r){return Vt(r)?r.reduce((e,n)=>(e[n]=null,e),{}):r}function Pme(r,e){const n=E1(r);for(const i in e){if(i.startsWith("__skip"))continue;let s=n[i];s?Vt(s)||pi(s)?s=n[i]={type:s,default:e[i]}:s.default=e[i]:s===null&&(s=n[i]={default:e[i]}),s&&e[`__skip_${i}`]&&(s.skipFactory=!0)}return n}function Rme(r,e){return!r||!e?r||e:Vt(r)&&Vt(e)?r.concat(e):zn({},E1(r),E1(e))}function Ime(r,e){const n={};for(const i in r)e.includes(i)||Object.defineProperty(n,i,{enumerable:!0,get:()=>r[i]});return n}function _O(r){const e=oa();let n=r();return Yk(),JR(n)&&(n=n.catch(i=>{throw Jf(e),i})),[n,()=>Jf(e)]}let Xk=!0;function Nme(r){const e=bI(r),n=r.proxy,i=r.ctx;Xk=!1,e.beforeCreate&&s6(e.beforeCreate,r,"bc");const{data:s,computed:o,methods:a,watch:l,provide:h,inject:u,created:f,beforeMount:p,mounted:m,beforeUpdate:v,updated:y,activated:x,deactivated:w,beforeDestroy:S,beforeUnmount:O,destroyed:_,unmounted:T,render:A,renderTracked:P,renderTriggered:N,errorCaptured:k,serverPrefetch:R,expose:E,inheritAttrs:D,components:$,directives:I,filters:L}=e;if(u&&Dme(u,i,null),a)for(const X in a){const H=a[X];pi(H)&&(i[X]=H.bind(n))}if(s){const X=s.call(n,n);Sn(X)&&(r.data=xp(X))}if(Xk=!0,o)for(const X in o){const H=o[X],J=pi(H)?H.bind(n,n):pi(H.get)?H.get.bind(n,n):xo,ee=!pi(H)&&pi(H.set)?H.set.bind(n):xo,ne=Rn({get:J,set:ee});Object.defineProperty(i,X,{enumerable:!0,configurable:!0,get:()=>ne.value,set:ge=>ne.value=ge})}if(l)for(const X in l)yX(l[X],i,n,X);if(h){const X=pi(h)?h.call(n):h;Reflect.ownKeys(X).forEach(H=>{M1(H,X[H])})}f&&s6(f,r,"c");function V(X,H){Vt(H)?H.forEach(J=>X(J.bind(n))):H&&X(H.bind(n))}if(V(lX,p),V(Xn,m),V(cX,v),V(XC,y),V(sX,x),V(oX,w),V(fX,k),V(dX,P),V(uX,N),V(Sb,O),V(Po,T),V(hX,R),Vt(E))if(E.length){const X=r.exposed||(r.exposed={});E.forEach(H=>{Object.defineProperty(X,H,{get:()=>n[H],set:J=>n[H]=J})})}else r.exposed||(r.exposed={});A&&r.render===xo&&(r.render=A),D!=null&&(r.inheritAttrs=D),$&&(r.components=$),I&&(r.directives=I)}function Dme(r,e,n=xo){Vt(r)&&(r=Wk(r));for(const i in r){const s=r[i];let o;Sn(s)?"default"in s?o=hg(s.from||i,s.default,!0):o=hg(s.from||i):o=hg(s),kr(o)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[i]=o}}function s6(r,e,n){na(Vt(r)?r.map(i=>i.bind(e.proxy)):r.bind(e.proxy),e,n)}function yX(r,e,n,i){const s=i.includes(".")?iX(n,i):()=>n[i];if(Yn(r)){const o=e[r];pi(o)&&Gi(s,o)}else if(pi(r))Gi(s,r.bind(n));else if(Sn(r))if(Vt(r))r.forEach(o=>yX(o,e,n,i));else{const o=pi(r.handler)?r.handler.bind(n):e[r.handler];pi(o)&&Gi(s,o,r)}}function bI(r){const e=r.type,{mixins:n,extends:i}=e,{mixins:s,optionsCache:o,config:{optionMergeStrategies:a}}=r.appContext,l=o.get(e);let h;return l?h=l:!s.length&&!n&&!i?h=e:(h={},s.length&&s.forEach(u=>dS(h,u,a,!0)),dS(h,e,a)),Sn(e)&&o.set(e,h),h}function dS(r,e,n,i=!1){const{mixins:s,extends:o}=e;o&&dS(r,o,n,!0),s&&s.forEach(a=>dS(r,a,n,!0));for(const a in e)if(!(i&&a==="expose")){const l=Lme[a]||n&&n[a];r[a]=l?l(r[a],e[a]):e[a]}return r}const Lme={data:o6,props:a6,emits:a6,methods:Ly,computed:Ly,beforeCreate:Gs,created:Gs,beforeMount:Gs,mounted:Gs,beforeUpdate:Gs,updated:Gs,beforeDestroy:Gs,beforeUnmount:Gs,destroyed:Gs,unmounted:Gs,activated:Gs,deactivated:Gs,errorCaptured:Gs,serverPrefetch:Gs,components:Ly,directives:Ly,watch:$me,provide:o6,inject:Bme};function o6(r,e){return e?r?function(){return zn(pi(r)?r.call(this,this):r,pi(e)?e.call(this,this):e)}:e:r}function Bme(r,e){return Ly(Wk(r),Wk(e))}function Wk(r){if(Vt(r)){const e={};for(let n=0;n<r.length;n++)e[r[n]]=r[n];return e}return r}function Gs(r,e){return r?[...new Set([].concat(r,e))]:e}function Ly(r,e){return r?zn(Object.create(null),r,e):e}function a6(r,e){return r?Vt(r)&&Vt(e)?[...new Set([...r,...e])]:zn(Object.create(null),E1(r),E1(e??{})):e}function $me(r,e){if(!r)return e;if(!e)return r;const n=zn(Object.create(null),r);for(const i in e)n[i]=Gs(r[i],e[i]);return n}function bX(){return{app:null,config:{isNativeTag:qfe,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ume=0;function Vme(r,e){return function(i,s=null){pi(i)||(i=zn({},i)),s!=null&&!Sn(s)&&(s=null);const o=bX(),a=new WeakSet;let l=!1;const h=o.app={_uid:Ume++,_component:i,_props:s,_container:null,_context:o,_instance:null,version:GX,get config(){return o.config},set config(u){},use(u,...f){return a.has(u)||(u&&pi(u.install)?(a.add(u),u.install(h,...f)):pi(u)&&(a.add(u),u(h,...f))),h},mixin(u){return o.mixins.includes(u)||o.mixins.push(u),h},component(u,f){return f?(o.components[u]=f,h):o.components[u]},directive(u,f){return f?(o.directives[u]=f,h):o.directives[u]},mount(u,f,p){if(!l){const m=Pe(i,s);return m.appContext=o,p===!0?p="svg":p===!1&&(p=void 0),f&&e?e(m,u):r(m,u,p),l=!0,h._container=u,u.__vue_app__=h,GC(m.component)||m.component.proxy}},unmount(){l&&(r(null,h._container),delete h._container.__vue_app__)},provide(u,f){return o.provides[u]=f,h},runWithContext(u){const f=cg;cg=h;try{return u()}finally{cg=f}}};return h}}let cg=null;function M1(r,e){if(Ur){let n=Ur.provides;const i=Ur.parent&&Ur.parent.provides;i===n&&(n=Ur.provides=Object.create(i)),n[r]=e}}function hg(r,e,n=!1){const i=Ur||Tr;if(i||cg){const s=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:cg._context.provides;if(s&&r in s)return s[r];if(arguments.length>1)return n&&pi(e)?e.call(i&&i.proxy):e}}function Fme(){return!!(Ur||Tr||cg)}const xX={},wX=()=>Object.create(xX),_X=r=>Object.getPrototypeOf(r)===xX;function zme(r,e,n,i=!1){const s={},o=wX();r.propsDefaults=Object.create(null),OX(r,e,s,o);for(const a in r.propsOptions[0])a in s||(s[a]=void 0);n?r.props=i?s:$7(s):r.type.props?r.props=s:r.props=o,r.attrs=o}function Xme(r,e,n,i){const{props:s,attrs:o,vnode:{patchFlag:a}}=r,l=nn(s),[h]=r.propsOptions;let u=!1;if((i||a>0)&&!(a&16)){if(a&8){const f=r.vnode.dynamicProps;for(let p=0;p<f.length;p++){let m=f[p];if(UC(r.emitsOptions,m))continue;const v=e[m];if(h)if(rn(o,m))v!==o[m]&&(o[m]=v,u=!0);else{const y=Ks(m);s[y]=Gk(h,l,y,v,r,!1)}else v!==o[m]&&(o[m]=v,u=!0)}}}else{OX(r,e,s,o)&&(u=!0);let f;for(const p in l)(!e||!rn(e,p)&&((f=Yo(p))===p||!rn(e,f)))&&(h?n&&(n[p]!==void 0||n[f]!==void 0)&&(s[p]=Gk(h,l,p,void 0,r,!0)):delete s[p]);if(o!==l)for(const p in o)(!e||!rn(e,p))&&(delete o[p],u=!0)}u&&hh(r.attrs,"set","")}function OX(r,e,n,i){const[s,o]=r.propsOptions;let a=!1,l;if(e)for(let h in e){if(ng(h))continue;const u=e[h];let f;s&&rn(s,f=Ks(h))?!o||!o.includes(f)?n[f]=u:(l||(l={}))[f]=u:UC(r.emitsOptions,h)||(!(h in i)||u!==i[h])&&(i[h]=u,a=!0)}if(o){const h=nn(n),u=l||wn;for(let f=0;f<o.length;f++){const p=o[f];n[p]=Gk(s,h,p,u[p],r,!rn(u,p))}}return a}function Gk(r,e,n,i,s,o){const a=r[n];if(a!=null){const l=rn(a,"default");if(l&&i===void 0){const h=a.default;if(a.type!==Function&&!a.skipFactory&&pi(h)){const{propsDefaults:u}=s;if(n in u)i=u[n];else{const f=Jf(s);i=u[n]=h.call(null,e),f()}}else i=h}a[0]&&(o&&!l?i=!1:a[1]&&(i===""||i===Yo(n))&&(i=!0))}return i}function SX(r,e,n=!1){const i=e.propsCache,s=i.get(r);if(s)return s;const o=r.props,a={},l=[];let h=!1;if(!pi(r)){const f=p=>{h=!0;const[m,v]=SX(p,e,!0);zn(a,m),v&&l.push(...v)};!n&&e.mixins.length&&e.mixins.forEach(f),r.extends&&f(r.extends),r.mixins&&r.mixins.forEach(f)}if(!o&&!h)return Sn(r)&&i.set(r,tg),tg;if(Vt(o))for(let f=0;f<o.length;f++){const p=Ks(o[f]);l6(p)&&(a[p]=wn)}else if(o)for(const f in o){const p=Ks(f);if(l6(p)){const m=o[f],v=a[p]=Vt(m)||pi(m)?{type:m}:zn({},m);if(v){const y=u6(Boolean,v.type),x=u6(String,v.type);v[0]=y>-1,v[1]=x<0||y<x,(y>-1||rn(v,"default"))&&l.push(p)}}}const u=[a,l];return Sn(r)&&i.set(r,u),u}function l6(r){return r[0]!=="$"&&!ng(r)}function c6(r){return r===null?"null":typeof r=="function"?r.name||"":typeof r=="object"&&r.constructor&&r.constructor.name||""}function h6(r,e){return c6(r)===c6(e)}function u6(r,e){return Vt(e)?e.findIndex(n=>h6(n,r)):pi(e)&&h6(e,r)?0:-1}const CX=r=>r[0]==="_"||r==="$stable",xI=r=>Vt(r)?r.map(jo):[jo(r)],Wme=(r,e,n)=>{if(e._n)return e;const i=qe((...s)=>xI(e(...s)),n);return i._c=!1,i},TX=(r,e,n)=>{const i=r._ctx;for(const s in r){if(CX(s))continue;const o=r[s];if(pi(o))e[s]=Wme(s,o,i);else if(o!=null){const a=xI(o);e[s]=()=>a}}},EX=(r,e)=>{const n=xI(e);r.slots.default=()=>n},Gme=(r,e)=>{const n=r.slots=wX();if(r.vnode.shapeFlag&32){const i=e._;i?(zn(n,e),x7(n,"_",i,!0)):TX(e,n)}else e&&EX(r,e)},Hme=(r,e,n)=>{const{vnode:i,slots:s}=r;let o=!0,a=wn;if(i.shapeFlag&32){const l=e._;l?n&&l===1?o=!1:(zn(s,e),!n&&l===1&&delete s._):(o=!e.$stable,TX(e,s)),a=e}else e&&(EX(r,e),a={default:1});if(o)for(const l in s)!CX(l)&&a[l]==null&&delete s[l]};function fS(r,e,n,i,s=!1){if(Vt(r)){r.forEach((m,v)=>fS(m,e&&(Vt(e)?e[v]:e),n,i,s));return}if(Nf(i)&&!s)return;const o=i.shapeFlag&4?GC(i.component)||i.component.proxy:i.el,a=s?null:o,{i:l,r:h}=r,u=e&&e.r,f=l.refs===wn?l.refs={}:l.refs,p=l.setupState;if(u!=null&&u!==h&&(Yn(u)?(f[u]=null,rn(p,u)&&(p[u]=null)):kr(u)&&(u.value=null)),pi(h))uh(h,l,12,[a,f]);else{const m=Yn(h),v=kr(h);if(m||v){const y=()=>{if(r.f){const x=m?rn(p,h)?p[h]:f[h]:h.value;s?Vt(x)&&KR(x,o):Vt(x)?x.includes(o)||x.push(o):m?(f[h]=[o],rn(p,h)&&(p[h]=f[h])):(h.value=[o],r.k&&(f[r.k]=h.value))}else m?(f[h]=a,rn(p,h)&&(p[h]=a)):v&&(h.value=a,r.k&&(f[r.k]=a))};a?(y.id=-1,cs(y,n)):y()}}}let tu=!1;const Qme=r=>r.namespaceURI.includes("svg")&&r.tagName!=="foreignObject",jme=r=>r.namespaceURI.includes("MathML"),pw=r=>{if(Qme(r))return"svg";if(jme(r))return"mathml"},mw=r=>r.nodeType===8;function Yme(r){const{mt:e,p:n,o:{patchProp:i,createText:s,nextSibling:o,parentNode:a,remove:l,insert:h,createComment:u}}=r,f=(_,T)=>{if(!T.hasChildNodes()){n(null,_,T),uS(),T._vnode=_;return}tu=!1,p(T.firstChild,_,null,null,null),uS(),T._vnode=_,tu&&console.error("Hydration completed but contains mismatches.")},p=(_,T,A,P,N,k=!1)=>{k=k||!!T.dynamicChildren;const R=mw(_)&&_.data==="[",E=()=>x(_,T,A,P,N,R),{type:D,ref:$,shapeFlag:I,patchFlag:L}=T;let U=_.nodeType;T.el=_,L===-2&&(k=!1,T.dynamicChildren=null);let V=null;switch(D){case Zf:U!==3?T.children===""?(h(T.el=s(""),a(_),_),V=_):V=E():(_.data!==T.children&&(tu=!0,_.data=T.children),V=o(_));break;case gs:O(_)?(V=o(_),S(T.el=_.content.firstChild,_,A)):U!==8||R?V=E():V=o(_);break;case Df:if(R&&(_=o(_),U=_.nodeType),U===1||U===3){V=_;const X=!T.children.length;for(let H=0;H<T.staticCount;H++)X&&(T.children+=V.nodeType===1?V.outerHTML:V.data),H===T.staticCount-1&&(T.anchor=V),V=o(V);return R?o(V):V}else E();break;case yn:R?V=y(_,T,A,P,N,k):V=E();break;default:if(I&1)(U!==1||T.type.toLowerCase()!==_.tagName.toLowerCase())&&!O(_)?V=E():V=m(_,T,A,P,N,k);else if(I&6){T.slotScopeIds=N;const X=a(_);if(R?V=w(_):mw(_)&&_.data==="teleport start"?V=w(_,_.data,"teleport end"):V=o(_),e(T,X,null,A,P,pw(X),k),Nf(T)){let H;R?(H=Pe(yn),H.anchor=V?V.previousSibling:X.lastChild):H=_.nodeType===3?tn(""):Pe("div"),H.el=_,T.component.subTree=H}}else I&64?U!==8?V=E():V=T.type.hydrate(_,T,A,P,N,k,r,v):I&128&&(V=T.type.hydrate(_,T,A,P,pw(a(_)),N,k,r,p))}return $!=null&&fS($,null,P,T),V},m=(_,T,A,P,N,k)=>{k=k||!!T.dynamicChildren;const{type:R,props:E,patchFlag:D,shapeFlag:$,dirs:I,transition:L}=T,U=R==="input"||R==="option";if(U||D!==-1){I&&jl(T,null,A,"created");let V=!1;if(O(_)){V=kX(P,L)&&A&&A.vnode.props&&A.vnode.props.appear;const H=_.content.firstChild;V&&L.beforeEnter(H),S(H,_,A),T.el=_=H}if($&16&&!(E&&(E.innerHTML||E.textContent))){let H=v(_.firstChild,T,_,A,P,N,k);for(;H;){tu=!0;const J=H;H=H.nextSibling,l(J)}}else $&8&&_.textContent!==T.children&&(tu=!0,_.textContent=T.children);if(E)if(U||!k||D&48)for(const H in E)(U&&(H.endsWith("value")||H==="indeterminate")||bb(H)&&!ng(H)||H[0]===".")&&i(_,H,null,E[H],void 0,void 0,A);else E.onClick&&i(_,"onClick",null,E.onClick,void 0,void 0,A);let X;(X=E&&E.onVnodeBeforeMount)&&go(X,A,T),I&&jl(T,null,A,"beforeMount"),((X=E&&E.onVnodeMounted)||I||V)&&Z7(()=>{X&&go(X,A,T),V&&L.enter(_),I&&jl(T,null,A,"mounted")},P)}return _.nextSibling},v=(_,T,A,P,N,k,R)=>{R=R||!!T.dynamicChildren;const E=T.children,D=E.length;for(let $=0;$<D;$++){const I=R?E[$]:E[$]=jo(E[$]);if(_)_=p(_,I,P,N,k,R);else{if(I.type===Zf&&!I.children)continue;tu=!0,n(null,I,A,null,P,N,pw(A),k)}}return _},y=(_,T,A,P,N,k)=>{const{slotScopeIds:R}=T;R&&(N=N?N.concat(R):R);const E=a(_),D=v(o(_),T,E,A,P,N,k);return D&&mw(D)&&D.data==="]"?o(T.anchor=D):(tu=!0,h(T.anchor=u("]"),E,D),D)},x=(_,T,A,P,N,k)=>{if(tu=!0,T.el=null,k){const D=w(_);for(;;){const $=o(_);if($&&$!==D)l($);else break}}const R=o(_),E=a(_);return l(_),n(null,T,E,R,A,P,pw(E),N),R},w=(_,T="[",A="]")=>{let P=0;for(;_;)if(_=o(_),_&&mw(_)&&(_.data===T&&P++,_.data===A)){if(P===0)return o(_);P--}return _},S=(_,T,A)=>{const P=T.parentNode;P&&P.replaceChild(_,T);let N=A;for(;N;)N.vnode.el===T&&(N.vnode.el=N.subTree.el=_),N=N.parent},O=_=>_.nodeType===1&&_.tagName.toLowerCase()==="template";return[f,p]}const cs=Z7;function wI(r){return AX(r)}function MX(r){return AX(r,Yme)}function AX(r,e){const n=w7();n.__VUE__=!0;const{insert:i,remove:s,patchProp:o,createElement:a,createText:l,createComment:h,setText:u,setElementText:f,parentNode:p,nextSibling:m,setScopeId:v=xo,insertStaticContent:y}=r,x=(W,Z,he,pe=null,_e=null,Re=null,ie=void 0,q=null,me=!!Z.dynamicChildren)=>{if(W===Z)return;W&&!ll(W,Z)&&(pe=se(W),ge(W,_e,Re,!0),W=null),Z.patchFlag===-2&&(me=!1,Z.dynamicChildren=null);const{type:ve,ref:Te,shapeFlag:ke}=Z;switch(ve){case Zf:w(W,Z,he,pe);break;case gs:S(W,Z,he,pe);break;case Df:W==null&&O(Z,he,pe,ie);break;case yn:$(W,Z,he,pe,_e,Re,ie,q,me);break;default:ke&1?A(W,Z,he,pe,_e,Re,ie,q,me):ke&6?I(W,Z,he,pe,_e,Re,ie,q,me):(ke&64||ke&128)&&ve.process(W,Z,he,pe,_e,Re,ie,q,me,z)}Te!=null&&_e&&fS(Te,W&&W.ref,Re,Z||W,!Z)},w=(W,Z,he,pe)=>{if(W==null)i(Z.el=l(Z.children),he,pe);else{const _e=Z.el=W.el;Z.children!==W.children&&u(_e,Z.children)}},S=(W,Z,he,pe)=>{W==null?i(Z.el=h(Z.children||""),he,pe):Z.el=W.el},O=(W,Z,he,pe)=>{[W.el,W.anchor]=y(W.children,Z,he,pe,W.el,W.anchor)},_=({el:W,anchor:Z},he,pe)=>{let _e;for(;W&&W!==Z;)_e=m(W),i(W,he,pe),W=_e;i(Z,he,pe)},T=({el:W,anchor:Z})=>{let he;for(;W&&W!==Z;)he=m(W),s(W),W=he;s(Z)},A=(W,Z,he,pe,_e,Re,ie,q,me)=>{Z.type==="svg"?ie="svg":Z.type==="math"&&(ie="mathml"),W==null?P(Z,he,pe,_e,Re,ie,q,me):R(W,Z,_e,Re,ie,q,me)},P=(W,Z,he,pe,_e,Re,ie,q)=>{let me,ve;const{props:Te,shapeFlag:ke,transition:He,dirs:Ue}=W;if(me=W.el=a(W.type,Re,Te&&Te.is,Te),ke&8?f(me,W.children):ke&16&&k(W.children,me,null,pe,_e,NE(W,Re),ie,q),Ue&&jl(W,null,pe,"created"),N(me,W,W.scopeId,ie,pe),Te){for(const ct in Te)ct!=="value"&&!ng(ct)&&o(me,ct,null,Te[ct],Re,W.children,pe,_e,be);"value"in Te&&o(me,"value",null,Te.value,Re),(ve=Te.onVnodeBeforeMount)&&go(ve,pe,W)}Ue&&jl(W,null,pe,"beforeMount");const We=kX(_e,He);We&&He.beforeEnter(me),i(me,Z,he),((ve=Te&&Te.onVnodeMounted)||We||Ue)&&cs(()=>{ve&&go(ve,pe,W),We&&He.enter(me),Ue&&jl(W,null,pe,"mounted")},_e)},N=(W,Z,he,pe,_e)=>{if(he&&v(W,he),pe)for(let Re=0;Re<pe.length;Re++)v(W,pe[Re]);if(_e){let Re=_e.subTree;if(Z===Re){const ie=_e.vnode;N(W,ie,ie.scopeId,ie.slotScopeIds,_e.parent)}}},k=(W,Z,he,pe,_e,Re,ie,q,me=0)=>{for(let ve=me;ve<W.length;ve++){const Te=W[ve]=q?Tu(W[ve]):jo(W[ve]);x(null,Te,Z,he,pe,_e,Re,ie,q)}},R=(W,Z,he,pe,_e,Re,ie)=>{const q=Z.el=W.el;let{patchFlag:me,dynamicChildren:ve,dirs:Te}=Z;me|=W.patchFlag&16;const ke=W.props||wn,He=Z.props||wn;let Ue;if(he&&Vd(he,!1),(Ue=He.onVnodeBeforeUpdate)&&go(Ue,he,Z,W),Te&&jl(Z,W,he,"beforeUpdate"),he&&Vd(he,!0),ve?E(W.dynamicChildren,ve,q,he,pe,NE(Z,_e),Re):ie||H(W,Z,q,null,he,pe,NE(Z,_e),Re,!1),me>0){if(me&16)D(q,Z,ke,He,he,pe,_e);else if(me&2&&ke.class!==He.class&&o(q,"class",null,He.class,_e),me&4&&o(q,"style",ke.style,He.style,_e),me&8){const We=Z.dynamicProps;for(let ct=0;ct<We.length;ct++){const Ye=We[ct],lt=ke[Ye],Lt=He[Ye];(Lt!==lt||Ye==="value")&&o(q,Ye,lt,Lt,_e,W.children,he,pe,be)}}me&1&&W.children!==Z.children&&f(q,Z.children)}else!ie&&ve==null&&D(q,Z,ke,He,he,pe,_e);((Ue=He.onVnodeUpdated)||Te)&&cs(()=>{Ue&&go(Ue,he,Z,W),Te&&jl(Z,W,he,"updated")},pe)},E=(W,Z,he,pe,_e,Re,ie)=>{for(let q=0;q<Z.length;q++){const me=W[q],ve=Z[q],Te=me.el&&(me.type===yn||!ll(me,ve)||me.shapeFlag&70)?p(me.el):he;x(me,ve,Te,null,pe,_e,Re,ie,!0)}},D=(W,Z,he,pe,_e,Re,ie)=>{if(he!==pe){if(he!==wn)for(const q in he)!ng(q)&&!(q in pe)&&o(W,q,he[q],null,ie,Z.children,_e,Re,be);for(const q in pe){if(ng(q))continue;const me=pe[q],ve=he[q];me!==ve&&q!=="value"&&o(W,q,ve,me,ie,Z.children,_e,Re,be)}"value"in pe&&o(W,"value",he.value,pe.value,ie)}},$=(W,Z,he,pe,_e,Re,ie,q,me)=>{const ve=Z.el=W?W.el:l(""),Te=Z.anchor=W?W.anchor:l("");let{patchFlag:ke,dynamicChildren:He,slotScopeIds:Ue}=Z;Ue&&(q=q?q.concat(Ue):Ue),W==null?(i(ve,he,pe),i(Te,he,pe),k(Z.children||[],he,Te,_e,Re,ie,q,me)):ke>0&&ke&64&&He&&W.dynamicChildren?(E(W.dynamicChildren,He,he,_e,Re,ie,q),(Z.key!=null||_e&&Z===_e.subTree)&&_I(W,Z,!0)):H(W,Z,he,Te,_e,Re,ie,q,me)},I=(W,Z,he,pe,_e,Re,ie,q,me)=>{Z.slotScopeIds=q,W==null?Z.shapeFlag&512?_e.ctx.activate(Z,he,pe,ie,me):L(Z,he,pe,_e,Re,ie,me):U(W,Z,me)},L=(W,Z,he,pe,_e,Re,ie)=>{const q=W.component=$X(W,pe,_e);if(Ob(W)&&(q.ctx.renderer=z),VX(q),q.asyncDep){if(_e&&_e.registerDep(q,V),!W.el){const me=q.subTree=Pe(gs);S(null,me,Z,he)}}else V(q,W,Z,he,_e,Re,ie)},U=(W,Z,he)=>{const pe=Z.component=W.component;if(sme(W,Z,he))if(pe.asyncDep&&!pe.asyncResolved){X(pe,Z,he);return}else pe.next=Z,Kpe(pe.update),pe.effect.dirty=!0,pe.update();else Z.el=W.el,pe.vnode=Z},V=(W,Z,he,pe,_e,Re,ie)=>{const q=()=>{if(W.isMounted){let{next:Te,bu:ke,u:He,parent:Ue,vnode:We}=W;{const Bt=PX(W);if(Bt){Te&&(Te.el=We.el,X(W,Te,ie)),Bt.asyncDep.then(()=>{W.isUnmounted||q()});return}}let ct=Te,Ye;Vd(W,!1),Te?(Te.el=We.el,X(W,Te,ie)):Te=We,ke&&rg(ke),(Ye=Te.props&&Te.props.onVnodeBeforeUpdate)&&go(Ye,Ue,Te,We),Vd(W,!0);const lt=wO(W),Lt=W.subTree;W.subTree=lt,x(Lt,lt,p(Lt.el),se(Lt),W,_e,Re),Te.el=lt.el,ct===null&&dI(W,lt.el),He&&cs(He,_e),(Ye=Te.props&&Te.props.onVnodeUpdated)&&cs(()=>go(Ye,Ue,Te,We),_e)}else{let Te;const{el:ke,props:He}=Z,{bm:Ue,m:We,parent:ct}=W,Ye=Nf(Z);if(Vd(W,!1),Ue&&rg(Ue),!Ye&&(Te=He&&He.onVnodeBeforeMount)&&go(Te,ct,Z),Vd(W,!0),ke&&te){const lt=()=>{W.subTree=wO(W),te(ke,W.subTree,W,_e,null)};Ye?Z.type.__asyncLoader().then(()=>!W.isUnmounted&&lt()):lt()}else{const lt=W.subTree=wO(W);x(null,lt,he,pe,W,_e,Re),Z.el=lt.el}if(We&&cs(We,_e),!Ye&&(Te=He&&He.onVnodeMounted)){const lt=Z;cs(()=>go(Te,ct,lt),_e)}(Z.shapeFlag&256||ct&&Nf(ct.vnode)&&ct.vnode.shapeFlag&256)&&W.a&&cs(W.a,_e),W.isMounted=!0,Z=he=pe=null}},me=W.effect=new Rg(q,xo,()=>$C(ve),W.scope),ve=W.update=()=>{me.dirty&&me.run()};ve.id=W.uid,Vd(W,!0),ve()},X=(W,Z,he)=>{Z.component=W;const pe=W.vnode.props;W.vnode=Z,W.next=null,Xme(W,Z.props,pe,he),Hme(W,Z.children,he),md(),e6(W),gd()},H=(W,Z,he,pe,_e,Re,ie,q,me=!1)=>{const ve=W&&W.children,Te=W?W.shapeFlag:0,ke=Z.children,{patchFlag:He,shapeFlag:Ue}=Z;if(He>0){if(He&128){ee(ve,ke,he,pe,_e,Re,ie,q,me);return}else if(He&256){J(ve,ke,he,pe,_e,Re,ie,q,me);return}}Ue&8?(Te&16&&be(ve,_e,Re),ke!==ve&&f(he,ke)):Te&16?Ue&16?ee(ve,ke,he,pe,_e,Re,ie,q,me):be(ve,_e,Re,!0):(Te&8&&f(he,""),Ue&16&&k(ke,he,pe,_e,Re,ie,q,me))},J=(W,Z,he,pe,_e,Re,ie,q,me)=>{W=W||tg,Z=Z||tg;const ve=W.length,Te=Z.length,ke=Math.min(ve,Te);let He;for(He=0;He<ke;He++){const Ue=Z[He]=me?Tu(Z[He]):jo(Z[He]);x(W[He],Ue,he,null,_e,Re,ie,q,me)}ve>Te?be(W,_e,Re,!0,!1,ke):k(Z,he,pe,_e,Re,ie,q,me,ke)},ee=(W,Z,he,pe,_e,Re,ie,q,me)=>{let ve=0;const Te=Z.length;let ke=W.length-1,He=Te-1;for(;ve<=ke&&ve<=He;){const Ue=W[ve],We=Z[ve]=me?Tu(Z[ve]):jo(Z[ve]);if(ll(Ue,We))x(Ue,We,he,null,_e,Re,ie,q,me);else break;ve++}for(;ve<=ke&&ve<=He;){const Ue=W[ke],We=Z[He]=me?Tu(Z[He]):jo(Z[He]);if(ll(Ue,We))x(Ue,We,he,null,_e,Re,ie,q,me);else break;ke--,He--}if(ve>ke){if(ve<=He){const Ue=He+1,We=Ue<Te?Z[Ue].el:pe;for(;ve<=He;)x(null,Z[ve]=me?Tu(Z[ve]):jo(Z[ve]),he,We,_e,Re,ie,q,me),ve++}}else if(ve>He)for(;ve<=ke;)ge(W[ve],_e,Re,!0),ve++;else{const Ue=ve,We=ve,ct=new Map;for(ve=We;ve<=He;ve++){const Me=Z[ve]=me?Tu(Z[ve]):jo(Z[ve]);Me.key!=null&&ct.set(Me.key,ve)}let Ye,lt=0;const Lt=He-We+1;let Bt=!1,gt=0;const ei=new Array(Lt);for(ve=0;ve<Lt;ve++)ei[ve]=0;for(ve=Ue;ve<=ke;ve++){const Me=W[ve];if(lt>=Lt){ge(Me,_e,Re,!0);continue}let Ve;if(Me.key!=null)Ve=ct.get(Me.key);else for(Ye=We;Ye<=He;Ye++)if(ei[Ye-We]===0&&ll(Me,Z[Ye])){Ve=Ye;break}Ve===void 0?ge(Me,_e,Re,!0):(ei[Ve-We]=ve+1,Ve>=gt?gt=Ve:Bt=!0,x(Me,Z[Ve],he,null,_e,Re,ie,q,me),lt++)}const wi=Bt?qme(ei):tg;for(Ye=wi.length-1,ve=Lt-1;ve>=0;ve--){const Me=We+ve,Ve=Z[Me],xe=Me+1<Te?Z[Me+1].el:pe;ei[ve]===0?x(null,Ve,he,xe,_e,Re,ie,q,me):Bt&&(Ye<0||ve!==wi[Ye]?ne(Ve,he,xe,2):Ye--)}}},ne=(W,Z,he,pe,_e=null)=>{const{el:Re,type:ie,transition:q,children:me,shapeFlag:ve}=W;if(ve&6){ne(W.component.subTree,Z,he,pe);return}if(ve&128){W.suspense.move(Z,he,pe);return}if(ve&64){ie.move(W,Z,he,z);return}if(ie===yn){i(Re,Z,he);for(let ke=0;ke<me.length;ke++)ne(me[ke],Z,he,pe);i(W.anchor,Z,he);return}if(ie===Df){_(W,Z,he);return}if(pe!==2&&ve&1&&q)if(pe===0)q.beforeEnter(Re),i(Re,Z,he),cs(()=>q.enter(Re),_e);else{const{leave:ke,delayLeave:He,afterLeave:Ue}=q,We=()=>i(Re,Z,he),ct=()=>{ke(Re,()=>{We(),Ue&&Ue()})};He?He(Re,We,ct):ct()}else i(Re,Z,he)},ge=(W,Z,he,pe=!1,_e=!1)=>{const{type:Re,props:ie,ref:q,children:me,dynamicChildren:ve,shapeFlag:Te,patchFlag:ke,dirs:He}=W;if(q!=null&&fS(q,null,he,W,!0),Te&256){Z.ctx.deactivate(W);return}const Ue=Te&1&&He,We=!Nf(W);let ct;if(We&&(ct=ie&&ie.onVnodeBeforeUnmount)&&go(ct,Z,W),Te&6)we(W.component,he,pe);else{if(Te&128){W.suspense.unmount(he,pe);return}Ue&&jl(W,null,Z,"beforeUnmount"),Te&64?W.type.remove(W,Z,he,_e,z,pe):ve&&(Re!==yn||ke>0&&ke&64)?be(ve,Z,he,!1,!0):(Re===yn&&ke&384||!_e&&Te&16)&&be(me,Z,he),pe&&ye(W)}(We&&(ct=ie&&ie.onVnodeUnmounted)||Ue)&&cs(()=>{ct&&go(ct,Z,W),Ue&&jl(W,null,Z,"unmounted")},he)},ye=W=>{const{type:Z,el:he,anchor:pe,transition:_e}=W;if(Z===yn){ce(he,pe);return}if(Z===Df){T(W);return}const Re=()=>{s(he),_e&&!_e.persisted&&_e.afterLeave&&_e.afterLeave()};if(W.shapeFlag&1&&_e&&!_e.persisted){const{leave:ie,delayLeave:q}=_e,me=()=>ie(he,Re);q?q(W.el,Re,me):me()}else Re()},ce=(W,Z)=>{let he;for(;W!==Z;)he=m(W),s(W),W=he;s(Z)},we=(W,Z,he)=>{const{bum:pe,scope:_e,update:Re,subTree:ie,um:q}=W;pe&&rg(pe),_e.stop(),Re&&(Re.active=!1,ge(ie,W,Z,he)),q&&cs(q,Z),cs(()=>{W.isUnmounted=!0},Z),Z&&Z.pendingBranch&&!Z.isUnmounted&&W.asyncDep&&!W.asyncResolved&&W.suspenseId===Z.pendingId&&(Z.deps--,Z.deps===0&&Z.resolve())},be=(W,Z,he,pe=!1,_e=!1,Re=0)=>{for(let ie=Re;ie<W.length;ie++)ge(W[ie],Z,he,pe,_e)},se=W=>W.shapeFlag&6?se(W.component.subTree):W.shapeFlag&128?W.suspense.next():m(W.anchor||W.el);let ae=!1;const Q=(W,Z,he)=>{W==null?Z._vnode&&ge(Z._vnode,null,null,!0):x(Z._vnode||null,W,Z,null,null,null,he),ae||(ae=!0,e6(),uS(),ae=!1),Z._vnode=W},z={p:x,um:ge,m:ne,r:ye,mt:L,mc:k,pc:H,pbc:E,n:se,o:r};let j,te;return e&&([j,te]=e(z)),{render:Q,hydrate:j,createApp:Vme(Q,j)}}function NE({type:r,props:e},n){return n==="svg"&&r==="foreignObject"||n==="mathml"&&r==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Vd({effect:r,update:e},n){r.allowRecurse=e.allowRecurse=n}function kX(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function _I(r,e,n=!1){const i=r.children,s=e.children;if(Vt(i)&&Vt(s))for(let o=0;o<i.length;o++){const a=i[o];let l=s[o];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=s[o]=Tu(s[o]),l.el=a.el),n||_I(a,l)),l.type===Zf&&(l.el=a.el)}}function qme(r){const e=r.slice(),n=[0];let i,s,o,a,l;const h=r.length;for(i=0;i<h;i++){const u=r[i];if(u!==0){if(s=n[n.length-1],r[s]<u){e[i]=s,n.push(i);continue}for(o=0,a=n.length-1;o<a;)l=o+a>>1,r[n[l]]<u?o=l+1:a=l;u<r[n[o]]&&(o>0&&(e[i]=n[o-1]),n[o]=i)}}for(o=n.length,a=n[o-1];o-- >0;)n[o]=a,a=e[a];return n}function PX(r){const e=r.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:PX(e)}const Zme=r=>r.__isTeleport,t1=r=>r&&(r.disabled||r.disabled===""),d6=r=>typeof SVGElement<"u"&&r instanceof SVGElement,f6=r=>typeof MathMLElement=="function"&&r instanceof MathMLElement,Hk=(r,e)=>{const n=r&&r.to;return Yn(n)?e?e(n):null:n},Kme={name:"Teleport",__isTeleport:!0,process(r,e,n,i,s,o,a,l,h,u){const{mc:f,pc:p,pbc:m,o:{insert:v,querySelector:y,createText:x,createComment:w}}=u,S=t1(e.props);let{shapeFlag:O,children:_,dynamicChildren:T}=e;if(r==null){const A=e.el=x(""),P=e.anchor=x("");v(A,n,i),v(P,n,i);const N=e.target=Hk(e.props,y),k=e.targetAnchor=x("");N&&(v(k,N),a==="svg"||d6(N)?a="svg":(a==="mathml"||f6(N))&&(a="mathml"));const R=(E,D)=>{O&16&&f(_,E,D,s,o,a,l,h)};S?R(n,P):N&&R(N,k)}else{e.el=r.el;const A=e.anchor=r.anchor,P=e.target=r.target,N=e.targetAnchor=r.targetAnchor,k=t1(r.props),R=k?n:P,E=k?A:N;if(a==="svg"||d6(P)?a="svg":(a==="mathml"||f6(P))&&(a="mathml"),T?(m(r.dynamicChildren,T,R,s,o,a,l),_I(r,e,!0)):h||p(r,e,R,E,s,o,a,l,!1),S)k?e.props&&r.props&&e.props.to!==r.props.to&&(e.props.to=r.props.to):gw(e,n,A,u,1);else if((e.props&&e.props.to)!==(r.props&&r.props.to)){const D=e.target=Hk(e.props,y);D&&gw(e,D,null,u,0)}else k&&gw(e,P,N,u,1)}RX(e)},remove(r,e,n,i,{um:s,o:{remove:o}},a){const{shapeFlag:l,children:h,anchor:u,targetAnchor:f,target:p,props:m}=r;if(p&&o(f),a&&o(u),l&16){const v=a||!t1(m);for(let y=0;y<h.length;y++){const x=h[y];s(x,e,n,v,!!x.dynamicChildren)}}},move:gw,hydrate:Jme};function gw(r,e,n,{o:{insert:i},m:s},o=2){o===0&&i(r.targetAnchor,e,n);const{el:a,anchor:l,shapeFlag:h,children:u,props:f}=r,p=o===2;if(p&&i(a,e,n),(!p||t1(f))&&h&16)for(let m=0;m<u.length;m++)s(u[m],e,n,2);p&&i(l,e,n)}function Jme(r,e,n,i,s,o,{o:{nextSibling:a,parentNode:l,querySelector:h}},u){const f=e.target=Hk(e.props,h);if(f){const p=f._lpa||f.firstChild;if(e.shapeFlag&16)if(t1(e.props))e.anchor=u(a(r),e,l(r),n,i,s,o),e.targetAnchor=p;else{e.anchor=a(r);let m=p;for(;m;)if(m=a(m),m&&m.nodeType===8&&m.data==="teleport anchor"){e.targetAnchor=m,f._lpa=e.targetAnchor&&a(e.targetAnchor);break}u(p,e,f,n,i,s,o)}RX(e)}return e.anchor&&a(e.anchor)}const ege=Kme;function RX(r){const e=r.ctx;if(e&&e.ut){let n=r.children[0].el;for(;n&&n!==r.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",e.uid),n=n.nextSibling;e.ut()}}const yn=Symbol.for("v-fgt"),Zf=Symbol.for("v-txt"),gs=Symbol.for("v-cmt"),Df=Symbol.for("v-stc"),i1=[];let wo=null;function ri(r=!1){i1.push(wo=r?null:[])}function IX(){i1.pop(),wo=i1[i1.length-1]||null}let Kf=1;function Qk(r){Kf+=r}function NX(r){return r.dynamicChildren=Kf>0?wo||tg:null,IX(),Kf>0&&wo&&wo.push(r),r}function Ji(r,e,n,i,s,o){return NX(xt(r,e,n,i,s,o,!0))}function Ar(r,e,n,i,s){return NX(Pe(r,e,n,i,s,!0))}function Ju(r){return r?r.__v_isVNode===!0:!1}function ll(r,e){return r.type===e.type&&r.key===e.key}function tge(r){}const DX=({key:r})=>r??null,OO=({ref:r,ref_key:e,ref_for:n})=>(typeof r=="number"&&(r=""+r),r!=null?Yn(r)||kr(r)||pi(r)?{i:Tr,r,k:e,f:!!n}:r:null);function xt(r,e=null,n=null,i=0,s=null,o=r===yn?0:1,a=!1,l=!1){const h={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&DX(e),ref:e&&OO(e),scopeId:VC,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Tr};return l?(OI(h,n),o&128&&r.normalize(h)):n&&(h.shapeFlag|=Yn(n)?8:16),Kf>0&&!a&&wo&&(h.patchFlag>0||o&6)&&h.patchFlag!==32&&wo.push(h),h}const Pe=ige;function ige(r,e=null,n=null,i=0,s=null,o=!1){if((!r||r===j7)&&(r=gs),Ju(r)){const l=uc(r,e,!0);return n&&OI(l,n),Kf>0&&!o&&wo&&(l.shapeFlag&6?wo[wo.indexOf(r)]=l:wo.push(l)),l.patchFlag|=-2,l}if(hge(r)&&(r=r.__vccOpts),e){e=LX(e);let{class:l,style:h}=e;l&&!Yn(l)&&(e.class=i0(l)),Sn(h)&&(oI(h)&&!Vt(h)&&(h=zn({},h)),e.style=pd(h))}const a=Yn(r)?1:Y7(r)?128:Zme(r)?64:Sn(r)?4:pi(r)?2:0;return xt(r,e,n,i,s,a,o,!0)}function LX(r){return r?oI(r)||_X(r)?zn({},r):r:null}function uc(r,e,n=!1,i=!1){const{props:s,ref:o,patchFlag:a,children:l,transition:h}=r,u=e?BX(s||{},e):s,f={__v_isVNode:!0,__v_skip:!0,type:r.type,props:u,key:u&&DX(u),ref:e&&e.ref?n&&o?Vt(o)?o.concat(OO(e)):[o,OO(e)]:OO(e):o,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:l,target:r.target,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==yn?a===-1?16:a|16:a,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:h,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&uc(r.ssContent),ssFallback:r.ssFallback&&uc(r.ssFallback),el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return h&&i&&(f.transition=h.clone(f)),f}function tn(r=" ",e=0){return Pe(Zf,null,r,e)}function nge(r,e){const n=Pe(Df,null,r);return n.staticCount=e,n}function WC(r="",e=!1){return e?(ri(),Ar(gs,null,r)):Pe(gs,null,r)}function jo(r){return r==null||typeof r=="boolean"?Pe(gs):Vt(r)?Pe(yn,null,r.slice()):typeof r=="object"?Tu(r):Pe(Zf,null,String(r))}function Tu(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:uc(r)}function OI(r,e){let n=0;const{shapeFlag:i}=r;if(e==null)e=null;else if(Vt(e))n=16;else if(typeof e=="object")if(i&65){const s=e.default;s&&(s._c&&(s._d=!1),OI(r,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!_X(e)?e._ctx=Tr:s===3&&Tr&&(Tr.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else pi(e)?(e={default:e,_ctx:Tr},n=32):(e=String(e),i&64?(n=16,e=[tn(e)]):n=8);r.children=e,r.shapeFlag|=n}function BX(...r){const e={};for(let n=0;n<r.length;n++){const i=r[n];for(const s in i)if(s==="class")e.class!==i.class&&(e.class=i0([e.class,i.class]));else if(s==="style")e.style=pd([e.style,i.style]);else if(bb(s)){const o=e[s],a=i[s];a&&o!==a&&!(Vt(o)&&o.includes(a))&&(e[s]=o?[].concat(o,a):a)}else s!==""&&(e[s]=i[s])}return e}function go(r,e,n,i=null){na(r,e,7,[n,i])}const rge=bX();let sge=0;function $X(r,e,n){const i=r.type,s=(e?e.appContext:r.appContext)||rge,o={uid:sge++,vnode:r,type:i,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new tI(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:SX(i,s),emitsOptions:Q7(i,s),emit:null,emitted:null,propsDefaults:wn,inheritAttrs:i.inheritAttrs,ctx:wn,data:wn,props:wn,attrs:wn,slots:wn,refs:wn,setupState:wn,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=e?e.root:o,o.emit=eme.bind(null,o),r.ce&&r.ce(o),o}let Ur=null;const oa=()=>Ur||Tr;let pS,jk;{const r=w7(),e=(n,i)=>{let s;return(s=r[n])||(s=r[n]=[]),s.push(i),o=>{s.length>1?s.forEach(a=>a(o)):s[0](o)}};pS=e("__VUE_INSTANCE_SETTERS__",n=>Ur=n),jk=e("__VUE_SSR_SETTERS__",n=>Cb=n)}const Jf=r=>{const e=Ur;return pS(r),r.scope.on(),()=>{r.scope.off(),pS(e)}},Yk=()=>{Ur&&Ur.scope.off(),pS(null)};function UX(r){return r.vnode.shapeFlag&4}let Cb=!1;function VX(r,e=!1){e&&jk(e);const{props:n,children:i}=r.vnode,s=UX(r);zme(r,n,s,e),Gme(r,i);const o=s?oge(r,e):void 0;return e&&jk(!1),o}function oge(r,e){const n=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,zk);const{setup:i}=n;if(i){const s=r.setupContext=i.length>1?zX(r):null,o=Jf(r);md();const a=uh(i,r,0,[r.props,s]);if(gd(),o(),JR(a)){if(a.then(Yk,Yk),e)return a.then(l=>{qk(r,l,e)}).catch(l=>{wp(l,r,0)});r.asyncDep=a}else qk(r,a,e)}else FX(r,e)}function qk(r,e,n){pi(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:Sn(e)&&(r.setupState=cI(e)),FX(r,n)}let mS,Zk;function age(r){mS=r,Zk=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,Ome))}}const lge=()=>!mS;function FX(r,e,n){const i=r.type;if(!r.render){if(!e&&mS&&!i.render){const s=i.template||bI(r).template;if(s){const{isCustomElement:o,compilerOptions:a}=r.appContext.config,{delimiters:l,compilerOptions:h}=i,u=zn(zn({isCustomElement:o,delimiters:l},a),h);i.render=mS(s,u)}}r.render=i.render||xo,Zk&&Zk(r)}{const s=Jf(r);md();try{Nme(r)}finally{gd(),s()}}}const cge={get(r,e){return Mo(r,"get",""),r[e]}};function zX(r){const e=n=>{r.exposed=n||{}};return{attrs:new Proxy(r.attrs,cge),slots:r.slots,emit:r.emit,expose:e}}function GC(r){if(r.exposed)return r.exposeProxy||(r.exposeProxy=new Proxy(cI(U7(r.exposed)),{get(e,n){if(n in e)return e[n];if(n in e1)return e1[n](r)},has(e,n){return n in e||n in e1}}))}function Kk(r,e=!0){return pi(r)?r.displayName||r.name:r.name||e&&r.__name}function hge(r){return pi(r)&&"__vccOpts"in r}const Rn=(r,e)=>Lpe(r,e,Cb);function XX(r,e,n=wn){const i=oa(),s=Ks(e),o=Yo(e),a=hI((h,u)=>{let f;return tX(()=>{const p=r[e];vl(f,p)&&(f=p,u())}),{get(){return h(),n.get?n.get(f):f},set(p){const m=i.vnode.props;!(m&&(e in m||s in m||o in m)&&(`onUpdate:${e}`in m||`onUpdate:${s}`in m||`onUpdate:${o}`in m))&&vl(p,f)&&(f=p,u()),i.emit(`update:${e}`,n.set?n.set(p):p)}}}),l=e==="modelValue"?"modelModifiers":`${e}Modifiers`;return a[Symbol.iterator]=()=>{let h=0;return{next(){return h<2?{value:h++?r[l]||{}:a,done:!1}:{done:!0}}}},a}function gS(r,e,n){const i=arguments.length;return i===2?Sn(e)&&!Vt(e)?Ju(e)?Pe(r,null,[e]):Pe(r,e):Pe(r,null,e):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&Ju(n)&&(n=[n]),Pe(r,e,n))}function uge(){}function dge(r,e,n,i){const s=n[i];if(s&&WX(s,r))return s;const o=e();return o.memo=r.slice(),n[i]=o}function WX(r,e){const n=r.memo;if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(vl(n[i],e[i]))return!1;return Kf>0&&wo&&wo.push(r),!0}const GX="3.4.27",fge=xo,pge=Ype,mge=Dm,gge=H7,vge={createComponentInstance:$X,setupComponent:VX,renderComponentRoot:wO,setCurrentRenderingInstance:C1,isVNode:Ju,normalizeVNode:jo},yge=vge,bge=null,xge=null,wge=null;/**
* @vue/runtime-dom v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const _ge="http://www.w3.org/2000/svg",Oge="http://www.w3.org/1998/Math/MathML",Eu=typeof document<"u"?document:null,p6=Eu&&Eu.createElement("template"),Sge={insert:(r,e,n)=>{e.insertBefore(r,n||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,n,i)=>{const s=e==="svg"?Eu.createElementNS(_ge,r):e==="mathml"?Eu.createElementNS(Oge,r):Eu.createElement(r,n?{is:n}:void 0);return r==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:r=>Eu.createTextNode(r),createComment:r=>Eu.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>Eu.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},insertStaticContent(r,e,n,i,s,o){const a=n?n.previousSibling:e.lastChild;if(s&&(s===o||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===o||!(s=s.nextSibling)););else{p6.innerHTML=i==="svg"?`<svg>${r}</svg>`:i==="mathml"?`<math>${r}</math>`:r;const l=p6.content;if(i==="svg"||i==="mathml"){const h=l.firstChild;for(;h.firstChild;)l.appendChild(h.firstChild);l.removeChild(h)}e.insertBefore(l,n)}return[a?a.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},iu="transition",ov="animation",Dg=Symbol("_vtc"),SI=(r,{slots:e})=>gS(nX,QX(r),e);SI.displayName="Transition";const HX={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Cge=SI.props=zn({},vI,HX),Fd=(r,e=[])=>{Vt(r)?r.forEach(n=>n(...e)):r&&r(...e)},m6=r=>r?Vt(r)?r.some(e=>e.length>1):r.length>1:!1;function QX(r){const e={};for(const $ in r)$ in HX||(e[$]=r[$]);if(r.css===!1)return e;const{name:n="v",type:i,duration:s,enterFromClass:o=`${n}-enter-from`,enterActiveClass:a=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:h=o,appearActiveClass:u=a,appearToClass:f=l,leaveFromClass:p=`${n}-leave-from`,leaveActiveClass:m=`${n}-leave-active`,leaveToClass:v=`${n}-leave-to`}=r,y=Tge(s),x=y&&y[0],w=y&&y[1],{onBeforeEnter:S,onEnter:O,onEnterCancelled:_,onLeave:T,onLeaveCancelled:A,onBeforeAppear:P=S,onAppear:N=O,onAppearCancelled:k=_}=e,R=($,I,L)=>{wu($,I?f:l),wu($,I?u:a),L&&L()},E=($,I)=>{$._isLeaving=!1,wu($,p),wu($,v),wu($,m),I&&I()},D=$=>(I,L)=>{const U=$?N:O,V=()=>R(I,$,L);Fd(U,[I,V]),g6(()=>{wu(I,$?h:o),Zc(I,$?f:l),m6(U)||v6(I,i,x,V)})};return zn(e,{onBeforeEnter($){Fd(S,[$]),Zc($,o),Zc($,a)},onBeforeAppear($){Fd(P,[$]),Zc($,h),Zc($,u)},onEnter:D(!1),onAppear:D(!0),onLeave($,I){$._isLeaving=!0;const L=()=>E($,I);Zc($,p),Zc($,m),YX(),g6(()=>{$._isLeaving&&(wu($,p),Zc($,v),m6(T)||v6($,i,w,L))}),Fd(T,[$,L])},onEnterCancelled($){R($,!1),Fd(_,[$])},onAppearCancelled($){R($,!0),Fd(k,[$])},onLeaveCancelled($){E($),Fd(A,[$])}})}function Tge(r){if(r==null)return null;if(Sn(r))return[DE(r.enter),DE(r.leave)];{const e=DE(r);return[e,e]}}function DE(r){return lS(r)}function Zc(r,e){e.split(/\s+/).forEach(n=>n&&r.classList.add(n)),(r[Dg]||(r[Dg]=new Set)).add(e)}function wu(r,e){e.split(/\s+/).forEach(i=>i&&r.classList.remove(i));const n=r[Dg];n&&(n.delete(e),n.size||(r[Dg]=void 0))}function g6(r){requestAnimationFrame(()=>{requestAnimationFrame(r)})}let Ege=0;function v6(r,e,n,i){const s=r._endId=++Ege,o=()=>{s===r._endId&&i()};if(n)return setTimeout(o,n);const{type:a,timeout:l,propCount:h}=jX(r,e);if(!a)return i();const u=a+"end";let f=0;const p=()=>{r.removeEventListener(u,m),o()},m=v=>{v.target===r&&++f>=h&&p()};setTimeout(()=>{f<h&&p()},l+1),r.addEventListener(u,m)}function jX(r,e){const n=window.getComputedStyle(r),i=y=>(n[y]||"").split(", "),s=i(`${iu}Delay`),o=i(`${iu}Duration`),a=y6(s,o),l=i(`${ov}Delay`),h=i(`${ov}Duration`),u=y6(l,h);let f=null,p=0,m=0;e===iu?a>0&&(f=iu,p=a,m=o.length):e===ov?u>0&&(f=ov,p=u,m=h.length):(p=Math.max(a,u),f=p>0?a>u?iu:ov:null,m=f?f===iu?o.length:h.length:0);const v=f===iu&&/\b(transform|all)(,|$)/.test(i(`${iu}Property`).toString());return{type:f,timeout:p,propCount:m,hasTransform:v}}function y6(r,e){for(;r.length<e.length;)r=r.concat(r);return Math.max(...e.map((n,i)=>b6(n)+b6(r[i])))}function b6(r){return r==="auto"?0:Number(r.slice(0,-1).replace(",","."))*1e3}function YX(){return document.body.offsetHeight}function Mge(r,e,n){const i=r[Dg];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?r.removeAttribute("class"):n?r.setAttribute("class",e):r.className=e}const vS=Symbol("_vod"),qX=Symbol("_vsh"),ZX={beforeMount(r,{value:e},{transition:n}){r[vS]=r.style.display==="none"?"":r.style.display,n&&e?n.beforeEnter(r):av(r,e)},mounted(r,{value:e},{transition:n}){n&&e&&n.enter(r)},updated(r,{value:e,oldValue:n},{transition:i}){!e!=!n&&(i?e?(i.beforeEnter(r),av(r,!0),i.enter(r)):i.leave(r,()=>{av(r,!1)}):av(r,e))},beforeUnmount(r,{value:e}){av(r,e)}};function av(r,e){r.style.display=e?r[vS]:"none",r[qX]=!e}function Age(){ZX.getSSRProps=({value:r})=>{if(!r)return{style:{display:"none"}}}}const KX=Symbol("");function kge(r){const e=oa();if(!e)return;const n=e.ut=(s=r(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(o=>eP(o,s))},i=()=>{const s=r(e.proxy);Jk(e.subTree,s),n(s)};Xn(()=>{eX(i);const s=new MutationObserver(i);s.observe(e.subTree.el.parentNode,{childList:!0}),Po(()=>s.disconnect())})}function Jk(r,e){if(r.shapeFlag&128){const n=r.suspense;r=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{Jk(n.activeBranch,e)})}for(;r.component;)r=r.component.subTree;if(r.shapeFlag&1&&r.el)eP(r.el,e);else if(r.type===yn)r.children.forEach(n=>Jk(n,e));else if(r.type===Df){let{el:n,anchor:i}=r;for(;n&&(eP(n,e),n!==i);)n=n.nextSibling}}function eP(r,e){if(r.nodeType===1){const n=r.style;let i="";for(const s in e)n.setProperty(`--${s}`,e[s]),i+=`--${s}: ${e[s]};`;n[KX]=i}}const Pge=/(^|;)\s*display\s*:/;function Rge(r,e,n){const i=r.style,s=Yn(n);let o=!1;if(n&&!s){if(e)if(Yn(e))for(const a of e.split(";")){const l=a.slice(0,a.indexOf(":")).trim();n[l]==null&&SO(i,l,"")}else for(const a in e)n[a]==null&&SO(i,a,"");for(const a in n)a==="display"&&(o=!0),SO(i,a,n[a])}else if(s){if(e!==n){const a=i[KX];a&&(n+=";"+a),i.cssText=n,o=Pge.test(n)}}else e&&r.removeAttribute("style");vS in r&&(r[vS]=o?i.display:"",r[qX]&&(i.display="none"))}const x6=/\s*!important$/;function SO(r,e,n){if(Vt(n))n.forEach(i=>SO(r,e,i));else if(n==null&&(n=""),e.startsWith("--"))r.setProperty(e,n);else{const i=Ige(r,e);x6.test(n)?r.setProperty(Yo(i),n.replace(x6,""),"important"):r[i]=n}}const w6=["Webkit","Moz","ms"],LE={};function Ige(r,e){const n=LE[e];if(n)return n;let i=Ks(e);if(i!=="filter"&&i in r)return LE[e]=i;i=xb(i);for(let s=0;s<w6.length;s++){const o=w6[s]+i;if(o in r)return LE[e]=o}return e}const _6="http://www.w3.org/1999/xlink";function Nge(r,e,n,i,s){if(i&&e.startsWith("xlink:"))n==null?r.removeAttributeNS(_6,e.slice(6,e.length)):r.setAttributeNS(_6,e,n);else{const o=hpe(e);n==null||o&&!_7(n)?r.removeAttribute(e):r.setAttribute(e,o?"":n)}}function Dge(r,e,n,i,s,o,a){if(e==="innerHTML"||e==="textContent"){i&&a(i,s,o),r[e]=n??"";return}const l=r.tagName;if(e==="value"&&l!=="PROGRESS"&&!l.includes("-")){const u=l==="OPTION"?r.getAttribute("value")||"":r.value,f=n??"";(u!==f||!("_value"in r))&&(r.value=f),n==null&&r.removeAttribute(e),r._value=n;return}let h=!1;if(n===""||n==null){const u=typeof r[e];u==="boolean"?n=_7(n):n==null&&u==="string"?(n="",h=!0):u==="number"&&(n=0,h=!0)}try{r[e]=n}catch{}h&&r.removeAttribute(e)}function th(r,e,n,i){r.addEventListener(e,n,i)}function Lge(r,e,n,i){r.removeEventListener(e,n,i)}const O6=Symbol("_vei");function Bge(r,e,n,i,s=null){const o=r[O6]||(r[O6]={}),a=o[e];if(i&&a)a.value=i;else{const[l,h]=$ge(e);if(i){const u=o[e]=Fge(i,s);th(r,l,u,h)}else a&&(Lge(r,l,a,h),o[e]=void 0)}}const S6=/(?:Once|Passive|Capture)$/;function $ge(r){let e;if(S6.test(r)){e={};let i;for(;i=r.match(S6);)r=r.slice(0,r.length-i[0].length),e[i[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):Yo(r.slice(2)),e]}let BE=0;const Uge=Promise.resolve(),Vge=()=>BE||(Uge.then(()=>BE=0),BE=Date.now());function Fge(r,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;na(zge(i,n.value),e,5,[i])};return n.value=r,n.attached=Vge(),n}function zge(r,e){if(Vt(e)){const n=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{n.call(r),r._stopped=!0},e.map(i=>s=>!s._stopped&&i&&i(s))}else return e}const C6=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,Xge=(r,e,n,i,s,o,a,l,h)=>{const u=s==="svg";e==="class"?Mge(r,i,u):e==="style"?Rge(r,n,i):bb(e)?ZR(e)||Bge(r,e,n,i,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Wge(r,e,i,u))?Dge(r,e,i,o,a,l,h):(e==="true-value"?r._trueValue=i:e==="false-value"&&(r._falseValue=i),Nge(r,e,i,u))};function Wge(r,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in r&&C6(e)&&pi(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=r.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return C6(e)&&Yn(n)?!1:e in r}/*! #__NO_SIDE_EFFECTS__ */function JX(r,e){const n=xh(r);class i extends HC{constructor(o){super(n,o,e)}}return i.def=n,i}/*! #__NO_SIDE_EFFECTS__ */const Gge=r=>JX(r,hW),Hge=typeof HTMLElement<"u"?HTMLElement:class{};class HC extends Hge{constructor(e,n={},i){super(),this._def=e,this._props=n,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this._ob=null,this.shadowRoot&&i?i(this._createVNode(),this.shadowRoot):(this.attachShadow({mode:"open"}),this._def.__asyncLoader||this._resolveProps(this._def))}connectedCallback(){this._connected=!0,this._instance||(this._resolved?this._update():this._resolveDef())}disconnectedCallback(){this._connected=!1,this._ob&&(this._ob.disconnect(),this._ob=null),n0(()=>{this._connected||(xS(null,this.shadowRoot),this._instance=null)})}_resolveDef(){this._resolved=!0;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const s of i)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(i,s=!1)=>{const{props:o,styles:a}=i;let l;if(o&&!Vt(o))for(const h in o){const u=o[h];(u===Number||u&&u.type===Number)&&(h in this._props&&(this._props[h]=lS(this._props[h])),(l||(l=Object.create(null)))[Ks(h)]=!0)}this._numberProps=l,s&&this._resolveProps(i),this._applyStyles(a),this._update()},n=this._def.__asyncLoader;n?n().then(i=>e(i,!0)):e(this._def)}_resolveProps(e){const{props:n}=e,i=Vt(n)?n:Object.keys(n||{});for(const s of Object.keys(this))s[0]!=="_"&&i.includes(s)&&this._setProp(s,this[s],!0,!1);for(const s of i.map(Ks))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(o){this._setProp(s,o)}})}_setAttr(e){let n=this.hasAttribute(e)?this.getAttribute(e):void 0;const i=Ks(e);this._numberProps&&this._numberProps[i]&&(n=lS(n)),this._setProp(i,n,!1)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,s=!0){n!==this._props[e]&&(this._props[e]=n,s&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(Yo(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(Yo(e),n+""):n||this.removeAttribute(Yo(e))))}_update(){xS(this._createVNode(),this.shadowRoot)}_createVNode(){const e=Pe(this._def,zn({},this._props));return this._instance||(e.ce=n=>{this._instance=n,n.isCE=!0;const i=(o,a)=>{this.dispatchEvent(new CustomEvent(o,{detail:a}))};n.emit=(o,...a)=>{i(o,a),Yo(o)!==o&&i(Yo(o),a)};let s=this;for(;s=s&&(s.parentNode||s.host);)if(s instanceof HC){n.parent=s._instance,n.provides=s._instance.provides;break}}),e}_applyStyles(e){e&&e.forEach(n=>{const i=document.createElement("style");i.textContent=n,this.shadowRoot.appendChild(i)})}}function Qge(r="$style"){{const e=oa();if(!e)return wn;const n=e.type.__cssModules;if(!n)return wn;const i=n[r];return i||wn}}const eW=new WeakMap,tW=new WeakMap,yS=Symbol("_moveCb"),T6=Symbol("_enterCb"),iW={name:"TransitionGroup",props:zn({},Cge,{tag:String,moveClass:String}),setup(r,{slots:e}){const n=oa(),i=gI();let s,o;return XC(()=>{if(!s.length)return;const a=r.moveClass||`${r.name||"v"}-move`;if(!Jge(s[0].el,n.vnode.el,a))return;s.forEach(qge),s.forEach(Zge);const l=s.filter(Kge);YX(),l.forEach(h=>{const u=h.el,f=u.style;Zc(u,a),f.transform=f.webkitTransform=f.transitionDuration="";const p=u[yS]=m=>{m&&m.target!==u||(!m||/transform$/.test(m.propertyName))&&(u.removeEventListener("transitionend",p),u[yS]=null,wu(u,a))};u.addEventListener("transitionend",p)})}),()=>{const a=nn(r),l=QX(a);let h=a.tag||yn;if(s=[],o)for(let u=0;u<o.length;u++){const f=o[u];f.el&&f.el instanceof Element&&(s.push(f),qf(f,Ng(f,l,i,n)),eW.set(f,f.el.getBoundingClientRect()))}o=e.default?FC(e.default()):[];for(let u=0;u<o.length;u++){const f=o[u];f.key!=null&&qf(f,Ng(f,l,i,n))}return Pe(h,null,o)}}},jge=r=>delete r.mode;iW.props;const Yge=iW;function qge(r){const e=r.el;e[yS]&&e[yS](),e[T6]&&e[T6]()}function Zge(r){tW.set(r,r.el.getBoundingClientRect())}function Kge(r){const e=eW.get(r),n=tW.get(r),i=e.left-n.left,s=e.top-n.top;if(i||s){const o=r.el.style;return o.transform=o.webkitTransform=`translate(${i}px,${s}px)`,o.transitionDuration="0s",r}}function Jge(r,e,n){const i=r.cloneNode(),s=r[Dg];s&&s.forEach(l=>{l.split(/\s+/).forEach(h=>h&&i.classList.remove(h))}),n.split(/\s+/).forEach(l=>l&&i.classList.add(l)),i.style.display="none";const o=e.nodeType===1?e:e.parentNode;o.appendChild(i);const{hasTransform:a}=jX(i);return o.removeChild(i),a}const ed=r=>{const e=r.props["onUpdate:modelValue"]||!1;return Vt(e)?n=>rg(e,n):e};function e0e(r){r.target.composing=!0}function E6(r){const e=r.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Ra=Symbol("_assign"),bS={created(r,{modifiers:{lazy:e,trim:n,number:i}},s){r[Ra]=ed(s);const o=i||s.props&&s.props.type==="number";th(r,e?"change":"input",a=>{if(a.target.composing)return;let l=r.value;n&&(l=l.trim()),o&&(l=aS(l)),r[Ra](l)}),n&&th(r,"change",()=>{r.value=r.value.trim()}),e||(th(r,"compositionstart",e0e),th(r,"compositionend",E6),th(r,"change",E6))},mounted(r,{value:e}){r.value=e??""},beforeUpdate(r,{value:e,modifiers:{lazy:n,trim:i,number:s}},o){if(r[Ra]=ed(o),r.composing)return;const a=(s||r.type==="number")&&!/^0\d/.test(r.value)?aS(r.value):r.value,l=e??"";a!==l&&(document.activeElement===r&&r.type!=="range"&&(n||i&&r.value.trim()===l)||(r.value=l))}},CI={deep:!0,created(r,e,n){r[Ra]=ed(n),th(r,"change",()=>{const i=r._modelValue,s=Lg(r),o=r.checked,a=r[Ra];if(Vt(i)){const l=IC(i,s),h=l!==-1;if(o&&!h)a(i.concat(s));else if(!o&&h){const u=[...i];u.splice(l,1),a(u)}}else if(bp(i)){const l=new Set(i);o?l.add(s):l.delete(s),a(l)}else a(rW(r,o))})},mounted:M6,beforeUpdate(r,e,n){r[Ra]=ed(n),M6(r,e,n)}};function M6(r,{value:e,oldValue:n},i){r._modelValue=e,Vt(e)?r.checked=IC(e,i.props.value)>-1:bp(e)?r.checked=e.has(i.props.value):e!==n&&(r.checked=Ku(e,rW(r,!0)))}const TI={created(r,{value:e},n){r.checked=Ku(e,n.props.value),r[Ra]=ed(n),th(r,"change",()=>{r[Ra](Lg(r))})},beforeUpdate(r,{value:e,oldValue:n},i){r[Ra]=ed(i),e!==n&&(r.checked=Ku(e,i.props.value))}},nW={deep:!0,created(r,{value:e,modifiers:{number:n}},i){const s=bp(e);th(r,"change",()=>{const o=Array.prototype.filter.call(r.options,a=>a.selected).map(a=>n?aS(Lg(a)):Lg(a));r[Ra](r.multiple?s?new Set(o):o:o[0]),r._assigning=!0,n0(()=>{r._assigning=!1})}),r[Ra]=ed(i)},mounted(r,{value:e,modifiers:{number:n}}){A6(r,e)},beforeUpdate(r,e,n){r[Ra]=ed(n)},updated(r,{value:e,modifiers:{number:n}}){r._assigning||A6(r,e)}};function A6(r,e,n){const i=r.multiple,s=Vt(e);if(!(i&&!s&&!bp(e))){for(let o=0,a=r.options.length;o<a;o++){const l=r.options[o],h=Lg(l);if(i)if(s){const u=typeof h;u==="string"||u==="number"?l.selected=e.some(f=>String(f)===String(h)):l.selected=IC(e,h)>-1}else l.selected=e.has(h);else if(Ku(Lg(l),e)){r.selectedIndex!==o&&(r.selectedIndex=o);return}}!i&&r.selectedIndex!==-1&&(r.selectedIndex=-1)}}function Lg(r){return"_value"in r?r._value:r.value}function rW(r,e){const n=e?"_trueValue":"_falseValue";return n in r?r[n]:e}const sW={created(r,e,n){vw(r,e,n,null,"created")},mounted(r,e,n){vw(r,e,n,null,"mounted")},beforeUpdate(r,e,n,i){vw(r,e,n,i,"beforeUpdate")},updated(r,e,n,i){vw(r,e,n,i,"updated")}};function oW(r,e){switch(r){case"SELECT":return nW;case"TEXTAREA":return bS;default:switch(e){case"checkbox":return CI;case"radio":return TI;default:return bS}}}function vw(r,e,n,i,s){const a=oW(r.tagName,n.props&&n.props.type)[s];a&&a(r,e,n,i)}function t0e(){bS.getSSRProps=({value:r})=>({value:r}),TI.getSSRProps=({value:r},e)=>{if(e.props&&Ku(e.props.value,r))return{checked:!0}},CI.getSSRProps=({value:r},e)=>{if(Vt(r)){if(e.props&&IC(r,e.props.value)>-1)return{checked:!0}}else if(bp(r)){if(e.props&&r.has(e.props.value))return{checked:!0}}else if(r)return{checked:!0}},sW.getSSRProps=(r,e)=>{if(typeof e.type!="string")return;const n=oW(e.type.toUpperCase(),e.props&&e.props.type);if(n.getSSRProps)return n.getSSRProps(r,e)}}const i0e=["ctrl","shift","alt","meta"],n0e={stop:r=>r.stopPropagation(),prevent:r=>r.preventDefault(),self:r=>r.target!==r.currentTarget,ctrl:r=>!r.ctrlKey,shift:r=>!r.shiftKey,alt:r=>!r.altKey,meta:r=>!r.metaKey,left:r=>"button"in r&&r.button!==0,middle:r=>"button"in r&&r.button!==1,right:r=>"button"in r&&r.button!==2,exact:(r,e)=>i0e.some(n=>r[`${n}Key`]&&!e.includes(n))},r0e=(r,e)=>{const n=r._withMods||(r._withMods={}),i=e.join(".");return n[i]||(n[i]=(s,...o)=>{for(let a=0;a<e.length;a++){const l=n0e[e[a]];if(l&&l(s,e))return}return r(s,...o)})},s0e={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},o0e=(r,e)=>{const n=r._withKeys||(r._withKeys={}),i=e.join(".");return n[i]||(n[i]=s=>{if(!("key"in s))return;const o=Yo(s.key);if(e.some(a=>a===o||s0e[a]===o))return r(s)})},aW=zn({patchProp:Xge},Sge);let n1,k6=!1;function lW(){return n1||(n1=wI(aW))}function cW(){return n1=k6?n1:MX(aW),k6=!0,n1}const xS=(...r)=>{lW().render(...r)},hW=(...r)=>{cW().hydrate(...r)},uW=(...r)=>{const e=lW().createApp(...r),{mount:n}=e;return e.mount=i=>{const s=fW(i);if(!s)return;const o=e._component;!pi(o)&&!o.render&&!o.template&&(o.template=s.innerHTML),s.innerHTML="";const a=n(s,!1,dW(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},e},a0e=(...r)=>{const e=cW().createApp(...r),{mount:n}=e;return e.mount=i=>{const s=fW(i);if(s)return n(s,!0,dW(s))},e};function dW(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function fW(r){return Yn(r)?document.querySelector(r):r}let P6=!1;const l0e=()=>{P6||(P6=!0,t0e(),Age())};/**
* vue v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const c0e=()=>{},h0e=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:nX,BaseTransitionPropsValidators:vI,Comment:gs,DeprecationTypes:wge,EffectScope:tI,ErrorCodes:jpe,ErrorTypeStrings:pge,Fragment:yn,KeepAlive:bme,ReactiveEffect:Rg,Static:Df,Suspense:q7,Teleport:ege,Text:Zf,TrackOpTypes:Gpe,Transition:SI,TransitionGroup:Yge,TriggerOpTypes:Hpe,VueElement:HC,assertNumber:Qpe,callWithAsyncErrorHandling:na,callWithErrorHandling:uh,camelize:Ks,capitalize:xb,cloneVNode:uc,compatUtils:xge,compile:c0e,computed:Rn,createApp:uW,createBlock:Ar,createCommentVNode:WC,createElementBlock:Ji,createElementVNode:xt,createHydrationRenderer:MX,createPropsRestProxy:Ime,createRenderer:wI,createSSRApp:a0e,createSlots:wme,createStaticVNode:nge,createTextVNode:tn,createVNode:Pe,customRef:hI,defineAsyncComponent:vme,defineComponent:xh,defineCustomElement:JX,defineEmits:Cme,defineExpose:Tme,defineModel:Ame,defineOptions:Eme,defineProps:Sme,defineSSRCustomElement:Gge,defineSlots:Mme,devtools:mge,effect:ppe,effectScope:dpe,getCurrentInstance:oa,getCurrentScope:NC,getTransitionRawChildren:FC,guardReactiveProps:LX,h:gS,handleError:wp,hasInjectionContext:Fme,hydrate:hW,initCustomFormatter:uge,initDirectivesForSSR:l0e,inject:hg,isMemoSame:WX,isProxy:oI,isReactive:sg,isReadonly:Ig,isRef:kr,isRuntimeOnly:lge,isShallow:w1,isVNode:Ju,markRaw:U7,mergeDefaults:Pme,mergeModels:Rme,mergeProps:BX,nextTick:n0,normalizeClass:i0,normalizeProps:lpe,normalizeStyle:pd,onActivated:sX,onBeforeMount:lX,onBeforeUnmount:Sb,onBeforeUpdate:cX,onDeactivated:oX,onErrorCaptured:fX,onMounted:Xn,onRenderTracked:dX,onRenderTriggered:uX,onScopeDispose:iI,onServerPrefetch:hX,onUnmounted:Po,onUpdated:XC,openBlock:ri,popScopeId:Op,provide:M1,proxyRefs:cI,pushScopeId:_p,queuePostFlushCb:hS,reactive:xp,readonly:Yf,ref:ot,registerRuntimeCompiler:age,render:xS,renderList:hc,renderSlot:pX,resolveComponent:bt,resolveDirective:ame,resolveDynamicComponent:Uk,resolveFilter:bge,resolveTransitionHooks:Ng,setBlockTracking:Qk,setDevtoolsHook:gge,setTransitionHooks:qf,shallowReactive:$7,shallowReadonly:Dpe,shallowRef:Qn,ssrContextKey:K7,ssrUtils:yge,stop:mpe,toDisplayString:bh,toHandlerKey:Jy,toHandlers:_me,toRaw:nn,toRef:Wpe,toRefs:wb,toValue:Upe,transformVNodeArgs:tge,triggerRef:$pe,unref:oi,useAttrs:gX,useCssModule:Qge,useCssVars:kge,useModel:XX,useSSRContext:J7,useSlots:yI,useTransitionState:gI,vModelCheckbox:CI,vModelDynamic:sW,vModelRadio:TI,vModelSelect:nW,vModelText:bS,vShow:ZX,version:GX,warn:fge,watch:Gi,watchEffect:dh,watchPostEffect:eX,watchSyncEffect:tX,withAsyncContext:_O,withCtx:qe,withDefaults:kme,withDirectives:mme,withKeys:o0e,withMemo:dge,withModifiers:r0e,withScopeId:tme},Symbol.toStringTag,{value:"Module"})),u0e={style:{width:"100%","text-align":"center"}},d0e={__name:"AppItem",props:{routeData:{id:"",title:"",comp:null,desc:""}},setup(r){const e=r;function n(){location.hash=e.routeData.id}return(i,s)=>{const o=bt("Icon"),a=bt("Button");return ri(),Ji("div",u0e,[Pe(a,{type:"success",size:"large",onClick:n},{default:qe(()=>[Pe(o,{type:"md-eye"}),tn(" "+bh(r.routeData.title),1)]),_:1})])}}};/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const r0="164",cf={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Jc={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},pW=0,tP=1,mW=2,f0e=3,p0e=0,EI=1,QC=2,Ql=3,dc=0,Rs=1,Qs=2,fh=0,Lf=1,wS=2,iP=3,nP=4,gW=5,Ru=100,vW=101,yW=102,bW=103,xW=104,wW=200,_W=201,OW=202,SW=203,_S=204,OS=205,CW=206,TW=207,EW=208,MW=209,AW=210,kW=211,PW=212,RW=213,IW=214,NW=0,DW=1,LW=2,A1=3,BW=4,$W=5,UW=6,VW=7,Tb=0,FW=1,zW=2,ph=0,XW=1,WW=2,GW=3,MI=4,HW=5,QW=6,jW=7,rP="attached",YW="detached",jC=300,wh=301,td=302,Bg=303,k1=304,s0=306,yl=1e3,Ps=1001,ep=1002,Er=1003,Eb=1004,m0e=1004,Bu=1005,g0e=1005,ir=1006,Bf=1007,v0e=1007,Ko=1008,y0e=1008,bl=1009,qW=1010,ZW=1011,AI=1012,kI=1013,tp=1014,Ea=1015,o0=1016,PI=1017,RI=1018,a0=1020,KW=35902,JW=1021,eG=1022,_o=1023,tG=1024,iG=1025,$f=1026,$g=1027,II=1028,NI=1029,nG=1030,DI=1031,LI=1033,CO=33776,TO=33777,EO=33778,MO=33779,sP=35840,oP=35841,aP=35842,lP=35843,cP=36196,hP=37492,uP=37496,dP=37808,fP=37809,pP=37810,mP=37811,gP=37812,vP=37813,yP=37814,bP=37815,xP=37816,wP=37817,_P=37818,OP=37819,SP=37820,CP=37821,AO=36492,TP=36494,EP=36495,rG=36283,MP=36284,AP=36285,kP=36286,sG=2200,oG=2201,aG=2202,ip=2300,id=2301,kO=2302,Tf=2400,Ef=2401,P1=2402,YC=2500,BI=2501,lG=0,$I=1,SS=2,cG=3200,hG=3201,vd=0,uG=1,ih="",Jr="srgb",ns="srgb-linear",qC="display-p3",Mb="display-p3-linear",R1="linear",kn="srgb",I1="rec709",N1="p3",b0e=0,hf=7680,x0e=7681,w0e=7682,_0e=7683,O0e=34055,S0e=34056,C0e=5386,T0e=512,E0e=513,M0e=514,A0e=515,k0e=516,P0e=517,R0e=518,PP=519,dG=512,fG=513,pG=514,UI=515,mG=516,gG=517,vG=518,yG=519,D1=35044,I0e=35048,N0e=35040,D0e=35045,L0e=35049,B0e=35041,$0e=35046,U0e=35050,V0e=35042,F0e="100",RP="300 es",tc=2e3,L1=2001;class bc{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const o=s.indexOf(n);o!==-1&&s.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const s=i.slice(0);for(let o=0,a=s.length;o<a;o++)s[o].call(this,e);e.target=null}}}const Cs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let R6=1234567;const Uf=Math.PI/180,Ug=180/Math.PI;function ra(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Cs[r&255]+Cs[r>>8&255]+Cs[r>>16&255]+Cs[r>>24&255]+"-"+Cs[e&255]+Cs[e>>8&255]+"-"+Cs[e>>16&15|64]+Cs[e>>24&255]+"-"+Cs[n&63|128]+Cs[n>>8&255]+"-"+Cs[n>>16&255]+Cs[n>>24&255]+Cs[i&255]+Cs[i>>8&255]+Cs[i>>16&255]+Cs[i>>24&255]).toLowerCase()}function hr(r,e,n){return Math.max(e,Math.min(n,r))}function VI(r,e){return(r%e+e)%e}function z0e(r,e,n,i,s){return i+(r-e)*(s-i)/(n-e)}function X0e(r,e,n){return r!==e?(n-r)/(e-r):0}function r1(r,e,n){return(1-n)*r+n*e}function W0e(r,e,n,i){return r1(r,e,1-Math.exp(-n*i))}function G0e(r,e=1){return e-Math.abs(VI(r,e*2)-e)}function H0e(r,e,n){return r<=e?0:r>=n?1:(r=(r-e)/(n-e),r*r*(3-2*r))}function Q0e(r,e,n){return r<=e?0:r>=n?1:(r=(r-e)/(n-e),r*r*r*(r*(r*6-15)+10))}function j0e(r,e){return r+Math.floor(Math.random()*(e-r+1))}function Y0e(r,e){return r+Math.random()*(e-r)}function q0e(r){return r*(.5-Math.random())}function Z0e(r){r!==void 0&&(R6=r);let e=R6+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function K0e(r){return r*Uf}function J0e(r){return r*Ug}function eve(r){return(r&r-1)===0&&r!==0}function tve(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function ive(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function nve(r,e,n,i,s){const o=Math.cos,a=Math.sin,l=o(n/2),h=a(n/2),u=o((e+i)/2),f=a((e+i)/2),p=o((e-i)/2),m=a((e-i)/2),v=o((i-e)/2),y=a((i-e)/2);switch(s){case"XYX":r.set(l*f,h*p,h*m,l*u);break;case"YZY":r.set(h*m,l*f,h*p,l*u);break;case"ZXZ":r.set(h*p,h*m,l*f,l*u);break;case"XZX":r.set(l*f,h*y,h*v,l*u);break;case"YXY":r.set(h*v,l*f,h*y,l*u);break;case"ZYZ":r.set(h*y,h*v,l*f,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function js(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function Mi(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const fs={DEG2RAD:Uf,RAD2DEG:Ug,generateUUID:ra,clamp:hr,euclideanModulo:VI,mapLinear:z0e,inverseLerp:X0e,lerp:r1,damp:W0e,pingpong:G0e,smoothstep:H0e,smootherstep:Q0e,randInt:j0e,randFloat:Y0e,randFloatSpread:q0e,seededRandom:Z0e,degToRad:K0e,radToDeg:J0e,isPowerOfTwo:eve,ceilPowerOfTwo:tve,floorPowerOfTwo:ive,setQuaternionFromProperEuler:nve,normalize:Mi,denormalize:js};class Xe{constructor(e=0,n=0){Xe.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6],this.y=s[1]*n+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(hr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),s=Math.sin(n),o=this.x-e.x,a=this.y-e.y;return this.x=o*i-a*s+e.x,this.y=o*s+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ci{constructor(e,n,i,s,o,a,l,h,u){Ci.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,s,o,a,l,h,u)}set(e,n,i,s,o,a,l,h,u){const f=this.elements;return f[0]=e,f[1]=s,f[2]=l,f[3]=n,f[4]=o,f[5]=h,f[6]=i,f[7]=a,f[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,o=this.elements,a=i[0],l=i[3],h=i[6],u=i[1],f=i[4],p=i[7],m=i[2],v=i[5],y=i[8],x=s[0],w=s[3],S=s[6],O=s[1],_=s[4],T=s[7],A=s[2],P=s[5],N=s[8];return o[0]=a*x+l*O+h*A,o[3]=a*w+l*_+h*P,o[6]=a*S+l*T+h*N,o[1]=u*x+f*O+p*A,o[4]=u*w+f*_+p*P,o[7]=u*S+f*T+p*N,o[2]=m*x+v*O+y*A,o[5]=m*w+v*_+y*P,o[8]=m*S+v*T+y*N,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],h=e[6],u=e[7],f=e[8];return n*a*f-n*l*u-i*o*f+i*l*h+s*o*u-s*a*h}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],h=e[6],u=e[7],f=e[8],p=f*a-l*u,m=l*h-f*o,v=u*o-a*h,y=n*p+i*m+s*v;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/y;return e[0]=p*x,e[1]=(s*u-f*i)*x,e[2]=(l*i-s*a)*x,e[3]=m*x,e[4]=(f*n-s*h)*x,e[5]=(s*o-l*n)*x,e[6]=v*x,e[7]=(i*h-u*n)*x,e[8]=(a*n-i*o)*x,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,s,o,a,l){const h=Math.cos(o),u=Math.sin(o);return this.set(i*h,i*u,-i*(h*a+u*l)+a+e,-s*u,s*h,-s*(-u*a+h*l)+l+n,0,0,1),this}scale(e,n){return this.premultiply($E.makeScale(e,n)),this}rotate(e){return this.premultiply($E.makeRotation(-e)),this}translate(e,n){return this.premultiply($E.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<9;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const $E=new Ci;function bG(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}const rve={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Hm(r,e){return new rve[r](e)}function B1(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function xG(){const r=B1("canvas");return r.style.display="block",r}const I6={};function wG(r){r in I6||(I6[r]=!0,console.warn(r))}const N6=new Ci().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),D6=new Ci().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),yw={[ns]:{transfer:R1,primaries:I1,toReference:r=>r,fromReference:r=>r},[Jr]:{transfer:kn,primaries:I1,toReference:r=>r.convertSRGBToLinear(),fromReference:r=>r.convertLinearToSRGB()},[Mb]:{transfer:R1,primaries:N1,toReference:r=>r.applyMatrix3(D6),fromReference:r=>r.applyMatrix3(N6)},[qC]:{transfer:kn,primaries:N1,toReference:r=>r.convertSRGBToLinear().applyMatrix3(D6),fromReference:r=>r.applyMatrix3(N6).convertLinearToSRGB()}},sve=new Set([ns,Mb]),dn={enabled:!0,_workingColorSpace:ns,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(r){if(!sve.has(r))throw new Error(`Unsupported working color space, "${r}".`);this._workingColorSpace=r},convert:function(r,e,n){if(this.enabled===!1||e===n||!e||!n)return r;const i=yw[e].toReference,s=yw[n].fromReference;return s(i(r))},fromWorkingColorSpace:function(r,e){return this.convert(r,this._workingColorSpace,e)},toWorkingColorSpace:function(r,e){return this.convert(r,e,this._workingColorSpace)},getPrimaries:function(r){return yw[r].primaries},getTransfer:function(r){return r===ih?R1:yw[r].transfer}};function ug(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function UE(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}let Jp;class _G{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Jp===void 0&&(Jp=B1("canvas")),Jp.width=e.width,Jp.height=e.height;const i=Jp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=Jp}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=B1("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),o=s.data;for(let a=0;a<o.length;a++)o[a]=ug(o[a]/255)*255;return i.putImageData(s,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(ug(n[i]/255)*255):n[i]=ug(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let ove=0;class Mf{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ove++}),this.uuid=ra(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let a=0,l=s.length;a<l;a++)s[a].isDataTexture?o.push(VE(s[a].image)):o.push(VE(s[a]))}else o=VE(s);i.url=o}return n||(e.images[this.uuid]=i),i}}function VE(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?_G.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ave=0,qn=class PO extends bc{constructor(e=PO.DEFAULT_IMAGE,n=PO.DEFAULT_MAPPING,i=Ps,s=Ps,o=ir,a=Ko,l=_o,h=bl,u=PO.DEFAULT_ANISOTROPY,f=ih){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ave++}),this.uuid=ra(),this.name="",this.source=new Mf(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=h,this.offset=new Xe(0,0),this.repeat=new Xe(1,1),this.center=new Xe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ci,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==jC)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case yl:e.x=e.x-Math.floor(e.x);break;case Ps:e.x=e.x<0?0:1;break;case ep:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case yl:e.y=e.y-Math.floor(e.y);break;case Ps:e.y=e.y<0?0:1;break;case ep:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};qn.DEFAULT_IMAGE=null;qn.DEFAULT_MAPPING=jC;qn.DEFAULT_ANISOTROPY=1;class Ni{constructor(e=0,n=0,i=0,s=1){Ni.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,s){return this.x=e,this.y=n,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,o=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*s+a[12]*o,this.y=a[1]*n+a[5]*i+a[9]*s+a[13]*o,this.z=a[2]*n+a[6]*i+a[10]*s+a[14]*o,this.w=a[3]*n+a[7]*i+a[11]*s+a[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,s,o;const h=e.elements,u=h[0],f=h[4],p=h[8],m=h[1],v=h[5],y=h[9],x=h[2],w=h[6],S=h[10];if(Math.abs(f-m)<.01&&Math.abs(p-x)<.01&&Math.abs(y-w)<.01){if(Math.abs(f+m)<.1&&Math.abs(p+x)<.1&&Math.abs(y+w)<.1&&Math.abs(u+v+S-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const _=(u+1)/2,T=(v+1)/2,A=(S+1)/2,P=(f+m)/4,N=(p+x)/4,k=(y+w)/4;return _>T&&_>A?_<.01?(i=0,s=.707106781,o=.707106781):(i=Math.sqrt(_),s=P/i,o=N/i):T>A?T<.01?(i=.707106781,s=0,o=.707106781):(s=Math.sqrt(T),i=P/s,o=k/s):A<.01?(i=.707106781,s=.707106781,o=0):(o=Math.sqrt(A),i=N/o,s=k/o),this.set(i,s,o,n),this}let O=Math.sqrt((w-y)*(w-y)+(p-x)*(p-x)+(m-f)*(m-f));return Math.abs(O)<.001&&(O=1),this.x=(w-y)/O,this.y=(p-x)/O,this.z=(m-f)/O,this.w=Math.acos((u+v+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class OG extends bc{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Ni(0,0,e,n),this.scissorTest=!1,this.viewport=new Ni(0,0,e,n);const s={width:e,height:n,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ir,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const o=new qn(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);o.flipY=!1,o.generateMipmaps=i.generateMipmaps,o.internalFormat=i.internalFormat,this.textures=[];const a=i.count;for(let l=0;l<a;l++)this.textures[l]=o.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let s=0,o=this.textures.length;s<o;s++)this.textures[s].image.width=e,this.textures[s].image.height=n,this.textures[s].image.depth=i;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,s=e.textures.length;i<s;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new Mf(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class La extends OG{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class ZC extends qn{constructor(e=null,n=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:s},this.magFilter=Er,this.minFilter=Er,this.wrapR=Ps,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class lve extends La{constructor(e=1,n=1,i=1,s={}){super(e,n,s),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new ZC(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class FI extends qn{constructor(e=null,n=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:s},this.magFilter=Er,this.minFilter=Er,this.wrapR=Ps,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class cve extends La{constructor(e=1,n=1,i=1,s={}){super(e,n,s),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new FI(null,e,n,i),this.texture.isRenderTargetTexture=!0}}let ur=class{constructor(e=0,n=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=s}static slerpFlat(e,n,i,s,o,a,l){let h=i[s+0],u=i[s+1],f=i[s+2],p=i[s+3];const m=o[a+0],v=o[a+1],y=o[a+2],x=o[a+3];if(l===0){e[n+0]=h,e[n+1]=u,e[n+2]=f,e[n+3]=p;return}if(l===1){e[n+0]=m,e[n+1]=v,e[n+2]=y,e[n+3]=x;return}if(p!==x||h!==m||u!==v||f!==y){let w=1-l;const S=h*m+u*v+f*y+p*x,O=S>=0?1:-1,_=1-S*S;if(_>Number.EPSILON){const A=Math.sqrt(_),P=Math.atan2(A,S*O);w=Math.sin(w*P)/A,l=Math.sin(l*P)/A}const T=l*O;if(h=h*w+m*T,u=u*w+v*T,f=f*w+y*T,p=p*w+x*T,w===1-l){const A=1/Math.sqrt(h*h+u*u+f*f+p*p);h*=A,u*=A,f*=A,p*=A}}e[n]=h,e[n+1]=u,e[n+2]=f,e[n+3]=p}static multiplyQuaternionsFlat(e,n,i,s,o,a){const l=i[s],h=i[s+1],u=i[s+2],f=i[s+3],p=o[a],m=o[a+1],v=o[a+2],y=o[a+3];return e[n]=l*y+f*p+h*v-u*m,e[n+1]=h*y+f*m+u*p-l*v,e[n+2]=u*y+f*v+l*m-h*p,e[n+3]=f*y-l*p-h*m-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,s){return this._x=e,this._y=n,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,s=e._y,o=e._z,a=e._order,l=Math.cos,h=Math.sin,u=l(i/2),f=l(s/2),p=l(o/2),m=h(i/2),v=h(s/2),y=h(o/2);switch(a){case"XYZ":this._x=m*f*p+u*v*y,this._y=u*v*p-m*f*y,this._z=u*f*y+m*v*p,this._w=u*f*p-m*v*y;break;case"YXZ":this._x=m*f*p+u*v*y,this._y=u*v*p-m*f*y,this._z=u*f*y-m*v*p,this._w=u*f*p+m*v*y;break;case"ZXY":this._x=m*f*p-u*v*y,this._y=u*v*p+m*f*y,this._z=u*f*y+m*v*p,this._w=u*f*p-m*v*y;break;case"ZYX":this._x=m*f*p-u*v*y,this._y=u*v*p+m*f*y,this._z=u*f*y-m*v*p,this._w=u*f*p+m*v*y;break;case"YZX":this._x=m*f*p+u*v*y,this._y=u*v*p+m*f*y,this._z=u*f*y-m*v*p,this._w=u*f*p-m*v*y;break;case"XZY":this._x=m*f*p-u*v*y,this._y=u*v*p-m*f*y,this._z=u*f*y+m*v*p,this._w=u*f*p+m*v*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],s=n[4],o=n[8],a=n[1],l=n[5],h=n[9],u=n[2],f=n[6],p=n[10],m=i+l+p;if(m>0){const v=.5/Math.sqrt(m+1);this._w=.25/v,this._x=(f-h)*v,this._y=(o-u)*v,this._z=(a-s)*v}else if(i>l&&i>p){const v=2*Math.sqrt(1+i-l-p);this._w=(f-h)/v,this._x=.25*v,this._y=(s+a)/v,this._z=(o+u)/v}else if(l>p){const v=2*Math.sqrt(1+l-i-p);this._w=(o-u)/v,this._x=(s+a)/v,this._y=.25*v,this._z=(h+f)/v}else{const v=2*Math.sqrt(1+p-i-l);this._w=(a-s)/v,this._x=(o+u)/v,this._y=(h+f)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(hr(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const s=Math.min(1,n/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,s=e._y,o=e._z,a=e._w,l=n._x,h=n._y,u=n._z,f=n._w;return this._x=i*f+a*l+s*u-o*h,this._y=s*f+a*h+o*l-i*u,this._z=o*f+a*u+i*h-s*l,this._w=a*f-i*l-s*h-o*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,s=this._y,o=this._z,a=this._w;let l=a*e._w+i*e._x+s*e._y+o*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=a,this._x=i,this._y=s,this._z=o,this;const h=1-l*l;if(h<=Number.EPSILON){const v=1-n;return this._w=v*a+n*this._w,this._x=v*i+n*this._x,this._y=v*s+n*this._y,this._z=v*o+n*this._z,this.normalize(),this}const u=Math.sqrt(h),f=Math.atan2(u,l),p=Math.sin((1-n)*f)/u,m=Math.sin(n*f)/u;return this._w=a*p+this._w*m,this._x=i*p+this._x*m,this._y=s*p+this._y*m,this._z=o*p+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(n),o*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};class le{constructor(e=0,n=0,i=0){le.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(L6.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(L6.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[3]*i+o[6]*s,this.y=o[1]*n+o[4]*i+o[7]*s,this.z=o[2]*n+o[5]*i+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,o=e.elements,a=1/(o[3]*n+o[7]*i+o[11]*s+o[15]);return this.x=(o[0]*n+o[4]*i+o[8]*s+o[12])*a,this.y=(o[1]*n+o[5]*i+o[9]*s+o[13])*a,this.z=(o[2]*n+o[6]*i+o[10]*s+o[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,s=this.z,o=e.x,a=e.y,l=e.z,h=e.w,u=2*(a*s-l*i),f=2*(l*n-o*s),p=2*(o*i-a*n);return this.x=n+h*u+a*p-l*f,this.y=i+h*f+l*u-o*p,this.z=s+h*p+o*f-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*s,this.y=o[1]*n+o[5]*i+o[9]*s,this.z=o[2]*n+o[6]*i+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,s=e.y,o=e.z,a=n.x,l=n.y,h=n.z;return this.x=s*h-o*l,this.y=o*a-i*h,this.z=i*l-s*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return FE.copy(this).projectOnVector(e),this.sub(FE)}reflect(e){return this.sub(FE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(hr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return n*n+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const s=Math.sin(n)*e;return this.x=s*Math.sin(i),this.y=Math.cos(n)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=s,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const FE=new le,L6=new ur;class vr{constructor(e=new le(1/0,1/0,1/0),n=new le(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(Ja.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(Ja.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Ja.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const o=i.getAttribute("position");if(n===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let a=0,l=o.count;a<l;a++)e.isMesh===!0?e.getVertexPosition(a,Ja):Ja.fromBufferAttribute(o,a),Ja.applyMatrix4(e.matrixWorld),this.expandByPoint(Ja);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),bw.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),bw.copy(i.boundingBox)),bw.applyMatrix4(e.matrixWorld),this.union(bw)}const s=e.children;for(let o=0,a=s.length;o<a;o++)this.expandByObject(s[o],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ja),Ja.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(lv),xw.subVectors(this.max,lv),em.subVectors(e.a,lv),tm.subVectors(e.b,lv),im.subVectors(e.c,lv),nu.subVectors(tm,em),ru.subVectors(im,tm),zd.subVectors(em,im);let n=[0,-nu.z,nu.y,0,-ru.z,ru.y,0,-zd.z,zd.y,nu.z,0,-nu.x,ru.z,0,-ru.x,zd.z,0,-zd.x,-nu.y,nu.x,0,-ru.y,ru.x,0,-zd.y,zd.x,0];return!zE(n,em,tm,im,xw)||(n=[1,0,0,0,1,0,0,0,1],!zE(n,em,tm,im,xw))?!1:(ww.crossVectors(nu,ru),n=[ww.x,ww.y,ww.z],zE(n,em,tm,im,xw))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ja).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ja).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Dc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Dc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Dc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Dc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Dc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Dc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Dc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Dc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Dc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Dc=[new le,new le,new le,new le,new le,new le,new le,new le],Ja=new le,bw=new vr,em=new le,tm=new le,im=new le,nu=new le,ru=new le,zd=new le,lv=new le,xw=new le,ww=new le,Xd=new le;function zE(r,e,n,i,s){for(let o=0,a=r.length-3;o<=a;o+=3){Xd.fromArray(r,o);const l=s.x*Math.abs(Xd.x)+s.y*Math.abs(Xd.y)+s.z*Math.abs(Xd.z),h=e.dot(Xd),u=n.dot(Xd),f=i.dot(Xd);if(Math.max(-Math.max(h,u,f),Math.min(h,u,f))>l)return!1}return!0}const hve=new vr,cv=new le,XE=new le;class ts{constructor(e=new le,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):hve.setFromPoints(e).getCenter(i);let s=0;for(let o=0,a=e.length;o<a;o++)s=Math.max(s,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;cv.subVectors(e,this.center);const n=cv.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),s=(i-this.radius)*.5;this.center.addScaledVector(cv,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(XE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(cv.copy(e.center).add(XE)),this.expandByPoint(cv.copy(e.center).sub(XE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Lc=new le,WE=new le,_w=new le,su=new le,GE=new le,Ow=new le,HE=new le;let Sp=class{constructor(e=new le,n=new le(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Lc)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Lc.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Lc.copy(this.origin).addScaledVector(this.direction,n),Lc.distanceToSquared(e))}distanceSqToSegment(e,n,i,s){WE.copy(e).add(n).multiplyScalar(.5),_w.copy(n).sub(e).normalize(),su.copy(this.origin).sub(WE);const o=e.distanceTo(n)*.5,a=-this.direction.dot(_w),l=su.dot(this.direction),h=-su.dot(_w),u=su.lengthSq(),f=Math.abs(1-a*a);let p,m,v,y;if(f>0)if(p=a*h-l,m=a*l-h,y=o*f,p>=0)if(m>=-y)if(m<=y){const x=1/f;p*=x,m*=x,v=p*(p+a*m+2*l)+m*(a*p+m+2*h)+u}else m=o,p=Math.max(0,-(a*m+l)),v=-p*p+m*(m+2*h)+u;else m=-o,p=Math.max(0,-(a*m+l)),v=-p*p+m*(m+2*h)+u;else m<=-y?(p=Math.max(0,-(-a*o+l)),m=p>0?-o:Math.min(Math.max(-o,-h),o),v=-p*p+m*(m+2*h)+u):m<=y?(p=0,m=Math.min(Math.max(-o,-h),o),v=m*(m+2*h)+u):(p=Math.max(0,-(a*o+l)),m=p>0?o:Math.min(Math.max(-o,-h),o),v=-p*p+m*(m+2*h)+u);else m=a>0?-o:o,p=Math.max(0,-(a*m+l)),v=-p*p+m*(m+2*h)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,p),s&&s.copy(WE).addScaledVector(_w,m),v}intersectSphere(e,n){Lc.subVectors(e.center,this.origin);const i=Lc.dot(this.direction),s=Lc.dot(Lc)-i*i,o=e.radius*e.radius;if(s>o)return null;const a=Math.sqrt(o-s),l=i-a,h=i+a;return h<0?null:l<0?this.at(h,n):this.at(l,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,s,o,a,l,h;const u=1/this.direction.x,f=1/this.direction.y,p=1/this.direction.z,m=this.origin;return u>=0?(i=(e.min.x-m.x)*u,s=(e.max.x-m.x)*u):(i=(e.max.x-m.x)*u,s=(e.min.x-m.x)*u),f>=0?(o=(e.min.y-m.y)*f,a=(e.max.y-m.y)*f):(o=(e.max.y-m.y)*f,a=(e.min.y-m.y)*f),i>a||o>s||((o>i||isNaN(i))&&(i=o),(a<s||isNaN(s))&&(s=a),p>=0?(l=(e.min.z-m.z)*p,h=(e.max.z-m.z)*p):(l=(e.max.z-m.z)*p,h=(e.min.z-m.z)*p),i>h||l>s)||((l>i||i!==i)&&(i=l),(h<s||s!==s)&&(s=h),s<0)?null:this.at(i>=0?i:s,n)}intersectsBox(e){return this.intersectBox(e,Lc)!==null}intersectTriangle(e,n,i,s,o){GE.subVectors(n,e),Ow.subVectors(i,e),HE.crossVectors(GE,Ow);let a=this.direction.dot(HE),l;if(a>0){if(s)return null;l=1}else if(a<0)l=-1,a=-a;else return null;su.subVectors(this.origin,e);const h=l*this.direction.dot(Ow.crossVectors(su,Ow));if(h<0)return null;const u=l*this.direction.dot(GE.cross(su));if(u<0||h+u>a)return null;const f=-l*su.dot(HE);return f<0?null:this.at(f/a,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};class dt{constructor(e,n,i,s,o,a,l,h,u,f,p,m,v,y,x,w){dt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,s,o,a,l,h,u,f,p,m,v,y,x,w)}set(e,n,i,s,o,a,l,h,u,f,p,m,v,y,x,w){const S=this.elements;return S[0]=e,S[4]=n,S[8]=i,S[12]=s,S[1]=o,S[5]=a,S[9]=l,S[13]=h,S[2]=u,S[6]=f,S[10]=p,S[14]=m,S[3]=v,S[7]=y,S[11]=x,S[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new dt().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,s=1/nm.setFromMatrixColumn(e,0).length(),o=1/nm.setFromMatrixColumn(e,1).length(),a=1/nm.setFromMatrixColumn(e,2).length();return n[0]=i[0]*s,n[1]=i[1]*s,n[2]=i[2]*s,n[3]=0,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,s=e.y,o=e.z,a=Math.cos(i),l=Math.sin(i),h=Math.cos(s),u=Math.sin(s),f=Math.cos(o),p=Math.sin(o);if(e.order==="XYZ"){const m=a*f,v=a*p,y=l*f,x=l*p;n[0]=h*f,n[4]=-h*p,n[8]=u,n[1]=v+y*u,n[5]=m-x*u,n[9]=-l*h,n[2]=x-m*u,n[6]=y+v*u,n[10]=a*h}else if(e.order==="YXZ"){const m=h*f,v=h*p,y=u*f,x=u*p;n[0]=m+x*l,n[4]=y*l-v,n[8]=a*u,n[1]=a*p,n[5]=a*f,n[9]=-l,n[2]=v*l-y,n[6]=x+m*l,n[10]=a*h}else if(e.order==="ZXY"){const m=h*f,v=h*p,y=u*f,x=u*p;n[0]=m-x*l,n[4]=-a*p,n[8]=y+v*l,n[1]=v+y*l,n[5]=a*f,n[9]=x-m*l,n[2]=-a*u,n[6]=l,n[10]=a*h}else if(e.order==="ZYX"){const m=a*f,v=a*p,y=l*f,x=l*p;n[0]=h*f,n[4]=y*u-v,n[8]=m*u+x,n[1]=h*p,n[5]=x*u+m,n[9]=v*u-y,n[2]=-u,n[6]=l*h,n[10]=a*h}else if(e.order==="YZX"){const m=a*h,v=a*u,y=l*h,x=l*u;n[0]=h*f,n[4]=x-m*p,n[8]=y*p+v,n[1]=p,n[5]=a*f,n[9]=-l*f,n[2]=-u*f,n[6]=v*p+y,n[10]=m-x*p}else if(e.order==="XZY"){const m=a*h,v=a*u,y=l*h,x=l*u;n[0]=h*f,n[4]=-p,n[8]=u*f,n[1]=m*p+x,n[5]=a*f,n[9]=v*p-y,n[2]=y*p-v,n[6]=l*f,n[10]=x*p+m}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(uve,e,dve)}lookAt(e,n,i){const s=this.elements;return Vo.subVectors(e,n),Vo.lengthSq()===0&&(Vo.z=1),Vo.normalize(),ou.crossVectors(i,Vo),ou.lengthSq()===0&&(Math.abs(i.z)===1?Vo.x+=1e-4:Vo.z+=1e-4,Vo.normalize(),ou.crossVectors(i,Vo)),ou.normalize(),Sw.crossVectors(Vo,ou),s[0]=ou.x,s[4]=Sw.x,s[8]=Vo.x,s[1]=ou.y,s[5]=Sw.y,s[9]=Vo.y,s[2]=ou.z,s[6]=Sw.z,s[10]=Vo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,o=this.elements,a=i[0],l=i[4],h=i[8],u=i[12],f=i[1],p=i[5],m=i[9],v=i[13],y=i[2],x=i[6],w=i[10],S=i[14],O=i[3],_=i[7],T=i[11],A=i[15],P=s[0],N=s[4],k=s[8],R=s[12],E=s[1],D=s[5],$=s[9],I=s[13],L=s[2],U=s[6],V=s[10],X=s[14],H=s[3],J=s[7],ee=s[11],ne=s[15];return o[0]=a*P+l*E+h*L+u*H,o[4]=a*N+l*D+h*U+u*J,o[8]=a*k+l*$+h*V+u*ee,o[12]=a*R+l*I+h*X+u*ne,o[1]=f*P+p*E+m*L+v*H,o[5]=f*N+p*D+m*U+v*J,o[9]=f*k+p*$+m*V+v*ee,o[13]=f*R+p*I+m*X+v*ne,o[2]=y*P+x*E+w*L+S*H,o[6]=y*N+x*D+w*U+S*J,o[10]=y*k+x*$+w*V+S*ee,o[14]=y*R+x*I+w*X+S*ne,o[3]=O*P+_*E+T*L+A*H,o[7]=O*N+_*D+T*U+A*J,o[11]=O*k+_*$+T*V+A*ee,o[15]=O*R+_*I+T*X+A*ne,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],s=e[8],o=e[12],a=e[1],l=e[5],h=e[9],u=e[13],f=e[2],p=e[6],m=e[10],v=e[14],y=e[3],x=e[7],w=e[11],S=e[15];return y*(+o*h*p-s*u*p-o*l*m+i*u*m+s*l*v-i*h*v)+x*(+n*h*v-n*u*m+o*a*m-s*a*v+s*u*f-o*h*f)+w*(+n*u*p-n*l*v-o*a*p+i*a*v+o*l*f-i*u*f)+S*(-s*l*f-n*h*p+n*l*m+s*a*p-i*a*m+i*h*f)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=n,s[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],h=e[6],u=e[7],f=e[8],p=e[9],m=e[10],v=e[11],y=e[12],x=e[13],w=e[14],S=e[15],O=p*w*u-x*m*u+x*h*v-l*w*v-p*h*S+l*m*S,_=y*m*u-f*w*u-y*h*v+a*w*v+f*h*S-a*m*S,T=f*x*u-y*p*u+y*l*v-a*x*v-f*l*S+a*p*S,A=y*p*h-f*x*h-y*l*m+a*x*m+f*l*w-a*p*w,P=n*O+i*_+s*T+o*A;if(P===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const N=1/P;return e[0]=O*N,e[1]=(x*m*o-p*w*o-x*s*v+i*w*v+p*s*S-i*m*S)*N,e[2]=(l*w*o-x*h*o+x*s*u-i*w*u-l*s*S+i*h*S)*N,e[3]=(p*h*o-l*m*o-p*s*u+i*m*u+l*s*v-i*h*v)*N,e[4]=_*N,e[5]=(f*w*o-y*m*o+y*s*v-n*w*v-f*s*S+n*m*S)*N,e[6]=(y*h*o-a*w*o-y*s*u+n*w*u+a*s*S-n*h*S)*N,e[7]=(a*m*o-f*h*o+f*s*u-n*m*u-a*s*v+n*h*v)*N,e[8]=T*N,e[9]=(y*p*o-f*x*o-y*i*v+n*x*v+f*i*S-n*p*S)*N,e[10]=(a*x*o-y*l*o+y*i*u-n*x*u-a*i*S+n*l*S)*N,e[11]=(f*l*o-a*p*o-f*i*u+n*p*u+a*i*v-n*l*v)*N,e[12]=A*N,e[13]=(f*x*s-y*p*s+y*i*m-n*x*m-f*i*w+n*p*w)*N,e[14]=(y*l*s-a*x*s-y*i*h+n*x*h+a*i*w-n*l*w)*N,e[15]=(a*p*s-f*l*s+f*i*h-n*p*h-a*i*m+n*l*m)*N,this}scale(e){const n=this.elements,i=e.x,s=e.y,o=e.z;return n[0]*=i,n[4]*=s,n[8]*=o,n[1]*=i,n[5]*=s,n[9]*=o,n[2]*=i,n[6]*=s,n[10]*=o,n[3]*=i,n[7]*=s,n[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,s))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),s=Math.sin(n),o=1-i,a=e.x,l=e.y,h=e.z,u=o*a,f=o*l;return this.set(u*a+i,u*l-s*h,u*h+s*l,0,u*l+s*h,f*l+i,f*h-s*a,0,u*h-s*l,f*h+s*a,o*h*h+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,s,o,a){return this.set(1,i,o,0,e,1,a,0,n,s,1,0,0,0,0,1),this}compose(e,n,i){const s=this.elements,o=n._x,a=n._y,l=n._z,h=n._w,u=o+o,f=a+a,p=l+l,m=o*u,v=o*f,y=o*p,x=a*f,w=a*p,S=l*p,O=h*u,_=h*f,T=h*p,A=i.x,P=i.y,N=i.z;return s[0]=(1-(x+S))*A,s[1]=(v+T)*A,s[2]=(y-_)*A,s[3]=0,s[4]=(v-T)*P,s[5]=(1-(m+S))*P,s[6]=(w+O)*P,s[7]=0,s[8]=(y+_)*N,s[9]=(w-O)*N,s[10]=(1-(m+x))*N,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,n,i){const s=this.elements;let o=nm.set(s[0],s[1],s[2]).length();const a=nm.set(s[4],s[5],s[6]).length(),l=nm.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],el.copy(this);const u=1/o,f=1/a,p=1/l;return el.elements[0]*=u,el.elements[1]*=u,el.elements[2]*=u,el.elements[4]*=f,el.elements[5]*=f,el.elements[6]*=f,el.elements[8]*=p,el.elements[9]*=p,el.elements[10]*=p,n.setFromRotationMatrix(el),i.x=o,i.y=a,i.z=l,this}makePerspective(e,n,i,s,o,a,l=tc){const h=this.elements,u=2*o/(n-e),f=2*o/(i-s),p=(n+e)/(n-e),m=(i+s)/(i-s);let v,y;if(l===tc)v=-(a+o)/(a-o),y=-2*a*o/(a-o);else if(l===L1)v=-a/(a-o),y=-a*o/(a-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return h[0]=u,h[4]=0,h[8]=p,h[12]=0,h[1]=0,h[5]=f,h[9]=m,h[13]=0,h[2]=0,h[6]=0,h[10]=v,h[14]=y,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,n,i,s,o,a,l=tc){const h=this.elements,u=1/(n-e),f=1/(i-s),p=1/(a-o),m=(n+e)*u,v=(i+s)*f;let y,x;if(l===tc)y=(a+o)*p,x=-2*p;else if(l===L1)y=o*p,x=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return h[0]=2*u,h[4]=0,h[8]=0,h[12]=-m,h[1]=0,h[5]=2*f,h[9]=0,h[13]=-v,h[2]=0,h[6]=0,h[10]=x,h[14]=-y,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<16;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const nm=new le,el=new dt,uve=new le(0,0,0),dve=new le(1,1,1),ou=new le,Sw=new le,Vo=new le,B6=new dt,$6=new ur;class Vr{constructor(e=0,n=0,i=0,s=Vr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,s=this._order){return this._x=e,this._y=n,this._z=i,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const s=e.elements,o=s[0],a=s[4],l=s[8],h=s[1],u=s[5],f=s[9],p=s[2],m=s[6],v=s[10];switch(n){case"XYZ":this._y=Math.asin(hr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-f,v),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(m,u),this._z=0);break;case"YXZ":this._x=Math.asin(-hr(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(l,v),this._z=Math.atan2(h,u)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(hr(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-p,v),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(h,o));break;case"ZYX":this._y=Math.asin(-hr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(m,v),this._z=Math.atan2(h,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(hr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-f,u),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(l,v));break;case"XZY":this._z=Math.asin(-hr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(m,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-f,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return B6.makeRotationFromQuaternion(e),this.setFromRotationMatrix(B6,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return $6.setFromEuler(this),this.setFromQuaternion($6,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Vr.DEFAULT_ORDER="XYZ";class KC{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let fve=0;const U6=new le,rm=new ur,Bc=new dt,Cw=new le,hv=new le,pve=new le,mve=new ur,V6=new le(1,0,0),F6=new le(0,1,0),z6=new le(0,0,1),X6={type:"added"},gve={type:"removed"},sm={type:"childadded",child:null},QE={type:"childremoved",child:null};class Li extends bc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:fve++}),this.uuid=ra(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Li.DEFAULT_UP.clone();const e=new le,n=new Vr,i=new ur,s=new le(1,1,1);function o(){i.setFromEuler(n,!1)}function a(){n.setFromQuaternion(i,void 0,!1)}n._onChange(o),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new dt},normalMatrix:{value:new Ci}}),this.matrix=new dt,this.matrixWorld=new dt,this.matrixAutoUpdate=Li.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Li.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new KC,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return rm.setFromAxisAngle(e,n),this.quaternion.multiply(rm),this}rotateOnWorldAxis(e,n){return rm.setFromAxisAngle(e,n),this.quaternion.premultiply(rm),this}rotateX(e){return this.rotateOnAxis(V6,e)}rotateY(e){return this.rotateOnAxis(F6,e)}rotateZ(e){return this.rotateOnAxis(z6,e)}translateOnAxis(e,n){return U6.copy(e).applyQuaternion(this.quaternion),this.position.add(U6.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(V6,e)}translateY(e){return this.translateOnAxis(F6,e)}translateZ(e){return this.translateOnAxis(z6,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Bc.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?Cw.copy(e):Cw.set(e,n,i);const s=this.parent;this.updateWorldMatrix(!0,!1),hv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Bc.lookAt(hv,Cw,this.up):Bc.lookAt(Cw,hv,this.up),this.quaternion.setFromRotationMatrix(Bc),s&&(Bc.extractRotation(s.matrixWorld),rm.setFromRotationMatrix(Bc),this.quaternion.premultiply(rm.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(X6),sm.child=e,this.dispatchEvent(sm),sm.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(gve),QE.child=e,this.dispatchEvent(QE),QE.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Bc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Bc.multiply(e.parent.matrixWorld)),e.applyMatrix4(Bc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(X6),sm.child=e,this.dispatchEvent(sm),sm.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,s=this.children.length;i<s;i++){const a=this.children[i].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hv,e,pve),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hv,mve,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,s=n.length;i<s;i++){const o=n[i];(o.matrixWorldAutoUpdate===!0||e===!0)&&o.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];l.matrixWorldAutoUpdate===!0&&l.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(l,h){return l[h.uuid]===void 0&&(l[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const h=l.shapes;if(Array.isArray(h))for(let u=0,f=h.length;u<f;u++){const p=h[u];o(e.shapes,p)}else o(e.shapes,h)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let h=0,u=this.material.length;h<u;h++)l.push(o(e.materials,this.material[h]));s.material=l}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++){const h=this.animations[l];s.animations.push(o(e.animations,h))}}if(n){const l=a(e.geometries),h=a(e.materials),u=a(e.textures),f=a(e.images),p=a(e.shapes),m=a(e.skeletons),v=a(e.animations),y=a(e.nodes);l.length>0&&(i.geometries=l),h.length>0&&(i.materials=h),u.length>0&&(i.textures=u),f.length>0&&(i.images=f),p.length>0&&(i.shapes=p),m.length>0&&(i.skeletons=m),v.length>0&&(i.animations=v),y.length>0&&(i.nodes=y)}return i.object=s,i;function a(l){const h=[];for(const u in l){const f=l[u];delete f.metadata,h.push(f)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const s=e.children[i];this.add(s.clone())}return this}}Li.DEFAULT_UP=new le(0,1,0);Li.DEFAULT_MATRIX_AUTO_UPDATE=!0;Li.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const tl=new le,$c=new le,jE=new le,Uc=new le,om=new le,am=new le,W6=new le,YE=new le,qE=new le,ZE=new le;class bo{constructor(e=new le,n=new le,i=new le){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,s){s.subVectors(i,n),tl.subVectors(e,n),s.cross(tl);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,n,i,s,o){tl.subVectors(s,n),$c.subVectors(i,n),jE.subVectors(e,n);const a=tl.dot(tl),l=tl.dot($c),h=tl.dot(jE),u=$c.dot($c),f=$c.dot(jE),p=a*u-l*l;if(p===0)return o.set(0,0,0),null;const m=1/p,v=(u*h-l*f)*m,y=(a*f-l*h)*m;return o.set(1-v-y,y,v)}static containsPoint(e,n,i,s){return this.getBarycoord(e,n,i,s,Uc)===null?!1:Uc.x>=0&&Uc.y>=0&&Uc.x+Uc.y<=1}static getInterpolation(e,n,i,s,o,a,l,h){return this.getBarycoord(e,n,i,s,Uc)===null?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(o,Uc.x),h.addScaledVector(a,Uc.y),h.addScaledVector(l,Uc.z),h)}static isFrontFacing(e,n,i,s){return tl.subVectors(i,n),$c.subVectors(e,n),tl.cross($c).dot(s)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,s){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,n,i,s){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return tl.subVectors(this.c,this.b),$c.subVectors(this.a,this.b),tl.cross($c).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return bo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return bo.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,s,o){return bo.getInterpolation(e,this.a,this.b,this.c,n,i,s,o)}containsPoint(e){return bo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return bo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,s=this.b,o=this.c;let a,l;om.subVectors(s,i),am.subVectors(o,i),YE.subVectors(e,i);const h=om.dot(YE),u=am.dot(YE);if(h<=0&&u<=0)return n.copy(i);qE.subVectors(e,s);const f=om.dot(qE),p=am.dot(qE);if(f>=0&&p<=f)return n.copy(s);const m=h*p-f*u;if(m<=0&&h>=0&&f<=0)return a=h/(h-f),n.copy(i).addScaledVector(om,a);ZE.subVectors(e,o);const v=om.dot(ZE),y=am.dot(ZE);if(y>=0&&v<=y)return n.copy(o);const x=v*u-h*y;if(x<=0&&u>=0&&y<=0)return l=u/(u-y),n.copy(i).addScaledVector(am,l);const w=f*y-v*p;if(w<=0&&p-f>=0&&v-y>=0)return W6.subVectors(o,s),l=(p-f)/(p-f+(v-y)),n.copy(s).addScaledVector(W6,l);const S=1/(w+x+m);return a=x*S,l=m*S,n.copy(i).addScaledVector(om,a).addScaledVector(am,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const SG={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},au={h:0,s:0,l:0},Tw={h:0,s:0,l:0};function KE(r,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(e-r)*6*n:n<1/2?e:n<2/3?r+(e-r)*6*(2/3-n):r}let nt=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Jr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,dn.toWorkingColorSpace(this,n),this}setRGB(e,n,i,s=dn.workingColorSpace){return this.r=e,this.g=n,this.b=i,dn.toWorkingColorSpace(this,s),this}setHSL(e,n,i,s=dn.workingColorSpace){if(e=VI(e,1),n=hr(n,0,1),i=hr(i,0,1),n===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+n):i+n-i*n,a=2*i-o;this.r=KE(a,o,e+1/3),this.g=KE(a,o,e),this.b=KE(a,o,e-1/3)}return dn.toWorkingColorSpace(this,s),this}setStyle(e,n=Jr){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=s[1],l=s[2];switch(a){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,n);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,n);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=s[1],a=o.length;if(a===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(o,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Jr){const i=SG[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ug(e.r),this.g=ug(e.g),this.b=ug(e.b),this}copyLinearToSRGB(e){return this.r=UE(e.r),this.g=UE(e.g),this.b=UE(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Jr){return dn.fromWorkingColorSpace(Ts.copy(this),e),Math.round(hr(Ts.r*255,0,255))*65536+Math.round(hr(Ts.g*255,0,255))*256+Math.round(hr(Ts.b*255,0,255))}getHexString(e=Jr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=dn.workingColorSpace){dn.fromWorkingColorSpace(Ts.copy(this),n);const i=Ts.r,s=Ts.g,o=Ts.b,a=Math.max(i,s,o),l=Math.min(i,s,o);let h,u;const f=(l+a)/2;if(l===a)h=0,u=0;else{const p=a-l;switch(u=f<=.5?p/(a+l):p/(2-a-l),a){case i:h=(s-o)/p+(s<o?6:0);break;case s:h=(o-i)/p+2;break;case o:h=(i-s)/p+4;break}h/=6}return e.h=h,e.s=u,e.l=f,e}getRGB(e,n=dn.workingColorSpace){return dn.fromWorkingColorSpace(Ts.copy(this),n),e.r=Ts.r,e.g=Ts.g,e.b=Ts.b,e}getStyle(e=Jr){dn.fromWorkingColorSpace(Ts.copy(this),e);const n=Ts.r,i=Ts.g,s=Ts.b;return e!==Jr?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,n,i){return this.getHSL(au),this.setHSL(au.h+e,au.s+n,au.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(au),e.getHSL(Tw);const i=r1(au.h,Tw.h,n),s=r1(au.s,Tw.s,n),o=r1(au.l,Tw.l,n);return this.setHSL(i,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,s=this.b,o=e.elements;return this.r=o[0]*n+o[3]*i+o[6]*s,this.g=o[1]*n+o[4]*i+o[7]*s,this.b=o[2]*n+o[5]*i+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Ts=new nt;nt.NAMES=SG;let vve=0,Xr=class extends bc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:vve++}),this.uuid=ra(),this.name="",this.type="Material",this.blending=Lf,this.side=dc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=_S,this.blendDst=OS,this.blendEquation=Ru,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new nt(0,0,0),this.blendAlpha=0,this.depthFunc=A1,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=PP,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=hf,this.stencilZFail=hf,this.stencilZPass=hf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const s=this[n];if(s===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Lf&&(i.blending=this.blending),this.side!==dc&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==_S&&(i.blendSrc=this.blendSrc),this.blendDst!==OS&&(i.blendDst=this.blendDst),this.blendEquation!==Ru&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==A1&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==PP&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==hf&&(i.stencilFail=this.stencilFail),this.stencilZFail!==hf&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==hf&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(o){const a=[];for(const l in o){const h=o[l];delete h.metadata,a.push(h)}return a}if(n){const o=s(e.textures),a=s(e.images);o.length>0&&(i.textures=o),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const s=n.length;i=new Array(s);for(let o=0;o!==s;++o)i[o]=n[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}};class vs extends Xr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vr,this.combine=Tb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const nh=yve();function yve(){const r=new ArrayBuffer(4),e=new Float32Array(r),n=new Uint32Array(r),i=new Uint32Array(512),s=new Uint32Array(512);for(let h=0;h<256;++h){const u=h-127;u<-27?(i[h]=0,i[h|256]=32768,s[h]=24,s[h|256]=24):u<-14?(i[h]=1024>>-u-14,i[h|256]=1024>>-u-14|32768,s[h]=-u-1,s[h|256]=-u-1):u<=15?(i[h]=u+15<<10,i[h|256]=u+15<<10|32768,s[h]=13,s[h|256]=13):u<128?(i[h]=31744,i[h|256]=64512,s[h]=24,s[h|256]=24):(i[h]=31744,i[h|256]=64512,s[h]=13,s[h|256]=13)}const o=new Uint32Array(2048),a=new Uint32Array(64),l=new Uint32Array(64);for(let h=1;h<1024;++h){let u=h<<13,f=0;for(;!(u&8388608);)u<<=1,f-=8388608;u&=-8388609,f+=947912704,o[h]=u|f}for(let h=1024;h<2048;++h)o[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)a[h]=h<<23;a[31]=1199570944,a[32]=2147483648;for(let h=33;h<63;++h)a[h]=2147483648+(h-32<<23);a[63]=3347054592;for(let h=1;h<64;++h)h!==32&&(l[h]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:s,mantissaTable:o,exponentTable:a,offsetTable:l}}function uo(r){Math.abs(r)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),r=hr(r,-65504,65504),nh.floatView[0]=r;const e=nh.uint32View[0],n=e>>23&511;return nh.baseTable[n]+((e&8388607)>>nh.shiftTable[n])}function By(r){const e=r>>10;return nh.uint32View[0]=nh.mantissaTable[nh.offsetTable[e]+(r&1023)]+nh.exponentTable[e],nh.floatView[0]}const bve={toHalfFloat:uo,fromHalfFloat:By},wr=new le,Ew=new Xe;class Di{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=D1,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Ea,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return wG("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=n.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)Ew.fromBufferAttribute(this,n),Ew.applyMatrix3(e),this.setXY(n,Ew.x,Ew.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)wr.fromBufferAttribute(this,n),wr.applyMatrix3(e),this.setXYZ(n,wr.x,wr.y,wr.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)wr.fromBufferAttribute(this,n),wr.applyMatrix4(e),this.setXYZ(n,wr.x,wr.y,wr.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)wr.fromBufferAttribute(this,n),wr.applyNormalMatrix(e),this.setXYZ(n,wr.x,wr.y,wr.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)wr.fromBufferAttribute(this,n),wr.transformDirection(e),this.setXYZ(n,wr.x,wr.y,wr.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=js(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Mi(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=js(n,this.array)),n}setX(e,n){return this.normalized&&(n=Mi(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=js(n,this.array)),n}setY(e,n){return this.normalized&&(n=Mi(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=js(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Mi(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=js(n,this.array)),n}setW(e,n){return this.normalized&&(n=Mi(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Mi(n,this.array),i=Mi(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,s){return e*=this.itemSize,this.normalized&&(n=Mi(n,this.array),i=Mi(i,this.array),s=Mi(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,n,i,s,o){return e*=this.itemSize,this.normalized&&(n=Mi(n,this.array),i=Mi(i,this.array),s=Mi(s,this.array),o=Mi(o,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==D1&&(e.usage=this.usage),e}}class xve extends Di{constructor(e,n,i){super(new Int8Array(e),n,i)}}class wve extends Di{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class _ve extends Di{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class Ove extends Di{constructor(e,n,i){super(new Int16Array(e),n,i)}}class JC extends Di{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class Sve extends Di{constructor(e,n,i){super(new Int32Array(e),n,i)}}class zI extends Di{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class Cve extends Di{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=By(this.array[e*this.itemSize]);return this.normalized&&(n=js(n,this.array)),n}setX(e,n){return this.normalized&&(n=Mi(n,this.array)),this.array[e*this.itemSize]=uo(n),this}getY(e){let n=By(this.array[e*this.itemSize+1]);return this.normalized&&(n=js(n,this.array)),n}setY(e,n){return this.normalized&&(n=Mi(n,this.array)),this.array[e*this.itemSize+1]=uo(n),this}getZ(e){let n=By(this.array[e*this.itemSize+2]);return this.normalized&&(n=js(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Mi(n,this.array)),this.array[e*this.itemSize+2]=uo(n),this}getW(e){let n=By(this.array[e*this.itemSize+3]);return this.normalized&&(n=js(n,this.array)),n}setW(e,n){return this.normalized&&(n=Mi(n,this.array)),this.array[e*this.itemSize+3]=uo(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Mi(n,this.array),i=Mi(i,this.array)),this.array[e+0]=uo(n),this.array[e+1]=uo(i),this}setXYZ(e,n,i,s){return e*=this.itemSize,this.normalized&&(n=Mi(n,this.array),i=Mi(i,this.array),s=Mi(s,this.array)),this.array[e+0]=uo(n),this.array[e+1]=uo(i),this.array[e+2]=uo(s),this}setXYZW(e,n,i,s,o){return e*=this.itemSize,this.normalized&&(n=Mi(n,this.array),i=Mi(i,this.array),s=Mi(s,this.array),o=Mi(o,this.array)),this.array[e+0]=uo(n),this.array[e+1]=uo(i),this.array[e+2]=uo(s),this.array[e+3]=uo(o),this}}class Nt extends Di{constructor(e,n,i){super(new Float32Array(e),n,i)}}let Tve=0;const ga=new dt,JE=new Li,lm=new le,Fo=new vr,uv=new vr,qr=new le;class vi extends bc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Tve++}),this.uuid=ra(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(bG(e)?zI:JC)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new Ci().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ga.makeRotationFromQuaternion(e),this.applyMatrix4(ga),this}rotateX(e){return ga.makeRotationX(e),this.applyMatrix4(ga),this}rotateY(e){return ga.makeRotationY(e),this.applyMatrix4(ga),this}rotateZ(e){return ga.makeRotationZ(e),this.applyMatrix4(ga),this}translate(e,n,i){return ga.makeTranslation(e,n,i),this.applyMatrix4(ga),this}scale(e,n,i){return ga.makeScale(e,n,i),this.applyMatrix4(ga),this}lookAt(e){return JE.lookAt(e),JE.updateMatrix(),this.applyMatrix4(JE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(lm).negate(),this.translate(lm.x,lm.y,lm.z),this}setFromPoints(e){const n=[];for(let i=0,s=e.length;i<s;i++){const o=e[i];n.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Nt(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vr);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new le(-1/0,-1/0,-1/0),new le(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,s=n.length;i<s;i++){const o=n[i];Fo.setFromBufferAttribute(o),this.morphTargetsRelative?(qr.addVectors(this.boundingBox.min,Fo.min),this.boundingBox.expandByPoint(qr),qr.addVectors(this.boundingBox.max,Fo.max),this.boundingBox.expandByPoint(qr)):(this.boundingBox.expandByPoint(Fo.min),this.boundingBox.expandByPoint(Fo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ts);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new le,1/0);return}if(e){const i=this.boundingSphere.center;if(Fo.setFromBufferAttribute(e),n)for(let o=0,a=n.length;o<a;o++){const l=n[o];uv.setFromBufferAttribute(l),this.morphTargetsRelative?(qr.addVectors(Fo.min,uv.min),Fo.expandByPoint(qr),qr.addVectors(Fo.max,uv.max),Fo.expandByPoint(qr)):(Fo.expandByPoint(uv.min),Fo.expandByPoint(uv.max))}Fo.getCenter(i);let s=0;for(let o=0,a=e.count;o<a;o++)qr.fromBufferAttribute(e,o),s=Math.max(s,i.distanceToSquared(qr));if(n)for(let o=0,a=n.length;o<a;o++){const l=n[o],h=this.morphTargetsRelative;for(let u=0,f=l.count;u<f;u++)qr.fromBufferAttribute(l,u),h&&(lm.fromBufferAttribute(e,u),qr.add(lm)),s=Math.max(s,i.distanceToSquared(qr))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,s=n.normal,o=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Di(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),l=[],h=[];for(let k=0;k<i.count;k++)l[k]=new le,h[k]=new le;const u=new le,f=new le,p=new le,m=new Xe,v=new Xe,y=new Xe,x=new le,w=new le;function S(k,R,E){u.fromBufferAttribute(i,k),f.fromBufferAttribute(i,R),p.fromBufferAttribute(i,E),m.fromBufferAttribute(o,k),v.fromBufferAttribute(o,R),y.fromBufferAttribute(o,E),f.sub(u),p.sub(u),v.sub(m),y.sub(m);const D=1/(v.x*y.y-y.x*v.y);isFinite(D)&&(x.copy(f).multiplyScalar(y.y).addScaledVector(p,-v.y).multiplyScalar(D),w.copy(p).multiplyScalar(v.x).addScaledVector(f,-y.x).multiplyScalar(D),l[k].add(x),l[R].add(x),l[E].add(x),h[k].add(w),h[R].add(w),h[E].add(w))}let O=this.groups;O.length===0&&(O=[{start:0,count:e.count}]);for(let k=0,R=O.length;k<R;++k){const E=O[k],D=E.start,$=E.count;for(let I=D,L=D+$;I<L;I+=3)S(e.getX(I+0),e.getX(I+1),e.getX(I+2))}const _=new le,T=new le,A=new le,P=new le;function N(k){A.fromBufferAttribute(s,k),P.copy(A);const R=l[k];_.copy(R),_.sub(A.multiplyScalar(A.dot(R))).normalize(),T.crossVectors(P,R);const D=T.dot(h[k])<0?-1:1;a.setXYZW(k,_.x,_.y,_.z,D)}for(let k=0,R=O.length;k<R;++k){const E=O[k],D=E.start,$=E.count;for(let I=D,L=D+$;I<L;I+=3)N(e.getX(I+0)),N(e.getX(I+1)),N(e.getX(I+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Di(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let m=0,v=i.count;m<v;m++)i.setXYZ(m,0,0,0);const s=new le,o=new le,a=new le,l=new le,h=new le,u=new le,f=new le,p=new le;if(e)for(let m=0,v=e.count;m<v;m+=3){const y=e.getX(m+0),x=e.getX(m+1),w=e.getX(m+2);s.fromBufferAttribute(n,y),o.fromBufferAttribute(n,x),a.fromBufferAttribute(n,w),f.subVectors(a,o),p.subVectors(s,o),f.cross(p),l.fromBufferAttribute(i,y),h.fromBufferAttribute(i,x),u.fromBufferAttribute(i,w),l.add(f),h.add(f),u.add(f),i.setXYZ(y,l.x,l.y,l.z),i.setXYZ(x,h.x,h.y,h.z),i.setXYZ(w,u.x,u.y,u.z)}else for(let m=0,v=n.count;m<v;m+=3)s.fromBufferAttribute(n,m+0),o.fromBufferAttribute(n,m+1),a.fromBufferAttribute(n,m+2),f.subVectors(a,o),p.subVectors(s,o),f.cross(p),i.setXYZ(m+0,f.x,f.y,f.z),i.setXYZ(m+1,f.x,f.y,f.z),i.setXYZ(m+2,f.x,f.y,f.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)qr.fromBufferAttribute(e,n),qr.normalize(),e.setXYZ(n,qr.x,qr.y,qr.z)}toNonIndexed(){function e(l,h){const u=l.array,f=l.itemSize,p=l.normalized,m=new u.constructor(h.length*f);let v=0,y=0;for(let x=0,w=h.length;x<w;x++){l.isInterleavedBufferAttribute?v=h[x]*l.data.stride+l.offset:v=h[x]*f;for(let S=0;S<f;S++)m[y++]=u[v++]}return new Di(m,f,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new vi,i=this.index.array,s=this.attributes;for(const l in s){const h=s[l],u=e(h,i);n.setAttribute(l,u)}const o=this.morphAttributes;for(const l in o){const h=[],u=o[l];for(let f=0,p=u.length;f<p;f++){const m=u[f],v=e(m,i);h.push(v)}n.morphAttributes[l]=h}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,h=a.length;l<h;l++){const u=a[l];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const u in h)h[u]!==void 0&&(e[u]=h[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const h in i){const u=i[h];e.data.attributes[h]=u.toJSON(e.data)}const s={};let o=!1;for(const h in this.morphAttributes){const u=this.morphAttributes[h],f=[];for(let p=0,m=u.length;p<m;p++){const v=u[p];f.push(v.toJSON(e.data))}f.length>0&&(s[h]=f,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const s=e.attributes;for(const u in s){const f=s[u];this.setAttribute(u,f.clone(n))}const o=e.morphAttributes;for(const u in o){const f=[],p=o[u];for(let m=0,v=p.length;m<v;m++)f.push(p[m].clone(n));this.morphAttributes[u]=f}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,f=a.length;u<f;u++){const p=a[u];this.addGroup(p.start,p.count,p.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const G6=new dt,Wd=new Sp,Mw=new ts,H6=new le,cm=new le,hm=new le,um=new le,eM=new le,Aw=new le,kw=new Xe,Pw=new Xe,Rw=new Xe,Q6=new le,j6=new le,Y6=new le,Iw=new le,Nw=new le;let ln=class extends Li{constructor(e=new vi,n=new vs){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}getVertexPosition(e,n){const i=this.geometry,s=i.attributes.position,o=i.morphAttributes.position,a=i.morphTargetsRelative;n.fromBufferAttribute(s,e);const l=this.morphTargetInfluences;if(o&&l){Aw.set(0,0,0);for(let h=0,u=o.length;h<u;h++){const f=l[h],p=o[h];f!==0&&(eM.fromBufferAttribute(p,e),a?Aw.addScaledVector(eM,f):Aw.addScaledVector(eM.sub(n),f))}n.add(Aw)}return n}raycast(e,n){const i=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Mw.copy(i.boundingSphere),Mw.applyMatrix4(o),Wd.copy(e.ray).recast(e.near),!(Mw.containsPoint(Wd.origin)===!1&&(Wd.intersectSphere(Mw,H6)===null||Wd.origin.distanceToSquared(H6)>(e.far-e.near)**2))&&(G6.copy(o).invert(),Wd.copy(e.ray).applyMatrix4(G6),!(i.boundingBox!==null&&Wd.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,Wd)))}_computeIntersections(e,n,i){let s;const o=this.geometry,a=this.material,l=o.index,h=o.attributes.position,u=o.attributes.uv,f=o.attributes.uv1,p=o.attributes.normal,m=o.groups,v=o.drawRange;if(l!==null)if(Array.isArray(a))for(let y=0,x=m.length;y<x;y++){const w=m[y],S=a[w.materialIndex],O=Math.max(w.start,v.start),_=Math.min(l.count,Math.min(w.start+w.count,v.start+v.count));for(let T=O,A=_;T<A;T+=3){const P=l.getX(T),N=l.getX(T+1),k=l.getX(T+2);s=Dw(this,S,e,i,u,f,p,P,N,k),s&&(s.faceIndex=Math.floor(T/3),s.face.materialIndex=w.materialIndex,n.push(s))}}else{const y=Math.max(0,v.start),x=Math.min(l.count,v.start+v.count);for(let w=y,S=x;w<S;w+=3){const O=l.getX(w),_=l.getX(w+1),T=l.getX(w+2);s=Dw(this,a,e,i,u,f,p,O,_,T),s&&(s.faceIndex=Math.floor(w/3),n.push(s))}}else if(h!==void 0)if(Array.isArray(a))for(let y=0,x=m.length;y<x;y++){const w=m[y],S=a[w.materialIndex],O=Math.max(w.start,v.start),_=Math.min(h.count,Math.min(w.start+w.count,v.start+v.count));for(let T=O,A=_;T<A;T+=3){const P=T,N=T+1,k=T+2;s=Dw(this,S,e,i,u,f,p,P,N,k),s&&(s.faceIndex=Math.floor(T/3),s.face.materialIndex=w.materialIndex,n.push(s))}}else{const y=Math.max(0,v.start),x=Math.min(h.count,v.start+v.count);for(let w=y,S=x;w<S;w+=3){const O=w,_=w+1,T=w+2;s=Dw(this,a,e,i,u,f,p,O,_,T),s&&(s.faceIndex=Math.floor(w/3),n.push(s))}}}};function Eve(r,e,n,i,s,o,a,l){let h;if(e.side===Rs?h=i.intersectTriangle(a,o,s,!0,l):h=i.intersectTriangle(s,o,a,e.side===dc,l),h===null)return null;Nw.copy(l),Nw.applyMatrix4(r.matrixWorld);const u=n.ray.origin.distanceTo(Nw);return u<n.near||u>n.far?null:{distance:u,point:Nw.clone(),object:r}}function Dw(r,e,n,i,s,o,a,l,h,u){r.getVertexPosition(l,cm),r.getVertexPosition(h,hm),r.getVertexPosition(u,um);const f=Eve(r,e,n,i,cm,hm,um,Iw);if(f){s&&(kw.fromBufferAttribute(s,l),Pw.fromBufferAttribute(s,h),Rw.fromBufferAttribute(s,u),f.uv=bo.getInterpolation(Iw,cm,hm,um,kw,Pw,Rw,new Xe)),o&&(kw.fromBufferAttribute(o,l),Pw.fromBufferAttribute(o,h),Rw.fromBufferAttribute(o,u),f.uv1=bo.getInterpolation(Iw,cm,hm,um,kw,Pw,Rw,new Xe)),a&&(Q6.fromBufferAttribute(a,l),j6.fromBufferAttribute(a,h),Y6.fromBufferAttribute(a,u),f.normal=bo.getInterpolation(Iw,cm,hm,um,Q6,j6,Y6,new le),f.normal.dot(i.direction)>0&&f.normal.multiplyScalar(-1));const p={a:l,b:h,c:u,normal:new le,materialIndex:0};bo.getNormal(cm,hm,um,p.normal),f.face=p}return f}class Rh extends vi{constructor(e=1,n=1,i=1,s=1,o=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:s,heightSegments:o,depthSegments:a};const l=this;s=Math.floor(s),o=Math.floor(o),a=Math.floor(a);const h=[],u=[],f=[],p=[];let m=0,v=0;y("z","y","x",-1,-1,i,n,e,a,o,0),y("z","y","x",1,-1,i,n,-e,a,o,1),y("x","z","y",1,1,e,i,n,s,a,2),y("x","z","y",1,-1,e,i,-n,s,a,3),y("x","y","z",1,-1,e,n,i,s,o,4),y("x","y","z",-1,-1,e,n,-i,s,o,5),this.setIndex(h),this.setAttribute("position",new Nt(u,3)),this.setAttribute("normal",new Nt(f,3)),this.setAttribute("uv",new Nt(p,2));function y(x,w,S,O,_,T,A,P,N,k,R){const E=T/N,D=A/k,$=T/2,I=A/2,L=P/2,U=N+1,V=k+1;let X=0,H=0;const J=new le;for(let ee=0;ee<V;ee++){const ne=ee*D-I;for(let ge=0;ge<U;ge++){const ye=ge*E-$;J[x]=ye*O,J[w]=ne*_,J[S]=L,u.push(J.x,J.y,J.z),J[x]=0,J[w]=0,J[S]=P>0?1:-1,f.push(J.x,J.y,J.z),p.push(ge/N),p.push(1-ee/k),X+=1}}for(let ee=0;ee<k;ee++)for(let ne=0;ne<N;ne++){const ge=m+ne+U*ee,ye=m+ne+U*(ee+1),ce=m+(ne+1)+U*(ee+1),we=m+(ne+1)+U*ee;h.push(ge,ye,we),h.push(ye,ce,we),H+=6}l.addGroup(v,H,R),v+=H,m+=X}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Vg(r){const e={};for(const n in r){e[n]={};for(const i in r[n]){const s=r[n][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=s.clone():Array.isArray(s)?e[n][i]=s.slice():e[n][i]=s}}return e}function Hs(r){const e={};for(let n=0;n<r.length;n++){const i=Vg(r[n]);for(const s in i)e[s]=i[s]}return e}function Mve(r){const e=[];for(let n=0;n<r.length;n++)e.push(r[n].clone());return e}function CG(r){const e=r.getRenderTarget();return e===null?r.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:dn.workingColorSpace}const Ab={clone:Vg,merge:Hs};var Ave=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,kve=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class io extends Xr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Ave,this.fragmentShader=kve,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Vg(e.uniforms),this.uniformsGroups=Mve(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const s in this.uniforms){const a=this.uniforms[s].value;a&&a.isTexture?n.uniforms[s]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[s]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[s]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[s]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[s]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[s]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[s]={type:"m4",value:a.toArray()}:n.uniforms[s]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const s in this.extensions)this.extensions[s]===!0&&(i[s]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class kb extends Li{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new dt,this.projectionMatrix=new dt,this.projectionMatrixInverse=new dt,this.coordinateSystem=tc}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const lu=new le,q6=new Xe,Z6=new Xe;class fn extends kb{constructor(e=50,n=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Ug*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Uf*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Ug*2*Math.atan(Math.tan(Uf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){lu.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(lu.x,lu.y).multiplyScalar(-e/lu.z),lu.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(lu.x,lu.y).multiplyScalar(-e/lu.z)}getViewSize(e,n){return this.getViewBounds(e,q6,Z6),n.subVectors(Z6,q6)}setViewOffset(e,n,i,s,o,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Uf*.5*this.fov)/this.zoom,i=2*n,s=this.aspect*i,o=-.5*s;const a=this.view;if(this.view!==null&&this.view.enabled){const h=a.fullWidth,u=a.fullHeight;o+=a.offsetX*s/h,n-=a.offsetY*i/u,s*=a.width/h,i*=a.height/u}const l=this.filmOffset;l!==0&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const dm=-90,fm=1;class TG extends Li{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new fn(dm,fm,e,n);s.layers=this.layers,this.add(s);const o=new fn(dm,fm,e,n);o.layers=this.layers,this.add(o);const a=new fn(dm,fm,e,n);a.layers=this.layers,this.add(a);const l=new fn(dm,fm,e,n);l.layers=this.layers,this.add(l);const h=new fn(dm,fm,e,n);h.layers=this.layers,this.add(h);const u=new fn(dm,fm,e,n);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,s,o,a,l,h]=n;for(const u of n)this.remove(u);if(e===tc)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(e===L1)i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of n)this.add(u),u.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,a,l,h,u,f]=this.children,p=e.getRenderTarget(),m=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const x=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(n,o),e.setRenderTarget(i,1,s),e.render(n,a),e.setRenderTarget(i,2,s),e.render(n,l),e.setRenderTarget(i,3,s),e.render(n,h),e.setRenderTarget(i,4,s),e.render(n,u),i.texture.generateMipmaps=x,e.setRenderTarget(i,5,s),e.render(n,f),e.setRenderTarget(p,m,v),e.xr.enabled=y,i.texture.needsPMREMUpdate=!0}}class Pb extends qn{constructor(e,n,i,s,o,a,l,h,u,f){e=e!==void 0?e:[],n=n!==void 0?n:wh,super(e,n,i,s,o,a,l,h,u,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class EG extends La{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];this.texture=new Pb(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:ir}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Rh(5,5,5),o=new io({name:"CubemapFromEquirect",uniforms:Vg(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Rs,blending:fh});o.uniforms.tEquirect.value=n;const a=new ln(s,o),l=n.minFilter;return n.minFilter===Ko&&(n.minFilter=ir),new TG(1,10,this).update(e,a),n.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,n,i,s){const o=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,i,s);e.setRenderTarget(o)}}const tM=new le,Pve=new le,Rve=new Ci;class wa{constructor(e=new le(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,s){return this.normal.set(e,n,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const s=tM.subVectors(i,n).cross(Pve.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(tM),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:n.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||Rve.getNormalMatrix(e),s=this.coplanarPoint(tM).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Gd=new ts,Lw=new le;class Rb{constructor(e=new wa,n=new wa,i=new wa,s=new wa,o=new wa,a=new wa){this.planes=[e,n,i,s,o,a]}set(e,n,i,s,o,a){const l=this.planes;return l[0].copy(e),l[1].copy(n),l[2].copy(i),l[3].copy(s),l[4].copy(o),l[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=tc){const i=this.planes,s=e.elements,o=s[0],a=s[1],l=s[2],h=s[3],u=s[4],f=s[5],p=s[6],m=s[7],v=s[8],y=s[9],x=s[10],w=s[11],S=s[12],O=s[13],_=s[14],T=s[15];if(i[0].setComponents(h-o,m-u,w-v,T-S).normalize(),i[1].setComponents(h+o,m+u,w+v,T+S).normalize(),i[2].setComponents(h+a,m+f,w+y,T+O).normalize(),i[3].setComponents(h-a,m-f,w-y,T-O).normalize(),i[4].setComponents(h-l,m-p,w-x,T-_).normalize(),n===tc)i[5].setComponents(h+l,m+p,w+x,T+_).normalize();else if(n===L1)i[5].setComponents(l,p,x,_).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Gd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Gd.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Gd)}intersectsSprite(e){return Gd.center.set(0,0,0),Gd.radius=.7071067811865476,Gd.applyMatrix4(e.matrixWorld),this.intersectsSphere(Gd)}intersectsSphere(e){const n=this.planes,i=e.center,s=-e.radius;for(let o=0;o<6;o++)if(n[o].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const s=n[i];if(Lw.x=s.normal.x>0?e.max.x:e.min.x,Lw.y=s.normal.y>0?e.max.y:e.min.y,Lw.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Lw)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function MG(){let r=null,e=!1,n=null,i=null;function s(o,a){n(o,a),i=r.requestAnimationFrame(s)}return{start:function(){e!==!0&&n!==null&&(i=r.requestAnimationFrame(s),e=!0)},stop:function(){r.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){n=o},setContext:function(o){r=o}}}function Ive(r){const e=new WeakMap;function n(l,h){const u=l.array,f=l.usage,p=u.byteLength,m=r.createBuffer();r.bindBuffer(h,m),r.bufferData(h,u,f),l.onUploadCallback();let v;if(u instanceof Float32Array)v=r.FLOAT;else if(u instanceof Uint16Array)l.isFloat16BufferAttribute?v=r.HALF_FLOAT:v=r.UNSIGNED_SHORT;else if(u instanceof Int16Array)v=r.SHORT;else if(u instanceof Uint32Array)v=r.UNSIGNED_INT;else if(u instanceof Int32Array)v=r.INT;else if(u instanceof Int8Array)v=r.BYTE;else if(u instanceof Uint8Array)v=r.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)v=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:m,type:v,bytesPerElement:u.BYTES_PER_ELEMENT,version:l.version,size:p}}function i(l,h,u){const f=h.array,p=h._updateRange,m=h.updateRanges;if(r.bindBuffer(u,l),p.count===-1&&m.length===0&&r.bufferSubData(u,0,f),m.length!==0){for(let v=0,y=m.length;v<y;v++){const x=m[v];r.bufferSubData(u,x.start*f.BYTES_PER_ELEMENT,f,x.start,x.count)}h.clearUpdateRanges()}p.count!==-1&&(r.bufferSubData(u,p.offset*f.BYTES_PER_ELEMENT,f,p.offset,p.count),p.count=-1),h.onUploadCallback()}function s(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function o(l){l.isInterleavedBufferAttribute&&(l=l.data);const h=e.get(l);h&&(r.deleteBuffer(h.buffer),e.delete(l))}function a(l,h){if(l.isGLBufferAttribute){const f=e.get(l);(!f||f.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}l.isInterleavedBufferAttribute&&(l=l.data);const u=e.get(l);if(u===void 0)e.set(l,n(l,h));else if(u.version<l.version){if(u.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(u.buffer,l,h),u.version=l.version}}return{get:s,remove:o,update:a}}class yd extends vi{constructor(e=1,n=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:s};const o=e/2,a=n/2,l=Math.floor(i),h=Math.floor(s),u=l+1,f=h+1,p=e/l,m=n/h,v=[],y=[],x=[],w=[];for(let S=0;S<f;S++){const O=S*m-a;for(let _=0;_<u;_++){const T=_*p-o;y.push(T,-O,0),x.push(0,0,1),w.push(_/l),w.push(1-S/h)}}for(let S=0;S<h;S++)for(let O=0;O<l;O++){const _=O+u*S,T=O+u*(S+1),A=O+1+u*(S+1),P=O+1+u*S;v.push(_,T,P),v.push(T,A,P)}this.setIndex(v),this.setAttribute("position",new Nt(y,3)),this.setAttribute("normal",new Nt(x,3)),this.setAttribute("uv",new Nt(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yd(e.width,e.height,e.widthSegments,e.heightSegments)}}var Nve=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Dve=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Lve=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Bve=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,$ve=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Uve=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Vve=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Fve=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,zve=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Xve=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,Wve=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Gve=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Hve=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Qve=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,jve=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Yve=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,qve=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Zve=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Kve=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Jve=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,eye=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,tye=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,iye=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,nye=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,rye=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,sye=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,oye=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,aye=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,lye=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,cye=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,hye="gl_FragColor = linearToOutputTexel( gl_FragColor );",uye=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,dye=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,fye=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,pye=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,mye=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,gye=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,vye=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,yye=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,bye=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,xye=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,wye=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,_ye=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Oye=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Sye=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Cye=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Tye=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Eye=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Mye=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Aye=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,kye=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Pye=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Rye=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Iye=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Nye=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Dye=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Lye=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Bye=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,$ye=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Uye=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Vye=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Fye=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,zye=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Xye=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Wye=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Gye=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Hye=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Qye=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,jye=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Yye=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,qye=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Zye=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Kye=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Jye=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,e1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,t1e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,i1e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,n1e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,r1e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,s1e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,o1e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,a1e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,l1e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,c1e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,h1e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,u1e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,d1e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,f1e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,p1e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,m1e=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,g1e=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,v1e=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,y1e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,b1e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,x1e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,w1e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,_1e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,O1e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,S1e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,C1e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,T1e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,E1e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,M1e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,A1e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,k1e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,P1e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,R1e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const I1e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,N1e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,D1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,L1e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,B1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,$1e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,U1e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,V1e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,F1e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,z1e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,X1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,W1e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,G1e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,H1e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Q1e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,j1e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Y1e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,q1e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Z1e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,K1e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,J1e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,ebe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,tbe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ibe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nbe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,rbe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sbe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,obe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,abe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,lbe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,cbe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hbe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ube=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dbe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Pi={alphahash_fragment:Nve,alphahash_pars_fragment:Dve,alphamap_fragment:Lve,alphamap_pars_fragment:Bve,alphatest_fragment:$ve,alphatest_pars_fragment:Uve,aomap_fragment:Vve,aomap_pars_fragment:Fve,batching_pars_vertex:zve,batching_vertex:Xve,begin_vertex:Wve,beginnormal_vertex:Gve,bsdfs:Hve,iridescence_fragment:Qve,bumpmap_pars_fragment:jve,clipping_planes_fragment:Yve,clipping_planes_pars_fragment:qve,clipping_planes_pars_vertex:Zve,clipping_planes_vertex:Kve,color_fragment:Jve,color_pars_fragment:eye,color_pars_vertex:tye,color_vertex:iye,common:nye,cube_uv_reflection_fragment:rye,defaultnormal_vertex:sye,displacementmap_pars_vertex:oye,displacementmap_vertex:aye,emissivemap_fragment:lye,emissivemap_pars_fragment:cye,colorspace_fragment:hye,colorspace_pars_fragment:uye,envmap_fragment:dye,envmap_common_pars_fragment:fye,envmap_pars_fragment:pye,envmap_pars_vertex:mye,envmap_physical_pars_fragment:Tye,envmap_vertex:gye,fog_vertex:vye,fog_pars_vertex:yye,fog_fragment:bye,fog_pars_fragment:xye,gradientmap_pars_fragment:wye,lightmap_pars_fragment:_ye,lights_lambert_fragment:Oye,lights_lambert_pars_fragment:Sye,lights_pars_begin:Cye,lights_toon_fragment:Eye,lights_toon_pars_fragment:Mye,lights_phong_fragment:Aye,lights_phong_pars_fragment:kye,lights_physical_fragment:Pye,lights_physical_pars_fragment:Rye,lights_fragment_begin:Iye,lights_fragment_maps:Nye,lights_fragment_end:Dye,logdepthbuf_fragment:Lye,logdepthbuf_pars_fragment:Bye,logdepthbuf_pars_vertex:$ye,logdepthbuf_vertex:Uye,map_fragment:Vye,map_pars_fragment:Fye,map_particle_fragment:zye,map_particle_pars_fragment:Xye,metalnessmap_fragment:Wye,metalnessmap_pars_fragment:Gye,morphinstance_vertex:Hye,morphcolor_vertex:Qye,morphnormal_vertex:jye,morphtarget_pars_vertex:Yye,morphtarget_vertex:qye,normal_fragment_begin:Zye,normal_fragment_maps:Kye,normal_pars_fragment:Jye,normal_pars_vertex:e1e,normal_vertex:t1e,normalmap_pars_fragment:i1e,clearcoat_normal_fragment_begin:n1e,clearcoat_normal_fragment_maps:r1e,clearcoat_pars_fragment:s1e,iridescence_pars_fragment:o1e,opaque_fragment:a1e,packing:l1e,premultiplied_alpha_fragment:c1e,project_vertex:h1e,dithering_fragment:u1e,dithering_pars_fragment:d1e,roughnessmap_fragment:f1e,roughnessmap_pars_fragment:p1e,shadowmap_pars_fragment:m1e,shadowmap_pars_vertex:g1e,shadowmap_vertex:v1e,shadowmask_pars_fragment:y1e,skinbase_vertex:b1e,skinning_pars_vertex:x1e,skinning_vertex:w1e,skinnormal_vertex:_1e,specularmap_fragment:O1e,specularmap_pars_fragment:S1e,tonemapping_fragment:C1e,tonemapping_pars_fragment:T1e,transmission_fragment:E1e,transmission_pars_fragment:M1e,uv_pars_fragment:A1e,uv_pars_vertex:k1e,uv_vertex:P1e,worldpos_vertex:R1e,background_vert:I1e,background_frag:N1e,backgroundCube_vert:D1e,backgroundCube_frag:L1e,cube_vert:B1e,cube_frag:$1e,depth_vert:U1e,depth_frag:V1e,distanceRGBA_vert:F1e,distanceRGBA_frag:z1e,equirect_vert:X1e,equirect_frag:W1e,linedashed_vert:G1e,linedashed_frag:H1e,meshbasic_vert:Q1e,meshbasic_frag:j1e,meshlambert_vert:Y1e,meshlambert_frag:q1e,meshmatcap_vert:Z1e,meshmatcap_frag:K1e,meshnormal_vert:J1e,meshnormal_frag:ebe,meshphong_vert:tbe,meshphong_frag:ibe,meshphysical_vert:nbe,meshphysical_frag:rbe,meshtoon_vert:sbe,meshtoon_frag:obe,points_vert:abe,points_frag:lbe,shadow_vert:cbe,shadow_frag:hbe,sprite_vert:ube,sprite_frag:dbe},ut={common:{diffuse:{value:new nt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ci},alphaMap:{value:null},alphaMapTransform:{value:new Ci},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ci}},envmap:{envMap:{value:null},envMapRotation:{value:new Ci},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ci}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ci}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ci},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ci},normalScale:{value:new Xe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ci},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ci}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ci}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ci}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new nt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new nt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ci},alphaTest:{value:0},uvTransform:{value:new Ci}},sprite:{diffuse:{value:new nt(16777215)},opacity:{value:1},center:{value:new Xe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ci},alphaMap:{value:null},alphaMapTransform:{value:new Ci},alphaTest:{value:0}}},_a={basic:{uniforms:Hs([ut.common,ut.specularmap,ut.envmap,ut.aomap,ut.lightmap,ut.fog]),vertexShader:Pi.meshbasic_vert,fragmentShader:Pi.meshbasic_frag},lambert:{uniforms:Hs([ut.common,ut.specularmap,ut.envmap,ut.aomap,ut.lightmap,ut.emissivemap,ut.bumpmap,ut.normalmap,ut.displacementmap,ut.fog,ut.lights,{emissive:{value:new nt(0)}}]),vertexShader:Pi.meshlambert_vert,fragmentShader:Pi.meshlambert_frag},phong:{uniforms:Hs([ut.common,ut.specularmap,ut.envmap,ut.aomap,ut.lightmap,ut.emissivemap,ut.bumpmap,ut.normalmap,ut.displacementmap,ut.fog,ut.lights,{emissive:{value:new nt(0)},specular:{value:new nt(1118481)},shininess:{value:30}}]),vertexShader:Pi.meshphong_vert,fragmentShader:Pi.meshphong_frag},standard:{uniforms:Hs([ut.common,ut.envmap,ut.aomap,ut.lightmap,ut.emissivemap,ut.bumpmap,ut.normalmap,ut.displacementmap,ut.roughnessmap,ut.metalnessmap,ut.fog,ut.lights,{emissive:{value:new nt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag},toon:{uniforms:Hs([ut.common,ut.aomap,ut.lightmap,ut.emissivemap,ut.bumpmap,ut.normalmap,ut.displacementmap,ut.gradientmap,ut.fog,ut.lights,{emissive:{value:new nt(0)}}]),vertexShader:Pi.meshtoon_vert,fragmentShader:Pi.meshtoon_frag},matcap:{uniforms:Hs([ut.common,ut.bumpmap,ut.normalmap,ut.displacementmap,ut.fog,{matcap:{value:null}}]),vertexShader:Pi.meshmatcap_vert,fragmentShader:Pi.meshmatcap_frag},points:{uniforms:Hs([ut.points,ut.fog]),vertexShader:Pi.points_vert,fragmentShader:Pi.points_frag},dashed:{uniforms:Hs([ut.common,ut.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pi.linedashed_vert,fragmentShader:Pi.linedashed_frag},depth:{uniforms:Hs([ut.common,ut.displacementmap]),vertexShader:Pi.depth_vert,fragmentShader:Pi.depth_frag},normal:{uniforms:Hs([ut.common,ut.bumpmap,ut.normalmap,ut.displacementmap,{opacity:{value:1}}]),vertexShader:Pi.meshnormal_vert,fragmentShader:Pi.meshnormal_frag},sprite:{uniforms:Hs([ut.sprite,ut.fog]),vertexShader:Pi.sprite_vert,fragmentShader:Pi.sprite_frag},background:{uniforms:{uvTransform:{value:new Ci},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pi.background_vert,fragmentShader:Pi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ci}},vertexShader:Pi.backgroundCube_vert,fragmentShader:Pi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pi.cube_vert,fragmentShader:Pi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pi.equirect_vert,fragmentShader:Pi.equirect_frag},distanceRGBA:{uniforms:Hs([ut.common,ut.displacementmap,{referencePosition:{value:new le},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pi.distanceRGBA_vert,fragmentShader:Pi.distanceRGBA_frag},shadow:{uniforms:Hs([ut.lights,ut.fog,{color:{value:new nt(0)},opacity:{value:1}}]),vertexShader:Pi.shadow_vert,fragmentShader:Pi.shadow_frag}};_a.physical={uniforms:Hs([_a.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ci},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ci},clearcoatNormalScale:{value:new Xe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ci},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ci},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ci},sheen:{value:0},sheenColor:{value:new nt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ci},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ci},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ci},transmissionSamplerSize:{value:new Xe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ci},attenuationDistance:{value:0},attenuationColor:{value:new nt(0)},specularColor:{value:new nt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ci},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ci},anisotropyVector:{value:new Xe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ci}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag};const Bw={r:0,b:0,g:0},Hd=new Vr,fbe=new dt;function pbe(r,e,n,i,s,o,a){const l=new nt(0);let h=o===!0?0:1,u,f,p=null,m=0,v=null;function y(O){let _=O.isScene===!0?O.background:null;return _&&_.isTexture&&(_=(O.backgroundBlurriness>0?n:e).get(_)),_}function x(O){let _=!1;const T=y(O);T===null?S(l,h):T&&T.isColor&&(S(T,1),_=!0);const A=r.xr.getEnvironmentBlendMode();A==="additive"?i.buffers.color.setClear(0,0,0,1,a):A==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,a),(r.autoClear||_)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil)}function w(O,_){const T=y(_);T&&(T.isCubeTexture||T.mapping===s0)?(f===void 0&&(f=new ln(new Rh(1,1,1),new io({name:"BackgroundCubeMaterial",uniforms:Vg(_a.backgroundCube.uniforms),vertexShader:_a.backgroundCube.vertexShader,fragmentShader:_a.backgroundCube.fragmentShader,side:Rs,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(A,P,N){this.matrixWorld.copyPosition(N.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(f)),Hd.copy(_.backgroundRotation),Hd.x*=-1,Hd.y*=-1,Hd.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&(Hd.y*=-1,Hd.z*=-1),f.material.uniforms.envMap.value=T,f.material.uniforms.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=_.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=_.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(fbe.makeRotationFromEuler(Hd)),f.material.toneMapped=dn.getTransfer(T.colorSpace)!==kn,(p!==T||m!==T.version||v!==r.toneMapping)&&(f.material.needsUpdate=!0,p=T,m=T.version,v=r.toneMapping),f.layers.enableAll(),O.unshift(f,f.geometry,f.material,0,0,null)):T&&T.isTexture&&(u===void 0&&(u=new ln(new yd(2,2),new io({name:"BackgroundMaterial",uniforms:Vg(_a.background.uniforms),vertexShader:_a.background.vertexShader,fragmentShader:_a.background.fragmentShader,side:dc,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(u)),u.material.uniforms.t2D.value=T,u.material.uniforms.backgroundIntensity.value=_.backgroundIntensity,u.material.toneMapped=dn.getTransfer(T.colorSpace)!==kn,T.matrixAutoUpdate===!0&&T.updateMatrix(),u.material.uniforms.uvTransform.value.copy(T.matrix),(p!==T||m!==T.version||v!==r.toneMapping)&&(u.material.needsUpdate=!0,p=T,m=T.version,v=r.toneMapping),u.layers.enableAll(),O.unshift(u,u.geometry,u.material,0,0,null))}function S(O,_){O.getRGB(Bw,CG(r)),i.buffers.color.setClear(Bw.r,Bw.g,Bw.b,_,a)}return{getClearColor:function(){return l},setClearColor:function(O,_=1){l.set(O),h=_,S(l,h)},getClearAlpha:function(){return h},setClearAlpha:function(O){h=O,S(l,h)},render:x,addToRenderList:w}}function mbe(r,e){const n=r.getParameter(r.MAX_VERTEX_ATTRIBS),i={},s=m(null);let o=s,a=!1;function l(E,D,$,I,L){let U=!1;const V=p(I,$,D);o!==V&&(o=V,u(o.object)),U=v(E,I,$,L),U&&y(E,I,$,L),L!==null&&e.update(L,r.ELEMENT_ARRAY_BUFFER),(U||a)&&(a=!1,T(E,D,$,I),L!==null&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.get(L).buffer))}function h(){return r.createVertexArray()}function u(E){return r.bindVertexArray(E)}function f(E){return r.deleteVertexArray(E)}function p(E,D,$){const I=$.wireframe===!0;let L=i[E.id];L===void 0&&(L={},i[E.id]=L);let U=L[D.id];U===void 0&&(U={},L[D.id]=U);let V=U[I];return V===void 0&&(V=m(h()),U[I]=V),V}function m(E){const D=[],$=[],I=[];for(let L=0;L<n;L++)D[L]=0,$[L]=0,I[L]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:D,enabledAttributes:$,attributeDivisors:I,object:E,attributes:{},index:null}}function v(E,D,$,I){const L=o.attributes,U=D.attributes;let V=0;const X=$.getAttributes();for(const H in X)if(X[H].location>=0){const ee=L[H];let ne=U[H];if(ne===void 0&&(H==="instanceMatrix"&&E.instanceMatrix&&(ne=E.instanceMatrix),H==="instanceColor"&&E.instanceColor&&(ne=E.instanceColor)),ee===void 0||ee.attribute!==ne||ne&&ee.data!==ne.data)return!0;V++}return o.attributesNum!==V||o.index!==I}function y(E,D,$,I){const L={},U=D.attributes;let V=0;const X=$.getAttributes();for(const H in X)if(X[H].location>=0){let ee=U[H];ee===void 0&&(H==="instanceMatrix"&&E.instanceMatrix&&(ee=E.instanceMatrix),H==="instanceColor"&&E.instanceColor&&(ee=E.instanceColor));const ne={};ne.attribute=ee,ee&&ee.data&&(ne.data=ee.data),L[H]=ne,V++}o.attributes=L,o.attributesNum=V,o.index=I}function x(){const E=o.newAttributes;for(let D=0,$=E.length;D<$;D++)E[D]=0}function w(E){S(E,0)}function S(E,D){const $=o.newAttributes,I=o.enabledAttributes,L=o.attributeDivisors;$[E]=1,I[E]===0&&(r.enableVertexAttribArray(E),I[E]=1),L[E]!==D&&(r.vertexAttribDivisor(E,D),L[E]=D)}function O(){const E=o.newAttributes,D=o.enabledAttributes;for(let $=0,I=D.length;$<I;$++)D[$]!==E[$]&&(r.disableVertexAttribArray($),D[$]=0)}function _(E,D,$,I,L,U,V){V===!0?r.vertexAttribIPointer(E,D,$,L,U):r.vertexAttribPointer(E,D,$,I,L,U)}function T(E,D,$,I){x();const L=I.attributes,U=$.getAttributes(),V=D.defaultAttributeValues;for(const X in U){const H=U[X];if(H.location>=0){let J=L[X];if(J===void 0&&(X==="instanceMatrix"&&E.instanceMatrix&&(J=E.instanceMatrix),X==="instanceColor"&&E.instanceColor&&(J=E.instanceColor)),J!==void 0){const ee=J.normalized,ne=J.itemSize,ge=e.get(J);if(ge===void 0)continue;const ye=ge.buffer,ce=ge.type,we=ge.bytesPerElement,be=ce===r.INT||ce===r.UNSIGNED_INT||J.gpuType===kI;if(J.isInterleavedBufferAttribute){const se=J.data,ae=se.stride,Q=J.offset;if(se.isInstancedInterleavedBuffer){for(let z=0;z<H.locationSize;z++)S(H.location+z,se.meshPerAttribute);E.isInstancedMesh!==!0&&I._maxInstanceCount===void 0&&(I._maxInstanceCount=se.meshPerAttribute*se.count)}else for(let z=0;z<H.locationSize;z++)w(H.location+z);r.bindBuffer(r.ARRAY_BUFFER,ye);for(let z=0;z<H.locationSize;z++)_(H.location+z,ne/H.locationSize,ce,ee,ae*we,(Q+ne/H.locationSize*z)*we,be)}else{if(J.isInstancedBufferAttribute){for(let se=0;se<H.locationSize;se++)S(H.location+se,J.meshPerAttribute);E.isInstancedMesh!==!0&&I._maxInstanceCount===void 0&&(I._maxInstanceCount=J.meshPerAttribute*J.count)}else for(let se=0;se<H.locationSize;se++)w(H.location+se);r.bindBuffer(r.ARRAY_BUFFER,ye);for(let se=0;se<H.locationSize;se++)_(H.location+se,ne/H.locationSize,ce,ee,ne*we,ne/H.locationSize*se*we,be)}}else if(V!==void 0){const ee=V[X];if(ee!==void 0)switch(ee.length){case 2:r.vertexAttrib2fv(H.location,ee);break;case 3:r.vertexAttrib3fv(H.location,ee);break;case 4:r.vertexAttrib4fv(H.location,ee);break;default:r.vertexAttrib1fv(H.location,ee)}}}}O()}function A(){k();for(const E in i){const D=i[E];for(const $ in D){const I=D[$];for(const L in I)f(I[L].object),delete I[L];delete D[$]}delete i[E]}}function P(E){if(i[E.id]===void 0)return;const D=i[E.id];for(const $ in D){const I=D[$];for(const L in I)f(I[L].object),delete I[L];delete D[$]}delete i[E.id]}function N(E){for(const D in i){const $=i[D];if($[E.id]===void 0)continue;const I=$[E.id];for(const L in I)f(I[L].object),delete I[L];delete $[E.id]}}function k(){R(),a=!0,o!==s&&(o=s,u(o.object))}function R(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:l,reset:k,resetDefaultState:R,dispose:A,releaseStatesOfGeometry:P,releaseStatesOfProgram:N,initAttributes:x,enableAttribute:w,disableUnusedAttributes:O}}function gbe(r,e,n){let i;function s(u){i=u}function o(u,f){r.drawArrays(i,u,f),n.update(f,i,1)}function a(u,f,p){p!==0&&(r.drawArraysInstanced(i,u,f,p),n.update(f,i,p))}function l(u,f,p){if(p===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let v=0;v<p;v++)this.render(u[v],f[v]);else{m.multiDrawArraysWEBGL(i,u,0,f,0,p);let v=0;for(let y=0;y<p;y++)v+=f[y];n.update(v,i,1)}}function h(u,f,p,m){if(p===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let y=0;y<u.length;y++)a(u[y],f[y],m[y]);else{v.multiDrawArraysInstancedWEBGL(i,u,0,f,0,m,0,p);let y=0;for(let x=0;x<p;x++)y+=f[x];for(let x=0;x<m.length;x++)n.update(y,i,m[x])}}this.setMode=s,this.render=o,this.renderInstances=a,this.renderMultiDraw=l,this.renderMultiDrawInstances=h}function vbe(r,e,n,i){let s;function o(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const P=e.get("EXT_texture_filter_anisotropic");s=r.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function a(P){return!(P!==_o&&i.convert(P)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(P){const N=P===o0&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(P!==bl&&i.convert(P)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_TYPE)&&P!==Ea&&!N)}function h(P){if(P==="highp"){if(r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision>0)return"highp";P="mediump"}return P==="mediump"&&r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=n.precision!==void 0?n.precision:"highp";const f=h(u);f!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",f,"instead."),u=f);const p=n.logarithmicDepthBuffer===!0,m=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),v=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=r.getParameter(r.MAX_TEXTURE_SIZE),x=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),w=r.getParameter(r.MAX_VERTEX_ATTRIBS),S=r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS),O=r.getParameter(r.MAX_VARYING_VECTORS),_=r.getParameter(r.MAX_FRAGMENT_UNIFORM_VECTORS),T=v>0,A=r.getParameter(r.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:h,textureFormatReadable:a,textureTypeReadable:l,precision:u,logarithmicDepthBuffer:p,maxTextures:m,maxVertexTextures:v,maxTextureSize:y,maxCubemapSize:x,maxAttributes:w,maxVertexUniforms:S,maxVaryings:O,maxFragmentUniforms:_,vertexTextures:T,maxSamples:A}}function ybe(r){const e=this;let n=null,i=0,s=!1,o=!1;const a=new wa,l=new Ci,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(p,m){const v=p.length!==0||m||i!==0||s;return s=m,i=p.length,v},this.beginShadows=function(){o=!0,f(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(p,m){n=f(p,m,0)},this.setState=function(p,m,v){const y=p.clippingPlanes,x=p.clipIntersection,w=p.clipShadows,S=r.get(p);if(!s||y===null||y.length===0||o&&!w)o?f(null):u();else{const O=o?0:i,_=O*4;let T=S.clippingState||null;h.value=T,T=f(y,m,_,v);for(let A=0;A!==_;++A)T[A]=n[A];S.clippingState=T,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=O}};function u(){h.value!==n&&(h.value=n,h.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function f(p,m,v,y){const x=p!==null?p.length:0;let w=null;if(x!==0){if(w=h.value,y!==!0||w===null){const S=v+x*4,O=m.matrixWorldInverse;l.getNormalMatrix(O),(w===null||w.length<S)&&(w=new Float32Array(S));for(let _=0,T=v;_!==x;++_,T+=4)a.copy(p[_]).applyMatrix4(O,l),a.normal.toArray(w,T),w[T+3]=a.constant}h.value=w,h.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,w}}function bbe(r){let e=new WeakMap;function n(a,l){return l===Bg?a.mapping=wh:l===k1&&(a.mapping=td),a}function i(a){if(a&&a.isTexture){const l=a.mapping;if(l===Bg||l===k1)if(e.has(a)){const h=e.get(a).texture;return n(h,a.mapping)}else{const h=a.image;if(h&&h.height>0){const u=new EG(h.height);return u.fromEquirectangularTexture(r,a),e.set(a,u),a.addEventListener("dispose",s),n(u.texture,a.mapping)}else return null}}return a}function s(a){const l=a.target;l.removeEventListener("dispose",s);const h=e.get(l);h!==void 0&&(e.delete(l),h.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}class Jo extends kb{constructor(e=-1,n=1,i=1,s=-1,o=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=s,this.near=o,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,s,o,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=i-e,a=i+e,l=s+n,h=s-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=u*this.view.offsetX,a=o+u*this.view.width,l-=f*this.view.offsetY,h=l-f*this.view.height}this.projectionMatrix.makeOrthographic(o,a,l,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const Qm=4,K6=[.125,.215,.35,.446,.526,.582],bf=20,iM=new Jo,J6=new nt;let nM=null,rM=0,sM=0,oM=!1;const uf=(1+Math.sqrt(5))/2,pm=1/uf,e$=[new le(-uf,pm,0),new le(uf,pm,0),new le(-pm,0,uf),new le(pm,0,uf),new le(0,uf,-pm),new le(0,uf,pm),new le(-1,1,-1),new le(1,1,-1),new le(-1,1,1),new le(1,1,1)];class IP{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,s=100){nM=this._renderer.getRenderTarget(),rM=this._renderer.getActiveCubeFace(),sM=this._renderer.getActiveMipmapLevel(),oM=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,s,o),n>0&&this._blur(o,0,0,n),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=n$(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=i$(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(nM,rM,sM),this._renderer.xr.enabled=oM,e.scissorTest=!1,$w(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===wh||e.mapping===td?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),nM=this._renderer.getRenderTarget(),rM=this._renderer.getActiveCubeFace(),sM=this._renderer.getActiveMipmapLevel(),oM=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:ir,minFilter:ir,generateMipmaps:!1,type:o0,format:_o,colorSpace:ns,depthBuffer:!1},s=t$(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=t$(e,n,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=xbe(o)),this._blurMaterial=wbe(o,e,n)}return s}_compileMaterial(e){const n=new ln(this._lodPlanes[0],e);this._renderer.compile(n,iM)}_sceneToCubeUV(e,n,i,s){const l=new fn(90,1,n,i),h=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],f=this._renderer,p=f.autoClear,m=f.toneMapping;f.getClearColor(J6),f.toneMapping=ph,f.autoClear=!1;const v=new vs({name:"PMREM.Background",side:Rs,depthWrite:!1,depthTest:!1}),y=new ln(new Rh,v);let x=!1;const w=e.background;w?w.isColor&&(v.color.copy(w),e.background=null,x=!0):(v.color.copy(J6),x=!0);for(let S=0;S<6;S++){const O=S%3;O===0?(l.up.set(0,h[S],0),l.lookAt(u[S],0,0)):O===1?(l.up.set(0,0,h[S]),l.lookAt(0,u[S],0)):(l.up.set(0,h[S],0),l.lookAt(0,0,u[S]));const _=this._cubeSize;$w(s,O*_,S>2?_:0,_,_),f.setRenderTarget(s),x&&f.render(y,l),f.render(e,l)}y.geometry.dispose(),y.material.dispose(),f.toneMapping=m,f.autoClear=p,e.background=w}_textureToCubeUV(e,n){const i=this._renderer,s=e.mapping===wh||e.mapping===td;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=n$()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=i$());const o=s?this._cubemapMaterial:this._equirectMaterial,a=new ln(this._lodPlanes[0],o),l=o.uniforms;l.envMap.value=e;const h=this._cubeSize;$w(n,0,0,3*h,2*h),i.setRenderTarget(n),i.render(a,iM)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const s=this._lodPlanes.length;for(let o=1;o<s;o++){const a=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),l=e$[(s-o-1)%e$.length];this._blur(e,o-1,o,a,l)}n.autoClear=i}_blur(e,n,i,s,o){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,i,s,"latitudinal",o),this._halfBlur(a,e,i,i,s,"longitudinal",o)}_halfBlur(e,n,i,s,o,a,l){const h=this._renderer,u=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,p=new ln(this._lodPlanes[s],u),m=u.uniforms,v=this._sizeLods[i]-1,y=isFinite(o)?Math.PI/(2*v):2*Math.PI/(2*bf-1),x=o/y,w=isFinite(o)?1+Math.floor(f*x):bf;w>bf&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${bf}`);const S=[];let O=0;for(let N=0;N<bf;++N){const k=N/x,R=Math.exp(-k*k/2);S.push(R),N===0?O+=R:N<w&&(O+=2*R)}for(let N=0;N<S.length;N++)S[N]=S[N]/O;m.envMap.value=e.texture,m.samples.value=w,m.weights.value=S,m.latitudinal.value=a==="latitudinal",l&&(m.poleAxis.value=l);const{_lodMax:_}=this;m.dTheta.value=y,m.mipInt.value=_-i;const T=this._sizeLods[s],A=3*T*(s>_-Qm?s-_+Qm:0),P=4*(this._cubeSize-T);$w(n,A,P,3*T,2*T),h.setRenderTarget(n),h.render(p,iM)}}function xbe(r){const e=[],n=[],i=[];let s=r;const o=r-Qm+1+K6.length;for(let a=0;a<o;a++){const l=Math.pow(2,s);n.push(l);let h=1/l;a>r-Qm?h=K6[a-r+Qm-1]:a===0&&(h=0),i.push(h);const u=1/(l-2),f=-u,p=1+u,m=[f,f,p,f,p,p,f,f,p,p,f,p],v=6,y=6,x=3,w=2,S=1,O=new Float32Array(x*y*v),_=new Float32Array(w*y*v),T=new Float32Array(S*y*v);for(let P=0;P<v;P++){const N=P%3*2/3-1,k=P>2?0:-1,R=[N,k,0,N+2/3,k,0,N+2/3,k+1,0,N,k,0,N+2/3,k+1,0,N,k+1,0];O.set(R,x*y*P),_.set(m,w*y*P);const E=[P,P,P,P,P,P];T.set(E,S*y*P)}const A=new vi;A.setAttribute("position",new Di(O,x)),A.setAttribute("uv",new Di(_,w)),A.setAttribute("faceIndex",new Di(T,S)),e.push(A),s>Qm&&s--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function t$(r,e,n){const i=new La(r,e,n);return i.texture.mapping=s0,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function $w(r,e,n,i,s){r.viewport.set(e,n,i,s),r.scissor.set(e,n,i,s)}function wbe(r,e,n){const i=new Float32Array(bf),s=new le(0,1,0);return new io({name:"SphericalGaussianBlur",defines:{n:bf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:XI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:fh,depthTest:!1,depthWrite:!1})}function i$(){return new io({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:XI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:fh,depthTest:!1,depthWrite:!1})}function n$(){return new io({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:XI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:fh,depthTest:!1,depthWrite:!1})}function XI(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function _be(r){let e=new WeakMap,n=null;function i(l){if(l&&l.isTexture){const h=l.mapping,u=h===Bg||h===k1,f=h===wh||h===td;if(u||f){let p=e.get(l);const m=p!==void 0?p.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==m)return n===null&&(n=new IP(r)),p=u?n.fromEquirectangular(l,p):n.fromCubemap(l,p),p.texture.pmremVersion=l.pmremVersion,e.set(l,p),p.texture;if(p!==void 0)return p.texture;{const v=l.image;return u&&v&&v.height>0||f&&v&&s(v)?(n===null&&(n=new IP(r)),p=u?n.fromEquirectangular(l):n.fromCubemap(l),p.texture.pmremVersion=l.pmremVersion,e.set(l,p),l.addEventListener("dispose",o),p.texture):null}}}return l}function s(l){let h=0;const u=6;for(let f=0;f<u;f++)l[f]!==void 0&&h++;return h===u}function o(l){const h=l.target;h.removeEventListener("dispose",o);const u=e.get(h);u!==void 0&&(e.delete(h),u.dispose())}function a(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:a}}function Obe(r){const e={};function n(i){if(e[i]!==void 0)return e[i];let s;switch(i){case"WEBGL_depth_texture":s=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=r.getExtension(i)}return e[i]=s,s}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const s=n(i);return s===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),s}}}function Sbe(r,e,n,i){const s={},o=new WeakMap;function a(p){const m=p.target;m.index!==null&&e.remove(m.index);for(const y in m.attributes)e.remove(m.attributes[y]);for(const y in m.morphAttributes){const x=m.morphAttributes[y];for(let w=0,S=x.length;w<S;w++)e.remove(x[w])}m.removeEventListener("dispose",a),delete s[m.id];const v=o.get(m);v&&(e.remove(v),o.delete(m)),i.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,n.memory.geometries--}function l(p,m){return s[m.id]===!0||(m.addEventListener("dispose",a),s[m.id]=!0,n.memory.geometries++),m}function h(p){const m=p.attributes;for(const y in m)e.update(m[y],r.ARRAY_BUFFER);const v=p.morphAttributes;for(const y in v){const x=v[y];for(let w=0,S=x.length;w<S;w++)e.update(x[w],r.ARRAY_BUFFER)}}function u(p){const m=[],v=p.index,y=p.attributes.position;let x=0;if(v!==null){const O=v.array;x=v.version;for(let _=0,T=O.length;_<T;_+=3){const A=O[_+0],P=O[_+1],N=O[_+2];m.push(A,P,P,N,N,A)}}else if(y!==void 0){const O=y.array;x=y.version;for(let _=0,T=O.length/3-1;_<T;_+=3){const A=_+0,P=_+1,N=_+2;m.push(A,P,P,N,N,A)}}else return;const w=new(bG(m)?zI:JC)(m,1);w.version=x;const S=o.get(p);S&&e.remove(S),o.set(p,w)}function f(p){const m=o.get(p);if(m){const v=p.index;v!==null&&m.version<v.version&&u(p)}else u(p);return o.get(p)}return{get:l,update:h,getWireframeAttribute:f}}function Cbe(r,e,n){let i;function s(m){i=m}let o,a;function l(m){o=m.type,a=m.bytesPerElement}function h(m,v){r.drawElements(i,v,o,m*a),n.update(v,i,1)}function u(m,v,y){y!==0&&(r.drawElementsInstanced(i,v,o,m*a,y),n.update(v,i,y))}function f(m,v,y){if(y===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let w=0;w<y;w++)this.render(m[w]/a,v[w]);else{x.multiDrawElementsWEBGL(i,v,0,o,m,0,y);let w=0;for(let S=0;S<y;S++)w+=v[S];n.update(w,i,1)}}function p(m,v,y,x){if(y===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let S=0;S<m.length;S++)u(m[S]/a,v[S],x[S]);else{w.multiDrawElementsInstancedWEBGL(i,v,0,o,m,0,x,0,y);let S=0;for(let O=0;O<y;O++)S+=v[O];for(let O=0;O<x.length;O++)n.update(S,i,x[O])}}this.setMode=s,this.setIndex=l,this.render=h,this.renderInstances=u,this.renderMultiDraw=f,this.renderMultiDrawInstances=p}function Tbe(r){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,a,l){switch(n.calls++,a){case r.TRIANGLES:n.triangles+=l*(o/3);break;case r.LINES:n.lines+=l*(o/2);break;case r.LINE_STRIP:n.lines+=l*(o-1);break;case r.LINE_LOOP:n.lines+=l*o;break;case r.POINTS:n.points+=l*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function s(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:s,update:i}}function Ebe(r,e,n){const i=new WeakMap,s=new Ni;function o(a,l,h){const u=a.morphTargetInfluences,f=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,p=f!==void 0?f.length:0;let m=i.get(l);if(m===void 0||m.count!==p){let E=function(){k.dispose(),i.delete(l),l.removeEventListener("dispose",E)};var v=E;m!==void 0&&m.texture.dispose();const y=l.morphAttributes.position!==void 0,x=l.morphAttributes.normal!==void 0,w=l.morphAttributes.color!==void 0,S=l.morphAttributes.position||[],O=l.morphAttributes.normal||[],_=l.morphAttributes.color||[];let T=0;y===!0&&(T=1),x===!0&&(T=2),w===!0&&(T=3);let A=l.attributes.position.count*T,P=1;A>e.maxTextureSize&&(P=Math.ceil(A/e.maxTextureSize),A=e.maxTextureSize);const N=new Float32Array(A*P*4*p),k=new ZC(N,A,P,p);k.type=Ea,k.needsUpdate=!0;const R=T*4;for(let D=0;D<p;D++){const $=S[D],I=O[D],L=_[D],U=A*P*4*D;for(let V=0;V<$.count;V++){const X=V*R;y===!0&&(s.fromBufferAttribute($,V),N[U+X+0]=s.x,N[U+X+1]=s.y,N[U+X+2]=s.z,N[U+X+3]=0),x===!0&&(s.fromBufferAttribute(I,V),N[U+X+4]=s.x,N[U+X+5]=s.y,N[U+X+6]=s.z,N[U+X+7]=0),w===!0&&(s.fromBufferAttribute(L,V),N[U+X+8]=s.x,N[U+X+9]=s.y,N[U+X+10]=s.z,N[U+X+11]=L.itemSize===4?s.w:1)}}m={count:p,texture:k,size:new Xe(A,P)},i.set(l,m),l.addEventListener("dispose",E)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)h.getUniforms().setValue(r,"morphTexture",a.morphTexture,n);else{let y=0;for(let w=0;w<u.length;w++)y+=u[w];const x=l.morphTargetsRelative?1:1-y;h.getUniforms().setValue(r,"morphTargetBaseInfluence",x),h.getUniforms().setValue(r,"morphTargetInfluences",u)}h.getUniforms().setValue(r,"morphTargetsTexture",m.texture,n),h.getUniforms().setValue(r,"morphTargetsTextureSize",m.size)}return{update:o}}function Mbe(r,e,n,i){let s=new WeakMap;function o(h){const u=i.render.frame,f=h.geometry,p=e.get(h,f);if(s.get(p)!==u&&(e.update(p),s.set(p,u)),h.isInstancedMesh&&(h.hasEventListener("dispose",l)===!1&&h.addEventListener("dispose",l),s.get(h)!==u&&(n.update(h.instanceMatrix,r.ARRAY_BUFFER),h.instanceColor!==null&&n.update(h.instanceColor,r.ARRAY_BUFFER),s.set(h,u))),h.isSkinnedMesh){const m=h.skeleton;s.get(m)!==u&&(m.update(),s.set(m,u))}return p}function a(){s=new WeakMap}function l(h){const u=h.target;u.removeEventListener("dispose",l),n.remove(u.instanceMatrix),u.instanceColor!==null&&n.remove(u.instanceColor)}return{update:o,dispose:a}}class WI extends qn{constructor(e,n,i,s,o,a,l,h,u,f){if(f=f!==void 0?f:$f,f!==$f&&f!==$g)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&f===$f&&(i=tp),i===void 0&&f===$g&&(i=a0),super(null,s,o,a,l,h,f,i,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=l!==void 0?l:Er,this.minFilter=h!==void 0?h:Er,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}const AG=new qn,kG=new WI(1,1);kG.compareFunction=UI;const PG=new ZC,RG=new FI,IG=new Pb,r$=[],s$=[],o$=new Float32Array(16),a$=new Float32Array(9),l$=new Float32Array(4);function l0(r,e,n){const i=r[0];if(i<=0||i>0)return r;const s=e*n;let o=r$[s];if(o===void 0&&(o=new Float32Array(s),r$[s]=o),e!==0){i.toArray(o,0);for(let a=1,l=0;a!==e;++a)l+=n,r[a].toArray(o,l)}return o}function Wr(r,e){if(r.length!==e.length)return!1;for(let n=0,i=r.length;n<i;n++)if(r[n]!==e[n])return!1;return!0}function Gr(r,e){for(let n=0,i=e.length;n<i;n++)r[n]=e[n]}function e2(r,e){let n=s$[e];n===void 0&&(n=new Int32Array(e),s$[e]=n);for(let i=0;i!==e;++i)n[i]=r.allocateTextureUnit();return n}function Abe(r,e){const n=this.cache;n[0]!==e&&(r.uniform1f(this.addr,e),n[0]=e)}function kbe(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Wr(n,e))return;r.uniform2fv(this.addr,e),Gr(n,e)}}function Pbe(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Wr(n,e))return;r.uniform3fv(this.addr,e),Gr(n,e)}}function Rbe(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Wr(n,e))return;r.uniform4fv(this.addr,e),Gr(n,e)}}function Ibe(r,e){const n=this.cache,i=e.elements;if(i===void 0){if(Wr(n,e))return;r.uniformMatrix2fv(this.addr,!1,e),Gr(n,e)}else{if(Wr(n,i))return;l$.set(i),r.uniformMatrix2fv(this.addr,!1,l$),Gr(n,i)}}function Nbe(r,e){const n=this.cache,i=e.elements;if(i===void 0){if(Wr(n,e))return;r.uniformMatrix3fv(this.addr,!1,e),Gr(n,e)}else{if(Wr(n,i))return;a$.set(i),r.uniformMatrix3fv(this.addr,!1,a$),Gr(n,i)}}function Dbe(r,e){const n=this.cache,i=e.elements;if(i===void 0){if(Wr(n,e))return;r.uniformMatrix4fv(this.addr,!1,e),Gr(n,e)}else{if(Wr(n,i))return;o$.set(i),r.uniformMatrix4fv(this.addr,!1,o$),Gr(n,i)}}function Lbe(r,e){const n=this.cache;n[0]!==e&&(r.uniform1i(this.addr,e),n[0]=e)}function Bbe(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Wr(n,e))return;r.uniform2iv(this.addr,e),Gr(n,e)}}function $be(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Wr(n,e))return;r.uniform3iv(this.addr,e),Gr(n,e)}}function Ube(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Wr(n,e))return;r.uniform4iv(this.addr,e),Gr(n,e)}}function Vbe(r,e){const n=this.cache;n[0]!==e&&(r.uniform1ui(this.addr,e),n[0]=e)}function Fbe(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Wr(n,e))return;r.uniform2uiv(this.addr,e),Gr(n,e)}}function zbe(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Wr(n,e))return;r.uniform3uiv(this.addr,e),Gr(n,e)}}function Xbe(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Wr(n,e))return;r.uniform4uiv(this.addr,e),Gr(n,e)}}function Wbe(r,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(r.uniform1i(this.addr,s),i[0]=s);const o=this.type===r.SAMPLER_2D_SHADOW?kG:AG;n.setTexture2D(e||o,s)}function Gbe(r,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(r.uniform1i(this.addr,s),i[0]=s),n.setTexture3D(e||RG,s)}function Hbe(r,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(r.uniform1i(this.addr,s),i[0]=s),n.setTextureCube(e||IG,s)}function Qbe(r,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(r.uniform1i(this.addr,s),i[0]=s),n.setTexture2DArray(e||PG,s)}function jbe(r){switch(r){case 5126:return Abe;case 35664:return kbe;case 35665:return Pbe;case 35666:return Rbe;case 35674:return Ibe;case 35675:return Nbe;case 35676:return Dbe;case 5124:case 35670:return Lbe;case 35667:case 35671:return Bbe;case 35668:case 35672:return $be;case 35669:case 35673:return Ube;case 5125:return Vbe;case 36294:return Fbe;case 36295:return zbe;case 36296:return Xbe;case 35678:case 36198:case 36298:case 36306:case 35682:return Wbe;case 35679:case 36299:case 36307:return Gbe;case 35680:case 36300:case 36308:case 36293:return Hbe;case 36289:case 36303:case 36311:case 36292:return Qbe}}function Ybe(r,e){r.uniform1fv(this.addr,e)}function qbe(r,e){const n=l0(e,this.size,2);r.uniform2fv(this.addr,n)}function Zbe(r,e){const n=l0(e,this.size,3);r.uniform3fv(this.addr,n)}function Kbe(r,e){const n=l0(e,this.size,4);r.uniform4fv(this.addr,n)}function Jbe(r,e){const n=l0(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,n)}function exe(r,e){const n=l0(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,n)}function txe(r,e){const n=l0(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,n)}function ixe(r,e){r.uniform1iv(this.addr,e)}function nxe(r,e){r.uniform2iv(this.addr,e)}function rxe(r,e){r.uniform3iv(this.addr,e)}function sxe(r,e){r.uniform4iv(this.addr,e)}function oxe(r,e){r.uniform1uiv(this.addr,e)}function axe(r,e){r.uniform2uiv(this.addr,e)}function lxe(r,e){r.uniform3uiv(this.addr,e)}function cxe(r,e){r.uniform4uiv(this.addr,e)}function hxe(r,e,n){const i=this.cache,s=e.length,o=e2(n,s);Wr(i,o)||(r.uniform1iv(this.addr,o),Gr(i,o));for(let a=0;a!==s;++a)n.setTexture2D(e[a]||AG,o[a])}function uxe(r,e,n){const i=this.cache,s=e.length,o=e2(n,s);Wr(i,o)||(r.uniform1iv(this.addr,o),Gr(i,o));for(let a=0;a!==s;++a)n.setTexture3D(e[a]||RG,o[a])}function dxe(r,e,n){const i=this.cache,s=e.length,o=e2(n,s);Wr(i,o)||(r.uniform1iv(this.addr,o),Gr(i,o));for(let a=0;a!==s;++a)n.setTextureCube(e[a]||IG,o[a])}function fxe(r,e,n){const i=this.cache,s=e.length,o=e2(n,s);Wr(i,o)||(r.uniform1iv(this.addr,o),Gr(i,o));for(let a=0;a!==s;++a)n.setTexture2DArray(e[a]||PG,o[a])}function pxe(r){switch(r){case 5126:return Ybe;case 35664:return qbe;case 35665:return Zbe;case 35666:return Kbe;case 35674:return Jbe;case 35675:return exe;case 35676:return txe;case 5124:case 35670:return ixe;case 35667:case 35671:return nxe;case 35668:case 35672:return rxe;case 35669:case 35673:return sxe;case 5125:return oxe;case 36294:return axe;case 36295:return lxe;case 36296:return cxe;case 35678:case 36198:case 36298:case 36306:case 35682:return hxe;case 35679:case 36299:case 36307:return uxe;case 35680:case 36300:case 36308:case 36293:return dxe;case 36289:case 36303:case 36311:case 36292:return fxe}}class mxe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=jbe(n.type)}}class gxe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=pxe(n.type)}}class vxe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const s=this.seq;for(let o=0,a=s.length;o!==a;++o){const l=s[o];l.setValue(e,n[l.id],i)}}}const aM=/(\w+)(\])?(\[|\.)?/g;function c$(r,e){r.seq.push(e),r.map[e.id]=e}function yxe(r,e,n){const i=r.name,s=i.length;for(aM.lastIndex=0;;){const o=aM.exec(i),a=aM.lastIndex;let l=o[1];const h=o[2]==="]",u=o[3];if(h&&(l=l|0),u===void 0||u==="["&&a+2===s){c$(n,u===void 0?new mxe(l,r,e):new gxe(l,r,e));break}else{let p=n.map[l];p===void 0&&(p=new vxe(l),c$(n,p)),n=p}}}class RO{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){const o=e.getActiveUniform(n,s),a=e.getUniformLocation(n,o.name);yxe(o,a,this)}}setValue(e,n,i,s){const o=this.map[n];o!==void 0&&o.setValue(e,i,s)}setOptional(e,n,i){const s=n[i];s!==void 0&&this.setValue(e,i,s)}static upload(e,n,i,s){for(let o=0,a=n.length;o!==a;++o){const l=n[o],h=i[l.id];h.needsUpdate!==!1&&l.setValue(e,h.value,s)}}static seqWithValue(e,n){const i=[];for(let s=0,o=e.length;s!==o;++s){const a=e[s];a.id in n&&i.push(a)}return i}}function h$(r,e,n){const i=r.createShader(e);return r.shaderSource(i,n),r.compileShader(i),i}const bxe=37297;let xxe=0;function wxe(r,e){const n=r.split(`
`),i=[],s=Math.max(e-6,0),o=Math.min(e+6,n.length);for(let a=s;a<o;a++){const l=a+1;i.push(`${l===e?">":" "} ${l}: ${n[a]}`)}return i.join(`
`)}function _xe(r){const e=dn.getPrimaries(dn.workingColorSpace),n=dn.getPrimaries(r);let i;switch(e===n?i="":e===N1&&n===I1?i="LinearDisplayP3ToLinearSRGB":e===I1&&n===N1&&(i="LinearSRGBToLinearDisplayP3"),r){case ns:case Mb:return[i,"LinearTransferOETF"];case Jr:case qC:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",r),[i,"LinearTransferOETF"]}}function u$(r,e,n){const i=r.getShaderParameter(e,r.COMPILE_STATUS),s=r.getShaderInfoLog(e).trim();if(i&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const a=parseInt(o[1]);return n.toUpperCase()+`

`+s+`

`+wxe(r.getShaderSource(e),a)}else return s}function Oxe(r,e){const n=_xe(e);return`vec4 ${r}( vec4 value ) { return ${n[0]}( ${n[1]}( value ) ); }`}function Sxe(r,e){let n;switch(e){case XW:n="Linear";break;case WW:n="Reinhard";break;case GW:n="OptimizedCineon";break;case MI:n="ACESFilmic";break;case QW:n="AgX";break;case jW:n="Neutral";break;case HW:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+r+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Cxe(r){return[r.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",r.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter($y).join(`
`)}function Txe(r){const e=[];for(const n in r){const i=r[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function Exe(r,e){const n={},i=r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const o=r.getActiveAttrib(e,s),a=o.name;let l=1;o.type===r.FLOAT_MAT2&&(l=2),o.type===r.FLOAT_MAT3&&(l=3),o.type===r.FLOAT_MAT4&&(l=4),n[a]={type:o.type,location:r.getAttribLocation(e,a),locationSize:l}}return n}function $y(r){return r!==""}function d$(r,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function f$(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Mxe=/^[ \t]*#include +<([\w\d./]+)>/gm;function NP(r){return r.replace(Mxe,kxe)}const Axe=new Map;function kxe(r,e){let n=Pi[e];if(n===void 0){const i=Axe.get(e);if(i!==void 0)n=Pi[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return NP(n)}const Pxe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function p$(r){return r.replace(Pxe,Rxe)}function Rxe(r,e,n,i){let s="";for(let o=parseInt(e);o<parseInt(n);o++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function m$(r){let e=`precision ${r.precision} float;
	precision ${r.precision} int;
	precision ${r.precision} sampler2D;
	precision ${r.precision} samplerCube;
	precision ${r.precision} sampler3D;
	precision ${r.precision} sampler2DArray;
	precision ${r.precision} sampler2DShadow;
	precision ${r.precision} samplerCubeShadow;
	precision ${r.precision} sampler2DArrayShadow;
	precision ${r.precision} isampler2D;
	precision ${r.precision} isampler3D;
	precision ${r.precision} isamplerCube;
	precision ${r.precision} isampler2DArray;
	precision ${r.precision} usampler2D;
	precision ${r.precision} usampler3D;
	precision ${r.precision} usamplerCube;
	precision ${r.precision} usampler2DArray;
	`;return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Ixe(r){let e="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===EI?e="SHADOWMAP_TYPE_PCF":r.shadowMapType===QC?e="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===Ql&&(e="SHADOWMAP_TYPE_VSM"),e}function Nxe(r){let e="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case wh:case td:e="ENVMAP_TYPE_CUBE";break;case s0:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Dxe(r){let e="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case td:e="ENVMAP_MODE_REFRACTION";break}return e}function Lxe(r){let e="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case Tb:e="ENVMAP_BLENDING_MULTIPLY";break;case FW:e="ENVMAP_BLENDING_MIX";break;case zW:e="ENVMAP_BLENDING_ADD";break}return e}function Bxe(r){const e=r.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function $xe(r,e,n,i){const s=r.getContext(),o=n.defines;let a=n.vertexShader,l=n.fragmentShader;const h=Ixe(n),u=Nxe(n),f=Dxe(n),p=Lxe(n),m=Bxe(n),v=Cxe(n),y=Txe(o),x=s.createProgram();let w,S,O=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(w=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y].filter($y).join(`
`),w.length>0&&(w+=`
`),S=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y].filter($y).join(`
`),S.length>0&&(S+=`
`)):(w=[m$(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter($y).join(`
`),S=[m$(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+f:"",n.envMap?"#define "+p:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==ph?"#define TONE_MAPPING":"",n.toneMapping!==ph?Pi.tonemapping_pars_fragment:"",n.toneMapping!==ph?Sxe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Pi.colorspace_pars_fragment,Oxe("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter($y).join(`
`)),a=NP(a),a=d$(a,n),a=f$(a,n),l=NP(l),l=d$(l,n),l=f$(l,n),a=p$(a),l=p$(l),n.isRawShaderMaterial!==!0&&(O=`#version 300 es
`,w=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,S=["#define varying in",n.glslVersion===RP?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===RP?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const _=O+w+a,T=O+S+l,A=h$(s,s.VERTEX_SHADER,_),P=h$(s,s.FRAGMENT_SHADER,T);s.attachShader(x,A),s.attachShader(x,P),n.index0AttributeName!==void 0?s.bindAttribLocation(x,0,n.index0AttributeName):n.morphTargets===!0&&s.bindAttribLocation(x,0,"position"),s.linkProgram(x);function N(D){if(r.debug.checkShaderErrors){const $=s.getProgramInfoLog(x).trim(),I=s.getShaderInfoLog(A).trim(),L=s.getShaderInfoLog(P).trim();let U=!0,V=!0;if(s.getProgramParameter(x,s.LINK_STATUS)===!1)if(U=!1,typeof r.debug.onShaderError=="function")r.debug.onShaderError(s,x,A,P);else{const X=u$(s,A,"vertex"),H=u$(s,P,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(x,s.VALIDATE_STATUS)+`

Material Name: `+D.name+`
Material Type: `+D.type+`

Program Info Log: `+$+`
`+X+`
`+H)}else $!==""?console.warn("THREE.WebGLProgram: Program Info Log:",$):(I===""||L==="")&&(V=!1);V&&(D.diagnostics={runnable:U,programLog:$,vertexShader:{log:I,prefix:w},fragmentShader:{log:L,prefix:S}})}s.deleteShader(A),s.deleteShader(P),k=new RO(s,x),R=Exe(s,x)}let k;this.getUniforms=function(){return k===void 0&&N(this),k};let R;this.getAttributes=function(){return R===void 0&&N(this),R};let E=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return E===!1&&(E=s.getProgramParameter(x,bxe)),E},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(x),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=xxe++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=A,this.fragmentShader=P,this}let Uxe=0;class Vxe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,s=this._getShaderStage(n),o=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(s)===!1&&(a.add(s),s.usedTimes++),a.has(o)===!1&&(a.add(o),o.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new Fxe(e),n.set(e,i)),i}}class Fxe{constructor(e){this.id=Uxe++,this.code=e,this.usedTimes=0}}function zxe(r,e,n,i,s,o,a){const l=new KC,h=new Vxe,u=new Set,f=[],p=s.logarithmicDepthBuffer,m=s.vertexTextures;let v=s.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(R){return u.add(R),R===0?"uv":`uv${R}`}function w(R,E,D,$,I){const L=$.fog,U=I.geometry,V=R.isMeshStandardMaterial?$.environment:null,X=(R.isMeshStandardMaterial?n:e).get(R.envMap||V),H=X&&X.mapping===s0?X.image.height:null,J=y[R.type];R.precision!==null&&(v=s.getMaxPrecision(R.precision),v!==R.precision&&console.warn("THREE.WebGLProgram.getParameters:",R.precision,"not supported, using",v,"instead."));const ee=U.morphAttributes.position||U.morphAttributes.normal||U.morphAttributes.color,ne=ee!==void 0?ee.length:0;let ge=0;U.morphAttributes.position!==void 0&&(ge=1),U.morphAttributes.normal!==void 0&&(ge=2),U.morphAttributes.color!==void 0&&(ge=3);let ye,ce,we,be;if(J){const Ii=_a[J];ye=Ii.vertexShader,ce=Ii.fragmentShader}else ye=R.vertexShader,ce=R.fragmentShader,h.update(R),we=h.getVertexShaderID(R),be=h.getFragmentShaderID(R);const se=r.getRenderTarget(),ae=I.isInstancedMesh===!0,Q=I.isBatchedMesh===!0,z=!!R.map,j=!!R.matcap,te=!!X,W=!!R.aoMap,Z=!!R.lightMap,he=!!R.bumpMap,pe=!!R.normalMap,_e=!!R.displacementMap,Re=!!R.emissiveMap,ie=!!R.metalnessMap,q=!!R.roughnessMap,me=R.anisotropy>0,ve=R.clearcoat>0,Te=R.dispersion>0,ke=R.iridescence>0,He=R.sheen>0,Ue=R.transmission>0,We=me&&!!R.anisotropyMap,ct=ve&&!!R.clearcoatMap,Ye=ve&&!!R.clearcoatNormalMap,lt=ve&&!!R.clearcoatRoughnessMap,Lt=ke&&!!R.iridescenceMap,Bt=ke&&!!R.iridescenceThicknessMap,gt=He&&!!R.sheenColorMap,ei=He&&!!R.sheenRoughnessMap,wi=!!R.specularMap,Me=!!R.specularColorMap,Ve=!!R.specularIntensityMap,xe=Ue&&!!R.transmissionMap,Fe=Ue&&!!R.thicknessMap,Ge=!!R.gradientMap,at=!!R.alphaMap,vt=R.alphaTest>0,Vi=!!R.alphaHash,Fi=!!R.extensions;let en=ph;R.toneMapped&&(se===null||se.isXRRenderTarget===!0)&&(en=r.toneMapping);const Wn={shaderID:J,shaderType:R.type,shaderName:R.name,vertexShader:ye,fragmentShader:ce,defines:R.defines,customVertexShaderID:we,customFragmentShaderID:be,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:v,batching:Q,instancing:ae,instancingColor:ae&&I.instanceColor!==null,instancingMorph:ae&&I.morphTexture!==null,supportsVertexTextures:m,outputColorSpace:se===null?r.outputColorSpace:se.isXRRenderTarget===!0?se.texture.colorSpace:ns,alphaToCoverage:!!R.alphaToCoverage,map:z,matcap:j,envMap:te,envMapMode:te&&X.mapping,envMapCubeUVHeight:H,aoMap:W,lightMap:Z,bumpMap:he,normalMap:pe,displacementMap:m&&_e,emissiveMap:Re,normalMapObjectSpace:pe&&R.normalMapType===uG,normalMapTangentSpace:pe&&R.normalMapType===vd,metalnessMap:ie,roughnessMap:q,anisotropy:me,anisotropyMap:We,clearcoat:ve,clearcoatMap:ct,clearcoatNormalMap:Ye,clearcoatRoughnessMap:lt,dispersion:Te,iridescence:ke,iridescenceMap:Lt,iridescenceThicknessMap:Bt,sheen:He,sheenColorMap:gt,sheenRoughnessMap:ei,specularMap:wi,specularColorMap:Me,specularIntensityMap:Ve,transmission:Ue,transmissionMap:xe,thicknessMap:Fe,gradientMap:Ge,opaque:R.transparent===!1&&R.blending===Lf&&R.alphaToCoverage===!1,alphaMap:at,alphaTest:vt,alphaHash:Vi,combine:R.combine,mapUv:z&&x(R.map.channel),aoMapUv:W&&x(R.aoMap.channel),lightMapUv:Z&&x(R.lightMap.channel),bumpMapUv:he&&x(R.bumpMap.channel),normalMapUv:pe&&x(R.normalMap.channel),displacementMapUv:_e&&x(R.displacementMap.channel),emissiveMapUv:Re&&x(R.emissiveMap.channel),metalnessMapUv:ie&&x(R.metalnessMap.channel),roughnessMapUv:q&&x(R.roughnessMap.channel),anisotropyMapUv:We&&x(R.anisotropyMap.channel),clearcoatMapUv:ct&&x(R.clearcoatMap.channel),clearcoatNormalMapUv:Ye&&x(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:lt&&x(R.clearcoatRoughnessMap.channel),iridescenceMapUv:Lt&&x(R.iridescenceMap.channel),iridescenceThicknessMapUv:Bt&&x(R.iridescenceThicknessMap.channel),sheenColorMapUv:gt&&x(R.sheenColorMap.channel),sheenRoughnessMapUv:ei&&x(R.sheenRoughnessMap.channel),specularMapUv:wi&&x(R.specularMap.channel),specularColorMapUv:Me&&x(R.specularColorMap.channel),specularIntensityMapUv:Ve&&x(R.specularIntensityMap.channel),transmissionMapUv:xe&&x(R.transmissionMap.channel),thicknessMapUv:Fe&&x(R.thicknessMap.channel),alphaMapUv:at&&x(R.alphaMap.channel),vertexTangents:!!U.attributes.tangent&&(pe||me),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!U.attributes.color&&U.attributes.color.itemSize===4,pointsUvs:I.isPoints===!0&&!!U.attributes.uv&&(z||at),fog:!!L,useFog:R.fog===!0,fogExp2:!!L&&L.isFogExp2,flatShading:R.flatShading===!0,sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:p,skinning:I.isSkinnedMesh===!0,morphTargets:U.morphAttributes.position!==void 0,morphNormals:U.morphAttributes.normal!==void 0,morphColors:U.morphAttributes.color!==void 0,morphTargetsCount:ne,morphTextureStride:ge,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numLightProbes:E.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:R.dithering,shadowMapEnabled:r.shadowMap.enabled&&D.length>0,shadowMapType:r.shadowMap.type,toneMapping:en,useLegacyLights:r._useLegacyLights,decodeVideoTexture:z&&R.map.isVideoTexture===!0&&dn.getTransfer(R.map.colorSpace)===kn,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===Qs,flipSided:R.side===Rs,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionClipCullDistance:Fi&&R.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Fi&&R.extensions.multiDraw===!0&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()};return Wn.vertexUv1s=u.has(1),Wn.vertexUv2s=u.has(2),Wn.vertexUv3s=u.has(3),u.clear(),Wn}function S(R){const E=[];if(R.shaderID?E.push(R.shaderID):(E.push(R.customVertexShaderID),E.push(R.customFragmentShaderID)),R.defines!==void 0)for(const D in R.defines)E.push(D),E.push(R.defines[D]);return R.isRawShaderMaterial===!1&&(O(E,R),_(E,R),E.push(r.outputColorSpace)),E.push(R.customProgramCacheKey),E.join()}function O(R,E){R.push(E.precision),R.push(E.outputColorSpace),R.push(E.envMapMode),R.push(E.envMapCubeUVHeight),R.push(E.mapUv),R.push(E.alphaMapUv),R.push(E.lightMapUv),R.push(E.aoMapUv),R.push(E.bumpMapUv),R.push(E.normalMapUv),R.push(E.displacementMapUv),R.push(E.emissiveMapUv),R.push(E.metalnessMapUv),R.push(E.roughnessMapUv),R.push(E.anisotropyMapUv),R.push(E.clearcoatMapUv),R.push(E.clearcoatNormalMapUv),R.push(E.clearcoatRoughnessMapUv),R.push(E.iridescenceMapUv),R.push(E.iridescenceThicknessMapUv),R.push(E.sheenColorMapUv),R.push(E.sheenRoughnessMapUv),R.push(E.specularMapUv),R.push(E.specularColorMapUv),R.push(E.specularIntensityMapUv),R.push(E.transmissionMapUv),R.push(E.thicknessMapUv),R.push(E.combine),R.push(E.fogExp2),R.push(E.sizeAttenuation),R.push(E.morphTargetsCount),R.push(E.morphAttributeCount),R.push(E.numDirLights),R.push(E.numPointLights),R.push(E.numSpotLights),R.push(E.numSpotLightMaps),R.push(E.numHemiLights),R.push(E.numRectAreaLights),R.push(E.numDirLightShadows),R.push(E.numPointLightShadows),R.push(E.numSpotLightShadows),R.push(E.numSpotLightShadowsWithMaps),R.push(E.numLightProbes),R.push(E.shadowMapType),R.push(E.toneMapping),R.push(E.numClippingPlanes),R.push(E.numClipIntersection),R.push(E.depthPacking)}function _(R,E){l.disableAll(),E.supportsVertexTextures&&l.enable(0),E.instancing&&l.enable(1),E.instancingColor&&l.enable(2),E.instancingMorph&&l.enable(3),E.matcap&&l.enable(4),E.envMap&&l.enable(5),E.normalMapObjectSpace&&l.enable(6),E.normalMapTangentSpace&&l.enable(7),E.clearcoat&&l.enable(8),E.iridescence&&l.enable(9),E.alphaTest&&l.enable(10),E.vertexColors&&l.enable(11),E.vertexAlphas&&l.enable(12),E.vertexUv1s&&l.enable(13),E.vertexUv2s&&l.enable(14),E.vertexUv3s&&l.enable(15),E.vertexTangents&&l.enable(16),E.anisotropy&&l.enable(17),E.alphaHash&&l.enable(18),E.batching&&l.enable(19),E.dispersion&&l.enable(20),R.push(l.mask),l.disableAll(),E.fog&&l.enable(0),E.useFog&&l.enable(1),E.flatShading&&l.enable(2),E.logarithmicDepthBuffer&&l.enable(3),E.skinning&&l.enable(4),E.morphTargets&&l.enable(5),E.morphNormals&&l.enable(6),E.morphColors&&l.enable(7),E.premultipliedAlpha&&l.enable(8),E.shadowMapEnabled&&l.enable(9),E.useLegacyLights&&l.enable(10),E.doubleSided&&l.enable(11),E.flipSided&&l.enable(12),E.useDepthPacking&&l.enable(13),E.dithering&&l.enable(14),E.transmission&&l.enable(15),E.sheen&&l.enable(16),E.opaque&&l.enable(17),E.pointsUvs&&l.enable(18),E.decodeVideoTexture&&l.enable(19),E.alphaToCoverage&&l.enable(20),R.push(l.mask)}function T(R){const E=y[R.type];let D;if(E){const $=_a[E];D=Ab.clone($.uniforms)}else D=R.uniforms;return D}function A(R,E){let D;for(let $=0,I=f.length;$<I;$++){const L=f[$];if(L.cacheKey===E){D=L,++D.usedTimes;break}}return D===void 0&&(D=new $xe(r,E,R,o),f.push(D)),D}function P(R){if(--R.usedTimes===0){const E=f.indexOf(R);f[E]=f[f.length-1],f.pop(),R.destroy()}}function N(R){h.remove(R)}function k(){h.dispose()}return{getParameters:w,getProgramCacheKey:S,getUniforms:T,acquireProgram:A,releaseProgram:P,releaseShaderCache:N,programs:f,dispose:k}}function Xxe(){let r=new WeakMap;function e(o){let a=r.get(o);return a===void 0&&(a={},r.set(o,a)),a}function n(o){r.delete(o)}function i(o,a,l){r.get(o)[a]=l}function s(){r=new WeakMap}return{get:e,remove:n,update:i,dispose:s}}function Wxe(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function g$(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function v$(){const r=[];let e=0;const n=[],i=[],s=[];function o(){e=0,n.length=0,i.length=0,s.length=0}function a(p,m,v,y,x,w){let S=r[e];return S===void 0?(S={id:p.id,object:p,geometry:m,material:v,groupOrder:y,renderOrder:p.renderOrder,z:x,group:w},r[e]=S):(S.id=p.id,S.object=p,S.geometry=m,S.material=v,S.groupOrder=y,S.renderOrder=p.renderOrder,S.z=x,S.group=w),e++,S}function l(p,m,v,y,x,w){const S=a(p,m,v,y,x,w);v.transmission>0?i.push(S):v.transparent===!0?s.push(S):n.push(S)}function h(p,m,v,y,x,w){const S=a(p,m,v,y,x,w);v.transmission>0?i.unshift(S):v.transparent===!0?s.unshift(S):n.unshift(S)}function u(p,m){n.length>1&&n.sort(p||Wxe),i.length>1&&i.sort(m||g$),s.length>1&&s.sort(m||g$)}function f(){for(let p=e,m=r.length;p<m;p++){const v=r[p];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:n,transmissive:i,transparent:s,init:o,push:l,unshift:h,finish:f,sort:u}}function Gxe(){let r=new WeakMap;function e(i,s){const o=r.get(i);let a;return o===void 0?(a=new v$,r.set(i,[a])):s>=o.length?(a=new v$,o.push(a)):a=o[s],a}function n(){r=new WeakMap}return{get:e,dispose:n}}function Hxe(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new le,color:new nt};break;case"SpotLight":n={position:new le,direction:new le,color:new nt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new le,color:new nt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new le,skyColor:new nt,groundColor:new nt};break;case"RectAreaLight":n={color:new nt,position:new le,halfWidth:new le,halfHeight:new le};break}return r[e.id]=n,n}}}function Qxe(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=n,n}}}let jxe=0;function Yxe(r,e){return(e.castShadow?2:0)-(r.castShadow?2:0)+(e.map?1:0)-(r.map?1:0)}function qxe(r){const e=new Hxe,n=Qxe(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new le);const s=new le,o=new dt,a=new dt;function l(u,f){let p=0,m=0,v=0;for(let D=0;D<9;D++)i.probe[D].set(0,0,0);let y=0,x=0,w=0,S=0,O=0,_=0,T=0,A=0,P=0,N=0,k=0;u.sort(Yxe);const R=f===!0?Math.PI:1;for(let D=0,$=u.length;D<$;D++){const I=u[D],L=I.color,U=I.intensity,V=I.distance,X=I.shadow&&I.shadow.map?I.shadow.map.texture:null;if(I.isAmbientLight)p+=L.r*U*R,m+=L.g*U*R,v+=L.b*U*R;else if(I.isLightProbe){for(let H=0;H<9;H++)i.probe[H].addScaledVector(I.sh.coefficients[H],U);k++}else if(I.isDirectionalLight){const H=e.get(I);if(H.color.copy(I.color).multiplyScalar(I.intensity*R),I.castShadow){const J=I.shadow,ee=n.get(I);ee.shadowBias=J.bias,ee.shadowNormalBias=J.normalBias,ee.shadowRadius=J.radius,ee.shadowMapSize=J.mapSize,i.directionalShadow[y]=ee,i.directionalShadowMap[y]=X,i.directionalShadowMatrix[y]=I.shadow.matrix,_++}i.directional[y]=H,y++}else if(I.isSpotLight){const H=e.get(I);H.position.setFromMatrixPosition(I.matrixWorld),H.color.copy(L).multiplyScalar(U*R),H.distance=V,H.coneCos=Math.cos(I.angle),H.penumbraCos=Math.cos(I.angle*(1-I.penumbra)),H.decay=I.decay,i.spot[w]=H;const J=I.shadow;if(I.map&&(i.spotLightMap[P]=I.map,P++,J.updateMatrices(I),I.castShadow&&N++),i.spotLightMatrix[w]=J.matrix,I.castShadow){const ee=n.get(I);ee.shadowBias=J.bias,ee.shadowNormalBias=J.normalBias,ee.shadowRadius=J.radius,ee.shadowMapSize=J.mapSize,i.spotShadow[w]=ee,i.spotShadowMap[w]=X,A++}w++}else if(I.isRectAreaLight){const H=e.get(I);H.color.copy(L).multiplyScalar(U),H.halfWidth.set(I.width*.5,0,0),H.halfHeight.set(0,I.height*.5,0),i.rectArea[S]=H,S++}else if(I.isPointLight){const H=e.get(I);if(H.color.copy(I.color).multiplyScalar(I.intensity*R),H.distance=I.distance,H.decay=I.decay,I.castShadow){const J=I.shadow,ee=n.get(I);ee.shadowBias=J.bias,ee.shadowNormalBias=J.normalBias,ee.shadowRadius=J.radius,ee.shadowMapSize=J.mapSize,ee.shadowCameraNear=J.camera.near,ee.shadowCameraFar=J.camera.far,i.pointShadow[x]=ee,i.pointShadowMap[x]=X,i.pointShadowMatrix[x]=I.shadow.matrix,T++}i.point[x]=H,x++}else if(I.isHemisphereLight){const H=e.get(I);H.skyColor.copy(I.color).multiplyScalar(U*R),H.groundColor.copy(I.groundColor).multiplyScalar(U*R),i.hemi[O]=H,O++}}S>0&&(r.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=ut.LTC_FLOAT_1,i.rectAreaLTC2=ut.LTC_FLOAT_2):(i.rectAreaLTC1=ut.LTC_HALF_1,i.rectAreaLTC2=ut.LTC_HALF_2)),i.ambient[0]=p,i.ambient[1]=m,i.ambient[2]=v;const E=i.hash;(E.directionalLength!==y||E.pointLength!==x||E.spotLength!==w||E.rectAreaLength!==S||E.hemiLength!==O||E.numDirectionalShadows!==_||E.numPointShadows!==T||E.numSpotShadows!==A||E.numSpotMaps!==P||E.numLightProbes!==k)&&(i.directional.length=y,i.spot.length=w,i.rectArea.length=S,i.point.length=x,i.hemi.length=O,i.directionalShadow.length=_,i.directionalShadowMap.length=_,i.pointShadow.length=T,i.pointShadowMap.length=T,i.spotShadow.length=A,i.spotShadowMap.length=A,i.directionalShadowMatrix.length=_,i.pointShadowMatrix.length=T,i.spotLightMatrix.length=A+P-N,i.spotLightMap.length=P,i.numSpotLightShadowsWithMaps=N,i.numLightProbes=k,E.directionalLength=y,E.pointLength=x,E.spotLength=w,E.rectAreaLength=S,E.hemiLength=O,E.numDirectionalShadows=_,E.numPointShadows=T,E.numSpotShadows=A,E.numSpotMaps=P,E.numLightProbes=k,i.version=jxe++)}function h(u,f){let p=0,m=0,v=0,y=0,x=0;const w=f.matrixWorldInverse;for(let S=0,O=u.length;S<O;S++){const _=u[S];if(_.isDirectionalLight){const T=i.directional[p];T.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(w),p++}else if(_.isSpotLight){const T=i.spot[v];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(w),T.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(w),v++}else if(_.isRectAreaLight){const T=i.rectArea[y];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(w),a.identity(),o.copy(_.matrixWorld),o.premultiply(w),a.extractRotation(o),T.halfWidth.set(_.width*.5,0,0),T.halfHeight.set(0,_.height*.5,0),T.halfWidth.applyMatrix4(a),T.halfHeight.applyMatrix4(a),y++}else if(_.isPointLight){const T=i.point[m];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(w),m++}else if(_.isHemisphereLight){const T=i.hemi[x];T.direction.setFromMatrixPosition(_.matrixWorld),T.direction.transformDirection(w),x++}}}return{setup:l,setupView:h,state:i}}function y$(r){const e=new qxe(r),n=[],i=[];function s(f){u.camera=f,n.length=0,i.length=0}function o(f){n.push(f)}function a(f){i.push(f)}function l(f){e.setup(n,f)}function h(f){e.setupView(n,f)}const u={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:u,setupLights:l,setupLightsView:h,pushLight:o,pushShadow:a}}function Zxe(r){let e=new WeakMap;function n(s,o=0){const a=e.get(s);let l;return a===void 0?(l=new y$(r),e.set(s,[l])):o>=a.length?(l=new y$(r),a.push(l)):l=a[o],l}function i(){e=new WeakMap}return{get:n,dispose:i}}class GI extends Xr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=cG,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class HI extends Xr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Kxe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Jxe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function ewe(r,e,n){let i=new Rb;const s=new Xe,o=new Xe,a=new Ni,l=new GI({depthPacking:hG}),h=new HI,u={},f=n.maxTextureSize,p={[dc]:Rs,[Rs]:dc,[Qs]:Qs},m=new io({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xe},radius:{value:4}},vertexShader:Kxe,fragmentShader:Jxe}),v=m.clone();v.defines.HORIZONTAL_PASS=1;const y=new vi;y.setAttribute("position",new Di(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new ln(y,m),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=EI;let S=this.type;this.render=function(P,N,k){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||P.length===0)return;const R=r.getRenderTarget(),E=r.getActiveCubeFace(),D=r.getActiveMipmapLevel(),$=r.state;$.setBlending(fh),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);const I=S!==Ql&&this.type===Ql,L=S===Ql&&this.type!==Ql;for(let U=0,V=P.length;U<V;U++){const X=P[U],H=X.shadow;if(H===void 0){console.warn("THREE.WebGLShadowMap:",X,"has no shadow.");continue}if(H.autoUpdate===!1&&H.needsUpdate===!1)continue;s.copy(H.mapSize);const J=H.getFrameExtents();if(s.multiply(J),o.copy(H.mapSize),(s.x>f||s.y>f)&&(s.x>f&&(o.x=Math.floor(f/J.x),s.x=o.x*J.x,H.mapSize.x=o.x),s.y>f&&(o.y=Math.floor(f/J.y),s.y=o.y*J.y,H.mapSize.y=o.y)),H.map===null||I===!0||L===!0){const ne=this.type!==Ql?{minFilter:Er,magFilter:Er}:{};H.map!==null&&H.map.dispose(),H.map=new La(s.x,s.y,ne),H.map.texture.name=X.name+".shadowMap",H.camera.updateProjectionMatrix()}r.setRenderTarget(H.map),r.clear();const ee=H.getViewportCount();for(let ne=0;ne<ee;ne++){const ge=H.getViewport(ne);a.set(o.x*ge.x,o.y*ge.y,o.x*ge.z,o.y*ge.w),$.viewport(a),H.updateMatrices(X,ne),i=H.getFrustum(),T(N,k,H.camera,X,this.type)}H.isPointLightShadow!==!0&&this.type===Ql&&O(H,k),H.needsUpdate=!1}S=this.type,w.needsUpdate=!1,r.setRenderTarget(R,E,D)};function O(P,N){const k=e.update(x);m.defines.VSM_SAMPLES!==P.blurSamples&&(m.defines.VSM_SAMPLES=P.blurSamples,v.defines.VSM_SAMPLES=P.blurSamples,m.needsUpdate=!0,v.needsUpdate=!0),P.mapPass===null&&(P.mapPass=new La(s.x,s.y)),m.uniforms.shadow_pass.value=P.map.texture,m.uniforms.resolution.value=P.mapSize,m.uniforms.radius.value=P.radius,r.setRenderTarget(P.mapPass),r.clear(),r.renderBufferDirect(N,null,k,m,x,null),v.uniforms.shadow_pass.value=P.mapPass.texture,v.uniforms.resolution.value=P.mapSize,v.uniforms.radius.value=P.radius,r.setRenderTarget(P.map),r.clear(),r.renderBufferDirect(N,null,k,v,x,null)}function _(P,N,k,R){let E=null;const D=k.isPointLight===!0?P.customDistanceMaterial:P.customDepthMaterial;if(D!==void 0)E=D;else if(E=k.isPointLight===!0?h:l,r.localClippingEnabled&&N.clipShadows===!0&&Array.isArray(N.clippingPlanes)&&N.clippingPlanes.length!==0||N.displacementMap&&N.displacementScale!==0||N.alphaMap&&N.alphaTest>0||N.map&&N.alphaTest>0){const $=E.uuid,I=N.uuid;let L=u[$];L===void 0&&(L={},u[$]=L);let U=L[I];U===void 0&&(U=E.clone(),L[I]=U,N.addEventListener("dispose",A)),E=U}if(E.visible=N.visible,E.wireframe=N.wireframe,R===Ql?E.side=N.shadowSide!==null?N.shadowSide:N.side:E.side=N.shadowSide!==null?N.shadowSide:p[N.side],E.alphaMap=N.alphaMap,E.alphaTest=N.alphaTest,E.map=N.map,E.clipShadows=N.clipShadows,E.clippingPlanes=N.clippingPlanes,E.clipIntersection=N.clipIntersection,E.displacementMap=N.displacementMap,E.displacementScale=N.displacementScale,E.displacementBias=N.displacementBias,E.wireframeLinewidth=N.wireframeLinewidth,E.linewidth=N.linewidth,k.isPointLight===!0&&E.isMeshDistanceMaterial===!0){const $=r.properties.get(E);$.light=k}return E}function T(P,N,k,R,E){if(P.visible===!1)return;if(P.layers.test(N.layers)&&(P.isMesh||P.isLine||P.isPoints)&&(P.castShadow||P.receiveShadow&&E===Ql)&&(!P.frustumCulled||i.intersectsObject(P))){P.modelViewMatrix.multiplyMatrices(k.matrixWorldInverse,P.matrixWorld);const I=e.update(P),L=P.material;if(Array.isArray(L)){const U=I.groups;for(let V=0,X=U.length;V<X;V++){const H=U[V],J=L[H.materialIndex];if(J&&J.visible){const ee=_(P,J,R,E);P.onBeforeShadow(r,P,N,k,I,ee,H),r.renderBufferDirect(k,null,I,ee,P,H),P.onAfterShadow(r,P,N,k,I,ee,H)}}}else if(L.visible){const U=_(P,L,R,E);P.onBeforeShadow(r,P,N,k,I,U,null),r.renderBufferDirect(k,null,I,U,P,null),P.onAfterShadow(r,P,N,k,I,U,null)}}const $=P.children;for(let I=0,L=$.length;I<L;I++)T($[I],N,k,R,E)}function A(P){P.target.removeEventListener("dispose",A);for(const k in u){const R=u[k],E=P.target.uuid;E in R&&(R[E].dispose(),delete R[E])}}}function twe(r){function e(){let xe=!1;const Fe=new Ni;let Ge=null;const at=new Ni(0,0,0,0);return{setMask:function(vt){Ge!==vt&&!xe&&(r.colorMask(vt,vt,vt,vt),Ge=vt)},setLocked:function(vt){xe=vt},setClear:function(vt,Vi,Fi,en,Wn){Wn===!0&&(vt*=en,Vi*=en,Fi*=en),Fe.set(vt,Vi,Fi,en),at.equals(Fe)===!1&&(r.clearColor(vt,Vi,Fi,en),at.copy(Fe))},reset:function(){xe=!1,Ge=null,at.set(-1,0,0,0)}}}function n(){let xe=!1,Fe=null,Ge=null,at=null;return{setTest:function(vt){vt?be(r.DEPTH_TEST):se(r.DEPTH_TEST)},setMask:function(vt){Fe!==vt&&!xe&&(r.depthMask(vt),Fe=vt)},setFunc:function(vt){if(Ge!==vt){switch(vt){case NW:r.depthFunc(r.NEVER);break;case DW:r.depthFunc(r.ALWAYS);break;case LW:r.depthFunc(r.LESS);break;case A1:r.depthFunc(r.LEQUAL);break;case BW:r.depthFunc(r.EQUAL);break;case $W:r.depthFunc(r.GEQUAL);break;case UW:r.depthFunc(r.GREATER);break;case VW:r.depthFunc(r.NOTEQUAL);break;default:r.depthFunc(r.LEQUAL)}Ge=vt}},setLocked:function(vt){xe=vt},setClear:function(vt){at!==vt&&(r.clearDepth(vt),at=vt)},reset:function(){xe=!1,Fe=null,Ge=null,at=null}}}function i(){let xe=!1,Fe=null,Ge=null,at=null,vt=null,Vi=null,Fi=null,en=null,Wn=null;return{setTest:function(Ii){xe||(Ii?be(r.STENCIL_TEST):se(r.STENCIL_TEST))},setMask:function(Ii){Fe!==Ii&&!xe&&(r.stencilMask(Ii),Fe=Ii)},setFunc:function(Ii,Hr,Kn){(Ge!==Ii||at!==Hr||vt!==Kn)&&(r.stencilFunc(Ii,Hr,Kn),Ge=Ii,at=Hr,vt=Kn)},setOp:function(Ii,Hr,Kn){(Vi!==Ii||Fi!==Hr||en!==Kn)&&(r.stencilOp(Ii,Hr,Kn),Vi=Ii,Fi=Hr,en=Kn)},setLocked:function(Ii){xe=Ii},setClear:function(Ii){Wn!==Ii&&(r.clearStencil(Ii),Wn=Ii)},reset:function(){xe=!1,Fe=null,Ge=null,at=null,vt=null,Vi=null,Fi=null,en=null,Wn=null}}}const s=new e,o=new n,a=new i,l=new WeakMap,h=new WeakMap;let u={},f={},p=new WeakMap,m=[],v=null,y=!1,x=null,w=null,S=null,O=null,_=null,T=null,A=null,P=new nt(0,0,0),N=0,k=!1,R=null,E=null,D=null,$=null,I=null;const L=r.getParameter(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let U=!1,V=0;const X=r.getParameter(r.VERSION);X.indexOf("WebGL")!==-1?(V=parseFloat(/^WebGL (\d)/.exec(X)[1]),U=V>=1):X.indexOf("OpenGL ES")!==-1&&(V=parseFloat(/^OpenGL ES (\d)/.exec(X)[1]),U=V>=2);let H=null,J={};const ee=r.getParameter(r.SCISSOR_BOX),ne=r.getParameter(r.VIEWPORT),ge=new Ni().fromArray(ee),ye=new Ni().fromArray(ne);function ce(xe,Fe,Ge,at){const vt=new Uint8Array(4),Vi=r.createTexture();r.bindTexture(xe,Vi),r.texParameteri(xe,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(xe,r.TEXTURE_MAG_FILTER,r.NEAREST);for(let Fi=0;Fi<Ge;Fi++)xe===r.TEXTURE_3D||xe===r.TEXTURE_2D_ARRAY?r.texImage3D(Fe,0,r.RGBA,1,1,at,0,r.RGBA,r.UNSIGNED_BYTE,vt):r.texImage2D(Fe+Fi,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,vt);return Vi}const we={};we[r.TEXTURE_2D]=ce(r.TEXTURE_2D,r.TEXTURE_2D,1),we[r.TEXTURE_CUBE_MAP]=ce(r.TEXTURE_CUBE_MAP,r.TEXTURE_CUBE_MAP_POSITIVE_X,6),we[r.TEXTURE_2D_ARRAY]=ce(r.TEXTURE_2D_ARRAY,r.TEXTURE_2D_ARRAY,1,1),we[r.TEXTURE_3D]=ce(r.TEXTURE_3D,r.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),be(r.DEPTH_TEST),o.setFunc(A1),he(!1),pe(tP),be(r.CULL_FACE),W(fh);function be(xe){u[xe]!==!0&&(r.enable(xe),u[xe]=!0)}function se(xe){u[xe]!==!1&&(r.disable(xe),u[xe]=!1)}function ae(xe,Fe){return f[xe]!==Fe?(r.bindFramebuffer(xe,Fe),f[xe]=Fe,xe===r.DRAW_FRAMEBUFFER&&(f[r.FRAMEBUFFER]=Fe),xe===r.FRAMEBUFFER&&(f[r.DRAW_FRAMEBUFFER]=Fe),!0):!1}function Q(xe,Fe){let Ge=m,at=!1;if(xe){Ge=p.get(Fe),Ge===void 0&&(Ge=[],p.set(Fe,Ge));const vt=xe.textures;if(Ge.length!==vt.length||Ge[0]!==r.COLOR_ATTACHMENT0){for(let Vi=0,Fi=vt.length;Vi<Fi;Vi++)Ge[Vi]=r.COLOR_ATTACHMENT0+Vi;Ge.length=vt.length,at=!0}}else Ge[0]!==r.BACK&&(Ge[0]=r.BACK,at=!0);at&&r.drawBuffers(Ge)}function z(xe){return v!==xe?(r.useProgram(xe),v=xe,!0):!1}const j={[Ru]:r.FUNC_ADD,[vW]:r.FUNC_SUBTRACT,[yW]:r.FUNC_REVERSE_SUBTRACT};j[bW]=r.MIN,j[xW]=r.MAX;const te={[wW]:r.ZERO,[_W]:r.ONE,[OW]:r.SRC_COLOR,[_S]:r.SRC_ALPHA,[AW]:r.SRC_ALPHA_SATURATE,[EW]:r.DST_COLOR,[CW]:r.DST_ALPHA,[SW]:r.ONE_MINUS_SRC_COLOR,[OS]:r.ONE_MINUS_SRC_ALPHA,[MW]:r.ONE_MINUS_DST_COLOR,[TW]:r.ONE_MINUS_DST_ALPHA,[kW]:r.CONSTANT_COLOR,[PW]:r.ONE_MINUS_CONSTANT_COLOR,[RW]:r.CONSTANT_ALPHA,[IW]:r.ONE_MINUS_CONSTANT_ALPHA};function W(xe,Fe,Ge,at,vt,Vi,Fi,en,Wn,Ii){if(xe===fh){y===!0&&(se(r.BLEND),y=!1);return}if(y===!1&&(be(r.BLEND),y=!0),xe!==gW){if(xe!==x||Ii!==k){if((w!==Ru||_!==Ru)&&(r.blendEquation(r.FUNC_ADD),w=Ru,_=Ru),Ii)switch(xe){case Lf:r.blendFuncSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case wS:r.blendFunc(r.ONE,r.ONE);break;case iP:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case nP:r.blendFuncSeparate(r.ZERO,r.SRC_COLOR,r.ZERO,r.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",xe);break}else switch(xe){case Lf:r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case wS:r.blendFunc(r.SRC_ALPHA,r.ONE);break;case iP:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case nP:r.blendFunc(r.ZERO,r.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",xe);break}S=null,O=null,T=null,A=null,P.set(0,0,0),N=0,x=xe,k=Ii}return}vt=vt||Fe,Vi=Vi||Ge,Fi=Fi||at,(Fe!==w||vt!==_)&&(r.blendEquationSeparate(j[Fe],j[vt]),w=Fe,_=vt),(Ge!==S||at!==O||Vi!==T||Fi!==A)&&(r.blendFuncSeparate(te[Ge],te[at],te[Vi],te[Fi]),S=Ge,O=at,T=Vi,A=Fi),(en.equals(P)===!1||Wn!==N)&&(r.blendColor(en.r,en.g,en.b,Wn),P.copy(en),N=Wn),x=xe,k=!1}function Z(xe,Fe){xe.side===Qs?se(r.CULL_FACE):be(r.CULL_FACE);let Ge=xe.side===Rs;Fe&&(Ge=!Ge),he(Ge),xe.blending===Lf&&xe.transparent===!1?W(fh):W(xe.blending,xe.blendEquation,xe.blendSrc,xe.blendDst,xe.blendEquationAlpha,xe.blendSrcAlpha,xe.blendDstAlpha,xe.blendColor,xe.blendAlpha,xe.premultipliedAlpha),o.setFunc(xe.depthFunc),o.setTest(xe.depthTest),o.setMask(xe.depthWrite),s.setMask(xe.colorWrite);const at=xe.stencilWrite;a.setTest(at),at&&(a.setMask(xe.stencilWriteMask),a.setFunc(xe.stencilFunc,xe.stencilRef,xe.stencilFuncMask),a.setOp(xe.stencilFail,xe.stencilZFail,xe.stencilZPass)),Re(xe.polygonOffset,xe.polygonOffsetFactor,xe.polygonOffsetUnits),xe.alphaToCoverage===!0?be(r.SAMPLE_ALPHA_TO_COVERAGE):se(r.SAMPLE_ALPHA_TO_COVERAGE)}function he(xe){R!==xe&&(xe?r.frontFace(r.CW):r.frontFace(r.CCW),R=xe)}function pe(xe){xe!==pW?(be(r.CULL_FACE),xe!==E&&(xe===tP?r.cullFace(r.BACK):xe===mW?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK))):se(r.CULL_FACE),E=xe}function _e(xe){xe!==D&&(U&&r.lineWidth(xe),D=xe)}function Re(xe,Fe,Ge){xe?(be(r.POLYGON_OFFSET_FILL),($!==Fe||I!==Ge)&&(r.polygonOffset(Fe,Ge),$=Fe,I=Ge)):se(r.POLYGON_OFFSET_FILL)}function ie(xe){xe?be(r.SCISSOR_TEST):se(r.SCISSOR_TEST)}function q(xe){xe===void 0&&(xe=r.TEXTURE0+L-1),H!==xe&&(r.activeTexture(xe),H=xe)}function me(xe,Fe,Ge){Ge===void 0&&(H===null?Ge=r.TEXTURE0+L-1:Ge=H);let at=J[Ge];at===void 0&&(at={type:void 0,texture:void 0},J[Ge]=at),(at.type!==xe||at.texture!==Fe)&&(H!==Ge&&(r.activeTexture(Ge),H=Ge),r.bindTexture(xe,Fe||we[xe]),at.type=xe,at.texture=Fe)}function ve(){const xe=J[H];xe!==void 0&&xe.type!==void 0&&(r.bindTexture(xe.type,null),xe.type=void 0,xe.texture=void 0)}function Te(){try{r.compressedTexImage2D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ke(){try{r.compressedTexImage3D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function He(){try{r.texSubImage2D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function Ue(){try{r.texSubImage3D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function We(){try{r.compressedTexSubImage2D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ct(){try{r.compressedTexSubImage3D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function Ye(){try{r.texStorage2D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function lt(){try{r.texStorage3D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function Lt(){try{r.texImage2D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function Bt(){try{r.texImage3D.apply(r,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function gt(xe){ge.equals(xe)===!1&&(r.scissor(xe.x,xe.y,xe.z,xe.w),ge.copy(xe))}function ei(xe){ye.equals(xe)===!1&&(r.viewport(xe.x,xe.y,xe.z,xe.w),ye.copy(xe))}function wi(xe,Fe){let Ge=h.get(Fe);Ge===void 0&&(Ge=new WeakMap,h.set(Fe,Ge));let at=Ge.get(xe);at===void 0&&(at=r.getUniformBlockIndex(Fe,xe.name),Ge.set(xe,at))}function Me(xe,Fe){const at=h.get(Fe).get(xe);l.get(Fe)!==at&&(r.uniformBlockBinding(Fe,at,xe.__bindingPointIndex),l.set(Fe,at))}function Ve(){r.disable(r.BLEND),r.disable(r.CULL_FACE),r.disable(r.DEPTH_TEST),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SCISSOR_TEST),r.disable(r.STENCIL_TEST),r.disable(r.SAMPLE_ALPHA_TO_COVERAGE),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ZERO),r.blendFuncSeparate(r.ONE,r.ZERO,r.ONE,r.ZERO),r.blendColor(0,0,0,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(r.LESS),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(r.ALWAYS,0,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),r.clearStencil(0),r.cullFace(r.BACK),r.frontFace(r.CCW),r.polygonOffset(0,0),r.activeTexture(r.TEXTURE0),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),u={},H=null,J={},f={},p=new WeakMap,m=[],v=null,y=!1,x=null,w=null,S=null,O=null,_=null,T=null,A=null,P=new nt(0,0,0),N=0,k=!1,R=null,E=null,D=null,$=null,I=null,ge.set(0,0,r.canvas.width,r.canvas.height),ye.set(0,0,r.canvas.width,r.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:be,disable:se,bindFramebuffer:ae,drawBuffers:Q,useProgram:z,setBlending:W,setMaterial:Z,setFlipSided:he,setCullFace:pe,setLineWidth:_e,setPolygonOffset:Re,setScissorTest:ie,activeTexture:q,bindTexture:me,unbindTexture:ve,compressedTexImage2D:Te,compressedTexImage3D:ke,texImage2D:Lt,texImage3D:Bt,updateUBOMapping:wi,uniformBlockBinding:Me,texStorage2D:Ye,texStorage3D:lt,texSubImage2D:He,texSubImage3D:Ue,compressedTexSubImage2D:We,compressedTexSubImage3D:ct,scissor:gt,viewport:ei,reset:Ve}}function iwe(r,e,n,i,s,o,a){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Xe,f=new WeakMap;let p;const m=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(ie,q){return v?new OffscreenCanvas(ie,q):B1("canvas")}function x(ie,q,me){let ve=1;const Te=Re(ie);if((Te.width>me||Te.height>me)&&(ve=me/Math.max(Te.width,Te.height)),ve<1)if(typeof HTMLImageElement<"u"&&ie instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ie instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ie instanceof ImageBitmap||typeof VideoFrame<"u"&&ie instanceof VideoFrame){const ke=Math.floor(ve*Te.width),He=Math.floor(ve*Te.height);p===void 0&&(p=y(ke,He));const Ue=q?y(ke,He):p;return Ue.width=ke,Ue.height=He,Ue.getContext("2d").drawImage(ie,0,0,ke,He),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Te.width+"x"+Te.height+") to ("+ke+"x"+He+")."),Ue}else return"data"in ie&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Te.width+"x"+Te.height+")."),ie;return ie}function w(ie){return ie.generateMipmaps&&ie.minFilter!==Er&&ie.minFilter!==ir}function S(ie){r.generateMipmap(ie)}function O(ie,q,me,ve,Te=!1){if(ie!==null){if(r[ie]!==void 0)return r[ie];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ie+"'")}let ke=q;if(q===r.RED&&(me===r.FLOAT&&(ke=r.R32F),me===r.HALF_FLOAT&&(ke=r.R16F),me===r.UNSIGNED_BYTE&&(ke=r.R8)),q===r.RED_INTEGER&&(me===r.UNSIGNED_BYTE&&(ke=r.R8UI),me===r.UNSIGNED_SHORT&&(ke=r.R16UI),me===r.UNSIGNED_INT&&(ke=r.R32UI),me===r.BYTE&&(ke=r.R8I),me===r.SHORT&&(ke=r.R16I),me===r.INT&&(ke=r.R32I)),q===r.RG&&(me===r.FLOAT&&(ke=r.RG32F),me===r.HALF_FLOAT&&(ke=r.RG16F),me===r.UNSIGNED_BYTE&&(ke=r.RG8)),q===r.RG_INTEGER&&(me===r.UNSIGNED_BYTE&&(ke=r.RG8UI),me===r.UNSIGNED_SHORT&&(ke=r.RG16UI),me===r.UNSIGNED_INT&&(ke=r.RG32UI),me===r.BYTE&&(ke=r.RG8I),me===r.SHORT&&(ke=r.RG16I),me===r.INT&&(ke=r.RG32I)),q===r.RGB&&me===r.UNSIGNED_INT_5_9_9_9_REV&&(ke=r.RGB9_E5),q===r.RGBA){const He=Te?R1:dn.getTransfer(ve);me===r.FLOAT&&(ke=r.RGBA32F),me===r.HALF_FLOAT&&(ke=r.RGBA16F),me===r.UNSIGNED_BYTE&&(ke=He===kn?r.SRGB8_ALPHA8:r.RGBA8),me===r.UNSIGNED_SHORT_4_4_4_4&&(ke=r.RGBA4),me===r.UNSIGNED_SHORT_5_5_5_1&&(ke=r.RGB5_A1)}return(ke===r.R16F||ke===r.R32F||ke===r.RG16F||ke===r.RG32F||ke===r.RGBA16F||ke===r.RGBA32F)&&e.get("EXT_color_buffer_float"),ke}function _(ie,q){return w(ie)===!0||ie.isFramebufferTexture&&ie.minFilter!==Er&&ie.minFilter!==ir?Math.log2(Math.max(q.width,q.height))+1:ie.mipmaps!==void 0&&ie.mipmaps.length>0?ie.mipmaps.length:ie.isCompressedTexture&&Array.isArray(ie.image)?q.mipmaps.length:1}function T(ie){const q=ie.target;q.removeEventListener("dispose",T),P(q),q.isVideoTexture&&f.delete(q)}function A(ie){const q=ie.target;q.removeEventListener("dispose",A),k(q)}function P(ie){const q=i.get(ie);if(q.__webglInit===void 0)return;const me=ie.source,ve=m.get(me);if(ve){const Te=ve[q.__cacheKey];Te.usedTimes--,Te.usedTimes===0&&N(ie),Object.keys(ve).length===0&&m.delete(me)}i.remove(ie)}function N(ie){const q=i.get(ie);r.deleteTexture(q.__webglTexture);const me=ie.source,ve=m.get(me);delete ve[q.__cacheKey],a.memory.textures--}function k(ie){const q=i.get(ie);if(ie.depthTexture&&ie.depthTexture.dispose(),ie.isWebGLCubeRenderTarget)for(let ve=0;ve<6;ve++){if(Array.isArray(q.__webglFramebuffer[ve]))for(let Te=0;Te<q.__webglFramebuffer[ve].length;Te++)r.deleteFramebuffer(q.__webglFramebuffer[ve][Te]);else r.deleteFramebuffer(q.__webglFramebuffer[ve]);q.__webglDepthbuffer&&r.deleteRenderbuffer(q.__webglDepthbuffer[ve])}else{if(Array.isArray(q.__webglFramebuffer))for(let ve=0;ve<q.__webglFramebuffer.length;ve++)r.deleteFramebuffer(q.__webglFramebuffer[ve]);else r.deleteFramebuffer(q.__webglFramebuffer);if(q.__webglDepthbuffer&&r.deleteRenderbuffer(q.__webglDepthbuffer),q.__webglMultisampledFramebuffer&&r.deleteFramebuffer(q.__webglMultisampledFramebuffer),q.__webglColorRenderbuffer)for(let ve=0;ve<q.__webglColorRenderbuffer.length;ve++)q.__webglColorRenderbuffer[ve]&&r.deleteRenderbuffer(q.__webglColorRenderbuffer[ve]);q.__webglDepthRenderbuffer&&r.deleteRenderbuffer(q.__webglDepthRenderbuffer)}const me=ie.textures;for(let ve=0,Te=me.length;ve<Te;ve++){const ke=i.get(me[ve]);ke.__webglTexture&&(r.deleteTexture(ke.__webglTexture),a.memory.textures--),i.remove(me[ve])}i.remove(ie)}let R=0;function E(){R=0}function D(){const ie=R;return ie>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ie+" texture units while this GPU supports only "+s.maxTextures),R+=1,ie}function $(ie){const q=[];return q.push(ie.wrapS),q.push(ie.wrapT),q.push(ie.wrapR||0),q.push(ie.magFilter),q.push(ie.minFilter),q.push(ie.anisotropy),q.push(ie.internalFormat),q.push(ie.format),q.push(ie.type),q.push(ie.generateMipmaps),q.push(ie.premultiplyAlpha),q.push(ie.flipY),q.push(ie.unpackAlignment),q.push(ie.colorSpace),q.join()}function I(ie,q){const me=i.get(ie);if(ie.isVideoTexture&&pe(ie),ie.isRenderTargetTexture===!1&&ie.version>0&&me.__version!==ie.version){const ve=ie.image;if(ve===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ve.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ge(me,ie,q);return}}n.bindTexture(r.TEXTURE_2D,me.__webglTexture,r.TEXTURE0+q)}function L(ie,q){const me=i.get(ie);if(ie.version>0&&me.__version!==ie.version){ge(me,ie,q);return}n.bindTexture(r.TEXTURE_2D_ARRAY,me.__webglTexture,r.TEXTURE0+q)}function U(ie,q){const me=i.get(ie);if(ie.version>0&&me.__version!==ie.version){ge(me,ie,q);return}n.bindTexture(r.TEXTURE_3D,me.__webglTexture,r.TEXTURE0+q)}function V(ie,q){const me=i.get(ie);if(ie.version>0&&me.__version!==ie.version){ye(me,ie,q);return}n.bindTexture(r.TEXTURE_CUBE_MAP,me.__webglTexture,r.TEXTURE0+q)}const X={[yl]:r.REPEAT,[Ps]:r.CLAMP_TO_EDGE,[ep]:r.MIRRORED_REPEAT},H={[Er]:r.NEAREST,[Eb]:r.NEAREST_MIPMAP_NEAREST,[Bu]:r.NEAREST_MIPMAP_LINEAR,[ir]:r.LINEAR,[Bf]:r.LINEAR_MIPMAP_NEAREST,[Ko]:r.LINEAR_MIPMAP_LINEAR},J={[dG]:r.NEVER,[yG]:r.ALWAYS,[fG]:r.LESS,[UI]:r.LEQUAL,[pG]:r.EQUAL,[vG]:r.GEQUAL,[mG]:r.GREATER,[gG]:r.NOTEQUAL};function ee(ie,q){if(q.type===Ea&&e.has("OES_texture_float_linear")===!1&&(q.magFilter===ir||q.magFilter===Bf||q.magFilter===Bu||q.magFilter===Ko||q.minFilter===ir||q.minFilter===Bf||q.minFilter===Bu||q.minFilter===Ko)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),r.texParameteri(ie,r.TEXTURE_WRAP_S,X[q.wrapS]),r.texParameteri(ie,r.TEXTURE_WRAP_T,X[q.wrapT]),(ie===r.TEXTURE_3D||ie===r.TEXTURE_2D_ARRAY)&&r.texParameteri(ie,r.TEXTURE_WRAP_R,X[q.wrapR]),r.texParameteri(ie,r.TEXTURE_MAG_FILTER,H[q.magFilter]),r.texParameteri(ie,r.TEXTURE_MIN_FILTER,H[q.minFilter]),q.compareFunction&&(r.texParameteri(ie,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(ie,r.TEXTURE_COMPARE_FUNC,J[q.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(q.magFilter===Er||q.minFilter!==Bu&&q.minFilter!==Ko||q.type===Ea&&e.has("OES_texture_float_linear")===!1)return;if(q.anisotropy>1||i.get(q).__currentAnisotropy){const me=e.get("EXT_texture_filter_anisotropic");r.texParameterf(ie,me.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(q.anisotropy,s.getMaxAnisotropy())),i.get(q).__currentAnisotropy=q.anisotropy}}}function ne(ie,q){let me=!1;ie.__webglInit===void 0&&(ie.__webglInit=!0,q.addEventListener("dispose",T));const ve=q.source;let Te=m.get(ve);Te===void 0&&(Te={},m.set(ve,Te));const ke=$(q);if(ke!==ie.__cacheKey){Te[ke]===void 0&&(Te[ke]={texture:r.createTexture(),usedTimes:0},a.memory.textures++,me=!0),Te[ke].usedTimes++;const He=Te[ie.__cacheKey];He!==void 0&&(Te[ie.__cacheKey].usedTimes--,He.usedTimes===0&&N(q)),ie.__cacheKey=ke,ie.__webglTexture=Te[ke].texture}return me}function ge(ie,q,me){let ve=r.TEXTURE_2D;(q.isDataArrayTexture||q.isCompressedArrayTexture)&&(ve=r.TEXTURE_2D_ARRAY),q.isData3DTexture&&(ve=r.TEXTURE_3D);const Te=ne(ie,q),ke=q.source;n.bindTexture(ve,ie.__webglTexture,r.TEXTURE0+me);const He=i.get(ke);if(ke.version!==He.__version||Te===!0){n.activeTexture(r.TEXTURE0+me);const Ue=dn.getPrimaries(dn.workingColorSpace),We=q.colorSpace===ih?null:dn.getPrimaries(q.colorSpace),ct=q.colorSpace===ih||Ue===We?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,q.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,q.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,ct);let Ye=x(q.image,!1,s.maxTextureSize);Ye=_e(q,Ye);const lt=o.convert(q.format,q.colorSpace),Lt=o.convert(q.type);let Bt=O(q.internalFormat,lt,Lt,q.colorSpace,q.isVideoTexture);ee(ve,q);let gt;const ei=q.mipmaps,wi=q.isVideoTexture!==!0,Me=He.__version===void 0||Te===!0,Ve=ke.dataReady,xe=_(q,Ye);if(q.isDepthTexture)Bt=r.DEPTH_COMPONENT16,q.type===Ea?Bt=r.DEPTH_COMPONENT32F:q.type===tp?Bt=r.DEPTH_COMPONENT24:q.type===a0&&(Bt=r.DEPTH24_STENCIL8),Me&&(wi?n.texStorage2D(r.TEXTURE_2D,1,Bt,Ye.width,Ye.height):n.texImage2D(r.TEXTURE_2D,0,Bt,Ye.width,Ye.height,0,lt,Lt,null));else if(q.isDataTexture)if(ei.length>0){wi&&Me&&n.texStorage2D(r.TEXTURE_2D,xe,Bt,ei[0].width,ei[0].height);for(let Fe=0,Ge=ei.length;Fe<Ge;Fe++)gt=ei[Fe],wi?Ve&&n.texSubImage2D(r.TEXTURE_2D,Fe,0,0,gt.width,gt.height,lt,Lt,gt.data):n.texImage2D(r.TEXTURE_2D,Fe,Bt,gt.width,gt.height,0,lt,Lt,gt.data);q.generateMipmaps=!1}else wi?(Me&&n.texStorage2D(r.TEXTURE_2D,xe,Bt,Ye.width,Ye.height),Ve&&n.texSubImage2D(r.TEXTURE_2D,0,0,0,Ye.width,Ye.height,lt,Lt,Ye.data)):n.texImage2D(r.TEXTURE_2D,0,Bt,Ye.width,Ye.height,0,lt,Lt,Ye.data);else if(q.isCompressedTexture)if(q.isCompressedArrayTexture){wi&&Me&&n.texStorage3D(r.TEXTURE_2D_ARRAY,xe,Bt,ei[0].width,ei[0].height,Ye.depth);for(let Fe=0,Ge=ei.length;Fe<Ge;Fe++)gt=ei[Fe],q.format!==_o?lt!==null?wi?Ve&&n.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,Fe,0,0,0,gt.width,gt.height,Ye.depth,lt,gt.data,0,0):n.compressedTexImage3D(r.TEXTURE_2D_ARRAY,Fe,Bt,gt.width,gt.height,Ye.depth,0,gt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):wi?Ve&&n.texSubImage3D(r.TEXTURE_2D_ARRAY,Fe,0,0,0,gt.width,gt.height,Ye.depth,lt,Lt,gt.data):n.texImage3D(r.TEXTURE_2D_ARRAY,Fe,Bt,gt.width,gt.height,Ye.depth,0,lt,Lt,gt.data)}else{wi&&Me&&n.texStorage2D(r.TEXTURE_2D,xe,Bt,ei[0].width,ei[0].height);for(let Fe=0,Ge=ei.length;Fe<Ge;Fe++)gt=ei[Fe],q.format!==_o?lt!==null?wi?Ve&&n.compressedTexSubImage2D(r.TEXTURE_2D,Fe,0,0,gt.width,gt.height,lt,gt.data):n.compressedTexImage2D(r.TEXTURE_2D,Fe,Bt,gt.width,gt.height,0,gt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):wi?Ve&&n.texSubImage2D(r.TEXTURE_2D,Fe,0,0,gt.width,gt.height,lt,Lt,gt.data):n.texImage2D(r.TEXTURE_2D,Fe,Bt,gt.width,gt.height,0,lt,Lt,gt.data)}else if(q.isDataArrayTexture)wi?(Me&&n.texStorage3D(r.TEXTURE_2D_ARRAY,xe,Bt,Ye.width,Ye.height,Ye.depth),Ve&&n.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,Ye.width,Ye.height,Ye.depth,lt,Lt,Ye.data)):n.texImage3D(r.TEXTURE_2D_ARRAY,0,Bt,Ye.width,Ye.height,Ye.depth,0,lt,Lt,Ye.data);else if(q.isData3DTexture)wi?(Me&&n.texStorage3D(r.TEXTURE_3D,xe,Bt,Ye.width,Ye.height,Ye.depth),Ve&&n.texSubImage3D(r.TEXTURE_3D,0,0,0,0,Ye.width,Ye.height,Ye.depth,lt,Lt,Ye.data)):n.texImage3D(r.TEXTURE_3D,0,Bt,Ye.width,Ye.height,Ye.depth,0,lt,Lt,Ye.data);else if(q.isFramebufferTexture){if(Me)if(wi)n.texStorage2D(r.TEXTURE_2D,xe,Bt,Ye.width,Ye.height);else{let Fe=Ye.width,Ge=Ye.height;for(let at=0;at<xe;at++)n.texImage2D(r.TEXTURE_2D,at,Bt,Fe,Ge,0,lt,Lt,null),Fe>>=1,Ge>>=1}}else if(ei.length>0){if(wi&&Me){const Fe=Re(ei[0]);n.texStorage2D(r.TEXTURE_2D,xe,Bt,Fe.width,Fe.height)}for(let Fe=0,Ge=ei.length;Fe<Ge;Fe++)gt=ei[Fe],wi?Ve&&n.texSubImage2D(r.TEXTURE_2D,Fe,0,0,lt,Lt,gt):n.texImage2D(r.TEXTURE_2D,Fe,Bt,lt,Lt,gt);q.generateMipmaps=!1}else if(wi){if(Me){const Fe=Re(Ye);n.texStorage2D(r.TEXTURE_2D,xe,Bt,Fe.width,Fe.height)}Ve&&n.texSubImage2D(r.TEXTURE_2D,0,0,0,lt,Lt,Ye)}else n.texImage2D(r.TEXTURE_2D,0,Bt,lt,Lt,Ye);w(q)&&S(ve),He.__version=ke.version,q.onUpdate&&q.onUpdate(q)}ie.__version=q.version}function ye(ie,q,me){if(q.image.length!==6)return;const ve=ne(ie,q),Te=q.source;n.bindTexture(r.TEXTURE_CUBE_MAP,ie.__webglTexture,r.TEXTURE0+me);const ke=i.get(Te);if(Te.version!==ke.__version||ve===!0){n.activeTexture(r.TEXTURE0+me);const He=dn.getPrimaries(dn.workingColorSpace),Ue=q.colorSpace===ih?null:dn.getPrimaries(q.colorSpace),We=q.colorSpace===ih||He===Ue?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,q.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,q.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,We);const ct=q.isCompressedTexture||q.image[0].isCompressedTexture,Ye=q.image[0]&&q.image[0].isDataTexture,lt=[];for(let Ge=0;Ge<6;Ge++)!ct&&!Ye?lt[Ge]=x(q.image[Ge],!0,s.maxCubemapSize):lt[Ge]=Ye?q.image[Ge].image:q.image[Ge],lt[Ge]=_e(q,lt[Ge]);const Lt=lt[0],Bt=o.convert(q.format,q.colorSpace),gt=o.convert(q.type),ei=O(q.internalFormat,Bt,gt,q.colorSpace),wi=q.isVideoTexture!==!0,Me=ke.__version===void 0||ve===!0,Ve=Te.dataReady;let xe=_(q,Lt);ee(r.TEXTURE_CUBE_MAP,q);let Fe;if(ct){wi&&Me&&n.texStorage2D(r.TEXTURE_CUBE_MAP,xe,ei,Lt.width,Lt.height);for(let Ge=0;Ge<6;Ge++){Fe=lt[Ge].mipmaps;for(let at=0;at<Fe.length;at++){const vt=Fe[at];q.format!==_o?Bt!==null?wi?Ve&&n.compressedTexSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,at,0,0,vt.width,vt.height,Bt,vt.data):n.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,at,ei,vt.width,vt.height,0,vt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):wi?Ve&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,at,0,0,vt.width,vt.height,Bt,gt,vt.data):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,at,ei,vt.width,vt.height,0,Bt,gt,vt.data)}}}else{if(Fe=q.mipmaps,wi&&Me){Fe.length>0&&xe++;const Ge=Re(lt[0]);n.texStorage2D(r.TEXTURE_CUBE_MAP,xe,ei,Ge.width,Ge.height)}for(let Ge=0;Ge<6;Ge++)if(Ye){wi?Ve&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,0,0,lt[Ge].width,lt[Ge].height,Bt,gt,lt[Ge].data):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,ei,lt[Ge].width,lt[Ge].height,0,Bt,gt,lt[Ge].data);for(let at=0;at<Fe.length;at++){const Vi=Fe[at].image[Ge].image;wi?Ve&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,at+1,0,0,Vi.width,Vi.height,Bt,gt,Vi.data):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,at+1,ei,Vi.width,Vi.height,0,Bt,gt,Vi.data)}}else{wi?Ve&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,0,0,Bt,gt,lt[Ge]):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,ei,Bt,gt,lt[Ge]);for(let at=0;at<Fe.length;at++){const vt=Fe[at];wi?Ve&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,at+1,0,0,Bt,gt,vt.image[Ge]):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,at+1,ei,Bt,gt,vt.image[Ge])}}}w(q)&&S(r.TEXTURE_CUBE_MAP),ke.__version=Te.version,q.onUpdate&&q.onUpdate(q)}ie.__version=q.version}function ce(ie,q,me,ve,Te,ke){const He=o.convert(me.format,me.colorSpace),Ue=o.convert(me.type),We=O(me.internalFormat,He,Ue,me.colorSpace);if(!i.get(q).__hasExternalTextures){const Ye=Math.max(1,q.width>>ke),lt=Math.max(1,q.height>>ke);Te===r.TEXTURE_3D||Te===r.TEXTURE_2D_ARRAY?n.texImage3D(Te,ke,We,Ye,lt,q.depth,0,He,Ue,null):n.texImage2D(Te,ke,We,Ye,lt,0,He,Ue,null)}n.bindFramebuffer(r.FRAMEBUFFER,ie),he(q)?l.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,ve,Te,i.get(me).__webglTexture,0,Z(q)):(Te===r.TEXTURE_2D||Te>=r.TEXTURE_CUBE_MAP_POSITIVE_X&&Te<=r.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&r.framebufferTexture2D(r.FRAMEBUFFER,ve,Te,i.get(me).__webglTexture,ke),n.bindFramebuffer(r.FRAMEBUFFER,null)}function we(ie,q,me){if(r.bindRenderbuffer(r.RENDERBUFFER,ie),q.depthBuffer&&!q.stencilBuffer){let ve=r.DEPTH_COMPONENT24;if(me||he(q)){const Te=q.depthTexture;Te&&Te.isDepthTexture&&(Te.type===Ea?ve=r.DEPTH_COMPONENT32F:Te.type===tp&&(ve=r.DEPTH_COMPONENT24));const ke=Z(q);he(q)?l.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,ke,ve,q.width,q.height):r.renderbufferStorageMultisample(r.RENDERBUFFER,ke,ve,q.width,q.height)}else r.renderbufferStorage(r.RENDERBUFFER,ve,q.width,q.height);r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,ie)}else if(q.depthBuffer&&q.stencilBuffer){const ve=Z(q);me&&he(q)===!1?r.renderbufferStorageMultisample(r.RENDERBUFFER,ve,r.DEPTH24_STENCIL8,q.width,q.height):he(q)?l.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,ve,r.DEPTH24_STENCIL8,q.width,q.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,q.width,q.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,ie)}else{const ve=q.textures;for(let Te=0;Te<ve.length;Te++){const ke=ve[Te],He=o.convert(ke.format,ke.colorSpace),Ue=o.convert(ke.type),We=O(ke.internalFormat,He,Ue,ke.colorSpace),ct=Z(q);me&&he(q)===!1?r.renderbufferStorageMultisample(r.RENDERBUFFER,ct,We,q.width,q.height):he(q)?l.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,ct,We,q.width,q.height):r.renderbufferStorage(r.RENDERBUFFER,We,q.width,q.height)}}r.bindRenderbuffer(r.RENDERBUFFER,null)}function be(ie,q){if(q&&q.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(r.FRAMEBUFFER,ie),!(q.depthTexture&&q.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(q.depthTexture).__webglTexture||q.depthTexture.image.width!==q.width||q.depthTexture.image.height!==q.height)&&(q.depthTexture.image.width=q.width,q.depthTexture.image.height=q.height,q.depthTexture.needsUpdate=!0),I(q.depthTexture,0);const ve=i.get(q.depthTexture).__webglTexture,Te=Z(q);if(q.depthTexture.format===$f)he(q)?l.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,ve,0,Te):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,ve,0);else if(q.depthTexture.format===$g)he(q)?l.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,ve,0,Te):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,ve,0);else throw new Error("Unknown depthTexture format")}function se(ie){const q=i.get(ie),me=ie.isWebGLCubeRenderTarget===!0;if(ie.depthTexture&&!q.__autoAllocateDepthBuffer){if(me)throw new Error("target.depthTexture not supported in Cube render targets");be(q.__webglFramebuffer,ie)}else if(me){q.__webglDepthbuffer=[];for(let ve=0;ve<6;ve++)n.bindFramebuffer(r.FRAMEBUFFER,q.__webglFramebuffer[ve]),q.__webglDepthbuffer[ve]=r.createRenderbuffer(),we(q.__webglDepthbuffer[ve],ie,!1)}else n.bindFramebuffer(r.FRAMEBUFFER,q.__webglFramebuffer),q.__webglDepthbuffer=r.createRenderbuffer(),we(q.__webglDepthbuffer,ie,!1);n.bindFramebuffer(r.FRAMEBUFFER,null)}function ae(ie,q,me){const ve=i.get(ie);q!==void 0&&ce(ve.__webglFramebuffer,ie,ie.texture,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,0),me!==void 0&&se(ie)}function Q(ie){const q=ie.texture,me=i.get(ie),ve=i.get(q);ie.addEventListener("dispose",A);const Te=ie.textures,ke=ie.isWebGLCubeRenderTarget===!0,He=Te.length>1;if(He||(ve.__webglTexture===void 0&&(ve.__webglTexture=r.createTexture()),ve.__version=q.version,a.memory.textures++),ke){me.__webglFramebuffer=[];for(let Ue=0;Ue<6;Ue++)if(q.mipmaps&&q.mipmaps.length>0){me.__webglFramebuffer[Ue]=[];for(let We=0;We<q.mipmaps.length;We++)me.__webglFramebuffer[Ue][We]=r.createFramebuffer()}else me.__webglFramebuffer[Ue]=r.createFramebuffer()}else{if(q.mipmaps&&q.mipmaps.length>0){me.__webglFramebuffer=[];for(let Ue=0;Ue<q.mipmaps.length;Ue++)me.__webglFramebuffer[Ue]=r.createFramebuffer()}else me.__webglFramebuffer=r.createFramebuffer();if(He)for(let Ue=0,We=Te.length;Ue<We;Ue++){const ct=i.get(Te[Ue]);ct.__webglTexture===void 0&&(ct.__webglTexture=r.createTexture(),a.memory.textures++)}if(ie.samples>0&&he(ie)===!1){me.__webglMultisampledFramebuffer=r.createFramebuffer(),me.__webglColorRenderbuffer=[],n.bindFramebuffer(r.FRAMEBUFFER,me.__webglMultisampledFramebuffer);for(let Ue=0;Ue<Te.length;Ue++){const We=Te[Ue];me.__webglColorRenderbuffer[Ue]=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,me.__webglColorRenderbuffer[Ue]);const ct=o.convert(We.format,We.colorSpace),Ye=o.convert(We.type),lt=O(We.internalFormat,ct,Ye,We.colorSpace,ie.isXRRenderTarget===!0),Lt=Z(ie);r.renderbufferStorageMultisample(r.RENDERBUFFER,Lt,lt,ie.width,ie.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+Ue,r.RENDERBUFFER,me.__webglColorRenderbuffer[Ue])}r.bindRenderbuffer(r.RENDERBUFFER,null),ie.depthBuffer&&(me.__webglDepthRenderbuffer=r.createRenderbuffer(),we(me.__webglDepthRenderbuffer,ie,!0)),n.bindFramebuffer(r.FRAMEBUFFER,null)}}if(ke){n.bindTexture(r.TEXTURE_CUBE_MAP,ve.__webglTexture),ee(r.TEXTURE_CUBE_MAP,q);for(let Ue=0;Ue<6;Ue++)if(q.mipmaps&&q.mipmaps.length>0)for(let We=0;We<q.mipmaps.length;We++)ce(me.__webglFramebuffer[Ue][We],ie,q,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,We);else ce(me.__webglFramebuffer[Ue],ie,q,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0);w(q)&&S(r.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(He){for(let Ue=0,We=Te.length;Ue<We;Ue++){const ct=Te[Ue],Ye=i.get(ct);n.bindTexture(r.TEXTURE_2D,Ye.__webglTexture),ee(r.TEXTURE_2D,ct),ce(me.__webglFramebuffer,ie,ct,r.COLOR_ATTACHMENT0+Ue,r.TEXTURE_2D,0),w(ct)&&S(r.TEXTURE_2D)}n.unbindTexture()}else{let Ue=r.TEXTURE_2D;if((ie.isWebGL3DRenderTarget||ie.isWebGLArrayRenderTarget)&&(Ue=ie.isWebGL3DRenderTarget?r.TEXTURE_3D:r.TEXTURE_2D_ARRAY),n.bindTexture(Ue,ve.__webglTexture),ee(Ue,q),q.mipmaps&&q.mipmaps.length>0)for(let We=0;We<q.mipmaps.length;We++)ce(me.__webglFramebuffer[We],ie,q,r.COLOR_ATTACHMENT0,Ue,We);else ce(me.__webglFramebuffer,ie,q,r.COLOR_ATTACHMENT0,Ue,0);w(q)&&S(Ue),n.unbindTexture()}ie.depthBuffer&&se(ie)}function z(ie){const q=ie.textures;for(let me=0,ve=q.length;me<ve;me++){const Te=q[me];if(w(Te)){const ke=ie.isWebGLCubeRenderTarget?r.TEXTURE_CUBE_MAP:r.TEXTURE_2D,He=i.get(Te).__webglTexture;n.bindTexture(ke,He),S(ke),n.unbindTexture()}}}const j=[],te=[];function W(ie){if(ie.samples>0){if(he(ie)===!1){const q=ie.textures,me=ie.width,ve=ie.height;let Te=r.COLOR_BUFFER_BIT;const ke=ie.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,He=i.get(ie),Ue=q.length>1;if(Ue)for(let We=0;We<q.length;We++)n.bindFramebuffer(r.FRAMEBUFFER,He.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+We,r.RENDERBUFFER,null),n.bindFramebuffer(r.FRAMEBUFFER,He.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+We,r.TEXTURE_2D,null,0);n.bindFramebuffer(r.READ_FRAMEBUFFER,He.__webglMultisampledFramebuffer),n.bindFramebuffer(r.DRAW_FRAMEBUFFER,He.__webglFramebuffer);for(let We=0;We<q.length;We++){if(ie.resolveDepthBuffer&&(ie.depthBuffer&&(Te|=r.DEPTH_BUFFER_BIT),ie.stencilBuffer&&ie.resolveStencilBuffer&&(Te|=r.STENCIL_BUFFER_BIT)),Ue){r.framebufferRenderbuffer(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,He.__webglColorRenderbuffer[We]);const ct=i.get(q[We]).__webglTexture;r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,ct,0)}r.blitFramebuffer(0,0,me,ve,0,0,me,ve,Te,r.NEAREST),h===!0&&(j.length=0,te.length=0,j.push(r.COLOR_ATTACHMENT0+We),ie.depthBuffer&&ie.resolveDepthBuffer===!1&&(j.push(ke),te.push(ke),r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,te)),r.invalidateFramebuffer(r.READ_FRAMEBUFFER,j))}if(n.bindFramebuffer(r.READ_FRAMEBUFFER,null),n.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),Ue)for(let We=0;We<q.length;We++){n.bindFramebuffer(r.FRAMEBUFFER,He.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+We,r.RENDERBUFFER,He.__webglColorRenderbuffer[We]);const ct=i.get(q[We]).__webglTexture;n.bindFramebuffer(r.FRAMEBUFFER,He.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+We,r.TEXTURE_2D,ct,0)}n.bindFramebuffer(r.DRAW_FRAMEBUFFER,He.__webglMultisampledFramebuffer)}else if(ie.depthBuffer&&ie.resolveDepthBuffer===!1&&h){const q=ie.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,[q])}}}function Z(ie){return Math.min(s.maxSamples,ie.samples)}function he(ie){const q=i.get(ie);return ie.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&q.__useRenderToTexture!==!1}function pe(ie){const q=a.render.frame;f.get(ie)!==q&&(f.set(ie,q),ie.update())}function _e(ie,q){const me=ie.colorSpace,ve=ie.format,Te=ie.type;return ie.isCompressedTexture===!0||ie.isVideoTexture===!0||me!==ns&&me!==ih&&(dn.getTransfer(me)===kn?(ve!==_o||Te!==bl)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",me)),q}function Re(ie){return typeof HTMLImageElement<"u"&&ie instanceof HTMLImageElement?(u.width=ie.naturalWidth||ie.width,u.height=ie.naturalHeight||ie.height):typeof VideoFrame<"u"&&ie instanceof VideoFrame?(u.width=ie.displayWidth,u.height=ie.displayHeight):(u.width=ie.width,u.height=ie.height),u}this.allocateTextureUnit=D,this.resetTextureUnits=E,this.setTexture2D=I,this.setTexture2DArray=L,this.setTexture3D=U,this.setTextureCube=V,this.rebindTextures=ae,this.setupRenderTarget=Q,this.updateRenderTargetMipmap=z,this.updateMultisampleRenderTarget=W,this.setupDepthRenderbuffer=se,this.setupFrameBufferTexture=ce,this.useMultisampledRTT=he}function NG(r,e){function n(i,s=ih){let o;const a=dn.getTransfer(s);if(i===bl)return r.UNSIGNED_BYTE;if(i===PI)return r.UNSIGNED_SHORT_4_4_4_4;if(i===RI)return r.UNSIGNED_SHORT_5_5_5_1;if(i===KW)return r.UNSIGNED_INT_5_9_9_9_REV;if(i===qW)return r.BYTE;if(i===ZW)return r.SHORT;if(i===AI)return r.UNSIGNED_SHORT;if(i===kI)return r.INT;if(i===tp)return r.UNSIGNED_INT;if(i===Ea)return r.FLOAT;if(i===o0)return r.HALF_FLOAT;if(i===JW)return r.ALPHA;if(i===eG)return r.RGB;if(i===_o)return r.RGBA;if(i===tG)return r.LUMINANCE;if(i===iG)return r.LUMINANCE_ALPHA;if(i===$f)return r.DEPTH_COMPONENT;if(i===$g)return r.DEPTH_STENCIL;if(i===II)return r.RED;if(i===NI)return r.RED_INTEGER;if(i===nG)return r.RG;if(i===DI)return r.RG_INTEGER;if(i===LI)return r.RGBA_INTEGER;if(i===CO||i===TO||i===EO||i===MO)if(a===kn)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(i===CO)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===TO)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===EO)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===MO)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(i===CO)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===TO)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===EO)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===MO)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===sP||i===oP||i===aP||i===lP)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(i===sP)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===oP)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===aP)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===lP)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===cP||i===hP||i===uP)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(i===cP||i===hP)return a===kn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(i===uP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===dP||i===fP||i===pP||i===mP||i===gP||i===vP||i===yP||i===bP||i===xP||i===wP||i===_P||i===OP||i===SP||i===CP)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(i===dP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===fP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===pP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===mP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===gP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===vP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===yP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===bP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===xP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===wP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===_P)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===OP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===SP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===CP)return a===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===AO||i===TP||i===EP)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(i===AO)return a===kn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===TP)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===EP)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===rG||i===MP||i===AP||i===kP)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(i===AO)return o.COMPRESSED_RED_RGTC1_EXT;if(i===MP)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===AP)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===kP)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===a0?r.UNSIGNED_INT_24_8:r[i]!==void 0?r[i]:null}return{convert:n}}class DG extends fn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let qs=class extends Li{constructor(){super(),this.isGroup=!0,this.type="Group"}};const nwe={type:"move"};class lM{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new qs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new qs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new le,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new le),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new qs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new le,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new le),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let s=null,o=null,a=null;const l=this._targetRay,h=this._grip,u=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(u&&e.hand){a=!0;for(const x of e.hand.values()){const w=n.getJointPose(x,i),S=this._getHandJoint(u,x);w!==null&&(S.matrix.fromArray(w.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=w.radius),S.visible=w!==null}const f=u.joints["index-finger-tip"],p=u.joints["thumb-tip"],m=f.position.distanceTo(p.position),v=.02,y=.005;u.inputState.pinching&&m>v+y?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&m<=v-y&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(o=n.getPose(e.gripSpace,i),o!==null&&(h.matrix.fromArray(o.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,o.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(o.linearVelocity)):h.hasLinearVelocity=!1,o.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(o.angularVelocity)):h.hasAngularVelocity=!1));l!==null&&(s=n.getPose(e.targetRaySpace,i),s===null&&o!==null&&(s=o),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(nwe)))}return l!==null&&(l.visible=s!==null),h!==null&&(h.visible=o!==null),u!==null&&(u.visible=a!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new qs;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}const rwe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,swe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class owe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){const s=new qn,o=e.properties.get(s);o.__webglTexture=n.texture,(n.depthNear!=i.depthNear||n.depthFar!=i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=s}}render(e,n){if(this.texture!==null){if(this.mesh===null){const i=n.cameras[0].viewport,s=new io({vertexShader:rwe,fragmentShader:swe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:i.z},depthHeight:{value:i.w}}});this.mesh=new ln(new yd(20,20),s)}e.render(this.mesh,n)}}reset(){this.texture=null,this.mesh=null}}class awe extends bc{constructor(e,n){super();const i=this;let s=null,o=1,a=null,l="local-floor",h=1,u=null,f=null,p=null,m=null,v=null,y=null;const x=new owe,w=n.getContextAttributes();let S=null,O=null;const _=[],T=[],A=new Xe;let P=null;const N=new fn;N.layers.enable(1),N.viewport=new Ni;const k=new fn;k.layers.enable(2),k.viewport=new Ni;const R=[N,k],E=new DG;E.layers.enable(1),E.layers.enable(2);let D=null,$=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ce){let we=_[ce];return we===void 0&&(we=new lM,_[ce]=we),we.getTargetRaySpace()},this.getControllerGrip=function(ce){let we=_[ce];return we===void 0&&(we=new lM,_[ce]=we),we.getGripSpace()},this.getHand=function(ce){let we=_[ce];return we===void 0&&(we=new lM,_[ce]=we),we.getHandSpace()};function I(ce){const we=T.indexOf(ce.inputSource);if(we===-1)return;const be=_[we];be!==void 0&&(be.update(ce.inputSource,ce.frame,u||a),be.dispatchEvent({type:ce.type,data:ce.inputSource}))}function L(){s.removeEventListener("select",I),s.removeEventListener("selectstart",I),s.removeEventListener("selectend",I),s.removeEventListener("squeeze",I),s.removeEventListener("squeezestart",I),s.removeEventListener("squeezeend",I),s.removeEventListener("end",L),s.removeEventListener("inputsourceschange",U);for(let ce=0;ce<_.length;ce++){const we=T[ce];we!==null&&(T[ce]=null,_[ce].disconnect(we))}D=null,$=null,x.reset(),e.setRenderTarget(S),v=null,m=null,p=null,s=null,O=null,ye.stop(),i.isPresenting=!1,e.setPixelRatio(P),e.setSize(A.width,A.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ce){o=ce,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ce){l=ce,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(ce){u=ce},this.getBaseLayer=function(){return m!==null?m:v},this.getBinding=function(){return p},this.getFrame=function(){return y},this.getSession=function(){return s},this.setSession=async function(ce){if(s=ce,s!==null){if(S=e.getRenderTarget(),s.addEventListener("select",I),s.addEventListener("selectstart",I),s.addEventListener("selectend",I),s.addEventListener("squeeze",I),s.addEventListener("squeezestart",I),s.addEventListener("squeezeend",I),s.addEventListener("end",L),s.addEventListener("inputsourceschange",U),w.xrCompatible!==!0&&await n.makeXRCompatible(),P=e.getPixelRatio(),e.getSize(A),s.renderState.layers===void 0){const we={antialias:w.antialias,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:o};v=new XRWebGLLayer(s,n,we),s.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),O=new La(v.framebufferWidth,v.framebufferHeight,{format:_o,type:bl,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil})}else{let we=null,be=null,se=null;w.depth&&(se=w.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,we=w.stencil?$g:$f,be=w.stencil?a0:tp);const ae={colorFormat:n.RGBA8,depthFormat:se,scaleFactor:o};p=new XRWebGLBinding(s,n),m=p.createProjectionLayer(ae),s.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),O=new La(m.textureWidth,m.textureHeight,{format:_o,type:bl,depthTexture:new WI(m.textureWidth,m.textureHeight,be,void 0,void 0,void 0,void 0,void 0,void 0,we),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0,resolveDepthBuffer:m.ignoreDepthValues===!1})}O.isXRRenderTarget=!0,this.setFoveation(h),u=null,a=await s.requestReferenceSpace(l),ye.setContext(s),ye.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode};function U(ce){for(let we=0;we<ce.removed.length;we++){const be=ce.removed[we],se=T.indexOf(be);se>=0&&(T[se]=null,_[se].disconnect(be))}for(let we=0;we<ce.added.length;we++){const be=ce.added[we];let se=T.indexOf(be);if(se===-1){for(let Q=0;Q<_.length;Q++)if(Q>=T.length){T.push(be),se=Q;break}else if(T[Q]===null){T[Q]=be,se=Q;break}if(se===-1)break}const ae=_[se];ae&&ae.connect(be)}}const V=new le,X=new le;function H(ce,we,be){V.setFromMatrixPosition(we.matrixWorld),X.setFromMatrixPosition(be.matrixWorld);const se=V.distanceTo(X),ae=we.projectionMatrix.elements,Q=be.projectionMatrix.elements,z=ae[14]/(ae[10]-1),j=ae[14]/(ae[10]+1),te=(ae[9]+1)/ae[5],W=(ae[9]-1)/ae[5],Z=(ae[8]-1)/ae[0],he=(Q[8]+1)/Q[0],pe=z*Z,_e=z*he,Re=se/(-Z+he),ie=Re*-Z;we.matrixWorld.decompose(ce.position,ce.quaternion,ce.scale),ce.translateX(ie),ce.translateZ(Re),ce.matrixWorld.compose(ce.position,ce.quaternion,ce.scale),ce.matrixWorldInverse.copy(ce.matrixWorld).invert();const q=z+Re,me=j+Re,ve=pe-ie,Te=_e+(se-ie),ke=te*j/me*q,He=W*j/me*q;ce.projectionMatrix.makePerspective(ve,Te,ke,He,q,me),ce.projectionMatrixInverse.copy(ce.projectionMatrix).invert()}function J(ce,we){we===null?ce.matrixWorld.copy(ce.matrix):ce.matrixWorld.multiplyMatrices(we.matrixWorld,ce.matrix),ce.matrixWorldInverse.copy(ce.matrixWorld).invert()}this.updateCamera=function(ce){if(s===null)return;x.texture!==null&&(ce.near=x.depthNear,ce.far=x.depthFar),E.near=k.near=N.near=ce.near,E.far=k.far=N.far=ce.far,(D!==E.near||$!==E.far)&&(s.updateRenderState({depthNear:E.near,depthFar:E.far}),D=E.near,$=E.far,N.near=D,N.far=$,k.near=D,k.far=$,N.updateProjectionMatrix(),k.updateProjectionMatrix(),ce.updateProjectionMatrix());const we=ce.parent,be=E.cameras;J(E,we);for(let se=0;se<be.length;se++)J(be[se],we);be.length===2?H(E,N,k):E.projectionMatrix.copy(N.projectionMatrix),ee(ce,E,we)};function ee(ce,we,be){be===null?ce.matrix.copy(we.matrixWorld):(ce.matrix.copy(be.matrixWorld),ce.matrix.invert(),ce.matrix.multiply(we.matrixWorld)),ce.matrix.decompose(ce.position,ce.quaternion,ce.scale),ce.updateMatrixWorld(!0),ce.projectionMatrix.copy(we.projectionMatrix),ce.projectionMatrixInverse.copy(we.projectionMatrixInverse),ce.isPerspectiveCamera&&(ce.fov=Ug*2*Math.atan(1/ce.projectionMatrix.elements[5]),ce.zoom=1)}this.getCamera=function(){return E},this.getFoveation=function(){if(!(m===null&&v===null))return h},this.setFoveation=function(ce){h=ce,m!==null&&(m.fixedFoveation=ce),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=ce)},this.hasDepthSensing=function(){return x.texture!==null};let ne=null;function ge(ce,we){if(f=we.getViewerPose(u||a),y=we,f!==null){const be=f.views;v!==null&&(e.setRenderTargetFramebuffer(O,v.framebuffer),e.setRenderTarget(O));let se=!1;be.length!==E.cameras.length&&(E.cameras.length=0,se=!0);for(let Q=0;Q<be.length;Q++){const z=be[Q];let j=null;if(v!==null)j=v.getViewport(z);else{const W=p.getViewSubImage(m,z);j=W.viewport,Q===0&&(e.setRenderTargetTextures(O,W.colorTexture,m.ignoreDepthValues?void 0:W.depthStencilTexture),e.setRenderTarget(O))}let te=R[Q];te===void 0&&(te=new fn,te.layers.enable(Q),te.viewport=new Ni,R[Q]=te),te.matrix.fromArray(z.transform.matrix),te.matrix.decompose(te.position,te.quaternion,te.scale),te.projectionMatrix.fromArray(z.projectionMatrix),te.projectionMatrixInverse.copy(te.projectionMatrix).invert(),te.viewport.set(j.x,j.y,j.width,j.height),Q===0&&(E.matrix.copy(te.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),se===!0&&E.cameras.push(te)}const ae=s.enabledFeatures;if(ae&&ae.includes("depth-sensing")){const Q=p.getDepthInformation(be[0]);Q&&Q.isValid&&Q.texture&&x.init(e,Q,s.renderState)}}for(let be=0;be<_.length;be++){const se=T[be],ae=_[be];se!==null&&ae!==void 0&&ae.update(se,we,u||a)}x.render(e,E),ne&&ne(ce,we),we.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:we}),y=null}const ye=new MG;ye.setAnimationLoop(ge),this.setAnimationLoop=function(ce){ne=ce},this.dispose=function(){}}}const Qd=new Vr,lwe=new dt;function cwe(r,e){function n(w,S){w.matrixAutoUpdate===!0&&w.updateMatrix(),S.value.copy(w.matrix)}function i(w,S){S.color.getRGB(w.fogColor.value,CG(r)),S.isFog?(w.fogNear.value=S.near,w.fogFar.value=S.far):S.isFogExp2&&(w.fogDensity.value=S.density)}function s(w,S,O,_,T){S.isMeshBasicMaterial||S.isMeshLambertMaterial?o(w,S):S.isMeshToonMaterial?(o(w,S),p(w,S)):S.isMeshPhongMaterial?(o(w,S),f(w,S)):S.isMeshStandardMaterial?(o(w,S),m(w,S),S.isMeshPhysicalMaterial&&v(w,S,T)):S.isMeshMatcapMaterial?(o(w,S),y(w,S)):S.isMeshDepthMaterial?o(w,S):S.isMeshDistanceMaterial?(o(w,S),x(w,S)):S.isMeshNormalMaterial?o(w,S):S.isLineBasicMaterial?(a(w,S),S.isLineDashedMaterial&&l(w,S)):S.isPointsMaterial?h(w,S,O,_):S.isSpriteMaterial?u(w,S):S.isShadowMaterial?(w.color.value.copy(S.color),w.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function o(w,S){w.opacity.value=S.opacity,S.color&&w.diffuse.value.copy(S.color),S.emissive&&w.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(w.map.value=S.map,n(S.map,w.mapTransform)),S.alphaMap&&(w.alphaMap.value=S.alphaMap,n(S.alphaMap,w.alphaMapTransform)),S.bumpMap&&(w.bumpMap.value=S.bumpMap,n(S.bumpMap,w.bumpMapTransform),w.bumpScale.value=S.bumpScale,S.side===Rs&&(w.bumpScale.value*=-1)),S.normalMap&&(w.normalMap.value=S.normalMap,n(S.normalMap,w.normalMapTransform),w.normalScale.value.copy(S.normalScale),S.side===Rs&&w.normalScale.value.negate()),S.displacementMap&&(w.displacementMap.value=S.displacementMap,n(S.displacementMap,w.displacementMapTransform),w.displacementScale.value=S.displacementScale,w.displacementBias.value=S.displacementBias),S.emissiveMap&&(w.emissiveMap.value=S.emissiveMap,n(S.emissiveMap,w.emissiveMapTransform)),S.specularMap&&(w.specularMap.value=S.specularMap,n(S.specularMap,w.specularMapTransform)),S.alphaTest>0&&(w.alphaTest.value=S.alphaTest);const O=e.get(S),_=O.envMap,T=O.envMapRotation;if(_&&(w.envMap.value=_,Qd.copy(T),Qd.x*=-1,Qd.y*=-1,Qd.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(Qd.y*=-1,Qd.z*=-1),w.envMapRotation.value.setFromMatrix4(lwe.makeRotationFromEuler(Qd)),w.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=S.reflectivity,w.ior.value=S.ior,w.refractionRatio.value=S.refractionRatio),S.lightMap){w.lightMap.value=S.lightMap;const A=r._useLegacyLights===!0?Math.PI:1;w.lightMapIntensity.value=S.lightMapIntensity*A,n(S.lightMap,w.lightMapTransform)}S.aoMap&&(w.aoMap.value=S.aoMap,w.aoMapIntensity.value=S.aoMapIntensity,n(S.aoMap,w.aoMapTransform))}function a(w,S){w.diffuse.value.copy(S.color),w.opacity.value=S.opacity,S.map&&(w.map.value=S.map,n(S.map,w.mapTransform))}function l(w,S){w.dashSize.value=S.dashSize,w.totalSize.value=S.dashSize+S.gapSize,w.scale.value=S.scale}function h(w,S,O,_){w.diffuse.value.copy(S.color),w.opacity.value=S.opacity,w.size.value=S.size*O,w.scale.value=_*.5,S.map&&(w.map.value=S.map,n(S.map,w.uvTransform)),S.alphaMap&&(w.alphaMap.value=S.alphaMap,n(S.alphaMap,w.alphaMapTransform)),S.alphaTest>0&&(w.alphaTest.value=S.alphaTest)}function u(w,S){w.diffuse.value.copy(S.color),w.opacity.value=S.opacity,w.rotation.value=S.rotation,S.map&&(w.map.value=S.map,n(S.map,w.mapTransform)),S.alphaMap&&(w.alphaMap.value=S.alphaMap,n(S.alphaMap,w.alphaMapTransform)),S.alphaTest>0&&(w.alphaTest.value=S.alphaTest)}function f(w,S){w.specular.value.copy(S.specular),w.shininess.value=Math.max(S.shininess,1e-4)}function p(w,S){S.gradientMap&&(w.gradientMap.value=S.gradientMap)}function m(w,S){w.metalness.value=S.metalness,S.metalnessMap&&(w.metalnessMap.value=S.metalnessMap,n(S.metalnessMap,w.metalnessMapTransform)),w.roughness.value=S.roughness,S.roughnessMap&&(w.roughnessMap.value=S.roughnessMap,n(S.roughnessMap,w.roughnessMapTransform)),S.envMap&&(w.envMapIntensity.value=S.envMapIntensity)}function v(w,S,O){w.ior.value=S.ior,S.sheen>0&&(w.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),w.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(w.sheenColorMap.value=S.sheenColorMap,n(S.sheenColorMap,w.sheenColorMapTransform)),S.sheenRoughnessMap&&(w.sheenRoughnessMap.value=S.sheenRoughnessMap,n(S.sheenRoughnessMap,w.sheenRoughnessMapTransform))),S.clearcoat>0&&(w.clearcoat.value=S.clearcoat,w.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(w.clearcoatMap.value=S.clearcoatMap,n(S.clearcoatMap,w.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,n(S.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(w.clearcoatNormalMap.value=S.clearcoatNormalMap,n(S.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===Rs&&w.clearcoatNormalScale.value.negate())),S.dispersion>0&&(w.dispersion.value=S.dispersion),S.iridescence>0&&(w.iridescence.value=S.iridescence,w.iridescenceIOR.value=S.iridescenceIOR,w.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(w.iridescenceMap.value=S.iridescenceMap,n(S.iridescenceMap,w.iridescenceMapTransform)),S.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=S.iridescenceThicknessMap,n(S.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),S.transmission>0&&(w.transmission.value=S.transmission,w.transmissionSamplerMap.value=O.texture,w.transmissionSamplerSize.value.set(O.width,O.height),S.transmissionMap&&(w.transmissionMap.value=S.transmissionMap,n(S.transmissionMap,w.transmissionMapTransform)),w.thickness.value=S.thickness,S.thicknessMap&&(w.thicknessMap.value=S.thicknessMap,n(S.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=S.attenuationDistance,w.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(w.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(w.anisotropyMap.value=S.anisotropyMap,n(S.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=S.specularIntensity,w.specularColor.value.copy(S.specularColor),S.specularColorMap&&(w.specularColorMap.value=S.specularColorMap,n(S.specularColorMap,w.specularColorMapTransform)),S.specularIntensityMap&&(w.specularIntensityMap.value=S.specularIntensityMap,n(S.specularIntensityMap,w.specularIntensityMapTransform))}function y(w,S){S.matcap&&(w.matcap.value=S.matcap)}function x(w,S){const O=e.get(S).light;w.referencePosition.value.setFromMatrixPosition(O.matrixWorld),w.nearDistance.value=O.shadow.camera.near,w.farDistance.value=O.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:s}}function hwe(r,e,n,i){let s={},o={},a=[];const l=r.getParameter(r.MAX_UNIFORM_BUFFER_BINDINGS);function h(O,_){const T=_.program;i.uniformBlockBinding(O,T)}function u(O,_){let T=s[O.id];T===void 0&&(y(O),T=f(O),s[O.id]=T,O.addEventListener("dispose",w));const A=_.program;i.updateUBOMapping(O,A);const P=e.render.frame;o[O.id]!==P&&(m(O),o[O.id]=P)}function f(O){const _=p();O.__bindingPointIndex=_;const T=r.createBuffer(),A=O.__size,P=O.usage;return r.bindBuffer(r.UNIFORM_BUFFER,T),r.bufferData(r.UNIFORM_BUFFER,A,P),r.bindBuffer(r.UNIFORM_BUFFER,null),r.bindBufferBase(r.UNIFORM_BUFFER,_,T),T}function p(){for(let O=0;O<l;O++)if(a.indexOf(O)===-1)return a.push(O),O;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(O){const _=s[O.id],T=O.uniforms,A=O.__cache;r.bindBuffer(r.UNIFORM_BUFFER,_);for(let P=0,N=T.length;P<N;P++){const k=Array.isArray(T[P])?T[P]:[T[P]];for(let R=0,E=k.length;R<E;R++){const D=k[R];if(v(D,P,R,A)===!0){const $=D.__offset,I=Array.isArray(D.value)?D.value:[D.value];let L=0;for(let U=0;U<I.length;U++){const V=I[U],X=x(V);typeof V=="number"||typeof V=="boolean"?(D.__data[0]=V,r.bufferSubData(r.UNIFORM_BUFFER,$+L,D.__data)):V.isMatrix3?(D.__data[0]=V.elements[0],D.__data[1]=V.elements[1],D.__data[2]=V.elements[2],D.__data[3]=0,D.__data[4]=V.elements[3],D.__data[5]=V.elements[4],D.__data[6]=V.elements[5],D.__data[7]=0,D.__data[8]=V.elements[6],D.__data[9]=V.elements[7],D.__data[10]=V.elements[8],D.__data[11]=0):(V.toArray(D.__data,L),L+=X.storage/Float32Array.BYTES_PER_ELEMENT)}r.bufferSubData(r.UNIFORM_BUFFER,$,D.__data)}}}r.bindBuffer(r.UNIFORM_BUFFER,null)}function v(O,_,T,A){const P=O.value,N=_+"_"+T;if(A[N]===void 0)return typeof P=="number"||typeof P=="boolean"?A[N]=P:A[N]=P.clone(),!0;{const k=A[N];if(typeof P=="number"||typeof P=="boolean"){if(k!==P)return A[N]=P,!0}else if(k.equals(P)===!1)return k.copy(P),!0}return!1}function y(O){const _=O.uniforms;let T=0;const A=16;for(let N=0,k=_.length;N<k;N++){const R=Array.isArray(_[N])?_[N]:[_[N]];for(let E=0,D=R.length;E<D;E++){const $=R[E],I=Array.isArray($.value)?$.value:[$.value];for(let L=0,U=I.length;L<U;L++){const V=I[L],X=x(V),H=T%A;H!==0&&A-H<X.boundary&&(T+=A-H),$.__data=new Float32Array(X.storage/Float32Array.BYTES_PER_ELEMENT),$.__offset=T,T+=X.storage}}}const P=T%A;return P>0&&(T+=A-P),O.__size=T,O.__cache={},this}function x(O){const _={boundary:0,storage:0};return typeof O=="number"||typeof O=="boolean"?(_.boundary=4,_.storage=4):O.isVector2?(_.boundary=8,_.storage=8):O.isVector3||O.isColor?(_.boundary=16,_.storage=12):O.isVector4?(_.boundary=16,_.storage=16):O.isMatrix3?(_.boundary=48,_.storage=48):O.isMatrix4?(_.boundary=64,_.storage=64):O.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",O),_}function w(O){const _=O.target;_.removeEventListener("dispose",w);const T=a.indexOf(_.__bindingPointIndex);a.splice(T,1),r.deleteBuffer(s[_.id]),delete s[_.id],delete o[_.id]}function S(){for(const O in s)r.deleteBuffer(s[O]);a=[],s={},o={}}return{bind:h,update:u,dispose:S}}class dg{constructor(e={}){const{canvas:n=xG(),context:i=null,depth:s=!0,stencil:o=!1,alpha:a=!1,antialias:l=!1,premultipliedAlpha:h=!0,preserveDrawingBuffer:u=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:p=!1}=e;this.isWebGLRenderer=!0;let m;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=i.getContextAttributes().alpha}else m=a;const v=new Uint32Array(4),y=new Int32Array(4);let x=null,w=null;const S=[],O=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Jr,this._useLegacyLights=!1,this.toneMapping=ph,this.toneMappingExposure=1;const _=this;let T=!1,A=0,P=0,N=null,k=-1,R=null;const E=new Ni,D=new Ni;let $=null;const I=new nt(0);let L=0,U=n.width,V=n.height,X=1,H=null,J=null;const ee=new Ni(0,0,U,V),ne=new Ni(0,0,U,V);let ge=!1;const ye=new Rb;let ce=!1,we=!1;const be=new dt,se=new le,ae={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Q(){return N===null?X:1}let z=i;function j(de,Ie){return n.getContext(de,Ie)}try{const de={alpha:!0,depth:s,stencil:o,antialias:l,premultipliedAlpha:h,preserveDrawingBuffer:u,powerPreference:f,failIfMajorPerformanceCaveat:p};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${r0}`),n.addEventListener("webglcontextlost",xe,!1),n.addEventListener("webglcontextrestored",Fe,!1),n.addEventListener("webglcontextcreationerror",Ge,!1),z===null){const Ie="webgl2";if(z=j(Ie,de),z===null)throw j(Ie)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(de){throw console.error("THREE.WebGLRenderer: "+de.message),de}let te,W,Z,he,pe,_e,Re,ie,q,me,ve,Te,ke,He,Ue,We,ct,Ye,lt,Lt,Bt,gt,ei,wi;function Me(){te=new Obe(z),te.init(),gt=new NG(z,te),W=new vbe(z,te,e,gt),Z=new twe(z),he=new Tbe(z),pe=new Xxe,_e=new iwe(z,te,Z,pe,W,gt,he),Re=new bbe(_),ie=new _be(_),q=new Ive(z),ei=new mbe(z,q),me=new Sbe(z,q,he,ei),ve=new Mbe(z,me,q,he),lt=new Ebe(z,W,_e),We=new ybe(pe),Te=new zxe(_,Re,ie,te,W,ei,We),ke=new cwe(_,pe),He=new Gxe,Ue=new Zxe(te),Ye=new pbe(_,Re,ie,Z,ve,m,h),ct=new ewe(_,ve,W),wi=new hwe(z,he,W,Z),Lt=new gbe(z,te,he),Bt=new Cbe(z,te,he),he.programs=Te.programs,_.capabilities=W,_.extensions=te,_.properties=pe,_.renderLists=He,_.shadowMap=ct,_.state=Z,_.info=he}Me();const Ve=new awe(_,z);this.xr=Ve,this.getContext=function(){return z},this.getContextAttributes=function(){return z.getContextAttributes()},this.forceContextLoss=function(){const de=te.get("WEBGL_lose_context");de&&de.loseContext()},this.forceContextRestore=function(){const de=te.get("WEBGL_lose_context");de&&de.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(de){de!==void 0&&(X=de,this.setSize(U,V,!1))},this.getSize=function(de){return de.set(U,V)},this.setSize=function(de,Ie,ze=!0){if(Ve.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}U=de,V=Ie,n.width=Math.floor(de*X),n.height=Math.floor(Ie*X),ze===!0&&(n.style.width=de+"px",n.style.height=Ie+"px"),this.setViewport(0,0,de,Ie)},this.getDrawingBufferSize=function(de){return de.set(U*X,V*X).floor()},this.setDrawingBufferSize=function(de,Ie,ze){U=de,V=Ie,X=ze,n.width=Math.floor(de*ze),n.height=Math.floor(Ie*ze),this.setViewport(0,0,de,Ie)},this.getCurrentViewport=function(de){return de.copy(E)},this.getViewport=function(de){return de.copy(ee)},this.setViewport=function(de,Ie,ze,$e){de.isVector4?ee.set(de.x,de.y,de.z,de.w):ee.set(de,Ie,ze,$e),Z.viewport(E.copy(ee).multiplyScalar(X).round())},this.getScissor=function(de){return de.copy(ne)},this.setScissor=function(de,Ie,ze,$e){de.isVector4?ne.set(de.x,de.y,de.z,de.w):ne.set(de,Ie,ze,$e),Z.scissor(D.copy(ne).multiplyScalar(X).round())},this.getScissorTest=function(){return ge},this.setScissorTest=function(de){Z.setScissorTest(ge=de)},this.setOpaqueSort=function(de){H=de},this.setTransparentSort=function(de){J=de},this.getClearColor=function(de){return de.copy(Ye.getClearColor())},this.setClearColor=function(){Ye.setClearColor.apply(Ye,arguments)},this.getClearAlpha=function(){return Ye.getClearAlpha()},this.setClearAlpha=function(){Ye.setClearAlpha.apply(Ye,arguments)},this.clear=function(de=!0,Ie=!0,ze=!0){let $e=0;if(de){let Be=!1;if(N!==null){const yt=N.texture.format;Be=yt===LI||yt===DI||yt===NI}if(Be){const yt=N.texture.type,Ht=yt===bl||yt===tp||yt===AI||yt===a0||yt===PI||yt===RI,qt=Ye.getClearColor(),ai=Ye.getClearAlpha(),bi=qt.r,Si=qt.g,Ti=qt.b;Ht?(v[0]=bi,v[1]=Si,v[2]=Ti,v[3]=ai,z.clearBufferuiv(z.COLOR,0,v)):(y[0]=bi,y[1]=Si,y[2]=Ti,y[3]=ai,z.clearBufferiv(z.COLOR,0,y))}else $e|=z.COLOR_BUFFER_BIT}Ie&&($e|=z.DEPTH_BUFFER_BIT),ze&&($e|=z.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),z.clear($e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",xe,!1),n.removeEventListener("webglcontextrestored",Fe,!1),n.removeEventListener("webglcontextcreationerror",Ge,!1),He.dispose(),Ue.dispose(),pe.dispose(),Re.dispose(),ie.dispose(),ve.dispose(),ei.dispose(),wi.dispose(),Te.dispose(),Ve.dispose(),Ve.removeEventListener("sessionstart",Ii),Ve.removeEventListener("sessionend",Hr),Kn.stop()};function xe(de){de.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function Fe(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const de=he.autoReset,Ie=ct.enabled,ze=ct.autoUpdate,$e=ct.needsUpdate,Be=ct.type;Me(),he.autoReset=de,ct.enabled=Ie,ct.autoUpdate=ze,ct.needsUpdate=$e,ct.type=Be}function Ge(de){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",de.statusMessage)}function at(de){const Ie=de.target;Ie.removeEventListener("dispose",at),vt(Ie)}function vt(de){Vi(de),pe.remove(de)}function Vi(de){const Ie=pe.get(de).programs;Ie!==void 0&&(Ie.forEach(function(ze){Te.releaseProgram(ze)}),de.isShaderMaterial&&Te.releaseShaderCache(de))}this.renderBufferDirect=function(de,Ie,ze,$e,Be,yt){Ie===null&&(Ie=ae);const Ht=Be.isMesh&&Be.matrixWorld.determinant()<0,qt=dT(de,Ie,ze,$e,Be);Z.setMaterial($e,Ht);let ai=ze.index,bi=1;if($e.wireframe===!0){if(ai=me.getWireframeAttribute(ze),ai===void 0)return;bi=2}const Si=ze.drawRange,Ti=ze.attributes.position;let Ei=Si.start*bi,_n=(Si.start+Si.count)*bi;yt!==null&&(Ei=Math.max(Ei,yt.start*bi),_n=Math.min(_n,(yt.start+yt.count)*bi)),ai!==null?(Ei=Math.max(Ei,0),_n=Math.min(_n,ai.count)):Ti!=null&&(Ei=Math.max(Ei,0),_n=Math.min(_n,Ti.count));const Bs=_n-Ei;if(Bs<0||Bs===1/0)return;ei.setup(Be,$e,qt,ze,ai);let ha,on=Lt;if(ai!==null&&(ha=q.get(ai),on=Bt,on.setIndex(ha)),Be.isMesh)$e.wireframe===!0?(Z.setLineWidth($e.wireframeLinewidth*Q()),on.setMode(z.LINES)):on.setMode(z.TRIANGLES);else if(Be.isLine){let _i=$e.linewidth;_i===void 0&&(_i=1),Z.setLineWidth(_i*Q()),Be.isLineSegments?on.setMode(z.LINES):Be.isLineLoop?on.setMode(z.LINE_LOOP):on.setMode(z.LINE_STRIP)}else Be.isPoints?on.setMode(z.POINTS):Be.isSprite&&on.setMode(z.TRIANGLES);if(Be.isBatchedMesh)Be._multiDrawInstances!==null?on.renderMultiDrawInstances(Be._multiDrawStarts,Be._multiDrawCounts,Be._multiDrawCount,Be._multiDrawInstances):on.renderMultiDraw(Be._multiDrawStarts,Be._multiDrawCounts,Be._multiDrawCount);else if(Be.isInstancedMesh)on.renderInstances(Ei,Bs,Be.count);else if(ze.isInstancedBufferGeometry){const _i=ze._maxInstanceCount!==void 0?ze._maxInstanceCount:1/0,Td=Math.min(ze.instanceCount,_i);on.renderInstances(Ei,Bs,Td)}else on.render(Ei,Bs)};function Fi(de,Ie,ze){de.transparent===!0&&de.side===Qs&&de.forceSinglePass===!1?(de.side=Rs,de.needsUpdate=!0,gn(de,Ie,ze),de.side=dc,de.needsUpdate=!0,gn(de,Ie,ze),de.side=Qs):gn(de,Ie,ze)}this.compile=function(de,Ie,ze=null){ze===null&&(ze=de),w=Ue.get(ze),w.init(Ie),O.push(w),ze.traverseVisible(function(Be){Be.isLight&&Be.layers.test(Ie.layers)&&(w.pushLight(Be),Be.castShadow&&w.pushShadow(Be))}),de!==ze&&de.traverseVisible(function(Be){Be.isLight&&Be.layers.test(Ie.layers)&&(w.pushLight(Be),Be.castShadow&&w.pushShadow(Be))}),w.setupLights(_._useLegacyLights);const $e=new Set;return de.traverse(function(Be){const yt=Be.material;if(yt)if(Array.isArray(yt))for(let Ht=0;Ht<yt.length;Ht++){const qt=yt[Ht];Fi(qt,ze,Be),$e.add(qt)}else Fi(yt,ze,Be),$e.add(yt)}),O.pop(),w=null,$e},this.compileAsync=function(de,Ie,ze=null){const $e=this.compile(de,Ie,ze);return new Promise(Be=>{function yt(){if($e.forEach(function(Ht){pe.get(Ht).currentProgram.isReady()&&$e.delete(Ht)}),$e.size===0){Be(de);return}setTimeout(yt,10)}te.get("KHR_parallel_shader_compile")!==null?yt():setTimeout(yt,10)})};let en=null;function Wn(de){en&&en(de)}function Ii(){Kn.stop()}function Hr(){Kn.start()}const Kn=new MG;Kn.setAnimationLoop(Wn),typeof self<"u"&&Kn.setContext(self),this.setAnimationLoop=function(de){en=de,Ve.setAnimationLoop(de),de===null?Kn.stop():Kn.start()},Ve.addEventListener("sessionstart",Ii),Ve.addEventListener("sessionend",Hr),this.render=function(de,Ie){if(Ie!==void 0&&Ie.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(T===!0)return;de.matrixWorldAutoUpdate===!0&&de.updateMatrixWorld(),Ie.parent===null&&Ie.matrixWorldAutoUpdate===!0&&Ie.updateMatrixWorld(),Ve.enabled===!0&&Ve.isPresenting===!0&&(Ve.cameraAutoUpdate===!0&&Ve.updateCamera(Ie),Ie=Ve.getCamera()),de.isScene===!0&&de.onBeforeRender(_,de,Ie,N),w=Ue.get(de,O.length),w.init(Ie),O.push(w),be.multiplyMatrices(Ie.projectionMatrix,Ie.matrixWorldInverse),ye.setFromProjectionMatrix(be),we=this.localClippingEnabled,ce=We.init(this.clippingPlanes,we),x=He.get(de,S.length),x.init(),S.push(x),_0(de,Ie,0,_.sortObjects),x.finish(),_.sortObjects===!0&&x.sort(H,J);const ze=Ve.enabled===!1||Ve.isPresenting===!1||Ve.hasDepthSensing()===!1;ze&&Ye.addToRenderList(x,de),this.info.render.frame++,ce===!0&&We.beginShadows();const $e=w.state.shadowsArray;ct.render($e,de,Ie),ce===!0&&We.endShadows(),this.info.autoReset===!0&&this.info.reset();const Be=x.opaque,yt=x.transmissive;if(w.setupLights(_._useLegacyLights),Ie.isArrayCamera){const Ht=Ie.cameras;if(yt.length>0)for(let qt=0,ai=Ht.length;qt<ai;qt++){const bi=Ht[qt];fx(Be,yt,de,bi)}ze&&Ye.render(de);for(let qt=0,ai=Ht.length;qt<ai;qt++){const bi=Ht[qt];Rr(x,de,bi,bi.viewport)}}else yt.length>0&&fx(Be,yt,de,Ie),ze&&Ye.render(de),Rr(x,de,Ie);N!==null&&(_e.updateMultisampleRenderTarget(N),_e.updateRenderTargetMipmap(N)),de.isScene===!0&&de.onAfterRender(_,de,Ie),ei.resetDefaultState(),k=-1,R=null,O.pop(),O.length>0?(w=O[O.length-1],ce===!0&&We.setGlobalState(_.clippingPlanes,w.state.camera)):w=null,S.pop(),S.length>0?x=S[S.length-1]:x=null};function _0(de,Ie,ze,$e){if(de.visible===!1)return;if(de.layers.test(Ie.layers)){if(de.isGroup)ze=de.renderOrder;else if(de.isLOD)de.autoUpdate===!0&&de.update(Ie);else if(de.isLight)w.pushLight(de),de.castShadow&&w.pushShadow(de);else if(de.isSprite){if(!de.frustumCulled||ye.intersectsSprite(de)){$e&&se.setFromMatrixPosition(de.matrixWorld).applyMatrix4(be);const Ht=ve.update(de),qt=de.material;qt.visible&&x.push(de,Ht,qt,ze,se.z,null)}}else if((de.isMesh||de.isLine||de.isPoints)&&(!de.frustumCulled||ye.intersectsObject(de))){const Ht=ve.update(de),qt=de.material;if($e&&(de.boundingSphere!==void 0?(de.boundingSphere===null&&de.computeBoundingSphere(),se.copy(de.boundingSphere.center)):(Ht.boundingSphere===null&&Ht.computeBoundingSphere(),se.copy(Ht.boundingSphere.center)),se.applyMatrix4(de.matrixWorld).applyMatrix4(be)),Array.isArray(qt)){const ai=Ht.groups;for(let bi=0,Si=ai.length;bi<Si;bi++){const Ti=ai[bi],Ei=qt[Ti.materialIndex];Ei&&Ei.visible&&x.push(de,Ht,Ei,ze,se.z,Ti)}}else qt.visible&&x.push(de,Ht,qt,ze,se.z,null)}}const yt=de.children;for(let Ht=0,qt=yt.length;Ht<qt;Ht++)_0(yt[Ht],Ie,ze,$e)}function Rr(de,Ie,ze,$e){const Be=de.opaque,yt=de.transmissive,Ht=de.transparent;w.setupLightsView(ze),ce===!0&&We.setGlobalState(_.clippingPlanes,ze),$e&&Z.viewport(E.copy($e)),Be.length>0&&Cd(Be,Ie,ze),yt.length>0&&Cd(yt,Ie,ze),Ht.length>0&&Cd(Ht,Ie,ze),Z.buffers.depth.setTest(!0),Z.buffers.depth.setMask(!0),Z.buffers.color.setMask(!0),Z.setPolygonOffset(!1)}function fx(de,Ie,ze,$e){if((ze.isScene===!0?ze.overrideMaterial:null)!==null)return;w.state.transmissionRenderTarget[$e.id]===void 0&&(w.state.transmissionRenderTarget[$e.id]=new La(1,1,{generateMipmaps:!0,type:te.has("EXT_color_buffer_half_float")||te.has("EXT_color_buffer_float")?o0:bl,minFilter:Ko,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const yt=w.state.transmissionRenderTarget[$e.id],Ht=$e.viewport||E;yt.setSize(Ht.z,Ht.w);const qt=_.getRenderTarget();_.setRenderTarget(yt),_.getClearColor(I),L=_.getClearAlpha(),L<1&&_.setClearColor(16777215,.5),_.clear();const ai=_.toneMapping;_.toneMapping=ph;const bi=$e.viewport;if($e.viewport!==void 0&&($e.viewport=void 0),w.setupLightsView($e),ce===!0&&We.setGlobalState(_.clippingPlanes,$e),Cd(de,ze,$e),_e.updateMultisampleRenderTarget(yt),_e.updateRenderTargetMipmap(yt),te.has("WEBGL_multisampled_render_to_texture")===!1){let Si=!1;for(let Ti=0,Ei=Ie.length;Ti<Ei;Ti++){const _n=Ie[Ti],Bs=_n.object,ha=_n.geometry,on=_n.material,_i=_n.group;if(on.side===Qs&&Bs.layers.test($e.layers)){const Td=on.side;on.side=Rs,on.needsUpdate=!0,Dh(Bs,ze,$e,ha,on,_i),on.side=Td,on.needsUpdate=!0,Si=!0}}Si===!0&&(_e.updateMultisampleRenderTarget(yt),_e.updateRenderTargetMipmap(yt))}_.setRenderTarget(qt),_.setClearColor(I,L),bi!==void 0&&($e.viewport=bi),_.toneMapping=ai}function Cd(de,Ie,ze){const $e=Ie.isScene===!0?Ie.overrideMaterial:null;for(let Be=0,yt=de.length;Be<yt;Be++){const Ht=de[Be],qt=Ht.object,ai=Ht.geometry,bi=$e===null?Ht.material:$e,Si=Ht.group;qt.layers.test(ze.layers)&&Dh(qt,Ie,ze,ai,bi,Si)}}function Dh(de,Ie,ze,$e,Be,yt){de.onBeforeRender(_,Ie,ze,$e,Be,yt),de.modelViewMatrix.multiplyMatrices(ze.matrixWorldInverse,de.matrixWorld),de.normalMatrix.getNormalMatrix(de.modelViewMatrix),Be.onBeforeRender(_,Ie,ze,$e,de,yt),Be.transparent===!0&&Be.side===Qs&&Be.forceSinglePass===!1?(Be.side=Rs,Be.needsUpdate=!0,_.renderBufferDirect(ze,Ie,$e,Be,de,yt),Be.side=dc,Be.needsUpdate=!0,_.renderBufferDirect(ze,Ie,$e,Be,de,yt),Be.side=Qs):_.renderBufferDirect(ze,Ie,$e,Be,de,yt),de.onAfterRender(_,Ie,ze,$e,Be,yt)}function gn(de,Ie,ze){Ie.isScene!==!0&&(Ie=ae);const $e=pe.get(de),Be=w.state.lights,yt=w.state.shadowsArray,Ht=Be.state.version,qt=Te.getParameters(de,Be.state,yt,Ie,ze),ai=Te.getProgramCacheKey(qt);let bi=$e.programs;$e.environment=de.isMeshStandardMaterial?Ie.environment:null,$e.fog=Ie.fog,$e.envMap=(de.isMeshStandardMaterial?ie:Re).get(de.envMap||$e.environment),$e.envMapRotation=$e.environment!==null&&de.envMap===null?Ie.environmentRotation:de.envMapRotation,bi===void 0&&(de.addEventListener("dispose",at),bi=new Map,$e.programs=bi);let Si=bi.get(ai);if(Si!==void 0){if($e.currentProgram===Si&&$e.lightsStateVersion===Ht)return Lh(de,qt),Si}else qt.uniforms=Te.getUniforms(de),de.onBuild(ze,qt,_),de.onBeforeCompile(qt,_),Si=Te.acquireProgram(qt,ai),bi.set(ai,Si),$e.uniforms=qt.uniforms;const Ti=$e.uniforms;return(!de.isShaderMaterial&&!de.isRawShaderMaterial||de.clipping===!0)&&(Ti.clippingPlanes=We.uniform),Lh(de,qt),$e.needsLights=pT(de),$e.lightsStateVersion=Ht,$e.needsLights&&(Ti.ambientLightColor.value=Be.state.ambient,Ti.lightProbe.value=Be.state.probe,Ti.directionalLights.value=Be.state.directional,Ti.directionalLightShadows.value=Be.state.directionalShadow,Ti.spotLights.value=Be.state.spot,Ti.spotLightShadows.value=Be.state.spotShadow,Ti.rectAreaLights.value=Be.state.rectArea,Ti.ltc_1.value=Be.state.rectAreaLTC1,Ti.ltc_2.value=Be.state.rectAreaLTC2,Ti.pointLights.value=Be.state.point,Ti.pointLightShadows.value=Be.state.pointShadow,Ti.hemisphereLights.value=Be.state.hemi,Ti.directionalShadowMap.value=Be.state.directionalShadowMap,Ti.directionalShadowMatrix.value=Be.state.directionalShadowMatrix,Ti.spotShadowMap.value=Be.state.spotShadowMap,Ti.spotLightMatrix.value=Be.state.spotLightMatrix,Ti.spotLightMap.value=Be.state.spotLightMap,Ti.pointShadowMap.value=Be.state.pointShadowMap,Ti.pointShadowMatrix.value=Be.state.pointShadowMatrix),$e.currentProgram=Si,$e.uniformsList=null,Si}function za(de){if(de.uniformsList===null){const Ie=de.currentProgram.getUniforms();de.uniformsList=RO.seqWithValue(Ie.seq,de.uniforms)}return de.uniformsList}function Lh(de,Ie){const ze=pe.get(de);ze.outputColorSpace=Ie.outputColorSpace,ze.batching=Ie.batching,ze.instancing=Ie.instancing,ze.instancingColor=Ie.instancingColor,ze.instancingMorph=Ie.instancingMorph,ze.skinning=Ie.skinning,ze.morphTargets=Ie.morphTargets,ze.morphNormals=Ie.morphNormals,ze.morphColors=Ie.morphColors,ze.morphTargetsCount=Ie.morphTargetsCount,ze.numClippingPlanes=Ie.numClippingPlanes,ze.numIntersection=Ie.numClipIntersection,ze.vertexAlphas=Ie.vertexAlphas,ze.vertexTangents=Ie.vertexTangents,ze.toneMapping=Ie.toneMapping}function dT(de,Ie,ze,$e,Be){Ie.isScene!==!0&&(Ie=ae),_e.resetTextureUnits();const yt=Ie.fog,Ht=$e.isMeshStandardMaterial?Ie.environment:null,qt=N===null?_.outputColorSpace:N.isXRRenderTarget===!0?N.texture.colorSpace:ns,ai=($e.isMeshStandardMaterial?ie:Re).get($e.envMap||Ht),bi=$e.vertexColors===!0&&!!ze.attributes.color&&ze.attributes.color.itemSize===4,Si=!!ze.attributes.tangent&&(!!$e.normalMap||$e.anisotropy>0),Ti=!!ze.morphAttributes.position,Ei=!!ze.morphAttributes.normal,_n=!!ze.morphAttributes.color;let Bs=ph;$e.toneMapped&&(N===null||N.isXRRenderTarget===!0)&&(Bs=_.toneMapping);const ha=ze.morphAttributes.position||ze.morphAttributes.normal||ze.morphAttributes.color,on=ha!==void 0?ha.length:0,_i=pe.get($e),Td=w.state.lights;if(ce===!0&&(we===!0||de!==R)){const _s=de===R&&$e.id===k;We.setState($e,de,_s)}let Mn=!1;$e.version===_i.__version?(_i.needsLights&&_i.lightsStateVersion!==Td.state.version||_i.outputColorSpace!==qt||Be.isBatchedMesh&&_i.batching===!1||!Be.isBatchedMesh&&_i.batching===!0||Be.isInstancedMesh&&_i.instancing===!1||!Be.isInstancedMesh&&_i.instancing===!0||Be.isSkinnedMesh&&_i.skinning===!1||!Be.isSkinnedMesh&&_i.skinning===!0||Be.isInstancedMesh&&_i.instancingColor===!0&&Be.instanceColor===null||Be.isInstancedMesh&&_i.instancingColor===!1&&Be.instanceColor!==null||Be.isInstancedMesh&&_i.instancingMorph===!0&&Be.morphTexture===null||Be.isInstancedMesh&&_i.instancingMorph===!1&&Be.morphTexture!==null||_i.envMap!==ai||$e.fog===!0&&_i.fog!==yt||_i.numClippingPlanes!==void 0&&(_i.numClippingPlanes!==We.numPlanes||_i.numIntersection!==We.numIntersection)||_i.vertexAlphas!==bi||_i.vertexTangents!==Si||_i.morphTargets!==Ti||_i.morphNormals!==Ei||_i.morphColors!==_n||_i.toneMapping!==Bs||_i.morphTargetsCount!==on)&&(Mn=!0):(Mn=!0,_i.__version=$e.version);let $s=_i.currentProgram;Mn===!0&&($s=gn($e,Ie,Be));let Ed=!1,Md=!1,O0=!1;const Jn=$s.getUniforms(),Tl=_i.uniforms;if(Z.useProgram($s.program)&&(Ed=!0,Md=!0,O0=!0),$e.id!==k&&(k=$e.id,Md=!0),Ed||R!==de){Jn.setValue(z,"projectionMatrix",de.projectionMatrix),Jn.setValue(z,"viewMatrix",de.matrixWorldInverse);const _s=Jn.map.cameraPosition;_s!==void 0&&_s.setValue(z,se.setFromMatrixPosition(de.matrixWorld)),W.logarithmicDepthBuffer&&Jn.setValue(z,"logDepthBufFC",2/(Math.log(de.far+1)/Math.LN2)),($e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshLambertMaterial||$e.isMeshBasicMaterial||$e.isMeshStandardMaterial||$e.isShaderMaterial)&&Jn.setValue(z,"isOrthographic",de.isOrthographicCamera===!0),R!==de&&(R=de,Md=!0,O0=!0)}if(Be.isSkinnedMesh){Jn.setOptional(z,Be,"bindMatrix"),Jn.setOptional(z,Be,"bindMatrixInverse");const _s=Be.skeleton;_s&&(_s.boneTexture===null&&_s.computeBoneTexture(),Jn.setValue(z,"boneTexture",_s.boneTexture,_e))}Be.isBatchedMesh&&(Jn.setOptional(z,Be,"batchingTexture"),Jn.setValue(z,"batchingTexture",Be._matricesTexture,_e));const S0=ze.morphAttributes;if((S0.position!==void 0||S0.normal!==void 0||S0.color!==void 0)&&lt.update(Be,ze,$s),(Md||_i.receiveShadow!==Be.receiveShadow)&&(_i.receiveShadow=Be.receiveShadow,Jn.setValue(z,"receiveShadow",Be.receiveShadow)),$e.isMeshGouraudMaterial&&$e.envMap!==null&&(Tl.envMap.value=ai,Tl.flipEnvMap.value=ai.isCubeTexture&&ai.isRenderTargetTexture===!1?-1:1),$e.isMeshStandardMaterial&&$e.envMap===null&&Ie.environment!==null&&(Tl.envMapIntensity.value=Ie.environmentIntensity),Md&&(Jn.setValue(z,"toneMappingExposure",_.toneMappingExposure),_i.needsLights&&fT(Tl,O0),yt&&$e.fog===!0&&ke.refreshFogUniforms(Tl,yt),ke.refreshMaterialUniforms(Tl,$e,X,V,w.state.transmissionRenderTarget[de.id]),RO.upload(z,za(_i),Tl,_e)),$e.isShaderMaterial&&$e.uniformsNeedUpdate===!0&&(RO.upload(z,za(_i),Tl,_e),$e.uniformsNeedUpdate=!1),$e.isSpriteMaterial&&Jn.setValue(z,"center",Be.center),Jn.setValue(z,"modelViewMatrix",Be.modelViewMatrix),Jn.setValue(z,"normalMatrix",Be.normalMatrix),Jn.setValue(z,"modelMatrix",Be.matrixWorld),$e.isShaderMaterial||$e.isRawShaderMaterial){const _s=$e.uniformsGroups;for(let ro=0,mT=_s.length;ro<mT;ro++){const px=_s[ro];wi.update(px,$s),wi.bind(px,$s)}}return $s}function fT(de,Ie){de.ambientLightColor.needsUpdate=Ie,de.lightProbe.needsUpdate=Ie,de.directionalLights.needsUpdate=Ie,de.directionalLightShadows.needsUpdate=Ie,de.pointLights.needsUpdate=Ie,de.pointLightShadows.needsUpdate=Ie,de.spotLights.needsUpdate=Ie,de.spotLightShadows.needsUpdate=Ie,de.rectAreaLights.needsUpdate=Ie,de.hemisphereLights.needsUpdate=Ie}function pT(de){return de.isMeshLambertMaterial||de.isMeshToonMaterial||de.isMeshPhongMaterial||de.isMeshStandardMaterial||de.isShadowMaterial||de.isShaderMaterial&&de.lights===!0}this.getActiveCubeFace=function(){return A},this.getActiveMipmapLevel=function(){return P},this.getRenderTarget=function(){return N},this.setRenderTargetTextures=function(de,Ie,ze){pe.get(de.texture).__webglTexture=Ie,pe.get(de.depthTexture).__webglTexture=ze;const $e=pe.get(de);$e.__hasExternalTextures=!0,$e.__autoAllocateDepthBuffer=ze===void 0,$e.__autoAllocateDepthBuffer||te.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$e.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(de,Ie){const ze=pe.get(de);ze.__webglFramebuffer=Ie,ze.__useDefaultFramebuffer=Ie===void 0},this.setRenderTarget=function(de,Ie=0,ze=0){N=de,A=Ie,P=ze;let $e=!0,Be=null,yt=!1,Ht=!1;if(de){const ai=pe.get(de);ai.__useDefaultFramebuffer!==void 0?(Z.bindFramebuffer(z.FRAMEBUFFER,null),$e=!1):ai.__webglFramebuffer===void 0?_e.setupRenderTarget(de):ai.__hasExternalTextures&&_e.rebindTextures(de,pe.get(de.texture).__webglTexture,pe.get(de.depthTexture).__webglTexture);const bi=de.texture;(bi.isData3DTexture||bi.isDataArrayTexture||bi.isCompressedArrayTexture)&&(Ht=!0);const Si=pe.get(de).__webglFramebuffer;de.isWebGLCubeRenderTarget?(Array.isArray(Si[Ie])?Be=Si[Ie][ze]:Be=Si[Ie],yt=!0):de.samples>0&&_e.useMultisampledRTT(de)===!1?Be=pe.get(de).__webglMultisampledFramebuffer:Array.isArray(Si)?Be=Si[ze]:Be=Si,E.copy(de.viewport),D.copy(de.scissor),$=de.scissorTest}else E.copy(ee).multiplyScalar(X).floor(),D.copy(ne).multiplyScalar(X).floor(),$=ge;if(Z.bindFramebuffer(z.FRAMEBUFFER,Be)&&$e&&Z.drawBuffers(de,Be),Z.viewport(E),Z.scissor(D),Z.setScissorTest($),yt){const ai=pe.get(de.texture);z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,ai.__webglTexture,ze)}else if(Ht){const ai=pe.get(de.texture),bi=Ie||0;z.framebufferTextureLayer(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,ai.__webglTexture,ze||0,bi)}k=-1},this.readRenderTargetPixels=function(de,Ie,ze,$e,Be,yt,Ht){if(!(de&&de.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let qt=pe.get(de).__webglFramebuffer;if(de.isWebGLCubeRenderTarget&&Ht!==void 0&&(qt=qt[Ht]),qt){Z.bindFramebuffer(z.FRAMEBUFFER,qt);try{const ai=de.texture,bi=ai.format,Si=ai.type;if(!W.textureFormatReadable(bi)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!W.textureTypeReadable(Si)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ie>=0&&Ie<=de.width-$e&&ze>=0&&ze<=de.height-Be&&z.readPixels(Ie,ze,$e,Be,gt.convert(bi),gt.convert(Si),yt)}finally{const ai=N!==null?pe.get(N).__webglFramebuffer:null;Z.bindFramebuffer(z.FRAMEBUFFER,ai)}}},this.copyFramebufferToTexture=function(de,Ie,ze=0){const $e=Math.pow(2,-ze),Be=Math.floor(Ie.image.width*$e),yt=Math.floor(Ie.image.height*$e);_e.setTexture2D(Ie,0),z.copyTexSubImage2D(z.TEXTURE_2D,ze,0,0,de.x,de.y,Be,yt),Z.unbindTexture()},this.copyTextureToTexture=function(de,Ie,ze,$e=0){const Be=Ie.image.width,yt=Ie.image.height,Ht=gt.convert(ze.format),qt=gt.convert(ze.type);_e.setTexture2D(ze,0),z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,ze.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ze.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,ze.unpackAlignment),Ie.isDataTexture?z.texSubImage2D(z.TEXTURE_2D,$e,de.x,de.y,Be,yt,Ht,qt,Ie.image.data):Ie.isCompressedTexture?z.compressedTexSubImage2D(z.TEXTURE_2D,$e,de.x,de.y,Ie.mipmaps[0].width,Ie.mipmaps[0].height,Ht,Ie.mipmaps[0].data):z.texSubImage2D(z.TEXTURE_2D,$e,de.x,de.y,Ht,qt,Ie.image),$e===0&&ze.generateMipmaps&&z.generateMipmap(z.TEXTURE_2D),Z.unbindTexture()},this.copyTextureToTexture3D=function(de,Ie,ze,$e,Be=0){const yt=de.max.x-de.min.x,Ht=de.max.y-de.min.y,qt=de.max.z-de.min.z,ai=gt.convert($e.format),bi=gt.convert($e.type);let Si;if($e.isData3DTexture)_e.setTexture3D($e,0),Si=z.TEXTURE_3D;else if($e.isDataArrayTexture||$e.isCompressedArrayTexture)_e.setTexture2DArray($e,0),Si=z.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,$e.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$e.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,$e.unpackAlignment);const Ti=z.getParameter(z.UNPACK_ROW_LENGTH),Ei=z.getParameter(z.UNPACK_IMAGE_HEIGHT),_n=z.getParameter(z.UNPACK_SKIP_PIXELS),Bs=z.getParameter(z.UNPACK_SKIP_ROWS),ha=z.getParameter(z.UNPACK_SKIP_IMAGES),on=ze.isCompressedTexture?ze.mipmaps[Be]:ze.image;z.pixelStorei(z.UNPACK_ROW_LENGTH,on.width),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,on.height),z.pixelStorei(z.UNPACK_SKIP_PIXELS,de.min.x),z.pixelStorei(z.UNPACK_SKIP_ROWS,de.min.y),z.pixelStorei(z.UNPACK_SKIP_IMAGES,de.min.z),ze.isDataTexture||ze.isData3DTexture?z.texSubImage3D(Si,Be,Ie.x,Ie.y,Ie.z,yt,Ht,qt,ai,bi,on.data):$e.isCompressedArrayTexture?z.compressedTexSubImage3D(Si,Be,Ie.x,Ie.y,Ie.z,yt,Ht,qt,ai,on.data):z.texSubImage3D(Si,Be,Ie.x,Ie.y,Ie.z,yt,Ht,qt,ai,bi,on),z.pixelStorei(z.UNPACK_ROW_LENGTH,Ti),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,Ei),z.pixelStorei(z.UNPACK_SKIP_PIXELS,_n),z.pixelStorei(z.UNPACK_SKIP_ROWS,Bs),z.pixelStorei(z.UNPACK_SKIP_IMAGES,ha),Be===0&&$e.generateMipmaps&&z.generateMipmap(Si),Z.unbindTexture()},this.initTexture=function(de){de.isCubeTexture?_e.setTextureCube(de,0):de.isData3DTexture?_e.setTexture3D(de,0):de.isDataArrayTexture||de.isCompressedArrayTexture?_e.setTexture2DArray(de,0):_e.setTexture2D(de,0),Z.unbindTexture()},this.resetState=function(){A=0,P=0,N=null,Z.reset(),ei.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return tc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=e===qC?"display-p3":"srgb",n.unpackColorSpace=dn.workingColorSpace===Mb?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class t2{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new nt(e),this.density=n}clone(){return new t2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class i2{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new nt(e),this.near=n,this.far=i}clone(){return new i2(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class np extends Li{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Vr,this.environmentIntensity=1,this.environmentRotation=new Vr,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class c0{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=D1,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=ra()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return wG("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let s=0,o=this.stride;s<o;s++)this.array[e+s]=n.array[i+s];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ra()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ra()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ws=new le;class fc{constructor(e,n,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)Ws.fromBufferAttribute(this,n),Ws.applyMatrix4(e),this.setXYZ(n,Ws.x,Ws.y,Ws.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Ws.fromBufferAttribute(this,n),Ws.applyNormalMatrix(e),this.setXYZ(n,Ws.x,Ws.y,Ws.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Ws.fromBufferAttribute(this,n),Ws.transformDirection(e),this.setXYZ(n,Ws.x,Ws.y,Ws.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=js(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Mi(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=Mi(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=Mi(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=Mi(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=Mi(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=js(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=js(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=js(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=js(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=Mi(n,this.array),i=Mi(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=Mi(n,this.array),i=Mi(i,this.array),s=Mi(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,n,i,s,o){return e=e*this.data.stride+this.offset,this.normalized&&(n=Mi(n,this.array),i=Mi(i,this.array),s=Mi(s,this.array),o=Mi(o,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[s+o])}return new Di(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new fc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class QI extends Xr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new nt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let mm;const dv=new le,gm=new le,vm=new le,ym=new Xe,fv=new Xe,LG=new dt,Uw=new le,pv=new le,Vw=new le,b$=new Xe,cM=new Xe,x$=new Xe;let BG=class extends Li{constructor(e=new QI){if(super(),this.isSprite=!0,this.type="Sprite",mm===void 0){mm=new vi;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new c0(n,5);mm.setIndex([0,1,2,0,2,3]),mm.setAttribute("position",new fc(i,3,0,!1)),mm.setAttribute("uv",new fc(i,2,3,!1))}this.geometry=mm,this.material=e,this.center=new Xe(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),gm.setFromMatrixScale(this.matrixWorld),LG.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),vm.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&gm.multiplyScalar(-vm.z);const i=this.material.rotation;let s,o;i!==0&&(o=Math.cos(i),s=Math.sin(i));const a=this.center;Fw(Uw.set(-.5,-.5,0),vm,a,gm,s,o),Fw(pv.set(.5,-.5,0),vm,a,gm,s,o),Fw(Vw.set(.5,.5,0),vm,a,gm,s,o),b$.set(0,0),cM.set(1,0),x$.set(1,1);let l=e.ray.intersectTriangle(Uw,pv,Vw,!1,dv);if(l===null&&(Fw(pv.set(-.5,.5,0),vm,a,gm,s,o),cM.set(0,1),l=e.ray.intersectTriangle(Uw,Vw,pv,!1,dv),l===null))return;const h=e.ray.origin.distanceTo(dv);h<e.near||h>e.far||n.push({distance:h,point:dv.clone(),uv:bo.getInterpolation(dv,Uw,pv,Vw,b$,cM,x$,new Xe),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}};function Fw(r,e,n,i,s,o){ym.subVectors(r,n).addScalar(.5).multiply(i),s!==void 0?(fv.x=o*ym.x-s*ym.y,fv.y=s*ym.x+o*ym.y):fv.copy(ym),r.copy(e),r.x+=fv.x,r.y+=fv.y,r.applyMatrix4(LG)}const zw=new le,w$=new le;class $G extends Li{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,s=n.length;i<s;i++){const o=n[i];this.addLevel(o.object.clone(),o.distance,o.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const s=this.levels;let o;for(o=0;o<s.length&&!(n<s[o].distance);o++);return s.splice(o,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,s;for(i=1,s=n.length;i<s;i++){let o=n[i].distance;if(n[i].object.visible&&(o-=o*n[i].hysteresis),e<o)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){zw.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(zw);this.getObjectForDistance(s).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){zw.setFromMatrixPosition(e.matrixWorld),w$.setFromMatrixPosition(this.matrixWorld);const i=zw.distanceTo(w$)/e.zoom;n[0].object.visible=!0;let s,o;for(s=1,o=n.length;s<o;s++){let a=n[s].distance;if(n[s].object.visible&&(a-=a*n[s].hysteresis),i>=a)n[s-1].object.visible=!1,n[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<o;s++)n[s].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let s=0,o=i.length;s<o;s++){const a=i[s];n.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return n}}const _$=new le,O$=new Ni,S$=new Ni,uwe=new le,C$=new dt,Xw=new le,hM=new ts,T$=new dt,uM=new Sp;class n2 extends ln{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=rP,this.bindMatrix=new dt,this.bindMatrixInverse=new dt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new vr),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,Xw),this.boundingBox.expandByPoint(Xw)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new ts),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,Xw),this.boundingSphere.expandByPoint(Xw)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,s=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),hM.copy(this.boundingSphere),hM.applyMatrix4(s),e.ray.intersectsSphere(hM)!==!1&&(T$.copy(s).invert(),uM.copy(e.ray).applyMatrix4(T$),!(this.boundingBox!==null&&uM.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,uM)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ni,n=this.geometry.attributes.skinWeight;for(let i=0,s=n.count;i<s;i++){e.fromBufferAttribute(n,i);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===rP?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===YW?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,s=this.geometry;O$.fromBufferAttribute(s.attributes.skinIndex,e),S$.fromBufferAttribute(s.attributes.skinWeight,e),_$.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let o=0;o<4;o++){const a=S$.getComponent(o);if(a!==0){const l=O$.getComponent(o);C$.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),n.addScaledVector(uwe.copy(_$).applyMatrix4(C$),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}class Fg extends Li{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Qu extends qn{constructor(e=null,n=1,i=1,s,o,a,l,h,u=Er,f=Er,p,m){super(null,a,l,h,u,f,s,o,p,m),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const E$=new dt,dwe=new dt;class h0{constructor(e=[],n=[]){this.uuid=ra(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,s=this.bones.length;i<s;i++)this.boneInverses.push(new dt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new dt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,s=this.boneTexture;for(let o=0,a=e.length;o<a;o++){const l=e[o]?e[o].matrixWorld:dwe;E$.multiplyMatrices(l,n[o]),E$.toArray(i,o*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new h0(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new Qu(n,e,e,_o,Ea);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const s=this.bones[n];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,s=e.bones.length;i<s;i++){const o=e.bones[i];let a=n[o];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),a=new Fg),this.bones.push(a),this.boneInverses.push(new dt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let s=0,o=n.length;s<o;s++){const a=n[s];e.bones.push(a.uuid);const l=i[s];e.boneInverses.push(l.toArray())}return e}}class rp extends Di{constructor(e,n,i,s=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const bm=new dt,M$=new dt,Ww=[],A$=new vr,fwe=new dt,mv=new ln,gv=new ts;class jI extends ln{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new rp(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<i;s++)this.setMatrixAt(s,fwe)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new vr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,bm),A$.copy(e.boundingBox).applyMatrix4(bm),this.boundingBox.union(A$)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new ts),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,bm),gv.copy(e.boundingSphere).applyMatrix4(bm),this.boundingSphere.union(gv)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){const i=n.morphTargetInfluences,s=this.morphTexture.source.data.data,o=i.length+1,a=e*o+1;for(let l=0;l<i.length;l++)i[l]=s[a+l]}raycast(e,n){const i=this.matrixWorld,s=this.count;if(mv.geometry=this.geometry,mv.material=this.material,mv.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),gv.copy(this.boundingSphere),gv.applyMatrix4(i),e.ray.intersectsSphere(gv)!==!1))for(let o=0;o<s;o++){this.getMatrixAt(o,bm),M$.multiplyMatrices(i,bm),mv.matrixWorld=M$,mv.raycast(e,Ww);for(let a=0,l=Ww.length;a<l;a++){const h=Ww[a];h.instanceId=o,h.object=this,n.push(h)}Ww.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new rp(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){const i=n.morphTargetInfluences,s=i.length+1;this.morphTexture===null&&(this.morphTexture=new Qu(new Float32Array(s*this.count),s,this.count,II,Ea));const o=this.morphTexture.source.data.data;let a=0;for(let u=0;u<i.length;u++)a+=i[u];const l=this.geometry.morphTargetsRelative?1:1-a,h=s*e;o[h]=l,o.set(i,h+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function pwe(r,e){return r.z-e.z}function mwe(r,e){return e.z-r.z}class gwe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n){const i=this.pool,s=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1});const o=i[this.index];s.push(o),this.index++,o.start=e.start,o.count=e.count,o.z=n}reset(){this.list.length=0,this.index=0}}const xm="batchId",cu=new dt,k$=new dt,vwe=new dt,P$=new dt,dM=new Rb,Gw=new vr,jd=new ts,vv=new le,fM=new gwe,Es=new ln,Hw=[];function ywe(r,e,n=0){const i=e.itemSize;if(r.isInterleavedBufferAttribute||r.array.constructor!==e.array.constructor){const s=r.count;for(let o=0;o<s;o++)for(let a=0;a<i;a++)e.setComponent(o+n,a,r.getComponent(o,a))}else e.array.set(r.array,n*i);e.needsUpdate=!0}class UG extends ln{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,n,i=n*2,s){super(new vi,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=n,this._maxIndexCount=i,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),i=new Qu(n,e,e,_o,Ea);this._matricesTexture=i}_initializeGeometry(e){const n=this.geometry,i=this._maxVertexCount,s=this._maxGeometryCount,o=this._maxIndexCount;if(this._geometryInitialized===!1){for(const l in e.attributes){const h=e.getAttribute(l),{array:u,itemSize:f,normalized:p}=h,m=new u.constructor(i*f),v=new Di(m,f,p);n.setAttribute(l,v)}if(e.getIndex()!==null){const l=i>65536?new Uint32Array(o):new Uint16Array(o);n.setIndex(new Di(l,1))}const a=s>65536?new Uint32Array(i):new Uint16Array(i);n.setAttribute(xm,new Di(a,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(xm))throw new Error(`BatchedMesh: Geometry cannot use attribute "${xm}"`);const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const i in n.attributes){if(i===xm)continue;if(!e.hasAttribute(i))throw new Error(`BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const s=e.getAttribute(i),o=n.getAttribute(i);if(s.itemSize!==o.itemSize||s.normalized!==o.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vr);const e=this._geometryCount,n=this.boundingBox,i=this._active;n.makeEmpty();for(let s=0;s<e;s++)i[s]!==!1&&(this.getMatrixAt(s,cu),this.getBoundingBoxAt(s,Gw).applyMatrix4(cu),n.union(Gw))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ts);const e=this._geometryCount,n=this.boundingSphere,i=this._active;n.makeEmpty();for(let s=0;s<e;s++)i[s]!==!1&&(this.getMatrixAt(s,cu),this.getBoundingSphereAt(s,jd).applyMatrix4(cu),n.union(jd))}addGeometry(e,n=-1,i=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const s={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let o=null;const a=this._reservedRanges,l=this._drawRanges,h=this._bounds;this._geometryCount!==0&&(o=a[a.length-1]),n===-1?s.vertexCount=e.getAttribute("position").count:s.vertexCount=n,o===null?s.vertexStart=0:s.vertexStart=o.vertexStart+o.vertexCount;const u=e.getIndex(),f=u!==null;if(f&&(i===-1?s.indexCount=u.count:s.indexCount=i,o===null?s.indexStart=0:s.indexStart=o.indexStart+o.indexCount),s.indexStart!==-1&&s.indexStart+s.indexCount>this._maxIndexCount||s.vertexStart+s.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const p=this._visibility,m=this._active,v=this._matricesTexture,y=this._matricesTexture.image.data;p.push(!0),m.push(!0);const x=this._geometryCount;this._geometryCount++,vwe.toArray(y,x*16),v.needsUpdate=!0,a.push(s),l.push({start:f?s.indexStart:s.vertexStart,count:-1}),h.push({boxInitialized:!1,box:new vr,sphereInitialized:!1,sphere:new ts});const w=this.geometry.getAttribute(xm);for(let S=0;S<s.vertexCount;S++)w.setX(s.vertexStart+S,x);return w.needsUpdate=!0,this.setGeometryAt(x,e),x}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const i=this.geometry,s=i.getIndex()!==null,o=i.getIndex(),a=n.getIndex(),l=this._reservedRanges[e];if(s&&a.count>l.indexCount||n.attributes.position.count>l.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const h=l.vertexStart,u=l.vertexCount;for(const v in i.attributes){if(v===xm)continue;const y=n.getAttribute(v),x=i.getAttribute(v);ywe(y,x,h);const w=y.itemSize;for(let S=y.count,O=u;S<O;S++){const _=h+S;for(let T=0;T<w;T++)x.setComponent(_,T,0)}x.needsUpdate=!0,x.addUpdateRange(h*w,u*w)}if(s){const v=l.indexStart;for(let y=0;y<a.count;y++)o.setX(v+y,h+a.getX(y));for(let y=a.count,x=l.indexCount;y<x;y++)o.setX(v+y,h);o.needsUpdate=!0,o.addUpdateRange(v,l.indexCount)}const f=this._bounds[e];n.boundingBox!==null?(f.box.copy(n.boundingBox),f.boxInitialized=!0):f.boxInitialized=!1,n.boundingSphere!==null?(f.sphere.copy(n.boundingSphere),f.sphereInitialized=!0):f.sphereInitialized=!1;const p=this._drawRanges[e],m=n.getAttribute("position");return p.count=s?a.count:m.count,this._visibilityChanged=!0,e}deleteGeometry(e){const n=this._active;return e>=n.length||n[e]===!1?this:(n[e]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(e){return this._multiDrawInstances===null?null:this._multiDrawInstances[e]}setInstanceCountAt(e,n){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[e]=n,e}getBoundingBoxAt(e,n){if(this._active[e]===!1)return null;const s=this._bounds[e],o=s.box,a=this.geometry;if(s.boxInitialized===!1){o.makeEmpty();const l=a.index,h=a.attributes.position,u=this._drawRanges[e];for(let f=u.start,p=u.start+u.count;f<p;f++){let m=f;l&&(m=l.getX(m)),o.expandByPoint(vv.fromBufferAttribute(h,m))}s.boxInitialized=!0}return n.copy(o),n}getBoundingSphereAt(e,n){if(this._active[e]===!1)return null;const s=this._bounds[e],o=s.sphere,a=this.geometry;if(s.sphereInitialized===!1){o.makeEmpty(),this.getBoundingBoxAt(e,Gw),Gw.getCenter(o.center);const l=a.index,h=a.attributes.position,u=this._drawRanges[e];let f=0;for(let p=u.start,m=u.start+u.count;p<m;p++){let v=p;l&&(v=l.getX(v)),vv.fromBufferAttribute(h,v),f=Math.max(f,o.center.distanceToSquared(vv))}o.radius=Math.sqrt(f),s.sphereInitialized=!0}return n.copy(o),n}setMatrixAt(e,n){const i=this._active,s=this._matricesTexture,o=this._matricesTexture.image.data,a=this._geometryCount;return e>=a||i[e]===!1?this:(n.toArray(o,e*16),s.needsUpdate=!0,this)}getMatrixAt(e,n){const i=this._active,s=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||i[e]===!1?null:n.fromArray(s,e*16)}setVisibleAt(e,n){const i=this._visibility,s=this._active,o=this._geometryCount;return e>=o||s[e]===!1||i[e]===n?this:(i[e]=n,this._visibilityChanged=!0,this)}getVisibleAt(e){const n=this._visibility,i=this._active,s=this._geometryCount;return e>=s||i[e]===!1?!1:n[e]}raycast(e,n){const i=this._visibility,s=this._active,o=this._drawRanges,a=this._geometryCount,l=this.matrixWorld,h=this.geometry;Es.material=this.material,Es.geometry.index=h.index,Es.geometry.attributes=h.attributes,Es.geometry.boundingBox===null&&(Es.geometry.boundingBox=new vr),Es.geometry.boundingSphere===null&&(Es.geometry.boundingSphere=new ts);for(let u=0;u<a;u++){if(!i[u]||!s[u])continue;const f=o[u];Es.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(u,Es.matrixWorld).premultiply(l),this.getBoundingBoxAt(u,Es.geometry.boundingBox),this.getBoundingSphereAt(u,Es.geometry.boundingSphere),Es.raycast(e,Hw);for(let p=0,m=Hw.length;p<m;p++){const v=Hw[p];v.object=this,v.batchId=u,n.push(v)}Hw.length=0}Es.material=null,Es.geometry.index=null,Es.geometry.attributes={},Es.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(n=>({...n})),this._reservedRanges=e._reservedRanges.map(n=>({...n})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(n=>({boxInitialized:n.boxInitialized,box:n.box.clone(),sphereInitialized:n.sphereInitialized,sphere:n.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,n,i,s,o){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=s.getIndex(),l=a===null?1:a.array.BYTES_PER_ELEMENT,h=this._active,u=this._visibility,f=this._multiDrawStarts,p=this._multiDrawCounts,m=this._drawRanges,v=this.perObjectFrustumCulled;v&&(P$.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),dM.setFromProjectionMatrix(P$,e.coordinateSystem));let y=0;if(this.sortObjects){k$.copy(this.matrixWorld).invert(),vv.setFromMatrixPosition(i.matrixWorld).applyMatrix4(k$);for(let S=0,O=u.length;S<O;S++)if(u[S]&&h[S]){this.getMatrixAt(S,cu),this.getBoundingSphereAt(S,jd).applyMatrix4(cu);let _=!1;if(v&&(_=!dM.intersectsSphere(jd)),!_){const T=vv.distanceTo(jd.center);fM.push(m[S],T)}}const x=fM.list,w=this.customSort;w===null?x.sort(o.transparent?mwe:pwe):w.call(this,x,i);for(let S=0,O=x.length;S<O;S++){const _=x[S];f[y]=_.start*l,p[y]=_.count,y++}fM.reset()}else for(let x=0,w=u.length;x<w;x++)if(u[x]&&h[x]){let S=!1;if(v&&(this.getMatrixAt(x,cu),this.getBoundingSphereAt(x,jd).applyMatrix4(cu),S=!dM.intersectsSphere(jd)),!S){const O=m[x];f[y]=O.start*l,p[y]=O.count,y++}}this._multiDrawCount=y,this._visibilityChanged=!1}onBeforeShadow(e,n,i,s,o,a){this.onBeforeRender(e,null,s,o,a)}}class bs extends Xr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new nt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const CS=new le,TS=new le,R$=new dt,yv=new Sp,Qw=new ts,pM=new le,I$=new le;let pc=class extends Li{constructor(e=new vi,n=new bs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let s=1,o=n.count;s<o;s++)CS.fromBufferAttribute(n,s-1),TS.fromBufferAttribute(n,s),i[s]=i[s-1],i[s]+=CS.distanceTo(TS);e.setAttribute("lineDistance",new Nt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Qw.copy(i.boundingSphere),Qw.applyMatrix4(s),Qw.radius+=o,e.ray.intersectsSphere(Qw)===!1)return;R$.copy(s).invert(),yv.copy(e.ray).applyMatrix4(R$);const l=o/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,u=this.isLineSegments?2:1,f=i.index,m=i.attributes.position;if(f!==null){const v=Math.max(0,a.start),y=Math.min(f.count,a.start+a.count);for(let x=v,w=y-1;x<w;x+=u){const S=f.getX(x),O=f.getX(x+1),_=jw(this,e,yv,h,S,O);_&&n.push(_)}if(this.isLineLoop){const x=f.getX(y-1),w=f.getX(v),S=jw(this,e,yv,h,x,w);S&&n.push(S)}}else{const v=Math.max(0,a.start),y=Math.min(m.count,a.start+a.count);for(let x=v,w=y-1;x<w;x+=u){const S=jw(this,e,yv,h,x,x+1);S&&n.push(S)}if(this.isLineLoop){const x=jw(this,e,yv,h,y-1,v);x&&n.push(x)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}};function jw(r,e,n,i,s,o){const a=r.geometry.attributes.position;if(CS.fromBufferAttribute(a,s),TS.fromBufferAttribute(a,o),n.distanceSqToSegment(CS,TS,pM,I$)>i)return;pM.applyMatrix4(r.matrixWorld);const h=e.ray.origin.distanceTo(pM);if(!(h<e.near||h>e.far))return{distance:h,point:I$.clone().applyMatrix4(r.matrixWorld),index:s,face:null,faceIndex:null,object:r}}const N$=new le,D$=new le;class _l extends pc{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let s=0,o=n.count;s<o;s+=2)N$.fromBufferAttribute(n,s),D$.fromBufferAttribute(n,s+1),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+N$.distanceTo(D$);e.setAttribute("lineDistance",new Nt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class YI extends pc{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class r2 extends Xr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new nt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const L$=new dt,DP=new Sp,Yw=new ts,qw=new le;class qI extends Li{constructor(e=new vi,n=new r2){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,s=this.matrixWorld,o=e.params.Points.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Yw.copy(i.boundingSphere),Yw.applyMatrix4(s),Yw.radius+=o,e.ray.intersectsSphere(Yw)===!1)return;L$.copy(s).invert(),DP.copy(e.ray).applyMatrix4(L$);const l=o/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,u=i.index,p=i.attributes.position;if(u!==null){const m=Math.max(0,a.start),v=Math.min(u.count,a.start+a.count);for(let y=m,x=v;y<x;y++){const w=u.getX(y);qw.fromBufferAttribute(p,w),B$(qw,w,h,s,e,n,this)}}else{const m=Math.max(0,a.start),v=Math.min(p.count,a.start+a.count);for(let y=m,x=v;y<x;y++)qw.fromBufferAttribute(p,y),B$(qw,y,h,s,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}}function B$(r,e,n,i,s,o,a){const l=DP.distanceSqToPoint(r);if(l<n){const h=new le;DP.closestPointToPoint(r,h),h.applyMatrix4(i);const u=s.ray.origin.distanceTo(h);if(u<s.near||u>s.far)return;o.push({distance:u,distanceToRay:Math.sqrt(l),point:h,index:e,face:null,object:a})}}class bwe extends qn{constructor(e,n,i,s,o,a,l,h,u){super(e,n,i,s,o,a,l,h,u),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:ir,this.magFilter=o!==void 0?o:ir,this.generateMipmaps=!1;const f=this;function p(){f.needsUpdate=!0,e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(p)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class LP extends qn{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=Er,this.minFilter=Er,this.generateMipmaps=!1,this.needsUpdate=!0}}class Vf extends qn{constructor(e,n,i,s,o,a,l,h,u,f,p,m){super(null,a,l,h,u,f,s,o,p,m),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class xwe extends Vf{constructor(e,n,i,s,o,a){super(e,n,i,o,a),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Ps}}class wwe extends Vf{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,wh),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class _we extends qn{constructor(e,n,i,s,o,a,l,h,u){super(e,n,i,s,o,a,l,h,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class $a{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,s=this.getPoint(0),o=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),o+=i.distanceTo(s),n.push(o),s=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let s=0;const o=i.length;let a;n?a=n:a=e*i[o-1];let l=0,h=o-1,u;for(;l<=h;)if(s=Math.floor(l+(h-l)/2),u=i[s]-a,u<0)l=s+1;else if(u>0)h=s-1;else{h=s;break}if(s=h,i[s]===a)return s/(o-1);const f=i[s],m=i[s+1]-f,v=(a-f)/m;return(s+v)/(o-1)}getTangent(e,n){let s=e-1e-4,o=e+1e-4;s<0&&(s=0),o>1&&(o=1);const a=this.getPoint(s),l=this.getPoint(o),h=n||(a.isVector2?new Xe:new le);return h.copy(l).sub(a).normalize(),h}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new le,s=[],o=[],a=[],l=new le,h=new dt;for(let v=0;v<=e;v++){const y=v/e;s[v]=this.getTangentAt(y,new le)}o[0]=new le,a[0]=new le;let u=Number.MAX_VALUE;const f=Math.abs(s[0].x),p=Math.abs(s[0].y),m=Math.abs(s[0].z);f<=u&&(u=f,i.set(1,0,0)),p<=u&&(u=p,i.set(0,1,0)),m<=u&&i.set(0,0,1),l.crossVectors(s[0],i).normalize(),o[0].crossVectors(s[0],l),a[0].crossVectors(s[0],o[0]);for(let v=1;v<=e;v++){if(o[v]=o[v-1].clone(),a[v]=a[v-1].clone(),l.crossVectors(s[v-1],s[v]),l.length()>Number.EPSILON){l.normalize();const y=Math.acos(hr(s[v-1].dot(s[v]),-1,1));o[v].applyMatrix4(h.makeRotationAxis(l,y))}a[v].crossVectors(s[v],o[v])}if(n===!0){let v=Math.acos(hr(o[0].dot(o[e]),-1,1));v/=e,s[0].dot(l.crossVectors(o[0],o[e]))>0&&(v=-v);for(let y=1;y<=e;y++)o[y].applyMatrix4(h.makeRotationAxis(s[y],v*y)),a[y].crossVectors(s[y],o[y])}return{tangents:s,normals:o,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class s2 extends $a{constructor(e=0,n=0,i=1,s=1,o=0,a=Math.PI*2,l=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=s,this.aStartAngle=o,this.aEndAngle=a,this.aClockwise=l,this.aRotation=h}getPoint(e,n=new Xe){const i=n,s=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const a=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=s;for(;o>s;)o-=s;o<Number.EPSILON&&(a?o=0:o=s),this.aClockwise===!0&&!a&&(o===s?o=-s:o=o-s);const l=this.aStartAngle+e*o;let h=this.aX+this.xRadius*Math.cos(l),u=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const f=Math.cos(this.aRotation),p=Math.sin(this.aRotation),m=h-this.aX,v=u-this.aY;h=m*f-v*p+this.aX,u=m*p+v*f+this.aY}return i.set(h,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class VG extends s2{constructor(e,n,i,s,o,a){super(e,n,i,i,s,o,a),this.isArcCurve=!0,this.type="ArcCurve"}}function ZI(){let r=0,e=0,n=0,i=0;function s(o,a,l,h){r=o,e=l,n=-3*o+3*a-2*l-h,i=2*o-2*a+l+h}return{initCatmullRom:function(o,a,l,h,u){s(a,l,u*(l-o),u*(h-a))},initNonuniformCatmullRom:function(o,a,l,h,u,f,p){let m=(a-o)/u-(l-o)/(u+f)+(l-a)/f,v=(l-a)/f-(h-a)/(f+p)+(h-l)/p;m*=f,v*=f,s(a,l,m,v)},calc:function(o){const a=o*o,l=a*o;return r+e*o+n*a+i*l}}}const Zw=new le,mM=new ZI,gM=new ZI,vM=new ZI;class FG extends $a{constructor(e=[],n=!1,i="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=s}getPoint(e,n=new le){const i=n,s=this.points,o=s.length,a=(o-(this.closed?0:1))*e;let l=Math.floor(a),h=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o)+1)*o:h===0&&l===o-1&&(l=o-2,h=1);let u,f;this.closed||l>0?u=s[(l-1)%o]:(Zw.subVectors(s[0],s[1]).add(s[0]),u=Zw);const p=s[l%o],m=s[(l+1)%o];if(this.closed||l+2<o?f=s[(l+2)%o]:(Zw.subVectors(s[o-1],s[o-2]).add(s[o-1]),f=Zw),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let y=Math.pow(u.distanceToSquared(p),v),x=Math.pow(p.distanceToSquared(m),v),w=Math.pow(m.distanceToSquared(f),v);x<1e-4&&(x=1),y<1e-4&&(y=x),w<1e-4&&(w=x),mM.initNonuniformCatmullRom(u.x,p.x,m.x,f.x,y,x,w),gM.initNonuniformCatmullRom(u.y,p.y,m.y,f.y,y,x,w),vM.initNonuniformCatmullRom(u.z,p.z,m.z,f.z,y,x,w)}else this.curveType==="catmullrom"&&(mM.initCatmullRom(u.x,p.x,m.x,f.x,this.tension),gM.initCatmullRom(u.y,p.y,m.y,f.y,this.tension),vM.initCatmullRom(u.z,p.z,m.z,f.z,this.tension));return i.set(mM.calc(h),gM.calc(h),vM.calc(h)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const s=this.points[n];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(new le().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function $$(r,e,n,i,s){const o=(i-e)*.5,a=(s-n)*.5,l=r*r,h=r*l;return(2*n-2*i+o+a)*h+(-3*n+3*i-2*o-a)*l+o*r+n}function Owe(r,e){const n=1-r;return n*n*e}function Swe(r,e){return 2*(1-r)*r*e}function Cwe(r,e){return r*r*e}function s1(r,e,n,i){return Owe(r,e)+Swe(r,n)+Cwe(r,i)}function Twe(r,e){const n=1-r;return n*n*n*e}function Ewe(r,e){const n=1-r;return 3*n*n*r*e}function Mwe(r,e){return 3*(1-r)*r*r*e}function Awe(r,e){return r*r*r*e}function o1(r,e,n,i,s){return Twe(r,e)+Ewe(r,n)+Mwe(r,i)+Awe(r,s)}class KI extends $a{constructor(e=new Xe,n=new Xe,i=new Xe,s=new Xe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=s}getPoint(e,n=new Xe){const i=n,s=this.v0,o=this.v1,a=this.v2,l=this.v3;return i.set(o1(e,s.x,o.x,a.x,l.x),o1(e,s.y,o.y,a.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class zG extends $a{constructor(e=new le,n=new le,i=new le,s=new le){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=s}getPoint(e,n=new le){const i=n,s=this.v0,o=this.v1,a=this.v2,l=this.v3;return i.set(o1(e,s.x,o.x,a.x,l.x),o1(e,s.y,o.y,a.y,l.y),o1(e,s.z,o.z,a.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class JI extends $a{constructor(e=new Xe,n=new Xe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Xe){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Xe){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class XG extends $a{constructor(e=new le,n=new le){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new le){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new le){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class o2 extends $a{constructor(e=new Xe,n=new Xe,i=new Xe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Xe){const i=n,s=this.v0,o=this.v1,a=this.v2;return i.set(s1(e,s.x,o.x,a.x),s1(e,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class e4 extends $a{constructor(e=new le,n=new le,i=new le){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new le){const i=n,s=this.v0,o=this.v1,a=this.v2;return i.set(s1(e,s.x,o.x,a.x),s1(e,s.y,o.y,a.y),s1(e,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class t4 extends $a{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Xe){const i=n,s=this.points,o=(s.length-1)*e,a=Math.floor(o),l=o-a,h=s[a===0?a:a-1],u=s[a],f=s[a>s.length-2?s.length-1:a+1],p=s[a>s.length-3?s.length-1:a+2];return i.set($$(l,h.x,u.x,f.x,p.x),$$(l,h.y,u.y,f.y,p.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const s=this.points[n];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(new Xe().fromArray(s))}return this}}var ES=Object.freeze({__proto__:null,ArcCurve:VG,CatmullRomCurve3:FG,CubicBezierCurve:KI,CubicBezierCurve3:zG,EllipseCurve:s2,LineCurve:JI,LineCurve3:XG,QuadraticBezierCurve:o2,QuadraticBezierCurve3:e4,SplineCurve:t4});class WG extends $a{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new ES[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),s=this.getCurveLengths();let o=0;for(;o<s.length;){if(s[o]>=i){const a=s[o]-i,l=this.curves[o],h=l.getLength(),u=h===0?0:1-a/h;return l.getPointAt(u,n)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,s=this.curves.length;i<s;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let s=0,o=this.curves;s<o.length;s++){const a=o[s],l=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,h=a.getPoints(l);for(let u=0;u<h.length;u++){const f=h[u];i&&i.equals(f)||(n.push(f),i=f)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const s=e.curves[n];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const s=this.curves[n];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const s=e.curves[n];this.curves.push(new ES[s.type]().fromJSON(s))}return this}}let $1=class extends WG{constructor(e){super(),this.type="Path",this.currentPoint=new Xe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new JI(this.currentPoint.clone(),new Xe(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,s){const o=new o2(this.currentPoint.clone(),new Xe(e,n),new Xe(i,s));return this.curves.push(o),this.currentPoint.set(i,s),this}bezierCurveTo(e,n,i,s,o,a){const l=new KI(this.currentPoint.clone(),new Xe(e,n),new Xe(i,s),new Xe(o,a));return this.curves.push(l),this.currentPoint.set(o,a),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new t4(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,s,o,a){const l=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(e+l,n+h,i,s,o,a),this}absarc(e,n,i,s,o,a){return this.absellipse(e,n,i,i,s,o,a),this}ellipse(e,n,i,s,o,a,l,h){const u=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+u,n+f,i,s,o,a,l,h),this}absellipse(e,n,i,s,o,a,l,h){const u=new s2(e,n,i,s,o,a,l,h);if(this.curves.length>0){const p=u.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(u);const f=u.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class Ib extends vi{constructor(e=[new Xe(0,-.5),new Xe(.5,0),new Xe(0,.5)],n=12,i=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:s},n=Math.floor(n),s=hr(s,0,Math.PI*2);const o=[],a=[],l=[],h=[],u=[],f=1/n,p=new le,m=new Xe,v=new le,y=new le,x=new le;let w=0,S=0;for(let O=0;O<=e.length-1;O++)switch(O){case 0:w=e[O+1].x-e[O].x,S=e[O+1].y-e[O].y,v.x=S*1,v.y=-w,v.z=S*0,x.copy(v),v.normalize(),h.push(v.x,v.y,v.z);break;case e.length-1:h.push(x.x,x.y,x.z);break;default:w=e[O+1].x-e[O].x,S=e[O+1].y-e[O].y,v.x=S*1,v.y=-w,v.z=S*0,y.copy(v),v.x+=x.x,v.y+=x.y,v.z+=x.z,v.normalize(),h.push(v.x,v.y,v.z),x.copy(y)}for(let O=0;O<=n;O++){const _=i+O*f*s,T=Math.sin(_),A=Math.cos(_);for(let P=0;P<=e.length-1;P++){p.x=e[P].x*T,p.y=e[P].y,p.z=e[P].x*A,a.push(p.x,p.y,p.z),m.x=O/n,m.y=P/(e.length-1),l.push(m.x,m.y);const N=h[3*P+0]*T,k=h[3*P+1],R=h[3*P+0]*A;u.push(N,k,R)}}for(let O=0;O<n;O++)for(let _=0;_<e.length-1;_++){const T=_+O*e.length,A=T,P=T+e.length,N=T+e.length+1,k=T+1;o.push(A,P,k),o.push(N,k,P)}this.setIndex(o),this.setAttribute("position",new Nt(a,3)),this.setAttribute("uv",new Nt(l,2)),this.setAttribute("normal",new Nt(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ib(e.points,e.segments,e.phiStart,e.phiLength)}}class a2 extends Ib{constructor(e=1,n=1,i=4,s=8){const o=new $1;o.absarc(0,-n/2,e,Math.PI*1.5,0),o.absarc(0,n/2,e,0,Math.PI*.5),super(o.getPoints(i),s),this.type="CapsuleGeometry",this.parameters={radius:e,length:n,capSegments:i,radialSegments:s}}static fromJSON(e){return new a2(e.radius,e.length,e.capSegments,e.radialSegments)}}class l2 extends vi{constructor(e=1,n=32,i=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:s},n=Math.max(3,n);const o=[],a=[],l=[],h=[],u=new le,f=new Xe;a.push(0,0,0),l.push(0,0,1),h.push(.5,.5);for(let p=0,m=3;p<=n;p++,m+=3){const v=i+p/n*s;u.x=e*Math.cos(v),u.y=e*Math.sin(v),a.push(u.x,u.y,u.z),l.push(0,0,1),f.x=(a[m]/e+1)/2,f.y=(a[m+1]/e+1)/2,h.push(f.x,f.y)}for(let p=1;p<=n;p++)o.push(p,p+1,0);this.setIndex(o),this.setAttribute("position",new Nt(a,3)),this.setAttribute("normal",new Nt(l,3)),this.setAttribute("uv",new Nt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new l2(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class u0 extends vi{constructor(e=1,n=1,i=1,s=32,o=1,a=!1,l=0,h=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:s,heightSegments:o,openEnded:a,thetaStart:l,thetaLength:h};const u=this;s=Math.floor(s),o=Math.floor(o);const f=[],p=[],m=[],v=[];let y=0;const x=[],w=i/2;let S=0;O(),a===!1&&(e>0&&_(!0),n>0&&_(!1)),this.setIndex(f),this.setAttribute("position",new Nt(p,3)),this.setAttribute("normal",new Nt(m,3)),this.setAttribute("uv",new Nt(v,2));function O(){const T=new le,A=new le;let P=0;const N=(n-e)/i;for(let k=0;k<=o;k++){const R=[],E=k/o,D=E*(n-e)+e;for(let $=0;$<=s;$++){const I=$/s,L=I*h+l,U=Math.sin(L),V=Math.cos(L);A.x=D*U,A.y=-E*i+w,A.z=D*V,p.push(A.x,A.y,A.z),T.set(U,N,V).normalize(),m.push(T.x,T.y,T.z),v.push(I,1-E),R.push(y++)}x.push(R)}for(let k=0;k<s;k++)for(let R=0;R<o;R++){const E=x[R][k],D=x[R+1][k],$=x[R+1][k+1],I=x[R][k+1];f.push(E,D,I),f.push(D,$,I),P+=6}u.addGroup(S,P,0),S+=P}function _(T){const A=y,P=new Xe,N=new le;let k=0;const R=T===!0?e:n,E=T===!0?1:-1;for(let $=1;$<=s;$++)p.push(0,w*E,0),m.push(0,E,0),v.push(.5,.5),y++;const D=y;for(let $=0;$<=s;$++){const L=$/s*h+l,U=Math.cos(L),V=Math.sin(L);N.x=R*V,N.y=w*E,N.z=R*U,p.push(N.x,N.y,N.z),m.push(0,E,0),P.x=U*.5+.5,P.y=V*.5*E+.5,v.push(P.x,P.y),y++}for(let $=0;$<s;$++){const I=A+$,L=D+$;T===!0?f.push(L,L+1,I):f.push(L+1,L,I),k+=3}u.addGroup(S,k,T===!0?1:2),S+=k}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new u0(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class c2 extends u0{constructor(e=1,n=1,i=32,s=1,o=!1,a=0,l=Math.PI*2){super(0,e,n,i,s,o,a,l),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l}}static fromJSON(e){return new c2(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class bd extends vi{constructor(e=[],n=[],i=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:s};const o=[],a=[];l(s),u(i),f(),this.setAttribute("position",new Nt(o,3)),this.setAttribute("normal",new Nt(o.slice(),3)),this.setAttribute("uv",new Nt(a,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function l(O){const _=new le,T=new le,A=new le;for(let P=0;P<n.length;P+=3)v(n[P+0],_),v(n[P+1],T),v(n[P+2],A),h(_,T,A,O)}function h(O,_,T,A){const P=A+1,N=[];for(let k=0;k<=P;k++){N[k]=[];const R=O.clone().lerp(T,k/P),E=_.clone().lerp(T,k/P),D=P-k;for(let $=0;$<=D;$++)$===0&&k===P?N[k][$]=R:N[k][$]=R.clone().lerp(E,$/D)}for(let k=0;k<P;k++)for(let R=0;R<2*(P-k)-1;R++){const E=Math.floor(R/2);R%2===0?(m(N[k][E+1]),m(N[k+1][E]),m(N[k][E])):(m(N[k][E+1]),m(N[k+1][E+1]),m(N[k+1][E]))}}function u(O){const _=new le;for(let T=0;T<o.length;T+=3)_.x=o[T+0],_.y=o[T+1],_.z=o[T+2],_.normalize().multiplyScalar(O),o[T+0]=_.x,o[T+1]=_.y,o[T+2]=_.z}function f(){const O=new le;for(let _=0;_<o.length;_+=3){O.x=o[_+0],O.y=o[_+1],O.z=o[_+2];const T=w(O)/2/Math.PI+.5,A=S(O)/Math.PI+.5;a.push(T,1-A)}y(),p()}function p(){for(let O=0;O<a.length;O+=6){const _=a[O+0],T=a[O+2],A=a[O+4],P=Math.max(_,T,A),N=Math.min(_,T,A);P>.9&&N<.1&&(_<.2&&(a[O+0]+=1),T<.2&&(a[O+2]+=1),A<.2&&(a[O+4]+=1))}}function m(O){o.push(O.x,O.y,O.z)}function v(O,_){const T=O*3;_.x=e[T+0],_.y=e[T+1],_.z=e[T+2]}function y(){const O=new le,_=new le,T=new le,A=new le,P=new Xe,N=new Xe,k=new Xe;for(let R=0,E=0;R<o.length;R+=9,E+=6){O.set(o[R+0],o[R+1],o[R+2]),_.set(o[R+3],o[R+4],o[R+5]),T.set(o[R+6],o[R+7],o[R+8]),P.set(a[E+0],a[E+1]),N.set(a[E+2],a[E+3]),k.set(a[E+4],a[E+5]),A.copy(O).add(_).add(T).divideScalar(3);const D=w(A);x(P,E+0,O,D),x(N,E+2,_,D),x(k,E+4,T,D)}}function x(O,_,T,A){A<0&&O.x===1&&(a[_]=O.x-1),T.x===0&&T.z===0&&(a[_]=A/2/Math.PI+.5)}function w(O){return Math.atan2(O.z,-O.x)}function S(O){return Math.atan2(-O.y,Math.sqrt(O.x*O.x+O.z*O.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bd(e.vertices,e.indices,e.radius,e.details)}}class h2 extends bd{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,s=1/i,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-i,0,-s,i,0,s,-i,0,s,i,-s,-i,0,-s,i,0,s,-i,0,s,i,0,-i,0,-s,i,0,-s,-i,0,s,i,0,s],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,a,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new h2(e.radius,e.detail)}}const Kw=new le,Jw=new le,yM=new le,e_=new bo;class GG extends vi{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const s=Math.pow(10,4),o=Math.cos(Uf*n),a=e.getIndex(),l=e.getAttribute("position"),h=a?a.count:l.count,u=[0,0,0],f=["a","b","c"],p=new Array(3),m={},v=[];for(let y=0;y<h;y+=3){a?(u[0]=a.getX(y),u[1]=a.getX(y+1),u[2]=a.getX(y+2)):(u[0]=y,u[1]=y+1,u[2]=y+2);const{a:x,b:w,c:S}=e_;if(x.fromBufferAttribute(l,u[0]),w.fromBufferAttribute(l,u[1]),S.fromBufferAttribute(l,u[2]),e_.getNormal(yM),p[0]=`${Math.round(x.x*s)},${Math.round(x.y*s)},${Math.round(x.z*s)}`,p[1]=`${Math.round(w.x*s)},${Math.round(w.y*s)},${Math.round(w.z*s)}`,p[2]=`${Math.round(S.x*s)},${Math.round(S.y*s)},${Math.round(S.z*s)}`,!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let O=0;O<3;O++){const _=(O+1)%3,T=p[O],A=p[_],P=e_[f[O]],N=e_[f[_]],k=`${T}_${A}`,R=`${A}_${T}`;R in m&&m[R]?(yM.dot(m[R].normal)<=o&&(v.push(P.x,P.y,P.z),v.push(N.x,N.y,N.z)),m[R]=null):k in m||(m[k]={index0:u[O],index1:u[_],normal:yM.clone()})}}for(const y in m)if(m[y]){const{index0:x,index1:w}=m[y];Kw.fromBufferAttribute(l,x),Jw.fromBufferAttribute(l,w),v.push(Kw.x,Kw.y,Kw.z),v.push(Jw.x,Jw.y,Jw.z)}this.setAttribute("position",new Nt(v,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}let Ff=class extends $1{constructor(e){super(e),this.uuid=ra(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,s=this.holes.length;i<s;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const s=e.holes[n];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const s=this.holes[n];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const s=e.holes[n];this.holes.push(new $1().fromJSON(s))}return this}};const kwe={triangulate:function(r,e,n=2){const i=e&&e.length,s=i?e[0]*n:r.length;let o=HG(r,0,s,n,!0);const a=[];if(!o||o.next===o.prev)return a;let l,h,u,f,p,m,v;if(i&&(o=Dwe(r,e,o,n)),r.length>80*n){l=u=r[0],h=f=r[1];for(let y=n;y<s;y+=n)p=r[y],m=r[y+1],p<l&&(l=p),m<h&&(h=m),p>u&&(u=p),m>f&&(f=m);v=Math.max(u-l,f-h),v=v!==0?32767/v:0}return U1(o,a,n,l,h,v,0),a}};function HG(r,e,n,i,s){let o,a;if(s===Hwe(r,e,n,i)>0)for(o=e;o<n;o+=i)a=U$(o,r[o],r[o+1],a);else for(o=n-i;o>=e;o-=i)a=U$(o,r[o],r[o+1],a);return a&&u2(a,a.next)&&(F1(a),a=a.next),a}function sp(r,e){if(!r)return r;e||(e=r);let n=r,i;do if(i=!1,!n.steiner&&(u2(n,n.next)||nr(n.prev,n,n.next)===0)){if(F1(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function U1(r,e,n,i,s,o,a){if(!r)return;!a&&o&&Vwe(r,i,s,o);let l=r,h,u;for(;r.prev!==r.next;){if(h=r.prev,u=r.next,o?Rwe(r,i,s,o):Pwe(r)){e.push(h.i/n|0),e.push(r.i/n|0),e.push(u.i/n|0),F1(r),r=u.next,l=u.next;continue}if(r=u,r===l){a?a===1?(r=Iwe(sp(r),e,n),U1(r,e,n,i,s,o,2)):a===2&&Nwe(r,e,n,i,s,o):U1(sp(r),e,n,i,s,o,1);break}}}function Pwe(r){const e=r.prev,n=r,i=r.next;if(nr(e,n,i)>=0)return!1;const s=e.x,o=n.x,a=i.x,l=e.y,h=n.y,u=i.y,f=s<o?s<a?s:a:o<a?o:a,p=l<h?l<u?l:u:h<u?h:u,m=s>o?s>a?s:a:o>a?o:a,v=l>h?l>u?l:u:h>u?h:u;let y=i.next;for(;y!==e;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=v&&jm(s,l,o,h,a,u,y.x,y.y)&&nr(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function Rwe(r,e,n,i){const s=r.prev,o=r,a=r.next;if(nr(s,o,a)>=0)return!1;const l=s.x,h=o.x,u=a.x,f=s.y,p=o.y,m=a.y,v=l<h?l<u?l:u:h<u?h:u,y=f<p?f<m?f:m:p<m?p:m,x=l>h?l>u?l:u:h>u?h:u,w=f>p?f>m?f:m:p>m?p:m,S=BP(v,y,e,n,i),O=BP(x,w,e,n,i);let _=r.prevZ,T=r.nextZ;for(;_&&_.z>=S&&T&&T.z<=O;){if(_.x>=v&&_.x<=x&&_.y>=y&&_.y<=w&&_!==s&&_!==a&&jm(l,f,h,p,u,m,_.x,_.y)&&nr(_.prev,_,_.next)>=0||(_=_.prevZ,T.x>=v&&T.x<=x&&T.y>=y&&T.y<=w&&T!==s&&T!==a&&jm(l,f,h,p,u,m,T.x,T.y)&&nr(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;_&&_.z>=S;){if(_.x>=v&&_.x<=x&&_.y>=y&&_.y<=w&&_!==s&&_!==a&&jm(l,f,h,p,u,m,_.x,_.y)&&nr(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;T&&T.z<=O;){if(T.x>=v&&T.x<=x&&T.y>=y&&T.y<=w&&T!==s&&T!==a&&jm(l,f,h,p,u,m,T.x,T.y)&&nr(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function Iwe(r,e,n){let i=r;do{const s=i.prev,o=i.next.next;!u2(s,o)&&QG(s,i,i.next,o)&&V1(s,o)&&V1(o,s)&&(e.push(s.i/n|0),e.push(i.i/n|0),e.push(o.i/n|0),F1(i),F1(i.next),i=r=o),i=i.next}while(i!==r);return sp(i)}function Nwe(r,e,n,i,s,o){let a=r;do{let l=a.next.next;for(;l!==a.prev;){if(a.i!==l.i&&Xwe(a,l)){let h=jG(a,l);a=sp(a,a.next),h=sp(h,h.next),U1(a,e,n,i,s,o,0),U1(h,e,n,i,s,o,0);return}l=l.next}a=a.next}while(a!==r)}function Dwe(r,e,n,i){const s=[];let o,a,l,h,u;for(o=0,a=e.length;o<a;o++)l=e[o]*i,h=o<a-1?e[o+1]*i:r.length,u=HG(r,l,h,i,!1),u===u.next&&(u.steiner=!0),s.push(zwe(u));for(s.sort(Lwe),o=0;o<s.length;o++)n=Bwe(s[o],n);return n}function Lwe(r,e){return r.x-e.x}function Bwe(r,e){const n=$we(r,e);if(!n)return e;const i=jG(n,r);return sp(i,i.next),sp(n,n.next)}function $we(r,e){let n=e,i=-1/0,s;const o=r.x,a=r.y;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){const m=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(m<=o&&m>i&&(i=m,s=n.x<n.next.x?n:n.next,m===o))return s}n=n.next}while(n!==e);if(!s)return null;const l=s,h=s.x,u=s.y;let f=1/0,p;n=s;do o>=n.x&&n.x>=h&&o!==n.x&&jm(a<u?o:i,a,h,u,a<u?i:o,a,n.x,n.y)&&(p=Math.abs(a-n.y)/(o-n.x),V1(n,r)&&(p<f||p===f&&(n.x>s.x||n.x===s.x&&Uwe(s,n)))&&(s=n,f=p)),n=n.next;while(n!==l);return s}function Uwe(r,e){return nr(r.prev,r,e.prev)<0&&nr(e.next,r,r.next)<0}function Vwe(r,e,n,i){let s=r;do s.z===0&&(s.z=BP(s.x,s.y,e,n,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,Fwe(s)}function Fwe(r){let e,n,i,s,o,a,l,h,u=1;do{for(n=r,r=null,o=null,a=0;n;){for(a++,i=n,l=0,e=0;e<u&&(l++,i=i.nextZ,!!i);e++);for(h=u;l>0||h>0&&i;)l!==0&&(h===0||!i||n.z<=i.z)?(s=n,n=n.nextZ,l--):(s=i,i=i.nextZ,h--),o?o.nextZ=s:r=s,s.prevZ=o,o=s;n=i}o.nextZ=null,u*=2}while(a>1);return r}function BP(r,e,n,i,s){return r=(r-n)*s|0,e=(e-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function zwe(r){let e=r,n=r;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==r);return n}function jm(r,e,n,i,s,o,a,l){return(s-a)*(e-l)>=(r-a)*(o-l)&&(r-a)*(i-l)>=(n-a)*(e-l)&&(n-a)*(o-l)>=(s-a)*(i-l)}function Xwe(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!Wwe(r,e)&&(V1(r,e)&&V1(e,r)&&Gwe(r,e)&&(nr(r.prev,r,e.prev)||nr(r,e.prev,e))||u2(r,e)&&nr(r.prev,r,r.next)>0&&nr(e.prev,e,e.next)>0)}function nr(r,e,n){return(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y)}function u2(r,e){return r.x===e.x&&r.y===e.y}function QG(r,e,n,i){const s=i_(nr(r,e,n)),o=i_(nr(r,e,i)),a=i_(nr(n,i,r)),l=i_(nr(n,i,e));return!!(s!==o&&a!==l||s===0&&t_(r,n,e)||o===0&&t_(r,i,e)||a===0&&t_(n,r,i)||l===0&&t_(n,e,i))}function t_(r,e,n){return e.x<=Math.max(r.x,n.x)&&e.x>=Math.min(r.x,n.x)&&e.y<=Math.max(r.y,n.y)&&e.y>=Math.min(r.y,n.y)}function i_(r){return r>0?1:r<0?-1:0}function Wwe(r,e){let n=r;do{if(n.i!==r.i&&n.next.i!==r.i&&n.i!==e.i&&n.next.i!==e.i&&QG(n,n.next,r,e))return!0;n=n.next}while(n!==r);return!1}function V1(r,e){return nr(r.prev,r,r.next)<0?nr(r,e,r.next)>=0&&nr(r,r.prev,e)>=0:nr(r,e,r.prev)<0||nr(r,r.next,e)<0}function Gwe(r,e){let n=r,i=!1;const s=(r.x+e.x)/2,o=(r.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&s<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==r);return i}function jG(r,e){const n=new $P(r.i,r.x,r.y),i=new $P(e.i,e.x,e.y),s=r.next,o=e.prev;return r.next=e,e.prev=r,n.next=s,s.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function U$(r,e,n,i){const s=new $P(r,e,n);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function F1(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function $P(r,e,n){this.i=r,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Hwe(r,e,n,i){let s=0;for(let o=e,a=n-i;o<n;o+=i)s+=(r[a]-r[o])*(r[o+1]+r[a+1]),a=o;return s}class ac{static area(e){const n=e.length;let i=0;for(let s=n-1,o=0;o<n;s=o++)i+=e[s].x*e[o].y-e[o].x*e[s].y;return i*.5}static isClockWise(e){return ac.area(e)<0}static triangulateShape(e,n){const i=[],s=[],o=[];V$(e),F$(i,e);let a=e.length;n.forEach(V$);for(let h=0;h<n.length;h++)s.push(a),a+=n[h].length,F$(i,n[h]);const l=kwe.triangulate(i,s);for(let h=0;h<l.length;h+=3)o.push(l.slice(h,h+3));return o}}function V$(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function F$(r,e){for(let n=0;n<e.length;n++)r.push(e[n].x),r.push(e[n].y)}class Nb extends vi{constructor(e=new Ff([new Xe(.5,.5),new Xe(-.5,.5),new Xe(-.5,-.5),new Xe(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,s=[],o=[];for(let l=0,h=e.length;l<h;l++){const u=e[l];a(u)}this.setAttribute("position",new Nt(s,3)),this.setAttribute("uv",new Nt(o,2)),this.computeVertexNormals();function a(l){const h=[],u=n.curveSegments!==void 0?n.curveSegments:12,f=n.steps!==void 0?n.steps:1,p=n.depth!==void 0?n.depth:1;let m=n.bevelEnabled!==void 0?n.bevelEnabled:!0,v=n.bevelThickness!==void 0?n.bevelThickness:.2,y=n.bevelSize!==void 0?n.bevelSize:v-.1,x=n.bevelOffset!==void 0?n.bevelOffset:0,w=n.bevelSegments!==void 0?n.bevelSegments:3;const S=n.extrudePath,O=n.UVGenerator!==void 0?n.UVGenerator:Qwe;let _,T=!1,A,P,N,k;S&&(_=S.getSpacedPoints(f),T=!0,m=!1,A=S.computeFrenetFrames(f,!1),P=new le,N=new le,k=new le),m||(w=0,v=0,y=0,x=0);const R=l.extractPoints(u);let E=R.shape;const D=R.holes;if(!ac.isClockWise(E)){E=E.reverse();for(let te=0,W=D.length;te<W;te++){const Z=D[te];ac.isClockWise(Z)&&(D[te]=Z.reverse())}}const I=ac.triangulateShape(E,D),L=E;for(let te=0,W=D.length;te<W;te++){const Z=D[te];E=E.concat(Z)}function U(te,W,Z){return W||console.error("THREE.ExtrudeGeometry: vec does not exist"),te.clone().addScaledVector(W,Z)}const V=E.length,X=I.length;function H(te,W,Z){let he,pe,_e;const Re=te.x-W.x,ie=te.y-W.y,q=Z.x-te.x,me=Z.y-te.y,ve=Re*Re+ie*ie,Te=Re*me-ie*q;if(Math.abs(Te)>Number.EPSILON){const ke=Math.sqrt(ve),He=Math.sqrt(q*q+me*me),Ue=W.x-ie/ke,We=W.y+Re/ke,ct=Z.x-me/He,Ye=Z.y+q/He,lt=((ct-Ue)*me-(Ye-We)*q)/(Re*me-ie*q);he=Ue+Re*lt-te.x,pe=We+ie*lt-te.y;const Lt=he*he+pe*pe;if(Lt<=2)return new Xe(he,pe);_e=Math.sqrt(Lt/2)}else{let ke=!1;Re>Number.EPSILON?q>Number.EPSILON&&(ke=!0):Re<-Number.EPSILON?q<-Number.EPSILON&&(ke=!0):Math.sign(ie)===Math.sign(me)&&(ke=!0),ke?(he=-ie,pe=Re,_e=Math.sqrt(ve)):(he=Re,pe=ie,_e=Math.sqrt(ve/2))}return new Xe(he/_e,pe/_e)}const J=[];for(let te=0,W=L.length,Z=W-1,he=te+1;te<W;te++,Z++,he++)Z===W&&(Z=0),he===W&&(he=0),J[te]=H(L[te],L[Z],L[he]);const ee=[];let ne,ge=J.concat();for(let te=0,W=D.length;te<W;te++){const Z=D[te];ne=[];for(let he=0,pe=Z.length,_e=pe-1,Re=he+1;he<pe;he++,_e++,Re++)_e===pe&&(_e=0),Re===pe&&(Re=0),ne[he]=H(Z[he],Z[_e],Z[Re]);ee.push(ne),ge=ge.concat(ne)}for(let te=0;te<w;te++){const W=te/w,Z=v*Math.cos(W*Math.PI/2),he=y*Math.sin(W*Math.PI/2)+x;for(let pe=0,_e=L.length;pe<_e;pe++){const Re=U(L[pe],J[pe],he);se(Re.x,Re.y,-Z)}for(let pe=0,_e=D.length;pe<_e;pe++){const Re=D[pe];ne=ee[pe];for(let ie=0,q=Re.length;ie<q;ie++){const me=U(Re[ie],ne[ie],he);se(me.x,me.y,-Z)}}}const ye=y+x;for(let te=0;te<V;te++){const W=m?U(E[te],ge[te],ye):E[te];T?(N.copy(A.normals[0]).multiplyScalar(W.x),P.copy(A.binormals[0]).multiplyScalar(W.y),k.copy(_[0]).add(N).add(P),se(k.x,k.y,k.z)):se(W.x,W.y,0)}for(let te=1;te<=f;te++)for(let W=0;W<V;W++){const Z=m?U(E[W],ge[W],ye):E[W];T?(N.copy(A.normals[te]).multiplyScalar(Z.x),P.copy(A.binormals[te]).multiplyScalar(Z.y),k.copy(_[te]).add(N).add(P),se(k.x,k.y,k.z)):se(Z.x,Z.y,p/f*te)}for(let te=w-1;te>=0;te--){const W=te/w,Z=v*Math.cos(W*Math.PI/2),he=y*Math.sin(W*Math.PI/2)+x;for(let pe=0,_e=L.length;pe<_e;pe++){const Re=U(L[pe],J[pe],he);se(Re.x,Re.y,p+Z)}for(let pe=0,_e=D.length;pe<_e;pe++){const Re=D[pe];ne=ee[pe];for(let ie=0,q=Re.length;ie<q;ie++){const me=U(Re[ie],ne[ie],he);T?se(me.x,me.y+_[f-1].y,_[f-1].x+Z):se(me.x,me.y,p+Z)}}}ce(),we();function ce(){const te=s.length/3;if(m){let W=0,Z=V*W;for(let he=0;he<X;he++){const pe=I[he];ae(pe[2]+Z,pe[1]+Z,pe[0]+Z)}W=f+w*2,Z=V*W;for(let he=0;he<X;he++){const pe=I[he];ae(pe[0]+Z,pe[1]+Z,pe[2]+Z)}}else{for(let W=0;W<X;W++){const Z=I[W];ae(Z[2],Z[1],Z[0])}for(let W=0;W<X;W++){const Z=I[W];ae(Z[0]+V*f,Z[1]+V*f,Z[2]+V*f)}}i.addGroup(te,s.length/3-te,0)}function we(){const te=s.length/3;let W=0;be(L,W),W+=L.length;for(let Z=0,he=D.length;Z<he;Z++){const pe=D[Z];be(pe,W),W+=pe.length}i.addGroup(te,s.length/3-te,1)}function be(te,W){let Z=te.length;for(;--Z>=0;){const he=Z;let pe=Z-1;pe<0&&(pe=te.length-1);for(let _e=0,Re=f+w*2;_e<Re;_e++){const ie=V*_e,q=V*(_e+1),me=W+he+ie,ve=W+pe+ie,Te=W+pe+q,ke=W+he+q;Q(me,ve,Te,ke)}}}function se(te,W,Z){h.push(te),h.push(W),h.push(Z)}function ae(te,W,Z){z(te),z(W),z(Z);const he=s.length/3,pe=O.generateTopUV(i,s,he-3,he-2,he-1);j(pe[0]),j(pe[1]),j(pe[2])}function Q(te,W,Z,he){z(te),z(W),z(he),z(W),z(Z),z(he);const pe=s.length/3,_e=O.generateSideWallUV(i,s,pe-6,pe-3,pe-2,pe-1);j(_e[0]),j(_e[1]),j(_e[3]),j(_e[1]),j(_e[2]),j(_e[3])}function z(te){s.push(h[te*3+0]),s.push(h[te*3+1]),s.push(h[te*3+2])}function j(te){o.push(te.x),o.push(te.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return jwe(n,i,e)}static fromJSON(e,n){const i=[];for(let o=0,a=e.shapes.length;o<a;o++){const l=n[e.shapes[o]];i.push(l)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new ES[s.type]().fromJSON(s)),new Nb(i,e.options)}}const Qwe={generateTopUV:function(r,e,n,i,s){const o=e[n*3],a=e[n*3+1],l=e[i*3],h=e[i*3+1],u=e[s*3],f=e[s*3+1];return[new Xe(o,a),new Xe(l,h),new Xe(u,f)]},generateSideWallUV:function(r,e,n,i,s,o){const a=e[n*3],l=e[n*3+1],h=e[n*3+2],u=e[i*3],f=e[i*3+1],p=e[i*3+2],m=e[s*3],v=e[s*3+1],y=e[s*3+2],x=e[o*3],w=e[o*3+1],S=e[o*3+2];return Math.abs(l-f)<Math.abs(a-u)?[new Xe(a,1-h),new Xe(u,1-p),new Xe(m,1-y),new Xe(x,1-S)]:[new Xe(l,1-h),new Xe(f,1-p),new Xe(v,1-y),new Xe(w,1-S)]}};function jwe(r,e,n){if(n.shapes=[],Array.isArray(r))for(let i=0,s=r.length;i<s;i++){const o=r[i];n.shapes.push(o.uuid)}else n.shapes.push(r.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class d2 extends bd{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,s=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,o,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new d2(e.radius,e.detail)}}class Db extends bd{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,s,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new Db(e.radius,e.detail)}}class f2 extends vi{constructor(e=.5,n=1,i=32,s=1,o=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:s,thetaStart:o,thetaLength:a},i=Math.max(3,i),s=Math.max(1,s);const l=[],h=[],u=[],f=[];let p=e;const m=(n-e)/s,v=new le,y=new Xe;for(let x=0;x<=s;x++){for(let w=0;w<=i;w++){const S=o+w/i*a;v.x=p*Math.cos(S),v.y=p*Math.sin(S),h.push(v.x,v.y,v.z),u.push(0,0,1),y.x=(v.x/n+1)/2,y.y=(v.y/n+1)/2,f.push(y.x,y.y)}p+=m}for(let x=0;x<s;x++){const w=x*(i+1);for(let S=0;S<i;S++){const O=S+w,_=O,T=O+i+1,A=O+i+2,P=O+1;l.push(_,T,P),l.push(T,A,P)}}this.setIndex(l),this.setAttribute("position",new Nt(h,3)),this.setAttribute("normal",new Nt(u,3)),this.setAttribute("uv",new Nt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new f2(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class p2 extends vi{constructor(e=new Ff([new Xe(0,.5),new Xe(-.5,-.5),new Xe(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],s=[],o=[],a=[];let l=0,h=0;if(Array.isArray(e)===!1)u(e);else for(let f=0;f<e.length;f++)u(e[f]),this.addGroup(l,h,f),l+=h,h=0;this.setIndex(i),this.setAttribute("position",new Nt(s,3)),this.setAttribute("normal",new Nt(o,3)),this.setAttribute("uv",new Nt(a,2));function u(f){const p=s.length/3,m=f.extractPoints(n);let v=m.shape;const y=m.holes;ac.isClockWise(v)===!1&&(v=v.reverse());for(let w=0,S=y.length;w<S;w++){const O=y[w];ac.isClockWise(O)===!0&&(y[w]=O.reverse())}const x=ac.triangulateShape(v,y);for(let w=0,S=y.length;w<S;w++){const O=y[w];v=v.concat(O)}for(let w=0,S=v.length;w<S;w++){const O=v[w];s.push(O.x,O.y,0),o.push(0,0,1),a.push(O.x,O.y)}for(let w=0,S=x.length;w<S;w++){const O=x[w],_=O[0]+p,T=O[1]+p,A=O[2]+p;i.push(_,T,A),h+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return Ywe(n,e)}static fromJSON(e,n){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=n[e.shapes[s]];i.push(a)}return new p2(i,e.curveSegments)}}function Ywe(r,e){if(e.shapes=[],Array.isArray(r))for(let n=0,i=r.length;n<i;n++){const s=r[n];e.shapes.push(s.uuid)}else e.shapes.push(r.uuid);return e}class Lb extends vi{constructor(e=1,n=32,i=16,s=0,o=Math.PI*2,a=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:s,phiLength:o,thetaStart:a,thetaLength:l},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const h=Math.min(a+l,Math.PI);let u=0;const f=[],p=new le,m=new le,v=[],y=[],x=[],w=[];for(let S=0;S<=i;S++){const O=[],_=S/i;let T=0;S===0&&a===0?T=.5/n:S===i&&h===Math.PI&&(T=-.5/n);for(let A=0;A<=n;A++){const P=A/n;p.x=-e*Math.cos(s+P*o)*Math.sin(a+_*l),p.y=e*Math.cos(a+_*l),p.z=e*Math.sin(s+P*o)*Math.sin(a+_*l),y.push(p.x,p.y,p.z),m.copy(p).normalize(),x.push(m.x,m.y,m.z),w.push(P+T,1-_),O.push(u++)}f.push(O)}for(let S=0;S<i;S++)for(let O=0;O<n;O++){const _=f[S][O+1],T=f[S][O],A=f[S+1][O],P=f[S+1][O+1];(S!==0||a>0)&&v.push(_,T,P),(S!==i-1||h<Math.PI)&&v.push(T,A,P)}this.setIndex(v),this.setAttribute("position",new Nt(y,3)),this.setAttribute("normal",new Nt(x,3)),this.setAttribute("uv",new Nt(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lb(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class m2 extends bd{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,s,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new m2(e.radius,e.detail)}}class g2 extends vi{constructor(e=1,n=.4,i=12,s=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:s,arc:o},i=Math.floor(i),s=Math.floor(s);const a=[],l=[],h=[],u=[],f=new le,p=new le,m=new le;for(let v=0;v<=i;v++)for(let y=0;y<=s;y++){const x=y/s*o,w=v/i*Math.PI*2;p.x=(e+n*Math.cos(w))*Math.cos(x),p.y=(e+n*Math.cos(w))*Math.sin(x),p.z=n*Math.sin(w),l.push(p.x,p.y,p.z),f.x=e*Math.cos(x),f.y=e*Math.sin(x),m.subVectors(p,f).normalize(),h.push(m.x,m.y,m.z),u.push(y/s),u.push(v/i)}for(let v=1;v<=i;v++)for(let y=1;y<=s;y++){const x=(s+1)*v+y-1,w=(s+1)*(v-1)+y-1,S=(s+1)*(v-1)+y,O=(s+1)*v+y;a.push(x,w,O),a.push(w,S,O)}this.setIndex(a),this.setAttribute("position",new Nt(l,3)),this.setAttribute("normal",new Nt(h,3)),this.setAttribute("uv",new Nt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new g2(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class v2 extends vi{constructor(e=1,n=.4,i=64,s=8,o=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:s,p:o,q:a},i=Math.floor(i),s=Math.floor(s);const l=[],h=[],u=[],f=[],p=new le,m=new le,v=new le,y=new le,x=new le,w=new le,S=new le;for(let _=0;_<=i;++_){const T=_/i*o*Math.PI*2;O(T,o,a,e,v),O(T+.01,o,a,e,y),w.subVectors(y,v),S.addVectors(y,v),x.crossVectors(w,S),S.crossVectors(x,w),x.normalize(),S.normalize();for(let A=0;A<=s;++A){const P=A/s*Math.PI*2,N=-n*Math.cos(P),k=n*Math.sin(P);p.x=v.x+(N*S.x+k*x.x),p.y=v.y+(N*S.y+k*x.y),p.z=v.z+(N*S.z+k*x.z),h.push(p.x,p.y,p.z),m.subVectors(p,v).normalize(),u.push(m.x,m.y,m.z),f.push(_/i),f.push(A/s)}}for(let _=1;_<=i;_++)for(let T=1;T<=s;T++){const A=(s+1)*(_-1)+(T-1),P=(s+1)*_+(T-1),N=(s+1)*_+T,k=(s+1)*(_-1)+T;l.push(A,P,k),l.push(P,N,k)}this.setIndex(l),this.setAttribute("position",new Nt(h,3)),this.setAttribute("normal",new Nt(u,3)),this.setAttribute("uv",new Nt(f,2));function O(_,T,A,P,N){const k=Math.cos(_),R=Math.sin(_),E=A/T*_,D=Math.cos(E);N.x=P*(2+D)*.5*k,N.y=P*(2+D)*R*.5,N.z=P*Math.sin(E)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new v2(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class y2 extends vi{constructor(e=new e4(new le(-1,-1,0),new le(-1,1,0),new le(1,1,0)),n=64,i=1,s=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:s,closed:o};const a=e.computeFrenetFrames(n,o);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const l=new le,h=new le,u=new Xe;let f=new le;const p=[],m=[],v=[],y=[];x(),this.setIndex(y),this.setAttribute("position",new Nt(p,3)),this.setAttribute("normal",new Nt(m,3)),this.setAttribute("uv",new Nt(v,2));function x(){for(let _=0;_<n;_++)w(_);w(o===!1?n:0),O(),S()}function w(_){f=e.getPointAt(_/n,f);const T=a.normals[_],A=a.binormals[_];for(let P=0;P<=s;P++){const N=P/s*Math.PI*2,k=Math.sin(N),R=-Math.cos(N);h.x=R*T.x+k*A.x,h.y=R*T.y+k*A.y,h.z=R*T.z+k*A.z,h.normalize(),m.push(h.x,h.y,h.z),l.x=f.x+i*h.x,l.y=f.y+i*h.y,l.z=f.z+i*h.z,p.push(l.x,l.y,l.z)}}function S(){for(let _=1;_<=n;_++)for(let T=1;T<=s;T++){const A=(s+1)*(_-1)+(T-1),P=(s+1)*_+(T-1),N=(s+1)*_+T,k=(s+1)*(_-1)+T;y.push(A,P,k),y.push(P,N,k)}}function O(){for(let _=0;_<=n;_++)for(let T=0;T<=s;T++)u.x=_/n,u.y=T/s,v.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new y2(new ES[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class YG extends vi{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,s=new le,o=new le;if(e.index!==null){const a=e.attributes.position,l=e.index;let h=e.groups;h.length===0&&(h=[{start:0,count:l.count,materialIndex:0}]);for(let u=0,f=h.length;u<f;++u){const p=h[u],m=p.start,v=p.count;for(let y=m,x=m+v;y<x;y+=3)for(let w=0;w<3;w++){const S=l.getX(y+w),O=l.getX(y+(w+1)%3);s.fromBufferAttribute(a,S),o.fromBufferAttribute(a,O),z$(s,o,i)===!0&&(n.push(s.x,s.y,s.z),n.push(o.x,o.y,o.z))}}}else{const a=e.attributes.position;for(let l=0,h=a.count/3;l<h;l++)for(let u=0;u<3;u++){const f=3*l+u,p=3*l+(u+1)%3;s.fromBufferAttribute(a,f),o.fromBufferAttribute(a,p),z$(s,o,i)===!0&&(n.push(s.x,s.y,s.z),n.push(o.x,o.y,o.z))}}this.setAttribute("position",new Nt(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function z$(r,e,n){const i=`${r.x},${r.y},${r.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${r.x},${r.y},${r.z}`;return n.has(i)===!0||n.has(s)===!0?!1:(n.add(i),n.add(s),!0)}var X$=Object.freeze({__proto__:null,BoxGeometry:Rh,CapsuleGeometry:a2,CircleGeometry:l2,ConeGeometry:c2,CylinderGeometry:u0,DodecahedronGeometry:h2,EdgesGeometry:GG,ExtrudeGeometry:Nb,IcosahedronGeometry:d2,LatheGeometry:Ib,OctahedronGeometry:Db,PlaneGeometry:yd,PolyhedronGeometry:bd,RingGeometry:f2,ShapeGeometry:p2,SphereGeometry:Lb,TetrahedronGeometry:m2,TorusGeometry:g2,TorusKnotGeometry:v2,TubeGeometry:y2,WireframeGeometry:YG});class qG extends Xr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new nt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class a1 extends io{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class d0 extends Xr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new nt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vd,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vr,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ua extends d0{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Xe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return hr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new nt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new nt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new nt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class fg extends Xr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new nt(16777215),this.specular=new nt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vd,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vr,this.combine=Tb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ZG extends Xr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new nt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vd,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class KG extends Xr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vd,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class i4 extends Xr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vd,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Vr,this.combine=Tb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class JG extends Xr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new nt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vd,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eH extends bs{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Af(r,e,n){return!r||!n&&r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)}function tH(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function iH(r){function e(s,o){return r[s]-r[o]}const n=r.length,i=new Array(n);for(let s=0;s!==n;++s)i[s]=s;return i.sort(e),i}function UP(r,e,n){const i=r.length,s=new r.constructor(i);for(let o=0,a=0;a!==i;++o){const l=n[o]*e;for(let h=0;h!==e;++h)s[a++]=r[l+h]}return s}function n4(r,e,n,i){let s=1,o=r[0];for(;o!==void 0&&o[i]===void 0;)o=r[s++];if(o===void 0)return;let a=o[i];if(a!==void 0)if(Array.isArray(a))do a=o[i],a!==void 0&&(e.push(o.time),n.push.apply(n,a)),o=r[s++];while(o!==void 0);else if(a.toArray!==void 0)do a=o[i],a!==void 0&&(e.push(o.time),a.toArray(n,n.length)),o=r[s++];while(o!==void 0);else do a=o[i],a!==void 0&&(e.push(o.time),n.push(a)),o=r[s++];while(o!==void 0)}function qwe(r,e,n,i,s=30){const o=r.clone();o.name=e;const a=[];for(let h=0;h<o.tracks.length;++h){const u=o.tracks[h],f=u.getValueSize(),p=[],m=[];for(let v=0;v<u.times.length;++v){const y=u.times[v]*s;if(!(y<n||y>=i)){p.push(u.times[v]);for(let x=0;x<f;++x)m.push(u.values[v*f+x])}}p.length!==0&&(u.times=Af(p,u.times.constructor),u.values=Af(m,u.values.constructor),a.push(u))}o.tracks=a;let l=1/0;for(let h=0;h<o.tracks.length;++h)l>o.tracks[h].times[0]&&(l=o.tracks[h].times[0]);for(let h=0;h<o.tracks.length;++h)o.tracks[h].shift(-1*l);return o.resetDuration(),o}function Zwe(r,e=0,n=r,i=30){i<=0&&(i=30);const s=n.tracks.length,o=e/i;for(let a=0;a<s;++a){const l=n.tracks[a],h=l.ValueTypeName;if(h==="bool"||h==="string")continue;const u=r.tracks.find(function(S){return S.name===l.name&&S.ValueTypeName===h});if(u===void 0)continue;let f=0;const p=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=p/3);let m=0;const v=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=v/3);const y=l.times.length-1;let x;if(o<=l.times[0]){const S=f,O=p-f;x=l.values.slice(S,O)}else if(o>=l.times[y]){const S=y*p+f,O=S+p-f;x=l.values.slice(S,O)}else{const S=l.createInterpolant(),O=f,_=p-f;S.evaluate(o),x=S.resultBuffer.slice(O,_)}h==="quaternion"&&new ur().fromArray(x).normalize().conjugate().toArray(x);const w=u.times.length;for(let S=0;S<w;++S){const O=S*v+m;if(h==="quaternion")ur.multiplyQuaternionsFlat(u.values,O,x,0,u.values,O);else{const _=v-m*2;for(let T=0;T<_;++T)u.values[O+T]-=x[T]}}}return r.blendMode=BI,r}const Kwe={convertArray:Af,isTypedArray:tH,getKeyframeOrder:iH,sortedArray:UP,flattenJSON:n4,subclip:qwe,makeClipAdditive:Zwe};class f0{constructor(e,n,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,s=n[i],o=n[i-1];e:{t:{let a;i:{n:if(!(e<s)){for(let l=i+2;;){if(s===void 0){if(e<o)break n;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(o=s,s=n[++i],e<s)break t}a=n.length;break i}if(!(e>=o)){const l=n[1];e<l&&(i=2,o=l);for(let h=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===h)break;if(s=o,o=n[--i-1],e>=o)break t}a=i,i=0;break i}break e}for(;i<a;){const l=i+a>>>1;e<n[l]?a=l:i=l+1}if(s=n[i],o=n[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,s)}return this.interpolate_(i,o,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s;for(let a=0;a!==s;++a)n[a]=i[o+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class nH extends f0{constructor(e,n,i,s){super(e,n,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Tf,endingEnd:Tf}}intervalChanged_(e,n,i){const s=this.parameterPositions;let o=e-2,a=e+1,l=s[o],h=s[a];if(l===void 0)switch(this.getSettings_().endingStart){case Ef:o=e,l=2*n-i;break;case P1:o=s.length-2,l=n+s[o]-s[o+1];break;default:o=e,l=i}if(h===void 0)switch(this.getSettings_().endingEnd){case Ef:a=e,h=2*i-n;break;case P1:a=1,h=i+s[1]-s[0];break;default:a=e-1,h=n}const u=(i-n)*.5,f=this.valueSize;this._weightPrev=u/(n-l),this._weightNext=u/(h-i),this._offsetPrev=o*f,this._offsetNext=a*f}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,h=e*l,u=h-l,f=this._offsetPrev,p=this._offsetNext,m=this._weightPrev,v=this._weightNext,y=(i-n)/(s-n),x=y*y,w=x*y,S=-m*w+2*m*x-m*y,O=(1+m)*w+(-1.5-2*m)*x+(-.5+m)*y+1,_=(-1-v)*w+(1.5+v)*x+.5*y,T=v*w-v*x;for(let A=0;A!==l;++A)o[A]=S*a[f+A]+O*a[u+A]+_*a[h+A]+T*a[p+A];return o}}class r4 extends f0{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,h=e*l,u=h-l,f=(i-n)/(s-n),p=1-f;for(let m=0;m!==l;++m)o[m]=a[u+m]*p+a[h+m]*f;return o}}class rH extends f0{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ol{constructor(e,n,i,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Af(n,this.TimeBufferType),this.values=Af(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:Af(e.times,Array),values:Af(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new rH(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new r4(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new nH(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case ip:n=this.InterpolantFactoryMethodDiscrete;break;case id:n=this.InterpolantFactoryMethodLinear;break;case kO:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ip;case this.InterpolantFactoryMethodLinear:return id;case this.InterpolantFactoryMethodSmooth:return kO}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,s=n.length;i!==s;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,s=n.length;i!==s;++i)n[i]*=e}return this}trim(e,n){const i=this.times,s=i.length;let o=0,a=s-1;for(;o!==s&&i[o]<e;)++o;for(;a!==-1&&i[a]>n;)--a;if(++a,o!==0||a!==s){o>=a&&(a=Math.max(a,1),o=a-1);const l=this.getValueSize();this.times=i.slice(o,a),this.values=this.values.slice(o*l,a*l)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,s=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let l=0;l!==o;l++){const h=i[l];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,h),e=!1;break}if(a!==null&&a>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,h,a),e=!1;break}a=h}if(s!==void 0&&tH(s))for(let l=0,h=s.length;l!==h;++l){const u=s[l];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),s=this.getInterpolation()===kO,o=e.length-1;let a=1;for(let l=1;l<o;++l){let h=!1;const u=e[l],f=e[l+1];if(u!==f&&(l!==1||u!==e[0]))if(s)h=!0;else{const p=l*i,m=p-i,v=p+i;for(let y=0;y!==i;++y){const x=n[p+y];if(x!==n[m+y]||x!==n[v+y]){h=!0;break}}}if(h){if(l!==a){e[a]=e[l];const p=l*i,m=a*i;for(let v=0;v!==i;++v)n[m+v]=n[p+v]}++a}}if(o>0){e[a]=e[o];for(let l=o*i,h=a*i,u=0;u!==i;++u)n[h+u]=n[l+u];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,s=new i(this.name,e,n);return s.createInterpolant=this.createInterpolant,s}}Ol.prototype.TimeBufferType=Float32Array;Ol.prototype.ValueBufferType=Float32Array;Ol.prototype.DefaultInterpolation=id;class Cp extends Ol{}Cp.prototype.ValueTypeName="bool";Cp.prototype.ValueBufferType=Array;Cp.prototype.DefaultInterpolation=ip;Cp.prototype.InterpolantFactoryMethodLinear=void 0;Cp.prototype.InterpolantFactoryMethodSmooth=void 0;class s4 extends Ol{}s4.prototype.ValueTypeName="color";class nd extends Ol{}nd.prototype.ValueTypeName="number";class sH extends f0{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,h=(i-n)/(s-n);let u=e*l;for(let f=u+l;u!==f;u+=4)ur.slerpFlat(o,0,a,u-l,a,u,h);return o}}class _h extends Ol{InterpolantFactoryMethodLinear(e){return new sH(this.times,this.values,this.getValueSize(),e)}}_h.prototype.ValueTypeName="quaternion";_h.prototype.DefaultInterpolation=id;_h.prototype.InterpolantFactoryMethodSmooth=void 0;class Tp extends Ol{}Tp.prototype.ValueTypeName="string";Tp.prototype.ValueBufferType=Array;Tp.prototype.DefaultInterpolation=ip;Tp.prototype.InterpolantFactoryMethodLinear=void 0;Tp.prototype.InterpolantFactoryMethodSmooth=void 0;class rd extends Ol{}rd.prototype.ValueTypeName="vector";class op{constructor(e="",n=-1,i=[],s=YC){this.name=e,this.tracks=i,this.duration=n,this.blendMode=s,this.uuid=ra(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,s=1/(e.fps||1);for(let a=0,l=i.length;a!==l;++a)n.push(e_e(i[a]).scale(s));const o=new this(e.name,e.duration,n,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const n=[],i=e.tracks,s={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,a=i.length;o!==a;++o)n.push(Ol.toJSON(i[o]));return s}static CreateFromMorphTargetSequence(e,n,i,s){const o=n.length,a=[];for(let l=0;l<o;l++){let h=[],u=[];h.push((l+o-1)%o,l,(l+1)%o),u.push(0,1,0);const f=iH(h);h=UP(h,1,f),u=UP(u,1,f),!s&&h[0]===0&&(h.push(o),u.push(u[0])),a.push(new nd(".morphTargetInfluences["+n[l].name+"]",h,u).scale(1/i))}return new this(e,-1,a)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const s=e;i=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<i.length;s++)if(i[s].name===n)return i[s];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const s={},o=/^([\w-]*?)([\d]+)$/;for(let l=0,h=e.length;l<h;l++){const u=e[l],f=u.name.match(o);if(f&&f.length>1){const p=f[1];let m=s[p];m||(s[p]=m=[]),m.push(u)}}const a=[];for(const l in s)a.push(this.CreateFromMorphTargetSequence(l,s[l],n,i));return a}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(p,m,v,y,x){if(v.length!==0){const w=[],S=[];n4(v,w,S,y),w.length!==0&&x.push(new p(m,w,S))}},s=[],o=e.name||"default",a=e.fps||30,l=e.blendMode;let h=e.length||-1;const u=e.hierarchy||[];for(let p=0;p<u.length;p++){const m=u[p].keys;if(!(!m||m.length===0))if(m[0].morphTargets){const v={};let y;for(y=0;y<m.length;y++)if(m[y].morphTargets)for(let x=0;x<m[y].morphTargets.length;x++)v[m[y].morphTargets[x]]=-1;for(const x in v){const w=[],S=[];for(let O=0;O!==m[y].morphTargets.length;++O){const _=m[y];w.push(_.time),S.push(_.morphTarget===x?1:0)}s.push(new nd(".morphTargetInfluence["+x+"]",w,S))}h=v.length*a}else{const v=".bones["+n[p].name+"]";i(rd,v+".position",m,"pos",s),i(_h,v+".quaternion",m,"rot",s),i(rd,v+".scale",m,"scl",s)}}return s.length===0?null:new this(o,h,s,l)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,s=e.length;i!==s;++i){const o=this.tracks[i];n=Math.max(n,o.times[o.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Jwe(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return nd;case"vector":case"vector2":case"vector3":case"vector4":return rd;case"color":return s4;case"quaternion":return _h;case"bool":case"boolean":return Cp;case"string":return Tp}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function e_e(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Jwe(r.type);if(r.times===void 0){const n=[],i=[];n4(r.keys,n,i,"value"),r.times=n,r.values=i}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const rh={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class o4{constructor(e,n,i){const s=this;let o=!1,a=0,l=0,h;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(f){l++,o===!1&&s.onStart!==void 0&&s.onStart(f,a,l),o=!0},this.itemEnd=function(f){a++,s.onProgress!==void 0&&s.onProgress(f,a,l),a===l&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(f){s.onError!==void 0&&s.onError(f)},this.resolveURL=function(f){return h?h(f):f},this.setURLModifier=function(f){return h=f,this},this.addHandler=function(f,p){return u.push(f,p),this},this.removeHandler=function(f){const p=u.indexOf(f);return p!==-1&&u.splice(p,2),this},this.getHandler=function(f){for(let p=0,m=u.length;p<m;p+=2){const v=u[p],y=u[p+1];if(v.global&&(v.lastIndex=0),v.test(f))return y}return null}}}const oH=new o4;let xs=class{constructor(e){this.manager=e!==void 0?e:oH,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(s,o){i.load(e,s,n,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};xs.DEFAULT_MATERIAL_NAME="__DEFAULT";const Vc={};class t_e extends Error{constructor(e,n){super(e),this.response=n}}class aa extends xs{constructor(e){super(e)}load(e,n,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=rh.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(o),this.manager.itemEnd(e)},0),o;if(Vc[e]!==void 0){Vc[e].push({onLoad:n,onProgress:i,onError:s});return}Vc[e]=[],Vc[e].push({onLoad:n,onProgress:i,onError:s});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,h=this.responseType;fetch(a).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const f=Vc[e],p=u.body.getReader(),m=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),v=m?parseInt(m):0,y=v!==0;let x=0;const w=new ReadableStream({start(S){O();function O(){p.read().then(({done:_,value:T})=>{if(_)S.close();else{x+=T.byteLength;const A=new ProgressEvent("progress",{lengthComputable:y,loaded:x,total:v});for(let P=0,N=f.length;P<N;P++){const k=f[P];k.onProgress&&k.onProgress(A)}S.enqueue(T),O()}})}}});return new Response(w)}else throw new t_e(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(h){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(f=>new DOMParser().parseFromString(f,l));case"json":return u.json();default:if(l===void 0)return u.text();{const p=/charset="?([^;"\s]*)"?/i.exec(l),m=p&&p[1]?p[1].toLowerCase():void 0,v=new TextDecoder(m);return u.arrayBuffer().then(y=>v.decode(y))}}}).then(u=>{rh.add(e,u);const f=Vc[e];delete Vc[e];for(let p=0,m=f.length;p<m;p++){const v=f[p];v.onLoad&&v.onLoad(u)}}).catch(u=>{const f=Vc[e];if(f===void 0)throw this.manager.itemError(e),u;delete Vc[e];for(let p=0,m=f.length;p<m;p++){const v=f[p];v.onError&&v.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class i_e extends xs{constructor(e){super(e)}load(e,n,i,s){const o=this,a=new aa(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{n(o.parse(JSON.parse(l)))}catch(h){s?s(h):console.error(h),o.manager.itemError(e)}},i,s)}parse(e){const n=[];for(let i=0;i<e.length;i++){const s=op.parse(e[i]);n.push(s)}return n}}class n_e extends xs{constructor(e){super(e)}load(e,n,i,s){const o=this,a=[],l=new Vf,h=new aa(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(o.withCredentials);let u=0;function f(p){h.load(e[p],function(m){const v=o.parse(m,!0);a[p]={width:v.width,height:v.height,format:v.format,mipmaps:v.mipmaps},u+=1,u===6&&(v.mipmapCount===1&&(l.minFilter=ir),l.image=a,l.format=v.format,l.needsUpdate=!0,n&&n(l))},i,s)}if(Array.isArray(e))for(let p=0,m=e.length;p<m;++p)f(p);else h.load(e,function(p){const m=o.parse(p,!0);if(m.isCubemap){const v=m.mipmaps.length/m.mipmapCount;for(let y=0;y<v;y++){a[y]={mipmaps:[]};for(let x=0;x<m.mipmapCount;x++)a[y].mipmaps.push(m.mipmaps[y*m.mipmapCount+x]),a[y].format=m.format,a[y].width=m.width,a[y].height=m.height}l.image=a}else l.image.width=m.width,l.image.height=m.height,l.mipmaps=m.mipmaps;m.mipmapCount===1&&(l.minFilter=ir),l.format=m.format,l.needsUpdate=!0,n&&n(l)},i,s);return l}}class z1 extends xs{constructor(e){super(e)}load(e,n,i,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=rh.get(e);if(a!==void 0)return o.manager.itemStart(e),setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a;const l=B1("img");function h(){f(),rh.add(e,this),n&&n(this),o.manager.itemEnd(e)}function u(p){f(),s&&s(p),o.manager.itemError(e),o.manager.itemEnd(e)}function f(){l.removeEventListener("load",h,!1),l.removeEventListener("error",u,!1)}return l.addEventListener("load",h,!1),l.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}}class r_e extends xs{constructor(e){super(e)}load(e,n,i,s){const o=new Pb;o.colorSpace=Jr;const a=new z1(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let l=0;function h(u){a.load(e[u],function(f){o.images[u]=f,l++,l===6&&(o.needsUpdate=!0,n&&n(o))},void 0,s)}for(let u=0;u<e.length;++u)h(u);return o}}class s_e extends xs{constructor(e){super(e)}load(e,n,i,s){const o=this,a=new Qu,l=new aa(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(o.withCredentials),l.load(e,function(h){let u;try{u=o.parse(h)}catch(f){if(s!==void 0)s(f);else{console.error(f);return}}u.image!==void 0?a.image=u.image:u.data!==void 0&&(a.image.width=u.width,a.image.height=u.height,a.image.data=u.data),a.wrapS=u.wrapS!==void 0?u.wrapS:Ps,a.wrapT=u.wrapT!==void 0?u.wrapT:Ps,a.magFilter=u.magFilter!==void 0?u.magFilter:ir,a.minFilter=u.minFilter!==void 0?u.minFilter:ir,a.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0&&(a.colorSpace=u.colorSpace),u.flipY!==void 0&&(a.flipY=u.flipY),u.format!==void 0&&(a.format=u.format),u.type!==void 0&&(a.type=u.type),u.mipmaps!==void 0&&(a.mipmaps=u.mipmaps,a.minFilter=Ko),u.mipmapCount===1&&(a.minFilter=ir),u.generateMipmaps!==void 0&&(a.generateMipmaps=u.generateMipmaps),a.needsUpdate=!0,n&&n(a,u)},i,s),a}}class Bb extends xs{constructor(e){super(e)}load(e,n,i,s){const o=new qn,a=new z1(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(l){o.image=l,o.needsUpdate=!0,n!==void 0&&n(o)},i,s),o}}class xd extends Li{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new nt(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class aH extends xd{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Li.DEFAULT_UP),this.updateMatrix(),this.groundColor=new nt(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const bM=new dt,W$=new le,G$=new le;class a4{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Xe(512,512),this.map=null,this.mapPass=null,this.matrix=new dt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Rb,this._frameExtents=new Xe(1,1),this._viewportCount=1,this._viewports=[new Ni(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;W$.setFromMatrixPosition(e.matrixWorld),n.position.copy(W$),G$.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(G$),n.updateMatrixWorld(),bM.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(bM),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(bM)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class o_e extends a4{constructor(){super(new fn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=Ug*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=e.distance||n.far;(i!==n.fov||s!==n.aspect||o!==n.far)&&(n.fov=i,n.aspect=s,n.far=o,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class $b extends xd{constructor(e,n,i=0,s=Math.PI/3,o=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Li.DEFAULT_UP),this.updateMatrix(),this.target=new Li,this.distance=i,this.angle=s,this.penumbra=o,this.decay=a,this.map=null,this.shadow=new o_e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const H$=new dt,bv=new le,xM=new le;class a_e extends a4{constructor(){super(new fn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Xe(4,2),this._viewportCount=6,this._viewports=[new Ni(2,1,1,1),new Ni(0,1,1,1),new Ni(3,1,1,1),new Ni(1,1,1,1),new Ni(3,0,1,1),new Ni(1,0,1,1)],this._cubeDirections=[new le(1,0,0),new le(-1,0,0),new le(0,0,1),new le(0,0,-1),new le(0,1,0),new le(0,-1,0)],this._cubeUps=[new le(0,1,0),new le(0,1,0),new le(0,1,0),new le(0,1,0),new le(0,0,1),new le(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,s=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),bv.setFromMatrixPosition(e.matrixWorld),i.position.copy(bv),xM.copy(i.position),xM.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(xM),i.updateMatrixWorld(),s.makeTranslation(-bv.x,-bv.y,-bv.z),H$.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(H$)}}class X1 extends xd{constructor(e,n,i=0,s=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new a_e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class l_e extends a4{constructor(){super(new Jo(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Ub extends xd{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Li.DEFAULT_UP),this.updateMatrix(),this.target=new Li,this.shadow=new l_e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class b2 extends xd{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class lH extends xd{constructor(e,n,i=10,s=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class cH{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new le)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,s=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*s),n.addScaledVector(a[2],.488603*o),n.addScaledVector(a[3],.488603*i),n.addScaledVector(a[4],1.092548*(i*s)),n.addScaledVector(a[5],1.092548*(s*o)),n.addScaledVector(a[6],.315392*(3*o*o-1)),n.addScaledVector(a[7],1.092548*(i*o)),n.addScaledVector(a[8],.546274*(i*i-s*s)),n}getIrradianceAt(e,n){const i=e.x,s=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*s),n.addScaledVector(a[2],2*.511664*o),n.addScaledVector(a[3],2*.511664*i),n.addScaledVector(a[4],2*.429043*i*s),n.addScaledVector(a[5],2*.429043*s*o),n.addScaledVector(a[6],.743125*o*o-.247708),n.addScaledVector(a[7],2*.429043*i*o),n.addScaledVector(a[8],.429043*(i*i-s*s)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].fromArray(e,n+s*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].toArray(e,n+s*3);return e}static getBasisAt(e,n){const i=e.x,s=e.y,o=e.z;n[0]=.282095,n[1]=.488603*s,n[2]=.488603*o,n[3]=.488603*i,n[4]=1.092548*i*s,n[5]=1.092548*s*o,n[6]=.315392*(3*o*o-1),n[7]=1.092548*i*o,n[8]=.546274*(i*i-s*s)}}class hH extends xd{constructor(e=new cH,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class x2 extends xs{constructor(e){super(e),this.textures={}}load(e,n,i,s){const o=this,a=new aa(o.manager);a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(e,function(l){try{n(o.parse(JSON.parse(l)))}catch(h){s?s(h):console.error(h),o.manager.itemError(e)}},i,s)}parse(e){const n=this.textures;function i(o){return n[o]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",o),n[o]}const s=x2.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new nt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const o in e.uniforms){const a=e.uniforms[o];switch(s.uniforms[o]={},a.type){case"t":s.uniforms[o].value=i(a.value);break;case"c":s.uniforms[o].value=new nt().setHex(a.value);break;case"v2":s.uniforms[o].value=new Xe().fromArray(a.value);break;case"v3":s.uniforms[o].value=new le().fromArray(a.value);break;case"v4":s.uniforms[o].value=new Ni().fromArray(a.value);break;case"m3":s.uniforms[o].value=new Ci().fromArray(a.value);break;case"m4":s.uniforms[o].value=new dt().fromArray(a.value);break;default:s.uniforms[o].value=a.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const o in e.extensions)s.extensions[o]=e.extensions[o];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=i(e.map)),e.matcap!==void 0&&(s.matcap=i(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),s.normalScale=new Xe().fromArray(o)}return e.displacementMap!==void 0&&(s.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=i(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new Xe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=i(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const n={ShadowMaterial:qG,SpriteMaterial:QI,RawShaderMaterial:a1,ShaderMaterial:io,PointsMaterial:r2,MeshPhysicalMaterial:Ua,MeshStandardMaterial:d0,MeshPhongMaterial:fg,MeshToonMaterial:ZG,MeshNormalMaterial:KG,MeshLambertMaterial:i4,MeshDepthMaterial:GI,MeshDistanceMaterial:HI,MeshBasicMaterial:vs,MeshMatcapMaterial:JG,LineDashedMaterial:eH,LineBasicMaterial:bs,Material:Xr};return new n[e]}}class fl{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let i=0,s=e.length;i<s;i++)n+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class uH extends vi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class dH extends xs{constructor(e){super(e)}load(e,n,i,s){const o=this,a=new aa(o.manager);a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(e,function(l){try{n(o.parse(JSON.parse(l)))}catch(h){s?s(h):console.error(h),o.manager.itemError(e)}},i,s)}parse(e){const n={},i={};function s(v,y){if(n[y]!==void 0)return n[y];const w=v.interleavedBuffers[y],S=o(v,w.buffer),O=Hm(w.type,S),_=new c0(O,w.stride);return _.uuid=w.uuid,n[y]=_,_}function o(v,y){if(i[y]!==void 0)return i[y];const w=v.arrayBuffers[y],S=new Uint32Array(w).buffer;return i[y]=S,S}const a=e.isInstancedBufferGeometry?new uH:new vi,l=e.data.index;if(l!==void 0){const v=Hm(l.type,l.array);a.setIndex(new Di(v,1))}const h=e.data.attributes;for(const v in h){const y=h[v];let x;if(y.isInterleavedBufferAttribute){const w=s(e.data,y.data);x=new fc(w,y.itemSize,y.offset,y.normalized)}else{const w=Hm(y.type,y.array),S=y.isInstancedBufferAttribute?rp:Di;x=new S(w,y.itemSize,y.normalized)}y.name!==void 0&&(x.name=y.name),y.usage!==void 0&&x.setUsage(y.usage),a.setAttribute(v,x)}const u=e.data.morphAttributes;if(u)for(const v in u){const y=u[v],x=[];for(let w=0,S=y.length;w<S;w++){const O=y[w];let _;if(O.isInterleavedBufferAttribute){const T=s(e.data,O.data);_=new fc(T,O.itemSize,O.offset,O.normalized)}else{const T=Hm(O.type,O.array);_=new Di(T,O.itemSize,O.normalized)}O.name!==void 0&&(_.name=O.name),x.push(_)}a.morphAttributes[v]=x}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==void 0)for(let v=0,y=p.length;v!==y;++v){const x=p[v];a.addGroup(x.start,x.count,x.materialIndex)}const m=e.data.boundingSphere;if(m!==void 0){const v=new le;m.center!==void 0&&v.fromArray(m.center),a.boundingSphere=new ts(v,m.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class c_e extends xs{constructor(e){super(e)}load(e,n,i,s){const o=this,a=this.path===""?fl.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const l=new aa(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(h){let u=null;try{u=JSON.parse(h)}catch(p){s!==void 0&&s(p),console.error("THREE:ObjectLoader: Can't parse "+e+".",p.message);return}const f=u.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}o.parse(u,n)},i,s)}async loadAsync(e,n){const i=this,s=this.path===""?fl.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const o=new aa(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);const a=await o.loadAsync(e,n),l=JSON.parse(a),h=l.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(l)}parse(e,n){const i=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,s),a=this.parseImages(e.images,function(){n!==void 0&&n(u)}),l=this.parseTextures(e.textures,a),h=this.parseMaterials(e.materials,l),u=this.parseObject(e.object,o,h,l,i),f=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,f),n!==void 0){let p=!1;for(const m in a)if(a[m].data instanceof HTMLImageElement){p=!0;break}p===!1&&n(u)}return u}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),h=this.parseObject(e.object,s,l,a,n),u=this.parseSkeletons(e.skeletons,h);return this.bindSkeletons(h,u),h}parseShapes(e){const n={};if(e!==void 0)for(let i=0,s=e.length;i<s;i++){const o=new Ff().fromJSON(e[i]);n[o.uuid]=o}return n}parseSkeletons(e,n){const i={},s={};if(n.traverse(function(o){o.isBone&&(s[o.uuid]=o)}),e!==void 0)for(let o=0,a=e.length;o<a;o++){const l=new h0().fromJSON(e[o],s);i[l.uuid]=l}return i}parseGeometries(e,n){const i={};if(e!==void 0){const s=new dH;for(let o=0,a=e.length;o<a;o++){let l;const h=e[o];switch(h.type){case"BufferGeometry":case"InstancedBufferGeometry":l=s.parse(h);break;default:h.type in X$?l=X$[h.type].fromJSON(h,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${h.type}"`)}l.uuid=h.uuid,h.name!==void 0&&(l.name=h.name),h.userData!==void 0&&(l.userData=h.userData),i[h.uuid]=l}}return i}parseMaterials(e,n){const i={},s={};if(e!==void 0){const o=new x2;o.setTextures(n);for(let a=0,l=e.length;a<l;a++){const h=e[a];i[h.uuid]===void 0&&(i[h.uuid]=o.parse(h)),s[h.uuid]=i[h.uuid]}}return s}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const s=e[i],o=op.parse(s);n[o.uuid]=o}return n}parseImages(e,n){const i=this,s={};let o;function a(h){return i.manager.itemStart(h),o.load(h,function(){i.manager.itemEnd(h)},void 0,function(){i.manager.itemError(h),i.manager.itemEnd(h)})}function l(h){if(typeof h=="string"){const u=h,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u;return a(f)}else return h.data?{data:Hm(h.type,h.data),width:h.width,height:h.height}:null}if(e!==void 0&&e.length>0){const h=new o4(n);o=new z1(h),o.setCrossOrigin(this.crossOrigin);for(let u=0,f=e.length;u<f;u++){const p=e[u],m=p.url;if(Array.isArray(m)){const v=[];for(let y=0,x=m.length;y<x;y++){const w=m[y],S=l(w);S!==null&&(S instanceof HTMLImageElement?v.push(S):v.push(new Qu(S.data,S.width,S.height)))}s[p.uuid]=new Mf(v)}else{const v=l(p.url);s[p.uuid]=new Mf(v)}}}return s}async parseImagesAsync(e){const n=this,i={};let s;async function o(a){if(typeof a=="string"){const l=a,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:n.resourcePath+l;return await s.loadAsync(h)}else return a.data?{data:Hm(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){s=new z1(this.manager),s.setCrossOrigin(this.crossOrigin);for(let a=0,l=e.length;a<l;a++){const h=e[a],u=h.url;if(Array.isArray(u)){const f=[];for(let p=0,m=u.length;p<m;p++){const v=u[p],y=await o(v);y!==null&&(y instanceof HTMLImageElement?f.push(y):f.push(new Qu(y.data,y.width,y.height)))}i[h.uuid]=new Mf(f)}else{const f=await o(h.url);i[h.uuid]=new Mf(f)}}}return i}parseTextures(e,n){function i(o,a){return typeof o=="number"?o:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",o),a[o])}const s={};if(e!==void 0)for(let o=0,a=e.length;o<a;o++){const l=e[o];l.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),n[l.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",l.image);const h=n[l.image],u=h.data;let f;Array.isArray(u)?(f=new Pb,u.length===6&&(f.needsUpdate=!0)):(u&&u.data?f=new Qu:f=new qn,u&&(f.needsUpdate=!0)),f.source=h,f.uuid=l.uuid,l.name!==void 0&&(f.name=l.name),l.mapping!==void 0&&(f.mapping=i(l.mapping,h_e)),l.channel!==void 0&&(f.channel=l.channel),l.offset!==void 0&&f.offset.fromArray(l.offset),l.repeat!==void 0&&f.repeat.fromArray(l.repeat),l.center!==void 0&&f.center.fromArray(l.center),l.rotation!==void 0&&(f.rotation=l.rotation),l.wrap!==void 0&&(f.wrapS=i(l.wrap[0],Q$),f.wrapT=i(l.wrap[1],Q$)),l.format!==void 0&&(f.format=l.format),l.internalFormat!==void 0&&(f.internalFormat=l.internalFormat),l.type!==void 0&&(f.type=l.type),l.colorSpace!==void 0&&(f.colorSpace=l.colorSpace),l.minFilter!==void 0&&(f.minFilter=i(l.minFilter,j$)),l.magFilter!==void 0&&(f.magFilter=i(l.magFilter,j$)),l.anisotropy!==void 0&&(f.anisotropy=l.anisotropy),l.flipY!==void 0&&(f.flipY=l.flipY),l.generateMipmaps!==void 0&&(f.generateMipmaps=l.generateMipmaps),l.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(f.unpackAlignment=l.unpackAlignment),l.compareFunction!==void 0&&(f.compareFunction=l.compareFunction),l.userData!==void 0&&(f.userData=l.userData),s[l.uuid]=f}return s}parseObject(e,n,i,s,o){let a;function l(m){return n[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",m),n[m]}function h(m){if(m!==void 0){if(Array.isArray(m)){const v=[];for(let y=0,x=m.length;y<x;y++){const w=m[y];i[w]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",w),v.push(i[w])}return v}return i[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),i[m]}}function u(m){return s[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",m),s[m]}let f,p;switch(e.type){case"Scene":a=new np,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new nt(e.background):a.background=u(e.background)),e.environment!==void 0&&(a.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new i2(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new t2(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new fn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Jo(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new b2(e.color,e.intensity);break;case"DirectionalLight":a=new Ub(e.color,e.intensity);break;case"PointLight":a=new X1(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new lH(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new $b(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new aH(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new hH().fromJSON(e);break;case"SkinnedMesh":f=l(e.geometry),p=h(e.material),a=new n2(f,p),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":f=l(e.geometry),p=h(e.material),a=new ln(f,p);break;case"InstancedMesh":f=l(e.geometry),p=h(e.material);const m=e.count,v=e.instanceMatrix,y=e.instanceColor;a=new jI(f,p,m),a.instanceMatrix=new rp(new Float32Array(v.array),16),y!==void 0&&(a.instanceColor=new rp(new Float32Array(y.array),y.itemSize));break;case"BatchedMesh":f=l(e.geometry),p=h(e.material),a=new UG(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,p),a.geometry=f,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._visibility=e.visibility,a._active=e.active,a._bounds=e.bounds.map(x=>{const w=new vr;w.min.fromArray(x.boxMin),w.max.fromArray(x.boxMax);const S=new ts;return S.radius=x.sphereRadius,S.center.fromArray(x.sphereCenter),{boxInitialized:x.boxInitialized,box:w,sphereInitialized:x.sphereInitialized,sphere:S}}),a._maxGeometryCount=e.maxGeometryCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._geometryCount=e.geometryCount,a._matricesTexture=u(e.matricesTexture.uuid);break;case"LOD":a=new $G;break;case"Line":a=new pc(l(e.geometry),h(e.material));break;case"LineLoop":a=new YI(l(e.geometry),h(e.material));break;case"LineSegments":a=new _l(l(e.geometry),h(e.material));break;case"PointCloud":case"Points":a=new qI(l(e.geometry),h(e.material));break;case"Sprite":a=new BG(h(e.material));break;case"Group":a=new qs;break;case"Bone":a=new Fg;break;default:a=new Li}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const m=e.children;for(let v=0;v<m.length;v++)a.add(this.parseObject(m[v],n,i,s,o))}if(e.animations!==void 0){const m=e.animations;for(let v=0;v<m.length;v++){const y=m[v];a.animations.push(o[y])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const m=e.levels;for(let v=0;v<m.length;v++){const y=m[v],x=a.getObjectByProperty("uuid",y.object);x!==void 0&&a.addLevel(x,y.distance,y.hysteresis)}}return a}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const s=n[i.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(s,i.bindMatrix)}})}}const h_e={UVMapping:jC,CubeReflectionMapping:wh,CubeRefractionMapping:td,EquirectangularReflectionMapping:Bg,EquirectangularRefractionMapping:k1,CubeUVReflectionMapping:s0},Q$={RepeatWrapping:yl,ClampToEdgeWrapping:Ps,MirroredRepeatWrapping:ep},j$={NearestFilter:Er,NearestMipmapNearestFilter:Eb,NearestMipmapLinearFilter:Bu,LinearFilter:ir,LinearMipmapNearestFilter:Bf,LinearMipmapLinearFilter:Ko};class fH extends xs{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=rh.get(e);if(a!==void 0){if(o.manager.itemStart(e),a.then){a.then(u=>{n&&n(u),o.manager.itemEnd(e)}).catch(u=>{s&&s(u)});return}return setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a}const l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader;const h=fetch(e,l).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(u){return rh.add(e,u),n&&n(u),o.manager.itemEnd(e),u}).catch(function(u){s&&s(u),rh.remove(e),o.manager.itemError(e),o.manager.itemEnd(e)});rh.add(e,h),o.manager.itemStart(e)}}let n_;class l4{static getContext(){return n_===void 0&&(n_=new(window.AudioContext||window.webkitAudioContext)),n_}static setContext(e){n_=e}}class u_e extends xs{constructor(e){super(e)}load(e,n,i,s){const o=this,a=new aa(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(h){try{const u=h.slice(0);l4.getContext().decodeAudioData(u,function(p){n(p)}).catch(l)}catch(u){l(u)}},i,s);function l(h){s?s(h):console.error(h),o.manager.itemError(e)}}}const Y$=new dt,q$=new dt,Yd=new dt;class d_e{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new fn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new fn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Yd.copy(e.projectionMatrix);const s=n.eyeSep/2,o=s*n.near/n.focus,a=n.near*Math.tan(Uf*n.fov*.5)/n.zoom;let l,h;q$.elements[12]=-s,Y$.elements[12]=s,l=-a*n.aspect+o,h=a*n.aspect+o,Yd.elements[0]=2*n.near/(h-l),Yd.elements[8]=(h+l)/(h-l),this.cameraL.projectionMatrix.copy(Yd),l=-a*n.aspect-o,h=a*n.aspect-o,Yd.elements[0]=2*n.near/(h-l),Yd.elements[8]=(h+l)/(h-l),this.cameraR.projectionMatrix.copy(Yd)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(q$),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Y$)}}class c4{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Z$(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=Z$();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function Z$(){return(typeof performance>"u"?Date:performance).now()}const qd=new le,K$=new ur,f_e=new le,Zd=new le;class p_e extends Li{constructor(){super(),this.type="AudioListener",this.context=l4.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new c4}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(qd,K$,f_e),Zd.set(0,0,-1).applyQuaternion(K$),n.positionX){const s=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(qd.x,s),n.positionY.linearRampToValueAtTime(qd.y,s),n.positionZ.linearRampToValueAtTime(qd.z,s),n.forwardX.linearRampToValueAtTime(Zd.x,s),n.forwardY.linearRampToValueAtTime(Zd.y,s),n.forwardZ.linearRampToValueAtTime(Zd.z,s),n.upX.linearRampToValueAtTime(i.x,s),n.upY.linearRampToValueAtTime(i.y,s),n.upZ.linearRampToValueAtTime(i.z,s)}else n.setPosition(qd.x,qd.y,qd.z),n.setOrientation(Zd.x,Zd.y,Zd.z,i.x,i.y,i.z)}}class pH extends Li{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Kd=new le,J$=new ur,m_e=new le,Jd=new le;class g_e extends pH{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Kd,J$,m_e),Jd.set(0,0,1).applyQuaternion(J$);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Kd.x,i),n.positionY.linearRampToValueAtTime(Kd.y,i),n.positionZ.linearRampToValueAtTime(Kd.z,i),n.orientationX.linearRampToValueAtTime(Jd.x,i),n.orientationY.linearRampToValueAtTime(Jd.y,i),n.orientationZ.linearRampToValueAtTime(Jd.z,i)}else n.setPosition(Kd.x,Kd.y,Kd.z),n.setOrientation(Jd.x,Jd.y,Jd.z)}}class v_e{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class mH{constructor(e,n,i){this.binding=e,this.valueSize=i;let s,o,a;switch(n){case"quaternion":s=this._slerp,o=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":s=this._select,o=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:s=this._lerp,o=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=o,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,s=this.valueSize,o=e*s+s;let a=this.cumulativeWeight;if(a===0){for(let l=0;l!==s;++l)i[o+l]=i[l];a=n}else{a+=n;const l=n/a;this._mixBufferRegion(i,o,0,l,s)}this.cumulativeWeight=a}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,s=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,s,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,s=e*n+n,o=this.cumulativeWeight,a=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const h=n*this._origIndex;this._mixBufferRegion(i,s,h,1-o,n)}a>0&&this._mixBufferRegionAdditive(i,s,this._addIndex*n,1,n);for(let h=n,u=n+n;h!==u;++h)if(i[h]!==i[h+n]){l.setValue(i,s);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,s=i*this._origIndex;e.getValue(n,s);for(let o=i,a=s;o!==a;++o)n[o]=n[s+o%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,s,o){if(s>=.5)for(let a=0;a!==o;++a)e[n+a]=e[i+a]}_slerp(e,n,i,s){ur.slerpFlat(e,n,e,n,e,i,s)}_slerpAdditive(e,n,i,s,o){const a=this._workIndex*o;ur.multiplyQuaternionsFlat(e,a,e,n,e,i),ur.slerpFlat(e,n,e,n,e,a,s)}_lerp(e,n,i,s,o){const a=1-s;for(let l=0;l!==o;++l){const h=n+l;e[h]=e[h]*a+e[i+l]*s}}_lerpAdditive(e,n,i,s,o){for(let a=0;a!==o;++a){const l=n+a;e[l]=e[l]+e[i+a]*s}}}const h4="\\[\\]\\.:\\/",y_e=new RegExp("["+h4+"]","g"),u4="[^"+h4+"]",b_e="[^"+h4.replace("\\.","")+"]",x_e=/((?:WC+[\/:])*)/.source.replace("WC",u4),w_e=/(WCOD+)?/.source.replace("WCOD",b_e),__e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",u4),O_e=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",u4),S_e=new RegExp("^"+x_e+w_e+__e+O_e+"$"),C_e=["material","materials","bones","map"];class T_e{constructor(e,n,i){const s=i||Ai.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,s)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,s=this._bindings[i];s!==void 0&&s.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=i.length;s!==o;++s)i[s].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class Ai{constructor(e,n,i){this.path=n,this.parsedPath=i||Ai.parseTrackName(n),this.node=Ai.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new Ai.Composite(e,n,i):new Ai(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(y_e,"")}static parseTrackName(e){const n=S_e.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=i.nodeName&&i.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const o=i.nodeName.substring(s+1);C_e.indexOf(o)!==-1&&(i.nodeName=i.nodeName.substring(0,s),i.objectName=o)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===n||l.uuid===n)return l;const h=i(l.children);if(h)return h}return null},s=i(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)e[n++]=i[s]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)i[s]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)i[s]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)i[s]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(e||(e=Ai.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let u=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===u){u=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const a=e[s];if(a===void 0){const u=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+s+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}h=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(h=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ai.Composite=T_e;Ai.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ai.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ai.prototype.GetterByBindingType=[Ai.prototype._getValue_direct,Ai.prototype._getValue_array,Ai.prototype._getValue_arrayElement,Ai.prototype._getValue_toArray];Ai.prototype.SetterByBindingTypeAndVersioning=[[Ai.prototype._setValue_direct,Ai.prototype._setValue_direct_setNeedsUpdate,Ai.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ai.prototype._setValue_array,Ai.prototype._setValue_array_setNeedsUpdate,Ai.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ai.prototype._setValue_arrayElement,Ai.prototype._setValue_arrayElement_setNeedsUpdate,Ai.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ai.prototype._setValue_fromArray,Ai.prototype._setValue_fromArray_setNeedsUpdate,Ai.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class E_e{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ra(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,s=arguments.length;i!==s;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length;let l,h=e.length,u=this.nCachedObjects_;for(let f=0,p=arguments.length;f!==p;++f){const m=arguments[f],v=m.uuid;let y=n[v];if(y===void 0){y=h++,n[v]=y,e.push(m);for(let x=0,w=a;x!==w;++x)o[x].push(new Ai(m,i[x],s[x]))}else if(y<u){l=e[y];const x=--u,w=e[x];n[w.uuid]=y,e[y]=w,n[v]=x,e[x]=m;for(let S=0,O=a;S!==O;++S){const _=o[S],T=_[x];let A=_[y];_[y]=T,A===void 0&&(A=new Ai(m,i[S],s[S])),_[x]=A}}else e[y]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,s=i.length;let o=this.nCachedObjects_;for(let a=0,l=arguments.length;a!==l;++a){const h=arguments[a],u=h.uuid,f=n[u];if(f!==void 0&&f>=o){const p=o++,m=e[p];n[m.uuid]=f,e[f]=m,n[u]=p,e[p]=h;for(let v=0,y=s;v!==y;++v){const x=i[v],w=x[p],S=x[f];x[f]=w,x[p]=S}}}this.nCachedObjects_=o}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,s=i.length;let o=this.nCachedObjects_,a=e.length;for(let l=0,h=arguments.length;l!==h;++l){const u=arguments[l],f=u.uuid,p=n[f];if(p!==void 0)if(delete n[f],p<o){const m=--o,v=e[m],y=--a,x=e[y];n[v.uuid]=p,e[p]=v,n[x.uuid]=m,e[m]=x,e.pop();for(let w=0,S=s;w!==S;++w){const O=i[w],_=O[m],T=O[y];O[p]=_,O[m]=T,O.pop()}}else{const m=--a,v=e[m];m>0&&(n[v.uuid]=p),e[p]=v,e.pop();for(let y=0,x=s;y!==x;++y){const w=i[y];w[p]=w[m],w.pop()}}}this.nCachedObjects_=o}subscribe_(e,n){const i=this._bindingsIndicesByPath;let s=i[e];const o=this._bindings;if(s!==void 0)return o[s];const a=this._paths,l=this._parsedPaths,h=this._objects,u=h.length,f=this.nCachedObjects_,p=new Array(u);s=o.length,i[e]=s,a.push(e),l.push(n),o.push(p);for(let m=f,v=h.length;m!==v;++m){const y=h[m];p[m]=new Ai(y,e,n)}return p}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const s=this._paths,o=this._parsedPaths,a=this._bindings,l=a.length-1,h=a[l],u=e[l];n[u]=i,a[i]=h,a.pop(),o[i]=o[l],o.pop(),s[i]=s[l],s.pop()}}}class gH{constructor(e,n,i=null,s=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=s;const o=n.tracks,a=o.length,l=new Array(a),h={endingStart:Tf,endingEnd:Tf};for(let u=0;u!==a;++u){const f=o[u].createInterpolant(null);l[u]=f,f.settings=h}this._interpolantSettings=h,this._interpolants=l,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=oG,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i){if(e.fadeOut(n),this.fadeIn(n),i){const s=this._clip.duration,o=e._clip.duration,a=o/s,l=s/o;e.warp(1,a,n),this.warp(l,1,n)}return this}crossFadeTo(e,n,i){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const s=this._mixer,o=s.time,a=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=s._lendControlInterpolant(),this._timeScaleInterpolant=l);const h=l.parameterPositions,u=l.sampleValues;return h[0]=o,h[1]=o+i,u[0]=e/a,u[1]=n/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,s){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const h=(e-o)*i;h<0||i===0?n=0:(this._startTime=null,n=i*h)}n*=this._updateTimeScale(e);const a=this._updateTime(n),l=this._updateWeight(e);if(l>0){const h=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case BI:for(let f=0,p=h.length;f!==p;++f)h[f].evaluate(a),u[f].accumulateAdditive(l);break;case YC:default:for(let f=0,p=h.length;f!==p;++f)h[f].evaluate(a),u[f].accumulate(s,l)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const s=i.evaluate(e)[0];n*=s,e>i.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const s=i.evaluate(e)[0];n*=s,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let s=this.time+e,o=this._loopCount;const a=i===aG;if(e===0)return o===-1?s:a&&(o&1)===1?n-s:s;if(i===sG){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=n)s=n;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),s>=n||s<0){const l=Math.floor(s/n);s-=n*l,o+=Math.abs(l);const h=this.repetitions-o;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?n:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(h===1){const u=e<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=o,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=s;if(a&&(o&1)===1)return n-s}return s}_setEndings(e,n,i){const s=this._interpolantSettings;i?(s.endingStart=Ef,s.endingEnd=Ef):(e?s.endingStart=this.zeroSlopeAtStart?Ef:Tf:s.endingStart=P1,n?s.endingEnd=this.zeroSlopeAtEnd?Ef:Tf:s.endingEnd=P1)}_scheduleFading(e,n,i){const s=this._mixer,o=s.time;let a=this._weightInterpolant;a===null&&(a=s._lendControlInterpolant(),this._weightInterpolant=a);const l=a.parameterPositions,h=a.sampleValues;return l[0]=o,h[0]=n,l[1]=o+e,h[1]=i,this}}const M_e=new Float32Array(1);class A_e extends bc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,s=e._clip.tracks,o=s.length,a=e._propertyBindings,l=e._interpolants,h=i.uuid,u=this._bindingsByRootAndName;let f=u[h];f===void 0&&(f={},u[h]=f);for(let p=0;p!==o;++p){const m=s[p],v=m.name;let y=f[v];if(y!==void 0)++y.referenceCount,a[p]=y;else{if(y=a[p],y!==void 0){y._cacheIndex===null&&(++y.referenceCount,this._addInactiveBinding(y,h,v));continue}const x=n&&n._propertyBindings[p].binding.parsedPath;y=new mH(Ai.create(i,v,x),m.ValueTypeName,m.getValueSize()),++y.referenceCount,this._addInactiveBinding(y,h,v),a[p]=y}l[p].resultBuffer=y.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,s=e._clip.uuid,o=this._actionsByClip[s];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,s,i)}const n=e._propertyBindings;for(let i=0,s=n.length;i!==s;++i){const o=n[i];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,s=n.length;i!==s;++i){const o=n[i];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const s=this._actions,o=this._actionsByClip;let a=o[n];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[n]=a;else{const l=a.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=s.length,s.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],s=e._cacheIndex;i._cacheIndex=s,n[s]=i,n.pop(),e._cacheIndex=null;const o=e._clip.uuid,a=this._actionsByClip,l=a[o],h=l.knownActions,u=h[h.length-1],f=e._byClipCacheIndex;u._byClipCacheIndex=f,h[f]=u,h.pop(),e._byClipCacheIndex=null;const p=l.actionByRoot,m=(e._localRoot||this._root).uuid;delete p[m],h.length===0&&delete a[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,s=n.length;i!==s;++i){const o=n[i];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,s=this._nActiveActions++,o=n[s];e._cacheIndex=s,n[s]=e,o._cacheIndex=i,n[i]=o}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,s=--this._nActiveActions,o=n[s];e._cacheIndex=s,n[s]=e,o._cacheIndex=i,n[i]=o}_addInactiveBinding(e,n,i){const s=this._bindingsByRootAndName,o=this._bindings;let a=s[n];a===void 0&&(a={},s[n]=a),a[i]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,s=i.rootNode.uuid,o=i.path,a=this._bindingsByRootAndName,l=a[s],h=n[n.length-1],u=e._cacheIndex;h._cacheIndex=u,n[u]=h,n.pop(),delete l[o],Object.keys(l).length===0&&delete a[s]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,s=this._nActiveBindings++,o=n[s];e._cacheIndex=s,n[s]=e,o._cacheIndex=i,n[i]=o}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,s=--this._nActiveBindings,o=n[s];e._cacheIndex=s,n[s]=e,o._cacheIndex=i,n[i]=o}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new r4(new Float32Array(2),new Float32Array(2),1,M_e),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,s=--this._nActiveControlInterpolants,o=n[s];e.__cacheIndex=s,n[s]=e,o.__cacheIndex=i,n[i]=o}clipAction(e,n,i){const s=n||this._root,o=s.uuid;let a=typeof e=="string"?op.findByName(s,e):e;const l=a!==null?a.uuid:e,h=this._actionsByClip[l];let u=null;if(i===void 0&&(a!==null?i=a.blendMode:i=YC),h!==void 0){const p=h.actionByRoot[o];if(p!==void 0&&p.blendMode===i)return p;u=h.knownActions[0],a===null&&(a=u._clip)}if(a===null)return null;const f=new gH(this,a,n,i);return this._bindAction(f,u),this._addInactiveAction(f,l,o),f}existingAction(e,n){const i=n||this._root,s=i.uuid,o=typeof e=="string"?op.findByName(i,e):e,a=o?o.uuid:e,l=this._actionsByClip[a];return l!==void 0&&l.actionByRoot[s]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,s=this.time+=e,o=Math.sign(e),a=this._accuIndex^=1;for(let u=0;u!==i;++u)n[u]._update(s,e,o,a);const l=this._bindings,h=this._nActiveBindings;for(let u=0;u!==h;++u)l[u].apply(a);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,s=this._actionsByClip,o=s[i];if(o!==void 0){const a=o.knownActions;for(let l=0,h=a.length;l!==h;++l){const u=a[l];this._deactivateAction(u);const f=u._cacheIndex,p=n[n.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,p._cacheIndex=f,n[f]=p,n.pop(),this._removeInactiveBindingsForAction(u)}delete s[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const a in i){const l=i[a].actionByRoot,h=l[n];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}const s=this._bindingsByRootAndName,o=s[n];if(o!==void 0)for(const a in o){const l=o[a];l.restoreOriginalState(),this._removeInactiveBinding(l)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class w2{constructor(e){this.value=e}clone(){return new w2(this.value.clone===void 0?this.value:this.value.clone())}}let k_e=0;class P_e extends bc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:k_e++}),this.name="",this.usage=D1,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,s=n.length;i<s;i++){const o=Array.isArray(n[i])?n[i]:[n[i]];for(let a=0;a<o.length;a++)this.uniforms.push(o[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class R_e extends c0{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class I_e{constructor(e,n,i,s,o){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=s,this.count=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const eU=new dt;class _2{constructor(e,n,i=0,s=1/0){this.ray=new Sp(e,n),this.near=i,this.far=s,this.camera=null,this.layers=new KC,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return eU.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(eU),this}intersectObject(e,n=!0,i=[]){return VP(e,this,i,n),i.sort(tU),i}intersectObjects(e,n=!0,i=[]){for(let s=0,o=e.length;s<o;s++)VP(e[s],this,i,n);return i.sort(tU),i}}function tU(r,e){return r.distance-e.distance}function VP(r,e,n,i){if(r.layers.test(e.layers)&&r.raycast(e,n),i===!0){const s=r.children;for(let o=0,a=s.length;o<a;o++)VP(s[o],e,n,!0)}}class FP{constructor(e=1,n=0,i=0){return this.radius=e,this.phi=n,this.theta=i,this}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(hr(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class N_e{constructor(e=1,n=0,i=0){return this.radius=e,this.theta=n,this.y=i,this}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}const iU=new Xe;class vH{constructor(e=new Xe(1/0,1/0),n=new Xe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=iU.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,iU).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const nU=new le,r_=new le;class yH{constructor(e=new le,n=new le){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){nU.subVectors(e,this.start),r_.subVectors(this.end,this.start);const i=r_.dot(r_);let o=r_.dot(nU)/i;return n&&(o=hr(o,0,1)),o}closestPointToPoint(e,n,i){const s=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const rU=new le;class D_e extends Li{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new vi,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,l=1,h=32;a<h;a++,l++){const u=a/h*Math.PI*2,f=l/h*Math.PI*2;s.push(Math.cos(u),Math.sin(u),1,Math.cos(f),Math.sin(f),1)}i.setAttribute("position",new Nt(s,3));const o=new bs({fog:!1,toneMapped:!1});this.cone=new _l(i,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),rU.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(rU),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const hu=new le,s_=new dt,wM=new dt;class L_e extends _l{constructor(e){const n=bH(e),i=new vi,s=[],o=[],a=new nt(0,0,1),l=new nt(0,1,0);for(let u=0;u<n.length;u++){const f=n[u];f.parent&&f.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),o.push(a.r,a.g,a.b),o.push(l.r,l.g,l.b))}i.setAttribute("position",new Nt(s,3)),i.setAttribute("color",new Nt(o,3));const h=new bs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,h),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,s=i.getAttribute("position");wM.copy(this.root.matrixWorld).invert();for(let o=0,a=0;o<n.length;o++){const l=n[o];l.parent&&l.parent.isBone&&(s_.multiplyMatrices(wM,l.matrixWorld),hu.setFromMatrixPosition(s_),s.setXYZ(a,hu.x,hu.y,hu.z),s_.multiplyMatrices(wM,l.parent.matrixWorld),hu.setFromMatrixPosition(s_),s.setXYZ(a+1,hu.x,hu.y,hu.z),a+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function bH(r){const e=[];r.isBone===!0&&e.push(r);for(let n=0;n<r.children.length;n++)e.push.apply(e,bH(r.children[n]));return e}class B_e extends ln{constructor(e,n,i){const s=new Lb(n,4,2),o=new vs({wireframe:!0,fog:!1,toneMapped:!1});super(s,o),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const $_e=new le,sU=new nt,oU=new nt;class U_e extends Li{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const s=new Db(n);s.rotateY(Math.PI*.5),this.material=new vs({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const o=s.getAttribute("position"),a=new Float32Array(o.count*3);s.setAttribute("color",new Di(a,3)),this.add(new ln(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");sU.copy(this.light.color),oU.copy(this.light.groundColor);for(let i=0,s=n.count;i<s;i++){const o=i<s/2?sU:oU;n.setXYZ(i,o.r,o.g,o.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt($_e.setFromMatrixPosition(this.light.matrixWorld).negate())}}class V_e extends _l{constructor(e=10,n=10,i=4473924,s=8947848){i=new nt(i),s=new nt(s);const o=n/2,a=e/n,l=e/2,h=[],u=[];for(let m=0,v=0,y=-l;m<=n;m++,y+=a){h.push(-l,0,y,l,0,y),h.push(y,0,-l,y,0,l);const x=m===o?i:s;x.toArray(u,v),v+=3,x.toArray(u,v),v+=3,x.toArray(u,v),v+=3,x.toArray(u,v),v+=3}const f=new vi;f.setAttribute("position",new Nt(h,3)),f.setAttribute("color",new Nt(u,3));const p=new bs({vertexColors:!0,toneMapped:!1});super(f,p),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class F_e extends _l{constructor(e=10,n=16,i=8,s=64,o=4473924,a=8947848){o=new nt(o),a=new nt(a);const l=[],h=[];if(n>1)for(let p=0;p<n;p++){const m=p/n*(Math.PI*2),v=Math.sin(m)*e,y=Math.cos(m)*e;l.push(0,0,0),l.push(v,0,y);const x=p&1?o:a;h.push(x.r,x.g,x.b),h.push(x.r,x.g,x.b)}for(let p=0;p<i;p++){const m=p&1?o:a,v=e-e/i*p;for(let y=0;y<s;y++){let x=y/s*(Math.PI*2),w=Math.sin(x)*v,S=Math.cos(x)*v;l.push(w,0,S),h.push(m.r,m.g,m.b),x=(y+1)/s*(Math.PI*2),w=Math.sin(x)*v,S=Math.cos(x)*v,l.push(w,0,S),h.push(m.r,m.g,m.b)}}const u=new vi;u.setAttribute("position",new Nt(l,3)),u.setAttribute("color",new Nt(h,3));const f=new bs({vertexColors:!0,toneMapped:!1});super(u,f),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const aU=new le,o_=new le,lU=new le;class z_e extends Li{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let s=new vi;s.setAttribute("position",new Nt([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const o=new bs({fog:!1,toneMapped:!1});this.lightPlane=new pc(s,o),this.add(this.lightPlane),s=new vi,s.setAttribute("position",new Nt([0,0,0,0,0,1],3)),this.targetLine=new pc(s,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),aU.setFromMatrixPosition(this.light.matrixWorld),o_.setFromMatrixPosition(this.light.target.matrixWorld),lU.subVectors(o_,aU),this.lightPlane.lookAt(o_),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(o_),this.targetLine.scale.z=lU.length()}}const a_=new le,ar=new kb;class X_e extends _l{constructor(e){const n=new vi,i=new bs({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],o=[],a={};l("n1","n2"),l("n2","n4"),l("n4","n3"),l("n3","n1"),l("f1","f2"),l("f2","f4"),l("f4","f3"),l("f3","f1"),l("n1","f1"),l("n2","f2"),l("n3","f3"),l("n4","f4"),l("p","n1"),l("p","n2"),l("p","n3"),l("p","n4"),l("u1","u2"),l("u2","u3"),l("u3","u1"),l("c","t"),l("p","c"),l("cn1","cn2"),l("cn3","cn4"),l("cf1","cf2"),l("cf3","cf4");function l(y,x){h(y),h(x)}function h(y){s.push(0,0,0),o.push(0,0,0),a[y]===void 0&&(a[y]=[]),a[y].push(s.length/3-1)}n.setAttribute("position",new Nt(s,3)),n.setAttribute("color",new Nt(o,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const u=new nt(16755200),f=new nt(16711680),p=new nt(43775),m=new nt(16777215),v=new nt(3355443);this.setColors(u,f,p,m,v)}setColors(e,n,i,s,o){const l=this.geometry.getAttribute("color");l.setXYZ(0,e.r,e.g,e.b),l.setXYZ(1,e.r,e.g,e.b),l.setXYZ(2,e.r,e.g,e.b),l.setXYZ(3,e.r,e.g,e.b),l.setXYZ(4,e.r,e.g,e.b),l.setXYZ(5,e.r,e.g,e.b),l.setXYZ(6,e.r,e.g,e.b),l.setXYZ(7,e.r,e.g,e.b),l.setXYZ(8,e.r,e.g,e.b),l.setXYZ(9,e.r,e.g,e.b),l.setXYZ(10,e.r,e.g,e.b),l.setXYZ(11,e.r,e.g,e.b),l.setXYZ(12,e.r,e.g,e.b),l.setXYZ(13,e.r,e.g,e.b),l.setXYZ(14,e.r,e.g,e.b),l.setXYZ(15,e.r,e.g,e.b),l.setXYZ(16,e.r,e.g,e.b),l.setXYZ(17,e.r,e.g,e.b),l.setXYZ(18,e.r,e.g,e.b),l.setXYZ(19,e.r,e.g,e.b),l.setXYZ(20,e.r,e.g,e.b),l.setXYZ(21,e.r,e.g,e.b),l.setXYZ(22,e.r,e.g,e.b),l.setXYZ(23,e.r,e.g,e.b),l.setXYZ(24,n.r,n.g,n.b),l.setXYZ(25,n.r,n.g,n.b),l.setXYZ(26,n.r,n.g,n.b),l.setXYZ(27,n.r,n.g,n.b),l.setXYZ(28,n.r,n.g,n.b),l.setXYZ(29,n.r,n.g,n.b),l.setXYZ(30,n.r,n.g,n.b),l.setXYZ(31,n.r,n.g,n.b),l.setXYZ(32,i.r,i.g,i.b),l.setXYZ(33,i.r,i.g,i.b),l.setXYZ(34,i.r,i.g,i.b),l.setXYZ(35,i.r,i.g,i.b),l.setXYZ(36,i.r,i.g,i.b),l.setXYZ(37,i.r,i.g,i.b),l.setXYZ(38,s.r,s.g,s.b),l.setXYZ(39,s.r,s.g,s.b),l.setXYZ(40,o.r,o.g,o.b),l.setXYZ(41,o.r,o.g,o.b),l.setXYZ(42,o.r,o.g,o.b),l.setXYZ(43,o.r,o.g,o.b),l.setXYZ(44,o.r,o.g,o.b),l.setXYZ(45,o.r,o.g,o.b),l.setXYZ(46,o.r,o.g,o.b),l.setXYZ(47,o.r,o.g,o.b),l.setXYZ(48,o.r,o.g,o.b),l.setXYZ(49,o.r,o.g,o.b),l.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,s=1;ar.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),fr("c",n,e,ar,0,0,-1),fr("t",n,e,ar,0,0,1),fr("n1",n,e,ar,-i,-s,-1),fr("n2",n,e,ar,i,-s,-1),fr("n3",n,e,ar,-i,s,-1),fr("n4",n,e,ar,i,s,-1),fr("f1",n,e,ar,-i,-s,1),fr("f2",n,e,ar,i,-s,1),fr("f3",n,e,ar,-i,s,1),fr("f4",n,e,ar,i,s,1),fr("u1",n,e,ar,i*.7,s*1.1,-1),fr("u2",n,e,ar,-i*.7,s*1.1,-1),fr("u3",n,e,ar,0,s*2,-1),fr("cf1",n,e,ar,-i,0,1),fr("cf2",n,e,ar,i,0,1),fr("cf3",n,e,ar,0,-s,1),fr("cf4",n,e,ar,0,s,1),fr("cn1",n,e,ar,-i,0,-1),fr("cn2",n,e,ar,i,0,-1),fr("cn3",n,e,ar,0,-s,-1),fr("cn4",n,e,ar,0,s,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function fr(r,e,n,i,s,o,a){a_.set(s,o,a).unproject(i);const l=e[r];if(l!==void 0){const h=n.getAttribute("position");for(let u=0,f=l.length;u<f;u++)h.setXYZ(l[u],a_.x,a_.y,a_.z)}}const l_=new vr;class W_e extends _l{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),o=new vi;o.setIndex(new Di(i,1)),o.setAttribute("position",new Di(s,3)),super(o,new bs({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&l_.setFromObject(this.object),l_.isEmpty())return;const n=l_.min,i=l_.max,s=this.geometry.attributes.position,o=s.array;o[0]=i.x,o[1]=i.y,o[2]=i.z,o[3]=n.x,o[4]=i.y,o[5]=i.z,o[6]=n.x,o[7]=n.y,o[8]=i.z,o[9]=i.x,o[10]=n.y,o[11]=i.z,o[12]=i.x,o[13]=i.y,o[14]=n.z,o[15]=n.x,o[16]=i.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=i.x,o[22]=n.y,o[23]=n.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class G_e extends _l{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new vi;o.setIndex(new Di(i,1)),o.setAttribute("position",new Nt(s,3)),super(o,new bs({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class H_e extends pc{constructor(e,n=1,i=16776960){const s=i,o=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new vi;a.setAttribute("position",new Nt(o,3)),a.computeBoundingSphere(),super(a,new bs({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const l=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],h=new vi;h.setAttribute("position",new Nt(l,3)),h.computeBoundingSphere(),this.add(new ln(h,new vs({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const cU=new le;let c_,_M;class Q_e extends Li{constructor(e=new le(0,0,1),n=new le(0,0,0),i=1,s=16776960,o=i*.2,a=o*.2){super(),this.type="ArrowHelper",c_===void 0&&(c_=new vi,c_.setAttribute("position",new Nt([0,0,0,0,1,0],3)),_M=new u0(0,.5,1,5,1),_M.translate(0,-.5,0)),this.position.copy(n),this.line=new pc(c_,new bs({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ln(_M,new vs({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,o,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{cU.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(cU,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class j_e extends _l{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new vi;s.setAttribute("position",new Nt(n,3)),s.setAttribute("color",new Nt(i,3));const o=new bs({vertexColors:!0,toneMapped:!1});super(s,o),this.type="AxesHelper"}setColors(e,n,i){const s=new nt,o=this.geometry.attributes.color.array;return s.set(e),s.toArray(o,0),s.toArray(o,3),s.set(n),s.toArray(o,6),s.toArray(o,9),s.set(i),s.toArray(o,12),s.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class d4{constructor(){this.type="ShapePath",this.color=new nt,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new $1,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,s){return this.currentPath.quadraticCurveTo(e,n,i,s),this}bezierCurveTo(e,n,i,s,o,a){return this.currentPath.bezierCurveTo(e,n,i,s,o,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(S){const O=[];for(let _=0,T=S.length;_<T;_++){const A=S[_],P=new Ff;P.curves=A.curves,O.push(P)}return O}function i(S,O){const _=O.length;let T=!1;for(let A=_-1,P=0;P<_;A=P++){let N=O[A],k=O[P],R=k.x-N.x,E=k.y-N.y;if(Math.abs(E)>Number.EPSILON){if(E<0&&(N=O[P],R=-R,k=O[A],E=-E),S.y<N.y||S.y>k.y)continue;if(S.y===N.y){if(S.x===N.x)return!0}else{const D=E*(S.x-N.x)-R*(S.y-N.y);if(D===0)return!0;if(D<0)continue;T=!T}}else{if(S.y!==N.y)continue;if(k.x<=S.x&&S.x<=N.x||N.x<=S.x&&S.x<=k.x)return!0}}return T}const s=ac.isClockWise,o=this.subPaths;if(o.length===0)return[];let a,l,h;const u=[];if(o.length===1)return l=o[0],h=new Ff,h.curves=l.curves,u.push(h),u;let f=!s(o[0].getPoints());f=e?!f:f;const p=[],m=[];let v=[],y=0,x;m[y]=void 0,v[y]=[];for(let S=0,O=o.length;S<O;S++)l=o[S],x=l.getPoints(),a=s(x),a=e?!a:a,a?(!f&&m[y]&&y++,m[y]={s:new Ff,p:x},m[y].s.curves=l.curves,f&&y++,v[y]=[]):v[y].push({h:l,p:x[0]});if(!m[0])return n(o);if(m.length>1){let S=!1,O=0;for(let _=0,T=m.length;_<T;_++)p[_]=[];for(let _=0,T=m.length;_<T;_++){const A=v[_];for(let P=0;P<A.length;P++){const N=A[P];let k=!0;for(let R=0;R<m.length;R++)i(N.p,m[R].p)&&(_!==R&&O++,k?(k=!1,p[R].push(N)):S=!0);k&&p[_].push(N)}}O>0&&S===!1&&(v=p)}let w;for(let S=0,O=m.length;S<O;S++){h=m[S].s,u.push(h),w=v[S];for(let _=0,T=w.length;_<T;_++)h.holes.push(w[_].h)}return u}}class Y_e extends La{constructor(e=1,n=1,i=1,s={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,n,{...s,count:i}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r0}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=r0);const q_e=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:MI,AddEquation:Ru,AddOperation:zW,AdditiveAnimationBlendMode:BI,AdditiveBlending:wS,AgXToneMapping:QW,AlphaFormat:JW,AlwaysCompare:yG,AlwaysDepth:DW,AlwaysStencilFunc:PP,AmbientLight:b2,AnimationAction:gH,AnimationClip:op,AnimationLoader:i_e,AnimationMixer:A_e,AnimationObjectGroup:E_e,AnimationUtils:Kwe,ArcCurve:VG,ArrayCamera:DG,ArrowHelper:Q_e,AttachedBindMode:rP,Audio:pH,AudioAnalyser:v_e,AudioContext:l4,AudioListener:p_e,AudioLoader:u_e,AxesHelper:j_e,BackSide:Rs,BasicDepthPacking:cG,BasicShadowMap:p0e,BatchedMesh:UG,Bone:Fg,BooleanKeyframeTrack:Cp,Box2:vH,Box3:vr,Box3Helper:G_e,BoxGeometry:Rh,BoxHelper:W_e,BufferAttribute:Di,BufferGeometry:vi,BufferGeometryLoader:dH,ByteType:qW,Cache:rh,Camera:kb,CameraHelper:X_e,CanvasTexture:_we,CapsuleGeometry:a2,CatmullRomCurve3:FG,CineonToneMapping:GW,CircleGeometry:l2,ClampToEdgeWrapping:Ps,Clock:c4,Color:nt,ColorKeyframeTrack:s4,ColorManagement:dn,CompressedArrayTexture:xwe,CompressedCubeTexture:wwe,CompressedTexture:Vf,CompressedTextureLoader:n_e,ConeGeometry:c2,ConstantAlphaFactor:RW,ConstantColorFactor:kW,CubeCamera:TG,CubeReflectionMapping:wh,CubeRefractionMapping:td,CubeTexture:Pb,CubeTextureLoader:r_e,CubeUVReflectionMapping:s0,CubicBezierCurve:KI,CubicBezierCurve3:zG,CubicInterpolant:nH,CullFaceBack:tP,CullFaceFront:mW,CullFaceFrontBack:f0e,CullFaceNone:pW,Curve:$a,CurvePath:WG,CustomBlending:gW,CustomToneMapping:HW,CylinderGeometry:u0,Cylindrical:N_e,Data3DTexture:FI,DataArrayTexture:ZC,DataTexture:Qu,DataTextureLoader:s_e,DataUtils:bve,DecrementStencilOp:_0e,DecrementWrapStencilOp:S0e,DefaultLoadingManager:oH,DepthFormat:$f,DepthStencilFormat:$g,DepthTexture:WI,DetachedBindMode:YW,DirectionalLight:Ub,DirectionalLightHelper:z_e,DiscreteInterpolant:rH,DisplayP3ColorSpace:qC,DodecahedronGeometry:h2,DoubleSide:Qs,DstAlphaFactor:CW,DstColorFactor:EW,DynamicCopyUsage:U0e,DynamicDrawUsage:I0e,DynamicReadUsage:L0e,EdgesGeometry:GG,EllipseCurve:s2,EqualCompare:pG,EqualDepth:BW,EqualStencilFunc:M0e,EquirectangularReflectionMapping:Bg,EquirectangularRefractionMapping:k1,Euler:Vr,EventDispatcher:bc,ExtrudeGeometry:Nb,FileLoader:aa,Float16BufferAttribute:Cve,Float32BufferAttribute:Nt,FloatType:Ea,Fog:i2,FogExp2:t2,FramebufferTexture:LP,FrontSide:dc,Frustum:Rb,GLBufferAttribute:I_e,GLSL1:F0e,GLSL3:RP,GreaterCompare:mG,GreaterDepth:UW,GreaterEqualCompare:vG,GreaterEqualDepth:$W,GreaterEqualStencilFunc:R0e,GreaterStencilFunc:k0e,GridHelper:V_e,Group:qs,HalfFloatType:o0,HemisphereLight:aH,HemisphereLightHelper:U_e,IcosahedronGeometry:d2,ImageBitmapLoader:fH,ImageLoader:z1,ImageUtils:_G,IncrementStencilOp:w0e,IncrementWrapStencilOp:O0e,InstancedBufferAttribute:rp,InstancedBufferGeometry:uH,InstancedInterleavedBuffer:R_e,InstancedMesh:jI,Int16BufferAttribute:Ove,Int32BufferAttribute:Sve,Int8BufferAttribute:xve,IntType:kI,InterleavedBuffer:c0,InterleavedBufferAttribute:fc,Interpolant:f0,InterpolateDiscrete:ip,InterpolateLinear:id,InterpolateSmooth:kO,InvertStencilOp:C0e,KeepStencilOp:hf,KeyframeTrack:Ol,LOD:$G,LatheGeometry:Ib,Layers:KC,LessCompare:fG,LessDepth:LW,LessEqualCompare:UI,LessEqualDepth:A1,LessEqualStencilFunc:A0e,LessStencilFunc:E0e,Light:xd,LightProbe:hH,Line:pc,Line3:yH,LineBasicMaterial:bs,LineCurve:JI,LineCurve3:XG,LineDashedMaterial:eH,LineLoop:YI,LineSegments:_l,LinearDisplayP3ColorSpace:Mb,LinearFilter:ir,LinearInterpolant:r4,LinearMipMapLinearFilter:y0e,LinearMipMapNearestFilter:v0e,LinearMipmapLinearFilter:Ko,LinearMipmapNearestFilter:Bf,LinearSRGBColorSpace:ns,LinearToneMapping:XW,LinearTransfer:R1,Loader:xs,LoaderUtils:fl,LoadingManager:o4,LoopOnce:sG,LoopPingPong:aG,LoopRepeat:oG,LuminanceAlphaFormat:iG,LuminanceFormat:tG,MOUSE:cf,Material:Xr,MaterialLoader:x2,MathUtils:fs,Matrix3:Ci,Matrix4:dt,MaxEquation:xW,Mesh:ln,MeshBasicMaterial:vs,MeshDepthMaterial:GI,MeshDistanceMaterial:HI,MeshLambertMaterial:i4,MeshMatcapMaterial:JG,MeshNormalMaterial:KG,MeshPhongMaterial:fg,MeshPhysicalMaterial:Ua,MeshStandardMaterial:d0,MeshToonMaterial:ZG,MinEquation:bW,MirroredRepeatWrapping:ep,MixOperation:FW,MultiplyBlending:nP,MultiplyOperation:Tb,NearestFilter:Er,NearestMipMapLinearFilter:g0e,NearestMipMapNearestFilter:m0e,NearestMipmapLinearFilter:Bu,NearestMipmapNearestFilter:Eb,NeutralToneMapping:jW,NeverCompare:dG,NeverDepth:NW,NeverStencilFunc:T0e,NoBlending:fh,NoColorSpace:ih,NoToneMapping:ph,NormalAnimationBlendMode:YC,NormalBlending:Lf,NotEqualCompare:gG,NotEqualDepth:VW,NotEqualStencilFunc:P0e,NumberKeyframeTrack:nd,Object3D:Li,ObjectLoader:c_e,ObjectSpaceNormalMap:uG,OctahedronGeometry:Db,OneFactor:_W,OneMinusConstantAlphaFactor:IW,OneMinusConstantColorFactor:PW,OneMinusDstAlphaFactor:TW,OneMinusDstColorFactor:MW,OneMinusSrcAlphaFactor:OS,OneMinusSrcColorFactor:SW,OrthographicCamera:Jo,P3Primaries:N1,PCFShadowMap:EI,PCFSoftShadowMap:QC,PMREMGenerator:IP,Path:$1,PerspectiveCamera:fn,Plane:wa,PlaneGeometry:yd,PlaneHelper:H_e,PointLight:X1,PointLightHelper:B_e,Points:qI,PointsMaterial:r2,PolarGridHelper:F_e,PolyhedronGeometry:bd,PositionalAudio:g_e,PropertyBinding:Ai,PropertyMixer:mH,QuadraticBezierCurve:o2,QuadraticBezierCurve3:e4,Quaternion:ur,QuaternionKeyframeTrack:_h,QuaternionLinearInterpolant:sH,RED_GREEN_RGTC2_Format:AP,RED_RGTC1_Format:rG,REVISION:r0,RGBADepthPacking:hG,RGBAFormat:_o,RGBAIntegerFormat:LI,RGBA_ASTC_10x10_Format:OP,RGBA_ASTC_10x5_Format:xP,RGBA_ASTC_10x6_Format:wP,RGBA_ASTC_10x8_Format:_P,RGBA_ASTC_12x10_Format:SP,RGBA_ASTC_12x12_Format:CP,RGBA_ASTC_4x4_Format:dP,RGBA_ASTC_5x4_Format:fP,RGBA_ASTC_5x5_Format:pP,RGBA_ASTC_6x5_Format:mP,RGBA_ASTC_6x6_Format:gP,RGBA_ASTC_8x5_Format:vP,RGBA_ASTC_8x6_Format:yP,RGBA_ASTC_8x8_Format:bP,RGBA_BPTC_Format:AO,RGBA_ETC2_EAC_Format:uP,RGBA_PVRTC_2BPPV1_Format:lP,RGBA_PVRTC_4BPPV1_Format:aP,RGBA_S3TC_DXT1_Format:TO,RGBA_S3TC_DXT3_Format:EO,RGBA_S3TC_DXT5_Format:MO,RGBFormat:eG,RGB_BPTC_SIGNED_Format:TP,RGB_BPTC_UNSIGNED_Format:EP,RGB_ETC1_Format:cP,RGB_ETC2_Format:hP,RGB_PVRTC_2BPPV1_Format:oP,RGB_PVRTC_4BPPV1_Format:sP,RGB_S3TC_DXT1_Format:CO,RGFormat:nG,RGIntegerFormat:DI,RawShaderMaterial:a1,Ray:Sp,Raycaster:_2,Rec709Primaries:I1,RectAreaLight:lH,RedFormat:II,RedIntegerFormat:NI,ReinhardToneMapping:WW,RenderTarget:OG,RepeatWrapping:yl,ReplaceStencilOp:x0e,ReverseSubtractEquation:yW,RingGeometry:f2,SIGNED_RED_GREEN_RGTC2_Format:kP,SIGNED_RED_RGTC1_Format:MP,SRGBColorSpace:Jr,SRGBTransfer:kn,Scene:np,ShaderChunk:Pi,ShaderLib:_a,ShaderMaterial:io,ShadowMaterial:qG,Shape:Ff,ShapeGeometry:p2,ShapePath:d4,ShapeUtils:ac,ShortType:ZW,Skeleton:h0,SkeletonHelper:L_e,SkinnedMesh:n2,Source:Mf,Sphere:ts,SphereGeometry:Lb,Spherical:FP,SphericalHarmonics3:cH,SplineCurve:t4,SpotLight:$b,SpotLightHelper:D_e,Sprite:BG,SpriteMaterial:QI,SrcAlphaFactor:_S,SrcAlphaSaturateFactor:AW,SrcColorFactor:OW,StaticCopyUsage:$0e,StaticDrawUsage:D1,StaticReadUsage:D0e,StereoCamera:d_e,StreamCopyUsage:V0e,StreamDrawUsage:N0e,StreamReadUsage:B0e,StringKeyframeTrack:Tp,SubtractEquation:vW,SubtractiveBlending:iP,TOUCH:Jc,TangentSpaceNormalMap:vd,TetrahedronGeometry:m2,Texture:qn,TextureLoader:Bb,TorusGeometry:g2,TorusKnotGeometry:v2,Triangle:bo,TriangleFanDrawMode:SS,TriangleStripDrawMode:$I,TrianglesDrawMode:lG,TubeGeometry:y2,UVMapping:jC,Uint16BufferAttribute:JC,Uint32BufferAttribute:zI,Uint8BufferAttribute:wve,Uint8ClampedBufferAttribute:_ve,Uniform:w2,UniformsGroup:P_e,UniformsLib:ut,UniformsUtils:Ab,UnsignedByteType:bl,UnsignedInt248Type:a0,UnsignedInt5999Type:KW,UnsignedIntType:tp,UnsignedShort4444Type:PI,UnsignedShort5551Type:RI,UnsignedShortType:AI,VSMShadowMap:Ql,Vector2:Xe,Vector3:le,Vector4:Ni,VectorKeyframeTrack:rd,VideoTexture:bwe,WebGL3DRenderTarget:cve,WebGLArrayRenderTarget:lve,WebGLCoordinateSystem:tc,WebGLCubeRenderTarget:EG,WebGLMultipleRenderTargets:Y_e,WebGLRenderTarget:La,WebGLRenderer:dg,WebGLUtils:NG,WebGPUCoordinateSystem:L1,WireframeGeometry:YG,WrapAroundEnding:P1,ZeroCurvatureEnding:Tf,ZeroFactor:wW,ZeroSlopeEnding:Ef,ZeroStencilOp:b0e,createCanvasElement:xG},Symbol.toStringTag,{value:"Module"}));function Oh(r){return NC()?(iI(r),!0):!1}function W1(){const r=new Set,e=s=>{r.delete(s)};return{on:s=>{r.add(s);const o=()=>e(s);return Oh(o),{off:o}},off:e,trigger:(...s)=>Promise.all(Array.from(r).map(o=>o(...s)))}}function Ln(r){return typeof r=="function"?r():oi(r)}const zP=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Z_e=r=>r!=null,K_e=Object.prototype.toString,J_e=r=>K_e.call(r)==="[object Object]",XP=()=>{};function eOe(r,e){function n(...i){return new Promise((s,o)=>{Promise.resolve(r(()=>e.apply(this,i),{fn:e,thisArg:this,args:i})).then(s).catch(o)})}return n}function tOe(r,e={}){let n,i,s=XP;const o=l=>{clearTimeout(l),s(),s=XP};return l=>{const h=Ln(r),u=Ln(e.maxWait);return n&&o(n),h<=0||u!==void 0&&u<=0?(i&&(o(i),i=null),Promise.resolve(l())):new Promise((f,p)=>{s=e.rejectOnCancel?p:f,u&&!i&&(i=setTimeout(()=>{n&&o(n),i=null,f(l())},u)),n=setTimeout(()=>{i&&o(i),i=null,f(l())},h)})}}function iOe(r,e,n=!1){return e.reduce((i,s)=>(s in r&&(!n||r[s]!==void 0)&&(i[s]=r[s]),i),{})}function nOe(r){return oa()}function rOe(r,e=200,n={}){return eOe(tOe(e,n),r)}function hU(r,e=200,n={}){const i=ot(r.value),s=rOe(()=>{i.value=r.value},e,n);return Gi(r,()=>s()),i}function sOe(r,e={}){if(!kr(r))return wb(r);const n=Array.isArray(r.value)?Array.from({length:r.value.length}):{};for(const i in r.value)n[i]=hI(()=>({get(){return r.value[i]},set(s){var o;if((o=Ln(e.replaceRef))!=null?o:!0)if(Array.isArray(r.value)){const l=[...r.value];l[i]=s,r.value=l}else{const l={...r.value,[i]:s};Object.setPrototypeOf(l,Object.getPrototypeOf(r.value)),r.value=l}else r.value[i]=s}}));return n}function f4(r,e=!0,n){nOe()?Xn(r,n):e?r():n0(r)}function oOe(r,e=1e3,n={}){const{immediate:i=!0,immediateCallback:s=!1}=n;let o=null;const a=ot(!1);function l(){o&&(clearInterval(o),o=null)}function h(){a.value=!1,l()}function u(){const f=Ln(e);f<=0||(a.value=!0,s&&r(),l(),o=setInterval(r,f))}if(i&&zP&&u(),kr(e)||typeof e=="function"){const f=Gi(e,()=>{a.value&&zP&&u()});Oh(f)}return Oh(h),{isActive:a,pause:h,resume:u}}function hl(r){var e;const n=Ln(r);return(e=n==null?void 0:n.$el)!=null?e:n}const Ih=zP?window:void 0;function G1(...r){let e,n,i,s;if(typeof r[0]=="string"||Array.isArray(r[0])?([n,i,s]=r,e=Ih):[e,n,i,s]=r,!e)return XP;Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]);const o=[],a=()=>{o.forEach(f=>f()),o.length=0},l=(f,p,m,v)=>(f.addEventListener(p,m,v),()=>f.removeEventListener(p,m,v)),h=Gi(()=>[hl(e),Ln(s)],([f,p])=>{if(a(),!f)return;const m=J_e(p)?{...p}:p;o.push(...n.flatMap(v=>i.map(y=>l(f,v,y,m))))},{immediate:!0,flush:"post"}),u=()=>{h(),a()};return Oh(u),u}function aOe(){const r=ot(!1),e=oa();return e&&Xn(()=>{r.value=!0},e),r}function O2(r){const e=aOe();return Rn(()=>(e.value,!!r()))}function lOe(r,e,n={}){const{window:i=Ih,...s}=n;let o;const a=O2(()=>i&&"MutationObserver"in i),l=()=>{o&&(o.disconnect(),o=void 0)},h=Rn(()=>{const m=Ln(r),v=(Array.isArray(m)?m:[m]).map(hl).filter(Z_e);return new Set(v)}),u=Gi(()=>h.value,m=>{l(),a.value&&m.size&&(o=new MutationObserver(e),m.forEach(v=>o.observe(v,s)))},{immediate:!0,flush:"post"}),f=()=>o==null?void 0:o.takeRecords(),p=()=>{l(),u()};return Oh(p),{isSupported:a,stop:p,takeRecords:f}}function p4(r,e={}){const{immediate:n=!0,fpsLimit:i=void 0,window:s=Ih}=e,o=ot(!1),a=i?1e3/i:null;let l=0,h=null;function u(m){if(!o.value||!s)return;l||(l=m);const v=m-l;if(a&&v<a){h=s.requestAnimationFrame(u);return}l=m,r({delta:v,timestamp:m}),h=s.requestAnimationFrame(u)}function f(){!o.value&&s&&(o.value=!0,l=0,h=s.requestAnimationFrame(u))}function p(){o.value=!1,h!=null&&s&&(s.cancelAnimationFrame(h),h=null)}return n&&f(),Oh(p),{isActive:Yf(o),pause:p,resume:f}}function cOe(r,e={}){const{window:n=Ih}=e,i=O2(()=>n&&"matchMedia"in n&&typeof n.matchMedia=="function");let s;const o=ot(!1),a=u=>{o.value=u.matches},l=()=>{s&&("removeEventListener"in s?s.removeEventListener("change",a):s.removeListener(a))},h=dh(()=>{i.value&&(l(),s=n.matchMedia(Ln(r)),"addEventListener"in s?s.addEventListener("change",a):s.addListener(a),o.value=s.matches)});return Oh(()=>{h(),l(),s=void 0}),o}function hOe(r={}){const{window:e=Ih}=r,n=ot(1);if(e){let i=function(){n.value=e.devicePixelRatio,s(),o=e.matchMedia(`(resolution: ${n.value}dppx)`),o.addEventListener("change",i,{once:!0})},s=function(){o==null||o.removeEventListener("change",i)},o;i(),Oh(s)}return{pixelRatio:n}}function xH(r,e,n={}){const{window:i=Ih,...s}=n;let o;const a=O2(()=>i&&"ResizeObserver"in i),l=()=>{o&&(o.disconnect(),o=void 0)},h=Rn(()=>Array.isArray(r)?r.map(p=>hl(p)):[hl(r)]),u=Gi(h,p=>{if(l(),a.value&&i){o=new ResizeObserver(e);for(const m of p)m&&o.observe(m,s)}},{immediate:!0,flush:"post"}),f=()=>{l(),u()};return Oh(f),{isSupported:a,stop:f}}function uOe(r,e={}){const{reset:n=!0,windowResize:i=!0,windowScroll:s=!0,immediate:o=!0}=e,a=ot(0),l=ot(0),h=ot(0),u=ot(0),f=ot(0),p=ot(0),m=ot(0),v=ot(0);function y(){const x=hl(r);if(!x){n&&(a.value=0,l.value=0,h.value=0,u.value=0,f.value=0,p.value=0,m.value=0,v.value=0);return}const w=x.getBoundingClientRect();a.value=w.height,l.value=w.bottom,h.value=w.left,u.value=w.right,f.value=w.top,p.value=w.width,m.value=w.x,v.value=w.y}return xH(r,y),Gi(()=>hl(r),x=>!x&&y()),lOe(r,y,{attributeFilter:["style","class"]}),s&&G1("scroll",y,{capture:!0,passive:!0}),i&&G1("resize",y,{passive:!0}),f4(()=>{o&&y()}),{height:a,bottom:l,left:h,right:u,top:f,width:p,x:m,y:v,update:y}}function dOe(r,e={width:0,height:0},n={}){const{window:i=Ih,box:s="content-box"}=n,o=Rn(()=>{var p,m;return(m=(p=hl(r))==null?void 0:p.namespaceURI)==null?void 0:m.includes("svg")}),a=ot(e.width),l=ot(e.height),{stop:h}=xH(r,([p])=>{const m=s==="border-box"?p.borderBoxSize:s==="content-box"?p.contentBoxSize:p.devicePixelContentBoxSize;if(i&&o.value){const v=hl(r);if(v){const y=v.getBoundingClientRect();a.value=y.width,l.value=y.height}}else if(m){const v=Array.isArray(m)?m:[m];a.value=v.reduce((y,{inlineSize:x})=>y+x,0),l.value=v.reduce((y,{blockSize:x})=>y+x,0)}else a.value=p.contentRect.width,l.value=p.contentRect.height},n);f4(()=>{const p=hl(r);p&&(a.value="offsetWidth"in p?p.offsetWidth:e.width,l.value="offsetHeight"in p?p.offsetHeight:e.height)});const u=Gi(()=>hl(r),p=>{a.value=p?e.width:0,l.value=p?e.height:0});function f(){h(),u()}return{width:a,height:l,stop:f}}function fOe(r){var e;const n=ot(0);if(typeof performance>"u")return n;const i=(e=r==null?void 0:r.every)!=null?e:10;let s=performance.now(),o=0;return p4(()=>{if(o+=1,o>=i){const a=performance.now(),l=a-s;n.value=Math.round(1e3/(l/o)),s=a,o=0}}),n}function pOe(r={}){const e=ot(),n=O2(()=>typeof performance<"u"&&"memory"in performance);if(n.value){const{interval:i=1e3}=r;oOe(()=>{e.value=performance.memory},i,{immediate:r.immediate,immediateCallback:r.immediateCallback})}return{isSupported:n,memory:e}}const wH={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},mOe=Object.keys(wH);function gOe(r={}){const{target:e=Ih}=r,n=ot(!1),i=ot(r.initialValue||{});Object.assign(i.value,wH,i.value);const s=o=>{n.value=!0,!(r.pointerTypes&&!r.pointerTypes.includes(o.pointerType))&&(i.value=iOe(o,mOe,!1))};if(e){const o={passive:!0};G1(e,["pointerdown","pointermove","pointerup"],s,o),G1(e,"pointerleave",()=>n.value=!1,o)}return{...sOe(i),isInside:n}}function vOe(r={}){const{window:e=Ih,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:i=Number.POSITIVE_INFINITY,listenOrientation:s=!0,includeScrollbar:o=!0}=r,a=ot(n),l=ot(i),h=()=>{e&&(o?(a.value=e.innerWidth,l.value=e.innerHeight):(a.value=e.document.documentElement.clientWidth,l.value=e.document.documentElement.clientHeight))};if(h(),f4(h),G1("resize",h,{passive:!0}),s){const u=cOe("(orientation: portrait)");Gi(u,()=>h())}return{width:a,height:l}}var yOe=Object.defineProperty,bOe=(r,e,n)=>e in r?yOe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,uU=(r,e,n)=>(bOe(r,typeof e!="symbol"?e+"":e,n),n);const xOe="@tresjs/core",wOe="module",_Oe="3.9.0",OOe="pnpm@8.15.6",SOe="Declarative ThreeJS using Vue Components",COe="Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",TOe="MIT",EOe=["vue","3d","threejs","three","threejs-vue"],MOe=!1,AOe={".":{types:"./dist/index.d.ts",import:"./dist/tres.js",require:"./dist/tres.umd.cjs"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},kOe="./dist/tres.js",POe="./dist/tres.js",ROe="./dist/index.d.ts",IOe=["*.d.ts","dist"],NOe={access:"public"},DOe={dev:"cd playground && npm run dev",build:"vite build",playground:"cd playground && npm run dev",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui",release:"release-it",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts",prepare:"node .husky/install.mjs"},LOe={three:">=0.133",vue:">=3.3"},BOe={"@alvarosabu/utils":"^3.1.1","@vue/devtools-api":"^6.6.1","@vueuse/core":"^10.7.0"},$Oe={"@release-it/conventional-changelog":"^8.0.1","@stackblitz/sdk":"^1.9.0","@tresjs/cientos":"3.8.0","@tresjs/eslint-config":"^1.0.0","@tresjs/eslint-config-vue":"^0.2.1","@types/three":"^0.163.0","@typescript-eslint/eslint-plugin":"^7.7.1","@typescript-eslint/parser":"^7.7.1","@vitejs/plugin-vue":"^5.0.4","@vitest/coverage-c8":"^0.33.0","@vitest/ui":"^1.5.0","@vue/test-utils":"^2.4.3",eslint:"^9.1.1","eslint-plugin-vue":"^9.25.0",esno:"^4.0.0",gsap:"^3.12.3",husky:"^9.0.11",jsdom:"^24.0.0",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^1.1.1","release-it":"^17.2.0","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.11.0",three:"^0.163.0",unocss:"^0.59.4",unplugin:"^1.10.1","unplugin-vue-components":"^0.26.0",vite:"^5.2.10","vite-plugin-banner":"^0.7.1","vite-plugin-dts":"3.9.0","vite-plugin-inspect":"^0.8.4","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.1.3",vitest:"^1.5.0",vue:"^3.4.24","vue-demi":"^0.14.6"},UOe={name:xOe,type:wOe,version:_Oe,packageManager:OOe,description:SOe,author:COe,license:TOe,keywords:EOe,sideEffects:MOe,exports:AOe,main:kOe,module:POe,types:ROe,files:IOe,publishConfig:NOe,scripts:DOe,peerDependencies:LOe,dependencies:BOe,devDependencies:$Oe},VOe=({sizes:r,scene:e})=>{const n=ot([]),i=Rn(()=>n.value[0]),s=l=>{const h=l instanceof kb?l:n.value.find(f=>f.uuid===l);if(!h)return;const u=n.value.filter(({uuid:f})=>f!==h.uuid);n.value=[h,...u]},o=(l,h=!1)=>{n.value.some(({uuid:u})=>u===l.uuid)||(h?s(l):n.value.push(l))},a=l=>{n.value=n.value.filter(({uuid:h})=>h!==l.uuid)};return dh(()=>{r.aspectRatio.value&&n.value.forEach(l=>{l instanceof fn&&(l.aspect=r.aspectRatio.value),(l instanceof fn||l instanceof Jo)&&l.updateProjectionMatrix()})}),e.userData.tres__registerCamera=o,e.userData.tres__deregisterCamera=a,Po(()=>{n.value=[]}),{camera:i,cameras:n,registerCamera:o,deregisterCamera:a,setCameraActive:s}},_H=W1(),OH=W1(),m4=W1(),l1=new c4;let IO=0,NO=0;const{pause:FOe,resume:zOe,isActive:XOe}=p4(()=>{_H.trigger({delta:IO,elapsed:NO,clock:l1}),OH.trigger({delta:IO,elapsed:NO,clock:l1}),m4.trigger({delta:IO,elapsed:NO,clock:l1})},{immediate:!1});m4.on(()=>{IO=l1.getDelta(),NO=l1.getElapsedTime()});const Ep=()=>({onBeforeLoop:_H.on,onLoop:OH.on,onAfterLoop:m4.on,pause:FOe,resume:zOe,isActive:XOe}),h_="[TresJS ▲ ■ ●] ";function S2(){function r(...i){typeof i[0]=="string"?i[0]=h_+i[0]:i.unshift(h_),console.error(...i)}function e(...i){typeof i[0]=="string"?i[0]=h_+i[0]:i.unshift(h_),console.warn(...i)}function n(i,s){}return{logError:r,logWarning:e,logMessage:n}}function WOe(r){return r instanceof nt?r:Array.isArray(r)?new nt(...r):new nt(r)}class GOe extends ln{constructor(...e){super(...e),uU(this,"type","HightlightMesh"),uU(this,"createTime"),this.createTime=Date.now()}onBeforeRender(){const e=(Date.now()-this.createTime)/1e3,n=1+.07*Math.sin(2.5*e);this.scale.set(n,n,n)}}const SH=(r,e)=>{for(const n of Object.keys(e))e[n]instanceof Object&&Object.assign(e[n],SH(r[n],e[n]));return Object.assign(r||{},e),r},HOe="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",QOe=jOe(HOe);function dU(r){return r&&r.nodeType===1}function u_(r){return r.replace(/-([a-z])/g,(e,n)=>n.toUpperCase())}function jOe(r,e){const n=Object.create(null),i=r.split(",");for(let s=0;s<i.length;s++)n[i[s]]=!0;return s=>!!n[s]}const YOe=(r,e)=>{const n=new Set,i=[];for(const s of r){const o=e(s);n.has(o)||(n.add(o),i.push(s))}return i},fU=(r,e)=>{if(!e)return;const n=Array.isArray(e)?e:e.match(/([^[.\]])+/g);return n==null?void 0:n.reduce((i,s)=>i&&i[s],r)},qOe=(r,e,n)=>{const i=Array.isArray(e)?e:e.match(/([^[.\]])+/g);i&&i.reduce((s,o,a)=>(s[o]===void 0&&(s[o]={}),a===i.length-1&&(s[o]=n),s[o]),r)};function CH(r,e){if(dU(r)&&dU(e)){const s=r.attributes,o=e.attributes;return s.length!==o.length?!1:Array.from(s).every(({name:a,value:l})=>e.getAttribute(a)===l)}if(r===e)return!0;if(r===null||typeof r!="object"||e===null||typeof e!="object")return!1;const n=Object.keys(r),i=Object.keys(e);if(n.length!==i.length)return!1;for(const s of n)if(!i.includes(s)||!CH(r[s],e[s]))return!1;return!0}function ZOe(r,e){if(!Array.isArray(r)||!Array.isArray(e)||r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!CH(r[n],e[n]))return!1;return!0}const KOe=Array.isArray;function JOe(r,e,n,i){const s=h=>{if(h.uuid===e)return h;for(const u of h.children){const f=s(u);if(f)return f}},o=s(r);if(!o){console.warn("Object with UUID not found in the scene.");return}let a=o;for(let h=0;h<n.length-1;h++)if(a[n[h]]!==void 0)a=a[n[h]];else{console.warn(`Property path is not valid: ${n.join(".")}`);return}const l=n[n.length-1];a[l]!==void 0?a[l]=i:console.warn(`Property path is not valid: ${n.join(".")}`)}function eSe(r){const e=new vs({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:Qs});return new GOe(r.geometry.clone(),e)}const tSe=Number.parseInt(r0.replace("dev","")),d_={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:Jr,toneMapping:MI,toneMappingExposure:3,shadowMap:{enabled:!0,type:QC}}};function iSe({scene:r,canvas:e,options:n,disableRender:i,contextParts:{sizes:s,camera:o}}){const a=Rn(()=>({alpha:Ln(n.alpha),depth:Ln(n.depth),canvas:hl(e),context:Ln(n.context),stencil:Ln(n.stencil),antialias:Ln(n.antialias)===void 0?!0:Ln(n.antialias),precision:Ln(n.precision),powerPreference:Ln(n.powerPreference),premultipliedAlpha:Ln(n.premultipliedAlpha),preserveDrawingBuffer:Ln(n.preserveDrawingBuffer),logarithmicDepthBuffer:Ln(n.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:Ln(n.failIfMajorPerformanceCaveat)})),l=Qn(new dg(a.value));Gi(a,()=>{l.value.dispose(),l.value=new dg(a.value)}),dh(()=>{l.value.setSize(s.width.value,s.height.value)});const{pixelRatio:h}=hOe();dh(()=>{l.value.setPixelRatio(h.value)});const{logError:u}=S2(),f=(()=>{const y=new dg,x={shadowMap:{enabled:y.shadowMap.enabled,type:y.shadowMap.type},toneMapping:y.toneMapping,toneMappingExposure:y.toneMappingExposure,outputColorSpace:y.outputColorSpace};return y.dispose(),x})();dh(()=>{const y=Ln(n.preset);y&&(y in d_||u(`Renderer Preset must be one of these: ${Object.keys(d_).join(", ")}`),SH(l.value,d_[y]));const x=(O,_)=>{const T=Ln(O),A=()=>{if(y)return fU(d_[y],_)};if(T!==void 0)return T;const P=A();return P!==void 0?P:fU(f,_)},w=(O,_)=>qOe(l.value,_,x(O,_));w(n.shadows,"shadowMap.enabled"),w(n.toneMapping,"toneMapping"),w(n.shadowMapType,"shadowMap.type"),tSe<150&&w(!n.useLegacyLights,"physicallyCorrectLights"),w(n.outputColorSpace,"outputColorSpace"),w(n.toneMappingExposure,"toneMappingExposure");const S=x(n.clearColor,"clearColor");S&&l.value.setClearColor(S?WOe(S):new nt(0))});const{pause:p,resume:m,onLoop:v}=Ep();return v(()=>{o.value&&!Ln(i)&&l.value.render(r,o.value)}),m(),Po(()=>{p(),l.value.dispose(),l.value.forceContextLoss()}),{renderer:l}}const pU=r=>typeof r=="function",nSe=r=>!!r&&r.constructor===Array;function rSe(r){const e={nodes:{},materials:{}};return r&&r.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}async function sSe(r,e,n,i,s){const{logError:o}=S2(),a=new r,l=(Array.isArray(e)?e:[e]).map(h=>new Promise((u,f)=>{a.load(h,p=>{p.scene&&Object.assign(p,rSe(p.scene)),u(p)},i,p=>f(o("[useLoader] - Failed to load resource",p)))}));return nSe(e)?await Promise.all(l):await l[0]}async function oSe(r,e){const n=new Bb(e),i=s=>new Promise((o,a)=>{n.load(s,l=>o(l),()=>null,()=>{a(new Error("[useTextures] - Failed to load texture"))})});if(KOe(r)){const s=await Promise.all(r.map(o=>i(o)));return r.length>1?s:s[0]}else{const{map:s,displacementMap:o,normalMap:a,roughnessMap:l,metalnessMap:h,aoMap:u,alphaMap:f,matcap:p}=r;return{map:s?await i(s):null,displacementMap:o?await i(o):null,normalMap:a?await i(a):null,roughnessMap:l?await i(l):null,metalnessMap:h?await i(h):null,aoMap:u?await i(u):null,alphaMap:f?await i(f):null,matcap:p?await i(p):null}}}const aSe=(r,{renderer:e,camera:n,raycaster:i})=>{const s=Rn(()=>e.value.domElement),{x:o,y:a}=gOe({target:s}),{width:l,height:h,top:u,left:f}=uOe(s),p=({x:N,y:k})=>{if(s.value)return{x:(N-f.value)/l.value*2-1,y:-((k-u.value)/h.value)*2+1}},m=({x:N,y:k})=>{if(n.value)return i.value.setFromCamera(new Xe(N,k),n.value),i.value.intersectObjects(r.value,!1)},v=N=>{const k=p({x:(N==null?void 0:N.clientX)??o.value,y:(N==null?void 0:N.clientY)??a.value});return k?m(k)||[]:[]},y=Rn(()=>v()),x=W1(),w=W1(),S=(N,k)=>{N.trigger({event:k,intersects:v(k)})},O=N=>{S(w,N)};let _;const T=N=>{var k;_=(k=v(N)[0])==null?void 0:k.object},A=N=>{var k;N instanceof PointerEvent&&_===((k=v(N)[0])==null?void 0:k.object)&&S(x,N)},P=N=>w.trigger({event:N,intersects:[]});return s.value.addEventListener("pointerup",A),s.value.addEventListener("pointerdown",T),s.value.addEventListener("pointermove",O),s.value.addEventListener("pointerleave",P),Po(()=>{s!=null&&s.value&&(s.value.removeEventListener("pointerup",A),s.value.removeEventListener("pointerdown",T),s.value.removeEventListener("pointermove",O),s.value.removeEventListener("pointerleave",P))}),{intersects:y,onClick:N=>x.on(N).off,onPointerMove:N=>w.on(N).off}},lSe=({scene:r,contextParts:e})=>{const n=xp({click:new Map,pointerMove:new Map,pointerEnter:new Map,pointerLeave:new Map}),i=ot(new Set),s=m=>{i.value.add(m)},o=m=>{i.value.delete(m)},a=m=>{Object.values(n).forEach(v=>v.delete(m)),o(m)},l=m=>{const{onClick:v,onPointerMove:y,onPointerEnter:x,onPointerLeave:w}=m;v&&n.click.set(m,v),y&&n.pointerMove.set(m,y),x&&n.pointerEnter.set(m,x),w&&n.pointerLeave.set(m,w)};r.userData.tres__registerAtPointerEventHandler=l,r.userData.tres__deregisterAtPointerEventHandler=a,r.userData.tres__registerBlockingObjectAtPointerEventHandler=s,r.userData.tres__deregisterBlockingObjectAtPointerEventHandler=o;const h=Rn(()=>YOe([...Array.from(i.value),...Object.values(n).map(m=>Array.from(m.keys())).flat()],({uuid:m})=>m)),{onClick:u,onPointerMove:f}=aSe(h,e);u(({intersects:m,event:v})=>{var y;m.length&&((y=n.click.get(m[0].object))==null||y(m[0],v))});let p;return f(({intersects:m,event:v})=>{var y,x,w,S;const O=(y=m==null?void 0:m[0])==null?void 0:y.object,{pointerLeave:_,pointerEnter:T,pointerMove:A}=n;p&&p!==O&&((x=_.get(p))==null||x(p,v)),O&&(p!==O&&((w=T.get(O))==null||w(m[0],v)),(S=A.get(O))==null||S(m[0],v)),p=O||null}),{registerObject:l,deregisterObject:a}};function TH(r){let e=0;return r.traverse(n=>{if(n.isMesh&&n.geometry){const i=n.geometry,s=i.attributes.position.count*3*Float32Array.BYTES_PER_ELEMENT,o=i.index?i.index.count*Uint32Array.BYTES_PER_ELEMENT:0,a=i.attributes.normal?i.attributes.normal.count*3*Float32Array.BYTES_PER_ELEMENT:0,l=i.attributes.uv?i.attributes.uv.count*2*Float32Array.BYTES_PER_ELEMENT:0,h=s+o+a+l;e+=h}}),e}function cSe(r){return(r/1024).toFixed(2)}const WP=ot({}),g4=r=>Object.assign(WP.value,r);function hSe(r,e,n=10){const i=Ln(r)?vOe():dOe(Rn(()=>Ln(e).parentElement)),s=Yf(hU(i.width,n)),o=Yf(hU(i.height,n)),a=Rn(()=>s.value/o.value);return{height:o,width:s,aspectRatio:a}}function uSe({scene:r,canvas:e,windowSize:n,disableRender:i,rendererOptions:s}){const o=hSe(n,e),a=Qn(r),{camera:l,cameras:h,registerCamera:u,deregisterCamera:f,setCameraActive:p}=VOe({sizes:o,scene:r}),{renderer:m}=iSe({scene:r,canvas:e,options:s,contextParts:{sizes:o,camera:l},disableRender:i}),v={sizes:o,scene:a,camera:l,cameras:Yf(h),renderer:m,raycaster:Qn(new _2),controls:ot(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},extend:g4,registerCamera:u,setCameraActive:p,deregisterCamera:f};M1("useTres",v);const y=100,x=fOe({every:y}),{isSupported:w,memory:S}=pOe({interval:y}),O=160;let _=performance.now();const T=({timestamp:k})=>{v.scene.value&&(v.perf.memory.allocatedMem=TH(v.scene.value)),k-_>=y&&(_=k,v.perf.fps.accumulator.push(x.value),v.perf.fps.accumulator.length>O&&v.perf.fps.accumulator.shift(),v.perf.fps.value=x.value,w.value&&S.value&&(v.perf.memory.accumulator.push(S.value.usedJSHeapSize/1024/1024),v.perf.memory.accumulator.length>O&&v.perf.memory.accumulator.shift(),v.perf.memory.currentMem=v.perf.memory.accumulator.reduce((R,E)=>R+E,0)/v.perf.memory.accumulator.length))};let A=0;const P=1,{pause:N}=p4(({delta:k})=>{window.__TRES__DEVTOOLS__&&(T({timestamp:performance.now()}),A+=k,A>=P&&(window.__TRES__DEVTOOLS__.cb(v),A=0))},{immediate:!0});return Po(()=>{N()}),v}function v4(){const r=hg("useTres");if(!r)throw new Error("useTresContext must be used together with useTresContextProvider");return r}let lr=null;const{logError:mU}=S2(),OM=["onClick","onPointerMove","onPointerEnter","onPointerLeave"],dSe={createElement(r,e,n,i){var s,o;if(i||(i={}),i.args||(i.args=[]),r==="template"||QOe(r))return null;let a=r.replace("Tres",""),l;if(r==="primitive"){(i==null?void 0:i.object)===void 0&&mU("Tres primitives need a prop 'object'");const h=i.object;a=h.type,l=Object.assign(h,{type:a,attach:i.attach,primitive:!0})}else{const h=WP.value[a];h||mU(`${a} is not defined on the THREE namespace. Use extend to add it to the catalog.`),l=new h(...i.args)}return l.isCamera&&(i!=null&&i.position||l.position.set(3,3,3),i!=null&&i.lookAt||l.lookAt(0,0,0)),(i==null?void 0:i.attach)===void 0&&(l.isMaterial?l.attach="material":l.isBufferGeometry&&(l.attach="geometry")),l.isObject3D&&((s=i==null?void 0:i.material)!=null&&s.isMaterial&&(l.userData.tres__materialViaProp=!0),(o=i==null?void 0:i.geometry)!=null&&o.isBufferGeometry&&(l.userData.tres__geometryViaProp=!0)),l.userData={...l.userData,tres__name:a},l},insert(r,e){var n,i,s,o;e&&e.isScene&&(lr=e);const a=e||lr;if(r!=null&&r.isObject3D){if(r!=null&&r.isCamera){if(!(lr!=null&&lr.userData.tres__registerCamera))throw new Error("could not find tres__registerCamera on scene's userData");(i=lr==null?void 0:(n=lr.userData).tres__registerCamera)==null||i.call(n,r)}if(r&&OM.some(l=>r[l])){if(!(lr!=null&&lr.userData.tres__registerAtPointerEventHandler))throw new Error("could not find tres__registerAtPointerEventHandler on scene's userData");(o=lr==null?void 0:(s=lr.userData).tres__registerAtPointerEventHandler)==null||o.call(s,r)}}r!=null&&r.isObject3D&&a!=null&&a.isObject3D?(a.add(r),r.dispatchEvent({type:"added"})):r!=null&&r.isFog?a.fog=r:typeof(r==null?void 0:r.attach)=="string"&&(r.__previousAttach=r[a==null?void 0:a.attach],a&&(a[r.attach]=r))},remove(r){var e,n;if(r){if(r.isObject3D){const i=r,s=u=>{var f,p;const m=u;u.userData.tres__materialViaProp||((f=m.material)==null||f.dispose(),m.material=void 0),u.userData.tres__geometryViaProp||((p=m.geometry)==null||p.dispose(),m.geometry=void 0)},o=lr==null?void 0:lr.userData.tres__deregisterAtPointerEventHandler,a=lr==null?void 0:lr.userData.tres__deregisterBlockingObjectAtPointerEventHandler,l=u=>{var f,p;if(!a)throw new Error("could not find tres__deregisterBlockingObjectAtPointerEventHandler on scene's userData");if((p=lr==null?void 0:(f=lr.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||p.call(f,u),!o)throw new Error("could not find tres__deregisterAtPointerEventHandler on scene's userData");u&&OM.some(m=>u[m])&&(o==null||o(u))},h=u=>{const f=lr==null?void 0:lr.userData.tres__deregisterCamera;if(!f)throw new Error("could not find tres__deregisterCamera on scene's userData");u.isCamera&&(f==null||f(u))};(e=r.removeFromParent)==null||e.call(r),i.traverse(u=>{s(u),h(u),l==null||l(u)}),s(i),h(i),l==null||l(i)}(n=r.dispose)==null||n.call(r)}},patchProp(r,e,n,i){var s,o,a,l;if(r){let h=r,u=e;if(r.isObject3D&&u==="blocks-pointer-events"){i||i===""?(o=lr==null?void 0:(s=lr.userData).tres__registerBlockingObjectAtPointerEventHandler)==null||o.call(s,r):(l=lr==null?void 0:(a=lr.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||l.call(a,r);return}let f=u_(u),p=h==null?void 0:h[f];if(u==="args"){const v=r,y=n??[],x=i??[],w=r.userData.tres__name||r.type;w&&y.length&&!ZOe(y,x)&&(h=Object.assign(v,new WP.value[w](...i)));return}if(h.type==="BufferGeometry"){if(u==="args")return;h.setAttribute(u_(u),new Di(...i));return}if(u.includes("-")&&p===void 0){const v=u.split("-");p=v.reduce((y,x)=>y[u_(x)],h),u=v.pop(),f=u.toLowerCase(),p!=null&&p.set||(h=v.reduce((y,x)=>y[u_(x)],h))}let m=i;if(m===""&&(m=!0),pU(p)){OM.includes(e)||(Array.isArray(m)?r[f](...m):r[f](m));return}!(p!=null&&p.set)&&!pU(p)?h[f]=m:p.constructor===m.constructor&&p!=null&&p.copy?p==null||p.copy(m):Array.isArray(m)?p.set(...m):!p.isColor&&p.setScalar?p.setScalar(m):p.set(m)}},parentNode(r){return(r==null?void 0:r.parent)||null},createText:()=>{},createComment:()=>{},setText:()=>{},setElementText:()=>{},nextSibling:()=>{},querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}},{render:fSe}=wI(dSe);g4(q_e);function pSe(){return EH().__VUE_DEVTOOLS_GLOBAL_HOOK__}function EH(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const mSe=typeof Proxy=="function",gSe="devtools-plugin:setup",vSe="plugin:settings:set";let xv,GP;function ySe(){var r;return xv!==void 0||(typeof window<"u"&&window.performance?(xv=!0,GP=window.performance):typeof globalThis<"u"&&!((r=globalThis.perf_hooks)===null||r===void 0)&&r.performance?(xv=!0,GP=globalThis.perf_hooks.performance):xv=!1),xv}function bSe(){return ySe()?GP.now():Date.now()}class xSe{constructor(e,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=n;const i={};if(e.settings)for(const a in e.settings){const l=e.settings[a];i[a]=l.defaultValue}const s=`__vue-devtools-plugin-settings__${e.id}`;let o=Object.assign({},i);try{const a=localStorage.getItem(s),l=JSON.parse(a);Object.assign(o,l)}catch{}this.fallbacks={getSettings(){return o},setSettings(a){try{localStorage.setItem(s,JSON.stringify(a))}catch{}o=a},now(){return bSe()}},n&&n.on(vSe,(a,l)=>{a===this.plugin.id&&this.fallbacks.setSettings(l)}),this.proxiedOn=new Proxy({},{get:(a,l)=>this.target?this.target.on[l]:(...h)=>{this.onQueue.push({method:l,args:h})}}),this.proxiedTarget=new Proxy({},{get:(a,l)=>this.target?this.target[l]:l==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(l)?(...h)=>(this.targetQueue.push({method:l,args:h,resolve:()=>{}}),this.fallbacks[l](...h)):(...h)=>new Promise(u=>{this.targetQueue.push({method:l,args:h,resolve:u})})})}async setRealTarget(e){this.target=e;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(await this.target[n.method](...n.args))}}function wSe(r,e){const n=r,i=EH(),s=pSe(),o=mSe&&n.enableEarlyProxy;if(s&&(i.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!o))s.emit(gSe,r,e);else{const a=o?new xSe(n,s):null;(i.__VUE_DEVTOOLS_PLUGINS__=i.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:e,proxy:a}),a&&e(a.proxiedTarget)}}function _Se(r,e){const n=`▲ ■ ●${r}`;typeof __VUE_DEVTOOLS_TOAST__=="function"?__VUE_DEVTOOLS_TOAST__(n,e):console.log(n)}const MH=r=>{const e={id:r.uuid,label:r.type,children:[],tags:[]};r.name!==""&&e.tags.push({label:r.name,textColor:5750629,backgroundColor:15793395});const n=TH(r);return n>0&&e.tags.push({label:`${cSe(n)} KB`,textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),r.type.includes("Light")&&(e.tags.push({label:`${r.intensity}`,textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),e.tags.push({label:`#${r.color.getHexString()}`,textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),r.type.includes("Camera")&&(e.tags.push({label:`${r.fov}°`,textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),e.tags.push({label:`x: ${Math.round(r.position.x)} y: ${Math.round(r.position.y)} z: ${Math.round(r.position.z)}`,textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),e};function AH(r,e){r.children.forEach(n=>{if(n.type==="HightlightMesh")return;const i=MH(n);e.children.push(i),AH(n,i)})}const OSe=[],wv="tres:inspector",SSe=xp({sceneGraph:null});function CSe(r,e){wSe({id:"dev.esm.tres",label:"TresJS 🪐",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://tresjs.org",componentStateTypes:OSe,app:r},n=>{typeof n.now!="function"&&_Se("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),n.addInspector({id:wv,label:"TresJS 🪐",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval(()=>{n.sendInspectorTree(wv)},1e3),setInterval(()=>{n.notifyComponentUpdate()},5e3),n.on.getInspectorTree(o=>{if(o.inspectorId===wv){const a=MH(e.scene.value);AH(e.scene.value,a),SSe.sceneGraph=a,o.rootNodes=[a]}});let i=null,s=null;n.on.getInspectorState(o=>{if(o.inspectorId===wv){const[a]=e.scene.value.getObjectsByProperty("uuid",o.nodeId);if(!a)return;if(s&&i&&i.parent&&s.remove(i),a.isMesh){const l=eSe(a);a.add(l),i=l,s=a}o.state={object:[{key:"uuid",editable:!0,value:a.uuid},{key:"name",editable:!0,value:a.name},{key:"type",editable:!0,value:a.type},{key:"position",editable:!0,value:a.position},{key:"rotation",editable:!0,value:a.rotation},{key:"scale",editable:!0,value:a.scale},{key:"geometry",value:a.geometry},{key:"material",value:a.material},{key:"color",editable:!0,value:a.color},{key:"intensity",editable:!0,value:a.intensity},{key:"castShadow",editable:!0,value:a.castShadow},{key:"receiveShadow",editable:!0,value:a.receiveShadow},{key:"frustumCulled",editable:!0,value:a.frustumCulled},{key:"matrixAutoUpdate",editable:!0,value:a.matrixAutoUpdate},{key:"matrixWorldNeedsUpdate",editable:!0,value:a.matrixWorldNeedsUpdate},{key:"matrixWorld",value:a.matrixWorld},{key:"visible",editable:!0,value:a.visible}]}}}),n.on.editInspectorState(o=>{o.inspectorId===wv&&JOe(e.scene.value,o.nodeId,o.path,o.state.value)})})}const TSe=["data-scene","data-tres"],y4=xh({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},disableRender:{type:Boolean,default:void 0},context:{},precision:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},logarithmicDepthBuffer:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0}},setup(r,{expose:e}){var n;const i=r,s=yI(),{logWarning:o}=S2(),a=ot(),l=Qn(new np),{resume:h}=Ep(),u=(n=oa())==null?void 0:n.appContext.app,f=x=>xh({setup(){var w;const S=(w=oa())==null?void 0:w.appContext;return S&&(S.app=u),M1("useTres",x),M1("extend",g4),typeof window<"u"&&CSe(S.app,x),()=>gS(yn,null,s!=null&&s.default?s.default():[])}}),p=x=>{const w=f(x);fSe(gS(w),l.value)},m=(x,w=!1)=>{l.value.children=[],w&&(x.renderer.value.dispose(),x.renderer.value.renderLists.dispose(),x.renderer.value.forceContextLoss()),p(x),h()},v=Rn(()=>i.disableRender),y=Qn(null);return e({context:y,dispose:()=>m(y.value,!0)}),Xn(()=>{const x=a;y.value=uSe({scene:l.value,canvas:x,windowSize:i.windowSize,disableRender:v,rendererOptions:i}),lSe({scene:l.value,contextParts:y.value});const{registerCamera:w,camera:S,cameras:O,deregisterCamera:_}=y.value;p(y.value);const T=()=>{const A=new fn(45,window.innerWidth/window.innerHeight,.1,1e3);A.position.set(3,3,3),A.lookAt(0,0,0),w(A);const P=dh(()=>{O.value.length>=2&&(A.removeFromParent(),_(A),P==null||P())})};Gi(()=>i.camera,(A,P)=>{A&&w(A),P&&(P.removeFromParent(),_(P))},{immediate:!0}),S.value||(o("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),T())}),(x,w)=>(ri(),Ji("canvas",{ref_key:"canvas",ref:a,"data-scene":l.value.uuid,class:i0(x.$attrs.class),"data-tres":`tresjs ${oi(UOe).version}`,style:pd({display:"block",width:"100%",height:"100%",position:x.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",...x.$attrs.style})},null,14,TSe))}}),ESe={install(r){r.component("TresCanvas",y4)}};/*! Tweakpane 4.0.3 (c) 2016 cocopon, licensed under the MIT license. */function sr(r){return r==null}function b4(r){return r!==null&&typeof r=="object"}function HP(r){return r!==null&&typeof r=="object"}function MSe(r,e){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!==e[n])return!1;return!0}function ap(r,e){return Array.from(new Set([...Object.keys(r),...Object.keys(e)])).reduce((i,s)=>{const o=r[s],a=e[s];return HP(o)&&HP(a)?Object.assign(Object.assign({},i),{[s]:ap(o,a)}):Object.assign(Object.assign({},i),{[s]:s in e?a:o})},{})}function ASe(r){return b4(r)?"target"in r:!1}const kSe={alreadydisposed:()=>"View has been already disposed",invalidparams:r=>`Invalid parameters for '${r.name}'`,nomatchingcontroller:r=>`No matching controller for '${r.key}'`,nomatchingview:r=>`No matching view for '${JSON.stringify(r.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:r=>`Not compatible with  plugin '${r.id}'`,propertynotfound:r=>`Property '${r.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class qo{static alreadyDisposed(){return new qo({type:"alreadydisposed"})}static notBindable(){return new qo({type:"notbindable"})}static notCompatible(e,n){return new qo({type:"notcompatible",context:{id:`${e}.${n}`}})}static propertyNotFound(e){return new qo({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new qo({type:"shouldneverhappen"})}constructor(e){var n;this.message=(n=kSe[e.type](e.context))!==null&&n!==void 0?n:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class MS{constructor(e,n){this.obj_=e,this.key=n}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,n){const i=this.read();if(!MS.isBindable(i))throw qo.notBindable();if(!(e in i))throw qo.propertyNotFound(e);i[e]=n}}class la{constructor(){this.observers_={}}on(e,n,i){var s;let o=this.observers_[e];return o||(o=this.observers_[e]=[]),o.push({handler:n,key:(s=i==null?void 0:i.key)!==null&&s!==void 0?s:n}),this}off(e,n){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.key!==n)),this}emit(e,n){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(n)})}}class PSe{constructor(e,n){var i;this.constraint_=n==null?void 0:n.constraint,this.equals_=(i=n==null?void 0:n.equals)!==null&&i!==void 0?i:(s,o)=>s===o,this.emitter=new la,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,n){const i=n??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,o=this.rawValue_;this.equals_(o,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:o,rawValue:s,sender:this}))}}class RSe{constructor(e){this.emitter=new la,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,n){const i=n??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}}class ISe{constructor(e){this.emitter=new la,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function rs(r,e){const n=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!n&&!i?new RSe(r):new PSe(r,e)}function NSe(r){return[new ISe(r),(e,n)=>{r.setRawValue(e,n)}]}class pn{constructor(e){this.emitter=new la,this.valMap_=e;for(const n in this.valMap_)this.valMap_[n].emitter.on("change",()=>{this.emitter.emit("change",{key:n,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:rs(e[s])}),{})}static fromObject(e){const n=this.createCore(e);return new pn(n)}get(e){return this.valMap_[e].rawValue}set(e,n){this.valMap_[e].rawValue=n}value(e){return this.valMap_[e]}}class C2{constructor(e){this.values=pn.fromObject({max:e.max,min:e.min})}constrain(e){const n=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),n)}}class DSe{constructor(e){this.values=pn.fromObject({max:e.max,min:e.min})}constrain(e){const n=this.values.get("max"),i=this.values.get("min");let s=e;return sr(i)||(s=Math.max(s,i)),sr(n)||(s=Math.min(s,n)),s}}class LSe{constructor(e,n=0){this.step=e,this.origin=n}constrain(e){const n=this.origin%this.step,i=Math.round((e-n)/this.step);return n+i*this.step}}class BSe{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const $Se={"**":(r,e)=>Math.pow(r,e),"*":(r,e)=>r*e,"/":(r,e)=>r/e,"%":(r,e)=>r%e,"+":(r,e)=>r+e,"-":(r,e)=>r-e,"<<":(r,e)=>r<<e,">>":(r,e)=>r>>e,">>>":(r,e)=>r>>>e,"&":(r,e)=>r&e,"^":(r,e)=>r^e,"|":(r,e)=>r|e};class USe{constructor(e,n,i){this.left=n,this.operator=e,this.right=i}evaluate(){const e=$Se[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const VSe={"+":r=>r,"-":r=>-r,"~":r=>~r};class FSe{constructor(e,n){this.operator=e,this.expression=n}evaluate(){const e=VSe[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function x4(r){return(e,n)=>{for(let i=0;i<r.length;i++){const s=r[i](e,n);if(s!=="")return s}return""}}function H1(r,e){var n;const i=r.substr(e).match(/^\s+/);return(n=i&&i[0])!==null&&n!==void 0?n:""}function zSe(r,e){const n=r.substr(e,1);return n.match(/^[1-9]$/)?n:""}function Q1(r,e){var n;const i=r.substr(e).match(/^[0-9]+/);return(n=i&&i[0])!==null&&n!==void 0?n:""}function XSe(r,e){const n=Q1(r,e);if(n!=="")return n;const i=r.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=Q1(r,e);return s===""?"":i+s}function w4(r,e){const n=r.substr(e,1);if(e+=1,n.toLowerCase()!=="e")return"";const i=XSe(r,e);return i===""?"":n+i}function kH(r,e){const n=r.substr(e,1);if(n==="0")return n;const i=zSe(r,e);return e+=i.length,i===""?"":i+Q1(r,e)}function WSe(r,e){const n=kH(r,e);if(e+=n.length,n==="")return"";const i=r.substr(e,1);if(e+=i.length,i!==".")return"";const s=Q1(r,e);return e+=s.length,n+i+s+w4(r,e)}function GSe(r,e){const n=r.substr(e,1);if(e+=n.length,n!==".")return"";const i=Q1(r,e);return e+=i.length,i===""?"":n+i+w4(r,e)}function HSe(r,e){const n=kH(r,e);return e+=n.length,n===""?"":n+w4(r,e)}const QSe=x4([WSe,GSe,HSe]);function jSe(r,e){var n;const i=r.substr(e).match(/^[01]+/);return(n=i&&i[0])!==null&&n!==void 0?n:""}function YSe(r,e){const n=r.substr(e,2);if(e+=n.length,n.toLowerCase()!=="0b")return"";const i=jSe(r,e);return i===""?"":n+i}function qSe(r,e){var n;const i=r.substr(e).match(/^[0-7]+/);return(n=i&&i[0])!==null&&n!==void 0?n:""}function ZSe(r,e){const n=r.substr(e,2);if(e+=n.length,n.toLowerCase()!=="0o")return"";const i=qSe(r,e);return i===""?"":n+i}function KSe(r,e){var n;const i=r.substr(e).match(/^[0-9a-f]+/i);return(n=i&&i[0])!==null&&n!==void 0?n:""}function JSe(r,e){const n=r.substr(e,2);if(e+=n.length,n.toLowerCase()!=="0x")return"";const i=KSe(r,e);return i===""?"":n+i}const eCe=x4([YSe,ZSe,JSe]),tCe=x4([eCe,QSe]);function iCe(r,e){const n=tCe(r,e);return e+=n.length,n===""?null:{evaluable:new BSe(n),cursor:e}}function nCe(r,e){const n=r.substr(e,1);if(e+=n.length,n!=="(")return null;const i=RH(r,e);if(!i)return null;e=i.cursor,e+=H1(r,e).length;const s=r.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function rCe(r,e){var n;return(n=iCe(r,e))!==null&&n!==void 0?n:nCe(r,e)}function PH(r,e){const n=rCe(r,e);if(n)return n;const i=r.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=PH(r,e);return s?(e=s.cursor,{cursor:e,evaluable:new FSe(i,s.evaluable)}):null}function sCe(r,e,n){n+=H1(e,n).length;const i=r.filter(s=>e.startsWith(s,n))[0];return i?(n+=i.length,n+=H1(e,n).length,{cursor:n,operator:i}):null}function oCe(r,e){return(n,i)=>{const s=r(n,i);if(!s)return null;i=s.cursor;let o=s.evaluable;for(;;){const a=sCe(e,n,i);if(!a)break;i=a.cursor;const l=r(n,i);if(!l)return null;i=l.cursor,o=new USe(a.operator,o,l.evaluable)}return o?{cursor:i,evaluable:o}:null}}const aCe=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((r,e)=>oCe(r,e),PH);function RH(r,e){return e+=H1(r,e).length,aCe(r,e)}function lCe(r){const e=RH(r,0);return!e||e.cursor+H1(r,e.cursor).length!==r.length?null:e.evaluable}function sd(r){var e;const n=lCe(r);return(e=n==null?void 0:n.evaluate())!==null&&e!==void 0?e:null}function IH(r){if(typeof r=="number")return r;if(typeof r=="string"){const e=sd(r);if(!sr(e))return e}return 0}function Ao(r){return e=>e.toFixed(Math.max(Math.min(r,20),0))}function xn(r,e,n,i,s){const o=(r-e)/(n-e);return i+o*(s-i)}function gU(r){return String(r.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Fr(r,e,n){return Math.min(Math.max(r,e),n)}function NH(r,e){return(r%e+e)%e}function cCe(r,e){return sr(r.step)?Math.max(gU(e),2):gU(r.step)}function DH(r){var e;return(e=r.step)!==null&&e!==void 0?e:1}function hCe(r,e){var n;const i=Math.abs((n=r.step)!==null&&n!==void 0?n:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function LH(r,e){return sr(r.step)?null:new LSe(r.step,e)}function BH(r){return!sr(r.max)&&!sr(r.min)?new C2({max:r.max,min:r.min}):!sr(r.max)||!sr(r.min)?new DSe({max:r.max,min:r.min}):null}function $H(r,e){var n,i,s;return{formatter:(n=r.format)!==null&&n!==void 0?n:Ao(cCe(r,e)),keyScale:(i=r.keyScale)!==null&&i!==void 0?i:DH(r),pointerScale:(s=r.pointerScale)!==null&&s!==void 0?s:hCe(r,e)}}function UH(r){return{format:r.optional.function,keyScale:r.optional.number,max:r.optional.number,min:r.optional.number,pointerScale:r.optional.number,step:r.optional.number}}function _4(r){return{constraint:r.constraint,textProps:pn.fromObject($H(r.params,r.initialValue))}}class O4{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class T2{constructor(e){this.target=e}}class VH extends T2{constructor(e,n,i){super(e),this.value=n,this.last=i??!0}}class uCe extends T2{constructor(e,n){super(e),this.expanded=n}}class dCe extends T2{constructor(e,n){super(e),this.index=n}}class fCe extends T2{constructor(e,n){super(e),this.native=n}}class S4 extends O4{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new la,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,n){const i=n.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:n}),this}off(e,n){return this.emitter_.off(e,n),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const n=this.controller.value;this.emitter_.emit("change",new VH(this,n.binding.target.read(),e.options.last))}}function pCe(r,e){const i=Object.keys(e).reduce((s,o)=>{if(s===void 0)return;const a=e[o],l=a(r[o]);return l.succeeded?Object.assign(Object.assign({},s),{[o]:l.value}):void 0},{});return i}function mCe(r,e){return r.reduce((n,i)=>{if(n===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...n,s.value]},[])}function gCe(r){return r===null?!1:typeof r=="object"}function Fc(r){return e=>n=>{if(!e&&n===void 0)return{succeeded:!1,value:void 0};if(e&&n===void 0)return{succeeded:!0,value:void 0};const i=r(n);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function vU(r){return{custom:e=>Fc(e)(r),boolean:Fc(e=>typeof e=="boolean"?e:void 0)(r),number:Fc(e=>typeof e=="number"?e:void 0)(r),string:Fc(e=>typeof e=="string"?e:void 0)(r),function:Fc(e=>typeof e=="function"?e:void 0)(r),constant:e=>Fc(n=>n===e?e:void 0)(r),raw:Fc(e=>e)(r),object:e=>Fc(n=>{if(gCe(n))return pCe(n,e)})(r),array:e=>Fc(n=>{if(Array.isArray(n))return mCe(n,e)})(r)}}const QP={optional:vU(!0),required:vU(!1)};function Ds(r,e){const n=e(QP),i=QP.required.object(n)(r);return i.succeeded?i.value:void 0}function xc(r,e,n,i){if(e&&!e(r))return!1;const s=Ds(r,n);return s?i(s):!1}function wc(r,e){var n;return ap((n=r==null?void 0:r())!==null&&n!==void 0?n:{},e)}function DO(r){return"value"in r}function vCe(r){if(!b4(r)||!("binding"in r))return!1;const e=r.binding;return ASe(e)}const ic="http://www.w3.org/2000/svg";function AS(r){r.offsetHeight}function yCe(r,e){const n=r.style.transition;r.style.transition="none",e(),r.style.transition=n}function C4(r){return r.ontouchstart!==void 0}function bCe(r){const e=r.ownerDocument.defaultView;return e&&"document"in e?r.getContext("2d",{willReadFrequently:!0}):null}const xCe={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function E2(r,e){const n=r.createElementNS(ic,"svg");return n.innerHTML=xCe[e],n}function FH(r,e,n){r.insertBefore(e,r.children[n])}function T4(r){r.parentElement&&r.parentElement.removeChild(r)}function zH(r){for(;r.children.length>0;)r.removeChild(r.children[0])}function wCe(r){for(;r.childNodes.length>0;)r.removeChild(r.childNodes[0])}function XH(r){return r.relatedTarget?r.relatedTarget:"explicitOriginalTarget"in r?r.explicitOriginalTarget:null}function mh(r,e){r.emitter.on("change",n=>{e(n.rawValue)}),e(r.rawValue)}function mc(r,e,n){mh(r.value(e),n)}const _Ce="tp";function mn(r){return(n,i)=>[_Ce,"-",r,"v",n?`_${n}`:"",i?`-${i}`:""].join("")}const _v=mn("lbl");function OCe(r,e){const n=r.createDocumentFragment();return e.split(`
`).map(s=>r.createTextNode(s)).forEach((s,o)=>{o>0&&n.appendChild(r.createElement("br")),n.appendChild(s)}),n}class SCe{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(_v()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(_v("l")),mc(n.props,"label",o=>{sr(o)?this.element.classList.add(_v(void 0,"nol")):(this.element.classList.remove(_v(void 0,"nol")),wCe(i),i.appendChild(OCe(e,o)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(_v("v")),this.element.appendChild(s),this.valueElement=s}}class CCe{constructor(e,n){this.props=n.props,this.valueController=n.valueController,this.viewProps=n.valueController.viewProps,this.view=new SCe(e,{props:n.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return xc(e,null,n=>({label:n.optional.string}),n=>(this.props.set("label",n.label),!0))}exportProps(){return wc(null,{label:this.props.get("label")})}}function TCe(){return["veryfirst","first","last","verylast"]}const yU=mn(""),bU={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class WH{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const n=this.view.element;this.blade.value("positions").emitter.on("change",()=>{TCe().forEach(i=>{n.classList.remove(yU(void 0,bU[i]))}),this.blade.get("positions").forEach(i=>{n.classList.add(yU(void 0,bU[i]))})}),this.viewProps.handleDispose(()=>{T4(n)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return xc(e,null,n=>({disabled:n.required.boolean,hidden:n.required.boolean}),n=>(this.viewProps.importState(n),!0))}exportState(){return wc(null,Object.assign({},this.viewProps.exportState()))}}class ECe extends O4{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,n){const i=n.bind(this);return this.controller.buttonController.emitter.on(e,o=>{i(new fCe(this,o.nativeEvent))}),this}off(e,n){return this.controller.buttonController.emitter.off(e,n),this}}function MCe(r,e,n){n?r.classList.add(e):r.classList.remove(e)}function p0(r,e){return n=>{MCe(r,e,n)}}function E4(r,e){mh(r,n=>{e.textContent=n??""})}const SM=mn("btn");class ACe{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(SM()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(SM("b")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(SM("t")),E4(n.props.value("title"),s),this.buttonElement.appendChild(s)}}class kCe{constructor(e,n){this.emitter=new la,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new ACe(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return xc(e,null,n=>({title:n.optional.string}),n=>(this.props.set("title",n.title),!0))}exportProps(){return wc(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}}class xU extends WH{constructor(e,n){const i=new kCe(e,{props:n.buttonProps,viewProps:n.viewProps}),s=new CCe(e,{blade:n.blade,props:n.labelProps,valueController:i});super({blade:n.blade,view:s.view,viewProps:n.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return xc(e,n=>super.importState(n)&&this.buttonController.importProps(n)&&this.labelController.importProps(n),()=>({}),()=>!0)}exportState(){return wc(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class GH{constructor(e){const[n,i]=e.split("-"),s=n.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}}const PCe=new GH("2.0.3");function no(r){return Object.assign({core:PCe},r)}no({id:"button",type:"blade",accept(r){const e=Ds(r,n=>({title:n.required.string,view:n.required.constant("button"),label:n.optional.string}));return e?{params:e}:null},controller(r){return new xU(r.document,{blade:r.blade,buttonProps:pn.fromObject({title:r.params.title}),labelProps:pn.fromObject({label:r.params.label}),viewProps:r.viewProps})},api(r){return r.controller instanceof xU?new ECe(r.controller):null}});function RCe(r,e){return r.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function ICe(r,e){return r.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function NCe(r,e){return r.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function DCe(r){return b4(r)?"refresh"in r&&typeof r.refresh=="function":!1}function LCe(r,e){if(!MS.isBindable(r))throw qo.notBindable();return new MS(r,e)}class BCe{constructor(e,n){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new la,this.pool_=n,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,n,i){const s=i??{},o=this.controller_.element.ownerDocument,a=this.pool_.createBinding(o,LCe(e,n),s),l=this.pool_.createBindingApi(a);return this.add(l,s.index)}addFolder(e){return ICe(this,e)}addButton(e){return RCe(this,e)}addTab(e){return NCe(this,e)}add(e,n){const i=e.controller;return this.controller_.rack.add(i,n),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const n=this.controller_.element.ownerDocument,i=this.pool_.createBlade(n,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,n){const i=n.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:n}),this}off(e,n){return this.emitter_.off(e,n),this}refresh(){this.children.forEach(e=>{DCe(e)&&e.refresh()})}onRackValueChange_(e){const n=e.bladeController,i=this.pool_.createApi(n),s=vCe(n.value)?n.value.binding:null;this.emitter_.emit("change",new VH(i,s?s.target.read():n.value.rawValue,e.options.last))}}class M4 extends O4{constructor(e,n){super(e),this.rackApi_=new BCe(e.rackController,n)}refresh(){this.rackApi_.refresh()}}class A4 extends WH{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return xc(e,n=>super.importState(n),n=>({children:n.required.array(n.required.raw)}),n=>this.rackController.rack.children.every((i,s)=>i.importState(n.children[s])))}exportState(){return wc(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}}function jP(r){return"rackController"in r}class $Ce{constructor(e){this.emitter=new la,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const n of this.allItems())if(e(n))return n;return null}includes(e){return this.cache_.has(e)}add(e,n){if(this.includes(e))throw qo.shouldNeverHappen();const i=n!==void 0?n:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(o=>{this.cache_.add(o)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const n=this.items_.indexOf(e);if(n<0)return;this.items_.splice(n,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:n,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function UCe(r,e){for(let n=0;n<r.length;n++){const i=r[n];if(DO(i)&&i.value===e)return i}return null}function VCe(r){return jP(r)?r.rackController.rack.bcSet_:null}class FCe{constructor(e){var n,i;this.emitter=new la,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(n=e.blade)!==null&&n!==void 0?n:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new $Ce(VCe),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,n){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,n)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const n=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:n,sender:this}),!n)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),DO(i))i.value.emitter.on("change",this.onChildValueChange_);else if(jP(i)){const s=i.rackController.rack;if(s){const o=s.emitter;o.on("layout",this.onRackLayout_),o.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const n=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:n,sender:this}),!n)return;const i=e.item;if(DO(i))i.value.emitter.off("change",this.onChildValueChange_);else if(jP(i)){const s=i.rackController.rack;if(s){const o=s.emitter;o.off("layout",this.onRackLayout_),o.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),n=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const o=[];s===n&&(o.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&o.push("veryfirst")),s===i&&(o.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&o.push("verylast")),s.blade.set("positions",o)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(n=>n.viewProps.get("disposed")).forEach(n=>{this.bcSet_.remove(n)})}onChildValueChange_(e){const n=UCe(this.find(DO),e.sender);if(!n)throw qo.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:n,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class k4{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const n=new FCe({blade:e.root?void 0:e.blade,viewProps:e.viewProps});n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),this.rack=n,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&FH(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&T4(e.bladeController.view.element)}}function HH(){return new pn({positions:rs([],{equals:MSe})})}class Vb extends pn{constructor(e){super(e)}static create(e){const n={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=pn.createCore(n);return new Vb(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!sr(e)?`${e}px`:"auto"}bindExpandedClass(e,n){const i=()=>{this.styleExpanded?e.classList.add(n):e.classList.remove(n)};mc(this,"expanded",i),mc(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function zCe(r,e){let n=0;return yCe(e,()=>{r.set("expandedHeight",null),r.set("temporaryExpanded",!0),AS(e),n=e.clientHeight,r.set("temporaryExpanded",null),AS(e)}),n}function wU(r,e){e.style.height=r.styleHeight}function P4(r,e){r.value("expanded").emitter.on("beforechange",()=>{if(r.set("completed",!1),sr(r.get("expandedHeight"))){const n=zCe(r,e);n>0&&r.set("expandedHeight",n)}r.set("shouldFixHeight",!0),AS(e)}),r.emitter.on("change",()=>{wU(r,e)}),wU(r,e),e.addEventListener("transitionend",n=>{n.propertyName==="height"&&r.cleanUpTransition()})}class XCe extends M4{constructor(e,n){super(e,n),this.emitter_=new la,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new uCe(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,n,i){return this.rackApi_.addBinding(e,n,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,n){return this.rackApi_.add(e,n)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,n){const i=n.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:n}),this}off(e,n){return this.emitter_.off(e,n),this}}const QH=mn("cnt");class WCe{constructor(e,n){var i;this.className_=mn((i=n.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),QH()),n.viewProps.bindClassModifiers(this.element),this.foldable_=n.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),mc(this.foldable_,"completed",p0(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),mc(n.props,"title",u=>{sr(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),n.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const o=e.createElement("div");o.classList.add(this.className_("i")),this.element.appendChild(o);const a=e.createElement("div");a.classList.add(this.className_("t")),E4(n.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const h=e.createElement("div");h.classList.add(this.className_("c")),this.element.appendChild(h),this.containerElement=h}}class _U extends A4{constructor(e,n){var i;const s=Vb.create((i=n.expanded)!==null&&i!==void 0?i:!0),o=new WCe(e,{foldable:s,props:n.props,viewName:n.root?"rot":void 0,viewProps:n.viewProps});super(Object.assign(Object.assign({},n),{rackController:new k4({blade:n.blade,element:o.containerElement,root:n.root,viewProps:n.viewProps}),view:o})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=n.props,this.foldable=s,P4(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return xc(e,n=>super.importState(n),n=>({expanded:n.required.boolean,title:n.optional.string}),n=>(this.foldable.set("expanded",n.expanded),this.props.set("title",n.title),!0))}exportState(){return wc(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}no({id:"folder",type:"blade",accept(r){const e=Ds(r,n=>({title:n.required.string,view:n.required.constant("folder"),expanded:n.optional.boolean}));return e?{params:e}:null},controller(r){return new _U(r.document,{blade:r.blade,expanded:r.params.expanded,props:pn.fromObject({title:r.params.title}),viewProps:r.viewProps})},api(r){return r.controller instanceof _U?new XCe(r.controller,r.pool):null}});const GCe=mn("");function OU(r,e){return p0(r,GCe(void 0,e))}class Fb extends pn{constructor(e){var n;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=NSe(rs(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(n=this.get("parent"))===null||n===void 0||n.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var n,i,s;const o=e??{};return new Fb(pn.createCore({disabled:(n=o.disabled)!==null&&n!==void 0?n:!1,disposed:!1,hidden:(i=o.hidden)!==null&&i!==void 0?i:!1,parent:(s=o.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){mh(this.globalDisabled_,OU(e,"disabled")),mc(this,"hidden",OU(e,"hidden"))}bindDisabled(e){mh(this.globalDisabled_,n=>{e.disabled=n})}bindTabIndex(e){mh(this.globalDisabled_,n=>{e.tabIndex=n?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",n=>{n&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var n;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(n=this.get("parent"))===null||n===void 0||n.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const SU=mn("tbp");class HCe{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(SU()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(SU("c")),this.element.appendChild(i),this.containerElement=i}}const Ov=mn("tbi");class QCe{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(Ov()),n.viewProps.bindClassModifiers(this.element),mc(n.props,"selected",o=>{o?this.element.classList.add(Ov(void 0,"sel")):this.element.classList.remove(Ov(void 0,"sel"))});const i=e.createElement("button");i.classList.add(Ov("b")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(Ov("t")),E4(n.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}}class jCe{constructor(e,n){this.emitter=new la,this.onClick_=this.onClick_.bind(this),this.props=n.props,this.viewProps=n.viewProps,this.view=new QCe(e,{props:n.props,viewProps:n.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class YP extends A4{constructor(e,n){const i=new HCe(e,{viewProps:n.viewProps});super(Object.assign(Object.assign({},n),{rackController:new k4({blade:n.blade,element:i.containerElement,viewProps:n.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new jCe(e,{props:n.itemProps,viewProps:Fb.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=n.props,mc(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return xc(e,n=>super.importState(n),n=>({selected:n.required.boolean,title:n.required.string}),n=>(this.ic_.props.set("selected",n.selected),this.ic_.props.set("title",n.title),!0))}exportState(){return wc(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class YCe extends M4{constructor(e,n){super(e,n),this.emitter_=new la,this.onSelect_=this.onSelect_.bind(this),this.pool_=n,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const n=this.controller.view.element.ownerDocument,i=new YP(n,{blade:HH(),itemProps:pn.fromObject({selected:!1,title:e.title}),props:pn.fromObject({selected:!1}),viewProps:Fb.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,n){const i=n.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:n}),this}off(e,n){return this.emitter_.off(e,n),this}onSelect_(e){this.emitter_.emit("select",new dCe(this,e.rawValue))}}class qCe extends M4{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,n){this.rackApi_.add(e,n)}remove(e){this.rackApi_.remove(e)}addBinding(e,n,i){return this.rackApi_.addBinding(e,n,i)}addBlade(e){return this.rackApi_.addBlade(e)}}const CU=-1;class ZCe{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=rs(!0),this.selectedIndex=rs(CU),this.items_=[]}add(e,n){const i=n??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const n=this.items_.indexOf(e);n<0||(this.items_.splice(n,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=CU,this.empty.rawValue=!0;return}const e=this.items_.findIndex(n=>n.rawValue);e<0?(this.items_.forEach((n,i)=>{n.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((n,i)=>{n.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const n=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===n}),this.selectedIndex.rawValue=n}else this.keepSelection_()}}const Sv=mn("tab");class KCe{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(Sv(),QH()),n.viewProps.bindClassModifiers(this.element),mh(n.empty,p0(this.element,Sv(void 0,"nop")));const i=e.createElement("div");i.classList.add(Sv("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(Sv("i")),this.element.appendChild(s);const o=e.createElement("div");o.classList.add(Sv("c")),this.element.appendChild(o),this.contentsElement=o}}class TU extends A4{constructor(e,n){const i=new ZCe,s=new KCe(e,{empty:i.empty,viewProps:n.viewProps});super({blade:n.blade,rackController:new k4({blade:n.blade,element:s.contentsElement,viewProps:n.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const o=this.rackController.rack;o.emitter.on("add",this.onRackAdd_),o.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,n){this.rackController.rack.add(e,n)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const n=e.bladeController;FH(this.view.itemsElement,n.itemController.view.element,e.index),n.itemController.viewProps.set("parent",this.viewProps),this.tab.add(n.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const n=e.bladeController;T4(n.itemController.view.element),n.itemController.viewProps.set("parent",null),this.tab.remove(n.props.value("selected"))}}no({id:"tab",type:"blade",accept(r){const e=Ds(r,n=>({pages:n.required.array(n.required.object({title:n.required.string})),view:n.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(r){const e=new TU(r.document,{blade:r.blade,viewProps:r.viewProps});return r.params.pages.forEach(n=>{const i=new YP(r.document,{blade:HH(),itemProps:pn.fromObject({selected:!1,title:n.title}),props:pn.fromObject({selected:!1}),viewProps:Fb.create()});e.add(i)}),e},api(r){return r.controller instanceof TU?new YCe(r.controller,r.pool):r.controller instanceof YP?new qCe(r.controller,r.pool):null}});class R4 extends S4{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class zb{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((n,i)=>i.constrain(n),e)}}function kS(r,e){if(r instanceof e)return r;if(r instanceof zb){const n=r.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(n)return n}return null}class M2{constructor(e){this.values=pn.fromObject({options:e})}constrain(e){const n=this.values.get("options");return n.length===0||n.filter(s=>s.value===e).length>0?e:n[0].value}}function A2(r){var e;const n=QP;if(Array.isArray(r))return(e=Ds({items:r},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof r=="object")return n.required.raw(r).value}function jH(r){if(Array.isArray(r))return r;const e=[];return Object.keys(r).forEach(n=>{e.push({text:n,value:r[n]})}),e}function I4(r){return sr(r)?null:new M2(jH(r))}const CM=mn("lst");class JCe{constructor(e,n){this.onValueChange_=this.onValueChange_.bind(this),this.props_=n.props,this.element=e.createElement("div"),this.element.classList.add(CM()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(CM("s")),n.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(CM("m")),s.appendChild(E2(e,"dropdown")),this.element.appendChild(s),n.value.emitter.on("change",this.onValueChange_),this.value_=n.value,mc(this.props_,"options",o=>{zH(this.selectElement),o.forEach(a=>{const l=e.createElement("option");l.textContent=a.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(n=>n.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class zg{constructor(e,n){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new JCe(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const n=e.currentTarget;this.value.rawValue=this.props.get("options")[n.selectedIndex].value}importProps(e){return xc(e,null,n=>({options:n.required.custom(A2)}),n=>(this.props.set("options",jH(n.options)),!0))}exportProps(){return wc(null,{options:this.props.get("options")})}}const EU=mn("pop");class e2e{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(EU()),n.viewProps.bindClassModifiers(this.element),mh(n.shows,p0(this.element,EU(void 0,"v")))}}class YH{constructor(e,n){this.shows=rs(!1),this.viewProps=n.viewProps,this.view=new e2e(e,{shows:this.shows,viewProps:this.viewProps})}}const MU=mn("txt");let t2e=class{constructor(e,n){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(MU()),n.viewProps.bindClassModifiers(this.element),this.props_=n.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(MU("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,n.value.emitter.on("change",this.onChange_),this.value_=n.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}};class N4{constructor(e,n){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=n.parser,this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new t2e(e,{props:n.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);sr(s)||(this.value.rawValue=s),this.view.refresh()}}function i2e(r){return String(r)}function qH(r){return r==="false"?!1:!!r}function AU(r){return i2e(r)}function n2e(r){return e=>r.reduce((n,i)=>n!==null?n:i(e),null)}const r2e=Ao(0);function PS(r){return r2e(r)+"%"}function ZH(r){return String(r)}function qP(r){return r}function m0({primary:r,secondary:e,forward:n,backward:i}){let s=!1;function o(a){s||(s=!0,a(),s=!1)}r.emitter.on("change",a=>{o(()=>{e.setRawValue(n(r.rawValue,e.rawValue),a.options)})}),e.emitter.on("change",a=>{o(()=>{r.setRawValue(i(r.rawValue,e.rawValue),a.options)}),o(()=>{e.setRawValue(n(r.rawValue,e.rawValue),a.options)})}),o(()=>{e.setRawValue(n(r.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function Oo(r,e){const n=r*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function j1(r){return{altKey:r.altKey,downKey:r.key==="ArrowDown",shiftKey:r.shiftKey,upKey:r.key==="ArrowUp"}}function Sh(r){return{altKey:r.altKey,downKey:r.key==="ArrowLeft",shiftKey:r.shiftKey,upKey:r.key==="ArrowRight"}}function s2e(r){return r==="ArrowUp"||r==="ArrowDown"}function KH(r){return s2e(r)||r==="ArrowLeft"||r==="ArrowRight"}function TM(r,e){var n,i;const s=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:r.pageX-(((n=s&&s.scrollX)!==null&&n!==void 0?n:0)+o.left),y:r.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+o.top)}}class Mp{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new la,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const n=this.elem_.getBoundingClientRect();return{bounds:{width:n.width,height:n.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var n;e.preventDefault(),(n=e.currentTarget)===null||n===void 0||n.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(TM(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(TM(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const n=this.elem_.ownerDocument;n.removeEventListener("mousemove",this.onDocumentMouseMove_),n.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(TM(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const n=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=n}onTouchMove_(e){const n=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=n}onTouchEnd_(e){var n;const i=(n=e.targetTouches.item(0))!==null&&n!==void 0?n:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const va=mn("txt");class o2e{constructor(e,n){this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(va(),va(void 0,"num")),n.arrayPosition&&this.element.classList.add(va(void 0,n.arrayPosition)),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(va("i")),i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=n.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(va()),this.inputElement.classList.add(va("i"));const s=e.createElement("div");s.classList.add(va("k")),this.element.appendChild(s),this.knobElement=s;const o=e.createElementNS(ic,"svg");o.classList.add(va("g")),this.knobElement.appendChild(o);const a=e.createElementNS(ic,"path");a.classList.add(va("gb")),o.appendChild(a),this.guideBodyElem_=a;const l=e.createElementNS(ic,"path");l.classList.add(va("gh")),o.appendChild(l),this.guideHeadElem_=l;const h=e.createElement("div");h.classList.add(mn("tt")()),this.knobElement.appendChild(h),this.tooltipElem_=h,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(va(void 0,"drg"));return}this.element.classList.add(va(void 0,"drg"));const n=e.rawValue/this.props_.get("pointerScale"),i=n+(n>0?-1:n<0?1:0),s=Fr(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${n},-1 L${n},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${n},4`);const o=this.props_.get("formatter");this.tooltipElem_.textContent=o(this.value.rawValue),this.tooltipElem_.style.left=`${n}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class Xb{constructor(e,n){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=n.parser,this.props=n.props,this.sliderProps_=(i=n.sliderProps)!==null&&i!==void 0?i:null,this.value=n.value,this.viewProps=n.viewProps,this.dragging_=rs(null),this.view=new o2e(e,{arrayPosition:n.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new Mp(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var n,i;const s=(n=this.sliderProps_)===null||n===void 0?void 0:n.get("min"),o=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let a=e;return s!==void 0&&(a=Math.max(a,s)),o!==void 0&&(a=Math.min(a,o)),a}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);sr(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const n=Oo(this.props.get("keyScale"),j1(e));n!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+n),{forceEmit:!1,last:!1})}onInputKeyUp_(e){Oo(this.props.get("keyScale"),j1(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const n=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+n*this.props.get("pointerScale"))}onPointerMove_(e){const n=this.computeDraggingValue_(e.data);n!==null&&(this.value.setRawValue(n,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const n=this.computeDraggingValue_(e.data);n!==null&&(this.value.setRawValue(n,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const EM=mn("sld");class a2e{constructor(e,n){this.onChange_=this.onChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(EM()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(EM("t")),n.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(EM("k")),this.trackElement.appendChild(s),this.knobElement=s,n.value.emitter.on("change",this.onChange_),this.value=n.value,this.update_()}update_(){const e=Fr(xn(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class l2e{constructor(e,n){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.props=n.props,this.view=new a2e(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mp(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,n){e.point&&this.value.setRawValue(xn(Fr(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),n)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const n=Oo(this.props.get("keyScale"),Sh(e));n!==0&&this.value.setRawValue(this.value.rawValue+n,{forceEmit:!1,last:!1})}onKeyUp_(e){Oo(this.props.get("keyScale"),Sh(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const MM=mn("sldtxt");class c2e{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(MM());const i=e.createElement("div");i.classList.add(MM("s")),this.sliderView_=n.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(MM("t")),this.textView_=n.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}}class kU{constructor(e,n){this.value=n.value,this.viewProps=n.viewProps,this.sliderC_=new l2e(e,{props:n.sliderProps,value:n.value,viewProps:this.viewProps}),this.textC_=new Xb(e,{parser:n.parser,props:n.textProps,sliderProps:n.sliderProps,value:n.value,viewProps:n.viewProps}),this.view=new c2e(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return xc(e,null,n=>({max:n.required.number,min:n.required.number}),n=>{const i=this.sliderC_.props;return i.set("max",n.max),i.set("min",n.min),!0})}exportProps(){const e=this.sliderC_.props;return wc(null,{max:e.get("max"),min:e.get("min")})}}function h2e(r){return{sliderProps:new pn({keyScale:r.keyScale,max:r.max,min:r.min}),textProps:new pn({formatter:rs(r.formatter),keyScale:r.keyScale,pointerScale:rs(r.pointerScale)})}}const u2e={containerUnitSize:"cnt-usz"};function JH(r){return`--${u2e[r]}`}function Y1(r){return UH(r)}function $u(r){if(HP(r))return Ds(r,Y1)}function sh(r,e){if(!r)return;const n=[],i=LH(r,e);i&&n.push(i);const s=BH(r);return s&&n.push(s),new zb(n)}function eQ(r){if(r==="inline"||r==="popup")return r}function Wb(r,e){r.write(e)}const f_=mn("ckb");class d2e{constructor(e,n){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(f_()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(f_("l")),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("input");s.classList.add(f_("i")),s.type="checkbox",this.labelElement.appendChild(s),this.inputElement=s,n.viewProps.bindDisabled(this.inputElement);const o=e.createElement("div");o.classList.add(f_("w")),this.labelElement.appendChild(o);const a=E2(e,"check");o.appendChild(a),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class f2e{constructor(e,n){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new d2e(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const n=e.currentTarget;this.value.rawValue=n.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}}function p2e(r){const e=[],n=I4(r.options);return n&&e.push(n),new zb(e)}no({id:"input-bool",type:"input",accept:(r,e)=>{if(typeof r!="boolean")return null;const n=Ds(e,i=>({options:i.optional.custom(A2),readonly:i.optional.constant(!1)}));return n?{initialValue:r,params:n}:null},binding:{reader:r=>qH,constraint:r=>p2e(r.params),writer:r=>Wb},controller:r=>{const e=r.document,n=r.value,i=r.constraint,s=i&&kS(i,M2);return s?new zg(e,{props:new pn({options:s.values.value("options")}),value:n,viewProps:r.viewProps}):new f2e(e,{value:n,viewProps:r.viewProps})},api(r){return typeof r.controller.value.rawValue!="boolean"?null:r.controller.valueController instanceof zg?new R4(r.controller):null}});const ef=mn("col");class m2e{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(ef()),n.foldable.bindExpandedClass(this.element,ef(void 0,"expanded")),mc(n.foldable,"completed",p0(this.element,ef(void 0,"cpl")));const i=e.createElement("div");i.classList.add(ef("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(ef("s")),i.appendChild(s),this.swatchElement=s;const o=e.createElement("div");if(o.classList.add(ef("t")),i.appendChild(o),this.textElement=o,n.pickerLayout==="inline"){const a=e.createElement("div");a.classList.add(ef("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null}}function g2e(r,e,n){const i=Fr(r/255,0,1),s=Fr(e/255,0,1),o=Fr(n/255,0,1),a=Math.max(i,s,o),l=Math.min(i,s,o),h=a-l;let u=0,f=0;const p=(l+a)/2;return h!==0&&(f=h/(1-Math.abs(a+l-1)),i===a?u=(s-o)/h:s===a?u=2+(o-i)/h:u=4+(i-s)/h,u=u/6+(u<0?1:0)),[u*360,f*100,p*100]}function v2e(r,e,n){const i=(r%360+360)%360,s=Fr(e/100,0,1),o=Fr(n/100,0,1),a=(1-Math.abs(2*o-1))*s,l=a*(1-Math.abs(i/60%2-1)),h=o-a/2;let u,f,p;return i>=0&&i<60?[u,f,p]=[a,l,0]:i>=60&&i<120?[u,f,p]=[l,a,0]:i>=120&&i<180?[u,f,p]=[0,a,l]:i>=180&&i<240?[u,f,p]=[0,l,a]:i>=240&&i<300?[u,f,p]=[l,0,a]:[u,f,p]=[a,0,l],[(u+h)*255,(f+h)*255,(p+h)*255]}function y2e(r,e,n){const i=Fr(r/255,0,1),s=Fr(e/255,0,1),o=Fr(n/255,0,1),a=Math.max(i,s,o),l=Math.min(i,s,o),h=a-l;let u;h===0?u=0:a===i?u=60*(((s-o)/h%6+6)%6):a===s?u=60*((o-i)/h+2):u=60*((i-s)/h+4);const f=a===0?0:h/a,p=a;return[u,f*100,p*100]}function tQ(r,e,n){const i=NH(r,360),s=Fr(e/100,0,1),o=Fr(n/100,0,1),a=o*s,l=a*(1-Math.abs(i/60%2-1)),h=o-a;let u,f,p;return i>=0&&i<60?[u,f,p]=[a,l,0]:i>=60&&i<120?[u,f,p]=[l,a,0]:i>=120&&i<180?[u,f,p]=[0,a,l]:i>=180&&i<240?[u,f,p]=[0,l,a]:i>=240&&i<300?[u,f,p]=[l,0,a]:[u,f,p]=[a,0,l],[(u+h)*255,(f+h)*255,(p+h)*255]}function b2e(r,e,n){const i=n+e*(100-Math.abs(2*n-100))/200;return[r,i!==0?e*(100-Math.abs(2*n-100))/i:0,n+e*(100-Math.abs(2*n-100))/(2*100)]}function x2e(r,e,n){const i=100-Math.abs(n*(200-e)/100-100);return[r,i!==0?e*n/i:0,n*(200-e)/(2*100)]}function gc(r){return[r[0],r[1],r[2]]}function k2(r,e){return[r[0],r[1],r[2],e]}const w2e={hsl:{hsl:(r,e,n)=>[r,e,n],hsv:b2e,rgb:v2e},hsv:{hsl:x2e,hsv:(r,e,n)=>[r,e,n],rgb:tQ},rgb:{hsl:g2e,hsv:y2e,rgb:(r,e,n)=>[r,e,n]}};function Xg(r,e){return[e==="float"?1:r==="rgb"?255:360,e==="float"?1:r==="rgb"?255:100,e==="float"?1:r==="rgb"?255:100]}function _2e(r,e){return r===e?e:NH(r,e)}function iQ(r,e,n){var i;const s=Xg(e,n);return[e==="rgb"?Fr(r[0],0,s[0]):_2e(r[0],s[0]),Fr(r[1],0,s[1]),Fr(r[2],0,s[2]),Fr((i=r[3])!==null&&i!==void 0?i:1,0,1)]}function PU(r,e,n,i){const s=Xg(e,n),o=Xg(e,i);return r.map((a,l)=>a/s[l]*o[l])}function nQ(r,e,n){const i=PU(r,e.mode,e.type,"int"),s=w2e[e.mode][n.mode](...i);return PU(s,n.mode,"int",n.type)}class cn{static black(){return new cn([0,0,0],"rgb")}constructor(e,n){this.type="int",this.mode=n,this.comps_=iQ(e,n,this.type)}getComponents(e){return k2(nQ(gc(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const uu=mn("colp");class O2e{constructor(e,n){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(uu()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(uu("hsv"));const s=e.createElement("div");s.classList.add(uu("sv")),this.svPaletteView_=n.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const o=e.createElement("div");o.classList.add(uu("h")),this.hPaletteView_=n.hPaletteView,o.appendChild(this.hPaletteView_.element),i.appendChild(o),this.element.appendChild(i);const a=e.createElement("div");if(a.classList.add(uu("rgb")),this.textsView_=n.textsView,a.appendChild(this.textsView_.element),this.element.appendChild(a),n.alphaViews){this.alphaViews_={palette:n.alphaViews.palette,text:n.alphaViews.text};const l=e.createElement("div");l.classList.add(uu("a"));const h=e.createElement("div");h.classList.add(uu("ap")),h.appendChild(this.alphaViews_.palette.element),l.appendChild(h);const u=e.createElement("div");u.classList.add(uu("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(n=>n.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function S2e(r){return r==="int"?"int":r==="float"?"float":void 0}function D4(r){return Ds(r,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(S2e)}),expanded:e.optional.boolean,picker:e.optional.custom(eQ),readonly:e.optional.constant(!1)}))}function lp(r){return r?.1:1}function rQ(r){var e;return(e=r.color)===null||e===void 0?void 0:e.type}class L4{constructor(e,n){this.type="float",this.mode=n,this.comps_=iQ(e,n,this.type)}getComponents(e){return k2(nQ(gc(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const C2e={int:(r,e)=>new cn(r,e),float:(r,e)=>new L4(r,e)};function B4(r,e,n){return C2e[n](r,e)}function T2e(r){return r.type==="float"}function E2e(r){return r.type==="int"}function M2e(r){const e=r.getComponents(),n=Xg(r.mode,"int");return new cn([Math.round(xn(e[0],0,1,0,n[0])),Math.round(xn(e[1],0,1,0,n[1])),Math.round(xn(e[2],0,1,0,n[2])),e[3]],r.mode)}function A2e(r){const e=r.getComponents(),n=Xg(r.mode,"int");return new L4([xn(e[0],0,n[0],0,1),xn(e[1],0,n[1],0,1),xn(e[2],0,n[2],0,1),e[3]],r.mode)}function Js(r,e){if(r.type===e)return r;if(E2e(r)&&e==="float")return A2e(r);if(T2e(r)&&e==="int")return M2e(r);throw qo.shouldNeverHappen()}function k2e(r,e){return r.alpha===e.alpha&&r.mode===e.mode&&r.notation===e.notation&&r.type===e.type}function Ma(r,e){const n=r.match(/^(.+)%$/);return Math.min(n?parseFloat(n[1])*.01*e:parseFloat(r),e)}const P2e={deg:r=>r,grad:r=>r*360/400,rad:r=>r*360/(2*Math.PI),turn:r=>r*360};function sQ(r){const e=r.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(r);const n=parseFloat(e[1]),i=e[2];return P2e[i](n)}function oQ(r){const e=r.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Ma(e[1],255),Ma(e[2],255),Ma(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function R2e(r){const e=oQ(r);return e?new cn(e,"rgb"):null}function aQ(r){const e=r.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Ma(e[1],255),Ma(e[2],255),Ma(e[3],255),Ma(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function I2e(r){const e=aQ(r);return e?new cn(e,"rgb"):null}function lQ(r){const e=r.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[sQ(e[1]),Ma(e[2],100),Ma(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function N2e(r){const e=lQ(r);return e?new cn(e,"hsl"):null}function cQ(r){const e=r.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[sQ(e[1]),Ma(e[2],100),Ma(e[3],100),Ma(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function D2e(r){const e=cQ(r);return e?new cn(e,"hsl"):null}function hQ(r){const e=r.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const n=r.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function L2e(r){const e=hQ(r);return e?new cn(e,"rgb"):null}function uQ(r){const e=r.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),xn(parseInt(e[4]+e[4],16),0,255,0,1)];const n=r.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),xn(parseInt(n[4],16),0,255,0,1)]:null}function B2e(r){const e=uQ(r);return e?new cn(e,"rgb"):null}function dQ(r){const e=r.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const n=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function $2e(r){return e=>{const n=dQ(e);return n?B4(n,"rgb",r):null}}function fQ(r){const e=r.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const n=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function U2e(r){return e=>{const n=fQ(e);return n?B4(n,"rgb",r):null}}const V2e=[{parser:hQ,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:uQ,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:oQ,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:aQ,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:lQ,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:cQ,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:dQ,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:fQ,result:{alpha:!0,mode:"rgb",notation:"object"}}];function F2e(r){return V2e.reduce((e,{parser:n,result:i})=>e||(n(r)?i:null),null)}function z2e(r,e="int"){const n=F2e(r);return n?n.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},n),{type:"int"}):n.notation==="func"?Object.assign(Object.assign({},n),{type:e}):null:null}function Gb(r){const e=[L2e,B2e,R2e,I2e,N2e,D2e];e.push($2e("int"),U2e("int"));const n=n2e(e);return i=>{const s=n(i);return s?Js(s,r):null}}function X2e(r){const e=Gb("int");if(typeof r!="string")return cn.black();const n=e(r);return n??cn.black()}function pQ(r){const e=Fr(Math.floor(r),0,255).toString(16);return e.length===1?`0${e}`:e}function $4(r,e="#"){const n=gc(r.getComponents("rgb")).map(pQ).join("");return`${e}${n}`}function U4(r,e="#"){const n=r.getComponents("rgb"),i=[n[0],n[1],n[2],n[3]*255].map(pQ).join("");return`${e}${i}`}function mQ(r){const e=Ao(0),n=Js(r,"int");return`rgb(${gc(n.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function LO(r){const e=Ao(2),n=Ao(0);return`rgba(${Js(r,"int").getComponents("rgb").map((o,a)=>(a===3?e:n)(o)).join(", ")})`}function W2e(r){const e=[Ao(0),PS,PS],n=Js(r,"int");return`hsl(${gc(n.getComponents("hsl")).map((s,o)=>e[o](s)).join(", ")})`}function G2e(r){const e=[Ao(0),PS,PS,Ao(2)];return`hsla(${Js(r,"int").getComponents("hsl").map((s,o)=>e[o](s)).join(", ")})`}function gQ(r,e){const n=Ao(e==="float"?2:0),i=["r","g","b"],s=Js(r,e);return`{${gc(s.getComponents("rgb")).map((a,l)=>`${i[l]}: ${n(a)}`).join(", ")}}`}function H2e(r){return e=>gQ(e,r)}function vQ(r,e){const n=Ao(2),i=Ao(e==="float"?2:0),s=["r","g","b","a"];return`{${Js(r,e).getComponents("rgb").map((l,h)=>{const u=h===3?n:i;return`${s[h]}: ${u(l)}`}).join(", ")}}`}function Q2e(r){return e=>vQ(e,r)}const j2e=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:$4},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:U4},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:mQ},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:LO},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:W2e},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:G2e},...["int","float"].reduce((r,e)=>[...r,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:H2e(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:Q2e(e)}],[])];function yQ(r){return j2e.reduce((e,n)=>e||(k2e(n.format,r)?n.stringifier:null),null)}const Cv=mn("apl");class Y2e{constructor(e,n){this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Cv()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Cv("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Cv("c")),i.appendChild(s),this.colorElem_=s;const o=e.createElement("div");o.classList.add(Cv("m")),this.element.appendChild(o),this.markerElem_=o;const a=e.createElement("div");a.classList.add(Cv("p")),this.markerElem_.appendChild(a),this.previewElem_=a,this.update_()}update_(){const e=this.value.rawValue,n=e.getComponents("rgb"),i=new cn([n[0],n[1],n[2],0],"rgb"),s=new cn([n[0],n[1],n[2],255],"rgb"),o=["to right",LO(i),LO(s)];this.colorElem_.style.background=`linear-gradient(${o.join(",")})`,this.previewElem_.style.backgroundColor=LO(e);const a=xn(n[3],0,1,0,100);this.markerElem_.style.left=`${a}%`}onValueChange_(){this.update_()}}class q2e{constructor(e,n){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new Y2e(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mp(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,n){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[o,a,l]=s.getComponents("hsv");this.value.setRawValue(new cn([o,a,l,i],"hsv"),n)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const n=Oo(lp(!0),Sh(e));if(n===0)return;const i=this.value.rawValue,[s,o,a,l]=i.getComponents("hsv");this.value.setRawValue(new cn([s,o,a,l+n],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Oo(lp(!0),Sh(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const wm=mn("coltxt");function Z2e(r){const e=r.createElement("select"),n=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(n.reduce((i,s)=>{const o=r.createElement("option");return o.textContent=s.text,o.value=s.value,i.appendChild(o),i},r.createDocumentFragment())),e}class K2e{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(wm()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(wm("m")),this.modeElem_=Z2e(e),this.modeElem_.classList.add(wm("ms")),i.appendChild(this.modeSelectElement),n.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(wm("mm")),s.appendChild(E2(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const o=e.createElement("div");o.classList.add(wm("w")),this.element.appendChild(o),this.inputsElem_=o,this.inputViews_=n.inputViews,this.applyInputViews_(),mh(n.mode,a=>{this.modeElem_.value=a})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){zH(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(n=>{const i=e.createElement("div");i.classList.add(wm("c")),i.appendChild(n.element),this.inputsElem_.appendChild(i)})}}function J2e(r){return Ao(r==="float"?2:0)}function eTe(r,e,n){const i=Xg(r,e)[n];return new C2({min:0,max:i})}function tTe(r,e,n){return new Xb(r,{arrayPosition:n===0?"fst":n===2?"lst":"mid",parser:e.parser,props:pn.fromObject({formatter:J2e(e.colorType),keyScale:lp(!1),pointerScale:e.colorType==="float"?.01:1}),value:rs(0,{constraint:eTe(e.colorMode,e.colorType,n)}),viewProps:e.viewProps})}function iTe(r,e){const n={colorMode:e.colorMode,colorType:e.colorType,parser:sd,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=tTe(r,n,i);return m0({primary:e.value,secondary:s.value,forward(o){return Js(o,e.colorType).getComponents(e.colorMode)[i]},backward(o,a){const l=e.colorMode,u=Js(o,e.colorType).getComponents(l);u[i]=a;const f=B4(k2(gc(u),u[3]),l,e.colorType);return Js(f,"int")}}),s})}function nTe(r,e){const n=new N4(r,{parser:Gb("int"),props:pn.fromObject({formatter:$4}),value:rs(cn.black()),viewProps:e.viewProps});return m0({primary:e.value,secondary:n.value,forward:i=>new cn(gc(i.getComponents()),i.mode),backward:(i,s)=>new cn(k2(gc(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[n]}function rTe(r){return r!=="hex"}class sTe{constructor(e,n){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=n.colorType,this.value=n.value,this.viewProps=n.viewProps,this.colorMode=rs(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new K2e(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const n=this.colorMode.rawValue;return rTe(n)?iTe(e,{colorMode:n,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):nTe(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const n=e.currentTarget;this.colorMode.rawValue=n.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}}const AM=mn("hpl");class oTe{constructor(e,n){this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(AM()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(AM("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(AM("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[n]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=mQ(new cn([n,100,100],"hsv"));const i=xn(n,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}}class aTe{constructor(e,n){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new oTe(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mp(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,n){if(!e.point)return;const i=xn(Fr(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,o,a,l]=s.getComponents("hsv");this.value.setRawValue(new cn([i,o,a,l],"hsv"),n)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const n=Oo(lp(!1),Sh(e));if(n===0)return;const i=this.value.rawValue,[s,o,a,l]=i.getComponents("hsv");this.value.setRawValue(new cn([s+n,o,a,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Oo(lp(!1),Sh(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const kM=mn("svp"),RU=64;class lTe{constructor(e,n){this.onValueChange_=this.onValueChange_.bind(this),this.value=n.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(kM()),n.viewProps.bindClassModifiers(this.element),n.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=RU,i.width=RU,i.classList.add(kM("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(kM("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=bCe(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,o=this.canvasElement.height,a=e.getImageData(0,0,s,o),l=a.data;for(let f=0;f<o;f++)for(let p=0;p<s;p++){const m=xn(p,0,s,0,100),v=xn(f,0,o,100,0),y=tQ(i[0],m,v),x=(f*s+p)*4;l[x]=y[0],l[x+1]=y[1],l[x+2]=y[2],l[x+3]=255}e.putImageData(a,0,0);const h=xn(i[1],0,100,0,100);this.markerElem_.style.left=`${h}%`;const u=xn(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}}class cTe{constructor(e,n){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.view=new lTe(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mp(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,n){if(!e.point)return;const i=xn(e.point.x,0,e.bounds.width,0,100),s=xn(e.point.y,0,e.bounds.height,100,0),[o,,,a]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new cn([o,i,s,a],"hsv"),n)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){KH(e.key)&&e.preventDefault();const[n,i,s,o]=this.value.rawValue.getComponents("hsv"),a=lp(!1),l=Oo(a,Sh(e)),h=Oo(a,j1(e));l===0&&h===0||this.value.setRawValue(new cn([n,i+l,s+h,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const n=lp(!1),i=Oo(n,Sh(e)),s=Oo(n,j1(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class hTe{constructor(e,n){this.value=n.value,this.viewProps=n.viewProps,this.hPaletteC_=new aTe(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new cTe(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=n.supportsAlpha?{palette:new q2e(e,{value:this.value,viewProps:this.viewProps}),text:new Xb(e,{parser:sd,props:pn.fromObject({pointerScale:.01,keyScale:.1,formatter:Ao(2)}),value:rs(0,{constraint:new C2({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&m0({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const o=i.getComponents();return o[3]=s,new cn(o,i.mode)}}),this.textsC_=new sTe(e,{colorType:n.colorType,value:this.value,viewProps:this.viewProps}),this.view=new O2e(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:n.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const PM=mn("colsw");class uTe{constructor(e,n){this.onValueChange_=this.onValueChange_.bind(this),n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.element=e.createElement("div"),this.element.classList.add(PM()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(PM("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add(PM("b")),n.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=U4(e)}onValueChange_(){this.update_()}}class dTe{constructor(e,n){this.value=n.value,this.viewProps=n.viewProps,this.view=new uTe(e,{value:this.value,viewProps:this.viewProps})}}class V4{constructor(e,n){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=Vb.create(n.expanded),this.swatchC_=new dTe(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new N4(e,{parser:n.parser,props:pn.fromObject({formatter:n.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new m2e(e,{foldable:this.foldable_,pickerLayout:n.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=n.pickerLayout==="popup"?new YH(e,{viewProps:this.viewProps}):null;const s=new hTe(e,{colorType:n.colorType,supportsAlpha:n.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),m0({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,a)=>a})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),P4(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const n=this.view.element,i=e.relatedTarget;(!i||!n.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const n=this.popC_.view.element,i=XH(e);i&&n.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!C4(n.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function fTe(r){return gc(r.getComponents("rgb")).reduce((e,n)=>e<<8|Math.floor(n)&255,0)}function pTe(r){return r.getComponents("rgb").reduce((e,n,i)=>{const s=Math.floor(i===3?n*255:n)&255;return e<<8|s},0)>>>0}function mTe(r){return new cn([r>>16&255,r>>8&255,r&255],"rgb")}function gTe(r){return new cn([r>>24&255,r>>16&255,r>>8&255,xn(r&255,0,255,0,1)],"rgb")}function vTe(r){return typeof r!="number"?cn.black():mTe(r)}function yTe(r){return typeof r!="number"?cn.black():gTe(r)}function BO(r,e){return typeof r!="object"||sr(r)?!1:e in r&&typeof r[e]=="number"}function bQ(r){return BO(r,"r")&&BO(r,"g")&&BO(r,"b")}function xQ(r){return bQ(r)&&BO(r,"a")}function wQ(r){return bQ(r)}function F4(r,e){if(r.mode!==e.mode||r.type!==e.type)return!1;const n=r.getComponents(),i=e.getComponents();for(let s=0;s<n.length;s++)if(n[s]!==i[s])return!1;return!0}function IU(r){return"a"in r?[r.r,r.g,r.b,r.a]:[r.r,r.g,r.b]}function bTe(r){const e=yQ(r);return e?(n,i)=>{Wb(n,e(i))}:null}function xTe(r){const e=r?pTe:fTe;return(n,i)=>{Wb(n,e(i))}}function wTe(r,e,n){const s=Js(e,n).toRgbaObject();r.writeProperty("r",s.r),r.writeProperty("g",s.g),r.writeProperty("b",s.b),r.writeProperty("a",s.a)}function _Te(r,e,n){const s=Js(e,n).toRgbaObject();r.writeProperty("r",s.r),r.writeProperty("g",s.g),r.writeProperty("b",s.b)}function OTe(r,e){return(n,i)=>{r?wTe(n,i,e):_Te(n,i,e)}}function STe(r){var e;return!!(!((e=r==null?void 0:r.color)===null||e===void 0)&&e.alpha)}function CTe(r){return r?e=>U4(e,"0x"):e=>$4(e,"0x")}function TTe(r){return"color"in r||r.view==="color"}no({id:"input-color-number",type:"input",accept:(r,e)=>{if(typeof r!="number"||!TTe(e))return null;const n=D4(e);return n?{initialValue:r,params:Object.assign(Object.assign({},n),{supportsAlpha:STe(e)})}:null},binding:{reader:r=>r.params.supportsAlpha?yTe:vTe,equals:F4,writer:r=>xTe(r.params.supportsAlpha)},controller:r=>{var e,n;return new V4(r.document,{colorType:"int",expanded:(e=r.params.expanded)!==null&&e!==void 0?e:!1,formatter:CTe(r.params.supportsAlpha),parser:Gb("int"),pickerLayout:(n=r.params.picker)!==null&&n!==void 0?n:"popup",supportsAlpha:r.params.supportsAlpha,value:r.value,viewProps:r.viewProps})}});function ETe(r,e){if(!wQ(r))return Js(cn.black(),e);if(e==="int"){const n=IU(r);return new cn(n,"rgb")}if(e==="float"){const n=IU(r);return new L4(n,"rgb")}return Js(cn.black(),"int")}function MTe(r){return xQ(r)}function ATe(r){return e=>{const n=ETe(e,r);return Js(n,"int")}}function kTe(r,e){return n=>r?vQ(n,e):gQ(n,e)}no({id:"input-color-object",type:"input",accept:(r,e)=>{var n;if(!wQ(r))return null;const i=D4(e);return i?{initialValue:r,params:Object.assign(Object.assign({},i),{colorType:(n=rQ(e))!==null&&n!==void 0?n:"int"})}:null},binding:{reader:r=>ATe(r.params.colorType),equals:F4,writer:r=>OTe(MTe(r.initialValue),r.params.colorType)},controller:r=>{var e,n;const i=xQ(r.initialValue);return new V4(r.document,{colorType:r.params.colorType,expanded:(e=r.params.expanded)!==null&&e!==void 0?e:!1,formatter:kTe(i,r.params.colorType),parser:Gb("int"),pickerLayout:(n=r.params.picker)!==null&&n!==void 0?n:"popup",supportsAlpha:i,value:r.value,viewProps:r.viewProps})}});no({id:"input-color-string",type:"input",accept:(r,e)=>{if(typeof r!="string"||e.view==="text")return null;const n=z2e(r,rQ(e));if(!n)return null;const i=yQ(n);if(!i)return null;const s=D4(e);return s?{initialValue:r,params:Object.assign(Object.assign({},s),{format:n,stringifier:i})}:null},binding:{reader:()=>X2e,equals:F4,writer:r=>{const e=bTe(r.params.format);if(!e)throw qo.notBindable();return e}},controller:r=>{var e,n;return new V4(r.document,{colorType:r.params.format.type,expanded:(e=r.params.expanded)!==null&&e!==void 0?e:!1,formatter:r.params.stringifier,parser:Gb("int"),pickerLayout:(n=r.params.picker)!==null&&n!==void 0?n:"popup",supportsAlpha:r.params.format.alpha,value:r.value,viewProps:r.viewProps})}});class z4{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const n=this.asm_.toComponents(e).map((i,s)=>{var o,a;return(a=(o=this.components[s])===null||o===void 0?void 0:o.constrain(i))!==null&&a!==void 0?a:i});return this.asm_.fromComponents(n)}}const NU=mn("pndtxt");class PTe{constructor(e,n){this.textViews=n.textViews,this.element=e.createElement("div"),this.element.classList.add(NU()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(NU("a")),s.appendChild(i.element),this.element.appendChild(s)})}}function RTe(r,e,n){return new Xb(r,{arrayPosition:n===0?"fst":n===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[n].textProps,value:rs(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}class X4{constructor(e,n){this.value=n.value,this.viewProps=n.viewProps,this.acs_=n.axes.map((i,s)=>RTe(e,n,s)),this.acs_.forEach((i,s)=>{m0({primary:this.value,secondary:i.value,forward:o=>n.assembly.toComponents(o)[s],backward:(o,a)=>{const l=n.assembly.toComponents(o);return l[s]=a,n.assembly.fromComponents(l)}})}),this.view=new PTe(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}}class ITe extends S4{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}function NTe(r,e){const n=[],i=LH(r,e);i&&n.push(i);const s=BH(r);s&&n.push(s);const o=I4(r.options);return o&&n.push(o),new zb(n)}no({id:"input-number",type:"input",accept:(r,e)=>{if(typeof r!="number")return null;const n=Ds(e,i=>Object.assign(Object.assign({},UH(i)),{options:i.optional.custom(A2),readonly:i.optional.constant(!1)}));return n?{initialValue:r,params:n}:null},binding:{reader:r=>IH,constraint:r=>NTe(r.params,r.initialValue),writer:r=>Wb},controller:r=>{const e=r.value,n=r.constraint,i=n&&kS(n,M2);if(i)return new zg(r.document,{props:new pn({options:i.values.value("options")}),value:e,viewProps:r.viewProps});const s=$H(r.params,e.rawValue),o=n&&kS(n,C2);return o?new kU(r.document,Object.assign(Object.assign({},h2e(Object.assign(Object.assign({},s),{keyScale:rs(s.keyScale),max:o.values.value("max"),min:o.values.value("min")}))),{parser:sd,value:e,viewProps:r.viewProps})):new Xb(r.document,{parser:sd,props:pn.fromObject(s),value:e,viewProps:r.viewProps})},api(r){return typeof r.controller.value.rawValue!="number"?null:r.controller.valueController instanceof kU?new ITe(r.controller):r.controller.valueController instanceof zg?new R4(r.controller):null}});class ju{constructor(e=0,n=0){this.x=e,this.y=n}getComponents(){return[this.x,this.y]}static isObject(e){if(sr(e))return!1;const n=e.x,i=e.y;return!(typeof n!="number"||typeof i!="number")}static equals(e,n){return e.x===n.x&&e.y===n.y}toObject(){return{x:this.x,y:this.y}}}const _Q={toComponents:r=>r.getComponents(),fromComponents:r=>new ju(...r)},_m=mn("p2d");class DTe{constructor(e,n){this.element=e.createElement("div"),this.element.classList.add(_m()),n.viewProps.bindClassModifiers(this.element),mh(n.expanded,p0(this.element,_m(void 0,"expanded")));const i=e.createElement("div");i.classList.add(_m("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(_m("b")),s.appendChild(E2(e,"p2dpad")),n.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const o=e.createElement("div");if(o.classList.add(_m("t")),i.appendChild(o),this.textElement=o,n.pickerLayout==="inline"){const a=e.createElement("div");a.classList.add(_m("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null}}const du=mn("p2dp");class LTe{constructor(e,n){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=n.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(du()),n.layout==="popup"&&this.element.classList.add(du(void 0,"p")),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(du("p")),n.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(ic,"svg");s.classList.add(du("g")),this.padElement.appendChild(s),this.svgElem_=s;const o=e.createElementNS(ic,"line");o.classList.add(du("ax")),o.setAttributeNS(null,"x1","0"),o.setAttributeNS(null,"y1","50%"),o.setAttributeNS(null,"x2","100%"),o.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(o);const a=e.createElementNS(ic,"line");a.classList.add(du("ax")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","0"),a.setAttributeNS(null,"x2","50%"),a.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(a);const l=e.createElementNS(ic,"line");l.classList.add(du("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const h=e.createElement("div");h.classList.add(du("m")),this.padElement.appendChild(h),this.markerElem_=h,n.value.emitter.on("change",this.onValueChange_),this.value=n.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,n]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=xn(e,-i,+i,0,100),o=xn(n,-i,+i,0,100),a=this.props_.get("invertsY")?100-o:o;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${a}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function DU(r,e,n){return[Oo(e[0],Sh(r)),Oo(e[1],j1(r))*(n?1:-1)]}class BTe{constructor(e,n){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.view=new LTe(e,{layout:n.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mp(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,n){if(!e.point)return;const i=this.props.get("max"),s=xn(e.point.x,0,e.bounds.width,-i,+i),o=xn(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new ju(s,o),n)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){KH(e.key)&&e.preventDefault();const[n,i]=DU(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));n===0&&i===0||this.value.setRawValue(new ju(this.value.rawValue.x+n,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[n,i]=DU(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));n===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class $Te{constructor(e,n){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=n.value,this.viewProps=n.viewProps,this.foldable_=Vb.create(n.expanded),this.popC_=n.pickerLayout==="popup"?new YH(e,{viewProps:this.viewProps}):null;const o=new BTe(e,{layout:n.pickerLayout,props:new pn({invertsY:rs(n.invertsY),max:rs(n.max),xKeyScale:n.axes[0].textProps.value("keyScale"),yKeyScale:n.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach(a=>{a.addEventListener("blur",this.onPopupChildBlur_),a.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=o,this.textC_=new X4(e,{assembly:_Q,axes:n.axes,parser:n.parser,value:this.value,viewProps:this.viewProps}),this.view=new DTe(e,{expanded:this.foldable_.value("expanded"),pickerLayout:n.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),m0({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:a=>a,backward:(a,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),P4(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const n=this.view.element,i=e.relatedTarget;(!i||!n.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const n=this.popC_.view.element,i=XH(e);i&&n.contains(i)||i&&i===this.view.buttonElement&&!C4(n.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}}function UTe(r){return ju.isObject(r)?new ju(r.x,r.y):new ju}function VTe(r,e){r.writeProperty("x",e.x),r.writeProperty("y",e.y)}function FTe(r,e){return new z4({assembly:_Q,components:[sh(Object.assign(Object.assign({},r),r.x),e.x),sh(Object.assign(Object.assign({},r),r.y),e.y)]})}function LU(r,e){var n,i;if(!sr(r.min)||!sr(r.max))return Math.max(Math.abs((n=r.min)!==null&&n!==void 0?n:0),Math.abs((i=r.max)!==null&&i!==void 0?i:0));const s=DH(r);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function zTe(r,e){var n,i;const s=LU(ap(r,(n=r.x)!==null&&n!==void 0?n:{}),e.x),o=LU(ap(r,(i=r.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,o)}function XTe(r){if(!("y"in r))return!1;const e=r.y;return e&&"inverted"in e?!!e.inverted:!1}no({id:"input-point2d",type:"input",accept:(r,e)=>{if(!ju.isObject(r))return null;const n=Ds(e,i=>Object.assign(Object.assign({},Y1(i)),{expanded:i.optional.boolean,picker:i.optional.custom(eQ),readonly:i.optional.constant(!1),x:i.optional.custom($u),y:i.optional.object(Object.assign(Object.assign({},Y1(i)),{inverted:i.optional.boolean}))}));return n?{initialValue:r,params:n}:null},binding:{reader:()=>UTe,constraint:r=>FTe(r.params,r.initialValue),equals:ju.equals,writer:()=>VTe},controller:r=>{var e,n;const i=r.document,s=r.value,o=r.constraint,a=[r.params.x,r.params.y];return new $Te(i,{axes:s.rawValue.getComponents().map((l,h)=>{var u;return _4({constraint:o.components[h],initialValue:l,params:ap(r.params,(u=a[h])!==null&&u!==void 0?u:{})})}),expanded:(e=r.params.expanded)!==null&&e!==void 0?e:!1,invertsY:XTe(r.params),max:zTe(r.params,s.rawValue),parser:sd,pickerLayout:(n=r.params.picker)!==null&&n!==void 0?n:"popup",value:s,viewProps:r.viewProps})}});class pg{constructor(e=0,n=0,i=0){this.x=e,this.y=n,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(sr(e))return!1;const n=e.x,i=e.y,s=e.z;return!(typeof n!="number"||typeof i!="number"||typeof s!="number")}static equals(e,n){return e.x===n.x&&e.y===n.y&&e.z===n.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const OQ={toComponents:r=>r.getComponents(),fromComponents:r=>new pg(...r)};function WTe(r){return pg.isObject(r)?new pg(r.x,r.y,r.z):new pg}function GTe(r,e){r.writeProperty("x",e.x),r.writeProperty("y",e.y),r.writeProperty("z",e.z)}function HTe(r,e){return new z4({assembly:OQ,components:[sh(Object.assign(Object.assign({},r),r.x),e.x),sh(Object.assign(Object.assign({},r),r.y),e.y),sh(Object.assign(Object.assign({},r),r.z),e.z)]})}no({id:"input-point3d",type:"input",accept:(r,e)=>{if(!pg.isObject(r))return null;const n=Ds(e,i=>Object.assign(Object.assign({},Y1(i)),{readonly:i.optional.constant(!1),x:i.optional.custom($u),y:i.optional.custom($u),z:i.optional.custom($u)}));return n?{initialValue:r,params:n}:null},binding:{reader:r=>WTe,constraint:r=>HTe(r.params,r.initialValue),equals:pg.equals,writer:r=>GTe},controller:r=>{const e=r.value,n=r.constraint,i=[r.params.x,r.params.y,r.params.z];return new X4(r.document,{assembly:OQ,axes:e.rawValue.getComponents().map((s,o)=>{var a;return _4({constraint:n.components[o],initialValue:s,params:ap(r.params,(a=i[o])!==null&&a!==void 0?a:{})})}),parser:sd,value:e,viewProps:r.viewProps})}});class mg{constructor(e=0,n=0,i=0,s=0){this.x=e,this.y=n,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(sr(e))return!1;const n=e.x,i=e.y,s=e.z,o=e.w;return!(typeof n!="number"||typeof i!="number"||typeof s!="number"||typeof o!="number")}static equals(e,n){return e.x===n.x&&e.y===n.y&&e.z===n.z&&e.w===n.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const SQ={toComponents:r=>r.getComponents(),fromComponents:r=>new mg(...r)};function QTe(r){return mg.isObject(r)?new mg(r.x,r.y,r.z,r.w):new mg}function jTe(r,e){r.writeProperty("x",e.x),r.writeProperty("y",e.y),r.writeProperty("z",e.z),r.writeProperty("w",e.w)}function YTe(r,e){return new z4({assembly:SQ,components:[sh(Object.assign(Object.assign({},r),r.x),e.x),sh(Object.assign(Object.assign({},r),r.y),e.y),sh(Object.assign(Object.assign({},r),r.z),e.z),sh(Object.assign(Object.assign({},r),r.w),e.w)]})}no({id:"input-point4d",type:"input",accept:(r,e)=>{if(!mg.isObject(r))return null;const n=Ds(e,i=>Object.assign(Object.assign({},Y1(i)),{readonly:i.optional.constant(!1),w:i.optional.custom($u),x:i.optional.custom($u),y:i.optional.custom($u),z:i.optional.custom($u)}));return n?{initialValue:r,params:n}:null},binding:{reader:r=>QTe,constraint:r=>YTe(r.params,r.initialValue),equals:mg.equals,writer:r=>jTe},controller:r=>{const e=r.value,n=r.constraint,i=[r.params.x,r.params.y,r.params.z,r.params.w];return new X4(r.document,{assembly:SQ,axes:e.rawValue.getComponents().map((s,o)=>{var a;return _4({constraint:n.components[o],initialValue:s,params:ap(r.params,(a=i[o])!==null&&a!==void 0?a:{})})}),parser:sd,value:e,viewProps:r.viewProps})}});function qTe(r){const e=[],n=I4(r.options);return n&&e.push(n),new zb(e)}no({id:"input-string",type:"input",accept:(r,e)=>{if(typeof r!="string")return null;const n=Ds(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(A2)}));return n?{initialValue:r,params:n}:null},binding:{reader:r=>ZH,constraint:r=>qTe(r.params),writer:r=>Wb},controller:r=>{const e=r.document,n=r.value,i=r.constraint,s=i&&kS(i,M2);return s?new zg(e,{props:new pn({options:s.values.value("options")}),value:n,viewProps:r.viewProps}):new N4(e,{parser:o=>o,props:pn.fromObject({formatter:qP}),value:n,viewProps:r.viewProps})},api(r){return typeof r.controller.value.rawValue!="string"?null:r.controller.valueController instanceof zg?new R4(r.controller):null}});const P2={monitor:{defaultInterval:200,defaultRows:3}},BU=mn("mll");class ZTe{constructor(e,n){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=e.createElement("div"),this.element.classList.add(BU()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(BU("i")),i.style.height=`calc(var(${JH("containerUnitSize")}) * ${n.rows})`,i.readOnly=!0,n.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}update_(){const e=this.textareaElem_,n=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),n&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class W4{constructor(e,n){this.value=n.value,this.viewProps=n.viewProps,this.view=new ZTe(e,{formatter:n.formatter,rows:n.rows,value:this.value,viewProps:this.viewProps})}}const $U=mn("sgl");class KTe{constructor(e,n){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=n.formatter,this.element=e.createElement("div"),this.element.classList.add($U()),n.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add($U("i")),i.readOnly=!0,i.type="text",n.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}update_(){const e=this.value.rawValue,n=e[e.length-1];this.inputElement.value=n!==void 0?this.formatter_(n):""}onValueUpdate_(){this.update_()}}class G4{constructor(e,n){this.value=n.value,this.viewProps=n.viewProps,this.view=new KTe(e,{formatter:n.formatter,value:this.value,viewProps:this.viewProps})}}no({id:"monitor-bool",type:"monitor",accept:(r,e)=>{if(typeof r!="boolean")return null;const n=Ds(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return n?{initialValue:r,params:n}:null},binding:{reader:r=>qH},controller:r=>{var e;return r.value.rawValue.length===1?new G4(r.document,{formatter:AU,value:r.value,viewProps:r.viewProps}):new W4(r.document,{formatter:AU,rows:(e=r.params.rows)!==null&&e!==void 0?e:P2.monitor.defaultRows,value:r.value,viewProps:r.viewProps})}});class JTe extends S4{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const fu=mn("grl");class eEe{constructor(e,n){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(fu()),n.viewProps.bindClassModifiers(this.element),this.formatter_=n.formatter,this.props_=n.props,this.cursor_=n.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(ic,"svg");i.classList.add(fu("g")),i.style.height=`calc(var(${JH("containerUnitSize")}) * ${n.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(ic,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const o=e.createElement("div");o.classList.add(fu("t"),mn("tt")()),this.element.appendChild(o),this.tooltipElem_=o,n.value.emitter.on("change",this.onValueUpdate_),this.value=n.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:n}=this.element,i=this.value.rawValue.length-1,s=this.props_.get("min"),o=this.props_.get("max"),a=[];this.value.rawValue.forEach((p,m)=>{if(p===void 0)return;const v=xn(m,0,i,0,e),y=xn(p,s,o,n,0);a.push([v,y].join(","))}),this.lineElem_.setAttributeNS(null,"points",a.join(" "));const l=this.tooltipElem_,h=this.value.rawValue[this.cursor_.rawValue];if(h===void 0){l.classList.remove(fu("t","a"));return}const u=xn(this.cursor_.rawValue,0,i,0,e),f=xn(h,s,o,n,0);l.style.left=`${u}px`,l.style.top=`${f}px`,l.textContent=`${this.formatter_(h)}`,l.classList.contains(fu("t","a"))||(l.classList.add(fu("t","a"),fu("t","in")),AS(l),l.classList.remove(fu("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class CQ{constructor(e,n){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=n.props,this.value=n.value,this.viewProps=n.viewProps,this.cursor_=rs(-1),this.view=new eEe(e,{cursor:this.cursor_,formatter:n.formatter,rows:n.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!C4(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Mp(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return xc(e,null,n=>({max:n.required.number,min:n.required.number}),n=>(this.props.set("max",n.max),this.props.set("min",n.min),!0))}exportProps(){return wc(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:n}=this.view.element;this.cursor_.rawValue=Math.floor(xn(e.offsetX,0,n,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(xn(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function ZP(r){return sr(r.format)?Ao(2):r.format}function tEe(r){var e;return r.value.rawValue.length===1?new G4(r.document,{formatter:ZP(r.params),value:r.value,viewProps:r.viewProps}):new W4(r.document,{formatter:ZP(r.params),rows:(e=r.params.rows)!==null&&e!==void 0?e:P2.monitor.defaultRows,value:r.value,viewProps:r.viewProps})}function iEe(r){var e,n,i;return new CQ(r.document,{formatter:ZP(r.params),rows:(e=r.params.rows)!==null&&e!==void 0?e:P2.monitor.defaultRows,props:pn.fromObject({max:(n=r.params.max)!==null&&n!==void 0?n:100,min:(i=r.params.min)!==null&&i!==void 0?i:0}),value:r.value,viewProps:r.viewProps})}function UU(r){return r.view==="graph"}no({id:"monitor-number",type:"monitor",accept:(r,e)=>{if(typeof r!="number")return null;const n=Ds(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return n?{initialValue:r,params:n}:null},binding:{defaultBufferSize:r=>UU(r)?64:1,reader:r=>IH},controller:r=>UU(r.params)?iEe(r):tEe(r),api:r=>r.controller.valueController instanceof CQ?new JTe(r.controller):null});no({id:"monitor-string",type:"monitor",accept:(r,e)=>{if(typeof r!="string")return null;const n=Ds(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return n?{initialValue:r,params:n}:null},binding:{reader:r=>ZH},controller:r=>{var e;const n=r.value;return n.rawValue.length>1||r.params.multiline?new W4(r.document,{formatter:qP,rows:(e=r.params.rows)!==null&&e!==void 0?e:P2.monitor.defaultRows,value:n,viewProps:r.viewProps}):new G4(r.document,{formatter:qP,value:n,viewProps:r.viewProps})}});new GH("4.0.3");const nEe=parseInt(r0.replace(/\D+/g,""));var rEe=Object.defineProperty,sEe=(r,e,n)=>e in r?rEe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,oEe=(r,e,n)=>(sEe(r,e+"",n),n);async function VU(r){const e=await r.arrayBuffer(),n=btoa(String.fromCharCode(...new Uint8Array(e)));return`data:${r.type||""};base64,${n}`}let p_,RM,Om,m_;function IM(r,e=1/0,n=null){RM||(RM=new yd(2,2,1,1)),Om||(Om=new io({uniforms:{blitTexture:new w2(r)},vertexShader:`
        varying vec2 vUv;
        void main(){
            vUv = uv;
            gl_Position = vec4(position.xy * 1.0,0.,.999999);
        }
      `,fragmentShader:`
          uniform sampler2D blitTexture; 
          varying vec2 vUv;

          void main(){ 
              gl_FragColor = vec4(vUv.xy, 0, 1);
              
              #ifdef IS_SRGB
              gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );
              #else
              gl_FragColor = texture2D( blitTexture, vUv);
              #endif
          }
      `})),Om.uniforms.blitTexture.value=r,Om.defines.IS_SRGB="colorSpace"in r?r.colorSpace==="srgb":r.encoding===3001,Om.needsUpdate=!0,m_||(m_=new ln(RM,Om),m_.frustrumCulled=!1);const i=new fn,s=new np;s.add(m_),n||(n=p_=new dg({antialias:!1})),n.setSize(Math.min(r.image.width,e),Math.min(r.image.height,e)),n.clear(),n.render(s,i);const o=new qn(n.domElement);return o.minFilter=r.minFilter,o.magFilter=r.magFilter,o.wrapS=r.wrapS,o.wrapT=r.wrapT,o.name=r.name,p_&&(p_.dispose(),p_=null),o}const FU={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class TQ{constructor(){this.pluginCallbacks=[],this.register(function(e){return new gEe(e)}),this.register(function(e){return new vEe(e)}),this.register(function(e){return new xEe(e)}),this.register(function(e){return new wEe(e)}),this.register(function(e){return new _Ee(e)}),this.register(function(e){return new OEe(e)}),this.register(function(e){return new yEe(e)}),this.register(function(e){return new bEe(e)}),this.register(function(e){return new SEe(e)}),this.register(function(e){return new CEe(e)}),this.register(function(e){return new TEe(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,i,s){const o=new mEe,a=[];for(let l=0,h=this.pluginCallbacks.length;l<h;l++)a.push(this.pluginCallbacks[l](o));o.setPlugins(a),o.write(e,n,s).catch(i)}parseAsync(e,n){const i=this;return new Promise(function(s,o){i.parse(e,s,o,n)})}}oEe(TQ,"Utils",{insertKeyframe:function(r,e){const n=r.getValueSize(),i=new r.TimeBufferType(r.times.length+1),s=new r.ValueBufferType(r.values.length+n),o=r.createInterpolant(new r.ValueBufferType(n));let a;if(r.times.length===0){i[0]=e;for(let l=0;l<n;l++)s[l]=0;a=0}else if(e<r.times[0]){if(Math.abs(r.times[0]-e)<.001)return 0;i[0]=e,i.set(r.times,1),s.set(o.evaluate(e),0),s.set(r.values,n),a=0}else if(e>r.times[r.times.length-1]){if(Math.abs(r.times[r.times.length-1]-e)<.001)return r.times.length-1;i[i.length-1]=e,i.set(r.times,0),s.set(r.values,0),s.set(o.evaluate(e),r.values.length),a=i.length-1}else for(let l=0;l<r.times.length;l++){if(Math.abs(r.times[l]-e)<.001)return l;if(r.times[l]<e&&r.times[l+1]>e){i.set(r.times.slice(0,l+1),0),i[l+1]=e,i.set(r.times.slice(l+1),l+2),s.set(r.values.slice(0,(l+1)*n),0),s.set(o.evaluate(e),(l+1)*n),s.set(r.values.slice((l+1)*n),(l+2)*n),a=l+1;break}}return r.times=i,r.values=s,a},mergeMorphTargetTracks:function(r,e){const n=[],i={},s=r.tracks;for(let o=0;o<s.length;++o){let a=s[o];const l=Ai.parseTrackName(a.name),h=Ai.findNode(e,l.nodeName);if(l.propertyName!=="morphTargetInfluences"||l.propertyIndex===void 0){n.push(a);continue}if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),a=a.clone(),a.setInterpolation(id)}const u=h.morphTargetInfluences.length,f=h.morphTargetDictionary[l.propertyIndex];if(f===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);let p;if(i[h.uuid]===void 0){p=a.clone();const v=new p.ValueBufferType(u*p.times.length);for(let y=0;y<p.times.length;y++)v[y*u+f]=p.values[y];p.name=(l.nodeName||"")+".morphTargetInfluences",p.values=v,i[h.uuid]=p,n.push(p);continue}const m=a.createInterpolant(new a.ValueBufferType(1));p=i[h.uuid];for(let v=0;v<p.times.length;v++)p.values[v*u+f]=m.evaluate(p.times[v]);for(let v=0;v<a.times.length;v++){const y=this.insertKeyframe(p,a.times[v]);p.values[y*u+f]=a.values[v]}}return r.tracks=n,r}});const Ki={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},NM="KHR_mesh_quantization",ea={};ea[Er]=Ki.NEAREST;ea[Eb]=Ki.NEAREST_MIPMAP_NEAREST;ea[Bu]=Ki.NEAREST_MIPMAP_LINEAR;ea[ir]=Ki.LINEAR;ea[Bf]=Ki.LINEAR_MIPMAP_NEAREST;ea[Ko]=Ki.LINEAR_MIPMAP_LINEAR;ea[Ps]=Ki.CLAMP_TO_EDGE;ea[yl]=Ki.REPEAT;ea[ep]=Ki.MIRRORED_REPEAT;const zU={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},aEe=new nt,XU=12,lEe=1179937895,cEe=2,WU=8,hEe=1313821514,uEe=5130562;function Uy(r,e){return r.length===e.length&&r.every(function(n,i){return n===e[i]})}function dEe(r){return new TextEncoder().encode(r).buffer}function fEe(r){return Uy(r.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function pEe(r,e,n){const i={min:new Array(r.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(r.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let s=e;s<e+n;s++)for(let o=0;o<r.itemSize;o++){let a;r.itemSize>4?a=r.array[s*r.itemSize+o]:(o===0?a=r.getX(s):o===1?a=r.getY(s):o===2?a=r.getZ(s):o===3&&(a=r.getW(s)),r.normalized===!0&&(a=fs.normalize(a,r.array))),i.min[o]=Math.min(i.min[o],a),i.max[o]=Math.max(i.max[o],a)}return i}function EQ(r){return Math.ceil(r/4)*4}function DM(r,e=0){const n=EQ(r.byteLength);if(n!==r.byteLength){const i=new Uint8Array(n);if(i.set(new Uint8Array(r)),e!==0)for(let s=r.byteLength;s<n;s++)i[s]=e;return i.buffer}return r}function GU(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function HU(r,e){if(r.toBlob!==void 0)return new Promise(i=>r.toBlob(i,e));let n;return e==="image/jpeg"?n=.92:e==="image/webp"&&(n=.8),r.convertToBlob({type:e,quality:n})}class mEe{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,n,i={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const s=this,o=s.buffers,a=s.json;i=s.options;const l=s.extensionsUsed,h=s.extensionsRequired,u=new Blob(o,{type:"application/octet-stream"}),f=Object.keys(l),p=Object.keys(h);f.length>0&&(a.extensionsUsed=f),p.length>0&&(a.extensionsRequired=p),a.buffers&&a.buffers.length>0&&(a.buffers[0].byteLength=u.size),i.binary===!0?u.arrayBuffer().then(m=>{const v=DM(m),y=new DataView(new ArrayBuffer(WU));y.setUint32(0,v.byteLength,!0),y.setUint32(4,uEe,!0);const x=DM(dEe(JSON.stringify(a)),32),w=new DataView(new ArrayBuffer(WU));w.setUint32(0,x.byteLength,!0),w.setUint32(4,hEe,!0);const S=new ArrayBuffer(XU),O=new DataView(S);O.setUint32(0,lEe,!0),O.setUint32(4,cEe,!0);const _=XU+w.byteLength+x.byteLength+y.byteLength+v.byteLength;O.setUint32(8,_,!0),new Blob([S,w,x,y,v],{type:"application/octet-stream"}).arrayBuffer().then(n)}):a.buffers&&a.buffers.length>0?VU(u).then(m=>{a.buffers[0].uri=m,n(a)}):n(a)}serializeUserData(e,n){if(Object.keys(e.userData).length===0)return;const i=this.options,s=this.extensionsUsed;try{const o=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&o.gltfExtensions){n.extensions===void 0&&(n.extensions={});for(const a in o.gltfExtensions)n.extensions[a]=o.gltfExtensions[a],s[a]=!0;delete o.gltfExtensions}Object.keys(o).length>0&&(n.extras=o)}catch(o){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+o.message)}}getUID(e,n=!1){if(this.uids.has(e)===!1){const i=new Map;i.set(!0,this.uid++),i.set(!1,this.uid++),this.uids.set(e,i)}return this.uids.get(e).get(n)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const n=new le;for(let i=0,s=e.count;i<s;i++)if(Math.abs(n.fromBufferAttribute(e,i).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const n=this.cache;if(n.attributesNormalized.has(e))return n.attributesNormalized.get(e);const i=e.clone(),s=new le;for(let o=0,a=i.count;o<a;o++)s.fromBufferAttribute(i,o),s.x===0&&s.y===0&&s.z===0?s.setX(1):s.normalize(),i.setXYZ(o,s.x,s.y,s.z);return n.attributesNormalized.set(e,i),i}applyTextureTransform(e,n){let i=!1;const s={};(n.offset.x!==0||n.offset.y!==0)&&(s.offset=n.offset.toArray(),i=!0),n.rotation!==0&&(s.rotation=n.rotation,i=!0),(n.repeat.x!==1||n.repeat.y!==1)&&(s.scale=n.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=s,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,n){if(e===n)return e;function i(m){return("colorSpace"in m?m.colorSpace==="srgb":m.encoding===3001)?function(v){return v<.04045?v*.0773993808:Math.pow(v*.9478672986+.0521327014,2.4)}:function(v){return v}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof Vf&&(e=IM(e)),n instanceof Vf&&(n=IM(n));const s=e?e.image:null,o=n?n.image:null,a=Math.max(s?s.width:0,o?o.width:0),l=Math.max(s?s.height:0,o?o.height:0),h=GU();h.width=a,h.height=l;const u=h.getContext("2d");u.fillStyle="#00ffff",u.fillRect(0,0,a,l);const f=u.getImageData(0,0,a,l);if(s){u.drawImage(s,0,0,a,l);const m=i(e),v=u.getImageData(0,0,a,l).data;for(let y=2;y<v.length;y+=4)f.data[y]=m(v[y]/256)*256}if(o){u.drawImage(o,0,0,a,l);const m=i(n),v=u.getImageData(0,0,a,l).data;for(let y=1;y<v.length;y+=4)f.data[y]=m(v[y]/256)*256}u.putImageData(f,0,0);const p=(e||n).clone();return p.source=new qn(h).source,"colorSpace"in p?p.colorSpace="":p.encoding=3e3,p.channel=(e||n).channel,e&&n&&e.channel!==n.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),p}processBuffer(e){const n=this.json,i=this.buffers;return n.buffers||(n.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,n,i,s,o){const a=this.json;a.bufferViews||(a.bufferViews=[]);let l;switch(n){case Ki.BYTE:case Ki.UNSIGNED_BYTE:l=1;break;case Ki.SHORT:case Ki.UNSIGNED_SHORT:l=2;break;default:l=4}const h=EQ(s*e.itemSize*l),u=new DataView(new ArrayBuffer(h));let f=0;for(let m=i;m<i+s;m++)for(let v=0;v<e.itemSize;v++){let y;e.itemSize>4?y=e.array[m*e.itemSize+v]:(v===0?y=e.getX(m):v===1?y=e.getY(m):v===2?y=e.getZ(m):v===3&&(y=e.getW(m)),e.normalized===!0&&(y=fs.normalize(y,e.array))),n===Ki.FLOAT?u.setFloat32(f,y,!0):n===Ki.INT?u.setInt32(f,y,!0):n===Ki.UNSIGNED_INT?u.setUint32(f,y,!0):n===Ki.SHORT?u.setInt16(f,y,!0):n===Ki.UNSIGNED_SHORT?u.setUint16(f,y,!0):n===Ki.BYTE?u.setInt8(f,y):n===Ki.UNSIGNED_BYTE&&u.setUint8(f,y),f+=l}const p={buffer:this.processBuffer(u.buffer),byteOffset:this.byteOffset,byteLength:h};return o!==void 0&&(p.target=o),o===Ki.ARRAY_BUFFER&&(p.byteStride=e.itemSize*l),this.byteOffset+=h,a.bufferViews.push(p),{id:a.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const n=this,i=n.json;return i.bufferViews||(i.bufferViews=[]),e.arrayBuffer().then(s=>{const o=DM(s),a={buffer:n.processBuffer(o),byteOffset:n.byteOffset,byteLength:o.byteLength};return n.byteOffset+=o.byteLength,i.bufferViews.push(a)-1})}processAccessor(e,n,i,s){const o=this.json,a={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let l;if(e.array.constructor===Float32Array)l=Ki.FLOAT;else if(e.array.constructor===Int32Array)l=Ki.INT;else if(e.array.constructor===Uint32Array)l=Ki.UNSIGNED_INT;else if(e.array.constructor===Int16Array)l=Ki.SHORT;else if(e.array.constructor===Uint16Array)l=Ki.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)l=Ki.BYTE;else if(e.array.constructor===Uint8Array)l=Ki.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(i===void 0&&(i=0),s===void 0&&(s=e.count),s===0)return null;const h=pEe(e,i,s);let u;n!==void 0&&(u=e===n.index?Ki.ELEMENT_ARRAY_BUFFER:Ki.ARRAY_BUFFER);const f=this.processBufferView(e,l,i,s,u),p={bufferView:f.id,byteOffset:f.byteOffset,componentType:l,count:s,max:h.max,min:h.min,type:a[e.itemSize]};return e.normalized===!0&&(p.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(p)-1}processImage(e,n,i,s="image/png"){if(e!==null){const o=this,a=o.cache,l=o.json,h=o.options,u=o.pending;a.images.has(e)||a.images.set(e,{});const f=a.images.get(e),p=s+":flipY/"+i.toString();if(f[p]!==void 0)return f[p];l.images||(l.images=[]);const m={mimeType:s},v=GU();v.width=Math.min(e.width,h.maxTextureSize),v.height=Math.min(e.height,h.maxTextureSize);const y=v.getContext("2d");if(i===!0&&(y.translate(0,v.height),y.scale(1,-1)),e.data!==void 0){n!==_o&&console.error("GLTFExporter: Only RGBAFormat is supported.",n),(e.width>h.maxTextureSize||e.height>h.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const w=new Uint8ClampedArray(e.height*e.width*4);for(let S=0;S<w.length;S+=4)w[S+0]=e.data[S+0],w[S+1]=e.data[S+1],w[S+2]=e.data[S+2],w[S+3]=e.data[S+3];y.putImageData(new ImageData(w,e.width,e.height),0,0)}else y.drawImage(e,0,0,v.width,v.height);h.binary===!0?u.push(HU(v,s).then(w=>o.processBufferViewImage(w)).then(w=>{m.bufferView=w})):v.toDataURL!==void 0?m.uri=v.toDataURL(s):u.push(HU(v,s).then(VU).then(w=>{m.uri=w}));const x=l.images.push(m)-1;return f[p]=x,x}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const n=this.json;n.samplers||(n.samplers=[]);const i={magFilter:ea[e.magFilter],minFilter:ea[e.minFilter],wrapS:ea[e.wrapS],wrapT:ea[e.wrapT]};return n.samplers.push(i)-1}processTexture(e){const n=this.options,i=this.cache,s=this.json;if(i.textures.has(e))return i.textures.get(e);s.textures||(s.textures=[]),e instanceof Vf&&(e=IM(e,n.maxTextureSize));let o=e.userData.mimeType;o==="image/webp"&&(o="image/png");const a={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,o)};e.name&&(a.name=e.name),this._invokeAll(function(h){h.writeTexture&&h.writeTexture(e,a)});const l=s.textures.push(a)-1;return i.textures.set(e,l),l}processMaterial(e){const n=this.cache,i=this.json;if(n.materials.has(e))return n.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const s={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const o=e.color.toArray().concat([e.opacity]);if(Uy(o,[1,1,1,1])||(s.pbrMetallicRoughness.baseColorFactor=o),e.isMeshStandardMaterial?(s.pbrMetallicRoughness.metallicFactor=e.metalness,s.pbrMetallicRoughness.roughnessFactor=e.roughness):(s.pbrMetallicRoughness.metallicFactor=.5,s.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const l=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),h={index:this.processTexture(l),channel:l.channel};this.applyTextureTransform(h,l),s.pbrMetallicRoughness.metallicRoughnessTexture=h}if(e.map){const l={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(l,e.map),s.pbrMetallicRoughness.baseColorTexture=l}if(e.emissive){const l=e.emissive;if(Math.max(l.r,l.g,l.b)>0&&(s.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const h={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(h,e.emissiveMap),s.emissiveTexture=h}}if(e.normalMap){const l={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(l.scale=e.normalScale.x),this.applyTextureTransform(l,e.normalMap),s.normalTexture=l}if(e.aoMap){const l={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(l.strength=e.aoMapIntensity),this.applyTextureTransform(l,e.aoMap),s.occlusionTexture=l}e.transparent?s.alphaMode="BLEND":e.alphaTest>0&&(s.alphaMode="MASK",s.alphaCutoff=e.alphaTest),e.side===Qs&&(s.doubleSided=!0),e.name!==""&&(s.name=e.name),this.serializeUserData(e,s),this._invokeAll(function(l){l.writeMaterial&&l.writeMaterial(e,s)});const a=i.materials.push(s)-1;return n.materials.set(e,a),a}processMesh(e){const n=this.cache,i=this.json,s=[e.geometry.uuid];if(Array.isArray(e.material))for(let _=0,T=e.material.length;_<T;_++)s.push(e.material[_].uuid);else s.push(e.material.uuid);const o=s.join(":");if(n.meshes.has(o))return n.meshes.get(o);const a=e.geometry;let l;e.isLineSegments?l=Ki.LINES:e.isLineLoop?l=Ki.LINE_LOOP:e.isLine?l=Ki.LINE_STRIP:e.isPoints?l=Ki.POINTS:l=e.material.wireframe?Ki.LINES:Ki.TRIANGLES;const h={},u={},f=[],p=[],m={...nEe>=152?{uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3"}:{uv:"TEXCOORD_0",uv2:"TEXCOORD_1"},color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},v=a.getAttribute("normal");v!==void 0&&!this.isNormalizedNormalAttribute(v)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",this.createNormalizedNormalAttribute(v)));let y=null;for(let _ in a.attributes){if(_.slice(0,5)==="morph")continue;const T=a.attributes[_];if(_=m[_]||_.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(_)||(_="_"+_),n.attributes.has(this.getUID(T))){u[_]=n.attributes.get(this.getUID(T));continue}y=null;const A=T.array;_==="JOINTS_0"&&!(A instanceof Uint16Array)&&!(A instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),y=new Di(new Uint16Array(A),T.itemSize,T.normalized));const P=this.processAccessor(y||T,a);P!==null&&(_.startsWith("_")||this.detectMeshQuantization(_,T),u[_]=P,n.attributes.set(this.getUID(T),P))}if(v!==void 0&&a.setAttribute("normal",v),Object.keys(u).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const _=[],T=[],A={};if(e.morphTargetDictionary!==void 0)for(const P in e.morphTargetDictionary)A[e.morphTargetDictionary[P]]=P;for(let P=0;P<e.morphTargetInfluences.length;++P){const N={};let k=!1;for(const R in a.morphAttributes){if(R!=="position"&&R!=="normal"){k||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),k=!0);continue}const E=a.morphAttributes[R][P],D=R.toUpperCase(),$=a.attributes[R];if(n.attributes.has(this.getUID(E,!0))){N[D]=n.attributes.get(this.getUID(E,!0));continue}const I=E.clone();if(!a.morphTargetsRelative)for(let L=0,U=E.count;L<U;L++)for(let V=0;V<E.itemSize;V++)V===0&&I.setX(L,E.getX(L)-$.getX(L)),V===1&&I.setY(L,E.getY(L)-$.getY(L)),V===2&&I.setZ(L,E.getZ(L)-$.getZ(L)),V===3&&I.setW(L,E.getW(L)-$.getW(L));N[D]=this.processAccessor(I,a),n.attributes.set(this.getUID($,!0),N[D])}p.push(N),_.push(e.morphTargetInfluences[P]),e.morphTargetDictionary!==void 0&&T.push(A[P])}h.weights=_,T.length>0&&(h.extras={},h.extras.targetNames=T)}const x=Array.isArray(e.material);if(x&&a.groups.length===0)return null;const w=x?e.material:[e.material],S=x?a.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let _=0,T=S.length;_<T;_++){const A={mode:l,attributes:u};if(this.serializeUserData(a,A),p.length>0&&(A.targets=p),a.index!==null){let N=this.getUID(a.index);(S[_].start!==void 0||S[_].count!==void 0)&&(N+=":"+S[_].start+":"+S[_].count),n.attributes.has(N)?A.indices=n.attributes.get(N):(A.indices=this.processAccessor(a.index,a,S[_].start,S[_].count),n.attributes.set(N,A.indices)),A.indices===null&&delete A.indices}const P=this.processMaterial(w[S[_].materialIndex]);P!==null&&(A.material=P),f.push(A)}h.primitives=f,i.meshes||(i.meshes=[]),this._invokeAll(function(_){_.writeMesh&&_.writeMesh(e,h)});const O=i.meshes.push(h)-1;return n.meshes.set(o,O),O}detectMeshQuantization(e,n){if(this.extensionsUsed[NM])return;let i;switch(n.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}n.normalized&&(i+=" normalized");const s=e.split("_",1)[0];FU[s]&&FU[s].includes(i)&&(this.extensionsUsed[NM]=!0,this.extensionsRequired[NM]=!0)}processCamera(e){const n=this.json;n.cameras||(n.cameras=[]);const i=e.isOrthographicCamera,s={type:i?"orthographic":"perspective"};return i?s.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:s.perspective={aspectRatio:e.aspect,yfov:fs.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(s.name=e.type),n.cameras.push(s)-1}processAnimation(e,n){const i=this.json,s=this.nodeMap;i.animations||(i.animations=[]),e=TQ.Utils.mergeMorphTargetTracks(e.clone(),n);const o=e.tracks,a=[],l=[];for(let h=0;h<o.length;++h){const u=o[h],f=Ai.parseTrackName(u.name);let p=Ai.findNode(n,f.nodeName);const m=zU[f.propertyName];if(f.objectName==="bones"&&(p.isSkinnedMesh===!0?p=p.skeleton.getBoneByName(f.objectIndex):p=void 0),!p||!m)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',u.name),null;const v=1;let y=u.values.length/u.times.length;m===zU.morphTargetInfluences&&(y/=p.morphTargetInfluences.length);let x;u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(x="CUBICSPLINE",y/=3):u.getInterpolation()===ip?x="STEP":x="LINEAR",l.push({input:this.processAccessor(new Di(u.times,v)),output:this.processAccessor(new Di(u.values,y)),interpolation:x}),a.push({sampler:l.length-1,target:{node:s.get(p),path:m}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:l,channels:a}),i.animations.length-1}processSkin(e){const n=this.json,i=this.nodeMap,s=n.nodes[i.get(e)],o=e.skeleton;if(o===void 0)return null;const a=e.skeleton.bones[0];if(a===void 0)return null;const l=[],h=new Float32Array(o.bones.length*16),u=new dt;for(let f=0;f<o.bones.length;++f)l.push(i.get(o.bones[f])),u.copy(o.boneInverses[f]),u.multiply(e.bindMatrix).toArray(h,f*16);return n.skins===void 0&&(n.skins=[]),n.skins.push({inverseBindMatrices:this.processAccessor(new Di(h,16)),joints:l,skeleton:i.get(a)}),s.skin=n.skins.length-1}processNode(e){const n=this.json,i=this.options,s=this.nodeMap;n.nodes||(n.nodes=[]);const o={};if(i.trs){const l=e.quaternion.toArray(),h=e.position.toArray(),u=e.scale.toArray();Uy(l,[0,0,0,1])||(o.rotation=l),Uy(h,[0,0,0])||(o.translation=h),Uy(u,[1,1,1])||(o.scale=u)}else e.matrixAutoUpdate&&e.updateMatrix(),fEe(e.matrix)===!1&&(o.matrix=e.matrix.elements);if(e.name!==""&&(o.name=String(e.name)),this.serializeUserData(e,o),e.isMesh||e.isLine||e.isPoints){const l=this.processMesh(e);l!==null&&(o.mesh=l)}else e.isCamera&&(o.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const l=[];for(let h=0,u=e.children.length;h<u;h++){const f=e.children[h];if(f.visible||i.onlyVisible===!1){const p=this.processNode(f);p!==null&&l.push(p)}}l.length>0&&(o.children=l)}this._invokeAll(function(l){l.writeNode&&l.writeNode(e,o)});const a=n.nodes.push(o)-1;return s.set(e,a),a}processScene(e){const n=this.json,i=this.options;n.scenes||(n.scenes=[],n.scene=0);const s={};e.name!==""&&(s.name=e.name),n.scenes.push(s);const o=[];for(let a=0,l=e.children.length;a<l;a++){const h=e.children[a];if(h.visible||i.onlyVisible===!1){const u=this.processNode(h);u!==null&&o.push(u)}}o.length>0&&(s.nodes=o),this.serializeUserData(e,s)}processObjects(e){const n=new np;n.name="AuxScene";for(let i=0;i<e.length;i++)n.children.push(e[i]);this.processScene(n)}processInput(e){const n=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(s){s.beforeParse&&s.beforeParse(e)});const i=[];for(let s=0;s<e.length;s++)e[s]instanceof np?this.processScene(e[s]):i.push(e[s]);i.length>0&&this.processObjects(i);for(let s=0;s<this.skins.length;++s)this.processSkin(this.skins[s]);for(let s=0;s<n.animations.length;++s)this.processAnimation(n.animations[s],e[0]);this._invokeAll(function(s){s.afterParse&&s.afterParse(e)})}_invokeAll(e){for(let n=0,i=this.plugins.length;n<i;n++)e(this.plugins[n])}}class gEe{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,n){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const i=this.writer,s=i.json,o=i.extensionsUsed,a={};e.name&&(a.name=e.name),a.color=e.color.toArray(),a.intensity=e.intensity,e.isDirectionalLight?a.type="directional":e.isPointLight?(a.type="point",e.distance>0&&(a.range=e.distance)):e.isSpotLight&&(a.type="spot",e.distance>0&&(a.range=e.distance),a.spot={},a.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,a.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),o[this.name]||(s.extensions=s.extensions||{},s.extensions[this.name]={lights:[]},o[this.name]=!0);const l=s.extensions[this.name].lights;l.push(a),n.extensions=n.extensions||{},n.extensions[this.name]={light:l.length-1}}}let vEe=class{constructor(r){this.writer=r,this.name="KHR_materials_unlit"}writeMaterial(r,e){if(!r.isMeshBasicMaterial)return;const n=this.writer.extensionsUsed;e.extensions=e.extensions||{},e.extensions[this.name]={},n[this.name]=!0,e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9}},yEe=class{constructor(r){this.writer=r,this.name="KHR_materials_clearcoat"}writeMaterial(r,e){if(!r.isMeshPhysicalMaterial||r.clearcoat===0)return;const n=this.writer,i=n.extensionsUsed,s={};if(s.clearcoatFactor=r.clearcoat,r.clearcoatMap){const o={index:n.processTexture(r.clearcoatMap),texCoord:r.clearcoatMap.channel};n.applyTextureTransform(o,r.clearcoatMap),s.clearcoatTexture=o}if(s.clearcoatRoughnessFactor=r.clearcoatRoughness,r.clearcoatRoughnessMap){const o={index:n.processTexture(r.clearcoatRoughnessMap),texCoord:r.clearcoatRoughnessMap.channel};n.applyTextureTransform(o,r.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=o}if(r.clearcoatNormalMap){const o={index:n.processTexture(r.clearcoatNormalMap),texCoord:r.clearcoatNormalMap.channel};n.applyTextureTransform(o,r.clearcoatNormalMap),s.clearcoatNormalTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}},bEe=class{constructor(r){this.writer=r,this.name="KHR_materials_iridescence"}writeMaterial(r,e){if(!r.isMeshPhysicalMaterial||r.iridescence===0)return;const n=this.writer,i=n.extensionsUsed,s={};if(s.iridescenceFactor=r.iridescence,r.iridescenceMap){const o={index:n.processTexture(r.iridescenceMap),texCoord:r.iridescenceMap.channel};n.applyTextureTransform(o,r.iridescenceMap),s.iridescenceTexture=o}if(s.iridescenceIor=r.iridescenceIOR,s.iridescenceThicknessMinimum=r.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=r.iridescenceThicknessRange[1],r.iridescenceThicknessMap){const o={index:n.processTexture(r.iridescenceThicknessMap),texCoord:r.iridescenceThicknessMap.channel};n.applyTextureTransform(o,r.iridescenceThicknessMap),s.iridescenceThicknessTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}},xEe=class{constructor(r){this.writer=r,this.name="KHR_materials_transmission"}writeMaterial(r,e){if(!r.isMeshPhysicalMaterial||r.transmission===0)return;const n=this.writer,i=n.extensionsUsed,s={};if(s.transmissionFactor=r.transmission,r.transmissionMap){const o={index:n.processTexture(r.transmissionMap),texCoord:r.transmissionMap.channel};n.applyTextureTransform(o,r.transmissionMap),s.transmissionTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}},wEe=class{constructor(r){this.writer=r,this.name="KHR_materials_volume"}writeMaterial(r,e){if(!r.isMeshPhysicalMaterial||r.transmission===0)return;const n=this.writer,i=n.extensionsUsed,s={};if(s.thicknessFactor=r.thickness,r.thicknessMap){const o={index:n.processTexture(r.thicknessMap),texCoord:r.thicknessMap.channel};n.applyTextureTransform(o,r.thicknessMap),s.thicknessTexture=o}s.attenuationDistance=r.attenuationDistance,s.attenuationColor=r.attenuationColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}},_Ee=class{constructor(r){this.writer=r,this.name="KHR_materials_ior"}writeMaterial(r,e){if(!r.isMeshPhysicalMaterial||r.ior===1.5)return;const n=this.writer.extensionsUsed,i={};i.ior=r.ior,e.extensions=e.extensions||{},e.extensions[this.name]=i,n[this.name]=!0}},OEe=class{constructor(r){this.writer=r,this.name="KHR_materials_specular"}writeMaterial(r,e){if(!r.isMeshPhysicalMaterial||r.specularIntensity===1&&r.specularColor.equals(aEe)&&!r.specularIntensityMap&&!r.specularColorTexture)return;const n=this.writer,i=n.extensionsUsed,s={};if(r.specularIntensityMap){const o={index:n.processTexture(r.specularIntensityMap),texCoord:r.specularIntensityMap.channel};n.applyTextureTransform(o,r.specularIntensityMap),s.specularTexture=o}if(r.specularColorMap){const o={index:n.processTexture(r.specularColorMap),texCoord:r.specularColorMap.channel};n.applyTextureTransform(o,r.specularColorMap),s.specularColorTexture=o}s.specularFactor=r.specularIntensity,s.specularColorFactor=r.specularColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}},SEe=class{constructor(r){this.writer=r,this.name="KHR_materials_sheen"}writeMaterial(r,e){if(!r.isMeshPhysicalMaterial||r.sheen==0)return;const n=this.writer,i=n.extensionsUsed,s={};if(r.sheenRoughnessMap){const o={index:n.processTexture(r.sheenRoughnessMap),texCoord:r.sheenRoughnessMap.channel};n.applyTextureTransform(o,r.sheenRoughnessMap),s.sheenRoughnessTexture=o}if(r.sheenColorMap){const o={index:n.processTexture(r.sheenColorMap),texCoord:r.sheenColorMap.channel};n.applyTextureTransform(o,r.sheenColorMap),s.sheenColorTexture=o}s.sheenRoughnessFactor=r.sheenRoughness,s.sheenColorFactor=r.sheenColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}},CEe=class{constructor(r){this.writer=r,this.name="KHR_materials_anisotropy"}writeMaterial(r,e){if(!r.isMeshPhysicalMaterial||r.anisotropy==0)return;const n=this.writer,i=n.extensionsUsed,s={};if(r.anisotropyMap){const o={index:n.processTexture(r.anisotropyMap)};n.applyTextureTransform(o,r.anisotropyMap),s.anisotropyTexture=o}s.anisotropyStrength=r.anisotropy,s.anisotropyRotation=r.anisotropyRotation,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}},TEe=class{constructor(r){this.writer=r,this.name="KHR_materials_emissive_strength"}writeMaterial(r,e){if(!r.isMeshStandardMaterial||r.emissiveIntensity===1)return;const n=this.writer.extensionsUsed,i={};i.emissiveStrength=r.emissiveIntensity,e.extensions=e.extensions||{},e.extensions[this.name]=i,n[this.name]=!0}};var Sa=Uint8Array,zf=Uint16Array,KP=Uint32Array,MQ=new Sa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),AQ=new Sa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),EEe=new Sa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kQ=function(r,e){for(var n=new zf(31),i=0;i<31;++i)n[i]=e+=1<<r[i-1];for(var s=new KP(n[30]),i=1;i<30;++i)for(var o=n[i];o<n[i+1];++o)s[o]=o-n[i]<<5|i;return[n,s]},PQ=kQ(MQ,2),RQ=PQ[0],MEe=PQ[1];RQ[28]=258,MEe[258]=28;var AEe=kQ(AQ,0),kEe=AEe[0],IQ=new zf(32768);for(var $n=0;$n<32768;++$n){var pu=($n&43690)>>>1|($n&21845)<<1;pu=(pu&52428)>>>2|(pu&13107)<<2,pu=(pu&61680)>>>4|(pu&3855)<<4,IQ[$n]=((pu&65280)>>>8|(pu&255)<<8)>>>1}var c1=function(r,e,n){for(var i=r.length,s=0,o=new zf(e);s<i;++s)++o[r[s]-1];var a=new zf(e);for(s=0;s<e;++s)a[s]=a[s-1]+o[s-1]<<1;var l;{l=new zf(1<<e);var h=15-e;for(s=0;s<i;++s)if(r[s])for(var u=s<<4|r[s],f=e-r[s],p=a[r[s]-1]++<<f,m=p|(1<<f)-1;p<=m;++p)l[IQ[p]>>>h]=u}return l},Hb=new Sa(288);for(var $n=0;$n<144;++$n)Hb[$n]=8;for(var $n=144;$n<256;++$n)Hb[$n]=9;for(var $n=256;$n<280;++$n)Hb[$n]=7;for(var $n=280;$n<288;++$n)Hb[$n]=8;var NQ=new Sa(32);for(var $n=0;$n<32;++$n)NQ[$n]=5;var PEe=c1(Hb,9),REe=c1(NQ,5),LM=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},il=function(r,e,n){var i=e/8|0;return(r[i]|r[i+1]<<8)>>(e&7)&n},BM=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},IEe=function(r){return(r/8|0)+(r&7&&1)},NEe=function(r,e,n){(n==null||n>r.length)&&(n=r.length);var i=new(r instanceof zf?zf:r instanceof KP?KP:Sa)(n-e);return i.set(r.subarray(e,n)),i},DEe=function(r,e,n){var i=r.length;if(!i||n&&!n.l&&i<5)return e||new Sa(0);var s=!e||n,o=!n||n.i;n||(n={}),e||(e=new Sa(i*3));var a=function(be){var se=e.length;if(be>se){var ae=new Sa(Math.max(se*2,be));ae.set(e),e=ae}},l=n.f||0,h=n.p||0,u=n.b||0,f=n.l,p=n.d,m=n.m,v=n.n,y=i*8;do{if(!f){n.f=l=il(r,h,1);var x=il(r,h+1,3);if(h+=3,x)if(x==1)f=PEe,p=REe,m=9,v=5;else if(x==2){var w=il(r,h,31)+257,S=il(r,h+10,15)+4,O=w+il(r,h+5,31)+1;h+=14;for(var _=new Sa(O),T=new Sa(19),A=0;A<S;++A)T[EEe[A]]=il(r,h+A*3,7);h+=S*3;for(var P=LM(T),N=(1<<P)-1,k=c1(T,P),A=0;A<O;){var R=k[il(r,h,N)];h+=R&15;var E=R>>>4;if(E<16)_[A++]=E;else{var D=0,$=0;for(E==16?($=3+il(r,h,3),h+=2,D=_[A-1]):E==17?($=3+il(r,h,7),h+=3):E==18&&($=11+il(r,h,127),h+=7);$--;)_[A++]=D}}var I=_.subarray(0,w),L=_.subarray(w);m=LM(I),v=LM(L),f=c1(I,m),p=c1(L,v)}else throw"invalid block type";else{var E=IEe(h)+4,U=r[E-4]|r[E-3]<<8,V=E+U;if(V>i){if(o)throw"unexpected EOF";break}s&&a(u+U),e.set(r.subarray(E,V),u),n.b=u+=U,n.p=h=V*8;continue}if(h>y){if(o)throw"unexpected EOF";break}}s&&a(u+131072);for(var X=(1<<m)-1,H=(1<<v)-1,J=h;;J=h){var D=f[BM(r,h)&X],ee=D>>>4;if(h+=D&15,h>y){if(o)throw"unexpected EOF";break}if(!D)throw"invalid length/literal";if(ee<256)e[u++]=ee;else if(ee==256){J=h,f=null;break}else{var ne=ee-254;if(ee>264){var A=ee-257,ge=MQ[A];ne=il(r,h,(1<<ge)-1)+RQ[A],h+=ge}var ye=p[BM(r,h)&H],ce=ye>>>4;if(!ye)throw"invalid distance";h+=ye&15;var L=kEe[ce];if(ce>3){var ge=AQ[ce];L+=BM(r,h)&(1<<ge)-1,h+=ge}if(h>y){if(o)throw"unexpected EOF";break}s&&a(u+131072);for(var we=u+ne;u<we;u+=4)e[u]=e[u-L],e[u+1]=e[u+1-L],e[u+2]=e[u+2-L],e[u+3]=e[u+3-L];u=we}}n.l=f,n.p=J,n.b=u,f&&(l=1,n.m=m,n.d=p,n.n=v)}while(!l);return u==e.length?e:NEe(e,0,u)},LEe=new Sa(0),BEe=function(r){if((r[0]&15)!=8||r[0]>>>4>7||(r[0]<<8|r[1])%31)throw"invalid zlib data";if(r[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function $Ee(r,e){return DEe((BEe(r),r.subarray(2,-4)),e)}var UEe=typeof TextDecoder<"u"&&new TextDecoder,VEe=0;try{UEe.decode(LEe,{stream:!0}),VEe=1}catch{}new bo;new le;new Vr(0,0,0,"YXZ");new le;var FEe=Object.defineProperty,zEe=(r,e,n)=>e in r?FEe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,gi=(r,e,n)=>(zEe(r,typeof e!="symbol"?e+"":e,n),n);const g_=new Sp,QU=new wa,XEe=Math.cos(70*(Math.PI/180)),jU=(r,e)=>(r%e+e)%e;class WEe extends bc{constructor(e,n){super(),gi(this,"object"),gi(this,"domElement"),gi(this,"enabled",!0),gi(this,"target",new le),gi(this,"minDistance",0),gi(this,"maxDistance",1/0),gi(this,"minZoom",0),gi(this,"maxZoom",1/0),gi(this,"minPolarAngle",0),gi(this,"maxPolarAngle",Math.PI),gi(this,"minAzimuthAngle",-1/0),gi(this,"maxAzimuthAngle",1/0),gi(this,"enableDamping",!1),gi(this,"dampingFactor",.05),gi(this,"enableZoom",!0),gi(this,"zoomSpeed",1),gi(this,"enableRotate",!0),gi(this,"rotateSpeed",1),gi(this,"enablePan",!0),gi(this,"panSpeed",1),gi(this,"screenSpacePanning",!0),gi(this,"keyPanSpeed",7),gi(this,"zoomToCursor",!1),gi(this,"autoRotate",!1),gi(this,"autoRotateSpeed",2),gi(this,"reverseOrbit",!1),gi(this,"reverseHorizontalOrbit",!1),gi(this,"reverseVerticalOrbit",!1),gi(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),gi(this,"mouseButtons",{LEFT:cf.ROTATE,MIDDLE:cf.DOLLY,RIGHT:cf.PAN}),gi(this,"touches",{ONE:Jc.ROTATE,TWO:Jc.DOLLY_PAN}),gi(this,"target0"),gi(this,"position0"),gi(this,"zoom0"),gi(this,"_domElementKeyEvents",null),gi(this,"getPolarAngle"),gi(this,"getAzimuthalAngle"),gi(this,"setPolarAngle"),gi(this,"setAzimuthalAngle"),gi(this,"getDistance"),gi(this,"listenToKeyEvents"),gi(this,"stopListenToKeyEvents"),gi(this,"saveState"),gi(this,"reset"),gi(this,"update"),gi(this,"connect"),gi(this,"dispose"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>f.phi,this.getAzimuthalAngle=()=>f.theta,this.setPolarAngle=Me=>{let Ve=jU(Me,2*Math.PI),xe=f.phi;xe<0&&(xe+=2*Math.PI),Ve<0&&(Ve+=2*Math.PI);let Fe=Math.abs(Ve-xe);2*Math.PI-Fe<Fe&&(Ve<xe?Ve+=2*Math.PI:xe+=2*Math.PI),p.phi=Ve-xe,i.update()},this.setAzimuthalAngle=Me=>{let Ve=jU(Me,2*Math.PI),xe=f.theta;xe<0&&(xe+=2*Math.PI),Ve<0&&(Ve+=2*Math.PI);let Fe=Math.abs(Ve-xe);2*Math.PI-Fe<Fe&&(Ve<xe?Ve+=2*Math.PI:xe+=2*Math.PI),p.theta=Ve-xe,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=Me=>{Me.addEventListener("keydown",ct),this._domElementKeyEvents=Me},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ct),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(s),i.update(),h=l.NONE},this.update=(()=>{const Me=new le,Ve=new le(0,1,0),xe=new ur().setFromUnitVectors(e.up,Ve),Fe=xe.clone().invert(),Ge=new le,at=new ur,vt=2*Math.PI;return function(){const Vi=i.object.position;xe.setFromUnitVectors(e.up,Ve),Fe.copy(xe).invert(),Me.copy(Vi).sub(i.target),Me.applyQuaternion(xe),f.setFromVector3(Me),i.autoRotate&&h===l.NONE&&L($()),i.enableDamping?(f.theta+=p.theta*i.dampingFactor,f.phi+=p.phi*i.dampingFactor):(f.theta+=p.theta,f.phi+=p.phi);let Fi=i.minAzimuthAngle,en=i.maxAzimuthAngle;isFinite(Fi)&&isFinite(en)&&(Fi<-Math.PI?Fi+=vt:Fi>Math.PI&&(Fi-=vt),en<-Math.PI?en+=vt:en>Math.PI&&(en-=vt),Fi<=en?f.theta=Math.max(Fi,Math.min(en,f.theta)):f.theta=f.theta>(Fi+en)/2?Math.max(Fi,f.theta):Math.min(en,f.theta)),f.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,f.phi)),f.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(v,i.dampingFactor):i.target.add(v),i.zoomToCursor&&R||i.object.isOrthographicCamera?f.radius=ge(f.radius):f.radius=ge(f.radius*m),Me.setFromSpherical(f),Me.applyQuaternion(Fe),Vi.copy(i.target).add(Me),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(p.theta*=1-i.dampingFactor,p.phi*=1-i.dampingFactor,v.multiplyScalar(1-i.dampingFactor)):(p.set(0,0,0),v.set(0,0,0));let Wn=!1;if(i.zoomToCursor&&R){let Ii=null;if(i.object instanceof fn&&i.object.isPerspectiveCamera){const Hr=Me.length();Ii=ge(Hr*m);const Kn=Hr-Ii;i.object.position.addScaledVector(N,Kn),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Hr=new le(k.x,k.y,0);Hr.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix(),Wn=!0;const Kn=new le(k.x,k.y,0);Kn.unproject(i.object),i.object.position.sub(Kn).add(Hr),i.object.updateMatrixWorld(),Ii=Me.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;Ii!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(Ii).add(i.object.position):(g_.origin.copy(i.object.position),g_.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(g_.direction))<XEe?e.lookAt(i.target):(QU.setFromNormalAndCoplanarPoint(i.object.up,i.target),g_.intersectPlane(QU,i.target))))}else i.object instanceof Jo&&i.object.isOrthographicCamera&&(Wn=m!==1,Wn&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix()));return m=1,R=!1,Wn||Ge.distanceToSquared(i.object.position)>u||8*(1-at.dot(i.object.quaternion))>u?(i.dispatchEvent(s),Ge.copy(i.object.position),at.copy(i.object.quaternion),Wn=!1,!0):!1}})(),this.connect=Me=>{Me===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),i.domElement=Me,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",Lt),i.domElement.addEventListener("pointerdown",me),i.domElement.addEventListener("pointercancel",ke),i.domElement.addEventListener("wheel",We,{passive:!0})},this.dispose=()=>{var Me,Ve,xe,Fe,Ge,at;i.domElement&&(i.domElement.style.touchAction="auto"),(Me=i.domElement)==null||Me.removeEventListener("contextmenu",Lt),(Ve=i.domElement)==null||Ve.removeEventListener("pointerdown",me),(xe=i.domElement)==null||xe.removeEventListener("pointercancel",ke),(Fe=i.domElement)==null||Fe.removeEventListener("wheel",We),(Ge=i.domElement)==null||Ge.ownerDocument.removeEventListener("pointermove",ve),(at=i.domElement)==null||at.ownerDocument.removeEventListener("pointerup",Te),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",ct)};const i=this,s={type:"change"},o={type:"start"},a={type:"end"},l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let h=l.NONE;const u=1e-6,f=new FP,p=new FP;let m=1;const v=new le,y=new Xe,x=new Xe,w=new Xe,S=new Xe,O=new Xe,_=new Xe,T=new Xe,A=new Xe,P=new Xe,N=new le,k=new Xe;let R=!1;const E=[],D={};function $(){return 2*Math.PI/60/60*i.autoRotateSpeed}function I(){return Math.pow(.95,i.zoomSpeed)}function L(Me){i.reverseOrbit||i.reverseHorizontalOrbit?p.theta+=Me:p.theta-=Me}function U(Me){i.reverseOrbit||i.reverseVerticalOrbit?p.phi+=Me:p.phi-=Me}const V=(()=>{const Me=new le;return function(Ve,xe){Me.setFromMatrixColumn(xe,0),Me.multiplyScalar(-Ve),v.add(Me)}})(),X=(()=>{const Me=new le;return function(Ve,xe){i.screenSpacePanning===!0?Me.setFromMatrixColumn(xe,1):(Me.setFromMatrixColumn(xe,0),Me.crossVectors(i.object.up,Me)),Me.multiplyScalar(Ve),v.add(Me)}})(),H=(()=>{const Me=new le;return function(Ve,xe){const Fe=i.domElement;if(Fe&&i.object instanceof fn&&i.object.isPerspectiveCamera){const Ge=i.object.position;Me.copy(Ge).sub(i.target);let at=Me.length();at*=Math.tan(i.object.fov/2*Math.PI/180),V(2*Ve*at/Fe.clientHeight,i.object.matrix),X(2*xe*at/Fe.clientHeight,i.object.matrix)}else Fe&&i.object instanceof Jo&&i.object.isOrthographicCamera?(V(Ve*(i.object.right-i.object.left)/i.object.zoom/Fe.clientWidth,i.object.matrix),X(xe*(i.object.top-i.object.bottom)/i.object.zoom/Fe.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function J(Me){i.object instanceof fn&&i.object.isPerspectiveCamera||i.object instanceof Jo&&i.object.isOrthographicCamera?m/=Me:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ee(Me){i.object instanceof fn&&i.object.isPerspectiveCamera||i.object instanceof Jo&&i.object.isOrthographicCamera?m*=Me:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ne(Me){if(!i.zoomToCursor||!i.domElement)return;R=!0;const Ve=i.domElement.getBoundingClientRect(),xe=Me.clientX-Ve.left,Fe=Me.clientY-Ve.top,Ge=Ve.width,at=Ve.height;k.x=xe/Ge*2-1,k.y=-(Fe/at)*2+1,N.set(k.x,k.y,1).unproject(i.object).sub(i.object.position).normalize()}function ge(Me){return Math.max(i.minDistance,Math.min(i.maxDistance,Me))}function ye(Me){y.set(Me.clientX,Me.clientY)}function ce(Me){ne(Me),T.set(Me.clientX,Me.clientY)}function we(Me){S.set(Me.clientX,Me.clientY)}function be(Me){x.set(Me.clientX,Me.clientY),w.subVectors(x,y).multiplyScalar(i.rotateSpeed);const Ve=i.domElement;Ve&&(L(2*Math.PI*w.x/Ve.clientHeight),U(2*Math.PI*w.y/Ve.clientHeight)),y.copy(x),i.update()}function se(Me){A.set(Me.clientX,Me.clientY),P.subVectors(A,T),P.y>0?J(I()):P.y<0&&ee(I()),T.copy(A),i.update()}function ae(Me){O.set(Me.clientX,Me.clientY),_.subVectors(O,S).multiplyScalar(i.panSpeed),H(_.x,_.y),S.copy(O),i.update()}function Q(Me){ne(Me),Me.deltaY<0?ee(I()):Me.deltaY>0&&J(I()),i.update()}function z(Me){let Ve=!1;switch(Me.code){case i.keys.UP:H(0,i.keyPanSpeed),Ve=!0;break;case i.keys.BOTTOM:H(0,-i.keyPanSpeed),Ve=!0;break;case i.keys.LEFT:H(i.keyPanSpeed,0),Ve=!0;break;case i.keys.RIGHT:H(-i.keyPanSpeed,0),Ve=!0;break}Ve&&(Me.preventDefault(),i.update())}function j(){if(E.length==1)y.set(E[0].pageX,E[0].pageY);else{const Me=.5*(E[0].pageX+E[1].pageX),Ve=.5*(E[0].pageY+E[1].pageY);y.set(Me,Ve)}}function te(){if(E.length==1)S.set(E[0].pageX,E[0].pageY);else{const Me=.5*(E[0].pageX+E[1].pageX),Ve=.5*(E[0].pageY+E[1].pageY);S.set(Me,Ve)}}function W(){const Me=E[0].pageX-E[1].pageX,Ve=E[0].pageY-E[1].pageY,xe=Math.sqrt(Me*Me+Ve*Ve);T.set(0,xe)}function Z(){i.enableZoom&&W(),i.enablePan&&te()}function he(){i.enableZoom&&W(),i.enableRotate&&j()}function pe(Me){if(E.length==1)x.set(Me.pageX,Me.pageY);else{const xe=wi(Me),Fe=.5*(Me.pageX+xe.x),Ge=.5*(Me.pageY+xe.y);x.set(Fe,Ge)}w.subVectors(x,y).multiplyScalar(i.rotateSpeed);const Ve=i.domElement;Ve&&(L(2*Math.PI*w.x/Ve.clientHeight),U(2*Math.PI*w.y/Ve.clientHeight)),y.copy(x)}function _e(Me){if(E.length==1)O.set(Me.pageX,Me.pageY);else{const Ve=wi(Me),xe=.5*(Me.pageX+Ve.x),Fe=.5*(Me.pageY+Ve.y);O.set(xe,Fe)}_.subVectors(O,S).multiplyScalar(i.panSpeed),H(_.x,_.y),S.copy(O)}function Re(Me){const Ve=wi(Me),xe=Me.pageX-Ve.x,Fe=Me.pageY-Ve.y,Ge=Math.sqrt(xe*xe+Fe*Fe);A.set(0,Ge),P.set(0,Math.pow(A.y/T.y,i.zoomSpeed)),J(P.y),T.copy(A)}function ie(Me){i.enableZoom&&Re(Me),i.enablePan&&_e(Me)}function q(Me){i.enableZoom&&Re(Me),i.enableRotate&&pe(Me)}function me(Me){var Ve,xe;i.enabled!==!1&&(E.length===0&&((Ve=i.domElement)==null||Ve.ownerDocument.addEventListener("pointermove",ve),(xe=i.domElement)==null||xe.ownerDocument.addEventListener("pointerup",Te)),Bt(Me),Me.pointerType==="touch"?Ye(Me):He(Me))}function ve(Me){i.enabled!==!1&&(Me.pointerType==="touch"?lt(Me):Ue(Me))}function Te(Me){var Ve,xe,Fe;gt(Me),E.length===0&&((Ve=i.domElement)==null||Ve.releasePointerCapture(Me.pointerId),(xe=i.domElement)==null||xe.ownerDocument.removeEventListener("pointermove",ve),(Fe=i.domElement)==null||Fe.ownerDocument.removeEventListener("pointerup",Te)),i.dispatchEvent(a),h=l.NONE}function ke(Me){gt(Me)}function He(Me){let Ve;switch(Me.button){case 0:Ve=i.mouseButtons.LEFT;break;case 1:Ve=i.mouseButtons.MIDDLE;break;case 2:Ve=i.mouseButtons.RIGHT;break;default:Ve=-1}switch(Ve){case cf.DOLLY:if(i.enableZoom===!1)return;ce(Me),h=l.DOLLY;break;case cf.ROTATE:if(Me.ctrlKey||Me.metaKey||Me.shiftKey){if(i.enablePan===!1)return;we(Me),h=l.PAN}else{if(i.enableRotate===!1)return;ye(Me),h=l.ROTATE}break;case cf.PAN:if(Me.ctrlKey||Me.metaKey||Me.shiftKey){if(i.enableRotate===!1)return;ye(Me),h=l.ROTATE}else{if(i.enablePan===!1)return;we(Me),h=l.PAN}break;default:h=l.NONE}h!==l.NONE&&i.dispatchEvent(o)}function Ue(Me){if(i.enabled!==!1)switch(h){case l.ROTATE:if(i.enableRotate===!1)return;be(Me);break;case l.DOLLY:if(i.enableZoom===!1)return;se(Me);break;case l.PAN:if(i.enablePan===!1)return;ae(Me);break}}function We(Me){i.enabled===!1||i.enableZoom===!1||h!==l.NONE&&h!==l.ROTATE||(i.dispatchEvent(o),Q(Me),i.dispatchEvent(a))}function ct(Me){i.enabled===!1||i.enablePan===!1||z(Me)}function Ye(Me){switch(ei(Me),E.length){case 1:switch(i.touches.ONE){case Jc.ROTATE:if(i.enableRotate===!1)return;j(),h=l.TOUCH_ROTATE;break;case Jc.PAN:if(i.enablePan===!1)return;te(),h=l.TOUCH_PAN;break;default:h=l.NONE}break;case 2:switch(i.touches.TWO){case Jc.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Z(),h=l.TOUCH_DOLLY_PAN;break;case Jc.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;he(),h=l.TOUCH_DOLLY_ROTATE;break;default:h=l.NONE}break;default:h=l.NONE}h!==l.NONE&&i.dispatchEvent(o)}function lt(Me){switch(ei(Me),h){case l.TOUCH_ROTATE:if(i.enableRotate===!1)return;pe(Me),i.update();break;case l.TOUCH_PAN:if(i.enablePan===!1)return;_e(Me),i.update();break;case l.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;ie(Me),i.update();break;case l.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;q(Me),i.update();break;default:h=l.NONE}}function Lt(Me){i.enabled!==!1&&Me.preventDefault()}function Bt(Me){E.push(Me)}function gt(Me){delete D[Me.pointerId];for(let Ve=0;Ve<E.length;Ve++)if(E[Ve].pointerId==Me.pointerId){E.splice(Ve,1);return}}function ei(Me){let Ve=D[Me.pointerId];Ve===void 0&&(Ve=new Xe,D[Me.pointerId]=Ve),Ve.set(Me.pageX,Me.pageY)}function wi(Me){const Ve=Me.pointerId===E[0].pointerId?E[1]:E[0];return D[Ve.pointerId]}n!==void 0&&this.connect(n),this.update()}}new dt;new le;function DQ(r,e,n){const i=n.length-r-1;if(e>=n[i])return i-1;if(e<=n[r])return r;let s=r,o=i,a=Math.floor((s+o)/2);for(;e<n[a]||e>=n[a+1];)e<n[a]?o=a:s=a,a=Math.floor((s+o)/2);return a}function GEe(r,e,n,i){const s=[],o=[],a=[];s[0]=1;for(let l=1;l<=n;++l){o[l]=e-i[r+1-l],a[l]=i[r+l]-e;let h=0;for(let u=0;u<l;++u){const f=a[u+1],p=o[l-u],m=s[u]/(f+p);s[u]=h+f*m,h=p*m}s[l]=h}return s}function HEe(r,e,n,i){const s=DQ(r,i,e),o=GEe(s,i,r,e),a=new Ni(0,0,0,0);for(let l=0;l<=r;++l){const h=n[s-r+l],u=o[l],f=h.w*u;a.x+=h.x*f,a.y+=h.y*f,a.z+=h.z*f,a.w+=h.w*u}return a}function QEe(r,e,n,i,s){const o=[];for(let p=0;p<=n;++p)o[p]=0;const a=[];for(let p=0;p<=i;++p)a[p]=o.slice(0);const l=[];for(let p=0;p<=n;++p)l[p]=o.slice(0);l[0][0]=1;const h=o.slice(0),u=o.slice(0);for(let p=1;p<=n;++p){h[p]=e-s[r+1-p],u[p]=s[r+p]-e;let m=0;for(let v=0;v<p;++v){const y=u[v+1],x=h[p-v];l[p][v]=y+x;const w=l[v][p-1]/l[p][v];l[v][p]=m+y*w,m=x*w}l[p][p]=m}for(let p=0;p<=n;++p)a[0][p]=l[p][n];for(let p=0;p<=n;++p){let m=0,v=1;const y=[];for(let x=0;x<=n;++x)y[x]=o.slice(0);y[0][0]=1;for(let x=1;x<=i;++x){let w=0;const S=p-x,O=n-x;p>=x&&(y[v][0]=y[m][0]/l[O+1][S],w=y[v][0]*l[S][O]);const _=S>=-1?1:-S,T=p-1<=O?x-1:n-p;for(let P=_;P<=T;++P)y[v][P]=(y[m][P]-y[m][P-1])/l[O+1][S+P],w+=y[v][P]*l[S+P][O];p<=O&&(y[v][x]=-y[m][x-1]/l[O+1][p],w+=y[v][x]*l[p][O]),a[x][p]=w;const A=m;m=v,v=A}}let f=n;for(let p=1;p<=i;++p){for(let m=0;m<=n;++m)a[p][m]*=f;f*=n-p}return a}function jEe(r,e,n,i,s){const o=s<r?s:r,a=[],l=DQ(r,i,e),h=QEe(l,i,r,o,e),u=[];for(let f=0;f<n.length;++f){const p=n[f].clone(),m=p.w;p.x*=m,p.y*=m,p.z*=m,u[f]=p}for(let f=0;f<=o;++f){const p=u[l-r].clone().multiplyScalar(h[f][0]);for(let m=1;m<=r;++m)p.add(u[l-r+m].clone().multiplyScalar(h[f][m]));a[f]=p}for(let f=o+1;f<=s+1;++f)a[f]=new Ni(0,0,0);return a}function YEe(r,e){let n=1;for(let s=2;s<=r;++s)n*=s;let i=1;for(let s=2;s<=e;++s)i*=s;for(let s=2;s<=r-e;++s)i*=s;return n/i}function qEe(r){const e=r.length,n=[],i=[];for(let o=0;o<e;++o){const a=r[o];n[o]=new le(a.x,a.y,a.z),i[o]=a.w}const s=[];for(let o=0;o<e;++o){const a=n[o].clone();for(let l=1;l<=o;++l)a.sub(s[o-l].clone().multiplyScalar(YEe(o,l)*i[l]));s[o]=a.divideScalar(i[0])}return s}function ZEe(r,e,n,i,s){const o=jEe(r,e,n,i,s);return qEe(o)}class YU extends $a{constructor(e,n,i,s,o){super(),this.degree=e,this.knots=n,this.controlPoints=[],this.startKnot=s||0,this.endKnot=o||this.knots.length-1;for(let a=0;a<i.length;++a){const l=i[a];this.controlPoints[a]=new Ni(l.x,l.y,l.z,l.w)}}getPoint(e,n){const i=n||new le,s=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),o=HEe(this.degree,this.knots,this.controlPoints,s);return o.w!=1&&o.divideScalar(o.w),i.set(o.x,o.y,o.z)}getTangent(e,n){const i=n||new le,s=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),o=ZEe(this.degree,this.knots,this.controlPoints,s,1);return i.copy(o[1]).normalize(),i}}let zi,pr,po;class KEe extends xs{constructor(e){super(e)}load(e,n,i,s){const o=this,a=o.path===""?fl.extractUrlBase(e):o.path,l=new aa(this.manager);l.setPath(o.path),l.setResponseType("arraybuffer"),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(h){try{n(o.parse(h,a))}catch(u){s?s(u):console.error(u),o.manager.itemError(e)}},i,s)}parse(e,n){if(rMe(e))zi=new nMe().parse(e);else{const s=UQ(e);if(!sMe(s))throw new Error("THREE.FBXLoader: Unknown format.");if(ZU(s)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+ZU(s));zi=new iMe().parse(s)}const i=new Bb(this.manager).setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);return new JEe(i,this.manager).parse(zi)}}class JEe{constructor(e,n){this.textureLoader=e,this.manager=n}parse(){pr=this.parseConnections();const e=this.parseImages(),n=this.parseTextures(e),i=this.parseMaterials(n),s=this.parseDeformers(),o=new eMe().parse(s);return this.parseScene(s,o,i),po}parseConnections(){const e=new Map;return"Connections"in zi&&zi.Connections.connections.forEach(function(n){const i=n[0],s=n[1],o=n[2];e.has(i)||e.set(i,{parents:[],children:[]});const a={ID:s,relationship:o};e.get(i).parents.push(a),e.has(s)||e.set(s,{parents:[],children:[]});const l={ID:i,relationship:o};e.get(s).children.push(l)}),e}parseImages(){const e={},n={};if("Video"in zi.Objects){const i=zi.Objects.Video;for(const s in i){const o=i[s],a=parseInt(s);if(e[a]=o.RelativeFilename||o.Filename,"Content"in o){const l=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,h=typeof o.Content=="string"&&o.Content!=="";if(l||h){const u=this.parseImage(i[s]);n[o.RelativeFilename||o.Filename]=u}}}}for(const i in e){const s=e[i];n[s]!==void 0?e[i]=n[s]:e[i]=e[i].split("\\").pop()}return e}parseImage(e){const n=e.Content,i=e.RelativeFilename||e.Filename,s=i.slice(i.lastIndexOf(".")+1).toLowerCase();let o;switch(s){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",i),o="image/tga";break;default:console.warn('FBXLoader: Image type "'+s+'" is not supported.');return}if(typeof n=="string")return"data:"+o+";base64,"+n;{const a=new Uint8Array(n);return window.URL.createObjectURL(new Blob([a],{type:o}))}}parseTextures(e){const n=new Map;if("Texture"in zi.Objects){const i=zi.Objects.Texture;for(const s in i){const o=this.parseTexture(i[s],e);n.set(parseInt(s),o)}}return n}parseTexture(e,n){const i=this.loadTexture(e,n);i.ID=e.id,i.name=e.attrName;const s=e.WrapModeU,o=e.WrapModeV,a=s!==void 0?s.value:0,l=o!==void 0?o.value:0;if(i.wrapS=a===0?yl:Ps,i.wrapT=l===0?yl:Ps,"Scaling"in e){const h=e.Scaling.value;i.repeat.x=h[0],i.repeat.y=h[1]}return i}loadTexture(e,n){let i;const s=this.textureLoader.path,o=pr.get(e.id).children;o!==void 0&&o.length>0&&n[o[0].ID]!==void 0&&(i=n[o[0].ID],(i.indexOf("blob:")===0||i.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let a;const l=e.FileName.slice(-3).toLowerCase();if(l==="tga"){const h=this.manager.getHandler(".tga");h===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),a=new qn):(h.setPath(this.textureLoader.path),a=h.load(i))}else l==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),a=new qn):a=this.textureLoader.load(i);return this.textureLoader.setPath(s),a}parseMaterials(e){const n=new Map;if("Material"in zi.Objects){const i=zi.Objects.Material;for(const s in i){const o=this.parseMaterial(i[s],e);o!==null&&n.set(parseInt(s),o)}}return n}parseMaterial(e,n){const i=e.id,s=e.attrName;let o=e.ShadingModel;if(typeof o=="object"&&(o=o.value),!pr.has(i))return null;const a=this.parseParameters(e,n,i);let l;switch(o.toLowerCase()){case"phong":l=new fg;break;case"lambert":l=new i4;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),l=new fg;break}return l.setValues(a),l.name=s,l}parseParameters(e,n,i){const s={};e.BumpFactor&&(s.bumpScale=e.BumpFactor.value),e.Diffuse?s.color=new nt().fromArray(e.Diffuse.value):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(s.color=new nt().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(s.displacementScale=e.DisplacementFactor.value),e.Emissive?s.emissive=new nt().fromArray(e.Emissive.value):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(s.emissive=new nt().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(s.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(s.opacity=parseFloat(e.Opacity.value)),s.opacity<1&&(s.transparent=!0),e.ReflectionFactor&&(s.reflectivity=e.ReflectionFactor.value),e.Shininess&&(s.shininess=e.Shininess.value),e.Specular?s.specular=new nt().fromArray(e.Specular.value):e.SpecularColor&&e.SpecularColor.type==="Color"&&(s.specular=new nt().fromArray(e.SpecularColor.value));const o=this;return pr.get(i).children.forEach(function(a){const l=a.relationship;switch(l){case"Bump":s.bumpMap=o.getTexture(n,a.ID);break;case"Maya|TEX_ao_map":s.aoMap=o.getTexture(n,a.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":s.map=o.getTexture(n,a.ID),s.map!==void 0&&("colorSpace"in s.map?s.map.colorSpace="srgb":s.map.encoding=3001);break;case"DisplacementColor":s.displacementMap=o.getTexture(n,a.ID);break;case"EmissiveColor":s.emissiveMap=o.getTexture(n,a.ID),s.emissiveMap!==void 0&&("colorSpace"in s.emissiveMap?s.emissiveMap.colorSpace="srgb":s.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":s.normalMap=o.getTexture(n,a.ID);break;case"ReflectionColor":s.envMap=o.getTexture(n,a.ID),s.envMap!==void 0&&(s.envMap.mapping=Bg,"colorSpace"in s.envMap?s.envMap.colorSpace="srgb":s.envMap.encoding=3001);break;case"SpecularColor":s.specularMap=o.getTexture(n,a.ID),s.specularMap!==void 0&&("colorSpace"in s.specularMap?s.specularMap.colorSpace="srgb":s.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":s.alphaMap=o.getTexture(n,a.ID),s.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",l);break}}),s}getTexture(e,n){return"LayeredTexture"in zi.Objects&&n in zi.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=pr.get(n).children[0].ID),e.get(n)}parseDeformers(){const e={},n={};if("Deformer"in zi.Objects){const i=zi.Objects.Deformer;for(const s in i){const o=i[s],a=pr.get(parseInt(s));if(o.attrType==="Skin"){const l=this.parseSkeleton(a,i);l.ID=s,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=a.parents[0].ID,e[s]=l}else if(o.attrType==="BlendShape"){const l={id:s};l.rawTargets=this.parseMorphTargets(a,i),l.id=s,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[s]=l}}}return{skeletons:e,morphTargets:n}}parseSkeleton(e,n){const i=[];return e.children.forEach(function(s){const o=n[s.ID];if(o.attrType!=="Cluster")return;const a={ID:s.ID,indices:[],weights:[],transformLink:new dt().fromArray(o.TransformLink.a)};"Indexes"in o&&(a.indices=o.Indexes.a,a.weights=o.Weights.a),i.push(a)}),{rawBones:i,bones:[]}}parseMorphTargets(e,n){const i=[];for(let s=0;s<e.children.length;s++){const o=e.children[s],a=n[o.ID],l={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if(a.attrType!=="BlendShapeChannel")return;l.geoID=pr.get(parseInt(o.ID)).children.filter(function(h){return h.relationship===void 0})[0].ID,i.push(l)}return i}parseScene(e,n,i){po=new qs;const s=this.parseModels(e.skeletons,n,i),o=zi.Objects.Model,a=this;s.forEach(function(h){const u=o[h.ID];a.setLookAtProperties(h,u),pr.get(h.ID).parents.forEach(function(f){const p=s.get(f.ID);p!==void 0&&p.add(h)}),h.parent===null&&po.add(h)}),this.bindSkeleton(e.skeletons,n,s),this.createAmbientLight(),po.traverse(function(h){if(h.userData.transformData){h.parent&&(h.userData.transformData.parentMatrix=h.parent.matrix,h.userData.transformData.parentMatrixWorld=h.parent.matrixWorld);const u=BQ(h.userData.transformData);h.applyMatrix4(u),h.updateWorldMatrix()}});const l=new tMe().parse();po.children.length===1&&po.children[0].isGroup&&(po.children[0].animations=l,po=po.children[0]),po.animations=l}parseModels(e,n,i){const s=new Map,o=zi.Objects.Model;for(const a in o){const l=parseInt(a),h=o[a],u=pr.get(l);let f=this.buildSkeleton(u,e,l,h.attrName);if(!f){switch(h.attrType){case"Camera":f=this.createCamera(u);break;case"Light":f=this.createLight(u);break;case"Mesh":f=this.createMesh(u,n,i);break;case"NurbsCurve":f=this.createCurve(u,n);break;case"LimbNode":case"Root":f=new Fg;break;case"Null":default:f=new qs;break}f.name=h.attrName?Ai.sanitizeNodeName(h.attrName):"",f.ID=l}this.getTransformData(f,h),s.set(l,f)}return s}buildSkeleton(e,n,i,s){let o=null;return e.parents.forEach(function(a){for(const l in n){const h=n[l];h.rawBones.forEach(function(u,f){if(u.ID===a.ID){const p=o;o=new Fg,o.matrixWorld.copy(u.transformLink),o.name=s?Ai.sanitizeNodeName(s):"",o.ID=i,h.bones[f]=o,p!==null&&o.add(p)}})}}),o}createCamera(e){let n,i;if(e.children.forEach(function(s){const o=zi.Objects.NodeAttribute[s.ID];o!==void 0&&(i=o)}),i===void 0)n=new Li;else{let s=0;i.CameraProjectionType!==void 0&&i.CameraProjectionType.value===1&&(s=1);let o=1;i.NearPlane!==void 0&&(o=i.NearPlane.value/1e3);let a=1e3;i.FarPlane!==void 0&&(a=i.FarPlane.value/1e3);let l=window.innerWidth,h=window.innerHeight;i.AspectWidth!==void 0&&i.AspectHeight!==void 0&&(l=i.AspectWidth.value,h=i.AspectHeight.value);const u=l/h;let f=45;i.FieldOfView!==void 0&&(f=i.FieldOfView.value);const p=i.FocalLength?i.FocalLength.value:null;switch(s){case 0:n=new fn(f,u,o,a),p!==null&&n.setFocalLength(p);break;case 1:n=new Jo(-l/2,l/2,h/2,-h/2,o,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+s+"."),n=new Li;break}}return n}createLight(e){let n,i;if(e.children.forEach(function(s){const o=zi.Objects.NodeAttribute[s.ID];o!==void 0&&(i=o)}),i===void 0)n=new Li;else{let s;i.LightType===void 0?s=0:s=i.LightType.value;let o=16777215;i.Color!==void 0&&(o=new nt().fromArray(i.Color.value));let a=i.Intensity===void 0?1:i.Intensity.value/100;i.CastLightOnObject!==void 0&&i.CastLightOnObject.value===0&&(a=0);let l=0;i.FarAttenuationEnd!==void 0&&(i.EnableFarAttenuation!==void 0&&i.EnableFarAttenuation.value===0?l=0:l=i.FarAttenuationEnd.value);const h=1;switch(s){case 0:n=new X1(o,a,l,h);break;case 1:n=new Ub(o,a);break;case 2:let u=Math.PI/3;i.InnerAngle!==void 0&&(u=fs.degToRad(i.InnerAngle.value));let f=0;i.OuterAngle!==void 0&&(f=fs.degToRad(i.OuterAngle.value),f=Math.max(f,1)),n=new $b(o,a,l,u,f,h);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),n=new X1(o,a);break}i.CastShadows!==void 0&&i.CastShadows.value===1&&(n.castShadow=!0)}return n}createMesh(e,n,i){let s,o=null,a=null;const l=[];return e.children.forEach(function(h){n.has(h.ID)&&(o=n.get(h.ID)),i.has(h.ID)&&l.push(i.get(h.ID))}),l.length>1?a=l:l.length>0?a=l[0]:(a=new fg({color:13421772}),l.push(a)),"color"in o.attributes&&l.forEach(function(h){h.vertexColors=!0}),o.FBX_Deformer?(s=new n2(o,a),s.normalizeSkinWeights()):s=new ln(o,a),s}createCurve(e,n){const i=e.children.reduce(function(o,a){return n.has(a.ID)&&(o=n.get(a.ID)),o},null),s=new bs({color:3342591,linewidth:1});return new pc(i,s)}getTransformData(e,n){const i={};"InheritType"in n&&(i.inheritType=parseInt(n.InheritType.value)),"RotationOrder"in n?i.eulerOrder=$Q(n.RotationOrder.value):i.eulerOrder="ZYX","Lcl_Translation"in n&&(i.translation=n.Lcl_Translation.value),"PreRotation"in n&&(i.preRotation=n.PreRotation.value),"Lcl_Rotation"in n&&(i.rotation=n.Lcl_Rotation.value),"PostRotation"in n&&(i.postRotation=n.PostRotation.value),"Lcl_Scaling"in n&&(i.scale=n.Lcl_Scaling.value),"ScalingOffset"in n&&(i.scalingOffset=n.ScalingOffset.value),"ScalingPivot"in n&&(i.scalingPivot=n.ScalingPivot.value),"RotationOffset"in n&&(i.rotationOffset=n.RotationOffset.value),"RotationPivot"in n&&(i.rotationPivot=n.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,n){"LookAtProperty"in n&&pr.get(e.ID).children.forEach(function(i){if(i.relationship==="LookAtProperty"){const s=zi.Objects.Model[i.ID];if("Lcl_Translation"in s){const o=s.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(o),po.add(e.target)):e.lookAt(new le().fromArray(o))}}})}bindSkeleton(e,n,i){const s=this.parsePoseNodes();for(const o in e){const a=e[o];pr.get(parseInt(a.ID)).parents.forEach(function(l){if(n.has(l.ID)){const h=l.ID;pr.get(h).parents.forEach(function(u){i.has(u.ID)&&i.get(u.ID).bind(new h0(a.bones),s[u.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in zi.Objects){const n=zi.Objects.Pose;for(const i in n)if(n[i].attrType==="BindPose"&&n[i].NbPoseNodes>0){const s=n[i].PoseNode;Array.isArray(s)?s.forEach(function(o){e[o.Node]=new dt().fromArray(o.Matrix.a)}):e[s.Node]=new dt().fromArray(s.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in zi&&"AmbientColor"in zi.GlobalSettings){const e=zi.GlobalSettings.AmbientColor.value,n=e[0],i=e[1],s=e[2];if(n!==0||i!==0||s!==0){const o=new nt(n,i,s);po.add(new b2(o,1))}}}}class eMe{parse(e){const n=new Map;if("Geometry"in zi.Objects){const i=zi.Objects.Geometry;for(const s in i){const o=pr.get(parseInt(s)),a=this.parseGeometry(o,i[s],e);n.set(parseInt(s),a)}}return n}parseGeometry(e,n,i){switch(n.attrType){case"Mesh":return this.parseMeshGeometry(e,n,i);case"NurbsCurve":return this.parseNurbsGeometry(n)}}parseMeshGeometry(e,n,i){const s=i.skeletons,o=[],a=e.parents.map(function(p){return zi.Objects.Model[p.ID]});if(a.length===0)return;const l=e.children.reduce(function(p,m){return s[m.ID]!==void 0&&(p=s[m.ID]),p},null);e.children.forEach(function(p){i.morphTargets[p.ID]!==void 0&&o.push(i.morphTargets[p.ID])});const h=a[0],u={};"RotationOrder"in h&&(u.eulerOrder=$Q(h.RotationOrder.value)),"InheritType"in h&&(u.inheritType=parseInt(h.InheritType.value)),"GeometricTranslation"in h&&(u.translation=h.GeometricTranslation.value),"GeometricRotation"in h&&(u.rotation=h.GeometricRotation.value),"GeometricScaling"in h&&(u.scale=h.GeometricScaling.value);const f=BQ(u);return this.genGeometry(n,l,o,f)}genGeometry(e,n,i,s){const o=new vi;e.attrName&&(o.name=e.attrName);const a=this.parseGeoNode(e,n),l=this.genBuffers(a),h=new Nt(l.vertex,3);if(h.applyMatrix4(s),o.setAttribute("position",h),l.colors.length>0&&o.setAttribute("color",new Nt(l.colors,3)),n&&(o.setAttribute("skinIndex",new JC(l.weightsIndices,4)),o.setAttribute("skinWeight",new Nt(l.vertexWeights,4)),o.FBX_Deformer=n),l.normal.length>0){const u=new Ci().getNormalMatrix(s),f=new Nt(l.normal,3);f.applyNormalMatrix(u),o.setAttribute("normal",f)}if(l.uvs.forEach(function(u,f){let p="uv"+(f+1).toString();f===0&&(p="uv"),o.setAttribute(p,new Nt(l.uvs[f],2))}),a.material&&a.material.mappingType!=="AllSame"){let u=l.materialIndex[0],f=0;if(l.materialIndex.forEach(function(p,m){p!==u&&(o.addGroup(f,m-f,u),u=p,f=m)}),o.groups.length>0){const p=o.groups[o.groups.length-1],m=p.start+p.count;m!==l.materialIndex.length&&o.addGroup(m,l.materialIndex.length-m,u)}o.groups.length===0&&o.addGroup(0,l.materialIndex.length,l.materialIndex[0])}return this.addMorphTargets(o,e,i,s),o}parseGeoNode(e,n){const i={};if(i.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],i.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let s=0;for(;e.LayerElementUV[s];)e.LayerElementUV[s].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[s])),s++}return i.weightTable={},n!==null&&(i.skeleton=n,n.rawBones.forEach(function(s,o){s.indices.forEach(function(a,l){i.weightTable[a]===void 0&&(i.weightTable[a]=[]),i.weightTable[a].push({id:o,weight:s.weights[l]})})})),i}genBuffers(e){const n={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,s=0,o=!1,a=[],l=[],h=[],u=[],f=[],p=[];const m=this;return e.vertexIndices.forEach(function(v,y){let x,w=!1;v<0&&(v=v^-1,w=!0);let S=[],O=[];if(a.push(v*3,v*3+1,v*3+2),e.color){const _=v_(y,i,v,e.color);h.push(_[0],_[1],_[2])}if(e.skeleton){if(e.weightTable[v]!==void 0&&e.weightTable[v].forEach(function(_){O.push(_.weight),S.push(_.id)}),O.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const _=[0,0,0,0],T=[0,0,0,0];O.forEach(function(A,P){let N=A,k=S[P];T.forEach(function(R,E,D){if(N>R){D[E]=N,N=R;const $=_[E];_[E]=k,k=$}})}),S=_,O=T}for(;O.length<4;)O.push(0),S.push(0);for(let _=0;_<4;++_)f.push(O[_]),p.push(S[_])}if(e.normal){const _=v_(y,i,v,e.normal);l.push(_[0],_[1],_[2])}e.material&&e.material.mappingType!=="AllSame"&&(x=v_(y,i,v,e.material)[0]),e.uv&&e.uv.forEach(function(_,T){const A=v_(y,i,v,_);u[T]===void 0&&(u[T]=[]),u[T].push(A[0]),u[T].push(A[1])}),s++,w&&(m.genFace(n,e,a,x,l,h,u,f,p,s),i++,s=0,a=[],l=[],h=[],u=[],f=[],p=[])}),n}genFace(e,n,i,s,o,a,l,h,u,f){for(let p=2;p<f;p++)e.vertex.push(n.vertexPositions[i[0]]),e.vertex.push(n.vertexPositions[i[1]]),e.vertex.push(n.vertexPositions[i[2]]),e.vertex.push(n.vertexPositions[i[(p-1)*3]]),e.vertex.push(n.vertexPositions[i[(p-1)*3+1]]),e.vertex.push(n.vertexPositions[i[(p-1)*3+2]]),e.vertex.push(n.vertexPositions[i[p*3]]),e.vertex.push(n.vertexPositions[i[p*3+1]]),e.vertex.push(n.vertexPositions[i[p*3+2]]),n.skeleton&&(e.vertexWeights.push(h[0]),e.vertexWeights.push(h[1]),e.vertexWeights.push(h[2]),e.vertexWeights.push(h[3]),e.vertexWeights.push(h[(p-1)*4]),e.vertexWeights.push(h[(p-1)*4+1]),e.vertexWeights.push(h[(p-1)*4+2]),e.vertexWeights.push(h[(p-1)*4+3]),e.vertexWeights.push(h[p*4]),e.vertexWeights.push(h[p*4+1]),e.vertexWeights.push(h[p*4+2]),e.vertexWeights.push(h[p*4+3]),e.weightsIndices.push(u[0]),e.weightsIndices.push(u[1]),e.weightsIndices.push(u[2]),e.weightsIndices.push(u[3]),e.weightsIndices.push(u[(p-1)*4]),e.weightsIndices.push(u[(p-1)*4+1]),e.weightsIndices.push(u[(p-1)*4+2]),e.weightsIndices.push(u[(p-1)*4+3]),e.weightsIndices.push(u[p*4]),e.weightsIndices.push(u[p*4+1]),e.weightsIndices.push(u[p*4+2]),e.weightsIndices.push(u[p*4+3])),n.color&&(e.colors.push(a[0]),e.colors.push(a[1]),e.colors.push(a[2]),e.colors.push(a[(p-1)*3]),e.colors.push(a[(p-1)*3+1]),e.colors.push(a[(p-1)*3+2]),e.colors.push(a[p*3]),e.colors.push(a[p*3+1]),e.colors.push(a[p*3+2])),n.material&&n.material.mappingType!=="AllSame"&&(e.materialIndex.push(s),e.materialIndex.push(s),e.materialIndex.push(s)),n.normal&&(e.normal.push(o[0]),e.normal.push(o[1]),e.normal.push(o[2]),e.normal.push(o[(p-1)*3]),e.normal.push(o[(p-1)*3+1]),e.normal.push(o[(p-1)*3+2]),e.normal.push(o[p*3]),e.normal.push(o[p*3+1]),e.normal.push(o[p*3+2])),n.uv&&n.uv.forEach(function(m,v){e.uvs[v]===void 0&&(e.uvs[v]=[]),e.uvs[v].push(l[v][0]),e.uvs[v].push(l[v][1]),e.uvs[v].push(l[v][(p-1)*2]),e.uvs[v].push(l[v][(p-1)*2+1]),e.uvs[v].push(l[v][p*2]),e.uvs[v].push(l[v][p*2+1])})}addMorphTargets(e,n,i,s){if(i.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const o=this;i.forEach(function(a){a.rawTargets.forEach(function(l){const h=zi.Objects.Geometry[l.geoID];h!==void 0&&o.genMorphGeometry(e,n,h,s,l.name)})})}genMorphGeometry(e,n,i,s,o){const a=n.PolygonVertexIndex!==void 0?n.PolygonVertexIndex.a:[],l=i.Vertices!==void 0?i.Vertices.a:[],h=i.Indexes!==void 0?i.Indexes.a:[],u=e.attributes.position.count*3,f=new Float32Array(u);for(let y=0;y<h.length;y++){const x=h[y]*3;f[x]=l[y*3],f[x+1]=l[y*3+1],f[x+2]=l[y*3+2]}const p={vertexIndices:a,vertexPositions:f},m=this.genBuffers(p),v=new Nt(m.vertex,3);v.name=o||i.attrName,v.applyMatrix4(s),e.morphAttributes.position.push(v)}parseNormals(e){const n=e.MappingInformationType,i=e.ReferenceInformationType,s=e.Normals.a;let o=[];return i==="IndexToDirect"&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:s,indices:o,mappingType:n,referenceType:i}}parseUVs(e){const n=e.MappingInformationType,i=e.ReferenceInformationType,s=e.UV.a;let o=[];return i==="IndexToDirect"&&(o=e.UVIndex.a),{dataSize:2,buffer:s,indices:o,mappingType:n,referenceType:i}}parseVertexColors(e){const n=e.MappingInformationType,i=e.ReferenceInformationType,s=e.Colors.a;let o=[];return i==="IndexToDirect"&&(o=e.ColorIndex.a),{dataSize:4,buffer:s,indices:o,mappingType:n,referenceType:i}}parseMaterialIndices(e){const n=e.MappingInformationType,i=e.ReferenceInformationType;if(n==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const s=e.Materials.a,o=[];for(let a=0;a<s.length;++a)o.push(a);return{dataSize:1,buffer:s,indices:o,mappingType:n,referenceType:i}}parseNurbsGeometry(e){if(YU===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new vi;const n=parseInt(e.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new vi;const i=n-1,s=e.KnotVector.a,o=[],a=e.Points.a;for(let f=0,p=a.length;f<p;f+=4)o.push(new Ni().fromArray(a,f));let l,h;if(e.Form==="Closed")o.push(o[0]);else if(e.Form==="Periodic"){l=i,h=s.length-1-l;for(let f=0;f<i;++f)o.push(o[f])}const u=new YU(i,s,o,l,h).getPoints(o.length*12);return new vi().setFromPoints(u)}}class tMe{parse(){const e=[],n=this.parseClips();if(n!==void 0)for(const i in n){const s=n[i],o=this.addClip(s);e.push(o)}return e}parseClips(){if(zi.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const n=this.parseAnimationLayers(e);return this.parseAnimStacks(n)}parseAnimationCurveNodes(){const e=zi.Objects.AnimationCurveNode,n=new Map;for(const i in e){const s=e[i];if(s.attrName.match(/S|R|T|DeformPercent/)!==null){const o={id:s.id,attr:s.attrName,curves:{}};n.set(o.id,o)}}return n}parseAnimationCurves(e){const n=zi.Objects.AnimationCurve;for(const i in n){const s={id:n[i].id,times:n[i].KeyTime.a.map(oMe),values:n[i].KeyValueFloat.a},o=pr.get(s.id);if(o!==void 0){const a=o.parents[0].ID,l=o.parents[0].relationship;l.match(/X/)?e.get(a).curves.x=s:l.match(/Y/)?e.get(a).curves.y=s:l.match(/Z/)?e.get(a).curves.z=s:l.match(/d|DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=s)}}}parseAnimationLayers(e){const n=zi.Objects.AnimationLayer,i=new Map;for(const s in n){const o=[],a=pr.get(parseInt(s));a!==void 0&&(a.children.forEach(function(l,h){if(e.has(l.ID)){const u=e.get(l.ID);if(u.curves.x!==void 0||u.curves.y!==void 0||u.curves.z!==void 0){if(o[h]===void 0){const f=pr.get(l.ID).parents.filter(function(p){return p.relationship!==void 0})[0].ID;if(f!==void 0){const p=zi.Objects.Model[f.toString()];if(p===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",l);return}const m={modelName:p.attrName?Ai.sanitizeNodeName(p.attrName):"",ID:p.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};po.traverse(function(v){v.ID===p.id&&(m.transform=v.matrix,v.userData.transformData&&(m.eulerOrder=v.userData.transformData.eulerOrder))}),m.transform||(m.transform=new dt),"PreRotation"in p&&(m.preRotation=p.PreRotation.value),"PostRotation"in p&&(m.postRotation=p.PostRotation.value),o[h]=m}}o[h]&&(o[h][u.attr]=u)}else if(u.curves.morph!==void 0){if(o[h]===void 0){const f=pr.get(l.ID).parents.filter(function(w){return w.relationship!==void 0})[0].ID,p=pr.get(f).parents[0].ID,m=pr.get(p).parents[0].ID,v=pr.get(m).parents[0].ID,y=zi.Objects.Model[v],x={modelName:y.attrName?Ai.sanitizeNodeName(y.attrName):"",morphName:zi.Objects.Deformer[f].attrName};o[h]=x}o[h][u.attr]=u}}}),i.set(parseInt(s),o))}return i}parseAnimStacks(e){const n=zi.Objects.AnimationStack,i={};for(const s in n){const o=pr.get(parseInt(s)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(o[0].ID);i[s]={name:n[s].attrName,layer:a}}return i}addClip(e){let n=[];const i=this;return e.layer.forEach(function(s){n=n.concat(i.generateTracks(s))}),new op(e.name,-1,n)}generateTracks(e){const n=[];let i=new le,s=new ur,o=new le;if(e.transform&&e.transform.decompose(i,s,o),i=i.toArray(),s=new Vr().setFromQuaternion(s,e.eulerOrder).toArray(),o=o.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const a=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");a!==void 0&&n.push(a)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const a=this.generateRotationTrack(e.modelName,e.R.curves,s,e.preRotation,e.postRotation,e.eulerOrder);a!==void 0&&n.push(a)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const a=this.generateVectorTrack(e.modelName,e.S.curves,o,"scale");a!==void 0&&n.push(a)}if(e.DeformPercent!==void 0){const a=this.generateMorphTrack(e);a!==void 0&&n.push(a)}return n}generateVectorTrack(e,n,i,s){const o=this.getTimesForAllAxes(n),a=this.getKeyframeTrackValues(o,n,i);return new rd(e+"."+s,o,a)}generateRotationTrack(e,n,i,s,o,a){n.x!==void 0&&(this.interpolateRotations(n.x),n.x.values=n.x.values.map(fs.degToRad)),n.y!==void 0&&(this.interpolateRotations(n.y),n.y.values=n.y.values.map(fs.degToRad)),n.z!==void 0&&(this.interpolateRotations(n.z),n.z.values=n.z.values.map(fs.degToRad));const l=this.getTimesForAllAxes(n),h=this.getKeyframeTrackValues(l,n,i);s!==void 0&&(s=s.map(fs.degToRad),s.push(a),s=new Vr().fromArray(s),s=new ur().setFromEuler(s)),o!==void 0&&(o=o.map(fs.degToRad),o.push(a),o=new Vr().fromArray(o),o=new ur().setFromEuler(o).invert());const u=new ur,f=new Vr,p=[];for(let m=0;m<h.length;m+=3)f.set(h[m],h[m+1],h[m+2],a),u.setFromEuler(f),s!==void 0&&u.premultiply(s),o!==void 0&&u.multiply(o),u.toArray(p,m/3*4);return new _h(e+".quaternion",l,p)}generateMorphTrack(e){const n=e.DeformPercent.curves.morph,i=n.values.map(function(o){return o/100}),s=po.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new nd(e.modelName+".morphTargetInfluences["+s+"]",n.times,i)}getTimesForAllAxes(e){let n=[];if(e.x!==void 0&&(n=n.concat(e.x.times)),e.y!==void 0&&(n=n.concat(e.y.times)),e.z!==void 0&&(n=n.concat(e.z.times)),n=n.sort(function(i,s){return i-s}),n.length>1){let i=1,s=n[0];for(let o=1;o<n.length;o++){const a=n[o];a!==s&&(n[i]=a,s=a,i++)}n=n.slice(0,i)}return n}getKeyframeTrackValues(e,n,i){const s=i,o=[];let a=-1,l=-1,h=-1;return e.forEach(function(u){if(n.x&&(a=n.x.times.indexOf(u)),n.y&&(l=n.y.times.indexOf(u)),n.z&&(h=n.z.times.indexOf(u)),a!==-1){const f=n.x.values[a];o.push(f),s[0]=f}else o.push(s[0]);if(l!==-1){const f=n.y.values[l];o.push(f),s[1]=f}else o.push(s[1]);if(h!==-1){const f=n.z.values[h];o.push(f),s[2]=f}else o.push(s[2])}),o}interpolateRotations(e){for(let n=1;n<e.values.length;n++){const i=e.values[n-1],s=e.values[n]-i,o=Math.abs(s);if(o>=180){const a=o/180,l=s/a;let h=i+l;const u=e.times[n-1],f=(e.times[n]-u)/a;let p=u+f;const m=[],v=[];for(;p<e.times[n];)m.push(p),p+=f,v.push(h),h+=l;e.times=KU(e.times,n,m),e.values=KU(e.values,n,v)}}}}class iMe{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,n){this.currentProp=e,this.currentPropName=n}parse(e){this.currentIndent=0,this.allNodes=new LQ,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const n=this,i=e.split(/[\r\n]+/);return i.forEach(function(s,o){const a=s.match(/^[\s\t]*;/),l=s.match(/^[\s\t]*$/);if(a||l)return;const h=s.match("^\\t{"+n.currentIndent+"}(\\w+):(.*){",""),u=s.match("^\\t{"+n.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),f=s.match("^\\t{"+(n.currentIndent-1)+"}}");h?n.parseNodeBegin(s,h):u?n.parseNodeProperty(s,u,i[++o]):f?n.popStack():s.match(/^[^\s\t}]/)&&n.parseNodePropertyContinued(s)}),this.allNodes}parseNodeBegin(e,n){const i=n[1].trim().replace(/^"/,"").replace(/"$/,""),s=n[2].split(",").map(function(h){return h.trim().replace(/^"/,"").replace(/"$/,"")}),o={name:i},a=this.parseNodeAttr(s),l=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(i,o):i in l?(i==="PoseNode"?l.PoseNode.push(o):l[i].id!==void 0&&(l[i]={},l[i][l[i].id]=l[i]),a.id!==""&&(l[i][a.id]=o)):typeof a.id=="number"?(l[i]={},l[i][a.id]=o):i!=="Properties70"&&(i==="PoseNode"?l[i]=[o]:l[i]=o),typeof a.id=="number"&&(o.id=a.id),a.name!==""&&(o.attrName=a.name),a.type!==""&&(o.attrType=a.type),this.pushStack(o)}parseNodeAttr(e){let n=e[0];e[0]!==""&&(n=parseInt(e[0]),isNaN(n)&&(n=e[0]));let i="",s="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),s=e[2]),{id:n,name:i,type:s}}parseNodeProperty(e,n,i){let s=n[1].replace(/^"/,"").replace(/"$/,"").trim(),o=n[2].replace(/^"/,"").replace(/"$/,"").trim();s==="Content"&&o===","&&(o=i.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if(a.name==="Properties70"){this.parseNodeSpecialProperty(e,s,o);return}if(s==="C"){const l=o.split(",").slice(1),h=parseInt(l[0]),u=parseInt(l[1]);let f=o.split(",").slice(3);f=f.map(function(p){return p.trim().replace(/^"/,"")}),s="connections",o=[h,u],lMe(o,f),a[s]===void 0&&(a[s]=[])}s==="Node"&&(a.id=o),s in a&&Array.isArray(a[s])?a[s].push(o):s!=="a"?a[s]=o:a.a=o,this.setCurrentProp(a,s),s==="a"&&o.slice(-1)!==","&&(a.a=UM(o))}parseNodePropertyContinued(e){const n=this.getCurrentNode();n.a+=e,e.slice(-1)!==","&&(n.a=UM(n.a))}parseNodeSpecialProperty(e,n,i){const s=i.split('",').map(function(f){return f.trim().replace(/^\"/,"").replace(/\s/,"_")}),o=s[0],a=s[1],l=s[2],h=s[3];let u=s[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=UM(u);break}this.getPrevNode()[o]={type:a,type2:l,flag:h,value:u},this.setCurrentProp(this.getPrevNode(),o)}}class nMe{parse(e){const n=new qU(e);n.skip(23);const i=n.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const s=new LQ;for(;!this.endOfContent(n);){const o=this.parseNode(n,i);o!==null&&s.add(o.name,o)}return s}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,n){const i={},s=n>=7500?e.getUint64():e.getUint32(),o=n>=7500?e.getUint64():e.getUint32();n>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),l=e.getString(a);if(s===0)return null;const h=[];for(let m=0;m<o;m++)h.push(this.parseProperty(e));const u=h.length>0?h[0]:"",f=h.length>1?h[1]:"",p=h.length>2?h[2]:"";for(i.singleProperty=o===1&&e.getOffset()===s;s>e.getOffset();){const m=this.parseNode(e,n);m!==null&&this.parseSubNode(l,i,m)}return i.propertyList=h,typeof u=="number"&&(i.id=u),f!==""&&(i.attrName=f),p!==""&&(i.attrType=p),l!==""&&(i.name=l),i}parseSubNode(e,n,i){if(i.singleProperty===!0){const s=i.propertyList[0];Array.isArray(s)?(n[i.name]=i,i.a=s):n[i.name]=s}else if(e==="Connections"&&i.name==="C"){const s=[];i.propertyList.forEach(function(o,a){a!==0&&s.push(o)}),n.connections===void 0&&(n.connections=[]),n.connections.push(s)}else if(i.name==="Properties70")Object.keys(i).forEach(function(s){n[s]=i[s]});else if(e==="Properties70"&&i.name==="P"){let s=i.propertyList[0],o=i.propertyList[1];const a=i.propertyList[2],l=i.propertyList[3];let h;s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),o.indexOf("Lcl ")===0&&(o=o.replace("Lcl ","Lcl_")),o==="Color"||o==="ColorRGB"||o==="Vector"||o==="Vector3D"||o.indexOf("Lcl_")===0?h=[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:h=i.propertyList[4],n[s]={type:o,type2:a,flag:l,value:h}}else n[i.name]===void 0?typeof i.id=="number"?(n[i.name]={},n[i.name][i.id]=i):n[i.name]=i:i.name==="PoseNode"?(Array.isArray(n[i.name])||(n[i.name]=[n[i.name]]),n[i.name].push(i)):n[i.name][i.id]===void 0&&(n[i.name][i.id]=i)}parseProperty(e){const n=e.getString(1);let i;switch(n){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const s=e.getUint32(),o=e.getUint32(),a=e.getUint32();if(o===0)switch(n){case"b":case"c":return e.getBooleanArray(s);case"d":return e.getFloat64Array(s);case"f":return e.getFloat32Array(s);case"i":return e.getInt32Array(s);case"l":return e.getInt64Array(s)}const l=$Ee(new Uint8Array(e.getArrayBuffer(a))),h=new qU(l.buffer);switch(n){case"b":case"c":return h.getBooleanArray(s);case"d":return h.getFloat64Array(s);case"f":return h.getFloat32Array(s);case"i":return h.getInt32Array(s);case"l":return h.getInt64Array(s)}default:throw new Error("THREE.FBXLoader: Unknown property type "+n)}}}class qU{constructor(e,n){this.dv=new DataView(e),this.offset=0,this.littleEndian=n!==void 0?n:!0}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const n=[];for(let i=0;i<e;i++)n.push(this.getBoolean());return n}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getInt32());return n}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n&2147483648?(n=~n&4294967295,e=~e&4294967295,e===4294967295&&(n=n+1&4294967295),e=e+1&4294967295,-(n*4294967296+e)):n*4294967296+e}getInt64Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getInt64());return n}getUint64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getFloat32());return n}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getFloat64());return n}getArrayBuffer(e){const n=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,n}getString(e){let n=[];for(let s=0;s<e;s++)n[s]=this.getUint8();const i=n.indexOf(0);return i>=0&&(n=n.slice(0,i)),fl.decodeText(new Uint8Array(n))}}class LQ{add(e,n){this[e]=n}}function rMe(r){const e="Kaydara FBX Binary  \0";return r.byteLength>=e.length&&e===UQ(r,0,e.length)}function sMe(r){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function i(s){const o=r[s-1];return r=r.slice(n+s),n++,o}for(let s=0;s<e.length;++s)if(i(1)===e[s])return!1;return!0}function ZU(r){const e=/FBXVersion: (\d+)/,n=r.match(e);if(n)return parseInt(n[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function oMe(r){return r/46186158e3}const aMe=[];function v_(r,e,n,i){let s;switch(i.mappingType){case"ByPolygonVertex":s=r;break;case"ByPolygon":s=e;break;case"ByVertice":s=n;break;case"AllSame":s=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}i.referenceType==="IndexToDirect"&&(s=i.indices[s]);const o=s*i.dataSize,a=o+i.dataSize;return cMe(aMe,i.buffer,o,a)}const $M=new Vr,Sm=new le;function BQ(r){const e=new dt,n=new dt,i=new dt,s=new dt,o=new dt,a=new dt,l=new dt,h=new dt,u=new dt,f=new dt,p=new dt,m=new dt,v=r.inheritType?r.inheritType:0;if(r.translation&&e.setPosition(Sm.fromArray(r.translation)),r.preRotation){const E=r.preRotation.map(fs.degToRad);E.push(r.eulerOrder),n.makeRotationFromEuler($M.fromArray(E))}if(r.rotation){const E=r.rotation.map(fs.degToRad);E.push(r.eulerOrder),i.makeRotationFromEuler($M.fromArray(E))}if(r.postRotation){const E=r.postRotation.map(fs.degToRad);E.push(r.eulerOrder),s.makeRotationFromEuler($M.fromArray(E)),s.invert()}r.scale&&o.scale(Sm.fromArray(r.scale)),r.scalingOffset&&l.setPosition(Sm.fromArray(r.scalingOffset)),r.scalingPivot&&a.setPosition(Sm.fromArray(r.scalingPivot)),r.rotationOffset&&h.setPosition(Sm.fromArray(r.rotationOffset)),r.rotationPivot&&u.setPosition(Sm.fromArray(r.rotationPivot)),r.parentMatrixWorld&&(p.copy(r.parentMatrix),f.copy(r.parentMatrixWorld));const y=n.clone().multiply(i).multiply(s),x=new dt;x.extractRotation(f);const w=new dt;w.copyPosition(f);const S=w.clone().invert().multiply(f),O=x.clone().invert().multiply(S),_=o,T=new dt;if(v===0)T.copy(x).multiply(y).multiply(O).multiply(_);else if(v===1)T.copy(x).multiply(O).multiply(y).multiply(_);else{const E=new dt().scale(new le().setFromMatrixScale(p)).clone().invert(),D=O.clone().multiply(E);T.copy(x).multiply(y).multiply(D).multiply(_)}const A=u.clone().invert(),P=a.clone().invert();let N=e.clone().multiply(h).multiply(u).multiply(n).multiply(i).multiply(s).multiply(A).multiply(l).multiply(a).multiply(o).multiply(P);const k=new dt().copyPosition(N),R=f.clone().multiply(k);return m.copyPosition(R),N=m.clone().multiply(T),N.premultiply(f.invert()),N}function $Q(r){r=r||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return r===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[r]}function UM(r){return r.split(",").map(function(e){return parseFloat(e)})}function UQ(r,e,n){return e===void 0&&(e=0),n===void 0&&(n=r.byteLength),fl.decodeText(new Uint8Array(r,e,n))}function lMe(r,e){for(let n=0,i=r.length,s=e.length;n<s;n++,i++)r[i]=e[n]}function cMe(r,e,n,i){for(let s=n,o=0;s<i;s++,o++)r[o]=e[s];return r}function KU(r,e,n){return r.slice(0,e).concat(n).concat(r.slice(e))}var hMe=Object.defineProperty,uMe=(r,e,n)=>e in r?hMe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,H4=(r,e,n)=>(uMe(r,typeof e!="symbol"?e+"":e,n),n);class VQ{constructor(e){H4(this,"data"),this.data=e}generateShapes(e,n=100,i){const s=[],o={letterSpacing:0,lineHeight:1,...i},a=dMe(e,n,this.data,o);for(let l=0,h=a.length;l<h;l++)Array.prototype.push.apply(s,a[l].toShapes(!1));return s}}H4(VQ,"isFont");H4(VQ,"type");function dMe(r,e,n,i){const s=Array.from(r),o=e/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*o,l=[];let h=0,u=0;for(let f=0;f<s.length;f++){const p=s[f];if(p===`
`)h=0,u-=a*i.lineHeight;else{const m=fMe(p,o,h,u,n);m&&(h+=m.offsetX+i.letterSpacing,l.push(m.path))}}return l}function fMe(r,e,n,i,s){const o=s.glyphs[r]||s.glyphs["?"];if(!o){console.error('THREE.Font: character "'+r+'" does not exists in font family '+s.familyName+".");return}const a=new d4;let l,h,u,f,p,m,v,y;if(o.o){const x=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let w=0,S=x.length;w<S;)switch(x[w++]){case"m":l=parseInt(x[w++])*e+n,h=parseInt(x[w++])*e+i,a.moveTo(l,h);break;case"l":l=parseInt(x[w++])*e+n,h=parseInt(x[w++])*e+i,a.lineTo(l,h);break;case"q":u=parseInt(x[w++])*e+n,f=parseInt(x[w++])*e+i,p=parseInt(x[w++])*e+n,m=parseInt(x[w++])*e+i,a.quadraticCurveTo(p,m,u,f);break;case"b":u=parseInt(x[w++])*e+n,f=parseInt(x[w++])*e+i,p=parseInt(x[w++])*e+n,m=parseInt(x[w++])*e+i,v=parseInt(x[w++])*e+n,y=parseInt(x[w++])*e+i,a.bezierCurveTo(p,m,v,y,u,f);break}}return{offsetX:o.ha*e,path:a}}class q1 extends ln{constructor(e,n={}){super(e),this.isReflector=!0,this.type="Reflector",this.camera=new fn;const i=this,s=n.color!==void 0?new nt(n.color):new nt(8355711),o=n.textureWidth||512,a=n.textureHeight||512,l=n.clipBias||0,h=n.shader||q1.ReflectorShader,u=n.multisample!==void 0?n.multisample:4,f=new wa,p=new le,m=new le,v=new le,y=new dt,x=new le(0,0,-1),w=new Ni,S=new le,O=new le,_=new Ni,T=new dt,A=this.camera,P=new La(o,a,{samples:u,type:o0}),N=new io({name:h.name!==void 0?h.name:"unspecified",uniforms:Ab.clone(h.uniforms),fragmentShader:h.fragmentShader,vertexShader:h.vertexShader});N.uniforms.tDiffuse.value=P.texture,N.uniforms.color.value=s,N.uniforms.textureMatrix.value=T,this.material=N,this.onBeforeRender=function(k,R,E){if(m.setFromMatrixPosition(i.matrixWorld),v.setFromMatrixPosition(E.matrixWorld),y.extractRotation(i.matrixWorld),p.set(0,0,1),p.applyMatrix4(y),S.subVectors(m,v),S.dot(p)>0)return;S.reflect(p).negate(),S.add(m),y.extractRotation(E.matrixWorld),x.set(0,0,-1),x.applyMatrix4(y),x.add(v),O.subVectors(m,x),O.reflect(p).negate(),O.add(m),A.position.copy(S),A.up.set(0,1,0),A.up.applyMatrix4(y),A.up.reflect(p),A.lookAt(O),A.far=E.far,A.updateMatrixWorld(),A.projectionMatrix.copy(E.projectionMatrix),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(A.projectionMatrix),T.multiply(A.matrixWorldInverse),T.multiply(i.matrixWorld),f.setFromNormalAndCoplanarPoint(p,m),f.applyMatrix4(A.matrixWorldInverse),w.set(f.normal.x,f.normal.y,f.normal.z,f.constant);const D=A.projectionMatrix;_.x=(Math.sign(w.x)+D.elements[8])/D.elements[0],_.y=(Math.sign(w.y)+D.elements[9])/D.elements[5],_.z=-1,_.w=(1+D.elements[10])/D.elements[14],w.multiplyScalar(2/w.dot(_)),D.elements[2]=w.x,D.elements[6]=w.y,D.elements[10]=w.z+1-l,D.elements[14]=w.w,i.visible=!1;const $=k.getRenderTarget(),I=k.xr.enabled,L=k.shadowMap.autoUpdate;k.xr.enabled=!1,k.shadowMap.autoUpdate=!1,k.setRenderTarget(P),k.state.buffers.depth.setMask(!0),k.autoClear===!1&&k.clear(),k.render(R,A),k.xr.enabled=I,k.shadowMap.autoUpdate=L,k.setRenderTarget($);const U=E.viewport;U!==void 0&&k.state.viewport(U),i.visible=!0},this.getRenderTarget=function(){return P},this.dispose=function(){P.dispose(),i.material.dispose()}}}q1.ReflectorShader={name:"ReflectorShader",uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};const pMe=["args","material-uniforms-color-value"],mMe=xt("TresPlaneGeometry",{args:[5,5]},null,-1);q1.ReflectorShader;function gMe(r){return NC()?(iI(r),!0):!1}function FQ(r){return typeof r=="function"?r():oi(r)}const vMe=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const yMe=Object.prototype.toString,bMe=r=>yMe.call(r)==="[object Object]",xMe=()=>{};function wMe(r){var e;const n=FQ(r);return(e=n==null?void 0:n.$el)!=null?e:n}const _Me=vMe?window:void 0;function VM(...r){let e,n,i,s;if(typeof r[0]=="string"||Array.isArray(r[0])?([n,i,s]=r,e=_Me):[e,n,i,s]=r,!e)return xMe;Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]);const o=[],a=()=>{o.forEach(f=>f()),o.length=0},l=(f,p,m,v)=>(f.addEventListener(p,m,v),()=>f.removeEventListener(p,m,v)),h=Gi(()=>[wMe(e),FQ(s)],([f,p])=>{if(a(),!f)return;const m=bMe(p)?{...p}:p;o.push(...n.flatMap(v=>i.map(y=>l(f,v,y,m))))},{immediate:!0,flush:"post"}),u=()=>{h(),a()};return gMe(u),u}class RS extends ln{constructor(){super(RS.Geometry,new vs({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const e=new le,n=new le,i=new LP(16,16),s=new LP(16,16);let o=bl;const a=RS.Geometry,l=new a1({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),h=new a1({uniforms:{map:{value:i},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),u=new ln(a,l),f=[],p=zQ.Shader,m=new a1({name:p.name,uniforms:{map:{value:null},occlusionMap:{value:s},color:{value:new nt(16777215)},scale:{value:new Xe},screenPosition:{value:new le}},vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,blending:wS,transparent:!0,depthWrite:!1}),v=new ln(a,m);this.addElement=function(O){f.push(O)};const y=new Xe,x=new Xe,w=new vH,S=new Ni;this.onBeforeRender=function(O,_,T){O.getCurrentViewport(S);const A=O.getRenderTarget(),P=A!==null?A.texture.type:bl;o!==P&&(i.dispose(),s.dispose(),i.type=s.type=P,o=P);const N=S.w/S.z,k=S.z/2,R=S.w/2;let E=16/S.w;if(y.set(E*N,E),w.min.set(S.x,S.y),w.max.set(S.x+(S.z-16),S.y+(S.w-16)),n.setFromMatrixPosition(this.matrixWorld),n.applyMatrix4(T.matrixWorldInverse),!(n.z>0)&&(e.copy(n).applyMatrix4(T.projectionMatrix),x.x=S.x+e.x*k+k-8,x.y=S.y+e.y*R+R-8,w.containsPoint(x))){O.copyFramebufferToTexture(x,i);let D=l.uniforms;D.scale.value=y,D.screenPosition.value=e,O.renderBufferDirect(T,null,a,l,u,null),O.copyFramebufferToTexture(x,s),D=h.uniforms,D.scale.value=y,D.screenPosition.value=e,O.renderBufferDirect(T,null,a,h,u,null);const $=-e.x*2,I=-e.y*2;for(let L=0,U=f.length;L<U;L++){const V=f[L],X=m.uniforms;X.color.value.copy(V.color),X.map.value=V.texture,X.screenPosition.value.x=e.x+$*V.distance,X.screenPosition.value.y=e.y+I*V.distance,E=V.size/S.w;const H=S.w/S.z;X.scale.value.set(E*H,E),m.uniformsNeedUpdate=!0,O.renderBufferDirect(T,null,a,m,v,null)}}},this.dispose=function(){l.dispose(),h.dispose(),m.dispose(),i.dispose(),s.dispose();for(let O=0,_=f.length;O<_;O++)f[O].texture.dispose()}}}class zQ{constructor(e,n=1,i=0,s=new nt(16777215)){this.texture=e,this.size=n,this.distance=i,this.color=s}}zQ.Shader={name:"LensflareElementShader",uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:`

		precision highp float;

		uniform vec3 screenPosition;
		uniform vec2 scale;

		uniform sampler2D occlusionMap;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vUV = uv;

			vec2 pos = position.xy;

			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );

			vVisibility =        visibility.r / 9.0;
			vVisibility *= 1.0 - visibility.g / 9.0;
			vVisibility *=       visibility.b / 9.0;

			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D map;
		uniform vec3 color;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vec4 texture = texture2D( map, vUV );
			texture.a *= vVisibility;
			gl_FragColor = texture;
			gl_FragColor.rgb *= color;

		}`};RS.Geometry=function(){const r=new vi,e=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),n=new c0(e,5);return r.setIndex([0,1,2,0,2,3]),r.setAttribute("position",new fc(n,3,0,!1)),r.setAttribute("uv",new fc(n,2,3,!1)),r}();fs.clamp;fs.lerp;async function OMe(r){return await sSe(KEe,r)}const SMe=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","args"],R2=xh({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:Jc.ROTATE,TWO:Jc.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(r,{expose:e,emit:n}){const i=r,s=n,{makeDefault:o,autoRotate:a,autoRotateSpeed:l,enableDamping:h,dampingFactor:u,enablePan:f,keyPanSpeed:p,maxAzimuthAngle:m,minAzimuthAngle:v,maxPolarAngle:y,minPolarAngle:x,minDistance:w,maxDistance:S,minZoom:O,maxZoom:_,enableZoom:T,zoomSpeed:A,enableRotate:P,touches:N,rotateSpeed:k,target:R}=wb(i),{camera:E,renderer:D,extend:$,controls:I}=v4(),L=ot(null);$({OrbitControls:WEe}),Gi(L,X=>{U(),X&&o.value?I.value=X:I.value=null});function U(){VM(L.value,"change",()=>s("change",L.value)),VM(L.value,"start",()=>s("start",L.value)),VM(L.value,"end",()=>s("end",L.value))}const{onLoop:V}=Ep();return V(()=>{L.value&&(h.value||a.value)&&L.value.update()}),Po(()=>{L.value&&L.value.dispose()}),e({value:L}),(X,H)=>(X.camera||oi(E))&&(X.domElement||oi(D))?(ri(),Ji("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:L,target:oi(R),"auto-rotate":oi(a),"auto-rotate-speed":oi(l),"enable-damping":oi(h),"damping-factor":oi(u),"enable-pan":oi(f),"key-pan-speed":oi(p),keys:X.keys,"max-azimuth-angle":oi(m),"min-azimuth-angle":oi(v),"max-polar-angle":oi(y),"min-polar-angle":oi(x),"min-distance":oi(w),"max-distance":oi(S),"min-zoom":oi(O),"max-zoom":oi(_),touches:oi(N),"enable-zoom":oi(T),"zoom-speed":oi(A),"enable-rotate":oi(P),"rotate-speed":oi(k),args:[X.camera||oi(E),X.domElement||oi(D).domElement]},null,8,SMe)):WC("",!0)}});var FM;/Mac/.test((FM=globalThis==null?void 0:globalThis.navigator)===null||FM===void 0?void 0:FM.platform);var CMe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function y_(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var TMe={exports:{}};(function(r,e){(function(n){r.exports=n()})(function(){return function n(i,s,o){function a(u,f){if(!s[u]){if(!i[u]){var p=typeof y_=="function"&&y_;if(!f&&p)return p(u,!0);if(l)return l(u,!0);throw new Error("Cannot find module '"+u+"'")}f=s[u]={exports:{}},i[u][0].call(f.exports,function(m){var v=i[u][1][m];return a(v||m)},f,f.exports,n,i,s,o)}return s[u].exports}for(var l=typeof y_=="function"&&y_,h=0;h<o.length;h++)a(o[h]);return a}({1:[function(n,i,s){(function(o,a,l,h,u,f,p,m,v){var y=n("crypto");function x(P,N){N=O(P,N);var k;return(k=N.algorithm!=="passthrough"?y.createHash(N.algorithm):new A).write===void 0&&(k.write=k.update,k.end=k.update),T(N,k).dispatch(P),k.update||k.end(""),k.digest?k.digest(N.encoding==="buffer"?void 0:N.encoding):(P=k.read(),N.encoding!=="buffer"?P.toString(N.encoding):P)}(s=i.exports=x).sha1=function(P){return x(P)},s.keys=function(P){return x(P,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},s.MD5=function(P){return x(P,{algorithm:"md5",encoding:"hex"})},s.keysMD5=function(P){return x(P,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var w=y.getHashes?y.getHashes().slice():["sha1","md5"],S=(w.push("passthrough"),["buffer","hex","binary","base64"]);function O(P,N){var k={};if(k.algorithm=(N=N||{}).algorithm||"sha1",k.encoding=N.encoding||"hex",k.excludeValues=!!N.excludeValues,k.algorithm=k.algorithm.toLowerCase(),k.encoding=k.encoding.toLowerCase(),k.ignoreUnknown=N.ignoreUnknown===!0,k.respectType=N.respectType!==!1,k.respectFunctionNames=N.respectFunctionNames!==!1,k.respectFunctionProperties=N.respectFunctionProperties!==!1,k.unorderedArrays=N.unorderedArrays===!0,k.unorderedSets=N.unorderedSets!==!1,k.unorderedObjects=N.unorderedObjects!==!1,k.replacer=N.replacer||void 0,k.excludeKeys=N.excludeKeys||void 0,P===void 0)throw new Error("Object argument required.");for(var R=0;R<w.length;++R)w[R].toLowerCase()===k.algorithm.toLowerCase()&&(k.algorithm=w[R]);if(w.indexOf(k.algorithm)===-1)throw new Error('Algorithm "'+k.algorithm+'"  not supported. supported values: '+w.join(", "));if(S.indexOf(k.encoding)===-1&&k.algorithm!=="passthrough")throw new Error('Encoding "'+k.encoding+'"  not supported. supported values: '+S.join(", "));return k}function _(P){if(typeof P=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(P))!=null}function T(P,N,k){k=k||[];function R(E){return N.update?N.update(E,"utf8"):N.write(E,"utf8")}return{dispatch:function(E){return this["_"+((E=P.replacer?P.replacer(E):E)===null?"null":typeof E)](E)},_object:function(E){var D,$=Object.prototype.toString.call(E),I=/\[object (.*)\]/i.exec($);if(I=(I=I?I[1]:"unknown:["+$+"]").toLowerCase(),0<=($=k.indexOf(E)))return this.dispatch("[CIRCULAR:"+$+"]");if(k.push(E),l!==void 0&&l.isBuffer&&l.isBuffer(E))return R("buffer:"),R(E);if(I==="object"||I==="function"||I==="asyncfunction")return $=Object.keys(E),P.unorderedObjects&&($=$.sort()),P.respectType===!1||_(E)||$.splice(0,0,"prototype","__proto__","constructor"),P.excludeKeys&&($=$.filter(function(L){return!P.excludeKeys(L)})),R("object:"+$.length+":"),D=this,$.forEach(function(L){D.dispatch(L),R(":"),P.excludeValues||D.dispatch(E[L]),R(",")});if(!this["_"+I]){if(P.ignoreUnknown)return R("["+I+"]");throw new Error('Unknown object type "'+I+'"')}this["_"+I](E)},_array:function(E,L){L=L!==void 0?L:P.unorderedArrays!==!1;var $=this;if(R("array:"+E.length+":"),!L||E.length<=1)return E.forEach(function(U){return $.dispatch(U)});var I=[],L=E.map(function(U){var V=new A,X=k.slice();return T(P,V,X).dispatch(U),I=I.concat(X.slice(k.length)),V.read().toString()});return k=k.concat(I),L.sort(),this._array(L,!1)},_date:function(E){return R("date:"+E.toJSON())},_symbol:function(E){return R("symbol:"+E.toString())},_error:function(E){return R("error:"+E.toString())},_boolean:function(E){return R("bool:"+E.toString())},_string:function(E){R("string:"+E.length+":"),R(E.toString())},_function:function(E){R("fn:"),_(E)?this.dispatch("[native]"):this.dispatch(E.toString()),P.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(E.name)),P.respectFunctionProperties&&this._object(E)},_number:function(E){return R("number:"+E.toString())},_xml:function(E){return R("xml:"+E.toString())},_null:function(){return R("Null")},_undefined:function(){return R("Undefined")},_regexp:function(E){return R("regex:"+E.toString())},_uint8array:function(E){return R("uint8array:"),this.dispatch(Array.prototype.slice.call(E))},_uint8clampedarray:function(E){return R("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(E))},_int8array:function(E){return R("int8array:"),this.dispatch(Array.prototype.slice.call(E))},_uint16array:function(E){return R("uint16array:"),this.dispatch(Array.prototype.slice.call(E))},_int16array:function(E){return R("int16array:"),this.dispatch(Array.prototype.slice.call(E))},_uint32array:function(E){return R("uint32array:"),this.dispatch(Array.prototype.slice.call(E))},_int32array:function(E){return R("int32array:"),this.dispatch(Array.prototype.slice.call(E))},_float32array:function(E){return R("float32array:"),this.dispatch(Array.prototype.slice.call(E))},_float64array:function(E){return R("float64array:"),this.dispatch(Array.prototype.slice.call(E))},_arraybuffer:function(E){return R("arraybuffer:"),this.dispatch(new Uint8Array(E))},_url:function(E){return R("url:"+E.toString())},_map:function(E){return R("map:"),E=Array.from(E),this._array(E,P.unorderedSets!==!1)},_set:function(E){return R("set:"),E=Array.from(E),this._array(E,P.unorderedSets!==!1)},_file:function(E){return R("file:"),this.dispatch([E.name,E.size,E.type,E.lastModfied])},_blob:function(){if(P.ignoreUnknown)return R("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return R("domwindow")},_bigint:function(E){return R("bigint:"+E.toString())},_process:function(){return R("process")},_timer:function(){return R("timer")},_pipe:function(){return R("pipe")},_tcp:function(){return R("tcp")},_udp:function(){return R("udp")},_tty:function(){return R("tty")},_statwatcher:function(){return R("statwatcher")},_securecontext:function(){return R("securecontext")},_connection:function(){return R("connection")},_zlib:function(){return R("zlib")},_context:function(){return R("context")},_nodescript:function(){return R("nodescript")},_httpparser:function(){return R("httpparser")},_dataview:function(){return R("dataview")},_signal:function(){return R("signal")},_fsevent:function(){return R("fsevent")},_tlswrap:function(){return R("tlswrap")}}}function A(){return{buf:"",write:function(P){this.buf+=P},end:function(P){this.buf+=P},read:function(){return this.buf}}}s.writeToStream=function(P,N,k){return k===void 0&&(k=N,N={}),T(N=O(P,N),k).dispatch(P)}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(n,i,s){(function(o,a,l,h,u,f,p,m,v){(function(y){var x=typeof Uint8Array<"u"?Uint8Array:Array,w=43,S=47,O=48,_=97,T=65,A=45,P=95;function N(k){return k=k.charCodeAt(0),k===w||k===A?62:k===S||k===P?63:k<O?-1:k<O+10?k-O+26+26:k<T+26?k-T:k<_+26?k-_+26:void 0}y.toByteArray=function(k){var R,E;if(0<k.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var D=k.length,D=k.charAt(D-2)==="="?2:k.charAt(D-1)==="="?1:0,$=new x(3*k.length/4-D),I=0<D?k.length-4:k.length,L=0;function U(V){$[L++]=V}for(R=0;R<I;R+=4,0)U((16711680&(E=N(k.charAt(R))<<18|N(k.charAt(R+1))<<12|N(k.charAt(R+2))<<6|N(k.charAt(R+3))))>>16),U((65280&E)>>8),U(255&E);return D==2?U(255&(E=N(k.charAt(R))<<2|N(k.charAt(R+1))>>4)):D==1&&(U((E=N(k.charAt(R))<<10|N(k.charAt(R+1))<<4|N(k.charAt(R+2))>>2)>>8&255),U(255&E)),$},y.fromByteArray=function(k){var R,E,D,$,I=k.length%3,L="";function U(V){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(V)}for(R=0,D=k.length-I;R<D;R+=3)E=(k[R]<<16)+(k[R+1]<<8)+k[R+2],L+=U(($=E)>>18&63)+U($>>12&63)+U($>>6&63)+U(63&$);switch(I){case 1:L=(L+=U((E=k[k.length-1])>>2))+U(E<<4&63)+"==";break;case 2:L=(L=(L+=U((E=(k[k.length-2]<<8)+k[k.length-1])>>10))+U(E>>4&63))+U(E<<2&63)+"="}return L}})(s===void 0?this.base64js={}:s)}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(n,i,s){(function(o,a,w,h,u,f,p,m,v){var y=n("base64-js"),x=n("ieee754");function w(Q,z,j){if(!(this instanceof w))return new w(Q,z,j);var te,W,Z,he,pe=typeof Q;if(z==="base64"&&pe=="string")for(Q=(he=Q).trim?he.trim():he.replace(/^\s+|\s+$/g,"");Q.length%4!=0;)Q+="=";if(pe=="number")te=H(Q);else if(pe=="string")te=w.byteLength(Q,z);else{if(pe!="object")throw new Error("First argument needs to be a number, array or string.");te=H(Q.length)}if(w._useTypedArrays?W=w._augment(new Uint8Array(te)):((W=this).length=te,W._isBuffer=!0),w._useTypedArrays&&typeof Q.byteLength=="number")W._set(Q);else if(J(he=Q)||w.isBuffer(he)||he&&typeof he=="object"&&typeof he.length=="number")for(Z=0;Z<te;Z++)w.isBuffer(Q)?W[Z]=Q.readUInt8(Z):W[Z]=Q[Z];else if(pe=="string")W.write(Q,0,z);else if(pe=="number"&&!w._useTypedArrays&&!j)for(Z=0;Z<te;Z++)W[Z]=0;return W}function S(Q,z,j,te){return w._charsWritten=ye(function(W){for(var Z=[],he=0;he<W.length;he++)Z.push(255&W.charCodeAt(he));return Z}(z),Q,j,te)}function O(Q,z,j,te){return w._charsWritten=ye(function(W){for(var Z,he,pe=[],_e=0;_e<W.length;_e++)he=W.charCodeAt(_e),Z=he>>8,he=he%256,pe.push(he),pe.push(Z);return pe}(z),Q,j,te)}function _(Q,z,j){var te="";j=Math.min(Q.length,j);for(var W=z;W<j;W++)te+=String.fromCharCode(Q[W]);return te}function T(Q,z,j,Z){Z||(ae(typeof j=="boolean","missing or invalid endian"),ae(z!=null,"missing offset"),ae(z+1<Q.length,"Trying to read beyond buffer length"));var W,Z=Q.length;if(!(Z<=z))return j?(W=Q[z],z+1<Z&&(W|=Q[z+1]<<8)):(W=Q[z]<<8,z+1<Z&&(W|=Q[z+1])),W}function A(Q,z,j,Z){Z||(ae(typeof j=="boolean","missing or invalid endian"),ae(z!=null,"missing offset"),ae(z+3<Q.length,"Trying to read beyond buffer length"));var W,Z=Q.length;if(!(Z<=z))return j?(z+2<Z&&(W=Q[z+2]<<16),z+1<Z&&(W|=Q[z+1]<<8),W|=Q[z],z+3<Z&&(W+=Q[z+3]<<24>>>0)):(z+1<Z&&(W=Q[z+1]<<16),z+2<Z&&(W|=Q[z+2]<<8),z+3<Z&&(W|=Q[z+3]),W+=Q[z]<<24>>>0),W}function P(Q,z,j,te){if(te||(ae(typeof j=="boolean","missing or invalid endian"),ae(z!=null,"missing offset"),ae(z+1<Q.length,"Trying to read beyond buffer length")),!(Q.length<=z))return te=T(Q,z,j,!0),32768&te?-1*(65535-te+1):te}function N(Q,z,j,te){if(te||(ae(typeof j=="boolean","missing or invalid endian"),ae(z!=null,"missing offset"),ae(z+3<Q.length,"Trying to read beyond buffer length")),!(Q.length<=z))return te=A(Q,z,j,!0),2147483648&te?-1*(4294967295-te+1):te}function k(Q,z,j,te){return te||(ae(typeof j=="boolean","missing or invalid endian"),ae(z+3<Q.length,"Trying to read beyond buffer length")),x.read(Q,z,j,23,4)}function R(Q,z,j,te){return te||(ae(typeof j=="boolean","missing or invalid endian"),ae(z+7<Q.length,"Trying to read beyond buffer length")),x.read(Q,z,j,52,8)}function E(Q,z,j,te,W){if(W||(ae(z!=null,"missing value"),ae(typeof te=="boolean","missing or invalid endian"),ae(j!=null,"missing offset"),ae(j+1<Q.length,"trying to write beyond buffer length"),we(z,65535)),W=Q.length,!(W<=j))for(var Z=0,he=Math.min(W-j,2);Z<he;Z++)Q[j+Z]=(z&255<<8*(te?Z:1-Z))>>>8*(te?Z:1-Z)}function D(Q,z,j,te,W){if(W||(ae(z!=null,"missing value"),ae(typeof te=="boolean","missing or invalid endian"),ae(j!=null,"missing offset"),ae(j+3<Q.length,"trying to write beyond buffer length"),we(z,4294967295)),W=Q.length,!(W<=j))for(var Z=0,he=Math.min(W-j,4);Z<he;Z++)Q[j+Z]=z>>>8*(te?Z:3-Z)&255}function $(Q,z,j,te,W){W||(ae(z!=null,"missing value"),ae(typeof te=="boolean","missing or invalid endian"),ae(j!=null,"missing offset"),ae(j+1<Q.length,"Trying to write beyond buffer length"),be(z,32767,-32768)),Q.length<=j||E(Q,0<=z?z:65535+z+1,j,te,W)}function I(Q,z,j,te,W){W||(ae(z!=null,"missing value"),ae(typeof te=="boolean","missing or invalid endian"),ae(j!=null,"missing offset"),ae(j+3<Q.length,"Trying to write beyond buffer length"),be(z,2147483647,-2147483648)),Q.length<=j||D(Q,0<=z?z:4294967295+z+1,j,te,W)}function L(Q,z,j,te,W){W||(ae(z!=null,"missing value"),ae(typeof te=="boolean","missing or invalid endian"),ae(j!=null,"missing offset"),ae(j+3<Q.length,"Trying to write beyond buffer length"),se(z,34028234663852886e22,-34028234663852886e22)),Q.length<=j||x.write(Q,z,j,te,23,4)}function U(Q,z,j,te,W){W||(ae(z!=null,"missing value"),ae(typeof te=="boolean","missing or invalid endian"),ae(j!=null,"missing offset"),ae(j+7<Q.length,"Trying to write beyond buffer length"),se(z,17976931348623157e292,-17976931348623157e292)),Q.length<=j||x.write(Q,z,j,te,52,8)}s.Buffer=w,s.SlowBuffer=w,s.INSPECT_MAX_BYTES=50,w.poolSize=8192,w._useTypedArrays=function(){try{var Q=new ArrayBuffer(0),z=new Uint8Array(Q);return z.foo=function(){return 42},z.foo()===42&&typeof z.subarray=="function"}catch{return!1}}(),w.isEncoding=function(Q){switch(String(Q).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},w.isBuffer=function(Q){return!(Q==null||!Q._isBuffer)},w.byteLength=function(Q,z){var j;switch(Q+="",z||"utf8"){case"hex":j=Q.length/2;break;case"utf8":case"utf-8":j=ne(Q).length;break;case"ascii":case"binary":case"raw":j=Q.length;break;case"base64":j=ge(Q).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":j=2*Q.length;break;default:throw new Error("Unknown encoding")}return j},w.concat=function(Q,z){if(ae(J(Q),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),Q.length===0)return new w(0);if(Q.length===1)return Q[0];if(typeof z!="number")for(W=z=0;W<Q.length;W++)z+=Q[W].length;for(var j=new w(z),te=0,W=0;W<Q.length;W++){var Z=Q[W];Z.copy(j,te),te+=Z.length}return j},w.prototype.write=function(Q,z,j,te){isFinite(z)?isFinite(j)||(te=j,j=void 0):(_e=te,te=z,z=j,j=_e),z=Number(z)||0;var W,Z,he,pe,_e=this.length-z;switch((!j||_e<(j=Number(j)))&&(j=_e),te=String(te||"utf8").toLowerCase()){case"hex":W=function(Re,ie,q,me){q=Number(q)||0;var ve=Re.length-q;(!me||ve<(me=Number(me)))&&(me=ve),ae((ve=ie.length)%2==0,"Invalid hex string"),ve/2<me&&(me=ve/2);for(var Te=0;Te<me;Te++){var ke=parseInt(ie.substr(2*Te,2),16);ae(!isNaN(ke),"Invalid hex string"),Re[q+Te]=ke}return w._charsWritten=2*Te,Te}(this,Q,z,j);break;case"utf8":case"utf-8":Z=this,he=z,pe=j,W=w._charsWritten=ye(ne(Q),Z,he,pe);break;case"ascii":case"binary":W=S(this,Q,z,j);break;case"base64":Z=this,he=z,pe=j,W=w._charsWritten=ye(ge(Q),Z,he,pe);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":W=O(this,Q,z,j);break;default:throw new Error("Unknown encoding")}return W},w.prototype.toString=function(Q,z,j){var te,W,Z,he,pe=this;if(Q=String(Q||"utf8").toLowerCase(),z=Number(z)||0,(j=j!==void 0?Number(j):pe.length)===z)return"";switch(Q){case"hex":te=function(_e,Re,ie){var q=_e.length;(!Re||Re<0)&&(Re=0),(!ie||ie<0||q<ie)&&(ie=q);for(var me="",ve=Re;ve<ie;ve++)me+=ee(_e[ve]);return me}(pe,z,j);break;case"utf8":case"utf-8":te=function(_e,Re,ie){var q="",me="";ie=Math.min(_e.length,ie);for(var ve=Re;ve<ie;ve++)_e[ve]<=127?(q+=ce(me)+String.fromCharCode(_e[ve]),me=""):me+="%"+_e[ve].toString(16);return q+ce(me)}(pe,z,j);break;case"ascii":case"binary":te=_(pe,z,j);break;case"base64":W=pe,he=j,te=(Z=z)===0&&he===W.length?y.fromByteArray(W):y.fromByteArray(W.slice(Z,he));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":te=function(_e,Re,ie){for(var q=_e.slice(Re,ie),me="",ve=0;ve<q.length;ve+=2)me+=String.fromCharCode(q[ve]+256*q[ve+1]);return me}(pe,z,j);break;default:throw new Error("Unknown encoding")}return te},w.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},w.prototype.copy=function(Q,z,j,te){if(z=z||0,(te=te||te===0?te:this.length)!==(j=j||0)&&Q.length!==0&&this.length!==0){ae(j<=te,"sourceEnd < sourceStart"),ae(0<=z&&z<Q.length,"targetStart out of bounds"),ae(0<=j&&j<this.length,"sourceStart out of bounds"),ae(0<=te&&te<=this.length,"sourceEnd out of bounds"),te>this.length&&(te=this.length);var W=(te=Q.length-z<te-j?Q.length-z+j:te)-j;if(W<100||!w._useTypedArrays)for(var Z=0;Z<W;Z++)Q[Z+z]=this[Z+j];else Q._set(this.subarray(j,j+W),z)}},w.prototype.slice=function(Q,z){var j=this.length;if(Q=X(Q,j,0),z=X(z,j,j),w._useTypedArrays)return w._augment(this.subarray(Q,z));for(var te=z-Q,W=new w(te,void 0,!0),Z=0;Z<te;Z++)W[Z]=this[Z+Q];return W},w.prototype.get=function(Q){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(Q)},w.prototype.set=function(Q,z){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(Q,z)},w.prototype.readUInt8=function(Q,z){if(z||(ae(Q!=null,"missing offset"),ae(Q<this.length,"Trying to read beyond buffer length")),!(Q>=this.length))return this[Q]},w.prototype.readUInt16LE=function(Q,z){return T(this,Q,!0,z)},w.prototype.readUInt16BE=function(Q,z){return T(this,Q,!1,z)},w.prototype.readUInt32LE=function(Q,z){return A(this,Q,!0,z)},w.prototype.readUInt32BE=function(Q,z){return A(this,Q,!1,z)},w.prototype.readInt8=function(Q,z){if(z||(ae(Q!=null,"missing offset"),ae(Q<this.length,"Trying to read beyond buffer length")),!(Q>=this.length))return 128&this[Q]?-1*(255-this[Q]+1):this[Q]},w.prototype.readInt16LE=function(Q,z){return P(this,Q,!0,z)},w.prototype.readInt16BE=function(Q,z){return P(this,Q,!1,z)},w.prototype.readInt32LE=function(Q,z){return N(this,Q,!0,z)},w.prototype.readInt32BE=function(Q,z){return N(this,Q,!1,z)},w.prototype.readFloatLE=function(Q,z){return k(this,Q,!0,z)},w.prototype.readFloatBE=function(Q,z){return k(this,Q,!1,z)},w.prototype.readDoubleLE=function(Q,z){return R(this,Q,!0,z)},w.prototype.readDoubleBE=function(Q,z){return R(this,Q,!1,z)},w.prototype.writeUInt8=function(Q,z,j){j||(ae(Q!=null,"missing value"),ae(z!=null,"missing offset"),ae(z<this.length,"trying to write beyond buffer length"),we(Q,255)),z>=this.length||(this[z]=Q)},w.prototype.writeUInt16LE=function(Q,z,j){E(this,Q,z,!0,j)},w.prototype.writeUInt16BE=function(Q,z,j){E(this,Q,z,!1,j)},w.prototype.writeUInt32LE=function(Q,z,j){D(this,Q,z,!0,j)},w.prototype.writeUInt32BE=function(Q,z,j){D(this,Q,z,!1,j)},w.prototype.writeInt8=function(Q,z,j){j||(ae(Q!=null,"missing value"),ae(z!=null,"missing offset"),ae(z<this.length,"Trying to write beyond buffer length"),be(Q,127,-128)),z>=this.length||(0<=Q?this.writeUInt8(Q,z,j):this.writeUInt8(255+Q+1,z,j))},w.prototype.writeInt16LE=function(Q,z,j){$(this,Q,z,!0,j)},w.prototype.writeInt16BE=function(Q,z,j){$(this,Q,z,!1,j)},w.prototype.writeInt32LE=function(Q,z,j){I(this,Q,z,!0,j)},w.prototype.writeInt32BE=function(Q,z,j){I(this,Q,z,!1,j)},w.prototype.writeFloatLE=function(Q,z,j){L(this,Q,z,!0,j)},w.prototype.writeFloatBE=function(Q,z,j){L(this,Q,z,!1,j)},w.prototype.writeDoubleLE=function(Q,z,j){U(this,Q,z,!0,j)},w.prototype.writeDoubleBE=function(Q,z,j){U(this,Q,z,!1,j)},w.prototype.fill=function(Q,z,j){if(z=z||0,j=j||this.length,ae(typeof(Q=typeof(Q=Q||0)=="string"?Q.charCodeAt(0):Q)=="number"&&!isNaN(Q),"value is not a number"),ae(z<=j,"end < start"),j!==z&&this.length!==0){ae(0<=z&&z<this.length,"start out of bounds"),ae(0<=j&&j<=this.length,"end out of bounds");for(var te=z;te<j;te++)this[te]=Q}},w.prototype.inspect=function(){for(var Q=[],z=this.length,j=0;j<z;j++)if(Q[j]=ee(this[j]),j===s.INSPECT_MAX_BYTES){Q[j+1]="...";break}return"<Buffer "+Q.join(" ")+">"},w.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(w._useTypedArrays)return new w(this).buffer;for(var Q=new Uint8Array(this.length),z=0,j=Q.length;z<j;z+=1)Q[z]=this[z];return Q.buffer};var V=w.prototype;function X(Q,z,j){return typeof Q!="number"?j:z<=(Q=~~Q)?z:0<=Q||0<=(Q+=z)?Q:0}function H(Q){return(Q=~~Math.ceil(+Q))<0?0:Q}function J(Q){return(Array.isArray||function(z){return Object.prototype.toString.call(z)==="[object Array]"})(Q)}function ee(Q){return Q<16?"0"+Q.toString(16):Q.toString(16)}function ne(Q){for(var z=[],j=0;j<Q.length;j++){var te=Q.charCodeAt(j);if(te<=127)z.push(Q.charCodeAt(j));else for(var W=j,Z=(55296<=te&&te<=57343&&j++,encodeURIComponent(Q.slice(W,j+1)).substr(1).split("%")),he=0;he<Z.length;he++)z.push(parseInt(Z[he],16))}return z}function ge(Q){return y.toByteArray(Q)}function ye(Q,z,j,te){for(var W=0;W<te&&!(W+j>=z.length||W>=Q.length);W++)z[W+j]=Q[W];return W}function ce(Q){try{return decodeURIComponent(Q)}catch{return"�"}}function we(Q,z){ae(typeof Q=="number","cannot write a non-number as a number"),ae(0<=Q,"specified a negative value for writing an unsigned value"),ae(Q<=z,"value is larger than maximum value for type"),ae(Math.floor(Q)===Q,"value has a fractional component")}function be(Q,z,j){ae(typeof Q=="number","cannot write a non-number as a number"),ae(Q<=z,"value larger than maximum allowed value"),ae(j<=Q,"value smaller than minimum allowed value"),ae(Math.floor(Q)===Q,"value has a fractional component")}function se(Q,z,j){ae(typeof Q=="number","cannot write a non-number as a number"),ae(Q<=z,"value larger than maximum allowed value"),ae(j<=Q,"value smaller than minimum allowed value")}function ae(Q,z){if(!Q)throw new Error(z||"Failed assertion")}w._augment=function(Q){return Q._isBuffer=!0,Q._get=Q.get,Q._set=Q.set,Q.get=V.get,Q.set=V.set,Q.write=V.write,Q.toString=V.toString,Q.toLocaleString=V.toString,Q.toJSON=V.toJSON,Q.copy=V.copy,Q.slice=V.slice,Q.readUInt8=V.readUInt8,Q.readUInt16LE=V.readUInt16LE,Q.readUInt16BE=V.readUInt16BE,Q.readUInt32LE=V.readUInt32LE,Q.readUInt32BE=V.readUInt32BE,Q.readInt8=V.readInt8,Q.readInt16LE=V.readInt16LE,Q.readInt16BE=V.readInt16BE,Q.readInt32LE=V.readInt32LE,Q.readInt32BE=V.readInt32BE,Q.readFloatLE=V.readFloatLE,Q.readFloatBE=V.readFloatBE,Q.readDoubleLE=V.readDoubleLE,Q.readDoubleBE=V.readDoubleBE,Q.writeUInt8=V.writeUInt8,Q.writeUInt16LE=V.writeUInt16LE,Q.writeUInt16BE=V.writeUInt16BE,Q.writeUInt32LE=V.writeUInt32LE,Q.writeUInt32BE=V.writeUInt32BE,Q.writeInt8=V.writeInt8,Q.writeInt16LE=V.writeInt16LE,Q.writeInt16BE=V.writeInt16BE,Q.writeInt32LE=V.writeInt32LE,Q.writeInt32BE=V.writeInt32BE,Q.writeFloatLE=V.writeFloatLE,Q.writeFloatBE=V.writeFloatBE,Q.writeDoubleLE=V.writeDoubleLE,Q.writeDoubleBE=V.writeDoubleBE,Q.fill=V.fill,Q.inspect=V.inspect,Q.toArrayBuffer=V.toArrayBuffer,Q}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(n,i,s){(function(o,a,y,h,u,f,p,m,v){var y=n("buffer").Buffer,x=4,w=new y(x);w.fill(0),i.exports={hash:function(S,O,_,T){for(var A=O(function(E,D){E.length%x!=0&&($=E.length+(x-E.length%x),E=y.concat([E,w],$));for(var $,I=[],L=D?E.readInt32BE:E.readInt32LE,U=0;U<E.length;U+=x)I.push(L.call(E,U));return I}(S=y.isBuffer(S)?S:new y(S),T),8*S.length),O=T,P=new y(_),N=O?P.writeInt32BE:P.writeInt32LE,k=0;k<A.length;k++)N.call(P,A[k],4*k,!0);return P}}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(n,i,s){(function(o,a,y,h,u,f,p,m,v){var y=n("buffer").Buffer,x=n("./sha"),w=n("./sha256"),S=n("./rng"),O={sha1:x,sha256:w,md5:n("./md5")},_=64,T=new y(_);function A(E,D){var $=O[E=E||"sha1"],I=[];return $||P("algorithm:",E,"is not yet supported"),{update:function(L){return y.isBuffer(L)||(L=new y(L)),I.push(L),L.length,this},digest:function(L){var U=y.concat(I),U=D?function(V,X,H){y.isBuffer(X)||(X=new y(X)),y.isBuffer(H)||(H=new y(H)),X.length>_?X=V(X):X.length<_&&(X=y.concat([X,T],_));for(var J=new y(_),ee=new y(_),ne=0;ne<_;ne++)J[ne]=54^X[ne],ee[ne]=92^X[ne];return H=V(y.concat([J,H])),V(y.concat([ee,H]))}($,D,U):$(U);return I=null,L?U.toString(L):U}}}function P(){var E=[].slice.call(arguments).join(" ");throw new Error([E,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}T.fill(0),s.createHash=function(E){return A(E)},s.createHmac=A,s.randomBytes=function(E,D){if(!D||!D.call)return new y(S(E));try{D.call(this,void 0,new y(S(E)))}catch($){D($)}};var N,k=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],R=function(E){s[E]=function(){P("sorry,",E,"is not implemented yet")}};for(N in k)R(k[N])}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(n,i,s){(function(o,a,l,h,u,f,p,m,v){var y=n("./helpers");function x(P,N){P[N>>5]|=128<<N%32,P[14+(N+64>>>9<<4)]=N;for(var k=1732584193,R=-271733879,E=-1732584194,D=271733878,$=0;$<P.length;$+=16){var I=k,L=R,U=E,V=D,k=S(k,R,E,D,P[$+0],7,-680876936),D=S(D,k,R,E,P[$+1],12,-389564586),E=S(E,D,k,R,P[$+2],17,606105819),R=S(R,E,D,k,P[$+3],22,-1044525330);k=S(k,R,E,D,P[$+4],7,-176418897),D=S(D,k,R,E,P[$+5],12,1200080426),E=S(E,D,k,R,P[$+6],17,-1473231341),R=S(R,E,D,k,P[$+7],22,-45705983),k=S(k,R,E,D,P[$+8],7,1770035416),D=S(D,k,R,E,P[$+9],12,-1958414417),E=S(E,D,k,R,P[$+10],17,-42063),R=S(R,E,D,k,P[$+11],22,-1990404162),k=S(k,R,E,D,P[$+12],7,1804603682),D=S(D,k,R,E,P[$+13],12,-40341101),E=S(E,D,k,R,P[$+14],17,-1502002290),k=O(k,R=S(R,E,D,k,P[$+15],22,1236535329),E,D,P[$+1],5,-165796510),D=O(D,k,R,E,P[$+6],9,-1069501632),E=O(E,D,k,R,P[$+11],14,643717713),R=O(R,E,D,k,P[$+0],20,-373897302),k=O(k,R,E,D,P[$+5],5,-701558691),D=O(D,k,R,E,P[$+10],9,38016083),E=O(E,D,k,R,P[$+15],14,-660478335),R=O(R,E,D,k,P[$+4],20,-405537848),k=O(k,R,E,D,P[$+9],5,568446438),D=O(D,k,R,E,P[$+14],9,-1019803690),E=O(E,D,k,R,P[$+3],14,-187363961),R=O(R,E,D,k,P[$+8],20,1163531501),k=O(k,R,E,D,P[$+13],5,-1444681467),D=O(D,k,R,E,P[$+2],9,-51403784),E=O(E,D,k,R,P[$+7],14,1735328473),k=_(k,R=O(R,E,D,k,P[$+12],20,-1926607734),E,D,P[$+5],4,-378558),D=_(D,k,R,E,P[$+8],11,-2022574463),E=_(E,D,k,R,P[$+11],16,1839030562),R=_(R,E,D,k,P[$+14],23,-35309556),k=_(k,R,E,D,P[$+1],4,-1530992060),D=_(D,k,R,E,P[$+4],11,1272893353),E=_(E,D,k,R,P[$+7],16,-155497632),R=_(R,E,D,k,P[$+10],23,-1094730640),k=_(k,R,E,D,P[$+13],4,681279174),D=_(D,k,R,E,P[$+0],11,-358537222),E=_(E,D,k,R,P[$+3],16,-722521979),R=_(R,E,D,k,P[$+6],23,76029189),k=_(k,R,E,D,P[$+9],4,-640364487),D=_(D,k,R,E,P[$+12],11,-421815835),E=_(E,D,k,R,P[$+15],16,530742520),k=T(k,R=_(R,E,D,k,P[$+2],23,-995338651),E,D,P[$+0],6,-198630844),D=T(D,k,R,E,P[$+7],10,1126891415),E=T(E,D,k,R,P[$+14],15,-1416354905),R=T(R,E,D,k,P[$+5],21,-57434055),k=T(k,R,E,D,P[$+12],6,1700485571),D=T(D,k,R,E,P[$+3],10,-1894986606),E=T(E,D,k,R,P[$+10],15,-1051523),R=T(R,E,D,k,P[$+1],21,-2054922799),k=T(k,R,E,D,P[$+8],6,1873313359),D=T(D,k,R,E,P[$+15],10,-30611744),E=T(E,D,k,R,P[$+6],15,-1560198380),R=T(R,E,D,k,P[$+13],21,1309151649),k=T(k,R,E,D,P[$+4],6,-145523070),D=T(D,k,R,E,P[$+11],10,-1120210379),E=T(E,D,k,R,P[$+2],15,718787259),R=T(R,E,D,k,P[$+9],21,-343485551),k=A(k,I),R=A(R,L),E=A(E,U),D=A(D,V)}return Array(k,R,E,D)}function w(P,N,k,R,E,D){return A((N=A(A(N,P),A(R,D)))<<E|N>>>32-E,k)}function S(P,N,k,R,E,D,$){return w(N&k|~N&R,P,N,E,D,$)}function O(P,N,k,R,E,D,$){return w(N&R|k&~R,P,N,E,D,$)}function _(P,N,k,R,E,D,$){return w(N^k^R,P,N,E,D,$)}function T(P,N,k,R,E,D,$){return w(k^(N|~R),P,N,E,D,$)}function A(P,N){var k=(65535&P)+(65535&N);return(P>>16)+(N>>16)+(k>>16)<<16|65535&k}i.exports=function(P){return y.hash(P,x,16)}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(n,i,s){(function(o,a,l,h,u,f,p,m,v){i.exports=function(y){for(var x,w=new Array(y),S=0;S<y;S++)!(3&S)&&(x=4294967296*Math.random()),w[S]=x>>>((3&S)<<3)&255;return w}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(n,i,s){(function(o,a,l,h,u,f,p,m,v){var y=n("./helpers");function x(O,_){O[_>>5]|=128<<24-_%32,O[15+(_+64>>9<<4)]=_;for(var T,A,P,N=Array(80),k=1732584193,R=-271733879,E=-1732584194,D=271733878,$=-1009589776,I=0;I<O.length;I+=16){for(var L=k,U=R,V=E,X=D,H=$,J=0;J<80;J++){N[J]=J<16?O[I+J]:S(N[J-3]^N[J-8]^N[J-14]^N[J-16],1);var ee=w(w(S(k,5),(ee=R,A=E,P=D,(T=J)<20?ee&A|~ee&P:!(T<40)&&T<60?ee&A|ee&P|A&P:ee^A^P)),w(w($,N[J]),(T=J)<20?1518500249:T<40?1859775393:T<60?-1894007588:-899497514)),$=D,D=E,E=S(R,30),R=k,k=ee}k=w(k,L),R=w(R,U),E=w(E,V),D=w(D,X),$=w($,H)}return Array(k,R,E,D,$)}function w(O,_){var T=(65535&O)+(65535&_);return(O>>16)+(_>>16)+(T>>16)<<16|65535&T}function S(O,_){return O<<_|O>>>32-_}i.exports=function(O){return y.hash(O,x,20,!0)}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(n,i,s){(function(o,a,l,h,u,f,p,m,v){function y(_,T){var A=(65535&_)+(65535&T);return(_>>16)+(T>>16)+(A>>16)<<16|65535&A}function x(_,T){var A,P=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),N=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),k=new Array(64);_[T>>5]|=128<<24-T%32,_[15+(T+64>>9<<4)]=T;for(var R,E,D=0;D<_.length;D+=16){for(var $=N[0],I=N[1],L=N[2],U=N[3],V=N[4],X=N[5],H=N[6],J=N[7],ee=0;ee<64;ee++)k[ee]=ee<16?_[ee+D]:y(y(y((E=k[ee-2],S(E,17)^S(E,19)^O(E,10)),k[ee-7]),(E=k[ee-15],S(E,7)^S(E,18)^O(E,3))),k[ee-16]),A=y(y(y(y(J,S(E=V,6)^S(E,11)^S(E,25)),V&X^~V&H),P[ee]),k[ee]),R=y(S(R=$,2)^S(R,13)^S(R,22),$&I^$&L^I&L),J=H,H=X,X=V,V=y(U,A),U=L,L=I,I=$,$=y(A,R);N[0]=y($,N[0]),N[1]=y(I,N[1]),N[2]=y(L,N[2]),N[3]=y(U,N[3]),N[4]=y(V,N[4]),N[5]=y(X,N[5]),N[6]=y(H,N[6]),N[7]=y(J,N[7])}return N}var w=n("./helpers"),S=function(_,T){return _>>>T|_<<32-T},O=function(_,T){return _>>>T};i.exports=function(_){return w.hash(_,x,32,!0)}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(n,i,s){(function(o,a,l,h,u,f,p,m,v){s.read=function(y,x,w,S,D){var _,T,A=8*D-S-1,P=(1<<A)-1,N=P>>1,k=-7,R=w?D-1:0,E=w?-1:1,D=y[x+R];for(R+=E,_=D&(1<<-k)-1,D>>=-k,k+=A;0<k;_=256*_+y[x+R],R+=E,k-=8);for(T=_&(1<<-k)-1,_>>=-k,k+=S;0<k;T=256*T+y[x+R],R+=E,k-=8);if(_===0)_=1-N;else{if(_===P)return T?NaN:1/0*(D?-1:1);T+=Math.pow(2,S),_-=N}return(D?-1:1)*T*Math.pow(2,_-S)},s.write=function(y,x,w,S,O,$){var T,A,P=8*$-O-1,N=(1<<P)-1,k=N>>1,R=O===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=S?0:$-1,D=S?1:-1,$=x<0||x===0&&1/x<0?1:0;for(x=Math.abs(x),isNaN(x)||x===1/0?(A=isNaN(x)?1:0,T=N):(T=Math.floor(Math.log(x)/Math.LN2),x*(S=Math.pow(2,-T))<1&&(T--,S*=2),2<=(x+=1<=T+k?R/S:R*Math.pow(2,1-k))*S&&(T++,S/=2),N<=T+k?(A=0,T=N):1<=T+k?(A=(x*S-1)*Math.pow(2,O),T+=k):(A=x*Math.pow(2,k-1)*Math.pow(2,O),T=0));8<=O;y[w+E]=255&A,E+=D,A/=256,O-=8);for(T=T<<O|A,P+=O;0<P;y[w+E]=255&T,E+=D,T/=256,P-=8);y[w+E-D]|=128*$}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(n,i,s){(function(o,a,l,h,u,f,p,m,v){var y,x,w;function S(){}(o=i.exports={}).nextTick=(x=typeof window<"u"&&window.setImmediate,w=typeof window<"u"&&window.postMessage&&window.addEventListener,x?function(O){return window.setImmediate(O)}:w?(y=[],window.addEventListener("message",function(O){var _=O.source;_!==window&&_!==null||O.data!=="process-tick"||(O.stopPropagation(),0<y.length&&y.shift()())},!0),function(O){y.push(O),window.postMessage("process-tick","*")}):function(O){setTimeout(O,0)}),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=S,o.addListener=S,o.once=S,o.off=S,o.removeListener=S,o.removeAllListeners=S,o.emit=S,o.binding=function(O){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(O){throw new Error("process.chdir is not supported")}}).call(this,n("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(TMe);var EMe=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],JP=EMe;JP=JP.slice().filter(function(r){return!/^(gl\_|texture)/.test(r)});JP.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]);function MMe(r,e){if(typeof r!="object"||r===null)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function AMe(r){var e=MMe(r,"string");return typeof e=="symbol"?e:String(e)}function On(r,e,n){return e=AMe(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}var yi={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},lo,Cm;lo={},On(lo,"".concat(yi.normal),{"#include <beginnormal_vertex>":`
    vec3 objectNormal = `.concat(yi.normal,`;
    #ifdef USE_TANGENT
	    vec3 objectTangent = vec3( tangent.xyz );
    #endif
    `)}),On(lo,"".concat(yi.position),{"#include <begin_vertex>":`
    vec3 transformed = `.concat(yi.position,`;
  `)}),On(lo,"".concat(yi.positionRaw),{"#include <begin_vertex>":`
    vec4 csm_internal_positionUnprojected = `.concat(yi.positionRaw,`;
    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;
    #ifdef USE_INSTANCING
      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;
    #endif
    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;
    vec3 transformed = csm_internal_positionUnprojected.xyz;
  `)}),On(lo,"".concat(yi.pointSize),{"gl_PointSize = size;":`
    gl_PointSize = `.concat(yi.pointSize,`;
    `)}),On(lo,"".concat(yi.diffuseColor),{"#include <color_fragment>":`
    #include <color_fragment>
    diffuseColor = `.concat(yi.diffuseColor,`;
  `)}),On(lo,"".concat(yi.fragColor),{"#include <dithering_fragment>":`
    #include <dithering_fragment>
    gl_FragColor  = `.concat(yi.fragColor,`;
  `)}),On(lo,"".concat(yi.emissive),{"vec3 totalEmissiveRadiance = emissive;":`
    vec3 totalEmissiveRadiance = `.concat(yi.emissive,`;
    `)}),On(lo,"".concat(yi.roughness),{"#include <roughnessmap_fragment>":`
    #include <roughnessmap_fragment>
    roughnessFactor = `.concat(yi.roughness,`;
    `)}),On(lo,"".concat(yi.metalness),{"#include <metalnessmap_fragment>":`
    #include <metalnessmap_fragment>
    metalnessFactor = `.concat(yi.metalness,`;
    `)}),On(lo,"".concat(yi.ao),{"#include <aomap_fragment>":`
    #include <aomap_fragment>
    reflectedLight.indirectDiffuse *= 1. - `.concat(yi.ao,`;
    `)}),On(lo,"".concat(yi.bump),{"#include <normal_fragment_maps>":`
    #include <normal_fragment_maps>

    vec3 csm_internal_orthogonal = `.concat(yi.bump," - (dot(").concat(yi.bump,`, normal) * normal);
    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;
    normal = normalize(normal - csm_internal_projectedbump);
    `)}),On(lo,"".concat(yi.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":`
      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * `.concat(yi.depthAlpha,` );
    `),"gl_FragColor = packDepthToRGBA( fragCoordZ );":`
      gl_FragColor = packDepthToRGBA( fragCoordZ );
      gl_FragColor.a *= `.concat(yi.depthAlpha,`;
    `)});Cm={},On(Cm,"".concat(yi.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = projectionMatrix * modelViewMatrix * vec4( `.concat(yi.position,`, 1.0 );
  `)}),On(Cm,"".concat(yi.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = `.concat(yi.position,`;
  `)}),On(Cm,"".concat(yi.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(yi.diffuseColor,`;
  `)}),On(Cm,"".concat(yi.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(yi.fragColor,`;
  `)});var co;co={},On(co,"".concat(yi.position),"*"),On(co,"".concat(yi.positionRaw),"*"),On(co,"".concat(yi.normal),"*"),On(co,"".concat(yi.pointSize),["PointsMaterial"]),On(co,"".concat(yi.diffuseColor),"*"),On(co,"".concat(yi.fragColor),"*"),On(co,"".concat(yi.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),On(co,"".concat(yi.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),On(co,"".concat(yi.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),On(co,"".concat(yi.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),On(co,"".concat(yi.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),On(co,"".concat(yi.depthAlpha),"*");new vr;new le;ut.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Xe(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};_a.line={uniforms:Ab.merge([ut.common,ut.fog,ut.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};new le;new le;new Ni;new Ni;new Ni;new le;new dt;new yH;new le;new vr;new ts;new Ni;const kMe={key:0,args:[0,1,64]},PMe={key:1,args:[.5,1,64]},RMe={key:2},IMe=["tone-mapped","map","side","color"];new nt(16777215);class Q4 extends ln{constructor(){const e=Q4.SkyShader,n=new io({name:e.name,uniforms:Ab.clone(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:Rs,depthWrite:!1});super(new Rh(1,1,1),n),this.isSky=!0}}Q4.SkyShader={name:"SkyShader",uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new le},up:{value:new le(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPosition );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};var NMe={exports:{}};(function(r,e){(function(n,i){r.exports=i()})(CMe,function(){var n=function(){function i(v){return a.appendChild(v.dom),v}function s(v){for(var y=0;y<a.children.length;y++)a.children[y].style.display=y===v?"block":"none";o=v}var o=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(v){v.preventDefault(),s(++o%a.children.length)},!1);var l=(performance||Date).now(),h=l,u=0,f=i(new n.Panel("FPS","#0ff","#002")),p=i(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var m=i(new n.Panel("MB","#f08","#201"));return s(0),{REVISION:16,dom:a,addPanel:i,showPanel:s,begin:function(){l=(performance||Date).now()},end:function(){u++;var v=(performance||Date).now();if(p.update(v-l,200),v>h+1e3&&(f.update(1e3*u/(v-h),100),h=v,u=0,m)){var y=performance.memory;m.update(y.usedJSHeapSize/1048576,y.jsHeapSizeLimit/1048576)}return v},update:function(){l=this.end()},domElement:a,setMode:s}};return n.Panel=function(i,s,o){var a=1/0,l=0,h=Math.round,u=h(window.devicePixelRatio||1),f=80*u,p=48*u,m=3*u,v=2*u,y=3*u,x=15*u,w=74*u,S=30*u,O=document.createElement("canvas");O.width=f,O.height=p,O.style.cssText="width:80px;height:48px";var _=O.getContext("2d");return _.font="bold "+9*u+"px Helvetica,Arial,sans-serif",_.textBaseline="top",_.fillStyle=o,_.fillRect(0,0,f,p),_.fillStyle=s,_.fillText(i,m,v),_.fillRect(y,x,w,S),_.fillStyle=o,_.globalAlpha=.9,_.fillRect(y,x,w,S),{dom:O,update:function(T,A){a=Math.min(a,T),l=Math.max(l,T),_.fillStyle=o,_.globalAlpha=1,_.fillRect(0,0,f,x),_.fillStyle=s,_.fillText(h(T)+" "+i+" ("+h(a)+"-"+h(l)+")",m,v),_.drawImage(O,y+u,x,w-u,S,y,x,w-u,S),_.fillRect(y+w-u,x,u,S),_.fillStyle=o,_.globalAlpha=.9,_.fillRect(y+w-u,x,u,h((1-T/A)*S))}}},n})})(NMe);var DMe=`#include <common>

void main() {
  vec2 center = vec2(0., 1.);
  float rotation = 0.0;

  
  
  float size = 0.03;

  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

  bool isPerspective = isPerspectiveMatrix( projectionMatrix );
  if ( isPerspective ) scale *= - mvPosition.z;

  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
  mvPosition.xy += rotatedPosition;

  gl_Position = projectionMatrix * mvPosition;
}`,LMe=`void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
}`;const Qb=new le(0,0,0),j4=new le(0,0,0),BMe=new le(0,0,0);function JU(r,e,n){const i=Qb.setFromMatrixPosition(r.matrixWorld);i.project(e);const s=n.width/2,o=n.height/2;return[(Number.isNaN(i.x)?0:i.x)*s+s,-(i.y*o)+o]}function $Me(r,e){const n=Qb.setFromMatrixPosition(r.matrixWorld),i=j4.setFromMatrixPosition(e.matrixWorld),s=n.sub(i),o=e.getWorldDirection(BMe);return s.angleTo(o)>Math.PI/2}function UMe(r,e,n,i){const s=Qb.setFromMatrixPosition(r.matrixWorld),o=s.clone();o.project(e),n.setFromCamera(new Xe(o.x,o.y),e);const a=n.intersectObjects(i,!0);if(a.length>0){const l=a[0].distance;return s.distanceTo(n.ray.origin)<l}return!0}function VMe(r,e){if(e instanceof Jo)return e.zoom;if(e instanceof fn){const n=Qb.setFromMatrixPosition(r.matrixWorld),i=j4.setFromMatrixPosition(e.matrixWorld),s=e.fov*Math.PI/180,o=n.distanceTo(i);return 1/(2*Math.tan(s/2)*o)}else return 1}function FMe(r,e,n){if(e instanceof fn||e instanceof Jo){const i=Qb.setFromMatrixPosition(r.matrixWorld),s=j4.setFromMatrixPosition(e.matrixWorld),o=i.distanceTo(s),a=(n[1]-n[0])/(e.far-e.near),l=n[1]-a*e.far;return Math.round(a*o+l)}}const e3=r=>Math.abs(r)<1e-10?0:r;function XQ(r,e,n=""){let i="matrix3d(";for(let s=0;s!==16;s++)i+=e3(e[s]*r.elements[s])+(s!==15?",":")");return n+i}const zMe=(r=>e=>XQ(e,r))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),XMe=(r=>(e,n)=>XQ(e,r(n),"translate(-50%,-50%)"))(r=>[1/r,1/r,1/r,1,-1/r,-1/r,-1/r,-1,1/r,1/r,1/r,1,1,1,1,1]),WMe=["geometry","material"];new yd;var Xf=Object.freeze({Linear:Object.freeze({None:function(r){return r},In:function(r){return r},Out:function(r){return r},InOut:function(r){return r}}),Quadratic:Object.freeze({In:function(r){return r*r},Out:function(r){return r*(2-r)},InOut:function(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)}}),Cubic:Object.freeze({In:function(r){return r*r*r},Out:function(r){return--r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)}}),Quartic:Object.freeze({In:function(r){return r*r*r*r},Out:function(r){return 1- --r*r*r*r},InOut:function(r){return(r*=2)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2)}}),Quintic:Object.freeze({In:function(r){return r*r*r*r*r},Out:function(r){return--r*r*r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2)}}),Sinusoidal:Object.freeze({In:function(r){return 1-Math.sin((1-r)*Math.PI/2)},Out:function(r){return Math.sin(r*Math.PI/2)},InOut:function(r){return .5*(1-Math.sin(Math.PI*(.5-r)))}}),Exponential:Object.freeze({In:function(r){return r===0?0:Math.pow(1024,r-1)},Out:function(r){return r===1?1:1-Math.pow(2,-10*r)},InOut:function(r){return r===0?0:r===1?1:(r*=2)<1?.5*Math.pow(1024,r-1):.5*(-Math.pow(2,-10*(r-1))+2)}}),Circular:Object.freeze({In:function(r){return 1-Math.sqrt(1-r*r)},Out:function(r){return Math.sqrt(1- --r*r)},InOut:function(r){return(r*=2)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1)}}),Elastic:Object.freeze({In:function(r){return r===0?0:r===1?1:-Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI)},Out:function(r){return r===0?0:r===1?1:Math.pow(2,-10*r)*Math.sin((r-.1)*5*Math.PI)+1},InOut:function(r){return r===0?0:r===1?1:(r*=2,r<1?-.5*Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI):.5*Math.pow(2,-10*(r-1))*Math.sin((r-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(r){var e=1.70158;return r===1?1:r*r*((e+1)*r-e)},Out:function(r){var e=1.70158;return r===0?0:--r*r*((e+1)*r+e)+1},InOut:function(r){var e=2.5949095;return(r*=2)<1?.5*(r*r*((e+1)*r-e)):.5*((r-=2)*r*((e+1)*r+e)+2)}}),Bounce:Object.freeze({In:function(r){return 1-Xf.Bounce.Out(1-r)},Out:function(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},InOut:function(r){return r<.5?Xf.Bounce.In(r*2)*.5:Xf.Bounce.Out(r*2-1)*.5+.5}}),generatePow:function(r){return r===void 0&&(r=4),r=r<Number.EPSILON?Number.EPSILON:r,r=r>1e4?1e4:r,{In:function(e){return Math.pow(e,r)},Out:function(e){return 1-Math.pow(1-e,r)},InOut:function(e){return e<.5?Math.pow(e*2,r)/2:(1-Math.pow(2-e*2,r))/2+.5}}}}),Vy=function(){return performance.now()},GMe=function(){function r(){this._tweens={},this._tweensAddedDuringUpdate={}}return r.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},r.prototype.removeAll=function(){this._tweens={}},r.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},r.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},r.prototype.update=function(e,n){e===void 0&&(e=Vy()),n===void 0&&(n=!1);var i=Object.keys(this._tweens);if(i.length===0)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<i.length;s++){var o=this._tweens[i[s]],a=!n;o&&o.update(e,a)===!1&&!n&&delete this._tweens[i[s]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},r}(),Ym={Linear:function(r,e){var n=r.length-1,i=n*e,s=Math.floor(i),o=Ym.Utils.Linear;return e<0?o(r[0],r[1],i):e>1?o(r[n],r[n-1],n-i):o(r[s],r[s+1>n?n:s+1],i-s)},Bezier:function(r,e){for(var n=0,i=r.length-1,s=Math.pow,o=Ym.Utils.Bernstein,a=0;a<=i;a++)n+=s(1-e,i-a)*s(e,a)*r[a]*o(i,a);return n},CatmullRom:function(r,e){var n=r.length-1,i=n*e,s=Math.floor(i),o=Ym.Utils.CatmullRom;return r[0]===r[n]?(e<0&&(s=Math.floor(i=n*(1+e))),o(r[(s-1+n)%n],r[s],r[(s+1)%n],r[(s+2)%n],i-s)):e<0?r[0]-(o(r[0],r[0],r[1],r[1],-i)-r[0]):e>1?r[n]-(o(r[n],r[n],r[n-1],r[n-1],i-n)-r[n]):o(r[s?s-1:0],r[s],r[n<s+1?n:s+1],r[n<s+2?n:s+2],i-s)},Utils:{Linear:function(r,e,n){return(e-r)*n+r},Bernstein:function(r,e){var n=Ym.Utils.Factorial;return n(r)/n(e)/n(r-e)},Factorial:function(){var r=[1];return function(e){var n=1;if(r[e])return r[e];for(var i=e;i>1;i--)n*=i;return r[e]=n,n}}(),CatmullRom:function(r,e,n,i,s){var o=(n-r)*.5,a=(i-e)*.5,l=s*s,h=s*l;return(2*e-2*n+o+a)*h+(-3*e+3*n-2*o-a)*l+o*s+e}}},HMe=function(){function r(){}return r.nextId=function(){return r._nextId++},r._nextId=0,r}(),t3=new GMe,QMe=function(){function r(e,n){n===void 0&&(n=t3),this._object=e,this._group=n,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Xf.Linear.None,this._interpolationFunction=Ym.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=HMe.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return r.prototype.getId=function(){return this._id},r.prototype.isPlaying=function(){return this._isPlaying},r.prototype.isPaused=function(){return this._isPaused},r.prototype.getDuration=function(){return this._duration},r.prototype.to=function(e,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},r.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},r.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},r.prototype.start=function(e,n){if(e===void 0&&(e=Vy()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var s={};for(var o in this._valuesEnd)s[o]=this._valuesEnd[o];this._valuesEnd=s}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},r.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},r.prototype._setupProperties=function(e,n,i,s,o){for(var a in i){var l=e[a],h=Array.isArray(l),u=h?"array":typeof l,f=!h&&Array.isArray(i[a]);if(!(u==="undefined"||u==="function")){if(f){var p=i[a];if(p.length===0)continue;for(var m=[l],v=0,y=p.length;v<y;v+=1){var x=this._handleRelativeValue(l,p[v]);if(isNaN(x)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}m.push(x)}f&&(i[a]=m)}if((u==="object"||h)&&l&&!f){n[a]=h?[]:{};var w=l;for(var S in w)n[a][S]=w[S];s[a]=h?[]:{};var p=i[a];if(!this._isDynamic){var O={};for(var S in p)O[S]=p[S];i[a]=p=O}this._setupProperties(w,n[a],p,s[a],o)}else(typeof n[a]>"u"||o)&&(n[a]=l),h||(n[a]*=1),f?s[a]=i[a].slice().reverse():s[a]=n[a]||0}}},r.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},r.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},r.prototype.pause=function(e){return e===void 0&&(e=Vy()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},r.prototype.resume=function(e){return e===void 0&&(e=Vy()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},r.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},r.prototype.group=function(e){return e===void 0&&(e=t3),this._group=e,this},r.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},r.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},r.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},r.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},r.prototype.easing=function(e){return e===void 0&&(e=Xf.Linear.None),this._easingFunction=e,this},r.prototype.interpolation=function(e){return e===void 0&&(e=Ym.Linear),this._interpolationFunction=e,this},r.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},r.prototype.onStart=function(e){return this._onStartCallback=e,this},r.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},r.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},r.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},r.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},r.prototype.onStop=function(e){return this._onStopCallback=e,this},r.prototype.update=function(e,n){var i;if(e===void 0&&(e=Vy()),n===void 0&&(n=!0),this._isPaused)return!0;var s=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>s)return!1;n&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,a=this._duration+((i=this._repeatDelayTime)!==null&&i!==void 0?i:this._delayTime),l=this._duration+this._repeat*a,h=this._calculateElapsedPortion(o,a,l),u=this._easingFunction(h),f=this._calculateCompletionStatus(o,a);if(f==="repeat"&&this._processRepetition(o,a),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,u),f==="about-to-repeat"&&this._processRepetition(o,a),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),f==="repeat"||f==="about-to-repeat")this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1;else if(f==="completed"){this._isPlaying=!1,this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,m=this._chainedTweens.length;p<m;p++)this._chainedTweens[p].start(this._startTime+this._duration,!1)}return f!=="completed"},r.prototype._calculateElapsedPortion=function(e,n,i){if(this._duration===0||e>i)return 1;var s=e%n,o=Math.min(s/this._duration,1);return o===0&&e!==0&&e%this._duration===0?1:o},r.prototype._calculateCompletionStatus=function(e,n){return this._duration!==0&&e<this._duration?"playing":this._repeat<=0?"completed":e===this._duration?"about-to-repeat":"repeat"},r.prototype._processRepetition=function(e,n){var i=Math.min(Math.trunc((e-this._duration)/n)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=i);for(var s in this._valuesStartRepeat){var o=this._valuesEnd[s];!this._yoyo&&typeof o=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(o)),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s]}this._yoyo&&(this._reversed=!this._reversed),this._startTime+=n*i},r.prototype._updateProperties=function(e,n,i,s){for(var o in i)if(n[o]!==void 0){var a=n[o]||0,l=i[o],h=Array.isArray(e[o]),u=Array.isArray(l),f=!h&&u;f?e[o]=this._interpolationFunction(l,s):typeof l=="object"&&l?this._updateProperties(e[o],a,l,s):(l=this._handleRelativeValue(a,l),typeof l=="number"&&(e[o]=a+(l-a)*s))}},r.prototype._handleRelativeValue=function(e,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?e+parseFloat(n):parseFloat(n)},r.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=n},r}(),vc=t3;vc.getAll.bind(vc);vc.removeAll.bind(vc);vc.add.bind(vc);vc.remove.bind(vc);var jMe=vc.update.bind(vc);class YMe{constructor(){this.TileType={Brick:1,Iron:2,Grass:3,Water:4,Home:9},this.Direction={None:0,Up:1,Right:2,Down:3,Left:4},this.CampType={Player:"Player",Enermy:"Enermy"},this.ObjectType={Tank:"Tank",Bullet:"Bullet"},this.GameState={Prepare:"Prepare",Gaming:"Gaming",Finish:"Finish"},this.maps=this.getMapDatas()}makeTween(e){var n=new QMe(e);return n}makeTweenTankAppear(e,n){e.position.y=-1,this.makeTween(e.position).to({y:0},1e3).easing(Xf.Back.Out).onComplete(n).start()}randInt(e,n){if(n<e)return e;var i=n+1-e;return Math.floor(Math.random()*i)+e}randSplice(e){var n=this.randInt(0,e.length-1);return e.splice(n,1)[0]}formatNum(e,n){if(typeof e=="number")return this.formatNumImpl(e,n);if(e instanceof le)return e.x=this.formatNumImpl(e.x,n),e.y=this.formatNumImpl(e.y,n),e.z=this.formatNumImpl(e.z,n),e}formatNumImpl(e,n){if(n==0)return Math.abs(e)<1e-4?0:e;var i=Math.round(e/n);return n*i}getDirectionRotation(e){return[0,0,-Math.PI/2,Math.PI,Math.PI/2][e]}isEqual(e,n){return Math.abs(e-n)<=1e-4}removeArrayValue(e,n){for(var i=e.indexOf(n);i>=0;)e.splice(i,1),i=e.indexOf(n)}removeArrayValueIf(e,n){for(var i=e.findIndex(n);i>=0;)e.splice(i,1),i=e.indexOf(n)}getMapDatas(){const e=this.getSrcMaps(),n=[];for(let i=0;i<e.length;++i){const s=e[i],o=this.getMapData(s);n.push(o)}return n}getMapData(e){var n=e.split(`
`);n.shift(),n.pop();var i=[];for(let o=0;o<n.length;o++){var s=n[o].trim().split("	").map(l=>parseInt(l)||0);i[o]=s}return i}getDirectionVector(e){var i=[null,new le(0,0,-1),new le(1,0,0),new le(0,0,1),new le(-1,0,0)][e];return i?i.clone():null}getSrcMaps(){return[`第1关
            0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
            0																									0
            0		1	1			1	1			1	1			1	1			1	1			1	1		0
            0		1	1			1	1			1	1			1	1			1	1			1	1		0
            0		1	1			1	1			1	1			1	1			1	1			1	1		0
            0		1	1			1	1			1	1	1	1	1	1			1	1			1	1		0
            0		1	1			1	1			1	1	1	1	1	1			1	1			1	1		0
            0		1	1			1	1			1	1			1	1			1	1			1	1		0
            0		1	1			1	1											1	1			1	1		0
            0		1	1			1	1											1	1			1	1		0
            0										1	1			1	1										0
            0										1	1			1	1										0
            1	1			1	1	1	1											1	1	1	1			1	1
            2	2			1	1	1	1											1	1	1	1			2	2
            0										1	1			1	1										0
            0										1	1	1	1	1	1										0
            0		1	1			1	1			1	1	1	1	1	1		1	1			1	1			0
            0		1	1			1	1			1	1			1	1		1	1			1	1			0
            0		1	1			1	1			1	1			1	1		1	1			1	1			0
            0		1	1			1	1										1	1			1	1			0
            0		1	1			1	1										1	1			1	1			0
            0		1	1			1	1				1	1	1	1			1	1			1	1			0
            0											1	9		1											0
            0	0	0	0	0	0	0	0	0	0	0	1			1	0	0	0	0	0	0	0	0	0	0	0
`]}}const ft=new YMe;class qMe{constructor(){this.Rows=24,this.Cols=26,this.Width=this.Cols*.5,this.Height=this.Rows*.5,this.HalfWidth=this.Width/2,this.HalfHeight=this.Height/2}getRCByIndex(e){let n={};return n.r=Math.floor(e/this.Cols),n.c=e%this.Cols,n}getIndexByRC(e,n){if(typeof e=="object")var{r:e,c:n}=e;return e*this.Cols+n}getIndexByPosition(e){return this.getIndexByRC(getRCByPosition(e))}getPositionByRC(e,n){if(typeof e=="object")var{r:e,c:n}=e;return new le(n*.5-6.25,0,e*.5-5.75)}getRCByPosition(e){let n={};return n.r=Math.floor((e.z+6)/.5),n.c=Math.floor((e.x+6.5)/.5),n}isIndexInBound(e){return e>=0&&e<this.Rows*this.Cols}isRCInBound(e,n){if(typeof e=="object")var{r:e,c:n}=e;return e>=0&&e<this.Rows&&n>=0&&n<this.Cols}isGridInBound(e){return!(e.minR<0||e.minC<0||e.maxR>=this.Rows||e.maxC>=this.Cols)}getStandGrid(e,n){let i={};const s=new le(e.x-n/2,0,e.z-n/2),o=new le(e.x+n/2,0,e.z+n/2),a=this.getRCByPosition(s),l=this.getRCByPosition(o);return i.minR=Math.min(a.r,l.r),i.minC=Math.min(a.c,l.c),i.maxR=Math.max(a.r,l.r),i.maxC=Math.max(a.c,l.c),Number.isInteger(o.x/.5)&&(i.maxC-=1),Number.isInteger(o.z/.5)&&(i.maxR-=1),i}}var Ia=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jb(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function WQ(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var s=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:function(){return r[i]}})}),n}var Yb=function(e,n,i,s,o){var a=s-e,l=o-n;return a*a+l*l<=i*i},ZMe=function(e,n,i,s,o,a){var l=e-s,h=o-n,u=i+a;return l*l+h*h<=u*u},I2=function(e,n,i,s,o,a,l){var h=[o-e,a-n],u=[i-e,s-n],f=zM(u,u),p=zM(h,u),m=p/f;m=m<0?0:m,m=m>1?1:m;var v=[u[0]*m+e-o,u[1]*m+n-a],y=zM(v,v);return y<=l*l};function zM(r,e){return r[0]*e[0]+r[1]*e[1]}var KMe=I2,JMe=function(e,n,i,s,o,a,l){return KMe(s,o,a,l,e,n,i)},Y4=function(e,n,i,s,o,a,l){var h=i/2,u=s/2,f=Math.abs(o-(e+i/2)),p=Math.abs(a-(n+s/2));if(f>h+l||p>u+l)return!1;if(f<=h||p<=u)return!0;var m=f-h,v=p-u;return m*m+v*v<=l*l},eAe=Y4,tAe=function(e,n,i,s,o,a,l){return eAe(s,o,a,l,e,n,i)};function XM(r,e,n,i){return Math.sqrt(Math.pow(r-n,2)+Math.pow(e-i,2))}var q4=function(e,n,i,s,o,a,l){return l=l||1,Math.abs(XM(e,n,i,s)-(XM(e,n,o,a)+XM(i,s,o,a)))<=l};const iAe=q4;var qb=function(e,n,i,s){var o=e.length,a=!1,l,h;for(l=0,h=o-2;l<o;l+=2)e[l+1]>i!=e[h+1]>i&&n<(e[h]-e[l])*(i-e[l+1])/(e[h+1]-e[l+1])+e[l]&&(a=!a),h=l;if(a)return!0;for(l=0;l<o;l+=2){var u=e[l],f=e[l+1],p,m;if(l===o-2?(p=e[0],m=e[1]):(p=e[l+2],m=e[l+3]),iAe(u,f,p,m,n,i,s))return!0}return!1},nAe=qb,eV=I2,GQ=function(e,n,i,s,o){if(nAe(e,n,i,o))return!0;for(var a=e.length,l=0;l<a-2;l+=2)if(eV(e[l],e[l+1],e[l+2],e[l+3],n,i,s))return!0;return eV(e[0],e[1],e[a-2],e[a-1],n,i,s)},rAe=GQ,sAe=function(e,n,i,s,o){return rAe(s,e,n,i,o)},HQ=10,IS,NS,Z4;function QQ(){IS=[],NS=[];for(var r=0;r<=HQ;r++){var e=4<<r;IS[r]=.5/Math.cos(4*Math.acos(0)/e),NS[r]=.5/(Math.cos(2*Math.acos(0)/e)*Math.cos(2*Math.acos(0)/e))}Z4=!0}function jQ(r,e,n,i,s,o,a){for(var l=1;l<=HQ;l++){var h=(n+s)*IS[l],u=(i+o)*IS[l],f=r-h,p=e-u;if(f*f+p*p<=a)return!0;var m=s-h,v=o-u;if(f*m+p*v>=0&&f*m+p*v<=m*m+v*v&&(p*m-f*v>=0||a*(m*m+v*v)>=(p*m-f*v)*(p*m-f*v)))return!0;var y=n-h,x=i-u;if(f*y+p*x>=0&&f*y+p*x<=y*y+x*x&&(p*y-f*x<=0||a*(y*y+x*x)>=(p*y-f*x)*(p*y-f*x)))return!0;var w=(n+h)*NS[l],S=(i+u)*NS[l];if((w-r)*(w-r)+(S-e)*(S-e)<a){s=h,o=u;continue}var O=h-w+h,_=u-S+u;if((O-r)*(O-r)+(_-e)*(_-e)<a){n=h,i=u;continue}var T=w-h,A=S-u;if(p*T-f*A<=0||a*(T*T+A*A)>(p*T-f*A)*(p*T-f*A)){if(f*T+p*A>0){if(Math.abs(f*T+p*A)<=T*T+A*A||(r-w)*(n-w)+(e-S)*(i-S)>=0){s=h,o=u;continue}}else if(-(f*T+p*A)<=T*T+A*A||(r-O)*(s-O)+(e-_)*(o-_)>=0){n=h,i=u;continue}}return!1}return!1}function oAe(r,e,n,i,s,o,a,l){Z4||QQ();var h=Math.abs(s-r)*l,u=Math.abs(o-e)*a;n*=l,i*=a;var f=a*l;return h*h+(i-u)*(i-u)<=f*f||(n-h)*(n-h)+u*u<=f*f||h*i+u*n<=n*i||(h*i+u*n-n*i)*(h*i+u*n-n*i)<=f*f*(n*n+i*i)&&h*n-u*i>=-i*i&&h*n-u*i<=n*n?!0:(h-n)*(h-n)+(u-i)*(u-i)<=f*f||h<=n&&u-f<=i||u<=i&&h-f<=n?jQ(h,u,n,0,0,i,f*f):!1}function aAe(r,e,n,i,s,o,a){Z4||QQ();var l=Math.abs(s-r),h=Math.abs(o-e);return l*l+(i-h)*(i-h)<=a*a||(n-l)*(n-l)+h*h<=a*a||l*i+h*n<=n*i||(l*i+h*n-n*i)*(l*i+h*n-n*i)<=a*a*(n*n+i*i)&&l*n-h*i>=-i*i&&l*n-h*i<=n*n?!0:(l-n)*(l-n)+(h-i)*(h-i)<=a*a||l<=n&&h-a<=i||h<=i&&l-a<=n?jQ(l,h,n,0,0,i,a*a):!1}var YQ={ellipseCircle:aAe,ellipseEllipse:oAe},lAe=YQ,qQ=function(e,n,i,s,o,a,l){return lAe.ellipseCircle(e,n,i,s,o,a,l)},cAe=qQ,hAe=function(e,n,i,s,o,a,l){return cAe(s,o,a,l,e,n,i)},mu=Yb,uAe=Y4,ZQ=function(e,n,i,s,o,a,l,h){h=h||1;var u=0;if(u+=mu(e,n,i,s,o)?1:0,u+=mu(e,n,i,s+a,o)?1:0,u+=mu(e,n,i,s,o+l)?1:0,u+=mu(e,n,i,s+a,o+l)?1:0,u===0)return uAe(s,o,a,l,e,n,i);if(u>=1&&u<=3)return!0;if(u===4)return!mu(e,n,i-h,s,o)||!mu(e,n,i-h,s+a,o)||!mu(e,n,i-h,s,o+l)||!mu(e,n,i-h,s+a,o+l)},dAe=I2,tV=Yb,KQ=function(e,n,i,s,o,a,l,h){return h=h||1,dAe(s,o,a,l,e,n,i)&&!(tV(e,n,i-h,s,o)&&tV(e,n,i-h,a,l))},iV=Yb,JQ=function(e,n,i,s,o,a){return a=a||1,iV(e,n,i,s,o)&&!iV(e,n,i-a,s,o)},ej=function(e,n,i,s,o,a,l,h){var u=i-e,f=s-n,p=l-o,m=h-a,v=(-f*(e-o)+u*(n-a))/(-p*f+u*m),y=(p*(n-a)-m*(e-o))/(-p*f+u*m);return v>=0&&v<=1&&y>=0&&y<=1},fAe=qb,pAe=ej,K4=function(e,n,i,s,o,a){var l=o.length;if(fAe(o,e,n,a))return!0;for(var h=0;h<l;h+=2){var u=(h+2)%l;if(pAe(e,n,i,s,o[h],o[h+1],o[u],o[u+1]))return!0}return!1},mAe=K4,gAe=function(e,n,i,s,o,a){return mAe(n,i,s,o,e,a)},J4=function(e,n){for(var i=e,s=n,o=[i,s],a,l,h,u,f,p,m=0;m<o.length;m++)for(var v=o[m],y=0;y<v.length;y+=2){var x=(y+2)%v.length,w={x:v[x+1]-v[y+1],y:v[y]-v[x]};for(a=l=null,p=0;p<i.length;p+=2)h=w.x*i[p]+w.y*i[p+1],(a===null||h<a)&&(a=h),(l===null||h>l)&&(l=h);for(u=f=null,p=0;p<s.length;p+=2)h=w.x*s[p]+w.y*s[p+1],(u===null||h<u)&&(u=h),(f===null||h>f)&&(f=h);if(l<u||f<a)return!1}return!0},vAe=J4,tj=function(e,n,i,s,o){var a=[n,i,n+s,i,n+s,i+o,n,i+o];return vAe(e,a)},e5=function(e,n,i,s,o,a,l,h){o-=e,l-=e,a-=n,h-=n;var u=Math.pow(l-o,2)/i/i+Math.pow(h-a,2)/s/s,f=2*o*(l-o)/i/i+2*a*(h-a)/s/s,p=o*o/i/i+a*a/s/s-1,m=f*f-4*u*p;if(m===0){var v=-f/2/u;return v>=0&&v<=1}else if(m>0){var y=Math.sqrt(m),x=(-f+y)/2/u,w=(-f-y)/2/u;return x>=0&&x<=1||w>=0&&w<=1}else return!1},yAe=e5,ij=function(e,n,i,s,o,a,l,h){return yAe(o,a,l,h,e,n,i,s)},bAe=qb,nV=ij,nj=function(e,n,i,s,o){if(bAe(e,n,i))return!0;for(var a=e.length,l=0;l<a-2;l+=2)if(nV(e[l],e[l+1],e[l+2],e[l+3],n,i,s,o))return!0;return nV(e[0],e[1],e[a-2],e[a-1],n,i,s,o)},N2=function(e,n,i,s,o,a){return o>=e&&o<=e+i&&a>=n&&a<=n+s},xAe=function(e,n,i,s,o,a,l,h){return e<o+l&&e+i>o&&n<a+h&&n+s>a},wAe=function(e,n,i,s,o){const a=Math.atan2(s-n,i-e)-Math.PI/2,l=o/2,h=Math.cos(a)*l,u=Math.sin(a)*l;return[e-h,n-u,i-h,s-u,i+h,s+u,e+h,n+u]};const b_=wAe,_Ae=J4,rV=K4,OAe=ej;var rj=function(e,n,i,s,o,a,l,h,u,f){return u||f?SAe(e,n,i,s,o,a,l,h,u,f):OAe(e,n,i,s,o,a,l,h)};function SAe(r,e,n,i,s,o,a,l,h,u){if(h&&u)return _Ae(b_(r,e,n,i,h),b_(s,o,a,l,u));if(h)return rV(s,o,a,l,b_(r,e,n,i,h));if(u)return rV(r,e,n,i,b_(s,o,a,l,h))}var sV=N2,x_=rj,sj=function(e,n,i,s,o,a,l,h){return sV(o,a,l,h,e,n)||sV(o,a,l,h,i,s)?!0:x_(e,n,i,s,o,a,o+l,a)||x_(e,n,i,s,o+l,a,o+l,a+h)||x_(e,n,i,s,o,a+h,o+l,a+h)||x_(e,n,i,s,o,a,o,a+h)},CAe=sj,TAe=function(e,n,i,s,o,a,l,h){return CAe(o,a,l,h,e,n,i,s)},EAe=tj,MAe=function(e,n,i,s,o){return EAe(o,e,n,i,s)},w_=e5,AAe=N2,oj=function(e,n,i,s,o,a,l,h){return AAe(o,a,l,h,e,n)||w_(e,n,i,s,o,a,o+l,a)||w_(e,n,i,s,o,a+h,o+l,a+h)||w_(e,n,i,s,o,a,o,a+h)||w_(e,n,i,s,o+l,a,o+l,a+h)},kAe=oj,PAe=function(e,n,i,s,o,a,l,h){return kAe(o,a,l,h,e,n,i,s)},RAe=ZQ,IAe=function(e,n,i,s,o,a,l,h){return RAe(o,a,l,e,n,i,s,h)},NAe=N2,DAe=function(e,n,i,s,o,a){return NAe(i,s,o,a,e,n)},LAe=qb,BAe=function(e,n,i,s){return LAe(i,e,n,s)},$Ae=Yb,UAe=function(e,n,i,s,o){return $Ae(i,s,o,e,n)},VAe=q4,FAe=function(e,n,i,s,o,a){return VAe(i,s,o,a,e,n)},aj=function(e,n,i,s,o,a){var l=Math.pow(o-e,2)/(i*i),h=Math.pow(a-n,2)/(s*s);return l+h<=1},zAe=aj,XAe=function(e,n,i,s,o,a){return zAe(i,s,o,a,e,n)},WAe=JQ,GAe=function(e,n,i,s,o,a){return WAe(e,n,i,s,o,a)},HAe=KQ,QAe=function(e,n,i,s,o,a,l,h){return HAe(o,a,l,e,n,i,s,h)},jAe=YQ,YAe=function(e,n,i,s,o,a,l,h){return jAe.ellipseEllipse(e,n,i,s,o,a,l,h)},qAe=nj,ZAe=function(e,n,i,s,o){return qAe(o,e,n,i,s)},__={circlePoint:Yb,circleCircle:ZMe,circleLine:JMe,circleBox:tAe,circlePolygon:sAe,circleEllipse:hAe,circleOutlineBox:ZQ,circleOutlineLine:KQ,circleOutlinePoint:JQ,polygonPoint:qb,polygonLine:gAe,polygonPolygon:J4,polygonBox:tj,polygonCircle:GQ,polygonEllipse:nj,boxPoint:N2,boxBox:xAe,boxLine:TAe,boxPolygon:MAe,boxCircle:Y4,boxEllipse:PAe,boxCircleOutline:IAe,pointBox:DAe,pointPolygon:BAe,pointCircle:UAe,pointLine:FAe,pointEllipse:XAe,pointCircleOutline:GAe,lineLine:rj,lineBox:sj,linePolygon:K4,lineCircle:I2,linePoint:q4,lineEllipse:ij,lineCircleOutline:QAe,ellipsePoint:aj,ellipseLine:e5,ellipseBox:oj,ellipseCircle:qQ,ellipseEllipse:YAe,ellipsePolygon:ZAe};const mo=class mo{constructor(e,n){this.shapeType=e,e==mo.Box?this.size=n:e==mo.Circle&&(this.radius=n)}get center(){return this._center}set center(e){this._center=e}intersect(e){if(this.shapeType==mo.Box&&e.shapeType==mo.Box){var n=this.center.x-this.size/2,i=this.center.z-this.size/2,s=this.size,o=this.size,a=e.center.x-e.size/2,l=e.center.z-e.size/2,h=e.size,u=e.size,f=__.boxBox(n,i,s,o,a,l,h,u);return f}else if(this.shapeType==mo.Box&&e.shapeType==mo.Circle){var n=this.center.x-this.size/2,i=this.center.z-this.size/2,s=this.size,o=this.size,p=e.center.x,m=e.center.z,v=e.radius,f=__.boxCircle(n,i,s,o,p,m,v);return f}else if(this.shapeType==mo.Circle&&e.shapeType==mo.Box){var p=this.center.x,m=this.center.z,v=this.radius,a=e.center.x-e.size/2,l=e.center.z-e.size/2,h=e.size,u=e.size,f=__.circleBox(p,m,v,n,i,s,o);return f}else if(this.shapeType==mo.Circle&&e.shapeType==mo.Circle){var n=this.center.x,i=this.center.z,y=this.radius,a=this.center.x,l=this.center.z,x=this.radius,f=__.circleCircle(n,i,y,a,l,x);return f}}};Nc(mo,"Box","Box"),Nc(mo,"Circle","Circle");let od=mo;class KAe{constructor(){this.obj=this.createObject(),this.speed=4,this.power=1,game.timer.tick(this.update.bind(this)),this.shape=new od(od.Circle,.15)}createObject(){var e=game.ResStore.bullet_player.clone();return e}get CampType(){return ft.CampType.Player}get ObjectType(){return ft.ObjectType.Bullet}get Shape(){return this.shape.center=this.obj.position,this.shape}init(e){this.tank=e;var n=e.position.clone().add(new le(0,.5,0));this.obj.position.copy(n),this.direction=e.getDirection(),this.speed=this.initBulletSpeed(),this.canHitTileTypes=this.initCanHitTileTypes(),this.power=this.initPower()}initBulletSpeed(){return this.tank.starCount<=0?4:8}initPower(){return this.tank.starCount<=2?1:2}initCanHitTileTypes(){var e=[];return e.push(ft.TileType.Home),e.push(ft.TileType.Brick),this.tank.getStarCount()>=3&&e.push(ft.TileType.Iron),e}onRemove(){}update({delta:e,elapsed:n}){var i=this.speed*e,s=ft.getDirectionVector(this.direction).multiplyScalar(i);this.obj.position.add(s)}}class JAe{constructor(){this.obj=this.createObject(),this.moveSpeed=2,this.shootDiff=.1,this.shootAcc=0,this.starCount=1,this.bullets=[],this.shape=new od(od.Box,1)}getMaxBulletCount(){return this.starCount<=1?1:2}getStarCount(){return this.starCount}createObject(){var e=game.ResStore.tank_player_1.clone();this.lightTarget=new Li,e.add(this.lightTarget),this.lightTarget.position.set(0,.5,-10);var n=new $b(16777215);return n.position.set(0,.5,-.3),n.castShadow=!0,n.target=this.lightTarget,n.angle=Math.PI/4,n.intensity=10,n.penumbra=.2,e.add(n),this.spotLight=n,e}init(){game.onAddController.push(this.onAddController.bind(this)),game.onRemoveController.push(this.onRemoveController.bind(this))}onRemove(){ft.removeArrayValue(game.onAddController,this.onAddController.bind(this)),ft.removeArrayValue(game.onRemoveController,this.onRemoveController.bind(this))}onAddController(e){e.CampType==ft.CampType.Player&&e.ObjectType==ft.ObjectType.Bullet&&this.bullets.push(e)}onRemoveController(e){e.CampType==ft.CampType.Player&&e.ObjectType==ft.ObjectType.Bullet&&ft.removeArrayValue(this.bullets,e)}get CampType(){return ft.CampType.Player}get ObjectType(){return ft.ObjectType.Tank}get Shape(){return this.shape.center=this.obj.position,this.shape}ITank_update({delta:e,elapsed:n}){window.game.gameState==ft.GameState.Gaming&&(this.checkMove({delta:e,elapsed:n}),this.checkShoot({delta:e,elapsed:n}))}checkMove({delta:e,elapsed:n}){var i=game.getMoveDirection();if(i){var s=ft.getDirectionRotation(i);s!=this.rotation.y&&(this.rotation.y=s,ft.formatNum(this.position,.25));var o=game.getCanMoveLength(this,i);if(o>0){var a=this.moveSpeed*e;a>o&&(a=o);var l=ft.getDirectionVector(i).multiplyScalar(a);this.position.add(l)}}}getDirection(){return this.rotation.y==0?ft.Direction.Up:this.rotation.y==Math.PI?ft.Direction.Down:this.rotation.y==-Math.PI/2?ft.Direction.Right:this.rotation.y==Math.PI/2?ft.Direction.Left:ft.Direction.Up}shootPressed(){return game.inputs.c||game.inputs.j||game.inputs.f}checkShoot({delta:e,elapsed:n}){this.bullets.length>=this.getMaxBulletCount()||(this.shootAcc+=e,this.shootPressed()&&this.shootAcc>=this.shootDiff&&(this.shootAcc=0,this.doShoot()))}doShoot(){var e=new KAe;game.addController(e),e.init(this)}get position(){return this.obj.position}get rotation(){return this.obj.rotation}}class eke{constructor(){this.delta=0,this.elapsed=0,this.records=[],this.shouldRemoves=[],this.shouldAdds=[]}update({delta:e,elapsed:n}){this.delta=e,this.elapsed=n;for(let s=0;s<this.records.length;++s){var i=this.records[s];i.acc+=e,i.acc>=i.second&&(i.callback({delta:i.acc,elapsed:n}),i.acc=0,i.times&&(i.times-=1,i.times<=0&&this.shouldRemoves.push(i.callback)))}this.checkRemove(),this.checkAdd()}checkAdd(){for(let e=0;e<this.shouldAdds.length;++e)this.records.push(this.shouldAdds[e]);this.shouldAdds.length=0}checkRemove(){for(let n=0;n<this.shouldRemoves.length;++n){var e=i=>i.callback==this.shouldRemoves[n];ft.removeArrayValueIf(this.records,e),ft.removeArrayValueIf(this.shouldAdds,e)}this.shouldRemoves.length=0}tick(e,n){n=n||0;var i={second:n,callback:e,acc:0};this.shouldAdds.push(i)}tickOnce(e,n){n=n||0;var i={second:n,callback:e,acc:0,times:1};this.shouldAdds.push(i)}untick(e){this.shouldRemoves.push(e)}}class WM{constructor(e,n,i){this.enermyMan=e,this.bornIndex=n,this.tankType=i,this.obj=this.createObject(),this.obj.position.copy(this.getBornPos(this.bornIndex)),this.obj.rotation.y=ft.getDirectionRotation(ft.Direction.Down),this.state=0,this.shape=new od(od.Box,1),this.moveSpeed=this.getSpeedTemplate(),this.blood=this.getBloodTemplate(),this.direction=this.getRandDirection(),this.moveDirectAcc=0,this.moveDirectMax=3}get position(){return this.obj.position}get rotation(){return this.obj.rotation}createObject(){var e=window.game.ResStore[`enermy${this.tankType+1}`],n=e.clone();return n}getSpeedTemplate(){var e=[2,3,4,2];return e[this.tankType]}getBloodTemplate(){var e=[1,2,1,4];return e[this.tankType]}getRandDirection(){for(var e=[ft.Direction.Up,ft.Direction.Right,ft.Direction.Down,ft.Direction.Left],n=[window.game.getCanMoveLength(this,ft.Direction.Up),window.game.getCanMoveLength(this,ft.Direction.Right),window.game.getCanMoveLength(this,ft.Direction.Down),window.game.getCanMoveLength(this,ft.Direction.Left)],i=n.findIndex(s=>s<=0);i>=0;)e.splice(i,1),n.splice(i,1),i=n.findIndex(s=>s<=0);return e.length>0?ft.randSplice(e):ft.Direction.Down}onAppearFinish(){this.state=1}get CampType(){return ft.CampType.Enermy}get ObjectType(){return ft.ObjectType.Tank}get Shape(){return this.shape.center=this.obj.position,this.shape}getBornPos(e){if(e=e%3,e==0)return window.game.rc.getPositionByRC(0,0).add(new le(.25,0,.25));if(e==1)return window.game.rc.getPositionByRC(0,12).add(new le(.25,0,.25));if(e==2)return window.game.rc.getPositionByRC(0,24).add(new le(.25,0,.25))}ITank_update({delta:e}){this.state!=0&&(this.wantChangeDirection&&(this.direction=this.getRandDirection(),this.wantChangeDirection=!1,this.moveDirectAcc=0,this.moveDirectMax=1e3,ft.randInt(1,5)),this.checkMove({delta:e}),this.moveDirectAcc>=this.moveDirectMax&&(this.wantChangeDirection=!0))}checkMove({delta:e}){var n=ft.getDirectionRotation(this.direction);n!=this.rotation.y&&(this.rotation.y=n,ft.formatNum(this.position,.25));var i=game.getCanMoveLength(this,this.direction);if(i>0){var s=this.moveSpeed*e;s>i&&(s=i);var o=ft.getDirectionVector(this.direction).multiplyScalar(s);this.position.add(o),this.moveDirectAcc+=e}else this.wantChangeDirection=!0}}class tke{constructor(){this.tanks=[],this.bornIndex=0,this.bornTime={},this.totalCount=20,this.destroyCount=0,console.log("EnermyMan")}start(){window.game.timer.tick(this.update.bind(this),1),window.game.onAddController.push(this.onAddController.bind(this)),window.game.onRemoveController.push(this.onRemoveController.bind(this))}dispose(){window.game.timer.untick(this.update.bind(this)),ft.removeArrayValue(window.game.onAddController,this.onAddController.bind(this)),ft.removeArrayValue(window.game.onRemoveController,this.onRemoveController.bind(this))}onAddController(e){e instanceof WM&&this.tanks.push(e)}onRemoveController(e){e instanceof WM&&(ft.removeArrayValue(this.tanks,e),this.destroyCount+=1)}getBornPos(e){if(e=e%3,e==0)return window.game.rc.getPositionByRC(0,0).add(new le(.25,0,.25));if(e==1)return window.game.rc.getPositionByRC(0,12).add(new le(.25,0,.25));if(e==2)return window.game.rc.getPositionByRC(0,24).add(new le(.25,0,.25))}isEmptyBorn(){var e=this.bornTime[this.bornIndex]||0;return Date.now()-e>2e3}update({delta:e,elapsed:n}){for(;this.tanks.length<1&&this.isEmptyBorn();)this.makeEnermy()}makeEnermy(){var e=ft.randInt(0,3),n=new WM(this,this.bornIndex,e);window.game.addController(n),ft.makeTweenTankAppear(n.obj,n.onAppearFinish.bind(n)),this.bornTime[this.bornIndex]=Date.now(),this.bornIndex+=1,this.bornIndex=this.bornIndex%3}}const{onLoop:ike}=Ep();class nke{constructor(e){Nc(this,"tick",0);this.scene=e.value.context.scene.value,this.camera=e.value.context.camera.value}startGame(){this.rc=new qMe,this.inputs={},this.tiles=[],this.player_1=null,this.controllers=[],this.playerBullets=[],this.controllerShouldAdd=[],this.controllerShouldRemove=[],this.ITank_updates=[],this.onAddController=[],this.onRemoveController=[],this.timer=new eke,ike(this.update.bind(this));var e=this.ResStore.platform.clone();this.scene.add(e),this.tileRoot=new qs,this.scene.add(this.tileRoot),this.startLevel(0),this.initInput(),e.visible=this.visible,this.tileRoot.visible=this.visible}startLevel(e){for(this.gameState=ft.GameState.Prepare;this.tileRoot.children.length>0;)this.tileRoot.remove(this.tileRoot.children[0]);this.initMap(e),this.initPlayer(),this.enermyMan&&this.enermyMan.dispose(),this.enermyMan=new tke,this.timer.tickOnce(()=>{this.showPlayerAppear()},1)}initPlayer(){this.player_1&&this.removeController(this.player_1),this.player_1=new JAe,this.addController(this.player_1),this.player_1.position.copy(this.rc.getPositionByRC(22,9).add(new le(-.25,-1,.25))),this.player_1.init()}showPlayerAppear(){ft.makeTween(this.player_1.obj.position).to({y:0},1e3).easing(Xf.Back.Out).onComplete(()=>{this.gameState=ft.GameState.Gaming,this.enermyMan.start()}).start()}run(){this.loadResource()}loadResource(){this.ResStore={};const e=["tank/platform.fbx","tank/tile1.fbx","tank/tile2.fbx","tank/tile9.fbx","tank/enermy1.fbx","tank/enermy2.fbx","tank/enermy3.fbx","tank/enermy4.fbx","tank/bullet_player.fbx","tank/tank_player_1.fbx"];OMe(e).then(n=>{for(let s=0;s<n.length;++s){const o=n[s],a=e[s];this.ResStore[a]=o;var i=a.split("/");i=i[i.length-1],i=i.split("."),i=i[0],this.ResStore[i]=o}this.brickHitMaterial=this.ResStore.tile1.children[0].material.clone(),this.brickHitMaterial.color.setHex(8912896),this.startGame()})}initInput(){document.addEventListener("keydown",e=>{this.inputs[e.key]=1}),document.addEventListener("keyup",e=>{this.inputs[e.key]=0})}initMap(e){var n=ft.maps[e];for(let a=0;a<n.length;a++){const l=n[a];for(let h=0;h<l.length;h++){const u=l[h],f=this.rc.getIndexByRC(a,h);var i=null,s=0;if(u==ft.TileType.Brick){var i=this.ResStore.tile1.clone();this.tileRoot.add(i),i.position.copy(this.rc.getPositionByRC(a,h)),s=1}else if(u==ft.TileType.Iron){var i=this.ResStore.tile2.clone();this.tileRoot.add(i),i.position.copy(this.rc.getPositionByRC(a,h)),s=1}else if(u==ft.TileType.Home){var i=this.ResStore.tile9.clone();this.tileRoot.add(i),i.position.x=h*.5-6,i.position.z=a*.5-5.5,s=2}if(s==1){var o={tileType:u,obj:i,blood:2};this.tiles[f]=o}else if(s==2){var o={tileType:u,obj:i,blood:1};this.tiles[f]=o,this.tiles[this.rc.getIndexByRC(a,h+1)]=o,this.tiles[this.rc.getIndexByRC(a+1,h)]=o,this.tiles[this.rc.getIndexByRC(a+1,h+1)]=o}if(!this.tiles[f]){var o={tileType:u,obj:i};this.tiles[f]=o}}}}getTile(e,n){var i=this.rc.getIndexByRC(e,n);return this.tiles[i]}getTilesByGrid(e){var n=[];for(let s=e.minR;s<=e.maxR;++s)for(let o=e.minC;o<=e.maxC;++o){var i=this.getTile(s,o);i.tileType&&n.push(i)}return n}getMoveDirection(){return this.inputs.w?ft.Direction.Up:this.inputs.s?ft.Direction.Down:this.inputs.a?ft.Direction.Left:this.inputs.d?ft.Direction.Right:ft.Direction.None}getBlockTileRCs(e,n){let i=[];if(n==ft.Direction.Up)for(let o=e.minR;o>=0;--o)for(let a=e.minC;a<=e.maxC;++a){var s=this.getTile(o,a);s.tileType&&i.push({r:o,c:a})}else if(n==ft.Direction.Down)for(let o=e.maxR;o<=this.rc.Rows-1;++o)for(let a=e.minC;a<=e.maxC;++a){var s=this.getTile(o,a);s.tileType&&i.push({r:o,c:a})}else if(n==ft.Direction.Left)for(let o=e.minC;o>=0;--o)for(let a=e.minR;a<=e.maxR;++a){var s=this.getTile(a,o);s.tileType&&i.push({r:a,c:o})}else if(n==ft.Direction.Right)for(let o=e.maxC;o<=this.rc.Cols-1;++o)for(let a=e.minR;a<=e.maxR;++a){var s=this.getTile(a,o);s.tileType&&i.push({r:a,c:o})}return i}getCanMoveLength(e,n){var i=e.position.clone(),s=this.rc.getStandGrid(e.position,1),o=this.getBlockTileRCs(s,n),a=o[0],l=0;if(!a)n==ft.Direction.Up?l=i.z- -5.5:n==ft.Direction.Down?l=5.5-i.z:n==ft.Direction.Left?l=i.x- -6:n==ft.Direction.Right&&(l=6-i.x);else{var h=this.rc.getPositionByRC(a);n==ft.Direction.Up?l=i.z-.5-(h.z+.25):n==ft.Direction.Down?l=h.z-.25-(i.z+.5):n==ft.Direction.Left?l=i.x-.5-(h.x+.25):n==ft.Direction.Right&&(l=h.x-.25-(i.x+.5))}return l}update({delta:e,elapsed:n}){jMe(),this.checkRemoveController(),this.checkAddController();for(let i=0;i<this.ITank_updates.length;i++)this.ITank_updates[i].ITank_update({delta:e,elapsed:n});this.timer.update({delta:e,elapsed:n}),this.checkCollision({delta:e,elapsed:n}),this.checkRemoveController(),this.checkAddController(),this.makeCameraFollow({delta:e,elapsed:n})}makeCameraFollow({delta:e,elapsed:n}){}addController(e){e.obj&&this.tileRoot.add(e.obj),this.controllerShouldAdd.push(e),e.ITank_update&&this.ITank_updates.push(e);for(let i=0;i<this.onAddController.length;++i){var n=this.onAddController[i];n(e)}}checkAddController(){for(let e=0;e<this.controllerShouldAdd.length;e++){const n=this.controllerShouldAdd[e];this.controllers.push(n),n.CampType==ft.CampType.Player&&n.ObjectType==ft.ObjectType.Bullet&&this.playerBullets.push(n)}this.controllerShouldAdd.length=0}removeController(e){this.controllerShouldRemove.push(e),e.ITank_update&&ft.removeArrayValue(this.ITank_updates,e),e.onRemove&&e.onRemove();for(let i=0;i<this.onRemoveController.length;++i){var n=this.onRemoveController[i];n(e)}}checkRemoveController(){for(let e=0;e<this.controllerShouldRemove.length;e++){const n=this.controllerShouldRemove[e];ft.removeArrayValue(this.controllers,n),ft.removeArrayValue(this.playerBullets,n),this.tileRoot.remove(n.obj)}this.controllerShouldRemove.length=0}checkCollision({delta:e,elapsed:n}){for(let i=0;i<this.playerBullets.length;i++){const s=this.playerBullets[i];let o=this.rc.getStandGrid(s.obj.position,.5);if(this.rc.isGridInBound(o)){let a=this.getTilesByGrid(o);a.length>0&&this.onCollisionTiles(a,s)}else this.removeController(s)}for(let i=0;i<this.playerBullets.length;i++){const s=this.playerBullets[i];for(let o=0;o<this.enermyMan.tanks.length;o++){const a=this.enermyMan.tanks[o];if(a.Shape.intersect(s.Shape)){this.onCollisionBulletVsTank(s,a);break}}}}removeTile(e,n){}onCollisionTiles(e,n){this.removeController(n);for(let s=0;s<e.length;++s){var i=e[s];n.canHitTileTypes.indexOf(i.tileType)<0||(i.blood-=n.power,i.tileType==ft.TileType.Brick&&i.blood==1&&(i.obj.children[0].material=this.brickHitMaterial),i.blood<=0&&(i.tileType=0,this.tileRoot.remove(i.obj),i.obj=null))}}onCollisionBulletVsTank(e,n){this.removeController(e),this.removeController(n)}}const Ap=(r,e)=>{const n=r.__vccOpts||r;for(const[i,s]of e)n[i]=s;return n},rke=xt("TresPerspectiveCamera",{position:[0,20,0],rotation:[0,0,0]},null,-1),ske=xt("TresAmbientLight",{intensity:1},null,-1),oke=xt("TresAxesHelper",null,null,-1),ake={__name:"TankMain",setup(r){const e=Qn(null);return Gi(e,()=>{window.game=new nke(e),window.game.run()}),(n,i)=>{const s=bt("TresCanvas");return ri(),Ji("div",null,[Pe(s,{ref_key:"canvasRef",ref:e,"clear-color":"#FDF5E6","window-size":""},{default:qe(()=>[rke,ske,oke,Pe(oi(R2))]),_:1},512)])}}};var $O={exports:{}},Tv={},GM={},HM={},oV;function $i(){return oV||(oV=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._registerNode=r.Konva=r.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}r.glob=typeof Ia<"u"?Ia:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},r.Konva={_global:r.glob,version:"9.3.12",isBrowser:n(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return r.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return r.Konva.DD.isDragging},isTransforming(){var s;return(s=r.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!r.Konva.DD.node},releaseCanvasOnDestroy:!0,document:r.glob.document,_injectGlobal(s){r.glob.Konva=s}};const i=s=>{r.Konva[s.prototype.getClassName()]=s};r._registerNode=i,r.Konva._injectGlobal(r.Konva)}(HM)),HM}var QM={},aV;function dr(){return aV||(aV=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Util=r.Transform=void 0;const e=$i();class n{constructor(T=[1,0,0,1,0,0]){this.dirty=!1,this.m=T&&T.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(T){T.m[0]=this.m[0],T.m[1]=this.m[1],T.m[2]=this.m[2],T.m[3]=this.m[3],T.m[4]=this.m[4],T.m[5]=this.m[5]}point(T){var A=this.m;return{x:A[0]*T.x+A[2]*T.y+A[4],y:A[1]*T.x+A[3]*T.y+A[5]}}translate(T,A){return this.m[4]+=this.m[0]*T+this.m[2]*A,this.m[5]+=this.m[1]*T+this.m[3]*A,this}scale(T,A){return this.m[0]*=T,this.m[1]*=T,this.m[2]*=A,this.m[3]*=A,this}rotate(T){var A=Math.cos(T),P=Math.sin(T),N=this.m[0]*A+this.m[2]*P,k=this.m[1]*A+this.m[3]*P,R=this.m[0]*-P+this.m[2]*A,E=this.m[1]*-P+this.m[3]*A;return this.m[0]=N,this.m[1]=k,this.m[2]=R,this.m[3]=E,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(T,A){var P=this.m[0]+this.m[2]*A,N=this.m[1]+this.m[3]*A,k=this.m[2]+this.m[0]*T,R=this.m[3]+this.m[1]*T;return this.m[0]=P,this.m[1]=N,this.m[2]=k,this.m[3]=R,this}multiply(T){var A=this.m[0]*T.m[0]+this.m[2]*T.m[1],P=this.m[1]*T.m[0]+this.m[3]*T.m[1],N=this.m[0]*T.m[2]+this.m[2]*T.m[3],k=this.m[1]*T.m[2]+this.m[3]*T.m[3],R=this.m[0]*T.m[4]+this.m[2]*T.m[5]+this.m[4],E=this.m[1]*T.m[4]+this.m[3]*T.m[5]+this.m[5];return this.m[0]=A,this.m[1]=P,this.m[2]=N,this.m[3]=k,this.m[4]=R,this.m[5]=E,this}invert(){var T=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),A=this.m[3]*T,P=-this.m[1]*T,N=-this.m[2]*T,k=this.m[0]*T,R=T*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),E=T*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=A,this.m[1]=P,this.m[2]=N,this.m[3]=k,this.m[4]=R,this.m[5]=E,this}getMatrix(){return this.m}decompose(){var T=this.m[0],A=this.m[1],P=this.m[2],N=this.m[3],k=this.m[4],R=this.m[5],E=T*N-A*P;let D={x:k,y:R,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(T!=0||A!=0){var $=Math.sqrt(T*T+A*A);D.rotation=A>0?Math.acos(T/$):-Math.acos(T/$),D.scaleX=$,D.scaleY=E/$,D.skewX=(T*P+A*N)/E,D.skewY=0}else if(P!=0||N!=0){var I=Math.sqrt(P*P+N*N);D.rotation=Math.PI/2-(N>0?Math.acos(-P/I):-Math.acos(P/I)),D.scaleX=E/I,D.scaleY=I,D.skewX=0,D.skewY=(T*P+A*N)/E}return D.rotation=r.Util._getRotation(D.rotation),D}}r.Transform=n;var i="[object Array]",s="[object Number]",o="[object String]",a="[object Boolean]",l=Math.PI/180,h=180/Math.PI,u="#",f="",p="0",m="Konva warning: ",v="Konva error: ",y="rgb(",x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,S=[];const O=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(_){setTimeout(_,60)};r.Util={_isElement(_){return!!(_&&_.nodeType==1)},_isFunction(_){return!!(_&&_.constructor&&_.call&&_.apply)},_isPlainObject(_){return!!_&&_.constructor===Object},_isArray(_){return Object.prototype.toString.call(_)===i},_isNumber(_){return Object.prototype.toString.call(_)===s&&!isNaN(_)&&isFinite(_)},_isString(_){return Object.prototype.toString.call(_)===o},_isBoolean(_){return Object.prototype.toString.call(_)===a},isObject(_){return _ instanceof Object},isValidSelector(_){if(typeof _!="string")return!1;var T=_[0];return T==="#"||T==="."||T===T.toUpperCase()},_sign(_){return _===0||_>0?1:-1},requestAnimFrame(_){S.push(_),S.length===1&&O(function(){const T=S;S=[],T.forEach(function(A){A()})})},createCanvasElement(){var _=document.createElement("canvas");try{_.style=_.style||{}}catch{}return _},createImageElement(){return document.createElement("img")},_isInDocument(_){for(;_=_.parentNode;)if(_==document)return!0;return!1},_urlToImage(_,T){var A=r.Util.createImageElement();A.onload=function(){T(A)},A.src=_},_rgbToHex(_,T,A){return((1<<24)+(_<<16)+(T<<8)+A).toString(16).slice(1)},_hexToRgb(_){_=_.replace(u,f);var T=parseInt(_,16);return{r:T>>16&255,g:T>>8&255,b:T&255}},getRandomColor(){for(var _=(Math.random()*16777215<<0).toString(16);_.length<6;)_=p+_;return u+_},getRGB(_){var T;return _ in x?(T=x[_],{r:T[0],g:T[1],b:T[2]}):_[0]===u?this._hexToRgb(_.substring(1)):_.substr(0,4)===y?(T=w.exec(_.replace(/ /g,"")),{r:parseInt(T[1],10),g:parseInt(T[2],10),b:parseInt(T[3],10)}):{r:0,g:0,b:0}},colorToRGBA(_){return _=_||"black",r.Util._namedColorToRBA(_)||r.Util._hex3ColorToRGBA(_)||r.Util._hex4ColorToRGBA(_)||r.Util._hex6ColorToRGBA(_)||r.Util._hex8ColorToRGBA(_)||r.Util._rgbColorToRGBA(_)||r.Util._rgbaColorToRGBA(_)||r.Util._hslColorToRGBA(_)},_namedColorToRBA(_){var T=x[_.toLowerCase()];return T?{r:T[0],g:T[1],b:T[2],a:1}:null},_rgbColorToRGBA(_){if(_.indexOf("rgb(")===0){_=_.match(/rgb\(([^)]+)\)/)[1];var T=_.split(/ *, */).map(Number);return{r:T[0],g:T[1],b:T[2],a:1}}},_rgbaColorToRGBA(_){if(_.indexOf("rgba(")===0){_=_.match(/rgba\(([^)]+)\)/)[1];var T=_.split(/ *, */).map((A,P)=>A.slice(-1)==="%"?P===3?parseInt(A)/100:parseInt(A)/100*255:Number(A));return{r:T[0],g:T[1],b:T[2],a:T[3]}}},_hex8ColorToRGBA(_){if(_[0]==="#"&&_.length===9)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:parseInt(_.slice(7,9),16)/255}},_hex6ColorToRGBA(_){if(_[0]==="#"&&_.length===7)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:1}},_hex4ColorToRGBA(_){if(_[0]==="#"&&_.length===5)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:parseInt(_[4]+_[4],16)/255}},_hex3ColorToRGBA(_){if(_[0]==="#"&&_.length===4)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:1}},_hslColorToRGBA(_){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(_)){const[T,...A]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(_),P=Number(A[0])/360,N=Number(A[1])/100,k=Number(A[2])/100;let R,E,D;if(N===0)return D=k*255,{r:Math.round(D),g:Math.round(D),b:Math.round(D),a:1};k<.5?R=k*(1+N):R=k+N-k*N;const $=2*k-R,I=[0,0,0];for(let L=0;L<3;L++)E=P+1/3*-(L-1),E<0&&E++,E>1&&E--,6*E<1?D=$+(R-$)*6*E:2*E<1?D=R:3*E<2?D=$+(R-$)*(2/3-E)*6:D=$,I[L]=D*255;return{r:Math.round(I[0]),g:Math.round(I[1]),b:Math.round(I[2]),a:1}}},haveIntersection(_,T){return!(T.x>_.x+_.width||T.x+T.width<_.x||T.y>_.y+_.height||T.y+T.height<_.y)},cloneObject(_){var T={};for(var A in _)this._isPlainObject(_[A])?T[A]=this.cloneObject(_[A]):this._isArray(_[A])?T[A]=this.cloneArray(_[A]):T[A]=_[A];return T},cloneArray(_){return _.slice(0)},degToRad(_){return _*l},radToDeg(_){return _*h},_degToRad(_){return r.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),r.Util.degToRad(_)},_radToDeg(_){return r.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),r.Util.radToDeg(_)},_getRotation(_){return e.Konva.angleDeg?r.Util.radToDeg(_):_},_capitalize(_){return _.charAt(0).toUpperCase()+_.slice(1)},throw(_){throw new Error(v+_)},error(_){console.error(v+_)},warn(_){e.Konva.showWarnings&&console.warn(m+_)},each(_,T){for(var A in _)T(A,_[A])},_inRange(_,T,A){return T<=_&&_<A},_getProjectionToSegment(_,T,A,P,N,k){var R,E,D,$=(_-A)*(_-A)+(T-P)*(T-P);if($==0)R=_,E=T,D=(N-A)*(N-A)+(k-P)*(k-P);else{var I=((N-_)*(A-_)+(k-T)*(P-T))/$;I<0?(R=_,E=T,D=(_-N)*(_-N)+(T-k)*(T-k)):I>1?(R=A,E=P,D=(A-N)*(A-N)+(P-k)*(P-k)):(R=_+I*(A-_),E=T+I*(P-T),D=(R-N)*(R-N)+(E-k)*(E-k))}return[R,E,D]},_getProjectionToLine(_,T,A){var P=r.Util.cloneObject(_),N=Number.MAX_VALUE;return T.forEach(function(k,R){if(!(!A&&R===T.length-1)){var E=T[(R+1)%T.length],D=r.Util._getProjectionToSegment(k.x,k.y,E.x,E.y,_.x,_.y),$=D[0],I=D[1],L=D[2];L<N&&(P.x=$,P.y=I,N=L)}}),P},_prepareArrayForTween(_,T,A){var P,N=[],k=[];if(_.length>T.length){var R=T;T=_,_=R}for(P=0;P<_.length;P+=2)N.push({x:_[P],y:_[P+1]});for(P=0;P<T.length;P+=2)k.push({x:T[P],y:T[P+1]});var E=[];return k.forEach(function(D){var $=r.Util._getProjectionToLine(D,N,A);E.push($.x),E.push($.y)}),E},_prepareToStringify(_){var T;_.visitedByCircularReferenceRemoval=!0;for(var A in _)if(_.hasOwnProperty(A)&&_[A]&&typeof _[A]=="object"){if(T=Object.getOwnPropertyDescriptor(_,A),_[A].visitedByCircularReferenceRemoval||r.Util._isElement(_[A]))if(T.configurable)delete _[A];else return null;else if(r.Util._prepareToStringify(_[A])===null)if(T.configurable)delete _[A];else return null}return delete _.visitedByCircularReferenceRemoval,_},_assign(_,T){for(var A in T)_[A]=T[A];return _},_getFirstPointerId(_){return _.touches?_.changedTouches[0].identifier:_.pointerId||999},releaseCanvas(..._){e.Konva.releaseCanvasOnDestroy&&_.forEach(T=>{T.width=0,T.height=0})},drawRoundedRectPath(_,T,A,P){let N=0,k=0,R=0,E=0;typeof P=="number"?N=k=R=E=Math.min(P,T/2,A/2):(N=Math.min(P[0]||0,T/2,A/2),k=Math.min(P[1]||0,T/2,A/2),E=Math.min(P[2]||0,T/2,A/2),R=Math.min(P[3]||0,T/2,A/2)),_.moveTo(N,0),_.lineTo(T-k,0),_.arc(T-k,k,k,Math.PI*3/2,0,!1),_.lineTo(T,A-E),_.arc(T-E,A-E,E,0,Math.PI/2,!1),_.lineTo(R,A),_.arc(R,A-R,R,Math.PI/2,Math.PI,!1),_.lineTo(0,N),_.arc(N,N,N,Math.PI,Math.PI*3/2,!1)}}}(QM)),QM}var Ev={},jM={},Nn={},lV;function Hi(){if(lV)return Nn;lV=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.getComponentValidator=Nn.getBooleanValidator=Nn.getNumberArrayValidator=Nn.getFunctionValidator=Nn.getStringOrGradientValidator=Nn.getStringValidator=Nn.getNumberOrAutoValidator=Nn.getNumberOrArrayOfNumbersValidator=Nn.getNumberValidator=Nn.alphaComponent=Nn.RGBComponent=void 0;const r=$i(),e=dr();function n(y){return e.Util._isString(y)?'"'+y+'"':Object.prototype.toString.call(y)==="[object Number]"||e.Util._isBoolean(y)?y:Object.prototype.toString.call(y)}function i(y){return y>255?255:y<0?0:Math.round(y)}Nn.RGBComponent=i;function s(y){return y>1?1:y<1e-4?1e-4:y}Nn.alphaComponent=s;function o(){if(r.Konva.isUnminified)return function(y,x){return e.Util._isNumber(y)||e.Util.warn(n(y)+' is a not valid value for "'+x+'" attribute. The value should be a number.'),y}}Nn.getNumberValidator=o;function a(y){if(r.Konva.isUnminified)return function(x,w){let S=e.Util._isNumber(x),O=e.Util._isArray(x)&&x.length==y;return!S&&!O&&e.Util.warn(n(x)+' is a not valid value for "'+w+'" attribute. The value should be a number or Array<number>('+y+")"),x}}Nn.getNumberOrArrayOfNumbersValidator=a;function l(){if(r.Konva.isUnminified)return function(y,x){var w=e.Util._isNumber(y),S=y==="auto";return w||S||e.Util.warn(n(y)+' is a not valid value for "'+x+'" attribute. The value should be a number or "auto".'),y}}Nn.getNumberOrAutoValidator=l;function h(){if(r.Konva.isUnminified)return function(y,x){return e.Util._isString(y)||e.Util.warn(n(y)+' is a not valid value for "'+x+'" attribute. The value should be a string.'),y}}Nn.getStringValidator=h;function u(){if(r.Konva.isUnminified)return function(y,x){const w=e.Util._isString(y),S=Object.prototype.toString.call(y)==="[object CanvasGradient]"||y&&y.addColorStop;return w||S||e.Util.warn(n(y)+' is a not valid value for "'+x+'" attribute. The value should be a string or a native gradient.'),y}}Nn.getStringOrGradientValidator=u;function f(){if(r.Konva.isUnminified)return function(y,x){return e.Util._isFunction(y)||e.Util.warn(n(y)+' is a not valid value for "'+x+'" attribute. The value should be a function.'),y}}Nn.getFunctionValidator=f;function p(){if(r.Konva.isUnminified)return function(y,x){const w=Int8Array?Object.getPrototypeOf(Int8Array):null;return w&&y instanceof w||(e.Util._isArray(y)?y.forEach(function(S){e.Util._isNumber(S)||e.Util.warn('"'+x+'" attribute has non numeric element '+S+". Make sure that all elements are numbers.")}):e.Util.warn(n(y)+' is a not valid value for "'+x+'" attribute. The value should be a array of numbers.')),y}}Nn.getNumberArrayValidator=p;function m(){if(r.Konva.isUnminified)return function(y,x){var w=y===!0||y===!1;return w||e.Util.warn(n(y)+' is a not valid value for "'+x+'" attribute. The value should be a boolean.'),y}}Nn.getBooleanValidator=m;function v(y){if(r.Konva.isUnminified)return function(x,w){return x==null||e.Util.isObject(x)||e.Util.warn(n(x)+' is a not valid value for "'+w+'" attribute. The value should be an object with properties '+y),x}}return Nn.getComponentValidator=v,Nn}var cV;function Ui(){return cV||(cV=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Factory=void 0;const e=dr(),n=Hi();var i="get",s="set";r.Factory={addGetterSetter(o,a,l,h,u){r.Factory.addGetter(o,a,l),r.Factory.addSetter(o,a,h,u),r.Factory.addOverloadedGetterSetter(o,a)},addGetter(o,a,l){var h=i+e.Util._capitalize(a);o.prototype[h]=o.prototype[h]||function(){var u=this.attrs[a];return u===void 0?l:u}},addSetter(o,a,l,h){var u=s+e.Util._capitalize(a);o.prototype[u]||r.Factory.overWriteSetter(o,a,l,h)},overWriteSetter(o,a,l,h){var u=s+e.Util._capitalize(a);o.prototype[u]=function(f){return l&&f!==void 0&&f!==null&&(f=l.call(this,f,a)),this._setAttr(a,f),h&&h.call(this),this}},addComponentsGetterSetter(o,a,l,h,u){var f=l.length,p=e.Util._capitalize,m=i+p(a),v=s+p(a),y,x;o.prototype[m]=function(){var S={};for(y=0;y<f;y++)x=l[y],S[x]=this.getAttr(a+p(x));return S};var w=(0,n.getComponentValidator)(l);o.prototype[v]=function(S){var O=this.attrs[a],_;h&&(S=h.call(this,S)),w&&w.call(this,S,a);for(_ in S)S.hasOwnProperty(_)&&this._setAttr(a+p(_),S[_]);return S||l.forEach(T=>{this._setAttr(a+p(T),void 0)}),this._fireChangeEvent(a,O,S),u&&u.call(this),this},r.Factory.addOverloadedGetterSetter(o,a)},addOverloadedGetterSetter(o,a){var l=e.Util._capitalize(a),h=s+l,u=i+l;o.prototype[a]=function(){return arguments.length?(this[h](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(o,a,l,h){e.Util.error("Adding deprecated "+a);var u=i+e.Util._capitalize(a),f=a+" property is deprecated and will be removed soon. Look at Konva change log for more information.";o.prototype[u]=function(){e.Util.error(f);var p=this.attrs[a];return p===void 0?l:p},r.Factory.addSetter(o,a,h,function(){e.Util.error(f)}),r.Factory.addOverloadedGetterSetter(o,a)},backCompat(o,a){e.Util.each(a,function(l,h){var u=o.prototype[h],f=i+e.Util._capitalize(l),p=s+e.Util._capitalize(l);function m(){u.apply(this,arguments),e.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+h+'" instead.')}o.prototype[l]=m,o.prototype[f]=m,o.prototype[p]=m})},afterSetFilter(){this._filterUpToDate=!1}}}(jM)),jM}var zc={},Xc={},hV;function lj(){if(hV)return Xc;hV=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.HitContext=Xc.SceneContext=Xc.Context=void 0;const r=dr(),e=$i();function n(S){var O=[],_=S.length,T=r.Util,A,P;for(A=0;A<_;A++)P=S[A],T._isNumber(P)?P=Math.round(P*1e3)/1e3:T._isString(P)||(P=P+""),O.push(P);return O}var i=",",s="(",o=")",a="([",l="])",h=";",u="()",f="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],m=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const v=100;let y=class{constructor(O){this.canvas=O,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(O){O.fillEnabled()&&this._fill(O)}_fill(O){}strokeShape(O){O.hasStroke()&&this._stroke(O)}_stroke(O){}fillStrokeShape(O){O.attrs.fillAfterStrokeEnabled?(this.strokeShape(O),this.fillShape(O)):(this.fillShape(O),this.strokeShape(O))}getTrace(O,_){var T=this.traceArr,A=T.length,P="",N,k,R,E;for(N=0;N<A;N++)k=T[N],R=k.method,R?(E=k.args,P+=R,O?P+=u:r.Util._isArray(E[0])?P+=a+E.join(i)+l:(_&&(E=E.map(D=>typeof D=="number"?Math.floor(D):D)),P+=s+E.join(i)+o)):(P+=k.property,O||(P+=f+k.val)),P+=h;return P}clearTrace(){this.traceArr=[]}_trace(O){var _=this.traceArr,T;_.push(O),T=_.length,T>=v&&_.shift()}reset(){var O=this.getCanvas().getPixelRatio();this.setTransform(1*O,0,0,1*O,0,0)}getCanvas(){return this.canvas}clear(O){var _=this.getCanvas();O?this.clearRect(O.x||0,O.y||0,O.width||0,O.height||0):this.clearRect(0,0,_.getWidth()/_.pixelRatio,_.getHeight()/_.pixelRatio)}_applyLineCap(O){const _=O.attrs.lineCap;_&&this.setAttr("lineCap",_)}_applyOpacity(O){var _=O.getAbsoluteOpacity();_!==1&&this.setAttr("globalAlpha",_)}_applyLineJoin(O){const _=O.attrs.lineJoin;_&&this.setAttr("lineJoin",_)}setAttr(O,_){this._context[O]=_}arc(O,_,T,A,P,N){this._context.arc(O,_,T,A,P,N)}arcTo(O,_,T,A,P){this._context.arcTo(O,_,T,A,P)}beginPath(){this._context.beginPath()}bezierCurveTo(O,_,T,A,P,N){this._context.bezierCurveTo(O,_,T,A,P,N)}clearRect(O,_,T,A){this._context.clearRect(O,_,T,A)}clip(...O){this._context.clip.apply(this._context,O)}closePath(){this._context.closePath()}createImageData(O,_){var T=arguments;if(T.length===2)return this._context.createImageData(O,_);if(T.length===1)return this._context.createImageData(O)}createLinearGradient(O,_,T,A){return this._context.createLinearGradient(O,_,T,A)}createPattern(O,_){return this._context.createPattern(O,_)}createRadialGradient(O,_,T,A,P,N){return this._context.createRadialGradient(O,_,T,A,P,N)}drawImage(O,_,T,A,P,N,k,R,E){var D=arguments,$=this._context;D.length===3?$.drawImage(O,_,T):D.length===5?$.drawImage(O,_,T,A,P):D.length===9&&$.drawImage(O,_,T,A,P,N,k,R,E)}ellipse(O,_,T,A,P,N,k,R){this._context.ellipse(O,_,T,A,P,N,k,R)}isPointInPath(O,_,T,A){return T?this._context.isPointInPath(T,O,_,A):this._context.isPointInPath(O,_,A)}fill(...O){this._context.fill.apply(this._context,O)}fillRect(O,_,T,A){this._context.fillRect(O,_,T,A)}strokeRect(O,_,T,A){this._context.strokeRect(O,_,T,A)}fillText(O,_,T,A){A?this._context.fillText(O,_,T,A):this._context.fillText(O,_,T)}measureText(O){return this._context.measureText(O)}getImageData(O,_,T,A){return this._context.getImageData(O,_,T,A)}lineTo(O,_){this._context.lineTo(O,_)}moveTo(O,_){this._context.moveTo(O,_)}rect(O,_,T,A){this._context.rect(O,_,T,A)}roundRect(O,_,T,A,P){this._context.roundRect(O,_,T,A,P)}putImageData(O,_,T){this._context.putImageData(O,_,T)}quadraticCurveTo(O,_,T,A){this._context.quadraticCurveTo(O,_,T,A)}restore(){this._context.restore()}rotate(O){this._context.rotate(O)}save(){this._context.save()}scale(O,_){this._context.scale(O,_)}setLineDash(O){this._context.setLineDash?this._context.setLineDash(O):"mozDash"in this._context?this._context.mozDash=O:"webkitLineDash"in this._context&&(this._context.webkitLineDash=O)}getLineDash(){return this._context.getLineDash()}setTransform(O,_,T,A,P,N){this._context.setTransform(O,_,T,A,P,N)}stroke(O){O?this._context.stroke(O):this._context.stroke()}strokeText(O,_,T,A){this._context.strokeText(O,_,T,A)}transform(O,_,T,A,P,N){this._context.transform(O,_,T,A,P,N)}translate(O,_){this._context.translate(O,_)}_enableTrace(){var O=this,_=p.length,T=this.setAttr,A,P,N=function(k){var R=O[k],E;O[k]=function(){return P=n(Array.prototype.slice.call(arguments,0)),E=R.apply(O,arguments),O._trace({method:k,args:P}),E}};for(A=0;A<_;A++)N(p[A]);O.setAttr=function(){T.apply(O,arguments);var k=arguments[0],R=arguments[1];(k==="shadowOffsetX"||k==="shadowOffsetY"||k==="shadowBlur")&&(R=R/this.canvas.getPixelRatio()),O._trace({property:k,val:R})}}_applyGlobalCompositeOperation(O){const _=O.attrs.globalCompositeOperation;var T=!_||_==="source-over";T||this.setAttr("globalCompositeOperation",_)}};Xc.Context=y,m.forEach(function(S){Object.defineProperty(y.prototype,S,{get(){return this._context[S]},set(O){this._context[S]=O}})});class x extends y{constructor(O,{willReadFrequently:_=!1}={}){super(O),this._context=O._canvas.getContext("2d",{willReadFrequently:_})}_fillColor(O){var _=O.fill();this.setAttr("fillStyle",_),O._fillFunc(this)}_fillPattern(O){this.setAttr("fillStyle",O._getFillPattern()),O._fillFunc(this)}_fillLinearGradient(O){var _=O._getLinearGradient();_&&(this.setAttr("fillStyle",_),O._fillFunc(this))}_fillRadialGradient(O){const _=O._getRadialGradient();_&&(this.setAttr("fillStyle",_),O._fillFunc(this))}_fill(O){const _=O.fill(),T=O.getFillPriority();if(_&&T==="color"){this._fillColor(O);return}const A=O.getFillPatternImage();if(A&&T==="pattern"){this._fillPattern(O);return}const P=O.getFillLinearGradientColorStops();if(P&&T==="linear-gradient"){this._fillLinearGradient(O);return}const N=O.getFillRadialGradientColorStops();if(N&&T==="radial-gradient"){this._fillRadialGradient(O);return}_?this._fillColor(O):A?this._fillPattern(O):P?this._fillLinearGradient(O):N&&this._fillRadialGradient(O)}_strokeLinearGradient(O){const _=O.getStrokeLinearGradientStartPoint(),T=O.getStrokeLinearGradientEndPoint(),A=O.getStrokeLinearGradientColorStops(),P=this.createLinearGradient(_.x,_.y,T.x,T.y);if(A){for(var N=0;N<A.length;N+=2)P.addColorStop(A[N],A[N+1]);this.setAttr("strokeStyle",P)}}_stroke(O){var _=O.dash(),T=O.getStrokeScaleEnabled();if(O.hasStroke()){if(!T){this.save();var A=this.getCanvas().getPixelRatio();this.setTransform(A,0,0,A,0,0)}this._applyLineCap(O),_&&O.dashEnabled()&&(this.setLineDash(_),this.setAttr("lineDashOffset",O.dashOffset())),this.setAttr("lineWidth",O.strokeWidth()),O.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var P=O.getStrokeLinearGradientColorStops();P?this._strokeLinearGradient(O):this.setAttr("strokeStyle",O.stroke()),O._strokeFunc(this),T||this.restore()}}_applyShadow(O){var _,T,A,P=(_=O.getShadowRGBA())!==null&&_!==void 0?_:"black",N=(T=O.getShadowBlur())!==null&&T!==void 0?T:5,k=(A=O.getShadowOffset())!==null&&A!==void 0?A:{x:0,y:0},R=O.getAbsoluteScale(),E=this.canvas.getPixelRatio(),D=R.x*E,$=R.y*E;this.setAttr("shadowColor",P),this.setAttr("shadowBlur",N*Math.min(Math.abs(D),Math.abs($))),this.setAttr("shadowOffsetX",k.x*D),this.setAttr("shadowOffsetY",k.y*$)}}Xc.SceneContext=x;class w extends y{constructor(O){super(O),this._context=O._canvas.getContext("2d",{willReadFrequently:!0})}_fill(O){this.save(),this.setAttr("fillStyle",O.colorKey),O._fillFuncHit(this),this.restore()}strokeShape(O){O.hasHitStroke()&&this._stroke(O)}_stroke(O){if(O.hasHitStroke()){const P=O.getStrokeScaleEnabled();if(!P){this.save();var _=this.getCanvas().getPixelRatio();this.setTransform(_,0,0,_,0,0)}this._applyLineCap(O);var T=O.hitStrokeWidth(),A=T==="auto"?O.strokeWidth():T;this.setAttr("lineWidth",A),this.setAttr("strokeStyle",O.colorKey),O._strokeFuncHit(this),P||this.restore()}}}return Xc.HitContext=w,Xc}var uV;function D2(){if(uV)return zc;uV=1,Object.defineProperty(zc,"__esModule",{value:!0}),zc.HitCanvas=zc.SceneCanvas=zc.Canvas=void 0;const r=dr(),e=lj(),n=$i(),i=Ui(),s=Hi();var o;function a(){if(o)return o;var f=r.Util.createCanvasElement(),p=f.getContext("2d");return o=function(){var m=n.Konva._global.devicePixelRatio||1,v=p.webkitBackingStorePixelRatio||p.mozBackingStorePixelRatio||p.msBackingStorePixelRatio||p.oBackingStorePixelRatio||p.backingStorePixelRatio||1;return m/v}(),r.Util.releaseCanvas(f),o}let l=class{constructor(p){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var m=p||{},v=m.pixelRatio||n.Konva.pixelRatio||a();this.pixelRatio=v,this._canvas=r.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(p){var m=this.pixelRatio;this.pixelRatio=p,this.setSize(this.getWidth()/m,this.getHeight()/m)}setWidth(p){this.width=this._canvas.width=p*this.pixelRatio,this._canvas.style.width=p+"px";var m=this.pixelRatio,v=this.getContext()._context;v.scale(m,m)}setHeight(p){this.height=this._canvas.height=p*this.pixelRatio,this._canvas.style.height=p+"px";var m=this.pixelRatio,v=this.getContext()._context;v.scale(m,m)}getWidth(){return this.width}getHeight(){return this.height}setSize(p,m){this.setWidth(p||0),this.setHeight(m||0)}toDataURL(p,m){try{return this._canvas.toDataURL(p,m)}catch{try{return this._canvas.toDataURL()}catch(y){return r.Util.error("Unable to get data URL. "+y.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};zc.Canvas=l,i.Factory.addGetterSetter(l,"pixelRatio",void 0,(0,s.getNumberValidator)());class h extends l{constructor(p={width:0,height:0,willReadFrequently:!1}){super(p),this.context=new e.SceneContext(this,{willReadFrequently:p.willReadFrequently}),this.setSize(p.width,p.height)}}zc.SceneCanvas=h;class u extends l{constructor(p={width:0,height:0}){super(p),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(p.width,p.height)}}return zc.HitCanvas=u,zc}var YM={},dV;function t5(){return dV||(dV=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DD=void 0;const e=$i(),n=dr();r.DD={get isDragging(){var i=!1;return r.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){var i;return r.DD._dragElements.forEach(s=>{i=s.node}),i},_dragElements:new Map,_drag(i){const s=[];r.DD._dragElements.forEach((o,a)=>{const{node:l}=o,h=l.getStage();h.setPointersPositions(i),o.pointerId===void 0&&(o.pointerId=n.Util._getFirstPointerId(i));const u=h._changedPointerPositions.find(m=>m.id===o.pointerId);if(u){if(o.dragStatus!=="dragging"){var f=l.dragDistance(),p=Math.max(Math.abs(u.x-o.startPointerPos.x),Math.abs(u.y-o.startPointerPos.y));if(p<f||(l.startDrag({evt:i}),!l.isDragging()))return}l._setDragPosition(i,o),s.push(l)}}),s.forEach(o=>{o.fire("dragmove",{type:"dragmove",target:o,evt:i},!0)})},_endDragBefore(i){const s=[];r.DD._dragElements.forEach(o=>{const{node:a}=o,l=a.getStage();if(i&&l.setPointersPositions(i),!l._changedPointerPositions.find(f=>f.id===o.pointerId))return;(o.dragStatus==="dragging"||o.dragStatus==="stopped")&&(r.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,o.dragStatus="stopped");const u=o.node.getLayer()||o.node instanceof e.Konva.Stage&&o.node;u&&s.indexOf(u)===-1&&s.push(u)}),s.forEach(o=>{o.draw()})},_endDragAfter(i){r.DD._dragElements.forEach((s,o)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:i},!0),s.dragStatus!=="dragging"&&r.DD._dragElements.delete(o)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",r.DD._endDragBefore,!0),window.addEventListener("touchend",r.DD._endDragBefore,!0),window.addEventListener("mousemove",r.DD._drag),window.addEventListener("touchmove",r.DD._drag),window.addEventListener("mouseup",r.DD._endDragAfter,!1),window.addEventListener("touchend",r.DD._endDragAfter,!1))}(YM)),YM}var fV;function yr(){if(fV)return Ev;fV=1,Object.defineProperty(Ev,"__esModule",{value:!0}),Ev.Node=void 0;const r=dr(),e=Ui(),n=D2(),i=$i(),s=t5(),o=Hi();var a="absoluteOpacity",l="allEventListeners",h="absoluteTransform",u="absoluteScale",f="canvas",p="Change",m="children",v="konva",y="listening",x="mouseenter",w="mouseleave",S="set",O="Shape",_=" ",T="stage",A="transform",P="Stage",N="visible",k=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(_);let R=1;class E{constructor(I){this._id=R++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(I),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(I){(I===A||I===h)&&this._cache.get(I)?this._cache.get(I).dirty=!0:I?this._cache.delete(I):this._cache.clear()}_getCache(I,L){var U=this._cache.get(I),V=I===A||I===h,X=U===void 0||V&&U.dirty===!0;return X&&(U=L.call(this),this._cache.set(I,U)),U}_calculate(I,L,U){if(!this._attachedDepsListeners.get(I)){const V=L.map(X=>X+"Change.konva").join(_);this.on(V,()=>{this._clearCache(I)}),this._attachedDepsListeners.set(I,!0)}return this._getCache(I,U)}_getCanvasCache(){return this._cache.get(f)}_clearSelfAndDescendantCache(I){this._clearCache(I),I===h&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(f)){const{scene:I,filter:L,hit:U}=this._cache.get(f);r.Util.releaseCanvas(I,L,U),this._cache.delete(f)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(I){var L=I||{},U={};(L.x===void 0||L.y===void 0||L.width===void 0||L.height===void 0)&&(U=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var V=Math.ceil(L.width||U.width),X=Math.ceil(L.height||U.height),H=L.pixelRatio,J=L.x===void 0?Math.floor(U.x):L.x,ee=L.y===void 0?Math.floor(U.y):L.y,ne=L.offset||0,ge=L.drawBorder||!1,ye=L.hitCanvasPixelRatio||1;if(!V||!X){r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const ce=Math.abs(Math.round(U.x)-J)>.5?1:0,we=Math.abs(Math.round(U.y)-ee)>.5?1:0;V+=ne*2+ce,X+=ne*2+we,J-=ne,ee-=ne;var be=new n.SceneCanvas({pixelRatio:H,width:V,height:X}),se=new n.SceneCanvas({pixelRatio:H,width:0,height:0,willReadFrequently:!0}),ae=new n.HitCanvas({pixelRatio:ye,width:V,height:X}),Q=be.getContext(),z=ae.getContext();return ae.isCache=!0,be.isCache=!0,this._cache.delete(f),this._filterUpToDate=!1,L.imageSmoothingEnabled===!1&&(be.getContext()._context.imageSmoothingEnabled=!1,se.getContext()._context.imageSmoothingEnabled=!1),Q.save(),z.save(),Q.translate(-J,-ee),z.translate(-J,-ee),this._isUnderCache=!0,this._clearSelfAndDescendantCache(a),this._clearSelfAndDescendantCache(u),this.drawScene(be,this),this.drawHit(ae,this),this._isUnderCache=!1,Q.restore(),z.restore(),ge&&(Q.save(),Q.beginPath(),Q.rect(0,0,V,X),Q.closePath(),Q.setAttr("strokeStyle","red"),Q.setAttr("lineWidth",5),Q.stroke(),Q.restore()),this._cache.set(f,{scene:be,filter:se,hit:ae,x:J,y:ee}),this._requestDraw(),this}isCached(){return this._cache.has(f)}getClientRect(I){throw new Error('abstract "getClientRect" method call')}_transformedRect(I,L){var U=[{x:I.x,y:I.y},{x:I.x+I.width,y:I.y},{x:I.x+I.width,y:I.y+I.height},{x:I.x,y:I.y+I.height}],V=1/0,X=1/0,H=-1/0,J=-1/0,ee=this.getAbsoluteTransform(L);return U.forEach(function(ne){var ge=ee.point(ne);V===void 0&&(V=H=ge.x,X=J=ge.y),V=Math.min(V,ge.x),X=Math.min(X,ge.y),H=Math.max(H,ge.x),J=Math.max(J,ge.y)}),{x:V,y:X,width:H-V,height:J-X}}_drawCachedSceneCanvas(I){I.save(),I._applyOpacity(this),I._applyGlobalCompositeOperation(this);const L=this._getCanvasCache();I.translate(L.x,L.y);var U=this._getCachedSceneCanvas(),V=U.pixelRatio;I.drawImage(U._canvas,0,0,U.width/V,U.height/V),I.restore()}_drawCachedHitCanvas(I){var L=this._getCanvasCache(),U=L.hit;I.save(),I.translate(L.x,L.y),I.drawImage(U._canvas,0,0,U.width/U.pixelRatio,U.height/U.pixelRatio),I.restore()}_getCachedSceneCanvas(){var I=this.filters(),L=this._getCanvasCache(),U=L.scene,V=L.filter,X=V.getContext(),H,J,ee,ne;if(I){if(!this._filterUpToDate){var ge=U.pixelRatio;V.setSize(U.width/U.pixelRatio,U.height/U.pixelRatio);try{for(H=I.length,X.clear(),X.drawImage(U._canvas,0,0,U.getWidth()/ge,U.getHeight()/ge),J=X.getImageData(0,0,V.getWidth(),V.getHeight()),ee=0;ee<H;ee++){if(ne=I[ee],typeof ne!="function"){r.Util.error("Filter should be type of function, but got "+typeof ne+" instead. Please check correct filters");continue}ne.call(this,J),X.putImageData(J,0,0)}}catch(ye){r.Util.error("Unable to apply filter. "+ye.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return V}return U}on(I,L){if(this._cache&&this._cache.delete(l),arguments.length===3)return this._delegate.apply(this,arguments);var U=I.split(_),V=U.length,X,H,J,ee,ne;for(X=0;X<V;X++)H=U[X],J=H.split("."),ee=J[0],ne=J[1]||"",this.eventListeners[ee]||(this.eventListeners[ee]=[]),this.eventListeners[ee].push({name:ne,handler:L});return this}off(I,L){var U=(I||"").split(_),V=U.length,X,H,J,ee,ne,ge;if(this._cache&&this._cache.delete(l),!I)for(H in this.eventListeners)this._off(H);for(X=0;X<V;X++)if(J=U[X],ee=J.split("."),ne=ee[0],ge=ee[1],ne)this.eventListeners[ne]&&this._off(ne,ge,L);else for(H in this.eventListeners)this._off(H,ge,L);return this}dispatchEvent(I){var L={target:this,type:I.type,evt:I};return this.fire(I.type,L),this}addEventListener(I,L){return this.on(I,function(U){L.call(this,U.evt)}),this}removeEventListener(I){return this.off(I),this}_delegate(I,L,U){var V=this;this.on(I,function(X){for(var H=X.target.findAncestors(L,!0,V),J=0;J<H.length;J++)X=r.Util.cloneObject(X),X.currentTarget=H[J],U.call(H[J],X)})}remove(){return this.isDragging()&&this.stopDrag(),s.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(a),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(T),this._clearSelfAndDescendantCache(N),this._clearSelfAndDescendantCache(y)}_remove(){this._clearCaches();var I=this.getParent();I&&I.children&&(I.children.splice(this.index,1),I._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(I){var L="get"+r.Util._capitalize(I);return r.Util._isFunction(this[L])?this[L]():this.attrs[I]}getAncestors(){for(var I=this.getParent(),L=[];I;)L.push(I),I=I.getParent();return L}getAttrs(){return this.attrs||{}}setAttrs(I){return this._batchTransformChanges(()=>{var L,U;if(!I)return this;for(L in I)L!==m&&(U=S+r.Util._capitalize(L),r.Util._isFunction(this[U])?this[U](I[L]):this._setAttr(L,I[L]))}),this}isListening(){return this._getCache(y,this._isListening)}_isListening(I){if(!this.listening())return!1;const U=this.getParent();return U&&U!==I&&this!==I?U._isListening(I):!0}isVisible(){return this._getCache(N,this._isVisible)}_isVisible(I){if(!this.visible())return!1;const U=this.getParent();return U&&U!==I&&this!==I?U._isVisible(I):!0}shouldDrawHit(I,L=!1){if(I)return this._isVisible(I)&&this._isListening(I);var U=this.getLayer(),V=!1;s.DD._dragElements.forEach(H=>{H.dragStatus==="dragging"&&(H.node.nodeType==="Stage"||H.node.getLayer()===U)&&(V=!0)});var X=!L&&!i.Konva.hitOnDragEnabled&&(V||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!X}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var I=this.getDepth(),L=this,U=0,V,X,H,J;function ee(ge){for(V=[],X=ge.length,H=0;H<X;H++)J=ge[H],U++,J.nodeType!==O&&(V=V.concat(J.getChildren().slice())),J._id===L._id&&(H=X);V.length>0&&V[0].getDepth()<=I&&ee(V)}const ne=this.getStage();return L.nodeType!==P&&ne&&ee(ne.getChildren()),U}getDepth(){for(var I=0,L=this.parent;L;)I++,L=L.parent;return I}_batchTransformChanges(I){this._batchingTransformChange=!0,I(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(A),this._clearSelfAndDescendantCache(h)),this._needClearTransformCache=!1}setPosition(I){return this._batchTransformChanges(()=>{this.x(I.x),this.y(I.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const I=this.getStage();if(!I)return null;var L=I.getPointerPosition();if(!L)return null;var U=this.getAbsoluteTransform().copy();return U.invert(),U.point(L)}getAbsolutePosition(I){let L=!1,U=this.parent;for(;U;){if(U.isCached()){L=!0;break}U=U.parent}L&&!I&&(I=!0);var V=this.getAbsoluteTransform(I).getMatrix(),X=new r.Transform,H=this.offset();return X.m=V.slice(),X.translate(H.x,H.y),X.getTranslation()}setAbsolutePosition(I){const{x:L,y:U,...V}=this._clearTransform();this.attrs.x=L,this.attrs.y=U,this._clearCache(A);var X=this._getAbsoluteTransform().copy();return X.invert(),X.translate(I.x,I.y),I={x:this.attrs.x+X.getTranslation().x,y:this.attrs.y+X.getTranslation().y},this._setTransform(V),this.setPosition({x:I.x,y:I.y}),this._clearCache(A),this._clearSelfAndDescendantCache(h),this}_setTransform(I){var L;for(L in I)this.attrs[L]=I[L]}_clearTransform(){var I={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,I}move(I){var L=I.x,U=I.y,V=this.x(),X=this.y();return L!==void 0&&(V+=L),U!==void 0&&(X+=U),this.setPosition({x:V,y:X}),this}_eachAncestorReverse(I,L){var U=[],V=this.getParent(),X,H;if(!(L&&L._id===this._id)){for(U.unshift(this);V&&(!L||V._id!==L._id);)U.unshift(V),V=V.parent;for(X=U.length,H=0;H<X;H++)I(U[H])}}rotate(I){return this.rotation(this.rotation()+I),this}moveToTop(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var I=this.index,L=this.parent.getChildren().length;return I<L-1?(this.parent.children.splice(I,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;var I=this.index,L=this.parent.getChildren().length;return I<L-1?(this.parent.children.splice(I,1),this.parent.children.splice(I+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;var I=this.index;return I>0?(this.parent.children.splice(I,1),this.parent.children.splice(I-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var I=this.index;return I>0?(this.parent.children.splice(I,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(I){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(I<0||I>=this.parent.children.length)&&r.Util.warn("Unexpected value "+I+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var L=this.index;return this.parent.children.splice(L,1),this.parent.children.splice(I,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(a,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var I=this.opacity(),L=this.getParent();return L&&!L._isUnderCache&&(I*=L.getAbsoluteOpacity()),I}moveTo(I){return this.getParent()!==I&&(this._remove(),I.add(this)),this}toObject(){var I=this.getAttrs(),L,U,V,X,H;const J={attrs:{},className:this.getClassName()};for(L in I)U=I[L],H=r.Util.isObject(U)&&!r.Util._isPlainObject(U)&&!r.Util._isArray(U),!H&&(V=typeof this[L]=="function"&&this[L],delete I[L],X=V?V.call(this):null,I[L]=U,X!==U&&(J.attrs[L]=U));return r.Util._prepareToStringify(J)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(I,L,U){var V=[];L&&this._isMatch(I)&&V.push(this);for(var X=this.parent;X;){if(X===U)return V;X._isMatch(I)&&V.push(X),X=X.parent}return V}isAncestorOf(I){return!1}findAncestor(I,L,U){return this.findAncestors(I,L,U)[0]}_isMatch(I){if(!I)return!1;if(typeof I=="function")return I(this);var L=I.replace(/ /g,"").split(","),U=L.length,V,X;for(V=0;V<U;V++)if(X=L[V],r.Util.isValidSelector(X)||(r.Util.warn('Selector "'+X+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),X.charAt(0)==="#"){if(this.id()===X.slice(1))return!0}else if(X.charAt(0)==="."){if(this.hasName(X.slice(1)))return!0}else if(this.className===X||this.nodeType===X)return!0;return!1}getLayer(){var I=this.getParent();return I?I.getLayer():null}getStage(){return this._getCache(T,this._getStage)}_getStage(){var I=this.getParent();return I?I.getStage():null}fire(I,L={},U){return L.target=L.target||this,U?this._fireAndBubble(I,L):this._fire(I,L),this}getAbsoluteTransform(I){return I?this._getAbsoluteTransform(I):this._getCache(h,this._getAbsoluteTransform)}_getAbsoluteTransform(I){var L;if(I)return L=new r.Transform,this._eachAncestorReverse(function(V){var X=V.transformsEnabled();X==="all"?L.multiply(V.getTransform()):X==="position"&&L.translate(V.x()-V.offsetX(),V.y()-V.offsetY())},I),L;L=this._cache.get(h)||new r.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(L):L.reset();var U=this.transformsEnabled();if(U==="all")L.multiply(this.getTransform());else if(U==="position"){const V=this.attrs.x||0,X=this.attrs.y||0,H=this.attrs.offsetX||0,J=this.attrs.offsetY||0;L.translate(V-H,X-J)}return L.dirty=!1,L}getAbsoluteScale(I){for(var L=this;L;)L._isUnderCache&&(I=L),L=L.getParent();const V=this.getAbsoluteTransform(I).decompose();return{x:V.scaleX,y:V.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(A,this._getTransform)}_getTransform(){var I,L,U=this._cache.get(A)||new r.Transform;U.reset();var V=this.x(),X=this.y(),H=i.Konva.getAngle(this.rotation()),J=(I=this.attrs.scaleX)!==null&&I!==void 0?I:1,ee=(L=this.attrs.scaleY)!==null&&L!==void 0?L:1,ne=this.attrs.skewX||0,ge=this.attrs.skewY||0,ye=this.attrs.offsetX||0,ce=this.attrs.offsetY||0;return(V!==0||X!==0)&&U.translate(V,X),H!==0&&U.rotate(H),(ne!==0||ge!==0)&&U.skew(ne,ge),(J!==1||ee!==1)&&U.scale(J,ee),(ye!==0||ce!==0)&&U.translate(-1*ye,-1*ce),U.dirty=!1,U}clone(I){var L=r.Util.cloneObject(this.attrs),U,V,X,H,J;for(U in I)L[U]=I[U];var ee=new this.constructor(L);for(U in this.eventListeners)for(V=this.eventListeners[U],X=V.length,H=0;H<X;H++)J=V[H],J.name.indexOf(v)<0&&(ee.eventListeners[U]||(ee.eventListeners[U]=[]),ee.eventListeners[U].push(J));return ee}_toKonvaCanvas(I){I=I||{};var L=this.getClientRect(),U=this.getStage(),V=I.x!==void 0?I.x:Math.floor(L.x),X=I.y!==void 0?I.y:Math.floor(L.y),H=I.pixelRatio||1,J=new n.SceneCanvas({width:I.width||Math.ceil(L.width)||(U?U.width():0),height:I.height||Math.ceil(L.height)||(U?U.height():0),pixelRatio:H}),ee=J.getContext();const ne=new n.SceneCanvas({width:J.width/J.pixelRatio+Math.abs(V),height:J.height/J.pixelRatio+Math.abs(X),pixelRatio:J.pixelRatio});return I.imageSmoothingEnabled===!1&&(ee._context.imageSmoothingEnabled=!1),ee.save(),(V||X)&&ee.translate(-1*V,-1*X),this.drawScene(J,void 0,ne),ee.restore(),J}toCanvas(I){return this._toKonvaCanvas(I)._canvas}toDataURL(I){I=I||{};var L=I.mimeType||null,U=I.quality||null,V=this._toKonvaCanvas(I).toDataURL(L,U);return I.callback&&I.callback(V),V}toImage(I){return new Promise((L,U)=>{try{const V=I==null?void 0:I.callback;V&&delete I.callback,r.Util._urlToImage(this.toDataURL(I),function(X){L(X),V==null||V(X)})}catch(V){U(V)}})}toBlob(I){return new Promise((L,U)=>{try{const V=I==null?void 0:I.callback;V&&delete I.callback,this.toCanvas(I).toBlob(X=>{L(X),V==null||V(X)},I==null?void 0:I.mimeType,I==null?void 0:I.quality)}catch(V){U(V)}})}setSize(I){return this.width(I.width),this.height(I.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(I,L,U){var V=this.eventListeners[I],X,H,J;for(X=0;X<V.length;X++)if(H=V[X].name,J=V[X].handler,(H!=="konva"||L==="konva")&&(!L||H===L)&&(!U||U===J)){if(V.splice(X,1),V.length===0){delete this.eventListeners[I];break}X--}}_fireChangeEvent(I,L,U){this._fire(I+p,{oldVal:L,newVal:U})}addName(I){if(!this.hasName(I)){var L=this.name(),U=L?L+" "+I:I;this.name(U)}return this}hasName(I){if(!I)return!1;const L=this.name();if(!L)return!1;var U=(L||"").split(/\s/g);return U.indexOf(I)!==-1}removeName(I){var L=(this.name()||"").split(/\s/g),U=L.indexOf(I);return U!==-1&&(L.splice(U,1),this.name(L.join(" "))),this}setAttr(I,L){var U=this[S+r.Util._capitalize(I)];return r.Util._isFunction(U)?U.call(this,L):this._setAttr(I,L),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const I=this.getLayer()||this.getStage();I==null||I.batchDraw()}}_setAttr(I,L){var U=this.attrs[I];U===L&&!r.Util.isObject(L)||(L==null?delete this.attrs[I]:this.attrs[I]=L,this._shouldFireChangeEvents&&this._fireChangeEvent(I,U,L),this._requestDraw())}_setComponentAttr(I,L,U){var V;U!==void 0&&(V=this.attrs[I],V||(this.attrs[I]=this.getAttr(I)),this.attrs[I][L]=U,this._fireChangeEvent(I,V,U))}_fireAndBubble(I,L,U){L&&this.nodeType===O&&(L.target=this);var V=(I===x||I===w)&&(U&&(this===U||this.isAncestorOf&&this.isAncestorOf(U))||this.nodeType==="Stage"&&!U);if(!V){this._fire(I,L);var X=(I===x||I===w)&&U&&U.isAncestorOf&&U.isAncestorOf(this)&&!U.isAncestorOf(this.parent);(L&&!L.cancelBubble||!L)&&this.parent&&this.parent.isListening()&&!X&&(U&&U.parent?this._fireAndBubble.call(this.parent,I,L,U):this._fireAndBubble.call(this.parent,I,L))}}_getProtoListeners(I){var L,U,V;const X=(L=this._cache.get(l))!==null&&L!==void 0?L:{};let H=X==null?void 0:X[I];if(H===void 0){H=[];let J=Object.getPrototypeOf(this);for(;J;){const ee=(V=(U=J.eventListeners)===null||U===void 0?void 0:U[I])!==null&&V!==void 0?V:[];H.push(...ee),J=Object.getPrototypeOf(J)}X[I]=H,this._cache.set(l,X)}return H}_fire(I,L){L=L||{},L.currentTarget=this,L.type=I;const U=this._getProtoListeners(I);if(U)for(var V=0;V<U.length;V++)U[V].handler.call(this,L);const X=this.eventListeners[I];if(X)for(var V=0;V<X.length;V++)X[V].handler.call(this,L)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(I){var L=I?I.pointerId:void 0,U=this.getStage(),V=this.getAbsolutePosition();if(U){var X=U._getPointerById(L)||U._changedPointerPositions[0]||V;s.DD._dragElements.set(this._id,{node:this,startPointerPos:X,offset:{x:X.x-V.x,y:X.y-V.y},dragStatus:"ready",pointerId:L})}}startDrag(I,L=!0){s.DD._dragElements.has(this._id)||this._createDragElement(I);const U=s.DD._dragElements.get(this._id);U.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:I&&I.evt},L)}_setDragPosition(I,L){const U=this.getStage()._getPointerById(L.pointerId);if(U){var V={x:U.x-L.offset.x,y:U.y-L.offset.y},X=this.dragBoundFunc();if(X!==void 0){const H=X.call(this,V,I);H?V=H:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==V.x||this._lastPos.y!==V.y)&&(this.setAbsolutePosition(V),this._requestDraw()),this._lastPos=V}}stopDrag(I){const L=s.DD._dragElements.get(this._id);L&&(L.dragStatus="stopped"),s.DD._endDragBefore(I),s.DD._endDragAfter(I)}setDraggable(I){this._setAttr("draggable",I),this._dragChange()}isDragging(){const I=s.DD._dragElements.get(this._id);return I?I.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(I){var L=I.evt.button!==void 0,U=!L||i.Konva.dragButtons.indexOf(I.evt.button)>=0;if(U&&!this.isDragging()){var V=!1;s.DD._dragElements.forEach(X=>{this.isAncestorOf(X.node)&&(V=!0)}),V||this._createDragElement(I)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var I=this.getStage();if(!I)return;const L=s.DD._dragElements.get(this._id),U=L&&L.dragStatus==="dragging",V=L&&L.dragStatus==="ready";U?this.stopDrag():V&&s.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(I={x:0,y:0}){const L=this.getStage();if(!L)return!1;const U={x:-I.x,y:-I.y,width:L.width()+2*I.x,height:L.height()+2*I.y};return r.Util.haveIntersection(U,this.getClientRect())}static create(I,L){return r.Util._isString(I)&&(I=JSON.parse(I)),this._createNode(I,L)}static _createNode(I,L){var U=E.prototype.getClassName.call(I),V=I.children,X,H,J;L&&(I.attrs.container=L),i.Konva[U]||(r.Util.warn('Can not find a node with class name "'+U+'". Fallback to "Shape".'),U="Shape");const ee=i.Konva[U];if(X=new ee(I.attrs),V)for(H=V.length,J=0;J<H;J++)X.add(E._createNode(V[J]));return X}}Ev.Node=E,E.prototype.nodeType="Node",E.prototype._attrsAffectingSize=[],E.prototype.eventListeners={},E.prototype.on.call(E.prototype,k,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(A),this._clearSelfAndDescendantCache(h)}),E.prototype.on.call(E.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(N)}),E.prototype.on.call(E.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(y)}),E.prototype.on.call(E.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(a)});const D=e.Factory.addGetterSetter;return D(E,"zIndex"),D(E,"absolutePosition"),D(E,"position"),D(E,"x",0,(0,o.getNumberValidator)()),D(E,"y",0,(0,o.getNumberValidator)()),D(E,"globalCompositeOperation","source-over",(0,o.getStringValidator)()),D(E,"opacity",1,(0,o.getNumberValidator)()),D(E,"name","",(0,o.getStringValidator)()),D(E,"id","",(0,o.getStringValidator)()),D(E,"rotation",0,(0,o.getNumberValidator)()),e.Factory.addComponentsGetterSetter(E,"scale",["x","y"]),D(E,"scaleX",1,(0,o.getNumberValidator)()),D(E,"scaleY",1,(0,o.getNumberValidator)()),e.Factory.addComponentsGetterSetter(E,"skew",["x","y"]),D(E,"skewX",0,(0,o.getNumberValidator)()),D(E,"skewY",0,(0,o.getNumberValidator)()),e.Factory.addComponentsGetterSetter(E,"offset",["x","y"]),D(E,"offsetX",0,(0,o.getNumberValidator)()),D(E,"offsetY",0,(0,o.getNumberValidator)()),D(E,"dragDistance",null,(0,o.getNumberValidator)()),D(E,"width",0,(0,o.getNumberValidator)()),D(E,"height",0,(0,o.getNumberValidator)()),D(E,"listening",!0,(0,o.getBooleanValidator)()),D(E,"preventDefault",!0,(0,o.getBooleanValidator)()),D(E,"filters",null,function($){return this._filterUpToDate=!1,$}),D(E,"visible",!0,(0,o.getBooleanValidator)()),D(E,"transformsEnabled","all",(0,o.getStringValidator)()),D(E,"size"),D(E,"dragBoundFunc"),D(E,"draggable",!1,(0,o.getBooleanValidator)()),e.Factory.backCompat(E,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Ev}var Mv={},pV;function L2(){if(pV)return Mv;pV=1,Object.defineProperty(Mv,"__esModule",{value:!0}),Mv.Container=void 0;const r=Ui(),e=yr(),n=Hi();class i extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(o){if(!o)return this.children||[];const a=this.children||[];var l=[];return a.forEach(function(h){o(h)&&l.push(h)}),l}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(o=>{o.parent=null,o.index=0,o.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(o=>{o.parent=null,o.index=0,o.destroy()}),this.children=[],this._requestDraw(),this}add(...o){if(o.length===0)return this;if(o.length>1){for(var a=0;a<o.length;a++)this.add(o[a]);return this}const l=o[0];return l.getParent()?(l.moveTo(this),this):(this._validateAdd(l),l.index=this.getChildren().length,l.parent=this,l._clearCaches(),this.getChildren().push(l),this._fire("add",{child:l}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(o){return this._generalFind(o,!1)}findOne(o){var a=this._generalFind(o,!0);return a.length>0?a[0]:void 0}_generalFind(o,a){var l=[];return this._descendants(h=>{const u=h._isMatch(o);return u&&l.push(h),!!(u&&a)}),l}_descendants(o){let a=!1;const l=this.getChildren();for(const h of l){if(a=o(h),a)return!0;if(h.hasChildren()&&(a=h._descendants(o),a))return!0}return!1}toObject(){var o=e.Node.prototype.toObject.call(this);return o.children=[],this.getChildren().forEach(a=>{o.children.push(a.toObject())}),o}isAncestorOf(o){for(var a=o.getParent();a;){if(a._id===this._id)return!0;a=a.getParent()}return!1}clone(o){var a=e.Node.prototype.clone.call(this,o);return this.getChildren().forEach(function(l){a.add(l.clone())}),a}getAllIntersections(o){var a=[];return this.find("Shape").forEach(l=>{l.isVisible()&&l.intersects(o)&&a.push(l)}),a}_clearSelfAndDescendantCache(o){var a;super._clearSelfAndDescendantCache(o),!this.isCached()&&((a=this.children)===null||a===void 0||a.forEach(function(l){l._clearSelfAndDescendantCache(o)}))}_setChildrenIndices(){var o;(o=this.children)===null||o===void 0||o.forEach(function(a,l){a.index=l}),this._requestDraw()}drawScene(o,a,l){var h=this.getLayer(),u=o||h&&h.getCanvas(),f=u&&u.getContext(),p=this._getCanvasCache(),m=p&&p.scene,v=u&&u.isCache;if(!this.isVisible()&&!v)return this;if(m){f.save();var y=this.getAbsoluteTransform(a).getMatrix();f.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",u,a,l);return this}drawHit(o,a){if(!this.shouldDrawHit(a))return this;var l=this.getLayer(),h=o||l&&l.hitCanvas,u=h&&h.getContext(),f=this._getCanvasCache(),p=f&&f.hit;if(p){u.save();var m=this.getAbsoluteTransform(a).getMatrix();u.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(u),u.restore()}else this._drawChildren("drawHit",h,a);return this}_drawChildren(o,a,l,h){var u,f=a&&a.getContext(),p=this.clipWidth(),m=this.clipHeight(),v=this.clipFunc(),y=typeof p=="number"&&typeof m=="number"||v;const x=l===this;if(y){f.save();var w=this.getAbsoluteTransform(l),S=w.getMatrix();f.transform(S[0],S[1],S[2],S[3],S[4],S[5]),f.beginPath();let A;if(v)A=v.call(this,f,this);else{var O=this.clipX(),_=this.clipY();f.rect(O||0,_||0,p,m)}f.clip.apply(f,A),S=w.copy().invert().getMatrix(),f.transform(S[0],S[1],S[2],S[3],S[4],S[5])}var T=!x&&this.globalCompositeOperation()!=="source-over"&&o==="drawScene";T&&(f.save(),f._applyGlobalCompositeOperation(this)),(u=this.children)===null||u===void 0||u.forEach(function(A){A[o](a,l,h)}),T&&f.restore(),y&&f.restore()}getClientRect(o={}){var a,l=o.skipTransform,h=o.relativeTo,u,f,p,m,v={x:1/0,y:1/0,width:0,height:0},y=this;(a=this.children)===null||a===void 0||a.forEach(function(_){if(_.visible()){var T=_.getClientRect({relativeTo:y,skipShadow:o.skipShadow,skipStroke:o.skipStroke});T.width===0&&T.height===0||(u===void 0?(u=T.x,f=T.y,p=T.x+T.width,m=T.y+T.height):(u=Math.min(u,T.x),f=Math.min(f,T.y),p=Math.max(p,T.x+T.width),m=Math.max(m,T.y+T.height)))}});for(var x=this.find("Shape"),w=!1,S=0;S<x.length;S++){var O=x[S];if(O._isVisible(this)){w=!0;break}}return w&&u!==void 0?v={x:u,y:f,width:p-u,height:m-f}:v={x:0,y:0,width:0,height:0},l?v:this._transformedRect(v,h)}}return Mv.Container=i,r.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),r.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(i,"clipFunc"),Mv}var qM={},zo={},mV;function cj(){if(mV)return zo;mV=1,Object.defineProperty(zo,"__esModule",{value:!0}),zo.releaseCapture=zo.setPointerCapture=zo.hasPointerCapture=zo.createEvent=zo.getCapturedShape=void 0;const r=$i(),e=new Map,n=r.Konva._global.PointerEvent!==void 0;function i(h){return e.get(h)}zo.getCapturedShape=i;function s(h){return{evt:h,pointerId:h.pointerId}}zo.createEvent=s;function o(h,u){return e.get(h)===u}zo.hasPointerCapture=o;function a(h,u){l(h),u.getStage()&&(e.set(h,u),n&&u._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}zo.setPointerCapture=a;function l(h,u){const f=e.get(h);if(!f)return;const p=f.getStage();p&&p.content,e.delete(h),n&&f._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return zo.releaseCapture=l,zo}var gV;function lke(){return gV||(gV=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Stage=r.stages=void 0;const e=dr(),n=Ui(),i=L2(),s=$i(),o=D2(),a=t5(),l=$i(),h=cj();var u="Stage",f="string",p="px",m="mouseout",v="mouseleave",y="mouseover",x="mouseenter",w="mousemove",S="mousedown",O="mouseup",_="pointermove",T="pointerdown",A="pointerup",P="pointercancel",N="lostpointercapture",k="pointerout",R="pointerleave",E="pointerover",D="pointerenter",$="contextmenu",I="touchstart",L="touchend",U="touchmove",V="touchcancel",X="wheel",H=5,J=[[x,"_pointerenter"],[S,"_pointerdown"],[w,"_pointermove"],[O,"_pointerup"],[v,"_pointerleave"],[I,"_pointerdown"],[U,"_pointermove"],[L,"_pointerup"],[V,"_pointercancel"],[y,"_pointerover"],[X,"_wheel"],[$,"_contextmenu"],[T,"_pointerdown"],[_,"_pointermove"],[A,"_pointerup"],[P,"_pointercancel"],[N,"_lostpointercapture"]];const ee={mouse:{[k]:m,[R]:v,[E]:y,[D]:x,[_]:w,[T]:S,[A]:O,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[k]:"touchout",[R]:"touchleave",[E]:"touchover",[D]:"touchenter",[_]:U,[T]:I,[A]:L,[P]:V,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[k]:k,[R]:R,[E]:E,[D]:D,[_]:_,[T]:T,[A]:A,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ne=be=>be.indexOf("pointer")>=0?"pointer":be.indexOf("touch")>=0?"touch":"mouse",ge=be=>{const se=ne(be);if(se==="pointer")return s.Konva.pointerEventsEnabled&&ee.pointer;if(se==="touch")return ee.touch;if(se==="mouse")return ee.mouse};function ye(be={}){return(be.clipFunc||be.clipWidth||be.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),be}const ce="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";r.stages=[];class we extends i.Container{constructor(se){super(ye(se)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),r.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ye(this.attrs)}),this._checkVisibility()}_validateAdd(se){const ae=se.getType()==="Layer",Q=se.getType()==="FastLayer";ae||Q||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const se=this.visible()?"":"none";this.content.style.display=se}setContainer(se){if(typeof se===f){if(se.charAt(0)==="."){var ae=se.slice(1);se=document.getElementsByClassName(ae)[0]}else{var Q;se.charAt(0)!=="#"?Q=se:Q=se.slice(1),se=document.getElementById(Q)}if(!se)throw"Can not find container in document with id "+Q}return this._setAttr("container",se),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),se.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var se=this.children,ae=se.length,Q;for(Q=0;Q<ae;Q++)se[Q].clear();return this}clone(se){return se||(se={}),se.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,se)}destroy(){super.destroy();var se=this.content;se&&e.Util._isInDocument(se)&&this.container().removeChild(se);var ae=r.stages.indexOf(this);return ae>-1&&r.stages.splice(ae,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const se=this._pointerPositions[0]||this._changedPointerPositions[0];return se?{x:se.x,y:se.y}:(e.Util.warn(ce),null)}_getPointerById(se){return this._pointerPositions.find(ae=>ae.id===se)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(se){se=se||{},se.x=se.x||0,se.y=se.y||0,se.width=se.width||this.width(),se.height=se.height||this.height();var ae=new o.SceneCanvas({width:se.width,height:se.height,pixelRatio:se.pixelRatio||1}),Q=ae.getContext()._context,z=this.children;return(se.x||se.y)&&Q.translate(-1*se.x,-1*se.y),z.forEach(function(j){if(j.isVisible()){var te=j._toKonvaCanvas(se);Q.drawImage(te._canvas,se.x,se.y,te.getWidth()/te.getPixelRatio(),te.getHeight()/te.getPixelRatio())}}),ae}getIntersection(se){if(!se)return null;var ae=this.children,Q=ae.length,z=Q-1,j;for(j=z;j>=0;j--){const te=ae[j].getIntersection(se);if(te)return te}return null}_resizeDOM(){var se=this.width(),ae=this.height();this.content&&(this.content.style.width=se+p,this.content.style.height=ae+p),this.bufferCanvas.setSize(se,ae),this.bufferHitCanvas.setSize(se,ae),this.children.forEach(Q=>{Q.setSize({width:se,height:ae}),Q.draw()})}add(se,...ae){if(arguments.length>1){for(var Q=0;Q<arguments.length;Q++)this.add(arguments[Q]);return this}super.add(se);var z=this.children.length;return z>H&&e.Util.warn("The stage has "+z+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),se.setSize({width:this.width(),height:this.height()}),se.draw(),s.Konva.isBrowser&&this.content.appendChild(se.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(se){return h.hasPointerCapture(se,this)}setPointerCapture(se){h.setPointerCapture(se,this)}releaseCapture(se){h.releaseCapture(se,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&J.forEach(([se,ae])=>{this.content.addEventListener(se,Q=>{this[ae](Q)},{passive:!1})})}_pointerenter(se){this.setPointersPositions(se);const ae=ge(se.type);ae&&this._fire(ae.pointerenter,{evt:se,target:this,currentTarget:this})}_pointerover(se){this.setPointersPositions(se);const ae=ge(se.type);ae&&this._fire(ae.pointerover,{evt:se,target:this,currentTarget:this})}_getTargetShape(se){let ae=this[se+"targetShape"];return ae&&!ae.getStage()&&(ae=null),ae}_pointerleave(se){const ae=ge(se.type),Q=ne(se.type);if(ae){this.setPointersPositions(se);var z=this._getTargetShape(Q),j=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;z&&j?(z._fireAndBubble(ae.pointerout,{evt:se}),z._fireAndBubble(ae.pointerleave,{evt:se}),this._fire(ae.pointerleave,{evt:se,target:this,currentTarget:this}),this[Q+"targetShape"]=null):j&&(this._fire(ae.pointerleave,{evt:se,target:this,currentTarget:this}),this._fire(ae.pointerout,{evt:se,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(se){const ae=ge(se.type),Q=ne(se.type);if(ae){this.setPointersPositions(se);var z=!1;this._changedPointerPositions.forEach(j=>{var te=this.getIntersection(j);if(a.DD.justDragged=!1,s.Konva["_"+Q+"ListenClick"]=!0,!te||!te.isListening()){this[Q+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&te.setPointerCapture(j.id),this[Q+"ClickStartShape"]=te,te._fireAndBubble(ae.pointerdown,{evt:se,pointerId:j.id}),z=!0;const W=se.type.indexOf("touch")>=0;te.preventDefault()&&se.cancelable&&W&&se.preventDefault()}),z||this._fire(ae.pointerdown,{evt:se,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(se){const ae=ge(se.type),Q=ne(se.type);if(!ae)return;s.Konva.isDragging()&&a.DD.node.preventDefault()&&se.cancelable&&se.preventDefault(),this.setPointersPositions(se);var z=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;if(!z)return;var j={};let te=!1;var W=this._getTargetShape(Q);this._changedPointerPositions.forEach(Z=>{const he=h.getCapturedShape(Z.id)||this.getIntersection(Z),pe=Z.id,_e={evt:se,pointerId:pe};var Re=W!==he;if(Re&&W&&(W._fireAndBubble(ae.pointerout,{..._e},he),W._fireAndBubble(ae.pointerleave,{..._e},he)),he){if(j[he._id])return;j[he._id]=!0}he&&he.isListening()?(te=!0,Re&&(he._fireAndBubble(ae.pointerover,{..._e},W),he._fireAndBubble(ae.pointerenter,{..._e},W),this[Q+"targetShape"]=he),he._fireAndBubble(ae.pointermove,{..._e})):W&&(this._fire(ae.pointerover,{evt:se,target:this,currentTarget:this,pointerId:pe}),this[Q+"targetShape"]=null)}),te||this._fire(ae.pointermove,{evt:se,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(se){const ae=ge(se.type),Q=ne(se.type);if(!ae)return;this.setPointersPositions(se);const z=this[Q+"ClickStartShape"],j=this[Q+"ClickEndShape"];var te={};let W=!1;this._changedPointerPositions.forEach(Z=>{const he=h.getCapturedShape(Z.id)||this.getIntersection(Z);if(he){if(he.releaseCapture(Z.id),te[he._id])return;te[he._id]=!0}const pe=Z.id,_e={evt:se,pointerId:pe};let Re=!1;s.Konva["_"+Q+"InDblClickWindow"]?(Re=!0,clearTimeout(this[Q+"DblTimeout"])):a.DD.justDragged||(s.Konva["_"+Q+"InDblClickWindow"]=!0,clearTimeout(this[Q+"DblTimeout"])),this[Q+"DblTimeout"]=setTimeout(function(){s.Konva["_"+Q+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),he&&he.isListening()?(W=!0,this[Q+"ClickEndShape"]=he,he._fireAndBubble(ae.pointerup,{..._e}),s.Konva["_"+Q+"ListenClick"]&&z&&z===he&&(he._fireAndBubble(ae.pointerclick,{..._e}),Re&&j&&j===he&&he._fireAndBubble(ae.pointerdblclick,{..._e}))):(this[Q+"ClickEndShape"]=null,s.Konva["_"+Q+"ListenClick"]&&this._fire(ae.pointerclick,{evt:se,target:this,currentTarget:this,pointerId:pe}),Re&&this._fire(ae.pointerdblclick,{evt:se,target:this,currentTarget:this,pointerId:pe}))}),W||this._fire(ae.pointerup,{evt:se,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+Q+"ListenClick"]=!1,se.cancelable&&Q!=="touch"&&se.preventDefault()}_contextmenu(se){this.setPointersPositions(se);var ae=this.getIntersection(this.getPointerPosition());ae&&ae.isListening()?ae._fireAndBubble($,{evt:se}):this._fire($,{evt:se,target:this,currentTarget:this})}_wheel(se){this.setPointersPositions(se);var ae=this.getIntersection(this.getPointerPosition());ae&&ae.isListening()?ae._fireAndBubble(X,{evt:se}):this._fire(X,{evt:se,target:this,currentTarget:this})}_pointercancel(se){this.setPointersPositions(se);const ae=h.getCapturedShape(se.pointerId)||this.getIntersection(this.getPointerPosition());ae&&ae._fireAndBubble(A,h.createEvent(se)),h.releaseCapture(se.pointerId)}_lostpointercapture(se){h.releaseCapture(se.pointerId)}setPointersPositions(se){var ae=this._getContentPosition(),Q=null,z=null;se=se||window.event,se.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(se.touches,j=>{this._pointerPositions.push({id:j.identifier,x:(j.clientX-ae.left)/ae.scaleX,y:(j.clientY-ae.top)/ae.scaleY})}),Array.prototype.forEach.call(se.changedTouches||se.touches,j=>{this._changedPointerPositions.push({id:j.identifier,x:(j.clientX-ae.left)/ae.scaleX,y:(j.clientY-ae.top)/ae.scaleY})})):(Q=(se.clientX-ae.left)/ae.scaleX,z=(se.clientY-ae.top)/ae.scaleY,this.pointerPos={x:Q,y:z},this._pointerPositions=[{x:Q,y:z,id:e.Util._getFirstPointerId(se)}],this._changedPointerPositions=[{x:Q,y:z,id:e.Util._getFirstPointerId(se)}])}_setPointerPosition(se){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(se)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var se=this.content.getBoundingClientRect();return{top:se.top,left:se.left,scaleX:se.width/this.content.clientWidth||1,scaleY:se.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new o.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new o.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!s.Konva.isBrowser){var se=this.container();if(!se)throw"Stage has no container. A container is required.";se.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),se.appendChild(this.content),this._resizeDOM()}}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(se){se.batchDraw()}),this}}r.Stage=we,we.prototype.nodeType=u,(0,l._registerNode)(we),n.Factory.addGetterSetter(we,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{r.stages.forEach(be=>{be.batchDraw()})})}(qM)),qM}var Av={},ZM={},vV;function os(){return vV||(vV=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Shape=r.shapes=void 0;const e=$i(),n=dr(),i=Ui(),s=yr(),o=Hi(),a=$i(),l=cj();var h="hasShadow",u="shadowRGBA",f="patternImage",p="linearGradient",m="radialGradient";let v;function y(){return v||(v=n.Util.createCanvasElement().getContext("2d"),v)}r.shapes={};function x(R){const E=this.attrs.fillRule;E?R.fill(E):R.fill()}function w(R){R.stroke()}function S(R){R.fill()}function O(R){R.stroke()}function _(){this._clearCache(h)}function T(){this._clearCache(u)}function A(){this._clearCache(f)}function P(){this._clearCache(p)}function N(){this._clearCache(m)}class k extends s.Node{constructor(E){super(E);let D;for(;D=n.Util.getRandomColor(),!(D&&!(D in r.shapes)););this.colorKey=D,r.shapes[D]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(h,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(f,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var E=y();const D=E.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(D&&D.setTransform){const $=new n.Transform;$.translate(this.fillPatternX(),this.fillPatternY()),$.rotate(e.Konva.getAngle(this.fillPatternRotation())),$.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),$.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const I=$.getMatrix(),L=typeof DOMMatrix>"u"?{a:I[0],b:I[1],c:I[2],d:I[3],e:I[4],f:I[5]}:new DOMMatrix(I);D.setTransform(L)}return D}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){var E=this.fillLinearGradientColorStops();if(E){for(var D=y(),$=this.fillLinearGradientStartPoint(),I=this.fillLinearGradientEndPoint(),L=D.createLinearGradient($.x,$.y,I.x,I.y),U=0;U<E.length;U+=2)L.addColorStop(E[U],E[U+1]);return L}}_getRadialGradient(){return this._getCache(m,this.__getRadialGradient)}__getRadialGradient(){var E=this.fillRadialGradientColorStops();if(E){for(var D=y(),$=this.fillRadialGradientStartPoint(),I=this.fillRadialGradientEndPoint(),L=D.createRadialGradient($.x,$.y,this.fillRadialGradientStartRadius(),I.x,I.y,this.fillRadialGradientEndRadius()),U=0;U<E.length;U+=2)L.addColorStop(E[U],E[U+1]);return L}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var E=n.Util.colorToRGBA(this.shadowColor());if(E)return"rgba("+E.r+","+E.g+","+E.b+","+E.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const E=this.hitStrokeWidth();return E==="auto"?this.hasStroke():this.strokeEnabled()&&!!E}intersects(E){var D=this.getStage();if(!D)return!1;const $=D.bufferHitCanvas;return $.getContext().clear(),this.drawHit($,void 0,!0),$.context.getImageData(Math.round(E.x),Math.round(E.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete r.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(E){var D;if(!((D=this.attrs.perfectDrawEnabled)!==null&&D!==void 0?D:!0))return!1;const I=E||this.hasFill(),L=this.hasStroke(),U=this.getAbsoluteOpacity()!==1;if(I&&L&&U)return!0;const V=this.hasShadow(),X=this.shadowForStrokeEnabled();return!!(I&&L&&V&&X)}setStrokeHitEnabled(E){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),E?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var E=this.size();return{x:this._centroid?-E.width/2:0,y:this._centroid?-E.height/2:0,width:E.width,height:E.height}}getClientRect(E={}){let D=!1,$=this.getParent();for(;$;){if($.isCached()){D=!0;break}$=$.getParent()}const I=E.skipTransform,L=E.relativeTo||D&&this.getStage()||void 0,U=this.getSelfRect(),X=!E.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,H=U.width+X,J=U.height+X,ee=!E.skipShadow&&this.hasShadow(),ne=ee?this.shadowOffsetX():0,ge=ee?this.shadowOffsetY():0,ye=H+Math.abs(ne),ce=J+Math.abs(ge),we=ee&&this.shadowBlur()||0,be=ye+we*2,se=ce+we*2,ae={width:be,height:se,x:-(X/2+we)+Math.min(ne,0)+U.x,y:-(X/2+we)+Math.min(ge,0)+U.y};return I?ae:this._transformedRect(ae,L)}drawScene(E,D,$){var I=this.getLayer(),L=E||I.getCanvas(),U=L.getContext(),V=this._getCanvasCache(),X=this.getSceneFunc(),H=this.hasShadow(),J,ee,ne=L.isCache,ge=D===this;if(!this.isVisible()&&!ge)return this;if(V){U.save();var ye=this.getAbsoluteTransform(D).getMatrix();return U.transform(ye[0],ye[1],ye[2],ye[3],ye[4],ye[5]),this._drawCachedSceneCanvas(U),U.restore(),this}if(!X)return this;if(U.save(),this._useBufferCanvas()&&!ne){J=this.getStage();const be=$||J.bufferCanvas;ee=be.getContext(),ee.clear(),ee.save(),ee._applyLineJoin(this);var ce=this.getAbsoluteTransform(D).getMatrix();ee.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5]),X.call(this,ee,this),ee.restore();var we=be.pixelRatio;H&&U._applyShadow(this),U._applyOpacity(this),U._applyGlobalCompositeOperation(this),U.drawImage(be._canvas,0,0,be.width/we,be.height/we)}else{if(U._applyLineJoin(this),!ge){var ce=this.getAbsoluteTransform(D).getMatrix();U.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5]),U._applyOpacity(this),U._applyGlobalCompositeOperation(this)}H&&U._applyShadow(this),X.call(this,U,this)}return U.restore(),this}drawHit(E,D,$=!1){if(!this.shouldDrawHit(D,$))return this;var I=this.getLayer(),L=E||I.hitCanvas,U=L&&L.getContext(),V=this.hitFunc()||this.sceneFunc(),X=this._getCanvasCache(),H=X&&X.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),H){U.save();var J=this.getAbsoluteTransform(D).getMatrix();return U.transform(J[0],J[1],J[2],J[3],J[4],J[5]),this._drawCachedHitCanvas(U),U.restore(),this}if(!V)return this;if(U.save(),U._applyLineJoin(this),!(this===D)){var ne=this.getAbsoluteTransform(D).getMatrix();U.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5])}return V.call(this,U,this),U.restore(),this}drawHitFromCache(E=0){var D=this._getCanvasCache(),$=this._getCachedSceneCanvas(),I=D.hit,L=I.getContext(),U=I.getWidth(),V=I.getHeight(),X,H,J,ee,ne,ge;L.clear(),L.drawImage($._canvas,0,0,U,V);try{for(X=L.getImageData(0,0,U,V),H=X.data,J=H.length,ee=n.Util._hexToRgb(this.colorKey),ne=0;ne<J;ne+=4)ge=H[ne+3],ge>E?(H[ne]=ee.r,H[ne+1]=ee.g,H[ne+2]=ee.b,H[ne+3]=255):H[ne+3]=0;L.putImageData(X,0,0)}catch(ye){n.Util.error("Unable to draw hit graph from cached scene canvas. "+ye.message)}return this}hasPointerCapture(E){return l.hasPointerCapture(E,this)}setPointerCapture(E){l.setPointerCapture(E,this)}releaseCapture(E){l.releaseCapture(E,this)}}r.Shape=k,k.prototype._fillFunc=x,k.prototype._strokeFunc=w,k.prototype._fillFuncHit=S,k.prototype._strokeFuncHit=O,k.prototype._centroid=!1,k.prototype.nodeType="Shape",(0,a._registerNode)(k),k.prototype.eventListeners={},k.prototype.on.call(k.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),k.prototype.on.call(k.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",T),k.prototype.on.call(k.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",A),k.prototype.on.call(k.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),k.prototype.on.call(k.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",N),i.Factory.addGetterSetter(k,"stroke",void 0,(0,o.getStringOrGradientValidator)()),i.Factory.addGetterSetter(k,"strokeWidth",2,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(k,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(k,"hitStrokeWidth","auto",(0,o.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(k,"strokeHitEnabled",!0,(0,o.getBooleanValidator)()),i.Factory.addGetterSetter(k,"perfectDrawEnabled",!0,(0,o.getBooleanValidator)()),i.Factory.addGetterSetter(k,"shadowForStrokeEnabled",!0,(0,o.getBooleanValidator)()),i.Factory.addGetterSetter(k,"lineJoin"),i.Factory.addGetterSetter(k,"lineCap"),i.Factory.addGetterSetter(k,"sceneFunc"),i.Factory.addGetterSetter(k,"hitFunc"),i.Factory.addGetterSetter(k,"dash"),i.Factory.addGetterSetter(k,"dashOffset",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(k,"shadowColor",void 0,(0,o.getStringValidator)()),i.Factory.addGetterSetter(k,"shadowBlur",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(k,"shadowOpacity",1,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(k,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(k,"shadowOffsetX",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(k,"shadowOffsetY",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(k,"fillPatternImage"),i.Factory.addGetterSetter(k,"fill",void 0,(0,o.getStringOrGradientValidator)()),i.Factory.addGetterSetter(k,"fillPatternX",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(k,"fillPatternY",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(k,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(k,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(k,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(k,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(k,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(k,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(k,"fillEnabled",!0),i.Factory.addGetterSetter(k,"strokeEnabled",!0),i.Factory.addGetterSetter(k,"shadowEnabled",!0),i.Factory.addGetterSetter(k,"dashEnabled",!0),i.Factory.addGetterSetter(k,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(k,"fillPriority","color"),i.Factory.addComponentsGetterSetter(k,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(k,"fillPatternOffsetX",0,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(k,"fillPatternOffsetY",0,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(k,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(k,"fillPatternScaleX",1,(0,o.getNumberValidator)()),i.Factory.addGetterSetter(k,"fillPatternScaleY",1,(0,o.getNumberValidator)()),i.Factory.addComponentsGetterSetter(k,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(k,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(k,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(k,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(k,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(k,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(k,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(k,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(k,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(k,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(k,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(k,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(k,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(k,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(k,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(k,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(k,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(k,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(k,"fillPatternRotation",0),i.Factory.addGetterSetter(k,"fillRule",void 0,(0,o.getStringValidator)()),i.Factory.backCompat(k,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})}(ZM)),ZM}var yV;function hj(){if(yV)return Av;yV=1,Object.defineProperty(Av,"__esModule",{value:!0}),Av.Layer=void 0;const r=dr(),e=L2(),n=yr(),i=Ui(),s=D2(),o=Hi(),a=os(),l=$i();var h="#",u="beforeDraw",f="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],m=p.length;let v=class extends e.Container{constructor(x){super(x),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(x){return this.getContext().clear(x),this.getHitCanvas().getContext().clear(x),this}setZIndex(x){super.setZIndex(x);var w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),x<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[x+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);var x=this.getStage();return x&&x.content&&(x.content.removeChild(this.getNativeCanvasElement()),x.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var x=n.Node.prototype.moveUp.call(this);if(!x)return!1;var w=this.getStage();return!w||!w.content?!1:(w.content.removeChild(this.getNativeCanvasElement()),this.index<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[this.index+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){var x=this.getStage();if(x){var w=x.children;x.content&&(x.content.removeChild(this.getNativeCanvasElement()),x.content.insertBefore(this.getNativeCanvasElement(),w[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){var x=this.getStage();if(x){var w=x.children;x.content&&(x.content.removeChild(this.getNativeCanvasElement()),x.content.insertBefore(this.getNativeCanvasElement(),w[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var x=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),x&&x.parentNode&&r.Util._isInDocument(x)&&x.parentNode.removeChild(x),this}getStage(){return this.parent}setSize({width:x,height:w}){return this.canvas.setSize(x,w),this.hitCanvas.setSize(x,w),this._setSmoothEnabled(),this}_validateAdd(x){var w=x.getType();w!=="Group"&&w!=="Shape"&&r.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(x){return x=x||{},x.width=x.width||this.getWidth(),x.height=x.height||this.getHeight(),x.x=x.x!==void 0?x.x:this.x(),x.y=x.y!==void 0?x.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,x)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){r.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){r.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,r.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(x){if(!this.isListening()||!this.isVisible())return null;for(var w=1,S=!1;;){for(let O=0;O<m;O++){const _=p[O],T=this._getIntersection({x:x.x+_.x*w,y:x.y+_.y*w}),A=T.shape;if(A)return A;if(S=!!T.antialiased,!T.antialiased)break}if(S)w+=1;else return null}}_getIntersection(x){const w=this.hitCanvas.pixelRatio,S=this.hitCanvas.context.getImageData(Math.round(x.x*w),Math.round(x.y*w),1,1).data,O=S[3];if(O===255){const _=r.Util._rgbToHex(S[0],S[1],S[2]),T=a.shapes[h+_];return T?{shape:T}:{antialiased:!0}}else if(O>0)return{antialiased:!0};return{}}drawScene(x,w){var S=this.getLayer(),O=x||S&&S.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&O.getContext().clear(),e.Container.prototype.drawScene.call(this,O,w),this._fire(f,{node:this}),this}drawHit(x,w){var S=this.getLayer(),O=x||S&&S.hitCanvas;return S&&S.clearBeforeDraw()&&S.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,O,w),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(x){r.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(x)}getHitGraphEnabled(x){return r.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var x=this.parent,w=!!this.hitCanvas._canvas.parentNode;w?x.content.removeChild(this.hitCanvas._canvas):x.content.appendChild(this.hitCanvas._canvas)}}destroy(){return r.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};return Av.Layer=v,v.prototype.nodeType="Layer",(0,l._registerNode)(v),i.Factory.addGetterSetter(v,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(v,"clearBeforeDraw",!0),i.Factory.addGetterSetter(v,"hitGraphEnabled",!0,(0,o.getBooleanValidator)()),Av}var kv={},bV;function cke(){if(bV)return kv;bV=1,Object.defineProperty(kv,"__esModule",{value:!0}),kv.FastLayer=void 0;const r=dr(),e=hj(),n=$i();let i=class extends e.Layer{constructor(o){super(o),this.listening(!1),r.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return kv.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),kv}var Pv={},xV;function i5(){if(xV)return Pv;xV=1,Object.defineProperty(Pv,"__esModule",{value:!0}),Pv.Group=void 0;const r=dr(),e=L2(),n=$i();let i=class extends e.Container{_validateAdd(o){var a=o.getType();a!=="Group"&&a!=="Shape"&&r.Util.throw("You may only add groups and shapes to groups.")}};return Pv.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),Pv}var Rv={},wV;function n5(){if(wV)return Rv;wV=1,Object.defineProperty(Rv,"__esModule",{value:!0}),Rv.Animation=void 0;const r=$i(),e=dr(),n=function(){return r.glob.performance&&r.glob.performance.now?function(){return r.glob.performance.now()}:function(){return new Date().getTime()}}();let i=class Lm{constructor(o,a){this.id=Lm.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=o,this.setLayers(a)}setLayers(o){let a=[];return o&&(a=Array.isArray(o)?o:[o]),this.layers=a,this}getLayers(){return this.layers}addLayer(o){const a=this.layers,l=a.length;for(let h=0;h<l;h++)if(a[h]._id===o._id)return!1;return this.layers.push(o),!0}isRunning(){const a=Lm.animations,l=a.length;for(let h=0;h<l;h++)if(a[h].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),Lm._addAnimation(this),this}stop(){return Lm._removeAnimation(this),this}_updateFrameObject(o){this.frame.timeDiff=o-this.frame.lastTime,this.frame.lastTime=o,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(o){this.animations.push(o),this._handleAnimation()}static _removeAnimation(o){const a=o.id,l=this.animations,h=l.length;for(let u=0;u<h;u++)if(l[u].id===a){this.animations.splice(u,1);break}}static _runFrames(){const o={},a=this.animations;for(let l=0;l<a.length;l++){const h=a[l],u=h.layers,f=h.func;h._updateFrameObject(n());const p=u.length;let m;if(f?m=f.call(h,h.frame)!==!1:m=!0,!!m)for(let v=0;v<p;v++){const y=u[v];y._id!==void 0&&(o[y._id]=y)}}for(let l in o)o.hasOwnProperty(l)&&o[l].batchDraw()}static _animationLoop(){const o=Lm;o.animations.length?(o._runFrames(),e.Util.requestAnimFrame(o._animationLoop)):o.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return Rv.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,Rv}var KM={},_V;function hke(){return _V||(_V=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Easings=r.Tween=void 0;const e=dr(),n=n5(),i=yr(),s=$i();var o={node:1,duration:1,easing:1,onFinish:1,yoyo:1},a=1,l=2,h=3,u=0,f=["fill","stroke","shadowColor"];class p{constructor(y,x,w,S,O,_,T){this.prop=y,this.propFunc=x,this.begin=S,this._pos=S,this.duration=_,this._change=0,this.prevPos=0,this.yoyo=T,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=O-this.begin,this.pause()}fire(y){var x=this[y];x&&x()}setTime(y){y>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():y<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=y,this.update())}getTime(){return this._time}setPosition(y){this.prevPos=this._pos,this.propFunc(y),this._pos=y}getPosition(y){return y===void 0&&(y=this._time),this.func(y,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=h,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(y){this.pause(),this._time=y,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var y=this.getTimer()-this._startTime;this.state===l?this.setTime(y):this.state===h&&this.setTime(this.duration-y)}pause(){this.state=a,this.fire("onPause")}getTimer(){return new Date().getTime()}}class m{constructor(y){var x=this,w=y.node,S=w._id,O,_=y.easing||r.Easings.Linear,T=!!y.yoyo,A;typeof y.duration>"u"?O=.3:y.duration===0?O=.001:O=y.duration,this.node=w,this._id=u++;var P=w.getLayer()||(w instanceof s.Konva.Stage?w.getLayers():null);P||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){x.tween.onEnterFrame()},P),this.tween=new p(A,function(N){x._tweenFunc(N)},_,0,1,O*1e3,T),this._addListeners(),m.attrs[S]||(m.attrs[S]={}),m.attrs[S][this._id]||(m.attrs[S][this._id]={}),m.tweens[S]||(m.tweens[S]={});for(A in y)o[A]===void 0&&this._addAttr(A,y[A]);this.reset(),this.onFinish=y.onFinish,this.onReset=y.onReset,this.onUpdate=y.onUpdate}_addAttr(y,x){var w=this.node,S=w._id,O,_,T,A,P,N,k,R;if(T=m.tweens[S][y],T&&delete m.attrs[S][T][y],O=w.getAttr(y),e.Util._isArray(x))if(_=[],P=Math.max(x.length,O.length),y==="points"&&x.length!==O.length&&(x.length>O.length?(k=O,O=e.Util._prepareArrayForTween(O,x,w.closed())):(N=x,x=e.Util._prepareArrayForTween(x,O,w.closed()))),y.indexOf("fill")===0)for(A=0;A<P;A++)if(A%2===0)_.push(x[A]-O[A]);else{var E=e.Util.colorToRGBA(O[A]);R=e.Util.colorToRGBA(x[A]),O[A]=E,_.push({r:R.r-E.r,g:R.g-E.g,b:R.b-E.b,a:R.a-E.a})}else for(A=0;A<P;A++)_.push(x[A]-O[A]);else f.indexOf(y)!==-1?(O=e.Util.colorToRGBA(O),R=e.Util.colorToRGBA(x),_={r:R.r-O.r,g:R.g-O.g,b:R.b-O.b,a:R.a-O.a}):_=x-O;m.attrs[S][this._id][y]={start:O,diff:_,end:x,trueEnd:N,trueStart:k},m.tweens[S][y]=this._id}_tweenFunc(y){var x=this.node,w=m.attrs[x._id][this._id],S,O,_,T,A,P,N,k;for(S in w){if(O=w[S],_=O.start,T=O.diff,k=O.end,e.Util._isArray(_))if(A=[],N=Math.max(_.length,k.length),S.indexOf("fill")===0)for(P=0;P<N;P++)P%2===0?A.push((_[P]||0)+T[P]*y):A.push("rgba("+Math.round(_[P].r+T[P].r*y)+","+Math.round(_[P].g+T[P].g*y)+","+Math.round(_[P].b+T[P].b*y)+","+(_[P].a+T[P].a*y)+")");else for(P=0;P<N;P++)A.push((_[P]||0)+T[P]*y);else f.indexOf(S)!==-1?A="rgba("+Math.round(_.r+T.r*y)+","+Math.round(_.g+T.g*y)+","+Math.round(_.b+T.b*y)+","+(_.a+T.a*y)+")":A=_+T*y;x.setAttr(S,A)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var y=this.node,x=m.attrs[y._id][this._id];x.points&&x.points.trueEnd&&y.setAttr("points",x.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var y=this.node,x=m.attrs[y._id][this._id];x.points&&x.points.trueStart&&y.points(x.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(y){return this.tween.seek(y*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var y=this.node._id,x=this._id,w=m.tweens[y],S;this.pause();for(S in w)delete m.tweens[y][S];delete m.attrs[y][x]}}r.Tween=m,m.attrs={},m.tweens={},i.Node.prototype.to=function(v){var y=v.onFinish;v.node=this,v.onFinish=function(){this.destroy(),y&&y()};var x=new m(v);x.play()},r.Easings={BackEaseIn(v,y,x,w){var S=1.70158;return x*(v/=w)*v*((S+1)*v-S)+y},BackEaseOut(v,y,x,w){var S=1.70158;return x*((v=v/w-1)*v*((S+1)*v+S)+1)+y},BackEaseInOut(v,y,x,w){var S=1.70158;return(v/=w/2)<1?x/2*(v*v*(((S*=1.525)+1)*v-S))+y:x/2*((v-=2)*v*(((S*=1.525)+1)*v+S)+2)+y},ElasticEaseIn(v,y,x,w,S,O){var _=0;return v===0?y:(v/=w)===1?y+x:(O||(O=w*.3),!S||S<Math.abs(x)?(S=x,_=O/4):_=O/(2*Math.PI)*Math.asin(x/S),-(S*Math.pow(2,10*(v-=1))*Math.sin((v*w-_)*(2*Math.PI)/O))+y)},ElasticEaseOut(v,y,x,w,S,O){var _=0;return v===0?y:(v/=w)===1?y+x:(O||(O=w*.3),!S||S<Math.abs(x)?(S=x,_=O/4):_=O/(2*Math.PI)*Math.asin(x/S),S*Math.pow(2,-10*v)*Math.sin((v*w-_)*(2*Math.PI)/O)+x+y)},ElasticEaseInOut(v,y,x,w,S,O){var _=0;return v===0?y:(v/=w/2)===2?y+x:(O||(O=w*(.3*1.5)),!S||S<Math.abs(x)?(S=x,_=O/4):_=O/(2*Math.PI)*Math.asin(x/S),v<1?-.5*(S*Math.pow(2,10*(v-=1))*Math.sin((v*w-_)*(2*Math.PI)/O))+y:S*Math.pow(2,-10*(v-=1))*Math.sin((v*w-_)*(2*Math.PI)/O)*.5+x+y)},BounceEaseOut(v,y,x,w){return(v/=w)<1/2.75?x*(7.5625*v*v)+y:v<2/2.75?x*(7.5625*(v-=1.5/2.75)*v+.75)+y:v<2.5/2.75?x*(7.5625*(v-=2.25/2.75)*v+.9375)+y:x*(7.5625*(v-=2.625/2.75)*v+.984375)+y},BounceEaseIn(v,y,x,w){return x-r.Easings.BounceEaseOut(w-v,0,x,w)+y},BounceEaseInOut(v,y,x,w){return v<w/2?r.Easings.BounceEaseIn(v*2,0,x,w)*.5+y:r.Easings.BounceEaseOut(v*2-w,0,x,w)*.5+x*.5+y},EaseIn(v,y,x,w){return x*(v/=w)*v+y},EaseOut(v,y,x,w){return-x*(v/=w)*(v-2)+y},EaseInOut(v,y,x,w){return(v/=w/2)<1?x/2*v*v+y:-x/2*(--v*(v-2)-1)+y},StrongEaseIn(v,y,x,w){return x*(v/=w)*v*v*v*v+y},StrongEaseOut(v,y,x,w){return x*((v=v/w-1)*v*v*v*v+1)+y},StrongEaseInOut(v,y,x,w){return(v/=w/2)<1?x/2*v*v*v*v*v+y:x/2*((v-=2)*v*v*v*v+2)+y},Linear(v,y,x,w){return x*v/w+y}}}(KM)),KM}var OV;function uke(){return OV||(OV=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Konva=void 0;const e=$i(),n=dr(),i=yr(),s=L2(),o=lke(),a=hj(),l=cke(),h=i5(),u=t5(),f=os(),p=n5(),m=hke(),v=lj(),y=D2();r.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:s.Container,Stage:o.Stage,stages:o.stages,Layer:a.Layer,FastLayer:l.FastLayer,Group:h.Group,DD:u.DD,Shape:f.Shape,shapes:f.shapes,Animation:p.Animation,Tween:m.Tween,Easings:m.Easings,Context:v.Context,Canvas:y.Canvas}),r.default=r.Konva}(GM)),GM}var Iv={},SV;function dke(){if(SV)return Iv;SV=1,Object.defineProperty(Iv,"__esModule",{value:!0}),Iv.Arc=void 0;const r=Ui(),e=os(),n=$i(),i=Hi(),s=$i();let o=class extends e.Shape{_sceneFunc(l){var h=n.Konva.getAngle(this.angle()),u=this.clockwise();l.beginPath(),l.arc(0,0,this.outerRadius(),0,h,u),l.arc(0,0,this.innerRadius(),h,0,!u),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(l){this.outerRadius(l/2)}setHeight(l){this.outerRadius(l/2)}getSelfRect(){const l=this.innerRadius(),h=this.outerRadius(),u=this.clockwise(),f=n.Konva.getAngle(u?360-this.angle():this.angle()),p=Math.cos(Math.min(f,Math.PI)),m=1,v=Math.sin(Math.min(Math.max(Math.PI,f),3*Math.PI/2)),y=Math.sin(Math.min(f,Math.PI/2)),x=p*(p>0?l:h),w=m*h,S=v*(v>0?l:h),O=y*(y>0?h:l);return{x,y:u?-1*O:S,width:w-x,height:O-S}}};return Iv.Arc=o,o.prototype._centroid=!0,o.prototype.className="Arc",o.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,s._registerNode)(o),r.Factory.addGetterSetter(o,"innerRadius",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(o,"outerRadius",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(o,"angle",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(o,"clockwise",!1,(0,i.getBooleanValidator)()),Iv}var Nv={},Dv={},CV;function uj(){if(CV)return Dv;CV=1,Object.defineProperty(Dv,"__esModule",{value:!0}),Dv.Line=void 0;const r=Ui(),e=os(),n=Hi(),i=$i();function s(l,h,u,f,p,m,v){var y=Math.sqrt(Math.pow(u-l,2)+Math.pow(f-h,2)),x=Math.sqrt(Math.pow(p-u,2)+Math.pow(m-f,2)),w=v*y/(y+x),S=v*x/(y+x),O=u-w*(p-l),_=f-w*(m-h),T=u+S*(p-l),A=f+S*(m-h);return[O,_,T,A]}function o(l,h){var u=l.length,f=[],p,m;for(p=2;p<u-2;p+=2)m=s(l[p-2],l[p-1],l[p],l[p+1],l[p+2],l[p+3],h),!isNaN(m[0])&&(f.push(m[0]),f.push(m[1]),f.push(l[p]),f.push(l[p+1]),f.push(m[2]),f.push(m[3]));return f}class a extends e.Shape{constructor(h){super(h),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(h){var u=this.points(),f=u.length,p=this.tension(),m=this.closed(),v=this.bezier(),y,x,w;if(f){if(h.beginPath(),h.moveTo(u[0],u[1]),p!==0&&f>4){for(y=this.getTensionPoints(),x=y.length,w=m?0:4,m||h.quadraticCurveTo(y[0],y[1],y[2],y[3]);w<x-2;)h.bezierCurveTo(y[w++],y[w++],y[w++],y[w++],y[w++],y[w++]);m||h.quadraticCurveTo(y[x-2],y[x-1],u[f-2],u[f-1])}else if(v)for(w=2;w<f;)h.bezierCurveTo(u[w++],u[w++],u[w++],u[w++],u[w++],u[w++]);else for(w=2;w<f;w+=2)h.lineTo(u[w],u[w+1]);m?(h.closePath(),h.fillStrokeShape(this)):h.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():o(this.points(),this.tension())}_getTensionPointsClosed(){var h=this.points(),u=h.length,f=this.tension(),p=s(h[u-2],h[u-1],h[0],h[1],h[2],h[3],f),m=s(h[u-4],h[u-3],h[u-2],h[u-1],h[0],h[1],f),v=o(h,f),y=[p[2],p[3]].concat(v).concat([m[0],m[1],h[u-2],h[u-1],m[2],m[3],p[0],p[1],h[0],h[1]]);return y}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var h=this.points();if(h.length<4)return{x:h[0]||0,y:h[1]||0,width:0,height:0};this.tension()!==0?h=[h[0],h[1],...this._getTensionPoints(),h[h.length-2],h[h.length-1]]:h=this.points();for(var u=h[0],f=h[0],p=h[1],m=h[1],v,y,x=0;x<h.length/2;x++)v=h[x*2],y=h[x*2+1],u=Math.min(u,v),f=Math.max(f,v),p=Math.min(p,y),m=Math.max(m,y);return{x:u,y:p,width:f-u,height:m-p}}}return Dv.Line=a,a.prototype.className="Line",a.prototype._attrsAffectingSize=["points","bezier","tension"],(0,i._registerNode)(a),r.Factory.addGetterSetter(a,"closed",!1),r.Factory.addGetterSetter(a,"bezier",!1),r.Factory.addGetterSetter(a,"tension",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(a,"points",[],(0,n.getNumberArrayValidator)()),Dv}var Lv={},JM={},TV;function fke(){return TV||(TV=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.t2length=r.getQuadraticArcLength=r.getCubicArcLength=r.binomialCoefficients=r.cValues=r.tValues=void 0,r.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],r.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],r.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(a,l,h)=>{let u,f,p;u=h/2,f=0;for(let v=0;v<20;v++)p=u*r.tValues[20][v]+u,f+=r.cValues[20][v]*i(a,l,p);return u*f};r.getCubicArcLength=e;const n=(a,l,h)=>{h===void 0&&(h=1);const u=a[0]-2*a[1]+a[2],f=l[0]-2*l[1]+l[2],p=2*a[1]-2*a[0],m=2*l[1]-2*l[0],v=4*(u*u+f*f),y=4*(u*p+f*m),x=p*p+m*m;if(v===0)return h*Math.sqrt(Math.pow(a[2]-a[0],2)+Math.pow(l[2]-l[0],2));const w=y/(2*v),S=x/v,O=h+w,_=S-w*w,T=O*O+_>0?Math.sqrt(O*O+_):0,A=w*w+_>0?Math.sqrt(w*w+_):0,P=w+Math.sqrt(w*w+_)!==0?_*Math.log(Math.abs((O+T)/(w+A))):0;return Math.sqrt(v)/2*(O*T-w*A+P)};r.getQuadraticArcLength=n;function i(a,l,h){const u=s(1,h,a),f=s(1,h,l),p=u*u+f*f;return Math.sqrt(p)}const s=(a,l,h)=>{const u=h.length-1;let f,p;if(u===0)return 0;if(a===0){p=0;for(let m=0;m<=u;m++)p+=r.binomialCoefficients[u][m]*Math.pow(1-l,u-m)*Math.pow(l,m)*h[m];return p}else{f=new Array(u);for(let m=0;m<u;m++)f[m]=u*(h[m+1]-h[m]);return s(a-1,l,f)}},o=(a,l,h)=>{let u=1,f=a/l,p=(a-h(f))/l,m=0;for(;u>.001;){const v=h(f+p),y=Math.abs(a-v)/l;if(y<u)u=y,f+=p;else{const x=h(f-p),w=Math.abs(a-x)/l;w<u?(u=w,f-=p):p/=2}if(m++,m>500)break}return f};r.t2length=o}(JM)),JM}var EV;function r5(){if(EV)return Lv;EV=1,Object.defineProperty(Lv,"__esModule",{value:!0}),Lv.Path=void 0;const r=Ui(),e=os(),n=$i(),i=fke();let s=class fo extends e.Shape{constructor(a){super(a),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=fo.parsePathData(this.data()),this.pathLength=fo.getPathLength(this.dataArray)}_sceneFunc(a){var l=this.dataArray;a.beginPath();for(var h=!1,u=0;u<l.length;u++){var f=l[u].command,p=l[u].points;switch(f){case"L":a.lineTo(p[0],p[1]);break;case"M":a.moveTo(p[0],p[1]);break;case"C":a.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":a.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":var m=p[0],v=p[1],y=p[2],x=p[3],w=p[4],S=p[5],O=p[6],_=p[7],T=y>x?y:x,A=y>x?1:y/x,P=y>x?x/y:1;a.translate(m,v),a.rotate(O),a.scale(A,P),a.arc(0,0,T,w,w+S,1-_),a.scale(1/A,1/P),a.rotate(-O),a.translate(-m,-v);break;case"z":h=!0,a.closePath();break}}!h&&!this.hasFill()?a.strokeShape(this):a.fillStrokeShape(this)}getSelfRect(){var a=[];this.dataArray.forEach(function(y){if(y.command==="A"){var x=y.points[4],w=y.points[5],S=y.points[4]+w,O=Math.PI/180;if(Math.abs(x-S)<O&&(O=Math.abs(x-S)),w<0)for(let _=x-O;_>S;_-=O){const T=fo.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],_,0);a.push(T.x,T.y)}else for(let _=x+O;_<S;_+=O){const T=fo.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],_,0);a.push(T.x,T.y)}}else if(y.command==="C")for(let _=0;_<=1;_+=.01){const T=fo.getPointOnCubicBezier(_,y.start.x,y.start.y,y.points[0],y.points[1],y.points[2],y.points[3],y.points[4],y.points[5]);a.push(T.x,T.y)}else a=a.concat(y.points)});for(var l=a[0],h=a[0],u=a[1],f=a[1],p,m,v=0;v<a.length/2;v++)p=a[v*2],m=a[v*2+1],isNaN(p)||(l=Math.min(l,p),h=Math.max(h,p)),isNaN(m)||(u=Math.min(u,m),f=Math.max(f,m));return{x:l,y:u,width:h-l,height:f-u}}getLength(){return this.pathLength}getPointAtLength(a){return fo.getPointAtLengthOfDataArray(a,this.dataArray)}static getLineLength(a,l,h,u){return Math.sqrt((h-a)*(h-a)+(u-l)*(u-l))}static getPathLength(a){let l=0;for(var h=0;h<a.length;++h)l+=a[h].pathLength;return l}static getPointAtLengthOfDataArray(a,l){var h,u=0,f=l.length;if(!f)return null;for(;u<f&&a>l[u].pathLength;)a-=l[u].pathLength,++u;if(u===f)return h=l[u-1].points.slice(-2),{x:h[0],y:h[1]};if(a<.01)return h=l[u].points.slice(0,2),{x:h[0],y:h[1]};var p=l[u],m=p.points;switch(p.command){case"L":return fo.getPointOnLine(a,p.start.x,p.start.y,m[0],m[1]);case"C":return fo.getPointOnCubicBezier((0,i.t2length)(a,fo.getPathLength(l),T=>(0,i.getCubicArcLength)([p.start.x,m[0],m[2],m[4]],[p.start.y,m[1],m[3],m[5]],T)),p.start.x,p.start.y,m[0],m[1],m[2],m[3],m[4],m[5]);case"Q":return fo.getPointOnQuadraticBezier((0,i.t2length)(a,fo.getPathLength(l),T=>(0,i.getQuadraticArcLength)([p.start.x,m[0],m[2]],[p.start.y,m[1],m[3]],T)),p.start.x,p.start.y,m[0],m[1],m[2],m[3]);case"A":var v=m[0],y=m[1],x=m[2],w=m[3],S=m[4],O=m[5],_=m[6];return S+=O*a/p.pathLength,fo.getPointOnEllipticalArc(v,y,x,w,S,_)}return null}static getPointOnLine(a,l,h,u,f,p,m){p=p??l,m=m??h;const v=this.getLineLength(l,h,u,f);if(v<1e-10)return{x:l,y:h};if(u===l)return{x:p,y:m+(f>h?a:-a)};const y=(f-h)/(u-l),x=Math.sqrt(a*a/(1+y*y))*(u<l?-1:1),w=y*x;if(Math.abs(m-h-y*(p-l))<1e-10)return{x:p+x,y:m+w};const S=((p-l)*(u-l)+(m-h)*(f-h))/(v*v),O=l+S*(u-l),_=h+S*(f-h),T=this.getLineLength(p,m,O,_),A=Math.sqrt(a*a-T*T),P=Math.sqrt(A*A/(1+y*y))*(u<l?-1:1),N=y*P;return{x:O+P,y:_+N}}static getPointOnCubicBezier(a,l,h,u,f,p,m,v,y){function x(A){return A*A*A}function w(A){return 3*A*A*(1-A)}function S(A){return 3*A*(1-A)*(1-A)}function O(A){return(1-A)*(1-A)*(1-A)}var _=v*x(a)+p*w(a)+u*S(a)+l*O(a),T=y*x(a)+m*w(a)+f*S(a)+h*O(a);return{x:_,y:T}}static getPointOnQuadraticBezier(a,l,h,u,f,p,m){function v(O){return O*O}function y(O){return 2*O*(1-O)}function x(O){return(1-O)*(1-O)}var w=p*v(a)+u*y(a)+l*x(a),S=m*v(a)+f*y(a)+h*x(a);return{x:w,y:S}}static getPointOnEllipticalArc(a,l,h,u,f,p){var m=Math.cos(p),v=Math.sin(p),y={x:h*Math.cos(f),y:u*Math.sin(f)};return{x:a+(y.x*m-y.y*v),y:l+(y.x*v+y.y*m)}}static parsePathData(a){if(!a)return[];var l=a,h=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];l=l.replace(new RegExp(" ","g"),",");for(var u=0;u<h.length;u++)l=l.replace(new RegExp(h[u],"g"),"|"+h[u]);var f=l.split("|"),p=[],m=[],v=0,y=0,x=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,w;for(u=1;u<f.length;u++){var S=f[u],O=S.charAt(0);for(S=S.slice(1),m.length=0;w=x.exec(S);)m.push(w[0]);for(var _=[],T=0,A=m.length;T<A;T++){if(m[T]==="00"){_.push(0,0);continue}var P=parseFloat(m[T]);isNaN(P)?_.push(0):_.push(P)}for(;_.length>0&&!isNaN(_[0]);){var N="",k=[],R=v,E=y,D,$,I,L,U,V,X,H,J,ee;switch(O){case"l":v+=_.shift(),y+=_.shift(),N="L",k.push(v,y);break;case"L":v=_.shift(),y=_.shift(),k.push(v,y);break;case"m":var ne=_.shift(),ge=_.shift();if(v+=ne,y+=ge,N="M",p.length>2&&p[p.length-1].command==="z"){for(var ye=p.length-2;ye>=0;ye--)if(p[ye].command==="M"){v=p[ye].points[0]+ne,y=p[ye].points[1]+ge;break}}k.push(v,y),O="l";break;case"M":v=_.shift(),y=_.shift(),N="M",k.push(v,y),O="L";break;case"h":v+=_.shift(),N="L",k.push(v,y);break;case"H":v=_.shift(),N="L",k.push(v,y);break;case"v":y+=_.shift(),N="L",k.push(v,y);break;case"V":y=_.shift(),N="L",k.push(v,y);break;case"C":k.push(_.shift(),_.shift(),_.shift(),_.shift()),v=_.shift(),y=_.shift(),k.push(v,y);break;case"c":k.push(v+_.shift(),y+_.shift(),v+_.shift(),y+_.shift()),v+=_.shift(),y+=_.shift(),N="C",k.push(v,y);break;case"S":$=v,I=y,D=p[p.length-1],D.command==="C"&&($=v+(v-D.points[2]),I=y+(y-D.points[3])),k.push($,I,_.shift(),_.shift()),v=_.shift(),y=_.shift(),N="C",k.push(v,y);break;case"s":$=v,I=y,D=p[p.length-1],D.command==="C"&&($=v+(v-D.points[2]),I=y+(y-D.points[3])),k.push($,I,v+_.shift(),y+_.shift()),v+=_.shift(),y+=_.shift(),N="C",k.push(v,y);break;case"Q":k.push(_.shift(),_.shift()),v=_.shift(),y=_.shift(),k.push(v,y);break;case"q":k.push(v+_.shift(),y+_.shift()),v+=_.shift(),y+=_.shift(),N="Q",k.push(v,y);break;case"T":$=v,I=y,D=p[p.length-1],D.command==="Q"&&($=v+(v-D.points[0]),I=y+(y-D.points[1])),v=_.shift(),y=_.shift(),N="Q",k.push($,I,v,y);break;case"t":$=v,I=y,D=p[p.length-1],D.command==="Q"&&($=v+(v-D.points[0]),I=y+(y-D.points[1])),v+=_.shift(),y+=_.shift(),N="Q",k.push($,I,v,y);break;case"A":L=_.shift(),U=_.shift(),V=_.shift(),X=_.shift(),H=_.shift(),J=v,ee=y,v=_.shift(),y=_.shift(),N="A",k=this.convertEndpointToCenterParameterization(J,ee,v,y,X,H,L,U,V);break;case"a":L=_.shift(),U=_.shift(),V=_.shift(),X=_.shift(),H=_.shift(),J=v,ee=y,v+=_.shift(),y+=_.shift(),N="A",k=this.convertEndpointToCenterParameterization(J,ee,v,y,X,H,L,U,V);break}p.push({command:N||O,points:k,start:{x:R,y:E},pathLength:this.calcLength(R,E,N||O,k)})}(O==="z"||O==="Z")&&p.push({command:"z",points:[],start:void 0,pathLength:0})}return p}static calcLength(a,l,h,u){var f,p,m,v,y=fo;switch(h){case"L":return y.getLineLength(a,l,u[0],u[1]);case"C":return(0,i.getCubicArcLength)([a,u[0],u[2],u[4]],[l,u[1],u[3],u[5]],1);case"Q":return(0,i.getQuadraticArcLength)([a,u[0],u[2]],[l,u[1],u[3]],1);case"A":f=0;var x=u[4],w=u[5],S=u[4]+w,O=Math.PI/180;if(Math.abs(x-S)<O&&(O=Math.abs(x-S)),p=y.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],x,0),w<0)for(v=x-O;v>S;v-=O)m=y.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],v,0),f+=y.getLineLength(p.x,p.y,m.x,m.y),p=m;else for(v=x+O;v<S;v+=O)m=y.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],v,0),f+=y.getLineLength(p.x,p.y,m.x,m.y),p=m;return m=y.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],S,0),f+=y.getLineLength(p.x,p.y,m.x,m.y),f}return 0}static convertEndpointToCenterParameterization(a,l,h,u,f,p,m,v,y){var x=y*(Math.PI/180),w=Math.cos(x)*(a-h)/2+Math.sin(x)*(l-u)/2,S=-1*Math.sin(x)*(a-h)/2+Math.cos(x)*(l-u)/2,O=w*w/(m*m)+S*S/(v*v);O>1&&(m*=Math.sqrt(O),v*=Math.sqrt(O));var _=Math.sqrt((m*m*(v*v)-m*m*(S*S)-v*v*(w*w))/(m*m*(S*S)+v*v*(w*w)));f===p&&(_*=-1),isNaN(_)&&(_=0);var T=_*m*S/v,A=_*-v*w/m,P=(a+h)/2+Math.cos(x)*T-Math.sin(x)*A,N=(l+u)/2+Math.sin(x)*T+Math.cos(x)*A,k=function(U){return Math.sqrt(U[0]*U[0]+U[1]*U[1])},R=function(U,V){return(U[0]*V[0]+U[1]*V[1])/(k(U)*k(V))},E=function(U,V){return(U[0]*V[1]<U[1]*V[0]?-1:1)*Math.acos(R(U,V))},D=E([1,0],[(w-T)/m,(S-A)/v]),$=[(w-T)/m,(S-A)/v],I=[(-1*w-T)/m,(-1*S-A)/v],L=E($,I);return R($,I)<=-1&&(L=Math.PI),R($,I)>=1&&(L=0),p===0&&L>0&&(L=L-2*Math.PI),p===1&&L<0&&(L=L+2*Math.PI),[P,N,m,v,D,L,x,p]}};return Lv.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,n._registerNode)(s),r.Factory.addGetterSetter(s,"data"),Lv}var MV;function pke(){if(MV)return Nv;MV=1,Object.defineProperty(Nv,"__esModule",{value:!0}),Nv.Arrow=void 0;const r=Ui(),e=uj(),n=Hi(),i=$i(),s=r5();let o=class extends e.Line{_sceneFunc(l){super._sceneFunc(l);var h=Math.PI*2,u=this.points(),f=u,p=this.tension()!==0&&u.length>4;p&&(f=this.getTensionPoints());var m=this.pointerLength(),v=u.length,y,x;if(p){const O=[f[f.length-4],f[f.length-3],f[f.length-2],f[f.length-1],u[v-2],u[v-1]],_=s.Path.calcLength(f[f.length-4],f[f.length-3],"C",O),T=s.Path.getPointOnQuadraticBezier(Math.min(1,1-m/_),O[0],O[1],O[2],O[3],O[4],O[5]);y=u[v-2]-T.x,x=u[v-1]-T.y}else y=u[v-2]-u[v-4],x=u[v-1]-u[v-3];var w=(Math.atan2(x,y)+h)%h,S=this.pointerWidth();this.pointerAtEnding()&&(l.save(),l.beginPath(),l.translate(u[v-2],u[v-1]),l.rotate(w),l.moveTo(0,0),l.lineTo(-m,S/2),l.lineTo(-m,-S/2),l.closePath(),l.restore(),this.__fillStroke(l)),this.pointerAtBeginning()&&(l.save(),l.beginPath(),l.translate(u[0],u[1]),p?(y=(f[0]+f[2])/2-u[0],x=(f[1]+f[3])/2-u[1]):(y=u[2]-u[0],x=u[3]-u[1]),l.rotate((Math.atan2(-x,-y)+h)%h),l.moveTo(0,0),l.lineTo(-m,S/2),l.lineTo(-m,-S/2),l.closePath(),l.restore(),this.__fillStroke(l))}__fillStroke(l){var h=this.dashEnabled();h&&(this.attrs.dashEnabled=!1,l.setLineDash([])),l.fillStrokeShape(this),h&&(this.attrs.dashEnabled=!0)}getSelfRect(){const l=super.getSelfRect(),h=this.pointerWidth()/2;return{x:l.x-h,y:l.y-h,width:l.width+h*2,height:l.height+h*2}}};return Nv.Arrow=o,o.prototype.className="Arrow",(0,i._registerNode)(o),r.Factory.addGetterSetter(o,"pointerLength",10,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(o,"pointerWidth",10,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(o,"pointerAtBeginning",!1),r.Factory.addGetterSetter(o,"pointerAtEnding",!0),Nv}var Bv={},AV;function mke(){if(AV)return Bv;AV=1,Object.defineProperty(Bv,"__esModule",{value:!0}),Bv.Circle=void 0;const r=Ui(),e=os(),n=Hi(),i=$i();class s extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius()!==a/2&&this.radius(a/2)}setHeight(a){this.radius()!==a/2&&this.radius(a/2)}}return Bv.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),r.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),Bv}var $v={},kV;function gke(){if(kV)return $v;kV=1,Object.defineProperty($v,"__esModule",{value:!0}),$v.Ellipse=void 0;const r=Ui(),e=os(),n=Hi(),i=$i();class s extends e.Shape{_sceneFunc(a){var l=this.radiusX(),h=this.radiusY();a.beginPath(),a.save(),l!==h&&a.scale(1,h/l),a.arc(0,0,l,0,Math.PI*2,!1),a.restore(),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(a){this.radiusX(a/2)}setHeight(a){this.radiusY(a/2)}}return $v.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(s),r.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),r.Factory.addGetterSetter(s,"radiusX",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(s,"radiusY",0,(0,n.getNumberValidator)()),$v}var Uv={},PV;function vke(){if(PV)return Uv;PV=1,Object.defineProperty(Uv,"__esModule",{value:!0}),Uv.Image=void 0;const r=dr(),e=Ui(),n=os(),i=$i(),s=Hi();class o extends n.Shape{constructor(l){super(l),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const l=this.image();l&&l.complete||l&&l.readyState===4||l&&l.addEventListener&&l.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(l){const h=this.getWidth(),u=this.getHeight(),f=this.cornerRadius(),p=this.attrs.image;let m;if(p){const v=this.attrs.cropWidth,y=this.attrs.cropHeight;v&&y?m=[p,this.cropX(),this.cropY(),v,y,0,0,h,u]:m=[p,0,0,h,u]}(this.hasFill()||this.hasStroke()||f)&&(l.beginPath(),f?r.Util.drawRoundedRectPath(l,h,u,f):l.rect(0,0,h,u),l.closePath(),l.fillStrokeShape(this)),p&&(f&&l.clip(),l.drawImage.apply(l,m))}_hitFunc(l){var h=this.width(),u=this.height(),f=this.cornerRadius();l.beginPath(),f?r.Util.drawRoundedRectPath(l,h,u,f):l.rect(0,0,h,u),l.closePath(),l.fillStrokeShape(this)}getWidth(){var l,h;return(l=this.attrs.width)!==null&&l!==void 0?l:(h=this.image())===null||h===void 0?void 0:h.width}getHeight(){var l,h;return(l=this.attrs.height)!==null&&l!==void 0?l:(h=this.image())===null||h===void 0?void 0:h.height}static fromURL(l,h,u=null){var f=r.Util.createImageElement();f.onload=function(){var p=new o({image:f});h(p)},f.onerror=u,f.crossOrigin="Anonymous",f.src=l}}return Uv.Image=o,o.prototype.className="Image",(0,i._registerNode)(o),e.Factory.addGetterSetter(o,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(o,"image"),e.Factory.addComponentsGetterSetter(o,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(o,"cropX",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(o,"cropY",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(o,"cropWidth",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(o,"cropHeight",0,(0,s.getNumberValidator)()),Uv}var tf={},RV;function dj(){if(RV)return tf;RV=1,Object.defineProperty(tf,"__esModule",{value:!0}),tf.Tag=tf.Label=void 0;const r=Ui(),e=os(),n=i5(),i=Hi(),s=$i();var o=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],a="Change.konva",l="none",h="up",u="right",f="down",p="left",m=o.length;let v=class extends n.Group{constructor(w){super(w),this.on("add.konva",function(S){this._addListeners(S.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(w){var S=this,O,_=function(){S._sync()};for(O=0;O<m;O++)w.on(o[O]+a,_)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var w=this.getText(),S=this.getTag(),O,_,T,A,P,N,k;if(w&&S){switch(O=w.width(),_=w.height(),T=S.pointerDirection(),A=S.pointerWidth(),k=S.pointerHeight(),P=0,N=0,T){case h:P=O/2,N=-1*k;break;case u:P=O+A,N=_/2;break;case f:P=O/2,N=_+k;break;case p:P=-1*A,N=_/2;break}S.setAttrs({x:-1*P,y:-1*N,width:O,height:_}),w.setAttrs({x:-1*P,y:-1*N})}}};tf.Label=v,v.prototype.className="Label",(0,s._registerNode)(v);class y extends e.Shape{_sceneFunc(w){var S=this.width(),O=this.height(),_=this.pointerDirection(),T=this.pointerWidth(),A=this.pointerHeight(),P=this.cornerRadius();let N=0,k=0,R=0,E=0;typeof P=="number"?N=k=R=E=Math.min(P,S/2,O/2):(N=Math.min(P[0]||0,S/2,O/2),k=Math.min(P[1]||0,S/2,O/2),E=Math.min(P[2]||0,S/2,O/2),R=Math.min(P[3]||0,S/2,O/2)),w.beginPath(),w.moveTo(N,0),_===h&&(w.lineTo((S-T)/2,0),w.lineTo(S/2,-1*A),w.lineTo((S+T)/2,0)),w.lineTo(S-k,0),w.arc(S-k,k,k,Math.PI*3/2,0,!1),_===u&&(w.lineTo(S,(O-A)/2),w.lineTo(S+T,O/2),w.lineTo(S,(O+A)/2)),w.lineTo(S,O-E),w.arc(S-E,O-E,E,0,Math.PI/2,!1),_===f&&(w.lineTo((S+T)/2,O),w.lineTo(S/2,O+A),w.lineTo((S-T)/2,O)),w.lineTo(R,O),w.arc(R,O-R,R,Math.PI/2,Math.PI,!1),_===p&&(w.lineTo(0,(O+A)/2),w.lineTo(-1*T,O/2),w.lineTo(0,(O-A)/2)),w.lineTo(0,N),w.arc(N,N,N,Math.PI,Math.PI*3/2,!1),w.closePath(),w.fillStrokeShape(this)}getSelfRect(){var w=0,S=0,O=this.pointerWidth(),_=this.pointerHeight(),T=this.pointerDirection(),A=this.width(),P=this.height();return T===h?(S-=_,P+=_):T===f?P+=_:T===p?(w-=O*1.5,A+=O):T===u&&(A+=O*1.5),{x:w,y:S,width:A,height:P}}}return tf.Tag=y,y.prototype.className="Tag",(0,s._registerNode)(y),r.Factory.addGetterSetter(y,"pointerDirection",l),r.Factory.addGetterSetter(y,"pointerWidth",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(y,"pointerHeight",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(y,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),tf}var Vv={},IV;function fj(){if(IV)return Vv;IV=1,Object.defineProperty(Vv,"__esModule",{value:!0}),Vv.Rect=void 0;const r=Ui(),e=os(),n=$i(),i=dr(),s=Hi();let o=class extends e.Shape{_sceneFunc(l){var h=this.cornerRadius(),u=this.width(),f=this.height();l.beginPath(),h?i.Util.drawRoundedRectPath(l,u,f,h):l.rect(0,0,u,f),l.closePath(),l.fillStrokeShape(this)}};return Vv.Rect=o,o.prototype.className="Rect",(0,n._registerNode)(o),r.Factory.addGetterSetter(o,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),Vv}var Fv={},NV;function yke(){if(NV)return Fv;NV=1,Object.defineProperty(Fv,"__esModule",{value:!0}),Fv.RegularPolygon=void 0;const r=Ui(),e=os(),n=Hi(),i=$i();let s=class extends e.Shape{_sceneFunc(a){const l=this._getPoints();a.beginPath(),a.moveTo(l[0].x,l[0].y);for(var h=1;h<l.length;h++)a.lineTo(l[h].x,l[h].y);a.closePath(),a.fillStrokeShape(this)}_getPoints(){const a=this.attrs.sides,l=this.attrs.radius||0,h=[];for(var u=0;u<a;u++)h.push({x:l*Math.sin(u*2*Math.PI/a),y:-1*l*Math.cos(u*2*Math.PI/a)});return h}getSelfRect(){const a=this._getPoints();var l=a[0].x,h=a[0].y,u=a[0].x,f=a[0].y;return a.forEach(p=>{l=Math.min(l,p.x),h=Math.max(h,p.x),u=Math.min(u,p.y),f=Math.max(f,p.y)}),{x:l,y:u,width:h-l,height:f-u}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return Fv.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(s),r.Factory.addGetterSetter(s,"radius",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(s,"sides",0,(0,n.getNumberValidator)()),Fv}var zv={},DV;function bke(){if(DV)return zv;DV=1,Object.defineProperty(zv,"__esModule",{value:!0}),zv.Ring=void 0;const r=Ui(),e=os(),n=Hi(),i=$i();var s=Math.PI*2;let o=class extends e.Shape{_sceneFunc(l){l.beginPath(),l.arc(0,0,this.innerRadius(),0,s,!1),l.moveTo(this.outerRadius(),0),l.arc(0,0,this.outerRadius(),s,0,!0),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(l){this.outerRadius(l/2)}setHeight(l){this.outerRadius(l/2)}};return zv.Ring=o,o.prototype.className="Ring",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(o),r.Factory.addGetterSetter(o,"innerRadius",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(o,"outerRadius",0,(0,n.getNumberValidator)()),zv}var Xv={},LV;function xke(){if(LV)return Xv;LV=1,Object.defineProperty(Xv,"__esModule",{value:!0}),Xv.Sprite=void 0;const r=Ui(),e=os(),n=n5(),i=Hi(),s=$i();class o extends e.Shape{constructor(l){super(l),this._updated=!0,this.anim=new n.Animation(()=>{var h=this._updated;return this._updated=!1,h}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(l){var h=this.animation(),u=this.frameIndex(),f=u*4,p=this.animations()[h],m=this.frameOffsets(),v=p[f+0],y=p[f+1],x=p[f+2],w=p[f+3],S=this.image();if((this.hasFill()||this.hasStroke())&&(l.beginPath(),l.rect(0,0,x,w),l.closePath(),l.fillStrokeShape(this)),S)if(m){var O=m[h],_=u*2;l.drawImage(S,v,y,x,w,O[_+0],O[_+1],x,w)}else l.drawImage(S,v,y,x,w,0,0,x,w)}_hitFunc(l){var h=this.animation(),u=this.frameIndex(),f=u*4,p=this.animations()[h],m=this.frameOffsets(),v=p[f+2],y=p[f+3];if(l.beginPath(),m){var x=m[h],w=u*2;l.rect(x[w+0],x[w+1],v,y)}else l.rect(0,0,v,y);l.closePath(),l.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var l=this;this.interval=setInterval(function(){l._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var l=this.getLayer();this.anim.setLayers(l),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var l=this.frameIndex(),h=this.animation(),u=this.animations(),f=u[h],p=f.length/4;l<p-1?this.frameIndex(l+1):this.frameIndex(0)}}return Xv.Sprite=o,o.prototype.className="Sprite",(0,s._registerNode)(o),r.Factory.addGetterSetter(o,"animation"),r.Factory.addGetterSetter(o,"animations"),r.Factory.addGetterSetter(o,"frameOffsets"),r.Factory.addGetterSetter(o,"image"),r.Factory.addGetterSetter(o,"frameIndex",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(o,"frameRate",17,(0,i.getNumberValidator)()),r.Factory.backCompat(o,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Xv}var Wv={},BV;function wke(){if(BV)return Wv;BV=1,Object.defineProperty(Wv,"__esModule",{value:!0}),Wv.Star=void 0;const r=Ui(),e=os(),n=Hi(),i=$i();let s=class extends e.Shape{_sceneFunc(a){var l=this.innerRadius(),h=this.outerRadius(),u=this.numPoints();a.beginPath(),a.moveTo(0,0-h);for(var f=1;f<u*2;f++){var p=f%2===0?h:l,m=p*Math.sin(f*Math.PI/u),v=-1*p*Math.cos(f*Math.PI/u);a.lineTo(m,v)}a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return Wv.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),r.Factory.addGetterSetter(s,"numPoints",5,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),Wv}var nf={},$V;function pj(){if($V)return nf;$V=1,Object.defineProperty(nf,"__esModule",{value:!0}),nf.Text=nf.stringToArray=void 0;const r=dr(),e=Ui(),n=os(),i=$i(),s=Hi(),o=$i();function a(ge){return Array.from(ge)}nf.stringToArray=a;var l="auto",h="center",u="inherit",f="justify",p="Change.konva",m="2d",v="-",y="left",x="text",w="Text",S="top",O="bottom",_="middle",T="normal",A="px ",P=" ",N="right",k="rtl",R="word",E="char",D="none",$="…",I=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],L=I.length;function U(ge){return ge.split(",").map(ye=>{ye=ye.trim();const ce=ye.indexOf(" ")>=0,we=ye.indexOf('"')>=0||ye.indexOf("'")>=0;return ce&&!we&&(ye=`"${ye}"`),ye}).join(", ")}var V;function X(){return V||(V=r.Util.createCanvasElement().getContext(m),V)}function H(ge){ge.fillText(this._partialText,this._partialTextX,this._partialTextY)}function J(ge){ge.setAttr("miterLimit",2),ge.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function ee(ge){return ge=ge||{},!ge.fillLinearGradientColorStops&&!ge.fillRadialGradientColorStops&&!ge.fillPatternImage&&(ge.fill=ge.fill||"black"),ge}class ne extends n.Shape{constructor(ye){super(ee(ye)),this._partialTextX=0,this._partialTextY=0;for(var ce=0;ce<L;ce++)this.on(I[ce]+p,this._setTextData);this._setTextData()}_sceneFunc(ye){var ce=this.textArr,we=ce.length;if(this.text()){var be=this.padding(),se=this.fontSize(),ae=this.lineHeight()*se,Q=this.verticalAlign(),z=this.direction(),j=0,te=this.align(),W=this.getWidth(),Z=this.letterSpacing(),he=this.fill(),pe=this.textDecoration(),_e=pe.indexOf("underline")!==-1,Re=pe.indexOf("line-through")!==-1,ie;z=z===u?ye.direction:z;var q=ae/2,me=_;if(i.Konva._fixTextRendering){var ve=this.measureSize("M");me="alphabetic",q=(ve.fontBoundingBoxAscent-ve.fontBoundingBoxDescent)/2+ae/2}var Te=0,ke=0;for(z===k&&ye.setAttr("direction",z),ye.setAttr("font",this._getContextFont()),ye.setAttr("textBaseline",me),ye.setAttr("textAlign",y),Q===_?j=(this.getHeight()-we*ae-be*2)/2:Q===O&&(j=this.getHeight()-we*ae-be*2),ye.translate(be,j+be),ie=0;ie<we;ie++){var Te=0,ke=0,He=ce[ie],Ue=He.text,We=He.width,ct=He.lastInParagraph,Ye,lt,Lt;if(ye.save(),te===N?Te+=W-We-be*2:te===h&&(Te+=(W-We-be*2)/2),_e){ye.save(),ye.beginPath();let Ve=i.Konva._fixTextRendering?Math.round(se/4):Math.round(se/2);const xe=Te,Fe=q+ke+Ve;ye.moveTo(xe,Fe),Ye=Ue.split(" ").length-1,lt=Ye===0,Lt=te===f&&!ct?W-be*2:We,ye.lineTo(xe+Math.round(Lt),Fe),ye.lineWidth=se/15;const Ge=this._getLinearGradient();ye.strokeStyle=Ge||he,ye.stroke(),ye.restore()}if(Re){ye.save(),ye.beginPath();let Ve=i.Konva._fixTextRendering?-Math.round(se/4):0;ye.moveTo(Te,q+ke+Ve),Ye=Ue.split(" ").length-1,lt=Ye===0,Lt=te===f&&ct&&!lt?W-be*2:We,ye.lineTo(Te+Math.round(Lt),q+ke+Ve),ye.lineWidth=se/15;const xe=this._getLinearGradient();ye.strokeStyle=xe||he,ye.stroke(),ye.restore()}if(z!==k&&(Z!==0||te===f)){Ye=Ue.split(" ").length-1;for(var Bt=a(Ue),gt=0;gt<Bt.length;gt++){var ei=Bt[gt];ei===" "&&!ct&&te===f&&(Te+=(W-be*2-We)/Ye),this._partialTextX=Te,this._partialTextY=q+ke,this._partialText=ei,ye.fillStrokeShape(this),Te+=this.measureSize(ei).width+Z}}else Z!==0&&ye.setAttr("letterSpacing",`${Z}px`),this._partialTextX=Te,this._partialTextY=q+ke,this._partialText=Ue,ye.fillStrokeShape(this);ye.restore(),we>1&&(q+=ae)}}}_hitFunc(ye){var ce=this.getWidth(),we=this.getHeight();ye.beginPath(),ye.rect(0,0,ce,we),ye.closePath(),ye.fillStrokeShape(this)}setText(ye){var ce=r.Util._isString(ye)?ye:ye==null?"":ye+"";return this._setAttr(x,ce),this}getWidth(){var ye=this.attrs.width===l||this.attrs.width===void 0;return ye?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var ye=this.attrs.height===l||this.attrs.height===void 0;return ye?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return r.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(ye){var ce=X(),we=this.fontSize(),be;return ce.save(),ce.font=this._getContextFont(),be=ce.measureText(ye),ce.restore(),{actualBoundingBoxAscent:be.actualBoundingBoxAscent,actualBoundingBoxDescent:be.actualBoundingBoxDescent,actualBoundingBoxLeft:be.actualBoundingBoxLeft,actualBoundingBoxRight:be.actualBoundingBoxRight,alphabeticBaseline:be.alphabeticBaseline,emHeightAscent:be.emHeightAscent,emHeightDescent:be.emHeightDescent,fontBoundingBoxAscent:be.fontBoundingBoxAscent,fontBoundingBoxDescent:be.fontBoundingBoxDescent,hangingBaseline:be.hangingBaseline,ideographicBaseline:be.ideographicBaseline,width:be.width,height:we}}_getContextFont(){return this.fontStyle()+P+this.fontVariant()+P+(this.fontSize()+A)+U(this.fontFamily())}_addTextLine(ye){this.align()===f&&(ye=ye.trim());var we=this._getTextWidth(ye);return this.textArr.push({text:ye,width:we,lastInParagraph:!1})}_getTextWidth(ye){var ce=this.letterSpacing(),we=ye.length;return X().measureText(ye).width+(we?ce*(we-1):0)}_setTextData(){var ye=this.text().split(`
`),ce=+this.fontSize(),we=0,be=this.lineHeight()*ce,se=this.attrs.width,ae=this.attrs.height,Q=se!==l&&se!==void 0,z=ae!==l&&ae!==void 0,j=this.padding(),te=se-j*2,W=ae-j*2,Z=0,he=this.wrap(),pe=he!==D,_e=he!==E&&pe,Re=this.ellipsis();this.textArr=[],X().font=this._getContextFont();for(var ie=Re?this._getTextWidth($):0,q=0,me=ye.length;q<me;++q){var ve=ye[q],Te=this._getTextWidth(ve);if(Q&&Te>te)for(;ve.length>0;){for(var ke=0,He=ve.length,Ue="",We=0;ke<He;){var ct=ke+He>>>1,Ye=ve.slice(0,ct+1),lt=this._getTextWidth(Ye)+ie;lt<=te?(ke=ct+1,Ue=Ye,We=lt):He=ct}if(Ue){if(_e){var Lt,Bt=ve[Ue.length],gt=Bt===P||Bt===v;gt&&We<=te?Lt=Ue.length:Lt=Math.max(Ue.lastIndexOf(P),Ue.lastIndexOf(v))+1,Lt>0&&(ke=Lt,Ue=Ue.slice(0,ke),We=this._getTextWidth(Ue))}Ue=Ue.trimRight(),this._addTextLine(Ue),we=Math.max(we,We),Z+=be;var ei=this._shouldHandleEllipsis(Z);if(ei){this._tryToAddEllipsisToLastLine();break}if(ve=ve.slice(ke),ve=ve.trimLeft(),ve.length>0&&(Te=this._getTextWidth(ve),Te<=te)){this._addTextLine(ve),Z+=be,we=Math.max(we,Te);break}}else break}else this._addTextLine(ve),Z+=be,we=Math.max(we,Te),this._shouldHandleEllipsis(Z)&&q<me-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),z&&Z+be>W)break}this.textHeight=ce,this.textWidth=we}_shouldHandleEllipsis(ye){var ce=+this.fontSize(),we=this.lineHeight()*ce,be=this.attrs.height,se=be!==l&&be!==void 0,ae=this.padding(),Q=be-ae*2,z=this.wrap(),j=z!==D;return!j||se&&ye+we>Q}_tryToAddEllipsisToLastLine(){var ye=this.attrs.width,ce=ye!==l&&ye!==void 0,we=this.padding(),be=ye-we*2,se=this.ellipsis(),ae=this.textArr[this.textArr.length-1];if(!(!ae||!se)){if(ce){var Q=this._getTextWidth(ae.text+$)<be;Q||(ae.text=ae.text.slice(0,ae.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(ae.text+$)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const ye=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,ce=this.hasShadow();return ye&&ce?!0:super._useBufferCanvas()}}return nf.Text=ne,ne.prototype._fillFunc=H,ne.prototype._strokeFunc=J,ne.prototype.className=w,ne.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,o._registerNode)(ne),e.Factory.overWriteSetter(ne,"width",(0,s.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(ne,"height",(0,s.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(ne,"direction",u),e.Factory.addGetterSetter(ne,"fontFamily","Arial"),e.Factory.addGetterSetter(ne,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(ne,"fontStyle",T),e.Factory.addGetterSetter(ne,"fontVariant",T),e.Factory.addGetterSetter(ne,"padding",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(ne,"align",y),e.Factory.addGetterSetter(ne,"verticalAlign",S),e.Factory.addGetterSetter(ne,"lineHeight",1,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(ne,"wrap",R),e.Factory.addGetterSetter(ne,"ellipsis",!1,(0,s.getBooleanValidator)()),e.Factory.addGetterSetter(ne,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(ne,"text","",(0,s.getStringValidator)()),e.Factory.addGetterSetter(ne,"textDecoration",""),nf}var Gv={},UV;function _ke(){if(UV)return Gv;UV=1,Object.defineProperty(Gv,"__esModule",{value:!0}),Gv.TextPath=void 0;const r=dr(),e=Ui(),n=os(),i=r5(),s=pj(),o=Hi(),a=$i();var l="",h="normal";function u(m){m.fillText(this.partialText,0,0)}function f(m){m.strokeText(this.partialText,0,0)}let p=class extends n.Shape{constructor(v){super(v),this.dummyCanvas=r.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(v){if(!this.attrs.data)return null;const y=this.pathLength;return v-1>y?null:i.Path.getPointAtLengthOfDataArray(v,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(v){v.setAttr("font",this._getContextFont()),v.setAttr("textBaseline",this.textBaseline()),v.setAttr("textAlign","left"),v.save();var y=this.textDecoration(),x=this.fill(),w=this.fontSize(),S=this.glyphInfo;y==="underline"&&v.beginPath();for(var O=0;O<S.length;O++){v.save();var _=S[O].p0;v.translate(_.x,_.y),v.rotate(S[O].rotation),this.partialText=S[O].text,v.fillStrokeShape(this),y==="underline"&&(O===0&&v.moveTo(0,w/2+1),v.lineTo(w,w/2+1)),v.restore()}y==="underline"&&(v.strokeStyle=x,v.lineWidth=w/20,v.stroke()),v.restore()}_hitFunc(v){v.beginPath();var y=this.glyphInfo;if(y.length>=1){var x=y[0].p0;v.moveTo(x.x,x.y)}for(var w=0;w<y.length;w++){var S=y[w].p1;v.lineTo(S.x,S.y)}v.setAttr("lineWidth",this.fontSize()),v.setAttr("strokeStyle",this.colorKey),v.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return r.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(v){return s.Text.prototype.setText.call(this,v)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(v){var y=this.dummyCanvas,x=y.getContext("2d");x.save(),x.font=this._getContextFont();var w=x.measureText(v);return x.restore(),{width:w.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:v,height:y}=this._getTextSize(this.attrs.text);if(this.textWidth=v,this.textHeight=y,this.glyphInfo=[],!this.attrs.data)return null;const x=this.letterSpacing(),w=this.align(),S=this.kerningFunc(),O=Math.max(this.textWidth+((this.attrs.text||"").length-1)*x,0);let _=0;w==="center"&&(_=Math.max(0,this.pathLength/2-O/2)),w==="right"&&(_=Math.max(0,this.pathLength-O));const T=(0,s.stringToArray)(this.text());let A=_;for(var P=0;P<T.length;P++){const N=this._getPointAtLength(A);if(!N)return;let k=this._getTextSize(T[P]).width+x;if(T[P]===" "&&w==="justify"){const L=this.text().split(" ").length-1;k+=(this.pathLength-O)/L}const R=this._getPointAtLength(A+k);if(!R)return;const E=i.Path.getLineLength(N.x,N.y,R.x,R.y);let D=0;if(S)try{D=S(T[P-1],T[P])*this.fontSize()}catch{D=0}N.x+=D,R.x+=D,this.textWidth+=D;const $=i.Path.getPointOnLine(D+E/2,N.x,N.y,R.x,R.y),I=Math.atan2(R.y-N.y,R.x-N.x);this.glyphInfo.push({transposeX:$.x,transposeY:$.y,text:T[P],rotation:I,p0:N,p1:R}),A+=k}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var v=[];this.glyphInfo.forEach(function(P){v.push(P.p0.x),v.push(P.p0.y),v.push(P.p1.x),v.push(P.p1.y)});for(var y=v[0]||0,x=v[0]||0,w=v[1]||0,S=v[1]||0,O,_,T=0;T<v.length/2;T++)O=v[T*2],_=v[T*2+1],y=Math.min(y,O),x=Math.max(x,O),w=Math.min(w,_),S=Math.max(S,_);var A=this.fontSize();return{x:y-A/2,y:w-A/2,width:x-y+A,height:S-w+A}}destroy(){return r.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Gv.TextPath=p,p.prototype._fillFunc=u,p.prototype._strokeFunc=f,p.prototype._fillFuncHit=u,p.prototype._strokeFuncHit=f,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,a._registerNode)(p),e.Factory.addGetterSetter(p,"data"),e.Factory.addGetterSetter(p,"fontFamily","Arial"),e.Factory.addGetterSetter(p,"fontSize",12,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(p,"fontStyle",h),e.Factory.addGetterSetter(p,"align","left"),e.Factory.addGetterSetter(p,"letterSpacing",0,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(p,"textBaseline","middle"),e.Factory.addGetterSetter(p,"fontVariant",h),e.Factory.addGetterSetter(p,"text",l),e.Factory.addGetterSetter(p,"textDecoration",null),e.Factory.addGetterSetter(p,"kerningFunc",null),Gv}var Hv={},VV;function Oke(){if(VV)return Hv;VV=1,Object.defineProperty(Hv,"__esModule",{value:!0}),Hv.Transformer=void 0;const r=dr(),e=Ui(),n=yr(),i=os(),s=fj(),o=i5(),a=$i(),l=Hi(),h=$i();var u="tr-konva",f=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(R=>R+`.${u}`).join(" "),p="nodesRect",m=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],v={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const y="ontouchstart"in a.Konva._global;function x(R,E,D){if(R==="rotater")return D;E+=r.Util.degToRad(v[R]||0);var $=(r.Util.radToDeg(E)%360+360)%360;return r.Util._inRange($,315+22.5,360)||r.Util._inRange($,0,22.5)?"ns-resize":r.Util._inRange($,45-22.5,45+22.5)?"nesw-resize":r.Util._inRange($,90-22.5,90+22.5)?"ew-resize":r.Util._inRange($,135-22.5,135+22.5)?"nwse-resize":r.Util._inRange($,180-22.5,180+22.5)?"ns-resize":r.Util._inRange($,225-22.5,225+22.5)?"nesw-resize":r.Util._inRange($,270-22.5,270+22.5)?"ew-resize":r.Util._inRange($,315-22.5,315+22.5)?"nwse-resize":(r.Util.error("Transformer has unknown angle for cursor detection: "+$),"pointer")}var w=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],S=1e8;function O(R){return{x:R.x+R.width/2*Math.cos(R.rotation)+R.height/2*Math.sin(-R.rotation),y:R.y+R.height/2*Math.cos(R.rotation)+R.width/2*Math.sin(R.rotation)}}function _(R,E,D){const $=D.x+(R.x-D.x)*Math.cos(E)-(R.y-D.y)*Math.sin(E),I=D.y+(R.x-D.x)*Math.sin(E)+(R.y-D.y)*Math.cos(E);return{...R,rotation:R.rotation+E,x:$,y:I}}function T(R,E){const D=O(R);return _(R,E,D)}function A(R,E,D){let $=E;for(let I=0;I<R.length;I++){const L=a.Konva.getAngle(R[I]),U=Math.abs(L-E)%(Math.PI*2);Math.min(U,Math.PI*2-U)<D&&($=L)}return $}let P=0,N=class extends o.Group{constructor(E){super(E),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(f,this.update),this.getNode()&&this.update()}attachTo(E){return this.setNode(E),this}setNode(E){return r.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([E])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(E=[]){this._nodes&&this._nodes.length&&this.detach();const D=E.filter(I=>I.isAncestorOf(this)?(r.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=E=D,E.length===1&&this.useSingleNodeRotation()?this.rotation(E[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(I=>{const L=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},U=I._attrsAffectingSize.map(V=>V+"Change."+this._getEventNamespace()).join(" ");I.on(U,L),I.on(m.map(V=>V+`.${this._getEventNamespace()}`).join(" "),L),I.on(`absoluteTransformChange.${this._getEventNamespace()}`,L),this._proxyDrag(I)}),this._resetTransformCache();var $=!!this.findOne(".top-left");return $&&this.update(),this}_proxyDrag(E){let D;E.on(`dragstart.${this._getEventNamespace()}`,$=>{D=E.getAbsolutePosition(),!this.isDragging()&&E!==this.findOne(".back")&&this.startDrag($,!1)}),E.on(`dragmove.${this._getEventNamespace()}`,$=>{if(!D)return;const I=E.getAbsolutePosition(),L=I.x-D.x,U=I.y-D.y;this.nodes().forEach(V=>{if(V===E||V.isDragging())return;const X=V.getAbsolutePosition();V.setAbsolutePosition({x:X.x+L,y:X.y+U}),V.startDrag($)}),D=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(E=>{E.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(E,D=this.rotation(),$){var I=E.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),L=E.getAbsoluteScale($),U=E.getAbsolutePosition($),V=I.x*L.x-E.offsetX()*L.x,X=I.y*L.y-E.offsetY()*L.y;const H=(a.Konva.getAngle(E.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),J={x:U.x+V*Math.cos(H)+X*Math.sin(-H),y:U.y+X*Math.cos(H)+V*Math.sin(H),width:I.width*L.x,height:I.height*L.y,rotation:H};return _(J,-a.Konva.getAngle(D),{x:0,y:0})}__getNodeRect(){var E=this.getNode();if(!E)return{x:-S,y:-S,width:0,height:0,rotation:0};const D=[];this.nodes().map(H=>{const J=H.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var ee=[{x:J.x,y:J.y},{x:J.x+J.width,y:J.y},{x:J.x+J.width,y:J.y+J.height},{x:J.x,y:J.y+J.height}],ne=H.getAbsoluteTransform();ee.forEach(function(ge){var ye=ne.point(ge);D.push(ye)})});const $=new r.Transform;$.rotate(-a.Konva.getAngle(this.rotation()));var I=1/0,L=1/0,U=-1/0,V=-1/0;D.forEach(function(H){var J=$.point(H);I===void 0&&(I=U=J.x,L=V=J.y),I=Math.min(I,J.x),L=Math.min(L,J.y),U=Math.max(U,J.x),V=Math.max(V,J.y)}),$.invert();const X=$.point({x:I,y:L});return{x:X.x,y:X.y,width:U-I,height:V-L,rotation:a.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),w.forEach(E=>{this._createAnchor(E)}),this._createAnchor("rotater")}_createAnchor(E){var D=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:E+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:y?10:"auto"}),$=this;D.on("mousedown touchstart",function(I){$._handleMouseDown(I)}),D.on("dragstart",I=>{D.stopDrag(),I.cancelBubble=!0}),D.on("dragend",I=>{I.cancelBubble=!0}),D.on("mouseenter",()=>{var I=a.Konva.getAngle(this.rotation()),L=this.rotateAnchorCursor(),U=x(E,I,L);D.getStage().content&&(D.getStage().content.style.cursor=U),this._cursorChange=!0}),D.on("mouseout",()=>{D.getStage().content&&(D.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(D)}_createBack(){var E=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(D,$){var I=$.getParent(),L=I.padding();D.beginPath(),D.rect(-L,-L,$.width()+L*2,$.height()+L*2),D.moveTo($.width()/2,-L),I.rotateEnabled()&&I.rotateLineVisible()&&D.lineTo($.width()/2,-I.rotateAnchorOffset()*r.Util._sign($.height())-L),D.fillStrokeShape($)},hitFunc:(D,$)=>{if(this.shouldOverdrawWholeArea()){var I=this.padding();D.beginPath(),D.rect(-I,-I,$.width()+I*2,$.height()+I*2),D.fillStrokeShape($)}}});this.add(E),this._proxyDrag(E),E.on("dragstart",D=>{D.cancelBubble=!0}),E.on("dragmove",D=>{D.cancelBubble=!0}),E.on("dragend",D=>{D.cancelBubble=!0}),this.on("dragmove",D=>{this.update()})}_handleMouseDown(E){if(!this._transforming){this._movingAnchorName=E.target.name().split(" ")[0];var D=this._getNodeRect(),$=D.width,I=D.height,L=Math.sqrt(Math.pow($,2)+Math.pow(I,2));this.sin=Math.abs(I/L),this.cos=Math.abs($/L),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var U=E.target.getAbsolutePosition(),V=E.target.getStage().getPointerPosition();this._anchorDragOffset={x:V.x-U.x,y:V.y-U.y},P++,this._fire("transformstart",{evt:E.evt,target:this.getNode()}),this._nodes.forEach(X=>{X._fire("transformstart",{evt:E.evt,target:X})})}}_handleMouseMove(E){var D,$,I,L=this.findOne("."+this._movingAnchorName),U=L.getStage();U.setPointersPositions(E);const V=U.getPointerPosition();let X={x:V.x-this._anchorDragOffset.x,y:V.y-this._anchorDragOffset.y};const H=L.getAbsolutePosition();this.anchorDragBoundFunc()&&(X=this.anchorDragBoundFunc()(H,X,E)),L.setAbsolutePosition(X);const J=L.getAbsolutePosition();if(!(H.x===J.x&&H.y===J.y)){if(this._movingAnchorName==="rotater"){var ee=this._getNodeRect();D=L.x()-ee.width/2,$=-L.y()+ee.height/2;let Re=Math.atan2(-$,D)+Math.PI/2;ee.height<0&&(Re-=Math.PI);var ne=a.Konva.getAngle(this.rotation());const ie=ne+Re,q=a.Konva.getAngle(this.rotationSnapTolerance()),ve=A(this.rotationSnaps(),ie,q)-ee.rotation,Te=T(ee,ve);this._fitNodesInto(Te,E);return}var ge=this.shiftBehavior(),ye;ge==="inverted"?ye=this.keepRatio()&&!E.shiftKey:ge==="none"?ye=this.keepRatio():ye=this.keepRatio()||E.shiftKey;var ae=this.centeredScaling()||E.altKey;if(this._movingAnchorName==="top-left"){if(ye){var ce=ae?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};I=Math.sqrt(Math.pow(ce.x-L.x(),2)+Math.pow(ce.y-L.y(),2));var we=this.findOne(".top-left").x()>ce.x?-1:1,be=this.findOne(".top-left").y()>ce.y?-1:1;D=I*this.cos*we,$=I*this.sin*be,this.findOne(".top-left").x(ce.x-D),this.findOne(".top-left").y(ce.y-$)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(L.y());else if(this._movingAnchorName==="top-right"){if(ye){var ce=ae?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};I=Math.sqrt(Math.pow(L.x()-ce.x,2)+Math.pow(ce.y-L.y(),2));var we=this.findOne(".top-right").x()<ce.x?-1:1,be=this.findOne(".top-right").y()>ce.y?-1:1;D=I*this.cos*we,$=I*this.sin*be,this.findOne(".top-right").x(ce.x+D),this.findOne(".top-right").y(ce.y-$)}var se=L.position();this.findOne(".top-left").y(se.y),this.findOne(".bottom-right").x(se.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(L.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(L.x());else if(this._movingAnchorName==="bottom-left"){if(ye){var ce=ae?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};I=Math.sqrt(Math.pow(ce.x-L.x(),2)+Math.pow(L.y()-ce.y,2));var we=ce.x<L.x()?-1:1,be=L.y()<ce.y?-1:1;D=I*this.cos*we,$=I*this.sin*be,L.x(ce.x-D),L.y(ce.y+$)}se=L.position(),this.findOne(".top-left").x(se.x),this.findOne(".bottom-right").y(se.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(L.y());else if(this._movingAnchorName==="bottom-right"){if(ye){var ce=ae?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};I=Math.sqrt(Math.pow(L.x()-ce.x,2)+Math.pow(L.y()-ce.y,2));var we=this.findOne(".bottom-right").x()<ce.x?-1:1,be=this.findOne(".bottom-right").y()<ce.y?-1:1;D=I*this.cos*we,$=I*this.sin*be,this.findOne(".bottom-right").x(ce.x+D),this.findOne(".bottom-right").y(ce.y+$)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var ae=this.centeredScaling()||E.altKey;if(ae){var Q=this.findOne(".top-left"),z=this.findOne(".bottom-right"),j=Q.x(),te=Q.y(),W=this.getWidth()-z.x(),Z=this.getHeight()-z.y();z.move({x:-j,y:-te}),Q.move({x:W,y:Z})}var he=this.findOne(".top-left").getAbsolutePosition();D=he.x,$=he.y;var pe=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),_e=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:D,y:$,width:pe,height:_e,rotation:a.Konva.getAngle(this.rotation())},E)}}_handleMouseUp(E){this._removeEvents(E)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(E){var D;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var $=this.getNode();P--,this._fire("transformend",{evt:E,target:$}),(D=this.getLayer())===null||D===void 0||D.batchDraw(),$&&this._nodes.forEach(I=>{var L;I._fire("transformend",{evt:E,target:I}),(L=I.getLayer())===null||L===void 0||L.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(E,D){var $=this._getNodeRect();const I=1;if(r.Util._inRange(E.width,-this.padding()*2-I,I)){this.update();return}if(r.Util._inRange(E.height,-this.padding()*2-I,I)){this.update();return}var L=new r.Transform;if(L.rotate(a.Konva.getAngle(this.rotation())),this._movingAnchorName&&E.width<0&&this._movingAnchorName.indexOf("left")>=0){const ne=L.point({x:-this.padding()*2,y:0});E.x+=ne.x,E.y+=ne.y,E.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=ne.x,this._anchorDragOffset.y-=ne.y}else if(this._movingAnchorName&&E.width<0&&this._movingAnchorName.indexOf("right")>=0){const ne=L.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=ne.x,this._anchorDragOffset.y-=ne.y,E.width+=this.padding()*2}if(this._movingAnchorName&&E.height<0&&this._movingAnchorName.indexOf("top")>=0){const ne=L.point({x:0,y:-this.padding()*2});E.x+=ne.x,E.y+=ne.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=ne.x,this._anchorDragOffset.y-=ne.y,E.height+=this.padding()*2}else if(this._movingAnchorName&&E.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const ne=L.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=ne.x,this._anchorDragOffset.y-=ne.y,E.height+=this.padding()*2}if(this.boundBoxFunc()){const ne=this.boundBoxFunc()($,E);ne?E=ne:r.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const U=1e7,V=new r.Transform;V.translate($.x,$.y),V.rotate($.rotation),V.scale($.width/U,$.height/U);const X=new r.Transform,H=E.width/U,J=E.height/U;this.flipEnabled()===!1?(X.translate(E.x,E.y),X.rotate(E.rotation),X.translate(E.width<0?E.width:0,E.height<0?E.height:0),X.scale(Math.abs(H),Math.abs(J))):(X.translate(E.x,E.y),X.rotate(E.rotation),X.scale(H,J));const ee=X.multiply(V.invert());this._nodes.forEach(ne=>{var ge;const ye=ne.getParent().getAbsoluteTransform(),ce=ne.getTransform().copy();ce.translate(ne.offsetX(),ne.offsetY());const we=new r.Transform;we.multiply(ye.copy().invert()).multiply(ee).multiply(ye).multiply(ce);const be=we.decompose();ne.setAttrs(be),(ge=ne.getLayer())===null||ge===void 0||ge.batchDraw()}),this.rotation(r.Util._getRotation(E.rotation)),this._nodes.forEach(ne=>{this._fire("transform",{evt:D,target:ne}),ne._fire("transform",{evt:D,target:ne})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(E,D){this.findOne(E).setAttrs(D)}update(){var E,D=this._getNodeRect();this.rotation(r.Util._getRotation(D.rotation));var $=D.width,I=D.height,L=this.enabledAnchors(),U=this.resizeEnabled(),V=this.padding(),X=this.anchorSize();const H=this.find("._anchor");H.forEach(ee=>{ee.setAttrs({width:X,height:X,offsetX:X/2,offsetY:X/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:X/2+V,offsetY:X/2+V,visible:U&&L.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:$/2,y:0,offsetY:X/2+V,visible:U&&L.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:$,y:0,offsetX:X/2-V,offsetY:X/2+V,visible:U&&L.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:I/2,offsetX:X/2+V,visible:U&&L.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:$,y:I/2,offsetX:X/2-V,visible:U&&L.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:I,offsetX:X/2+V,offsetY:X/2-V,visible:U&&L.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:$/2,y:I,offsetY:X/2-V,visible:U&&L.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:$,y:I,offsetX:X/2-V,offsetY:X/2-V,visible:U&&L.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:$/2,y:-this.rotateAnchorOffset()*r.Util._sign(I)-V,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:$,height:I,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const J=this.anchorStyleFunc();J&&H.forEach(ee=>{J(ee)}),(E=this.getLayer())===null||E===void 0||E.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var E=this.findOne("."+this._movingAnchorName);E&&E.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),o.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(E){var D=n.Node.prototype.clone.call(this,E);return D}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Hv.Transformer=N,N.isTransforming=()=>P>0;function k(R){return R instanceof Array||r.Util.warn("enabledAnchors value should be an array"),R instanceof Array&&R.forEach(function(E){w.indexOf(E)===-1&&r.Util.warn("Unknown anchor name: "+E+". Available names are: "+w.join(", "))}),R||[]}return N.prototype.className="Transformer",(0,h._registerNode)(N),e.Factory.addGetterSetter(N,"enabledAnchors",w,k),e.Factory.addGetterSetter(N,"flipEnabled",!0,(0,l.getBooleanValidator)()),e.Factory.addGetterSetter(N,"resizeEnabled",!0),e.Factory.addGetterSetter(N,"anchorSize",10,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(N,"rotateEnabled",!0),e.Factory.addGetterSetter(N,"rotateLineVisible",!0),e.Factory.addGetterSetter(N,"rotationSnaps",[]),e.Factory.addGetterSetter(N,"rotateAnchorOffset",50,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(N,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(N,"rotationSnapTolerance",5,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(N,"borderEnabled",!0),e.Factory.addGetterSetter(N,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(N,"anchorStrokeWidth",1,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(N,"anchorFill","white"),e.Factory.addGetterSetter(N,"anchorCornerRadius",0,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(N,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(N,"borderStrokeWidth",1,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(N,"borderDash"),e.Factory.addGetterSetter(N,"keepRatio",!0),e.Factory.addGetterSetter(N,"shiftBehavior","default"),e.Factory.addGetterSetter(N,"centeredScaling",!1),e.Factory.addGetterSetter(N,"ignoreStroke",!1),e.Factory.addGetterSetter(N,"padding",0,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(N,"node"),e.Factory.addGetterSetter(N,"nodes"),e.Factory.addGetterSetter(N,"boundBoxFunc"),e.Factory.addGetterSetter(N,"anchorDragBoundFunc"),e.Factory.addGetterSetter(N,"anchorStyleFunc"),e.Factory.addGetterSetter(N,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(N,"useSingleNodeRotation",!0),e.Factory.backCompat(N,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Hv}var Qv={},FV;function Ske(){if(FV)return Qv;FV=1,Object.defineProperty(Qv,"__esModule",{value:!0}),Qv.Wedge=void 0;const r=Ui(),e=os(),n=$i(),i=Hi(),s=$i();let o=class extends e.Shape{_sceneFunc(l){l.beginPath(),l.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),l.lineTo(0,0),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(l){this.radius(l/2)}setHeight(l){this.radius(l/2)}};return Qv.Wedge=o,o.prototype.className="Wedge",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(o),r.Factory.addGetterSetter(o,"radius",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(o,"angle",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(o,"clockwise",!1),r.Factory.backCompat(o,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Qv}var jv={},zV;function Cke(){if(zV)return jv;zV=1,Object.defineProperty(jv,"__esModule",{value:!0}),jv.Blur=void 0;const r=Ui(),e=yr(),n=Hi();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function a(h,u){var f=h.data,p=h.width,m=h.height,v,y,x,w,S,O,_,T,A,P,N,k,R,E,D,$,I,L,U,V,X,H,J,ee,ne=u+u+1,ge=p-1,ye=m-1,ce=u+1,we=ce*(ce+1)/2,be=new i,se=null,ae=be,Q=null,z=null,j=s[u],te=o[u];for(x=1;x<ne;x++)ae=ae.next=new i,x===ce&&(se=ae);for(ae.next=be,_=O=0,y=0;y<m;y++){for($=I=L=U=T=A=P=N=0,k=ce*(V=f[O]),R=ce*(X=f[O+1]),E=ce*(H=f[O+2]),D=ce*(J=f[O+3]),T+=we*V,A+=we*X,P+=we*H,N+=we*J,ae=be,x=0;x<ce;x++)ae.r=V,ae.g=X,ae.b=H,ae.a=J,ae=ae.next;for(x=1;x<ce;x++)w=O+((ge<x?ge:x)<<2),T+=(ae.r=V=f[w])*(ee=ce-x),A+=(ae.g=X=f[w+1])*ee,P+=(ae.b=H=f[w+2])*ee,N+=(ae.a=J=f[w+3])*ee,$+=V,I+=X,L+=H,U+=J,ae=ae.next;for(Q=be,z=se,v=0;v<p;v++)f[O+3]=J=N*j>>te,J!==0?(J=255/J,f[O]=(T*j>>te)*J,f[O+1]=(A*j>>te)*J,f[O+2]=(P*j>>te)*J):f[O]=f[O+1]=f[O+2]=0,T-=k,A-=R,P-=E,N-=D,k-=Q.r,R-=Q.g,E-=Q.b,D-=Q.a,w=_+((w=v+u+1)<ge?w:ge)<<2,$+=Q.r=f[w],I+=Q.g=f[w+1],L+=Q.b=f[w+2],U+=Q.a=f[w+3],T+=$,A+=I,P+=L,N+=U,Q=Q.next,k+=V=z.r,R+=X=z.g,E+=H=z.b,D+=J=z.a,$-=V,I-=X,L-=H,U-=J,z=z.next,O+=4;_+=p}for(v=0;v<p;v++){for(I=L=U=$=A=P=N=T=0,O=v<<2,k=ce*(V=f[O]),R=ce*(X=f[O+1]),E=ce*(H=f[O+2]),D=ce*(J=f[O+3]),T+=we*V,A+=we*X,P+=we*H,N+=we*J,ae=be,x=0;x<ce;x++)ae.r=V,ae.g=X,ae.b=H,ae.a=J,ae=ae.next;for(S=p,x=1;x<=u;x++)O=S+v<<2,T+=(ae.r=V=f[O])*(ee=ce-x),A+=(ae.g=X=f[O+1])*ee,P+=(ae.b=H=f[O+2])*ee,N+=(ae.a=J=f[O+3])*ee,$+=V,I+=X,L+=H,U+=J,ae=ae.next,x<ye&&(S+=p);for(O=v,Q=be,z=se,y=0;y<m;y++)w=O<<2,f[w+3]=J=N*j>>te,J>0?(J=255/J,f[w]=(T*j>>te)*J,f[w+1]=(A*j>>te)*J,f[w+2]=(P*j>>te)*J):f[w]=f[w+1]=f[w+2]=0,T-=k,A-=R,P-=E,N-=D,k-=Q.r,R-=Q.g,E-=Q.b,D-=Q.a,w=v+((w=y+ce)<ye?w:ye)*p<<2,T+=$+=Q.r=f[w],A+=I+=Q.g=f[w+1],P+=L+=Q.b=f[w+2],N+=U+=Q.a=f[w+3],Q=Q.next,k+=V=z.r,R+=X=z.g,E+=H=z.b,D+=J=z.a,$-=V,I-=X,L-=H,U-=J,z=z.next,O+=p}}const l=function(u){var f=Math.round(this.blurRadius());f>0&&a(u,f)};return jv.Blur=l,r.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),jv}var Yv={},XV;function Tke(){if(XV)return Yv;XV=1,Object.defineProperty(Yv,"__esModule",{value:!0}),Yv.Brighten=void 0;const r=Ui(),e=yr(),n=Hi(),i=function(s){var o=this.brightness()*255,a=s.data,l=a.length,h;for(h=0;h<l;h+=4)a[h]+=o,a[h+1]+=o,a[h+2]+=o};return Yv.Brighten=i,r.Factory.addGetterSetter(e.Node,"brightness",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),Yv}var qv={},WV;function Eke(){if(WV)return qv;WV=1,Object.defineProperty(qv,"__esModule",{value:!0}),qv.Contrast=void 0;const r=Ui(),e=yr(),n=Hi(),i=function(s){var o=Math.pow((this.contrast()+100)/100,2),a=s.data,l=a.length,h=150,u=150,f=150,p;for(p=0;p<l;p+=4)h=a[p],u=a[p+1],f=a[p+2],h/=255,h-=.5,h*=o,h+=.5,h*=255,u/=255,u-=.5,u*=o,u+=.5,u*=255,f/=255,f-=.5,f*=o,f+=.5,f*=255,h=h<0?0:h>255?255:h,u=u<0?0:u>255?255:u,f=f<0?0:f>255?255:f,a[p]=h,a[p+1]=u,a[p+2]=f};return qv.Contrast=i,r.Factory.addGetterSetter(e.Node,"contrast",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),qv}var Zv={},GV;function Mke(){if(GV)return Zv;GV=1,Object.defineProperty(Zv,"__esModule",{value:!0}),Zv.Emboss=void 0;const r=Ui(),e=yr(),n=dr(),i=Hi(),s=function(o){var a=this.embossStrength()*10,l=this.embossWhiteLevel()*255,h=this.embossDirection(),u=this.embossBlend(),f=0,p=0,m=o.data,v=o.width,y=o.height,x=v*4,w=y;switch(h){case"top-left":f=-1,p=-1;break;case"top":f=-1,p=0;break;case"top-right":f=-1,p=1;break;case"right":f=0,p=1;break;case"bottom-right":f=1,p=1;break;case"bottom":f=1,p=0;break;case"bottom-left":f=1,p=-1;break;case"left":f=0,p=-1;break;default:n.Util.error("Unknown emboss direction: "+h)}do{var S=(w-1)*x,O=f;w+O<1&&(O=0),w+O>y&&(O=0);var _=(w-1+O)*v*4,T=v;do{var A=S+(T-1)*4,P=p;T+P<1&&(P=0),T+P>v&&(P=0);var N=_+(T-1+P)*4,k=m[A]-m[N],R=m[A+1]-m[N+1],E=m[A+2]-m[N+2],D=k,$=D>0?D:-D,I=R>0?R:-R,L=E>0?E:-E;if(I>$&&(D=R),L>$&&(D=E),D*=a,u){var U=m[A]+D,V=m[A+1]+D,X=m[A+2]+D;m[A]=U>255?255:U<0?0:U,m[A+1]=V>255?255:V<0?0:V,m[A+2]=X>255?255:X<0?0:X}else{var H=l-D;H<0?H=0:H>255&&(H=255),m[A]=m[A+1]=m[A+2]=H}}while(--T)}while(--w)};return Zv.Emboss=s,r.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"embossDirection","top-left",null,r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"embossBlend",!1,null,r.Factory.afterSetFilter),Zv}var Kv={},HV;function Ake(){if(HV)return Kv;HV=1,Object.defineProperty(Kv,"__esModule",{value:!0}),Kv.Enhance=void 0;const r=Ui(),e=yr(),n=Hi();function i(o,a,l,h,u){var f=l-a,p=u-h,m;return f===0?h+p/2:p===0?h:(m=(o-a)/f,m=p*m+h,m)}const s=function(o){var a=o.data,l=a.length,h=a[0],u=h,f,p=a[1],m=p,v,y=a[2],x=y,w,S,O=this.enhance();if(O!==0){for(S=0;S<l;S+=4)f=a[S+0],f<h?h=f:f>u&&(u=f),v=a[S+1],v<p?p=v:v>m&&(m=v),w=a[S+2],w<y?y=w:w>x&&(x=w);u===h&&(u=255,h=0),m===p&&(m=255,p=0),x===y&&(x=255,y=0);var _,T,A,P,N,k,R,E,D;for(O>0?(T=u+O*(255-u),A=h-O*(h-0),N=m+O*(255-m),k=p-O*(p-0),E=x+O*(255-x),D=y-O*(y-0)):(_=(u+h)*.5,T=u+O*(u-_),A=h+O*(h-_),P=(m+p)*.5,N=m+O*(m-P),k=p+O*(p-P),R=(x+y)*.5,E=x+O*(x-R),D=y+O*(y-R)),S=0;S<l;S+=4)a[S+0]=i(a[S+0],h,u,A,T),a[S+1]=i(a[S+1],p,m,k,N),a[S+2]=i(a[S+2],y,x,D,E)}};return Kv.Enhance=s,r.Factory.addGetterSetter(e.Node,"enhance",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),Kv}var Jv={},QV;function kke(){if(QV)return Jv;QV=1,Object.defineProperty(Jv,"__esModule",{value:!0}),Jv.Grayscale=void 0;const r=function(e){var n=e.data,i=n.length,s,o;for(s=0;s<i;s+=4)o=.34*n[s]+.5*n[s+1]+.16*n[s+2],n[s]=o,n[s+1]=o,n[s+2]=o};return Jv.Grayscale=r,Jv}var ey={},jV;function Pke(){if(jV)return ey;jV=1,Object.defineProperty(ey,"__esModule",{value:!0}),ey.HSL=void 0;const r=Ui(),e=yr(),n=Hi();r.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"luminance",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter);const i=function(s){var o=s.data,a=o.length,l=1,h=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,f=this.luminance()*127,p,m=l*h*Math.cos(u*Math.PI/180),v=l*h*Math.sin(u*Math.PI/180),y=.299*l+.701*m+.167*v,x=.587*l-.587*m+.33*v,w=.114*l-.114*m-.497*v,S=.299*l-.299*m-.328*v,O=.587*l+.413*m+.035*v,_=.114*l-.114*m+.293*v,T=.299*l-.3*m+1.25*v,A=.587*l-.586*m-1.05*v,P=.114*l+.886*m-.2*v,N,k,R,E;for(p=0;p<a;p+=4)N=o[p+0],k=o[p+1],R=o[p+2],E=o[p+3],o[p+0]=y*N+x*k+w*R+f,o[p+1]=S*N+O*k+_*R+f,o[p+2]=T*N+A*k+P*R+f,o[p+3]=E};return ey.HSL=i,ey}var ty={},YV;function Rke(){if(YV)return ty;YV=1,Object.defineProperty(ty,"__esModule",{value:!0}),ty.HSV=void 0;const r=Ui(),e=yr(),n=Hi(),i=function(s){var o=s.data,a=o.length,l=Math.pow(2,this.value()),h=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,f,p=l*h*Math.cos(u*Math.PI/180),m=l*h*Math.sin(u*Math.PI/180),v=.299*l+.701*p+.167*m,y=.587*l-.587*p+.33*m,x=.114*l-.114*p-.497*m,w=.299*l-.299*p-.328*m,S=.587*l+.413*p+.035*m,O=.114*l-.114*p+.293*m,_=.299*l-.3*p+1.25*m,T=.587*l-.586*p-1.05*m,A=.114*l+.886*p-.2*m,P,N,k,R;for(f=0;f<a;f+=4)P=o[f+0],N=o[f+1],k=o[f+2],R=o[f+3],o[f+0]=v*P+y*N+x*k,o[f+1]=w*P+S*N+O*k,o[f+2]=_*P+T*N+A*k,o[f+3]=R};return ty.HSV=i,r.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"value",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),ty}var iy={},qV;function Ike(){if(qV)return iy;qV=1,Object.defineProperty(iy,"__esModule",{value:!0}),iy.Invert=void 0;const r=function(e){var n=e.data,i=n.length,s;for(s=0;s<i;s+=4)n[s]=255-n[s],n[s+1]=255-n[s+1],n[s+2]=255-n[s+2]};return iy.Invert=r,iy}var ny={},ZV;function Nke(){if(ZV)return ny;ZV=1,Object.defineProperty(ny,"__esModule",{value:!0}),ny.Kaleidoscope=void 0;const r=Ui(),e=yr(),n=dr(),i=Hi();var s=function(l,h,u){var f=l.data,p=h.data,m=l.width,v=l.height,y=u.polarCenterX||m/2,x=u.polarCenterY||v/2,w,S,O,_=0,T=0,A=0,P=0,N,k=Math.sqrt(y*y+x*x);S=m-y,O=v-x,N=Math.sqrt(S*S+O*O),k=N>k?N:k;var R=v,E=m,D,$,I=360/E*Math.PI/180,L,U;for($=0;$<E;$+=1)for(L=Math.sin($*I),U=Math.cos($*I),D=0;D<R;D+=1)S=Math.floor(y+k*D/R*U),O=Math.floor(x+k*D/R*L),w=(O*m+S)*4,_=f[w+0],T=f[w+1],A=f[w+2],P=f[w+3],w=($+D*m)*4,p[w+0]=_,p[w+1]=T,p[w+2]=A,p[w+3]=P},o=function(l,h,u){var f=l.data,p=h.data,m=l.width,v=l.height,y=u.polarCenterX||m/2,x=u.polarCenterY||v/2,w,S,O,_,T,A=0,P=0,N=0,k=0,R,E=Math.sqrt(y*y+x*x);S=m-y,O=v-x,R=Math.sqrt(S*S+O*O),E=R>E?R:E;var D=v,$=m,I,L,U=0,V,X;for(S=0;S<m;S+=1)for(O=0;O<v;O+=1)_=S-y,T=O-x,I=Math.sqrt(_*_+T*T)*D/E,L=(Math.atan2(T,_)*180/Math.PI+360+U)%360,L=L*$/360,V=Math.floor(L),X=Math.floor(I),w=(X*m+V)*4,A=f[w+0],P=f[w+1],N=f[w+2],k=f[w+3],w=(O*m+S)*4,p[w+0]=A,p[w+1]=P,p[w+2]=N,p[w+3]=k};const a=function(l){var h=l.width,u=l.height,f,p,m,v,y,x,w,S,O,_,T=Math.round(this.kaleidoscopePower()),A=Math.round(this.kaleidoscopeAngle()),P=Math.floor(h*(A%360)/360);if(!(T<1)){var N=n.Util.createCanvasElement();N.width=h,N.height=u;var k=N.getContext("2d").getImageData(0,0,h,u);n.Util.releaseCanvas(N),s(l,k,{polarCenterX:h/2,polarCenterY:u/2});for(var R=h/Math.pow(2,T);R<=8;)R=R*2,T-=1;R=Math.ceil(R);var E=R,D=0,$=E,I=1;for(P+R>h&&(D=E,$=0,I=-1),p=0;p<u;p+=1)for(f=D;f!==$;f+=I)m=Math.round(f+P)%h,O=(h*p+m)*4,y=k.data[O+0],x=k.data[O+1],w=k.data[O+2],S=k.data[O+3],_=(h*p+f)*4,k.data[_+0]=y,k.data[_+1]=x,k.data[_+2]=w,k.data[_+3]=S;for(p=0;p<u;p+=1)for(E=Math.floor(R),v=0;v<T;v+=1){for(f=0;f<E+1;f+=1)O=(h*p+f)*4,y=k.data[O+0],x=k.data[O+1],w=k.data[O+2],S=k.data[O+3],_=(h*p+E*2-f-1)*4,k.data[_+0]=y,k.data[_+1]=x,k.data[_+2]=w,k.data[_+3]=S;E*=2}o(k,l,{polarRotation:0})}};return ny.Kaleidoscope=a,r.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),ny}var ry={},KV;function Dke(){if(KV)return ry;KV=1,Object.defineProperty(ry,"__esModule",{value:!0}),ry.Mask=void 0;const r=Ui(),e=yr(),n=Hi();function i(m,v,y){var x=(y*m.width+v)*4,w=[];return w.push(m.data[x++],m.data[x++],m.data[x++],m.data[x++]),w}function s(m,v){return Math.sqrt(Math.pow(m[0]-v[0],2)+Math.pow(m[1]-v[1],2)+Math.pow(m[2]-v[2],2))}function o(m){for(var v=[0,0,0],y=0;y<m.length;y++)v[0]+=m[y][0],v[1]+=m[y][1],v[2]+=m[y][2];return v[0]/=m.length,v[1]/=m.length,v[2]/=m.length,v}function a(m,v){var y=i(m,0,0),x=i(m,m.width-1,0),w=i(m,0,m.height-1),S=i(m,m.width-1,m.height-1),O=v||10;if(s(y,x)<O&&s(x,S)<O&&s(S,w)<O&&s(w,y)<O){for(var _=o([x,y,S,w]),T=[],A=0;A<m.width*m.height;A++){var P=s(_,[m.data[A*4],m.data[A*4+1],m.data[A*4+2]]);T[A]=P<O?0:255}return T}}function l(m,v){for(var y=0;y<m.width*m.height;y++)m.data[4*y+3]=v[y]}function h(m,v,y){for(var x=[1,1,1,1,0,1,1,1,1],w=Math.round(Math.sqrt(x.length)),S=Math.floor(w/2),O=[],_=0;_<y;_++)for(var T=0;T<v;T++){for(var A=_*v+T,P=0,N=0;N<w;N++)for(var k=0;k<w;k++){var R=_+N-S,E=T+k-S;if(R>=0&&R<y&&E>=0&&E<v){var D=R*v+E,$=x[N*w+k];P+=m[D]*$}}O[A]=P===255*8?255:0}return O}function u(m,v,y){for(var x=[1,1,1,1,1,1,1,1,1],w=Math.round(Math.sqrt(x.length)),S=Math.floor(w/2),O=[],_=0;_<y;_++)for(var T=0;T<v;T++){for(var A=_*v+T,P=0,N=0;N<w;N++)for(var k=0;k<w;k++){var R=_+N-S,E=T+k-S;if(R>=0&&R<y&&E>=0&&E<v){var D=R*v+E,$=x[N*w+k];P+=m[D]*$}}O[A]=P>=255*4?255:0}return O}function f(m,v,y){for(var x=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],w=Math.round(Math.sqrt(x.length)),S=Math.floor(w/2),O=[],_=0;_<y;_++)for(var T=0;T<v;T++){for(var A=_*v+T,P=0,N=0;N<w;N++)for(var k=0;k<w;k++){var R=_+N-S,E=T+k-S;if(R>=0&&R<y&&E>=0&&E<v){var D=R*v+E,$=x[N*w+k];P+=m[D]*$}}O[A]=P}return O}const p=function(m){var v=this.threshold(),y=a(m,v);return y&&(y=h(y,m.width,m.height),y=u(y,m.width,m.height),y=f(y,m.width,m.height),l(m,y)),m};return ry.Mask=p,r.Factory.addGetterSetter(e.Node,"threshold",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),ry}var sy={},JV;function Lke(){if(JV)return sy;JV=1,Object.defineProperty(sy,"__esModule",{value:!0}),sy.Noise=void 0;const r=Ui(),e=yr(),n=Hi(),i=function(s){var o=this.noise()*255,a=s.data,l=a.length,h=o/2,u;for(u=0;u<l;u+=4)a[u+0]+=h-2*h*Math.random(),a[u+1]+=h-2*h*Math.random(),a[u+2]+=h-2*h*Math.random()};return sy.Noise=i,r.Factory.addGetterSetter(e.Node,"noise",.2,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),sy}var oy={},e8;function Bke(){if(e8)return oy;e8=1,Object.defineProperty(oy,"__esModule",{value:!0}),oy.Pixelate=void 0;const r=Ui(),e=dr(),n=yr(),i=Hi(),s=function(o){var a=Math.ceil(this.pixelSize()),l=o.width,h=o.height,u,f,p,m,v,y,x,w=Math.ceil(l/a),S=Math.ceil(h/a),O,_,T,A,P,N,k,R=o.data;if(a<=0){e.Util.error("pixelSize value can not be <= 0");return}for(P=0;P<w;P+=1)for(N=0;N<S;N+=1){for(m=0,v=0,y=0,x=0,O=P*a,_=O+a,T=N*a,A=T+a,k=0,u=O;u<_;u+=1)if(!(u>=l))for(f=T;f<A;f+=1)f>=h||(p=(l*f+u)*4,m+=R[p+0],v+=R[p+1],y+=R[p+2],x+=R[p+3],k+=1);for(m=m/k,v=v/k,y=y/k,x=x/k,u=O;u<_;u+=1)if(!(u>=l))for(f=T;f<A;f+=1)f>=h||(p=(l*f+u)*4,R[p+0]=m,R[p+1]=v,R[p+2]=y,R[p+3]=x)}};return oy.Pixelate=s,r.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),oy}var ay={},t8;function $ke(){if(t8)return ay;t8=1,Object.defineProperty(ay,"__esModule",{value:!0}),ay.Posterize=void 0;const r=Ui(),e=yr(),n=Hi(),i=function(s){var o=Math.round(this.levels()*254)+1,a=s.data,l=a.length,h=255/o,u;for(u=0;u<l;u+=1)a[u]=Math.floor(a[u]/h)*h};return ay.Posterize=i,r.Factory.addGetterSetter(e.Node,"levels",.5,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),ay}var ly={},i8;function Uke(){if(i8)return ly;i8=1,Object.defineProperty(ly,"__esModule",{value:!0}),ly.RGB=void 0;const r=Ui(),e=yr(),n=Hi(),i=function(s){var o=s.data,a=o.length,l=this.red(),h=this.green(),u=this.blue(),f,p;for(f=0;f<a;f+=4)p=(.34*o[f]+.5*o[f+1]+.16*o[f+2])/255,o[f]=p*l,o[f+1]=p*h,o[f+2]=p*u,o[f+3]=o[f+3]};return ly.RGB=i,r.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),r.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),r.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,r.Factory.afterSetFilter),ly}var cy={},n8;function Vke(){if(n8)return cy;n8=1,Object.defineProperty(cy,"__esModule",{value:!0}),cy.RGBA=void 0;const r=Ui(),e=yr(),n=Hi(),i=function(s){var o=s.data,a=o.length,l=this.red(),h=this.green(),u=this.blue(),f=this.alpha(),p,m;for(p=0;p<a;p+=4)m=1-f,o[p]=l*f+o[p]*m,o[p+1]=h*f+o[p+1]*m,o[p+2]=u*f+o[p+2]*m};return cy.RGBA=i,r.Factory.addGetterSetter(e.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),r.Factory.addGetterSetter(e.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),r.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),cy}var hy={},r8;function Fke(){if(r8)return hy;r8=1,Object.defineProperty(hy,"__esModule",{value:!0}),hy.Sepia=void 0;const r=function(e){var n=e.data,i=n.length,s,o,a,l;for(s=0;s<i;s+=4)o=n[s+0],a=n[s+1],l=n[s+2],n[s+0]=Math.min(255,o*.393+a*.769+l*.189),n[s+1]=Math.min(255,o*.349+a*.686+l*.168),n[s+2]=Math.min(255,o*.272+a*.534+l*.131)};return hy.Sepia=r,hy}var uy={},s8;function zke(){if(s8)return uy;s8=1,Object.defineProperty(uy,"__esModule",{value:!0}),uy.Solarize=void 0;const r=function(e){var n=e.data,i=e.width,s=e.height,o=i*4,a=s;do{var l=(a-1)*o,h=i;do{var u=l+(h-1)*4,f=n[u],p=n[u+1],m=n[u+2];f>127&&(f=255-f),p>127&&(p=255-p),m>127&&(m=255-m),n[u]=f,n[u+1]=p,n[u+2]=m}while(--h)}while(--a)};return uy.Solarize=r,uy}var dy={},o8;function Xke(){if(o8)return dy;o8=1,Object.defineProperty(dy,"__esModule",{value:!0}),dy.Threshold=void 0;const r=Ui(),e=yr(),n=Hi(),i=function(s){var o=this.threshold()*255,a=s.data,l=a.length,h;for(h=0;h<l;h+=1)a[h]=a[h]<o?0:255};return dy.Threshold=i,r.Factory.addGetterSetter(e.Node,"threshold",.5,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),dy}var a8;function Wke(){if(a8)return Tv;a8=1,Object.defineProperty(Tv,"__esModule",{value:!0}),Tv.Konva=void 0;const r=uke(),e=dke(),n=pke(),i=mke(),s=gke(),o=vke(),a=dj(),l=uj(),h=r5(),u=fj(),f=yke(),p=bke(),m=xke(),v=wke(),y=pj(),x=_ke(),w=Oke(),S=Ske(),O=Cke(),_=Tke(),T=Eke(),A=Mke(),P=Ake(),N=kke(),k=Pke(),R=Rke(),E=Ike(),D=Nke(),$=Dke(),I=Lke(),L=Bke(),U=$ke(),V=Uke(),X=Vke(),H=Fke(),J=zke(),ee=Xke();return Tv.Konva=r.Konva.Util._assign(r.Konva,{Arc:e.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:s.Ellipse,Image:o.Image,Label:a.Label,Tag:a.Tag,Line:l.Line,Path:h.Path,Rect:u.Rect,RegularPolygon:f.RegularPolygon,Ring:p.Ring,Sprite:m.Sprite,Star:v.Star,Text:y.Text,TextPath:x.TextPath,Transformer:w.Transformer,Wedge:S.Wedge,Filters:{Blur:O.Blur,Brighten:_.Brighten,Contrast:T.Contrast,Emboss:A.Emboss,Enhance:P.Enhance,Grayscale:N.Grayscale,HSL:k.HSL,HSV:R.HSV,Invert:E.Invert,Kaleidoscope:D.Kaleidoscope,Mask:$.Mask,Noise:I.Noise,Pixelate:L.Pixelate,Posterize:U.Posterize,RGB:V.RGB,RGBA:X.RGBA,Sepia:H.Sepia,Solarize:J.Solarize,Threshold:ee.Threshold}}),Tv}var Gke=$O.exports,l8;function mj(){if(l8)return $O.exports;l8=1,Object.defineProperty(Gke,"__esModule",{value:!0});const r=Wke();return $O.exports=r.Konva,$O.exports}var Iu=mj();const Hke=jb(Iu),Qke=Yfe({__proto__:null,default:Hke},[Iu]);var gj={exports:{}};const vj=WQ(h0e);/*!
 * vue-konva v3.0.1 - https://github.com/konvajs/vue-konva#readme
 * MIT Licensed
 */(function(r,e){(function(i,s){r.exports=s(vj,mj())})(Ia,function(n,i){return function(s){var o={};function a(l){if(o[l])return o[l].exports;var h=o[l]={i:l,l:!1,exports:{}};return s[l].call(h.exports,h,h.exports,a),h.l=!0,h.exports}return a.m=s,a.c=o,a.d=function(l,h,u){a.o(l,h)||Object.defineProperty(l,h,{enumerable:!0,get:u})},a.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},a.t=function(l,h){if(h&1&&(l=a(l)),h&8||h&4&&typeof l=="object"&&l&&l.__esModule)return l;var u=Object.create(null);if(a.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:l}),h&2&&typeof l!="string")for(var f in l)a.d(u,f,(function(p){return l[p]}).bind(null,f));return u},a.n=function(l){var h=l&&l.__esModule?function(){return l.default}:function(){return l};return a.d(h,"a",h),h},a.o=function(l,h){return Object.prototype.hasOwnProperty.call(l,h)},a.p="",a(a.s=2)}([function(s,o){s.exports=n},function(s,o){s.exports=i},function(s,o,a){s.exports=a(3)},function(s,o,a){a.r(o);var l=a(0),h=a(1),u=a.n(h);function f(I){if(!u.a.autoDrawEnabled){var L=I.getLayer()||I.getStage();L&&L.batchDraw()}}var p={key:!0,style:!0,elm:!0,isRootInsert:!0},m=".vue-konva-event";function v(I,L,U,V){L===void 0&&(L={}),U===void 0&&(U={});var X=I.__konvaNode,H={},J=!1;for(var ee in U)if(!p[ee]){var ne=ee.slice(0,2)==="on",ge=U[ee]!==L[ee];if(ne&&ge){var ye=ee.substr(2).toLowerCase();ye.substr(0,7)==="content"&&(ye="content"+ye.substr(7,1).toUpperCase()+ye.substr(8)),X.off(ye+m,U[ee])}var ce=!L.hasOwnProperty(ee);ce&&X.setAttr(ee,void 0)}for(var we in L)if(!p[we]){var be=we.slice(0,2)==="on",se=U[we]!==L[we];if(be&&se){var ae=we.substr(2).toLowerCase();ae.substr(0,7)==="content"&&(ae="content"+ae.substr(7,1).toUpperCase()+ae.substr(8)),L[we]&&(X.off(ae+m),X.on(ae+m,L[we]))}!be&&(L[we]!==U[we]||V&&L[we]!==X.getAttr(we))&&(J=!0,H[we]=L[we])}J&&(X.setAttrs(H),f(X))}var y="v";function x(I){function L(U){return U.__konvaNode?U:U.parent?L(U.parent):(console.error("vue-konva error: Can not find parent node"),{})}return L(I.parent)}function w(I){if(I!=null&&I.component)return I.component.__konvaNode||w(I.component.subTree)}function S(I){var L=I.el,U=I.component,V=w(I);if(L!=null&&L.tagName&&U&&!V){var X=L&&L.tagName.toLowerCase();return console.error('vue-konva error: You are trying to render "'+X+'" inside your component tree. Looks like it is not a Konva node. You can render only Konva components inside the Stage.'),null}return V}function O(I){var L=[];return I.children&&I.children.forEach(function(U){!U.component&&Array.isArray(U.children)&&U.children.forEach(function(V){!V.component&&Array.isArray(V.children)?L.push.apply(L,V.children):L.push(V)}),U.component&&L.push(U)}),L}function _(I,L){var U=O(I),V=[];U.forEach(function(H){var J=S(H);J&&V.push(J)});var X=!1;V.forEach(function(H,J){H.getZIndex()!==J&&(H.setZIndex(J),X=!0)}),X&&f(L)}function T(){return T=Object.assign||function(I){for(var L=1;L<arguments.length;L++){var U=arguments[L];for(var V in U)Object.prototype.hasOwnProperty.call(U,V)&&(I[V]=U[V])}return I},T.apply(this,arguments)}var A={props:{config:{type:Object,default:function(){return{}}},__useStrictMode:{type:Boolean}},inheritAttrs:!1,setup:function(L,U){var V=U.attrs,X=U.slots,H=U.expose;U.emits;var J=Object(l.getCurrentInstance)(),ee=Object(l.reactive)({}),ne=Object(l.ref)(null),ge=new window.Konva.Stage({width:L.config.width,height:L.config.height,container:document.createElement("div")});J.__konvaNode=ge,we();function ye(){return J.__konvaNode}function ce(){return J.__konvaNode}function we(){var be=ee||{},se=T({},V,L.config);v(J,se,be,L.__useStrictMode),Object.assign(ee,se)}return Object(l.onMounted)(function(){ne.value.innerHTML="",ge.container(ne.value),we()}),Object(l.onUpdated)(function(){we(),_(J.subTree,ge)}),Object(l.onBeforeUnmount)(function(){ge.destroy()}),Object(l.watch)(function(){return L.config},we,{deep:!0}),H({getStage:ce,getNode:ye}),function(){var be;return Object(l.h)("div",{ref:ne},(be=X.default)===null||be===void 0?void 0:be.call(X))}}};function P(){return P=Object.assign||function(I){for(var L=1;L<arguments.length;L++){var U=arguments[L];for(var V in U)Object.prototype.hasOwnProperty.call(U,V)&&(I[V]=U[V])}return I},P.apply(this,arguments)}var N=".vue-konva-event",k={Group:!0,Layer:!0,FastLayer:!0,Label:!0},R=function(I){return{props:{config:{type:Object,default:function(){return{}}},__useStrictMode:{type:Boolean}},setup:function(U,V){var X=V.attrs,H=V.slots,J=V.expose,ee=Object(l.getCurrentInstance)(),ne=Object(l.reactive)({}),ge=window.Konva[I];if(!ge){console.error("vue-konva error: Can not find node "+I);return}var ye=new ge;ee.__konvaNode=ye,ee.vnode.__konvaNode=ye,be();function ce(){return ee.__konvaNode}function we(){return ee.__konvaNode}function be(){var ae={};for(var Q in ee.vnode.props)Q.slice(0,2)==="on"&&(ae[Q]=ee.vnode.props[Q]);var z=ne||{},j=P({},X,U.config,ae);v(ee,j,z,U.__useStrictMode),Object.assign(ne,j)}Object(l.onMounted)(function(){var ae=x(ee).__konvaNode;ae.add(ye),f(ye)}),Object(l.onUnmounted)(function(){f(ye),ye.destroy(),ye.off(N)}),Object(l.onUpdated)(function(){be(),_(ee.subTree,ye)}),Object(l.watch)(function(){return U.config},be,{deep:!0}),J({getStage:we,getNode:ce});var se=k[I];return se?function(){var ae;return Object(l.h)("template",{},(ae=H.default)===null||ae===void 0?void 0:ae.call(H))}:function(){return null}}}};typeof window<"u"&&!window.Konva&&a(1);var E=["Layer","FastLayer","Group","Label","Rect","Circle","Ellipse","Wedge","Line","Sprite","Image","Text","TextPath","Star","Ring","Arc","Tag","Path","RegularPolygon","Arrow","Shape","Transformer"],D=[{name:"Stage",component:A}].concat(E.map(function(I){return{name:I,component:R(I)}})),$={install:function(L,U){var V=y;U&&U.prefix&&(V=U.prefix),D.forEach(function(X){L.component(""+V+X.name,X.component)})}};o.default=$}]).default})})(gj);var jke=gj.exports;const yj=jb(jke),B2={__name:"KonvaStage",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r,{expose:e}){let n=0;function i(){return n+=1,n}let s={};function o(x){return s[x.uuid]}function a(x,w){if(x.uuid==w)return x;if(x.children)for(let O=0;O<x.children.length;O++){const _=x.children[O];var S=a(_,w);if(S)return S}return null}e({getObject:o});const l=XX(r,"modelValue");function h(x,w,S){var O=Qke[x],_=new O(S);return _.uuid=S.uuid,s[S.uuid]=_,w&&w.add(_),u(_,S),_}function u(x,w){let S=["x","y","width","height","offsetX","offsetY","fill","opacity","stroke","name","rotation","scaleX","scaleY","shadowColor","shadowOffset","shadowBlur","lineJoin","draggable"];for(let O=0;O<S.length;O++){const _=S[O],T=`${_}Change`;x.on(T,A=>{w[_]=A.newVal})}}function f(x,w,S){var O=s[S.uuid];if(O?O.setAttrs(S):O=h(x,w,S),S.children)for(let _=0;_<S.children.length;_++){const T=S.children[_];f(T.type,O,T)}return O}function p(x){if(x.uuid||(x.uuid=i()),x.children)for(let w=0;w<x.children.length;w++){const S=x.children[w];p(S)}}function m(x){var w=a(l.value,x.uuid);if(!w){x.remove();return}var S=[];if(x.getChildren){var O=x.getChildren();for(let T=0;T<O.length;T++){const A=O[T];var _=a(l.value,A.uuid);_||S.push(A)}}for(let T=0;T<S.length;T++)S[T].remove();if(x.getChildren){var O=x.getChildren();for(let A=0;A<O.length;A++){const P=O[A];m(P)}}}function v(x){let w=document.getElementById(l.value.container);var S=l.value.width||w.clientWidth,O=l.value.height||w.clientHeight;x.width(S),x.height(O)}function y(){p(l.value);var x=f("Stage",null,l.value);v(x),m(x)}return Gi(l.value,()=>{y()}),Xn(()=>{y()}),Po(()=>{}),(x,w)=>null}},Va=r=>(_p("data-v-8a27eec9"),r=r(),Op(),r),Yke=Va(()=>xt("h1",null,"坐标系展示",-1)),qke=Va(()=>xt("div",{class:"mylabel"},"坐标(x,y)",-1)),Zke=Va(()=>xt("div",{class:"mylabel"},"全局坐标(x,y)",-1)),Kke=Va(()=>xt("div",{class:"mylabel"},"锚点(offset)",-1)),Jke=Va(()=>xt("div",{class:"mylabel"},"尺寸(w,h)",-1)),ePe=Va(()=>xt("div",{class:"mylabel"},"旋转角度",-1)),tPe=Va(()=>xt("div",{class:"mylabel"},"缩放(scale)",-1)),iPe=Va(()=>xt("div",{class:"mylabel"},"透明度(0-1)",-1)),nPe=Va(()=>xt("div",{class:"mylabel"},"颜色",-1)),rPe=Va(()=>xt("div",{class:"mylabel"},"shadowOffset",-1)),sPe=Va(()=>xt("div",{class:"mylabel"},"shadowBlur",-1)),oPe=Va(()=>xt("div",{class:"mylabel"},"lineJoin",-1)),eA=800,tA=600,aPe={__name:"KonvaMain",setup(r){const e=ot({stageConfig:{width:eA,height:tA,fill:"black"},backgroundConfig:{x:0,y:0,width:eA,height:tA,fill:"#fefae0",stroke:"black",strokeWidth:1},rectConfig:{x:100,y:100,gx:100,gy:100,width:200,height:100,offsetX:0,offsetY:0,fill:"#dda15e",opacity:.8,stroke:"black",name:"rect",rotation:0,scaleX:1,scaleY:1,shadowColor:"#A78EEB",shadowOffset:{x:3,y:3},shadowBlur:3,lineJoin:"miter",draggable:!0}}),n=ot(null),i=ot(null),s=ot(null);function o(){if(n.value){var a=n.value.getNode();e.value.rectConfig.x=a.x(),e.value.rectConfig.y=a.y(),e.value.rectConfig.gx=a.absolutePosition().x,e.value.rectConfig.gy=a.absolutePosition().y,e.value.rectConfig.offsetX=a.offsetX(),e.value.rectConfig.offsetY=a.offsetY(),e.value.rectConfig.width=a.width(),e.value.rectConfig.height=a.height(),e.value.rectConfig.rotation=a.rotation(),e.value.rectConfig.rotation=a.rotation(),e.value.rectConfig.scaleX=a.scaleX(),e.value.rectConfig.scaleY=a.scaleY(),requestAnimationFrame(o)}}return Xn(()=>{requestAnimationFrame(o);var a=i.value.getNode(),l=s.value.getNode();a.on("click tap",function(h){var f,p;if(!h.target.hasName("rect")){(f=a.findOne("Transformer"))==null||f.destroy(),l.draw();return}(p=a.findOne("Transformer"))==null||p.destroy();var u=new Iu.Transformer;l.add(u),u.nodes([h.target]),l.draw()}),window.stage=a,window.coordConfig=e,window.VueKonva=yj}),(a,l)=>{const h=bt("v-rect"),u=bt("v-arrow"),f=bt("v-layer"),p=bt("v-stage"),m=bt("Col"),v=bt("Divider"),y=bt("InputNumber"),x=bt("Row"),w=bt("Slider"),S=bt("ColorPicker"),O=bt("Option"),_=bt("Select"),T=bt("Card");return ri(),Ji(yn,null,[Pe(T,null,{title:qe(()=>[Yke]),default:qe(()=>[Pe(x,null,{default:qe(()=>[Pe(m,null,{default:qe(()=>[xt("div",null,[Pe(p,{ref_key:"myStageRef",ref:i,config:e.value.stageConfig},{default:qe(()=>[Pe(f,{ref_key:"myLayerRef",ref:s},{default:qe(()=>[Pe(h,{config:e.value.backgroundConfig},null,8,["config"]),Pe(u,{config:{points:[0,0,eA,0],fill:"black",stroke:"black"}},null,8,["config"]),Pe(u,{config:{points:[0,0,0,tA],fill:"black",stroke:"black"}},null,8,["config"]),Pe(h,{ref_key:"myRectRef",ref:n,config:e.value.rectConfig,__useStrictMode:!0},null,8,["config"])]),_:1},512)]),_:1},8,["config"])])]),_:1}),Pe(m,null,{default:qe(()=>[xt("div",null,[Pe(x,null,{default:qe(()=>[Pe(m,null,{default:qe(()=>[Pe(v,null,{default:qe(()=>[tn("基础")]),_:1}),Pe(x,null,{default:qe(()=>[qke,Pe(y,{modelValue:e.value.rectConfig.x,"onUpdate:modelValue":l[0]||(l[0]=A=>e.value.rectConfig.x=A),step:10},null,8,["modelValue"]),Pe(y,{modelValue:e.value.rectConfig.y,"onUpdate:modelValue":l[1]||(l[1]=A=>e.value.rectConfig.y=A),step:10},null,8,["modelValue"])]),_:1}),Pe(x,null,{default:qe(()=>[Zke,Pe(y,{modelValue:e.value.rectConfig.gx,"onUpdate:modelValue":l[2]||(l[2]=A=>e.value.rectConfig.gx=A),readonly:!0},null,8,["modelValue"]),Pe(y,{modelValue:e.value.rectConfig.gy,"onUpdate:modelValue":l[3]||(l[3]=A=>e.value.rectConfig.gy=A),readonly:!0},null,8,["modelValue"])]),_:1}),Pe(x,null,{default:qe(()=>[Kke,Pe(y,{modelValue:e.value.rectConfig.offsetX,"onUpdate:modelValue":l[4]||(l[4]=A=>e.value.rectConfig.offsetX=A),step:10},null,8,["modelValue"]),Pe(y,{modelValue:e.value.rectConfig.offsetY,"onUpdate:modelValue":l[5]||(l[5]=A=>e.value.rectConfig.offsetY=A),step:10},null,8,["modelValue"])]),_:1}),Pe(x,null,{default:qe(()=>[Jke,Pe(y,{modelValue:e.value.rectConfig.width,"onUpdate:modelValue":l[6]||(l[6]=A=>e.value.rectConfig.width=A),step:10},null,8,["modelValue"]),Pe(y,{modelValue:e.value.rectConfig.height,"onUpdate:modelValue":l[7]||(l[7]=A=>e.value.rectConfig.height=A),step:10},null,8,["modelValue"])]),_:1}),Pe(x,null,{default:qe(()=>[ePe,Pe(y,{modelValue:e.value.rectConfig.rotation,"onUpdate:modelValue":l[8]||(l[8]=A=>e.value.rectConfig.rotation=A),step:10},null,8,["modelValue"])]),_:1}),Pe(x,null,{default:qe(()=>[tPe,Pe(y,{modelValue:e.value.rectConfig.scaleX,"onUpdate:modelValue":l[9]||(l[9]=A=>e.value.rectConfig.scaleX=A),step:.1},null,8,["modelValue"]),Pe(y,{modelValue:e.value.rectConfig.scaleY,"onUpdate:modelValue":l[10]||(l[10]=A=>e.value.rectConfig.scaleY=A),step:.1},null,8,["modelValue"])]),_:1}),Pe(x,null,{default:qe(()=>[iPe,Pe(w,{modelValue:e.value.rectConfig.opacity,"onUpdate:modelValue":l[11]||(l[11]=A=>e.value.rectConfig.opacity=A),min:0,max:1,step:.05,style:{width:"160px"}},null,8,["modelValue"])]),_:1}),Pe(v,null,{default:qe(()=>[tn("阴影")]),_:1}),Pe(x,null,{default:qe(()=>[nPe,Pe(S,{modelValue:e.value.rectConfig.shadowColor,"onUpdate:modelValue":l[12]||(l[12]=A=>e.value.rectConfig.shadowColor=A)},null,8,["modelValue"])]),_:1}),Pe(x,null,{default:qe(()=>[rPe,Pe(y,{modelValue:e.value.rectConfig.shadowOffsetX,"onUpdate:modelValue":l[13]||(l[13]=A=>e.value.rectConfig.shadowOffsetX=A)},null,8,["modelValue"]),Pe(y,{modelValue:e.value.rectConfig.shadowOffsetY,"onUpdate:modelValue":l[14]||(l[14]=A=>e.value.rectConfig.shadowOffsetY=A)},null,8,["modelValue"])]),_:1}),Pe(x,null,{default:qe(()=>[sPe,Pe(y,{modelValue:e.value.rectConfig.shadowBlur,"onUpdate:modelValue":l[15]||(l[15]=A=>e.value.rectConfig.shadowBlur=A)},null,8,["modelValue"])]),_:1}),Pe(v,null,{default:qe(()=>[tn("边角")]),_:1}),Pe(x,null,{default:qe(()=>[oPe,Pe(_,{modelValue:e.value.rectConfig.lineJoin,"onUpdate:modelValue":l[16]||(l[16]=A=>e.value.rectConfig.lineJoin=A),style:{width:"160px"}},{default:qe(()=>[Pe(O,{value:"miter"},{default:qe(()=>[tn("miter")]),_:1}),Pe(O,{value:"bevel"},{default:qe(()=>[tn("bevel")]),_:1}),Pe(O,{value:"round"},{default:qe(()=>[tn("round")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),Pe(B2),Pe(T)],64)}}},lPe=Ap(aPe,[["__scopeId","data-v-8a27eec9"]]),cPe=["src"],fy={__name:"EasyLink",props:{link:String,width:Number,height:Number},setup(r){const e=r,n=ot(null);return Xn(()=>{var i=e.width?`${i}px`:"100%",s=e.height?`${s}px`:"100vh";n.value={width:i,height:s}}),(i,s)=>(ri(),Ji("iframe",{src:e.link,style:pd(n.value)},null,12,cPe))}},hPe={__name:"GridSquare",setup(r){const e=Qn(null),n=Qn(null),i=Qn(null),s=Qn(null),o=ot({rows:5,cols:8,boxWidth:100,boxHeight:50,offsetX:-400,offsetY:-125});Gi(o.value,()=>{h()});const a=Qn(null);function l(){var f=i.value.getNode(),p=s.value.getNode(),m=f.getChildren();for(let S=0;S<o.value.rows;S++)for(let O=0;O<o.value.cols;O++){var v=S*o.value.cols+O,y=m[v];y.x(O*o.value.boxWidth+o.value.offsetX),y.y(S*o.value.boxHeight+o.value.offsetY)}var x=p.findOne("#arrowx");x.points([0,0,o.value.boxWidth*o.value.cols+o.value.offsetX,0]);var w=p.findOne("#arrowy");w.points([0,0,0,o.value.boxHeight*o.value.rows+o.value.offsetY])}function h(){var f=n.value.getNode(),p=i.value.getNode(),m=s.value.getNode();p.removeChildren(),m.removeChildren();for(let O=0;O<o.value.rows;O++)for(let _=0;_<o.value.cols;_++){var v=new Iu.Group({id:`${O}_${_}`});p.add(v);var y=new Iu.Rect({x:0,y:0,width:o.value.boxWidth,height:o.value.boxHeight,stroke:"black",strokeWidth:1,draggable:!0,id:"box"});v.add(y);var x=new Iu.Text({text:`(${O},${_})`,x:0,y:0,width:o.value.boxWidth,height:o.value.boxHeight,align:"center",verticalAlign:"middle",id:"text"});v.add(x)}var w=new Iu.Arrow({x:0,y:0,points:[0,0,f.width(),0],pointerLength:20,pointerWidth:20,fill:"red",stroke:"red",strokeWidth:4,id:"arrowx"});m.add(w);var S=new Iu.Arrow({x:0,y:0,points:[0,0,0,f.height()],pointerLength:20,pointerWidth:20,fill:"green",stroke:"green",strokeWidth:4,id:"arrowy"});m.add(S),l()}Xn(()=>{var f=n.value.getNode(),p=i.value.getNode();f.width(e.value.clientWidth),f.height(e.value.clientHeight),f.x(e.value.clientWidth/2),f.y(e.value.clientHeight/2),window.boxConfig=o,window.stage=f,window.layer=p,h(),f.on("wheel",m=>{m.evt.preventDefault();var v=f.scaleX(),y=f.getPointerPosition(),x={x:(y.x-f.x())/v,y:(y.y-f.y())/v};let w=m.evt.deltaY>0?1:-1;m.evt.ctrlKey&&(w=-w);const S=1.1;var O=w<0?v*S:v/S;f.scale({x:O,y:O});var _={x:y.x-x.x*O,y:y.y-x.y*O};f.position(_)}),f.on("mousemove",m=>{var v=f.getPointerPosition(),y=Math.floor((v.y-f.y()-o.value.offsetY)/o.value.boxHeight),x=Math.floor((v.x-f.x()-o.value.offsetX)/o.value.boxWidth),w=`#${y}_${x}`;if(a.value){var S=p.findOne(a.value);u(S,!1)}var S=p.findOne(w);u(S,!0),a.value=w})});function u(f,p){if(f){var m=f.findOne("#box");p?(console.log(m.fill()),m.fill("red")):m.fill(null)}}return(f,p)=>{const m=bt("v-layer"),v=bt("v-stage"),y=bt("Col"),x=bt("InputNumber"),w=bt("FormItem"),S=bt("Form"),O=bt("Row");return ri(),Ar(O,null,{default:qe(()=>[Pe(y,{span:18},{default:qe(()=>[xt("div",{class:"boxborder",ref_key:"boxParentRef",ref:e},[Pe(v,{ref_key:"boxStageRef",ref:n,config:{width:100,height:100,draggable:!0}},{default:qe(()=>[Pe(m,{ref_key:"arrowLayerRef",ref:s},null,512),Pe(m,{ref_key:"boxLayerRef",ref:i},null,512)]),_:1},512)],512)]),_:1}),Pe(y,{span:6},{default:qe(()=>[Pe(S,{"label-width":100},{default:qe(()=>[Pe(w,{label:"行 / 列",style:{width:"100%"}},{default:qe(()=>[Pe(x,{modelValue:o.value.rows,"onUpdate:modelValue":p[0]||(p[0]=_=>o.value.rows=_)},null,8,["modelValue"]),Pe(x,{modelValue:o.value.cols,"onUpdate:modelValue":p[1]||(p[1]=_=>o.value.cols=_)},null,8,["modelValue"])]),_:1}),Pe(w,{label:"单元格宽高"},{default:qe(()=>[Pe(x,{modelValue:o.value.boxWidth,"onUpdate:modelValue":p[2]||(p[2]=_=>o.value.boxWidth=_)},null,8,["modelValue"]),Pe(x,{modelValue:o.value.boxHeight,"onUpdate:modelValue":p[3]||(p[3]=_=>o.value.boxHeight=_)},null,8,["modelValue"])]),_:1}),Pe(w,{label:"坐标偏移"},{default:qe(()=>[Pe(x,{modelValue:o.value.offsetX,"onUpdate:modelValue":p[4]||(p[4]=_=>o.value.offsetX=_)},null,8,["modelValue"]),Pe(x,{modelValue:o.value.offsetY,"onUpdate:modelValue":p[5]||(p[5]=_=>o.value.offsetY=_)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}},uPe=Ap(hPe,[["__scopeId","data-v-99fbc157"]]),dPe={id:"container",style:{"background-color":"antiquewhite",height:"80vh"}},fPe={__name:"GridParallelogramH",setup(r){const e=ot(100),n=ot(100),i=ot(60),s=ot(4),o=ot(5),a=Rn(()=>{var f=[];const p=e.value,m=n.value,v=i.value*Math.PI/180;for(let y=0;y<s.value;y++)for(let x=0;x<o.value;x++){const w=p*x,S=m*Math.sin(v)*y,O=w+p,_=S,T=O+m*Math.cos(v),A=(y+1)*m*Math.sin(v),P=w+m*Math.cos(v),k={type:"Line",points:[w,S,O,_,T,A,P,A],fill:"#00D2FF",stroke:"black",strokeWidth:1,closed:!0,name:`${y}_${x} line`};f.push(k)}return f}),l=Rn(()=>[{type:"Arrow",points:[0,0,e.value*o.value,0],pointerLength:20,pointerWidth:20,fill:"black",stroke:"red",strokeWidth:4},{type:"Arrow",points:[0,0,0,n.value*s.value],pointerLength:20,pointerWidth:20,fill:"black",stroke:"green",strokeWidth:4}]),h=ot(null),u=ot({container:"container",draggable:!0,x:100,y:600,scaleY:-1,children:[{type:"Layer",children:a},{type:"Layer",children:l}]});return Xn(()=>{window.shapes=a;var f=h.value.getObject(u.value),p=null;f.on("mousemove",m=>{p&&p.fill("#00D2FF"),m.target.hasName("line")&&(m.target.fill("red"),p=m.target)})}),(f,p)=>{const m=bt("Col"),v=bt("InputNumber"),y=bt("FormItem"),x=bt("Slider"),w=bt("Form"),S=bt("Row");return ri(),Ar(S,null,{default:qe(()=>[Pe(m,{span:12},{default:qe(()=>[xt("div",dPe,[Pe(B2,{ref_key:"stageRef",ref:h,modelValue:u.value,"onUpdate:modelValue":p[0]||(p[0]=O=>u.value=O)},null,8,["modelValue"])])]),_:1}),Pe(m,{span:4},{default:qe(()=>[Pe(w,{"label-width":100},{default:qe(()=>[Pe(y,{label:"地块横边(px)"},{default:qe(()=>[Pe(v,{modelValue:e.value,"onUpdate:modelValue":p[1]||(p[1]=O=>e.value=O)},null,8,["modelValue"])]),_:1}),Pe(y,{label:"地块竖边(px)"},{default:qe(()=>[Pe(v,{modelValue:n.value,"onUpdate:modelValue":p[2]||(p[2]=O=>n.value=O)},null,8,["modelValue"])]),_:1}),Pe(y,{label:"偏转角度"},{default:qe(()=>[Pe(x,{modelValue:i.value,"onUpdate:modelValue":p[3]||(p[3]=O=>i.value=O),min:0,max:90},null,8,["modelValue"])]),_:1}),Pe(y,{label:"行 / 列"},{default:qe(()=>[Pe(v,{modelValue:s.value,"onUpdate:modelValue":p[4]||(p[4]=O=>s.value=O)},null,8,["modelValue"]),Pe(v,{modelValue:o.value,"onUpdate:modelValue":p[5]||(p[5]=O=>o.value=O)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}},pPe={id:"container",style:{"background-color":"antiquewhite",height:"80vh"}},mPe={__name:"GridParallelogramV",setup(r){const e=ot(130),n=ot(100),i=ot(60),s=ot(4),o=ot(10),a=Rn(()=>{var f=[];const p=e.value,m=n.value;i.value*Math.PI/180;for(let y=0;y<s.value;y++)for(let x=0;x<o.value;x++){let w=null,S,O,_,T,A,P,N,k;S=p*x+p/2,O=m*y,_=S+p/2,T=O+m/2,A=S,P=O+m,N=p*x,k=T,S-=p*Math.floor(x/2),_-=p*Math.floor(x/2),A-=p*Math.floor(x/2),N-=p*Math.floor(x/2),x%2==1&&(S-=p/2,_-=p/2,A-=p/2,N-=p/2,O+=m/2,T+=m/2,P+=m/2,k+=m/2),O*=-1,T*=-1,P*=-1,k*=-1,w={type:"Line",points:[S,O,_,T,A,P,N,k],fill:"#c9ada7",stroke:"black",strokeWidth:1,closed:!0,name:`${y}_${x} line`,id:`${y}_${x}`},f.push(w);var v={type:"Text",text:`(${y},${x})`,x:N,y:T,align:"center",width:p,height:m};f.push(v)}return f}),l=Rn(()=>[{type:"Arrow",points:[0,0,e.value*o.value/2,0],pointerLength:20,pointerWidth:20,fill:"black",stroke:"red",strokeWidth:4},{type:"Arrow",points:[0,0,0,-n.value*s.value],pointerLength:20,pointerWidth:20,fill:"black",stroke:"green",strokeWidth:4}]),h=ot(null),u=ot({container:"container",draggable:!0,x:100,y:600,children:[{type:"Layer",children:a},{type:"Layer",children:l}]});return Xn(()=>{window.shapes=a;var f=h.value.getObject(u.value),p=null;f.on("mousemove",m=>{p&&p.fill("#c9ada7"),m.target.hasName("line")&&(m.target.fill("red"),p=m.target)})}),(f,p)=>{const m=bt("Col"),v=bt("Slider"),y=bt("FormItem"),x=bt("InputNumber"),w=bt("Form"),S=bt("Row");return ri(),Ar(S,null,{default:qe(()=>[Pe(m,{span:12},{default:qe(()=>[xt("div",pPe,[Pe(B2,{ref_key:"stageRef",ref:h,modelValue:u.value,"onUpdate:modelValue":p[0]||(p[0]=O=>u.value=O)},null,8,["modelValue"])])]),_:1}),Pe(m,{span:4},{default:qe(()=>[Pe(w,{"label-width":100},{default:qe(()=>[Pe(y,{label:"地块主边(px)"},{default:qe(()=>[Pe(v,{modelValue:e.value,"onUpdate:modelValue":p[1]||(p[1]=O=>e.value=O),min:50,max:200,"show-input":!0},null,8,["modelValue"])]),_:1}),Pe(y,{label:"地块次边(px)"},{default:qe(()=>[Pe(v,{modelValue:n.value,"onUpdate:modelValue":p[2]||(p[2]=O=>n.value=O),min:50,max:200,"show-input":!0},null,8,["modelValue"])]),_:1}),Pe(y,{label:"行 / 列"},{default:qe(()=>[Pe(x,{modelValue:s.value,"onUpdate:modelValue":p[3]||(p[3]=O=>s.value=O)},null,8,["modelValue"]),Pe(x,{modelValue:o.value,"onUpdate:modelValue":p[4]||(p[4]=O=>o.value=O)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})}}},gPe={id:"container",style:{"background-color":"antiquewhite",height:"80vh"}},vPe={__name:"KonvaStageTest",setup(r){const e=ot([{type:"Rect",x:100,y:100,width:200,height:100,fill:"red",draggable:!0}]),n=ot({type:"Stage",container:"container",wheel:!0,children:[{type:"Layer",children:e}]}),i=Qn(null);function s(o){o=="Rect"?e.value.push({type:"Rect",width:200,height:100,fill:"green",draggable:!0}):o=="Circle"?e.value.push({type:"Circle",radius:80,fill:"green",draggable:!0}):o=="Star"&&e.value.push({type:"Star",innerRadius:40,outerRadius:70,fill:"yellow",stroke:"black",strokeWidth:4,draggable:!0}),console.log(o)}return Xn(()=>{var o=i.value.getObject(n.value);o.on("wheel",a=>{a.evt.preventDefault();var l=o.scaleX(),h=o.getPointerPosition(),u={x:(h.x-o.x())/l,y:(h.y-o.y())/l};let f=a.evt.deltaY>0?1:-1;a.evt.ctrlKey&&(f=-f);var p=1.1,m=f<0?l*p:l/p;o.scale({x:m,y:m});var v={x:h.x-u.x*m,y:h.y-u.y*m};o.position(v)})}),(o,a)=>{const l=bt("Col"),h=bt("Icon"),u=bt("Button"),f=bt("DropdownItem"),p=bt("DropdownMenu"),m=bt("Dropdown"),v=bt("Space"),y=bt("FormItem"),x=bt("Divider"),w=bt("InputNumber"),S=bt("Form"),O=bt("Row");return ri(),Ar(O,null,{default:qe(()=>[Pe(l,{span:12},{default:qe(()=>[xt("div",gPe,[Pe(B2,{ref_key:"stageRef",ref:i,modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=_=>n.value=_)},null,8,["modelValue"])])]),_:1}),Pe(l,{span:12},{default:qe(()=>[Pe(S,{"label-width":100},{default:qe(()=>[Pe(y,{label:"添加"},{default:qe(()=>[Pe(v,null,{default:qe(()=>[Pe(m,{onOnClick:s},{list:qe(()=>[Pe(p,null,{default:qe(()=>[Pe(f,{name:"Rect"},{default:qe(()=>[tn("矩形")]),_:1}),Pe(f,{name:"Circle"},{default:qe(()=>[tn("圆形")]),_:1}),Pe(f,{name:"Star"},{default:qe(()=>[tn("星形")]),_:1})]),_:1})]),default:qe(()=>[Pe(u,{type:"primary"},{default:qe(()=>[tn(" 添加图形 "),Pe(h,{type:"ios-arrow-down"})]),_:1})]),_:1})]),_:1})]),_:1}),Pe(x),(ri(!0),Ji(yn,null,hc(e.value,_=>(ri(),Ar(y,{label:"x/y"},{default:qe(()=>[Pe(w,{modelValue:_.x,"onUpdate:modelValue":T=>_.x=T},null,8,["modelValue","onUpdate:modelValue"]),Pe(w,{modelValue:_.y,"onUpdate:modelValue":T=>_.y=T},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}},yPe=xt("h1",null,"三角函数计算器",-1),bPe={__name:"TrigoCalc",setup(r){const e=ot(0),n=ot(0),i=ot(0),s=ot(0),o=ot(0),a=ot(0),l=ot(0);let h=!1;Gi(n,()=>{u(n,m=>m)}),Gi(i,()=>{u(i,m=>m*180/Math.PI)}),Gi(s,()=>{u(s,m=>Math.asin(m))}),Gi(o,()=>{u(o,m=>Math.acos(m))}),Gi(a,()=>{u(a,m=>Math.atan(m))}),Gi(l,()=>{u(l,m=>Math.atan(1/m))});function u(m,v){if(h)return;const y=f(m.value);e.value=v(y)}function f(m){let v=parseFloat(m);return v||(v=0),Math.abs(v)<.001&&(v=0),v}Gi(e,p);async function p(){h=!0;const m=e.value*Math.PI/180;n.value=e.value,i.value=m,s.value=Math.sin(m),o.value=Math.cos(m),a.value=Math.tan(m),a.value?l.value=1/a.value:l.value=0,n.value=parseFloat(n.value.toFixed(3)),i.value=parseFloat(i.value.toFixed(3)),s.value=parseFloat(s.value.toFixed(3)),o.value=parseFloat(o.value.toFixed(3)),a.value=parseFloat(a.value.toFixed(3)),l.value=parseFloat(l.value.toFixed(3)),await n0(),h=!1}return Xn(()=>{e.value=30}),(m,v)=>{const y=bt("Input"),x=bt("Col"),w=bt("Row");return ri(),Ar(w,null,{default:qe(()=>[Pe(x,{span:4,offset:10},{default:qe(()=>[yPe,Pe(y,{type:"number",modelValue:n.value,"onUpdate:modelValue":v[0]||(v[0]=S=>n.value=S)},{prepend:qe(()=>[tn("角度")]),_:1},8,["modelValue"]),Pe(y,{type:"number",modelValue:i.value,"onUpdate:modelValue":v[1]||(v[1]=S=>i.value=S)},{prepend:qe(()=>[tn("弧度")]),_:1},8,["modelValue"]),Pe(y,{type:"number",modelValue:s.value,"onUpdate:modelValue":v[2]||(v[2]=S=>s.value=S)},{prepend:qe(()=>[tn("正弦")]),_:1},8,["modelValue"]),Pe(y,{type:"number",modelValue:o.value,"onUpdate:modelValue":v[3]||(v[3]=S=>o.value=S)},{prepend:qe(()=>[tn("余弦")]),_:1},8,["modelValue"]),Pe(y,{type:"number",modelValue:a.value,"onUpdate:modelValue":v[4]||(v[4]=S=>a.value=S)},{prepend:qe(()=>[tn("正切")]),_:1},8,["modelValue"]),Pe(y,{type:"number",modelValue:l.value,"onUpdate:modelValue":v[5]||(v[5]=S=>l.value=S)},{prepend:qe(()=>[tn("余切")]),_:1},8,["modelValue"])]),_:1})]),_:1})}}};let bn=class bj{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,n,i){[e,n]=Wg(this,e,n);let s=[];return this.decompose(0,e,s,2),i.length&&i.decompose(0,i.length,s,3),this.decompose(n,this.length,s,1),Jl.from(s,this.length-(n-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,n=this.length){[e,n]=Wg(this,e,n);let i=[];return this.decompose(e,n,i,0),Jl.from(i,n-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let n=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),s=new h1(this),o=new h1(e);for(let a=n,l=n;;){if(s.next(a),o.next(a),a=0,s.lineBreak!=o.lineBreak||s.done!=o.done||s.value!=o.value)return!1;if(l+=s.value.length,s.done||l>=i)return!0}}iter(e=1){return new h1(this,e)}iterRange(e,n=this.length){return new xj(this,e,n)}iterLines(e,n){let i;if(e==null)i=this.iter();else{n==null&&(n=this.lines+1);let s=this.line(e).from;i=this.iterRange(s,Math.max(s,n==this.lines+1?this.length:n<=1?0:this.line(n-1).to))}return new wj(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?bj.empty:e.length<=32?new mr(e):Jl.from(mr.split(e,[]))}};class mr extends bn{constructor(e,n=xPe(e)){super(),this.text=e,this.length=n}get lines(){return this.text.length}get children(){return null}lineInner(e,n,i,s){for(let o=0;;o++){let a=this.text[o],l=s+a.length;if((n?i:l)>=e)return new wPe(s,l,i,a);s=l+1,i++}}decompose(e,n,i,s){let o=e<=0&&n>=this.length?this:new mr(c8(this.text,e,n),Math.min(n,this.length)-Math.max(0,e));if(s&1){let a=i.pop(),l=UO(o.text,a.text.slice(),0,o.length);if(l.length<=32)i.push(new mr(l,a.length+o.length));else{let h=l.length>>1;i.push(new mr(l.slice(0,h)),new mr(l.slice(h)))}}else i.push(o)}replace(e,n,i){if(!(i instanceof mr))return super.replace(e,n,i);[e,n]=Wg(this,e,n);let s=UO(this.text,UO(i.text,c8(this.text,0,e)),n),o=this.length+i.length-(n-e);return s.length<=32?new mr(s,o):Jl.from(mr.split(s,[]),o)}sliceString(e,n=this.length,i=`
`){[e,n]=Wg(this,e,n);let s="";for(let o=0,a=0;o<=n&&a<this.text.length;a++){let l=this.text[a],h=o+l.length;o>e&&a&&(s+=i),e<h&&n>o&&(s+=l.slice(Math.max(0,e-o),n-o)),o=h+1}return s}flatten(e){for(let n of this.text)e.push(n)}scanIdentical(){return 0}static split(e,n){let i=[],s=-1;for(let o of e)i.push(o),s+=o.length+1,i.length==32&&(n.push(new mr(i,s)),i=[],s=-1);return s>-1&&n.push(new mr(i,s)),n}}class Jl extends bn{constructor(e,n){super(),this.children=e,this.length=n,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,n,i,s){for(let o=0;;o++){let a=this.children[o],l=s+a.length,h=i+a.lines-1;if((n?h:l)>=e)return a.lineInner(e,n,i,s);s=l+1,i=h+1}}decompose(e,n,i,s){for(let o=0,a=0;a<=n&&o<this.children.length;o++){let l=this.children[o],h=a+l.length;if(e<=h&&n>=a){let u=s&((a<=e?1:0)|(h>=n?2:0));a>=e&&h<=n&&!u?i.push(l):l.decompose(e-a,n-a,i,u)}a=h+1}}replace(e,n,i){if([e,n]=Wg(this,e,n),i.lines<this.lines)for(let s=0,o=0;s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e>=o&&n<=l){let h=a.replace(e-o,n-o,i),u=this.lines-a.lines+h.lines;if(h.lines<u>>4&&h.lines>u>>6){let f=this.children.slice();return f[s]=h,new Jl(f,this.length-(n-e)+i.length)}return super.replace(o,l,h)}o=l+1}return super.replace(e,n,i)}sliceString(e,n=this.length,i=`
`){[e,n]=Wg(this,e,n);let s="";for(let o=0,a=0;o<this.children.length&&a<=n;o++){let l=this.children[o],h=a+l.length;a>e&&o&&(s+=i),e<h&&n>a&&(s+=l.sliceString(e-a,n-a,i)),a=h+1}return s}flatten(e){for(let n of this.children)n.flatten(e)}scanIdentical(e,n){if(!(e instanceof Jl))return 0;let i=0,[s,o,a,l]=n>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=n,o+=n){if(s==a||o==l)return i;let h=this.children[s],u=e.children[o];if(h!=u)return i+h.scanIdentical(u,n);i+=h.length+1}}static from(e,n=e.reduce((i,s)=>i+s.length+1,-1)){let i=0;for(let v of e)i+=v.lines;if(i<32){let v=[];for(let y of e)y.flatten(v);return new mr(v,n)}let s=Math.max(32,i>>5),o=s<<1,a=s>>1,l=[],h=0,u=-1,f=[];function p(v){let y;if(v.lines>o&&v instanceof Jl)for(let x of v.children)p(x);else v.lines>a&&(h>a||!h)?(m(),l.push(v)):v instanceof mr&&h&&(y=f[f.length-1])instanceof mr&&v.lines+y.lines<=32?(h+=v.lines,u+=v.length+1,f[f.length-1]=new mr(y.text.concat(v.text),y.length+1+v.length)):(h+v.lines>s&&m(),h+=v.lines,u+=v.length+1,f.push(v))}function m(){h!=0&&(l.push(f.length==1?f[0]:Jl.from(f,u)),u=-1,h=f.length=0)}for(let v of e)p(v);return m(),l.length==1?l[0]:new Jl(l,n)}}bn.empty=new mr([""],0);function xPe(r){let e=-1;for(let n of r)e+=n.length+1;return e}function UO(r,e,n=0,i=1e9){for(let s=0,o=0,a=!0;o<r.length&&s<=i;o++){let l=r[o],h=s+l.length;h>=n&&(h>i&&(l=l.slice(0,i-s)),s<n&&(l=l.slice(n-s)),a?(e[e.length-1]+=l,a=!1):e.push(l)),s=h+1}return e}function c8(r,e,n){return UO(r,[""],e,n)}class h1{constructor(e,n=1){this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[n>0?1:(e instanceof mr?e.text.length:e.children.length)<<1]}nextInner(e,n){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,s=this.nodes[i],o=this.offsets[i],a=o>>1,l=s instanceof mr?s.text.length:s.children.length;if(a==(n>0?l:0)){if(i==0)return this.done=!0,this.value="",this;n>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((o&1)==(n>0?0:1)){if(this.offsets[i]+=n,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof mr){let h=s.text[a+(n<0?-1:0)];if(this.offsets[i]+=n,h.length>Math.max(0,e))return this.value=e==0?h:n>0?h.slice(e):h.slice(0,h.length-e),this;e-=h.length}else{let h=s.children[a+(n<0?-1:0)];e>h.length?(e-=h.length,this.offsets[i]+=n):(n<0&&this.offsets[i]--,this.nodes.push(h),this.offsets.push(n>0?1:(h instanceof mr?h.text.length:h.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class xj{constructor(e,n,i){this.value="",this.done=!1,this.cursor=new h1(e,n>i?-1:1),this.pos=n>i?e.length:0,this.from=Math.min(n,i),this.to=Math.max(n,i)}nextInner(e,n){if(n<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,n<0?this.pos-this.to:this.from-this.pos);let i=n<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*n,this.value=s.length<=i?s:n<0?s.slice(s.length-i):s.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class wj{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:n,lineBreak:i,value:s}=this.inner.next(e);return n&&this.afterBreak?(this.value="",this.afterBreak=!1):n?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(bn.prototype[Symbol.iterator]=function(){return this.iter()},h1.prototype[Symbol.iterator]=xj.prototype[Symbol.iterator]=wj.prototype[Symbol.iterator]=function(){return this});class wPe{constructor(e,n,i,s){this.from=e,this.to=n,this.number=i,this.text=s}get length(){return this.to-this.from}}function Wg(r,e,n){return e=Math.max(0,Math.min(r.length,e)),[e,Math.max(e,Math.min(r.length,n))]}let gg="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(r=>r?parseInt(r,36):1);for(let r=1;r<gg.length;r++)gg[r]+=gg[r-1];function _Pe(r){for(let e=1;e<gg.length;e+=2)if(gg[e]>r)return gg[e-1]<=r;return!1}function h8(r){return r>=127462&&r<=127487}const u8=8205;function ys(r,e,n=!0,i=!0){return(n?_j:OPe)(r,e,i)}function _j(r,e,n){if(e==r.length)return e;e&&Oj(r.charCodeAt(e))&&Sj(r.charCodeAt(e-1))&&e--;let i=us(r,e);for(e+=Ca(i);e<r.length;){let s=us(r,e);if(i==u8||s==u8||n&&_Pe(s))e+=Ca(s),i=s;else if(h8(s)){let o=0,a=e-2;for(;a>=0&&h8(us(r,a));)o++,a-=2;if(o%2==0)break;e+=2}else break}return e}function OPe(r,e,n){for(;e>0;){let i=_j(r,e-2,n);if(i<e)return i;e--}return 0}function Oj(r){return r>=56320&&r<57344}function Sj(r){return r>=55296&&r<56320}function us(r,e){let n=r.charCodeAt(e);if(!Sj(n)||e+1==r.length)return n;let i=r.charCodeAt(e+1);return Oj(i)?(n-55296<<10)+(i-56320)+65536:n}function s5(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function Ca(r){return r<65536?1:2}const i3=/\r\n?|\n/;var Ys=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(Ys||(Ys={}));class lc{constructor(e){this.sections=e}get length(){let e=0;for(let n=0;n<this.sections.length;n+=2)e+=this.sections[n];return e}get newLength(){let e=0;for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n+1];e+=i<0?this.sections[n]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let n=0,i=0,s=0;n<this.sections.length;){let o=this.sections[n++],a=this.sections[n++];a<0?(e(i,s,o),s+=o):s+=a,i+=o}}iterChangedRanges(e,n=!1){n3(this,e,n)}get invertedDesc(){let e=[];for(let n=0;n<this.sections.length;){let i=this.sections[n++],s=this.sections[n++];s<0?e.push(i,s):e.push(s,i)}return new lc(e)}composeDesc(e){return this.empty?e:e.empty?this:Cj(this,e)}mapDesc(e,n=!1){return e.empty?this:r3(this,e,n)}mapPos(e,n=-1,i=Ys.Simple){let s=0,o=0;for(let a=0;a<this.sections.length;){let l=this.sections[a++],h=this.sections[a++],u=s+l;if(h<0){if(u>e)return o+(e-s);o+=l}else{if(i!=Ys.Simple&&u>=e&&(i==Ys.TrackDel&&s<e&&u>e||i==Ys.TrackBefore&&s<e||i==Ys.TrackAfter&&u>e))return null;if(u>e||u==e&&n<0&&!l)return e==s||n<0?o:o+h;o+=h}s=u}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return o}touchesRange(e,n=e){for(let i=0,s=0;i<this.sections.length&&s<=n;){let o=this.sections[i++],a=this.sections[i++],l=s+o;if(a>=0&&s<=n&&l>=e)return s<e&&l>n?"cover":!0;s=l}return!1}toString(){let e="";for(let n=0;n<this.sections.length;){let i=this.sections[n++],s=this.sections[n++];e+=(e?" ":"")+i+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(n=>typeof n!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new lc(e)}static create(e){return new lc(e)}}class $r extends lc{constructor(e,n){super(e),this.inserted=n}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return n3(this,(n,i,s,o,a)=>e=e.replace(s,s+(i-n),a),!1),e}mapDesc(e,n=!1){return r3(this,e,n,!0)}invert(e){let n=this.sections.slice(),i=[];for(let s=0,o=0;s<n.length;s+=2){let a=n[s],l=n[s+1];if(l>=0){n[s]=l,n[s+1]=a;let h=s>>1;for(;i.length<h;)i.push(bn.empty);i.push(a?e.slice(o,o+a):bn.empty)}o+=a}return new $r(n,i)}compose(e){return this.empty?e:e.empty?this:Cj(this,e,!0)}map(e,n=!1){return e.empty?this:r3(this,e,n,!0)}iterChanges(e,n=!1){n3(this,e,n)}get desc(){return lc.create(this.sections)}filter(e){let n=[],i=[],s=[],o=new Z1(this);e:for(let a=0,l=0;;){let h=a==e.length?1e9:e[a++];for(;l<h||l==h&&o.len==0;){if(o.done)break e;let f=Math.min(o.len,h-l);Ms(s,f,-1);let p=o.ins==-1?-1:o.off==0?o.ins:0;Ms(n,f,p),p>0&&Uu(i,n,o.text),o.forward(f),l+=f}let u=e[a++];for(;l<u;){if(o.done)break e;let f=Math.min(o.len,u-l);Ms(n,f,-1),Ms(s,f,o.ins==-1?-1:o.off==0?o.ins:0),o.forward(f),l+=f}}return{changes:new $r(n,i),filtered:lc.create(s)}}toJSON(){let e=[];for(let n=0;n<this.sections.length;n+=2){let i=this.sections[n],s=this.sections[n+1];s<0?e.push(i):s==0?e.push([i]):e.push([i].concat(this.inserted[n>>1].toJSON()))}return e}static of(e,n,i){let s=[],o=[],a=0,l=null;function h(f=!1){if(!f&&!s.length)return;a<n&&Ms(s,n-a,-1);let p=new $r(s,o);l=l?l.compose(p.map(l)):p,s=[],o=[],a=0}function u(f){if(Array.isArray(f))for(let p of f)u(p);else if(f instanceof $r){if(f.length!=n)throw new RangeError(`Mismatched change set length (got ${f.length}, expected ${n})`);h(),l=l?l.compose(f.map(l)):f}else{let{from:p,to:m=p,insert:v}=f;if(p>m||p<0||m>n)throw new RangeError(`Invalid change range ${p} to ${m} (in doc of length ${n})`);let y=v?typeof v=="string"?bn.of(v.split(i||i3)):v:bn.empty,x=y.length;if(p==m&&x==0)return;p<a&&h(),p>a&&Ms(s,p-a,-1),Ms(s,m-p,x),Uu(o,s,y),a=m}}return u(e),h(!l),l}static empty(e){return new $r(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let n=[],i=[];for(let s=0;s<e.length;s++){let o=e[s];if(typeof o=="number")n.push(o,-1);else{if(!Array.isArray(o)||typeof o[0]!="number"||o.some((a,l)=>l&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(o.length==1)n.push(o[0],0);else{for(;i.length<s;)i.push(bn.empty);i[s]=bn.of(o.slice(1)),n.push(o[0],i[s].length)}}}return new $r(n,i)}static createSet(e,n){return new $r(e,n)}}function Ms(r,e,n,i=!1){if(e==0&&n<=0)return;let s=r.length-2;s>=0&&n<=0&&n==r[s+1]?r[s]+=e:e==0&&r[s]==0?r[s+1]+=n:i?(r[s]+=e,r[s+1]+=n):r.push(e,n)}function Uu(r,e,n){if(n.length==0)return;let i=e.length-2>>1;if(i<r.length)r[r.length-1]=r[r.length-1].append(n);else{for(;r.length<i;)r.push(bn.empty);r.push(n)}}function n3(r,e,n){let i=r.inserted;for(let s=0,o=0,a=0;a<r.sections.length;){let l=r.sections[a++],h=r.sections[a++];if(h<0)s+=l,o+=l;else{let u=s,f=o,p=bn.empty;for(;u+=l,f+=h,h&&i&&(p=p.append(i[a-2>>1])),!(n||a==r.sections.length||r.sections[a+1]<0);)l=r.sections[a++],h=r.sections[a++];e(s,u,o,f,p),s=u,o=f}}}function r3(r,e,n,i=!1){let s=[],o=i?[]:null,a=new Z1(r),l=new Z1(e);for(let h=-1;;)if(a.ins==-1&&l.ins==-1){let u=Math.min(a.len,l.len);Ms(s,u,-1),a.forward(u),l.forward(u)}else if(l.ins>=0&&(a.ins<0||h==a.i||a.off==0&&(l.len<a.len||l.len==a.len&&!n))){let u=l.len;for(Ms(s,l.ins,-1);u;){let f=Math.min(a.len,u);a.ins>=0&&h<a.i&&a.len<=f&&(Ms(s,0,a.ins),o&&Uu(o,s,a.text),h=a.i),a.forward(f),u-=f}l.next()}else if(a.ins>=0){let u=0,f=a.len;for(;f;)if(l.ins==-1){let p=Math.min(f,l.len);u+=p,f-=p,l.forward(p)}else if(l.ins==0&&l.len<f)f-=l.len,l.next();else break;Ms(s,u,h<a.i?a.ins:0),o&&h<a.i&&Uu(o,s,a.text),h=a.i,a.forward(a.len-f)}else{if(a.done&&l.done)return o?$r.createSet(s,o):lc.create(s);throw new Error("Mismatched change set lengths")}}function Cj(r,e,n=!1){let i=[],s=n?[]:null,o=new Z1(r),a=new Z1(e);for(let l=!1;;){if(o.done&&a.done)return s?$r.createSet(i,s):lc.create(i);if(o.ins==0)Ms(i,o.len,0,l),o.next();else if(a.len==0&&!a.done)Ms(i,0,a.ins,l),s&&Uu(s,i,a.text),a.next();else{if(o.done||a.done)throw new Error("Mismatched change set lengths");{let h=Math.min(o.len2,a.len),u=i.length;if(o.ins==-1){let f=a.ins==-1?-1:a.off?0:a.ins;Ms(i,h,f,l),s&&f&&Uu(s,i,a.text)}else a.ins==-1?(Ms(i,o.off?0:o.len,h,l),s&&Uu(s,i,o.textBit(h))):(Ms(i,o.off?0:o.len,a.off?0:a.ins,l),s&&!a.off&&Uu(s,i,a.text));l=(o.ins>h||a.ins>=0&&a.len>h)&&(l||i.length>u),o.forward2(h),a.forward(h)}}}}class Z1{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length?bn.empty:e[n]}textBit(e){let{inserted:n}=this.set,i=this.i-2>>1;return i>=n.length&&!e?bn.empty:n[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class kf{constructor(e,n,i){this.from=e,this.to=n,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,n=-1){let i,s;return this.empty?i=s=e.mapPos(this.from,n):(i=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),i==this.from&&s==this.to?this:new kf(i,s,this.flags)}extend(e,n=e){if(e<=this.anchor&&n>=this.anchor)return et.range(e,n);let i=Math.abs(e-this.anchor)>Math.abs(n-this.anchor)?e:n;return et.range(this.anchor,i)}eq(e,n=!1){return this.anchor==e.anchor&&this.head==e.head&&(!n||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return et.range(e.anchor,e.head)}static create(e,n,i){return new kf(e,n,i)}}class et{constructor(e,n){this.ranges=e,this.mainIndex=n}map(e,n=-1){return e.empty?this:et.create(this.ranges.map(i=>i.map(e,n)),this.mainIndex)}eq(e,n=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],n))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new et([this.main],0)}addRange(e,n=!0){return et.create([e].concat(this.ranges),n?0:this.mainIndex+1)}replaceRange(e,n=this.mainIndex){let i=this.ranges.slice();return i[n]=e,et.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new et(e.ranges.map(n=>kf.fromJSON(n)),e.main)}static single(e,n=e){return new et([et.range(e,n)],0)}static create(e,n=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,s=0;s<e.length;s++){let o=e[s];if(o.empty?o.from<=i:o.from<i)return et.normalized(e.slice(),n);i=o.to}return new et(e,n)}static cursor(e,n=0,i,s){return kf.create(e,e,(n==0?0:n<0?8:16)|(i==null?7:Math.min(6,i))|(s??16777215)<<6)}static range(e,n,i,s){let o=(i??16777215)<<6|(s==null?7:Math.min(6,s));return n<e?kf.create(n,e,48|o):kf.create(e,n,(n>e?8:0)|o)}static normalized(e,n=0){let i=e[n];e.sort((s,o)=>s.from-o.from),n=e.indexOf(i);for(let s=1;s<e.length;s++){let o=e[s],a=e[s-1];if(o.empty?o.from<=a.to:o.from<a.to){let l=a.from,h=Math.max(o.to,a.to);s<=n&&n--,e.splice(--s,2,o.anchor>o.head?et.range(h,l):et.range(l,h))}}return new et(e,n)}}function Tj(r,e){for(let n of r.ranges)if(n.to>e)throw new RangeError("Selection points outside of document")}let o5=0;class Pt{constructor(e,n,i,s,o){this.combine=e,this.compareInput=n,this.compare=i,this.isStatic=s,this.id=o5++,this.default=e([]),this.extensions=typeof o=="function"?o(this):o}get reader(){return this}static define(e={}){return new Pt(e.combine||(n=>n),e.compareInput||((n,i)=>n===i),e.compare||(e.combine?(n,i)=>n===i:a5),!!e.static,e.enables)}of(e){return new VO([],this,0,e)}compute(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new VO(e,this,1,n)}computeN(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new VO(e,this,2,n)}from(e,n){return n||(n=i=>i),this.compute([e],i=>n(i.field(e)))}}function a5(r,e){return r==e||r.length==e.length&&r.every((n,i)=>n===e[i])}class VO{constructor(e,n,i,s){this.dependencies=e,this.facet=n,this.type=i,this.value=s,this.id=o5++}dynamicSlot(e){var n;let i=this.value,s=this.facet.compareInput,o=this.id,a=e[o]>>1,l=this.type==2,h=!1,u=!1,f=[];for(let p of this.dependencies)p=="doc"?h=!0:p=="selection"?u=!0:((n=e[p.id])!==null&&n!==void 0?n:1)&1||f.push(e[p.id]);return{create(p){return p.values[a]=i(p),1},update(p,m){if(h&&m.docChanged||u&&(m.docChanged||m.selection)||s3(p,f)){let v=i(p);if(l?!d8(v,p.values[a],s):!s(v,p.values[a]))return p.values[a]=v,1}return 0},reconfigure:(p,m)=>{let v,y=m.config.address[o];if(y!=null){let x=LS(m,y);if(this.dependencies.every(w=>w instanceof Pt?m.facet(w)===p.facet(w):w instanceof ws?m.field(w,!1)==p.field(w,!1):!0)||(l?d8(v=i(p),x,s):s(v=i(p),x)))return p.values[a]=x,0}else v=i(p);return p.values[a]=v,1}}}}function d8(r,e,n){if(r.length!=e.length)return!1;for(let i=0;i<r.length;i++)if(!n(r[i],e[i]))return!1;return!0}function s3(r,e){let n=!1;for(let i of e)u1(r,i)&1&&(n=!0);return n}function SPe(r,e,n){let i=n.map(h=>r[h.id]),s=n.map(h=>h.type),o=i.filter(h=>!(h&1)),a=r[e.id]>>1;function l(h){let u=[];for(let f=0;f<i.length;f++){let p=LS(h,i[f]);if(s[f]==2)for(let m of p)u.push(m);else u.push(p)}return e.combine(u)}return{create(h){for(let u of i)u1(h,u);return h.values[a]=l(h),1},update(h,u){if(!s3(h,o))return 0;let f=l(h);return e.compare(f,h.values[a])?0:(h.values[a]=f,1)},reconfigure(h,u){let f=s3(h,i),p=u.config.facets[e.id],m=u.facet(e);if(p&&!f&&a5(n,p))return h.values[a]=m,0;let v=l(h);return e.compare(v,m)?(h.values[a]=m,0):(h.values[a]=v,1)}}}const f8=Pt.define({static:!0});class ws{constructor(e,n,i,s,o){this.id=e,this.createF=n,this.updateF=i,this.compareF=s,this.spec=o,this.provides=void 0}static define(e){let n=new ws(o5++,e.create,e.update,e.compare||((i,s)=>i===s),e);return e.provide&&(n.provides=e.provide(n)),n}create(e){let n=e.facet(f8).find(i=>i.field==this);return((n==null?void 0:n.create)||this.createF)(e)}slot(e){let n=e[this.id]>>1;return{create:i=>(i.values[n]=this.create(i),1),update:(i,s)=>{let o=i.values[n],a=this.updateF(o,s);return this.compareF(o,a)?0:(i.values[n]=a,1)},reconfigure:(i,s)=>s.config.address[this.id]!=null?(i.values[n]=s.field(this),0):(i.values[n]=this.create(i),1)}}init(e){return[this,f8.of({field:this,create:e})]}get extension(){return this}}const xf={lowest:4,low:3,default:2,high:1,highest:0};function py(r){return e=>new Ej(e,r)}const kp={highest:py(xf.highest),high:py(xf.high),default:py(xf.default),low:py(xf.low),lowest:py(xf.lowest)};class Ej{constructor(e,n){this.inner=e,this.prec=n}}class $2{of(e){return new o3(this,e)}reconfigure(e){return $2.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class o3{constructor(e,n){this.compartment=e,this.inner=n}}class DS{constructor(e,n,i,s,o,a){for(this.base=e,this.compartments=n,this.dynamicSlots=i,this.address=s,this.staticValues=o,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let n=this.address[e.id];return n==null?e.default:this.staticValues[n>>1]}static resolve(e,n,i){let s=[],o=Object.create(null),a=new Map;for(let m of CPe(e,n,a))m instanceof ws?s.push(m):(o[m.facet.id]||(o[m.facet.id]=[])).push(m);let l=Object.create(null),h=[],u=[];for(let m of s)l[m.id]=u.length<<1,u.push(v=>m.slot(v));let f=i==null?void 0:i.config.facets;for(let m in o){let v=o[m],y=v[0].facet,x=f&&f[m]||[];if(v.every(w=>w.type==0))if(l[y.id]=h.length<<1|1,a5(x,v))h.push(i.facet(y));else{let w=y.combine(v.map(S=>S.value));h.push(i&&y.compare(w,i.facet(y))?i.facet(y):w)}else{for(let w of v)w.type==0?(l[w.id]=h.length<<1|1,h.push(w.value)):(l[w.id]=u.length<<1,u.push(S=>w.dynamicSlot(S)));l[y.id]=u.length<<1,u.push(w=>SPe(w,y,v))}}let p=u.map(m=>m(l));return new DS(e,a,p,l,h,o)}}function CPe(r,e,n){let i=[[],[],[],[],[]],s=new Map;function o(a,l){let h=s.get(a);if(h!=null){if(h<=l)return;let u=i[h].indexOf(a);u>-1&&i[h].splice(u,1),a instanceof o3&&n.delete(a.compartment)}if(s.set(a,l),Array.isArray(a))for(let u of a)o(u,l);else if(a instanceof o3){if(n.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(a.compartment)||a.inner;n.set(a.compartment,u),o(u,l)}else if(a instanceof Ej)o(a.inner,a.prec);else if(a instanceof ws)i[l].push(a),a.provides&&o(a.provides,l);else if(a instanceof VO)i[l].push(a),a.facet.extensions&&o(a.facet.extensions,xf.default);else{let u=a.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);o(u,l)}}return o(r,xf.default),i.reduce((a,l)=>a.concat(l))}function u1(r,e){if(e&1)return 2;let n=e>>1,i=r.status[n];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;r.status[n]=4;let s=r.computeSlot(r,r.config.dynamicSlots[n]);return r.status[n]=2|s}function LS(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const Mj=Pt.define(),a3=Pt.define({combine:r=>r.some(e=>e),static:!0}),Aj=Pt.define({combine:r=>r.length?r[0]:void 0,static:!0}),kj=Pt.define(),Pj=Pt.define(),Rj=Pt.define(),Ij=Pt.define({combine:r=>r.length?r[0]:!1});class Nh{constructor(e,n){this.type=e,this.value=n}static define(){return new TPe}}class TPe{of(e){return new Nh(this,e)}}class EPe{constructor(e){this.map=e}of(e){return new Ri(this,e)}}class Ri{constructor(e,n){this.type=e,this.value=n}map(e){let n=this.type.map(this.value,e);return n===void 0?void 0:n==this.value?this:new Ri(this.type,n)}is(e){return this.type==e}static define(e={}){return new EPe(e.map||(n=>n))}static mapEffects(e,n){if(!e.length)return e;let i=[];for(let s of e){let o=s.map(n);o&&i.push(o)}return i}}Ri.reconfigure=Ri.define();Ri.appendConfig=Ri.define();class zr{constructor(e,n,i,s,o,a){this.startState=e,this.changes=n,this.selection=i,this.effects=s,this.annotations=o,this.scrollIntoView=a,this._doc=null,this._state=null,i&&Tj(i,n.newLength),o.some(l=>l.type==zr.time)||(this.annotations=o.concat(zr.time.of(Date.now())))}static create(e,n,i,s,o,a){return new zr(e,n,i,s,o,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let n of this.annotations)if(n.type==e)return n.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let n=this.annotation(zr.userEvent);return!!(n&&(n==e||n.length>e.length&&n.slice(0,e.length)==e&&n[e.length]=="."))}}zr.time=Nh.define();zr.userEvent=Nh.define();zr.addToHistory=Nh.define();zr.remote=Nh.define();function MPe(r,e){let n=[];for(let i=0,s=0;;){let o,a;if(i<r.length&&(s==e.length||e[s]>=r[i]))o=r[i++],a=r[i++];else if(s<e.length)o=e[s++],a=e[s++];else return n;!n.length||n[n.length-1]<o?n.push(o,a):n[n.length-1]<a&&(n[n.length-1]=a)}}function Nj(r,e,n){var i;let s,o,a;return n?(s=e.changes,o=$r.empty(e.changes.length),a=r.changes.compose(e.changes)):(s=e.changes.map(r.changes),o=r.changes.mapDesc(e.changes,!0),a=r.changes.compose(s)),{changes:a,selection:e.selection?e.selection.map(o):(i=r.selection)===null||i===void 0?void 0:i.map(s),effects:Ri.mapEffects(r.effects,s).concat(Ri.mapEffects(e.effects,o)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function l3(r,e,n){let i=e.selection,s=vg(e.annotations);return e.userEvent&&(s=s.concat(zr.userEvent.of(e.userEvent))),{changes:e.changes instanceof $r?e.changes:$r.of(e.changes||[],n,r.facet(Aj)),selection:i&&(i instanceof et?i:et.single(i.anchor,i.head)),effects:vg(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function Dj(r,e,n){let i=l3(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(n=!1);for(let o=1;o<e.length;o++){e[o].filter===!1&&(n=!1);let a=!!e[o].sequential;i=Nj(i,l3(r,e[o],a?i.changes.newLength:r.doc.length),a)}let s=zr.create(r,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return kPe(n?APe(s):s)}function APe(r){let e=r.startState,n=!0;for(let s of e.facet(kj)){let o=s(r);if(o===!1){n=!1;break}Array.isArray(o)&&(n=n===!0?o:MPe(n,o))}if(n!==!0){let s,o;if(n===!1)o=r.changes.invertedDesc,s=$r.empty(e.doc.length);else{let a=r.changes.filter(n);s=a.changes,o=a.filtered.mapDesc(a.changes).invertedDesc}r=zr.create(e,s,r.selection&&r.selection.map(o),Ri.mapEffects(r.effects,o),r.annotations,r.scrollIntoView)}let i=e.facet(Pj);for(let s=i.length-1;s>=0;s--){let o=i[s](r);o instanceof zr?r=o:Array.isArray(o)&&o.length==1&&o[0]instanceof zr?r=o[0]:r=Dj(e,vg(o),!1)}return r}function kPe(r){let e=r.startState,n=e.facet(Rj),i=r;for(let s=n.length-1;s>=0;s--){let o=n[s](r);o&&Object.keys(o).length&&(i=Nj(i,l3(e,o,r.changes.newLength),!0))}return i==r?r:zr.create(e,r.changes,r.selection,i.effects,i.annotations,i.scrollIntoView)}const PPe=[];function vg(r){return r==null?PPe:Array.isArray(r)?r:[r]}var jn=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(jn||(jn={}));const RPe=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let c3;try{c3=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function IPe(r){if(c3)return c3.test(r);for(let e=0;e<r.length;e++){let n=r[e];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||RPe.test(n)))return!0}return!1}function NPe(r){return e=>{if(!/\S/.test(e))return jn.Space;if(IPe(e))return jn.Word;for(let n=0;n<r.length;n++)if(e.indexOf(r[n])>-1)return jn.Word;return jn.Other}}class an{constructor(e,n,i,s,o,a){this.config=e,this.doc=n,this.selection=i,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=o,a&&(a._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)u1(this,l<<1);this.computeSlot=null}field(e,n=!0){let i=this.config.address[e.id];if(i==null){if(n)throw new RangeError("Field is not present in this state");return}return u1(this,i),LS(this,i)}update(...e){return Dj(this,e,!0)}applyTransaction(e){let n=this.config,{base:i,compartments:s}=n;for(let l of e.effects)l.is($2.reconfigure)?(n&&(s=new Map,n.compartments.forEach((h,u)=>s.set(u,h)),n=null),s.set(l.value.compartment,l.value.extension)):l.is(Ri.reconfigure)?(n=null,i=l.value):l.is(Ri.appendConfig)&&(n=null,i=vg(i).concat(l.value));let o;n?o=e.startState.values.slice():(n=DS.resolve(i,s,this),o=new an(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(h,u)=>u.reconfigure(h,this),null).values);let a=e.startState.facet(a3)?e.newSelection:e.newSelection.asSingle();new an(n,e.newDoc,a,o,(l,h)=>h.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:e},range:et.cursor(n.from+e.length)}))}changeByRange(e){let n=this.selection,i=e(n.ranges[0]),s=this.changes(i.changes),o=[i.range],a=vg(i.effects);for(let l=1;l<n.ranges.length;l++){let h=e(n.ranges[l]),u=this.changes(h.changes),f=u.map(s);for(let m=0;m<l;m++)o[m]=o[m].map(f);let p=s.mapDesc(u,!0);o.push(h.range.map(p)),s=s.compose(f),a=Ri.mapEffects(a,f).concat(Ri.mapEffects(vg(h.effects),p))}return{changes:s,selection:et.create(o,n.mainIndex),effects:a}}changes(e=[]){return e instanceof $r?e:$r.of(e,this.doc.length,this.facet(an.lineSeparator))}toText(e){return bn.of(e.split(this.facet(an.lineSeparator)||i3))}sliceDoc(e=0,n=this.doc.length){return this.doc.sliceString(e,n,this.lineBreak)}facet(e){let n=this.config.address[e.id];return n==null?e.default:(u1(this,n),LS(this,n))}toJSON(e){let n={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let s=e[i];s instanceof ws&&this.config.address[s.id]!=null&&(n[i]=s.spec.toJSON(this.field(e[i]),this))}return n}static fromJSON(e,n={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(i){for(let o in i)if(Object.prototype.hasOwnProperty.call(e,o)){let a=i[o],l=e[o];s.push(a.init(h=>a.spec.fromJSON(l,h)))}}return an.create({doc:e.doc,selection:et.fromJSON(e.selection),extensions:n.extensions?s.concat([n.extensions]):s})}static create(e={}){let n=DS.resolve(e.extensions||[],new Map),i=e.doc instanceof bn?e.doc:bn.of((e.doc||"").split(n.staticFacet(an.lineSeparator)||i3)),s=e.selection?e.selection instanceof et?e.selection:et.single(e.selection.anchor,e.selection.head):et.single(0);return Tj(s,i.length),n.staticFacet(a3)||(s=s.asSingle()),new an(n,i,s,n.dynamicSlots.map(()=>null),(o,a)=>a.create(o),null)}get tabSize(){return this.facet(an.tabSize)}get lineBreak(){return this.facet(an.lineSeparator)||`
`}get readOnly(){return this.facet(Ij)}phrase(e,...n){for(let i of this.facet(an.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return n.length&&(e=e.replace(/\$(\$|\d*)/g,(i,s)=>{if(s=="$")return"$";let o=+(s||1);return!o||o>n.length?i:n[o-1]})),e}languageDataAt(e,n,i=-1){let s=[];for(let o of this.facet(Mj))for(let a of o(this,n,i))Object.prototype.hasOwnProperty.call(a,e)&&s.push(a[e]);return s}charCategorizer(e){return NPe(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:n,from:i,length:s}=this.doc.lineAt(e),o=this.charCategorizer(e),a=e-i,l=e-i;for(;a>0;){let h=ys(n,a,!1);if(o(n.slice(h,a))!=jn.Word)break;a=h}for(;l<s;){let h=ys(n,l);if(o(n.slice(l,h))!=jn.Word)break;l=h}return a==l?null:et.range(a+i,l+i)}}an.allowMultipleSelections=a3;an.tabSize=Pt.define({combine:r=>r.length?r[0]:4});an.lineSeparator=Aj;an.readOnly=Ij;an.phrases=Pt.define({compare(r,e){let n=Object.keys(r),i=Object.keys(e);return n.length==i.length&&n.every(s=>r[s]==e[s])}});an.languageData=Mj;an.changeFilter=kj;an.transactionFilter=Pj;an.transactionExtender=Rj;$2.reconfigure=Ri.define();function _c(r,e,n={}){let i={};for(let s of r)for(let o of Object.keys(s)){let a=s[o],l=i[o];if(l===void 0)i[o]=a;else if(!(l===a||a===void 0))if(Object.hasOwnProperty.call(n,o))i[o]=n[o](l,a);else throw new Error("Config merge conflict for field "+o)}for(let s in e)i[s]===void 0&&(i[s]=e[s]);return i}class cp{eq(e){return this==e}range(e,n=e){return h3.create(e,n,this)}}cp.prototype.startSide=cp.prototype.endSide=0;cp.prototype.point=!1;cp.prototype.mapMode=Ys.TrackDel;let h3=class Lj{constructor(e,n,i){this.from=e,this.to=n,this.value=i}static create(e,n,i){return new Lj(e,n,i)}};function u3(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class l5{constructor(e,n,i,s){this.from=e,this.to=n,this.value=i,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,n,i,s=0){let o=i?this.to:this.from;for(let a=s,l=o.length;;){if(a==l)return a;let h=a+l>>1,u=o[h]-e||(i?this.value[h].endSide:this.value[h].startSide)-n;if(h==a)return u>=0?a:l;u>=0?l=h:a=h+1}}between(e,n,i,s){for(let o=this.findIndex(n,-1e9,!0),a=this.findIndex(i,1e9,!1,o);o<a;o++)if(s(this.from[o]+e,this.to[o]+e,this.value[o])===!1)return!1}map(e,n){let i=[],s=[],o=[],a=-1,l=-1;for(let h=0;h<this.value.length;h++){let u=this.value[h],f=this.from[h]+e,p=this.to[h]+e,m,v;if(f==p){let y=n.mapPos(f,u.startSide,u.mapMode);if(y==null||(m=v=y,u.startSide!=u.endSide&&(v=n.mapPos(f,u.endSide),v<m)))continue}else if(m=n.mapPos(f,u.startSide),v=n.mapPos(p,u.endSide),m>v||m==v&&u.startSide>0&&u.endSide<=0)continue;(v-m||u.endSide-u.startSide)<0||(a<0&&(a=m),u.point&&(l=Math.max(l,v-m)),i.push(u),s.push(m-a),o.push(v-a))}return{mapped:i.length?new l5(s,o,i,l):null,pos:a}}}class sn{constructor(e,n,i,s){this.chunkPos=e,this.chunk=n,this.nextLayer=i,this.maxPoint=s}static create(e,n,i,s){return new sn(e,n,i,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let n of this.chunk)e+=n.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:n=[],sort:i=!1,filterFrom:s=0,filterTo:o=this.length}=e,a=e.filter;if(n.length==0&&!a)return this;if(i&&(n=n.slice().sort(u3)),this.isEmpty)return n.length?sn.of(n):this;let l=new Bj(this,null,-1).goto(0),h=0,u=[],f=new ad;for(;l.value||h<n.length;)if(h<n.length&&(l.from-n[h].from||l.startSide-n[h].value.startSide)>=0){let p=n[h++];f.addInner(p.from,p.to,p.value)||u.push(p)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(h==n.length||this.chunkEnd(l.chunkIndex)<n[h].from)&&(!a||s>this.chunkEnd(l.chunkIndex)||o<this.chunkPos[l.chunkIndex])&&f.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!a||s>l.to||o<l.from||a(l.from,l.to,l.value))&&(f.addInner(l.from,l.to,l.value)||u.push(h3.create(l.from,l.to,l.value))),l.next());return f.finishInner(this.nextLayer.isEmpty&&!u.length?sn.empty:this.nextLayer.update({add:u,filter:a,filterFrom:s,filterTo:o}))}map(e){if(e.empty||this.isEmpty)return this;let n=[],i=[],s=-1;for(let a=0;a<this.chunk.length;a++){let l=this.chunkPos[a],h=this.chunk[a],u=e.touchesRange(l,l+h.length);if(u===!1)s=Math.max(s,h.maxPoint),n.push(h),i.push(e.mapPos(l));else if(u===!0){let{mapped:f,pos:p}=h.map(l,e);f&&(s=Math.max(s,f.maxPoint),n.push(f),i.push(p))}}let o=this.nextLayer.map(e);return n.length==0?o:new sn(i,n,o||sn.empty,s)}between(e,n,i){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let o=this.chunkPos[s],a=this.chunk[s];if(n>=o&&e<=o+a.length&&a.between(o,e-o,n-o,i)===!1)return}this.nextLayer.between(e,n,i)}}iter(e=0){return K1.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,n=0){return K1.from(e).goto(n)}static compare(e,n,i,s,o=-1){let a=e.filter(p=>p.maxPoint>0||!p.isEmpty&&p.maxPoint>=o),l=n.filter(p=>p.maxPoint>0||!p.isEmpty&&p.maxPoint>=o),h=p8(a,l,i),u=new my(a,h,o),f=new my(l,h,o);i.iterGaps((p,m,v)=>m8(u,p,f,m,v,s)),i.empty&&i.length==0&&m8(u,0,f,0,0,s)}static eq(e,n,i=0,s){s==null&&(s=999999999);let o=e.filter(f=>!f.isEmpty&&n.indexOf(f)<0),a=n.filter(f=>!f.isEmpty&&e.indexOf(f)<0);if(o.length!=a.length)return!1;if(!o.length)return!0;let l=p8(o,a),h=new my(o,l,0).goto(i),u=new my(a,l,0).goto(i);for(;;){if(h.to!=u.to||!d3(h.active,u.active)||h.point&&(!u.point||!h.point.eq(u.point)))return!1;if(h.to>s)return!0;h.next(),u.next()}}static spans(e,n,i,s,o=-1){let a=new my(e,null,o).goto(n),l=n,h=a.openStart;for(;;){let u=Math.min(a.to,i);if(a.point){let f=a.activeForPoint(a.to),p=a.pointFrom<n?f.length+1:a.point.startSide<0?f.length:Math.min(f.length,h);s.point(l,u,a.point,f,p,a.pointRank),h=Math.min(a.openEnd(u),f.length)}else u>l&&(s.span(l,u,a.active,h),h=a.openEnd(u));if(a.to>i)return h+(a.point&&a.to>i?1:0);l=a.to,a.next()}}static of(e,n=!1){let i=new ad;for(let s of e instanceof h3?[e]:n?DPe(e):e)i.add(s.from,s.to,s.value);return i.finish()}static join(e){if(!e.length)return sn.empty;let n=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let s=e[i];s!=sn.empty;s=s.nextLayer)n=new sn(s.chunkPos,s.chunk,n,Math.max(s.maxPoint,n.maxPoint));return n}}sn.empty=new sn([],[],null,-1);function DPe(r){if(r.length>1)for(let e=r[0],n=1;n<r.length;n++){let i=r[n];if(u3(e,i)>0)return r.slice().sort(u3);e=i}return r}sn.empty.nextLayer=sn.empty;class ad{finishChunk(e){this.chunks.push(new l5(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,n,i){this.addInner(e,n,i)||(this.nextLayer||(this.nextLayer=new ad)).add(e,n,i)}addInner(e,n,i){let s=e-this.lastTo||i.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(n-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=n,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,n-e)),!0)}addChunk(e,n){if((e-this.lastTo||n.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,n.maxPoint),this.chunks.push(n),this.chunkPos.push(e);let i=n.value.length-1;return this.last=n.value[i],this.lastFrom=n.from[i]+e,this.lastTo=n.to[i]+e,!0}finish(){return this.finishInner(sn.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let n=sn.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,n}}function p8(r,e,n){let i=new Map;for(let o of r)for(let a=0;a<o.chunk.length;a++)o.chunk[a].maxPoint<=0&&i.set(o.chunk[a],o.chunkPos[a]);let s=new Set;for(let o of e)for(let a=0;a<o.chunk.length;a++){let l=i.get(o.chunk[a]);l!=null&&(n?n.mapPos(l):l)==o.chunkPos[a]&&!(n!=null&&n.touchesRange(l,l+o.chunk[a].length))&&s.add(o.chunk[a])}return s}class Bj{constructor(e,n,i,s=0){this.layer=e,this.skip=n,this.minPoint=i,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,n=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,n,!1),this}gotoInner(e,n,i){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],n,!0);(!i||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,n){(this.to-e||this.endSide-n)<0&&this.gotoInner(e,n,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],n=this.layer.chunk[this.chunkIndex],i=e+n.from[this.rangeIndex];if(this.from=i,this.to=e+n.to[this.rangeIndex],this.value=n.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class K1{constructor(e){this.heap=e}static from(e,n=null,i=-1){let s=[];for(let o=0;o<e.length;o++)for(let a=e[o];!a.isEmpty;a=a.nextLayer)a.maxPoint>=i&&s.push(new Bj(a,n,i,o));return s.length==1?s[0]:new K1(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,n=-1e9){for(let i of this.heap)i.goto(e,n);for(let i=this.heap.length>>1;i>=0;i--)iA(this.heap,i);return this.next(),this}forward(e,n){for(let i of this.heap)i.forward(e,n);for(let i=this.heap.length>>1;i>=0;i--)iA(this.heap,i);(this.to-e||this.value.endSide-n)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),iA(this.heap,0)}}}function iA(r,e){for(let n=r[e];;){let i=(e<<1)+1;if(i>=r.length)break;let s=r[i];if(i+1<r.length&&s.compare(r[i+1])>=0&&(s=r[i+1],i++),n.compare(s)<0)break;r[i]=n,r[e]=s,e=i}}class my{constructor(e,n,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=K1.from(e,n,i)}goto(e,n=-1e9){return this.cursor.goto(e,n),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=n,this.openStart=-1,this.next(),this}forward(e,n){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-n)<0;)this.removeActive(this.minActive);this.cursor.forward(e,n)}removeActive(e){O_(this.active,e),O_(this.activeTo,e),O_(this.activeRank,e),this.minActive=g8(this.active,this.activeTo)}addActive(e){let n=0,{value:i,to:s,rank:o}=this.cursor;for(;n<this.activeRank.length&&(o-this.activeRank[n]||s-this.activeTo[n])>0;)n++;S_(this.active,n,i),S_(this.activeTo,n,s),S_(this.activeRank,n,o),e&&S_(e,n,this.cursor.from),this.minActive=g8(this.active,this.activeTo)}next(){let e=this.to,n=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&O_(i,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(i),this.cursor.next();else if(n&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let s=i.length-1;s>=0&&i[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let n=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&n.push(this.active[i]);return n.reverse()}openEnd(e){let n=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)n++;return n}}function m8(r,e,n,i,s,o){r.goto(e),n.goto(i);let a=i+s,l=i,h=i-e;for(;;){let u=r.to+h-n.to||r.endSide-n.endSide,f=u<0?r.to+h:n.to,p=Math.min(f,a);if(r.point||n.point?r.point&&n.point&&(r.point==n.point||r.point.eq(n.point))&&d3(r.activeForPoint(r.to),n.activeForPoint(n.to))||o.comparePoint(l,p,r.point,n.point):p>l&&!d3(r.active,n.active)&&o.compareRange(l,p,r.active,n.active),f>a)break;l=f,u<=0&&r.next(),u>=0&&n.next()}}function d3(r,e){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!=e[n]&&!r[n].eq(e[n]))return!1;return!0}function O_(r,e){for(let n=e,i=r.length-1;n<i;n++)r[n]=r[n+1];r.pop()}function S_(r,e,n){for(let i=r.length-1;i>=e;i--)r[i+1]=r[i];r[e]=n}function g8(r,e){let n=-1,i=1e9;for(let s=0;s<e.length;s++)(e[s]-i||r[s].endSide-r[n].endSide)<0&&(n=s,i=e[s]);return n}function g0(r,e,n=r.length){let i=0;for(let s=0;s<n;)r.charCodeAt(s)==9?(i+=e-i%e,s++):(i++,s=ys(r,s));return i}function f3(r,e,n,i){for(let s=0,o=0;;){if(o>=e)return s;if(s==r.length)break;o+=r.charCodeAt(s)==9?n-o%n:1,s=ys(r,s)}return i===!0?-1:r.length}const p3="ͼ",v8=typeof Symbol>"u"?"__"+p3:Symbol.for(p3),m3=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),y8=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class ld{constructor(e,n){this.rules=[];let{finish:i}=n||{};function s(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function o(a,l,h,u){let f=[],p=/^@(\w+)\b/.exec(a[0]),m=p&&p[1]=="keyframes";if(p&&l==null)return h.push(a[0]+";");for(let v in l){let y=l[v];if(/&/.test(v))o(v.split(/,\s*/).map(x=>a.map(w=>x.replace(/&/,w))).reduce((x,w)=>x.concat(w)),y,h);else if(y&&typeof y=="object"){if(!p)throw new RangeError("The value of a property ("+v+") should be a primitive value.");o(s(v),y,f,m)}else y!=null&&f.push(v.replace(/_.*/,"").replace(/[A-Z]/g,x=>"-"+x.toLowerCase())+": "+y+";")}(f.length||m)&&h.push((i&&!p&&!u?a.map(i):a).join(", ")+" {"+f.join(" ")+"}")}for(let a in e)o(s(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=y8[v8]||1;return y8[v8]=e+1,p3+e.toString(36)}static mount(e,n,i){let s=e[m3],o=i&&i.nonce;s?o&&s.setNonce(o):s=new LPe(e,o),s.mount(Array.isArray(n)?n:[n],e)}}let b8=new Map;class LPe{constructor(e,n){let i=e.ownerDocument||e,s=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&s.CSSStyleSheet){let o=b8.get(i);if(o)return e[m3]=o;this.sheet=new s.CSSStyleSheet,b8.set(i,this)}else this.styleTag=i.createElement("style"),n&&this.styleTag.setAttribute("nonce",n);this.modules=[],e[m3]=this}mount(e,n){let i=this.sheet,s=0,o=0;for(let a=0;a<e.length;a++){let l=e[a],h=this.modules.indexOf(l);if(h<o&&h>-1&&(this.modules.splice(h,1),o--,h=-1),h==-1){if(this.modules.splice(o++,0,l),i)for(let u=0;u<l.rules.length;u++)i.insertRule(l.rules[u],s++)}else{for(;o<h;)s+=this.modules[o++].rules.length;s+=l.rules.length,o++}}if(i)n.adoptedStyleSheets.indexOf(this.sheet)<0&&(n.adoptedStyleSheets=[this.sheet,...n.adoptedStyleSheets]);else{let a="";for(let h=0;h<this.modules.length;h++)a+=this.modules[h].getRules()+`
`;this.styleTag.textContent=a;let l=n.head||n;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var cd={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},J1={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},BPe=typeof navigator<"u"&&/Mac/.test(navigator.platform),$Pe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ds=0;ds<10;ds++)cd[48+ds]=cd[96+ds]=String(ds);for(var ds=1;ds<=24;ds++)cd[ds+111]="F"+ds;for(var ds=65;ds<=90;ds++)cd[ds]=String.fromCharCode(ds+32),J1[ds]=String.fromCharCode(ds);for(var nA in cd)J1.hasOwnProperty(nA)||(J1[nA]=cd[nA]);function UPe(r){var e=BPe&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||$Pe&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",n=!e&&r.key||(r.shiftKey?J1:cd)[r.keyCode]||r.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}function eb(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function g3(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function VPe(r){let e=r.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function FO(r,e){if(!e.anchorNode)return!1;try{return g3(r,e.anchorNode)}catch{return!1}}function tb(r){return r.nodeType==3?up(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function d1(r,e,n,i){return n?x8(r,e,n,i,-1)||x8(r,e,n,i,1):!1}function hp(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function BS(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function x8(r,e,n,i,s){for(;;){if(r==n&&e==i)return!0;if(e==(s<0?0:Ch(r))){if(r.nodeName=="DIV")return!1;let o=r.parentNode;if(!o||o.nodeType!=1)return!1;e=hp(r)+(s<0?0:1),r=o}else if(r.nodeType==1){if(r=r.childNodes[e+(s<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=s<0?Ch(r):0}else return!1}}function Ch(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function U2(r,e){let n=e?r.left:r.right;return{left:n,right:n,top:r.top,bottom:r.bottom}}function FPe(r){let e=r.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function $j(r,e){let n=e.width/r.offsetWidth,i=e.height/r.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.width-r.offsetWidth)<1)&&(n=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-r.offsetHeight)<1)&&(i=1),{scaleX:n,scaleY:i}}function zPe(r,e,n,i,s,o,a,l){let h=r.ownerDocument,u=h.defaultView||window;for(let f=r,p=!1;f&&!p;)if(f.nodeType==1){let m,v=f==h.body,y=1,x=1;if(v)m=FPe(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(f).position)&&(p=!0),f.scrollHeight<=f.clientHeight&&f.scrollWidth<=f.clientWidth){f=f.assignedSlot||f.parentNode;continue}let O=f.getBoundingClientRect();({scaleX:y,scaleY:x}=$j(f,O)),m={left:O.left,right:O.left+f.clientWidth*y,top:O.top,bottom:O.top+f.clientHeight*x}}let w=0,S=0;if(s=="nearest")e.top<m.top?(S=-(m.top-e.top+a),n>0&&e.bottom>m.bottom+S&&(S=e.bottom-m.bottom+S+a)):e.bottom>m.bottom&&(S=e.bottom-m.bottom+a,n<0&&e.top-S<m.top&&(S=-(m.top+S-e.top+a)));else{let O=e.bottom-e.top,_=m.bottom-m.top;S=(s=="center"&&O<=_?e.top+O/2-_/2:s=="start"||s=="center"&&n<0?e.top-a:e.bottom-_+a)-m.top}if(i=="nearest"?e.left<m.left?(w=-(m.left-e.left+o),n>0&&e.right>m.right+w&&(w=e.right-m.right+w+o)):e.right>m.right&&(w=e.right-m.right+o,n<0&&e.left<m.left+w&&(w=-(m.left+w-e.left+o))):w=(i=="center"?e.left+(e.right-e.left)/2-(m.right-m.left)/2:i=="start"==l?e.left-o:e.right-(m.right-m.left)+o)-m.left,w||S)if(v)u.scrollBy(w,S);else{let O=0,_=0;if(S){let T=f.scrollTop;f.scrollTop+=S/x,_=(f.scrollTop-T)*x}if(w){let T=f.scrollLeft;f.scrollLeft+=w/y,O=(f.scrollLeft-T)*y}e={left:e.left-O,top:e.top-_,right:e.right-O,bottom:e.bottom-_},O&&Math.abs(O-w)<1&&(i="nearest"),_&&Math.abs(_-S)<1&&(s="nearest")}if(v)break;f=f.assignedSlot||f.parentNode}else if(f.nodeType==11)f=f.host;else break}function XPe(r){let e=r.ownerDocument,n,i;for(let s=r.parentNode;s&&!(s==e.body||n&&i);)if(s.nodeType==1)!i&&s.scrollHeight>s.clientHeight&&(i=s),!n&&s.scrollWidth>s.clientWidth&&(n=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:n,y:i}}class WPe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:n,focusNode:i}=e;this.set(n,Math.min(e.anchorOffset,n?Ch(n):0),i,Math.min(e.focusOffset,i?Ch(i):0))}set(e,n,i,s){this.anchorNode=e,this.anchorOffset=n,this.focusNode=i,this.focusOffset=s}}let Tm=null;function Uj(r){if(r.setActive)return r.setActive();if(Tm)return r.focus(Tm);let e=[];for(let n=r;n&&(e.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(r.focus(Tm==null?{get preventScroll(){return Tm={preventScroll:!0},!0}}:void 0),!Tm){Tm=!1;for(let n=0;n<e.length;){let i=e[n++],s=e[n++],o=e[n++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=o&&(i.scrollLeft=o)}}}let w8;function up(r,e,n=e){let i=w8||(w8=document.createRange());return i.setEnd(r,n),i.setStart(r,e),i}function yg(r,e,n,i){let s={key:e,code:e,keyCode:n,which:n,cancelable:!0};i&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=i);let o=new KeyboardEvent("keydown",s);o.synthetic=!0,r.dispatchEvent(o);let a=new KeyboardEvent("keyup",s);return a.synthetic=!0,r.dispatchEvent(a),o.defaultPrevented||a.defaultPrevented}function GPe(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function Vj(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function HPe(r,e){let n=e.focusNode,i=e.focusOffset;if(!n||e.anchorNode!=n||e.anchorOffset!=i)return!1;for(i=Math.min(i,Ch(n));;)if(i){if(n.nodeType!=1)return!1;let s=n.childNodes[i-1];s.contentEditable=="false"?i--:(n=s,i=Ch(n))}else{if(n==r)return!0;i=hp(n),n=n.parentNode}}function Fj(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function zj(r,e){for(let n=r,i=e;;){if(n.nodeType==3&&i>0)return{node:n,offset:i};if(n.nodeType==1&&i>0){if(n.contentEditable=="false")return null;n=n.childNodes[i-1],i=Ch(n)}else if(n.parentNode&&!BS(n))i=hp(n),n=n.parentNode;else return null}}function Xj(r,e){for(let n=r,i=e;;){if(n.nodeType==3&&i<n.nodeValue.length)return{node:n,offset:i};if(n.nodeType==1&&i<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[i],i=0}else if(n.parentNode&&!BS(n))i=hp(n)+1,n=n.parentNode;else return null}}class ks{constructor(e,n,i=!0){this.node=e,this.offset=n,this.precise=i}static before(e,n){return new ks(e.parentNode,hp(e),n)}static after(e,n){return new ks(e.parentNode,hp(e)+1,n)}}const c5=[];class En{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let n=this.posAtStart;for(let i of this.children){if(i==e)return n;n+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,n){if(this.flags&2){let i=this.dom,s=null,o;for(let a of this.children){if(a.flags&7){if(!a.dom&&(o=s?s.nextSibling:i.firstChild)){let l=En.get(o);(!l||!l.parent&&l.canReuseDOM(a))&&a.reuseDOM(o)}a.sync(e,n),a.flags&=-8}if(o=s?s.nextSibling:i.firstChild,n&&!n.written&&n.node==i&&o!=a.dom&&(n.written=!0),a.dom.parentNode==i)for(;o&&o!=a.dom;)o=_8(o);else i.insertBefore(a.dom,o);s=a.dom}for(o=s?s.nextSibling:i.firstChild,o&&n&&n.node==i&&(n.written=!0);o;)o=_8(o)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,n),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,n){let i;if(e==this.dom)i=this.dom.childNodes[n];else{let s=Ch(e)==0?0:n==0?-1:1;for(;;){let o=e.parentNode;if(o==this.dom)break;s==0&&o.firstChild!=o.lastChild&&(e==o.firstChild?s=-1:s=1),e=o}s<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!En.get(i);)i=i.nextSibling;if(!i)return this.length;for(let s=0,o=0;;s++){let a=this.children[s];if(a.dom==i)return o;o+=a.length+a.breakAfter}}domBoundsAround(e,n,i=0){let s=-1,o=-1,a=-1,l=-1;for(let h=0,u=i,f=i;h<this.children.length;h++){let p=this.children[h],m=u+p.length;if(u<e&&m>n)return p.domBoundsAround(e,n,u);if(m>=e&&s==-1&&(s=h,o=u),u>n&&p.dom.parentNode==this.dom){a=h,l=f;break}f=m,u=m+p.breakAfter}return{from:o,to:l<0?i+this.length:l,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:a<this.children.length&&a>=0?this.children[a].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let n=this.parent;n;n=n.parent){if(e&&(n.flags|=2),n.flags&1)return;n.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let n=e.parent;if(!n)return e;e=n}}replaceChildren(e,n,i=c5){this.markDirty();for(let s=e;s<n;s++){let o=this.children[s];o.parent==this&&i.indexOf(o)<0&&o.destroy()}this.children.splice(e,n-e,...i);for(let s=0;s<i.length;s++)i[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Wj(this.children,e,this.children.length)}childPos(e,n=1){return this.childCursor().findPos(e,n)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,n,i,s,o,a){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}En.prototype.breakAfter=0;function _8(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class Wj{constructor(e,n,i){this.children=e,this.pos=n,this.i=i,this.off=0}findPos(e,n=1){for(;;){if(e>this.pos||e==this.pos&&(n>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Gj(r,e,n,i,s,o,a,l,h){let{children:u}=r,f=u.length?u[e]:null,p=o.length?o[o.length-1]:null,m=p?p.breakAfter:a;if(!(e==i&&f&&!a&&!m&&o.length<2&&f.merge(n,s,o.length?p:null,n==0,l,h))){if(i<u.length){let v=u[i];v&&(s<v.length||v.breakAfter&&(p!=null&&p.breakAfter))?(e==i&&(v=v.split(s),s=0),!m&&p&&v.merge(0,s,p,!0,0,h)?o[o.length-1]=v:((s||v.children.length&&!v.children[0].length)&&v.merge(0,s,null,!1,0,h),o.push(v))):v!=null&&v.breakAfter&&(p?p.breakAfter=1:a=1),i++}for(f&&(f.breakAfter=a,n>0&&(!a&&o.length&&f.merge(n,f.length,o[0],!1,l,0)?f.breakAfter=o.shift().breakAfter:(n<f.length||f.children.length&&f.children[f.children.length-1].length==0)&&f.merge(n,f.length,null,!1,l,0),e++));e<i&&o.length;)if(u[i-1].become(o[o.length-1]))i--,o.pop(),h=o.length?0:l;else if(u[e].become(o[0]))e++,o.shift(),l=o.length?0:h;else break;!o.length&&e&&i<u.length&&!u[e-1].breakAfter&&u[i].merge(0,0,u[e-1],!1,l,h)&&e--,(e<i||o.length)&&r.replaceChildren(e,i,o)}}function Hj(r,e,n,i,s,o){let a=r.childCursor(),{i:l,off:h}=a.findPos(n,1),{i:u,off:f}=a.findPos(e,-1),p=e-n;for(let m of i)p+=m.length;r.length+=p,Gj(r,u,f,l,h,i,0,s,o)}let vo=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},v3=typeof document<"u"?document:{documentElement:{style:{}}};const y3=/Edge\/(\d+)/.exec(vo.userAgent),Qj=/MSIE \d/.test(vo.userAgent),b3=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(vo.userAgent),V2=!!(Qj||b3||y3),O8=!V2&&/gecko\/(\d+)/i.test(vo.userAgent),rA=!V2&&/Chrome\/(\d+)/.exec(vo.userAgent),S8="webkitFontSmoothing"in v3.documentElement.style,jj=!V2&&/Apple Computer/.test(vo.vendor),C8=jj&&(/Mobile\/\w+/.test(vo.userAgent)||vo.maxTouchPoints>2);var It={mac:C8||/Mac/.test(vo.platform),windows:/Win/.test(vo.platform),linux:/Linux|X11/.test(vo.platform),ie:V2,ie_version:Qj?v3.documentMode||6:b3?+b3[1]:y3?+y3[1]:0,gecko:O8,gecko_version:O8?+(/Firefox\/(\d+)/.exec(vo.userAgent)||[0,0])[1]:0,chrome:!!rA,chrome_version:rA?+rA[1]:0,ios:C8,android:/Android\b/.test(vo.userAgent),webkit:S8,safari:jj,webkit_version:S8?+(/\bAppleWebKit\/(\d+)/.exec(vo.userAgent)||[0,0])[1]:0,tabSize:v3.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const QPe=256;class xl extends En{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,n){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(n&&n.node==this.dom&&(n.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,n,i){return this.flags&8||i&&(!(i instanceof xl)||this.length-(n-e)+i.length>QPe||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(n),this.markDirty(),!0)}split(e){let n=new xl(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),n.flags|=this.flags&8,n}localPosFromDOM(e,n){return e==this.dom?n:n?this.text.length:0}domAtPos(e){return new ks(this.dom,e)}domBoundsAround(e,n,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,n){return jPe(this.dom,e,n)}}class Th extends En{constructor(e,n=[],i=0){super(),this.mark=e,this.children=n,this.length=i;for(let s of n)s.setParent(this)}setAttrs(e){if(Vj(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let n in this.mark.attrs)e.setAttribute(n,this.mark.attrs[n]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,n){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,n)}merge(e,n,i,s,o,a){return i&&(!(i instanceof Th&&i.mark.eq(this.mark))||e&&o<=0||n<this.length&&a<=0)?!1:(Hj(this,e,n,i?i.children.slice():[],o-1,a-1),this.markDirty(),!0)}split(e){let n=[],i=0,s=-1,o=0;for(let l of this.children){let h=i+l.length;h>e&&n.push(i<e?l.split(e-i):l),s<0&&i>=e&&(s=o),i=h,o++}let a=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new Th(this.mark,n,a)}domAtPos(e){return Yj(this,e)}coordsAt(e,n){return Zj(this,e,n)}}function jPe(r,e,n){let i=r.nodeValue.length;e>i&&(e=i);let s=e,o=e,a=0;e==0&&n<0||e==i&&n>=0?It.chrome||It.gecko||(e?(s--,a=1):o<i&&(o++,a=-1)):n<0?s--:o<i&&o++;let l=up(r,s,o).getClientRects();if(!l.length)return null;let h=l[(a?a<0:n>=0)?0:l.length-1];return It.safari&&!a&&h.width==0&&(h=Array.prototype.find.call(l,u=>u.width)||h),a?U2(h,a<0):h||null}class Vu extends En{static create(e,n,i){return new Vu(e,n,i)}constructor(e,n,i){super(),this.widget=e,this.length=n,this.side=i,this.prevWidget=null}split(e){let n=Vu.create(this.widget,this.length-e,this.side);return this.length-=e,n}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,n,i,s,o,a){return i&&(!(i instanceof Vu)||!this.widget.compare(i.widget)||e>0&&o<=0||n<this.length&&a<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}become(e){return e instanceof Vu&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return bn.empty;let e=this;for(;e.parent;)e=e.parent;let{view:n}=e,i=n&&n.state.doc,s=this.posAtStart;return i?i.slice(s,s+this.length):bn.empty}domAtPos(e){return(this.length?e==0:this.side>0)?ks.before(this.dom):ks.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,n){let i=this.widget.coordsAt(this.dom,e,n);if(i)return i;let s=this.dom.getClientRects(),o=null;if(!s.length)return null;let a=this.side?this.side<0:e>0;for(let l=a?s.length-1:0;o=s[l],!(e>0?l==0:l==s.length-1||o.top<o.bottom);l+=a?-1:1);return U2(o,!a)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Gg extends En{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Gg&&e.side==this.side}split(){return new Gg(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?ks.before(this.dom):ks.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return bn.empty}get isHidden(){return!0}}xl.prototype.children=Vu.prototype.children=Gg.prototype.children=c5;function Yj(r,e){let n=r.dom,{children:i}=r,s=0;for(let o=0;s<i.length;s++){let a=i[s],l=o+a.length;if(!(l==o&&a.getSide()<=0)){if(e>o&&e<l&&a.dom.parentNode==n)return a.domAtPos(e-o);if(e<=o)break;o=l}}for(let o=s;o>0;o--){let a=i[o-1];if(a.dom.parentNode==n)return a.domAtPos(a.length)}for(let o=s;o<i.length;o++){let a=i[o];if(a.dom.parentNode==n)return a.domAtPos(0)}return new ks(n,0)}function qj(r,e,n){let i,{children:s}=r;n>0&&e instanceof Th&&s.length&&(i=s[s.length-1])instanceof Th&&i.mark.eq(e.mark)?qj(i,e.children[0],n-1):(s.push(e),e.setParent(r)),r.length+=e.length}function Zj(r,e,n){let i=null,s=-1,o=null,a=-1;function l(u,f){for(let p=0,m=0;p<u.children.length&&m<=f;p++){let v=u.children[p],y=m+v.length;y>=f&&(v.children.length?l(v,f-m):(!o||o.isHidden&&n>0)&&(y>f||m==y&&v.getSide()>0)?(o=v,a=f-m):(m<f||m==y&&v.getSide()<0&&!v.isHidden)&&(i=v,s=f-m)),m=y}}l(r,e);let h=(n<0?i:o)||i||o;return h?h.coordsAt(Math.max(0,h==i?s:a),n):YPe(r)}function YPe(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let n=tb(e);return n[n.length-1]||null}function x3(r,e){for(let n in r)n=="class"&&e.class?e.class+=" "+r.class:n=="style"&&e.style?e.style+=";"+r.style:e[n]=r[n];return e}const T8=Object.create(null);function $S(r,e,n){if(r==e)return!0;r||(r=T8),e||(e=T8);let i=Object.keys(r),s=Object.keys(e);if(i.length-(n&&i.indexOf(n)>-1?1:0)!=s.length-(n&&s.indexOf(n)>-1?1:0))return!1;for(let o of i)if(o!=n&&(s.indexOf(o)==-1||r[o]!==e[o]))return!1;return!0}function w3(r,e,n){let i=!1;if(e)for(let s in e)n&&s in n||(i=!0,s=="style"?r.style.cssText="":r.removeAttribute(s));if(n)for(let s in n)e&&e[s]==n[s]||(i=!0,s=="style"?r.style.cssText=n[s]:r.setAttribute(s,n[s]));return i}function qPe(r){let e=Object.create(null);for(let n=0;n<r.attributes.length;n++){let i=r.attributes[n];e[i.name]=i.value}return e}class wd{eq(e){return!1}updateDOM(e,n){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,n,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var eo=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(eo||(eo={}));class ui extends cp{constructor(e,n,i,s){super(),this.startSide=e,this.endSide=n,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(e){return new Zb(e)}static widget(e){let n=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return n+=i&&!e.inlineOrder?n>0?3e8:-4e8:n>0?1e8:-1e8,new hd(e,n,n,i,e.widget||null,!1)}static replace(e){let n=!!e.block,i,s;if(e.isBlockGap)i=-5e8,s=4e8;else{let{start:o,end:a}=Kj(e,n);i=(o?n?-3e8:-1:5e8)-1,s=(a?n?2e8:1:-6e8)+1}return new hd(e,i,s,n,e.widget||null,!0)}static line(e){return new Kb(e)}static set(e,n=!1){return sn.of(e,n)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ui.none=sn.empty;class Zb extends ui{constructor(e){let{start:n,end:i}=Kj(e);super(n?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var n,i;return this==e||e instanceof Zb&&this.tagName==e.tagName&&(this.class||((n=this.attrs)===null||n===void 0?void 0:n.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&$S(this.attrs,e.attrs,"class")}range(e,n=e){if(e>=n)throw new RangeError("Mark decorations may not be empty");return super.range(e,n)}}Zb.prototype.point=!1;class Kb extends ui{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Kb&&this.spec.class==e.spec.class&&$S(this.spec.attributes,e.spec.attributes)}range(e,n=e){if(n!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,n)}}Kb.prototype.mapMode=Ys.TrackBefore;Kb.prototype.point=!0;class hd extends ui{constructor(e,n,i,s,o,a){super(n,i,o,e),this.block=s,this.isReplace=a,this.mapMode=s?n<=0?Ys.TrackBefore:Ys.TrackAfter:Ys.TrackDel}get type(){return this.startSide!=this.endSide?eo.WidgetRange:this.startSide<=0?eo.WidgetBefore:eo.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof hd&&ZPe(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,n=e){if(this.isReplace&&(e>n||e==n&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&n!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,n)}}hd.prototype.point=!0;function Kj(r,e=!1){let{inclusiveStart:n,inclusiveEnd:i}=r;return n==null&&(n=r.inclusive),i==null&&(i=r.inclusive),{start:n??e,end:i??e}}function ZPe(r,e){return r==e||!!(r&&e&&r.compare(e))}function _3(r,e,n,i=0){let s=n.length-1;s>=0&&n[s]+i>=r?n[s]=Math.max(n[s],e):n.push(r,e)}class _r extends En{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,n,i,s,o,a){if(i){if(!(i instanceof _r))return!1;this.dom||i.transferDOM(this)}return s&&this.setDeco(i?i.attrs:null),Hj(this,e,n,i?i.children.slice():[],o,a),!0}split(e){let n=new _r;if(n.breakAfter=this.breakAfter,this.length==0)return n;let{i,off:s}=this.childPos(e);s&&(n.append(this.children[i].split(s),0),this.children[i].merge(s,this.children[i].length,null,!1,0,0),i++);for(let o=i;o<this.children.length;o++)n.append(this.children[o],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){$S(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,n){qj(this,e,n)}addLineDeco(e){let n=e.spec.attributes,i=e.spec.class;n&&(this.attrs=x3(n,this.attrs||{})),i&&(this.attrs=x3({class:i},this.attrs||{}))}domAtPos(e){return Yj(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,n){var i;this.dom?this.flags&4&&(Vj(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(w3(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,n);let s=this.dom.lastChild;for(;s&&En.get(s)instanceof Th;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((i=En.get(s))===null||i===void 0?void 0:i.isEditable)==!1&&(!It.ios||!this.children.some(o=>o instanceof xl))){let o=document.createElement("BR");o.cmIgnore=!0,this.dom.appendChild(o)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,n;for(let i of this.children){if(!(i instanceof xl)||/[^ -~]/.test(i.text))return null;let s=tb(i.dom);if(s.length!=1)return null;e+=s[0].width,n=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:n}:null}coordsAt(e,n){let i=Zj(this,e,n);if(!this.children.length&&i&&this.parent){let{heightOracle:s}=this.parent.view.viewState,o=i.bottom-i.top;if(Math.abs(o-s.lineHeight)<2&&s.textHeight<o){let a=(o-s.textHeight)/2;return{top:i.top+a,bottom:i.bottom-a,left:i.left,right:i.left}}}return i}become(e){return e instanceof _r&&this.children.length==0&&e.children.length==0&&$S(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,n){for(let i=0,s=0;i<e.children.length;i++){let o=e.children[i],a=s+o.length;if(a>=n){if(o instanceof _r)return o;if(a>n)break}s=a+o.breakAfter}return null}}class gh extends En{constructor(e,n,i){super(),this.widget=e,this.length=n,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,n,i,s,o,a){return i&&(!(i instanceof gh)||!this.widget.compare(i.widget)||e>0&&o<=0||n<this.length&&a<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-n),!0)}domAtPos(e){return e==0?ks.before(this.dom):ks.after(this.dom,e==this.length)}split(e){let n=this.length-e;this.length=e;let i=new gh(this.widget,n,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return c5}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):bn.empty}domBoundsAround(){return null}become(e){return e instanceof gh&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,n){let i=this.widget.coordsAt(this.dom,e,n);return i||(this.widget instanceof O3?null:U2(this.dom.getBoundingClientRect(),this.length?e==0:n<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:n,endSide:i}=this.deco;return n==i?!1:e<0?n<0:i>0}}class O3 extends wd{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class f1{constructor(e,n,i,s){this.doc=e,this.pos=n,this.end=i,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=n}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof gh&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new _r),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(C_(new Gg(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof gh)&&this.getLine()}buildText(e,n,i){for(;e>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:a,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=o,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(n.slice(n.length-i)),this.getLine().append(C_(new xl(this.text.slice(this.textOff,this.textOff+s)),n),i),this.atCursorPos=!0,this.textOff+=s,e-=s,i=0}}span(e,n,i,s){this.buildText(n-e,i,s),this.pos=n,this.openStart<0&&(this.openStart=s)}point(e,n,i,s,o,a){if(this.disallowBlockEffectsFor[a]&&i instanceof hd){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(n>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=n-e;if(i instanceof hd)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new gh(i.widget||Hg.block,l,i));else{let h=Vu.create(i.widget||Hg.inline,l,l?0:i.startSide),u=this.atCursorPos&&!h.isEditable&&o<=s.length&&(e<n||i.startSide>0),f=!h.isEditable&&(e<n||o>s.length||i.startSide<=0),p=this.getLine();this.pendingBuffer==2&&!u&&!h.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),u&&(p.append(C_(new Gg(1),s),o),o=s.length+Math.max(0,o-s.length)),p.append(C_(h,s),o),this.atCursorPos=f,this.pendingBuffer=f?e<n||o>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=n),this.openStart<0&&(this.openStart=o)}static build(e,n,i,s,o){let a=new f1(e,n,i,o);return a.openEnd=sn.spans(s,n,i,a),a.openStart<0&&(a.openStart=a.openEnd),a.finish(a.openEnd),a}}function C_(r,e){for(let n of e)r=new Th(n,[r],r.length);return r}class Hg extends wd{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Hg.inline=new Hg("span");Hg.block=new Hg("div");var Vn=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(Vn||(Vn={}));const dp=Vn.LTR,h5=Vn.RTL;function Jj(r){let e=[];for(let n=0;n<r.length;n++)e.push(1<<+r[n]);return e}const KPe=Jj("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),JPe=Jj("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),S3=Object.create(null),Nl=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),n=r.charCodeAt(1);S3[e]=n,S3[n]=-e}function eY(r){return r<=247?KPe[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?JPe[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const e3e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Fu{get dir(){return this.level%2?h5:dp}constructor(e,n,i){this.from=e,this.to=n,this.level=i}side(e,n){return this.dir==n==e?this.to:this.from}forward(e,n){return e==(this.dir==n)}static find(e,n,i,s){let o=-1;for(let a=0;a<e.length;a++){let l=e[a];if(l.from<=n&&l.to>=n){if(l.level==i)return a;(o<0||(s!=0?s<0?l.from<n:l.to>n:e[o].level>l.level))&&(o=a)}}if(o<0)throw new RangeError("Index out of range");return o}}function tY(r,e){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],s=e[n];if(i.from!=s.from||i.to!=s.to||i.direction!=s.direction||!tY(i.inner,s.inner))return!1}return!0}const Tn=[];function t3e(r,e,n,i,s){for(let o=0;o<=i.length;o++){let a=o?i[o-1].to:e,l=o<i.length?i[o].from:n,h=o?256:s;for(let u=a,f=h,p=h;u<l;u++){let m=eY(r.charCodeAt(u));m==512?m=f:m==8&&p==4&&(m=16),Tn[u]=m==4?2:m,m&7&&(p=m),f=m}for(let u=a,f=h,p=h;u<l;u++){let m=Tn[u];if(m==128)u<l-1&&f==Tn[u+1]&&f&24?m=Tn[u]=f:Tn[u]=256;else if(m==64){let v=u+1;for(;v<l&&Tn[v]==64;)v++;let y=u&&f==8||v<n&&Tn[v]==8?p==1?1:8:256;for(let x=u;x<v;x++)Tn[x]=y;u=v-1}else m==8&&p==1&&(Tn[u]=1);f=m,m&7&&(p=m)}}}function i3e(r,e,n,i,s){let o=s==1?2:1;for(let a=0,l=0,h=0;a<=i.length;a++){let u=a?i[a-1].to:e,f=a<i.length?i[a].from:n;for(let p=u,m,v,y;p<f;p++)if(v=S3[m=r.charCodeAt(p)])if(v<0){for(let x=l-3;x>=0;x-=3)if(Nl[x+1]==-v){let w=Nl[x+2],S=w&2?s:w&4?w&1?o:s:0;S&&(Tn[p]=Tn[Nl[x]]=S),l=x;break}}else{if(Nl.length==189)break;Nl[l++]=p,Nl[l++]=m,Nl[l++]=h}else if((y=Tn[p])==2||y==1){let x=y==s;h=x?0:1;for(let w=l-3;w>=0;w-=3){let S=Nl[w+2];if(S&2)break;if(x)Nl[w+2]|=2;else{if(S&4)break;Nl[w+2]|=4}}}}}function n3e(r,e,n,i){for(let s=0,o=i;s<=n.length;s++){let a=s?n[s-1].to:r,l=s<n.length?n[s].from:e;for(let h=a;h<l;){let u=Tn[h];if(u==256){let f=h+1;for(;;)if(f==l){if(s==n.length)break;f=n[s++].to,l=s<n.length?n[s].from:e}else if(Tn[f]==256)f++;else break;let p=o==1,m=(f<e?Tn[f]:i)==1,v=p==m?p?1:2:i;for(let y=f,x=s,w=x?n[x-1].to:r;y>h;)y==w&&(y=n[--x].from,w=x?n[x-1].to:r),Tn[--y]=v;h=f}else o=u,h++}}}function C3(r,e,n,i,s,o,a){let l=i%2?2:1;if(i%2==s%2)for(let h=e,u=0;h<n;){let f=!0,p=!1;if(u==o.length||h<o[u].from){let x=Tn[h];x!=l&&(f=!1,p=x==16)}let m=!f&&l==1?[]:null,v=f?i:i+1,y=h;e:for(;;)if(u<o.length&&y==o[u].from){if(p)break e;let x=o[u];if(!f)for(let w=x.to,S=u+1;;){if(w==n)break e;if(S<o.length&&o[S].from==w)w=o[S++].to;else{if(Tn[w]==l)break e;break}}if(u++,m)m.push(x);else{x.from>h&&a.push(new Fu(h,x.from,v));let w=x.direction==dp!=!(v%2);T3(r,w?i+1:i,s,x.inner,x.from,x.to,a),h=x.to}y=x.to}else{if(y==n||(f?Tn[y]!=l:Tn[y]==l))break;y++}m?C3(r,h,y,i+1,s,m,a):h<y&&a.push(new Fu(h,y,v)),h=y}else for(let h=n,u=o.length;h>e;){let f=!0,p=!1;if(!u||h>o[u-1].to){let x=Tn[h-1];x!=l&&(f=!1,p=x==16)}let m=!f&&l==1?[]:null,v=f?i:i+1,y=h;e:for(;;)if(u&&y==o[u-1].to){if(p)break e;let x=o[--u];if(!f)for(let w=x.from,S=u;;){if(w==e)break e;if(S&&o[S-1].to==w)w=o[--S].from;else{if(Tn[w-1]==l)break e;break}}if(m)m.push(x);else{x.to<h&&a.push(new Fu(x.to,h,v));let w=x.direction==dp!=!(v%2);T3(r,w?i+1:i,s,x.inner,x.from,x.to,a),h=x.from}y=x.from}else{if(y==e||(f?Tn[y-1]!=l:Tn[y-1]==l))break;y--}m?C3(r,y,h,i+1,s,m,a):y<h&&a.push(new Fu(y,h,v)),h=y}}function T3(r,e,n,i,s,o,a){let l=e%2?2:1;t3e(r,s,o,i,l),i3e(r,s,o,i,l),n3e(s,o,i,l),C3(r,s,o,e,n,i,a)}function r3e(r,e,n){if(!r)return[new Fu(0,0,e==h5?1:0)];if(e==dp&&!n.length&&!e3e.test(r))return iY(r.length);if(n.length)for(;r.length>Tn.length;)Tn[Tn.length]=256;let i=[],s=e==dp?0:1;return T3(r,s,s,n,0,r.length,i),i}function iY(r){return[new Fu(0,r,0)]}let nY="";function s3e(r,e,n,i,s){var o;let a=i.head-r.from,l=Fu.find(e,a,(o=i.bidiLevel)!==null&&o!==void 0?o:-1,i.assoc),h=e[l],u=h.side(s,n);if(a==u){let m=l+=s?1:-1;if(m<0||m>=e.length)return null;h=e[l=m],a=h.side(!s,n),u=h.side(s,n)}let f=ys(r.text,a,h.forward(s,n));(f<h.from||f>h.to)&&(f=u),nY=r.text.slice(Math.min(a,f),Math.max(a,f));let p=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return p&&f==u&&p.level+(s?0:1)<h.level?et.cursor(p.side(!s,n)+r.from,p.forward(s,n)?1:-1,p.level):et.cursor(f+r.from,h.forward(s,n)?-1:1,h.level)}function o3e(r,e,n){for(let i=e;i<n;i++){let s=eY(r.charCodeAt(i));if(s==1)return dp;if(s==2||s==4)return h5}return dp}const rY=Pt.define(),sY=Pt.define(),oY=Pt.define(),aY=Pt.define(),E3=Pt.define(),lY=Pt.define(),cY=Pt.define(),u5=Pt.define(),d5=Pt.define(),hY=Pt.define({combine:r=>r.some(e=>e)}),uY=Pt.define({combine:r=>r.some(e=>e)}),dY=Pt.define();class bg{constructor(e,n="nearest",i="nearest",s=5,o=5,a=!1){this.range=e,this.y=n,this.x=i,this.yMargin=s,this.xMargin=o,this.isSnapshot=a}map(e){return e.empty?this:new bg(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new bg(et.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const T_=Ri.define({map:(r,e)=>r.map(e)}),fY=Ri.define();function So(r,e,n){let i=r.facet(aY);i.length?i[0](e):window.onerror?window.onerror(String(e),n,void 0,void 0,e):n?console.error(n+":",e):console.error(e)}const Nu=Pt.define({combine:r=>r.length?r[0]:!0});let a3e=0;const Fy=Pt.define();class Pr{constructor(e,n,i,s,o){this.id=e,this.create=n,this.domEventHandlers=i,this.domEventObservers=s,this.extension=o(this)}static define(e,n){const{eventHandlers:i,eventObservers:s,provide:o,decorations:a}=n||{};return new Pr(a3e++,e,i,s,l=>{let h=[Fy.of(l)];return a&&h.push(ib.of(u=>{let f=u.plugin(l);return f?a(f):ui.none})),o&&h.push(o(l)),h})}static fromClass(e,n){return Pr.define(i=>new e(i),n)}}class sA{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let n=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(n)}catch(i){if(So(n.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(n){So(e.state,n,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var n;if(!((n=this.value)===null||n===void 0)&&n.destroy)try{this.value.destroy()}catch(i){So(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const pY=Pt.define(),f5=Pt.define(),ib=Pt.define(),mY=Pt.define(),p5=Pt.define(),gY=Pt.define();function E8(r,e){let n=r.state.facet(gY);if(!n.length)return n;let i=n.map(o=>o instanceof Function?o(r):o),s=[];return sn.spans(i,e.from,e.to,{point(){},span(o,a,l,h){let u=o-e.from,f=a-e.from,p=s;for(let m=l.length-1;m>=0;m--,h--){let v=l[m].spec.bidiIsolate,y;if(v==null&&(v=o3e(e.text,u,f)),h>0&&p.length&&(y=p[p.length-1]).to==u&&y.direction==v)y.to=f,p=y.inner;else{let x={from:u,to:f,direction:v,inner:[]};p.push(x),p=x.inner}}}}),s}const vY=Pt.define();function yY(r){let e=0,n=0,i=0,s=0;for(let o of r.state.facet(vY)){let a=o(r);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(n=Math.max(n,a.right)),a.top!=null&&(i=Math.max(i,a.top)),a.bottom!=null&&(s=Math.max(s,a.bottom)))}return{left:e,right:n,top:i,bottom:s}}const zy=Pt.define();class Na{constructor(e,n,i,s){this.fromA=e,this.toA=n,this.fromB=i,this.toB=s}join(e){return new Na(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let n=e.length,i=this;for(;n>0;n--){let s=e[n-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),e.splice(n-1,1)}}return e.splice(n,0,i),e}static extendWithRanges(e,n){if(n.length==0)return e;let i=[];for(let s=0,o=0,a=0,l=0;;s++){let h=s==e.length?null:e[s],u=a-l,f=h?h.fromB:1e9;for(;o<n.length&&n[o]<f;){let p=n[o],m=n[o+1],v=Math.max(l,p),y=Math.min(f,m);if(v<=y&&new Na(v+u,y+u,v,y).addToSet(i),m>f)break;o+=2}if(!h)return i;new Na(h.fromA,h.toA,h.fromB,h.toB).addToSet(i),a=h.toA,l=h.toB}}}class US{constructor(e,n,i){this.view=e,this.state=n,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=$r.empty(this.startState.doc.length);for(let o of i)this.changes=this.changes.compose(o.changes);let s=[];this.changes.iterChangedRanges((o,a,l,h)=>s.push(new Na(o,a,l,h))),this.changedRanges=s}static create(e,n,i){return new US(e,n,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class M8 extends En{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ui.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new _r],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Na(0,0,0,e.state.doc.length)],0,null)}update(e){var n;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:u,toA:f})=>f<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((n=this.domChanged)===null||n===void 0)&&n.newSel?s=this.domChanged.newSel.head:!p3e(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let o=s>-1?c3e(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:f}=this.hasComposition;i=new Na(u,f,e.changes.mapPos(u,-1),e.changes.mapPos(f,1)).addToSet(i.slice())}this.hasComposition=o?{from:o.range.fromB,to:o.range.toB}:null,(It.ie||It.chrome)&&!o&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,l=this.updateDeco(),h=d3e(a,l,e.changes);return i=Na.extendWithRanges(i,h),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,o),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,n,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,n,i);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let a=It.chrome||It.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,a),this.flags&=-8,a&&(a.written||s.selectionRange.focusNode!=a.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(a=>a.flags&=-9);let o=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let a of this.children)a instanceof gh&&a.widget instanceof O3&&o.push(a.dom);s.updateGaps(o)}updateChildren(e,n,i){let s=i?i.range.addToSet(e.slice()):e,o=this.childCursor(n);for(let a=s.length-1;;a--){let l=a>=0?s[a]:null;if(!l)break;let{fromA:h,toA:u,fromB:f,toB:p}=l,m,v,y,x;if(i&&i.range.fromB<p&&i.range.toB>f){let T=f1.build(this.view.state.doc,f,i.range.fromB,this.decorations,this.dynamicDecorationMap),A=f1.build(this.view.state.doc,i.range.toB,p,this.decorations,this.dynamicDecorationMap);v=T.breakAtStart,y=T.openStart,x=A.openEnd;let P=this.compositionView(i);A.breakAtStart?P.breakAfter=1:A.content.length&&P.merge(P.length,P.length,A.content[0],!1,A.openStart,0)&&(P.breakAfter=A.content[0].breakAfter,A.content.shift()),T.content.length&&P.merge(0,0,T.content[T.content.length-1],!0,0,T.openEnd)&&T.content.pop(),m=T.content.concat(P).concat(A.content)}else({content:m,breakAtStart:v,openStart:y,openEnd:x}=f1.build(this.view.state.doc,f,p,this.decorations,this.dynamicDecorationMap));let{i:w,off:S}=o.findPos(u,1),{i:O,off:_}=o.findPos(h,-1);Gj(this,O,_,w,S,m,v,y,x)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let n of e.transactions)for(let i of n.effects)i.is(fY)&&(this.editContextFormatting=i.value)}compositionView(e){let n=new xl(e.text.nodeValue);n.flags|=8;for(let{deco:s}of e.marks)n=new Th(s,[n],n.length);let i=new _r;return i.append(n,0),i}fixCompositionDOM(e){let n=(o,a)=>{a.flags|=8|(a.children.some(h=>h.flags&7)?1:0),this.markedForComposition.add(a);let l=En.get(o);l&&l!=a&&(l.dom=null),a.setDOM(o)},i=this.childPos(e.range.fromB,1),s=this.children[i.i];n(e.line,s);for(let o=e.marks.length-1;o>=-1;o--)i=s.childPos(i.off,1),s=s.children[i.i],n(o>=0?e.marks[o].node:e.text,s)}updateSelection(e=!1,n=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,s=i==this.dom,o=!s&&FO(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(s||n||o))return;let a=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,h=this.moveToLine(this.domAtPos(l.anchor)),u=l.empty?h:this.moveToLine(this.domAtPos(l.head));if(It.gecko&&l.empty&&!this.hasComposition&&l3e(h)){let p=document.createTextNode("");this.view.observer.ignore(()=>h.node.insertBefore(p,h.node.childNodes[h.offset]||null)),h=u=new ks(p,0),a=!0}let f=this.view.observer.selectionRange;(a||!f.focusNode||(!d1(h.node,h.offset,f.anchorNode,f.anchorOffset)||!d1(u.node,u.offset,f.focusNode,f.focusOffset))&&!this.suppressWidgetCursorChange(f,l))&&(this.view.observer.ignore(()=>{It.android&&It.chrome&&this.dom.contains(f.focusNode)&&f3e(f.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let p=eb(this.view.root);if(p)if(l.empty){if(It.gecko){let m=h3e(h.node,h.offset);if(m&&m!=3){let v=(m==1?zj:Xj)(h.node,h.offset);v&&(h=new ks(v.node,v.offset))}}p.collapse(h.node,h.offset),l.bidiLevel!=null&&p.caretBidiLevel!==void 0&&(p.caretBidiLevel=l.bidiLevel)}else if(p.extend){p.collapse(h.node,h.offset);try{p.extend(u.node,u.offset)}catch{}}else{let m=document.createRange();l.anchor>l.head&&([h,u]=[u,h]),m.setEnd(u.node,u.offset),m.setStart(h.node,h.offset),p.removeAllRanges(),p.addRange(m)}o&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(h,u)),this.impreciseAnchor=h.precise?null:new ks(f.anchorNode,f.anchorOffset),this.impreciseHead=u.precise?null:new ks(f.focusNode,f.focusOffset)}suppressWidgetCursorChange(e,n){return this.hasComposition&&n.empty&&d1(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==n.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,n=e.state.selection.main,i=eb(e.root),{anchorNode:s,anchorOffset:o}=e.observer.selectionRange;if(!i||!n.empty||!n.assoc||!i.modify)return;let a=_r.find(this,n.head);if(!a)return;let l=a.posAtStart;if(n.head==l||n.head==l+a.length)return;let h=this.coordsAt(n.head,-1),u=this.coordsAt(n.head,1);if(!h||!u||h.bottom>u.top)return;let f=this.domAtPos(n.head+n.assoc);i.collapse(f.node,f.offset),i.modify("move",n.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let p=e.observer.selectionRange;e.docView.posFromDOM(p.anchorNode,p.anchorOffset)!=n.from&&i.collapse(s,o)}moveToLine(e){let n=this.dom,i;if(e.node!=n)return e;for(let s=e.offset;!i&&s<n.childNodes.length;s++){let o=En.get(n.childNodes[s]);o instanceof _r&&(i=o.domAtPos(0))}for(let s=e.offset-1;!i&&s>=0;s--){let o=En.get(n.childNodes[s]);o instanceof _r&&(i=o.domAtPos(o.length))}return i?new ks(i.node,i.offset,!0):e}nearest(e){for(let n=e;n;){let i=En.get(n);if(i&&i.rootView==this)return i;n=n.parentNode}return null}posFromDOM(e,n){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,n)+i.posAtStart}domAtPos(e){let{i:n,off:i}=this.childCursor().findPos(e,-1);for(;n<this.children.length-1;){let s=this.children[n];if(i<s.length||s instanceof _r)break;n++,i=0}return this.children[n].domAtPos(i)}coordsAt(e,n){let i=null,s=0;for(let o=this.length,a=this.children.length-1;a>=0;a--){let l=this.children[a],h=o-l.breakAfter,u=h-l.length;if(h<e)break;if(u<=e&&(u<e||l.covers(-1))&&(h>e||l.covers(1))&&(!i||l instanceof _r&&!(i instanceof _r&&n>=0)))i=l,s=u;else if(i&&u==e&&h==e&&l instanceof gh&&Math.abs(n)<2){if(l.deco.startSide<0)break;a&&(i=null)}o=u}return i?i.coordsAt(e-s,n):null}coordsForChar(e){let{i:n,off:i}=this.childPos(e,1),s=this.children[n];if(!(s instanceof _r))return null;for(;s.children.length;){let{i:l,off:h}=s.childPos(i,1);for(;;l++){if(l==s.children.length)return null;if((s=s.children[l]).length)break}i=h}if(!(s instanceof xl))return null;let o=ys(s.text,i);if(o==i)return null;let a=up(s.dom,i,o).getClientRects();for(let l=0;l<a.length;l++){let h=a[l];if(l==a.length-1||h.top<h.bottom&&h.left<h.right)return h}return null}measureVisibleLineHeights(e){let n=[],{from:i,to:s}=e,o=this.view.contentDOM.clientWidth,a=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,h=this.view.textDirection==Vn.LTR;for(let u=0,f=0;f<this.children.length;f++){let p=this.children[f],m=u+p.length;if(m>s)break;if(u>=i){let v=p.dom.getBoundingClientRect();if(n.push(v.height),a){let y=p.dom.lastChild,x=y?tb(y):[];if(x.length){let w=x[x.length-1],S=h?w.right-v.left:v.right-w.left;S>l&&(l=S,this.minWidth=o,this.minWidthFrom=u,this.minWidthTo=m)}}}u=m+p.breakAfter}return n}textDirectionAt(e){let{i:n}=this.childPos(e,1);return getComputedStyle(this.children[n].dom).direction=="rtl"?Vn.RTL:Vn.LTR}measureTextSize(){for(let o of this.children)if(o instanceof _r){let a=o.measureTextSize();if(a)return a}let e=document.createElement("div"),n,i,s;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let o=tb(e.firstChild)[0];n=e.getBoundingClientRect().height,i=o?o.width/27:7,s=o?o.height:n,e.remove()}),{lineHeight:n,charWidth:i,textHeight:s}}childCursor(e=this.length){let n=this.children.length;return n&&(e-=this.children[--n].length),new Wj(this.children,e,n)}computeBlockGapDeco(){let e=[],n=this.view.viewState;for(let i=0,s=0;;s++){let o=s==n.viewports.length?null:n.viewports[s],a=o?o.from-1:this.length;if(a>i){let l=(n.lineBlockAt(a).bottom-n.lineBlockAt(i).top)/this.view.scaleY;e.push(ui.replace({widget:new O3(l),block:!0,inclusive:!0,isBlockGap:!0}).range(i,a))}if(!o)break;i=o.to+1}return ui.set(e)}updateDeco(){let e=1,n=this.view.state.facet(ib).map(o=>(this.dynamicDecorationMap[e++]=typeof o=="function")?o(this.view):o),i=!1,s=this.view.state.facet(mY).map((o,a)=>{let l=typeof o=="function";return l&&(i=!0),l?o(this.view):o});for(s.length&&(this.dynamicDecorationMap[e++]=i,n.push(sn.join(s))),this.decorations=[this.editContextFormatting,...n,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=u.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let u of this.view.state.facet(dY))try{if(u(this.view,e.range,e))return!0}catch(f){So(this.view.state,f,"scroll handler")}let{range:n}=e,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1),s;if(!i)return;!n.empty&&(s=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let o=yY(this.view),a={left:i.left-o.left,top:i.top-o.top,right:i.right+o.right,bottom:i.bottom+o.bottom},{offsetWidth:l,offsetHeight:h}=this.view.scrollDOM;zPe(this.view.scrollDOM,a,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,h),-h),this.view.textDirection==Vn.LTR)}}function l3e(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function bY(r,e){let n=r.observer.selectionRange;if(!n.focusNode)return null;let i=zj(n.focusNode,n.focusOffset),s=Xj(n.focusNode,n.focusOffset),o=i||s;if(s&&i&&s.node!=i.node){let l=En.get(s.node);if(!l||l instanceof xl&&l.text!=s.node.nodeValue)o=s;else if(r.docView.lastCompositionAfterCursor){let h=En.get(i.node);!h||h instanceof xl&&h.text!=i.node.nodeValue||(o=s)}}if(r.docView.lastCompositionAfterCursor=o!=i,!o)return null;let a=e-o.offset;return{from:a,to:a+o.node.nodeValue.length,node:o.node}}function c3e(r,e,n){let i=bY(r,n);if(!i)return null;let{node:s,from:o,to:a}=i,l=s.nodeValue;if(/[\n\r]/.test(l)||r.state.doc.sliceString(i.from,i.to)!=l)return null;let h=e.invertedDesc,u=new Na(h.mapPos(o),h.mapPos(a),o,a),f=[];for(let p=s.parentNode;;p=p.parentNode){let m=En.get(p);if(m instanceof Th)f.push({node:p,deco:m.mark});else{if(m instanceof _r||p.nodeName=="DIV"&&p.parentNode==r.contentDOM)return{range:u,text:s,marks:f,line:p};if(p!=r.contentDOM)f.push({node:p,deco:new Zb({inclusive:!0,attributes:qPe(p),tagName:p.tagName.toLowerCase()})});else return null}}}function h3e(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}let u3e=class{constructor(){this.changes=[]}compareRange(e,n){_3(e,n,this.changes)}comparePoint(e,n){_3(e,n,this.changes)}};function d3e(r,e,n){let i=new u3e;return sn.compare(r,e,n,i),i.changes}function f3e(r,e){for(let n=r;n&&n!=e;n=n.assignedSlot||n.parentNode)if(n.nodeType==1&&n.contentEditable=="false")return!0;return!1}function p3e(r,e){let n=!1;return e&&r.iterChangedRanges((i,s)=>{i<e.to&&s>e.from&&(n=!0)}),n}function m3e(r,e,n=1){let i=r.charCategorizer(e),s=r.doc.lineAt(e),o=e-s.from;if(s.length==0)return et.cursor(e);o==0?n=1:o==s.length&&(n=-1);let a=o,l=o;n<0?a=ys(s.text,o,!1):l=ys(s.text,o);let h=i(s.text.slice(a,l));for(;a>0;){let u=ys(s.text,a,!1);if(i(s.text.slice(u,a))!=h)break;a=u}for(;l<s.length;){let u=ys(s.text,l);if(i(s.text.slice(l,u))!=h)break;l=u}return et.range(a+s.from,l+s.from)}function g3e(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function v3e(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function oA(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function A8(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function k8(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function M3(r,e,n){let i,s,o,a,l=!1,h,u,f,p;for(let y=r.firstChild;y;y=y.nextSibling){let x=tb(y);for(let w=0;w<x.length;w++){let S=x[w];s&&oA(s,S)&&(S=A8(k8(S,s.bottom),s.top));let O=g3e(e,S),_=v3e(n,S);if(O==0&&_==0)return y.nodeType==3?P8(y,e,n):M3(y,e,n);if(!i||a>_||a==_&&o>O){i=y,s=S,o=O,a=_;let T=_?n<S.top?-1:1:O?e<S.left?-1:1:0;l=!T||(T>0?w<x.length-1:w>0)}O==0?n>S.bottom&&(!f||f.bottom<S.bottom)?(h=y,f=S):n<S.top&&(!p||p.top>S.top)&&(u=y,p=S):f&&oA(f,S)?f=k8(f,S.bottom):p&&oA(p,S)&&(p=A8(p,S.top))}}if(f&&f.bottom>=n?(i=h,s=f):p&&p.top<=n&&(i=u,s=p),!i)return{node:r,offset:0};let m=Math.max(s.left,Math.min(s.right,e));if(i.nodeType==3)return P8(i,m,n);if(l&&i.contentEditable!="false")return M3(i,m,n);let v=Array.prototype.indexOf.call(r.childNodes,i)+(e>=(s.left+s.right)/2?1:0);return{node:r,offset:v}}function P8(r,e,n){let i=r.nodeValue.length,s=-1,o=1e9,a=0;for(let l=0;l<i;l++){let h=up(r,l,l+1).getClientRects();for(let u=0;u<h.length;u++){let f=h[u];if(f.top==f.bottom)continue;a||(a=e-f.left);let p=(f.top>n?f.top-n:n-f.bottom)-1;if(f.left-1<=e&&f.right+1>=e&&p<o){let m=e>=(f.left+f.right)/2,v=m;if((It.chrome||It.gecko)&&up(r,l).getBoundingClientRect().left==f.right&&(v=!m),p<=0)return{node:r,offset:l+(v?1:0)};s=l+(v?1:0),o=p}}}return{node:r,offset:s>-1?s:a>0?r.nodeValue.length:0}}function xY(r,e,n,i=-1){var s,o;let a=r.contentDOM.getBoundingClientRect(),l=a.top+r.viewState.paddingTop,h,{docHeight:u}=r.viewState,{x:f,y:p}=e,m=p-l;if(m<0)return 0;if(m>u)return r.state.doc.length;for(let T=r.viewState.heightOracle.textHeight/2,A=!1;h=r.elementAtHeight(m),h.type!=eo.Text;)for(;m=i>0?h.bottom+T:h.top-T,!(m>=0&&m<=u);){if(A)return n?null:0;A=!0,i=-i}p=l+m;let v=h.from;if(v<r.viewport.from)return r.viewport.from==0?0:n?null:R8(r,a,h,f,p);if(v>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:n?null:R8(r,a,h,f,p);let y=r.dom.ownerDocument,x=r.root.elementFromPoint?r.root:y,w=x.elementFromPoint(f,p);w&&!r.contentDOM.contains(w)&&(w=null),w||(f=Math.max(a.left+1,Math.min(a.right-1,f)),w=x.elementFromPoint(f,p),w&&!r.contentDOM.contains(w)&&(w=null));let S,O=-1;if(w&&((s=r.docView.nearest(w))===null||s===void 0?void 0:s.isEditable)!=!1){if(y.caretPositionFromPoint){let T=y.caretPositionFromPoint(f,p);T&&({offsetNode:S,offset:O}=T)}else if(y.caretRangeFromPoint){let T=y.caretRangeFromPoint(f,p);T&&({startContainer:S,startOffset:O}=T,(!r.contentDOM.contains(S)||It.safari&&y3e(S,O,f)||It.chrome&&b3e(S,O,f))&&(S=void 0))}}if(!S||!r.docView.dom.contains(S)){let T=_r.find(r.docView,v);if(!T)return m>h.top+h.height/2?h.to:h.from;({node:S,offset:O}=M3(T.dom,f,p))}let _=r.docView.nearest(S);if(!_)return null;if(_.isWidget&&((o=_.dom)===null||o===void 0?void 0:o.nodeType)==1){let T=_.dom.getBoundingClientRect();return e.y<T.top||e.y<=T.bottom&&e.x<=(T.left+T.right)/2?_.posAtStart:_.posAtEnd}else return _.localPosFromDOM(S,O)+_.posAtStart}function R8(r,e,n,i,s){let o=Math.round((i-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&n.height>r.defaultLineHeight*1.5){let l=r.viewState.heightOracle.textHeight,h=Math.floor((s-n.top-(r.defaultLineHeight-l)*.5)/l);o+=h*r.viewState.heightOracle.lineLength}let a=r.state.sliceDoc(n.from,n.to);return n.from+f3(a,o,r.state.tabSize)}function y3e(r,e,n){let i;if(r.nodeType!=3||e!=(i=r.nodeValue.length))return!1;for(let s=r.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return up(r,i-1,i).getBoundingClientRect().left>n}function b3e(r,e,n){if(e!=0)return!1;for(let s=r;;){let o=s.parentNode;if(!o||o.nodeType!=1||o.firstChild!=s)return!1;if(o.classList.contains("cm-line"))break;s=o}let i=r.nodeType==1?r.getBoundingClientRect():up(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return n-i.left>5}function A3(r,e){let n=r.lineBlockAt(e);if(Array.isArray(n.type)){for(let i of n.type)if(i.to>e||i.to==e&&(i.to==n.to||i.type==eo.Text))return i}return n}function x3e(r,e,n,i){let s=A3(r,e.head),o=!i||s.type!=eo.Text||!(r.lineWrapping||s.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(o){let a=r.dom.getBoundingClientRect(),l=r.textDirectionAt(s.from),h=r.posAtCoords({x:n==(l==Vn.LTR)?a.right-1:a.left+1,y:(o.top+o.bottom)/2});if(h!=null)return et.cursor(h,n?-1:1)}return et.cursor(n?s.to:s.from,n?-1:1)}function I8(r,e,n,i){let s=r.state.doc.lineAt(e.head),o=r.bidiSpans(s),a=r.textDirectionAt(s.from);for(let l=e,h=null;;){let u=s3e(s,o,a,l,n),f=nY;if(!u){if(s.number==(n?r.state.doc.lines:1))return l;f=`
`,s=r.state.doc.line(s.number+(n?1:-1)),o=r.bidiSpans(s),u=r.visualLineSide(s,!n)}if(h){if(!h(f))return l}else{if(!i)return u;h=i(f)}l=u}}function w3e(r,e,n){let i=r.state.charCategorizer(e),s=i(n);return o=>{let a=i(o);return s==jn.Space&&(s=a),s==a}}function _3e(r,e,n,i){let s=e.head,o=n?1:-1;if(s==(n?r.state.doc.length:0))return et.cursor(s,e.assoc);let a=e.goalColumn,l,h=r.contentDOM.getBoundingClientRect(),u=r.coordsAtPos(s,e.assoc||-1),f=r.documentTop;if(u)a==null&&(a=u.left-h.left),l=o<0?u.top:u.bottom;else{let v=r.viewState.lineBlockAt(s);a==null&&(a=Math.min(h.right-h.left,r.defaultCharacterWidth*(s-v.from))),l=(o<0?v.top:v.bottom)+f}let p=h.left+a,m=i??r.viewState.heightOracle.textHeight>>1;for(let v=0;;v+=10){let y=l+(m+v)*o,x=xY(r,{x:p,y},!1,o);if(y<h.top||y>h.bottom||(o<0?x<s:x>s)){let w=r.docView.coordsForChar(x),S=!w||y<w.top?-1:1;return et.cursor(x,S,void 0,a)}}}function zO(r,e,n){for(;;){let i=0;for(let s of r)s.between(e-1,e+1,(o,a,l)=>{if(e>o&&e<a){let h=i||n||(e-o<a-e?-1:1);e=h<0?o:a,i=h}});if(!i)return e}}function aA(r,e,n){let i=zO(r.state.facet(p5).map(s=>s(r)),n.from,e.head>n.from?-1:1);return i==n.from?n:et.cursor(i,i<n.from?1:-1)}const Xy="￿";class O3e{constructor(e,n){this.points=e,this.text="",this.lineSeparator=n.facet(an.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Xy}readRange(e,n){if(!e)return this;let i=e.parentNode;for(let s=e;;){this.findPointBefore(i,s);let o=this.text.length;this.readNode(s);let a=s.nextSibling;if(a==n)break;let l=En.get(s),h=En.get(a);(l&&h?l.breakAfter:(l?l.breakAfter:BS(s))||BS(a)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>o)&&this.lineBreak(),s=a}return this.findPointBefore(i,n),this}readTextNode(e){let n=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,n.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let o=-1,a=1,l;if(this.lineSeparator?(o=n.indexOf(this.lineSeparator,i),a=this.lineSeparator.length):(l=s.exec(n))&&(o=l.index,a=l[0].length),this.append(n.slice(i,o<0?n.length:o)),o<0)break;if(this.lineBreak(),a>1)for(let h of this.points)h.node==e&&h.pos>this.text.length&&(h.pos-=a-1);i=o+a}}readNode(e){if(e.cmIgnore)return;let n=En.get(e),i=n&&n.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,n){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==n&&(i.pos=this.text.length)}findPointInside(e,n){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(S3e(e,i.node,i.offset)?n:0))}}function S3e(r,e,n){for(;;){if(!e||n<Ch(e))return!1;if(e==r)return!0;n=hp(e)+1,e=e.parentNode}}class N8{constructor(e,n){this.node=e,this.offset=n,this.pos=-1}}class C3e{constructor(e,n,i,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=n>-1;let{impreciseHead:o,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&n>-1)this.newSel=null;else if(n>-1&&(this.bounds=e.docView.domBoundsAround(n,i,0))){let l=o||a?[]:M3e(e),h=new O3e(l,e.state);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=A3e(l,this.bounds.from)}else{let l=e.observer.selectionRange,h=o&&o.node==l.focusNode&&o.offset==l.focusOffset||!g3(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),u=a&&a.node==l.anchorNode&&a.offset==l.anchorOffset||!g3(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),f=e.viewport;if((It.ios||It.chrome)&&e.state.selection.main.empty&&h!=u&&(f.from>0||f.to<e.state.doc.length)){let p=Math.min(h,u),m=Math.max(h,u),v=f.from-p,y=f.to-m;(v==0||v==1||p==0)&&(y==0||y==-1||m==e.state.doc.length)&&(h=0,u=e.state.doc.length)}this.newSel=et.single(u,h)}}}function wY(r,e){let n,{newSel:i}=e,s=r.state.selection.main,o=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:l}=e.bounds,h=s.from,u=null;(o===8||It.android&&e.text.length<l-a)&&(h=s.to,u="end");let f=E3e(r.state.doc.sliceString(a,l,Xy),e.text,h-a,u);f&&(It.chrome&&o==13&&f.toB==f.from+2&&e.text.slice(f.from,f.toB)==Xy+Xy&&f.toB--,n={from:a+f.from,to:a+f.toA,insert:bn.of(e.text.slice(f.from,f.toB).split(Xy))})}else i&&(!r.hasFocus&&r.state.facet(Nu)||i.main.eq(s))&&(i=null);if(!n&&!i)return!1;if(!n&&e.typeOver&&!s.empty&&i&&i.main.empty?n={from:s.from,to:s.to,insert:r.state.doc.slice(s.from,s.to)}:n&&n.from>=s.from&&n.to<=s.to&&(n.from!=s.from||n.to!=s.to)&&s.to-s.from-(n.to-n.from)<=4?n={from:s.from,to:s.to,insert:r.state.doc.slice(s.from,n.from).append(n.insert).append(r.state.doc.slice(n.to,s.to))}:(It.mac||It.android)&&n&&n.from==n.to&&n.from==s.head-1&&/^\. ?$/.test(n.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(i&&n.insert.length==2&&(i=et.single(i.main.anchor-1,i.main.head-1)),n={from:s.from,to:s.to,insert:bn.of([" "])}):It.chrome&&n&&n.from==n.to&&n.from==s.head&&n.insert.toString()==`
 `&&r.lineWrapping&&(i&&(i=et.single(i.main.anchor-1,i.main.head-1)),n={from:s.from,to:s.to,insert:bn.of([" "])}),n)return m5(r,n,i,o);if(i&&!i.main.eq(s)){let a=!1,l="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(a=!0),l=r.inputState.lastSelectionOrigin),r.dispatch({selection:i,scrollIntoView:a,userEvent:l}),!0}else return!1}function m5(r,e,n,i=-1){if(It.ios&&r.inputState.flushIOSKey(e))return!0;let s=r.state.selection.main;if(It.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&r.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&yg(r.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&yg(r.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&yg(r.contentDOM,"Delete",46)))return!0;let o=e.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let a,l=()=>a||(a=T3e(r,e,n));return r.state.facet(lY).some(h=>h(r,e.from,e.to,o,l))||r.dispatch(l()),!0}function T3e(r,e,n){let i,s=r.state,o=s.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!n||n.main.empty&&n.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let l=o.from<e.from?s.sliceDoc(o.from,e.from):"",h=o.to>e.to?s.sliceDoc(e.to,o.to):"";i=s.replaceSelection(r.state.toText(l+e.insert.sliceString(0,void 0,r.state.lineBreak)+h))}else{let l=s.changes(e),h=n&&n.main.to<=l.newLength?n.main:void 0;if(s.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let u=r.state.sliceDoc(e.from,e.to),f,p=n&&bY(r,n.main.head);if(p){let y=e.insert.length-(e.to-e.from);f={from:p.from,to:p.to-y}}else f=r.state.doc.lineAt(o.head);let m=o.to-e.to,v=o.to-o.from;i=s.changeByRange(y=>{if(y.from==o.from&&y.to==o.to)return{changes:l,range:h||y.map(l)};let x=y.to-m,w=x-u.length;if(y.to-y.from!=v||r.state.sliceDoc(w,x)!=u||y.to>=f.from&&y.from<=f.to)return{range:y};let S=s.changes({from:w,to:x,insert:e.insert}),O=y.to-o.to;return{changes:S,range:h?et.range(Math.max(0,h.anchor+O),Math.max(0,h.head+O)):y.map(S)}})}else i={changes:l,selection:h&&s.selection.replaceRange(h)}}let a="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,a+=".compose",r.inputState.compositionFirstChange&&(a+=".start",r.inputState.compositionFirstChange=!1)),s.update(i,{userEvent:a,scrollIntoView:!0})}function E3e(r,e,n,i){let s=Math.min(r.length,e.length),o=0;for(;o<s&&r.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&r.length==e.length)return null;let a=r.length,l=e.length;for(;a>0&&l>0&&r.charCodeAt(a-1)==e.charCodeAt(l-1);)a--,l--;if(i=="end"){let h=Math.max(0,o-Math.min(a,l));n-=a+h-o}if(a<o&&r.length<e.length){let h=n<=o&&n>=a?o-n:0;o-=h,l=o+(l-a),a=o}else if(l<o){let h=n<=o&&n>=l?o-n:0;o-=h,a=o+(a-l),l=o}return{from:o,toA:a,toB:l}}function M3e(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o}=r.observer.selectionRange;return n&&(e.push(new N8(n,i)),(s!=n||o!=i)&&e.push(new N8(s,o))),e}function A3e(r,e){if(r.length==0)return null;let n=r[0].pos,i=r.length==2?r[1].pos:n;return n>-1&&i>-1?et.single(n+e,i+e):null}class k3e{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,It.safari&&e.contentDOM.addEventListener("input",()=>null),It.gecko&&H3e(e.contentDOM.ownerDocument)}handleEvent(e){!$3e(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,n){let i=this.handlers[e];if(i){for(let s of i.observers)s(this.view,n);for(let s of i.handlers){if(n.defaultPrevented)break;if(s(this.view,n)){n.preventDefault();break}}}}ensureHandlers(e){let n=P3e(e),i=this.handlers,s=this.view.contentDOM;for(let o in n)if(o!="scroll"){let a=!n[o].handlers.length,l=i[o];l&&a!=!l.handlers.length&&(s.removeEventListener(o,this.handleEvent),l=null),l||s.addEventListener(o,this.handleEvent,{passive:a})}for(let o in i)o!="scroll"&&!n[o]&&s.removeEventListener(o,this.handleEvent);this.handlers=n}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&OY.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),It.android&&It.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let n;return It.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((n=_Y.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||R3e.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=n||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let n=this.pendingIOSKey;return!n||n.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,yg(this.view.contentDOM,n.key,n.keyCode,n instanceof KeyboardEvent?n:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:It.safari&&!It.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function D8(r,e){return(n,i)=>{try{return e.call(r,i,n)}catch(s){So(n.state,s)}}}function P3e(r){let e=Object.create(null);function n(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of r){let s=i.spec;if(s&&s.domEventHandlers)for(let o in s.domEventHandlers){let a=s.domEventHandlers[o];a&&n(o).handlers.push(D8(i.value,a))}if(s&&s.domEventObservers)for(let o in s.domEventObservers){let a=s.domEventObservers[o];a&&n(o).observers.push(D8(i.value,a))}}for(let i in wl)n(i).handlers.push(wl[i]);for(let i in Ba)n(i).observers.push(Ba[i]);return e}const _Y=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],R3e="dthko",OY=[16,17,18,20,91,92,224,225],E_=6;function M_(r){return Math.max(0,r)*.7+8}function I3e(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}class N3e{constructor(e,n,i,s){this.view=e,this.startEvent=n,this.style=i,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=n,this.scrollParents=XPe(e.contentDOM),this.atoms=e.state.facet(p5).map(a=>a(e));let o=e.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=n.shiftKey,this.multiple=e.state.facet(an.allowMultipleSelections)&&D3e(e,n),this.dragging=B3e(e,n)&&TY(n)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&I3e(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,i=0,s=0,o=0,a=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:o,bottom:l}=this.scrollParents.y.getBoundingClientRect());let h=yY(this.view);e.clientX-h.left<=s+E_?n=-M_(s-e.clientX):e.clientX+h.right>=a-E_&&(n=M_(e.clientX-a)),e.clientY-h.top<=o+E_?i=-M_(o-e.clientY):e.clientY+h.bottom>=l-E_&&(i=M_(e.clientY-l)),this.setScrollSpeed(n,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,n){this.scrollSpeed={x:e,y:n},e||n?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:n}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),n&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=n,n=0),(e||n)&&this.view.win.scrollBy(e,n),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let n=null;for(let i=0;i<e.ranges.length;i++){let s=e.ranges[i],o=null;if(s.empty){let a=zO(this.atoms,s.from,0);a!=s.from&&(o=et.cursor(a,-1))}else{let a=zO(this.atoms,s.from,-1),l=zO(this.atoms,s.to,1);(a!=s.from||l!=s.to)&&(o=et.range(s.from==s.anchor?a:l,s.from==s.head?a:l))}o&&(n||(n=e.ranges.slice()),n[i]=o)}return n?et.create(n,e.mainIndex):e}select(e){let{view:n}=this,i=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(n.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(n=>n.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function D3e(r,e){let n=r.state.facet(rY);return n.length?n[0](e):It.mac?e.metaKey:e.ctrlKey}function L3e(r,e){let n=r.state.facet(sY);return n.length?n[0](e):It.mac?!e.altKey:!e.ctrlKey}function B3e(r,e){let{main:n}=r.state.selection;if(n.empty)return!1;let i=eb(r.root);if(!i||i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let o=0;o<s.length;o++){let a=s[o];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function $3e(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target,i;n!=r.contentDOM;n=n.parentNode)if(!n||n.nodeType==11||(i=En.get(n))&&i.ignoreEvent(e))return!1;return!0}const wl=Object.create(null),Ba=Object.create(null),SY=It.ie&&It.ie_version<15||It.ios&&It.webkit_version<604;function U3e(r){let e=r.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{r.focus(),n.remove(),CY(r,n.value)},50)}function F2(r,e,n){for(let i of r.facet(e))n=i(n,r);return n}function CY(r,e){e=F2(r.state,u5,e);let{state:n}=r,i,s=1,o=n.toText(e),a=o.lines==n.selection.ranges.length;if(k3!=null&&n.selection.ranges.every(h=>h.empty)&&k3==o.toString()){let h=-1;i=n.changeByRange(u=>{let f=n.doc.lineAt(u.from);if(f.from==h)return{range:u};h=f.from;let p=n.toText((a?o.line(s++).text:e)+n.lineBreak);return{changes:{from:f.from,insert:p},range:et.cursor(u.from+p.length)}})}else a?i=n.changeByRange(h=>{let u=o.line(s++);return{changes:{from:h.from,to:h.to,insert:u.text},range:et.cursor(h.from+u.length)}}):i=n.replaceSelection(o);r.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Ba.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};wl.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);Ba.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};Ba.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};wl.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let i of r.state.facet(oY))if(n=i(r,e),n)break;if(!n&&e.button==0&&(n=z3e(r,e)),n){let i=!r.hasFocus;r.inputState.startMouseSelection(new N3e(r,e,n,i)),i&&r.observer.ignore(()=>{Uj(r.contentDOM);let o=r.root.activeElement;o&&!o.contains(r.contentDOM)&&o.blur()});let s=r.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}return!1};function L8(r,e,n,i){if(i==1)return et.cursor(e,n);if(i==2)return m3e(r.state,e,n);{let s=_r.find(r.docView,e),o=r.state.doc.lineAt(s?s.posAtEnd:e),a=s?s.posAtStart:o.from,l=s?s.posAtEnd:o.to;return l<r.state.doc.length&&l==o.to&&l++,et.range(a,l)}}let B8=(r,e,n)=>e>=n.top&&e<=n.bottom&&r>=n.left&&r<=n.right;function V3e(r,e,n,i){let s=_r.find(r.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(o==0)return 1;if(o==s.length)return-1;let a=s.coordsAt(o,-1);if(a&&B8(n,i,a))return-1;let l=s.coordsAt(o,1);return l&&B8(n,i,l)?1:a&&a.bottom>=i?-1:1}function $8(r,e){let n=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:n,bias:V3e(r,n,e.clientX,e.clientY)}}const F3e=It.ie&&It.ie_version<=11;let U8=null,V8=0,F8=0;function TY(r){if(!F3e)return r.detail;let e=U8,n=F8;return U8=r,F8=Date.now(),V8=!e||n>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(V8+1)%3:1}function z3e(r,e){let n=$8(r,e),i=TY(e),s=r.state.selection;return{update(o){o.docChanged&&(n.pos=o.changes.mapPos(n.pos),s=s.map(o.changes))},get(o,a,l){let h=$8(r,o),u,f=L8(r,h.pos,h.bias,i);if(n.pos!=h.pos&&!a){let p=L8(r,n.pos,n.bias,i),m=Math.min(p.from,f.from),v=Math.max(p.to,f.to);f=m<f.from?et.range(m,v):et.range(v,m)}return a?s.replaceRange(s.main.extend(f.from,f.to)):l&&i==1&&s.ranges.length>1&&(u=X3e(s,h.pos))?u:l?s.addRange(f):et.create([f])}}}function X3e(r,e){for(let n=0;n<r.ranges.length;n++){let{from:i,to:s}=r.ranges[n];if(i<=e&&s>=e)return et.create(r.ranges.slice(0,n).concat(r.ranges.slice(n+1)),r.mainIndex==n?0:r.mainIndex-(r.mainIndex>n?1:0))}return null}wl.dragstart=(r,e)=>{let{selection:{main:n}}=r.state;if(e.target.draggable){let s=r.docView.nearest(e.target);if(s&&s.isWidget){let o=s.posAtStart,a=o+s.length;(o>=n.to||a<=n.from)&&(n=et.range(o,a))}}let{inputState:i}=r;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=n,e.dataTransfer&&(e.dataTransfer.setData("Text",F2(r.state,d5,r.state.sliceDoc(n.from,n.to))),e.dataTransfer.effectAllowed="copyMove"),!1};wl.dragend=r=>(r.inputState.draggedContent=null,!1);function z8(r,e,n,i){if(n=F2(r.state,u5,n),!n)return;let s=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=r.inputState,a=i&&o&&L3e(r,e)?{from:o.from,to:o.to}:null,l={from:s,insert:n},h=r.state.changes(a?[a,l]:l);r.focus(),r.dispatch({changes:h,selection:{anchor:h.mapPos(s,-1),head:h.mapPos(s,1)},userEvent:a?"move.drop":"input.drop"}),r.inputState.draggedContent=null}wl.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let n=e.dataTransfer.files;if(n&&n.length){let i=Array(n.length),s=0,o=()=>{++s==n.length&&z8(r,e,i.filter(a=>a!=null).join(r.state.lineBreak),!1)};for(let a=0;a<n.length;a++){let l=new FileReader;l.onerror=o,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(i[a]=l.result),o()},l.readAsText(n[a])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return z8(r,e,i,!0),!0}return!1};wl.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let n=SY?null:e.clipboardData;return n?(CY(r,n.getData("text/plain")||n.getData("text/uri-list")),!0):(U3e(r),!1)};function W3e(r,e){let n=r.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),r.focus()},50)}function G3e(r){let e=[],n=[],i=!1;for(let s of r.selection.ranges)s.empty||(e.push(r.sliceDoc(s.from,s.to)),n.push(s));if(!e.length){let s=-1;for(let{from:o}of r.selection.ranges){let a=r.doc.lineAt(o);a.number>s&&(e.push(a.text),n.push({from:a.from,to:Math.min(r.doc.length,a.to+1)})),s=a.number}i=!0}return{text:F2(r,d5,e.join(r.lineBreak)),ranges:n,linewise:i}}let k3=null;wl.copy=wl.cut=(r,e)=>{let{text:n,ranges:i,linewise:s}=G3e(r.state);if(!n&&!s)return!1;k3=s?n:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let o=SY?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",n),!0):(W3e(r,n),!1)};const EY=Nh.define();function MY(r,e){let n=[];for(let i of r.facet(cY)){let s=i(r,e);s&&n.push(s)}return n?r.update({effects:n,annotations:EY.of(!0)}):null}function AY(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let n=MY(r.state,e);n?r.dispatch(n):r.update([])}},10)}Ba.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),AY(r)};Ba.blur=r=>{r.observer.clearSelectionRange(),AY(r)};Ba.compositionstart=Ba.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};Ba.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,It.chrome&&It.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};Ba.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};wl.beforeinput=(r,e)=>{var n,i;if(e.inputType=="insertReplacementText"&&r.observer.editContext){let o=(n=e.dataTransfer)===null||n===void 0?void 0:n.getData("text/plain"),a=e.getTargetRanges();if(o&&a.length){let l=a[0],h=r.posAtDOM(l.startContainer,l.startOffset),u=r.posAtDOM(l.endContainer,l.endOffset);return m5(r,{from:h,to:u,insert:r.state.toText(o)},null),!0}}let s;if(It.chrome&&It.android&&(s=_Y.find(o=>o.inputType==e.inputType))&&(r.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let o=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>o+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return It.ios&&e.inputType=="deleteContentForward"&&r.observer.flushSoon(),It.safari&&e.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>Ba.compositionend(r,e),20),!1};const X8=new Set;function H3e(r){X8.has(r)||(X8.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const W8=["pre-wrap","normal","pre-line","break-spaces"];let Qg=!1;function G8(){Qg=!1}class Q3e{constructor(e){this.lineWrapping=e,this.doc=bn.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,n){let i=this.doc.lineAt(n).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((n-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return W8.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let n=!1;for(let i=0;i<e.length;i++){let s=e[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(n=!0,this.heightSamples[Math.floor(s*10)]=!0)}return n}refresh(e,n,i,s,o,a){let l=W8.indexOf(e)>-1,h=Math.round(n)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=n,this.charWidth=i,this.textHeight=s,this.lineLength=o,h){this.heightSamples={};for(let u=0;u<a.length;u++){let f=a[u];f<0?u++:this.heightSamples[Math.floor(f*10)]=!0}}return h}}class j3e{constructor(e,n){this.from=e,this.heights=n,this.index=0}get more(){return this.index<this.heights.length}}class ec{constructor(e,n,i,s,o){this.from=e,this.length=n,this.top=i,this.height=s,this._content=o}get type(){return typeof this._content=="number"?eo.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof hd?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let n=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new ec(this.from,this.length+e.length,this.top,this.height+e.height,n)}}var Bn=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(Bn||(Bn={}));const XO=.001;class to{constructor(e,n,i=2){this.length=e,this.height=n,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>XO&&(Qg=!0),this.height=e)}replace(e,n,i){return to.of(i)}decomposeLeft(e,n){n.push(this)}decomposeRight(e,n){n.push(this)}applyChanges(e,n,i,s){let o=this,a=i.doc;for(let l=s.length-1;l>=0;l--){let{fromA:h,toA:u,fromB:f,toB:p}=s[l],m=o.lineAt(h,Bn.ByPosNoHeight,i.setDoc(n),0,0),v=m.to>=u?m:o.lineAt(u,Bn.ByPosNoHeight,i,0,0);for(p+=v.to-u,u=v.to;l>0&&m.from<=s[l-1].toA;)h=s[l-1].fromA,f=s[l-1].fromB,l--,h<m.from&&(m=o.lineAt(h,Bn.ByPosNoHeight,i,0,0));f+=m.from-h,h=m.from;let y=g5.build(i.setDoc(a),e,f,p);o=VS(o,o.replace(h,u,y))}return o.updateHeight(i,0)}static empty(){return new Qo(0,0)}static of(e){if(e.length==1)return e[0];let n=0,i=e.length,s=0,o=0;for(;;)if(n==i)if(s>o*2){let l=e[n-1];l.break?e.splice(--n,1,l.left,null,l.right):e.splice(--n,1,l.left,l.right),i+=1+l.break,s-=l.size}else if(o>s*2){let l=e[i];l.break?e.splice(i,1,l.left,null,l.right):e.splice(i,1,l.left,l.right),i+=2+l.break,o-=l.size}else break;else if(s<o){let l=e[n++];l&&(s+=l.size)}else{let l=e[--i];l&&(o+=l.size)}let a=0;return e[n-1]==null?(a=1,n--):e[n]==null&&(a=1,i++),new Y3e(to.of(e.slice(0,n)),a,to.of(e.slice(i)))}}function VS(r,e){return r==e?r:(r.constructor!=e.constructor&&(Qg=!0),e)}to.prototype.size=1;class kY extends to{constructor(e,n,i){super(e,n),this.deco=i}blockAt(e,n,i,s){return new ec(s,this.length,i,this.height,this.deco||0)}lineAt(e,n,i,s,o){return this.blockAt(0,i,s,o)}forEachLine(e,n,i,s,o,a){e<=o+this.length&&n>=o&&a(this.blockAt(0,i,s,o))}updateHeight(e,n=0,i=!1,s){return s&&s.from<=n&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Qo extends kY{constructor(e,n){super(e,n,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,n,i,s){return new ec(s,this.length,i,this.height,this.breaks)}replace(e,n,i){let s=i[0];return i.length==1&&(s instanceof Qo||s instanceof hs&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof hs?s=new Qo(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):to.of(i)}updateHeight(e,n=0,i=!1,s){return s&&s.from<=n&&s.more?this.setHeight(s.heights[s.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class hs extends to{constructor(e){super(e,0)}heightMetrics(e,n){let i=e.doc.lineAt(n).number,s=e.doc.lineAt(n+this.length).number,o=s-i+1,a,l=0;if(e.lineWrapping){let h=Math.min(this.height,e.lineHeight*o);a=h/o,this.length>o+1&&(l=(this.height-h)/(this.length-o-1))}else a=this.height/o;return{firstLine:i,lastLine:s,perLine:a,perChar:l}}blockAt(e,n,i,s){let{firstLine:o,lastLine:a,perLine:l,perChar:h}=this.heightMetrics(n,s);if(n.lineWrapping){let u=s+(e<n.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),f=n.doc.lineAt(u),p=l+f.length*h,m=Math.max(i,e-p/2);return new ec(f.from,f.length,m,p,0)}else{let u=Math.max(0,Math.min(a-o,Math.floor((e-i)/l))),{from:f,length:p}=n.doc.line(o+u);return new ec(f,p,i+l*u,l,0)}}lineAt(e,n,i,s,o){if(n==Bn.ByHeight)return this.blockAt(e,i,s,o);if(n==Bn.ByPosNoHeight){let{from:v,to:y}=i.doc.lineAt(e);return new ec(v,y-v,0,0,0)}let{firstLine:a,perLine:l,perChar:h}=this.heightMetrics(i,o),u=i.doc.lineAt(e),f=l+u.length*h,p=u.number-a,m=s+l*p+h*(u.from-o-p);return new ec(u.from,u.length,Math.max(s,Math.min(m,s+this.height-f)),f,0)}forEachLine(e,n,i,s,o,a){e=Math.max(e,o),n=Math.min(n,o+this.length);let{firstLine:l,perLine:h,perChar:u}=this.heightMetrics(i,o);for(let f=e,p=s;f<=n;){let m=i.doc.lineAt(f);if(f==e){let y=m.number-l;p+=h*y+u*(e-o-y)}let v=h+u*m.length;a(new ec(m.from,m.length,p,v,0)),p+=v,f=m.to+1}}replace(e,n,i){let s=this.length-n;if(s>0){let o=i[i.length-1];o instanceof hs?i[i.length-1]=new hs(o.length+s):i.push(null,new hs(s-1))}if(e>0){let o=i[0];o instanceof hs?i[0]=new hs(e+o.length):i.unshift(new hs(e-1),null)}return to.of(i)}decomposeLeft(e,n){n.push(new hs(e-1),null)}decomposeRight(e,n){n.push(null,new hs(this.length-e-1))}updateHeight(e,n=0,i=!1,s){let o=n+this.length;if(s&&s.from<=n+this.length&&s.more){let a=[],l=Math.max(n,s.from),h=-1;for(s.from>n&&a.push(new hs(s.from-n-1).updateHeight(e,n));l<=o&&s.more;){let f=e.doc.lineAt(l).length;a.length&&a.push(null);let p=s.heights[s.index++];h==-1?h=p:Math.abs(p-h)>=XO&&(h=-2);let m=new Qo(f,p);m.outdated=!1,a.push(m),l+=f+1}l<=o&&a.push(null,new hs(o-l).updateHeight(e,l));let u=to.of(a);return(h<0||Math.abs(u.height-this.height)>=XO||Math.abs(h-this.heightMetrics(e,n).perLine)>=XO)&&(Qg=!0),VS(this,u)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(n,n+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Y3e extends to{constructor(e,n,i){super(e.length+n+i.length,e.height+i.height,n|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,n,i,s){let o=i+this.left.height;return e<o?this.left.blockAt(e,n,i,s):this.right.blockAt(e,n,o,s+this.left.length+this.break)}lineAt(e,n,i,s,o){let a=s+this.left.height,l=o+this.left.length+this.break,h=n==Bn.ByHeight?e<a:e<l,u=h?this.left.lineAt(e,n,i,s,o):this.right.lineAt(e,n,i,a,l);if(this.break||(h?u.to<l:u.from>l))return u;let f=n==Bn.ByPosNoHeight?Bn.ByPosNoHeight:Bn.ByPos;return h?u.join(this.right.lineAt(l,f,i,a,l)):this.left.lineAt(l,f,i,s,o).join(u)}forEachLine(e,n,i,s,o,a){let l=s+this.left.height,h=o+this.left.length+this.break;if(this.break)e<h&&this.left.forEachLine(e,n,i,s,o,a),n>=h&&this.right.forEachLine(e,n,i,l,h,a);else{let u=this.lineAt(h,Bn.ByPos,i,s,o);e<u.from&&this.left.forEachLine(e,u.from-1,i,s,o,a),u.to>=e&&u.from<=n&&a(u),n>u.to&&this.right.forEachLine(u.to+1,n,i,l,h,a)}}replace(e,n,i){let s=this.left.length+this.break;if(n<s)return this.balanced(this.left.replace(e,n,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,n-s,i));let o=[];e>0&&this.decomposeLeft(e,o);let a=o.length;for(let l of i)o.push(l);if(e>0&&H8(o,a-1),n<this.length){let l=o.length;this.decomposeRight(n,o),H8(o,l)}return to.of(o)}decomposeLeft(e,n){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,n);n.push(this.left),this.break&&(i++,e>=i&&n.push(null)),e>i&&this.right.decomposeLeft(e-i,n)}decomposeRight(e,n){let i=this.left.length,s=i+this.break;if(e>=s)return this.right.decomposeRight(e-s,n);e<i&&this.left.decomposeRight(e,n),this.break&&e<s&&n.push(null),n.push(this.right)}balanced(e,n){return e.size>2*n.size||n.size>2*e.size?to.of(this.break?[e,null,n]:[e,n]):(this.left=VS(this.left,e),this.right=VS(this.right,n),this.setHeight(e.height+n.height),this.outdated=e.outdated||n.outdated,this.size=e.size+n.size,this.length=e.length+this.break+n.length,this)}updateHeight(e,n=0,i=!1,s){let{left:o,right:a}=this,l=n+o.length+this.break,h=null;return s&&s.from<=n+o.length&&s.more?h=o=o.updateHeight(e,n,i,s):o.updateHeight(e,n,i),s&&s.from<=l+a.length&&s.more?h=a=a.updateHeight(e,l,i,s):a.updateHeight(e,l,i),h?this.balanced(o,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function H8(r,e){let n,i;r[e]==null&&(n=r[e-1])instanceof hs&&(i=r[e+1])instanceof hs&&r.splice(e-1,3,new hs(n.length+1+i.length))}const q3e=5;class g5{constructor(e,n){this.pos=e,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,n){if(this.lineStart>-1){let i=Math.min(n,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Qo?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Qo(i-this.pos,-1)),this.writtenTo=i,n>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=n}point(e,n,i){if(e<n||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0,o=i.widget?i.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let a=n-e;i.block?this.addBlock(new kY(a,s,i)):(a||o||s>=q3e)&&this.addLineDeco(s,o,a)}else n>e&&this.span(e,n);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:n}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=n,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Qo(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,n){let i=new hs(n-e);return this.oracle.doc.lineAt(e).to==n&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Qo)return e;let n=new Qo(0,-1);return this.nodes.push(n),n}addBlock(e){this.enterLine();let n=e.deco;n&&n.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,n&&n.endSide>0&&(this.covering=e)}addLineDeco(e,n,i){let s=this.ensureLine();s.length+=i,s.collapsed+=i,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=n,this.writtenTo=this.pos=this.pos+i}finish(e){let n=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(n instanceof Qo)&&!this.isCovered?this.nodes.push(new Qo(0,-1)):(this.writtenTo<this.pos||n==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let s of this.nodes)s instanceof Qo&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(e,n,i,s){let o=new g5(i,e);return sn.spans(n,i,s,o,0),o.finish(i)}}function Z3e(r,e,n){let i=new K3e;return sn.compare(r,e,n,i,0),i.changes}class K3e{constructor(){this.changes=[]}compareRange(){}comparePoint(e,n,i,s){(e<n||i&&i.heightRelevant||s&&s.heightRelevant)&&_3(e,n,this.changes,5)}}function J3e(r,e){let n=r.getBoundingClientRect(),i=r.ownerDocument,s=i.defaultView||window,o=Math.max(0,n.left),a=Math.min(s.innerWidth,n.right),l=Math.max(0,n.top),h=Math.min(s.innerHeight,n.bottom);for(let u=r.parentNode;u&&u!=i.body;)if(u.nodeType==1){let f=u,p=window.getComputedStyle(f);if((f.scrollHeight>f.clientHeight||f.scrollWidth>f.clientWidth)&&p.overflow!="visible"){let m=f.getBoundingClientRect();o=Math.max(o,m.left),a=Math.min(a,m.right),l=Math.max(l,m.top),h=Math.min(u==r.parentNode?s.innerHeight:h,m.bottom)}u=p.position=="absolute"||p.position=="fixed"?f.offsetParent:f.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:o-n.left,right:Math.max(o,a)-n.left,top:l-(n.top+e),bottom:Math.max(l,h)-(n.top+e)}}function eRe(r,e){let n=r.getBoundingClientRect();return{left:0,right:n.right-n.left,top:e,bottom:n.bottom-(n.top+e)}}class lA{constructor(e,n,i){this.from=e,this.to=n,this.size=i}static same(e,n){if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++){let s=e[i],o=n[i];if(s.from!=o.from||s.to!=o.to||s.size!=o.size)return!1}return!0}draw(e,n){return ui.replace({widget:new tRe(this.size*(n?e.scaleY:e.scaleX),n)}).range(this.from,this.to)}}class tRe extends wd{constructor(e,n){super(),this.size=e,this.vertical=n}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Q8{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=j8,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Vn.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let n=e.facet(f5).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new Q3e(n),this.stateDeco=e.facet(ib).filter(i=>typeof i!="function"),this.heightMap=to.empty().applyChanges(this.stateDeco,bn.empty,this.heightOracle.setDoc(e.doc),[new Na(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ui.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:n}=this.state.selection;for(let i=0;i<=1;i++){let s=i?n.head:n.anchor;if(!e.some(({from:o,to:a})=>s>=o&&s<=a)){let{from:o,to:a}=this.lineBlockAt(s);e.push(new A_(o,a))}}return this.viewports=e.sort((i,s)=>i.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?j8:new v5(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Wy(e,this.scaler))})}update(e,n=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(ib).filter(f=>typeof f!="function");let s=e.changedRanges,o=Na.extendWithRanges(s,Z3e(i,this.stateDeco,e?e.changes:$r.empty(this.state.doc.length))),a=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);G8(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),o),(this.heightMap.height!=a||Qg)&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let h=o.length?this.mapViewport(this.viewport,e.changes):this.viewport;(n&&(n.range.head<h.from||n.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,n));let u=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,e.flags|=this.updateForViewport(),(u||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),n&&(this.scrollTarget=n),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(uY)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let n=e.contentDOM,i=window.getComputedStyle(n),s=this.heightOracle,o=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?Vn.RTL:Vn.LTR;let a=this.heightOracle.mustRefreshForWrapping(o),l=n.getBoundingClientRect(),h=a||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let u=0,f=0;if(l.width&&l.height){let{scaleX:T,scaleY:A}=$j(n,l);(T>.005&&Math.abs(this.scaleX-T)>.005||A>.005&&Math.abs(this.scaleY-A)>.005)&&(this.scaleX=T,this.scaleY=A,u|=8,a=h=!0)}let p=(parseInt(i.paddingTop)||0)*this.scaleY,m=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=p||this.paddingBottom!=m)&&(this.paddingTop=p,this.paddingBottom=m,u|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=8);let v=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=v&&(this.scrollAnchorHeight=-1,this.scrollTop=v),this.scrolledToBottom=Fj(e.scrollDOM);let y=(this.printing?eRe:J3e)(n,this.paddingTop),x=y.top-this.pixelViewport.top,w=y.bottom-this.pixelViewport.bottom;this.pixelViewport=y;let S=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(S!=this.inView&&(this.inView=S,S&&(h=!0)),!this.inView&&!this.scrollTarget)return 0;let O=l.width;if((this.contentDOMWidth!=O||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,u|=8),h){let T=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(T)&&(a=!0),a||s.lineWrapping&&Math.abs(O-this.contentDOMWidth)>s.charWidth){let{lineHeight:A,charWidth:P,textHeight:N}=e.docView.measureTextSize();a=A>0&&s.refresh(o,A,P,N,O/P,T),a&&(e.docView.minWidth=0,u|=8)}x>0&&w>0?f=Math.max(x,w):x<0&&w<0&&(f=Math.min(x,w)),G8();for(let A of this.viewports){let P=A.from==this.viewport.from?T:e.docView.measureVisibleLineHeights(A);this.heightMap=(a?to.empty().applyChanges(this.stateDeco,bn.empty,this.heightOracle,[new Na(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,a,new j3e(A.from,P))}Qg&&(u|=2)}let _=!this.viewportIsAppropriate(this.viewport,f)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return _&&(u&2&&(u|=this.updateScaler()),this.viewport=this.getViewport(f,this.scrollTarget),u|=this.updateForViewport()),(u&2||_)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,n){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,o=this.heightOracle,{visibleTop:a,visibleBottom:l}=this,h=new A_(s.lineAt(a-i*1e3,Bn.ByHeight,o,0,0).from,s.lineAt(l+(1-i)*1e3,Bn.ByHeight,o,0,0).to);if(n){let{head:u}=n.range;if(u<h.from||u>h.to){let f=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),p=s.lineAt(u,Bn.ByPos,o,0,0),m;n.y=="center"?m=(p.top+p.bottom)/2-f/2:n.y=="start"||n.y=="nearest"&&u<h.from?m=p.top:m=p.bottom-f,h=new A_(s.lineAt(m-1e3/2,Bn.ByHeight,o,0,0).from,s.lineAt(m+f+1e3/2,Bn.ByHeight,o,0,0).to)}}return h}mapViewport(e,n){let i=n.mapPos(e.from,-1),s=n.mapPos(e.to,1);return new A_(this.heightMap.lineAt(i,Bn.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,Bn.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:n},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,Bn.ByPos,this.heightOracle,0,0),{bottom:o}=this.heightMap.lineAt(n,Bn.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:l}=this;return(e==0||s<=a-Math.max(10,Math.min(-i,250)))&&(n==this.state.doc.length||o>=l+Math.max(10,Math.min(i,250)))&&s>a-2*1e3&&o<l+2*1e3}mapLineGaps(e,n){if(!e.length||n.empty)return e;let i=[];for(let s of e)n.touchesRange(s.from,s.to)||i.push(new lA(n.mapPos(s.from),n.mapPos(s.to),s.size));return i}ensureLineGaps(e,n){let i=this.heightOracle.lineWrapping,s=i?1e4:2e3,o=s>>1,a=s<<1;if(this.defaultTextDirection!=Vn.LTR&&!i)return[];let l=[],h=(f,p,m,v)=>{if(p-f<o)return;let y=this.state.selection.main,x=[y.from];y.empty||x.push(y.to);for(let S of x)if(S>f&&S<p){h(f,S-10,m,v),h(S+10,p,m,v);return}let w=nRe(e,S=>S.from>=m.from&&S.to<=m.to&&Math.abs(S.from-f)<o&&Math.abs(S.to-p)<o&&!x.some(O=>S.from<O&&S.to>O));if(!w){if(p<m.to&&n&&i&&n.visibleRanges.some(S=>S.from<=p&&S.to>=p)){let S=n.moveToLineBoundary(et.cursor(p),!1,!0).head;S>f&&(p=S)}w=new lA(f,p,this.gapSize(m,f,p,v))}l.push(w)},u=f=>{if(f.length<a||f.type!=eo.Text)return;let p=iRe(f.from,f.to,this.stateDeco);if(p.total<a)return;let m=this.scrollTarget?this.scrollTarget.range.head:null,v,y;if(i){let x=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,w,S;if(m!=null){let O=P_(p,m),_=((this.visibleBottom-this.visibleTop)/2+x)/f.height;w=O-_,S=O+_}else w=(this.visibleTop-f.top-x)/f.height,S=(this.visibleBottom-f.top+x)/f.height;v=k_(p,w),y=k_(p,S)}else{let x=p.total*this.heightOracle.charWidth,w=s*this.heightOracle.charWidth,S,O;if(m!=null){let _=P_(p,m),T=((this.pixelViewport.right-this.pixelViewport.left)/2+w)/x;S=_-T,O=_+T}else S=(this.pixelViewport.left-w)/x,O=(this.pixelViewport.right+w)/x;v=k_(p,S),y=k_(p,O)}v>f.from&&h(f.from,v,f,p),y<f.to&&h(y,f.to,f,p)};for(let f of this.viewportLines)Array.isArray(f.type)?f.type.forEach(u):u(f);return l}gapSize(e,n,i,s){let o=P_(s,i)-P_(s,n);return this.heightOracle.lineWrapping?e.height*o:s.total*this.heightOracle.charWidth*o}updateLineGaps(e){lA.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ui.set(e.map(n=>n.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let n=[];sn.spans(e,this.viewport.from,this.viewport.to,{span(s,o){n.push({from:s,to:o})},point(){}},20);let i=n.length!=this.visibleRanges.length||this.visibleRanges.some((s,o)=>s.from!=n[o].from||s.to!=n[o].to);return this.visibleRanges=n,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(n=>n.from<=e&&n.to>=e)||Wy(this.heightMap.lineAt(e,Bn.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(n=>n.top<=e&&n.bottom>=e)||Wy(this.heightMap.lineAt(this.scaler.fromDOM(e),Bn.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let n=this.lineBlockAtHeight(e+8);return n.from>=this.viewport.from||this.viewportLines[0].top-e>200?n:this.viewportLines[0]}elementAtHeight(e){return Wy(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class A_{constructor(e,n){this.from=e,this.to=n}}function iRe(r,e,n){let i=[],s=r,o=0;return sn.spans(n,r,e,{span(){},point(a,l){a>s&&(i.push({from:s,to:a}),o+=a-s),s=l}},20),s<e&&(i.push({from:s,to:e}),o+=e-s),{total:o,ranges:i}}function k_({total:r,ranges:e},n){if(n<=0)return e[0].from;if(n>=1)return e[e.length-1].to;let i=Math.floor(r*n);for(let s=0;;s++){let{from:o,to:a}=e[s],l=a-o;if(i<=l)return o+i;i-=l}}function P_(r,e){let n=0;for(let{from:i,to:s}of r.ranges){if(e<=s){n+=e-i;break}n+=s-i}return n/r.total}function nRe(r,e){for(let n of r)if(e(n))return n}const j8={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}};class v5{constructor(e,n,i){let s=0,o=0,a=0;this.viewports=i.map(({from:l,to:h})=>{let u=n.lineAt(l,Bn.ByPos,e,0,0).top,f=n.lineAt(h,Bn.ByPos,e,0,0).bottom;return s+=f-u,{from:l,to:h,top:u,bottom:f,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(n.height-s);for(let l of this.viewports)l.domTop=a+(l.top-o)*this.scale,a=l.domBottom=l.domTop+(l.bottom-l.top),o=l.bottom}toDOM(e){for(let n=0,i=0,s=0;;n++){let o=n<this.viewports.length?this.viewports[n]:null;if(!o||e<o.top)return s+(e-i)*this.scale;if(e<=o.bottom)return o.domTop+(e-o.top);i=o.bottom,s=o.domBottom}}fromDOM(e){for(let n=0,i=0,s=0;;n++){let o=n<this.viewports.length?this.viewports[n]:null;if(!o||e<o.domTop)return i+(e-s)/this.scale;if(e<=o.domBottom)return o.top+(e-o.domTop);i=o.bottom,s=o.domBottom}}eq(e){return e instanceof v5?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((n,i)=>n.from==e.viewports[i].from&&n.to==e.viewports[i].to):!1}}function Wy(r,e){if(e.scale==1)return r;let n=e.toDOM(r.top),i=e.toDOM(r.bottom);return new ec(r.from,r.length,n,i-n,Array.isArray(r._content)?r._content.map(s=>Wy(s,e)):r._content)}const R_=Pt.define({combine:r=>r.join(" ")}),P3=Pt.define({combine:r=>r.indexOf(!0)>-1}),R3=ld.newName(),PY=ld.newName(),RY=ld.newName(),IY={"&light":"."+PY,"&dark":"."+RY};function I3(r,e,n){return new ld(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return r;if(!n||!n[s])throw new RangeError(`Unsupported selector: ${s}`);return n[s]}):r+" "+i}})}const rRe=I3("."+R3,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},IY),sRe={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},cA=It.ie&&It.ie_version<=11;class oRe{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new WPe,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(n=>{for(let i of n)this.queue.push(i);(It.ie&&It.ie_version<=11||It.ios&&e.composing)&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(It.chrome&&It.chrome_version<126)&&(this.editContext=new lRe(e),e.state.facet(Nu)&&(e.contentDOM.editContext=this.editContext.editContext)),cA&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var n;((n=this.view.docView)===null||n===void 0?void 0:n.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(n=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),n.length>0&&n[n.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(n=>{n.length>0&&n[n.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((n,i)=>n!=e[i]))){this.gapIntersection.disconnect();for(let n of e)this.gapIntersection.observe(n);this.gaps=e}}onSelectionChange(e){let n=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,s=this.selectionRange;if(i.state.facet(Nu)?i.root.activeElement!=this.dom:!FO(i.dom,s))return;let o=s.anchorNode&&i.docView.nearest(s.anchorNode);if(o&&o.ignoreEvent(e)){n||(this.selectionChanged=!1);return}(It.ie&&It.ie_version<=11||It.android&&It.chrome)&&!i.state.selection.main.empty&&s.focusNode&&d1(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,n=eb(e.root);if(!n)return!1;let i=It.safari&&e.root.nodeType==11&&VPe(this.dom.ownerDocument)==this.dom&&aRe(this.view,n)||n;if(!i||this.selectionRange.eq(i))return!1;let s=FO(this.dom,i);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&HPe(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,n){this.selectionRange.set(e.node,e.offset,n.node,n.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,n=null;for(let i=this.dom;i;)if(i.nodeType==1)!n&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:n||(n=this.scrollTargets.slice(0,e)),n&&n.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!n&&(n=this.scrollTargets.slice(0,e)),n){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=n)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,sRe),cA&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),cA&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,n){var i;if(!this.delayedAndroidKey){let s=()=>{let o=this.delayedAndroidKey;o&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=o.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&o.force&&yg(this.dom,o.key,o.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:n,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let n=-1,i=-1,s=!1;for(let o of e){let a=this.readMutation(o);a&&(a.typeOver&&(s=!0),n==-1?{from:n,to:i}=a:(n=Math.min(a.from,n),i=Math.max(a.to,i)))}return{from:n,to:i,typeOver:s}}readChange(){let{from:e,to:n,typeOver:i}=this.processRecords(),s=this.selectionChanged&&FO(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let o=new C3e(this.view,e,n,i);return this.view.docView.domChanged={newSel:o.newSel?o.newSel.main:null},o}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let n=this.readChange();if(!n)return this.view.requestMeasure(),!1;let i=this.view.state,s=wY(this.view,n);return this.view.state==i&&(n.domChanged||n.newSel&&!n.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(e){let n=this.view.docView.nearest(e.target);if(!n||n.ignoreMutation(e))return null;if(n.markDirty(e.type=="attributes"),e.type=="attributes"&&(n.flags|=4),e.type=="childList"){let i=Y8(n,e.previousSibling||e.target.previousSibling,-1),s=Y8(n,e.nextSibling||e.target.nextSibling,1);return{from:i?n.posAfter(i):n.posAtStart,to:s?n.posBefore(s):n.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Nu)!=e.state.facet(Nu)&&(e.view.contentDOM.editContext=e.state.facet(Nu)?this.editContext.editContext:null))}destroy(){var e,n,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(n=this.gapIntersection)===null||n===void 0||n.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Y8(r,e,n){for(;e;){let i=En.get(e);if(i&&i.parent==r)return i;let s=e.parentNode;e=s!=r.dom?s:n>0?e.nextSibling:e.previousSibling}return null}function q8(r,e){let n=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,a=r.docView.domAtPos(r.state.selection.main.anchor);return d1(a.node,a.offset,s,o)&&([n,i,s,o]=[s,o,n,i]),{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:o}}function aRe(r,e){if(e.getComposedRanges){let s=e.getComposedRanges(r.root)[0];if(s)return q8(r,s)}let n=null;function i(s){s.preventDefault(),s.stopImmediatePropagation(),n=s.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",i,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",i,!0),n?q8(r,n):null}class lRe{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.resetRange(e.state);let n=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let{anchor:s}=e.state.selection.main,o={from:this.toEditorPos(i.updateRangeStart),to:this.toEditorPos(i.updateRangeEnd),insert:bn.of(i.text.split(`
`))};o.from==this.from&&s<this.from?o.from=s:o.to==this.to&&s>this.to&&(o.to=s),!(o.from==o.to&&!o.insert.length)&&(this.pendingContextChange=o,e.state.readOnly||m5(e,o,et.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd))),this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)))},this.handlers.characterboundsupdate=i=>{let s=[],o=null;for(let a=this.toEditorPos(i.rangeStart),l=this.toEditorPos(i.rangeEnd);a<l;a++){let h=e.coordsForChar(a);o=h&&new DOMRect(h.left,h.top,h.right-h.left,h.bottom-h.top)||o||new DOMRect,s.push(o)}n.updateCharacterBounds(i.rangeStart,s)},this.handlers.textformatupdate=i=>{let s=[];for(let o of i.getTextFormats()){let a=o.underlineStyle,l=o.underlineThickness;if(a!="None"&&l!="None"){let h=`text-decoration: underline ${a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;s.push(ui.mark({attributes:{style:h}}).range(this.toEditorPos(o.rangeStart),this.toEditorPos(o.rangeEnd)))}}e.dispatch({effects:fY.of(ui.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{e.inputState.composing=-1,e.inputState.compositionFirstChange=null};for(let i in this.handlers)n.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let s=eb(i.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let n=0,i=!1,s=this.pendingContextChange;return e.changes.iterChanges((o,a,l,h,u)=>{if(i)return;let f=u.length-(a-o);if(s&&a>=s.to)if(s.from==o&&s.to==a&&s.insert.eq(u)){s=this.pendingContextChange=null,n+=f,this.to+=f;return}else s=null,this.revertPending(e.state);if(o+=n,a+=n,a<=this.from)this.from+=f,this.to+=f;else if(o<this.to){if(o<this.from||a>this.to||this.to-this.from+u.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(o),this.toContextPos(a),u.toString()),this.to+=f}n+=f}),s&&!i&&this.revertPending(e.state),!i}update(e){let n=this.pendingContextChange;!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.resetRange(e.state),this.editContext.updateText(0,this.editContext.text.length,e.state.doc.sliceString(this.from,this.to)),this.setSelection(e.state)):(e.docChanged||e.selectionSet||n)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:n}=e.selection.main;this.from=Math.max(0,n-1e4),this.to=Math.min(e.doc.length,n+1e4)}revertPending(e){let n=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(n.from),this.toContextPos(n.from+n.insert.length),e.doc.sliceString(n.from,n.to))}setSelection(e){let{main:n}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,n.anchor))),s=this.toContextPos(n.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(i,s)}rangeIsValid(e){let{head:n}=e.selection.main;return!(this.from>0&&n-this.from<500||this.to<e.doc.length&&this.to-n<500||this.to-this.from>1e4*3)}toEditorPos(e){return e+this.from}toContextPos(e){return e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class St{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var n;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(s=>s.forEach(o=>i(o,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||GPe(e.parent)||document,this.viewState=new Q8(e.state||an.create(e)),e.scrollTo&&e.scrollTo.is(T_)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Fy).map(s=>new sA(s));for(let s of this.plugins)s.update(this);this.observer=new oRe(this),this.inputState=new k3e(this),this.inputState.ensureHandlers(this.plugins),this.docView=new M8(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((n=document.fonts)===null||n===void 0)&&n.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let n=e.length==1&&e[0]instanceof zr?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(n,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let n=!1,i=!1,s,o=this.state;for(let m of e){if(m.startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=m.state}if(this.destroyed){this.viewState.state=o;return}let a=this.hasFocus,l=0,h=null;e.some(m=>m.annotation(EY))?(this.inputState.notifiedFocused=a,l=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,h=MY(o,a),h||(l=1));let u=this.observer.delayedAndroidKey,f=null;if(u?(this.observer.clearDelayedAndroidKey(),f=this.observer.readChange(),(f&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(f=null)):this.observer.clear(),o.facet(an.phrases)!=this.state.facet(an.phrases))return this.setState(o);s=US.create(this,o,e),s.flags|=l;let p=this.viewState.scrollTarget;try{this.updateState=2;for(let m of e){if(p&&(p=p.map(m.changes)),m.scrollIntoView){let{main:v}=m.state.selection;p=new bg(v.empty?v:et.cursor(v.head,v.head>v.anchor?-1:1))}for(let v of m.effects)v.is(T_)&&(p=v.value.clip(this.state))}this.viewState.update(s,p),this.bidiCache=FS.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),n=this.docView.update(s),this.state.facet(zy)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some(m=>m.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(R_)!=s.state.facet(R_)&&(this.viewState.mustMeasureContent=!0),(n||i||p||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),n&&this.docViewUpdate(),!s.empty)for(let m of this.state.facet(E3))try{m(s)}catch(v){So(this.state,v,"update listener")}(h||f)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),f&&!wY(this,f)&&u.force&&yg(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let n=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Q8(e),this.plugins=e.facet(Fy).map(i=>new sA(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new M8(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}n&&this.focus(),this.requestMeasure()}updatePlugins(e){let n=e.startState.facet(Fy),i=e.state.facet(Fy);if(n!=i){let s=[];for(let o of i){let a=n.indexOf(o);if(a<0)s.push(new sA(o));else{let l=this.plugins[a];l.mustUpdate=e,s.push(l)}}for(let o of this.plugins)o.mustUpdate!=e&&o.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);n!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let n=e.value;if(n&&n.docViewUpdate)try{n.docViewUpdate(this)}catch(i){So(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let n=null,i=this.scrollDOM,s=i.scrollTop*this.scaleY,{scrollAnchorPos:o,scrollAnchorHeight:a}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(a<0)if(Fj(i))o=-1,a=this.viewState.heightMap.height;else{let v=this.viewState.scrollAnchorAt(s);o=v.from,a=v.top}this.updateState=1;let h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];h&4||([this.measureRequests,u]=[u,this.measureRequests]);let f=u.map(v=>{try{return v.read(this)}catch(y){return So(this.state,y),Z8}}),p=US.create(this,this.state,[]),m=!1;p.flags|=h,n?n.flags|=h:n=p,this.updateState=2,p.empty||(this.updatePlugins(p),this.inputState.update(p),this.updateAttrs(),m=this.docView.update(p),m&&this.docViewUpdate());for(let v=0;v<u.length;v++)if(f[v]!=Z8)try{let y=u[v];y.write&&y.write(f[v],this)}catch(y){So(this.state,y)}if(m&&this.docView.updateSelection(!0),!p.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let y=(o<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(o).top)-a;if(y>1||y<-1){s=s+y,i.scrollTop=s/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(n&&!n.empty)for(let l of this.state.facet(E3))l(n)}get themeClasses(){return R3+" "+(this.state.facet(P3)?RY:PY)+" "+this.state.facet(R_)}updateAttrs(){let e=K8(this,pY,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Nu)?"true":"false",class:"cm-content",style:`${It.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),K8(this,f5,n);let i=this.observer.ignore(()=>{let s=w3(this.contentDOM,this.contentAttrs,n),o=w3(this.dom,this.editorAttrs,e);return s||o});return this.editorAttrs=e,this.contentAttrs=n,i}showAnnouncements(e){let n=!0;for(let i of e)for(let s of i.effects)if(s.is(St.announce)){n&&(this.announceDOM.textContent=""),n=!1;let o=this.announceDOM.appendChild(document.createElement("div"));o.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(zy);let e=this.state.facet(St.cspNonce);ld.mount(this.root,this.styleModules.concat(rRe).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key){this.measureRequests[n]=e;return}}this.measureRequests.push(e)}}plugin(e){let n=this.pluginMap.get(e);return(n===void 0||n&&n.spec!=e)&&this.pluginMap.set(e,n=this.plugins.find(i=>i.spec==e)||null),n&&n.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,n,i){return aA(this,e,I8(this,e,n,i))}moveByGroup(e,n){return aA(this,e,I8(this,e,n,i=>w3e(this,e.head,i)))}visualLineSide(e,n){let i=this.bidiSpans(e),s=this.textDirectionAt(e.from),o=i[n?i.length-1:0];return et.cursor(o.side(n,s)+e.from,o.forward(!n,s)?1:-1)}moveToLineBoundary(e,n,i=!0){return x3e(this,e,n,i)}moveVertically(e,n,i){return aA(this,e,_3e(this,e,n,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,n=0){return this.docView.posFromDOM(e,n)}posAtCoords(e,n=!0){return this.readMeasured(),xY(this,e,n)}coordsAtPos(e,n=1){this.readMeasured();let i=this.docView.coordsAt(e,n);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(e),o=this.bidiSpans(s),a=o[Fu.find(o,e-s.from,-1,n)];return U2(i,a.dir==Vn.LTR==n>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(hY)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>cRe)return iY(e.length);let n=this.textDirectionAt(e.from),i;for(let o of this.bidiCache)if(o.from==e.from&&o.dir==n&&(o.fresh||tY(o.isolates,i=E8(this,e))))return o.order;i||(i=E8(this,e));let s=r3e(e.text,n,i);return this.bidiCache.push(new FS(e.from,e.to,n,i,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||It.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Uj(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,n={}){return T_.of(new bg(typeof e=="number"?et.cursor(e):e,n.y,n.x,n.yMargin,n.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:n}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return T_.of(new bg(et.cursor(i.from),"start","start",i.top-e,n,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Pr.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Pr.define(()=>({}),{eventObservers:e})}static theme(e,n){let i=ld.newName(),s=[R_.of(i),zy.of(I3(`.${i}`,e))];return n&&n.dark&&s.push(P3.of(!0)),s}static baseTheme(e){return kp.lowest(zy.of(I3("."+R3,e,IY)))}static findFromDOM(e){var n;let i=e.querySelector(".cm-content"),s=i&&En.get(i)||En.get(e);return((n=s==null?void 0:s.rootView)===null||n===void 0?void 0:n.view)||null}}St.styleModule=zy;St.inputHandler=lY;St.clipboardInputFilter=u5;St.clipboardOutputFilter=d5;St.scrollHandler=dY;St.focusChangeEffect=cY;St.perLineTextDirection=hY;St.exceptionSink=aY;St.updateListener=E3;St.editable=Nu;St.mouseSelectionStyle=oY;St.dragMovesSelection=sY;St.clickAddsSelectionRange=rY;St.decorations=ib;St.outerDecorations=mY;St.atomicRanges=p5;St.bidiIsolatedRanges=gY;St.scrollMargins=vY;St.darkTheme=P3;St.cspNonce=Pt.define({combine:r=>r.length?r[0]:""});St.contentAttributes=f5;St.editorAttributes=pY;St.lineWrapping=St.contentAttributes.of({class:"cm-lineWrapping"});St.announce=Ri.define();const cRe=4096,Z8={};class FS{constructor(e,n,i,s,o,a){this.from=e,this.to=n,this.dir=i,this.isolates=s,this.fresh=o,this.order=a}static update(e,n){if(n.empty&&!e.some(o=>o.fresh))return e;let i=[],s=e.length?e[e.length-1].dir:Vn.LTR;for(let o=Math.max(0,e.length-10);o<e.length;o++){let a=e[o];a.dir==s&&!n.touchesRange(a.from,a.to)&&i.push(new FS(n.mapPos(a.from,1),n.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return i}}function K8(r,e,n){for(let i=r.state.facet(e),s=i.length-1;s>=0;s--){let o=i[s],a=typeof o=="function"?o(r):o;a&&x3(a,n)}return n}const hRe=It.mac?"mac":It.windows?"win":It.linux?"linux":"key";function uRe(r,e){const n=r.split(/-(?!$)/);let i=n[n.length-1];i=="Space"&&(i=" ");let s,o,a,l;for(let h=0;h<n.length-1;++h){const u=n[h];if(/^(cmd|meta|m)$/i.test(u))l=!0;else if(/^a(lt)?$/i.test(u))s=!0;else if(/^(c|ctrl|control)$/i.test(u))o=!0;else if(/^s(hift)?$/i.test(u))a=!0;else if(/^mod$/i.test(u))e=="mac"?l=!0:o=!0;else throw new Error("Unrecognized modifier name: "+u)}return s&&(i="Alt-"+i),o&&(i="Ctrl-"+i),l&&(i="Meta-"+i),a&&(i="Shift-"+i),i}function I_(r,e,n){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),n!==!1&&e.shiftKey&&(r="Shift-"+r),r}const dRe=kp.default(St.domEventHandlers({keydown(r,e){return DY(NY(e.state),r,e,"editor")}})),y5=Pt.define({enables:dRe}),J8=new WeakMap;function NY(r){let e=r.facet(y5),n=J8.get(e);return n||J8.set(e,n=mRe(e.reduce((i,s)=>i.concat(s),[]))),n}function fRe(r,e,n){return DY(NY(r.state),e,r,n)}let Du=null;const pRe=4e3;function mRe(r,e=hRe){let n=Object.create(null),i=Object.create(null),s=(a,l)=>{let h=i[a];if(h==null)i[a]=l;else if(h!=l)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},o=(a,l,h,u,f)=>{var p,m;let v=n[a]||(n[a]=Object.create(null)),y=l.split(/ (?!$)/).map(S=>uRe(S,e));for(let S=1;S<y.length;S++){let O=y.slice(0,S).join(" ");s(O,!0),v[O]||(v[O]={preventDefault:!0,stopPropagation:!1,run:[_=>{let T=Du={view:_,prefix:O,scope:a};return setTimeout(()=>{Du==T&&(Du=null)},pRe),!0}]})}let x=y.join(" ");s(x,!1);let w=v[x]||(v[x]={preventDefault:!1,stopPropagation:!1,run:((m=(p=v._any)===null||p===void 0?void 0:p.run)===null||m===void 0?void 0:m.slice())||[]});h&&w.run.push(h),u&&(w.preventDefault=!0),f&&(w.stopPropagation=!0)};for(let a of r){let l=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let u of l){let f=n[u]||(n[u]=Object.create(null));f._any||(f._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:p}=a;for(let m in f)f[m].run.push(v=>p(v,N3))}let h=a[e]||a.key;if(h)for(let u of l)o(u,h,a.run,a.preventDefault,a.stopPropagation),a.shift&&o(u,"Shift-"+h,a.shift,a.preventDefault,a.stopPropagation)}return n}let N3=null;function DY(r,e,n,i){N3=e;let s=UPe(e),o=us(s,0),a=Ca(o)==s.length&&s!=" ",l="",h=!1,u=!1,f=!1;Du&&Du.view==n&&Du.scope==i&&(l=Du.prefix+" ",OY.indexOf(e.keyCode)<0&&(u=!0,Du=null));let p=new Set,m=w=>{if(w){for(let S of w.run)if(!p.has(S)&&(p.add(S),S(n)))return w.stopPropagation&&(f=!0),!0;w.preventDefault&&(w.stopPropagation&&(f=!0),u=!0)}return!1},v=r[i],y,x;return v&&(m(v[l+I_(s,e,!a)])?h=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(It.windows&&e.ctrlKey&&e.altKey)&&(y=cd[e.keyCode])&&y!=s?(m(v[l+I_(y,e,!0)])||e.shiftKey&&(x=J1[e.keyCode])!=s&&x!=y&&m(v[l+I_(x,e,!1)]))&&(h=!0):a&&e.shiftKey&&m(v[l+I_(s,e,!0)])&&(h=!0),!h&&m(v._any)&&(h=!0)),u&&(h=!0),h&&f&&e.stopPropagation(),N3=null,h}class Jb{constructor(e,n,i,s,o){this.className=e,this.left=n,this.top=i,this.width=s,this.height=o}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,n){return n.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,n,i){if(i.empty){let s=e.coordsAtPos(i.head,i.assoc||1);if(!s)return[];let o=LY(e);return[new Jb(n,s.left-o.left,s.top-o.top,null,s.bottom-s.top)]}else return gRe(e,n,i)}}function LY(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==Vn.LTR?e.left:e.right-r.scrollDOM.clientWidth*r.scaleX)-r.scrollDOM.scrollLeft*r.scaleX,top:e.top-r.scrollDOM.scrollTop*r.scaleY}}function eF(r,e,n,i){let s=r.coordsAtPos(e,n*2);if(!s)return i;let o=r.dom.getBoundingClientRect(),a=(s.top+s.bottom)/2,l=r.posAtCoords({x:o.left+1,y:a}),h=r.posAtCoords({x:o.right-1,y:a});return l==null||h==null?i:{from:Math.max(i.from,Math.min(l,h)),to:Math.min(i.to,Math.max(l,h))}}function gRe(r,e,n){if(n.to<=r.viewport.from||n.from>=r.viewport.to)return[];let i=Math.max(n.from,r.viewport.from),s=Math.min(n.to,r.viewport.to),o=r.textDirection==Vn.LTR,a=r.contentDOM,l=a.getBoundingClientRect(),h=LY(r),u=a.querySelector(".cm-line"),f=u&&window.getComputedStyle(u),p=l.left+(f?parseInt(f.paddingLeft)+Math.min(0,parseInt(f.textIndent)):0),m=l.right-(f?parseInt(f.paddingRight):0),v=A3(r,i),y=A3(r,s),x=v.type==eo.Text?v:null,w=y.type==eo.Text?y:null;if(x&&(r.lineWrapping||v.widgetLineBreaks)&&(x=eF(r,i,1,x)),w&&(r.lineWrapping||y.widgetLineBreaks)&&(w=eF(r,s,-1,w)),x&&w&&x.from==w.from&&x.to==w.to)return O(_(n.from,n.to,x));{let A=x?_(n.from,null,x):T(v,!1),P=w?_(null,n.to,w):T(y,!0),N=[];return(x||v).to<(w||y).from-(x&&w?1:0)||v.widgetLineBreaks>1&&A.bottom+r.defaultLineHeight/2<P.top?N.push(S(p,A.bottom,m,P.top)):A.bottom<P.top&&r.elementAtHeight((A.bottom+P.top)/2).type==eo.Text&&(A.bottom=P.top=(A.bottom+P.top)/2),O(A).concat(N).concat(O(P))}function S(A,P,N,k){return new Jb(e,A-h.left,P-h.top-.01,N-A,k-P+.01)}function O({top:A,bottom:P,horizontal:N}){let k=[];for(let R=0;R<N.length;R+=2)k.push(S(N[R],A,N[R+1],P));return k}function _(A,P,N){let k=1e9,R=-1e9,E=[];function D(L,U,V,X,H){let J=r.coordsAtPos(L,L==N.to?-2:2),ee=r.coordsAtPos(V,V==N.from?2:-2);!J||!ee||(k=Math.min(J.top,ee.top,k),R=Math.max(J.bottom,ee.bottom,R),H==Vn.LTR?E.push(o&&U?p:J.left,o&&X?m:ee.right):E.push(!o&&X?p:ee.left,!o&&U?m:J.right))}let $=A??N.from,I=P??N.to;for(let L of r.visibleRanges)if(L.to>$&&L.from<I)for(let U=Math.max(L.from,$),V=Math.min(L.to,I);;){let X=r.state.doc.lineAt(U);for(let H of r.bidiSpans(X)){let J=H.from+X.from,ee=H.to+X.from;if(J>=V)break;ee>U&&D(Math.max(J,U),A==null&&J<=$,Math.min(ee,V),P==null&&ee>=I,H.dir)}if(U=X.to+1,U>=V)break}return E.length==0&&D($,A==null,I,P==null,r.textDirection),{top:k,bottom:R,horizontal:E}}function T(A,P){let N=l.top+(P?A.top:A.bottom);return{top:N,bottom:N,horizontal:[]}}}function vRe(r,e){return r.constructor==e.constructor&&r.eq(e)}class yRe{constructor(e,n){this.view=e,this.layer=n,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),n.above&&this.dom.classList.add("cm-layer-above"),n.class&&this.dom.classList.add(n.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),n.mount&&n.mount(this.dom,e)}update(e){e.startState.facet(WO)!=e.state.facet(WO)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let n=0,i=e.facet(WO);for(;n<i.length&&i[n]!=this.layer;)n++;this.dom.style.zIndex=String((this.layer.above?150:-1)-n)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:n}=this.view;(e!=this.scaleX||n!=this.scaleY)&&(this.scaleX=e,this.scaleY=n,this.dom.style.transform=`scale(${1/e}, ${1/n})`)}draw(e){if(e.length!=this.drawn.length||e.some((n,i)=>!vRe(n,this.drawn[i]))){let n=this.dom.firstChild,i=0;for(let s of e)s.update&&n&&s.constructor&&this.drawn[i].constructor&&s.update(n,this.drawn[i])?(n=n.nextSibling,i++):this.dom.insertBefore(s.draw(),n);for(;n;){let s=n.nextSibling;n.remove(),n=s}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const WO=Pt.define();function BY(r){return[Pr.define(e=>new yRe(e,r)),WO.of(r)]}const $Y=!It.ios,nb=Pt.define({combine(r){return _c(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,n)=>Math.min(e,n),drawRangeCursor:(e,n)=>e||n})}});function bRe(r={}){return[nb.of(r),xRe,wRe,_Re,uY.of(!0)]}function UY(r){return r.startState.facet(nb)!=r.state.facet(nb)}const xRe=BY({above:!0,markers(r){let{state:e}=r,n=e.facet(nb),i=[];for(let s of e.selection.ranges){let o=s==e.selection.main;if(s.empty?!o||$Y:n.drawRangeCursor){let a=o?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=s.empty?s:et.cursor(s.head,s.head>s.anchor?-1:1);for(let h of Jb.forRange(r,a,l))i.push(h)}}return i},update(r,e){r.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let n=UY(r);return n&&tF(r.state,e),r.docChanged||r.selectionSet||n},mount(r,e){tF(e.state,r)},class:"cm-cursorLayer"});function tF(r,e){e.style.animationDuration=r.facet(nb).cursorBlinkRate+"ms"}const wRe=BY({above:!1,markers(r){return r.state.selection.ranges.map(e=>e.empty?[]:Jb.forRange(r,"cm-selectionBackground",e)).reduce((e,n)=>e.concat(n))},update(r,e){return r.docChanged||r.selectionSet||r.viewportChanged||UY(r)},class:"cm-selectionLayer"}),D3={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};$Y&&(D3[".cm-line"].caretColor=D3[".cm-content"].caretColor="transparent !important");const _Re=kp.highest(St.theme(D3)),VY=Ri.define({map(r,e){return r==null?null:e.mapPos(r)}}),Gy=ws.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((n,i)=>i.is(VY)?i.value:n,r)}}),ORe=Pr.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let n=r.state.field(Gy);n==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(Gy)!=n||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:r}=this,e=r.state.field(Gy),n=e!=null&&r.coordsAtPos(e);if(!n)return null;let i=r.scrollDOM.getBoundingClientRect();return{left:n.left-i.left+r.scrollDOM.scrollLeft*r.scaleX,top:n.top-i.top+r.scrollDOM.scrollTop*r.scaleY,height:n.bottom-n.top}}drawCursor(r){if(this.cursor){let{scaleX:e,scaleY:n}=this.view;r?(this.cursor.style.left=r.left/e+"px",this.cursor.style.top=r.top/n+"px",this.cursor.style.height=r.height/n+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(Gy)!=r&&this.view.dispatch({effects:VY.of(r)})}},{eventObservers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function SRe(){return[Gy,ORe]}function iF(r,e,n,i,s){e.lastIndex=0;for(let o=r.iterRange(n,i),a=n,l;!o.next().done;a+=o.value.length)if(!o.lineBreak)for(;l=e.exec(o.value);)s(a+l.index,l)}function CRe(r,e){let n=r.visibleRanges;if(n.length==1&&n[0].from==r.viewport.from&&n[0].to==r.viewport.to)return n;let i=[];for(let{from:s,to:o}of n)s=Math.max(r.state.doc.lineAt(s).from,s-e),o=Math.min(r.state.doc.lineAt(o).to,o+e),i.length&&i[i.length-1].to>=s?i[i.length-1].to=o:i.push({from:s,to:o});return i}class TRe{constructor(e){const{regexp:n,decoration:i,decorate:s,boundary:o,maxLength:a=1e3}=e;if(!n.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=n,s)this.addMatch=(l,h,u,f)=>s(f,u,u+l[0].length,l,h);else if(typeof i=="function")this.addMatch=(l,h,u,f)=>{let p=i(l,h,u);p&&f(u,u+l[0].length,p)};else if(i)this.addMatch=(l,h,u,f)=>f(u,u+l[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=o,this.maxLength=a}createDeco(e){let n=new ad,i=n.add.bind(n);for(let{from:s,to:o}of CRe(e,this.maxLength))iF(e.state.doc,this.regexp,s,o,(a,l)=>this.addMatch(l,e,a,i));return n.finish()}updateDeco(e,n){let i=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((o,a,l,h)=>{h>e.view.viewport.from&&l<e.view.viewport.to&&(i=Math.min(l,i),s=Math.max(h,s))}),e.viewportChanged||s-i>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,n.map(e.changes),i,s):n}updateRange(e,n,i,s){for(let o of e.visibleRanges){let a=Math.max(o.from,i),l=Math.min(o.to,s);if(l>a){let h=e.state.doc.lineAt(a),u=h.to<l?e.state.doc.lineAt(l):h,f=Math.max(o.from,h.from),p=Math.min(o.to,u.to);if(this.boundary){for(;a>h.from;a--)if(this.boundary.test(h.text[a-1-h.from])){f=a;break}for(;l<u.to;l++)if(this.boundary.test(u.text[l-u.from])){p=l;break}}let m=[],v,y=(x,w,S)=>m.push(S.range(x,w));if(h==u)for(this.regexp.lastIndex=f-h.from;(v=this.regexp.exec(h.text))&&v.index<p-h.from;)this.addMatch(v,e,v.index+h.from,y);else iF(e.state.doc,this.regexp,f,p,(x,w)=>this.addMatch(w,e,x,y));n=n.update({filterFrom:f,filterTo:p,filter:(x,w)=>x<f||w>p,add:m})}}return n}}const L3=/x/.unicode!=null?"gu":"g",ERe=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,L3),MRe={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let hA=null;function ARe(){var r;if(hA==null&&typeof document<"u"&&document.body){let e=document.body.style;hA=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return hA||!1}const GO=Pt.define({combine(r){let e=_c(r,{render:null,specialChars:ERe,addSpecialChars:null});return(e.replaceTabs=!ARe())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,L3)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,L3)),e}});function kRe(r={}){return[GO.of(r),PRe()]}let nF=null;function PRe(){return nF||(nF=Pr.fromClass(class{constructor(r){this.view=r,this.decorations=ui.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(GO)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new TRe({regexp:r.specialChars,decoration:(e,n,i)=>{let{doc:s}=n.state,o=us(e[0],0);if(o==9){let a=s.lineAt(i),l=n.state.tabSize,h=g0(a.text,l,i-a.from);return ui.replace({widget:new DRe((l-h%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[o]||(this.decorationCache[o]=ui.replace({widget:new NRe(r,o)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(GO);r.startState.facet(GO)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}const RRe="•";function IRe(r){return r>=32?RRe:r==10?"␤":String.fromCharCode(9216+r)}class NRe extends wd{constructor(e,n){super(),this.options=e,this.code=n}eq(e){return e.code==this.code}toDOM(e){let n=IRe(this.code),i=e.state.phrase("Control character")+" "+(MRe[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,i,n);if(s)return s;let o=document.createElement("span");return o.textContent=n,o.title=i,o.setAttribute("aria-label",i),o.className="cm-specialChar",o}ignoreEvent(){return!1}}class DRe extends wd{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function LRe(){return $Re}const BRe=ui.line({class:"cm-activeLine"}),$Re=Pr.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,n=[];for(let i of r.state.selection.ranges){let s=r.lineBlockAt(i.head);s.from>e&&(n.push(BRe.range(s.from)),e=s.from)}return ui.set(n)}},{decorations:r=>r.decorations}),B3=2e3;function URe(r,e,n){let i=Math.min(e.line,n.line),s=Math.max(e.line,n.line),o=[];if(e.off>B3||n.off>B3||e.col<0||n.col<0){let a=Math.min(e.off,n.off),l=Math.max(e.off,n.off);for(let h=i;h<=s;h++){let u=r.doc.line(h);u.length<=l&&o.push(et.range(u.from+a,u.to+l))}}else{let a=Math.min(e.col,n.col),l=Math.max(e.col,n.col);for(let h=i;h<=s;h++){let u=r.doc.line(h),f=f3(u.text,a,r.tabSize,!0);if(f<0)o.push(et.cursor(u.to));else{let p=f3(u.text,l,r.tabSize);o.push(et.range(u.from+f,u.from+p))}}}return o}function VRe(r,e){let n=r.coordsAtPos(r.viewport.from);return n?Math.round(Math.abs((n.left-e)/r.defaultCharacterWidth)):-1}function rF(r,e){let n=r.posAtCoords({x:e.clientX,y:e.clientY},!1),i=r.state.doc.lineAt(n),s=n-i.from,o=s>B3?-1:s==i.length?VRe(r,e.clientX):g0(i.text,r.state.tabSize,n-i.from);return{line:i.number,col:o,off:s}}function FRe(r,e){let n=rF(r,e),i=r.state.selection;return n?{update(s){if(s.docChanged){let o=s.changes.mapPos(s.startState.doc.line(n.line).from),a=s.state.doc.lineAt(o);n={line:a.number,col:n.col,off:Math.min(n.off,a.length)},i=i.map(s.changes)}},get(s,o,a){let l=rF(r,s);if(!l)return i;let h=URe(r.state,n,l);return h.length?a?et.create(h.concat(i.ranges)):et.create(h):i}}:null}function zRe(r){let e=n=>n.altKey&&n.button==0;return St.mouseSelectionStyle.of((n,i)=>e(i)?FRe(n,i):null)}const XRe={Alt:[18,r=>!!r.altKey],Control:[17,r=>!!r.ctrlKey],Shift:[16,r=>!!r.shiftKey],Meta:[91,r=>!!r.metaKey]},WRe={style:"cursor: crosshair"};function GRe(r={}){let[e,n]=XRe[r.key||"Alt"],i=Pr.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==e||n(s))},keyup(s){(s.keyCode==e||!n(s))&&this.set(!1)},mousemove(s){this.set(n(s))}}});return[i,St.contentAttributes.of(s=>{var o;return!((o=s.plugin(i))===null||o===void 0)&&o.isDown?WRe:null})]}const gy="-10000px";class FY{constructor(e,n,i,s){this.facet=n,this.createTooltipView=i,this.removeTooltipView=s,this.input=e.state.facet(n),this.tooltips=this.input.filter(a=>a);let o=null;this.tooltipViews=this.tooltips.map(a=>o=i(a,o))}update(e,n){var i;let s=e.state.facet(this.facet),o=s.filter(h=>h);if(s===this.input){for(let h of this.tooltipViews)h.update&&h.update(e);return!1}let a=[],l=n?[]:null;for(let h=0;h<o.length;h++){let u=o[h],f=-1;if(u){for(let p=0;p<this.tooltips.length;p++){let m=this.tooltips[p];m&&m.create==u.create&&(f=p)}if(f<0)a[h]=this.createTooltipView(u,h?a[h-1]:null),l&&(l[h]=!!u.above);else{let p=a[h]=this.tooltipViews[f];l&&(l[h]=n[f]),p.update&&p.update(e)}}}for(let h of this.tooltipViews)a.indexOf(h)<0&&(this.removeTooltipView(h),(i=h.destroy)===null||i===void 0||i.call(h));return n&&(l.forEach((h,u)=>n[u]=h),n.length=l.length),this.input=s,this.tooltips=o,this.tooltipViews=a,!0}}function HRe(r){let{win:e}=r;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const uA=Pt.define({combine:r=>{var e,n,i;return{position:It.ios?"absolute":((e=r.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((n=r.find(s=>s.parent))===null||n===void 0?void 0:n.parent)||null,tooltipSpace:((i=r.find(s=>s.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||HRe}}}),sF=new WeakMap,b5=Pr.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(uA);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new FY(r,x5,(n,i)=>this.createTooltip(n,i),n=>{this.resizeObserver&&this.resizeObserver.unobserve(n.dom),n.dom.remove()}),this.above=this.manager.tooltips.map(n=>!!n.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(n=>{Date.now()>this.lastTransaction-50&&n.length>0&&n[n.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r,this.above);e&&this.observeIntersection();let n=e||r.geometryChanged,i=r.state.facet(uA);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(r,e){let n=r.create(this.view),i=e?e.dom:null;if(n.dom.classList.add("cm-tooltip"),r.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",n.dom.appendChild(s)}return n.dom.style.position=this.position,n.dom.style.top=gy,n.dom.style.left="0px",this.container.insertBefore(n.dom,i),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var r,e,n;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(r=i.destroy)===null||r===void 0||r.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(n=this.intersectionObserver)===null||n===void 0||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=this.view.dom.getBoundingClientRect(),e=1,n=1,i=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(It.gecko)i=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==gy&&s.style.left=="0px"){let o=s.getBoundingClientRect();i=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(i||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(e=s.width/this.parent.offsetWidth,n=s.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:n}=this.view.viewState);return{editor:r,parent:this.parent?this.container.getBoundingClientRect():r,pos:this.manager.tooltips.map((s,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(uA).tooltipSpace(this.view),scaleX:e,scaleY:n,makeAbsolute:i}}writeMeasure(r){var e;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{editor:n,space:i,scaleX:s,scaleY:o}=r,a=[];for(let l=0;l<this.manager.tooltips.length;l++){let h=this.manager.tooltips[l],u=this.manager.tooltipViews[l],{dom:f}=u,p=r.pos[l],m=r.size[l];if(!p||p.bottom<=Math.max(n.top,i.top)||p.top>=Math.min(n.bottom,i.bottom)||p.right<Math.max(n.left,i.left)-.1||p.left>Math.min(n.right,i.right)+.1){f.style.top=gy;continue}let v=h.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,y=v?7:0,x=m.right-m.left,w=(e=sF.get(u))!==null&&e!==void 0?e:m.bottom-m.top,S=u.offset||jRe,O=this.view.textDirection==Vn.LTR,_=m.width>i.right-i.left?O?i.left:i.right-m.width:O?Math.max(i.left,Math.min(p.left-(v?14:0)+S.x,i.right-x)):Math.min(Math.max(i.left,p.left-x+(v?14:0)-S.x),i.right-x),T=this.above[l];!h.strictSide&&(T?p.top-(m.bottom-m.top)-S.y<i.top:p.bottom+(m.bottom-m.top)+S.y>i.bottom)&&T==i.bottom-p.bottom>p.top-i.top&&(T=this.above[l]=!T);let A=(T?p.top-i.top:i.bottom-p.bottom)-y;if(A<w&&u.resize!==!1){if(A<this.view.defaultLineHeight){f.style.top=gy;continue}sF.set(u,w),f.style.height=(w=A)/o+"px"}else f.style.height&&(f.style.height="");let P=T?p.top-w-y-S.y:p.bottom+y+S.y,N=_+x;if(u.overlap!==!0)for(let k of a)k.left<N&&k.right>_&&k.top<P+w&&k.bottom>P&&(P=T?k.top-w-2-y:k.bottom+y+2);if(this.position=="absolute"?(f.style.top=(P-r.parent.top)/o+"px",f.style.left=(_-r.parent.left)/s+"px"):(f.style.top=P/o+"px",f.style.left=_/s+"px"),v){let k=p.left+(O?S.x:-S.x)-(_+14-7);v.style.left=k/s+"px"}u.overlap!==!0&&a.push({left:_,top:P,right:N,bottom:P+w}),f.classList.toggle("cm-tooltip-above",T),f.classList.toggle("cm-tooltip-below",!T),u.positioned&&u.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=gy}},{eventObservers:{scroll(){this.maybeMeasure()}}}),QRe=St.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),jRe={x:0,y:0},x5=Pt.define({enables:[b5,QRe]}),zS=Pt.define({combine:r=>r.reduce((e,n)=>e.concat(n),[])});class z2{static create(e){return new z2(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new FY(e,zS,(n,i)=>this.createHostedView(n,i),n=>n.dom.remove())}createHostedView(e,n){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,n?n.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let n of this.manager.tooltipViews)n.mount&&n.mount(e);this.mounted=!0}positioned(e){for(let n of this.manager.tooltipViews)n.positioned&&n.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let n of this.manager.tooltipViews)(e=n.destroy)===null||e===void 0||e.call(n)}passProp(e){let n;for(let i of this.manager.tooltipViews){let s=i[e];if(s!==void 0){if(n===void 0)n=s;else if(n!==s)return}}return n}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const YRe=x5.compute([zS],r=>{let e=r.facet(zS);return e.length===0?null:{pos:Math.min(...e.map(n=>n.pos)),end:Math.max(...e.map(n=>{var i;return(i=n.end)!==null&&i!==void 0?i:n.pos})),create:z2.create,above:e[0].above,arrow:e.some(n=>n.arrow)}});class qRe{constructor(e,n,i,s,o){this.view=e,this.source=n,this.field=i,this.setHover=s,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:n}=this,i=e.docView.nearest(n.target);if(!i)return;let s,o=1;if(i instanceof Vu)s=i.posAtStart;else{if(s=e.posAtCoords(n),s==null)return;let l=e.coordsAtPos(s);if(!l||n.y<l.top||n.y>l.bottom||n.x<l.left-e.defaultCharacterWidth||n.x>l.right+e.defaultCharacterWidth)return;let h=e.bidiSpans(e.state.doc.lineAt(s)).find(f=>f.from<=s&&f.to>=s),u=h&&h.dir==Vn.RTL?-1:1;o=n.x<l.left?-u:u}let a=this.source(e,s,o);if(a!=null&&a.then){let l=this.pending={pos:s};a.then(h=>{this.pending==l&&(this.pending=null,h&&!(Array.isArray(h)&&!h.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(h)?h:[h])}))},h=>So(e.state,h,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(b5),n=e?e.manager.tooltips.findIndex(i=>i.create==z2.create):-1;return n>-1?e.manager.tooltipViews[n]:null}mousemove(e){var n,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:o}=this;if(s.length&&o&&!ZRe(o.dom,e)||this.pending){let{pos:a}=s[0]||this.pending,l=(i=(n=s[0])===null||n===void 0?void 0:n.end)!==null&&i!==void 0?i:a;(a==l?this.view.posAtCoords(this.lastMove)!=a:!KRe(this.view,a,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:n}=this;if(n.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let n=i=>{e.removeEventListener("mouseleave",n),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",n)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const N_=4;function ZRe(r,e){let{left:n,right:i,top:s,bottom:o}=r.getBoundingClientRect(),a;if(a=r.querySelector(".cm-tooltip-arrow")){let l=a.getBoundingClientRect();s=Math.min(l.top,s),o=Math.max(l.bottom,o)}return e.clientX>=n-N_&&e.clientX<=i+N_&&e.clientY>=s-N_&&e.clientY<=o+N_}function KRe(r,e,n,i,s,o){let a=r.scrollDOM.getBoundingClientRect(),l=r.documentTop+r.documentPadding.top+r.contentHeight;if(a.left>i||a.right<i||a.top>s||Math.min(a.bottom,l)<s)return!1;let h=r.posAtCoords({x:i,y:s},!1);return h>=e&&h<=n}function JRe(r,e={}){let n=Ri.define(),i=ws.define({create(){return[]},update(s,o){if(s.length&&(e.hideOnChange&&(o.docChanged||o.selection)?s=[]:e.hideOn&&(s=s.filter(a=>!e.hideOn(o,a))),o.docChanged)){let a=[];for(let l of s){let h=o.changes.mapPos(l.pos,-1,Ys.TrackDel);if(h!=null){let u=Object.assign(Object.create(null),l);u.pos=h,u.end!=null&&(u.end=o.changes.mapPos(u.end)),a.push(u)}}s=a}for(let a of o.effects)a.is(n)&&(s=a.value),a.is(eIe)&&(s=[]);return s},provide:s=>zS.from(s)});return{active:i,extension:[i,Pr.define(s=>new qRe(s,r,i,n,e.hoverTime||300)),YRe]}}function zY(r,e){let n=r.plugin(b5);if(!n)return null;let i=n.manager.tooltips.indexOf(e);return i<0?null:n.manager.tooltipViews[i]}const eIe=Ri.define(),oF=Pt.define({combine(r){let e,n;for(let i of r)e=e||i.topContainer,n=n||i.bottomContainer;return{topContainer:e,bottomContainer:n}}});function rb(r,e){let n=r.plugin(XY),i=n?n.specs.indexOf(e):-1;return i>-1?n.panels[i]:null}const XY=Pr.fromClass(class{constructor(r){this.input=r.state.facet(sb),this.specs=this.input.filter(n=>n),this.panels=this.specs.map(n=>n(r));let e=r.state.facet(oF);this.top=new D_(r,!0,e.topContainer),this.bottom=new D_(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(n=>n.top)),this.bottom.sync(this.panels.filter(n=>!n.top));for(let n of this.panels)n.dom.classList.add("cm-panel"),n.mount&&n.mount()}update(r){let e=r.state.facet(oF);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new D_(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new D_(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=r.state.facet(sb);if(n!=this.input){let i=n.filter(h=>h),s=[],o=[],a=[],l=[];for(let h of i){let u=this.specs.indexOf(h),f;u<0?(f=h(r.view),l.push(f)):(f=this.panels[u],f.update&&f.update(r)),s.push(f),(f.top?o:a).push(f)}this.specs=i,this.panels=s,this.top.sync(o),this.bottom.sync(a);for(let h of l)h.dom.classList.add("cm-panel"),h.mount&&h.mount()}else for(let i of this.panels)i.update&&i.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>St.scrollMargins.of(e=>{let n=e.plugin(r);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class D_{constructor(e,n,i){this.view=e,this.top=n,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let n of this.panels)n.destroy&&e.indexOf(n)<0&&n.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let n=this.container||this.view.dom;n.insertBefore(this.dom,this.top?n.firstChild:null)}let e=this.dom.firstChild;for(let n of this.panels)if(n.dom.parentNode==this.dom){for(;e!=n.dom;)e=aF(e);e=e.nextSibling}else this.dom.insertBefore(n.dom,e);for(;e;)e=aF(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function aF(r){let e=r.nextSibling;return r.remove(),e}const sb=Pt.define({enables:XY});class Eh extends cp{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Eh.prototype.elementClass="";Eh.prototype.toDOM=void 0;Eh.prototype.mapMode=Ys.TrackBefore;Eh.prototype.startSide=Eh.prototype.endSide=-1;Eh.prototype.point=!0;const HO=Pt.define(),tIe=Pt.define(),iIe={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>sn.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},p1=Pt.define();function nIe(r){return[WY(),p1.of(Object.assign(Object.assign({},iIe),r))]}const lF=Pt.define({combine:r=>r.some(e=>e)});function WY(r){return[rIe]}const rIe=Pr.fromClass(class{constructor(r){this.view=r,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(p1).map(e=>new hF(r,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!r.state.facet(lF),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}update(r){if(this.updateGutters(r)){let e=this.prevViewport,n=r.view.viewport,i=Math.min(e.to,n.to)-Math.max(e.from,n.from);this.syncGutters(i<(n.to-n.from)*.8)}r.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(lF)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&this.dom.remove();let n=sn.iter(this.view.state.facet(HO),this.view.viewport.from),i=[],s=this.gutters.map(o=>new sIe(o,this.view.viewport,-this.view.documentPadding.top));for(let o of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(o.type)){let a=!0;for(let l of o.type)if(l.type==eo.Text&&a){$3(n,i,l.from);for(let h of s)h.line(this.view,l,i);a=!1}else if(l.widget)for(let h of s)h.widget(this.view,l)}else if(o.type==eo.Text){$3(n,i,o.from);for(let a of s)a.line(this.view,o,i)}else if(o.widget)for(let a of s)a.widget(this.view,o);for(let o of s)o.finish();r&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(r){let e=r.startState.facet(p1),n=r.state.facet(p1),i=r.docChanged||r.heightChanged||r.viewportChanged||!sn.eq(r.startState.facet(HO),r.state.facet(HO),r.view.viewport.from,r.view.viewport.to);if(e==n)for(let s of this.gutters)s.update(r)&&(i=!0);else{i=!0;let s=[];for(let o of n){let a=e.indexOf(o);a<0?s.push(new hF(this.view,o)):(this.gutters[a].update(r),s.push(this.gutters[a]))}for(let o of this.gutters)o.dom.remove(),s.indexOf(o)<0&&o.destroy();for(let o of s)this.dom.appendChild(o.dom);this.gutters=s}return i}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove()}},{provide:r=>St.scrollMargins.of(e=>{let n=e.plugin(r);return!n||n.gutters.length==0||!n.fixed?null:e.textDirection==Vn.LTR?{left:n.dom.offsetWidth*e.scaleX}:{right:n.dom.offsetWidth*e.scaleX}})});function cF(r){return Array.isArray(r)?r:[r]}function $3(r,e,n){for(;r.value&&r.from<=n;)r.from==n&&e.push(r.value),r.next()}class sIe{constructor(e,n,i){this.gutter=e,this.height=i,this.i=0,this.cursor=sn.iter(e.markers,n.from)}addElement(e,n,i){let{gutter:s}=this,o=(n.top-this.height)/e.scaleY,a=n.height/e.scaleY;if(this.i==s.elements.length){let l=new GY(e,a,o,i);s.elements.push(l),s.dom.appendChild(l.dom)}else s.elements[this.i].update(e,a,o,i);this.height=n.bottom,this.i++}line(e,n,i){let s=[];$3(this.cursor,s,n.from),i.length&&(s=s.concat(i));let o=this.gutter.config.lineMarker(e,n,s);o&&s.unshift(o);let a=this.gutter;s.length==0&&!a.config.renderEmptyElements||this.addElement(e,n,s)}widget(e,n){let i=this.gutter.config.widgetMarker(e,n.widget,n),s=i?[i]:null;for(let o of e.state.facet(tIe)){let a=o(e,n.widget,n);a&&(s||(s=[])).push(a)}s&&this.addElement(e,n,s)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let n=e.elements.pop();e.dom.removeChild(n.dom),n.destroy()}}}class hF{constructor(e,n){this.view=e,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in n.domEventHandlers)this.dom.addEventListener(i,s=>{let o=s.target,a;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let h=o.getBoundingClientRect();a=(h.top+h.bottom)/2}else a=s.clientY;let l=e.lineBlockAtHeight(a-e.documentTop);n.domEventHandlers[i](e,l,s)&&s.preventDefault()});this.markers=cF(n.markers(e)),n.initialSpacer&&(this.spacer=new GY(e,0,0,[n.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let n=this.markers;if(this.markers=cF(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let i=e.view.viewport;return!sn.eq(this.markers,n,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class GY{constructor(e,n,i,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,n,i,s)}update(e,n,i,s){this.height!=n&&(this.height=n,this.dom.style.height=n+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),oIe(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,n){let i="cm-gutterElement",s=this.dom.firstChild;for(let o=0,a=0;;){let l=a,h=o<n.length?n[o++]:null,u=!1;if(h){let f=h.elementClass;f&&(i+=" "+f);for(let p=a;p<this.markers.length;p++)if(this.markers[p].compare(h)){l=p,u=!0;break}}else l=this.markers.length;for(;a<l;){let f=this.markers[a++];if(f.toDOM){f.destroy(s);let p=s.nextSibling;s.remove(),s=p}}if(!h)break;h.toDOM&&(u?s=s.nextSibling:this.dom.insertBefore(h.toDOM(e),s)),u&&a++}this.dom.className=i,this.markers=n}destroy(){this.setMarkers(null,[])}}function oIe(r,e){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!r[n].compare(e[n]))return!1;return!0}const aIe=Pt.define(),lIe=Pt.define(),qm=Pt.define({combine(r){return _c(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,n){let i=Object.assign({},e);for(let s in n){let o=i[s],a=n[s];i[s]=o?(l,h,u)=>o(l,h,u)||a(l,h,u):a}return i}})}});class dA extends Eh{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function fA(r,e){return r.state.facet(qm).formatNumber(e,r.state)}const cIe=p1.compute([qm],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(aIe)},lineMarker(e,n,i){return i.some(s=>s.toDOM)?null:new dA(fA(e,e.state.doc.lineAt(n.from).number))},widgetMarker:(e,n,i)=>{for(let s of e.state.facet(lIe)){let o=s(e,n,i);if(o)return o}return null},lineMarkerChange:e=>e.startState.facet(qm)!=e.state.facet(qm),initialSpacer(e){return new dA(fA(e,uF(e.state.doc.lines)))},updateSpacer(e,n){let i=fA(n.view,uF(n.view.state.doc.lines));return i==e.number?e:new dA(i)},domEventHandlers:r.facet(qm).domEventHandlers}));function hIe(r={}){return[qm.of(r),WY(),cIe]}function uF(r){let e=9;for(;e<r;)e=e*10+9;return e}const uIe=new class extends Eh{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},dIe=HO.compute(["selection"],r=>{let e=[],n=-1;for(let i of r.selection.ranges){let s=r.doc.lineAt(i.head).from;s>n&&(n=s,e.push(uIe.range(s)))}return sn.of(e)});function fIe(){return dIe}const HY=1024;let pIe=0;class pA{constructor(e,n){this.from=e,this.to=n}}class Bi{constructor(e={}){this.id=pIe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=ko.match(e)),n=>{let i=e(n);return i===void 0?null:[this,i]}}}Bi.closedBy=new Bi({deserialize:r=>r.split(" ")});Bi.openedBy=new Bi({deserialize:r=>r.split(" ")});Bi.group=new Bi({deserialize:r=>r.split(" ")});Bi.isolate=new Bi({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});Bi.contextHash=new Bi({perNode:!0});Bi.lookAhead=new Bi({perNode:!0});Bi.mounted=new Bi({perNode:!0});class XS{constructor(e,n,i){this.tree=e,this.overlay=n,this.parser=i}static get(e){return e&&e.props&&e.props[Bi.mounted.id]}}const mIe=Object.create(null);class ko{constructor(e,n,i,s=0){this.name=e,this.props=n,this.id=i,this.flags=s}static define(e){let n=e.props&&e.props.length?Object.create(null):mIe,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new ko(e.name||"",n,e.id,i);if(e.props){for(let o of e.props)if(Array.isArray(o)||(o=o(s)),o){if(o[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[o[0].id]=o[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(Bi.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let i in e)for(let s of i.split(" "))n[s]=e[i];return i=>{for(let s=i.prop(Bi.group),o=-1;o<(s?s.length:0);o++){let a=n[o<0?i.name:s[o]];if(a)return a}}}}ko.none=new ko("",Object.create(null),0,8);class w5{constructor(e){this.types=e;for(let n=0;n<e.length;n++)if(e[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let n=[];for(let i of this.types){let s=null;for(let o of e){let a=o(i);a&&(s||(s=Object.assign({},i.props)),s[a[0].id]=a[1])}n.push(s?new ko(i.name,s,i.id,i.flags):i)}return new w5(n)}}const L_=new WeakMap,dF=new WeakMap;var es;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(es||(es={}));class Mr{constructor(e,n,i,s,o){if(this.type=e,this.children=n,this.positions=i,this.length=s,this.props=null,o&&o.length){this.props=Object.create(null);for(let[a,l]of o)this.props[typeof a=="number"?a:a.id]=l}}toString(){let e=XS.get(this);if(e&&!e.overlay)return e.tree.toString();let n="";for(let i of this.children){let s=i.toString();s&&(n&&(n+=","),n+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new V3(this.topNode,e)}cursorAt(e,n=0,i=0){let s=L_.get(this)||this.topNode,o=new V3(s);return o.moveTo(e,n),L_.set(this,o._tree),o}get topNode(){return new Da(this,0,0,null)}resolve(e,n=0){let i=ob(L_.get(this)||this.topNode,e,n,!1);return L_.set(this,i),i}resolveInner(e,n=0){let i=ob(dF.get(this)||this.topNode,e,n,!0);return dF.set(this,i),i}resolveStack(e,n=0){return yIe(this,e,n)}iterate(e){let{enter:n,leave:i,from:s=0,to:o=this.length}=e,a=e.mode||0,l=(a&es.IncludeAnonymous)>0;for(let h=this.cursor(a|es.IncludeAnonymous);;){let u=!1;if(h.from<=o&&h.to>=s&&(!l&&h.type.isAnonymous||n(h)!==!1)){if(h.firstChild())continue;u=!0}for(;u&&i&&(l||!h.type.isAnonymous)&&i(h),!h.nextSibling();){if(!h.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:S5(ko.none,this.children,this.positions,0,this.children.length,0,this.length,(n,i,s)=>new Mr(this.type,n,i,s,this.propValues),e.makeTree||((n,i,s)=>new Mr(ko.none,n,i,s)))}static build(e){return bIe(e)}}Mr.empty=new Mr(ko.none,[],[],0);class _5{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new _5(this.buffer,this.index)}}class ud{constructor(e,n,i){this.buffer=e,this.length=n,this.set=i}get type(){return ko.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],i=this.buffer[e+3],s=this.set.types[n],o=s.name;if(/\W/.test(o)&&!s.isError&&(o=JSON.stringify(o)),e+=4,i==e)return o;let a=[];for(;e<i;)a.push(this.childString(e)),e=this.buffer[e+3];return o+"("+a.join(",")+")"}findChild(e,n,i,s,o){let{buffer:a}=this,l=-1;for(let h=e;h!=n&&!(QY(o,s,a[h+1],a[h+2])&&(l=h,i>0));h=a[h+3]);return l}slice(e,n,i){let s=this.buffer,o=new Uint16Array(n-e),a=0;for(let l=e,h=0;l<n;){o[h++]=s[l++],o[h++]=s[l++]-i;let u=o[h++]=s[l++]-i;o[h++]=s[l++]-e,a=Math.max(a,u)}return new ud(o,a,this.set)}}function QY(r,e,n,i){switch(r){case-2:return n<e;case-1:return i>=e&&n<e;case 0:return n<e&&i>e;case 1:return n<=e&&i>e;case 2:return i>e;case 4:return!0}}function ob(r,e,n,i){for(var s;r.from==r.to||(n<1?r.from>=e:r.from>e)||(n>-1?r.to<=e:r.to<e);){let a=!i&&r instanceof Da&&r.index<0?null:r.parent;if(!a)return r;r=a}let o=i?0:es.IgnoreOverlays;if(i)for(let a=r,l=a.parent;l;a=l,l=a.parent)a instanceof Da&&a.index<0&&((s=l.enter(e,n,o))===null||s===void 0?void 0:s.from)!=a.from&&(r=l);for(;;){let a=r.enter(e,n,o);if(!a)return r;r=a}}class jY{cursor(e=0){return new V3(this,e)}getChild(e,n=null,i=null){let s=fF(this,e,n,i);return s.length?s[0]:null}getChildren(e,n=null,i=null){return fF(this,e,n,i)}resolve(e,n=0){return ob(this,e,n,!1)}resolveInner(e,n=0){return ob(this,e,n,!0)}matchContext(e){return U3(this,e)}enterUnfinishedNodesBefore(e){let n=this.childBefore(e),i=this;for(;n;){let s=n.lastChild;if(!s||s.to!=n.to)break;s.type.isError&&s.from==s.to?(i=n,n=s.prevSibling):n=s}return i}get node(){return this}get next(){return this.parent}}class Da extends jY{constructor(e,n,i,s){super(),this._tree=e,this.from=n,this.index=i,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,i,s,o=0){for(let a=this;;){for(let{children:l,positions:h}=a._tree,u=n>0?l.length:-1;e!=u;e+=n){let f=l[e],p=h[e]+a.from;if(QY(s,i,p,p+f.length)){if(f instanceof ud){if(o&es.ExcludeBuffers)continue;let m=f.findChild(0,f.buffer.length,n,i-p,s);if(m>-1)return new zu(new gIe(a,f,e,p),null,m)}else if(o&es.IncludeAnonymous||!f.type.isAnonymous||O5(f)){let m;if(!(o&es.IgnoreMounts)&&(m=XS.get(f))&&!m.overlay)return new Da(m.tree,p,e,a);let v=new Da(f,p,e,a);return o&es.IncludeAnonymous||!v.type.isAnonymous?v:v.nextChild(n<0?f.children.length-1:0,n,i,s)}}}if(o&es.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+n:e=n<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,i=0){let s;if(!(i&es.IgnoreOverlays)&&(s=XS.get(this._tree))&&s.overlay){let o=e-this.from;for(let{from:a,to:l}of s.overlay)if((n>0?a<=o:a<o)&&(n<0?l>=o:l>o))return new Da(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function fF(r,e,n,i){let s=r.cursor(),o=[];if(!s.firstChild())return o;if(n!=null){for(let a=!1;!a;)if(a=s.type.is(n),!s.nextSibling())return o}for(;;){if(i!=null&&s.type.is(i))return o;if(s.type.is(e)&&o.push(s.node),!s.nextSibling())return i==null?o:[]}}function U3(r,e,n=e.length-1){for(let i=r.parent;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[n]&&e[n]!=i.name)return!1;n--}}return!0}class gIe{constructor(e,n,i,s){this.parent=e,this.buffer=n,this.index=i,this.start=s}}class zu extends jY{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,i){super(),this.context=e,this._parent=n,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,n,i){let{buffer:s}=this.context,o=s.findChild(this.index+4,s.buffer[this.index+3],e,n-this.context.start,i);return o<0?null:new zu(this.context,this,o)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,i=0){if(i&es.ExcludeBuffers)return null;let{buffer:s}=this.context,o=s.findChild(this.index+4,s.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return o<0?null:new zu(this.context,this,o)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new zu(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new zu(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],n=[],{buffer:i}=this.context,s=this.index+4,o=i.buffer[this.index+3];if(o>s){let a=i.buffer[this.index+1];e.push(i.slice(s,o,a)),n.push(0)}return new Mr(this.type,e,n,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function YY(r){if(!r.length)return null;let e=0,n=r[0];for(let o=1;o<r.length;o++){let a=r[o];(a.from>n.from||a.to<n.to)&&(n=a,e=o)}let i=n instanceof Da&&n.index<0?null:n.parent,s=r.slice();return i?s[e]=i:s.splice(e,1),new vIe(s,n)}class vIe{constructor(e,n){this.heads=e,this.node=n}get next(){return YY(this.heads)}}function yIe(r,e,n){let i=r.resolveInner(e,n),s=null;for(let o=i instanceof Da?i:i.context.parent;o;o=o.parent)if(o.index<0){let a=o.parent;(s||(s=[i])).push(a.resolve(e,n)),o=a}else{let a=XS.get(o.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let l=new Da(a.tree,a.overlay[0].from+o.from,-1,o);(s||(s=[i])).push(ob(l,e,n,!1))}}return s?YY(s):i}class V3{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Da)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:i,buffer:s}=this.buffer;return this.type=n||s.set.types[s.buffer[e]],this.from=i+s.buffer[e+1],this.to=i+s.buffer[e+2],!0}yield(e){return e?e instanceof Da?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,i,this.mode));let{buffer:s}=this.buffer,o=s.findChild(this.index+4,s.buffer[this.index+3],e,n-this.buffer.start,i);return o<0?!1:(this.stack.push(this.index),this.yieldBuf(o))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,i=this.mode){return this.buffer?i&es.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&es.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&es.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,i=this.stack.length-1;if(e<0){let s=i<0?0:this.stack[i]+4;if(this.index!=s)return this.yieldBuf(n.findChild(s,this.index,-1,0,4))}else{let s=n.buffer[this.index+3];if(s<(i<0?n.buffer.length:n.buffer[this.stack[i]+3]))return this.yieldBuf(s)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,i,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let o=0;o<this.index;o++)if(s.buffer.buffer[o+3]<this.index)return!1;({index:n,parent:i}=s)}else({index:n,_parent:i}=this._tree);for(;i;{index:n,_parent:i}=i)if(n>-1)for(let o=n+e,a=e<0?-1:i._tree.children.length;o!=a;o+=e){let l=i._tree.children[o];if(this.mode&es.IncludeAnonymous||l instanceof ud||!l.type.isAnonymous||O5(l))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,i=0;if(e&&e.context==this.buffer)e:for(let s=this.index,o=this.stack.length;o>=0;){for(let a=e;a;a=a._parent)if(a.index==s){if(s==this.index)return a;n=a,i=o+1;break e}s=this.stack[--o]}for(let s=i;s<this.stack.length;s++)n=new zu(this.buffer,n,this.stack[s]);return this.bufferNode=new zu(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let i=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(s=!0)}for(;s&&n&&n(this),s=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,s=!0}}}matchContext(e){if(!this.buffer)return U3(this.node,e);let{buffer:n}=this.buffer,{types:i}=n.set;for(let s=e.length-1,o=this.stack.length-1;s>=0;o--){if(o<0)return U3(this.node,e,s);let a=i[n.buffer[this.stack[o]]];if(!a.isAnonymous){if(e[s]&&e[s]!=a.name)return!1;s--}}return!0}}function O5(r){return r.children.some(e=>e instanceof ud||!e.type.isAnonymous||O5(e))}function bIe(r){var e;let{buffer:n,nodeSet:i,maxBufferLength:s=HY,reused:o=[],minRepeatType:a=i.types.length}=r,l=Array.isArray(n)?new _5(n,n.length):n,h=i.types,u=0,f=0;function p(A,P,N,k,R,E){let{id:D,start:$,end:I,size:L}=l,U=f;for(;L<0;)if(l.next(),L==-1){let ee=o[D];N.push(ee),k.push($-A);return}else if(L==-3){u=D;return}else if(L==-4){f=D;return}else throw new RangeError(`Unrecognized record size: ${L}`);let V=h[D],X,H,J=$-A;if(I-$<=s&&(H=w(l.pos-P,R))){let ee=new Uint16Array(H.size-H.skip),ne=l.pos-H.size,ge=ee.length;for(;l.pos>ne;)ge=S(H.start,ee,ge);X=new ud(ee,I-H.start,i),J=H.start-A}else{let ee=l.pos-L;l.next();let ne=[],ge=[],ye=D>=a?D:-1,ce=0,we=I;for(;l.pos>ee;)ye>=0&&l.id==ye&&l.size>=0?(l.end<=we-s&&(y(ne,ge,$,ce,l.end,we,ye,U),ce=ne.length,we=l.end),l.next()):E>2500?m($,ee,ne,ge):p($,ee,ne,ge,ye,E+1);if(ye>=0&&ce>0&&ce<ne.length&&y(ne,ge,$,ce,$,we,ye,U),ne.reverse(),ge.reverse(),ye>-1&&ce>0){let be=v(V);X=S5(V,ne,ge,0,ne.length,0,I-$,be,be)}else X=x(V,ne,ge,I-$,U-I)}N.push(X),k.push(J)}function m(A,P,N,k){let R=[],E=0,D=-1;for(;l.pos>P;){let{id:$,start:I,end:L,size:U}=l;if(U>4)l.next();else{if(D>-1&&I<D)break;D<0&&(D=L-s),R.push($,I,L),E++,l.next()}}if(E){let $=new Uint16Array(E*4),I=R[R.length-2];for(let L=R.length-3,U=0;L>=0;L-=3)$[U++]=R[L],$[U++]=R[L+1]-I,$[U++]=R[L+2]-I,$[U++]=U;N.push(new ud($,R[2]-I,i)),k.push(I-A)}}function v(A){return(P,N,k)=>{let R=0,E=P.length-1,D,$;if(E>=0&&(D=P[E])instanceof Mr){if(!E&&D.type==A&&D.length==k)return D;($=D.prop(Bi.lookAhead))&&(R=N[E]+D.length+$)}return x(A,P,N,k,R)}}function y(A,P,N,k,R,E,D,$){let I=[],L=[];for(;A.length>k;)I.push(A.pop()),L.push(P.pop()+N-R);A.push(x(i.types[D],I,L,E-R,$-E)),P.push(R-N)}function x(A,P,N,k,R=0,E){if(u){let D=[Bi.contextHash,u];E=E?[D].concat(E):[D]}if(R>25){let D=[Bi.lookAhead,R];E=E?[D].concat(E):[D]}return new Mr(A,P,N,k,E)}function w(A,P){let N=l.fork(),k=0,R=0,E=0,D=N.end-s,$={size:0,start:0,skip:0};e:for(let I=N.pos-A;N.pos>I;){let L=N.size;if(N.id==P&&L>=0){$.size=k,$.start=R,$.skip=E,E+=4,k+=4,N.next();continue}let U=N.pos-L;if(L<0||U<I||N.start<D)break;let V=N.id>=a?4:0,X=N.start;for(N.next();N.pos>U;){if(N.size<0)if(N.size==-3)V+=4;else break e;else N.id>=a&&(V+=4);N.next()}R=X,k+=L,E+=V}return(P<0||k==A)&&($.size=k,$.start=R,$.skip=E),$.size>4?$:void 0}function S(A,P,N){let{id:k,start:R,end:E,size:D}=l;if(l.next(),D>=0&&k<a){let $=N;if(D>4){let I=l.pos-(D-4);for(;l.pos>I;)N=S(A,P,N)}P[--N]=$,P[--N]=E-A,P[--N]=R-A,P[--N]=k}else D==-3?u=k:D==-4&&(f=k);return N}let O=[],_=[];for(;l.pos>0;)p(r.start||0,r.bufferStart||0,O,_,-1,0);let T=(e=r.length)!==null&&e!==void 0?e:O.length?_[0]+O[0].length:0;return new Mr(h[r.topID],O.reverse(),_.reverse(),T)}const pF=new WeakMap;function QO(r,e){if(!r.isAnonymous||e instanceof ud||e.type!=r)return 1;let n=pF.get(e);if(n==null){n=1;for(let i of e.children){if(i.type!=r||!(i instanceof Mr)){n=1;break}n+=QO(r,i)}pF.set(e,n)}return n}function S5(r,e,n,i,s,o,a,l,h){let u=0;for(let y=i;y<s;y++)u+=QO(r,e[y]);let f=Math.ceil(u*1.5/8),p=[],m=[];function v(y,x,w,S,O){for(let _=w;_<S;){let T=_,A=x[_],P=QO(r,y[_]);for(_++;_<S;_++){let N=QO(r,y[_]);if(P+N>=f)break;P+=N}if(_==T+1){if(P>f){let N=y[T];v(N.children,N.positions,0,N.children.length,x[T]+O);continue}p.push(y[T])}else{let N=x[_-1]+y[_-1].length-A;p.push(S5(r,y,x,T,_,A,N,null,h))}m.push(A+O-o)}}return v(e,n,i,s,0),(l||h)(p,m,a)}class Wf{constructor(e,n,i,s,o=!1,a=!1){this.from=e,this.to=n,this.tree=i,this.offset=s,this.open=(o?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,n=[],i=!1){let s=[new Wf(0,e.length,e,0,!1,i)];for(let o of n)o.to>e.length&&s.push(o);return s}static applyChanges(e,n,i=128){if(!n.length)return e;let s=[],o=1,a=e.length?e[0]:null;for(let l=0,h=0,u=0;;l++){let f=l<n.length?n[l]:null,p=f?f.fromA:1e9;if(p-h>=i)for(;a&&a.from<p;){let m=a;if(h>=m.from||p<=m.to||u){let v=Math.max(m.from,h)-u,y=Math.min(m.to,p)-u;m=v>=y?null:new Wf(v,y,m.tree,m.offset+u,l>0,!!f)}if(m&&s.push(m),a.to>p)break;a=o<e.length?e[o++]:null}if(!f)break;h=f.toA,u=f.toA-f.toB}return s}}class qY{startParse(e,n,i){return typeof e=="string"&&(e=new xIe(e)),i=i?i.length?i.map(s=>new pA(s.from,s.to)):[new pA(0,0)]:[new pA(0,e.length)],this.createParse(e,n||[],i)}parse(e,n,i){let s=this.startParse(e,n,i);for(;;){let o=s.advance();if(o)return o}}}class xIe{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,n){return this.string.slice(e,n)}}new Bi({perNode:!0});let wIe=0;class Oa{constructor(e,n,i,s){this.name=e,this.set=n,this.base=i,this.modified=s,this.id=wIe++}toString(){let{name:e}=this;for(let n of this.modified)n.name&&(e=`${n.name}(${e})`);return e}static define(e,n){let i=typeof e=="string"?e:"?";if(e instanceof Oa&&(n=e),n!=null&&n.base)throw new Error("Can not derive from a modified tag");let s=new Oa(i,[],null,[]);if(s.set.push(s),n)for(let o of n.set)s.set.push(o);return s}static defineModifier(e){let n=new WS(e);return i=>i.modified.indexOf(n)>-1?i:WS.get(i.base||i,i.modified.concat(n).sort((s,o)=>s.id-o.id))}}let _Ie=0;class WS{constructor(e){this.name=e,this.instances=[],this.id=_Ie++}static get(e,n){if(!n.length)return e;let i=n[0].instances.find(l=>l.base==e&&OIe(n,l.modified));if(i)return i;let s=[],o=new Oa(e.name,s,e,n);for(let l of n)l.instances.push(o);let a=SIe(n);for(let l of e.set)if(!l.modified.length)for(let h of a)s.push(WS.get(l,h));return o}}function OIe(r,e){return r.length==e.length&&r.every((n,i)=>n==e[i])}function SIe(r){let e=[[]];for(let n=0;n<r.length;n++)for(let i=0,s=e.length;i<s;i++)e.push(e[i].concat(r[n]));return e.sort((n,i)=>i.length-n.length)}function ZY(r){let e=Object.create(null);for(let n in r){let i=r[n];Array.isArray(i)||(i=[i]);for(let s of n.split(" "))if(s){let o=[],a=2,l=s;for(let p=0;;){if(l=="..."&&p>0&&p+3==s.length){a=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!m)throw new RangeError("Invalid path: "+s);if(o.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),p+=m[0].length,p==s.length)break;let v=s[p++];if(p==s.length&&v=="!"){a=0;break}if(v!="/")throw new RangeError("Invalid path: "+s);l=s.slice(p)}let h=o.length-1,u=o[h];if(!u)throw new RangeError("Invalid path: "+s);let f=new GS(i,a,h>0?o.slice(0,h):null);e[u]=f.sort(e[u])}}return KY.add(e)}const KY=new Bi;class GS{constructor(e,n,i,s){this.tags=e,this.mode=n,this.context=i,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}GS.empty=new GS([],2,null);function JY(r,e){let n=Object.create(null);for(let o of r)if(!Array.isArray(o.tag))n[o.tag.id]=o.class;else for(let a of o.tag)n[a.id]=o.class;let{scope:i,all:s=null}=e||{};return{style:o=>{let a=s;for(let l of o)for(let h of l.set){let u=n[h.id];if(u){a=a?a+" "+u:u;break}}return a},scope:i}}function CIe(r,e){let n=null;for(let i of r){let s=i.style(e);s&&(n=n?n+" "+s:s)}return n}function TIe(r,e,n,i=0,s=r.length){let o=new EIe(i,Array.isArray(e)?e:[e],n);o.highlightRange(r.cursor(),i,s,"",o.highlighters),o.flush(s)}class EIe{constructor(e,n,i){this.at=e,this.highlighters=n,this.span=i,this.class=""}startSpan(e,n){n!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=n)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,n,i,s,o){let{type:a,from:l,to:h}=e;if(l>=i||h<=n)return;a.isTop&&(o=this.highlighters.filter(v=>!v.scope||v.scope(a)));let u=s,f=MIe(e)||GS.empty,p=CIe(o,f.tags);if(p&&(u&&(u+=" "),u+=p,f.mode==1&&(s+=(s?" ":"")+p)),this.startSpan(Math.max(n,l),u),f.opaque)return;let m=e.tree&&e.tree.prop(Bi.mounted);if(m&&m.overlay){let v=e.node.enter(m.overlay[0].from+l,1),y=this.highlighters.filter(w=>!w.scope||w.scope(m.tree.type)),x=e.firstChild();for(let w=0,S=l;;w++){let O=w<m.overlay.length?m.overlay[w]:null,_=O?O.from+l:h,T=Math.max(n,S),A=Math.min(i,_);if(T<A&&x)for(;e.from<A&&(this.highlightRange(e,T,A,s,o),this.startSpan(Math.min(A,e.to),u),!(e.to>=_||!e.nextSibling())););if(!O||_>i)break;S=O.to+l,S>n&&(this.highlightRange(v.cursor(),Math.max(n,O.from+l),Math.min(i,S),"",y),this.startSpan(Math.min(i,S),u))}x&&e.parent()}else if(e.firstChild()){m&&(s="");do if(!(e.to<=n)){if(e.from>=i)break;this.highlightRange(e,n,i,s,o),this.startSpan(Math.min(i,e.to),u)}while(e.nextSibling());e.parent()}}}function MIe(r){let e=r.type.prop(KY);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const mt=Oa.define,B_=mt(),Mu=mt(),mF=mt(Mu),gF=mt(Mu),Au=mt(),$_=mt(Au),mA=mt(Au),Fl=mt(),rf=mt(Fl),Dl=mt(),Ll=mt(),F3=mt(),vy=mt(F3),U_=mt(),Qe={comment:B_,lineComment:mt(B_),blockComment:mt(B_),docComment:mt(B_),name:Mu,variableName:mt(Mu),typeName:mF,tagName:mt(mF),propertyName:gF,attributeName:mt(gF),className:mt(Mu),labelName:mt(Mu),namespace:mt(Mu),macroName:mt(Mu),literal:Au,string:$_,docString:mt($_),character:mt($_),attributeValue:mt($_),number:mA,integer:mt(mA),float:mt(mA),bool:mt(Au),regexp:mt(Au),escape:mt(Au),color:mt(Au),url:mt(Au),keyword:Dl,self:mt(Dl),null:mt(Dl),atom:mt(Dl),unit:mt(Dl),modifier:mt(Dl),operatorKeyword:mt(Dl),controlKeyword:mt(Dl),definitionKeyword:mt(Dl),moduleKeyword:mt(Dl),operator:Ll,derefOperator:mt(Ll),arithmeticOperator:mt(Ll),logicOperator:mt(Ll),bitwiseOperator:mt(Ll),compareOperator:mt(Ll),updateOperator:mt(Ll),definitionOperator:mt(Ll),typeOperator:mt(Ll),controlOperator:mt(Ll),punctuation:F3,separator:mt(F3),bracket:vy,angleBracket:mt(vy),squareBracket:mt(vy),paren:mt(vy),brace:mt(vy),content:Fl,heading:rf,heading1:mt(rf),heading2:mt(rf),heading3:mt(rf),heading4:mt(rf),heading5:mt(rf),heading6:mt(rf),contentSeparator:mt(Fl),list:mt(Fl),quote:mt(Fl),emphasis:mt(Fl),strong:mt(Fl),link:mt(Fl),monospace:mt(Fl),strikethrough:mt(Fl),inserted:mt(),deleted:mt(),changed:mt(),invalid:mt(),meta:U_,documentMeta:mt(U_),annotation:mt(U_),processingInstruction:mt(U_),definition:Oa.defineModifier("definition"),constant:Oa.defineModifier("constant"),function:Oa.defineModifier("function"),standard:Oa.defineModifier("standard"),local:Oa.defineModifier("local"),special:Oa.defineModifier("special")};for(let r in Qe){let e=Qe[r];e instanceof Oa&&(e.name=r)}JY([{tag:Qe.link,class:"tok-link"},{tag:Qe.heading,class:"tok-heading"},{tag:Qe.emphasis,class:"tok-emphasis"},{tag:Qe.strong,class:"tok-strong"},{tag:Qe.keyword,class:"tok-keyword"},{tag:Qe.atom,class:"tok-atom"},{tag:Qe.bool,class:"tok-bool"},{tag:Qe.url,class:"tok-url"},{tag:Qe.labelName,class:"tok-labelName"},{tag:Qe.inserted,class:"tok-inserted"},{tag:Qe.deleted,class:"tok-deleted"},{tag:Qe.literal,class:"tok-literal"},{tag:Qe.string,class:"tok-string"},{tag:Qe.number,class:"tok-number"},{tag:[Qe.regexp,Qe.escape,Qe.special(Qe.string)],class:"tok-string2"},{tag:Qe.variableName,class:"tok-variableName"},{tag:Qe.local(Qe.variableName),class:"tok-variableName tok-local"},{tag:Qe.definition(Qe.variableName),class:"tok-variableName tok-definition"},{tag:Qe.special(Qe.variableName),class:"tok-variableName2"},{tag:Qe.definition(Qe.propertyName),class:"tok-propertyName tok-definition"},{tag:Qe.typeName,class:"tok-typeName"},{tag:Qe.namespace,class:"tok-namespace"},{tag:Qe.className,class:"tok-className"},{tag:Qe.macroName,class:"tok-macroName"},{tag:Qe.propertyName,class:"tok-propertyName"},{tag:Qe.operator,class:"tok-operator"},{tag:Qe.comment,class:"tok-comment"},{tag:Qe.meta,class:"tok-meta"},{tag:Qe.invalid,class:"tok-invalid"},{tag:Qe.punctuation,class:"tok-punctuation"}]);var gA;const Zm=new Bi;function AIe(r){return Pt.define({combine:r?e=>e.concat(r):void 0})}const kIe=new Bi;class ul{constructor(e,n,i=[],s=""){this.data=e,this.name=s,an.prototype.hasOwnProperty("tree")||Object.defineProperty(an.prototype,"tree",{get(){return Is(this)}}),this.parser=n,this.extension=[dd.of(this),an.languageData.of((o,a,l)=>{let h=vF(o,a,l),u=h.type.prop(Zm);if(!u)return[];let f=o.facet(u),p=h.type.prop(kIe);if(p){let m=h.resolve(a-h.from,l);for(let v of p)if(v.test(m,o)){let y=o.facet(v.facet);return v.type=="replace"?y:y.concat(f)}}return f})].concat(i)}isActiveAt(e,n,i=-1){return vF(e,n,i).type.prop(Zm)==this.data}findRegions(e){let n=e.facet(dd);if((n==null?void 0:n.data)==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let i=[],s=(o,a)=>{if(o.prop(Zm)==this.data){i.push({from:a,to:a+o.length});return}let l=o.prop(Bi.mounted);if(l){if(l.tree.prop(Zm)==this.data){if(l.overlay)for(let h of l.overlay)i.push({from:h.from+a,to:h.to+a});else i.push({from:a,to:a+o.length});return}else if(l.overlay){let h=i.length;if(s(l.tree,l.overlay[0].from+a),i.length>h)return}}for(let h=0;h<o.children.length;h++){let u=o.children[h];u instanceof Mr&&s(u,o.positions[h]+a)}};return s(Is(e),0),i}get allowsNesting(){return!0}}ul.setState=Ri.define();function vF(r,e,n){let i=r.facet(dd),s=Is(r).topNode;if(!i||i.allowsNesting)for(let o=s;o;o=o.enter(e,n,es.ExcludeBuffers))o.type.isTop&&(s=o);return s}class HS extends ul{constructor(e,n,i){super(e,n,[],i),this.parser=n}static define(e){let n=AIe(e.languageData);return new HS(n,e.parser.configure({props:[Zm.add(i=>i.isTop?n:void 0)]}),e.name)}configure(e,n){return new HS(this.data,this.parser.configure(e),n||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Is(r){let e=r.field(ul.state,!1);return e?e.tree:Mr.empty}class PIe{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let i=this.cursorPos-this.string.length;return e<i||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-i,n-i)}}let yy=null;class QS{constructor(e,n,i=[],s,o,a,l,h){this.parser=e,this.state=n,this.fragments=i,this.tree=s,this.treeLen=o,this.viewport=a,this.skipped=l,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(e,n,i){return new QS(e,n,[],Mr.empty,0,i,[],null)}startParse(){return this.parser.startParse(new PIe(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=Mr.empty&&this.isDone(n??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(Wf.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(n??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped(Wf.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=yy;yy=this;try{return e()}finally{yy=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=yF(e,n.from,n.to);return e}changes(e,n){let{fragments:i,tree:s,treeLen:o,viewport:a,skipped:l}=this;if(this.takeTree(),!e.empty){let h=[];if(e.iterChangedRanges((u,f,p,m)=>h.push({fromA:u,toA:f,fromB:p,toB:m})),i=Wf.applyChanges(i,h),s=Mr.empty,o=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){l=[];for(let u of this.skipped){let f=e.mapPos(u.from,1),p=e.mapPos(u.to,-1);f<p&&l.push({from:f,to:p})}}}return new QS(this.parser,n,i,s,o,a,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:s,to:o}=this.skipped[i];s<e.to&&o>e.from&&(this.fragments=yF(this.fragments,s,o),this.skipped.splice(i--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends qY{createParse(n,i,s){let o=s[0].from,a=s[s.length-1].to;return{parsedPos:o,advance(){let h=yy;if(h){for(let u of s)h.tempSkipped.push(u);e&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,e]):e)}return this.parsedPos=a,new Mr(ko.none,[],[],a-o)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return yy}}function yF(r,e,n){return Wf.applyChanges(r,[{fromA:e,toA:n,fromB:e,toB:n}])}class jg{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,i)||n.takeTree(),new jg(n)}static init(e){let n=Math.min(3e3,e.doc.length),i=QS.create(e.facet(dd).parser,e,{from:0,to:n});return i.work(20,n)||i.takeTree(),new jg(i)}}ul.state=ws.define({create:jg.init,update(r,e){for(let n of e.effects)if(n.is(ul.setState))return n.value;return e.startState.facet(dd)!=e.state.facet(dd)?jg.init(e.state):r.apply(e)}});let eq=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(eq=r=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const vA=typeof navigator<"u"&&(!((gA=navigator.scheduling)===null||gA===void 0)&&gA.isInputPending)?()=>navigator.scheduling.isInputPending():null,RIe=Pr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field(ul.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field(ul.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=eq(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:s}}=this.view,o=i.field(ul.state);if(o.tree==o.context.tree&&o.context.isDone(s+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!vA?Math.max(25,e.timeRemaining()-5):1e9),l=o.context.treeLen<s&&i.doc.length>s+1e3,h=o.context.work(()=>vA&&vA()||Date.now()>a,s+(l?0:1e5));this.chunkBudget-=Date.now()-n,(h||this.chunkBudget<=0)&&(o.context.takeTree(),this.view.dispatch({effects:ul.setState.of(new jg(o.context))})),this.chunkBudget>0&&!(h&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(o.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>So(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),dd=Pt.define({combine(r){return r.length?r[0]:null},enables:r=>[ul.state,RIe,St.contentAttributes.compute([r],e=>{let n=e.facet(r);return n&&n.name?{"data-language":n.name}:{}})]});class IIe{constructor(e,n=[]){this.language=e,this.support=n,this.extension=[e,n]}}const NIe=Pt.define(),C5=Pt.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}});function jS(r){let e=r.facet(C5);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function ab(r,e){let n="",i=r.tabSize,s=r.facet(C5)[0];if(s=="	"){for(;e>=i;)n+="	",e-=i;s=" "}for(let o=0;o<e;o++)n+=s;return n}function T5(r,e){r instanceof an&&(r=new X2(r));for(let i of r.state.facet(NIe)){let s=i(r,e);if(s!==void 0)return s}let n=Is(r.state);return n.length>=e?DIe(r,n,e):null}class X2{constructor(e,n={}){this.state=e,this.options=n,this.unit=jS(e)}lineAt(e,n=1){let i=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:o}=this.options;return s!=null&&s>=i.from&&s<=i.to?o&&s==e?{text:"",from:e}:(n<0?s<e:s<=e)?{text:i.text.slice(s-i.from),from:s}:{text:i.text.slice(0,s-i.from),from:i.from}:i}textAfterPos(e,n=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:s}=this.lineAt(e,n);return i.slice(e-s,Math.min(i.length,e+100-s))}column(e,n=1){let{text:i,from:s}=this.lineAt(e,n),o=this.countColumn(i,e-s),a=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return a>-1&&(o+=a-this.countColumn(i,i.search(/\S|$/))),o}countColumn(e,n=e.length){return g0(e,this.state.tabSize,n)}lineIndent(e,n=1){let{text:i,from:s}=this.lineAt(e,n),o=this.options.overrideIndentation;if(o){let a=o(s);if(a>-1)return a}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const tq=new Bi;function DIe(r,e,n){let i=e.resolveStack(n),s=i.node.enterUnfinishedNodesBefore(n);if(s!=i.node){let o=[];for(let a=s;a!=i.node;a=a.parent)o.push(a);for(let a=o.length-1;a>=0;a--)i={node:o[a],next:i}}return iq(i,r,n)}function iq(r,e,n){for(let i=r;i;i=i.next){let s=BIe(i.node);if(s)return s(E5.create(e,n,i))}return 0}function LIe(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function BIe(r){let e=r.type.prop(tq);if(e)return e;let n=r.firstChild,i;if(n&&(i=n.type.prop(Bi.closedBy))){let s=r.lastChild,o=s&&i.indexOf(s.name)>-1;return a=>nq(a,!0,1,void 0,o&&!LIe(a)?s.from:void 0)}return r.parent==null?$Ie:null}function $Ie(){return 0}class E5 extends X2{constructor(e,n,i){super(e.state,e.options),this.base=e,this.pos=n,this.context=i}get node(){return this.context.node}static create(e,n,i){return new E5(e,n,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let n=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(n.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(UIe(i,e))break;n=this.state.doc.lineAt(i.from)}return this.lineIndent(n.from)}continue(){return iq(this.context.next,this.base,this.pos)}}function UIe(r,e){for(let n=e;n;n=n.parent)if(r==n)return!0;return!1}function VIe(r){let e=r.node,n=e.childAfter(e.from),i=e.lastChild;if(!n)return null;let s=r.options.simulateBreak,o=r.state.doc.lineAt(n.from),a=s==null||s<=o.from?o.to:Math.min(o.to,s);for(let l=n.to;;){let h=e.childAfter(l);if(!h||h==i)return null;if(!h.type.isSkipped)return h.from<a?n:null;l=h.to}}function FIe({closing:r,align:e=!0,units:n=1}){return i=>nq(i,e,n,r)}function nq(r,e,n,i,s){let o=r.textAfter,a=o.match(/^\s*/)[0].length,l=i&&o.slice(a,a+i.length)==i||s==r.pos+a,h=e?VIe(r):null;return h?l?r.column(h.from):r.column(h.to):r.baseIndent+(l?0:r.unit*n)}const zIe=r=>r.baseIndent;function yA({except:r,units:e=1}={}){return n=>{let i=r&&r.test(n.textAfter);return n.baseIndent+(i?0:e*n.unit)}}const XIe=200;function WIe(){return an.transactionFilter.of(r=>{if(!r.docChanged||!r.isUserEvent("input.type")&&!r.isUserEvent("input.complete"))return r;let e=r.startState.languageDataAt("indentOnInput",r.startState.selection.main.head);if(!e.length)return r;let n=r.newDoc,{head:i}=r.newSelection.main,s=n.lineAt(i);if(i>s.from+XIe)return r;let o=n.sliceString(s.from,i);if(!e.some(u=>u.test(o)))return r;let{state:a}=r,l=-1,h=[];for(let{head:u}of a.selection.ranges){let f=a.doc.lineAt(u);if(f.from==l)continue;l=f.from;let p=T5(a,f.from);if(p==null)continue;let m=/^\s*/.exec(f.text)[0],v=ab(a,p);m!=v&&h.push({from:f.from,to:f.from+m.length,insert:v})}return h.length?[r,{changes:h,sequential:!0}]:r})}const GIe=Pt.define(),rq=new Bi;function HIe(r){let e=r.firstChild,n=r.lastChild;return e&&e.to<n.from?{from:e.to,to:n.type.isError?r.to:n.from}:null}function QIe(r,e,n){let i=Is(r);if(i.length<n)return null;let s=i.resolveStack(n,1),o=null;for(let a=s;a;a=a.next){let l=a.node;if(l.to<=n||l.from>n)continue;if(o&&l.from<e)break;let h=l.type.prop(rq);if(h&&(l.to<i.length-50||i.length==r.doc.length||!jIe(l))){let u=h(l,r);u&&u.from<=n&&u.from>=e&&u.to>n&&(o=u)}}return o}function jIe(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function YS(r,e,n){for(let i of r.facet(GIe)){let s=i(r,e,n);if(s)return s}return QIe(r,e,n)}function sq(r,e){let n=e.mapPos(r.from,1),i=e.mapPos(r.to,-1);return n>=i?void 0:{from:n,to:i}}const W2=Ri.define({map:sq}),ex=Ri.define({map:sq});function oq(r){let e=[];for(let{head:n}of r.state.selection.ranges)e.some(i=>i.from<=n&&i.to>=n)||e.push(r.lineBlockAt(n));return e}const fp=ws.define({create(){return ui.none},update(r,e){r=r.map(e.changes);for(let n of e.effects)if(n.is(W2)&&!YIe(r,n.value.from,n.value.to)){let{preparePlaceholder:i}=e.state.facet(cq),s=i?ui.replace({widget:new i4e(i(e.state,n.value))}):bF;r=r.update({add:[s.range(n.value.from,n.value.to)]})}else n.is(ex)&&(r=r.update({filter:(i,s)=>n.value.from!=i||n.value.to!=s,filterFrom:n.value.from,filterTo:n.value.to}));if(e.selection){let n=!1,{head:i}=e.selection.main;r.between(i,i,(s,o)=>{s<i&&o>i&&(n=!0)}),n&&(r=r.update({filterFrom:i,filterTo:i,filter:(s,o)=>o<=i||s>=i}))}return r},provide:r=>St.decorations.from(r),toJSON(r,e){let n=[];return r.between(0,e.doc.length,(i,s)=>{n.push(i,s)}),n},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let n=0;n<r.length;){let i=r[n++],s=r[n++];if(typeof i!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");e.push(bF.range(i,s))}return ui.set(e,!0)}});function qS(r,e,n){var i;let s=null;return(i=r.field(fp,!1))===null||i===void 0||i.between(e,n,(o,a)=>{(!s||s.from>o)&&(s={from:o,to:a})}),s}function YIe(r,e,n){let i=!1;return r.between(e,e,(s,o)=>{s==e&&o==n&&(i=!0)}),i}function aq(r,e){return r.field(fp,!1)?e:e.concat(Ri.appendConfig.of(hq()))}const qIe=r=>{for(let e of oq(r)){let n=YS(r.state,e.from,e.to);if(n)return r.dispatch({effects:aq(r.state,[W2.of(n),lq(r,n)])}),!0}return!1},ZIe=r=>{if(!r.state.field(fp,!1))return!1;let e=[];for(let n of oq(r)){let i=qS(r.state,n.from,n.to);i&&e.push(ex.of(i),lq(r,i,!1))}return e.length&&r.dispatch({effects:e}),e.length>0};function lq(r,e,n=!0){let i=r.state.doc.lineAt(e.from).number,s=r.state.doc.lineAt(e.to).number;return St.announce.of(`${r.state.phrase(n?"Folded lines":"Unfolded lines")} ${i} ${r.state.phrase("to")} ${s}.`)}const KIe=r=>{let{state:e}=r,n=[];for(let i=0;i<e.doc.length;){let s=r.lineBlockAt(i),o=YS(e,s.from,s.to);o&&n.push(W2.of(o)),i=(o?r.lineBlockAt(o.to):s).to+1}return n.length&&r.dispatch({effects:aq(r.state,n)}),!!n.length},JIe=r=>{let e=r.state.field(fp,!1);if(!e||!e.size)return!1;let n=[];return e.between(0,r.state.doc.length,(i,s)=>{n.push(ex.of({from:i,to:s}))}),r.dispatch({effects:n}),!0},e4e=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:qIe},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:ZIe},{key:"Ctrl-Alt-[",run:KIe},{key:"Ctrl-Alt-]",run:JIe}],t4e={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},cq=Pt.define({combine(r){return _c(r,t4e)}});function hq(r){return[fp,s4e]}function uq(r,e){let{state:n}=r,i=n.facet(cq),s=a=>{let l=r.lineBlockAt(r.posAtDOM(a.target)),h=qS(r.state,l.from,l.to);h&&r.dispatch({effects:ex.of(h)}),a.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(r,s,e);let o=document.createElement("span");return o.textContent=i.placeholderText,o.setAttribute("aria-label",n.phrase("folded code")),o.title=n.phrase("unfold"),o.className="cm-foldPlaceholder",o.onclick=s,o}const bF=ui.replace({widget:new class extends wd{toDOM(r){return uq(r,null)}}});class i4e extends wd{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return uq(e,this.value)}}const n4e={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class bA extends Eh{constructor(e,n){super(),this.config=e,this.open=n}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let n=document.createElement("span");return n.textContent=this.open?this.config.openText:this.config.closedText,n.title=e.state.phrase(this.open?"Fold line":"Unfold line"),n}}function r4e(r={}){let e=Object.assign(Object.assign({},n4e),r),n=new bA(e,!0),i=new bA(e,!1),s=Pr.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(dd)!=a.state.facet(dd)||a.startState.field(fp,!1)!=a.state.field(fp,!1)||Is(a.startState)!=Is(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let l=new ad;for(let h of a.viewportLineBlocks){let u=qS(a.state,h.from,h.to)?i:YS(a.state,h.from,h.to)?n:null;u&&l.add(h.from,h.from,u)}return l.finish()}}),{domEventHandlers:o}=e;return[s,nIe({class:"cm-foldGutter",markers(a){var l;return((l=a.plugin(s))===null||l===void 0?void 0:l.markers)||sn.empty},initialSpacer(){return new bA(e,!1)},domEventHandlers:Object.assign(Object.assign({},o),{click:(a,l,h)=>{if(o.click&&o.click(a,l,h))return!0;let u=qS(a.state,l.from,l.to);if(u)return a.dispatch({effects:ex.of(u)}),!0;let f=YS(a.state,l.from,l.to);return f?(a.dispatch({effects:W2.of(f)}),!0):!1}})}),hq()]}const s4e=St.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class G2{constructor(e,n){this.specs=e;let i;function s(l){let h=ld.newName();return(i||(i=Object.create(null)))["."+h]=l,h}const o=typeof n.all=="string"?n.all:n.all?s(n.all):void 0,a=n.scope;this.scope=a instanceof ul?l=>l.prop(Zm)==a.data:a?l=>l==a:void 0,this.style=JY(e.map(l=>({tag:l.tag,class:l.class||s(Object.assign({},l,{tag:null}))})),{all:o}).style,this.module=i?new ld(i):null,this.themeType=n.themeType}static define(e,n){return new G2(e,n||{})}}const z3=Pt.define(),dq=Pt.define({combine(r){return r.length?[r[0]]:null}});function xA(r){let e=r.facet(z3);return e.length?e:r.facet(dq)}function o4e(r,e){let n=[l4e],i;return r instanceof G2&&(r.module&&n.push(St.styleModule.of(r.module)),i=r.themeType),e!=null&&e.fallback?n.push(dq.of(r)):i?n.push(z3.computeN([St.darkTheme],s=>s.facet(St.darkTheme)==(i=="dark")?[r]:[])):n.push(z3.of(r)),n}class a4e{constructor(e){this.markCache=Object.create(null),this.tree=Is(e.state),this.decorations=this.buildDeco(e,xA(e.state)),this.decoratedTo=e.viewport.to}update(e){let n=Is(e.state),i=xA(e.state),s=i!=xA(e.startState),{viewport:o}=e.view,a=e.changes.mapPos(this.decoratedTo,1);n.length<o.to&&!s&&n.type==this.tree.type&&a>=o.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(n!=this.tree||e.viewportChanged||s)&&(this.tree=n,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=o.to)}buildDeco(e,n){if(!n||!this.tree.length)return ui.none;let i=new ad;for(let{from:s,to:o}of e.visibleRanges)TIe(this.tree,n,(a,l,h)=>{i.add(a,l,this.markCache[h]||(this.markCache[h]=ui.mark({class:h})))},s,o);return i.finish()}}const l4e=kp.high(Pr.fromClass(a4e,{decorations:r=>r.decorations})),c4e=G2.define([{tag:Qe.meta,color:"#404740"},{tag:Qe.link,textDecoration:"underline"},{tag:Qe.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Qe.emphasis,fontStyle:"italic"},{tag:Qe.strong,fontWeight:"bold"},{tag:Qe.strikethrough,textDecoration:"line-through"},{tag:Qe.keyword,color:"#708"},{tag:[Qe.atom,Qe.bool,Qe.url,Qe.contentSeparator,Qe.labelName],color:"#219"},{tag:[Qe.literal,Qe.inserted],color:"#164"},{tag:[Qe.string,Qe.deleted],color:"#a11"},{tag:[Qe.regexp,Qe.escape,Qe.special(Qe.string)],color:"#e40"},{tag:Qe.definition(Qe.variableName),color:"#00f"},{tag:Qe.local(Qe.variableName),color:"#30a"},{tag:[Qe.typeName,Qe.namespace],color:"#085"},{tag:Qe.className,color:"#167"},{tag:[Qe.special(Qe.variableName),Qe.macroName],color:"#256"},{tag:Qe.definition(Qe.propertyName),color:"#00c"},{tag:Qe.comment,color:"#940"},{tag:Qe.invalid,color:"#f00"}]),h4e=St.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),fq=1e4,pq="()[]{}",mq=Pt.define({combine(r){return _c(r,{afterCursor:!0,brackets:pq,maxScanDistance:fq,renderMatch:f4e})}}),u4e=ui.mark({class:"cm-matchingBracket"}),d4e=ui.mark({class:"cm-nonmatchingBracket"});function f4e(r){let e=[],n=r.matched?u4e:d4e;return e.push(n.range(r.start.from,r.start.to)),r.end&&e.push(n.range(r.end.from,r.end.to)),e}const p4e=ws.define({create(){return ui.none},update(r,e){if(!e.docChanged&&!e.selection)return r;let n=[],i=e.state.facet(mq);for(let s of e.state.selection.ranges){if(!s.empty)continue;let o=nc(e.state,s.head,-1,i)||s.head>0&&nc(e.state,s.head-1,1,i)||i.afterCursor&&(nc(e.state,s.head,1,i)||s.head<e.state.doc.length&&nc(e.state,s.head+1,-1,i));o&&(n=n.concat(i.renderMatch(o,e.state)))}return ui.set(n,!0)},provide:r=>St.decorations.from(r)}),m4e=[p4e,h4e];function g4e(r={}){return[mq.of(r),m4e]}const v4e=new Bi;function X3(r,e,n){let i=r.prop(e<0?Bi.openedBy:Bi.closedBy);if(i)return i;if(r.name.length==1){let s=n.indexOf(r.name);if(s>-1&&s%2==(e<0?1:0))return[n[s+e]]}return null}function W3(r){let e=r.type.prop(v4e);return e?e(r.node):r}function nc(r,e,n,i={}){let s=i.maxScanDistance||fq,o=i.brackets||pq,a=Is(r),l=a.resolveInner(e,n);for(let h=l;h;h=h.parent){let u=X3(h.type,n,o);if(u&&h.from<h.to){let f=W3(h);if(f&&(n>0?e>=f.from&&e<f.to:e>f.from&&e<=f.to))return y4e(r,e,n,h,f,u,o)}}return b4e(r,e,n,a,l.type,s,o)}function y4e(r,e,n,i,s,o,a){let l=i.parent,h={from:s.from,to:s.to},u=0,f=l==null?void 0:l.cursor();if(f&&(n<0?f.childBefore(i.from):f.childAfter(i.to)))do if(n<0?f.to<=i.from:f.from>=i.to){if(u==0&&o.indexOf(f.type.name)>-1&&f.from<f.to){let p=W3(f);return{start:h,end:p?{from:p.from,to:p.to}:void 0,matched:!0}}else if(X3(f.type,n,a))u++;else if(X3(f.type,-n,a)){if(u==0){let p=W3(f);return{start:h,end:p&&p.from<p.to?{from:p.from,to:p.to}:void 0,matched:!1}}u--}}while(n<0?f.prevSibling():f.nextSibling());return{start:h,matched:!1}}function b4e(r,e,n,i,s,o,a){let l=n<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),h=a.indexOf(l);if(h<0||h%2==0!=n>0)return null;let u={from:n<0?e-1:e,to:n>0?e+1:e},f=r.doc.iterRange(e,n>0?r.doc.length:0),p=0;for(let m=0;!f.next().done&&m<=o;){let v=f.value;n<0&&(m+=v.length);let y=e+m*n;for(let x=n>0?0:v.length-1,w=n>0?v.length:-1;x!=w;x+=n){let S=a.indexOf(v[x]);if(!(S<0||i.resolveInner(y+x,1).type!=s))if(S%2==0==n>0)p++;else{if(p==1)return{start:u,end:{from:y+x,to:y+x+1},matched:S>>1==h>>1};p--}}n>0&&(m+=v.length)}return f.done?{start:u,matched:!1}:null}const x4e=Object.create(null),xF=[ko.none],wF=[],_F=Object.create(null),w4e=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])w4e[r]=_4e(x4e,e);function wA(r,e){wF.indexOf(r)>-1||(wF.push(r),console.warn(e))}function _4e(r,e){let n=[];for(let l of e.split(" ")){let h=[];for(let u of l.split(".")){let f=r[u]||Qe[u];f?typeof f=="function"?h.length?h=h.map(f):wA(u,`Modifier ${u} used at start of tag`):h.length?wA(u,`Tag ${u} used as modifier`):h=Array.isArray(f)?f:[f]:wA(u,`Unknown highlighting tag ${u}`)}for(let u of h)n.push(u)}if(!n.length)return 0;let i=e.replace(/ /g,"_"),s=i+" "+n.map(l=>l.id),o=_F[s];if(o)return o.id;let a=_F[s]=ko.define({id:xF.length,name:i,props:[ZY({[i]:n})]});return xF.push(a),a.id}Vn.RTL,Vn.LTR;const O4e=r=>{let{state:e}=r,n=e.doc.lineAt(e.selection.main.from),i=A5(r.state,n.from);return i.line?S4e(r):i.block?T4e(r):!1};function M5(r,e){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let s=r(e,n);return s?(i(n.update(s)),!0):!1}}const S4e=M5(A4e,0),C4e=M5(gq,0),T4e=M5((r,e)=>gq(r,e,M4e(e)),0);function A5(r,e){let n=r.languageDataAt("commentTokens",e);return n.length?n[0]:{}}const by=50;function E4e(r,{open:e,close:n},i,s){let o=r.sliceDoc(i-by,i),a=r.sliceDoc(s,s+by),l=/\s*$/.exec(o)[0].length,h=/^\s*/.exec(a)[0].length,u=o.length-l;if(o.slice(u-e.length,u)==e&&a.slice(h,h+n.length)==n)return{open:{pos:i-l,margin:l&&1},close:{pos:s+h,margin:h&&1}};let f,p;s-i<=2*by?f=p=r.sliceDoc(i,s):(f=r.sliceDoc(i,i+by),p=r.sliceDoc(s-by,s));let m=/^\s*/.exec(f)[0].length,v=/\s*$/.exec(p)[0].length,y=p.length-v-n.length;return f.slice(m,m+e.length)==e&&p.slice(y,y+n.length)==n?{open:{pos:i+m+e.length,margin:/\s/.test(f.charAt(m+e.length))?1:0},close:{pos:s-v-n.length,margin:/\s/.test(p.charAt(y-1))?1:0}}:null}function M4e(r){let e=[];for(let n of r.selection.ranges){let i=r.doc.lineAt(n.from),s=n.to<=i.to?i:r.doc.lineAt(n.to),o=e.length-1;o>=0&&e[o].to>i.from?e[o].to=s.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:s.to})}return e}function gq(r,e,n=e.selection.ranges){let i=n.map(o=>A5(e,o.from).block);if(!i.every(o=>o))return null;let s=n.map((o,a)=>E4e(e,i[a],o.from,o.to));if(r!=2&&!s.every(o=>o))return{changes:e.changes(n.map((o,a)=>s[a]?[]:[{from:o.from,insert:i[a].open+" "},{from:o.to,insert:" "+i[a].close}]))};if(r!=1&&s.some(o=>o)){let o=[];for(let a=0,l;a<s.length;a++)if(l=s[a]){let h=i[a],{open:u,close:f}=l;o.push({from:u.pos-h.open.length,to:u.pos+u.margin},{from:f.pos-f.margin,to:f.pos+h.close.length})}return{changes:o}}return null}function A4e(r,e,n=e.selection.ranges){let i=[],s=-1;for(let{from:o,to:a}of n){let l=i.length,h=1e9,u=A5(e,o).line;if(u){for(let f=o;f<=a;){let p=e.doc.lineAt(f);if(p.from>s&&(o==a||a>p.from)){s=p.from;let m=/^\s*/.exec(p.text)[0].length,v=m==p.length,y=p.text.slice(m,m+u.length)==u?m:-1;m<p.text.length&&m<h&&(h=m),i.push({line:p,comment:y,token:u,indent:m,empty:v,single:!1})}f=p.to+1}if(h<1e9)for(let f=l;f<i.length;f++)i[f].indent<i[f].line.text.length&&(i[f].indent=h);i.length==l+1&&(i[l].single=!0)}}if(r!=2&&i.some(o=>o.comment<0&&(!o.empty||o.single))){let o=[];for(let{line:l,token:h,indent:u,empty:f,single:p}of i)(p||!f)&&o.push({from:l.from+u,insert:h+" "});let a=e.changes(o);return{changes:a,selection:e.selection.map(a,1)}}else if(r!=1&&i.some(o=>o.comment>=0)){let o=[];for(let{line:a,comment:l,token:h}of i)if(l>=0){let u=a.from+l,f=u+h.length;a.text[f-a.from]==" "&&f++,o.push({from:u,to:f})}return{changes:o}}return null}const G3=Nh.define(),k4e=Nh.define(),P4e=Pt.define(),vq=Pt.define({combine(r){return _c(r,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(i,s)=>e(i,s)||n(i,s)})}}),yq=ws.define({create(){return rc.empty},update(r,e){let n=e.state.facet(vq),i=e.annotation(G3);if(i){let h=Co.fromTransaction(e,i.selection),u=i.side,f=u==0?r.undone:r.done;return h?f=ZS(f,f.length,n.minDepth,h):f=wq(f,e.startState.selection),new rc(u==0?i.rest:f,u==0?f:i.rest)}let s=e.annotation(k4e);if((s=="full"||s=="before")&&(r=r.isolate()),e.annotation(zr.addToHistory)===!1)return e.changes.empty?r:r.addMapping(e.changes.desc);let o=Co.fromTransaction(e),a=e.annotation(zr.time),l=e.annotation(zr.userEvent);return o?r=r.addChanges(o,a,l,n,e):e.selection&&(r=r.addSelection(e.startState.selection,a,l,n.newGroupDelay)),(s=="full"||s=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(e=>e.toJSON()),undone:r.undone.map(e=>e.toJSON())}},fromJSON(r){return new rc(r.done.map(Co.fromJSON),r.undone.map(Co.fromJSON))}});function R4e(r={}){return[yq,vq.of(r),St.domEventHandlers({beforeinput(e,n){let i=e.inputType=="historyUndo"?bq:e.inputType=="historyRedo"?H3:null;return i?(e.preventDefault(),i(n)):!1}})]}function H2(r,e){return function({state:n,dispatch:i}){if(!e&&n.readOnly)return!1;let s=n.field(yq,!1);if(!s)return!1;let o=s.pop(r,n,e);return o?(i(o),!0):!1}}const bq=H2(0,!1),H3=H2(1,!1),I4e=H2(0,!0),N4e=H2(1,!0);class Co{constructor(e,n,i,s,o){this.changes=e,this.effects=n,this.mapped=i,this.startSelection=s,this.selectionsAfter=o}setSelAfter(e){return new Co(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new Co(e.changes&&$r.fromJSON(e.changes),[],e.mapped&&lc.fromJSON(e.mapped),e.startSelection&&et.fromJSON(e.startSelection),e.selectionsAfter.map(et.fromJSON))}static fromTransaction(e,n){let i=Aa;for(let s of e.startState.facet(P4e)){let o=s(e);o.length&&(i=i.concat(o))}return!i.length&&e.changes.empty?null:new Co(e.changes.invert(e.startState.doc),i,void 0,n||e.startState.selection,Aa)}static selection(e){return new Co(void 0,Aa,void 0,void 0,e)}}function ZS(r,e,n,i){let s=e+1>n+20?e-n-1:0,o=r.slice(s,e);return o.push(i),o}function D4e(r,e){let n=[],i=!1;return r.iterChangedRanges((s,o)=>n.push(s,o)),e.iterChangedRanges((s,o,a,l)=>{for(let h=0;h<n.length;){let u=n[h++],f=n[h++];l>=u&&a<=f&&(i=!0)}}),i}function L4e(r,e){return r.ranges.length==e.ranges.length&&r.ranges.filter((n,i)=>n.empty!=e.ranges[i].empty).length===0}function xq(r,e){return r.length?e.length?r.concat(e):r:e}const Aa=[],B4e=200;function wq(r,e){if(r.length){let n=r[r.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-B4e));return i.length&&i[i.length-1].eq(e)?r:(i.push(e),ZS(r,r.length-1,1e9,n.setSelAfter(i)))}else return[Co.selection([e])]}function $4e(r){let e=r[r.length-1],n=r.slice();return n[r.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function _A(r,e){if(!r.length)return r;let n=r.length,i=Aa;for(;n;){let s=U4e(r[n-1],e,i);if(s.changes&&!s.changes.empty||s.effects.length){let o=r.slice(0,n);return o[n-1]=s,o}else e=s.mapped,n--,i=s.selectionsAfter}return i.length?[Co.selection(i)]:Aa}function U4e(r,e,n){let i=xq(r.selectionsAfter.length?r.selectionsAfter.map(l=>l.map(e)):Aa,n);if(!r.changes)return Co.selection(i);let s=r.changes.map(e),o=e.mapDesc(r.changes,!0),a=r.mapped?r.mapped.composeDesc(o):o;return new Co(s,Ri.mapEffects(r.effects,e),a,r.startSelection.map(o),i)}const V4e=/^(input\.type|delete)($|\.)/;class rc{constructor(e,n,i=0,s=void 0){this.done=e,this.undone=n,this.prevTime=i,this.prevUserEvent=s}isolate(){return this.prevTime?new rc(this.done,this.undone):this}addChanges(e,n,i,s,o){let a=this.done,l=a[a.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!i||V4e.test(i))&&(!l.selectionsAfter.length&&n-this.prevTime<s.newGroupDelay&&s.joinToEvent(o,D4e(l.changes,e.changes))||i=="input.type.compose")?a=ZS(a,a.length-1,s.minDepth,new Co(e.changes.compose(l.changes),xq(Ri.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,Aa)):a=ZS(a,a.length,s.minDepth,e),new rc(a,Aa,n,i)}addSelection(e,n,i,s){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:Aa;return o.length>0&&n-this.prevTime<s&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&L4e(o[o.length-1],e)?this:new rc(wq(this.done,e),this.undone,n,i)}addMapping(e){return new rc(_A(this.done,e),_A(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,i){let s=e==0?this.done:this.undone;if(s.length==0)return null;let o=s[s.length-1],a=o.selectionsAfter[0]||n.selection;if(i&&o.selectionsAfter.length)return n.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:G3.of({side:e,rest:$4e(s),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let l=s.length==1?Aa:s.slice(0,s.length-1);return o.mapped&&(l=_A(l,o.mapped)),n.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:G3.of({side:e,rest:l,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}rc.empty=new rc(Aa,Aa);const F4e=[{key:"Mod-z",run:bq,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:H3,preventDefault:!0},{linux:"Ctrl-Shift-z",run:H3,preventDefault:!0},{key:"Mod-u",run:I4e,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:N4e,preventDefault:!0}];function v0(r,e){return et.create(r.ranges.map(e),r.mainIndex)}function Oc(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Sl({state:r,dispatch:e},n){let i=v0(r.selection,n);return i.eq(r.selection,!0)?!1:(e(Oc(r,i)),!0)}function Q2(r,e){return et.cursor(e?r.to:r.from)}function _q(r,e){return Sl(r,n=>n.empty?r.moveByChar(n,e):Q2(n,e))}function Ls(r){return r.textDirectionAt(r.state.selection.main.head)==Vn.LTR}const Oq=r=>_q(r,!Ls(r)),Sq=r=>_q(r,Ls(r));function Cq(r,e){return Sl(r,n=>n.empty?r.moveByGroup(n,e):Q2(n,e))}const z4e=r=>Cq(r,!Ls(r)),X4e=r=>Cq(r,Ls(r));function W4e(r,e,n){if(e.type.prop(n))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function j2(r,e,n){let i=Is(r).resolveInner(e.head),s=n?Bi.closedBy:Bi.openedBy;for(let h=e.head;;){let u=n?i.childAfter(h):i.childBefore(h);if(!u)break;W4e(r,u,s)?i=u:h=n?u.to:u.from}let o=i.type.prop(s),a,l;return o&&(a=n?nc(r,i.from,1):nc(r,i.to,-1))&&a.matched?l=n?a.end.to:a.end.from:l=n?i.to:i.from,et.cursor(l,n?-1:1)}const G4e=r=>Sl(r,e=>j2(r.state,e,!Ls(r))),H4e=r=>Sl(r,e=>j2(r.state,e,Ls(r)));function Tq(r,e){return Sl(r,n=>{if(!n.empty)return Q2(n,e);let i=r.moveVertically(n,e);return i.head!=n.head?i:r.moveToLineBoundary(n,e)})}const Eq=r=>Tq(r,!1),Mq=r=>Tq(r,!0);function Aq(r){let e=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,n=0,i=0,s;if(e){for(let o of r.state.facet(St.scrollMargins)){let a=o(r);a!=null&&a.top&&(n=Math.max(a==null?void 0:a.top,n)),a!=null&&a.bottom&&(i=Math.max(a==null?void 0:a.bottom,i))}s=r.scrollDOM.clientHeight-n-i}else s=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:i,selfScroll:e,height:Math.max(r.defaultLineHeight,s-5)}}function kq(r,e){let n=Aq(r),{state:i}=r,s=v0(i.selection,a=>a.empty?r.moveVertically(a,e,n.height):Q2(a,e));if(s.eq(i.selection))return!1;let o;if(n.selfScroll){let a=r.coordsAtPos(i.selection.main.head),l=r.scrollDOM.getBoundingClientRect(),h=l.top+n.marginTop,u=l.bottom-n.marginBottom;a&&a.top>h&&a.bottom<u&&(o=St.scrollIntoView(s.main.head,{y:"start",yMargin:a.top-h}))}return r.dispatch(Oc(i,s),{effects:o}),!0}const OF=r=>kq(r,!1),Q3=r=>kq(r,!0);function _d(r,e,n){let i=r.lineBlockAt(e.head),s=r.moveToLineBoundary(e,n);if(s.head==e.head&&s.head!=(n?i.to:i.from)&&(s=r.moveToLineBoundary(e,n,!1)),!n&&s.head==i.from&&i.length){let o=/^\s*/.exec(r.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;o&&e.head!=i.from+o&&(s=et.cursor(i.from+o))}return s}const Q4e=r=>Sl(r,e=>_d(r,e,!0)),j4e=r=>Sl(r,e=>_d(r,e,!1)),Y4e=r=>Sl(r,e=>_d(r,e,!Ls(r))),q4e=r=>Sl(r,e=>_d(r,e,Ls(r))),Z4e=r=>Sl(r,e=>et.cursor(r.lineBlockAt(e.head).from,1)),K4e=r=>Sl(r,e=>et.cursor(r.lineBlockAt(e.head).to,-1));function J4e(r,e,n){let i=!1,s=v0(r.selection,o=>{let a=nc(r,o.head,-1)||nc(r,o.head,1)||o.head>0&&nc(r,o.head-1,1)||o.head<r.doc.length&&nc(r,o.head+1,-1);if(!a||!a.end)return o;i=!0;let l=a.start.from==o.head?a.end.to:a.end.from;return et.cursor(l)});return i?(e(Oc(r,s)),!0):!1}const e5e=({state:r,dispatch:e})=>J4e(r,e);function Fa(r,e){let n=v0(r.state.selection,i=>{let s=e(i);return et.range(i.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return n.eq(r.state.selection)?!1:(r.dispatch(Oc(r.state,n)),!0)}function Pq(r,e){return Fa(r,n=>r.moveByChar(n,e))}const Rq=r=>Pq(r,!Ls(r)),Iq=r=>Pq(r,Ls(r));function Nq(r,e){return Fa(r,n=>r.moveByGroup(n,e))}const t5e=r=>Nq(r,!Ls(r)),i5e=r=>Nq(r,Ls(r)),n5e=r=>Fa(r,e=>j2(r.state,e,!Ls(r))),r5e=r=>Fa(r,e=>j2(r.state,e,Ls(r)));function Dq(r,e){return Fa(r,n=>r.moveVertically(n,e))}const Lq=r=>Dq(r,!1),Bq=r=>Dq(r,!0);function $q(r,e){return Fa(r,n=>r.moveVertically(n,e,Aq(r).height))}const SF=r=>$q(r,!1),CF=r=>$q(r,!0),s5e=r=>Fa(r,e=>_d(r,e,!0)),o5e=r=>Fa(r,e=>_d(r,e,!1)),a5e=r=>Fa(r,e=>_d(r,e,!Ls(r))),l5e=r=>Fa(r,e=>_d(r,e,Ls(r))),c5e=r=>Fa(r,e=>et.cursor(r.lineBlockAt(e.head).from)),h5e=r=>Fa(r,e=>et.cursor(r.lineBlockAt(e.head).to)),TF=({state:r,dispatch:e})=>(e(Oc(r,{anchor:0})),!0),EF=({state:r,dispatch:e})=>(e(Oc(r,{anchor:r.doc.length})),!0),MF=({state:r,dispatch:e})=>(e(Oc(r,{anchor:r.selection.main.anchor,head:0})),!0),AF=({state:r,dispatch:e})=>(e(Oc(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),u5e=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),d5e=({state:r,dispatch:e})=>{let n=Y2(r).map(({from:i,to:s})=>et.range(i,Math.min(s+1,r.doc.length)));return e(r.update({selection:et.create(n),userEvent:"select"})),!0},f5e=({state:r,dispatch:e})=>{let n=v0(r.selection,i=>{var s;let o=Is(r).resolveStack(i.from,1);for(let a=o;a;a=a.next){let{node:l}=a;if((l.from<i.from&&l.to>=i.to||l.to>i.to&&l.from<=i.from)&&(!((s=l.parent)===null||s===void 0)&&s.parent))return et.range(l.to,l.from)}return i});return e(Oc(r,n)),!0},p5e=({state:r,dispatch:e})=>{let n=r.selection,i=null;return n.ranges.length>1?i=et.create([n.main]):n.main.empty||(i=et.create([et.cursor(n.main.head)])),i?(e(Oc(r,i)),!0):!1};function tx(r,e){if(r.state.readOnly)return!1;let n="delete.selection",{state:i}=r,s=i.changeByRange(o=>{let{from:a,to:l}=o;if(a==l){let h=e(o);h<a?(n="delete.backward",h=V_(r,h,!1)):h>a&&(n="delete.forward",h=V_(r,h,!0)),a=Math.min(a,h),l=Math.max(l,h)}else a=V_(r,a,!1),l=V_(r,l,!0);return a==l?{range:o}:{changes:{from:a,to:l},range:et.cursor(a,a<o.head?-1:1)}});return s.changes.empty?!1:(r.dispatch(i.update(s,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?St.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function V_(r,e,n){if(r instanceof St)for(let i of r.state.facet(St.atomicRanges).map(s=>s(r)))i.between(e,e,(s,o)=>{s<e&&o>e&&(e=n?o:s)});return e}const Uq=(r,e,n)=>tx(r,i=>{let s=i.from,{state:o}=r,a=o.doc.lineAt(s),l,h;if(n&&!e&&s>a.from&&s<a.from+200&&!/[^ \t]/.test(l=a.text.slice(0,s-a.from))){if(l[l.length-1]=="	")return s-1;let u=g0(l,o.tabSize),f=u%jS(o)||jS(o);for(let p=0;p<f&&l[l.length-1-p]==" ";p++)s--;h=s}else h=ys(a.text,s-a.from,e,e)+a.from,h==s&&a.number!=(e?o.doc.lines:1)?h+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(h-a.from,s-a.from))&&(h=ys(a.text,h-a.from,!1,!1)+a.from);return h}),j3=r=>Uq(r,!1,!0),Vq=r=>Uq(r,!0,!1),Fq=(r,e)=>tx(r,n=>{let i=n.head,{state:s}=r,o=s.doc.lineAt(i),a=s.charCategorizer(i);for(let l=null;;){if(i==(e?o.to:o.from)){i==n.head&&o.number!=(e?s.doc.lines:1)&&(i+=e?1:-1);break}let h=ys(o.text,i-o.from,e)+o.from,u=o.text.slice(Math.min(i,h)-o.from,Math.max(i,h)-o.from),f=a(u);if(l!=null&&f!=l)break;(u!=" "||i!=n.head)&&(l=f),i=h}return i}),zq=r=>Fq(r,!1),m5e=r=>Fq(r,!0),g5e=r=>tx(r,e=>{let n=r.lineBlockAt(e.head).to;return e.head<n?n:Math.min(r.state.doc.length,e.head+1)}),v5e=r=>tx(r,e=>{let n=r.moveToLineBoundary(e,!1).head;return e.head>n?n:Math.max(0,e.head-1)}),y5e=r=>tx(r,e=>{let n=r.moveToLineBoundary(e,!0).head;return e.head<n?n:Math.min(r.state.doc.length,e.head+1)}),b5e=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let n=r.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:bn.of(["",""])},range:et.cursor(i.from)}));return e(r.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},x5e=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let n=r.changeByRange(i=>{if(!i.empty||i.from==0||i.from==r.doc.length)return{range:i};let s=i.from,o=r.doc.lineAt(s),a=s==o.from?s-1:ys(o.text,s-o.from,!1)+o.from,l=s==o.to?s+1:ys(o.text,s-o.from,!0)+o.from;return{changes:{from:a,to:l,insert:r.doc.slice(s,l).append(r.doc.slice(a,s))},range:et.cursor(l)}});return n.changes.empty?!1:(e(r.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Y2(r){let e=[],n=-1;for(let i of r.selection.ranges){let s=r.doc.lineAt(i.from),o=r.doc.lineAt(i.to);if(!i.empty&&i.to==o.from&&(o=r.doc.lineAt(i.to-1)),n>=s.number){let a=e[e.length-1];a.to=o.to,a.ranges.push(i)}else e.push({from:s.from,to:o.to,ranges:[i]});n=o.number+1}return e}function Xq(r,e,n){if(r.readOnly)return!1;let i=[],s=[];for(let o of Y2(r)){if(n?o.to==r.doc.length:o.from==0)continue;let a=r.doc.lineAt(n?o.to+1:o.from-1),l=a.length+1;if(n){i.push({from:o.to,to:a.to},{from:o.from,insert:a.text+r.lineBreak});for(let h of o.ranges)s.push(et.range(Math.min(r.doc.length,h.anchor+l),Math.min(r.doc.length,h.head+l)))}else{i.push({from:a.from,to:o.from},{from:o.to,insert:r.lineBreak+a.text});for(let h of o.ranges)s.push(et.range(h.anchor-l,h.head-l))}}return i.length?(e(r.update({changes:i,scrollIntoView:!0,selection:et.create(s,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const w5e=({state:r,dispatch:e})=>Xq(r,e,!1),_5e=({state:r,dispatch:e})=>Xq(r,e,!0);function Wq(r,e,n){if(r.readOnly)return!1;let i=[];for(let s of Y2(r))n?i.push({from:s.from,insert:r.doc.slice(s.from,s.to)+r.lineBreak}):i.push({from:s.to,insert:r.lineBreak+r.doc.slice(s.from,s.to)});return e(r.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const O5e=({state:r,dispatch:e})=>Wq(r,e,!1),S5e=({state:r,dispatch:e})=>Wq(r,e,!0),C5e=r=>{if(r.state.readOnly)return!1;let{state:e}=r,n=e.changes(Y2(e).map(({from:s,to:o})=>(s>0?s--:o<e.doc.length&&o++,{from:s,to:o}))),i=v0(e.selection,s=>{let o;if(r.lineWrapping){let a=r.lineBlockAt(s.head),l=r.coordsAtPos(s.head,s.assoc||1);l&&(o=a.bottom+r.documentTop-l.bottom+r.defaultLineHeight/2)}return r.moveVertically(s,!0,o)}).map(n);return r.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function T5e(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=Is(r).resolveInner(e),i=n.childBefore(e),s=n.childAfter(e),o;return i&&s&&i.to<=e&&s.from>=e&&(o=i.type.prop(Bi.closedBy))&&o.indexOf(s.name)>-1&&r.doc.lineAt(i.to).from==r.doc.lineAt(s.from).from&&!/\S/.test(r.sliceDoc(i.to,s.from))?{from:i.to,to:s.from}:null}const E5e=Gq(!1),M5e=Gq(!0);function Gq(r){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let i=e.changeByRange(s=>{let{from:o,to:a}=s,l=e.doc.lineAt(o),h=!r&&o==a&&T5e(e,o);r&&(o=a=(a<=l.to?l:e.doc.lineAt(a)).to);let u=new X2(e,{simulateBreak:o,simulateDoubleBreak:!!h}),f=T5(u,o);for(f==null&&(f=g0(/^\s*/.exec(e.doc.lineAt(o).text)[0],e.tabSize));a<l.to&&/\s/.test(l.text[a-l.from]);)a++;h?{from:o,to:a}=h:o>l.from&&o<l.from+100&&!/\S/.test(l.text.slice(0,o))&&(o=l.from);let p=["",ab(e,f)];return h&&p.push(ab(e,u.lineIndent(l.from,-1))),{changes:{from:o,to:a,insert:bn.of(p)},range:et.cursor(o+1+p[1].length)}});return n(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function k5(r,e){let n=-1;return r.changeByRange(i=>{let s=[];for(let a=i.from;a<=i.to;){let l=r.doc.lineAt(a);l.number>n&&(i.empty||i.to>l.from)&&(e(l,s,i),n=l.number),a=l.to+1}let o=r.changes(s);return{changes:s,range:et.range(o.mapPos(i.anchor,1),o.mapPos(i.head,1))}})}const A5e=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let n=Object.create(null),i=new X2(r,{overrideIndentation:o=>{let a=n[o];return a??-1}}),s=k5(r,(o,a,l)=>{let h=T5(i,o.from);if(h==null)return;/\S/.test(o.text)||(h=0);let u=/^\s*/.exec(o.text)[0],f=ab(r,h);(u!=f||l.from<o.from+u.length)&&(n[o.from]=h,a.push({from:o.from,to:o.from+u.length,insert:f}))});return s.changes.empty||e(r.update(s,{userEvent:"indent"})),!0},k5e=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(k5(r,(n,i)=>{i.push({from:n.from,insert:r.facet(C5)})}),{userEvent:"input.indent"})),!0),P5e=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(k5(r,(n,i)=>{let s=/^\s*/.exec(n.text)[0];if(!s)return;let o=g0(s,r.tabSize),a=0,l=ab(r,Math.max(0,o-jS(r)));for(;a<s.length&&a<l.length&&s.charCodeAt(a)==l.charCodeAt(a);)a++;i.push({from:n.from+a,to:n.from+s.length,insert:l.slice(a)})}),{userEvent:"delete.dedent"})),!0),R5e=r=>(r.setTabFocusMode(),!0),I5e=[{key:"Ctrl-b",run:Oq,shift:Rq,preventDefault:!0},{key:"Ctrl-f",run:Sq,shift:Iq},{key:"Ctrl-p",run:Eq,shift:Lq},{key:"Ctrl-n",run:Mq,shift:Bq},{key:"Ctrl-a",run:Z4e,shift:c5e},{key:"Ctrl-e",run:K4e,shift:h5e},{key:"Ctrl-d",run:Vq},{key:"Ctrl-h",run:j3},{key:"Ctrl-k",run:g5e},{key:"Ctrl-Alt-h",run:zq},{key:"Ctrl-o",run:b5e},{key:"Ctrl-t",run:x5e},{key:"Ctrl-v",run:Q3}],N5e=[{key:"ArrowLeft",run:Oq,shift:Rq,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:z4e,shift:t5e,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Y4e,shift:a5e,preventDefault:!0},{key:"ArrowRight",run:Sq,shift:Iq,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:X4e,shift:i5e,preventDefault:!0},{mac:"Cmd-ArrowRight",run:q4e,shift:l5e,preventDefault:!0},{key:"ArrowUp",run:Eq,shift:Lq,preventDefault:!0},{mac:"Cmd-ArrowUp",run:TF,shift:MF},{mac:"Ctrl-ArrowUp",run:OF,shift:SF},{key:"ArrowDown",run:Mq,shift:Bq,preventDefault:!0},{mac:"Cmd-ArrowDown",run:EF,shift:AF},{mac:"Ctrl-ArrowDown",run:Q3,shift:CF},{key:"PageUp",run:OF,shift:SF},{key:"PageDown",run:Q3,shift:CF},{key:"Home",run:j4e,shift:o5e,preventDefault:!0},{key:"Mod-Home",run:TF,shift:MF},{key:"End",run:Q4e,shift:s5e,preventDefault:!0},{key:"Mod-End",run:EF,shift:AF},{key:"Enter",run:E5e},{key:"Mod-a",run:u5e},{key:"Backspace",run:j3,shift:j3},{key:"Delete",run:Vq},{key:"Mod-Backspace",mac:"Alt-Backspace",run:zq},{key:"Mod-Delete",mac:"Alt-Delete",run:m5e},{mac:"Mod-Backspace",run:v5e},{mac:"Mod-Delete",run:y5e}].concat(I5e.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),D5e=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:G4e,shift:n5e},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:H4e,shift:r5e},{key:"Alt-ArrowUp",run:w5e},{key:"Shift-Alt-ArrowUp",run:O5e},{key:"Alt-ArrowDown",run:_5e},{key:"Shift-Alt-ArrowDown",run:S5e},{key:"Escape",run:p5e},{key:"Mod-Enter",run:M5e},{key:"Alt-l",mac:"Ctrl-l",run:d5e},{key:"Mod-i",run:f5e,preventDefault:!0},{key:"Mod-[",run:P5e},{key:"Mod-]",run:k5e},{key:"Mod-Alt-\\",run:A5e},{key:"Shift-Mod-k",run:C5e},{key:"Shift-Mod-\\",run:e5e},{key:"Mod-/",run:O4e},{key:"Alt-A",run:C4e},{key:"Ctrl-m",mac:"Shift-Alt-m",run:R5e}].concat(N5e);function Pn(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var s=n[i];typeof s=="string"?r.setAttribute(i,s):s!=null&&(r[i]=s)}e++}for(;e<arguments.length;e++)Hq(r,arguments[e]);return r}function Hq(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)Hq(r,e[n]);else throw new RangeError("Unsupported child node: "+e)}const kF=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class Yg{constructor(e,n,i=0,s=e.length,o,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,s),this.bufferStart=i,this.normalize=o?l=>o(kF(l)):kF,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return us(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=s5(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Ca(e);let s=this.normalize(n);for(let o=0,a=i;;o++){let l=s.charCodeAt(o),h=this.match(l,a,this.bufferPos+this.bufferStart);if(o==s.length-1){if(h)return this.value=h,this;break}a==i&&o<n.length&&n.charCodeAt(o)==l&&a++}}}match(e,n,i){let s=null;for(let o=0;o<this.matches.length;o+=2){let a=this.matches[o],l=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?s={from:this.matches[o+1],to:i}:(this.matches[o]++,l=!0)),l||(this.matches.splice(o,2),o-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?s={from:n,to:i}:this.matches.push(1,n)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferStart)&&(s=null),s}}typeof Symbol<"u"&&(Yg.prototype[Symbol.iterator]=function(){return this});const Qq={from:-1,to:-1,match:/.*/.exec("")},P5="gm"+(/x/.unicode==null?"":"u");class jq{constructor(e,n,i,s=0,o=e.length){if(this.text=e,this.to=o,this.curLine="",this.done=!1,this.value=Qq,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new Yq(e,n,i,s,o);this.re=new RegExp(n,P5+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let a=e.lineAt(s);this.curLineStart=a.from,this.matchPos=KS(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let i=this.curLineStart+n.index,s=i+n[0].length;if(this.matchPos=KS(this.text,s+(i==s?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<s||i>this.value.to)&&(!this.test||this.test(i,s,n)))return this.value={from:i,to:s,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const OA=new WeakMap;class xg{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,i){let s=OA.get(e);if(!s||s.from>=i||s.to<=n){let l=new xg(n,e.sliceString(n,i));return OA.set(e,l),l}if(s.from==n&&s.to==i)return s;let{text:o,from:a}=s;return a>n&&(o=e.sliceString(n,a)+o,a=n),s.to<i&&(o+=e.sliceString(s.to,i)),OA.set(e,new xg(a,o)),new xg(n,o.slice(n-a,i-a))}}class Yq{constructor(e,n,i,s,o){this.text=e,this.to=o,this.done=!1,this.value=Qq,this.matchPos=KS(e,s),this.re=new RegExp(n,P5+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=xg.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let i=this.flat.from+n.index,s=i+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,s,n)))return this.value={from:i,to:s,match:n},this.matchPos=KS(this.text,s+(i==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=xg.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(jq.prototype[Symbol.iterator]=Yq.prototype[Symbol.iterator]=function(){return this});function L5e(r){try{return new RegExp(r,P5),!0}catch{return!1}}function KS(r,e){if(e>=r.length)return e;let n=r.lineAt(e),i;for(;e<n.to&&(i=n.text.charCodeAt(e-n.from))>=56320&&i<57344;)e++;return e}function Y3(r){let e=String(r.state.doc.lineAt(r.state.selection.main.head).number),n=Pn("input",{class:"cm-textfield",name:"line",value:e}),i=Pn("form",{class:"cm-gotoLine",onkeydown:o=>{o.keyCode==27?(o.preventDefault(),r.dispatch({effects:JS.of(!1)}),r.focus()):o.keyCode==13&&(o.preventDefault(),s())},onsubmit:o=>{o.preventDefault(),s()}},Pn("label",r.state.phrase("Go to line"),": ",n)," ",Pn("button",{class:"cm-button",type:"submit"},r.state.phrase("go")));function s(){let o=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!o)return;let{state:a}=r,l=a.doc.lineAt(a.selection.main.head),[,h,u,f,p]=o,m=f?+f.slice(1):0,v=u?+u:l.number;if(u&&p){let w=v/100;h&&(w=w*(h=="-"?-1:1)+l.number/a.doc.lines),v=Math.round(a.doc.lines*w)}else u&&h&&(v=v*(h=="-"?-1:1)+l.number);let y=a.doc.line(Math.max(1,Math.min(a.doc.lines,v))),x=et.cursor(y.from+Math.max(0,Math.min(m,y.length)));r.dispatch({effects:[JS.of(!1),St.scrollIntoView(x.from,{y:"center"})],selection:x}),r.focus()}return{dom:i}}const JS=Ri.define(),PF=ws.define({create(){return!0},update(r,e){for(let n of e.effects)n.is(JS)&&(r=n.value);return r},provide:r=>sb.from(r,e=>e?Y3:null)}),B5e=r=>{let e=rb(r,Y3);if(!e){let n=[JS.of(!0)];r.state.field(PF,!1)==null&&n.push(Ri.appendConfig.of([PF,$5e])),r.dispatch({effects:n}),e=rb(r,Y3)}return e&&e.dom.querySelector("input").select(),!0},$5e=St.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),U5e={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},V5e=Pt.define({combine(r){return _c(r,U5e,{highlightWordAroundCursor:(e,n)=>e||n,minSelectionLength:Math.min,maxMatches:Math.min})}});function F5e(r){return[H5e,G5e]}const z5e=ui.mark({class:"cm-selectionMatch"}),X5e=ui.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function RF(r,e,n,i){return(n==0||r(e.sliceDoc(n-1,n))!=jn.Word)&&(i==e.doc.length||r(e.sliceDoc(i,i+1))!=jn.Word)}function W5e(r,e,n,i){return r(e.sliceDoc(n,n+1))==jn.Word&&r(e.sliceDoc(i-1,i))==jn.Word}const G5e=Pr.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(V5e),{state:n}=r,i=n.selection;if(i.ranges.length>1)return ui.none;let s=i.main,o,a=null;if(s.empty){if(!e.highlightWordAroundCursor)return ui.none;let h=n.wordAt(s.head);if(!h)return ui.none;a=n.charCategorizer(s.head),o=n.sliceDoc(h.from,h.to)}else{let h=s.to-s.from;if(h<e.minSelectionLength||h>200)return ui.none;if(e.wholeWords){if(o=n.sliceDoc(s.from,s.to),a=n.charCategorizer(s.head),!(RF(a,n,s.from,s.to)&&W5e(a,n,s.from,s.to)))return ui.none}else if(o=n.sliceDoc(s.from,s.to),!o)return ui.none}let l=[];for(let h of r.visibleRanges){let u=new Yg(n.doc,o,h.from,h.to);for(;!u.next().done;){let{from:f,to:p}=u.value;if((!a||RF(a,n,f,p))&&(s.empty&&f<=s.from&&p>=s.to?l.push(X5e.range(f,p)):(f>=s.to||p<=s.from)&&l.push(z5e.range(f,p)),l.length>e.maxMatches))return ui.none}}return ui.set(l)}},{decorations:r=>r.decorations}),H5e=St.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Q5e=({state:r,dispatch:e})=>{let{selection:n}=r,i=et.create(n.ranges.map(s=>r.wordAt(s.head)||et.cursor(s.head)),n.mainIndex);return i.eq(n)?!1:(e(r.update({selection:i})),!0)};function j5e(r,e){let{main:n,ranges:i}=r.selection,s=r.wordAt(n.head),o=s&&s.from==n.from&&s.to==n.to;for(let a=!1,l=new Yg(r.doc,e,i[i.length-1].to);;)if(l.next(),l.done){if(a)return null;l=new Yg(r.doc,e,0,Math.max(0,i[i.length-1].from-1)),a=!0}else{if(a&&i.some(h=>h.from==l.value.from))continue;if(o){let h=r.wordAt(l.value.from);if(!h||h.from!=l.value.from||h.to!=l.value.to)continue}return l.value}}const Y5e=({state:r,dispatch:e})=>{let{ranges:n}=r.selection;if(n.some(o=>o.from===o.to))return Q5e({state:r,dispatch:e});let i=r.sliceDoc(n[0].from,n[0].to);if(r.selection.ranges.some(o=>r.sliceDoc(o.from,o.to)!=i))return!1;let s=j5e(r,i);return s?(e(r.update({selection:r.selection.addRange(et.range(s.from,s.to),!1),effects:St.scrollIntoView(s.to)})),!0):!1},y0=Pt.define({combine(r){return _c(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new aNe(e),scrollToMatch:e=>St.scrollIntoView(e)})}});class qq{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||L5e(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new J5e(this):new Z5e(this)}getCursor(e,n=0,i){let s=e.doc?e:an.create({doc:e});return i==null&&(i=s.doc.length),this.regexp?$m(this,s,n,i):Bm(this,s,n,i)}}class Zq{constructor(e){this.spec=e}}function Bm(r,e,n,i){return new Yg(e.doc,r.unquoted,n,i,r.caseSensitive?void 0:s=>s.toLowerCase(),r.wholeWord?q5e(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function q5e(r,e){return(n,i,s,o)=>((o>n||o+s.length<i)&&(o=Math.max(0,n-2),s=r.sliceString(o,Math.min(r.length,i+2))),(e(eC(s,n-o))!=jn.Word||e(tC(s,n-o))!=jn.Word)&&(e(tC(s,i-o))!=jn.Word||e(eC(s,i-o))!=jn.Word))}class Z5e extends Zq{constructor(e){super(e)}nextMatch(e,n,i){let s=Bm(this.spec,e,i,e.doc.length).nextOverlapping();return s.done&&(s=Bm(this.spec,e,0,n).nextOverlapping()),s.done?null:s.value}prevMatchInRange(e,n,i){for(let s=i;;){let o=Math.max(n,s-1e4-this.spec.unquoted.length),a=Bm(this.spec,e,o,s),l=null;for(;!a.nextOverlapping().done;)l=a.value;if(l)return l;if(o==n)return null;s-=1e4}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let i=Bm(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=n)return null;s.push(i.value)}return s}highlight(e,n,i,s){let o=Bm(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!o.next().done;)s(o.value.from,o.value.to)}}function $m(r,e,n,i){return new jq(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?K5e(e.charCategorizer(e.selection.main.head)):void 0},n,i)}function eC(r,e){return r.slice(ys(r,e,!1),e)}function tC(r,e){return r.slice(e,ys(r,e))}function K5e(r){return(e,n,i)=>!i[0].length||(r(eC(i.input,i.index))!=jn.Word||r(tC(i.input,i.index))!=jn.Word)&&(r(tC(i.input,i.index+i[0].length))!=jn.Word||r(eC(i.input,i.index+i[0].length))!=jn.Word)}class J5e extends Zq{nextMatch(e,n,i){let s=$m(this.spec,e,i,e.doc.length).next();return s.done&&(s=$m(this.spec,e,0,n).next()),s.done?null:s.value}prevMatchInRange(e,n,i){for(let s=1;;s++){let o=Math.max(n,i-s*1e4),a=$m(this.spec,e,o,i),l=null;for(;!a.next().done;)l=a.value;if(l&&(o==n||l.from>o+10))return l;if(o==n)return null}}prevMatch(e,n,i){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(n,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:n)}matchAll(e,n){let i=$m(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=n)return null;s.push(i.value)}return s}highlight(e,n,i,s){let o=$m(this.spec,e,Math.max(0,n-250),Math.min(i+250,e.doc.length));for(;!o.next().done;)s(o.value.from,o.value.to)}}const lb=Ri.define(),R5=Ri.define(),Yu=ws.define({create(r){return new SA(q3(r).create(),null)},update(r,e){for(let n of e.effects)n.is(lb)?r=new SA(n.value.create(),r.panel):n.is(R5)&&(r=new SA(r.query,n.value?I5:null));return r},provide:r=>sb.from(r,e=>e.panel)});class SA{constructor(e,n){this.query=e,this.panel=n}}const eNe=ui.mark({class:"cm-searchMatch"}),tNe=ui.mark({class:"cm-searchMatch cm-searchMatch-selected"}),iNe=Pr.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(Yu))}update(r){let e=r.state.field(Yu);(e!=r.startState.field(Yu)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return ui.none;let{view:n}=this,i=new ad;for(let s=0,o=n.visibleRanges,a=o.length;s<a;s++){let{from:l,to:h}=o[s];for(;s<a-1&&h>o[s+1].from-2*250;)h=o[++s].to;r.highlight(n.state,l,h,(u,f)=>{let p=n.state.selection.ranges.some(m=>m.from==u&&m.to==f);i.add(u,f,p?tNe:eNe)})}return i.finish()}},{decorations:r=>r.decorations});function ix(r){return e=>{let n=e.state.field(Yu,!1);return n&&n.query.spec.valid?r(e,n):eZ(e)}}const iC=ix((r,{query:e})=>{let{to:n}=r.state.selection.main,i=e.nextMatch(r.state,n,n);if(!i)return!1;let s=et.single(i.from,i.to),o=r.state.facet(y0);return r.dispatch({selection:s,effects:[N5(r,i),o.scrollToMatch(s.main,r)],userEvent:"select.search"}),Jq(r),!0}),nC=ix((r,{query:e})=>{let{state:n}=r,{from:i}=n.selection.main,s=e.prevMatch(n,i,i);if(!s)return!1;let o=et.single(s.from,s.to),a=r.state.facet(y0);return r.dispatch({selection:o,effects:[N5(r,s),a.scrollToMatch(o.main,r)],userEvent:"select.search"}),Jq(r),!0}),nNe=ix((r,{query:e})=>{let n=e.matchAll(r.state,1e3);return!n||!n.length?!1:(r.dispatch({selection:et.create(n.map(i=>et.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),rNe=({state:r,dispatch:e})=>{let n=r.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:i,to:s}=n.main,o=[],a=0;for(let l=new Yg(r.doc,r.sliceDoc(i,s));!l.next().done;){if(o.length>1e3)return!1;l.value.from==i&&(a=o.length),o.push(et.range(l.value.from,l.value.to))}return e(r.update({selection:et.create(o,a),userEvent:"select.search.matches"})),!0},IF=ix((r,{query:e})=>{let{state:n}=r,{from:i,to:s}=n.selection.main;if(n.readOnly)return!1;let o=e.nextMatch(n,i,i);if(!o)return!1;let a=[],l,h,u=[];if(o.from==i&&o.to==s&&(h=n.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:h}),o=e.nextMatch(n,o.from,o.to),u.push(St.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(i).number)+"."))),o){let f=a.length==0||a[0].from>=o.to?0:o.to-o.from-h.length;l=et.single(o.from-f,o.to-f),u.push(N5(r,o)),u.push(n.facet(y0).scrollToMatch(l.main,r))}return r.dispatch({changes:a,selection:l,effects:u,userEvent:"input.replace"}),!0}),sNe=ix((r,{query:e})=>{if(r.state.readOnly)return!1;let n=e.matchAll(r.state,1e9).map(s=>{let{from:o,to:a}=s;return{from:o,to:a,insert:e.getReplacement(s)}});if(!n.length)return!1;let i=r.state.phrase("replaced $ matches",n.length)+".";return r.dispatch({changes:n,effects:St.announce.of(i),userEvent:"input.replace.all"}),!0});function I5(r){return r.state.facet(y0).createPanel(r)}function q3(r,e){var n,i,s,o,a;let l=r.selection.main,h=l.empty||l.to>l.from+100?"":r.sliceDoc(l.from,l.to);if(e&&!h)return e;let u=r.facet(y0);return new qq({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:u.literal)?h:h.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:u.caseSensitive,literal:(s=e==null?void 0:e.literal)!==null&&s!==void 0?s:u.literal,regexp:(o=e==null?void 0:e.regexp)!==null&&o!==void 0?o:u.regexp,wholeWord:(a=e==null?void 0:e.wholeWord)!==null&&a!==void 0?a:u.wholeWord})}function Kq(r){let e=rb(r,I5);return e&&e.dom.querySelector("[main-field]")}function Jq(r){let e=Kq(r);e&&e==r.root.activeElement&&e.select()}const eZ=r=>{let e=r.state.field(Yu,!1);if(e&&e.panel){let n=Kq(r);if(n&&n!=r.root.activeElement){let i=q3(r.state,e.query.spec);i.valid&&r.dispatch({effects:lb.of(i)}),n.focus(),n.select()}}else r.dispatch({effects:[R5.of(!0),e?lb.of(q3(r.state,e.query.spec)):Ri.appendConfig.of(cNe)]});return!0},tZ=r=>{let e=r.state.field(Yu,!1);if(!e||!e.panel)return!1;let n=rb(r,I5);return n&&n.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:R5.of(!1)}),!0},oNe=[{key:"Mod-f",run:eZ,scope:"editor search-panel"},{key:"F3",run:iC,shift:nC,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:iC,shift:nC,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:tZ,scope:"editor search-panel"},{key:"Mod-Shift-l",run:rNe},{key:"Mod-Alt-g",run:B5e},{key:"Mod-d",run:Y5e,preventDefault:!0}];class aNe{constructor(e){this.view=e;let n=this.query=e.state.field(Yu).query.spec;this.commit=this.commit.bind(this),this.searchField=Pn("input",{value:n.search,placeholder:Xo(e,"Find"),"aria-label":Xo(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Pn("input",{value:n.replace,placeholder:Xo(e,"Replace"),"aria-label":Xo(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Pn("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=Pn("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=Pn("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function i(s,o,a){return Pn("button",{class:"cm-button",name:s,onclick:o,type:"button"},a)}this.dom=Pn("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,i("next",()=>iC(e),[Xo(e,"next")]),i("prev",()=>nC(e),[Xo(e,"previous")]),i("select",()=>nNe(e),[Xo(e,"all")]),Pn("label",null,[this.caseField,Xo(e,"match case")]),Pn("label",null,[this.reField,Xo(e,"regexp")]),Pn("label",null,[this.wordField,Xo(e,"by word")]),...e.state.readOnly?[]:[Pn("br"),this.replaceField,i("replace",()=>IF(e),[Xo(e,"replace")]),i("replaceAll",()=>sNe(e),[Xo(e,"replace all")])],Pn("button",{name:"close",onclick:()=>tZ(e),"aria-label":Xo(e,"close"),type:"button"},["×"])])}commit(){let e=new qq({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:lb.of(e)}))}keydown(e){fRe(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?nC:iC)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),IF(this.view))}update(e){for(let n of e.transactions)for(let i of n.effects)i.is(lb)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(y0).top}}function Xo(r,e){return r.state.phrase(e)}const F_=30,z_=/[\s\.,:;?!]/;function N5(r,{from:e,to:n}){let i=r.state.doc.lineAt(e),s=r.state.doc.lineAt(n).to,o=Math.max(i.from,e-F_),a=Math.min(s,n+F_),l=r.state.sliceDoc(o,a);if(o!=i.from){for(let h=0;h<F_;h++)if(!z_.test(l[h+1])&&z_.test(l[h])){l=l.slice(h);break}}if(a!=s){for(let h=l.length-1;h>l.length-F_;h--)if(!z_.test(l[h-1])&&z_.test(l[h])){l=l.slice(0,h);break}}return St.announce.of(`${r.state.phrase("current match")}. ${l} ${r.state.phrase("on line")} ${i.number}.`)}const lNe=St.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),cNe=[Yu,kp.low(iNe),lNe];class iZ{constructor(e,n,i,s){this.state=e,this.pos=n,this.explicit=i,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let n=Is(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),i=Math.max(n.from,this.pos-250),s=n.text.slice(i-n.from,this.pos-n.from),o=s.search(nZ(e,!1));return o<0?null:{from:i+o,to:this.pos,text:s.slice(o)}}get aborted(){return this.abortListeners==null}addEventListener(e,n,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(n),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function NF(r){let e=Object.keys(r).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function hNe(r){let e=Object.create(null),n=Object.create(null);for(let{label:s}of r){e[s[0]]=!0;for(let o=1;o<s.length;o++)n[s[o]]=!0}let i=NF(e)+NF(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function uNe(r){let e=r.map(s=>typeof s=="string"?{label:s}:s),[n,i]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:hNe(e);return s=>{let o=s.matchBefore(i);return o||s.explicit?{from:o?o.from:s.pos,options:e,validFor:n}:null}}class DF{constructor(e,n,i,s){this.completion=e,this.source=n,this.match=i,this.score=s}}function qu(r){return r.selection.main.from}function nZ(r,e){var n;let{source:i}=r,s=e&&i[0]!="^",o=i[i.length-1]!="$";return!s&&!o?r:new RegExp(`${s?"^":""}(?:${i})${o?"$":""}`,(n=r.flags)!==null&&n!==void 0?n:r.ignoreCase?"i":"")}const rZ=Nh.define();function dNe(r,e,n,i){let{main:s}=r.selection,o=n-s.from,a=i-s.from;return Object.assign(Object.assign({},r.changeByRange(l=>l!=s&&n!=i&&r.sliceDoc(l.from+o,l.from+a)!=r.sliceDoc(n,i)?{range:l}:{changes:{from:l.from+o,to:i==s.from?l.to:l.from+a,insert:e},range:et.cursor(l.from+o+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const LF=new WeakMap;function fNe(r){if(!Array.isArray(r))return r;let e=LF.get(r);return e||LF.set(r,e=uNe(r)),e}const rC=Ri.define(),cb=Ri.define();class pNe{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let i=us(e,n),s=Ca(i);this.chars.push(i);let o=e.slice(n,n+s),a=o.toUpperCase();this.folded.push(us(a==o?o.toLowerCase():a,0)),n+=s}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:i,any:s,precise:o,byWord:a}=this;if(n.length==1){let O=us(e,0),_=Ca(O),T=_==e.length?0:-100;if(O!=n[0])if(O==i[0])T+=-200;else return null;return this.ret(T,[0,_])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let h=n.length,u=0;if(l<0){for(let O=0,_=Math.min(e.length,200);O<_&&u<h;){let T=us(e,O);(T==n[u]||T==i[u])&&(s[u++]=O),O+=Ca(T)}if(u<h)return null}let f=0,p=0,m=!1,v=0,y=-1,x=-1,w=/[a-z]/.test(e),S=!0;for(let O=0,_=Math.min(e.length,200),T=0;O<_&&p<h;){let A=us(e,O);l<0&&(f<h&&A==n[f]&&(o[f++]=O),v<h&&(A==n[v]||A==i[v]?(v==0&&(y=O),x=O+1,v++):v=0));let P,N=A<255?A>=48&&A<=57||A>=97&&A<=122?2:A>=65&&A<=90?1:0:(P=s5(A))!=P.toLowerCase()?1:P!=P.toUpperCase()?2:0;(!O||N==1&&w||T==0&&N!=0)&&(n[p]==A||i[p]==A&&(m=!0)?a[p++]=O:a.length&&(S=!1)),T=N,O+=Ca(A)}return p==h&&a[0]==0&&S?this.result(-100+(m?-200:0),a,e):v==h&&y==0?this.ret(-200-e.length+(x==e.length?0:-100),[0,x]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):v==h?this.ret(-900-e.length,[y,x]):p==h?this.result(-100+(m?-200:0)+-700+(S?0:-1100),a,e):n.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,n,i){let s=[],o=0;for(let a of n){let l=a+(this.astral?Ca(us(i,a)):1);o&&s[o-1]==a?s[o-1]=l:(s[o++]=a,s[o++]=l)}return this.ret(e-i.length,s)}}class mNe{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),i=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,n.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const ps=Pt.define({combine(r){return _c(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:gNe,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>i=>BF(e(i),n(i)),optionClass:(e,n)=>i=>BF(e(i),n(i)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function BF(r,e){return r?e?r+" "+e:r:e}function gNe(r,e,n,i,s,o){let a=r.textDirection==Vn.RTL,l=a,h=!1,u="top",f,p,m=e.left-s.left,v=s.right-e.right,y=i.right-i.left,x=i.bottom-i.top;if(l&&m<Math.min(y,v)?l=!1:!l&&v<Math.min(y,m)&&(l=!0),y<=(l?m:v))f=Math.max(s.top,Math.min(n.top,s.bottom-x))-e.top,p=Math.min(400,l?m:v);else{h=!0,p=Math.min(400,(a?e.right:s.right-e.left)-30);let O=s.bottom-e.bottom;O>=x||O>e.top?f=n.bottom-e.top:(u="bottom",f=e.bottom-n.top)}let w=(e.bottom-e.top)/o.offsetHeight,S=(e.right-e.left)/o.offsetWidth;return{style:`${u}: ${f/w}px; max-width: ${p/S}px`,class:"cm-completionInfo-"+(h?a?"left-narrow":"right-narrow":l?"left":"right")}}function vNe(r){let e=r.addToOptions.slice();return r.icons&&e.push({render(n){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),n.type&&i.classList.add(...n.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(n,i,s,o){let a=document.createElement("span");a.className="cm-completionLabel";let l=n.displayLabel||n.label,h=0;for(let u=0;u<o.length;){let f=o[u++],p=o[u++];f>h&&a.appendChild(document.createTextNode(l.slice(h,f)));let m=a.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(l.slice(f,p))),m.className="cm-completionMatchedText",h=p}return h<l.length&&a.appendChild(document.createTextNode(l.slice(h))),a},position:50},{render(n){if(!n.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=n.detail,i},position:80}),e.sort((n,i)=>n.position-i.position).map(n=>n.render)}function CA(r,e,n){if(r<=n)return{from:0,to:r};if(e<0&&(e=0),e<=r>>1){let s=Math.floor(e/n);return{from:s*n,to:(s+1)*n}}let i=Math.floor((r-e)/n);return{from:r-(i+1)*n,to:r-i*n}}class yNe{constructor(e,n,i){this.view=e,this.stateField=n,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:h=>this.placeInfo(h),key:this},this.space=null,this.currentClass="";let s=e.state.field(n),{options:o,selected:a}=s.open,l=e.state.facet(ps);this.optionContent=vNe(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=CA(o.length,a,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",h=>{let{options:u}=e.state.field(n).open;for(let f=h.target,p;f&&f!=this.dom;f=f.parentNode)if(f.nodeName=="LI"&&(p=/-(\d+)$/.exec(f.id))&&+p[1]<u.length){this.applyCompletion(e,u[+p[1]]),h.preventDefault();return}}),this.dom.addEventListener("focusout",h=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(ps).closeOnBlur&&h.relatedTarget!=e.contentDOM&&e.dispatch({effects:cb.of(null)})}),this.showOptions(o,s.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let i=e.state.field(this.stateField),s=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=s){let{options:o,selected:a,disabled:l}=i.open;(!s.open||s.open.options!=o)&&(this.range=CA(o.length,a,e.state.facet(ps).maxRenderedOptions),this.showOptions(o,i.id)),this.updateSel(),l!=((n=s.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of n.split(" "))i&&this.dom.classList.add(i);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=CA(n.options.length,n.selected,this.view.state.facet(ps).maxRenderedOptions),this.showOptions(n.options,e.id)),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:i}=n.options[n.selected],{info:s}=i;if(!s)return;let o=typeof s=="string"?document.createTextNode(s):s(i);if(!o)return;"then"in o?o.then(a=>{a&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(a,i)}).catch(a=>So(this.view.state,a,"completion info")):this.addInfoPane(o,i)}}addInfoPane(e,n){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:s,destroy:o}=e;i.appendChild(s),this.infoDestroy=o||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let i=this.list.firstChild,s=this.range.from;i;i=i.nextSibling,s++)i.nodeName!="LI"||!i.id?s--:s==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),n=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return n&&xNe(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),o=this.space;if(!o){let a=this.dom.ownerDocument.defaultView||window;o={left:0,top:0,right:a.innerWidth,bottom:a.innerHeight}}return s.top>Math.min(o.bottom,n.bottom)-10||s.bottom<Math.max(o.top,n.top)+10?null:this.view.state.facet(ps).positionInfo(this.view,n,s,i,o,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,i){const s=document.createElement("ul");s.id=n,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions"));let o=null;for(let a=i.from;a<i.to;a++){let{completion:l,match:h}=e[a],{section:u}=l;if(u){let m=typeof u=="string"?u:u.name;if(m!=o&&(a>i.from||i.from==0))if(o=m,typeof u!="string"&&u.header)s.appendChild(u.header(u));else{let v=s.appendChild(document.createElement("completion-section"));v.textContent=m}}const f=s.appendChild(document.createElement("li"));f.id=n+"-"+a,f.setAttribute("role","option");let p=this.optionClass(l);p&&(f.className=p);for(let m of this.optionContent){let v=m(l,this.view.state,this.view,h);v&&f.appendChild(v)}}return i.from&&s.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function bNe(r,e){return n=>new yNe(n,r,e)}function xNe(r,e){let n=r.getBoundingClientRect(),i=e.getBoundingClientRect(),s=n.height/r.offsetHeight;i.top<n.top?r.scrollTop-=(n.top-i.top)/s:i.bottom>n.bottom&&(r.scrollTop+=(i.bottom-n.bottom)/s)}function $F(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function wNe(r,e){let n=[],i=null,s=u=>{n.push(u);let{section:f}=u.completion;if(f){i||(i=[]);let p=typeof f=="string"?f:f.name;i.some(m=>m.name==p)||i.push(typeof f=="string"?{name:p}:f)}},o=e.facet(ps);for(let u of r)if(u.hasResult()){let f=u.result.getMatch;if(u.result.filter===!1)for(let p of u.result.options)s(new DF(p,u.source,f?f(p):[],1e9-n.length));else{let p=e.sliceDoc(u.from,u.to),m,v=o.filterStrict?new mNe(p):new pNe(p);for(let y of u.result.options)if(m=v.match(y.label)){let x=y.displayLabel?f?f(y,m.matched):[]:m.matched;s(new DF(y,u.source,x,m.score+(y.boost||0)))}}}if(i){let u=Object.create(null),f=0,p=(m,v)=>{var y,x;return((y=m.rank)!==null&&y!==void 0?y:1e9)-((x=v.rank)!==null&&x!==void 0?x:1e9)||(m.name<v.name?-1:1)};for(let m of i.sort(p))f-=1e5,u[m.name]=f;for(let m of n){let{section:v}=m.completion;v&&(m.score+=u[typeof v=="string"?v:v.name])}}let a=[],l=null,h=o.compareCompletions;for(let u of n.sort((f,p)=>p.score-f.score||h(f.completion,p.completion))){let f=u.completion;!l||l.label!=f.label||l.detail!=f.detail||l.type!=null&&f.type!=null&&l.type!=f.type||l.apply!=f.apply||l.boost!=f.boost?a.push(u):$F(u.completion)>$F(l)&&(a[a.length-1]=u),l=u.completion}return a}class Km{constructor(e,n,i,s,o,a){this.options=e,this.attrs=n,this.tooltip=i,this.timestamp=s,this.selected=o,this.disabled=a}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new Km(this.options,UF(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,i,s,o){let a=wNe(e,n);if(!a.length)return s&&e.some(h=>h.state==1)?new Km(s.options,s.attrs,s.tooltip,s.timestamp,s.selected,!0):null;let l=n.facet(ps).selectOnOpen?0:-1;if(s&&s.selected!=l&&s.selected!=-1){let h=s.options[s.selected].completion;for(let u=0;u<a.length;u++)if(a[u].completion==h){l=u;break}}return new Km(a,UF(i,l),{pos:e.reduce((h,u)=>u.hasResult()?Math.min(h,u.from):h,1e8),create:ENe,above:o.aboveCursor},s?s.timestamp:Date.now(),l,!1)}map(e){return new Km(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class sC{constructor(e,n,i){this.active=e,this.id=n,this.open=i}static start(){return new sC(CNe,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,i=n.facet(ps),o=(i.override||n.languageDataAt("autocomplete",qu(n)).map(fNe)).map(l=>(this.active.find(u=>u.source==l)||new Zo(l,this.active.some(u=>u.state!=0)?1:0)).update(e,i));o.length==this.active.length&&o.every((l,h)=>l==this.active[h])&&(o=this.active);let a=this.open;a&&e.docChanged&&(a=a.map(e.changes)),e.selection||o.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!_Ne(o,this.active)?a=Km.build(o,n,this.id,a,i):a&&a.disabled&&!o.some(l=>l.state==1)&&(a=null),!a&&o.every(l=>l.state!=1)&&o.some(l=>l.hasResult())&&(o=o.map(l=>l.hasResult()?new Zo(l.source,0):l));for(let l of e.effects)l.is(aZ)&&(a=a&&a.setSelected(l.value,this.id));return o==this.active&&a==this.open?this:new sC(o,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?ONe:SNe}}function _Ne(r,e){if(r==e)return!0;for(let n=0,i=0;;){for(;n<r.length&&!r[n].hasResult;)n++;for(;i<e.length&&!e[i].hasResult;)i++;let s=n==r.length,o=i==e.length;if(s||o)return s==o;if(r[n++].result!=e[i++].result)return!1}}const ONe={"aria-autocomplete":"list"},SNe={};function UF(r,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return e>-1&&(n["aria-activedescendant"]=r+"-"+e),n}const CNe=[];function sZ(r,e){if(r.isUserEvent("input.complete")){let i=r.annotation(rZ);if(i&&e.activateOnCompletion(i))return 12}let n=r.isUserEvent("input.type");return n&&e.activateOnTyping?5:n?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}class Zo{constructor(e,n,i=-1){this.source=e,this.state=n,this.explicitPos=i}hasResult(){return!1}update(e,n){let i=sZ(e,n),s=this;(i&8||i&16&&this.touches(e))&&(s=new Zo(s.source,0)),i&4&&s.state==0&&(s=new Zo(this.source,1)),s=s.updateFor(e,i);for(let o of e.effects)if(o.is(rC))s=new Zo(s.source,1,o.value?qu(e.state):-1);else if(o.is(cb))s=new Zo(s.source,0);else if(o.is(oZ))for(let a of o.value)a.source==s.source&&(s=a);return s}updateFor(e,n){return this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new Zo(this.source,this.state,e.mapPos(this.explicitPos))}touches(e){return e.changes.touchesRange(qu(e.state))}}class wg extends Zo{constructor(e,n,i,s,o){super(e,2,n),this.result=i,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,n){var i;if(!(n&3))return this.map(e.changes);let s=this.result;s.map&&!e.changes.empty&&(s=s.map(s,e.changes));let o=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),l=qu(e.state);if((this.explicitPos<0?l<=o:l<this.from)||l>a||!s||n&2&&qu(e.startState)==this.from)return new Zo(this.source,n&4?1:0);let h=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return TNe(s.validFor,e.state,o,a)?new wg(this.source,h,s,o,a):s.update&&(s=s.update(s,o,a,new iZ(e.state,l,h>=0)))?new wg(this.source,h,s,s.from,(i=s.to)!==null&&i!==void 0?i:qu(e.state)):new Zo(this.source,1,h)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new wg(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Zo(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function TNe(r,e,n,i){if(!r)return!1;let s=e.sliceDoc(n,i);return typeof r=="function"?r(s,n,i,e):nZ(r,!0).test(s)}const oZ=Ri.define({map(r,e){return r.map(n=>n.map(e))}}),aZ=Ri.define(),yo=ws.define({create(){return sC.start()},update(r,e){return r.update(e)},provide:r=>[x5.from(r,e=>e.tooltip),St.contentAttributes.from(r,e=>e.attrs)]});function D5(r,e){const n=e.completion.apply||e.completion.label;let i=r.state.field(yo).active.find(s=>s.source==e.source);return i instanceof wg?(typeof n=="string"?r.dispatch(Object.assign(Object.assign({},dNe(r.state,n,i.from,i.to)),{annotations:rZ.of(e.completion)})):n(r,e.completion,i.from,i.to),!0):!1}const ENe=bNe(yo,D5);function X_(r,e="option"){return n=>{let i=n.state.field(yo,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(ps).interactionDelay)return!1;let s=1,o;e=="page"&&(o=zY(n,i.open.tooltip))&&(s=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:a}=i.open.options,l=i.open.selected>-1?i.open.selected+s*(r?1:-1):r?0:a-1;return l<0?l=e=="page"?0:a-1:l>=a&&(l=e=="page"?a-1:0),n.dispatch({effects:aZ.of(l)}),!0}}const MNe=r=>{let e=r.state.field(yo,!1);return r.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<r.state.facet(ps).interactionDelay?!1:D5(r,e.open.options[e.open.selected])},ANe=r=>r.state.field(yo,!1)?(r.dispatch({effects:rC.of(!0)}),!0):!1,kNe=r=>{let e=r.state.field(yo,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(r.dispatch({effects:cb.of(null)}),!0)};class PNe{constructor(e,n){this.active=e,this.context=n,this.time=Date.now(),this.updates=[],this.done=void 0}}const RNe=50,INe=1e3,NNe=Pr.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of r.state.field(yo).active)e.state==1&&this.startQuery(e)}update(r){let e=r.state.field(yo),n=r.state.facet(ps);if(!r.selectionSet&&!r.docChanged&&r.startState.field(yo)==e)return;let i=r.transactions.some(o=>{let a=sZ(o,n);return a&8||(o.selection||o.docChanged)&&!(a&3)});for(let o=0;o<this.running.length;o++){let a=this.running[o];if(i||a.context.abortOnDocChange&&r.docChanged||a.updates.length+r.transactions.length>RNe&&Date.now()-a.time>INe){for(let l of a.context.abortListeners)try{l()}catch(h){So(this.view.state,h)}a.context.abortListeners=null,this.running.splice(o--,1)}else a.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(o=>o.effects.some(a=>a.is(rC)))&&(this.pendingStart=!0);let s=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(o=>o.state==1&&!this.running.some(a=>a.active.source==o.source))?setTimeout(()=>this.startUpdate(),s):-1,this.composing!=0)for(let o of r.transactions)o.isUserEvent("input.type")?this.composing=2:this.composing==2&&o.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,e=r.field(yo);for(let n of e.active)n.state==1&&!this.running.some(i=>i.active.source==n.source)&&this.startQuery(n)}startQuery(r){let{state:e}=this.view,n=qu(e),i=new iZ(e,n,r.explicitPos==n,this.view),s=new PNe(r,i);this.running.push(s),Promise.resolve(r.source(i)).then(o=>{s.context.aborted||(s.done=o||null,this.scheduleAccept())},o=>{this.view.dispatch({effects:cb.of(null)}),So(this.view.state,o)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(ps).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],n=this.view.state.facet(ps);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let a=new wg(s.active.source,s.active.explicitPos,s.done,s.done.from,(r=s.done.to)!==null&&r!==void 0?r:qu(s.updates.length?s.updates[0].startState:this.view.state));for(let l of s.updates)a=a.update(l,n);if(a.hasResult()){e.push(a);continue}}let o=this.view.state.field(yo).active.find(a=>a.source==s.active.source);if(o&&o.state==1)if(s.done==null){let a=new Zo(s.active.source,0);for(let l of s.updates)a=a.update(l,n);a.state!=1&&e.push(a)}else this.startQuery(o)}e.length&&this.view.dispatch({effects:oZ.of(e)})}},{eventHandlers:{blur(r){let e=this.view.state.field(yo,!1);if(e&&e.tooltip&&this.view.state.facet(ps).closeOnBlur){let n=e.open&&zY(this.view,e.open.tooltip);(!n||!n.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:cb.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:rC.of(!1)}),20),this.composing=0}}}),DNe=typeof navigator=="object"&&/Win/.test(navigator.platform),LNe=kp.highest(St.domEventHandlers({keydown(r,e){let n=e.state.field(yo,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||r.key.length>1||r.ctrlKey&&!(DNe&&r.altKey)||r.metaKey)return!1;let i=n.open.options[n.open.selected],s=n.active.find(a=>a.source==i.source),o=i.completion.commitCharacters||s.result.commitCharacters;return o&&o.indexOf(r.key)>-1&&D5(e,i),!1}})),BNe=St.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),hb={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Pf=Ri.define({map(r,e){let n=e.mapPos(r,-1,Ys.TrackAfter);return n??void 0}}),L5=new class extends cp{};L5.startSide=1;L5.endSide=-1;const lZ=ws.define({create(){return sn.empty},update(r,e){if(r=r.map(e.changes),e.selection){let n=e.state.doc.lineAt(e.selection.main.head);r=r.update({filter:i=>i>=n.from&&i<=n.to})}for(let n of e.effects)n.is(Pf)&&(r=r.update({add:[L5.range(n.value,n.value+1)]}));return r}});function $Ne(){return[VNe,lZ]}const TA="()[]{}<>";function cZ(r){for(let e=0;e<TA.length;e+=2)if(TA.charCodeAt(e)==r)return TA.charAt(e+1);return s5(r<128?r:r+1)}function hZ(r,e){return r.languageDataAt("closeBrackets",e)[0]||hb}const UNe=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),VNe=St.inputHandler.of((r,e,n,i)=>{if((UNe?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let s=r.state.selection.main;if(i.length>2||i.length==2&&Ca(us(i,0))==1||e!=s.from||n!=s.to)return!1;let o=XNe(r.state,i);return o?(r.dispatch(o),!0):!1}),FNe=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let i=hZ(r,r.selection.main.head).brackets||hb.brackets,s=null,o=r.changeByRange(a=>{if(a.empty){let l=WNe(r.doc,a.head);for(let h of i)if(h==l&&q2(r.doc,a.head)==cZ(us(h,0)))return{changes:{from:a.head-h.length,to:a.head+h.length},range:et.cursor(a.head-h.length)}}return{range:s=a}});return s||e(r.update(o,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},zNe=[{key:"Backspace",run:FNe}];function XNe(r,e){let n=hZ(r,r.selection.main.head),i=n.brackets||hb.brackets;for(let s of i){let o=cZ(us(s,0));if(e==s)return o==s?QNe(r,s,i.indexOf(s+s+s)>-1,n):GNe(r,s,o,n.before||hb.before);if(e==o&&uZ(r,r.selection.main.from))return HNe(r,s,o)}return null}function uZ(r,e){let n=!1;return r.field(lZ).between(0,r.doc.length,i=>{i==e&&(n=!0)}),n}function q2(r,e){let n=r.sliceString(e,e+2);return n.slice(0,Ca(us(n,0)))}function WNe(r,e){let n=r.sliceString(e-2,e);return Ca(us(n,0))==n.length?n:n.slice(1)}function GNe(r,e,n,i){let s=null,o=r.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:n,from:a.to}],effects:Pf.of(a.to+e.length),range:et.range(a.anchor+e.length,a.head+e.length)};let l=q2(r.doc,a.head);return!l||/\s/.test(l)||i.indexOf(l)>-1?{changes:{insert:e+n,from:a.head},effects:Pf.of(a.head+e.length),range:et.cursor(a.head+e.length)}:{range:s=a}});return s?null:r.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function HNe(r,e,n){let i=null,s=r.changeByRange(o=>o.empty&&q2(r.doc,o.head)==n?{changes:{from:o.head,to:o.head+n.length,insert:n},range:et.cursor(o.head+n.length)}:i={range:o});return i?null:r.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function QNe(r,e,n,i){let s=i.stringPrefixes||hb.stringPrefixes,o=null,a=r.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:Pf.of(l.to+e.length),range:et.range(l.anchor+e.length,l.head+e.length)};let h=l.head,u=q2(r.doc,h),f;if(u==e){if(VF(r,h))return{changes:{insert:e+e,from:h},effects:Pf.of(h+e.length),range:et.cursor(h+e.length)};if(uZ(r,h)){let m=n&&r.sliceDoc(h,h+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:h,to:h+m.length,insert:m},range:et.cursor(h+m.length)}}}else{if(n&&r.sliceDoc(h-2*e.length,h)==e+e&&(f=FF(r,h-2*e.length,s))>-1&&VF(r,f))return{changes:{insert:e+e+e+e,from:h},effects:Pf.of(h+e.length),range:et.cursor(h+e.length)};if(r.charCategorizer(h)(u)!=jn.Word&&FF(r,h,s)>-1&&!jNe(r,h,e,s))return{changes:{insert:e+e,from:h},effects:Pf.of(h+e.length),range:et.cursor(h+e.length)}}return{range:o=l}});return o?null:r.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function VF(r,e){let n=Is(r).resolveInner(e+1);return n.parent&&n.from==e}function jNe(r,e,n,i){let s=Is(r).resolveInner(e,-1),o=i.reduce((a,l)=>Math.max(a,l.length),0);for(let a=0;a<5;a++){let l=r.sliceDoc(s.from,Math.min(s.to,s.from+n.length+o)),h=l.indexOf(n);if(!h||h>-1&&i.indexOf(l.slice(0,h))>-1){let f=s.firstChild;for(;f&&f.from==s.from&&f.to-f.from>n.length+h;){if(r.sliceDoc(f.to-n.length,f.to)==n)return!1;f=f.firstChild}return!0}let u=s.to==e&&s.parent;if(!u)break;s=u}return!1}function FF(r,e,n){let i=r.charCategorizer(e);if(i(r.sliceDoc(e-1,e))!=jn.Word)return e;for(let s of n){let o=e-s.length;if(r.sliceDoc(o,e)==s&&i(r.sliceDoc(o-1,o))!=jn.Word)return o}return-1}function YNe(r={}){return[LNe,yo,ps.of(r),NNe,qNe,BNe]}const dZ=[{key:"Ctrl-Space",run:ANe},{key:"Escape",run:kNe},{key:"ArrowDown",run:X_(!0)},{key:"ArrowUp",run:X_(!1)},{key:"PageDown",run:X_(!0,"page")},{key:"PageUp",run:X_(!1,"page")},{key:"Enter",run:MNe}],qNe=kp.highest(y5.computeN([ps],r=>r.facet(ps).defaultKeymap?[dZ]:[]));class ZNe{constructor(e,n,i){this.from=e,this.to=n,this.diagnostic=i}}class wf{constructor(e,n,i){this.diagnostics=e,this.panel=n,this.selected=i}static init(e,n,i){let s=e,o=i.facet(ub).markerFilter;o&&(s=o(s,i));let a=ui.set(s.map(l=>l.from==l.to||l.from==l.to-1&&i.doc.lineAt(l.from).to==l.from?ui.widget({widget:new oDe(l),diagnostic:l}).range(l.from):ui.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l}).range(l.from,l.to)),!0);return new wf(a,n,qg(a))}}function qg(r,e=null,n=0){let i=null;return r.between(n,1e9,(s,o,{spec:a})=>{if(!(e&&a.diagnostic!=e))return i=new ZNe(s,o,a.diagnostic),!1}),i}function KNe(r,e){let n=e.pos,i=e.end||n,s=r.state.facet(ub).hideOn(r,n,i);if(s!=null)return s;let o=r.startState.doc.lineAt(e.pos);return!!(r.effects.some(a=>a.is(fZ))||r.changes.touchesRange(o.from,Math.max(o.to,i)))}function JNe(r,e){return r.field(ta,!1)?e:e.concat(Ri.appendConfig.of(cDe))}const fZ=Ri.define(),B5=Ri.define(),pZ=Ri.define(),ta=ws.define({create(){return new wf(ui.none,null,null)},update(r,e){if(e.docChanged&&r.diagnostics.size){let n=r.diagnostics.map(e.changes),i=null,s=r.panel;if(r.selected){let o=e.changes.mapPos(r.selected.from,1);i=qg(n,r.selected.diagnostic,o)||qg(n,null,o)}!n.size&&s&&e.state.facet(ub).autoPanel&&(s=null),r=new wf(n,s,i)}for(let n of e.effects)if(n.is(fZ)){let i=e.state.facet(ub).autoPanel?n.value.length?db.open:null:r.panel;r=wf.init(n.value,i,e.state)}else n.is(B5)?r=new wf(r.diagnostics,n.value?db.open:null,r.selected):n.is(pZ)&&(r=new wf(r.diagnostics,r.panel,n.value));return r},provide:r=>[sb.from(r,e=>e.panel),St.decorations.from(r,e=>e.diagnostics)]}),eDe=ui.mark({class:"cm-lintRange cm-lintRange-active"});function tDe(r,e,n){let{diagnostics:i}=r.state.field(ta),s=[],o=2e8,a=0;i.between(e-(n<0?1:0),e+(n>0?1:0),(h,u,{spec:f})=>{e>=h&&e<=u&&(h==u||(e>h||n>0)&&(e<u||n<0))&&(s.push(f.diagnostic),o=Math.min(h,o),a=Math.max(u,a))});let l=r.state.facet(ub).tooltipFilter;return l&&(s=l(s,r.state)),s.length?{pos:o,end:a,above:r.state.doc.lineAt(o).to<a,create(){return{dom:iDe(r,s)}}}:null}function iDe(r,e){return Pn("ul",{class:"cm-tooltip-lint"},e.map(n=>gZ(r,n,!1)))}const nDe=r=>{let e=r.state.field(ta,!1);(!e||!e.panel)&&r.dispatch({effects:JNe(r.state,[B5.of(!0)])});let n=rb(r,db.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},zF=r=>{let e=r.state.field(ta,!1);return!e||!e.panel?!1:(r.dispatch({effects:B5.of(!1)}),!0)},rDe=r=>{let e=r.state.field(ta,!1);if(!e)return!1;let n=r.state.selection.main,i=e.diagnostics.iter(n.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to)?!1:(r.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},sDe=[{key:"Mod-Shift-m",run:nDe,preventDefault:!0},{key:"F8",run:rDe}],ub=Pt.define({combine(r){return Object.assign({sources:r.map(e=>e.source).filter(e=>e!=null)},_c(r.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,n)=>e?n?i=>e(i)||n(i):e:n}))}});function mZ(r){let e=[];if(r)e:for(let{name:n}of r){for(let i=0;i<n.length;i++){let s=n[i];if(/[a-zA-Z]/.test(s)&&!e.some(o=>o.toLowerCase()==s.toLowerCase())){e.push(s);continue e}}e.push("")}return e}function gZ(r,e,n){var i;let s=n?mZ(e.actions):[];return Pn("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Pn("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(r):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((o,a)=>{let l=!1,h=m=>{if(m.preventDefault(),l)return;l=!0;let v=qg(r.state.field(ta).diagnostics,e);v&&o.apply(r,v.from,v.to)},{name:u}=o,f=s[a]?u.indexOf(s[a]):-1,p=f<0?u:[u.slice(0,f),Pn("u",u.slice(f,f+1)),u.slice(f+1)];return Pn("button",{type:"button",class:"cm-diagnosticAction",onclick:h,onmousedown:h,"aria-label":` Action: ${u}${f<0?"":` (access key "${s[a]})"`}.`},p)}),e.source&&Pn("div",{class:"cm-diagnosticSource"},e.source))}class oDe extends wd{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return Pn("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class XF{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=gZ(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class db{constructor(e){this.view=e,this.items=[];let n=s=>{if(s.keyCode==27)zF(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:o}=this.items[this.selectedIndex],a=mZ(o.actions);for(let l=0;l<a.length;l++)if(a[l].toUpperCase().charCodeAt(0)==s.keyCode){let h=qg(this.view.state.field(ta).diagnostics,o);h&&o.actions[l].apply(e,h.from,h.to)}}else return;s.preventDefault()},i=s=>{for(let o=0;o<this.items.length;o++)this.items[o].dom.contains(s.target)&&this.moveSelection(o)};this.list=Pn("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:i}),this.dom=Pn("div",{class:"cm-panel-lint"},this.list,Pn("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>zF(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(ta).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(ta),i=0,s=!1,o=null;for(e.between(0,this.view.state.doc.length,(a,l,{spec:h})=>{let u=-1,f;for(let p=i;p<this.items.length;p++)if(this.items[p].diagnostic==h.diagnostic){u=p;break}u<0?(f=new XF(this.view,h.diagnostic),this.items.splice(i,0,f),s=!0):(f=this.items[u],u>i&&(this.items.splice(i,u-i),s=!0)),n&&f.diagnostic==n.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),o=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new XF(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:a,panel:l})=>{let h=l.height/this.list.offsetHeight;a.top<l.top?this.list.scrollTop-=(l.top-a.top)/h:a.bottom>l.bottom&&(this.list.scrollTop+=(a.bottom-l.bottom)/h)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function n(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)n();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(ta),i=qg(n.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:pZ.of(i)})}static open(e){return new db(e)}}function aDe(r,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(r)}</svg>')`}function W_(r){return aDe(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const lDe=St.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:W_("#d11")},".cm-lintRange-warning":{backgroundImage:W_("orange")},".cm-lintRange-info":{backgroundImage:W_("#999")},".cm-lintRange-hint":{backgroundImage:W_("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),cDe=[ta,St.decorations.compute([ta],r=>{let{selected:e,panel:n}=r.field(ta);return!e||!n||e.from==e.to?ui.none:ui.set([eDe.range(e.from,e.to)])}),JRe(tDe,{hideOn:KNe}),lDe],oC=[hIe(),fIe(),kRe(),R4e(),r4e(),bRe(),SRe(),an.allowMultipleSelections.of(!0),WIe(),o4e(c4e,{fallback:!0}),g4e(),$Ne(),YNe(),zRe(),GRe(),LRe(),F5e(),y5.of([...zNe,...D5e,...oNe,...F4e,...e4e,...dZ,...sDe])];var WF={};class aC{constructor(e,n,i,s,o,a,l,h,u,f=0,p){this.p=e,this.stack=n,this.state=i,this.reducePos=s,this.pos=o,this.score=a,this.buffer=l,this.bufferBase=h,this.curContext=u,this.lookAhead=f,this.parent=p}toString(){return`[${this.stack.filter((e,n)=>n%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,n,i=0){let s=e.parser.context;return new aC(e,[],n,i,i,0,[],0,s?new GF(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,n){this.stack.push(this.state,n,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var n;let i=e>>19,s=e&65535,{parser:o}=this.p,a=this.reducePos<this.pos-25;a&&this.setLookAhead(this.pos);let l=o.dynamicPrecedence(s);if(l&&(this.score+=l),i==0){this.pushState(o.getGoto(this.state,s,!0),this.reducePos),s<o.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(s,this.reducePos);return}let h=this.stack.length-(i-1)*3-(e&262144?6:0),u=h?this.stack[h-2]:this.p.ranges[0].from,f=this.reducePos-u;f>=2e3&&!(!((n=this.p.parser.nodeSet.types[s])===null||n===void 0)&&n.isAnonymous)&&(u==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=f):this.p.lastBigReductionSize<f&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=u,this.p.lastBigReductionSize=f));let p=h?this.stack[h-1]:0,m=this.bufferBase+this.buffer.length-p;if(s<o.minRepeatTerm||e&131072){let v=o.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,u,v,m+4,!0)}if(e&262144)this.state=this.stack[h];else{let v=this.stack[h-3];this.state=o.getGoto(v,s,!0)}for(;this.stack.length>h;)this.stack.pop();this.reduceContext(s,u)}storeNode(e,n,i,s=4,o=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,l=this.buffer.length;if(l==0&&a.parent&&(l=a.bufferBase-a.parent.bufferBase,a=a.parent),l>0&&a.buffer[l-4]==0&&a.buffer[l-1]>-1){if(n==i)return;if(a.buffer[l-2]>=n){a.buffer[l-2]=i;return}}}if(!o||this.pos==i)this.buffer.push(e,n,i,s);else{let a=this.buffer.length;if(a>0&&this.buffer[a-4]!=0){let l=!1;for(let h=a;h>0&&this.buffer[h-2]>i;h-=4)if(this.buffer[h-1]>=0){l=!0;break}if(l)for(;a>0&&this.buffer[a-2]>i;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,s>4&&(s-=4)}this.buffer[a]=e,this.buffer[a+1]=n,this.buffer[a+2]=i,this.buffer[a+3]=s}}shift(e,n,i,s){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=s,this.shiftContext(n,i),n<=this.p.parser.maxNode&&this.buffer.push(n,i,s,4);else{let o=e,{parser:a}=this.p;(s>this.pos||n<=a.maxNode)&&(this.pos=s,a.stateFlag(o,1)||(this.reducePos=s)),this.pushState(o,i),this.shiftContext(n,i),n<=a.maxNode&&this.buffer.push(n,i,s,4)}}apply(e,n,i,s){e&65536?this.reduce(e):this.shift(e,n,i,s)}useNode(e,n){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let s=this.pos;this.reducePos=this.pos=s+e.length,this.pushState(n,s),this.buffer.push(i,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,n=e.buffer.length;for(;n>0&&e.buffer[n-2]>e.reducePos;)n-=4;let i=e.buffer.slice(n),s=e.bufferBase+n;for(;e&&s==e.bufferBase;)e=e.parent;return new aC(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,s,this.curContext,this.lookAhead,e)}recoverByDelete(e,n){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,n,4),this.storeNode(0,this.pos,n,i?8:4),this.pos=this.reducePos=n,this.score-=190}canShift(e){for(let n=new hDe(this);;){let i=this.p.parser.stateSlot(n.state,4)||this.p.parser.hasAction(n.state,e);if(i==0)return!1;if(!(i&65536))return!0;n.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let n=this.p.parser.nextStates(this.state);if(n.length>8||this.stack.length>=120){let s=[];for(let o=0,a;o<n.length;o+=2)(a=n[o+1])!=this.state&&this.p.parser.hasAction(a,e)&&s.push(n[o],a);if(this.stack.length<120)for(let o=0;s.length<8&&o<n.length;o+=2){let a=n[o+1];s.some((l,h)=>h&1&&l==a)||s.push(n[o],a)}n=s}let i=[];for(let s=0;s<n.length&&i.length<4;s+=2){let o=n[s+1];if(o==this.state)continue;let a=this.split();a.pushState(o,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(n[s],this.pos),a.reducePos=this.pos,a.score-=200,i.push(a)}return i}forceReduce(){let{parser:e}=this.p,n=e.stateSlot(this.state,5);if(!(n&65536))return!1;if(!e.validAction(this.state,n)){let i=n>>19,s=n&65535,o=this.stack.length-i*3;if(o<0||e.getGoto(this.stack[o],s,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;n=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(n),!0}findForcedReduction(){let{parser:e}=this.p,n=[],i=(s,o)=>{if(!n.includes(s))return n.push(s),e.allActions(s,a=>{if(!(a&393216))if(a&65536){let l=(a>>19)-o;if(l>1){let h=a&65535,u=this.stack.length-l*3;if(u>=0&&e.getGoto(this.stack[u],h,!1)>=0)return l<<19|65536|h}}else{let l=i(a,o+1);if(l!=null)return l}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let n=0;n<this.stack.length;n+=3)if(this.stack[n]!=e.stack[n])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,n){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(n)))}reduceContext(e,n){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(n)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let n=new GF(this.curContext.tracker,e);n.hash!=this.curContext.hash&&this.emitContext(),this.curContext=n}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class GF{constructor(e,n){this.tracker=e,this.context=n,this.hash=e.strict?e.hash(n):0}}class hDe{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let n=e&65535,i=e>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let s=this.start.p.parser.getGoto(this.stack[this.base-3],n,!0);this.state=s}}class lC{constructor(e,n,i){this.stack=e,this.pos=n,this.index=i,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,n=e.bufferBase+e.buffer.length){return new lC(e,n,n-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new lC(this.stack,this.pos,this.index)}}function G_(r,e=Uint16Array){if(typeof r!="string")return r;let n=null;for(let i=0,s=0;i<r.length;){let o=0;for(;;){let a=r.charCodeAt(i++),l=!1;if(a==126){o=65535;break}a>=92&&a--,a>=34&&a--;let h=a-32;if(h>=46&&(h-=46,l=!0),o+=h,l)break;o*=46}n?n[s++]=o:n=new e(o)}return n}class jO{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const HF=new jO;class uDe{constructor(e,n){this.input=e,this.ranges=n,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=HF,this.rangeIndex=0,this.pos=this.chunkPos=n[0].from,this.range=n[0],this.end=n[n.length-1].to,this.readNext()}resolveOffset(e,n){let i=this.range,s=this.rangeIndex,o=this.pos+e;for(;o<i.from;){if(!s)return null;let a=this.ranges[--s];o-=i.from-a.to,i=a}for(;n<0?o>i.to:o>=i.to;){if(s==this.ranges.length-1)return null;let a=this.ranges[++s];o+=a.from-i.to,i=a}return o}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let n of this.ranges)if(n.to>e)return Math.max(e,n.from);return this.end}peek(e){let n=this.chunkOff+e,i,s;if(n>=0&&n<this.chunk.length)i=this.pos+e,s=this.chunk.charCodeAt(n);else{let o=this.resolveOffset(e,1);if(o==null)return-1;if(i=o,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)s=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let a=this.rangeIndex,l=this.range;for(;l.to<=i;)l=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>l.to&&(this.chunk2=this.chunk2.slice(0,l.to-i)),s=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),s}acceptToken(e,n=0){let i=n?this.resolveOffset(n,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}acceptTokenTo(e,n){this.token.value=e,this.token.end=n}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:n}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=n,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),n=this.pos+e.length;this.chunk=n>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,n){if(n?(this.token=n,n.start=e,n.lookAhead=e+1,n.value=n.extended=-1):this.token=HF,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,n){if(e>=this.chunkPos&&n<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,n-this.chunkPos);if(e>=this.chunk2Pos&&n<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,n-this.chunk2Pos);if(e>=this.range.from&&n<=this.range.to)return this.input.read(e,n);let i="";for(let s of this.ranges){if(s.from>=n)break;s.to>e&&(i+=this.input.read(Math.max(s.from,e),Math.min(s.to,n)))}return i}}class _g{constructor(e,n){this.data=e,this.id=n}token(e,n){let{parser:i}=n.p;dDe(this.data,e,n,this.id,i.data,i.tokenPrecTable)}}_g.prototype.contextual=_g.prototype.fallback=_g.prototype.extend=!1;_g.prototype.fallback=_g.prototype.extend=!1;class vZ{constructor(e,n={}){this.token=e,this.contextual=!!n.contextual,this.fallback=!!n.fallback,this.extend=!!n.extend}}function dDe(r,e,n,i,s,o){let a=0,l=1<<i,{dialect:h}=n.p.parser;e:for(;l&r[a];){let u=r[a+1];for(let v=a+3;v<u;v+=2)if((r[v+1]&l)>0){let y=r[v];if(h.allows(y)&&(e.token.value==-1||e.token.value==y||fDe(y,e.token.value,s,o))){e.acceptToken(y);break}}let f=e.next,p=0,m=r[a+2];if(e.next<0&&m>p&&r[u+m*3-3]==65535){a=r[u+m*3-1];continue e}for(;p<m;){let v=p+m>>1,y=u+v+(v<<1),x=r[y],w=r[y+1]||65536;if(f<x)m=v;else if(f>=w)p=v+1;else{a=r[y+2],e.advance();continue e}}break}}function QF(r,e,n){for(let i=e,s;(s=r[i])!=65535;i++)if(s==n)return i-e;return-1}function fDe(r,e,n,i){let s=QF(n,i,e);return s<0||QF(n,i,r)<s}const Wo=typeof process<"u"&&WF&&/\bparse\b/.test(WF.LOG);let EA=null;function jF(r,e,n){let i=r.cursor(es.IncludeAnonymous);for(i.moveTo(e);;)if(!(n<0?i.childBefore(e):i.childAfter(e)))for(;;){if((n<0?i.to<e:i.from>e)&&!i.type.isError)return n<0?Math.max(0,Math.min(i.to-1,e-25)):Math.min(r.length,Math.max(i.from+1,e+25));if(n<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return n<0?0:r.length}}class pDe{constructor(e,n){this.fragments=e,this.nodeSet=n,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?jF(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?jF(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let n=this.trees.length-1;if(n<0)return this.nextFragment(),null;let i=this.trees[n],s=this.index[n];if(s==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let o=i.children[s],a=this.start[n]+i.positions[s];if(a>e)return this.nextStart=a,null;if(o instanceof Mr){if(a==e){if(a<this.safeFrom)return null;let l=a+o.length;if(l<=this.safeTo){let h=o.prop(Bi.lookAhead);if(!h||l+h<this.fragment.to)return o}}this.index[n]++,a+o.length>=Math.max(this.safeFrom,e)&&(this.trees.push(o),this.start.push(a),this.index.push(0))}else this.index[n]++,this.nextStart=a+o.length}}}class mDe{constructor(e,n){this.stream=n,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(i=>new jO)}getActions(e){let n=0,i=null,{parser:s}=e.p,{tokenizers:o}=s,a=s.stateSlot(e.state,3),l=e.curContext?e.curContext.hash:0,h=0;for(let u=0;u<o.length;u++){if(!(1<<u&a))continue;let f=o[u],p=this.tokens[u];if(!(i&&!f.fallback)&&((f.contextual||p.start!=e.pos||p.mask!=a||p.context!=l)&&(this.updateCachedToken(p,f,e),p.mask=a,p.context=l),p.lookAhead>p.end+25&&(h=Math.max(p.lookAhead,h)),p.value!=0)){let m=n;if(p.extended>-1&&(n=this.addActions(e,p.extended,p.end,n)),n=this.addActions(e,p.value,p.end,n),!f.extend&&(i=p,n>m))break}}for(;this.actions.length>n;)this.actions.pop();return h&&e.setLookAhead(h),!i&&e.pos==this.stream.end&&(i=new jO,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,n=this.addActions(e,i.value,i.end,n)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let n=new jO,{pos:i,p:s}=e;return n.start=i,n.end=Math.min(i+1,s.stream.end),n.value=i==s.stream.end?s.parser.eofTerm:0,n}updateCachedToken(e,n,i){let s=this.stream.clipPos(i.pos);if(n.token(this.stream.reset(s,e),i),e.value>-1){let{parser:o}=i.p;for(let a=0;a<o.specialized.length;a++)if(o.specialized[a]==e.value){let l=o.specializers[a](this.stream.read(e.start,e.end),i);if(l>=0&&i.p.parser.dialect.allows(l>>1)){l&1?e.extended=l>>1:e.value=l>>1;break}}}else e.value=0,e.end=this.stream.clipPos(s+1)}putAction(e,n,i,s){for(let o=0;o<s;o+=3)if(this.actions[o]==e)return s;return this.actions[s++]=e,this.actions[s++]=n,this.actions[s++]=i,s}addActions(e,n,i,s){let{state:o}=e,{parser:a}=e.p,{data:l}=a;for(let h=0;h<2;h++)for(let u=a.stateSlot(o,h?2:1);;u+=3){if(l[u]==65535)if(l[u+1]==1)u=eh(l,u+2);else{s==0&&l[u+1]==2&&(s=this.putAction(eh(l,u+2),n,i,s));break}l[u]==n&&(s=this.putAction(eh(l,u+1),n,i,s))}return s}}class gDe{constructor(e,n,i,s){this.parser=e,this.input=n,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new uDe(n,s),this.tokens=new mDe(e,this.stream),this.topTerm=e.top[1];let{from:o}=s[0];this.stacks=[aC.start(this,e.top[0],o)],this.fragments=i.length&&this.stream.end-o>e.bufferLength*4?new pDe(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,n=this.minStackPos,i=this.stacks=[],s,o;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let l=e[a];for(;;){if(this.tokens.mainToken=null,l.pos>n)i.push(l);else{if(this.advanceStack(l,i,e))continue;{s||(s=[],o=[]),s.push(l);let h=this.tokens.getMainToken(l);o.push(h.value,h.end)}}break}}if(!i.length){let a=s&&yDe(s);if(a)return Wo&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw Wo&&s&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+n);this.recovering||(this.recovering=5)}if(this.recovering&&s){let a=this.stoppedAt!=null&&s[0].pos>this.stoppedAt?s[0]:this.runRecovery(s,o,i);if(a)return Wo&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(i.length>a)for(i.sort((l,h)=>h.score-l.score);i.length>a;)i.pop();i.some(l=>l.reducePos>n)&&this.recovering--}else if(i.length>1){e:for(let a=0;a<i.length-1;a++){let l=i[a];for(let h=a+1;h<i.length;h++){let u=i[h];if(l.sameState(u)||l.buffer.length>500&&u.buffer.length>500)if((l.score-u.score||l.buffer.length-u.buffer.length)>0)i.splice(h--,1);else{i.splice(a--,1);continue e}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let a=1;a<i.length;a++)i[a].pos<this.minStackPos&&(this.minStackPos=i[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,n,i){let s=e.pos,{parser:o}=this,a=Wo?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&s>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let u=e.curContext&&e.curContext.tracker.strict,f=u?e.curContext.hash:0;for(let p=this.fragments.nodeAt(s);p;){let m=this.parser.nodeSet.types[p.type.id]==p.type?o.getGoto(e.state,p.type.id):-1;if(m>-1&&p.length&&(!u||(p.prop(Bi.contextHash)||0)==f))return e.useNode(p,m),Wo&&console.log(a+this.stackID(e)+` (via reuse of ${o.getName(p.type.id)})`),!0;if(!(p instanceof Mr)||p.children.length==0||p.positions[0]>0)break;let v=p.children[0];if(v instanceof Mr&&p.positions[0]==0)p=v;else break}}let l=o.stateSlot(e.state,4);if(l>0)return e.reduce(l),Wo&&console.log(a+this.stackID(e)+` (via always-reduce ${o.getName(l&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let h=this.tokens.getActions(e);for(let u=0;u<h.length;){let f=h[u++],p=h[u++],m=h[u++],v=u==h.length||!i,y=v?e:e.split(),x=this.tokens.mainToken;if(y.apply(f,p,x?x.start:y.pos,m),Wo&&console.log(a+this.stackID(y)+` (via ${f&65536?`reduce of ${o.getName(f&65535)}`:"shift"} for ${o.getName(p)} @ ${s}${y==e?"":", split"})`),v)return!0;y.pos>s?n.push(y):i.push(y)}return!1}advanceFully(e,n){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return YF(e,n),!0}}runRecovery(e,n,i){let s=null,o=!1;for(let a=0;a<e.length;a++){let l=e[a],h=n[a<<1],u=n[(a<<1)+1],f=Wo?this.stackID(l)+" -> ":"";if(l.deadEnd&&(o||(o=!0,l.restart(),Wo&&console.log(f+this.stackID(l)+" (restarted)"),this.advanceFully(l,i))))continue;let p=l.split(),m=f;for(let v=0;p.forceReduce()&&v<10&&(Wo&&console.log(m+this.stackID(p)+" (via force-reduce)"),!this.advanceFully(p,i));v++)Wo&&(m=this.stackID(p)+" -> ");for(let v of l.recoverByInsert(h))Wo&&console.log(f+this.stackID(v)+" (via recover-insert)"),this.advanceFully(v,i);this.stream.end>l.pos?(u==l.pos&&(u++,h=0),l.recoverByDelete(h,u),Wo&&console.log(f+this.stackID(l)+` (via recover-delete ${this.parser.getName(h)})`),YF(l,i)):(!s||s.score<l.score)&&(s=l)}return s}stackToTree(e){return e.close(),Mr.build({buffer:lC.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let n=(EA||(EA=new WeakMap)).get(e);return n||EA.set(e,n=String.fromCodePoint(this.nextStackID++)),n+e}}function YF(r,e){for(let n=0;n<e.length;n++){let i=e[n];if(i.pos==r.pos&&i.sameState(r)){e[n].score<r.score&&(e[n]=r);return}}e.push(r)}class vDe{constructor(e,n,i){this.source=e,this.flags=n,this.disabled=i}allows(e){return!this.disabled||this.disabled[e]==0}}class cC extends qY{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let n=e.nodeNames.split(" ");this.minRepeatTerm=n.length;for(let l=0;l<e.repeatNodeCount;l++)n.push("");let i=Object.keys(e.topRules).map(l=>e.topRules[l][1]),s=[];for(let l=0;l<n.length;l++)s.push([]);function o(l,h,u){s[l].push([h,h.deserialize(String(u))])}if(e.nodeProps)for(let l of e.nodeProps){let h=l[0];typeof h=="string"&&(h=Bi[h]);for(let u=1;u<l.length;){let f=l[u++];if(f>=0)o(f,h,l[u++]);else{let p=l[u+-f];for(let m=-f;m>0;m--)o(l[u++],h,p);u++}}}this.nodeSet=new w5(n.map((l,h)=>ko.define({name:h>=this.minRepeatTerm?void 0:l,id:h,props:s[h],top:i.indexOf(h)>-1,error:h==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(h)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=HY;let a=G_(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let l=0;l<this.specializerSpecs.length;l++)this.specialized[l]=this.specializerSpecs[l].term;this.specializers=this.specializerSpecs.map(qF),this.states=G_(e.states,Uint32Array),this.data=G_(e.stateData),this.goto=G_(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(l=>typeof l=="number"?new _g(a,l):l),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,n,i){let s=new gDe(this,e,n,i);for(let o of this.wrappers)s=o(s,e,n,i);return s}getGoto(e,n,i=!1){let s=this.goto;if(n>=s[0])return-1;for(let o=s[n+1];;){let a=s[o++],l=a&1,h=s[o++];if(l&&i)return h;for(let u=o+(a>>1);o<u;o++)if(s[o]==e)return h;if(l)return-1}}hasAction(e,n){let i=this.data;for(let s=0;s<2;s++)for(let o=this.stateSlot(e,s?2:1),a;;o+=3){if((a=i[o])==65535)if(i[o+1]==1)a=i[o=eh(i,o+2)];else{if(i[o+1]==2)return eh(i,o+2);break}if(a==n||a==0)return eh(i,o+1)}return 0}stateSlot(e,n){return this.states[e*6+n]}stateFlag(e,n){return(this.stateSlot(e,0)&n)>0}validAction(e,n){return!!this.allActions(e,i=>i==n?!0:null)}allActions(e,n){let i=this.stateSlot(e,4),s=i?n(i):void 0;for(let o=this.stateSlot(e,1);s==null;o+=3){if(this.data[o]==65535)if(this.data[o+1]==1)o=eh(this.data,o+2);else break;s=n(eh(this.data,o+1))}return s}nextStates(e){let n=[];for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=eh(this.data,i+2);else break;if(!(this.data[i+2]&1)){let s=this.data[i+1];n.some((o,a)=>a&1&&o==s)||n.push(this.data[i],s)}}return n}configure(e){let n=Object.assign(Object.create(cC.prototype),this);if(e.props&&(n.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);n.top=i}return e.tokenizers&&(n.tokenizers=this.tokenizers.map(i=>{let s=e.tokenizers.find(o=>o.from==i);return s?s.to:i})),e.specializers&&(n.specializers=this.specializers.slice(),n.specializerSpecs=this.specializerSpecs.map((i,s)=>{let o=e.specializers.find(l=>l.from==i.external);if(!o)return i;let a=Object.assign(Object.assign({},i),{external:o.to});return n.specializers[s]=qF(a),a})),e.contextTracker&&(n.context=e.contextTracker),e.dialect&&(n.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(n.strict=e.strict),e.wrap&&(n.wrappers=n.wrappers.concat(e.wrap)),e.bufferLength!=null&&(n.bufferLength=e.bufferLength),n}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let n=this.dynamicPrecedences;return n==null?0:n[e]||0}parseDialect(e){let n=Object.keys(this.dialects),i=n.map(()=>!1);if(e)for(let o of e.split(" ")){let a=n.indexOf(o);a>=0&&(i[a]=!0)}let s=null;for(let o=0;o<n.length;o++)if(!i[o])for(let a=this.dialects[n[o]],l;(l=this.data[a++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[l]=1;return new vDe(e,i,s)}static deserialize(e){return new cC(e)}}function eh(r,e){return r[e]|r[e+1]<<16}function yDe(r){let e=null;for(let n of r){let i=n.p.stoppedAt;(n.pos==n.p.stream.end||i!=null&&n.pos>i)&&n.p.parser.stateFlag(n.state,2)&&(!e||e.score<n.score)&&(e=n)}return e}function qF(r){if(r.external){let e=r.extend?1:0;return(n,i)=>r.external(n,i)<<1|e}return r.get}const ZF=1,bDe=2,xDe=3,wDe=82,_De=76,ODe=117,SDe=85,CDe=97,TDe=122,EDe=65,MDe=90,ADe=95,Z3=48,KF=34,kDe=40,JF=41,PDe=32,ez=62,RDe=new vZ(r=>{if(r.next==_De||r.next==SDe?r.advance():r.next==ODe&&(r.advance(),r.next==Z3+8&&r.advance()),r.next!=wDe||(r.advance(),r.next!=KF))return;r.advance();let e="";for(;r.next!=kDe;){if(r.next==PDe||r.next<=13||r.next==JF)return;e+=String.fromCharCode(r.next),r.advance()}for(r.advance();;){if(r.next<0)return r.acceptToken(ZF);if(r.next==JF){let n=!0;for(let i=0;n&&i<e.length;i++)r.peek(i+1)!=e.charCodeAt(i)&&(n=!1);if(n&&r.peek(e.length+1)==KF)return r.acceptToken(ZF,2+e.length)}r.advance()}}),IDe=new vZ(r=>{if(r.next==ez)r.peek(1)==ez&&r.acceptToken(bDe,1);else{let e=!1,n=0;for(;;n++){if(r.next>=EDe&&r.next<=MDe)e=!0;else{if(r.next>=CDe&&r.next<=TDe)return;if(r.next!=ADe&&!(r.next>=Z3&&r.next<=Z3+9))break}r.advance()}e&&n>1&&r.acceptToken(xDe)}},{extend:!0}),NDe=ZY({"typedef struct union enum class typename decltype auto template operator friend noexcept namespace using requires concept import export module __attribute__ __declspec __based":Qe.definitionKeyword,"extern MsCallModifier MsPointerModifier extern static register thread_local inline const volatile restrict _Atomic mutable constexpr constinit consteval virtual explicit VirtualSpecifier Access":Qe.modifier,"if else switch for while do case default return break continue goto throw try catch":Qe.controlKeyword,"co_return co_yield co_await":Qe.controlKeyword,"new sizeof delete static_assert":Qe.operatorKeyword,"NULL nullptr":Qe.null,this:Qe.self,"True False":Qe.bool,"TypeSize PrimitiveType":Qe.standard(Qe.typeName),TypeIdentifier:Qe.typeName,FieldIdentifier:Qe.propertyName,"CallExpression/FieldExpression/FieldIdentifier":Qe.function(Qe.propertyName),"ModuleName/Identifier":Qe.namespace,PartitionName:Qe.labelName,StatementIdentifier:Qe.labelName,"Identifier DestructorName":Qe.variableName,"CallExpression/Identifier":Qe.function(Qe.variableName),"CallExpression/ScopedIdentifier/Identifier":Qe.function(Qe.variableName),"FunctionDeclarator/Identifier FunctionDeclarator/DestructorName":Qe.function(Qe.definition(Qe.variableName)),NamespaceIdentifier:Qe.namespace,OperatorName:Qe.operator,ArithOp:Qe.arithmeticOperator,LogicOp:Qe.logicOperator,BitOp:Qe.bitwiseOperator,CompareOp:Qe.compareOperator,AssignOp:Qe.definitionOperator,UpdateOp:Qe.updateOperator,LineComment:Qe.lineComment,BlockComment:Qe.blockComment,Number:Qe.number,String:Qe.string,"RawString SystemLibString":Qe.special(Qe.string),CharLiteral:Qe.character,EscapeSequence:Qe.escape,"UserDefinedLiteral/Identifier":Qe.literal,PreProcArg:Qe.meta,"PreprocDirectiveName #include #ifdef #ifndef #if #define #else #endif #elif":Qe.processingInstruction,MacroName:Qe.special(Qe.name),"( )":Qe.paren,"[ ]":Qe.squareBracket,"{ }":Qe.brace,"< >":Qe.angleBracket,". ->":Qe.derefOperator,", ;":Qe.separator}),DDe={__proto__:null,bool:34,char:34,int:34,float:34,double:34,void:34,size_t:34,ssize_t:34,intptr_t:34,uintptr_t:34,charptr_t:34,int8_t:34,int16_t:34,int32_t:34,int64_t:34,uint8_t:34,uint16_t:34,uint32_t:34,uint64_t:34,char8_t:34,char16_t:34,char32_t:34,char64_t:34,const:68,volatile:70,restrict:72,_Atomic:74,mutable:76,constexpr:78,constinit:80,consteval:82,struct:86,__declspec:90,final:148,override:148,public:152,private:152,protected:152,virtual:154,extern:160,static:162,register:164,inline:166,thread_local:168,__attribute__:172,__based:178,__restrict:180,__uptr:180,__sptr:180,_unaligned:180,__unaligned:180,noexcept:194,requires:198,TRUE:784,true:784,FALSE:786,false:786,typename:218,class:220,template:234,throw:248,__cdecl:256,__clrcall:256,__stdcall:256,__fastcall:256,__thiscall:256,__vectorcall:256,try:260,catch:264,export:282,import:286,case:296,default:298,if:308,else:314,switch:318,do:322,while:324,for:330,return:334,break:338,continue:342,goto:346,co_return:350,co_yield:354,using:362,typedef:366,namespace:380,new:398,delete:400,co_await:402,concept:406,enum:410,static_assert:414,friend:422,union:424,explicit:430,operator:444,module:456,signed:518,unsigned:518,long:518,short:518,decltype:528,auto:530,sizeof:566,NULL:572,nullptr:586,this:588},LDe={__proto__:null,"<":131},BDe={__proto__:null,">":135},$De={__proto__:null,operator:388,new:576,delete:582},UDe=cC.deserialize({version:14,states:"$:|Q!QQVOOP'gOUOOO(XOWO'#CdO,RQUO'#CgO,]QUO'#FjO-sQbO'#CwO.UQUO'#CwO0TQUO'#KZO0[QUO'#CvO0gOpO'#DvO0oQ!dO'#D]OOQR'#JO'#JOO5XQVO'#GUO5fQUO'#JVOOQQ'#JV'#JVO8zQUO'#KmO<eQUO'#KmO>{QVO'#E^O?]QUO'#E^OOQQ'#Ed'#EdOOQQ'#Ee'#EeO?bQVO'#EfO@XQVO'#EiOBUQUO'#FPOBvQUO'#FhOOQR'#Fj'#FjOB{QUO'#FjOOQR'#LQ'#LQOOQR'#LP'#LPOETQVO'#KQOFxQUO'#LVOGVQUO'#KqOGkQUO'#LVOH]QUO'#LXOOQR'#HU'#HUOOQR'#HV'#HVOOQR'#HW'#HWOOQR'#K|'#K|OOQR'#J_'#J_Q!QQVOOOHkQVO'#FOOIWQUO'#EhOI_QUOOOKZQVO'#HgOKkQUO'#HgONVQUO'#KqONaQUO'#KqOOQQ'#Kq'#KqO!!_QUO'#KqOOQQ'#Jq'#JqO!!lQUO'#HxOOQQ'#KZ'#KZO!&^QUO'#KZO!&zQUO'#KQO!(zQVO'#I]O!(zQVO'#I`OCQQUO'#KQOOQQ'#Ip'#IpOOQQ'#KQ'#KQO!,}QUO'#KZOOQR'#KY'#KYO!-UQUO'#DYO!/mQUO'#KnOOQQ'#Kn'#KnO!/tQUO'#KnO!/{QUO'#ETO!0QQUO'#EWO!0VQUO'#FRO8zQUO'#FPO!QQVO'#F^O!0[Q#vO'#F`O!0gQUO'#FkO!0oQUO'#FpO!0tQVO'#FrO!0oQUO'#FuO!3sQUO'#FvO!3xQVO'#FxO!4SQUO'#FzO!4XQUO'#F|O!4^QUO'#GOO!4cQVO'#GQO!(zQVO'#GSO!4jQUO'#GpO!4xQUO'#GYO!(zQVO'#FeO!6VQUO'#FeO!6[QVO'#G`O!6cQUO'#GaO!6nQUO'#GnO!6sQUO'#GrO!6xQUO'#GzO!7jQ&lO'#HiO!:mQUO'#GuO!:}QUO'#HXO!;YQUO'#HZO!;bQUO'#DWO!;bQUO'#HuO!;bQUO'#HvO!;yQUO'#HwO!<[QUO'#H|O!=PQUO'#H}O!>uQVO'#IbO!(zQVO'#IdO!?PQUO'#IgO!?WQVO'#IjP!@}{,UO'#CbP!6n{,UO'#CbP!AY{7[O'#CbP!6n{,UO'#CbP!A_{,UO'#CbP!AjOSO'#IzPOOO)CEn)CEnOOOO'#I|'#I|O!AtOWO,59OOOQR,59O,59OO!(zQVO,59UOOQQ,59W,59WO!(zQVO,5;ROOQR,5<U,5<UO!BPQUO,59YO!(zQVO,5>qOOQR'#IX'#IXOOQR'#IY'#IYOOQR'#IZ'#IZOOQR'#I['#I[O!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!DOQVO,5>zOOQQ,5?W,5?WO!EqQVO'#ChO!IjQUO'#CyOOQQ,59c,59cOOQQ,59b,59bOOQQ,5<},5<}O!IwQ&lO,5=mO!?PQUO,5?RO!LkQVO,5?UO!LrQbO,59cO!L}QVO'#FYOOQQ,5?P,5?PO!M_QVO,59VO!MfO`O,5:bO!MkQbO'#D^O!M|QbO'#K^O!N[QbO,59wO!NdQbO'#CwO!NuQUO'#CwO!NzQUO'#KZO# UQUO'#CvOOQR-E<|-E<|O# aQUO,5AoO# hQVO'#EfO@XQVO'#EiOBUQUO,5;kOOQR,5<p,5<pO#$aQUO'#KQO#$hQUO'#KQO!(zQVO'#IUO8zQUO,5;kO#${Q&lO'#HiO#(SQUO'#CsO#*wQbO'#CwO#*|QUO'#CvO#.jQUO'#KZOOQQ-E=T-E=TO#0}QUO,5AXO#1XQUO'#KZO#1cQUO,5AXOOQR,5Ao,5AoOOQQ,5>l,5>lO#3gQUO'#CgO#4]QUO,5>pO#6OQUO'#IeOOQR'#I}'#I}O#6WQUO,5:xO#6tQUO,5:xO#7eQUO,5:xO#8YQUO'#CtO!0QQUO'#ClOOQQ'#JW'#JWO#6tQUO,5:xO#8bQUO,5;QO!4xQUO'#C}O#9kQUO,5;QO#9pQUO,5>QO#:|QUO'#C}O#;dQUO,5>{O#;iQUO'#KwO#<rQUO,5;TO#<zQVO,5;TO#=UQUO,5;TOOQQ,5;T,5;TO#>}QUO'#L[O#?UQUO,5>UO#?ZQbO'#CwO#?fQUO'#GcO#?kQUO'#E^O#@[QUO,5;kO#@sQUO'#K}O#@{QUO,5;rOKkQUO'#HfOBUQUO'#HgO#AQQUO'#KqO!6nQUO'#HjO#AxQUO'#CtO!0tQVO,5<SOOQQ'#Cg'#CgOOQR'#Jh'#JhO#A}QVO,5=`OOQQ,5?Z,5?ZO#DWQbO'#CwO#DcQUO'#GcOOQQ'#Ji'#JiOOQQ-E=g-E=gOGVQUO,5AqOGkQUO,5AqO#DhQUO,5AsO#DsQUO'#G|OOQR,5Aq,5AqO#DhQUO,5AqO#EOQUO'#HOO#EWQUO,5AsOOQR,5As,5AsOOQR,5At,5AtO#EfQVO,5AtOOQR-E=]-E=]O#G`QVO,5;jOOQR,5;j,5;jO#IaQUO'#EjO#JfQUO'#EwO#K]QVO'#ExO#MoQUO'#EvO#MwQUO'#EyO#NvQUO'#EzOOQQ'#Kz'#KzO$ mQUO,5;SO$!sQUO'#EvOOQQ,5;S,5;SO$#pQUO,5;SO$%cQUO,5:yO$'|QVO,5>PO$(WQUO'#E[O$(eQUO,5>ROOQQ,5>S,5>SO$,RQVO'#C{OOQQ-E=o-E=oOOQQ,5>d,5>dOOQQ,59`,59`O$,]QUO,5>wO$.]QUO,5>zO!6nQUO,59tO$.pQUO,5;qO$.}QUO,5<{O!0QQUO,5:oOOQQ,5:r,5:rO$/YQUO,5;mO$/_QUO'#KmOBUQUO,5;kOOQR,5;x,5;xO$0OQUO'#FbO$0^QUO'#FbO$0cQUO,5;zO$3|QVO'#FmO!0tQVO,5<VO!0oQUO,5<VO!0VQUO,5<[O$4TQVO'#GUO$7PQUO,5<^O!0tQVO,5<aO$:gQVO,5<bO$:tQUO,5<dOOQR,5<d,5<dO$;}QUO,5<dOOQR,5<f,5<fOOQR,5<h,5<hOOQQ'#Fi'#FiO$<SQUO,5<jO$<XQUO,5<lOOQR,5<l,5<lO$=_QUO,5<nO$>eQUO,5<rO$>pQUO,5=[O$>uQUO,5=[O!4xQUO,5<tO$>}QUO,5<tO$?cQUO,5<PO$@iQVO,5<PO$BzQUO,5<zOOQR,5<z,5<zOOQR,5<{,5<{O$>uQUO,5<{O$DQQUO,5<{O$D]QUO,5=YO!(zQVO,5=^O!(zQVO,5=fO#NeQUO,5=mOOQQ,5>T,5>TO$FbQUO,5>TO$FlQUO,5>TO$FqQUO,5>TO$FvQUO,5>TO!6nQUO,5>TO$HtQUO'#KZO$H{QUO,5=oO$IWQUO,5=aOKkQUO,5=oO$JQQUO,5=sOOQR,5=s,5=sO$JYQUO,5=sO$LeQVO'#H[OOQQ,5=u,5=uO!;]QUO,5=uO%#`QUO'#KjO%#gQUO'#K[O%#{QUO'#KjO%$VQUO'#DyO%$hQUO'#D|O%'eQUO'#K[OOQQ'#K['#K[O%)WQUO'#K[O%#gQUO'#K[O%)]QUO'#K[OOQQ,59r,59rOOQQ,5>a,5>aOOQQ,5>b,5>bO%)eQUO'#HzO%)mQUO,5>cOOQQ,5>c,5>cO%-XQUO,5>cO%-dQUO,5>hO%1OQVO,5>iO%1VQUO,5>|O# hQVO'#EfO%4]QUO,5>|OOQQ,5>|,5>|O%4|QUO,5?OO%7QQUO,5?RO!<[QUO,5?RO%8|QUO,5?UO%<iQVO,5?UP!A_{,UO,58|P%<p{,UO,58|P%=O{7[O,58|P%=U{,UO,58|PO{O'#Ju'#JuP%=Z{,UO'#LcPOOO'#Lc'#LcP%=a{,UO'#LcPOOO,58|,58|POOO,5?f,5?fP%=fOSO,5?fOOOO-E<z-E<zOOQR1G.j1G.jO%=mQUO1G.pO%>sQUO1G0mOOQQ1G0m1G0mO%@PQUO'#CoO%B`QbO'#CwO%BkQUO'#CrO%BpQUO'#CrO%BuQUO1G.tO#AxQUO'#CqOOQQ1G.t1G.tO%DxQUO1G4]O%FOQUO1G4^O%GqQUO1G4^O%IdQUO1G4^O%KVQUO1G4^O%LxQUO1G4^O%NkQUO1G4^O&!^QUO1G4^O&$PQUO1G4^O&%rQUO1G4^O&'eQUO1G4^O&)WQUO1G4^O&*yQUO'#KPO&,SQUO'#KPO&,[QUO,59SOOQQ,5=P,5=PO&.dQUO,5=PO&.nQUO,5=PO&.sQUO,5=PO&.xQUO,5=PO!6nQUO,5=PO#NeQUO1G3XO&/SQUO1G4mO!<[QUO1G4mO&1OQUO1G4pO&2qQVO1G4pOOQQ1G.}1G.}OOQQ1G.|1G.|OOQQ1G2i1G2iO!IwQ&lO1G3XO&2xQUO'#LOO@XQVO'#EiO&4RQUO'#F]OOQQ'#Ja'#JaO&4WQUO'#FZO&4cQUO'#LOO&4kQUO,5;tO&4pQUO1G.qOOQQ1G.q1G.qOOQR1G/|1G/|O&6cQ!dO'#JPO&6hQbO,59xO&8yQ!eO'#D`O&9QQ!dO'#JRO&9VQbO,5@xO&9VQbO,5@xOOQR1G/c1G/cO&9bQbO1G/cO&9gQ&lO'#GeO&:eQbO,59cOOQR1G7Z1G7ZO#@[QUO1G1VO&:pQUO1G1^OBUQUO1G1VO&=RQUO'#CyO#*wQbO,59cO&@tQUO1G6sOOQR-E<{-E<{O&BWQUO1G0dO#6WQUO1G0dOOQQ-E=U-E=UO#6tQUO1G0dOOQQ1G0l1G0lO&B{QUO,59iOOQQ1G3l1G3lO&CcQUO,59iO&CyQUO,59iO!M_QVO1G4gO!(zQVO'#JYO&DeQUO,5AcOOQQ1G0o1G0oO!(zQVO1G0oO!6nQUO'#JnO&DmQUO,5AvOOQQ1G3p1G3pOOQR1G1V1G1VO&HjQVO'#FOO!M_QVO,5;sOOQQ,5;s,5;sOBUQUO'#JcO&JfQUO,5AiO&JnQVO'#E[OOQR1G1^1G1^O&M]QUO'#L[OOQR1G1n1G1nOOQR-E=f-E=fOOQR1G7]1G7]O#DhQUO1G7]OGVQUO1G7]O#DhQUO1G7_OOQR1G7_1G7_O&MeQUO'#G}O&MmQUO'#LWOOQQ,5=h,5=hO&M{QUO,5=jO&NQQUO,5=kOOQR1G7`1G7`O#EfQVO1G7`O&NVQUO1G7`O' ]QVO,5=kOOQR1G1U1G1UO$.vQUO'#E]O'!RQUO'#E]OOQQ'#Ky'#KyO'!lQUO'#KxO'!wQUO,5;UO'#PQUO'#ElO'#dQUO'#ElO'#wQUO'#EtOOQQ'#J['#J[O'#|QUO,5;cO'$sQUO,5;cO'%nQUO,5;dO'&tQVO,5;dOOQQ,5;d,5;dO''OQVO,5;dO'&tQVO,5;dO''VQUO,5;bO'(SQUO,5;eO'(_QUO'#KpO'(gQUO,5:vO'(lQUO,5;fOOQQ1G0n1G0nOOQQ'#J]'#J]O''VQUO,5;bO!4xQUO'#E}OOQQ,5;b,5;bO')gQUO'#E`O'+aQUO'#E{OHrQUO1G0nO'+fQUO'#EbOOQQ'#JX'#JXO'-OQUO'#KrOOQQ'#Kr'#KrO'-xQUO1G0eO'.pQUO1G3kO'/vQVO1G3kOOQQ1G3k1G3kO'0QQVO1G3kO'0XQUO'#L_O'1eQUO'#KXO'1sQUO'#KWO'2OQUO,59gO'2WQUO1G/`O'2]QUO'#FPOOQR1G1]1G1]OOQR1G2g1G2gO$>uQUO1G2gO'2gQUO1G2gO'2rQUO1G0ZOOQR'#J`'#J`O'2wQVO1G1XO'8pQUO'#FTO'8uQUO1G1VO!6nQUO'#JdO'9TQUO,5;|O$0^QUO,5;|OOQQ'#Fc'#FcOOQQ,5;|,5;|O'9cQUO1G1fOOQR1G1f1G1fO'9kQUO,5<XO$.vQUO'#FWOBUQUO'#FWO'9rQUO,5<XO!(zQVO,5<XO'9zQUO,5<XO':PQVO1G1qO!0tQVO1G1qOOQR1G1v1G1vO'?oQUO1G1xOOQR1G1{1G1{O'?tQUO1G1|OBUQUO1G2]O'@}QVO1G1|O'CcQUO1G1|O'ChQUO'#GWO8zQUO1G2]OOQR1G2O1G2OOOQR1G2U1G2UOOQR1G2W1G2WOOQR1G2Y1G2YO'CmQUO1G2^O!4xQUO1G2^OOQR1G2v1G2vO'CuQUO1G2vO$>}QUO1G2`OOQQ'#Cu'#CuO'CzQUO'#G[O'DuQUO'#G[O'DzQUO'#LRO'EYQUO'#G_OOQQ'#LS'#LSO'EhQUO1G2`O'EmQVO1G1kO'HOQVO'#GUOBUQUO'#FWOOQR'#Je'#JeO'EmQVO1G1kO'HYQUO'#FvOOQR1G2f1G2fO'H_QUO1G2gO'HdQUO'#JgO'2gQUO1G2gO!(zQVO1G2tO'HlQUO1G2xO'IuQUO1G3QO'J{QUO1G3XOOQQ1G3o1G3oO'KaQUO1G3oOOQR1G3Z1G3ZO'KfQUO'#KZO'2]QUO'#LTOGkQUO'#LVOOQR'#Gy'#GyO#DhQUO'#LXOOQR'#HQ'#HQO'KpQUO'#GvO'#wQUO'#GuOOQR1G2{1G2{O'LmQUO1G2{O'MdQUO1G3ZO'MoQUO1G3_O'MtQUO1G3_OOQR1G3_1G3_O'M|QUO'#H]OOQR'#H]'#H]O( VQUO'#H]O!(zQVO'#H`O!(zQVO'#H_OOQR'#LZ'#LZO( [QUO'#LZOOQR'#Jk'#JkO( aQVO,5=vOOQQ,5=v,5=vO( hQUO'#H^O( pQUO'#HZOOQQ1G3a1G3aO( zQUO,5@vOOQQ,5@v,5@vO%)WQUO,5@vO%)]QUO,5@vO%$VQUO,5:eO(%iQUO'#KkO(%wQUO'#KkOOQQ,5:e,5:eOOQQ'#JS'#JSO(&SQUO'#D}O(&^QUO'#KqOGkQUO'#LVO('YQUO'#D}OOQQ'#Hp'#HpOOQQ'#Hr'#HrOOQQ'#Hs'#HsOOQQ'#Kl'#KlOOQQ'#JU'#JUO('dQUO,5:hOOQQ,5:h,5:hO((aQUO'#LVO((nQUO'#HtO()UQUO,5@vO()]QUO'#H{O()hQUO'#L^O()pQUO,5>fO()uQUO'#L]OOQQ1G3}1G3}O(-lQUO1G3}O(-sQUO1G3}O(-zQUO1G4TO(/QQUO1G4TO(/VQUO,5A|O!6nQUO1G4hO!(zQVO'#IiOOQQ1G4m1G4mO(/[QUO1G4mO(1_QVO1G4pPOOO1G.h1G.hP!A_{,UO1G.hP(3_QUO'#LeP(3j{,UO1G.hP(3o{7[O1G.hPO{O-E=s-E=sPOOO,5A},5A}P(3w{,UO,5A}POOO1G5Q1G5QO!(zQVO7+$[O(3|QUO'#CyOOQQ,59^,59^O(4XQbO,59cO(4dQbO,59^OOQQ,59],59]OOQQ7+)w7+)wO!M_QVO'#JtO(4oQUO,5@kOOQQ1G.n1G.nOOQQ1G2k1G2kO(4wQUO1G2kO(4|QUO7+(sOOQQ7+*X7+*XO(7bQUO7+*XO(7iQUO7+*XO(1_QVO7+*[O#NeQUO7+(sO(7vQVO'#JbO(8ZQUO,5AjO(8cQUO,5;vOOQQ'#Co'#CoOOQQ,5;w,5;wO!(zQVO'#F[OOQQ-E=_-E=_O!M_QVO,5;uOOQQ1G1`1G1`OOQQ,5?k,5?kOOQQ-E<}-E<}OOQR'#Dg'#DgOOQR'#Di'#DiOOQR'#Dl'#DlO(9lQ!eO'#K_O(9sQMkO'#K_O(9zQ!eO'#K_OOQR'#K_'#K_OOQR'#JQ'#JQO(:RQ!eO,59zOOQQ,59z,59zO(:YQbO,5?mOOQQ-E=P-E=PO(:hQbO1G6dOOQR7+$}7+$}OOQR7+&q7+&qOOQR7+&x7+&xO'8uQUO7+&qO(:sQUO7+&OO#6WQUO7+&OO(;hQUO1G/TO(<OQUO1G/TO(<jQUO7+*ROOQQ7+*V7+*VO(>]QUO,5?tOOQQ-E=W-E=WO(?fQUO7+&ZOOQQ,5@Y,5@YOOQQ-E=l-E=lO(?kQUO'#LOO@XQVO'#EiO(@wQUO1G1_OOQQ1G1_1G1_O(BQQUO,5?}OOQQ,5?},5?}OOQQ-E=a-E=aO(BfQUO'#KpOOQR7+,w7+,wO#DhQUO7+,wOOQR7+,y7+,yO(BsQUO,5=iO#DsQUO'#JjO(CUQUO,5ArOOQR1G3U1G3UOOQR1G3V1G3VO(CdQUO7+,zOOQR7+,z7+,zO(E[QUO,5:wO(FyQUO'#EwO!(zQVO,5;VO(GlQUO,5:wO(GvQUO'#EpO(HXQUO'#EzOOQQ,5;Z,5;ZO#K]QVO'#ExO(HoQUO,5:wO(HvQUO'#EyO#GgQUO'#JZO(J`QUO,5AdOOQQ1G0p1G0pO(JkQUO,5;WO!<[QUO,5;^O(KUQUO,5;_O(KdQUO,5;WO(MvQUO,5;`OOQQ-E=Y-E=YO(NOQUO1G0}OOQQ1G1O1G1OO(NyQUO1G1OO)!PQVO1G1OO)!WQVO1G1OO)!bQUO1G0|OOQQ1G0|1G0|OOQQ1G1P1G1PO)#_QUO'#JoO)#iQUO,5A[OOQQ1G0b1G0bOOQQ-E=Z-E=ZO)#qQUO,5;iO!<[QUO,5;iO)$nQVO,5:zO)$uQUO,5;gO$ mQUO7+&YOOQQ7+&Y7+&YO!(zQVO'#EfO)$|QUO,5:|OOQQ'#Ks'#KsOOQQ-E=V-E=VOOQQ,5A^,5A^OOQQ'#Jl'#JlO)(qQUO7+&PPOQQ7+&P7+&POOQQ7+)V7+)VO))iQUO7+)VO)*oQVO7+)VOOQQ,5>m,5>mO$)YQVO'#JsO)*vQUO,5@rOOQQ1G/R1G/ROOQQ7+$z7+$zO)+RQUO7+(RO)+WQUO7+(ROOQR7+(R7+(RO$>uQUO7+(ROOQQ7+%u7+%uOOQR-E=^-E=^O!0VQUO,5;oOOQQ,5@O,5@OOOQQ-E=b-E=bO$0^QUO1G1hOOQQ1G1h1G1hOOQR7+'Q7+'QOOQR1G1s1G1sOBUQUO,5;rO)+tQUO,5<YO)+{QUO1G1sO)-UQUO1G1sO!0tQVO7+']O)-ZQVO7+']O)2yQUO7+'dO)3OQVO7+'hO)5dQUO7+'wO)5nQUO7+'hO)6tQVO7+'hOKkQUO7+'wO$>hQUO,5<rO!4xQUO7+'xO)6{QUO7+'xOOQR7+(b7+(bO)7QQUO7+'zO)7VQUO,5<vO'CzQUO,5<vO)7}QUO,5<vO'CzQUO,5<vOOQQ,5<w,5<wO)8`QVO,5<xO'EYQUO'#JfO)8jQUO,5AmO)8rQUO,5<yOOQR7+'z7+'zO)8}QVO7+'VO)5gQUO'#K}OOQR-E=c-E=cO);`QVO,5<bOOQQ,5@R,5@RO!6nQUO,5@ROOQQ-E=e-E=eO)=wQUO7+(`O)>}QUO7+(dO)?SQVO7+(dOOQQ7+(l7+(lOOQQ7+)Z7+)ZO)?[QUO'#KjO)?fQUO'#KjOOQR,5=b,5=bO)?sQUO,5=bO!;bQUO,5=bO!;bQUO,5=bO!;bQUO,5=bOOQR7+(g7+(gOOQR7+(u7+(uOOQR7+(y7+(yOOQR,5=w,5=wO)?xQUO,5=zO)AOQUO,5=yOOQR,5Au,5AuOOQR-E=i-E=iOOQQ1G3b1G3bO)BUQUO,5=xO)BZQVO'#EfOOQQ1G6b1G6bO%)WQUO1G6bO%)]QUO1G6bOOQQ1G0P1G0POOQQ-E=Q-E=QO)DrQUO,5AVO(%iQUO'#JTO)D}QUO,5AVO)D}QUO,5AVO)EVQUO,5:iO8zQUO,5:iOOQQ,5>],5>]O)EaQUO,5AqO)EhQUO'#EVO)FrQUO'#EVO)G]QUO,5:iO)GgQUO'#HlO)GgQUO'#HmOOQQ'#Ko'#KoO)HUQUO'#KoO!(zQVO'#HnOOQQ,5:i,5:iO)HvQUO,5:iO!M_QVO,5:iOOQQ-E=S-E=SOOQQ1G0S1G0SOOQQ,5>`,5>`O)H{QUO1G6bO!(zQVO,5>gO)LjQUO'#JrO)LuQUO,5AxOOQQ1G4Q1G4QO)L}QUO,5AwOOQQ,5Aw,5AwOOQQ7+)i7+)iO*!lQUO7+)iOOQQ7+)o7+)oO*'kQVO1G7hO*)mQUO7+*SO*)rQUO,5?TO**xQUO7+*[POOO7+$S7+$SP*,kQUO'#LfP*,sQUO,5BPP*,x{,UO7+$SPOOO1G7i1G7iO*,}QUO<<GvOOQQ1G.x1G.xOOQQ'#IT'#ITO*.pQUO,5@`OOQQ,5@`,5@`OOQQ-E=r-E=rOOQQ7+(V7+(VOOQQ<<Ms<<MsO*/yQUO<<MsO*1|QUO<<MvO*3oQUO<<L_O*4TQUO,5?|OOQQ,5?|,5?|OOQQ-E=`-E=`OOQQ1G1b1G1bO*5^QUO,5;vO*6dQUO1G1aOOQQ1G1a1G1aOOQR,5@y,5@yO*7mQ!eO,5@yO*7tQMkO,5@yO*7{Q!eO,5@yOOQR-E=O-E=OOOQQ1G/f1G/fO*8SQ!eO'#DwOOQQ1G5X1G5XOOQR<<J]<<J]O*8ZQUO<<IjO*9OQUO7+$oOOQQ<<Iu<<IuO(7vQVO,5;ROOQR<=!c<=!cOOQQ1G3T1G3TOOQQ,5@U,5@UOOQQ-E=h-E=hOOQR<=!f<=!fO*9{QUO1G0cO*:SQUO'#EzO*:dQUO1G0cO*:kQUO'#I}O*<RQUO1G0qO!(zQVO1G0qOOQQ,5;[,5;[OOQQ,5;],5;]OOQQ,5?u,5?uOOQQ-E=X-E=XO!<[QUO1G0xO*=bQUO1G0xOOQQ1G0y1G0yO*=sQUO'#ElOOQQ1G0z1G0zOOQQ7+&j7+&jO*>XQUO7+&jO*?_QVO7+&jOOQQ7+&h7+&hOOQQ,5@Z,5@ZOOQQ-E=m-E=mO*@ZQUO1G1TO*@eQUO1G1TO*AOQUO1G0fOOQQ1G0f1G0fO*BUQUO'#K{O*B^QUO1G1ROOQQ<<It<<ItOOQQ'#Hb'#HbO'+fQUO,5={OOQQ'#Hd'#HdO'+fQUO,5=}OOQQ-E=j-E=jPOQQ<<Ik<<IkPOQQ-E=k-E=kOOQQ<<Lq<<LqO*BcQUO'#LaO*CoQUO'#L`OOQQ,5@_,5@_OOQQ-E=q-E=qOOQR<<Km<<KmO$>uQUO<<KmO*C}QUO<<KmOOQR1G1Z1G1ZOOQQ7+'S7+'SO!M_QVO1G1tO*DSQUO1G1tOOQR7+'_7+'_OOQR<<Jw<<JwO!0tQVO<<JwOOQR<<KO<<KOO*D_QUO<<KSO*EeQVO<<KSOKkQUO<<KcO!M_QVO<<KcO*ElQUO<<KSO!0tQVO<<KSO*FuQUO<<KSO*FzQUO<<KcO*GVQUO<<KdOOQR<<Kd<<KdOOQR<<Kf<<KfO*G[QUO1G2bO)7VQUO1G2bO'CzQUO1G2bO*GmQUO1G2dO*HsQVO1G2dOOQQ1G2d1G2dO*H}QVO1G2dO*IUQUO,5@QOOQQ-E=d-E=dOOQQ1G2e1G2eO*IdQUO1G1|O*JmQVO1G1|O*JtQUO1G1|OOQQ1G5m1G5mOOQR<<Kz<<KzOOQR<<LO<<LOO*JyQVO<<LOO*KUQUO<<LOOOQR1G2|1G2|O*KZQUO1G2|O*KbQUO1G3eOOQR1G3d1G3dOOQQ7++|7++|O%)WQUO7++|O*KmQUO1G6qO*KmQUO1G6qO(%iQUO,5?oO*KuQUO,5?oOOQQ-E=R-E=RO*LQQUO1G0TOOQQ1G0T1G0TO*L[QUO1G0TO!M_QVO1G0TO*LaQUO1G0TOOQQ1G3w1G3wO*LkQUO,5:qO)EhQUO,5:qO*MXQUO,5:qO)EhQUO,5:qO$#uQUO,5:uO*MvQVO,5>VO)GgQUO'#JpO*NQQUO1G0TO*NcQVO1G0TOOQQ1G3u1G3uO*NjQUO,5>WO*NuQUO,5>XO+ dQUO,5>YO+!jQUO1G0TO%)]QUO7++|O+#pQUO1G4ROOQQ,5@^,5@^OOQQ-E=p-E=pOOQQ<<MT<<MTOOQQ<<Mn<<MnO+$yQUO1G4oP+&|QUO'#JvP+'UQUO,5BQPO{O1G7k1G7kPOOO<<Gn<<GnOOQQANC_ANC_OOQR1G6e1G6eO+'^Q!eO,5:cOOQQ,5:c,5:cO+'eQUO1G0mO+(qQUO7+&]O+*QQUO7+&dO+*cQUO,5;WOOQQ<<JU<<JUO+*qQUO7+&oOOQQ7+&Q7+&QO!4xQUO'#J^O++lQUO,5AgOOQQ7+&m7+&mOOQQ1G3g1G3gO++tQUO1G3iOOQQ,5>n,5>nO+/iQUOANAXOOQRANAXANAXO+/nQUO7+'`OOQRAN@cAN@cO+0zQVOAN@nO+1RQUOAN@nO!0tQVOAN@nO+2[QUOAN@nO+2aQUOAN@}O+2lQUOAN@}O+3rQUOAN@}OOQRAN@nAN@nO!M_QVOAN@}OOQRANAOANAOO+3wQUO7+'|O)7VQUO7+'|OOQQ7+(O7+(OO+4YQUO7+(OO+5`QVO7+(OO+5gQVO7+'hO+5nQUOANAjOOQR7+(h7+(hOOQR7+)P7+)PO+5sQUO7+)PO+5xQUO7+)POOQQ<= h<= hO+6QQUO7+,]O+6YQUO1G5ZOOQQ1G5Z1G5ZO+6eQUO7+%oOOQQ7+%o7+%oO+6vQUO7+%oO*NcQVO7+%oOOQQ7+)a7+)aO+6{QUO7+%oO+8RQUO7+%oO!M_QVO7+%oO+8]QUO1G0]O*LkQUO1G0]O)EhQUO1G0]OOQQ1G0a1G0aO+8zQUO1G3qO+:QQVO1G3qOOQQ1G3q1G3qO+:[QVO1G3qO+:cQUO,5@[OOQQ-E=n-E=nOOQQ1G3r1G3rO%)WQUO<= hOOQQ7+*Z7+*ZPOQQ,5@b,5@bPOQQ-E=t-E=tOOQQ1G/}1G/}OOQQ,5?x,5?xOOQQ-E=[-E=[OOQRG26sG26sO+:zQUOG26YO!0tQVOG26YO+<TQUOG26YOOQRG26YG26YO!M_QVOG26iO!0tQVOG26iO+<YQUOG26iO+=`QUOG26iO+=eQUO<<KhOOQQ<<Kj<<KjOOQRG27UG27UOOQR<<Lk<<LkO+=vQUO<<LkOOQQ7+*u7+*uOOQQ<<IZ<<IZO+={QUO<<IZO!M_QVO<<IZO+>QQUO<<IZO+?WQUO<<IZO*NcQVO<<IZOOQQ<<L{<<L{O+?iQUO7+%wO*LkQUO7+%wOOQQ7+)]7+)]O+@WQUO7+)]O+A^QVO7+)]OOQQANESANESO!0tQVOLD+tOOQRLD+tLD+tO+AeQUOLD,TO+BkQUOLD,TOOQRLD,TLD,TO!0tQVOLD,TOOQRANBVANBVOOQQAN>uAN>uO+BpQUOAN>uO+CvQUOAN>uO!M_QVOAN>uO+C{QUO<<IcOOQQ<<Lw<<LwOOQR!$( `!$( `O!0tQVO!$( oOOQR!$( o!$( oOOQQG24aG24aO+DjQUOG24aO+EpQUOG24aOOQR!)9EZ!)9EZOOQQLD){LD){O+EuQUO'#CgO(dQUO'#CgO+IrQUO'#CyO+LcQUO'#CyO!E{QUO'#CyO+M[QUO'#CyO+MoQUO'#CyO,#bQUO'#CyO,#rQUO'#CyO,$PQUO'#CyO,$[QbO,59cO,$gQbO,59cO,$rQbO,59cO,$}QbO'#CwO,%`QbO'#CwO,%qQbO'#CwO,&SQUO'#CgO,(gQUO'#CgO,(tQUO'#CgO,+iQUO'#CgO,.lQUO'#CgO,.|QUO'#CgO,2uQUO'#CgO,2|QUO'#CgO,3|QUO'#CgO,6VQUO,5:xO#?kQUO,5:xO#?kQUO,5:xO#=ZQUO'#L[O,6sQbO'#CwO,7OQbO'#CwO,7ZQbO'#CwO,7fQbO'#CwO#6tQUO'#E^O,7qQUO'#E^O,9OQUO'#HgO,9pQbO'#CwO,9{QbO'#CwO,:WQUO'#CvO,:]QUO'#CvO,:bQUO'#CoO,:pQbO,59cO,:{QbO,59cO,;WQbO,59cO,;cQbO,59cO,;nQbO,59cO,;yQbO,59cO,<UQbO,59cO,6VQUO1G0dO,<aQUO1G0dO#?kQUO1G0dO,7qQUO1G0dO,>nQUO'#KZO,?OQUO'#CyO,?^QbO,59cO,6VQUO7+&OO,<aQUO7+&OO,?iQUO'#EwO,@[QUO'#EzO,@{QUO'#E^O,AQQUO'#GcO,AVQUO'#CvO,A[QUO'#CwO,AaQUO'#CwO,AfQUO'#CvO,AkQUO'#GcO,ApQUO'#KZO,B^QUO'#KZO,BhQUO'#CvO,BsQUO'#CvO,COQUO'#CvO,<aQUO,5:xO,7qQUO,5:xO,7qQUO,5:xO,CZQUO'#KZO,CnQbO'#CwO,CyQUO'#CrO,DOQUO'#E^",stateData:",Dt~O(nOSSOSTOSRPQVPQ'ePQ'gPQ'hPQ'iPQ'jPQ'kPQ'lPQ'mPQ~O*ZOS~OPmO]eOa!]Od!POlTOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!TxO!VfO!X!XO!Y!WO!i!YO!opO!r!`O!s!aO!t!aO!u!bO!v!aO!x!cO!{!dO#V#QO#a#VO#b#TO#i#OO#p!xO#t!fO#v!eO$R!gO$T!hO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO${!tO$}!uO%U!yO%_#ZO%`#[O%a#YO%c!zO%e#UO%g!{O%l#SO%o!|O%v!}O%|#PO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(rRO)PYO)SaO)U|O)V{O)WiO)X!ZO)YXO)hcO)idO~OR#bOV#]O'e#^O'g#_O'h#`O'i#`O'j#aO'k#aO'l#_O'm#_O~OX#dO(p#dO(q#fO~O]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!TiX!VZX!ViX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX(uZX(v$]X(wZX(xZX)SZX)SiX)TZX)UZX)UiX)VZX)ViX)WZX)XZX)jZX~O)WiX!UZX~P(dO]#}O!V#lO!X#{O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO(w#kO(x#kO)S#mO)T#oO)U#nO)V#pO)W#jO)X#|O~Od$RO%Y$SO'[$TO'_$UO(y$OO~Ol$VO~O!T$WO](}Xd(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)W(}X~Ol$VO~P.ZOl$VO!g$YO)j$YO~OX$ZO)Z$ZO~O!R$[O)X)QP)])QP~OPmO]$eOa!]Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!TxO!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~Ol$_O#t$lO(rRO~P0zO](]Xa'yXd(]Xl'yXl(]Xr'yXr(]Xs'yXs(]Xt'yXt(]Xu'yXu(]Xv'yXv(]Xw'yXw(]Xx'yXx(]Xy'yXy(]X{'yX}'yX!V(]X!o(]X!r'yX!r(]X!s'yX!s(]X!t'yX!t(]X!u'yX!u(]X!v'yX!v(]X!x'yX!x(]X!{(]X#a'yX#b'yX%e'yX%l'yX%o(]X%v(]X&m'yX&r'yX&s'yX(r'yX(r(]X)S(]X)U(]X)V(]X~Oa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO&r#WO&s$wO])aXd)aXl)aX!V)aX!{)aX%v)aX(r)aX)S)aX)U)aX)V)aX~O)W$vO~P:nOPmO]eOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!VfO!X!XO!Y!WO!i!YO!{!dO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)SaO)U|O)V{O)X!ZO)YXO)hcO)idO~Oa%QOl:zO!|%RO(r$xO~P<lO)S%SO~Oa!]Ol$_O{#RO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r:}O~P<lOPmO]$eOa%QOl:zO!V$fO!W%_O!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V%]O)X!ZO)YXO)hcO)idO)j%[O~O]%hOd!POl%bO!V%kO!{!dO%v$mO(r;OO)S%dO)U%iO)V%iO~O(v%mO~O)W#jO~O(r%nO](tX!V(tX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!g(tX)j(tX!O(tX!W(tX(v(tX!U(tXQ(tX!d(tX~OP%oO(oQO~PCQO]%hOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V%kO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO!{!dO%o!|O%v!}O)S;`O)U|O)V|O~Ol%rO!o%wO(r$xO~PE_O!TxO#v!eO(v%yO)j%|O])eX!V)eX~O]%hOd!POl%rO!V%kO!{!dO%v!}O(r$xO)S;`O)U|O)V|O~O!TxO#v!eO)W&PO)j&QO~O!U&TO~P!QO]&YO!TxO!V&WO)S&VO)U&ZO)V&ZO~Op&UO~PHrO]&cO!V&bO~OPmO]eOd!PO!VfO!X!XO!Y!WO!i!YO!{!dO#V#QO%_#ZO%`#[O%a#YO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)SaO)U|O)V{O)X!ZO)YXO)hcO)idO~Oa%QOl:zO%v$mO(r$xO~PIgO]%hOd!POl;[O!V%kO!{!dO%v$mO(r$xO)S;`O)U|O)V|O~Op&fO](tX])eX!V(tX!V)eX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!O(tX!O)eX!U(tX~O!g$YO)j$YO~PL]O!g(tX)j(tX~PL]O](tX!V(tX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!g(tX)j(tX!O(tX!U(tX~O])eX!V)eX!O)eX~PNkOa&hO&m!RO]&lXd&lXl&lXr&lXs&lXt&lXu&lXv&lXw&lXx&lXy&lX}&lX!V&lX!r&lX!s&lX!t&lX!u&lX!v&lX!x&lX!{&lX%v&lX&r&lX&s&lX(r&lX)S&lX)U&lX)V&lX)W&lX!O&lX!T&lX!X&lX!Y&lX![&lX!^&lX!_&lX!a&lX!b&lX!c&lX!e&lX!f&lX!h&lX(u&lX(w&lX(x&lX)T&lX)X&lX!g&lX)j&lX!W&lXQ&lX!d&lX(v&lX!U&lX#v&lX~Op&fOl(}X!O(}XQ(}X!d(}X!h(}X)X(}X)j(}X~P.ZO!g$YO)j$YO](tX!V(tX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!O(tX!W(tX(v(tX!U(tXQ(tX!d(tX~OPmO]$eOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O](}Xd(}Xl(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)W(}X!O(}XQ(}X!d(}X!h(}X)X(}X)j(}X~O]#}O~P!*qO]&lO~O])bXa)bXd)bXl)bXr)bXs)bXt)bXu)bXv)bXw)bXx)bXy)bX{)bX})bX!V)bX!o)bX!r)bX!s)bX!t)bX!u)bX!v)bX!x)bX!{)bX#a)bX#b)bX%e)bX%l)bX%o)bX%v)bX&m)bX&r)bX&s)bX(r)bX)S)bX)U)bX)V)bX~O(oQO~P!-ZO%U&nO~P!-ZO]&oO~O]#}O~O!TxO~O$W&wO(r%nO(v&vO~O]&xOw&zO~O]&xO~OPmO]$eOa%QOl:zO!TxO!V$fO!X!XO!Y!WO!i!YO#V#QO#p!xO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:mO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~O]'PO~O!T$WO)W'RO~P!(zO)W'TO~O)W'UO~O(r'VO~O)W'YO~P!(zOl;^O%U'^O%e'^O(r;PO~Oa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO~O(v'bO~O)W'dO~P!(zO!TxO(r%nO)j'fO~O(r%nO~O]'iO~O]'jOd%nXl%nX!V%nX!{%nX%v%nX(r%nX)S%nX)U%nX)V%nX~O]'nO!V'oO!X'lO!g'lO%Z'lO%['lO%]'lO%^'lO%_'pO%`'pO%a'lO(x'mO)j'lO)x'qO~P8zO]%hOa!TOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V%kO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO!{!dO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO)S;`O)U|O)V|O~Ol;_Op&UO%v$mO(r;QO~P!8jO(r%nO(v'vO)W'wO~O]&cO!T'yO~Ol$oO}!_O!T(QO!l(VO(r$nO(v(PO)PYO~Ol$oO{(^O!T(ZO#b(^O(r$nO~Oa!TOl$oO{#RO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO~O](`O~OPmOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)YXO)hcO)idO~O](bO)X(cO~P!=UO]#}O~P!<[OPmO]$eOa%QOl:zO!V(iO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~OY(jO(oQO(r%nO~O'f(mO~OS(qOT(nO*W(pO~O]#}O(n(tO~Q'nXX#dO(p#dO(q(vO~Od)QOl({O&r#WO(r(zO~O!Y'Sa!['Sa!^'Sa!_'Sa!a'Sa!b'Sa!c'Sa!e'Sa!f'Sa!h'Sa(u'Sa)S'Sa)T'Sa)U'Sa)V'Sa)W'Sa)X'Sa!g'Sa)j'Sa!O'Sa!W'Sa(v'Sa!U'SaQ'Sa!d'Sa~OPmOa%QOl:zO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)YXO)hcO)idO]'Sa!V'Sa!X'Sa(w'Sa(x'Sa~P!B_O!T$WO!O(sP~P!(zO]nX]%WXdnXlmXpnXp%WXrnXsnXtnXunXvnXwnXxnXynX}nX!TnX!VnX!V%WX!X%WX!Y%WX![%WX!^%WX!_%WX!a%WX!b%WX!c%WX!e%WX!f%WX!gmX!h%WX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX(u%WX(w%WX(x%WX)SnX)S%WX)T%WX)UnX)U%WX)VnX)V%WX)W%WX)X%WX)jmX!O%WX~O)WnX!OnX!U%WX~P!E{O])dO!V)eO!X)bO!g)bO%Z)bO%[)bO%])bO%^)bO%_)fO%`)fO%a)bO(x)cO)j)bO)x)gO~P8zOPmO]$eOa%QOl:zO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O!V)lO~P!JwOd)oO%Y)pO(y$OO~O!T$WO!V)rO(w)sO!U)rP~P!JwO!T$WO~P!(zO)[)zO~Ol){O]!QX!h!QX)X!QX)]!QX~O])}O!h*OO)X)QX)])QX~O)X*SO)]*RO~Od$RO%Y*TO'[$TO'_$UO(y$OO~Ol*UO~Ol*UO!O(}X~P.ZOl*UO!g$YO)j$YO~O)W*VO~P:nOPmO]$eOa!]Ol$_Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)S$kO)V$kO)X!ZO)YXO)hcO)idO~Op&fO~P!&zOp&fO!W(tX(v(tXQ(tX!d(tX~PNkO]'nO!V'oO!X'lO!g'lO%Z'lO%['lO%]'lO%^'lO%_'pO%`'pO%a'lO(x'mO)j'lO)x'qO~O]iXdiXlgXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX!TiX!hiX)XiX)jiX!OiX~O!liX(viX)WiX!XiX!YiX![iX!^iX!_iX!aiX!biX!ciX!eiX!fiX(uiX(wiX(xiX)TiX!giX!WiXQiX!diX!UiX#viX#TiX#ViX#piXaiX{iX!oiX#aiX#biX#iiX#tiX${iX%ciX%eiX%kiX%liX%oiX&miX)PiX~P#%yO(y*ZO~Ol*[O~O](}Xd(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)W(}X!T(}X!X(}X!Y(}X![(}X!^(}X!_(}X!a(}X!b(}X!c(}X!e(}X!f(}X!h(}X(u(}X(w(}X(x(}X)T(}X)X(}X!g(}X)j(}X!O(}X!W(}XQ(}X!d(}X(v(}X!U(}X#v(}X~Ol*[O~P#+ROr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO])aad)aal)aa!V)aa!{)aa%v)aa(r)aa)S)aa)U)aa)V)aaQ)aa!d)aa!h)aa)X)aa)j)aa!O)aa!T)aa(v)aa)W)aa~O&r#WO&s$wO~P#.qOp&fOl(}X~P#+RO&r)aa~P#.qO]ZXlgXpZXpiX!TiX!VZX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX(uZX(wZX(xZX)SZX)TZX)UZX)VZX)WZX)XZX)jZX!OZX~O!WZX(vZX!UZXQZX!dZX~P#1jO]#}O!V#lO!X#{O(w#kO(x#kO~O!Y&xa![&xa!^&xa!_&xa!a&xa!b&xa!c&xa!e&xa!f&xa!g&xa!h&xa(u&xa)S&xa)T&xa)U&xa)V&xa)W&xa)X&xa)j&xa!O&xa!W&xa(v&xa!U&xaQ&xa!d&xa~P#3zOl;hO!T$WO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~PKkOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!|%RO~PKkO]&cO!V&bO!O#Qa!T#Qa!h#Qa#v#Qa)W#Qa)j#QaQ#Qa!d#Qa(v#Qa~Op&fO!T$WO~O!O*cO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O*cO~O]&cO!O*eO!V&bO~O]&YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V&WO&r#WO&s$wO)S&VO)U&ZO)V&ZO~O!OqXQqX!dqX!hqX)XqX)WqX~P#9{O!O*hO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h*iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!W)kX~P#3zO!W*kO!h*lO~O!W*kO!h*lO~P!(zO!W*kO~Op&fO!g$YO!h*mO)j$YO](tX!V(tX!W(tX!W*OX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)X(tX~O!h(tX~P#=ZO!W*oO~Od$RO%Y*TO(y:rO~Ol;kO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!|%RO~PBUO]*vO!T*qO!V&bO!h*tO#v!eO)j*rO)W)qX~O!h*tO)W)qX~O)W*wO~Op&fO])eX!T)eX!V)eX!h)eX#v)eX)W)eX)j)eX!O)eXQ)eX!d)eX(v)eX~Op&fO~OP%oO(oQO]%ha!V%ha!X%ha!Y%ha![%ha!^%ha!_%ha!a%ha!b%ha!c%ha!e%ha!f%ha!h%ha(r%ha(u%ha(w%ha(x%ha)S%ha)T%ha)U%ha)V%ha)W%ha)X%ha!g%ha)j%ha!O%ha!W%ha(v%ha!U%haQ%ha!d%ha~Od$RO%Y$SO(y:oO~Ol:wO~O!TxO#v!eO)j%|O~Ol<[O&r#WO(r;gO~O$Z+TO%`+UO~O!TxO#v!eO)W+VO)j+WO~OPmO]$eOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO$Z+TO%_#ZO%`+YO%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O!U+ZO~P!QOa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#a+aO#b+bO#i+cO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO)PYO~OQ)lP!d)lP~P#GgO]&YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V&WO)S&VO)U&ZO)V&ZO~O!O#kX!T#kX#v#kX)W#kX)j#kXQ#kX!d#kX!h#kX)X#kX!x#kX(v#kX~P#IkOPmO]$eOa%QOl:zOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V$fO!W+iO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S+jO)V$kO)X!ZO)YXO)hcO)idO~O]&cO!V+kO~O]&YO!V&WO)PYO)S&VO)U&ZO)V&ZO)X+nO!O)dP~P8zO]&YO!V&WO)S&VO)U&ZO)V&ZO~O!O#nX!T#nX#v#nX)W#nX)j#nXQ#nX!d#nX!h#nX)X#nX!x#nX(v#nX~P#NeO!TxO])nX!V)nX~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O#T+vO#p+wO(x+tO)U+rO)V+rO~O]#jX!T#jX!V#jX!O#jX#v#jX)W#jX)j#jXQ#jX!d#jX!h#jX)X#jX!x#jX(v#jX~P$ xO#V+yO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!l+zO#T+vO#V+yO#p+wO(x+tO)U+zO)V+zO])fP!T)fP!V)fP#v)fP(v)fP)j)fP!O)fP!h)fP)W)fP~O!x)fPQ)fP!d)fP~P$#uOPmO]$eOa%QOl:zOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)V$kO)X!ZO)YXO)hcO)idO~O!W,QO)S,RO~P$%pO)PYO)X+nO!O)dP~P8zO]&cO!V&bO!O&Za!T&Za!h&Za#v&Za)W&Za)j&ZaQ&Za!d&Za(v&Za~OPmO]$eOa!]Ol:|Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r;RO)S$kO)V$kO)X!ZO)YXO)hcO)idO~OQ(zP!d(zP~P$)YO]#}O!V#lO(w#kO(x#kO!X'Pa!Y'Pa!['Pa!^'Pa!_'Pa!a'Pa!b'Pa!c'Pa!e'Pa!f'Pa!h'Pa(u'Pa)S'Pa)T'Pa)U'Pa)V'Pa)W'Pa)X'Pa!g'Pa)j'Pa!O'Pa!W'Pa(v'Pa!U'PaQ'Pa!d'Pa~O]#}O!V#lO!X#{O(w#kO(x#kO~P!B_O!TxO#t!fO)PYO~P8zO!TxO(r%nO)j,[O~O#x,aO~OQ)aX!d)aX!h)aX)X)aX)j)aX!O)aX!T)aX(v)aX)W)aX~P:nO(v,eO(w,cO)P$UX)W$UX~O(r,fO~O)PYO)W,iO~OPmO]$eOa!]Ol:{Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~O(r;SO~P$0kOPmO]$eOa%QOl:zO!TxO!V$fO!X!XO!Y!WO!i!YO#V#QO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:mO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~O$h,sO~OPmO]$eOa!]Ol:{Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO$}!uO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O${,yO(r:}O)W,wO~P$7UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W,{O)X#|O~P#3zO)W,{O~O)W,|O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W,}O)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W-OO)X#|O~P#3zOp&fO)PYO)j-QO~O)W-RO~Ol;^O(r;PO~O]-YO!{!dO&r#WO&s$wO(r-UO)S-VO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO(v-]O)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!TxO$`!iO$e!jO$g!kO$h!lO$k-bO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO$}!uO(r:nOd$Xa!o$Xa!{$Xa#i$Xa#p$Xa#t$Xa#v$Xa$R$Xa$T$Xa$Y$Xa$Z$Xa${$Xa%U$Xa%c$Xa%g$Xa%o$Xa%|$Xa(k$Xa)U$Xa!U$Xa$c$Xa~P$0kO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W-cO)X#|O~P#3zOl-eO!TxO)j,[O~O)j-gO~O]&]a!X&]a!Y&]a![&]a!^&]a!_&]a!a&]a!b&]a!c&]a!e&]a!f&]a!h&]a(u&]a(w&]a(x&]a)T&]a)U&]a)V&]a)W&]a)X&]a!g&]a)j&]a!O&]a!W&]a!T&]a#v&]a(v&]a!U&]aQ&]a!d&]a~O)S-kO!V&]a~P$DbO!O-kO~O!W-kO~O!V-lO)S&]a~P$DbO](}Xd(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X~Ol;mO~P$GQO]&cO!V&bO)W-mO~Ol;cO!o-pO#V+yO#i-uO#t!fO${,yO%c!zO%k-tO%o!|O%v!}O(r;TO)PYO~P!8jO!n-yO(r,fO~O)PYO)W-{O~OPmO]$eOa%QOl:zO!T.QO!V$fO!X!XO!Y!WO!i!YO#V.XO#a.WO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO(x.PO)S$kO)V$kO)W-}O)X!ZO)YXO)hcO)idO~O!U.VO~P$JbO])^Xd)^Xr)^Xs)^Xt)^Xu)^Xv)^Xw)^Xx)^Xy)^X})^X!T)^X!V)^X!l)^X!r)^X!s)^X!t)^X!u)^X!v)^X!x)^X!{)^X%v)^X&r)^X&s)^X(r)^X(v)^X)S)^X)U)^X)V)^X)W)^X!O)^X!h)^X)X)^X!X)^X!Y)^X![)^X!^)^X!_)^X!a)^X!b)^X!c)^X!e)^X!f)^X(u)^X(w)^X(x)^X)T)^X!g)^X)j)^X!W)^XQ)^X!d)^X#T)^X#V)^X#p)^X#v)^Xa)^X{)^X!o)^X#a)^X#b)^X#i)^X#t)^X${)^X%c)^X%e)^X%k)^X%l)^X%o)^X&m)^X)P)^X!U)^X~Ol*[O~P$LlOl$oO!T(QO!l.^O(r$nO(v(PO)PYO~Op&fOl)^X~P$LlOl$oO!n.cO!o.cO(r$nO)PYO~Ol;dO!U.nO!n.pO!o.oO#i-uO${!tO$}!uO%g!{O%k-tO%o!|O%v!}O(r;VO)PYO~P!8jO!T(QO!l.^O(v(PO])OXd)OXl)OXr)OXs)OXt)OXu)OXv)OXw)OXx)OXy)OX})OX!V)OX!r)OX!s)OX!t)OX!u)OX!v)OX!x)OX!{)OX%v)OX&r)OX&s)OX(r)OX)S)OX)U)OX)V)OX~O)W)OX!O)OX!X)OX!Y)OX![)OX!^)OX!_)OX!a)OX!b)OX!c)OX!e)OX!f)OX!h)OX(u)OX(w)OX(x)OX)T)OX)X)OX!g)OX)j)OX!W)OXQ)OX!d)OX!U)OX#v)OX~P%%eO!T(QO~O!T(QO(v(PO~O(r%nO!U*QP~O!T(ZO(v.uO]&kad&kal&kar&kas&kat&kau&kav&kaw&kax&kay&ka}&ka!V&ka!r&ka!s&ka!t&ka!u&ka!v&ka!x&ka!{&ka%v&ka&r&ka&s&ka(r&ka)S&ka)U&ka)V&ka)W&ka!O&ka!X&ka!Y&ka![&ka!^&ka!_&ka!a&ka!b&ka!c&ka!e&ka!f&ka!h&ka(u&ka(w&ka(x&ka)T&ka)X&ka!g&ka)j&ka!W&kaQ&ka!d&ka!U&ka#v&ka~Ol$oO!T(ZO(r$nO~O&r#WO&s$wO]&pad&pal&par&pas&pat&pau&pav&paw&pax&pay&pa}&pa!V&pa!r&pa!s&pa!t&pa!u&pa!v&pa!x&pa!{&pa%v&pa(r&pa)S&pa)U&pa)V&pa)W&pa!O&pa!T&pa!X&pa!Y&pa![&pa!^&pa!_&pa!a&pa!b&pa!c&pa!e&pa!f&pa!h&pa(u&pa(w&pa(x&pa)T&pa)X&pa!g&pa)j&pa!W&paQ&pa!d&pa(v&pa!U&pa#v&pa~O&s.zO~P!(zO!Y#qO![#rO!f#zO)S#mO!^'Ua!_'Ua!a'Ua!b'Ua!c'Ua!e'Ua!h'Ua(u'Ua)T'Ua)U'Ua)V'Ua)W'Ua)X'Ua!g'Ua)j'Ua!O'Ua!W'Ua(v'Ua!U'UaQ'Ua!d'Ua~P#3zO!V'dX!X'dX!Y'dX!['dX!^'dX!_'dX!a'dX!b'dX!c'dX!e'dX!f'dX!h'dX(u'dX(w'dX(x'dX)S'dX)T'dX)U'dX)V'dX)X'dX!O'dX~O].|O)W'dX!g'dX)j'dX!W'dX(v'dX!U'dXQ'dX!d'dX~P%2xO!Y#qO![#rO!f#zO)S#mO!^'Wa!_'Wa!a'Wa!b'Wa!c'Wa!e'Wa!h'Wa(u'Wa)T'Wa)U'Wa)V'Wa)W'Wa)X'Wa!g'Wa)j'Wa!O'Wa!W'Wa(v'Wa!U'WaQ'Wa!d'Wa~P#3zO]#}O!T$WO!V.}O&r#WO&s$wO~O!X'Za!Y'Za!['Za!^'Za!_'Za!a'Za!b'Za!c'Za!e'Za!f'Za!h'Za(u'Za(w'Za(x'Za)S'Za)T'Za)U'Za)V'Za)W'Za)X'Za!g'Za)j'Za!O'Za!W'Za(v'Za!U'ZaQ'Za!d'Za~P%6oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^a)W'^a!g'^a)j'^a!O'^a!W'^a(v'^a!U'^aQ'^a!d'^a~P#3zOPmO]$eOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V%]O)X!ZO)YXO)hcO)idO)j%[O~O!W/QO~P%:oOS(qOT(nO]#}O*W(pO~O]/TO'f/UO*W/RO~OS/YOT(nO*W/XO~O]#}O~Q'na!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO(v/[O)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O)W#Zi!O#Zi~P#3zO]cXlgXpcXpiX!VcX!XcX!YcX![cX!^cX!_cX!acX!bcX!ccX!ecX!fcX!gcX!hcX(ucX(wcX(xcX)ScX)TcX)UcX)VcX)WcX)XcX)jcX!OcX!WcX(vcX!TcX#vcX!UcXQcX!dcX~Od/^O%Y*TO(y/]O~Ol/_O~Ol/`O~Op&fO]bi!Vbi!Xbi!Ybi![bi!^bi!_bi!abi!bbi!cbi!ebi!fbi!gbi!hbi(ubi(wbi(xbi)Sbi)Tbi)Ubi)Vbi)Wbi)Xbi)jbi!Obi!Wbi(vbi!UbiQbi!dbi~O!W/bO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO![#rO)S#mO!Y&zi!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!f&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y&zi![&zi!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!f&zi!h&zi(u&zi)S&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)V#pO!h&zi(u&zi)T&zi)U&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)U#nO)V#pO!h&zi(u&zi)T&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)V#pO!^&zi!h&zi(u&zi)T&zi)U&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)V#pO!^&zi!_&zi!h&zi(u&zi)T&zi)U&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO!^&zi!_&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!b#yO!c#yO!e#yO!f#zO)S#mO!^&zi!_&zi!a&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!f#zO)S#mO!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO)S#mO!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!f&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)T#oO)U#nO)V#pO!h&zi(u&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h/cO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!O(sX~P#3zO!h/cO!O(sX~O!O/eO~O]%Xap%Xa!X%Xa!Y%Xa![%Xa!^%Xa!_%Xa!a%Xa!b%Xa!c%Xa!e%Xa!f%Xa!h%Xa(u%Xa(w%Xa(x%Xa)T%Xa)U%Xa)V%Xa)W%Xa)X%Xa!g%Xa)j%Xa!O%Xa!W%Xa!T%Xa#v%Xa(v%Xa!U%XaQ%Xa!d%Xa~O)S/fO!V%Xa~P&,aO!O/fO~O!W/fO~O!V/gO)S%Xa~P&,aO!X'Zi!Y'Zi!['Zi!^'Zi!_'Zi!a'Zi!b'Zi!c'Zi!e'Zi!f'Zi!h'Zi(u'Zi(w'Zi(x'Zi)S'Zi)T'Zi)U'Zi)V'Zi)W'Zi)X'Zi!g'Zi)j'Zi!O'Zi!W'Zi(v'Zi!U'ZiQ'Zi!d'Zi~P%6oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^i)W'^i!g'^i)j'^i!O'^i!W'^i(v'^i!U'^iQ'^i!d'^i~P#3zO!W/lO~P%:oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h/nO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U)rX~P#3zO(r/qO~O!V/sO(w)sO)j/uO~O!h/nO!U)rX~O!U/vO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)T#oO)U#nO)V#pO)X#|O!h_i(u_i)W_i!g_i)j_i!O_i!W_i(v_i!U_iQ_i!d_i~P#3zO!R/wO~Ol){O]!Qa!h!Qa)X!Qa)]!Qa~OP0PO]0OOl0PO!R0PO!T/|O!V/}O!X0PO!Y0PO![0PO!^0PO!_0PO!a0PO!b0PO!c0PO!e0PO!f0PO!g0PO!h0PO!i0PO(oQO(v0PO(w0PO(x0PO)S/yO)T/zO)U/zO)V/{O)W0PO)X0PO)YXO~O!O0SO~P&6yO!R$[O~O!h*OO)X)Qa)])Qa~O)]0WO~O])dO!V)eO!X)bO!g)bO%Z)bO%[)bO%])bO%^)bO%_)fO%`)fO%a)bO(x)cO)j)bO)x)gO~Od)oO%Y*TO(y$OO~O)W0YO~O]nXdnXlmXpnXrnXsnXtnXunXvnXwnXxnXynX}nX!VnX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX)SnX)UnX)VnX!TnX!hnX)XnX!OnXQnX!dnX~O!lnX(vnX)WnX!XnX!YnX![nX!^nX!_nX!anX!bnX!cnX!enX!fnX(unX(wnX(xnX)TnX!gnX)jnX!WnX!UnX#vnX#TnX#VnX#pnXanX{nX!onX#anX#bnX#inX#tnX${nX%cnX%enX%knX%lnX%onX&mnX)PnX~P&:uOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO~O])aid)ail)ai!V)ai!{)ai%v)ai(r)ai)S)ai)U)ai)V)aiQ)ai!d)ai!h)ai)X)ai)j)ai!O)ai!T)ai&r)ai(v)ai)W)ai~P&?sO]&cO!V&bO!O#Qi!T#Qi!h#Qi#v#Qi)W#Qi)j#QiQ#Qi!d#Qi(v#Qi~O!OqaQqa!dqa!hqa)Xqa)Wqa~P#9{O!OqaQqa!dqa!hqa)Xqa)Wqa~P#IkO]&cO!V+kO!OqaQqa!dqa!hqa)Xqa)Wqa~O!h*iO!W)ka~O!h*mO!W*Oa~OPmOa!]Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!X!XO!Y!WO!i!YO!s!aO!t!aO!v!aO!x!cO#V#QO#a#VO#b#TO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%e#UO%l#SO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)WiO)X!ZO)YXO)hcO)idO~O]eOd!POlTO!T*qO!U&TO!V0hO!opO!r!`O!u!bO!{!dO#i#OO#p!xO#t!fO$R!gO$T!hO${!tO$}!uO%U!yO%c!zO%g!{O%o!|O%v!}O%|#PO(rRO(w)sO)SaO)U|O)V{O~P&DuO!h*tO)W)qa~OPmO]$eOa!]Ol:|O{#RO!T$WO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r;UO)PYO)S$kO)V$kO)X0nO)YXO)hcO)idO!O(sP!O)dP~P&?sO!h*mO!W*OX~O]#}O!T$WO~O!h0sO!T)zX#v)zX)j)zX~O)W0uO~O)W0vO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W0xO)X#|O~P#3zO)W0vO~P!?WO]1SOd!POl%bO!V1QO!{!dO%v$mO(r$xO)S0zO)X0}O~O)U1OO)V1OO)j0{OQ#PX!d#PX!h#PX!O#PX~P' dO!h1TOQ)lX!d)lX~OQ1VO!d1VO~O)X1YO)j1XOQ#`X!d#`X!h#`X~P!<[O)X1YO)j1XOQ#`X!d#`X!h#`X~P!;bOp&UO~O!O#ka!T#ka#v#ka)W#ka)j#kaQ#ka!d#ka!h#ka)X#ka!x#ka(v#ka~P#IkO]&cO!V+kO!O#ka!T#ka#v#ka)W#ka)j#kaQ#ka!d#ka!h#ka)X#ka!x#ka(v#ka~O!W1_O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W1_O)S1aO~P$%pO!W1_O~P!(zO]#ja!T#ja!V#ja!O#ja#v#ja)W#ja)j#jaQ#ja!d#ja!h#ja)X#ja!x#ja(v#ja~P$ xO]&cO!O1eO!V+kO~O!h1fO!O)dX~O!O1hO~O]&cO!V+kO!O#na!T#na#v#na)W#na)j#naQ#na!d#na!h#na)X#na!x#na(v#na~O]1lOr#SXs#SXt#SXu#SXv#SXw#SXx#SXy#SX!T#SX!V#SX#T#SX#p#SX(x#SX)U#SX)V#SX!l#SX!x#SX#V#SX#v#SX(v#SX)j#SX!O#SX!h#SX)W#SXQ#SX!d#SX)X#SX~O]1mO~O]1pOl$oO!V$fO#V#QO(r$nO)hcO)idO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!l+zO#T+vO#V+yO#p+wO(x+tO)U+zO)V+zO~O])fX!T)fX!V)fX!x)fX#v)fX(v)fX)j)fX!O)fX!h)fX)W)fXQ)fX!d)fX~P'+}O!x!cO]#Ri!T#Ri!V#Ri#v#Ri(v#Ri)j#Ri!O#Ri!h#Ri)W#RiQ#Ri!d#Ri~O!W1xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W1xO)S1zO~P$%pO!W1xO~P!(zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ*RX!d*RX!h*RX~P#3zO)X1{OQ({X!d({X!h({X~O!h1|OQ(zX!d(zX~OQ2OO!d2OO~O!O2PO~O#t$lO)PYO~P8zOl-eO!TxO)j2TO~O!O2UO~O#x,aOP#ui]#uia#uid#uil#uir#uis#uit#uiu#uiv#uiw#uix#uiy#ui{#ui}#ui!T#ui!V#ui!X#ui!Y#ui!i#ui!o#ui!r#ui!s#ui!t#ui!u#ui!v#ui!x#ui!{#ui#V#ui#a#ui#b#ui#i#ui#p#ui#t#ui#v#ui$R#ui$T#ui$Y#ui$Z#ui$`#ui$e#ui$g#ui$h#ui$k#ui$m#ui$o#ui$q#ui$s#ui$u#ui$w#ui${#ui$}#ui%U#ui%_#ui%`#ui%a#ui%c#ui%e#ui%g#ui%l#ui%o#ui%v#ui%|#ui&m#ui&r#ui&s#ui'Q#ui'R#ui'V#ui'Y#ui'a#ui'b#ui(k#ui(o#ui(r#ui)P#ui)S#ui)U#ui)V#ui)W#ui)X#ui)Y#ui)h#ui)i#ui!U#ui$c#ui!n#ui%k#ui~O]&cO~O]&cO!TxO!V&bO#v!eO~O(v2ZO(w,cO)P$Ua)W$Ua~O)PYO)W2]O~O!O2^O~P,]O!O2^O)W#jO~O!O2^O~O$c2cOP$_i]$_ia$_id$_il$_ir$_is$_it$_iu$_iv$_iw$_ix$_iy$_i{$_i}$_i!T$_i!V$_i!X$_i!Y$_i!i$_i!o$_i!r$_i!s$_i!t$_i!u$_i!v$_i!x$_i!{$_i#V$_i#a$_i#b$_i#i$_i#p$_i#t$_i#v$_i$R$_i$T$_i$Y$_i$Z$_i$`$_i$e$_i$g$_i$h$_i$k$_i$m$_i$o$_i$q$_i$s$_i$u$_i$w$_i${$_i$}$_i%U$_i%_$_i%`$_i%a$_i%c$_i%e$_i%g$_i%l$_i%o$_i%v$_i%|$_i&m$_i&r$_i&s$_i'Q$_i'R$_i'V$_i'Y$_i'a$_i'b$_i(k$_i(o$_i(r$_i)P$_i)S$_i)U$_i)V$_i)W$_i)X$_i)Y$_i)h$_i)i$_i!U$_i~O]1pO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W2fO)X#|O~P#3zOPmO]$eOa!]Ol:{O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)S$kO)V$kO)W2iO)X!ZO)YXO)hcO)idO~P&?sO)W2fO~O(r-UO~O)PYO)j2lO~O)W2nO~O]-YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO!|%RO(r-UO)S-VO~O)S2sO~O]&cO!V2uO!h2vO)W)uX~O]-YO!{!dO(r-UO)S-VO~O)W2yO~O!TxO$`!iO$e!jO$g!kO$h!lO$k-bO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO$}!uO(r:nOd$Xi!o$Xi!{$Xi#i$Xi#p$Xi#t$Xi#v$Xi$R$Xi$T$Xi$Y$Xi$Z$Xi${$Xi%U$Xi%c$Xi%g$Xi%o$Xi%|$Xi(k$Xi)U$Xi!U$Xi$c$Xi~P$0kOl:{O(r:nO~P0zO]2}O~O)W2SO~O!u3PO(r%nO~O!O3SO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h3TO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O3UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO]&cO!V+kO!T%ui#v%ui)W%ui)j%ui~O!W3VO~Ol:yO)W(}X~P$GQOa!TOl$oO{3]O#a#VO#b3[O#t!fO%e#UO%l3^O&m!RO&r#WO&s!TO(r$nO)PYO~P&?sOl;cO!o-pO#i-uO#t!fO${,yO%c!zO%k-tO%o!|O%v!}O(r;TO)PYO~P!8jO]&cO!V&bO)W3`O~O)W3aO~O)PYO)W3aO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W3bO)X#|O~P#3zO)W3bO~O)W3eO~O!U3gO~P$JbOl$oO(r$nO~O]3iO!T'yO~P'+iO!T(QO!l3lO(v(PO])Oad)Oal)Oar)Oas)Oat)Oau)Oav)Oaw)Oax)Oay)Oa})Oa!V)Oa!r)Oa!s)Oa!t)Oa!u)Oa!v)Oa!x)Oa!{)Oa%v)Oa&r)Oa&s)Oa(r)Oa)S)Oa)U)Oa)V)Oa)W)Oa!O)Oa!X)Oa!Y)Oa![)Oa!^)Oa!_)Oa!a)Oa!b)Oa!c)Oa!e)Oa!f)Oa!h)Oa(u)Oa(w)Oa(x)Oa)T)Oa)X)Oa!g)Oa)j)Oa!W)OaQ)Oa!d)Oa!U)Oa#v)Oa~Ol$oO!n.cO!o.cO(r$nO~O!h3pO)X3rO!T)_X~O!o3tO)PYO~P8zO)W3uO~PGVO]3zOl({O!T$WO!{!dO%v$mO&r#WO(r(zO(v4OO)S3wO)U3{O)V3{O~O)W4PO)j4RO~P(&eOl;dO!U4TO!n.pO!o.oO#i-uO${!tO$}!uO%g!{O%k-tO%o!|O%v!}O(r;VO)PYO~P!8jOl;dO%v!}O(r;VO~P!8jO(v4UO~Ol$oO!T(QO(r$nO(v(PO)PYO~O!l3lO~P((sO)j4WO!U&oX!h&oX~O!h4XO!U*QX~O!U4ZO~Oa4]Ol$oO&m!RO(r$nO~O!T(ZO]&kid&kil&kir&kis&kit&kiu&kiv&kiw&kix&kiy&ki}&ki!V&ki!r&ki!s&ki!t&ki!u&ki!v&ki!x&ki!{&ki%v&ki&r&ki&s&ki(r&ki)S&ki)U&ki)V&ki)W&ki!O&ki!X&ki!Y&ki![&ki!^&ki!_&ki!a&ki!b&ki!c&ki!e&ki!f&ki!h&ki(u&ki(w&ki(x&ki)T&ki)X&ki!g&ki)j&ki!W&kiQ&ki!d&ki!U&ki#v&ki~O(v&ki~P(*TO(v.uO~P(*TO!O4`O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O4`O~O!O4aO~O]#}O!T$WO!V'Zi!X'Zi!Y'Zi!['Zi!^'Zi!_'Zi!a'Zi!b'Zi!c'Zi!e'Zi!f'Zi!h'Zi(u'Zi(w'Zi(x'Zi)S'Zi)T'Zi)U'Zi)V'Zi)W'Zi)X'Zi!g'Zi)j'Zi!O'Zi!W'Zi(v'Zi!U'ZiQ'Zi!d'Zi~OPmOa%QOl:zO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)X!ZO)YXO)hcO)idO]#]ap#]a!T#]a!V#]a)S#]a)U#]a)V#]a~O(r%nO)X4fO!O*YP~O*W4eO~O'f4hO*W4eO~O*W4iO~OlmXpnXp&wX~Od4kO%Y*TO(y/]O~Od4kO%Y*TO(y4lO~O!h/cO!O(sa~O!W4pO~O]&cO!V+kO!T%uq#v%uq)W%uq)j%uq~O]#}O!T$WO!X'Zq!Y'Zq!['Zq!^'Zq!_'Zq!a'Zq!b'Zq!c'Zq!e'Zq!f'Zq!h'Zq(u'Zq(w'Zq(x'Zq)S'Zq)T'Zq)U'Zq)V'Zq)W'Zq)X'Zq!g'Zq)j'Zq!O'Zq!W'Zq(v'Zq!U'ZqQ'Zq!d'Zq~O!V'Zq~P(5bO!V.}O&r#WO&s$wO~P(5bO!T$WO!V)rO(w)sO!U(UX!h(UX~P!JwO!h/nO!U)ra~O!W4xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h*iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!U4|O~P&6yO!W4|O~P&6yO!O4|O~P&6yO!O5RO~P&6yO]5SO!h'ua)X'ua)]'ua~O!h*OO)X)Qi)])Qi~O]&cO!V&bO!O#Qq!T#Qq!h#Qq#v#Qq)W#Qq)j#QqQ#Qq!d#Qq(v#Qq~O!OqiQqi!dqi!hqi)Xqi)Wqi~P#IkO]&cO!V+kO!OqiQqi!dqi!hqi)Xqi)Wqi~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'Tq)W'Tq!g'Tq)j'Tq!O'Tq!W'Tq(v'Tq!U'TqQ'Tq!d'Tq~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!W'|a!h'|a~P#3zO!W5XO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h5YO(u#gO)S#mO)T#oO)U#nO)V#pO)W#jO)X#|O!U)rX~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h#{i)W#{i~P#3zO]*vO!T$WO!V&bO)j*rO!h(Va)W(Va~O!h1fO]'dX!O)dX~P%2xO)X5[O!T%qa!h%qa#v%qa)j%qa~O!h0sO!T)za#v)za)j)za~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W5_O)X#|O~P#3zO]1SOd!POl;[O!V1QO!{!dO%v$mO(r$xO)S;xO)U5aO)V5aO~OQ#Pa!d#Pa!h#Pa!O#Pa~P(DjO]1SOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V1QO!{!dO!|%RO%v$mO(r$xOQ#kX!d#kX!h#kX!O#kX~Ol%bO)S0zO)U;yO)V;yO~P(ElO]&cOQ#Pa!d#Pa!h#Pa!O#Pa~O!V&bO)j5eO~P(GZO(r%nOQ#dX!d#dX!h#dX!O#dX~O)U;yO)V;yOQ#nX!d#nX!h#nX!O#nX~P' dO!V+kO~P(GZO]1SOa!TOd!POl;]O{#RO!V1QO!{!dO#a#VO#b#TO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO(r;QO)PYO)S;xO)U5aO)V5aO)X+nO!O)dP~P&?sO!h1TOQ)la!d)la~Op&fO)j5jOQ#`al(}X!d#`a!h#`a)X(}X~P$GQO(r-UOQ#ga!d#ga!h#ga~Op&fO)j5jOQ#`a])^Xd)^Xl)^Xr)^Xs)^Xt)^Xu)^Xv)^Xw)^Xx)^Xy)^X})^X!T)^X!V)^X!d#`a!h#`a!l)^X!r)^X!s)^X!t)^X!u)^X!v)^X!x)^X!{)^X%v)^X&r)^X&s)^X(r)^X(v)^X)S)^X)U)^X)V)^X)X)^X~O#a5mO#b5mO~O]&cO!V+kO!O#ki!T#ki#v#ki)W#ki)j#kiQ#ki!d#ki!h#ki)X#ki!x#ki(v#ki~O!W5oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W5oO~P!(zO!W5oO)S5qO~P$%pO]#ji!T#ji!V#ji!O#ji#v#ji)W#ji)j#jiQ#ji!d#ji!h#ji)X#ji!x#ji(v#ji~P$ xO)PYO)X5sO~P8zO!h1fO!O)da~O&r#WO&s$wO!T#qa!x#qa#v#qa(v#qa)j#qa!O#qa!h#qa)W#qaQ#qa!d#qa)X#qa~P#NeO!O5xO~P!(zO!O)oP~P!4xO)T6OO)U5|O]#Ua!T#Ua!V#Ua)S#Ua)V#Uar#Uas#Uat#Uau#Uav#Uaw#Uax#Uay#Ua!l#Ua!x#Ua#T#Ua#V#Ua#p#Ua#v#Ua(v#Ua(x#Ua)j#Uaa#Uad#Ual#Ua{#Ua}#Ua!o#Ua!r#Ua!s#Ua!t#Ua!u#Ua!v#Ua!{#Ua#a#Ua#b#Ua#i#Ua#t#Ua${#Ua%c#Ua%e#Ua%k#Ua%l#Ua%o#Ua%v#Ua&m#Ua&r#Ua&s#Ua(r#Ua)P#Ua)W#Ua!O#Ua!h#UaQ#Ua!d#Ua~O!x!cO]#Rq!T#Rq!V#Rq#v#Rq(v#Rq)j#Rq!O#Rq!h#Rq)W#RqQ#Rq!d#Rq~O!W6TO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W6TO~P!(zO!h1|OQ(za!d(za~O)W6YO~Ol-eO!TxO)j6ZO~O]*vO!T$WO!V&bO!h*tO)W)qX~O)j6_O~P)+cO!O6aO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O6aO~O$c6cOP$_q]$_qa$_qd$_ql$_qr$_qs$_qt$_qu$_qv$_qw$_qx$_qy$_q{$_q}$_q!T$_q!V$_q!X$_q!Y$_q!i$_q!o$_q!r$_q!s$_q!t$_q!u$_q!v$_q!x$_q!{$_q#V$_q#a$_q#b$_q#i$_q#p$_q#t$_q#v$_q$R$_q$T$_q$Y$_q$Z$_q$`$_q$e$_q$g$_q$h$_q$k$_q$m$_q$o$_q$q$_q$s$_q$u$_q$w$_q${$_q$}$_q%U$_q%_$_q%`$_q%a$_q%c$_q%e$_q%g$_q%l$_q%o$_q%v$_q%|$_q&m$_q&r$_q&s$_q'Q$_q'R$_q'V$_q'Y$_q'a$_q'b$_q(k$_q(o$_q(r$_q)P$_q)S$_q)U$_q)V$_q)W$_q)X$_q)Y$_q)h$_q)i$_q!U$_q~O)W6dO~OPmO]$eOa!]Ol:{O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)S$kO)V$kO)W6fO)X!ZO)YXO)hcO)idO~P&?sO(v6hO)j*rO~P)+cO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W6fO)X#|O~P#3zO!O6jO~P!(zO)W6nO~O)W6oO~O]-YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO(r-UO)S-VO~O]&cO!V2uO!h%Oa)W%Oa!O%Oa~O!W6uO)S6vO~P$%pO!h2vO)W)ua~O]&cO!O6yO!V2uO~O!TxO$`!iO$e!jO$g!kO$h!lO$k-bO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO$}!uO(r:nOd$Xq!o$Xq!{$Xq#i$Xq#p$Xq#t$Xq#v$Xq$R$Xq$T$Xq$Y$Xq$Z$Xq${$Xq%U$Xq%c$Xq%g$Xq%o$Xq%|$Xq(k$Xq)U$Xq!U$Xq$c$Xq~P$0kOPmO]$eOa!]Ol:{O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)PYO)S$kO)V$kO)W6{O)X!ZO)YXO)hcO)idO~P&?sO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W7OO)X#|O~P#3zO)W7PO~OP7QO(oQO~Ol*[O)W)^X~P$GQOp&fOl(}X)W)^X~P$GQO)W7SO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O)W&Sa~P#3zO!U7UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO)W7VO~OPmO]$eOa!]Ol:|O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r;UO)PYO)S$kO)V$kO)X0nO)YXO)hcO)idO!O)dP~P&?sO!h3pO)X7ZO!T)_a~O!h3pO!T)_a~O)W7`O)j7bO~P(&eO)W7dO~PGVO]3zOl({Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO!|%RO%v$mO&r#WO(r(zO)S3wO)U3{O)V3{O~O)S7hO~O]&cO!T*qO!V7jO!h7kO#v!eO(v4OO~O)W7`O)j7mO~P)FwO]3zOl({O!{!dO%v$mO&r#WO(r(zO)S3wO)U3{O)V3{O~Op&fO])cX!T)cX!V)cX!h)cX#v)cX(v)cX)W)cX)j)cX!O)cX~O)W7`O~O!T(QO!l7sO(v(PO])Oid)Oil)Oir)Ois)Oit)Oiu)Oiv)Oiw)Oix)Oiy)Oi})Oi!V)Oi!r)Oi!s)Oi!t)Oi!u)Oi!v)Oi!x)Oi!{)Oi%v)Oi&r)Oi&s)Oi(r)Oi)S)Oi)U)Oi)V)Oi)W)Oi!O)Oi!X)Oi!Y)Oi![)Oi!^)Oi!_)Oi!a)Oi!b)Oi!c)Oi!e)Oi!f)Oi!h)Oi(u)Oi(w)Oi(x)Oi)T)Oi)X)Oi!g)Oi)j)Oi!W)OiQ)Oi!d)Oi!U)Oi#v)Oi~O(r%nO!U(fX!h(fX~O!h4XO!U*Qa~Op&fO]*Pad*Pal*Par*Pas*Pat*Pau*Pav*Paw*Pax*Pay*Pa}*Pa!T*Pa!V*Pa!r*Pa!s*Pa!t*Pa!u*Pa!v*Pa!x*Pa!{*Pa%v*Pa&r*Pa&s*Pa(r*Pa)S*Pa)U*Pa)V*Pa)W*Pa!O*Pa!X*Pa!Y*Pa![*Pa!^*Pa!_*Pa!a*Pa!b*Pa!c*Pa!e*Pa!f*Pa!h*Pa(u*Pa(w*Pa(x*Pa)T*Pa)X*Pa!g*Pa)j*Pa!W*PaQ*Pa!d*Pa(v*Pa!U*Pa#v*Pa~O!T(ZO]&kqd&kql&kqr&kqs&kqt&kqu&kqv&kqw&kqx&kqy&kq}&kq!V&kq!r&kq!s&kq!t&kq!u&kq!v&kq!x&kq!{&kq%v&kq&r&kq&s&kq(r&kq)S&kq)U&kq)V&kq)W&kq!O&kq!X&kq!Y&kq![&kq!^&kq!_&kq!a&kq!b&kq!c&kq!e&kq!f&kq!h&kq(u&kq(w&kq(x&kq)T&kq)X&kq!g&kq)j&kq!W&kqQ&kq!d&kq(v&kq!U&kq#v&kq~OPmOa%QOl:zO!T$WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)YXO)hcO)idO~O]*Ui!V*Ui!X*Ui!Y*Ui![*Ui!^*Ui!_*Ui!a*Ui!b*Ui!c*Ui!e*Ui!f*Ui!h*Ui(u*Ui(w*Ui(x*Ui)S*Ui)T*Ui)U*Ui)V*Ui)W*Ui)X*Ui!g*Ui)j*Ui!O*Ui!W*Ui(v*Ui!U*UiQ*Ui!d*Ui~P*&WO!O7xO~O!W7yO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^q)W'^q!g'^q)j'^q!O'^q!W'^q(v'^q!U'^qQ'^q!d'^q~P#3zO!h7zO!O*YX~O!O7|O~O*W7}O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h^y)W^y!g^y)j^y!O^y!W^y(v^y!U^yQ^y!d^y~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!O(ha!h(ha~P#3zO]#}O!T$WO!V'Zy!X'Zy!Y'Zy!['Zy!^'Zy!_'Zy!a'Zy!b'Zy!c'Zy!e'Zy!f'Zy!h'Zy(u'Zy(w'Zy(x'Zy)S'Zy)T'Zy)U'Zy)V'Zy)W'Zy)X'Zy!g'Zy)j'Zy!O'Zy!W'Zy(v'Zy!U'ZyQ'Zy!d'Zy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^y)W'^y!g'^y)j'^y!O'^y!W'^y(v'^y!U'^yQ'^y!d'^y~P#3zO]&cO!V+kO!T%uy#v%uy)W%uy)j%uy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U(Ua!h(Ua~P#3zO!W4xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U#}i!h#}i~P#3zO!U8PO~P&6yO!W8PO~P&6yO!O8PO~P&6yO!O8RO~P&6yO]&cO!V&bO!O#Qy!T#Qy!h#Qy#v#Qy)W#Qy)j#QyQ#Qy!d#Qy(v#Qy~O]&cO!V+kO!OqqQqq!dqq!hqq)Xqq)Wqq~O]&cOQ#Pi!d#Pi!h#Pi!O#Pi~O!V+kO~P*9jOQ#nX!d#nX!h#nX!O#nX~P(DjO!V&bO~P*9jOQ(OX](OXd'qXl'qXr(OXs(OXt(OXu(OXv(OXw(OXx(OXy(OX!V(OX!d(OX!h(OX!{'qX%v'qX(r'qX)S(OX)U(OX)V(OX!O(OX~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ#_i!d#_i!h#_i!O#_i~P#3zO&r#WO&s$wOQ#fi!d#fi!h#fi~O(r-UO)X1YO)j1XOQ#`X!d#`X!h#`X~O!W8WO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W8WO~P!(zO!T#qi!x#qi#v#qi(v#qi)j#qi!O#qi!h#qi)W#qiQ#qi!d#qi)X#qi~O]&cO!V+kO~P*?fO]&YO!V&WO&r#WO&s$wO)S&VO)U&ZO)V&ZO~P*?fO!O8YO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!h8ZO!O)oX~O!O8]O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ*TX!d*TX!h*TX~P#3zO)X8`OQ*SX!d*SX!h*SX~O)W8bO~O!O$bi!h#{a)W#{a~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W8eO)X#|O~P#3zO!O8gO~P!(zO!O8gO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O8gO~O]&cO!V&bO(v8mO~O)W8nO~O]&cO!V2uO!h%Oi)W%Oi!O%Oi~O!W8qO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W8qO)S8sO~P$%pO!W8qO~P!(zO]&cO!V2uO!h(Ya)W(Ya~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W8tO)X#|O~P#3zO)W2iO~P!(zO)W8tO~OP%oO!O8uO(oQO~O!O8uO~O)W8vO~P%%eO#T8yO(x.PO)W8wO~O!h3pO!T)_i~O)X8}O!T'wa!h'wa~O)W9PO)j9RO~P)FwO)W9PO~O)W9PO)j9VO~P(&eOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~P)GgO]&cO!V7jO!T!ya!h!ya#v!ya(v!ya)W!ya)j!ya!O!ya~O!W9^O)S9_O~P$%pO!T$WO!h7kO(v4OO)W9PO)j9VO~O!T$WO~P#EfO]&cO!O9bO!V7jO~O]&cO!V7jO!T&aa!h&aa#v&aa(v&aa)W&aa)j&aa!O&aa~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O)W&ba~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W9PO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U&oi!h&oi~P#3zO!V.}O]']i!T']i!X']i!Y']i![']i!^']i!_']i!a']i!b']i!c']i!e']i!f']i!h']i(u']i(w']i(x']i)S']i)T']i)U']i)V']i)W']i)X']i!g']i)j']i!O']i!W']i(v']i!U']iQ']i!d']i~O(r%nO)X9eO~O!h7zO!O*Ya~O!O9gO~P&6yO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U(Ua)W#Zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ#_q!d#_q!h#_q!O#_q~P#3zO&r#WO&s$wOQ#fq!d#fq!h#fq~O)j5jOQ#`a!d#`a!h#`a~O]&cO!V+kO!T#qq!x#qq#v#qq(v#qq)j#qq!O#qq!h#qq)W#qqQ#qq!d#qq)X#qq~O!h8ZO!O)oa~O)U5|O]&Vi!T&Vi!V&Vi)S&Vi)T&Vi)V&Vir&Vis&Vit&Viu&Viv&Viw&Vix&Viy&Vi!l&Vi!x&Vi#T&Vi#V&Vi#p&Vi#v&Vi(v&Vi(x&Vi)j&Via&Vid&Vil&Vi{&Vi}&Vi!o&Vi!r&Vi!s&Vi!t&Vi!u&Vi!v&Vi!{&Vi#a&Vi#b&Vi#i&Vi#t&Vi${&Vi%c&Vi%e&Vi%k&Vi%l&Vi%o&Vi%v&Vi&m&Vi&r&Vi&s&Vi(r&Vi)P&Vi)W&Vi!O&Vi!h&ViQ&Vi!d&Vi~O)W9jO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!O$bq!h#{i)W#{i~P#3zO!O9lO~P!(zO!O9lO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O9lO~O]&cO!V&bO(v9oO~O!O9pO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O9pO~O]&cO!V2uO!h%Oq)W%Oq!O%Oq~O!W9tO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W9tO~P!(zO)W6fO~P!(zO)W9uO~O)W9vO~O(x.PO)W9vO~O!h3pO!T)_q~O)X9xO!T'wi!h'wi~O!T$WO!h7kO(v4OO)W9yO)j9{O~O)W9yO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W9yO)X#|O~P#3zO)W9yO)j:OO~P)FwO]&cO!V7jO!T!yi!h!yi#v!yi(v!yi)W!yi)j!yi!O!yi~O!W:SO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W:SO)S:UO~P$%pO!W:SO~P!(zO]&cO!V7jO!T(da!h(da(v(da)W(da)j(da~O!O:WO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O:WO~O!O:]O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O:]O~O]&cO!V2uO!h%Oy)W%Oy!O%Oy~O)W:^O~O)W:_O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W:_O)X#|O~P#3zO!T$WO!h7kO(v4OO)W:_O)j:bO~O]&cO!V7jO!T!yq!h!yq#v!yq(v!yq)W!yq)j!yq!O!yq~O!W:dO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W:dO~P!(zO!O:fO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O:fO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W:hO)X#|O~P#3zO)W:hO~O]&cO!V7jO!T!yy!h!yy#v!yy(v!yy)W!yy)j!yy!O!yy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W:lO)X#|O~P#3zO)W:lO~O]ZXlgXpZXpiX!TiX!VZX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX(uZX(v$]X(wZX(xZX)SZX)TZX)UZX)VZX)WZX)XZX)jZX~O]%WXlmXpnXp%WX!TnX!V%WX!X%WX!Y%WX![%WX!^%WX!_%WX!a%WX!b%WX!c%WX!e%WX!f%WX!gmX!h%WX(u%WX(w%WX(x%WX)S%WX)T%WX)U%WX)V%WX)X%WX)jmX!O%WXQ%WX!d%WX~O)W%WX!W%WX(v%WX!U%WX~P+GrO]nX]%WXdnXlmXpnXp%WXrnXsnXtnXunXvnXwnXxnXynX}nX!VnX!V%WX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX)SnX)UnX)VnX!OnX!O%WX!hnX)XnX~O)WnX)jnX~P+JSO]%WXlmXpnXp%WX!V%WX!h%WXQ%WX!d%WX!O%WX~O!T%WX#v%WX)W%WX)j%WX(v%WX~P+LmOQnXQ%WX!TnX!X%WX!Y%WX![%WX!^%WX!_%WX!a%WX!b%WX!c%WX!dnX!d%WX!e%WX!f%WX!gmX!h%WX(u%WX(w%WX(x%WX)S%WX)T%WX)U%WX)V%WX)X%WX)jmX~P+JSO]nX]%WXlmXpnXp%WXrnXsnXtnXunXvnXwnXxnXynX}nX!V%WX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX)SnX)UnX)VnX~O!TnX(vnX)WnX)jnX~P, eOdnX!VnX)W%WX~P, eOlmXpnX)W%WX~Od)oO%Y)pO(y:oO~Od)oO%Y)pO(y:tO~Od)oO%Y)pO(y:pO~Od$RO%Y*TO'[$TO'_$UO(y:oO~Od$RO%Y*TO'[$TO'_$UO(y:qO~Od$RO%Y*TO'[$TO'_$UO(y:sO~O]iXriXsiXtiXuiXviXwiXxiXyiX!OiX!ViX&riX&siX)SiX)UiX)ViXdiX}iX!riX!siX!tiX!uiX!viX!xiX!{iX%viX(riX~P#1jO]ZXlgXpZXpiX!VZX!hZX)WZX)jZX~O!TZX#vZX(vZX~P,'{OlgXpiX)PiX)WZX)jiX~O]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!VZX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX!OZX!OiX!hiX)XiX)jiX~O)WZX~P,)VO]ZX]iXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX!TiX!VZX!ViX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX!hiX&riX&siX(uZX(wZX(xZX)SZX)SiX)TZX)UZX)UiX)VZX)ViX)XZX)XiX)jZX~OQZXQiX!dZX!diX~P,+pO]iXdiXriXsiXtiXuiXviXwiXxiXyiX}iX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX~P#1jO]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!VZX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX~O)WiX~P,0rOdiX}iX!OZX!OiX!riX!siX!tiX!uiX!viX!xiX!{iX%viX(riX)jiX~P,+pO]ZX]iXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!TiX!VZX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX(viX)SiX)UiX)ViX)WiX)jiX~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~PBUOd$RO%Y*TO(y:oO~Od$RO%Y*TO(y:pO~Od$RO%Y*TO(y:vO~Od$RO%Y*TO(y:uO~O]%hOd!POl%bOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V%kO!{!dO!|%RO%v$mO(r$xO)S;aO)U;bO)V;bO~O]%hOd!POl%bO!V%kO!{!dO%v$mO(r$xO)S;aO)U;bO)V;bO~Od$RO%Y$SO(y:pO~Od$RO%Y$SO(y:tO~Ol:yO~Ol:xO~O]cXlgXpiX!TcX~Od)oO%Y*TO(y:oO~Od)oO%Y*TO(y:pO~Od)oO%Y*TO(y:qO~Od)oO%Y*TO(y:rO~Od)oO%Y*TO(y:sO~Od)oO%Y*TO(y:uO~Od)oO%Y*TO(y:vO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~P,9OO](}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)j(}X~Ol:xO!T(}X(v(}X)W(}X~P,<}O]&wXlmXpnX!T&wX~Od4kO%Y*TO(y;tO~Ol;[O)S;xO)U5aO)V5aO~P(ElOd!POl%bO!{!dO%v$mO(r$xO~O]1SO!V1QO)S0zO)U;yO)V;yOQ#nX!d#nX!h#nX!O#nX~P,?yO)S;YO~Ol;hO~Ol;iO~Ol;jO~Ol;lO~Ol;mO~Ol;nO~Ol;lO!T$WOQ(}X!d(}X!h(}X)X(}X!O(}X)j(}X~P$GQOl;jO!T$WO~P$GQOl;hO!g$YO)j$YO~Ol;jO!g$YO)j$YO~Ol;lO!g$YO)j$YO~Ol;iO!O(}X!h(}X)X(}X)j(}X~P$GQOd/^O%Y*TO(y;tO~Ol;uO~O)S<YO~OV'e'h'i'g(o)Y!R(rST%Z!Y!['jd%[!i'R!f]'f*Z'k(w!^!_'l'm'l~",goto:"%5]*ZPPPPPP*[P*_PP.T4iP7j7j:tP:t>OP>i>{?aFXMX!&]!,sP!3m!4b!5VP!5qPPPPPPPP!6[P!7tPP!9V!:oP!:uPPPPPP!:xP!:xPP!:xPPPPPPPPP!;U!>lP!>oPP!?]!@QPPPPP!@UP>l!AgPP>l!Cn!Eo!E}!Gd!ITP!I`P!Io!Io!MP#!`##v#'S#*^!Eo#*hPP!Eo#*o#*u#*h#*h#*xP#*|#+k#+k#+k#+k!ITP#,U#,g#.|P#/bP#0}P#1R#1Z#2O#2Z#4i#4q#4q#1RP#1RP#4x#5OP#5YPP#5u#6d#7U#5uP#7v#8SP#5uP#5uPP#5u#5uP#5uP#5uP#5uP#5uP#5uP#5uP#8V#5Y#8sP#9YP#9o#9o#9o#9o#9|#1RP#:d#?`#?}PPPPPPPP#@uP#ATP#ATP#Aa#Dn#9OPP#@}#EQP#Ee#Ep#Ev#Ev#@}#FlP#1R#1R#1R#1R#1RP!Io#GW#G_#G_#G_#Gc!Ly#Gm!Ly#Gq!E}!E}!E}#Gt#L^!E}>l>l>l$#V!@Q!@Q!@Q!@Q!@Q!@Q!6[!6[!6[$#jP$%V$%e!6[$%kPP!6[$'y$'|#@l$(P:t7j$+V$-Q$.q$0a7jPP7j$2T7jP7j7jP7jP$5Z7jP7jPP7j$5gPPPPPPPPP*[P$8o$8u$;^$=d$=j$>Q$>[$>g$>v$>|$@[$AZ$Ab$Ai$Ao$Aw$BR$BX$Bd$Bj$Bs$B{$CW$C^$Ch$Cn$Cx$DP$D`$Df$DlP$Dr$Dz$ER$Ea$F}$GT$GZ$Gb$GkPPPPPPPP$Gq$GuPPPPP$Nw$'y$Nz%$S%&[P%&i%&lPPPPPPPPPP%&x%'{%(R%(V%)|%+Z%+|%,T%.d%.jPPP%.t%/P%/S%/Y%0a%0d%0n%0x%0|%2Q%2s%2y#@uP%3d%3t%3w%4X%4e%4i%4o%4u$'y$'|$'|%4x%4{P%5V%5YR#cP'`mO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fU%om%p7QQ&m!`Q(j#]d0P)}/|/}0O0R4}5O5P5S8QR7Q3Tb}Oaewx{!g&S*q&v$i[!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0{1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fS%`f0h#d%jgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YS%qm!YS&u!h#PQ']!tQ'g!yQ'h!zQ(j#`Q(k#]Q(l#^Q*x%kQ,W&lQ,]&nQ-S'^Q-d'fQ-k'qS.r(Z4XQ/f)gQ0e*mQ2Q,[Q2X,cQ3O-eQ4b.|Q4f/TQ5f0}Q6[2TQ6}3PQ8a6ZQ9e7zR;Z1Q$|#hS!]$y%Q%T%Z&j&k'Q'X'Z'a'c(a(e(h(w(x)R)S)T)U)V)W)X)Y)Z)[)])^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:iQ&p!dQ(g#ZQ(s#bQ)j$T[*s%e*W0k2`2g2{Q,^&oQ/O(fQ/S(kQ/Z(tS/i)i/PQ0r+QS4q/j/kR8O4r'a![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f'a!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ)O#kS+Q%y0sQ/r)sk3}.g3s3w3z3{7c7e7f7h7k9X9Y:RQ)Q#kk3|.g3s3w3z3{7c7e7f7h7k9X9Y:Rl)P#k.g3s3w3z3{7c7e7f7h7k9X9Y:RT+Q%y0s[UOwx!g&S*qW$`[e$e(b#l$p_!f!u!}#R#S#T#U#V#Z$S$T$l%U&U&Y&c&m'_'}(P(U(^(g)j)p+[+a+b+t+y,X,k,z-Q-o-t.W.X._.`.d.q.u1T1X1f1k1m2l3[3]3^3p3t5j5}6P7[8Z![%cg$g%d%i&s*Y*t+],l,v-_0z1O2_;W;X;Y;a;b;o;p;q;r;v;w;y<W<X<YY%snp%w-p.fl(|#k.g3s3w3z3{7c7e7f7h7k9X9Y:RS;e't-wU;f(Q.m.o&|;{af{|!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k$|$}%S%]%h%m&Q&W&b&y&|'O'i'j'u'y(`(i)l)r*`*b*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0]0h0y0{1Q1a1b1l1p1z2c2i2j2u4O4R4W4a5Y5a5e5q6_6c6f6g6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f;`;xQ;|1Sd;}&x'P'b,w-]-^-a2f2z2}W<O&f*v1|3iQ<P#O[<Q!t'^'f,[2T6ZT<]%y0s[VOwx!g&S*qW$a[e$e(bQ$p.u!j$q_!f!u!}#V#Z$S$T$l%U&U&Y&c&m'_(g)j)p+[+a+t,X,k,z-Q-o.d1T1X1f1k1m2l3t5j8Z&^$zaf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f![%cg$g%d%i&s*Y*t+],l,v-_0z1O2_;W;X;Y;a;b;o;p;q;r;v;w;y<W<X<YY%snp%w-p.fQ'r#O|'|#R#S#T#U'}(P(U(^+b+y.W.X._.`.q3[3]3^3p5}6P7[l(|#k.g3s3w3z3{7c7e7f7h7k9X9Y:RS-n't-wQ3W-tU;s(Q.m.on;{|$|$}%S%h'u*`*b0]0y2j5a6g;`;x[<Q!t'^'f,[2T6ZW<R&f*v1|3id<S&x'P'b,w-]-^-a2f2z2}Q<Z1ST<]%y0s!Q!UO[ewx!g$e&S&f&x'P'b(b*q*v,w-]-^-a1|2f2z2}3i!v$t_!f!u!}#O#V#Z$S$T$l%U&U&Y&c&m'_'t(Q(g)j)p+[+t,X,k,z-Q-o-w.d.m.o1S1T1X1f1k1m2l3t5j8Z&^%Paf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f$Q%lgnp|#k$g$|$}%S%d%h%i%w%y&s'^'f'u*Y*`*b*t+],[,l,v-_-p.f.g0]0s0y0z1O2T2_2j3s3w3z3{5a6Z6g7c7e7f7h7k9X9Y:R;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YQ'[!tz(O#R#S#T#U'}(P(U(^+y.W.X._.`.q3[3]3^3p5}6P7[f-Z'`-T-V-Y2p2q2s2v6q6r8pQ1W+aQ1Z+bQ2k,yQ3X-tQ4[.uQ5l1YR8V5m!Q!UO[ewx!g$e&S&f&x'P'b(b*q*v,w-]-^-a1|2f2z2}3i!x$t_!f!u!}#O#V#Z$S$T$l%U&U&Y&c&m'_'t(Q(g)j)p+[+a+t,X,k,z-Q-o-w.d.m.o1S1T1X1f1k1m2l3t5j8Z&^%Paf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f$S%lgnp|!t#k$g$|$}%S%d%h%i%w%y&s'^'f'u*Y*`*b*t+],[,l,v-_-p.f.g0]0s0y0z1O2T2_2j3s3w3z3{5a6Z6g7c7e7f7h7k9X9Y:R;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Y|(O#R#S#T#U'}(P(U(^+b+y.W.X._.`.q3[3]3^3p5}6P7[Q3X-tR4[.u[WOwx!g&S*qW$b[e$e(b#l$p_!f!u!}#R#S#T#U#V#Z$S$T$l%U&U&Y&c&m'_'}(P(U(^(g)j)p+[+a+b+t+y,X,k,z-Q-o-t.W.X._.`.d.q.u1T1X1f1k1m2l3[3]3^3p3t5j5}6P7[8Z![%cg$g%d%i&s*Y*t+],l,v-_0z1O2_;W;X;Y;a;b;o;p;q;r;v;w;y<W<X<YY%snp%w-p.fl(|#k.g3s3w3z3{7c7e7f7h7k9X9Y:RS;e't-wU;f(Q.m.on;{|$|$}%S%h'u*`*b0]0y2j5a6g;`;xQ;|1SQ<P#O[<Q!t'^'f,[2T6Z&^<Taf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fd<U&x'P'b,w-]-^-a2f2z2}W<V&f*v1|3iT<]%y0sp$PT$_$o%b%r({:z:{:|;[;];^;_;c;d<[o)m$V*U*[/_:w:x:y;h;i;j;k;l;m;n;up$QT$_$o%b%r({:z:{:|;[;];^;_;c;d<[o)n$V*U*[/_:w:x:y;h;i;j;k;l;m;n;u^&e}!O$i$j%`%j;Zd&i!U$t%P%l'[(O1W1Z3X4[V/a)O)P3}S%Ye$eQ,T&fQ.{(bQ2m-QQ5y1mQ6V1|Q6m2lR9h8Z#}!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o1S1T1X1f1k1m1|2f2l2z2}3i3t5j8Z#[^O[_`wx!f!g!}#O$S$d$l$s$u&S&U&Y&c&m&r&x'P'b't(Q)p*]*q*v+[,X,k,w,z-]-^-a-o-t-w.d.m.o1S1T1f2f2z2}3i3t_(U#R#S#T+b3[3]3^#}ZO[wx!g!k#R#S#T%m&S&U&Y&c&m&w&x&y&|'O'P'['b't'x'}(P(Q(U*q*v+[+b,X,h,k,q-P-]-^-a-o-t-w-z._.d.m.q1S1T1f2c2k2z2}3[3]3^3i6c6j8g9l9p:W:]:fQ$]YR0T*OR*Q$]e0P)}/|/}0O0R4}5O5P5S8Q'`!YO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fe0P)}/|/}0O0R4}5O5P5S8QR5T0T^(T#R#S#T+b3[3]3^Y.]'}(R(U(V7TU3k.Z.^.qS7X3l4VR9c7s^(S#R#S#T+b3[3]3^[.['}(R(T(U(V7TW3j.Z.].^.qU7W3k3l4VS8z7X7sR:V9cT.k(Q.md]Owx!g&S't(Q*q-w.m!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)p*]*v+[,X,k,w,z-]-^-a-o-t.d.o1S1T1f2f2z2}3i3tQ%tnT1u+}1v!jbOaenpwx{|!g#O$|$}%S%h%w&S't'u(Q*`*b*q-p-w.f.m.o0]0y1S2j5a6g;`;xf-W'`-T-V-Y2p2q2s2v6q6r8pj3x.g3s3w3z3{7c7e7f7h7k9X9Y:Rr;zg$g%d%i&s*Y*t,l,v-_2_;W;X;Y;o;q;vi<^+]0z1O;a;b;p;r;w;y<W<X<Y!O&^y%X&V&Y&Z'k)h*d*f+]+e+x/m0^0y0z1O1S1j5a5v;x;yz&az%O%W%e&d's*W*_,b-x0Z0[0k0|2`2g2{5V5b6l8iS'{#Q.Xn+l&X*g+f+m+p-j/h0_1R1^4t5W5`5u8XQ2W,a^2t-X2r2x6p6w8o9se7i3y7_7g7o7p9U9W9`:Q:cS+^&U1TY+n&Y&c*v1S3iR5s1f#w!POaegnpwx{|!g#O$g$|$}%S%d%h%i%w&S&s't'u(Q*Y*`*b*q*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Y`oOwx!g&S't*q-w#U!Paeg{|#O$g$|$}%S%d%h%i&s'u*Y*`*b*t+],l,v-_0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YU%vnp-pQ*}%wS.e(Q.mT3v.f.oW+r&^+l+s1cV+z&a+{7iQ+x&`U+z&a+{7iQ-w'tT.S'y.U'`![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fX1r+y.X5}6P'W!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fW1r+y.X5}6PR2e,s!WjO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fY%Ve$e(b1p3iQ'S!nS(y#i5YQ,m&xQ,x'PS.O'y.UQ2b,nQ6k2iQ6|2}Q8h6fR9m8e'W![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fX1r+y.X5}6P'ayO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k+y,P,R,n,q,w-]-^-a-g.P.Q.U.X.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q5}6P6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ&`yS't#O-uR1[+cS+^&U1TR5n1[Q1P+]R5g1OR1P+]T+^&U1Tz&[%X&V&Y&Z'k)h*d*f+]+e/m0^0y0z1O1S1j5a5v;x;yQ&]yR1n+x!P&[y%X&V&Y&Z'k)h*d*f+]+e+x/m0^0y0z1O1S1j5a5v;x;yQ+u&^S+|&a7iS1d+l+sQ1t+{R5r1c!WkO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fS%zo.eS&Oq-rQ&_yQ&q!eQ'e!yQ*p%eU*{%v%{3vS+P%x%}Q+q&]Q,Y&mS,Z&n'gQ,r&{S0X*W,bS0o*|*}Q0q+OQ1o+xS2S,]-fQ5U0ZQ5Z0pQ5{1nQ6Y2RQ6]2WQ7n3yQ9S7_R:P9U[uOwx!g&S*qQ,Y&mQ-v'tQ3Y-tR3_-wxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fU$h[&|-^S%zo.eS&Oq-rQ*p%eU*{%v%{3vS+P%x%}S0X*W,bS0o*|*}Q0q+OQ5U0ZQ5Z0pQ7n3yQ9S7_R:P9UT,_&q,`]uOwx!g&S*q[uOwx!g&S*qQ,Y&mQ,n&xQ,w'PW-`'b-]-a2zQ-v'tQ3Y-tQ3_-wR6{2}[%fg$g,l,v-_2_R0l*t^$XV!U$a$z%P<R<SQ'S!nS)`#}*vS)v$W*qQ)y$YY*s%e*W0k2g2{Q/O(fS/i)i/PS0a*h4aS0j*r6_Q0r+QQ4Q.gQ4n/cS4q/j/kS4v/n5YQ4{/uQ6`2`U7a3s3y4RQ8O4rQ8k6hY9Q7_7b7c7l7mQ9r8mW9z9O9R9U9VQ:Z9oU:a9{9}:OR:j:bS)v$W*qT4v/n5YZ)t$W)u*q/n5YQ&w!hR'x#PS,g&v'vQ2[,eR6^2ZxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fV$h[&|-^!XkO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:f!WhO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fR'W!q!WkO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fR,n&xQ&y!iQ&{!jQ'O!lR,q&zR,o&xxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fX-`'b-]-a2z[uOwx!g&S*qQ,z'PQ-v'tS.k(Q.mR3_-w[uOwx!g&S*qQ,z'PW-`'b-]-a2zT.k(Q.mg-Z'`-T-V-Y2p2q2s2v6q6r8pylOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fb!OOaewx{!g&S*q&|$j[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f#d%jgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YQ']!tQ-S'^Q-d'fQ2Q,[Q6[2TR8a6Zj$RT$_%b%r:z:{:|;[;];^;_;c;di)o$V*U:w:x:y;h;i;j;k;l;m;nj$RT$_%b%r:z:{:|;[;];^;_;c;dh)o$V*U:w:x:y;h;i;j;k;l;m;nS/^({<[V4k/_/`;u[uOwx!g&S*qQ-v'tR3_-w[uOwx!g&S*qT.k(Q.m'`!YO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fR7R3T[uOwx!g&S*qQ-v'tS.k(Q.mR3_-w[pOwx!g&S*qQ%wnS-p't-wT.f(Q.mS%{o.eS*|%v3vR0p*}Q+R%yR5]0sS%zo.eS&Oq-rU*{%v%{3vS+P%x%}S0o*|*}Q0q+OQ5Z0pQ7n3yQ9S7_R:P9U`qOwx!g&S(Q*q.mS%xn-pU%}p.f.oQ+O%wT-r't-wS'z#Q.XR.Y'{T.R'y.US.S'y.UQ8x7UR9w8yT5}1q8_R6P1q#d!Pgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Yb!QOaewx{!g&S*q&}![[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f#d!Pgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Yb!QOaewx{!g&S*q&|![[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fk3|.g3s3w3z3{7c7e7f7h7k9X9Y:RQ4Q.gS7a3s3yU9Q7_7c7lS9z9O9UR:a9}#|!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o1S1T1X1f1k1m1|2f2l2z2}3i3t5j8ZR4].uQ(]#US.v([(^S4^.w.xR7w4_Q.s(ZR7u4X#|!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o1S1T1X1f1k1m1|2f2l2z2}3i3t5j8Zp$w`$d$s%X&r'`(_(f)i*d-T/k1j5k5v8Uq(}#k%y.g0s3s3w3z3{7c7e7f7h7k9X9Y:RR,U&fR6W1|'X!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f$q#rS%T%Z'Q'X'Z'a'c(a(e(h(w(x)R)S)U)V)W)X)Y)Z)[)])^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i$]#sS%T%Z'Q'X'Z'a'c(h(w(x)R)V)^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i$Z#tS%T%Z'Q'X'Z'a'c(h(w(x)R)^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i$c#wS%T%Z'Q'X'Z'a'c(h(w(x)R)U)V)W)X)^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i'X![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ/P(fQ/j)iQ4r/kR9d7y']![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ#eQR(u#eU$|a;`;xb%Ue$e&f(b-Q1m1|2l8ZQ'_!u!Q*^$|%U'_*`*f+h,P0]0^1b2p6q6t7e8p9X9]:R;W;o;p;v;w<WS*`$}%SQ*f%XS+h&W1QQ,P&bQ0]*bQ0^*dQ1b+kQ2p-VS6q2q2sQ6t2uQ7e3wQ8p6rS9X7f7hQ9]7jQ:R9YQ;W%dS;o;X;YS;p<X<YQ;v;qQ;w;rT<W0z;a[[Owx!g&S*ql$c[&|'}+[,X,h,k-P-^-o-z._.d.ql&|!k%m&y'O,q2c6c6j8g9l9p:W:]:f^'}#R#S#T+b3[3]3^`+[&U&Y&c*v1S1T1f3iS,X&m-tQ,h&wU,k&x'P2}S-P'[2kW-^'b-]-a2zS-o't-wQ-z'xQ._(PS.d(Q.mR.q(UQ)|$[R/x)|Q0R)}Q4}/|Q5O/}Q5P0OY5Q0R4}5O5P8QR8Q5SQ*P$]S0U*P0VR0V*QS.`(P._S3n.`7[R7[3pQ3q.aS7Y3o3rU7^3q7Y8{R8{7ZQ.m(QR4S.m!|_O[wx!f!g!}#O$S$l&S&U&Y&c&m&x'P'b't(Q)p*q*v+[,X,k,w,z-]-^-a-o-t-w.d.m.o1S1T1f2f2z2}3i3tU$r_$u*]U$u`$d&rR*]$sU$}a;`;xd*a$}*b2q6r7f9Y;X;q;r<XQ*b%SQ2q-VQ6r2sQ7f3wQ9Y7hQ;X%dQ;q;YQ;r<YT<X0z;aS+{&a7iR1s+{S*j%Z/pR0c*jQ1U+_R5i1UU+e&V0z;xR1]+eQ+s&^Q1c+lT1i+s1cQ8[5yR9i8[QwOS&Rw&ST&Sx*qQ,`&qR2V,`W)u$W*q/n5YR/t)uU/o)q)v0gR4w/o[*u%e%f*W2`2g2{R0m*uQ,d&uR2Y,dQ-a'bQ2z-]T2|-a2zQ2w-XR6x2wQ-f'gQ2R,]T3Q-f2RS%pm7QR*z%pdnOwx!g&S't(Q*q-w.mR%unQ0t+RR5^0tQ.U'yR3f.UQ1v+}R6Q1vU*n%`*x;ZR0f*nS1g+n0nR5t1gQ7l3yQ9O7_U9a7l9O9}R9}9U$O!SO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o.u1S1T1X1f1k1m1|2f2l2z2}3i3t5j8ZR&g!SQ4Y.sR7v4YQ1},UR6X1}S/d)_)`R4o/dW(o#a(j(k/SR/W(oQ7{4fR9f7{T)a#}*v!USO[wx!g!k%m&S&y&|'O'b,q-]-^-a2c2z6c6j8g9l9p:W:]:fj$ya{$k%]+j,R1a1z5q6v8s9_:UY%Te$e(b1p3iY%Zf$f(i)l*lQ&j!WQ&k!XQ'Q!nQ'X!rQ'Z!sQ'a!vQ'c!xQ(a#XQ(e#YS(h#[+YQ(w#gQ(x#iQ)R#lQ)S#qQ)T#rQ)U#sQ)V#tQ)W#uQ)X#vQ)Y#wQ)Z#xQ)[#yQ)]#zQ)^#{S)_#}*vQ)k$UQ)q$WQ)x$YQ+X&QS+g&W1QQ,O&bQ,S&fQ,j&xQ,u'PQ-h'iQ-i'jS-|'y.UQ.y(`S/p)r0hS0`*h4aQ0b*iQ0g*qQ0i*rQ0w+WS1`+h+kQ1y,PQ2a,nS2h,w6{Q3R-gQ3c.PQ3d.QQ4c.}Q4d/QQ4j/[Q4m/cQ4s/lQ4u/nQ4y/sQ4z/uQ5d0{Q5p1bQ5w1lQ6U1|S6e2f8tQ6i2iQ6s2uQ6z2}Q7q4OQ7r4RQ7t4WQ8S5YQ8T5eQ8c6_Q8f6fQ8j6hQ8r6tS9T7b7mQ9[7jQ9k8eQ9q8mS9|9R9VQ:T9]Q:Y9oS:`9{:OR:i:bR,V&fd]Owx!g&S't(Q*q-w.m!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)p*]*v+[,X,k,w,z-]-^-a-o-t.d.o1S1T1f2f2z2}3i3t#r${ae!u$e$|$}%S%U%X%d&W&b&f'_(b*`*b*d*f+h+k,P-Q-V0]0^1Q1b1m1|2l2p2q2s2u3w6q6r6t7e7f7h7j8Z8p9X9Y9]:R;W;X;Y;`;a;o;p;q;r;v;w<W<X<YQ%tnS+d&V+eW+r&^+l+s1cU+z&a+{7iQ1k+tT5c0z;x``Owx!g&S't*q-wS$d[-oQ$s_b%Xe$e&f(b-Q1m1|2l8Z!h&r!f!}#O$S$l&U&Y&c&m&x'P'b(Q)p*v+[,X,k,w,z-]-^-a-t.d.m.o1S1T1f2f2z2}3i3tQ'`!uS(_#V+aQ(f#ZS)i$T(gQ*d%UQ-T'_Q/k)jQ1j+tQ5k1XQ5v1kR8U5jS(W#R3]S(X#S3^V(Y#T+b3[R$^Ye0Q)}/|/}0O0R4}5O5P5S8QW(R#R#S#T+bQ([#US.Z'}(US.a(P._Q.x(^W1r+y.X5}6PQ3Z-tQ3h.WQ3o.`Q4V.qU7T3[3]3^Q7]3pR8|7[Q.b(PR3m._T.l(Q.mdgOwx!g&S&m't*q-t-wU$g[,X-oQ&s!fQ'k!}Q'u#OQ)h$SQ*Y$l`+]&U&Y&c*v1S1T1f3iQ,l&xQ,v'PY-_'b-]-a2z2}S.g(Q.mQ/m)pQ0y+[S2_,k-^S2j,w,zS3s.d.oQ6g2fR7c3td]Owx!g&S't(Q*q-w.m!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)p*]*v+[,X,k,w,z-]-^-a-o-t.d.o1S1T1f2f2z2}3i3tR%tnQ3y.gQ7_3sQ7g3wQ7o3zQ7p3{Q9U7cU9W7e7f7hQ9`7kS:Q9X9YR:c:RZ+o&Y&c*v1S3ipzOnpwx!g%w&S't(Q*q-p-w.f.m.o[%Oa%d0z;`;a;xU%We%h1SQ%eg^&d{|%i1O5a;b;yQ's#OQ*W$gb*_$|$}%S;W;X;Y<W<X<YQ,b&sQ-x'uQ0Z*Y[0[*`*b;o;p;q;rQ0k*tQ0|+]Q2`,lQ2g,vS2{-_2_U5V0];v;wQ5b0yQ6l2jR8i6gQ+}&aR9Z7iS1q+y.XQ8^5}R8_6P[%^f$f(i)l)r0hR0d*lR+`&UQ+_&UR5h1TS&Xy+xQ*g%XU+f&V0z;xS+m&Y1SW+p&Z1O5a;yQ-j'kQ/h)hS0_*d*fQ1R+]Q1^+eQ4t/mQ5W0^Q5`0yQ5u1jR8X5vR5z1mYvOwx&S*qR&t!gW%gg,l,v-_T*X$g2_T)w$W*q[uOwx!g&S*qQ&}!kQ*y%mQ,p&yQ,t'OQ2d,qQ6b2cQ8d6cQ8l6jQ9n8gQ:X9lQ:[9pQ:e:WQ:g:]R:k:fxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fU$h[&|-^X-`'b-]-a2zQ-['`R2o-TS-X'`-TQ2r-VQ2x-YU6p2p2q2sQ6w2vS8o6q6rR9s8p[rOwx!g&S*qS-q't-wT.h(Q.mR+S%y[sOwx!g&S*qS-s't-wT.i(Q.m[tOwx!g&S*qT.j(Q.mT.T'y.UX%af%k0h1QQ.w([R4_.xR.t(ZR(d#XQ(r#aS/R(j(kR4e/SR/V(lR4g/T",nodeNames:"⚠ RawString > MacroName LineComment BlockComment PreprocDirective #include String EscapeSequence SystemLibString Identifier ArgumentList ( ConditionalExpression AssignmentExpression CallExpression PrimitiveType FieldExpression FieldIdentifier DestructorName TemplateMethod ScopedFieldIdentifier NamespaceIdentifier TemplateType TypeIdentifier ScopedTypeIdentifier ScopedNamespaceIdentifier :: NamespaceIdentifier TypeIdentifier TemplateArgumentList < TypeDescriptor const volatile restrict _Atomic mutable constexpr constinit consteval StructSpecifier struct MsDeclspecModifier __declspec ) Attribute AttributeName Identifier AttributeArgs { } [ ] UpdateOp ArithOp ArithOp ArithOp LogicOp BitOp BitOp BitOp CompareOp CompareOp CompareOp > CompareOp BitOp UpdateOp , Number CharLiteral AttributeArgs VirtualSpecifier BaseClassClause Access virtual FieldDeclarationList FieldDeclaration extern static register inline thread_local AttributeSpecifier __attribute__ PointerDeclarator MsBasedModifier __based MsPointerModifier FunctionDeclarator ParameterList ParameterDeclaration PointerDeclarator FunctionDeclarator Noexcept noexcept RequiresClause requires True False ParenthesizedExpression CommaExpression LambdaExpression LambdaCaptureSpecifier TemplateParameterList OptionalParameterDeclaration TypeParameterDeclaration typename class VariadicParameterDeclaration VariadicDeclarator ReferenceDeclarator OptionalTypeParameterDeclaration VariadicTypeParameterDeclaration TemplateTemplateParameterDeclaration template AbstractFunctionDeclarator AbstractPointerDeclarator AbstractArrayDeclarator AbstractParenthesizedDeclarator AbstractReferenceDeclarator ThrowSpecifier throw TrailingReturnType CompoundStatement FunctionDefinition MsCallModifier TryStatement try CatchClause catch LinkageSpecification Declaration InitDeclarator InitializerList InitializerPair SubscriptDesignator FieldDesignator ExportDeclaration export ImportDeclaration import ModuleName PartitionName HeaderName CaseStatement case default LabeledStatement StatementIdentifier ExpressionStatement IfStatement if ConditionClause Declaration else SwitchStatement switch DoStatement do while WhileStatement ForStatement for ReturnStatement return BreakStatement break ContinueStatement continue GotoStatement goto CoReturnStatement co_return CoYieldStatement co_yield AttributeStatement ForRangeLoop AliasDeclaration using TypeDefinition typedef PointerDeclarator FunctionDeclarator ArrayDeclarator ParenthesizedDeclarator ThrowStatement NamespaceDefinition namespace ScopedIdentifier Identifier OperatorName operator ArithOp BitOp CompareOp LogicOp new delete co_await ConceptDefinition concept UsingDeclaration enum StaticAssertDeclaration static_assert ConcatenatedString TemplateDeclaration FriendDeclaration friend union FunctionDefinition ExplicitFunctionSpecifier explicit FieldInitializerList FieldInitializer DefaultMethodClause DeleteMethodClause FunctionDefinition OperatorCast operator TemplateInstantiation FunctionDefinition FunctionDefinition Declaration ModuleDeclaration module RequiresExpression RequirementList SimpleRequirement TypeRequirement CompoundRequirement ReturnTypeRequirement ConstraintConjuction LogicOp ConstraintDisjunction LogicOp ArrayDeclarator ParenthesizedDeclarator ReferenceDeclarator TemplateFunction OperatorName StructuredBindingDeclarator ArrayDeclarator ParenthesizedDeclarator ReferenceDeclarator BitfieldClause FunctionDefinition FunctionDefinition Declaration FunctionDefinition Declaration AccessSpecifier UnionSpecifier ClassSpecifier EnumSpecifier SizedTypeSpecifier TypeSize EnumeratorList Enumerator DependentType Decltype decltype auto PlaceholderTypeSpecifier ParameterPackExpansion ParameterPackExpansion FieldIdentifier PointerExpression SubscriptExpression BinaryExpression ArithOp LogicOp LogicOp BitOp UnaryExpression LogicOp BitOp UpdateExpression CastExpression SizeofExpression sizeof CoAwaitExpression CompoundLiteralExpression NULL NewExpression new NewDeclarator DeleteExpression delete ParameterPackExpansion nullptr this UserDefinedLiteral ParamPack #define PreprocArg #if #ifdef #ifndef #else #endif #elif PreprocDirectiveName Macro Program",maxTerm:425,nodeProps:[["group",-35,1,8,11,14,15,16,18,71,72,100,101,102,104,191,208,229,242,243,270,271,272,277,280,281,282,284,285,286,287,290,292,293,294,295,296,"Expression",-13,17,24,25,26,42,255,256,257,258,262,263,265,266,"Type",-19,126,129,147,150,152,153,158,160,163,164,166,168,170,172,174,176,178,179,188,"Statement"],["isolate",-4,4,5,8,10,""]],propSources:[NDe],skippedNodes:[0,3,4,5,6,7,10,297,298,299,300,301,302,303,304,305,306,347,348],repeatNodeCount:41,tokenData:"&*r7ZR!UOX$eXY({YZ.gZ]$e]^+P^p$epq({qr.}rs0}st2ktu$euv!7dvw!9bwx!;exy!<Yyz!=Tz{!>O{|!?R|}!AV}!O!BQ!O!P!DX!P!Q#+y!Q!R#Az!R![$(x![!]$Ag!]!^$Cc!^!_$D^!_!`%1W!`!a%2X!a!b%5_!b!c$e!c!n%6Y!n!o%7q!o!w%6Y!w!x%7q!x!}%6Y!}#O%:n#O#P%<g#P#Q%Kz#Q#R%Ms#R#S%6Y#S#T$e#T#i%6Y#i#j%Nv#j#o%6Y#o#p&!e#p#q&#`#q#r&%f#r#s&&a#s;'S$e;'S;=`(u<%lO$e&t$nY)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e&r%eW)ZW'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^&j&SU'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j&kX'f&jOY%}YZ%}Z]%}]^'W^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j']V'f&jOY%}YZ%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j'uP;=`<%l%}&r'{P;=`<%l%^&l(VW(pQ'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O&l(rP;=`<%l(O&t(xP;=`<%l$e7Z)Y`)ZW(pQ(n.o'f&j*Z)`OX$eXY({YZ*[Z]$e]^+P^p$epq({qr$ers%^sw$ewx(Ox#O$e#O#P,^#P;'S$e;'S;=`(u<%lO$e.o*aT(n.oXY*[YZ*[]^*[pq*[#O#P*p.o*sQYZ*[]^*y.o*|PYZ*[4e+[`)ZW(pQ(n.o'f&jOX$eXY+PYZ*[Z]$e]^+P^p$epq+Pqr$ers%^sw$ewx(Ox#O$e#O#P,^#P;'S$e;'S;=`(u<%lO$e4Z,cX'f&jOY%}YZ-OZ]%}]^-{^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}4Z-V[(n.o'f&jOX%}XY-OYZ*[Z]%}]^-O^p%}pq-Oq#O%}#O#P,^#P;'S%};'S;=`'r<%lO%}4Z.QV'f&jOY%}YZ-OZ#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}7P.nT*W)`(n.oXY*[YZ*[]^*[pq*[#O#P*p3o/[[%^!b'QP)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`0Q!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o0_Y%]!b!a,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e6e1YY)ZW(qQ(o/]'f&jOY%^Zr%^rs1xsw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^(U2RW)x!b)ZW'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^4e2tf)ZW(pQ'f&jOX$eXY2kZp$epq2kqr$ers%^sw$ewx(Ox!c$e!c!}4Y!}#O$e#O#P&f#P#T$e#T#W4Y#W#X5m#X#Y>u#Y#]4Y#]#^NZ#^#o4Y#o;'S$e;'S;=`(u<%lO$e4e4eb)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e5xd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y7W#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e7cd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z8q#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e8|d)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^:[#^#o4Y#o;'S$e;'S;=`(u<%lO$e4e:gd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#b4Y#b#c;u#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e<Qd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y=`#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e=mb)ZW(pQ'e.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e?Qf)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#`4Y#`#a@f#a#b4Y#b#cHV#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e@qf)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^BV#^#g4Y#g#hEV#h#o4Y#o;'S$e;'S;=`(u<%lO$e4eBbd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#ZCp#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4eC}b)ZW(pQ'f&j'l.o'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eEbd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#YFp#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4eF}b)ZW(pQ'j.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eHbd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#XIp#X#o4Y#o;'S$e;'S;=`(u<%lO$e4eI{d)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^KZ#^#o4Y#o;'S$e;'S;=`(u<%lO$e4eKfd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#ZLt#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4eMRb)ZW(pQ'f&j'k.o'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eNff)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z! z#Z#b4Y#b#c!.[#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e!!Xf)ZW(pQ'g.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!#m#X#b4Y#b#c!(W#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e!#xd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!%W#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!%cd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z!&q#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e!'Ob)ZW(pQ'h.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e!(cd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!)q#X#o4Y#o;'S$e;'S;=`(u<%lO$e4e!)|d)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!+[#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!+gd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z!,u#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e!-Sb)ZW(pQ'i.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e!.gd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#V4Y#V#W!/u#W#o4Y#o;'S$e;'S;=`(u<%lO$e4e!0Qd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#`4Y#`#a!1`#a#o4Y#o;'S$e;'S;=`(u<%lO$e4e!1kd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#i4Y#i#j!2y#j#o4Y#o;'S$e;'S;=`(u<%lO$e4e!3Ud)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!4d#X#o4Y#o;'S$e;'S;=`(u<%lO$e4e!4od)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!5}#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!6[b)ZW(pQV.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e3o!7q[)ZW(pQ%Z!b![,g'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!8rY!g-y)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!9o])V,g)ZW(pQ%[!b'f&jOY$eZr$ers%^sv$evw!:hwx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!:uY)U,g%^!b)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2X!;pW)[S(pQ)Y,g'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O6i!<eY)ZW(pQ]6_'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e'V!=`Y!Oa)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!>][)S,g)ZW(pQ%Z!b'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!?`^)ZW(pQ%Z!b!Y,g'f&jOY$eZr$ers%^sw$ewx(Ox{$e{|!@[|!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!@gY)ZW!X-y(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!AbY!h,k)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!B__)ZW(pQ%Z!b!Y,g'f&jOY$eZr$ers%^sw$ewx(Ox}$e}!O!@[!O!_$e!_!`!8g!`!a!C^!a#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!CiY(x-y)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!Dd^)ZW(pQ'f&j(w,gOY$eZr$ers%^sw$ewx(Ox!O$e!O!P!E`!P!Q$e!Q![!GY![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!Ei[)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P!F_!P#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!FjY)X,k)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]!Gen)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx!Icx!Q$e!Q![!GY![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2T!IjY(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![!JY![#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O2T!Jcn(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx!Icx!Q(O!Q![!JY![!g(O!g!h!La!h!i##`!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#X(O#X#Y!La#Y#Z##`#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T!Ljl(pQ!i,g'f&jOY(OZr(Ors%}s{(O{|!Nb|}(O}!O!Nb!O!Q(O!Q![# e![!c(O!c!h# e!h!i# e!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#Y# e#Y#Z# e#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T!Ni^(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![# e![!c(O!c!i# e!i#O(O#O#P&f#P#T(O#T#Z# e#Z;'S(O;'S;=`(o<%lO(O2T# nj(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx!Nbx!Q(O!Q![# e![!c(O!c!h# e!h!i# e!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#Y# e#Y#Z# e#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T##id(pQ!i,g'f&jOY(OZr(Ors%}s!h(O!h!i##`!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#Y(O#Y#Z##`#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]#%Sn)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx(Ox{$e{|#'Q|}$e}!O#'Q!O!Q$e!Q![#(]![!c$e!c!h#(]!h!i#(]!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#Y#(]#Y#Z#(]#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]#'Z`)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![#(]![!c$e!c!i#(]!i#O$e#O#P&f#P#T$e#T#Z#(]#Z;'S$e;'S;=`(u<%lO$e2]#(hj)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx!Nbx!Q$e!Q![#(]![!c$e!c!h#(]!h!i#(]!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#Y#(]#Y#Z#(]#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]#*ef)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx(Ox!h$e!h!i#*Y!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#Y$e#Y#Z#*Y#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e7Z#,W`)ZW(pQ%Z!b![,g'f&jOY$eZr$ers%^sw$ewx(Oxz$ez{#-Y{!P$e!P!Q#:s!Q!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z#-c])ZW(pQ'f&jOY#-YYZ#.[Zr#-Yrs#/csw#-Ywx#5wxz#-Yz{#8j{#O#-Y#O#P#2`#P;'S#-Y;'S;=`#:m<%lO#-Y1e#._TOz#.[z{#.n{;'S#.[;'S;=`#/]<%lO#.[1e#.qVOz#.[z{#.n{!P#.[!P!Q#/W!Q;'S#.[;'S;=`#/]<%lO#.[1e#/]OT1e1e#/`P;=`<%l#.[7X#/jZ)ZW'f&jOY#/cYZ#.[Zw#/cwx#0]xz#/cz{#4O{#O#/c#O#P#2`#P;'S#/c;'S;=`#5q<%lO#/c7P#0bX'f&jOY#0]YZ#.[Zz#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#1SZ'f&jOY#0]YZ#.[Zz#0]z{#0}{!P#0]!P!Q#1u!Q#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#1|UT1e'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}7P#2eZ'f&jOY#0]YZ#0]Z]#0]]^#3W^z#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#3]X'f&jOY#0]YZ#0]Zz#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#3{P;=`<%l#0]7X#4V])ZW'f&jOY#/cYZ#.[Zw#/cwx#0]xz#/cz{#4O{!P#/c!P!Q#5O!Q#O#/c#O#P#2`#P;'S#/c;'S;=`#5q<%lO#/c7X#5XW)ZWT1e'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^7X#5tP;=`<%l#/c7R#6OZ(pQ'f&jOY#5wYZ#.[Zr#5wrs#0]sz#5wz{#6q{#O#5w#O#P#2`#P;'S#5w;'S;=`#8d<%lO#5w7R#6x](pQ'f&jOY#5wYZ#.[Zr#5wrs#0]sz#5wz{#6q{!P#5w!P!Q#7q!Q#O#5w#O#P#2`#P;'S#5w;'S;=`#8d<%lO#5w7R#7zW(pQT1e'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O7R#8gP;=`<%l#5w7Z#8s_)ZW(pQ'f&jOY#-YYZ#.[Zr#-Yrs#/csw#-Ywx#5wxz#-Yz{#8j{!P#-Y!P!Q#9r!Q#O#-Y#O#P#2`#P;'S#-Y;'S;=`#:m<%lO#-Y7Z#9}Y)ZW(pQT1e'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z#:pP;=`<%l#-Y7Z#;OY)ZW(pQS1e'f&jOY#:sZr#:srs#;nsw#:swx#@{x#O#:s#O#P#<z#P;'S#:s;'S;=`#At<%lO#:s7X#;wW)ZWS1e'f&jOY#;nZw#;nwx#<ax#O#;n#O#P#<z#P;'S#;n;'S;=`#@u<%lO#;n7P#<hUS1e'f&jOY#<aZ#O#<a#O#P#<z#P;'S#<a;'S;=`#>[<%lO#<a7P#=RXS1e'f&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P;'S#<a;'S;=`#>[<%lO#<a7P#=uVS1e'f&jOY#<aYZ%}Z#O#<a#O#P#<z#P;'S#<a;'S;=`#>[<%lO#<a7P#>_P;=`<%l#<a7P#>i]S1e'f&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P#b#<a#b#c#<a#c#f#<a#f#g#?b#g;'S#<a;'S;=`#>[<%lO#<a7P#?iUS1e'f&jOY#<aZ#O#<a#O#P#?{#P;'S#<a;'S;=`#>[<%lO#<a7P#@SZS1e'f&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P#b#<a#b#c#<a#c;'S#<a;'S;=`#>[<%lO#<a7X#@xP;=`<%l#;n7R#AUW(pQS1e'f&jOY#@{Zr#@{rs#<as#O#@{#O#P#<z#P;'S#@{;'S;=`#An<%lO#@{7R#AqP;=`<%l#@{7Z#AwP;=`<%l#:s2]#BVt)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#U$e#U#V$+X#V#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$=`#m;'S$e;'S;=`(u<%lO$e2T#DnY(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![#E^![#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O2T#Egp(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx#Dgx!O(O!O!P#Gk!P!Q(O!Q![#E^![!g(O!g!h!La!h!i##`!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#X(O#X#Y!La#Y#Z##`#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#Gtn(pQ!i,g'f&jOY(OZr(Ors%}s!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#I{p(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx#LPx!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#LW^(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![#Ir![!c(O!c!i#Ir!i#O(O#O#P&f#P#T(O#T#Z#Ir#Z;'S(O;'S;=`(o<%lO(O2T#M]t(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx#LPx{(O{|!Nb|}(O}!O!Nb!O!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]$ xp)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$$Xp)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#LPx!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$&ht)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#LPx{$e{|#'Q|}$e}!O#'Q!O!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$)Tp)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$+b_)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P$,a!P!Q$e!Q!R$-`!R![$(x![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$,j[)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![!GY![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$-kt)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#U$e#U#V$/{#V#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$0z#m;'S$e;'S;=`(u<%lO$e2]$0U[)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$(x![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$1T`)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$2V![!c$e!c!i$2V!i#O$e#O#P&f#P#T$e#T#Z$2V#Z;'S$e;'S;=`(u<%lO$e2]$2br)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx$4lx!O$e!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2T$4s^(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![$5o![!c(O!c!i$5o!i#O(O#O#P&f#P#T(O#T#Z$5o#Z;'S(O;'S;=`(o<%lO(O2T$5xr(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx$4lx!O(O!O!P#Gk!P!Q(O!Q![$5o![!c(O!c!g$5o!g!h$8S!h!i$5o!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X$5o#X#Y$8S#Y#Z$5o#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T$8]u(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx$4lx{(O{|!Nb|}(O}!O!Nb!O!P#Gk!P!Q(O!Q![$5o![!c(O!c!g$5o!g!h$8S!h!i$5o!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X$5o#X#Y$8S#Y#Z$5o#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]$:{u)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx$4lx{$e{|#'Q|}$e}!O#'Q!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$=ic)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P$,a!P!Q$e!Q!R$>t!R![$2V![!c$e!c!i$2V!i#O$e#O#P&f#P#T$e#T#Z$2V#Z;'S$e;'S;=`(u<%lO$e2]$?Pv)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx$4lx!O$e!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#U$2V#U#V$2V#V#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$0z#m;'S$e;'S;=`(u<%lO$e4e$Ar[(v-X)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox![$e![!]$Bh!]#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3s$BsYl-})ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$CnY)W,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7V$Dk_p,g%]!b)ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!^$Ej!^!_%+w!_!`%.U!`!a%0]!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej*[$Es])ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ejp$FoTO!`$Fl!`!a$GO!a;'S$Fl;'S;=`$GT<%lO$Flp$GTO$Wpp$GWP;=`<%l$Fl*Y$GbZ)ZW'f&jOY$GZYZ$FlZw$GZwx$HTx!`$GZ!`!a%(U!a#O$GZ#O#P$Ib#P;'S$GZ;'S;=`%(y<%lO$GZ*Q$HYX'f&jOY$HTYZ$FlZ!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT*Q$IOU$WpY#t'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}*Q$Ig['f&jOY$HTYZ$HTZ]$HT]^$J]^!`$HT!`!a$NO!a#O$HT#O#P%&n#P;'S$HT;'S;=`%'f;=`<%l%$z<%lO$HT*Q$JbX'f&jOY$HTYZ$J}Z!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT'[$KSX'f&jOY$J}YZ$FlZ!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$KvU$Wp'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}'[$L_Z'f&jOY$J}YZ$J}Z]$J}]^$MQ^!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$MVX'f&jOY$J}YZ$J}Z!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$MuP;=`<%l$J}*Q$M{P;=`<%l$HT*Q$NVW$Wp'f&jOY$NoZ!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`$NtW'f&jOY$NoZ!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`% eUY#t'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%})`% |Y'f&jOY$NoYZ$NoZ]$No]^%!l^#O$No#O#P%#d#P;'S$No;'S;=`%$[;=`<%l%$z<%lO$No)`%!qX'f&jOY$NoYZ%}Z!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`%#aP;=`<%l$No)`%#iZ'f&jOY$NoYZ%}Z]$No]^%!l^!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`%$_XOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l$No<%lO%$z#t%$}WOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h<%lO%$z#t%%lOY#t#t%%oRO;'S%$z;'S;=`%%x;=`O%$z#t%%{XOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l%$z<%lO%$z#t%&kP;=`<%l%$z*Q%&sZ'f&jOY$HTYZ$J}Z]$HT]^$J]^!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT*Q%'iXOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l$HT<%lO%$z*Y%(aW$WpY#t)ZW'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^*Y%(|P;=`<%l$GZ*S%)WZ(pQ'f&jOY%)PYZ$FlZr%)Prs$HTs!`%)P!`!a%)y!a#O%)P#O#P$Ib#P;'S%)P;'S;=`%*n<%lO%)P*S%*UW$WpY#t(pQ'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O*S%*qP;=`<%l%)P*[%+RY$WpY#t)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e*[%+tP;=`<%l$Ej7V%,U^)ZW(pQ%[!b!f,g'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!_$Ej!_!`%-Q!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%-]]!g-y)ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%.c]%]!b!b,g)ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%/[!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%/mY%]!b!b,g$WpY#t)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e)j%0hYY#t)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%1c[)j!c)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`0Q!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%2f]%]!b)ZW(pQ!d,g'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`%3_!`!a%4[!a#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%3lY%]!b!b,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%4i[)ZW(pQ%[!b!f,g'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e&u%5jY(uP)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z%6ib)ZW(yS(pQ!R,f(r%y'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e7Z%8Qb)ZW(yS(pQ!R,f(r%y'f&jOY$eZr$ers%9Ysw$ewx%9{x!Q$e!Q![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e5P%9cW)ZW(o/]'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^2T%:UW(pQ)Y,g'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O3o%:yZ!V-y)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!}$e!}#O%;l#O#P&f#P;'S$e;'S;=`(u<%lO$e&u%;wY)PP)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e4e%<la'f&jOY%=qYZ%>[Z]%=q]^%?Z^!Q%=q!Q![%?w![!w%=q!w!x%AX!x#O%=q#O#P%H_#P#i%=q#i#j%Ds#j#l%=q#l#m%IR#m;'S%=q;'S;=`%Kt<%lO%=q&t%=xUXY'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}4e%>e[XY(n.o'f&jOX%}XY-OYZ*[Z]%}]^-O^p%}pq-Oq#O%}#O#P,^#P;'S%};'S;=`'r<%lO%}4e%?bVXY'f&jOY%}YZ-OZ#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%@OWXY'f&jOY%}Z!Q%}!Q![%@h![#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%@oWXY'f&jOY%}Z!Q%}!Q![%=q![#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%A^['f&jOY%}Z!Q%}!Q![%BS![!c%}!c!i%BS!i#O%}#O#P&f#P#T%}#T#Z%BS#Z;'S%};'S;=`'r<%lO%}&t%BX['f&jOY%}Z!Q%}!Q![%B}![!c%}!c!i%B}!i#O%}#O#P&f#P#T%}#T#Z%B}#Z;'S%};'S;=`'r<%lO%}&t%CS['f&jOY%}Z!Q%}!Q![%Cx![!c%}!c!i%Cx!i#O%}#O#P&f#P#T%}#T#Z%Cx#Z;'S%};'S;=`'r<%lO%}&t%C}['f&jOY%}Z!Q%}!Q![%Ds![!c%}!c!i%Ds!i#O%}#O#P&f#P#T%}#T#Z%Ds#Z;'S%};'S;=`'r<%lO%}&t%Dx['f&jOY%}Z!Q%}!Q![%En![!c%}!c!i%En!i#O%}#O#P&f#P#T%}#T#Z%En#Z;'S%};'S;=`'r<%lO%}&t%Es['f&jOY%}Z!Q%}!Q![%Fi![!c%}!c!i%Fi!i#O%}#O#P&f#P#T%}#T#Z%Fi#Z;'S%};'S;=`'r<%lO%}&t%Fn['f&jOY%}Z!Q%}!Q![%Gd![!c%}!c!i%Gd!i#O%}#O#P&f#P#T%}#T#Z%Gd#Z;'S%};'S;=`'r<%lO%}&t%Gi['f&jOY%}Z!Q%}!Q![%=q![!c%}!c!i%=q!i#O%}#O#P&f#P#T%}#T#Z%=q#Z;'S%};'S;=`'r<%lO%}&t%HfXXY'f&jOY%}YZ%}Z]%}]^'W^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%IW['f&jOY%}Z!Q%}!Q![%I|![!c%}!c!i%I|!i#O%}#O#P&f#P#T%}#T#Z%I|#Z;'S%};'S;=`'r<%lO%}&t%JR['f&jOY%}Z!Q%}!Q![%Jw![!c%}!c!i%Jw!i#O%}#O#P&f#P#T%}#T#Z%Jw#Z;'S%};'S;=`'r<%lO%}&t%KO[XY'f&jOY%}Z!Q%}!Q![%Jw![!c%}!c!i%Jw!i#O%}#O#P&f#P#T%}#T#Z%Jw#Z;'S%};'S;=`'r<%lO%}&t%KwP;=`<%l%=q2a%LVZ!W,V)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P#Q%Lx#Q;'S$e;'S;=`(u<%lO$e'Y%MTY)]d)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%NQ[)ZW(pQ%[!b'f&j!_,gOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z& Vd)ZW(yS(pQ!R,f(r%y'f&jOY$eZr$ers%9Ysw$ewx%9{x!Q$e!Q!Y%6Y!Y!Z%7q!Z![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e2]&!pY!T,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o&#m^)ZW(pQ%[!b'f&j!^,gOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P#p$e#p#q&$i#q;'S$e;'S;=`(u<%lO$e3o&$vY)T,g%^!b)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e'V&%qY!Ua)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e(]&&nc)ZW(pQ%[!b'RP'f&jOX$eXY&'yZp$epq&'yqr$ers%^sw$ewx(Ox!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e&y&(Sc)ZW(pQ'f&jOX$eXY&'yZp$epq&'yqr$ers%^sw$ewx(Ox!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e&y&)jb)ZW(pQdT'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![&)_![!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e",tokenizers:[RDe,IDe,0,1,2,3,4,5,6,7,8,9],topRules:{Program:[0,307]},dynamicPrecedences:{87:1,94:1,119:1,184:1,187:-10,240:-10,241:1,244:-1,246:-10,247:1,262:-1,267:2,268:2,306:-10,365:3,417:1,418:3,419:1,420:1},specialized:[{term:356,get:r=>DDe[r]||-1},{term:32,get:r=>LDe[r]||-1},{term:66,get:r=>BDe[r]||-1},{term:363,get:r=>$De[r]||-1}],tokenPrec:24891}),VDe=HS.define({name:"cpp",parser:UDe.configure({props:[tq.add({IfStatement:yA({except:/^\s*({|else\b)/}),TryStatement:yA({except:/^\s*({|catch)\b/}),LabeledStatement:zIe,CaseStatement:r=>r.baseIndent+r.unit,BlockComment:()=>null,CompoundStatement:FIe({closing:"}"}),Statement:yA({except:/^{/})}),rq.add({"DeclarationList CompoundStatement EnumeratorList FieldDeclarationList InitializerList":HIe,BlockComment(r){return{from:r.from+2,to:r.to-2}}})]}),languageData:{commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\})$/,closeBrackets:{stringPrefixes:["L","u","U","u8","LR","UR","uR","u8R","R"]}}});function hC(){return new IIe(VDe)}const $5=r=>(_p("data-v-c96e8edb"),r=r(),Op(),r),FDe=$5(()=>xt("TresPerspectiveCamera",{position:[0,0,5]},null,-1)),zDe=$5(()=>xt("TresAxesHelper",{args:[2]},null,-1)),XDe=$5(()=>xt("TresBoxGeometry",{args:[2,2,2]},null,-1)),tz=`
varying vec2 UV;
void main() {
    UV = uv;
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( position, 1.0 );
}
`,iz=`
void main() {
  gl_FragColor = vec4(0.5, 0.5, 0.5, 1.0);
}
`,WDe={__name:"ShaderFragBase",setup(r){const{onLoop:e}=Ep(),n=[{name:"普通渐变",children:[{name:"普通渐变1",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = st.x;
    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"普通渐变2",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = 1.0-st.x-st.y; //写出渐变方程
    c = abs(c);
    gl_FragColor = vec4(c, c, c, 1.0);
}

                `},{name:"普通渐变3",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = st.x*st.x*st.x-st.y; //写出渐变方程
    c = abs(c);
    gl_FragColor = vec4(c, c, c, 1.0);
}

                `},{name:"普通渐变4",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = (st.x-0.5)*2.0;
    c = abs(c);
    gl_FragColor = vec4(0.0, c, 0.0, 1.0);
}
`},{name:"普通渐变5",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = 1.0-distance(st, vec2(0.5))*1.0;
    gl_FragColor = vec4(0.0, c, c, 1.0);
}
`}]},{name:"渐变和切变，可以用于边缘平滑",children:[{name:"渐变和切变1",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    
    float c = distance(st, vec2(0.5))*2.0;
    c = smoothstep(0.8, 0.9, c);
    
    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"渐变和切变2",frag:`

uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    
    float c = st.x*st.x*st.x-st.y;
    c = abs(c);
    c = smoothstep(0.005, 0.015, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}

`},{name:"颜色混合(颜色渐变)",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    
    float c = st.x*st.y;
    vec3 color = mix(vec3(1.0, 0.0, 0.0), vec3(0.0, 1.0, 0.0), c);
    
    gl_FragColor = vec4(color, 1.0);
}
`}]},{name:"重复图形",children:[{name:"重复图形1",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st *= 3.0;

    vec2 c = floor(st)*0.5;
    
    gl_FragColor = vec4(c, 0.0, 1.0);
}

`},{name:"重复图形2",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st *= 3.0;

    vec2 c = fract(st);
    
    gl_FragColor = vec4(c, 0.0, 1.0);
}

`},{name:"重复图形3",frag:`

uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st *= 3.0;

    vec2 center = 0.5+floor(st);
    float c = distance(st, center)*2.0;
    
    gl_FragColor = vec4(c, c, c, 1.0);
}
`}]},{name:"简单动画",children:[{name:"平移动画",frag:`
uniform vec2 u_resolution;
uniform float u_time;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st.x -= fract(u_time*0.2)*2.0-1.0;

    float c = distance(st, vec2(0.5))*2.0;
    c = step(0.5, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"缩放动画",frag:`
uniform vec2 u_resolution;
uniform float u_time;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st -= 0.5;
    st /= sin(u_time);

    float c = distance(st, vec2(0.0))*2.0;
    c = step(1.0, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"旋转动画",frag:`
uniform vec2 u_resolution;
uniform float u_time;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st -= 0.5;
    float theta = mod(u_time, 6.28);
    st = mat2(cos(theta), sin(theta), -sin(theta), cos(theta)) * st; //构造了一个绕Z轴的旋转矩阵

    float c = st.x;
    c = abs(c);
    c = step(0.05, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}
`}]}],i={u_time:{value:0},u_resolution:{value:{x:800,y:600}}};e(({elapsed:m})=>{i.u_time.value=m}),ot(!0);const s=Qn(null),o=Qn(null),a=ot(null);let l=null;const h=ot(null);let u=null;Xn(()=>{const m=St.updateListener.of(y=>{if(y.docChanged){let x=s.value;if(!x)return;x.vertexShader=y.state.doc.toString(),x.needsUpdate=!0}});l=new St({doc:"",extensions:[oC,hC(),m],parent:a.value});const v=St.updateListener.of(y=>{if(y.docChanged){let x=s.value;if(!x)return;x.fragmentShader=y.state.doc.toString(),x.needsUpdate=!0}});u=new St({doc:"",extensions:[oC,hC(),v],parent:h.value}),i.u_resolution.value.x=o.value.clientWidth,i.u_resolution.value.y=o.value.clientHeight}),Gi(s,()=>{p(0,0)});function f(m){return m.trim()}function p(m,v){let x=n[m].children[v],w=x.vert?x.vert:tz,S=x.frag?x.frag:iz;w=f(w),S=f(S);let O=l,_=O.state.update({changes:{from:0,to:O.state.doc.length,insert:w}});O.dispatch(_),O=u,_=O.state.update({changes:{from:0,to:O.state.doc.length,insert:S}}),O.dispatch(_)}return(m,v)=>{const y=bt("Button"),x=bt("Card"),w=bt("Col"),S=bt("Divider"),O=bt("Row");return ri(),Ar(O,null,{default:qe(()=>[Pe(w,{span:4},{default:qe(()=>[(ri(),Ji(yn,null,hc(n,(_,T)=>Pe(x,null,{title:qe(()=>[xt("h3",null,bh(_.name),1)]),default:qe(()=>[(ri(!0),Ji(yn,null,hc(_.children,(A,P)=>(ri(),Ar(y,{onClick:N=>p(T,P)},{default:qe(()=>[tn(bh(A.name),1)]),_:2},1032,["onClick"]))),256))]),_:2},1024)),64))]),_:1}),Pe(w,{span:10},{default:qe(()=>[xt("div",{ref_key:"tresCanvasParentRef",ref:o,class:"tresCanvasBorder"},[Pe(oi(y4),{"clear-color":"#FDF5E6"},{default:qe(()=>[FDe,zDe,xt("TresMesh",null,[XDe,xt("TresShaderMaterial",{ref_key:"materialRef",ref:s,uniforms:i,vertexShader:tz,fragmentShader:iz},null,512)]),Pe(oi(R2))]),_:1})],512)]),_:1}),Pe(w,{span:10},{default:qe(()=>[Pe(S,{orientation:"left"},{default:qe(()=>[tn("顶点着色器")]),_:1}),xt("div",{ref_key:"codeContainerV",ref:a},null,512),Pe(S,{orientation:"left"},{default:qe(()=>[tn("片段着色器")]),_:1}),xt("div",{ref_key:"codeContainerF",ref:h},null,512)]),_:1})]),_:1})}}},GDe=Ap(WDe,[["__scopeId","data-v-c96e8edb"]]),U5=r=>(_p("data-v-53185512"),r=r(),Op(),r),HDe=U5(()=>xt("TresPerspectiveCamera",{position:[0,0,5]},null,-1)),QDe=U5(()=>xt("TresAxesHelper",{args:[2]},null,-1)),jDe=U5(()=>xt("TresBoxGeometry",{args:[2,3.6,2]},null,-1)),nz=`
varying vec2 UV;
void main() {
    UV = uv;
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( position, 1.0 );
}
`,rz=`
void main() {
  gl_FragColor = vec4(0.5, 0.5, 0.5, 1.0);
}
`,YDe={__name:"ShaderImageBase",setup(r){const{onLoop:e}=Ep(),n=[{name:"显示图像",children:[{name:"显示图像",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
void main() {
    vec4 color = texture2D(u_tex0, UV);
    gl_FragColor = color;
}
`},{name:"图像变色",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
uniform float u_time;
void main() {
    vec4 color = texture2D(u_tex0, UV);
    float scale = abs(sin(u_time));
    scale *= 1.5;
    color.rgb *= scale;
    gl_FragColor = color;
}
`},{name:"图像置灰",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
uniform float u_time;
void main() {
    vec4 color = texture2D(u_tex0, UV);
    float gray = color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
    gl_FragColor = vec4(gray, gray, gray, color.a);
}
`},{name:"图像描边",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
uniform float u_time;

void main() {
    vec4 self = texture2D(u_tex0, UV);

    if(self.a>0.5){
        gl_FragColor = self;
        return;
    }

    float outlineW = abs(sin(u_time))*0.01;
    // outlineW = 0.01;

    int strokeCount = 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x-outlineW, UV.y)).a>0.0 ? 1 : 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x+outlineW, UV.y)).a>0.0 ? 1 : 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x, UV.y-outlineW)).a>0.0 ? 1 : 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x, UV.y+outlineW)).a>0.0 ? 1 : 0;

    if (strokeCount>0){
        self.rgb = vec3(1.0, 0.0, 1.0);
        self.a = 1.0;
    }

    gl_FragColor = self;
}
`}]}],i={u_time:{value:0},u_resolution:{value:{x:800,y:600}},u_tex0:{value:null}};e(({elapsed:m})=>{i.u_time.value=m}),ot(!0);const s=Qn(null),o=Qn(null),a=ot(null);let l=null;const h=ot(null);let u=null;Xn(()=>{const m=St.updateListener.of(y=>{if(y.docChanged){let x=s.value;if(!x)return;x.vertexShader=y.state.doc.toString(),x.needsUpdate=!0}});l=new St({doc:"",extensions:[oC,hC(),m],parent:a.value});const v=St.updateListener.of(y=>{if(y.docChanged){let x=s.value;if(!x)return;x.fragmentShader=y.state.doc.toString(),x.needsUpdate=!0}});u=new St({doc:"",extensions:[oC,hC(),v],parent:h.value}),i.u_resolution.value.x=o.value.clientWidth,i.u_resolution.value.y=o.value.clientHeight,oSe({map:"img/img1.png"}).then(y=>{i.u_tex0.value=y.map})}),Gi(s,()=>{p(0,0)});function f(m){return m.trim()}function p(m,v){let x=n[m].children[v],w=x.vert?x.vert:nz,S=x.frag?x.frag:rz;w=f(w),S=f(S);let O=l,_=O.state.update({changes:{from:0,to:O.state.doc.length,insert:w}});O.dispatch(_),O=u,_=O.state.update({changes:{from:0,to:O.state.doc.length,insert:S}}),O.dispatch(_)}return(m,v)=>{const y=bt("Button"),x=bt("Card"),w=bt("Col"),S=bt("Divider"),O=bt("Row");return ri(),Ar(O,null,{default:qe(()=>[Pe(w,{span:4},{default:qe(()=>[(ri(),Ji(yn,null,hc(n,(_,T)=>Pe(x,null,{title:qe(()=>[xt("h3",null,bh(_.name),1)]),default:qe(()=>[(ri(!0),Ji(yn,null,hc(_.children,(A,P)=>(ri(),Ar(y,{onClick:N=>p(T,P)},{default:qe(()=>[tn(bh(A.name),1)]),_:2},1032,["onClick"]))),256))]),_:2},1024)),64))]),_:1}),Pe(w,{span:10},{default:qe(()=>[xt("div",{ref_key:"tresCanvasParentRef",ref:o,class:"tresCanvasBorder"},[Pe(oi(y4),{"clear-color":"#FDF5E6"},{default:qe(()=>[HDe,QDe,xt("TresMesh",null,[jDe,xt("TresShaderMaterial",{ref_key:"materialRef",ref:s,uniforms:i,vertexShader:nz,fragmentShader:rz},null,512)]),Pe(oi(R2))]),_:1})],512)]),_:1}),Pe(w,{span:10},{default:qe(()=>[Pe(S,{orientation:"left"},{default:qe(()=>[tn("顶点着色器")]),_:1}),xt("div",{ref_key:"codeContainerV",ref:a},null,512),Pe(S,{orientation:"left"},{default:qe(()=>[tn("片段着色器")]),_:1}),xt("div",{ref_key:"codeContainerF",ref:h},null,512)]),_:1})]),_:1})}}},qDe=Ap(YDe,[["__scopeId","data-v-53185512"]]),ZDe=["src"],MA={__name:"ShowVideo",props:{link:String,width:Number,height:Number},setup(r){const e=r,n=ot(null);return Xn(()=>{var i=e.width?`${i}px`:"100%",s=e.height?`${s}px`:"100vh";n.value={width:i,height:s}}),(i,s)=>(ri(),Ji("video",{src:e.link,style:pd(n.value),controls:"",autoplay:"",loop:""},null,12,ZDe))}},nx=r=>(_p("data-v-523e230c"),r=r(),Op(),r),KDe=nx(()=>xt("audio",{src:"ballgame/ball_bgm.mp3",id:"ball_bgm",loop:"true"},null,-1)),JDe=nx(()=>xt("audio",{src:"ballgame/ball_bomb.mp3",id:"ball_bomb"},null,-1)),eLe=nx(()=>xt("audio",{src:"ballgame/ball_collect.mp3",id:"ball_collect"},null,-1)),tLe=nx(()=>xt("audio",{src:"ballgame/ball_click.mp3",id:"ball_click"},null,-1)),iLe=nx(()=>xt("div",{class:"watermark-tip"},[tn("躲避黑色，收集红色"),xt("br"),tn("点击屏幕改变小球方向")],-1)),nLe={__name:"BallGame",setup(r){const e={Wait:"Wait",Play:"Play"},n=ot(null);let i=null,s=null,o=[],a=null,l=[],h={},u=0,f=0,p=0,m=0,v=1,y=e.Wait,x=null,w=null,S=null,O=null,_=null,T=[];function A(z,j){const te=z.x,W=z.y,Z=z.radius,he=j.x,pe=j.y,_e=j.width,Re=j.height;let ie=Math.max(he,Math.min(te,he+_e)),q=Math.max(pe,Math.min(W,pe+Re)),me=te-ie,ve=W-q;return me*me+ve*ve<=Z*Z}function P(z,j){for(let te of j)if(A(z,te))return te;return null}const N={Black:"Black",Red:"Red"};class k{constructor(j,te,W=100,Z=50,he=10){this.color="black",this.x=j,this.y=te,this.width=W,this.height=Z,this.radius=he,this.rotation=0,this.rotationCenter={x:this.x+this.width/2,y:this.y+this.height/2},this.angle=0,this.speed=0,this.velocity={x:0,y:0}}setRotation(j){return this.rotation=j*Math.PI/180,this}setRotationCenter(j,te){return this.rotationCenter={x:j,y:te},this}setRotationCenterToMiddle(){return this.rotationCenter={x:this.x+this.width/2,y:this.y+this.height/2},this}setAngle(j){return this.angle=j*Math.PI/180,this._updateVelocity(),this}setSpeed(j){return this.speed=j,this._updateVelocity(),this}setVelocity(j,te){return this.velocity.x=j,this.velocity.y=te,this.speed=Math.sqrt(j*j+te*te),this.angle=Math.atan2(te,j),this}update(){return this.x+=this.velocity.x,this.y+=this.velocity.y,this.rotationCenter&&(this.rotationCenter.x+=this.velocity.x,this.rotationCenter.y+=this.velocity.y),this}_updateVelocity(){this.velocity.x=this.speed*Math.cos(this.angle),this.velocity.y=this.speed*Math.sin(this.angle)}getAngleDegrees(){return this.angle*180/Math.PI}getRotationDegrees(){return this.rotation*180/Math.PI}alignRotationWithMovement(){return this.rotation=this.angle,this}draw(j){j.save(),j.translate(this.rotationCenter.x,this.rotationCenter.y),j.rotate(this.rotation),j.translate(-this.rotationCenter.x,-this.rotationCenter.y);const{width:te,height:W,radius:Z}=this;j.beginPath(),j.moveTo(this.x+Z,this.y),j.lineTo(this.x+te-Z,this.y),j.arcTo(this.x+te,this.y,this.x+te,this.y+Z,Z),j.lineTo(this.x+te,this.y+W-Z),j.arcTo(this.x+te,this.y+W,this.x+te-Z,this.y+W,Z),j.lineTo(this.x+Z,this.y+W),j.arcTo(this.x,this.y+W,this.x,this.y+W-Z,Z),j.lineTo(this.x,this.y+Z),j.arcTo(this.x,this.y,this.x+Z,this.y,Z),j.closePath(),j.fillStyle=this.color,j.fill(),j.restore()}}class R{constructor(j,te){this.x=j,this.y=te,this.radius=20,this.angle=Math.random()*Math.PI*2,this.speed=20,this.life=1e3,this.alpha=100,this.color=`rgb(255,69,1,${this.alpha})`}draw(){i.beginPath(),i.arc(this.x,this.y,this.radius,0,Math.PI*2),i.fillStyle=this.color,i.fill()}update(j){this.x=this.x+Math.cos(this.angle)*this.speed,this.y=this.y+Math.sin(this.angle)*this.speed,this.angle+=Math.PI/180,this.speed*=.9,this.radius-=1,this.radius<0&&(this.radius=0),this.alpha-=Math.floor(j/1e3*255),this.life-=j}}class E{constructor(j,te,W=50){this.color="black",this.x=j,this.y=te,this.radius=W,this.rotation=0,this.rotationCenter={x:this.x,y:this.y},this.startAngle=0,this.endAngle=Math.PI*2,this.counterclockwise=!1,this.shadowColor="rgba(0, 0, 0, 0.3)",this.shadowBlur=10,this.shadowOffsetX=3,this.shadowOffsetY=3,this.useGradient=!0,this.highlightColor="rgba(255, 255, 255, 0.8)",this.shadowCenter="rgba(0, 0, 0, 0.2)",this.balls=[]}draw(j){j.save(),this.balls.length>0?this.drawBalls(j):this.drawSelf(j),j.restore()}update(j){this.balls.length>0?this.updateBalls(j):this.updateSelf&&this.updateSelf(j)}drawSelf(j){if(j.shadowColor=this.shadowColor,j.shadowBlur=this.shadowBlur,j.shadowOffsetX=this.shadowOffsetX,j.shadowOffsetY=this.shadowOffsetY,j.translate(this.rotationCenter.x,this.rotationCenter.y),j.rotate(this.rotation),j.translate(-this.rotationCenter.x,-this.rotationCenter.y),this.useGradient){const te=j.createRadialGradient(this.x-this.radius*.3,this.y-this.radius*.3,this.radius*.1,this.x,this.y,this.radius);te.addColorStop(0,this.highlightColor),te.addColorStop(.1,this.color),te.addColorStop(.9,this.color),te.addColorStop(1,this.shadowCenter),j.fillStyle=te}else j.fillStyle=this.color;j.beginPath(),j.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.counterclockwise),j.fill()}blast(){let j=10;this.balls=[];for(let te=0;te<j;te++)this.balls.push(new R(this.x,this.y))}updateBalls(j){let te=[];for(let W=0;W<this.balls.length;W++){const Z=this.balls[W];Z.update(j),Z.life<0&&te.push(Z)}for(let W=0;W<te.length;W++){const Z=te[W];let he=this.balls.indexOf(Z);he>=0&&this.balls.splice(he)}}drawBalls(j){for(let te=0;te<this.balls.length;te++)this.balls[te].draw(j)}setShadow(j,te,W,Z){return this.shadowColor=j,this.shadowBlur=te,this.shadowOffsetX=W,this.shadowOffsetY=Z,this}setGradientColors(j,te,W){return this.color=j,this.highlightColor=te,this.shadowCenter=W,this}setUseGradient(j){return this.useGradient=j,this}}const D=()=>{n.value&&(n.value.width=window.innerWidth,n.value.height=window.innerHeight)};function $(z,j){return Math.random()*(j-z)+z}function I(z){if(u+=z,u<=2e3)return;u=0;let j=60,te=60,W=h.centerX-j/2,Z=h.yMin,he=new k(W,Z,j,te,0);o.push(he),l.push(he),f==2?(he.boxType=N.Red,he.color="#f6416c"):(he.boxType=N.Black,he.color="#252a34"),f=(f+1)%3;let pe=$(-.8,.8)*v,_e=2*v;he.setVelocity(pe,_e)}function L(){let z=[];for(let j=0;j<l.length;j++){const te=l[j];let W=te.getRotationDegrees()+2;te.setRotation(W),te.y>h.yMax&&z.push(te)}for(let j=0;j<z.length;j++){const te=z[j];U(te)}}function U(z){let j=l.indexOf(z);j>=0&&l.splice(j,1),j=o.indexOf(z),j>=0&&o.splice(j,1)}function V(){let z=P(a,l);z&&(z.boxType===N.Red?(p+=1,v+=.3,ae(z.x+z.width/2,z.y+z.height/2,"#f6416c"),U(z),x.play()):(se(),U(z),a.blast(),S.play()),p>m&&(m=p))}function X(z,j,te,W,Z={}){z.save(),z.font=Z.font||"30px Courier New",z.textAlign=Z.align||"center",z.textBaseline=Z.baseline||"center",z.strokeStyle=Z.strokeColor||"black",z.lineWidth=Z.strokeWidth||5,z.strokeText(j,te,W),z.fillStyle=Z.fillColor||"white",z.fillText(j,te,W),z.restore()}let H=0;const J=()=>{if(!i||!n.value)return;if(y==e.Play){H||(H=Date.now());let j=Date.now(),te=j-H;for(let W=0;W<o.length;W++){const Z=o[W];Z.update&&Z.update(te)}I(te),L(),V(),H=j}i.fillStyle=s,i.fillRect(0,0,n.value.width,n.value.height);for(let j=0;j<o.length;j++)o[j].draw(i);y==e.Wait&&X(i,"点击屏幕开始游戏",h.centerX,h.yMax*.5);let z=130;X(i,`当前得分:${p}`,h.centerX,h.yMax*.6+z),X(i,`最高得分:${m}`,h.centerX,h.yMax*.6+z+50),Q(i),requestAnimationFrame(J)};function ee(z){y==e.Wait?(y=e.Play,x.load(),w.load(),S.load(),O.load(),w.play(),se(),J()):a.speed=-a.speed}function ne(z){_||(_="mouse"),_=="mouse"&&(ee(),z.preventDefault())}function ge(z){}function ye(z){}function ce(z){_||(_="touch"),_=="touch"&&(ee(),z.preventDefault())}function we(z){z.preventDefault()}function be(z){console.log("Touch end")}function se(){u=0,p=0,f=0,v=1}function ae(z,j,te){for(let W=0;W<18;W++){const Z=Math.random()*Math.PI*2,he=2+Math.random()*3;T.push({x:z,y:j,vx:Math.cos(Z)*he,vy:Math.sin(Z)*he,alpha:1,radius:6+Math.random()*4,color:te,life:24+Math.random()*10})}}function Q(z){for(let j=T.length-1;j>=0;j--){const te=T[j];if(te.x+=te.vx,te.y+=te.vy,te.vx*=.92,te.vy*=.92,te.alpha-=.035,te.life--,te.life<0||te.alpha<=0){T.splice(j,1);continue}z.save(),z.globalAlpha=Math.max(0,te.alpha),z.beginPath(),z.arc(te.x,te.y,te.radius,0,Math.PI*2),z.fillStyle=te.color,z.shadowColor=te.color,z.shadowBlur=8,z.fill(),z.restore()}}return Xn(()=>{i=n.value.getContext("2d"),D(),h.width=600,h.height=n.value.height,h.centerX=n.value.width/2,h.centerY=n.value.height/2,h.xMin=h.centerX-h.width/2,h.xMax=h.centerX+h.width/2,h.yMin=h.centerY-h.height/2,h.yMax=h.centerY+h.height/2;const z=n.value.width/2,j=n.value.height/2;s=i.createLinearGradient(0,0,n.value.width,0),s.addColorStop(0,"#71c9ce"),s.addColorStop(.5,"#8edbdf"),s.addColorStop(1,"#71c9ce"),window.addEventListener("resize",D),window.addEventListener("mousedown",ne),window.addEventListener("mousemove",ge),window.addEventListener("mouseup",ye),window.addEventListener("touchstart",ce),window.addEventListener("touchmove",we),window.addEventListener("touchend",be),w=document.getElementById("ball_bgm"),x=document.getElementById("ball_collect"),S=document.getElementById("ball_bomb"),O=document.getElementById("ball_click"),y=e.Wait,se();{let W=h.width,Z=h.height,he=z-W/2,pe=j-Z/2,_e=new k(he,pe,W,Z,5);_e.color="#A9A9A988"}let te=0;{let W=h.width*.6,Z=60,he=z-W/2,pe=h.yMax*.6,_e=new k(he,pe,W,Z,Z/2);_e.color="#A9A9A9",o.push(_e),te=W}{let W=30,Z=z,he=h.yMax*.6+W,pe=new E(Z,he,W);pe.color="#FF4500",pe.speed=300,pe.updateSelf=(_e=>{pe.x+=pe.speed*_e/1e3,pe.x>Z+te/2-W?pe.speed=-Math.abs(pe.speed):pe.x<Z-te/2+W&&(pe.speed=Math.abs(pe.speed)),pe.x>h.xMax&&(pe.x=h.xMin,pe.speed=Math.abs(pe.speed)),pe.x<h.xMin&&(pe.x=h.xMax,pe.speed=-Math.abs(pe.speed))}).bind(pe),o.push(pe),a=pe}J()}),Po(()=>{window.removeEventListener("resize",D),window.removeEventListener("mousedown",ne),window.removeEventListener("mousemove",ge),window.removeEventListener("mouseup",ye),window.removeEventListener("touchstart",ce),window.removeEventListener("touchmove",we),window.removeEventListener("touchend",be),w.pause()}),(z,j)=>(ri(),Ji(yn,null,[KDe,JDe,eLe,tLe,xt("canvas",{ref_key:"canvasRef",ref:n,type:"2d"},null,512),iLe],64))}},rLe=Ap(nLe,[["__scopeId","data-v-523e230c"]]),sLe=xt("TresPerspectiveCamera",{position:[0,20,0],rotation:[0,0,0]},null,-1),oLe=xt("TresAmbientLight",{intensity:1},null,-1),aLe=xt("TresAxesHelper",null,null,-1),lLe=xt("TresGridHelper",null,null,-1),cLe={__name:"ThreeHello",setup(r){const e=Qn(null);return Gi(e,()=>{}),(n,i)=>{const s=bt("TresCanvas");return ri(),Ji("div",null,[Pe(s,{ref_key:"canvasRef",ref:e,"clear-color":"#e0eee8","window-size":""},{default:qe(()=>[sLe,oLe,aLe,lLe,Pe(oi(R2))]),_:1},512)])}}},hLe=xt("TresAmbientLight",{intensity:1},null,-1),uLe=xt("TresAxesHelper",null,null,-1),dLe=["position"],fLe=xt("TresSphereGeometry",{args:[.4,8,8]},null,-1),pLe=xt("TresMeshBasicMaterial",{color:"red",transparent:!0,opacity:.1},null,-1),mLe=[fLe,pLe],gLe={__name:"CurveRope",setup(r){const e=Qn(null),n=Qn(null),i=Qn(null);let o=new Bb().load("img/rope3.png");var a=new vs({map:o});const l=Qn(null);let h=-1,u=new _2,f=xp([new le(0,-8,0),new le(0,2,0),new le(0,8,0)]);function p(){const x=new o2(...f),w=x.getLength();console.log("curveLength",w);const S=30;var O=[],_=[];for(let k=0;k<S;k++){let R=k/S,E=x.getPointAt(R),D=x.getTangentAt(R),$=new Xe(-D.y,D.x).normalize(),I=(k+1)/S,L=x.getPointAt(I),U=x.getTangentAt(I),V=new Xe(-U.y,U.x).normalize(),X=[E.clone().add($.clone().multiplyScalar(.4)),E.clone().sub($.clone().multiplyScalar(.4)),L.clone().add(V.clone().multiplyScalar(.4)),L.clone().sub(V.clone().multiplyScalar(.4))];O.push(X[0]),O.push(X[1]),O.push(X[2]),O.push(X[1]),O.push(X[3]),O.push(X[2]);let H=0,J=1;console.log(`ratio1=${R.toFixed(2)}`,`uv1=${H.toFixed(2)}`,`uv2=${J.toFixed(2)}`),_.push(new Xe(0,H)),_.push(new Xe(1,H)),_.push(new Xe(0,J)),_.push(new Xe(1,H)),_.push(new Xe(1,J)),_.push(new Xe(0,J))}const T=new Float32Array(O.length*3);for(let k=0;k<O.length;k++)T[k*3]=O[k].x,T[k*3+1]=O[k].y,T[k*3+2]=0;const A=new Float32Array(_.length*2);for(let k=0;k<_.length;k++)A[k*2]=_[k].x,A[k*2+1]=_[k].y;var P=new vi;for(P.setAttribute("position",new Di(T,3)),P.setAttribute("uv",new Di(A,2));n.value.children.length>0;)n.value.remove(n.value.children[0]);var N;{var N=new ln(P,a);n.value.add(N)}}Gi(n,()=>{p()});function m(x){if(h>=0){let w={x:0,y:0};w.x=x.clientX/window.innerWidth*2-1,w.y=-(x.clientY/window.innerHeight)*2+1,u.setFromCamera(w,i.value);let S=new wa(new le(0,0,1),0),O=new le;u.ray.intersectPlane(S,O)&&(f[h]=O),p()}}function v(x){let w={x:x.clientX/window.innerWidth*2-1,y:-(x.clientY/window.innerHeight)*2+1};u.setFromCamera(w,i.value);const S=u.intersectObjects(l.value.children);if(S.length>0){const O=S[0].object;h=l.value.children.indexOf(O)}else h=-1}function y(x){h=-1}return(x,w)=>{const S=bt("TresCanvas");return ri(),Ji("div",{onMousemove:m,onMousedown:v,onMouseup:y},[Pe(S,{ref_key:"canvasRef",ref:e,"clear-color":"#f9f7f7","window-size":""},{default:qe(()=>[xt("TresPerspectiveCamera",{ref_key:"cameraRef",ref:i,position:[0,0,20],rotation:[0,0,0]},null,512),hLe,uLe,xt("TresGroup",{ref_key:"curveRef",ref:n},null,512),xt("TresGroup",{ref_key:"controlPointsRef",ref:l},[(ri(!0),Ji(yn,null,hc(oi(f),(O,_)=>(ri(),Ji("TresMesh",{key:_,position:O},mLe,8,dLe))),128))],512)]),_:1},512)],32)}}};var Pp=(r=>(r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",r))(Pp||{}),yZ=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS",r))(yZ||{}),K3=(r=>(r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL",r))(K3||{}),di=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR",r))(di||{}),sc=(r=>(r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r))(sc||{}),rt=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))(rt||{}),Og=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(Og||{}),Jt=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(Jt||{}),At=(r=>(r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT",r))(At||{}),oh=(r=>(r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR",r))(oh||{}),Zu=(r=>(r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r))(Zu||{}),yc=(r=>(r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL",r))(yc||{}),To=(r=>(r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",r))(To||{}),ql=(r=>(r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT",r))(ql||{}),V5=(r=>(r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL",r))(V5||{}),ka=(r=>(r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp",r))(ka||{}),Lr=(r=>(r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR",r))(Lr||{}),Sr=(r=>(r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH",r))(Sr||{}),cc=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(cc||{});const vLe={createCanvas:(r,e)=>{const n=document.createElement("canvas");return n.width=r,n.height=e,n},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,e)=>fetch(r,e),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")},kt={ADAPTER:vLe,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var AA=/iPhone/i,sz=/iPod/i,oz=/iPad/i,az=/\biOS-universal(?:.+)Mac\b/i,kA=/\bAndroid(?:.+)Mobile\b/i,lz=/Android/i,Em=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,H_=/Silk/i,Wc=/Windows Phone/i,cz=/\bWindows(?:.+)ARM\b/i,hz=/BlackBerry/i,uz=/BB10/i,dz=/Opera Mini/i,fz=/\b(CriOS|Chrome)(?:.+)Mobile/i,pz=/Mobile(?:.+)Firefox\b/i,mz=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function yLe(r){return function(e){return e.test(r)}}function gz(r){var e={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?e.userAgent=r:r&&r.userAgent&&(e={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var n=e.userAgent,i=n.split("[FBAN");typeof i[1]<"u"&&(n=i[0]),i=n.split("Twitter"),typeof i[1]<"u"&&(n=i[0]);var s=yLe(n),o={apple:{phone:s(AA)&&!s(Wc),ipod:s(sz),tablet:!s(AA)&&(s(oz)||mz(e))&&!s(Wc),universal:s(az),device:(s(AA)||s(sz)||s(oz)||s(az)||mz(e))&&!s(Wc)},amazon:{phone:s(Em),tablet:!s(Em)&&s(H_),device:s(Em)||s(H_)},android:{phone:!s(Wc)&&s(Em)||!s(Wc)&&s(kA),tablet:!s(Wc)&&!s(Em)&&!s(kA)&&(s(H_)||s(lz)),device:!s(Wc)&&(s(Em)||s(H_)||s(kA)||s(lz))||s(/\bokhttp\b/i)},windows:{phone:s(Wc),tablet:s(cz),device:s(Wc)||s(cz)},other:{blackberry:s(hz),blackberry10:s(uz),opera:s(dz),firefox:s(pz),chrome:s(fz),device:s(hz)||s(uz)||s(dz)||s(pz)||s(fz)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const bLe=gz.default??gz,ah=bLe(globalThis.navigator);kt.RETINA_PREFIX=/@([0-9\.]+)x/;kt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var bZ={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function s(h,u,f){this.fn=h,this.context=u,this.once=f||!1}function o(h,u,f,p,m){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new s(f,p||h,m),y=n?n+u:u;return h._events[y]?h._events[y].fn?h._events[y]=[h._events[y],v]:h._events[y].push(v):(h._events[y]=v,h._eventsCount++),h}function a(h,u){--h._eventsCount===0?h._events=new i:delete h._events[u]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],f,p;if(this._eventsCount===0)return u;for(p in f=this._events)e.call(f,p)&&u.push(n?p.slice(1):p);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},l.prototype.listeners=function(u){var f=n?n+u:u,p=this._events[f];if(!p)return[];if(p.fn)return[p.fn];for(var m=0,v=p.length,y=new Array(v);m<v;m++)y[m]=p[m].fn;return y},l.prototype.listenerCount=function(u){var f=n?n+u:u,p=this._events[f];return p?p.fn?1:p.length:0},l.prototype.emit=function(u,f,p,m,v,y){var x=n?n+u:u;if(!this._events[x])return!1;var w=this._events[x],S=arguments.length,O,_;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),S){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,f),!0;case 3:return w.fn.call(w.context,f,p),!0;case 4:return w.fn.call(w.context,f,p,m),!0;case 5:return w.fn.call(w.context,f,p,m,v),!0;case 6:return w.fn.call(w.context,f,p,m,v,y),!0}for(_=1,O=new Array(S-1);_<S;_++)O[_-1]=arguments[_];w.fn.apply(w.context,O)}else{var T=w.length,A;for(_=0;_<T;_++)switch(w[_].once&&this.removeListener(u,w[_].fn,void 0,!0),S){case 1:w[_].fn.call(w[_].context);break;case 2:w[_].fn.call(w[_].context,f);break;case 3:w[_].fn.call(w[_].context,f,p);break;case 4:w[_].fn.call(w[_].context,f,p,m);break;default:if(!O)for(A=1,O=new Array(S-1);A<S;A++)O[A-1]=arguments[A];w[_].fn.apply(w[_].context,O)}}return!0},l.prototype.on=function(u,f,p){return o(this,u,f,p,!1)},l.prototype.once=function(u,f,p){return o(this,u,f,p,!0)},l.prototype.removeListener=function(u,f,p,m){var v=n?n+u:u;if(!this._events[v])return this;if(!f)return a(this,v),this;var y=this._events[v];if(y.fn)y.fn===f&&(!m||y.once)&&(!p||y.context===p)&&a(this,v);else{for(var x=0,w=[],S=y.length;x<S;x++)(y[x].fn!==f||m&&!y[x].once||p&&y[x].context!==p)&&w.push(y[x]);w.length?this._events[v]=w.length===1?w[0]:w:a(this,v)}return this},l.prototype.removeAllListeners=function(u){var f;return u?(f=n?n+u:u,this._events[f]&&a(this,f)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,r.exports=l})(bZ);var xLe=bZ.exports;const rx=jb(xLe);var F5={exports:{}};F5.exports=Z2;F5.exports.default=Z2;function Z2(r,e,n){n=n||2;var i=e&&e.length,s=i?e[0]*n:r.length,o=xZ(r,0,s,n,!0),a=[];if(!o||o.next===o.prev)return a;var l,h,u,f,p,m,v;if(i&&(o=CLe(r,e,o,n)),r.length>80*n){l=u=r[0],h=f=r[1];for(var y=n;y<s;y+=n)p=r[y],m=r[y+1],p<l&&(l=p),m<h&&(h=m),p>u&&(u=p),m>f&&(f=m);v=Math.max(u-l,f-h),v=v!==0?32767/v:0}return fb(o,a,n,l,h,v,0),a}function xZ(r,e,n,i,s){var o,a;if(s===tR(r,e,n,i)>0)for(o=e;o<n;o+=i)a=vz(o,r[o],r[o+1],a);else for(o=n-i;o>=e;o-=i)a=vz(o,r[o],r[o+1],a);return a&&K2(a,a.next)&&(mb(a),a=a.next),a}function pp(r,e){if(!r)return r;e||(e=r);var n=r,i;do if(i=!1,!n.steiner&&(K2(n,n.next)||rr(n.prev,n,n.next)===0)){if(mb(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function fb(r,e,n,i,s,o,a){if(r){!a&&o&&kLe(r,i,s,o);for(var l=r,h,u;r.prev!==r.next;){if(h=r.prev,u=r.next,o?_Le(r,i,s,o):wLe(r)){e.push(h.i/n|0),e.push(r.i/n|0),e.push(u.i/n|0),mb(r),r=u.next,l=u.next;continue}if(r=u,r===l){a?a===1?(r=OLe(pp(r),e,n),fb(r,e,n,i,s,o,2)):a===2&&SLe(r,e,n,i,s,o):fb(pp(r),e,n,i,s,o,1);break}}}}function wLe(r){var e=r.prev,n=r,i=r.next;if(rr(e,n,i)>=0)return!1;for(var s=e.x,o=n.x,a=i.x,l=e.y,h=n.y,u=i.y,f=s<o?s<a?s:a:o<a?o:a,p=l<h?l<u?l:u:h<u?h:u,m=s>o?s>a?s:a:o>a?o:a,v=l>h?l>u?l:u:h>u?h:u,y=i.next;y!==e;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=v&&Jm(s,l,o,h,a,u,y.x,y.y)&&rr(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function _Le(r,e,n,i){var s=r.prev,o=r,a=r.next;if(rr(s,o,a)>=0)return!1;for(var l=s.x,h=o.x,u=a.x,f=s.y,p=o.y,m=a.y,v=l<h?l<u?l:u:h<u?h:u,y=f<p?f<m?f:m:p<m?p:m,x=l>h?l>u?l:u:h>u?h:u,w=f>p?f>m?f:m:p>m?p:m,S=J3(v,y,e,n,i),O=J3(x,w,e,n,i),_=r.prevZ,T=r.nextZ;_&&_.z>=S&&T&&T.z<=O;){if(_.x>=v&&_.x<=x&&_.y>=y&&_.y<=w&&_!==s&&_!==a&&Jm(l,f,h,p,u,m,_.x,_.y)&&rr(_.prev,_,_.next)>=0||(_=_.prevZ,T.x>=v&&T.x<=x&&T.y>=y&&T.y<=w&&T!==s&&T!==a&&Jm(l,f,h,p,u,m,T.x,T.y)&&rr(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;_&&_.z>=S;){if(_.x>=v&&_.x<=x&&_.y>=y&&_.y<=w&&_!==s&&_!==a&&Jm(l,f,h,p,u,m,_.x,_.y)&&rr(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;T&&T.z<=O;){if(T.x>=v&&T.x<=x&&T.y>=y&&T.y<=w&&T!==s&&T!==a&&Jm(l,f,h,p,u,m,T.x,T.y)&&rr(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function OLe(r,e,n){var i=r;do{var s=i.prev,o=i.next.next;!K2(s,o)&&wZ(s,i,i.next,o)&&pb(s,o)&&pb(o,s)&&(e.push(s.i/n|0),e.push(i.i/n|0),e.push(o.i/n|0),mb(i),mb(i.next),i=r=o),i=i.next}while(i!==r);return pp(i)}function SLe(r,e,n,i,s,o){var a=r;do{for(var l=a.next.next;l!==a.prev;){if(a.i!==l.i&&ILe(a,l)){var h=_Z(a,l);a=pp(a,a.next),h=pp(h,h.next),fb(a,e,n,i,s,o,0),fb(h,e,n,i,s,o,0);return}l=l.next}a=a.next}while(a!==r)}function CLe(r,e,n,i){var s=[],o,a,l,h,u;for(o=0,a=e.length;o<a;o++)l=e[o]*i,h=o<a-1?e[o+1]*i:r.length,u=xZ(r,l,h,i,!1),u===u.next&&(u.steiner=!0),s.push(RLe(u));for(s.sort(TLe),o=0;o<s.length;o++)n=ELe(s[o],n);return n}function TLe(r,e){return r.x-e.x}function ELe(r,e){var n=MLe(r,e);if(!n)return e;var i=_Z(n,r);return pp(i,i.next),pp(n,n.next)}function MLe(r,e){var n=e,i=r.x,s=r.y,o=-1/0,a;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var l=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=i&&l>o&&(o=l,a=n.x<n.next.x?n:n.next,l===i))return a}n=n.next}while(n!==e);if(!a)return null;var h=a,u=a.x,f=a.y,p=1/0,m;n=a;do i>=n.x&&n.x>=u&&i!==n.x&&Jm(s<f?i:o,s,u,f,s<f?o:i,s,n.x,n.y)&&(m=Math.abs(s-n.y)/(i-n.x),pb(n,r)&&(m<p||m===p&&(n.x>a.x||n.x===a.x&&ALe(a,n)))&&(a=n,p=m)),n=n.next;while(n!==h);return a}function ALe(r,e){return rr(r.prev,r,e.prev)<0&&rr(e.next,r,r.next)<0}function kLe(r,e,n,i){var s=r;do s.z===0&&(s.z=J3(s.x,s.y,e,n,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,PLe(s)}function PLe(r){var e,n,i,s,o,a,l,h,u=1;do{for(n=r,r=null,o=null,a=0;n;){for(a++,i=n,l=0,e=0;e<u&&(l++,i=i.nextZ,!!i);e++);for(h=u;l>0||h>0&&i;)l!==0&&(h===0||!i||n.z<=i.z)?(s=n,n=n.nextZ,l--):(s=i,i=i.nextZ,h--),o?o.nextZ=s:r=s,s.prevZ=o,o=s;n=i}o.nextZ=null,u*=2}while(a>1);return r}function J3(r,e,n,i,s){return r=(r-n)*s|0,e=(e-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function RLe(r){var e=r,n=r;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==r);return n}function Jm(r,e,n,i,s,o,a,l){return(s-a)*(e-l)>=(r-a)*(o-l)&&(r-a)*(i-l)>=(n-a)*(e-l)&&(n-a)*(o-l)>=(s-a)*(i-l)}function ILe(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!NLe(r,e)&&(pb(r,e)&&pb(e,r)&&DLe(r,e)&&(rr(r.prev,r,e.prev)||rr(r,e.prev,e))||K2(r,e)&&rr(r.prev,r,r.next)>0&&rr(e.prev,e,e.next)>0)}function rr(r,e,n){return(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y)}function K2(r,e){return r.x===e.x&&r.y===e.y}function wZ(r,e,n,i){var s=j_(rr(r,e,n)),o=j_(rr(r,e,i)),a=j_(rr(n,i,r)),l=j_(rr(n,i,e));return!!(s!==o&&a!==l||s===0&&Q_(r,n,e)||o===0&&Q_(r,i,e)||a===0&&Q_(n,r,i)||l===0&&Q_(n,e,i))}function Q_(r,e,n){return e.x<=Math.max(r.x,n.x)&&e.x>=Math.min(r.x,n.x)&&e.y<=Math.max(r.y,n.y)&&e.y>=Math.min(r.y,n.y)}function j_(r){return r>0?1:r<0?-1:0}function NLe(r,e){var n=r;do{if(n.i!==r.i&&n.next.i!==r.i&&n.i!==e.i&&n.next.i!==e.i&&wZ(n,n.next,r,e))return!0;n=n.next}while(n!==r);return!1}function pb(r,e){return rr(r.prev,r,r.next)<0?rr(r,e,r.next)>=0&&rr(r,r.prev,e)>=0:rr(r,e,r.prev)<0||rr(r,r.next,e)<0}function DLe(r,e){var n=r,i=!1,s=(r.x+e.x)/2,o=(r.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&s<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==r);return i}function _Z(r,e){var n=new eR(r.i,r.x,r.y),i=new eR(e.i,e.x,e.y),s=r.next,o=e.prev;return r.next=e,e.prev=r,n.next=s,s.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function vz(r,e,n,i){var s=new eR(r,e,n);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function mb(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function eR(r,e,n){this.i=r,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Z2.deviation=function(r,e,n,i){var s=e&&e.length,o=s?e[0]*n:r.length,a=Math.abs(tR(r,0,o,n));if(s)for(var l=0,h=e.length;l<h;l++){var u=e[l]*n,f=l<h-1?e[l+1]*n:r.length;a-=Math.abs(tR(r,u,f,n))}var p=0;for(l=0;l<i.length;l+=3){var m=i[l]*n,v=i[l+1]*n,y=i[l+2]*n;p+=Math.abs((r[m]-r[y])*(r[v+1]-r[m+1])-(r[m]-r[v])*(r[y+1]-r[m+1]))}return a===0&&p===0?0:Math.abs((p-a)/a)};function tR(r,e,n,i){for(var s=0,o=e,a=n-i;o<n;o+=i)s+=(r[a]-r[o])*(r[o+1]+r[a+1]),a=o;return s}Z2.flatten=function(r){for(var e=r[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,s=0;s<r.length;s++){for(var o=0;o<r[s].length;o++)for(var a=0;a<e;a++)n.vertices.push(r[s][o][a]);s>0&&(i+=r[s-1].length,n.holes.push(i))}return n};var LLe=F5.exports;const BLe=jb(LLe);var uC={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */uC.exports;(function(r,e){(function(n){var i=e&&!e.nodeType&&e,s=r&&!r.nodeType&&r,o=typeof Ia=="object"&&Ia;(o.global===o||o.window===o||o.self===o)&&(n=o);var a,l=2147483647,h=36,u=1,f=26,p=38,m=700,v=72,y=128,x="-",w=/^xn--/,S=/[^\x20-\x7E]/,O=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=h-u,A=Math.floor,P=String.fromCharCode,N;function k(ee){throw new RangeError(_[ee])}function R(ee,ne){for(var ge=ee.length,ye=[];ge--;)ye[ge]=ne(ee[ge]);return ye}function E(ee,ne){var ge=ee.split("@"),ye="";ge.length>1&&(ye=ge[0]+"@",ee=ge[1]),ee=ee.replace(O,".");var ce=ee.split("."),we=R(ce,ne).join(".");return ye+we}function D(ee){for(var ne=[],ge=0,ye=ee.length,ce,we;ge<ye;)ce=ee.charCodeAt(ge++),ce>=55296&&ce<=56319&&ge<ye?(we=ee.charCodeAt(ge++),(we&64512)==56320?ne.push(((ce&1023)<<10)+(we&1023)+65536):(ne.push(ce),ge--)):ne.push(ce);return ne}function $(ee){return R(ee,function(ne){var ge="";return ne>65535&&(ne-=65536,ge+=P(ne>>>10&1023|55296),ne=56320|ne&1023),ge+=P(ne),ge}).join("")}function I(ee){return ee-48<10?ee-22:ee-65<26?ee-65:ee-97<26?ee-97:h}function L(ee,ne){return ee+22+75*(ee<26)-((ne!=0)<<5)}function U(ee,ne,ge){var ye=0;for(ee=ge?A(ee/m):ee>>1,ee+=A(ee/ne);ee>T*f>>1;ye+=h)ee=A(ee/T);return A(ye+(T+1)*ee/(ee+p))}function V(ee){var ne=[],ge=ee.length,ye,ce=0,we=y,be=v,se,ae,Q,z,j,te,W,Z,he;for(se=ee.lastIndexOf(x),se<0&&(se=0),ae=0;ae<se;++ae)ee.charCodeAt(ae)>=128&&k("not-basic"),ne.push(ee.charCodeAt(ae));for(Q=se>0?se+1:0;Q<ge;){for(z=ce,j=1,te=h;Q>=ge&&k("invalid-input"),W=I(ee.charCodeAt(Q++)),(W>=h||W>A((l-ce)/j))&&k("overflow"),ce+=W*j,Z=te<=be?u:te>=be+f?f:te-be,!(W<Z);te+=h)he=h-Z,j>A(l/he)&&k("overflow"),j*=he;ye=ne.length+1,be=U(ce-z,ye,z==0),A(ce/ye)>l-we&&k("overflow"),we+=A(ce/ye),ce%=ye,ne.splice(ce++,0,we)}return $(ne)}function X(ee){var ne,ge,ye,ce,we,be,se,ae,Q,z,j,te=[],W,Z,he,pe;for(ee=D(ee),W=ee.length,ne=y,ge=0,we=v,be=0;be<W;++be)j=ee[be],j<128&&te.push(P(j));for(ye=ce=te.length,ce&&te.push(x);ye<W;){for(se=l,be=0;be<W;++be)j=ee[be],j>=ne&&j<se&&(se=j);for(Z=ye+1,se-ne>A((l-ge)/Z)&&k("overflow"),ge+=(se-ne)*Z,ne=se,be=0;be<W;++be)if(j=ee[be],j<ne&&++ge>l&&k("overflow"),j==ne){for(ae=ge,Q=h;z=Q<=we?u:Q>=we+f?f:Q-we,!(ae<z);Q+=h)pe=ae-z,he=h-z,te.push(P(L(z+pe%he,0))),ae=A(pe/he);te.push(P(L(ae,0))),we=U(ge,Z,ye==ce),ge=0,++ye}++ge,++ne}return te.join("")}function H(ee){return E(ee,function(ne){return w.test(ne)?V(ne.slice(4).toLowerCase()):ne})}function J(ee){return E(ee,function(ne){return S.test(ne)?"xn--"+X(ne):ne})}if(a={version:"1.4.1",ucs2:{decode:D,encode:$},decode:V,encode:X,toASCII:J,toUnicode:H},i&&s)if(r.exports==i)s.exports=a;else for(N in a)a.hasOwnProperty(N)&&(i[N]=a[N]);else n.punycode=a})(Ia)})(uC,uC.exports);var $Le=uC.exports,b0=TypeError;const ULe={},VLe=Object.freeze(Object.defineProperty({__proto__:null,default:ULe},Symbol.toStringTag,{value:"Module"})),FLe=WQ(VLe);var z5=typeof Map=="function"&&Map.prototype,PA=Object.getOwnPropertyDescriptor&&z5?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,dC=z5&&PA&&typeof PA.get=="function"?PA.get:null,yz=z5&&Map.prototype.forEach,X5=typeof Set=="function"&&Set.prototype,RA=Object.getOwnPropertyDescriptor&&X5?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,fC=X5&&RA&&typeof RA.get=="function"?RA.get:null,bz=X5&&Set.prototype.forEach,zLe=typeof WeakMap=="function"&&WeakMap.prototype,m1=zLe?WeakMap.prototype.has:null,XLe=typeof WeakSet=="function"&&WeakSet.prototype,g1=XLe?WeakSet.prototype.has:null,WLe=typeof WeakRef=="function"&&WeakRef.prototype,xz=WLe?WeakRef.prototype.deref:null,GLe=Boolean.prototype.valueOf,HLe=Object.prototype.toString,QLe=Function.prototype.toString,jLe=String.prototype.match,W5=String.prototype.slice,Xu=String.prototype.replace,YLe=String.prototype.toUpperCase,wz=String.prototype.toLowerCase,OZ=RegExp.prototype.test,_z=Array.prototype.concat,Zl=Array.prototype.join,qLe=Array.prototype.slice,Oz=Math.floor,iR=typeof BigInt=="function"?BigInt.prototype.valueOf:null,IA=Object.getOwnPropertySymbols,nR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Ns=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Zg||!0)?Symbol.toStringTag:null,SZ=Object.prototype.propertyIsEnumerable,Sz=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function Cz(r,e){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||OZ.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var i=r<0?-Oz(-r):Oz(r);if(i!==r){var s=String(i),o=W5.call(e,s.length+1);return Xu.call(s,n,"$&_")+"."+Xu.call(Xu.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Xu.call(e,n,"$&_")}var rR=FLe,Tz=rR.custom,Ez=EZ(Tz)?Tz:null,CZ={__proto__:null,double:'"',single:"'"},ZLe={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},J2=function r(e,n,i,s){var o=n||{};if(Kc(o,"quoteStyle")&&!Kc(CZ,o.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Kc(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Kc(o,"customInspect")?o.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Kc(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Kc(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var l=o.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return AZ(e,o);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var h=String(e);return l?Cz(e,h):h}if(typeof e=="bigint"){var u=String(e)+"n";return l?Cz(e,u):u}var f=typeof o.depth>"u"?5:o.depth;if(typeof i>"u"&&(i=0),i>=f&&f>0&&typeof e=="object")return sR(e)?"[Array]":"[Object]";var p=mBe(o,i);if(typeof s>"u")s=[];else if(MZ(s,e)>=0)return"[Circular]";function m(I,L,U){if(L&&(s=qLe.call(s),s.push(L)),U){var V={depth:o.depth};return Kc(o,"quoteStyle")&&(V.quoteStyle=o.quoteStyle),r(I,V,i+1,s)}return r(I,o,i+1,s)}if(typeof e=="function"&&!Mz(e)){var v=oBe(e),y=Y_(e,m);return"[Function"+(v?": "+v:" (anonymous)")+"]"+(y.length>0?" { "+Zl.call(y,", ")+" }":"")}if(EZ(e)){var x=Zg?Xu.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):nR.call(e);return typeof e=="object"&&!Zg?xy(x):x}if(dBe(e)){for(var w="<"+wz.call(String(e.nodeName)),S=e.attributes||[],O=0;O<S.length;O++)w+=" "+S[O].name+"="+TZ(KLe(S[O].value),"double",o);return w+=">",e.childNodes&&e.childNodes.length&&(w+="..."),w+="</"+wz.call(String(e.nodeName))+">",w}if(sR(e)){if(e.length===0)return"[]";var _=Y_(e,m);return p&&!pBe(_)?"["+oR(_,p)+"]":"[ "+Zl.call(_,", ")+" ]"}if(eBe(e)){var T=Y_(e,m);return!("cause"in Error.prototype)&&"cause"in e&&!SZ.call(e,"cause")?"{ ["+String(e)+"] "+Zl.call(_z.call("[cause]: "+m(e.cause),T),", ")+" }":T.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Zl.call(T,", ")+" }"}if(typeof e=="object"&&a){if(Ez&&typeof e[Ez]=="function"&&rR)return rR(e,{depth:f-i});if(a!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(aBe(e)){var A=[];return yz&&yz.call(e,function(I,L){A.push(m(L,e,!0)+" => "+m(I,e))}),Az("Map",dC.call(e),A,p)}if(hBe(e)){var P=[];return bz&&bz.call(e,function(I){P.push(m(I,e))}),Az("Set",fC.call(e),P,p)}if(lBe(e))return NA("WeakMap");if(uBe(e))return NA("WeakSet");if(cBe(e))return NA("WeakRef");if(iBe(e))return xy(m(Number(e)));if(rBe(e))return xy(m(iR.call(e)));if(nBe(e))return xy(GLe.call(e));if(tBe(e))return xy(m(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof Ia<"u"&&e===Ia)return"{ [object globalThis] }";if(!JLe(e)&&!Mz(e)){var N=Y_(e,m),k=Sz?Sz(e)===Object.prototype:e instanceof Object||e.constructor===Object,R=e instanceof Object?"":"null prototype",E=!k&&Ns&&Object(e)===e&&Ns in e?W5.call(Od(e),8,-1):R?"Object":"",D=k||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",$=D+(E||R?"["+Zl.call(_z.call([],E||[],R||[]),": ")+"] ":"");return N.length===0?$+"{}":p?$+"{"+oR(N,p)+"}":$+"{ "+Zl.call(N,", ")+" }"}return String(e)};function TZ(r,e,n){var i=n.quoteStyle||e,s=CZ[i];return s+r+s}function KLe(r){return Xu.call(String(r),/"/g,"&quot;")}function sR(r){return Od(r)==="[object Array]"&&(!Ns||!(typeof r=="object"&&Ns in r))}function JLe(r){return Od(r)==="[object Date]"&&(!Ns||!(typeof r=="object"&&Ns in r))}function Mz(r){return Od(r)==="[object RegExp]"&&(!Ns||!(typeof r=="object"&&Ns in r))}function eBe(r){return Od(r)==="[object Error]"&&(!Ns||!(typeof r=="object"&&Ns in r))}function tBe(r){return Od(r)==="[object String]"&&(!Ns||!(typeof r=="object"&&Ns in r))}function iBe(r){return Od(r)==="[object Number]"&&(!Ns||!(typeof r=="object"&&Ns in r))}function nBe(r){return Od(r)==="[object Boolean]"&&(!Ns||!(typeof r=="object"&&Ns in r))}function EZ(r){if(Zg)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!nR)return!1;try{return nR.call(r),!0}catch{}return!1}function rBe(r){if(!r||typeof r!="object"||!iR)return!1;try{return iR.call(r),!0}catch{}return!1}var sBe=Object.prototype.hasOwnProperty||function(r){return r in this};function Kc(r,e){return sBe.call(r,e)}function Od(r){return HLe.call(r)}function oBe(r){if(r.name)return r.name;var e=jLe.call(QLe.call(r),/^function\s*([\w$]+)/);return e?e[1]:null}function MZ(r,e){if(r.indexOf)return r.indexOf(e);for(var n=0,i=r.length;n<i;n++)if(r[n]===e)return n;return-1}function aBe(r){if(!dC||!r||typeof r!="object")return!1;try{dC.call(r);try{fC.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function lBe(r){if(!m1||!r||typeof r!="object")return!1;try{m1.call(r,m1);try{g1.call(r,g1)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function cBe(r){if(!xz||!r||typeof r!="object")return!1;try{return xz.call(r),!0}catch{}return!1}function hBe(r){if(!fC||!r||typeof r!="object")return!1;try{fC.call(r);try{dC.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function uBe(r){if(!g1||!r||typeof r!="object")return!1;try{g1.call(r,g1);try{m1.call(r,m1)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function dBe(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function AZ(r,e){if(r.length>e.maxStringLength){var n=r.length-e.maxStringLength,i="... "+n+" more character"+(n>1?"s":"");return AZ(W5.call(r,0,e.maxStringLength),e)+i}var s=ZLe[e.quoteStyle||"single"];s.lastIndex=0;var o=Xu.call(Xu.call(r,s,"\\$1"),/[\x00-\x1f]/g,fBe);return TZ(o,"single",e)}function fBe(r){var e=r.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+YLe.call(e.toString(16))}function xy(r){return"Object("+r+")"}function NA(r){return r+" { ? }"}function Az(r,e,n,i){var s=i?oR(n,i):Zl.call(n,", ");return r+" ("+e+") {"+s+"}"}function pBe(r){for(var e=0;e<r.length;e++)if(MZ(r[e],`
`)>=0)return!1;return!0}function mBe(r,e){var n;if(r.indent==="	")n="	";else if(typeof r.indent=="number"&&r.indent>0)n=Zl.call(Array(r.indent+1)," ");else return null;return{base:n,prev:Zl.call(Array(e+1),n)}}function oR(r,e){if(r.length===0)return"";var n=`
`+e.prev+e.base;return n+Zl.call(r,","+n)+`
`+e.prev}function Y_(r,e){var n=sR(r),i=[];if(n){i.length=r.length;for(var s=0;s<r.length;s++)i[s]=Kc(r,s)?e(r[s],r):""}var o=typeof IA=="function"?IA(r):[],a;if(Zg){a={};for(var l=0;l<o.length;l++)a["$"+o[l]]=o[l]}for(var h in r)Kc(r,h)&&(n&&String(Number(h))===h&&h<r.length||Zg&&a["$"+h]instanceof Symbol||(OZ.call(/[^\w$]/,h)?i.push(e(h,r)+": "+e(r[h],r)):i.push(h+": "+e(r[h],r))));if(typeof IA=="function")for(var u=0;u<o.length;u++)SZ.call(r,o[u])&&i.push("["+e(o[u])+"]: "+e(r[o[u]],r));return i}var gBe=J2,vBe=b0,eT=function(r,e,n){for(var i=r,s;(s=i.next)!=null;i=s)if(s.key===e)return i.next=s.next,n||(s.next=r.next,r.next=s),s},yBe=function(r,e){if(r){var n=eT(r,e);return n&&n.value}},bBe=function(r,e,n){var i=eT(r,e);i?i.value=n:r.next={key:e,next:r.next,value:n}},xBe=function(r,e){return r?!!eT(r,e):!1},wBe=function(r,e){if(r)return eT(r,e,!0)},_Be=function(){var e,n={assert:function(i){if(!n.has(i))throw new vBe("Side channel does not contain "+gBe(i))},delete:function(i){var s=e&&e.next,o=wBe(e,i);return o&&s&&s===o&&(e=void 0),!!o},get:function(i){return yBe(e,i)},has:function(i){return xBe(e,i)},set:function(i,s){e||(e={next:void 0}),bBe(e,i,s)}};return n},kZ=Object,OBe=Error,SBe=EvalError,CBe=RangeError,TBe=ReferenceError,EBe=SyntaxError,MBe=URIError,ABe=Math.abs,kBe=Math.floor,PBe=Math.max,RBe=Math.min,IBe=Math.pow,NBe=Math.round,DBe=Number.isNaN||function(e){return e!==e},LBe=DBe,BBe=function(e){return LBe(e)||e===0?e:e<0?-1:1},$Be=Object.getOwnPropertyDescriptor,YO=$Be;if(YO)try{YO([],"length")}catch{YO=null}var PZ=YO,qO=Object.defineProperty||!1;if(qO)try{qO({},"a",{value:1})}catch{qO=!1}var UBe=qO,DA,kz;function VBe(){return kz||(kz=1,DA=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),i=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var s=42;e[n]=s;for(var o in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(e,n);if(l.value!==s||l.enumerable!==!0)return!1}return!0}),DA}var LA,Pz;function FBe(){if(Pz)return LA;Pz=1;var r=typeof Symbol<"u"&&Symbol,e=VBe();return LA=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},LA}var BA,Rz;function RZ(){return Rz||(Rz=1,BA=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),BA}var $A,Iz;function IZ(){if(Iz)return $A;Iz=1;var r=kZ;return $A=r.getPrototypeOf||null,$A}var UA,Nz;function zBe(){if(Nz)return UA;Nz=1;var r="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,n=Math.max,i="[object Function]",s=function(h,u){for(var f=[],p=0;p<h.length;p+=1)f[p]=h[p];for(var m=0;m<u.length;m+=1)f[m+h.length]=u[m];return f},o=function(h,u){for(var f=[],p=u,m=0;p<h.length;p+=1,m+=1)f[m]=h[p];return f},a=function(l,h){for(var u="",f=0;f<l.length;f+=1)u+=l[f],f+1<l.length&&(u+=h);return u};return UA=function(h){var u=this;if(typeof u!="function"||e.apply(u)!==i)throw new TypeError(r+u);for(var f=o(arguments,1),p,m=function(){if(this instanceof p){var S=u.apply(this,s(f,arguments));return Object(S)===S?S:this}return u.apply(h,s(f,arguments))},v=n(0,u.length-f.length),y=[],x=0;x<v;x++)y[x]="$"+x;if(p=Function("binder","return function ("+a(y,",")+"){ return binder.apply(this,arguments); }")(m),u.prototype){var w=function(){};w.prototype=u.prototype,p.prototype=new w,w.prototype=null}return p},UA}var VA,Dz;function tT(){if(Dz)return VA;Dz=1;var r=zBe();return VA=Function.prototype.bind||r,VA}var FA,Lz;function G5(){return Lz||(Lz=1,FA=Function.prototype.call),FA}var zA,Bz;function NZ(){return Bz||(Bz=1,zA=Function.prototype.apply),zA}var XBe=typeof Reflect<"u"&&Reflect&&Reflect.apply,WBe=tT(),GBe=NZ(),HBe=G5(),QBe=XBe,jBe=QBe||WBe.call(HBe,GBe),YBe=tT(),qBe=b0,ZBe=G5(),KBe=jBe,DZ=function(e){if(e.length<1||typeof e[0]!="function")throw new qBe("a function is required");return KBe(YBe,ZBe,e)},XA,$z;function JBe(){if($z)return XA;$z=1;var r=DZ,e=PZ,n;try{n=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var i=!!n&&e&&e(Object.prototype,"__proto__"),s=Object,o=s.getPrototypeOf;return XA=i&&typeof i.get=="function"?r([i.get]):typeof o=="function"?function(l){return o(l==null?l:s(l))}:!1,XA}var WA,Uz;function e6e(){if(Uz)return WA;Uz=1;var r=RZ(),e=IZ(),n=JBe();return WA=r?function(s){return r(s)}:e?function(s){if(!s||typeof s!="object"&&typeof s!="function")throw new TypeError("getProto: not an object");return e(s)}:n?function(s){return n(s)}:null,WA}var GA,Vz;function t6e(){if(Vz)return GA;Vz=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,n=tT();return GA=n.call(r,e),GA}var Zi,i6e=kZ,n6e=OBe,r6e=SBe,s6e=CBe,o6e=TBe,Kg=EBe,Sg=b0,a6e=MBe,l6e=ABe,c6e=kBe,h6e=PBe,u6e=RBe,d6e=IBe,f6e=NBe,p6e=BBe,LZ=Function,HA=function(r){try{return LZ('"use strict"; return ('+r+").constructor;")()}catch{}},gb=PZ,m6e=UBe,QA=function(){throw new Sg},g6e=gb?function(){try{return arguments.callee,QA}catch{try{return gb(arguments,"callee").get}catch{return QA}}}():QA,Mm=FBe()(),Zr=e6e(),v6e=IZ(),y6e=RZ(),BZ=NZ(),sx=G5(),Um={},b6e=typeof Uint8Array>"u"||!Zr?Zi:Zr(Uint8Array),Gf={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Zi:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Zi:ArrayBuffer,"%ArrayIteratorPrototype%":Mm&&Zr?Zr([][Symbol.iterator]()):Zi,"%AsyncFromSyncIteratorPrototype%":Zi,"%AsyncFunction%":Um,"%AsyncGenerator%":Um,"%AsyncGeneratorFunction%":Um,"%AsyncIteratorPrototype%":Um,"%Atomics%":typeof Atomics>"u"?Zi:Atomics,"%BigInt%":typeof BigInt>"u"?Zi:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Zi:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Zi:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Zi:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n6e,"%eval%":eval,"%EvalError%":r6e,"%Float32Array%":typeof Float32Array>"u"?Zi:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Zi:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Zi:FinalizationRegistry,"%Function%":LZ,"%GeneratorFunction%":Um,"%Int8Array%":typeof Int8Array>"u"?Zi:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Zi:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Zi:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Mm&&Zr?Zr(Zr([][Symbol.iterator]())):Zi,"%JSON%":typeof JSON=="object"?JSON:Zi,"%Map%":typeof Map>"u"?Zi:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Mm||!Zr?Zi:Zr(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":i6e,"%Object.getOwnPropertyDescriptor%":gb,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Zi:Promise,"%Proxy%":typeof Proxy>"u"?Zi:Proxy,"%RangeError%":s6e,"%ReferenceError%":o6e,"%Reflect%":typeof Reflect>"u"?Zi:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Zi:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Mm||!Zr?Zi:Zr(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Zi:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Mm&&Zr?Zr(""[Symbol.iterator]()):Zi,"%Symbol%":Mm?Symbol:Zi,"%SyntaxError%":Kg,"%ThrowTypeError%":g6e,"%TypedArray%":b6e,"%TypeError%":Sg,"%Uint8Array%":typeof Uint8Array>"u"?Zi:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Zi:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Zi:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Zi:Uint32Array,"%URIError%":a6e,"%WeakMap%":typeof WeakMap>"u"?Zi:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Zi:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Zi:WeakSet,"%Function.prototype.call%":sx,"%Function.prototype.apply%":BZ,"%Object.defineProperty%":m6e,"%Object.getPrototypeOf%":v6e,"%Math.abs%":l6e,"%Math.floor%":c6e,"%Math.max%":h6e,"%Math.min%":u6e,"%Math.pow%":d6e,"%Math.round%":f6e,"%Math.sign%":p6e,"%Reflect.getPrototypeOf%":y6e};if(Zr)try{null.error}catch(r){var x6e=Zr(Zr(r));Gf["%Error.prototype%"]=x6e}var w6e=function r(e){var n;if(e==="%AsyncFunction%")n=HA("async function () {}");else if(e==="%GeneratorFunction%")n=HA("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=HA("async function* () {}");else if(e==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(n=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=r("%AsyncGenerator%");s&&Zr&&(n=Zr(s.prototype))}return Gf[e]=n,n},Fz={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ox=tT(),pC=t6e(),_6e=ox.call(sx,Array.prototype.concat),O6e=ox.call(BZ,Array.prototype.splice),zz=ox.call(sx,String.prototype.replace),mC=ox.call(sx,String.prototype.slice),S6e=ox.call(sx,RegExp.prototype.exec),C6e=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,T6e=/\\(\\)?/g,E6e=function(e){var n=mC(e,0,1),i=mC(e,-1);if(n==="%"&&i!=="%")throw new Kg("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&n!=="%")throw new Kg("invalid intrinsic syntax, expected opening `%`");var s=[];return zz(e,C6e,function(o,a,l,h){s[s.length]=l?zz(h,T6e,"$1"):a||o}),s},M6e=function(e,n){var i=e,s;if(pC(Fz,i)&&(s=Fz[i],i="%"+s[0]+"%"),pC(Gf,i)){var o=Gf[i];if(o===Um&&(o=w6e(i)),typeof o>"u"&&!n)throw new Sg("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:i,value:o}}throw new Kg("intrinsic "+e+" does not exist!")},H5=function(e,n){if(typeof e!="string"||e.length===0)throw new Sg("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Sg('"allowMissing" argument must be a boolean');if(S6e(/^%?[^%]*%?$/,e)===null)throw new Kg("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=E6e(e),s=i.length>0?i[0]:"",o=M6e("%"+s+"%",n),a=o.name,l=o.value,h=!1,u=o.alias;u&&(s=u[0],O6e(i,_6e([0,1],u)));for(var f=1,p=!0;f<i.length;f+=1){var m=i[f],v=mC(m,0,1),y=mC(m,-1);if((v==='"'||v==="'"||v==="`"||y==='"'||y==="'"||y==="`")&&v!==y)throw new Kg("property names with quotes must have matching quotes");if((m==="constructor"||!p)&&(h=!0),s+="."+m,a="%"+s+"%",pC(Gf,a))l=Gf[a];else if(l!=null){if(!(m in l)){if(!n)throw new Sg("base intrinsic for "+e+" exists, but the property is not available.");return}if(gb&&f+1>=i.length){var x=gb(l,m);p=!!x,p&&"get"in x&&!("originalValue"in x.get)?l=x.get:l=l[m]}else p=pC(l,m),l=l[m];p&&!h&&(Gf[a]=l)}}return l},$Z=H5,UZ=DZ,A6e=UZ([$Z("%String.prototype.indexOf%")]),VZ=function(e,n){var i=$Z(e,!!n);return typeof i=="function"&&A6e(e,".prototype.")>-1?UZ([i]):i},k6e=H5,ax=VZ,P6e=J2,R6e=b0,Xz=k6e("%Map%",!0),I6e=ax("Map.prototype.get",!0),N6e=ax("Map.prototype.set",!0),D6e=ax("Map.prototype.has",!0),L6e=ax("Map.prototype.delete",!0),B6e=ax("Map.prototype.size",!0),FZ=!!Xz&&function(){var e,n={assert:function(i){if(!n.has(i))throw new R6e("Side channel does not contain "+P6e(i))},delete:function(i){if(e){var s=L6e(e,i);return B6e(e)===0&&(e=void 0),s}return!1},get:function(i){if(e)return I6e(e,i)},has:function(i){return e?D6e(e,i):!1},set:function(i,s){e||(e=new Xz),N6e(e,i,s)}};return n},$6e=H5,iT=VZ,U6e=J2,q_=FZ,V6e=b0,Am=$6e("%WeakMap%",!0),F6e=iT("WeakMap.prototype.get",!0),z6e=iT("WeakMap.prototype.set",!0),X6e=iT("WeakMap.prototype.has",!0),W6e=iT("WeakMap.prototype.delete",!0),G6e=Am?function(){var e,n,i={assert:function(s){if(!i.has(s))throw new V6e("Side channel does not contain "+U6e(s))},delete:function(s){if(Am&&s&&(typeof s=="object"||typeof s=="function")){if(e)return W6e(e,s)}else if(q_&&n)return n.delete(s);return!1},get:function(s){return Am&&s&&(typeof s=="object"||typeof s=="function")&&e?F6e(e,s):n&&n.get(s)},has:function(s){return Am&&s&&(typeof s=="object"||typeof s=="function")&&e?X6e(e,s):!!n&&n.has(s)},set:function(s,o){Am&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new Am),z6e(e,s,o)):q_&&(n||(n=q_()),n.set(s,o))}};return i}:q_,H6e=b0,Q6e=J2,j6e=_Be,Y6e=FZ,q6e=G6e,Z6e=q6e||Y6e||j6e,K6e=function(){var e,n={assert:function(i){if(!n.has(i))throw new H6e("Side channel does not contain "+Q6e(i))},delete:function(i){return!!e&&e.delete(i)},get:function(i){return e&&e.get(i)},has:function(i){return!!e&&e.has(i)},set:function(i,s){e||(e=Z6e()),e.set(i,s)}};return n},J6e=String.prototype.replace,e$e=/%20/g,jA={RFC1738:"RFC1738",RFC3986:"RFC3986"},Q5={default:jA.RFC3986,formatters:{RFC1738:function(r){return J6e.call(r,e$e,"+")},RFC3986:function(r){return String(r)}},RFC1738:jA.RFC1738,RFC3986:jA.RFC3986},t$e=Q5,YA=Object.prototype.hasOwnProperty,_f=Array.isArray,Bl=function(){for(var r=[],e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r}(),i$e=function(e){for(;e.length>1;){var n=e.pop(),i=n.obj[n.prop];if(_f(i)){for(var s=[],o=0;o<i.length;++o)typeof i[o]<"u"&&s.push(i[o]);n.obj[n.prop]=s}}},zZ=function(e,n){for(var i=n&&n.plainObjects?{__proto__:null}:{},s=0;s<e.length;++s)typeof e[s]<"u"&&(i[s]=e[s]);return i},n$e=function r(e,n,i){if(!n)return e;if(typeof n!="object"&&typeof n!="function"){if(_f(e))e.push(n);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!YA.call(Object.prototype,n))&&(e[n]=!0);else return[e,n];return e}if(!e||typeof e!="object")return[e].concat(n);var s=e;return _f(e)&&!_f(n)&&(s=zZ(e,i)),_f(e)&&_f(n)?(n.forEach(function(o,a){if(YA.call(e,a)){var l=e[a];l&&typeof l=="object"&&o&&typeof o=="object"?e[a]=r(l,o,i):e.push(o)}else e[a]=o}),e):Object.keys(n).reduce(function(o,a){var l=n[a];return YA.call(o,a)?o[a]=r(o[a],l,i):o[a]=l,o},s)},r$e=function(e,n){return Object.keys(n).reduce(function(i,s){return i[s]=n[s],i},e)},s$e=function(r,e,n){var i=r.replace(/\+/g," ");if(n==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},qA=1024,o$e=function(e,n,i,s,o){if(e.length===0)return e;var a=e;if(typeof e=="symbol"?a=Symbol.prototype.toString.call(e):typeof e!="string"&&(a=String(e)),i==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(v){return"%26%23"+parseInt(v.slice(2),16)+"%3B"});for(var l="",h=0;h<a.length;h+=qA){for(var u=a.length>=qA?a.slice(h,h+qA):a,f=[],p=0;p<u.length;++p){var m=u.charCodeAt(p);if(m===45||m===46||m===95||m===126||m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||o===t$e.RFC1738&&(m===40||m===41)){f[f.length]=u.charAt(p);continue}if(m<128){f[f.length]=Bl[m];continue}if(m<2048){f[f.length]=Bl[192|m>>6]+Bl[128|m&63];continue}if(m<55296||m>=57344){f[f.length]=Bl[224|m>>12]+Bl[128|m>>6&63]+Bl[128|m&63];continue}p+=1,m=65536+((m&1023)<<10|u.charCodeAt(p)&1023),f[f.length]=Bl[240|m>>18]+Bl[128|m>>12&63]+Bl[128|m>>6&63]+Bl[128|m&63]}l+=f.join("")}return l},a$e=function(e){for(var n=[{obj:{o:e},prop:"o"}],i=[],s=0;s<n.length;++s)for(var o=n[s],a=o.obj[o.prop],l=Object.keys(a),h=0;h<l.length;++h){var u=l[h],f=a[u];typeof f=="object"&&f!==null&&i.indexOf(f)===-1&&(n.push({obj:a,prop:u}),i.push(f))}return i$e(n),e},l$e=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},c$e=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},h$e=function(e,n){return[].concat(e,n)},u$e=function(e,n){if(_f(e)){for(var i=[],s=0;s<e.length;s+=1)i.push(n(e[s]));return i}return n(e)},XZ={arrayToObject:zZ,assign:r$e,combine:h$e,compact:a$e,decode:s$e,encode:o$e,isBuffer:c$e,isRegExp:l$e,maybeMap:u$e,merge:n$e},WZ=K6e,ZO=XZ,v1=Q5,d$e=Object.prototype.hasOwnProperty,GZ={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,n){return e+"["+n+"]"},repeat:function(e){return e}},Yl=Array.isArray,f$e=Array.prototype.push,HZ=function(r,e){f$e.apply(r,Yl(e)?e:[e])},p$e=Date.prototype.toISOString,Wz=v1.default,Dr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:ZO.encode,encodeValuesOnly:!1,filter:void 0,format:Wz,formatter:v1.formatters[Wz],indices:!1,serializeDate:function(e){return p$e.call(e)},skipNulls:!1,strictNullHandling:!1},m$e=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},ZA={},g$e=function r(e,n,i,s,o,a,l,h,u,f,p,m,v,y,x,w,S,O){for(var _=e,T=O,A=0,P=!1;(T=T.get(ZA))!==void 0&&!P;){var N=T.get(e);if(A+=1,typeof N<"u"){if(N===A)throw new RangeError("Cyclic object value");P=!0}typeof T.get(ZA)>"u"&&(A=0)}if(typeof f=="function"?_=f(n,_):_ instanceof Date?_=v(_):i==="comma"&&Yl(_)&&(_=ZO.maybeMap(_,function(ee){return ee instanceof Date?v(ee):ee})),_===null){if(a)return u&&!w?u(n,Dr.encoder,S,"key",y):n;_=""}if(m$e(_)||ZO.isBuffer(_)){if(u){var k=w?n:u(n,Dr.encoder,S,"key",y);return[x(k)+"="+x(u(_,Dr.encoder,S,"value",y))]}return[x(n)+"="+x(String(_))]}var R=[];if(typeof _>"u")return R;var E;if(i==="comma"&&Yl(_))w&&u&&(_=ZO.maybeMap(_,u)),E=[{value:_.length>0?_.join(",")||null:void 0}];else if(Yl(f))E=f;else{var D=Object.keys(_);E=p?D.sort(p):D}var $=h?String(n).replace(/\./g,"%2E"):String(n),I=s&&Yl(_)&&_.length===1?$+"[]":$;if(o&&Yl(_)&&_.length===0)return I+"[]";for(var L=0;L<E.length;++L){var U=E[L],V=typeof U=="object"&&U&&typeof U.value<"u"?U.value:_[U];if(!(l&&V===null)){var X=m&&h?String(U).replace(/\./g,"%2E"):String(U),H=Yl(_)?typeof i=="function"?i(I,X):I:I+(m?"."+X:"["+X+"]");O.set(e,A);var J=WZ();J.set(ZA,O),HZ(R,r(V,H,i,s,o,a,l,h,i==="comma"&&w&&Yl(_)?null:u,f,p,m,v,y,x,w,S,J))}}return R},v$e=function(e){if(!e)return Dr;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=e.charset||Dr.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=v1.default;if(typeof e.format<"u"){if(!d$e.call(v1.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var s=v1.formatters[i],o=Dr.filter;(typeof e.filter=="function"||Yl(e.filter))&&(o=e.filter);var a;if(e.arrayFormat in GZ?a=e.arrayFormat:"indices"in e?a=e.indices?"indices":"repeat":a=Dr.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var l=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:Dr.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Dr.addQueryPrefix,allowDots:l,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Dr.allowEmptyArrays,arrayFormat:a,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Dr.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Dr.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Dr.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Dr.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Dr.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Dr.encodeValuesOnly,filter:o,format:i,formatter:s,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Dr.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Dr.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Dr.strictNullHandling}},y$e=function(r,e){var n=r,i=v$e(e),s,o;typeof i.filter=="function"?(o=i.filter,n=o("",n)):Yl(i.filter)&&(o=i.filter,s=o);var a=[];if(typeof n!="object"||n===null)return"";var l=GZ[i.arrayFormat],h=l==="comma"&&i.commaRoundTrip;s||(s=Object.keys(n)),i.sort&&s.sort(i.sort);for(var u=WZ(),f=0;f<s.length;++f){var p=s[f],m=n[p];i.skipNulls&&m===null||HZ(a,g$e(m,p,l,h,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,u))}var v=a.join(i.delimiter),y=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?y+="utf8=%26%2310003%3B&":y+="utf8=%E2%9C%93&"),v.length>0?y+v:""},mp=XZ,aR=Object.prototype.hasOwnProperty,Gz=Array.isArray,cr={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:mp.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},b$e=function(r){return r.replace(/&#(\d+);/g,function(e,n){return String.fromCharCode(parseInt(n,10))})},QZ=function(r,e,n){if(r&&typeof r=="string"&&e.comma&&r.indexOf(",")>-1)return r.split(",");if(e.throwOnLimitExceeded&&n>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return r},x$e="utf8=%26%2310003%3B",w$e="utf8=%E2%9C%93",_$e=function(e,n){var i={__proto__:null},s=n.ignoreQueryPrefix?e.replace(/^\?/,""):e;s=s.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var o=n.parameterLimit===1/0?void 0:n.parameterLimit,a=s.split(n.delimiter,n.throwOnLimitExceeded?o+1:o);if(n.throwOnLimitExceeded&&a.length>o)throw new RangeError("Parameter limit exceeded. Only "+o+" parameter"+(o===1?"":"s")+" allowed.");var l=-1,h,u=n.charset;if(n.charsetSentinel)for(h=0;h<a.length;++h)a[h].indexOf("utf8=")===0&&(a[h]===w$e?u="utf-8":a[h]===x$e&&(u="iso-8859-1"),l=h,h=a.length);for(h=0;h<a.length;++h)if(h!==l){var f=a[h],p=f.indexOf("]="),m=p===-1?f.indexOf("="):p+1,v,y;m===-1?(v=n.decoder(f,cr.decoder,u,"key"),y=n.strictNullHandling?null:""):(v=n.decoder(f.slice(0,m),cr.decoder,u,"key"),y=mp.maybeMap(QZ(f.slice(m+1),n,Gz(i[v])?i[v].length:0),function(w){return n.decoder(w,cr.decoder,u,"value")})),y&&n.interpretNumericEntities&&u==="iso-8859-1"&&(y=b$e(String(y))),f.indexOf("[]=")>-1&&(y=Gz(y)?[y]:y);var x=aR.call(i,v);x&&n.duplicates==="combine"?i[v]=mp.combine(i[v],y):(!x||n.duplicates==="last")&&(i[v]=y)}return i},O$e=function(r,e,n,i){var s=0;if(r.length>0&&r[r.length-1]==="[]"){var o=r.slice(0,-1).join("");s=Array.isArray(e)&&e[o]?e[o].length:0}for(var a=i?e:QZ(e,n,s),l=r.length-1;l>=0;--l){var h,u=r[l];if(u==="[]"&&n.parseArrays)h=n.allowEmptyArrays&&(a===""||n.strictNullHandling&&a===null)?[]:mp.combine([],a);else{h=n.plainObjects?{__proto__:null}:{};var f=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u,p=n.decodeDotInKeys?f.replace(/%2E/g,"."):f,m=parseInt(p,10);!n.parseArrays&&p===""?h={0:a}:!isNaN(m)&&u!==p&&String(m)===p&&m>=0&&n.parseArrays&&m<=n.arrayLimit?(h=[],h[m]=a):p!=="__proto__"&&(h[p]=a)}a=h}return a},S$e=function(e,n,i,s){if(e){var o=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/,l=/(\[[^[\]]*])/g,h=i.depth>0&&a.exec(o),u=h?o.slice(0,h.index):o,f=[];if(u){if(!i.plainObjects&&aR.call(Object.prototype,u)&&!i.allowPrototypes)return;f.push(u)}for(var p=0;i.depth>0&&(h=l.exec(o))!==null&&p<i.depth;){if(p+=1,!i.plainObjects&&aR.call(Object.prototype,h[1].slice(1,-1))&&!i.allowPrototypes)return;f.push(h[1])}if(h){if(i.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+i.depth+" and strictDepth is true");f.push("["+o.slice(h.index)+"]")}return O$e(f,n,i,s)}},C$e=function(e){if(!e)return cr;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var n=typeof e.charset>"u"?cr.charset:e.charset,i=typeof e.duplicates>"u"?cr.duplicates:e.duplicates;if(i!=="combine"&&i!=="first"&&i!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var s=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:cr.allowDots:!!e.allowDots;return{allowDots:s,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:cr.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:cr.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:cr.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:cr.arrayLimit,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:cr.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:cr.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:cr.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:cr.decoder,delimiter:typeof e.delimiter=="string"||mp.isRegExp(e.delimiter)?e.delimiter:cr.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:cr.depth,duplicates:i,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:cr.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:cr.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:cr.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:cr.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:cr.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},T$e=function(r,e){var n=C$e(e);if(r===""||r===null||typeof r>"u")return n.plainObjects?{__proto__:null}:{};for(var i=typeof r=="string"?_$e(r,n):r,s=n.plainObjects?{__proto__:null}:{},o=Object.keys(i),a=0;a<o.length;++a){var l=o[a],h=S$e(l,i[l],n,typeof r=="string");s=mp.merge(s,h,n)}return n.allowSparse===!0?s:mp.compact(s)},E$e=y$e,M$e=T$e,A$e=Q5,k$e={formats:A$e,parse:M$e,stringify:E$e},P$e=$Le;function vh(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var R$e=/^([a-z0-9.+-]+:)/i,I$e=/:[0-9]*$/,N$e=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,D$e=["<",">",'"',"`"," ","\r",`
`,"	"],L$e=["{","}","|","\\","^","`"].concat(D$e),lR=["'"].concat(L$e),Hz=["%","/","?",";","#"].concat(lR),Qz=["/","?","#"],B$e=255,jz=/^[+a-z0-9A-Z_-]{0,63}$/,$$e=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,U$e={javascript:!0,"javascript:":!0},cR={javascript:!0,"javascript:":!0},Cg={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},hR=k$e;function V$e(r,e,n){if(r&&typeof r=="object"&&r instanceof vh)return r;var i=new vh;return i.parse(r,e,n),i}vh.prototype.parse=function(r,e,n){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var i=r.indexOf("?"),s=i!==-1&&i<r.indexOf("#")?"?":"#",o=r.split(s),a=/\\/g;o[0]=o[0].replace(a,"/"),r=o.join(s);var l=r;if(l=l.trim(),!n&&r.split("#").length===1){var h=N$e.exec(l);if(h)return this.path=l,this.href=l,this.pathname=h[1],h[2]?(this.search=h[2],e?this.query=hR.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=R$e.exec(l);if(u){u=u[0];var f=u.toLowerCase();this.protocol=f,l=l.substr(u.length)}if(n||u||l.match(/^\/\/[^@/]+@[^@/]+/)){var p=l.substr(0,2)==="//";p&&!(u&&cR[u])&&(l=l.substr(2),this.slashes=!0)}if(!cR[u]&&(p||u&&!Cg[u])){for(var m=-1,v=0;v<Qz.length;v++){var y=l.indexOf(Qz[v]);y!==-1&&(m===-1||y<m)&&(m=y)}var x,w;m===-1?w=l.lastIndexOf("@"):w=l.lastIndexOf("@",m),w!==-1&&(x=l.slice(0,w),l=l.slice(w+1),this.auth=decodeURIComponent(x)),m=-1;for(var v=0;v<Hz.length;v++){var y=l.indexOf(Hz[v]);y!==-1&&(m===-1||y<m)&&(m=y)}m===-1&&(m=l.length),this.host=l.slice(0,m),l=l.slice(m),this.parseHost(),this.hostname=this.hostname||"";var S=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!S)for(var O=this.hostname.split(/\./),v=0,_=O.length;v<_;v++){var T=O[v];if(T&&!T.match(jz)){for(var A="",P=0,N=T.length;P<N;P++)T.charCodeAt(P)>127?A+="x":A+=T[P];if(!A.match(jz)){var k=O.slice(0,v),R=O.slice(v+1),E=T.match($$e);E&&(k.push(E[1]),R.unshift(E[2])),R.length&&(l="/"+R.join(".")+l),this.hostname=k.join(".");break}}}this.hostname.length>B$e?this.hostname="":this.hostname=this.hostname.toLowerCase(),S||(this.hostname=P$e.toASCII(this.hostname));var D=this.port?":"+this.port:"",$=this.hostname||"";this.host=$+D,this.href+=this.host,S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!U$e[f])for(var v=0,_=lR.length;v<_;v++){var I=lR[v];if(l.indexOf(I)!==-1){var L=encodeURIComponent(I);L===I&&(L=escape(I)),l=l.split(I).join(L)}}var U=l.indexOf("#");U!==-1&&(this.hash=l.substr(U),l=l.slice(0,U));var V=l.indexOf("?");if(V!==-1?(this.search=l.substr(V),this.query=l.substr(V+1),e&&(this.query=hR.parse(this.query)),l=l.slice(0,V)):e&&(this.search="",this.query={}),l&&(this.pathname=l),Cg[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var D=this.pathname||"",X=this.search||"";this.path=D+X}return this.href=this.format(),this};vh.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var e=this.protocol||"",n=this.pathname||"",i=this.hash||"",s=!1,o="";this.host?s=r+this.host:this.hostname&&(s=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(o=hR.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||o&&"?"+o||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Cg[e])&&s!==!1?(s="//"+(s||""),n&&n.charAt(0)!=="/"&&(n="/"+n)):s||(s=""),i&&i.charAt(0)!=="#"&&(i="#"+i),a&&a.charAt(0)!=="?"&&(a="?"+a),n=n.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),a=a.replace("#","%23"),e+s+n+a+i};vh.prototype.resolve=function(r){return this.resolveObject(V$e(r,!1,!0)).format()};vh.prototype.resolveObject=function(r){if(typeof r=="string"){var e=new vh;e.parse(r,!1,!0),r=e}for(var n=new vh,i=Object.keys(this),s=0;s<i.length;s++){var o=i[s];n[o]=this[o]}if(n.hash=r.hash,r.href==="")return n.href=n.format(),n;if(r.slashes&&!r.protocol){for(var a=Object.keys(r),l=0;l<a.length;l++){var h=a[l];h!=="protocol"&&(n[h]=r[h])}return Cg[n.protocol]&&n.hostname&&!n.pathname&&(n.pathname="/",n.path=n.pathname),n.href=n.format(),n}if(r.protocol&&r.protocol!==n.protocol){if(!Cg[r.protocol]){for(var u=Object.keys(r),f=0;f<u.length;f++){var p=u[f];n[p]=r[p]}return n.href=n.format(),n}if(n.protocol=r.protocol,!r.host&&!cR[r.protocol]){for(var _=(r.pathname||"").split("/");_.length&&!(r.host=_.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),n.pathname=_.join("/")}else n.pathname=r.pathname;if(n.search=r.search,n.query=r.query,n.host=r.host||"",n.auth=r.auth,n.hostname=r.hostname||r.host,n.port=r.port,n.pathname||n.search){var m=n.pathname||"",v=n.search||"";n.path=m+v}return n.slashes=n.slashes||r.slashes,n.href=n.format(),n}var y=n.pathname&&n.pathname.charAt(0)==="/",x=r.host||r.pathname&&r.pathname.charAt(0)==="/",w=x||y||n.host&&r.pathname,S=w,O=n.pathname&&n.pathname.split("/")||[],_=r.pathname&&r.pathname.split("/")||[],T=n.protocol&&!Cg[n.protocol];if(T&&(n.hostname="",n.port=null,n.host&&(O[0]===""?O[0]=n.host:O.unshift(n.host)),n.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(_[0]===""?_[0]=r.host:_.unshift(r.host)),r.host=null),w=w&&(_[0]===""||O[0]==="")),x)n.host=r.host||r.host===""?r.host:n.host,n.hostname=r.hostname||r.hostname===""?r.hostname:n.hostname,n.search=r.search,n.query=r.query,O=_;else if(_.length)O||(O=[]),O.pop(),O=O.concat(_),n.search=r.search,n.query=r.query;else if(r.search!=null){if(T){n.host=O.shift(),n.hostname=n.host;var A=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;A&&(n.auth=A.shift(),n.hostname=A.shift(),n.host=n.hostname)}return n.search=r.search,n.query=r.query,(n.pathname!==null||n.search!==null)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!O.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var P=O.slice(-1)[0],N=(n.host||r.host||O.length>1)&&(P==="."||P==="..")||P==="",k=0,R=O.length;R>=0;R--)P=O[R],P==="."?O.splice(R,1):P===".."?(O.splice(R,1),k++):k&&(O.splice(R,1),k--);if(!w&&!S)for(;k--;k)O.unshift("..");w&&O[0]!==""&&(!O[0]||O[0].charAt(0)!=="/")&&O.unshift(""),N&&O.join("/").substr(-1)!=="/"&&O.push("");var E=O[0]===""||O[0]&&O[0].charAt(0)==="/";if(T){n.hostname=E?"":O.length?O.shift():"",n.host=n.hostname;var A=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;A&&(n.auth=A.shift(),n.hostname=A.shift(),n.host=n.hostname)}return w=w||n.host&&O.length,w&&!E&&O.unshift(""),O.length>0?n.pathname=O.join("/"):(n.pathname=null,n.path=null),(n.pathname!==null||n.search!==null)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=r.auth||n.auth,n.slashes=n.slashes||r.slashes,n.href=n.format(),n};vh.prototype.parseHost=function(){var r=this.host,e=I$e.exec(r);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),r=r.substr(0,r.length-e.length)),r&&(this.hostname=r)};const Yz={};function Xi(r,e,n=3){if(Yz[e])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`):(i=i.split(`
`).splice(n).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${r}`),console.warn(i))),Yz[e]=!0}function nl(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function wy(r){return r.split("?")[0].split("#")[0]}function F$e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function z$e(r,e,n){return r.replace(new RegExp(F$e(e),"g"),n)}function X$e(r,e){let n="",i=0,s=-1,o=0,a=-1;for(let l=0;l<=r.length;++l){if(l<r.length)a=r.charCodeAt(l);else{if(a===47)break;a=47}if(a===47){if(!(s===l-1||o===1))if(s!==l-1&&o===2){if(n.length<2||i!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){const h=n.lastIndexOf("/");if(h!==n.length-1){h===-1?(n="",i=0):(n=n.slice(0,h),i=n.length-1-n.lastIndexOf("/")),s=l,o=0;continue}}else if(n.length===2||n.length===1){n="",i=0,s=l,o=0;continue}}}else n.length>0?n+=`/${r.slice(s+1,l)}`:n=r.slice(s+1,l),i=l-s-1;s=l,o=0}else a===46&&o!==-1?++o:o=-1}return n}const is={toPosix(r){return z$e(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){nl(r),r=this.toPosix(r);const e=/^file:\/\/\//.exec(r);if(e)return e[0];const n=/^[^/:]+:\/{0,2}/.exec(r);return n?n[0]:""},toAbsolute(r,e,n){if(nl(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const i=wy(this.toPosix(e??kt.ADAPTER.getBaseUrl())),s=wy(this.toPosix(n??this.rootname(i)));return r=this.toPosix(r),r.startsWith("/")?is.join(s,r.slice(1)):this.isAbsolute(r)?r:this.join(i,r)},normalize(r){if(nl(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let e="";const n=r.startsWith("/");this.hasProtocol(r)&&(e=this.rootname(r),r=r.slice(e.length));const i=r.endsWith("/");return r=X$e(r),r.length>0&&i&&(r+="/"),n?`/${r}`:e+r},isAbsolute(r){return nl(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let e;for(let n=0;n<r.length;++n){const i=r[n];if(nl(i),i.length>0)if(e===void 0)e=i;else{const s=r[n-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?e+=`/../${i}`:e+=`/${i}`}}return e===void 0?".":this.normalize(e)},dirname(r){if(nl(r),r.length===0)return".";r=this.toPosix(r);let e=r.charCodeAt(0);const n=e===47;let i=-1,s=!0;const o=this.getProtocol(r),a=r;r=r.slice(o.length);for(let l=r.length-1;l>=1;--l)if(e=r.charCodeAt(l),e===47){if(!s){i=l;break}}else s=!1;return i===-1?n?"/":this.isUrl(a)?o+r:o:n&&i===1?"//":o+r.slice(0,i)},rootname(r){nl(r),r=this.toPosix(r);let e="";if(r.startsWith("/")?e="/":e=this.getProtocol(r),this.isUrl(r)){const n=r.indexOf("/",e.length);n!==-1?e=r.slice(0,n):e=r,e.endsWith("/")||(e+="/")}return e},basename(r,e){nl(r),e&&nl(e),r=wy(this.toPosix(r));let n=0,i=-1,s=!0,o;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e.length===r.length&&e===r)return"";let a=e.length-1,l=-1;for(o=r.length-1;o>=0;--o){const h=r.charCodeAt(o);if(h===47){if(!s){n=o+1;break}}else l===-1&&(s=!1,l=o+1),a>=0&&(h===e.charCodeAt(a)?--a===-1&&(i=o):(a=-1,i=l))}return n===i?i=l:i===-1&&(i=r.length),r.slice(n,i)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===47){if(!s){n=o+1;break}}else i===-1&&(s=!1,i=o+1);return i===-1?"":r.slice(n,i)},extname(r){nl(r),r=wy(this.toPosix(r));let e=-1,n=0,i=-1,s=!0,o=0;for(let a=r.length-1;a>=0;--a){const l=r.charCodeAt(a);if(l===47){if(!s){n=a+1;break}continue}i===-1&&(s=!1,i=a+1),l===46?e===-1?e=a:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||i===-1||o===0||o===1&&e===i-1&&e===n+1?"":r.slice(e,i)},parse(r){nl(r);const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;r=wy(this.toPosix(r));let n=r.charCodeAt(0);const i=this.isAbsolute(r);let s;e.root=this.rootname(r),i||this.hasProtocol(r)?s=1:s=0;let o=-1,a=0,l=-1,h=!0,u=r.length-1,f=0;for(;u>=s;--u){if(n=r.charCodeAt(u),n===47){if(!h){a=u+1;break}continue}l===-1&&(h=!1,l=u+1),n===46?o===-1?o=u:f!==1&&(f=1):o!==-1&&(f=-1)}return o===-1||l===-1||f===0||f===1&&o===l-1&&o===a+1?l!==-1&&(a===0&&i?e.base=e.name=r.slice(1,l):e.base=e.name=r.slice(a,l)):(a===0&&i?(e.name=r.slice(1,o),e.base=r.slice(1,l)):(e.name=r.slice(a,o),e.base=r.slice(a,l)),e.ext=r.slice(o,l)),e.dir=this.dirname(r),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let KA;async function W$e(){return KA??(KA=(async()=>{var o;const r=document.createElement("canvas").getContext("webgl");if(!r)return To.UNPACK;const e=await new Promise(a=>{const l=document.createElement("video");l.onloadeddata=()=>a(l),l.onerror=()=>a(null),l.autoplay=!1,l.crossOrigin="anonymous",l.preload="auto",l.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",l.load()});if(!e)return To.UNPACK;const n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n);const i=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,i),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e);const s=new Uint8Array(4);return r.readPixels(0,0,1,1,r.RGBA,r.UNSIGNED_BYTE,s),r.deleteFramebuffer(i),r.deleteTexture(n),(o=r.getExtension("WEBGL_lose_context"))==null||o.loseContext(),s[0]<=s[3]?To.PMA:To.UNPACK})()),KA}let JA;function G$e(){return typeof JA>"u"&&(JA=function(){var e;const r={stencil:!0,failIfMajorPerformanceCaveat:kt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!kt.ADAPTER.getWebGLRenderingContext())return!1;const n=kt.ADAPTER.createCanvas();let i=n.getContext("webgl",r)||n.getContext("experimental-webgl",r);const s=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const o=i.getExtension("WEBGL_lose_context");o&&o.loseContext()}return i=null,s}catch{return!1}}()),JA}var H$e={grad:.9,turn:360,rad:360/(2*Math.PI)},Gc=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},Kr=function(r,e,n){return e===void 0&&(e=0),n===void 0&&(n=Math.pow(10,e)),Math.round(n*r)/n+0},Pa=function(r,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),r>n?n:r>e?r:e},jZ=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},qz=function(r){return{r:Pa(r.r,0,255),g:Pa(r.g,0,255),b:Pa(r.b,0,255),a:Pa(r.a)}},ek=function(r){return{r:Kr(r.r),g:Kr(r.g),b:Kr(r.b),a:Kr(r.a,3)}},Q$e=/^#([0-9a-f]{3,8})$/i,Z_=function(r){var e=r.toString(16);return e.length<2?"0"+e:e},YZ=function(r){var e=r.r,n=r.g,i=r.b,s=r.a,o=Math.max(e,n,i),a=o-Math.min(e,n,i),l=a?o===e?(n-i)/a:o===n?2+(i-e)/a:4+(e-n)/a:0;return{h:60*(l<0?l+6:l),s:o?a/o*100:0,v:o/255*100,a:s}},qZ=function(r){var e=r.h,n=r.s,i=r.v,s=r.a;e=e/360*6,n/=100,i/=100;var o=Math.floor(e),a=i*(1-n),l=i*(1-(e-o)*n),h=i*(1-(1-e+o)*n),u=o%6;return{r:255*[i,l,a,a,h,i][u],g:255*[h,i,i,l,a,a][u],b:255*[a,a,h,i,i,l][u],a:s}},Zz=function(r){return{h:jZ(r.h),s:Pa(r.s,0,100),l:Pa(r.l,0,100),a:Pa(r.a)}},Kz=function(r){return{h:Kr(r.h),s:Kr(r.s),l:Kr(r.l),a:Kr(r.a,3)}},Jz=function(r){return qZ((n=(e=r).s,{h:e.h,s:(n*=((i=e.l)<50?i:100-i)/100)>0?2*n/(i+n)*100:0,v:i+n,a:e.a}));var e,n,i},y1=function(r){return{h:(e=YZ(r)).h,s:(s=(200-(n=e.s))*(i=e.v)/100)>0&&s<200?n*i/100/(s<=100?s:200-s)*100:0,l:s/2,a:e.a};var e,n,i,s},j$e=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Y$e=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,q$e=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Z$e=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uR={string:[[function(r){var e=Q$e.exec(r);return e?(r=e[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?Kr(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?Kr(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var e=q$e.exec(r)||Z$e.exec(r);return e?e[2]!==e[4]||e[4]!==e[6]?null:qz({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(r){var e=j$e.exec(r)||Y$e.exec(r);if(!e)return null;var n,i,s=Zz({h:(n=e[1],i=e[2],i===void 0&&(i="deg"),Number(n)*(H$e[i]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Jz(s)},"hsl"]],object:[[function(r){var e=r.r,n=r.g,i=r.b,s=r.a,o=s===void 0?1:s;return Gc(e)&&Gc(n)&&Gc(i)?qz({r:Number(e),g:Number(n),b:Number(i),a:Number(o)}):null},"rgb"],[function(r){var e=r.h,n=r.s,i=r.l,s=r.a,o=s===void 0?1:s;if(!Gc(e)||!Gc(n)||!Gc(i))return null;var a=Zz({h:Number(e),s:Number(n),l:Number(i),a:Number(o)});return Jz(a)},"hsl"],[function(r){var e=r.h,n=r.s,i=r.v,s=r.a,o=s===void 0?1:s;if(!Gc(e)||!Gc(n)||!Gc(i))return null;var a=function(l){return{h:jZ(l.h),s:Pa(l.s,0,100),v:Pa(l.v,0,100),a:Pa(l.a)}}({h:Number(e),s:Number(n),v:Number(i),a:Number(o)});return qZ(a)},"hsv"]]},e9=function(r,e){for(var n=0;n<e.length;n++){var i=e[n][0](r);if(i)return[i,e[n][1]]}return[null,void 0]},K$e=function(r){return typeof r=="string"?e9(r.trim(),uR.string):typeof r=="object"&&r!==null?e9(r,uR.object):[null,void 0]},tk=function(r,e){var n=y1(r);return{h:n.h,s:Pa(n.s+100*e,0,100),l:n.l,a:n.a}},ik=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},t9=function(r,e){var n=y1(r);return{h:n.h,s:n.s,l:Pa(n.l+100*e,0,100),a:n.a}},dR=function(){function r(e){this.parsed=K$e(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return Kr(ik(this.rgba),2)},r.prototype.isDark=function(){return ik(this.rgba)<.5},r.prototype.isLight=function(){return ik(this.rgba)>=.5},r.prototype.toHex=function(){return e=ek(this.rgba),n=e.r,i=e.g,s=e.b,a=(o=e.a)<1?Z_(Kr(255*o)):"","#"+Z_(n)+Z_(i)+Z_(s)+a;var e,n,i,s,o,a},r.prototype.toRgb=function(){return ek(this.rgba)},r.prototype.toRgbString=function(){return e=ek(this.rgba),n=e.r,i=e.g,s=e.b,(o=e.a)<1?"rgba("+n+", "+i+", "+s+", "+o+")":"rgb("+n+", "+i+", "+s+")";var e,n,i,s,o},r.prototype.toHsl=function(){return Kz(y1(this.rgba))},r.prototype.toHslString=function(){return e=Kz(y1(this.rgba)),n=e.h,i=e.s,s=e.l,(o=e.a)<1?"hsla("+n+", "+i+"%, "+s+"%, "+o+")":"hsl("+n+", "+i+"%, "+s+"%)";var e,n,i,s,o},r.prototype.toHsv=function(){return e=YZ(this.rgba),{h:Kr(e.h),s:Kr(e.s),v:Kr(e.v),a:Kr(e.a,3)};var e},r.prototype.invert=function(){return zl({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},r.prototype.saturate=function(e){return e===void 0&&(e=.1),zl(tk(this.rgba,e))},r.prototype.desaturate=function(e){return e===void 0&&(e=.1),zl(tk(this.rgba,-e))},r.prototype.grayscale=function(){return zl(tk(this.rgba,-1))},r.prototype.lighten=function(e){return e===void 0&&(e=.1),zl(t9(this.rgba,e))},r.prototype.darken=function(e){return e===void 0&&(e=.1),zl(t9(this.rgba,-e))},r.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},r.prototype.alpha=function(e){return typeof e=="number"?zl({r:(n=this.rgba).r,g:n.g,b:n.b,a:e}):Kr(this.rgba.a,3);var n},r.prototype.hue=function(e){var n=y1(this.rgba);return typeof e=="number"?zl({h:e,s:n.s,l:n.l,a:n.a}):Kr(n.h)},r.prototype.isEqual=function(e){return this.toHex()===zl(e).toHex()},r}(),zl=function(r){return r instanceof dR?r:new dR(r)},i9=[],J$e=function(r){r.forEach(function(e){i9.indexOf(e)<0&&(e(dR,uR),i9.push(e))})};function eUe(r,e){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var s in n)i[n[s]]=s;var o={};r.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var l,h,u=i[this.toHex()];if(u)return u;if(a!=null&&a.closest){var f=this.toRgb(),p=1/0,m="black";if(!o.length)for(var v in n)o[v]=new r(n[v]).toRgb();for(var y in n){var x=(l=f,h=o[y],Math.pow(l.r-h.r,2)+Math.pow(l.g-h.g,2)+Math.pow(l.b-h.b,2));x<p&&(p=x,m=y)}return m}},e.string.push([function(a){var l=a.toLowerCase(),h=l==="transparent"?"#0000":n[l];return h?new r(h).toRgb():null},"name"])}J$e([eUe]);const Vm=class KO{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof KO)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,n){const i=typeof e;if(i!==typeof n)return!1;if(i==="number"||i==="string"||e instanceof Number)return e===n;if(Array.isArray(e)&&Array.isArray(n)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(n))return e.length!==n.length?!1:e.every((s,o)=>s===n[o]);if(e!==null&&n!==null){const s=Object.keys(e),o=Object.keys(n);return s.length!==o.length?!1:s.every(a=>e[a]===n[a])}return e===n}toRgba(){const[e,n,i,s]=this._components;return{r:e,g:n,b:i,a:s}}toRgb(){const[e,n,i]=this._components;return{r:e,g:n,b:i}}toRgbaString(){const[e,n,i]=this.toUint8RgbArray();return`rgba(${e},${n},${i},${this.alpha})`}toUint8RgbArray(e){const[n,i,s]=this._components;return e=e??[],e[0]=Math.round(n*255),e[1]=Math.round(i*255),e[2]=Math.round(s*255),e}toRgbArray(e){e=e??[];const[n,i,s]=this._components;return e[0]=n,e[1]=i,e[2]=s,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[n,i,s,o]=KO.temp.setValue(e)._components;return this._components[0]*=n,this._components[1]*=i,this._components[2]*=s,this._components[3]*=o,this.refreshInt(),this._value=null,this}premultiply(e,n=!0){return n&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,n=!0){if(e===1)return(255<<24)+this._int;if(e===0)return n?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,o=this._int&255;return n&&(i=i*e+.5|0,s=s*e+.5|0,o=o*e+.5|0),(e*255<<24)+(i<<16)+(s<<8)+o}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[n,i,s]=this._components;return this._components[0]=Math.round(n*e)/e,this._components[1]=Math.round(i*e)/e,this._components[2]=Math.round(s*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[n,i,s,o]=this._components;return e[0]=n,e[1]=i,e[2]=s,e[3]=o,e}normalize(e){let n,i,s,o;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const a=e;n=(a>>16&255)/255,i=(a>>8&255)/255,s=(a&255)/255,o=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[n,i,s,o=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[n,i,s,o=255]=e,n/=255,i/=255,s/=255,o/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const l=KO.HEX_PATTERN.exec(e);l&&(e=`#${l[2]}`)}const a=zl(e);a.isValid()&&({r:n,g:i,b:s,a:o}=a.rgba,n/=255,i/=255,s/=255)}if(n!==void 0)this._components[0]=n,this._components[1]=i,this._components[2]=s,this._components[3]=o,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,n,i]=this._components;this._int=(e*255<<16)+(n*255<<8)+(i*255|0)}_clamp(e,n=0,i=1){return typeof e=="number"?Math.min(Math.max(e,n),i):(e.forEach((s,o)=>{e[o]=Math.min(Math.max(s,n),i)}),e)}};Vm.shared=new Vm,Vm.temp=new Vm,Vm.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Un=Vm;function tUe(r){return Xi("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Un.shared.setValue(r).toHex()}function iUe(r){return Xi("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Un.shared.setValue(r).toNumber()}function nUe(){const r=[],e=[];for(let i=0;i<32;i++)r[i]=i,e[i]=i;r[di.NORMAL_NPM]=di.NORMAL,r[di.ADD_NPM]=di.ADD,r[di.SCREEN_NPM]=di.SCREEN,e[di.NORMAL]=di.NORMAL_NPM,e[di.ADD]=di.ADD_NPM,e[di.SCREEN]=di.SCREEN_NPM;const n=[];return n.push(e),n.push(r),n}const ZZ=nUe();function KZ(r,e){return ZZ[e?1:0][r]}function rUe(r,e=null){const n=r*6;if(e=e||new Uint16Array(n),e.length!==n)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${n}`);for(let i=0,s=0;i<n;i+=6,s+=4)e[i+0]=s+0,e[i+1]=s+1,e[i+2]=s+2,e[i+3]=s+0,e[i+4]=s+2,e[i+5]=s+3;return e}function JZ(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function gC(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function n9(r){return!(r&r-1)&&!!r}function r9(r){let e=(r>65535?1:0)<<4;r>>>=e;let n=(r>255?1:0)<<3;return r>>>=n,e|=n,n=(r>15?1:0)<<2,r>>>=n,e|=n,n=(r>3?1:0)<<1,r>>>=n,e|=n,e|r>>1}function Tg(r,e,n){const i=r.length;let s;if(e>=i||n===0)return;n=e+n>i?i-e:n;const o=i-n;for(s=e;s<o;++s)r[s]=r[s+n];r.length=o}function Wu(r){return r===0?0:r<0?-1:1}let sUe=0;function gp(){return++sUe}const fR=class{constructor(r,e,n,i){this.left=r,this.top=e,this.right=n,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};fR.EMPTY=new fR(0,0,0,0);let s9=fR;const o9={},Xl=Object.create(null),gu=Object.create(null);class oUe{constructor(e,n,i){this._canvas=kt.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||kt.RESOLUTION,this.resize(e,n)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,n){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(n*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function a9(r,e,n){for(let i=0,s=4*n*e;i<e;++i,s+=4)if(r[s+3]!==0)return!1;return!0}function l9(r,e,n,i,s){const o=4*e;for(let a=i,l=i*o+4*n;a<=s;++a,l+=o)if(r[l+3]!==0)return!1;return!0}function aUe(r){const{width:e,height:n}=r,i=r.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const s=i.getImageData(0,0,e,n).data;let o=0,a=0,l=e-1,h=n-1;for(;a<n&&a9(s,e,a);)++a;if(a===n)return s9.EMPTY;for(;a9(s,e,h);)--h;for(;l9(s,e,o,a,h);)++o;for(;l9(s,e,l,a,h);)--l;return++l,++h,new s9(o,a,l,h)}function lUe(r){const e=aUe(r),{width:n,height:i}=e;let s=null;if(!e.isEmpty()){const o=r.getContext("2d");if(o===null)throw new TypeError("Failed to get canvas 2D context");s=o.getImageData(e.left,e.top,n,i)}return{width:n,height:i,data:s}}function cUe(r,e=globalThis.location){if(r.startsWith("data:"))return"";e=e||globalThis.location;const n=new URL(r,document.baseURI);return n.hostname!==e.hostname||n.port!==e.port||n.protocol!==e.protocol?"anonymous":""}function Mh(r,e=1){var i;const n=(i=kt.RETINA_PREFIX)==null?void 0:i.exec(r);return n?parseFloat(n[1]):e}var wt=(r=>(r.Renderer="renderer",r.Application="application",r.RendererSystem="renderer-webgl-system",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererSystem="renderer-canvas-system",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r))(wt||{});const pR=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},c9=(r,e)=>pR(r).priority??e,Gt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(pR).forEach(e=>{e.type.forEach(n=>{var i,s;return(s=(i=this._removeHandlers)[n])==null?void 0:s.call(i,e)})}),this},add(...r){return r.map(pR).forEach(e=>{e.type.forEach(n=>{var o,a;const i=this._addHandlers,s=this._queue;i[n]?(o=i[n])==null||o.call(i,e):(s[n]=s[n]||[],(a=s[n])==null||a.push(e))})}),this},handle(r,e,n){var a;const i=this._addHandlers,s=this._removeHandlers;if(i[r]||s[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=e,s[r]=n;const o=this._queue;return o[r]&&((a=o[r])==null||a.forEach(l=>e(l)),delete o[r]),this},handleByMap(r,e){return this.handle(r,n=>{n.name&&(e[n.name]=n.ref)},n=>{n.name&&delete e[n.name]})},handleByList(r,e,n=-1){return this.handle(r,i=>{e.includes(i.ref)||(e.push(i.ref),e.sort((s,o)=>c9(o,n)-c9(s,n)))},i=>{const s=e.indexOf(i.ref);s!==-1&&e.splice(s,1)})}};class mR{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const hUe=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function uUe(r){let e="";for(let n=0;n<r;++n)n>0&&(e+=`
else `),n<r-1&&(e+=`if(test == ${n}.0){}`);return e}function dUe(r,e){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const n=e.createShader(e.FRAGMENT_SHADER);for(;;){const i=hUe.replace(/%forloop%/gi,uUe(r));if(e.shaderSource(n,i),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))r=r/2|0;else break}return r}const nk=0,rk=1,sk=2,ok=3,ak=4,lk=5;class Sc{constructor(){this.data=0,this.blendMode=di.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<nk)}set blend(e){!!(this.data&1<<nk)!==e&&(this.data^=1<<nk)}get offsets(){return!!(this.data&1<<rk)}set offsets(e){!!(this.data&1<<rk)!==e&&(this.data^=1<<rk)}get culling(){return!!(this.data&1<<sk)}set culling(e){!!(this.data&1<<sk)!==e&&(this.data^=1<<sk)}get depthTest(){return!!(this.data&1<<ok)}set depthTest(e){!!(this.data&1<<ok)!==e&&(this.data^=1<<ok)}get depthMask(){return!!(this.data&1<<lk)}set depthMask(e){!!(this.data&1<<lk)!==e&&(this.data^=1<<lk)}get clockwiseFrontFace(){return!!(this.data&1<<ak)}set clockwiseFrontFace(e){!!(this.data&1<<ak)!==e&&(this.data^=1<<ak)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==di.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Sc;return e.depthTest=!1,e.blend=!0,e}}Sc.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const gR=[];function eK(r,e){if(!r)return null;let n="";if(typeof r=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);i&&(n=i[1].toLowerCase())}for(let i=gR.length-1;i>=0;--i){const s=gR[i];if(s.test&&s.test(r,n))return new s(r,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class pl{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,n,i,s,o,a,l,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:f}=this;this._aliasCount++;for(let p=0,m=f.length;p<m;p++)f[p][u](e,n,i,s,o,a,l,h);return f===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const n=this.items.indexOf(e);return n!==-1&&(this.ensureNonAliasedItems(),this.items.splice(n,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(pl.prototype,{dispatch:{value:pl.prototype.emit},run:{value:pl.prototype.emit}});class vb{constructor(e=0,n=0){this._width=e,this._height=n,this.destroyed=!1,this.internal=!1,this.onResize=new pl("setRealSize"),this.onUpdate=new pl("update"),this.onError=new pl("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,n){(e!==this._width||n!==this._height)&&(this._width=e,this._height=n,this.onResize.emit(e,n))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,n,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,n){return!1}}class nT extends vb{constructor(e,n){const{width:i,height:s}=n||{};if(!i||!s)throw new Error("BufferResource width or height invalid");super(i,s),this.data=e,this.unpackAlignment=n.unpackAlignment??4}upload(e,n,i){const s=e.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,this.unpackAlignment),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===To.UNPACK);const o=n.realWidth,a=n.realHeight;return i.width===o&&i.height===a?s.texSubImage2D(n.target,0,0,0,o,a,n.format,i.type,this.data):(i.width=o,i.height=a,s.texImage2D(n.target,0,i.internalFormat,o,a,0,n.format,i.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const fUe={scaleMode:oh.NEAREST,alphaMode:To.NPM},vR=class Fm extends rx{constructor(e=null,n=null){super(),n=Object.assign({},Fm.defaultOptions,n);const{alphaMode:i,mipmap:s,anisotropicLevel:o,scaleMode:a,width:l,height:h,wrapMode:u,format:f,type:p,target:m,resolution:v,resourceOptions:y}=n;e&&!(e instanceof vb)&&(e=eK(e,y),e.internal=!0),this.resolution=v||kt.RESOLUTION,this.width=Math.round((l||0)*this.resolution)/this.resolution,this.height=Math.round((h||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=o,this._wrapMode=u,this._scaleMode=a,this.format=f,this.type=p,this.target=m,this.alphaMode=i,this.uid=gp(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=l>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,n){let i;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,i=!0),n!==void 0&&n!==this.mipmap&&(this.mipmap=n,i=!0),i&&this.dirtyStyleId++,this}setSize(e,n,i){return i=i||this.resolution,this.setRealSize(e*i,n*i,i)}setRealSize(e,n,i){return this.resolution=i||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(n)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=n9(this.realWidth)&&n9(this.realHeight)}setResolution(e){const n=this.resolution;return n===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*n)/e,this.height=Math.round(this.height*n)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete gu[this.cacheId],delete Xl[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Fm.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,n,i=kt.STRICT_TEXTURE_CACHE){const s=typeof e=="string";let o=null;if(s)o=e;else{if(!e._pixiId){const l=(n==null?void 0:n.pixiIdPrefix)||"pixiid";e._pixiId=`${l}_${gp()}`}o=e._pixiId}let a=gu[o];if(s&&i&&!a)throw new Error(`The cacheId "${o}" does not exist in BaseTextureCache.`);return a||(a=new Fm(e,n),a.cacheId=o,Fm.addToCache(a,o)),a}static fromBuffer(e,n,i,s){e=e||new Float32Array(n*i*4);const o=new nT(e,{width:n,height:i,...s==null?void 0:s.resourceOptions});let a,l;return e instanceof Float32Array?(a=rt.RGBA,l=Jt.FLOAT):e instanceof Int32Array?(a=rt.RGBA_INTEGER,l=Jt.INT):e instanceof Uint32Array?(a=rt.RGBA_INTEGER,l=Jt.UNSIGNED_INT):e instanceof Int16Array?(a=rt.RGBA_INTEGER,l=Jt.SHORT):e instanceof Uint16Array?(a=rt.RGBA_INTEGER,l=Jt.UNSIGNED_SHORT):e instanceof Int8Array?(a=rt.RGBA,l=Jt.BYTE):(a=rt.RGBA,l=Jt.UNSIGNED_BYTE),o.internal=!0,new Fm(o,Object.assign({},fUe,{type:l,format:a},s))}static addToCache(e,n){n&&(e.textureCacheIds.includes(n)||e.textureCacheIds.push(n),gu[n]&&gu[n]!==e&&console.warn(`BaseTexture added to the cache with an id [${n}] that already had an entry`),gu[n]=e)}static removeFromCache(e){if(typeof e=="string"){const n=gu[e];if(n){const i=n.textureCacheIds.indexOf(e);return i>-1&&n.textureCacheIds.splice(i,1),delete gu[e],n}}else if(e!=null&&e.textureCacheIds){for(let n=0;n<e.textureCacheIds.length;++n)delete gu[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null}};vR.defaultOptions={mipmap:yc.POW2,anisotropicLevel:0,scaleMode:oh.LINEAR,wrapMode:Zu.CLAMP,alphaMode:To.UNPACK,target:Og.TEXTURE_2D,format:rt.RGBA,type:Jt.UNSIGNED_BYTE},vR._globalBatch=0;let Oi=vR;class yR{constructor(){this.texArray=null,this.blend=0,this.type=sc.TRIANGLES,this.start=0,this.size=0,this.data=null}}let pUe=0;class gr{constructor(e,n=!0,i=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=n,this.id=pUe++,this.disposeRunner=new pl("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?cc.ELEMENT_ARRAY_BUFFER:cc.ARRAY_BUFFER}get index(){return this.type===cc.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new gr(e)}}class vC{constructor(e,n=0,i=!1,s=Jt.FLOAT,o,a,l,h=1){this.buffer=e,this.size=n,this.normalized=i,this.type=s,this.stride=o,this.start=a,this.instance=l,this.divisor=h}destroy(){this.buffer=null}static from(e,n,i,s,o){return new vC(e,n,i,s,o)}}const mUe={Float32Array,Uint32Array,Int32Array,Uint8Array};function gUe(r,e){let n=0,i=0;const s={};for(let h=0;h<r.length;h++)i+=e[h],n+=r[h].length;const o=new ArrayBuffer(n*4);let a=null,l=0;for(let h=0;h<r.length;h++){const u=e[h],f=r[h],p=JZ(f);s[p]||(s[p]=new mUe[p](o)),a=s[p];for(let m=0;m<f.length;m++){const v=(m/u|0)*i+l,y=m%u;a[v+y]=f[m]}l+=u}return new Float32Array(o)}const h9={5126:4,5123:2,5121:1};let vUe=0;const yUe={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Ah{constructor(e=[],n={}){this.buffers=e,this.indexBuffer=null,this.attributes=n,this.glVertexArrayObjects={},this.id=vUe++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new pl("disposeGeometry"),this.refCount=0}addAttribute(e,n,i=0,s=!1,o,a,l,h=!1){if(!n)throw new Error("You must pass a buffer when creating an attribute");n instanceof gr||(n instanceof Array&&(n=new Float32Array(n)),n=new gr(n));const u=e.split("|");if(u.length>1){for(let p=0;p<u.length;p++)this.addAttribute(u[p],n,i,s,o);return this}let f=this.buffers.indexOf(n);return f===-1&&(this.buffers.push(n),f=this.buffers.length-1),this.attributes[e]=new vC(f,i,s,o,a,l,h),this.instanced=this.instanced||h,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof gr||(e instanceof Array&&(e=new Uint16Array(e)),e=new gr(e)),e.type=cc.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],n=[],i=new gr;let s;for(s in this.attributes){const o=this.attributes[s],a=this.buffers[o.buffer];e.push(a.data),n.push(o.size*h9[o.type]/4),o.buffer=0}for(i.data=gUe(e,n),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const n=this.attributes[e];return this.buffers[n.buffer].data.length/(n.stride/4||n.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Ah;for(let n=0;n<this.buffers.length;n++)e.buffers[n]=new gr(this.buffers[n].data.slice(0));for(const n in this.attributes){const i=this.attributes[n];e.attributes[n]=new vC(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=cc.ELEMENT_ARRAY_BUFFER),e}static merge(e){const n=new Ah,i=[],s=[],o=[];let a;for(let l=0;l<e.length;l++){a=e[l];for(let h=0;h<a.buffers.length;h++)s[h]=s[h]||0,s[h]+=a.buffers[h].data.length,o[h]=0}for(let l=0;l<a.buffers.length;l++)i[l]=new yUe[JZ(a.buffers[l].data)](s[l]),n.buffers[l]=new gr(i[l]);for(let l=0;l<e.length;l++){a=e[l];for(let h=0;h<a.buffers.length;h++)i[h].set(a.buffers[h].data,o[h]),o[h]+=a.buffers[h].data.length}if(n.attributes=a.attributes,a.indexBuffer){n.indexBuffer=n.buffers[a.buffers.indexOf(a.indexBuffer)],n.indexBuffer.type=cc.ELEMENT_ARRAY_BUFFER;let l=0,h=0,u=0,f=0;for(let p=0;p<a.buffers.length;p++)if(a.buffers[p]!==a.indexBuffer){f=p;break}for(const p in a.attributes){const m=a.attributes[p];(m.buffer|0)===f&&(h+=m.size*h9[m.type]/4)}for(let p=0;p<e.length;p++){const m=e[p].indexBuffer.data;for(let v=0;v<m.length;v++)n.indexBuffer.data[v+u]+=l;l+=e[p].buffers[f].data.length/h,u+=m.length}}return n}}class tK extends Ah{constructor(e=!1){super(),this._buffer=new gr(null,e,!1),this._indexBuffer=new gr(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Jt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Jt.FLOAT).addAttribute("aColor",this._buffer,4,!0,Jt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Jt.FLOAT).addIndex(this._indexBuffer)}}const yC=Math.PI*2,bUe=180/Math.PI,xUe=Math.PI/180;var ms=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(ms||{});class hi{constructor(e=0,n=0){this.x=0,this.y=0,this.x=e,this.y=n}clone(){return new hi(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,n=e){return this.x=e,this.y=n,this}}hi.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const K_=[new hi,new hi,new hi,new hi];class ki{constructor(e=0,n=0,i=0,s=0){this.x=Number(e),this.y=Number(n),this.width=Number(i),this.height=Number(s),this.type=ms.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ki(0,0,0,0)}clone(){return new ki(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,n){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&n>=this.y&&n<this.y+this.height}intersects(e,n){if(!n){const k=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=k)return!1;const R=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>R}const i=this.left,s=this.right,o=this.top,a=this.bottom;if(s<=i||a<=o)return!1;const l=K_[0].set(e.left,e.top),h=K_[1].set(e.left,e.bottom),u=K_[2].set(e.right,e.top),f=K_[3].set(e.right,e.bottom);if(u.x<=l.x||h.y<=l.y)return!1;const p=Math.sign(n.a*n.d-n.b*n.c);if(p===0||(n.apply(l,l),n.apply(h,h),n.apply(u,u),n.apply(f,f),Math.max(l.x,h.x,u.x,f.x)<=i||Math.min(l.x,h.x,u.x,f.x)>=s||Math.max(l.y,h.y,u.y,f.y)<=o||Math.min(l.y,h.y,u.y,f.y)>=a))return!1;const m=p*(h.y-l.y),v=p*(l.x-h.x),y=m*i+v*o,x=m*s+v*o,w=m*i+v*a,S=m*s+v*a;if(Math.max(y,x,w,S)<=m*l.x+v*l.y||Math.min(y,x,w,S)>=m*f.x+v*f.y)return!1;const O=p*(l.y-u.y),_=p*(u.x-l.x),T=O*i+_*o,A=O*s+_*o,P=O*i+_*a,N=O*s+_*a;return!(Math.max(T,A,P,N)<=O*l.x+_*l.y||Math.min(T,A,P,N)>=O*f.x+_*f.y)}pad(e=0,n=e){return this.x-=e,this.y-=n,this.width+=e*2,this.height+=n*2,this}fit(e){const n=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),s=Math.max(this.y,e.y),o=Math.min(this.y+this.height,e.y+e.height);return this.x=n,this.width=Math.max(i-n,0),this.y=s,this.height=Math.max(o-s,0),this}ceil(e=1,n=.001){const i=Math.ceil((this.x+this.width-n)*e)/e,s=Math.ceil((this.y+this.height-n)*e)/e;return this.x=Math.floor((this.x+n)*e)/e,this.y=Math.floor((this.y+n)*e)/e,this.width=i-this.x,this.height=s-this.y,this}enlarge(e){const n=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),s=Math.min(this.y,e.y),o=Math.max(this.y+this.height,e.y+e.height);return this.x=n,this.width=i-n,this.y=s,this.height=o-s,this}}ki.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class lx{constructor(e=0,n=0,i=0){this.x=e,this.y=n,this.radius=i,this.type=ms.CIRC}clone(){return new lx(this.x,this.y,this.radius)}contains(e,n){if(this.radius<=0)return!1;const i=this.radius*this.radius;let s=this.x-e,o=this.y-n;return s*=s,o*=o,s+o<=i}getBounds(){return new ki(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}lx.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class rT{constructor(e=0,n=0,i=0,s=0){this.x=e,this.y=n,this.width=i,this.height=s,this.type=ms.ELIP}clone(){return new rT(this.x,this.y,this.width,this.height)}contains(e,n){if(this.width<=0||this.height<=0)return!1;let i=(e-this.x)/this.width,s=(n-this.y)/this.height;return i*=i,s*=s,i+s<=1}getBounds(){return new ki(this.x-this.width,this.y-this.height,this.width,this.height)}}rT.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Hf{constructor(...e){let n=Array.isArray(e[0])?e[0]:e;if(typeof n[0]!="number"){const i=[];for(let s=0,o=n.length;s<o;s++)i.push(n[s].x,n[s].y);n=i}this.points=n,this.type=ms.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),n=new Hf(e);return n.closeStroke=this.closeStroke,n}contains(e,n){let i=!1;const s=this.points.length/2;for(let o=0,a=s-1;o<s;a=o++){const l=this.points[o*2],h=this.points[o*2+1],u=this.points[a*2],f=this.points[a*2+1];h>n!=f>n&&e<(u-l)*((n-h)/(f-h))+l&&(i=!i)}return i}}Hf.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((r,e)=>`${r}, ${e}`,"")}]`};class sT{constructor(e=0,n=0,i=0,s=0,o=20){this.x=e,this.y=n,this.width=i,this.height=s,this.radius=o,this.type=ms.RREC}clone(){return new sT(this.x,this.y,this.width,this.height,this.radius)}contains(e,n){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&n>=this.y&&n<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(n>=this.y+i&&n<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let s=e-(this.x+i),o=n-(this.y+i);const a=i*i;if(s*s+o*o<=a||(s=e-(this.x+this.width-i),s*s+o*o<=a)||(o=n-(this.y+this.height-i),s*s+o*o<=a)||(s=e-(this.x+i),s*s+o*o<=a))return!0}return!1}}sT.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Fn{constructor(e=1,n=0,i=0,s=1,o=0,a=0){this.array=null,this.a=e,this.b=n,this.c=i,this.d=s,this.tx=o,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,n,i,s,o,a){return this.a=e,this.b=n,this.c=i,this.d=s,this.tx=o,this.ty=a,this}toArray(e,n){this.array||(this.array=new Float32Array(9));const i=n||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,n){n=n||new hi;const i=e.x,s=e.y;return n.x=this.a*i+this.c*s+this.tx,n.y=this.b*i+this.d*s+this.ty,n}applyInverse(e,n){n=n||new hi;const i=1/(this.a*this.d+this.c*-this.b),s=e.x,o=e.y;return n.x=this.d*i*s+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,n.y=this.a*i*o+-this.b*i*s+(-this.ty*this.a+this.tx*this.b)*i,n}translate(e,n){return this.tx+=e,this.ty+=n,this}scale(e,n){return this.a*=e,this.d*=n,this.c*=e,this.b*=n,this.tx*=e,this.ty*=n,this}rotate(e){const n=Math.cos(e),i=Math.sin(e),s=this.a,o=this.c,a=this.tx;return this.a=s*n-this.b*i,this.b=s*i+this.b*n,this.c=o*n-this.d*i,this.d=o*i+this.d*n,this.tx=a*n-this.ty*i,this.ty=a*i+this.ty*n,this}append(e){const n=this.a,i=this.b,s=this.c,o=this.d;return this.a=e.a*n+e.b*s,this.b=e.a*i+e.b*o,this.c=e.c*n+e.d*s,this.d=e.c*i+e.d*o,this.tx=e.tx*n+e.ty*s+this.tx,this.ty=e.tx*i+e.ty*o+this.ty,this}setTransform(e,n,i,s,o,a,l,h,u){return this.a=Math.cos(l+u)*o,this.b=Math.sin(l+u)*o,this.c=-Math.sin(l-h)*a,this.d=Math.cos(l-h)*a,this.tx=e-(i*this.a+s*this.c),this.ty=n-(i*this.b+s*this.d),this}prepend(e){const n=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,s=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=s*e.a+this.d*e.c,this.d=s*e.b+this.d*e.d}return this.tx=n*e.a+this.ty*e.c+e.tx,this.ty=n*e.b+this.ty*e.d+e.ty,this}decompose(e){const n=this.a,i=this.b,s=this.c,o=this.d,a=e.pivot,l=-Math.atan2(-s,o),h=Math.atan2(i,n),u=Math.abs(l+h);return u<1e-5||Math.abs(yC-u)<1e-5?(e.rotation=h,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=l,e.skew.y=h),e.scale.x=Math.sqrt(n*n+i*i),e.scale.y=Math.sqrt(s*s+o*o),e.position.x=this.tx+(a.x*n+a.y*s),e.position.y=this.ty+(a.x*i+a.y*o),e}invert(){const e=this.a,n=this.b,i=this.c,s=this.d,o=this.tx,a=e*s-n*i;return this.a=s/a,this.b=-n/a,this.c=-i/a,this.d=e/a,this.tx=(i*this.ty-s*o)/a,this.ty=-(e*this.ty-n*o)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Fn;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Fn}static get TEMP_MATRIX(){return new Fn}}Fn.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const df=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ff=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],pf=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],mf=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],bR=[],iK=[],J_=Math.sign;function wUe(){for(let r=0;r<16;r++){const e=[];bR.push(e);for(let n=0;n<16;n++){const i=J_(df[r]*df[n]+pf[r]*ff[n]),s=J_(ff[r]*df[n]+mf[r]*ff[n]),o=J_(df[r]*pf[n]+pf[r]*mf[n]),a=J_(ff[r]*pf[n]+mf[r]*mf[n]);for(let l=0;l<16;l++)if(df[l]===i&&ff[l]===s&&pf[l]===o&&mf[l]===a){e.push(l);break}}}for(let r=0;r<16;r++){const e=new Fn;e.set(df[r],ff[r],pf[r],mf[r],0,0),iK.push(e)}}wUe();const tr={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>df[r],uY:r=>ff[r],vX:r=>pf[r],vY:r=>mf[r],inv:r=>r&8?r&15:-r&7,add:(r,e)=>bR[r][e],sub:(r,e)=>bR[r][tr.inv(e)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,e)=>Math.abs(r)*2<=Math.abs(e)?e>=0?tr.S:tr.N:Math.abs(e)*2<=Math.abs(r)?r>0?tr.E:tr.W:e>0?r>0?tr.SE:tr.SW:r>0?tr.NE:tr.NW,matrixAppendRotationInv:(r,e,n=0,i=0)=>{const s=iK[tr.inv(e)];s.tx=n,s.ty=i,r.append(s)}};class lh{constructor(e,n,i=0,s=0){this._x=i,this._y=s,this.cb=e,this.scope=n}clone(e=this.cb,n=this.scope){return new lh(e,n,this._x,this._y)}set(e=0,n=e){return(this._x!==e||this._y!==n)&&(this._x=e,this._y=n,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}lh.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const xR=class{constructor(){this.worldTransform=new Fn,this.localTransform=new Fn,this.position=new lh(this.onChange,this,0,0),this.scale=new lh(this.onChange,this,1,1),this.pivot=new lh(this.onChange,this,0,0),this.skew=new lh(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(r){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==r._worldID){const n=r.worldTransform,i=this.worldTransform;i.a=e.a*n.a+e.b*n.c,i.b=e.a*n.b+e.b*n.d,i.c=e.c*n.a+e.d*n.c,i.d=e.c*n.b+e.d*n.d,i.tx=e.tx*n.a+e.ty*n.c+n.tx,i.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=r._worldID,this._worldID++}}setFromMatrix(r){r.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(r){this._rotation!==r&&(this._rotation=r,this.updateSkew())}};xR.IDENTITY=new xR;let j5=xR;j5.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var _Ue=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,OUe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function u9(r,e,n){const i=r.createShader(e);return r.shaderSource(i,n),r.compileShader(i),i}function ck(r){const e=new Array(r);for(let n=0;n<e.length;n++)e[n]=!1;return e}function nK(r,e){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return ck(2*e);case"bvec3":return ck(3*e);case"bvec4":return ck(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Eg=[{test:r=>r.type==="float"&&r.size===1&&!r.isArray,code:r=>`
            if(uv["${r}"] !== ud["${r}"].value)
            {
                ud["${r}"].value = uv["${r}"]
                gl.uniform1f(ud["${r}"].location, uv["${r}"])
            }
            `},{test:(r,e)=>(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(e==null||e.castToBaseTexture!==void 0),code:r=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${r}"], t);

            if(ud["${r}"].value !== t)
            {
                ud["${r}"].value = t;
                gl.uniform1i(ud["${r}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(r,e)=>r.type==="mat3"&&r.size===1&&!r.isArray&&e.a!==void 0,code:r=>`
            gl.uniformMatrix3fv(ud["${r}"].location, false, uv["${r}"].toArray(true));
            `,codeUbo:r=>`
                var ${r}_matrix = uv.${r}.toArray(true);

                data[offset] = ${r}_matrix[0];
                data[offset+1] = ${r}_matrix[1];
                data[offset+2] = ${r}_matrix[2];
        
                data[offset + 4] = ${r}_matrix[3];
                data[offset + 5] = ${r}_matrix[4];
                data[offset + 6] = ${r}_matrix[5];
        
                data[offset + 8] = ${r}_matrix[6];
                data[offset + 9] = ${r}_matrix[7];
                data[offset + 10] = ${r}_matrix[8];
            `},{test:(r,e)=>r.type==="vec2"&&r.size===1&&!r.isArray&&e.x!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${r}"].location, v.x, v.y);
                }`,codeUbo:r=>`
                v = uv.${r};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:r=>r.type==="vec2"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${r}"].location, v[0], v[1]);
                }
            `},{test:(r,e)=>r.type==="vec4"&&r.size===1&&!r.isArray&&e.width!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${r}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(r,e)=>r.type==="vec4"&&r.size===1&&!r.isArray&&e.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${r}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(r,e)=>r.type==="vec3"&&r.size===1&&!r.isArray&&e.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${r}"].location, v.red, v.green, v.blue)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:r=>r.type==="vec4"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${r}"].location, v[0], v[1], v[2], v[3])
                }`}],SUe={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},CUe={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function TUe(r,e){var i;const n=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const s in r.uniforms){const o=e[s];if(!o){((i=r.uniforms[s])==null?void 0:i.group)===!0&&(r.uniforms[s].ubo?n.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${s}, '${s}');
                    `):n.push(`
                        renderer.shader.syncUniformGroup(uv.${s}, syncData);
                    `));continue}const a=r.uniforms[s];let l=!1;for(let h=0;h<Eg.length;h++)if(Eg[h].test(o,a)){n.push(Eg[h].code(s,a)),l=!0;break}if(!l){const h=(o.size===1&&!o.isArray?SUe:CUe)[o.type].replace("location",`ud["${s}"].location`);n.push(`
            cu = ud["${s}"];
            cv = cu.value;
            v = uv["${s}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",n.join(`
`))}const rK={};let km=rK;function EUe(){if(km===rK||km!=null&&km.isContextLost()){const r=kt.ADAPTER.createCanvas();let e;kt.PREFER_ENV>=Pp.WEBGL2&&(e=r.getContext("webgl2",{})),e||(e=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),km=e}return km}let eO;function MUe(){if(!eO){eO=ka.MEDIUM;const r=EUe();if(r&&r.getShaderPrecisionFormat){const e=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);e&&(eO=e.precision?ka.HIGH:ka.MEDIUM)}}return eO}function d9(r,e){const n=r.getShaderSource(e).split(`
`).map((u,f)=>`${f}: ${u}`),i=r.getShaderInfoLog(e),s=i.split(`
`),o={},a=s.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!o[u]?(o[u]=!0,!0):!1),l=[""];a.forEach(u=>{n[u-1]=`%c${n[u-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=n.join(`
`);l[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function AUe(r,e,n,i){r.getProgramParameter(e,r.LINK_STATUS)||(r.getShaderParameter(n,r.COMPILE_STATUS)||d9(r,n),r.getShaderParameter(i,r.COMPILE_STATUS)||d9(r,i),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(e)))}const kUe={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function sK(r){return kUe[r]}let tO=null;const f9={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function oK(r,e){if(!tO){const n=Object.keys(f9);tO={};for(let i=0;i<n.length;++i){const s=n[i];tO[r[s]]=f9[s]}}return tO[e]}function p9(r,e,n){if(r.substring(0,9)!=="precision"){let i=e;return e===ka.HIGH&&n!==ka.HIGH&&(i=ka.MEDIUM),`precision ${i} float;
${r}`}else if(n!==ka.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}let _y;function PUe(){if(typeof _y=="boolean")return _y;try{_y=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{_y=!1}return _y}let RUe=0;const iO={},wR=class zm{constructor(e,n,i="pixi-shader",s={}){this.extra={},this.id=RUe++,this.vertexSrc=e||zm.defaultVertexSrc,this.fragmentSrc=n||zm.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),iO[i]?(iO[i]++,i+=`-${iO[i]}`):iO[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=p9(this.vertexSrc,zm.defaultVertexPrecision,ka.HIGH),this.fragmentSrc=p9(this.fragmentSrc,zm.defaultFragmentPrecision,MUe())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return OUe}static get defaultFragmentSrc(){return _Ue}static from(e,n,i){const s=e+n;let o=o9[s];return o||(o9[s]=o=new zm(e,n,i)),o}};wR.defaultVertexPrecision=ka.HIGH,wR.defaultFragmentPrecision=ah.apple.device?ka.HIGH:ka.MEDIUM;let ch=wR,IUe=0;class ml{constructor(e,n,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=IUe++,this.static=!!n,this.ubo=!!i,e instanceof gr?(this.buffer=e,this.buffer.type=cc.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new gr(new Float32Array(1)),this.buffer.type=cc.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,n,i){if(!this.ubo)this.uniforms[e]=new ml(n,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,n,i){return new ml(e,n,i)}static uboFrom(e,n){return new ml(e,n??!0,!0)}}class gl{constructor(e,n){this.uniformBindCount=0,this.program=e,n?n instanceof ml?this.uniformGroup=n:this.uniformGroup=new ml(n):this.uniformGroup=new ml({}),this.disposeRunner=new pl("disposeShader")}checkUniformExists(e,n){if(n.uniforms[e])return!0;for(const i in n.uniforms){const s=n.uniforms[i];if(s.group===!0&&this.checkUniformExists(e,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,n,i){const s=ch.from(e,n);return new gl(s,i)}}class NUe{constructor(e,n){if(this.vertexSrc=e,this.fragTemplate=n,this.programCache={},this.defaultGroupCache={},!n.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!n.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const i=new Int32Array(e);for(let o=0;o<e;o++)i[o]=o;this.defaultGroupCache[e]=ml.from({uSamplers:i},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${e}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new ch(this.vertexSrc,s)}const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Fn,default:this.defaultGroupCache[e]};return new gl(this.programCache[e],n)}generateSampleSrc(e){let n="";n+=`
`,n+=`
`;for(let i=0;i<e;i++)i>0&&(n+=`
else `),i<e-1&&(n+=`if(vTextureId < ${i}.5)`),n+=`
{`,n+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,n+=`
}`;return n+=`
`,n+=`
`,n}}class _R{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function DUe(){return!ah.apple.device}function LUe(r){let e=!0;const n=kt.ADAPTER.getNavigator();if(ah.tablet||ah.phone){if(ah.apple.device){const i=n.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(e=!1)}if(ah.android.device){const i=n.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(e=!1)}}return e?r:4}class oT{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var BUe=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,$Ue=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Hy=class ol extends oT{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=tK,this.vertexSize=6,this.state=Sc.for2d(),this.size=ol.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??LUe(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??DUe(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Xi("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return $Ue}static get defaultFragmentTemplate(){return BUe}setShaderGenerator({vertex:e=ol.defaultVertexSrc,fragment:n=ol.defaultFragmentTemplate}={}){this.shaderGenerator=new NUe(e,n)}contextChange(){const e=this.renderer.gl;kt.PREFER_ENV===Pp.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),ol.defaultMaxTextures),this.maxTextures=dUe(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let n=0;n<this._packedGeometryPoolSize;n++)this._packedGeometries[n]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:n}=ol,i=this.size/4,s=Math.floor(i/this.maxTextures)+1;for(;e.length<i;)e.push(new yR);for(;n.length<s;)n.push(new _R);for(let o=0;o<this.maxTextures;o++)this._tempBoundTextures[o]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:n}=this,i=ol._textureArrayPool,s=this.renderer.batch,o=this._tempBoundTextures,a=this.renderer.textureGC.count;let l=++Oi._globalBatch,h=0,u=i[0],f=0;s.copyBoundTextures(o,n);for(let p=0;p<this._bufferSize;++p){const m=e[p];e[p]=null,m._batchEnabled!==l&&(u.count>=n&&(s.boundArray(u,o,l,n),this.buildDrawCalls(u,f,p),f=p,u=i[++h],++l),m._batchEnabled=l,m.touched=a,u.elements[u.count++]=m)}u.count>0&&(s.boundArray(u,o,l,n),this.buildDrawCalls(u,f,this._bufferSize),++h,++l);for(let p=0;p<o.length;p++)o[p]=null;Oi._globalBatch=l}buildDrawCalls(e,n,i){const{_bufferedElements:s,_attributeBuffer:o,_indexBuffer:a,vertexSize:l}=this,h=ol._drawCallPool;let u=this._dcIndex,f=this._aIndex,p=this._iIndex,m=h[u];m.start=this._iIndex,m.texArray=e;for(let v=n;v<i;++v){const y=s[v],x=y._texture.baseTexture,w=ZZ[x.alphaMode?1:0][y.blendMode];s[v]=null,n<v&&m.blend!==w&&(m.size=p-m.start,n=v,m=h[++u],m.texArray=e,m.start=p),this.packInterleavedGeometry(y,o,a,f,p),f+=y.vertexData.length/2*l,p+=y.indices.length,m.blend=w}n<i&&(m.size=p-m.start,++u),this._dcIndex=u,this._aIndex=f,this._iIndex=p}bindAndClearTexArray(e){const n=this.renderer.texture;for(let i=0;i<e.count;i++)n.bind(e.elements[i],e.ids[i]),e.elements[i]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:n,_indexBuffer:i}=this;ol.canUploadSameBuffer?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:n,state:i}=this.renderer,s=ol._drawCallPool;let o=null;for(let a=0;a<e;a++){const{texArray:l,type:h,size:u,start:f,blend:p}=s[a];o!==l&&(o=l,this.bindAndClearTexArray(l)),this.state.blendMode=p,i.set(this.state),n.drawElements(h,u,n.UNSIGNED_SHORT,f*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),ol.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const n=gC(Math.ceil(e/8)),i=r9(n),s=n*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let o=this._aBuffers[s];return o||(this._aBuffers[s]=o=new mR(s*this.vertexSize*4)),o}getIndexBuffer(e){const n=gC(Math.ceil(e/12)),i=r9(n),s=n*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let o=this._iBuffers[i];return o||(this._iBuffers[i]=o=new Uint16Array(s)),o}packInterleavedGeometry(e,n,i,s,o){const{uint32View:a,float32View:l}=n,h=s/this.vertexSize,u=e.uvs,f=e.indices,p=e.vertexData,m=e._texture.baseTexture._batchLocation,v=Math.min(e.worldAlpha,1),y=Un.shared.setValue(e._tintRGB).toPremultiplied(v,e._texture.baseTexture.alphaMode>0);for(let x=0;x<p.length;x+=2)l[s++]=p[x],l[s++]=p[x+1],l[s++]=u[x],l[s++]=u[x+1],a[s++]=y,l[s++]=m;for(let x=0;x<f.length;x++)i[o++]=h+f[x]}};Hy.defaultBatchSize=4096,Hy.extension={name:"batch",type:wt.RendererPlugin},Hy._drawCallPool=[],Hy._textureArrayPool=[];let gf=Hy;Gt.add(gf);var UUe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,VUe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const OR=class Qy extends gl{constructor(e,n,i){const s=ch.from(e||Qy.defaultVertexSrc,n||Qy.defaultFragmentSrc);super(s,i),this.padding=0,this.resolution=Qy.defaultResolution,this.multisample=Qy.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Sc}apply(e,n,i,s,o){e.applyFilter(this,n,i,s)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return VUe}static get defaultFragmentSrc(){return UUe}};OR.defaultResolution=1,OR.defaultMultisample=Sr.NONE;let Zs=OR;class bC{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Un(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:n,background:i,backgroundAlpha:s}=e,o=i??n;o!==void 0&&(this.color=o),this.alpha=s}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}bC.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},bC.extension={type:[wt.RendererSystem,wt.CanvasRendererSystem],name:"background"};Gt.add(bC);class aK{constructor(e){this.renderer=e,this.emptyRenderer=new oT(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,n){const{boundTextures:i}=this.renderer.texture;for(let s=n-1;s>=0;--s)e[s]=i[s]||null,e[s]&&(e[s]._batchLocation=s)}boundArray(e,n,i,s){const{elements:o,ids:a,count:l}=e;let h=0;for(let u=0;u<l;u++){const f=o[u],p=f._batchLocation;if(p>=0&&p<s&&n[p]===f){a[u]=p;continue}for(;h<s;){const m=n[h];if(m&&m._batchEnabled===i&&m._batchLocation===h){h++;continue}a[u]=h,f._batchLocation=h,n[h]=f;break}}}destroy(){this.renderer=null}}aK.extension={type:wt.RendererSystem,name:"batch"};Gt.add(aK);let m9=0;class xC{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=m9++}init(e){if(e.context)this.initFromContext(e.context);else{const n=this.renderer.background.alpha<1,i=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:n,premultipliedAlpha:i,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=m9++,this.renderer.runners.contextChange.emit(e);const n=this.renderer.view;n.addEventListener!==void 0&&(n.addEventListener("webglcontextlost",this.handleContextLost,!1),n.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const n=this.createContext(this.renderer.view,e);this.initFromContext(n)}createContext(e,n){let i;if(kt.PREFER_ENV>=Pp.WEBGL2&&(i=e.getContext("webgl2",n)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=e.getContext("webgl",n)||e.getContext("experimental-webgl",n),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,n={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,n,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,n,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const n=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),n&&!n.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const s=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}xC.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},xC.extension={type:wt.RendererSystem,name:"context"};Gt.add(xC);class SR{constructor(e,n){if(this.width=Math.round(e),this.height=Math.round(n),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new pl("disposeFramebuffer"),this.multisample=Sr.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,n){return this.colorTextures[e]=n||new Oi(null,{scaleMode:oh.NEAREST,resolution:1,mipmap:yc.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new Oi(null,{scaleMode:oh.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:yc.OFF,format:rt.DEPTH_COMPONENT,type:Jt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,n){if(e=Math.round(e),n=Math.round(n),!e||!n)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&n===this.height)){this.width=e,this.height=n,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const s=this.colorTextures[i],o=s.resolution;s.setSize(e/o,n/o)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(e/i,n/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class lK extends Oi{constructor(e={}){if(typeof e=="number"){const n=arguments[0],i=arguments[1],s=arguments[2],o=arguments[3];e={width:n,height:i,scaleMode:s,resolution:o}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=Sr.NONE),super(null,e),this.mipmap=yc.OFF,this.valid=!0,this._clear=new Un([0,0,0,0]),this.framebuffer=new SR(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,n){this.framebuffer.resize(e*this.resolution,n*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class kh extends vb{constructor(e){const n=e,i=n.naturalWidth||n.videoWidth||n.displayWidth||n.width,s=n.naturalHeight||n.videoHeight||n.displayHeight||n.height;super(i,s),this.source=e,this.noSubImage=!1}static crossOrigin(e,n,i){i===void 0&&!n.startsWith("data:")?e.crossOrigin=cUe(n):i!==!1&&(e.crossOrigin=typeof i=="string"?i:"anonymous")}upload(e,n,i,s){const o=e.gl,a=n.realWidth,l=n.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===To.UNPACK),!this.noSubImage&&n.target===o.TEXTURE_2D&&i.width===a&&i.height===l?o.texSubImage2D(o.TEXTURE_2D,0,0,0,n.format,i.type,s):(i.width=a,i.height=l,o.texImage2D(n.target,0,i.internalFormat,n.format,i.type,s)),!0}update(){if(this.destroyed)return;const e=this.source,n=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(n,i),super.update()}dispose(){this.source=null}}class cK extends kh{constructor(e,n){if(n=n||{},typeof e=="string"){const i=new Image;kh.crossOrigin(i,e,n.crossorigin),i.src=e,e=i}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(n.createBitmap??kt.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof n.alphaMode=="number"?n.alphaMode:null,this.bitmap=null,this._load=null,n.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((n,i)=>{const s=this.source;this.url=s.src;const o=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.update(),this._load=null,this.createBitmap?n(this.process()):n(this))};s.complete&&s.src?o():(s.onload=o,s.onerror=a=>{i(a),this.onError.emit(a)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const n=globalThis.createImageBitmap,i=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then(s=>s.blob()).then(s=>n(s,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===To.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,n,i){if(typeof this.alphaMode=="number"&&(n.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,n,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,n,i,this.bitmap),!this.preserveBitmap){let s=!0;const o=n._glTextures;for(const a in o){const l=o[a];if(l!==i&&l.dirtyId!==n.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class Y5{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,n,i){const s=n.width,o=n.height;if(i){const a=e.width/2/s,l=e.height/2/o,h=e.x/s+a,u=e.y/o+l;i=tr.add(i,tr.NW),this.x0=h+a*tr.uX(i),this.y0=u+l*tr.uY(i),i=tr.add(i,2),this.x1=h+a*tr.uX(i),this.y1=u+l*tr.uY(i),i=tr.add(i,2),this.x2=h+a*tr.uX(i),this.y2=u+l*tr.uY(i),i=tr.add(i,2),this.x3=h+a*tr.uX(i),this.y3=u+l*tr.uY(i)}else this.x0=e.x/s,this.y0=e.y/o,this.x1=(e.x+e.width)/s,this.y1=e.y/o,this.x2=(e.x+e.width)/s,this.y2=(e.y+e.height)/o,this.x3=e.x/s,this.y3=(e.y+e.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Y5.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const g9=new Y5;function nO(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}class Wt extends rx{constructor(e,n,i,s,o,a,l){if(super(),this.noFrame=!1,n||(this.noFrame=!0,n=new ki(0,0,1,1)),e instanceof Wt&&(e=e.baseTexture),this.baseTexture=e,this._frame=n,this.trim=s,this.valid=!1,this.destroyed=!1,this._uvs=g9,this.uvMatrix=null,this.orig=i||n,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new hi(a.x,a.y):new hi(0,0),this.defaultBorders=l,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=n:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:n}=this.baseTexture;n!=null&&n.url&&Xl[n.url]&&Wt.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Wt.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var s;const e=this._frame.clone(),n=this._frame===this.orig?e:this.orig.clone(),i=new Wt(this.baseTexture,!this.noFrame&&e,n,(s=this.trim)==null?void 0:s.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=e),i}updateUvs(){this._uvs===g9&&(this._uvs=new Y5),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,n={},i=kt.STRICT_TEXTURE_CACHE){const s=typeof e=="string";let o=null;if(s)o=e;else if(e instanceof Oi){if(!e.cacheId){const l=(n==null?void 0:n.pixiIdPrefix)||"pixiid";e.cacheId=`${l}-${gp()}`,Oi.addToCache(e,e.cacheId)}o=e.cacheId}else{if(!e._pixiId){const l=(n==null?void 0:n.pixiIdPrefix)||"pixiid";e._pixiId=`${l}_${gp()}`}o=e._pixiId}let a=Xl[o];if(s&&i&&!a)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return!a&&!(e instanceof Oi)?(n.resolution||(n.resolution=Mh(e)),a=new Wt(new Oi(e,n)),a.baseTexture.cacheId=o,Oi.addToCache(a.baseTexture,o),Wt.addToCache(a,o)):!a&&e instanceof Oi&&(a=new Wt(e),Wt.addToCache(a,o)),a}static fromURL(e,n){const i=Object.assign({autoLoad:!1},n==null?void 0:n.resourceOptions),s=Wt.from(e,Object.assign({resourceOptions:i},n),!1),o=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):o.load().then(()=>Promise.resolve(s))}static fromBuffer(e,n,i,s){return new Wt(Oi.fromBuffer(e,n,i,s))}static fromLoader(e,n,i,s){const o=new Oi(e,Object.assign({scaleMode:Oi.defaultOptions.scaleMode,resolution:Mh(n)},s)),{resource:a}=o;a instanceof cK&&(a.url=n);const l=new Wt(o);return i||(i=n),Oi.addToCache(l.baseTexture,i),Wt.addToCache(l,i),i!==n&&(Oi.addToCache(l.baseTexture,n),Wt.addToCache(l,n)),l.baseTexture.valid?Promise.resolve(l):new Promise(h=>{l.baseTexture.once("loaded",()=>h(l))})}static addToCache(e,n){n&&(e.textureCacheIds.includes(n)||e.textureCacheIds.push(n),Xl[n]&&Xl[n]!==e&&console.warn(`Texture added to the cache with an id [${n}] that already had an entry`),Xl[n]=e)}static removeFromCache(e){if(typeof e=="string"){const n=Xl[e];if(n){const i=n.textureCacheIds.indexOf(e);return i>-1&&n.textureCacheIds.splice(i,1),delete Xl[e],n}}else if(e!=null&&e.textureCacheIds){for(let n=0;n<e.textureCacheIds.length;++n)Xl[e.textureCacheIds[n]]===e&&delete Xl[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:n,y:i,width:s,height:o}=e,a=n+s>this.baseTexture.width,l=i+o>this.baseTexture.height;if(a||l){const h=a&&l?"and":"or",u=`X: ${n} + ${s} = ${n+s} > ${this.baseTexture.width}`,f=`Y: ${i} + ${o} = ${i+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${h} ${f}`)}this.valid=s&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Wt._EMPTY||(Wt._EMPTY=new Wt(new Oi),nO(Wt._EMPTY),nO(Wt._EMPTY.baseTexture)),Wt._EMPTY}static get WHITE(){if(!Wt._WHITE){const e=kt.ADAPTER.createCanvas(16,16),n=e.getContext("2d");e.width=16,e.height=16,n.fillStyle="white",n.fillRect(0,0,16,16),Wt._WHITE=new Wt(Oi.from(e)),nO(Wt._WHITE),nO(Wt._WHITE.baseTexture)}return Wt._WHITE}}class Rp extends Wt{constructor(e,n){super(e,n),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,n,i=!0){const s=this.baseTexture.resolution,o=Math.round(e*s)/s,a=Math.round(n*s)/s;this.valid=o>0&&a>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=a,i&&this.baseTexture.resize(o,a),this.updateUvs()}setResolution(e){const{baseTexture:n}=this;n.resolution!==e&&(n.setResolution(e),this.resize(n.width,n.height,!1))}static create(e){return new Rp(new lK(e))}}class hK{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,n,i=Sr.NONE){const s=new lK(Object.assign({width:e,height:n,resolution:1,multisample:i},this.textureOptions));return new Rp(s)}getOptimalTexture(e,n,i=1,s=Sr.NONE){let o;e=Math.max(Math.ceil(e*i-1e-6),1),n=Math.max(Math.ceil(n*i-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||n!==this._pixelsHeight?(e=gC(e),n=gC(n),o=((e&65535)<<16|n&65535)>>>0,s>1&&(o+=s*4294967296)):o=s>1?-s:-1,this.texturePool[o]||(this.texturePool[o]=[]);let a=this.texturePool[o].pop();return a||(a=this.createTexture(e,n,s)),a.filterPoolKey=o,a.setResolution(i),a}getFilterTexture(e,n,i){const s=this.getOptimalTexture(e.width,e.height,n||e.resolution,i||Sr.NONE);return s.filterFrame=e.filterFrame,s}returnTexture(e){const n=e.filterPoolKey;e.filterFrame=null,this.texturePool[n].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const n in this.texturePool){const i=this.texturePool[n];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const n in this.texturePool){if(!(Number(n)<0))continue;const i=this.texturePool[n];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0);this.texturePool[n]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}hK.SCREEN_KEY=-1;class FUe extends Ah{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class uK extends Ah{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new gr(this.vertices),this.uvBuffer=new gr(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,n){let i=0,s=0;return this.uvs[0]=i,this.uvs[1]=s,this.uvs[2]=i+n.width/e.width,this.uvs[3]=s,this.uvs[4]=i+n.width/e.width,this.uvs[5]=s+n.height/e.height,this.uvs[6]=i,this.uvs[7]=s+n.height/e.height,i=n.x,s=n.y,this.vertices[0]=i,this.vertices[1]=s,this.vertices[2]=i+n.width,this.vertices[3]=s,this.vertices[4]=i+n.width,this.vertices[5]=s+n.height,this.vertices[6]=i,this.vertices[7]=s+n.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class zUe{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Sr.NONE,this.sourceFrame=new ki,this.destinationFrame=new ki,this.bindingSourceFrame=new ki,this.bindingDestinationFrame=new ki,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const rO=[new hi,new hi,new hi,new hi],hk=new Fn;class dK{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new hK,this.statePool=[],this.quad=new FUe,this.quadUv=new uK,this.tempRect=new ki,this.activeState={},this.globalUniforms=new ml({outputFrame:new ki,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,n){const i=this.renderer,s=this.defaultFilterStack,o=this.statePool.pop()||new zUe,a=i.renderTexture;let l,h;if(a.current){const w=a.current;l=w.resolution,h=w.multisample}else l=i.resolution,h=i.multisample;let u=n[0].resolution||l,f=n[0].multisample??h,p=n[0].padding,m=n[0].autoFit,v=n[0].legacy??!0;for(let w=1;w<n.length;w++){const S=n[w];u=Math.min(u,S.resolution||l),f=Math.min(f,S.multisample??h),p=this.useMaxPadding?Math.max(p,S.padding):p+S.padding,m=m&&S.autoFit,v=v||(S.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),s.push(o),o.resolution=u,o.multisample=f,o.legacy=v,o.target=e,o.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),o.sourceFrame.pad(p);const y=this.tempRect.copyFrom(a.sourceFrame);i.projection.transform&&this.transformAABB(hk.copyFrom(i.projection.transform).invert(),y),m?(o.sourceFrame.fit(y),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(y)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,a.current?a.current.resolution:i.resolution,a.sourceFrame,a.destinationFrame,i.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,u,f),o.filters=n,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;const x=this.tempRect;x.x=0,x.y=0,x.width=o.sourceFrame.width,x.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(a.sourceFrame),o.bindingDestinationFrame.copyFrom(a.destinationFrame),o.transform=i.projection.transform,i.projection.transform=null,a.bind(o.renderTexture,o.sourceFrame,x),i.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,n=e.pop(),i=n.filters;this.activeState=n;const s=this.globalUniforms.uniforms;s.outputFrame=n.sourceFrame,s.resolution=n.resolution;const o=s.inputSize,a=s.inputPixel,l=s.inputClamp;if(o[0]=n.destinationFrame.width,o[1]=n.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],a[0]=Math.round(o[0]*n.resolution),a[1]=Math.round(o[1]*n.resolution),a[2]=1/a[0],a[3]=1/a[1],l[0]=.5*a[2],l[1]=.5*a[3],l[2]=n.sourceFrame.width*o[2]-.5*a[2],l[3]=n.sourceFrame.height*o[3]-.5*a[3],n.legacy){const u=s.filterArea;u[0]=n.destinationFrame.width,u[1]=n.destinationFrame.height,u[2]=n.sourceFrame.x,u[3]=n.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();const h=e[e.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,n.renderTexture,h.renderTexture,ql.BLEND,n),this.returnFilterTexture(n.renderTexture);else{let u=n.renderTexture,f=this.getOptimalFilterTexture(u.width,u.height,n.resolution);f.filterFrame=u.filterFrame;let p=0;for(p=0;p<i.length-1;++p){p===1&&n.multisample>1&&(f=this.getOptimalFilterTexture(u.width,u.height,n.resolution),f.filterFrame=u.filterFrame),i[p].apply(this,u,f,ql.CLEAR,n);const m=u;u=f,f=m}i[p].apply(this,u,h.renderTexture,ql.BLEND,n),p>1&&n.multisample>1&&this.returnFilterTexture(n.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(f)}n.clear(),this.statePool.push(n)}bindAndClear(e,n=ql.CLEAR){const{renderTexture:i,state:s}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const a=this.tempRect;a.x=0,a.y=0,a.width=e.filterFrame.width,a.height=e.filterFrame.height,i.bind(e,e.filterFrame,a)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const o=s.stateId&1||this.forceClear;(n===ql.CLEAR||n===ql.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,n,i,s){const o=this.renderer;o.state.set(e.state),this.bindAndClear(i,s),e.uniforms.uSampler=n,e.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(n._frame,n.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(sc.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(sc.TRIANGLE_STRIP))}calculateSpriteMatrix(e,n){const{sourceFrame:i,destinationFrame:s}=this.activeState,{orig:o}=n._texture,a=e.set(s.width,0,0,s.height,i.x,i.y),l=n.worldTransform.copyTo(Fn.TEMP_MATRIX);return l.invert(),a.prepend(l),a.scale(1/o.width,1/o.height),a.translate(n.anchor.x,n.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,n,i=1,s=Sr.NONE){return this.texturePool.getOptimalTexture(e,n,i,s)}getFilterTexture(e,n,i){if(typeof e=="number"){const o=e;e=n,n=o}e=e||this.activeState.renderTexture;const s=this.texturePool.getOptimalTexture(e.width,e.height,n||e.resolution,i||Sr.NONE);return s.filterFrame=e.filterFrame,s}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,n){const i=rO[0],s=rO[1],o=rO[2],a=rO[3];i.set(n.left,n.top),s.set(n.left,n.bottom),o.set(n.right,n.top),a.set(n.right,n.bottom),e.apply(i,i),e.apply(s,s),e.apply(o,o),e.apply(a,a);const l=Math.min(i.x,s.x,o.x,a.x),h=Math.min(i.y,s.y,o.y,a.y),u=Math.max(i.x,s.x,o.x,a.x),f=Math.max(i.y,s.y,o.y,a.y);n.x=l,n.y=h,n.width=u-l,n.height=f-h}roundFrame(e,n,i,s,o){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(o){const{a,b:l,c:h,d:u}=o;if((Math.abs(l)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(u)>1e-4))return}o=o?hk.copyFrom(o):hk.identity(),o.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.transformAABB(o,e),e.ceil(n),this.transformAABB(o.invert(),e)}}}dK.extension={type:wt.RendererSystem,name:"filter"};Gt.add(dK);class XUe{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Sr.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const WUe=new ki;class fK{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new SR(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ki,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let n=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;kt.PREFER_ENV===Pp.WEBGL_LEGACY&&(n=null,i=null),n?e.drawBuffers=s=>n.drawBuffersWEBGL(s):(this.hasMRT=!1,e.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,n,i=0){const{gl:s}=this;if(e){const o=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,s.bindFramebuffer(s.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,o.mipLevel=i),o.dirtyId!==e.dirtyId&&(o.dirtyId=e.dirtyId,o.dirtyFormat!==e.dirtyFormat?(o.dirtyFormat=e.dirtyFormat,o.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):o.dirtySize!==e.dirtySize&&(o.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let a=0;a<e.colorTextures.length;a++){const l=e.colorTextures[a];this.renderer.texture.unbind(l.parentTextureArray||l)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),n){const a=n.width>>i,l=n.height>>i,h=a/n.width;this.setViewport(n.x*h,n.y*h,a,l)}else{const a=e.width>>i,l=e.height>>i;this.setViewport(0,0,a,l)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),n?this.setViewport(n.x,n.y,n.width,n.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,n,i,s){const o=this.viewport;e=Math.round(e),n=Math.round(n),i=Math.round(i),s=Math.round(s),(o.width!==i||o.height!==s||o.x!==e||o.y!==n)&&(o.x=e,o.y=n,o.width=i,o.height=s,this.gl.viewport(e,n,i,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,n,i,s,o=K3.COLOR|K3.DEPTH){const{gl:a}=this;a.clearColor(e,n,i,s),a.clear(o)}initFramebuffer(e){const{gl:n}=this,i=new XUe(n.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i}resizeFramebuffer(e){const{gl:n}=this,i=e.glFramebuffers[this.CONTEXT_UID];if(i.stencil){n.bindRenderbuffer(n.RENDERBUFFER,i.stencil);let a;this.renderer.context.webGLVersion===1?a=n.DEPTH_STENCIL:e.depth&&e.stencil?a=n.DEPTH24_STENCIL8:e.depth?a=n.DEPTH_COMPONENT24:a=n.STENCIL_INDEX8,i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,a,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,a,e.width,e.height)}const s=e.colorTextures;let o=s.length;n.drawBuffers||(o=Math.min(o,1));for(let a=0;a<o;a++){const l=s[a],h=l.parentTextureArray||l;this.renderer.texture.bind(h,0),a===0&&i.msaaBuffer&&(n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,n){const{gl:i}=this,s=e.glFramebuffers[this.CONTEXT_UID],o=e.colorTextures;let a=o.length;i.drawBuffers||(a=Math.min(a,1)),s.multisample>1&&this.canMultisampleFramebuffer(e)?s.msaaBuffer=s.msaaBuffer||i.createRenderbuffer():s.msaaBuffer&&(i.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));const l=[];for(let h=0;h<a;h++){const u=o[h],f=u.parentTextureArray||u;this.renderer.texture.bind(f,0),h===0&&s.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,s.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,f._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,s.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+h,u.target,f._glTextures[this.CONTEXT_UID].texture,n),l.push(i.COLOR_ATTACHMENT0+h))}if(l.length>1&&i.drawBuffers(l),e.depthTexture&&this.writeDepthTexture){const h=e.depthTexture;this.renderer.texture.bind(h,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,n)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){s.stencil=s.stencil||i.createRenderbuffer();let h,u;this.renderer.context.webGLVersion===1?(h=i.DEPTH_STENCIL_ATTACHMENT,u=i.DEPTH_STENCIL):e.depth&&e.stencil?(h=i.DEPTH_STENCIL_ATTACHMENT,u=i.DEPTH24_STENCIL8):e.depth?(h=i.DEPTH_ATTACHMENT,u=i.DEPTH_COMPONENT24):(h=i.STENCIL_ATTACHMENT,u=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,s.stencil),s.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,u,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,u,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,h,i.RENDERBUFFER,s.stencil)}else s.stencil&&(i.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:n}=this;let i=Sr.NONE;if(e<=1||n===null)return i;for(let s=0;s<n.length;s++)if(n[s]<=e){i=n[s];break}return i===1&&(i=Sr.NONE),i}blit(e,n,i){const{current:s,renderer:o,gl:a,CONTEXT_UID:l}=this;if(o.context.webGLVersion!==2||!s)return;const h=s.glFramebuffers[l];if(!h)return;if(!e){if(!h.msaaBuffer)return;const f=s.colorTextures[0];if(!f)return;h.blitFramebuffer||(h.blitFramebuffer=new SR(s.width,s.height),h.blitFramebuffer.addColorTexture(0,f)),e=h.blitFramebuffer,e.colorTextures[0]!==f&&(e.colorTextures[0]=f,e.dirtyId++,e.dirtyFormat++),(e.width!==s.width||e.height!==s.height)&&(e.width=s.width,e.height=s.height,e.dirtyId++,e.dirtySize++)}n||(n=WUe,n.width=s.width,n.height=s.height),i||(i=n);const u=n.width===i.width&&n.height===i.height;this.bind(e),a.bindFramebuffer(a.READ_FRAMEBUFFER,h.framebuffer),a.blitFramebuffer(n.left,n.top,n.right,n.bottom,i.left,i.top,i.right,i.bottom,a.COLOR_BUFFER_BIT,u?a.NEAREST:a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,n){const i=e.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!i)return;delete e.glFramebuffers[this.CONTEXT_UID];const o=this.managedFramebuffers.indexOf(e);o>=0&&this.managedFramebuffers.splice(o,1),e.disposeRunner.remove(this),n||(s.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&s.deleteRenderbuffer(i.msaaBuffer),i.stencil&&s.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,n)}disposeAll(e){const n=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<n.length;i++)this.disposeFramebuffer(n[i],e)}forceStencil(){const e=this.current;if(!e)return;const n=e.glFramebuffers[this.CONTEXT_UID];if(!n||n.stencil&&e.stencil)return;e.stencil=!0;const i=e.width,s=e.height,o=this.gl,a=n.stencil=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,a);let l,h;this.renderer.context.webGLVersion===1?(l=o.DEPTH_STENCIL_ATTACHMENT,h=o.DEPTH_STENCIL):e.depth?(l=o.DEPTH_STENCIL_ATTACHMENT,h=o.DEPTH24_STENCIL8):(l=o.STENCIL_ATTACHMENT,h=o.STENCIL_INDEX8),n.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,n.multisample,h,i,s):o.renderbufferStorage(o.RENDERBUFFER,h,i,s),o.framebufferRenderbuffer(o.FRAMEBUFFER,l,o.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ki}destroy(){this.renderer=null}}fK.extension={type:wt.RendererSystem,name:"framebuffer"};Gt.add(fK);const uk={5126:4,5123:2,5121:1};class pK{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,n=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,n.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;kt.PREFER_ENV===Pp.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=()=>i.createVertexArrayOES(),e.bindVertexArray=s=>i.bindVertexArrayOES(s),e.deleteVertexArray=s=>i.deleteVertexArrayOES(s)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(n.webGLVersion!==2){const i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=(s,o)=>i.vertexAttribDivisorANGLE(s,o),e.drawElementsInstanced=(s,o,a,l,h)=>i.drawElementsInstancedANGLE(s,o,a,l,h),e.drawArraysInstanced=(s,o,a,l)=>i.drawArraysInstancedANGLE(s,o,a,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=n.webGLVersion===2||!!n.extensions.uint32ElementIndex}bind(e,n){n=n||this.renderer.shader.shader;const{gl:i}=this;let s=e.glVertexArrayObjects[this.CONTEXT_UID],o=!1;s||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=s={},o=!0);const a=s[n.program.id]||this.initGeometryVao(e,n,o);this._activeGeometry=e,this._activeVao!==a&&(this._activeVao=a,this.hasVao?i.bindVertexArray(a):this.activateVao(e,n.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,n=this.renderer.buffer;for(let i=0;i<e.buffers.length;i++){const s=e.buffers[i];n.update(s)}}checkCompatibility(e,n){const i=e.attributes,s=n.attributeData;for(const o in s)if(!i[o])throw new Error(`shader and geometry incompatible, geometry missing the "${o}" attribute`)}getSignature(e,n){const i=e.attributes,s=n.attributeData,o=["g",e.id];for(const a in i)s[a]&&o.push(a,s[a].location);return o.join("-")}initGeometryVao(e,n,i=!0){const s=this.gl,o=this.CONTEXT_UID,a=this.renderer.buffer,l=n.program;l.glPrograms[o]||this.renderer.shader.generateProgram(n),this.checkCompatibility(e,l);const h=this.getSignature(e,l),u=e.glVertexArrayObjects[this.CONTEXT_UID];let f=u[h];if(f)return u[l.id]=f,f;const p=e.buffers,m=e.attributes,v={},y={};for(const x in p)v[x]=0,y[x]=0;for(const x in m)!m[x].size&&l.attributeData[x]?m[x].size=l.attributeData[x].size:m[x].size||console.warn(`PIXI Geometry attribute '${x}' size cannot be determined (likely the bound shader does not have the attribute)`),v[m[x].buffer]+=m[x].size*uk[m[x].type];for(const x in m){const w=m[x],S=w.size;w.stride===void 0&&(v[w.buffer]===S*uk[w.type]?w.stride=0:w.stride=v[w.buffer]),w.start===void 0&&(w.start=y[w.buffer],y[w.buffer]+=S*uk[w.type])}f=s.createVertexArray(),s.bindVertexArray(f);for(let x=0;x<p.length;x++){const w=p[x];a.bind(w),i&&w._glBuffers[o].refCount++}return this.activateVao(e,l),u[l.id]=f,u[h]=f,s.bindVertexArray(null),a.unbind(cc.ARRAY_BUFFER),f}disposeGeometry(e,n){var l;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const i=e.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,o=e.buffers,a=(l=this.renderer)==null?void 0:l.buffer;if(e.disposeRunner.remove(this),!!i){if(a)for(let h=0;h<o.length;h++){const u=o[h]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!n&&a.dispose(o[h],n))}if(!n){for(const h in i)if(h[0]==="g"){const u=i[h];this._activeVao===u&&this.unbind(),s.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const n=Object.keys(this.managedGeometries);for(let i=0;i<n.length;i++)this.disposeGeometry(this.managedGeometries[n[i]],e)}activateVao(e,n){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=e.buffers,l=e.attributes;e.indexBuffer&&o.bind(e.indexBuffer);let h=null;for(const u in l){const f=l[u],p=a[f.buffer],m=p._glBuffers[s];if(n.attributeData[u]){h!==m&&(o.bind(p),h=m);const v=n.attributeData[u].location;if(i.enableVertexAttribArray(v),i.vertexAttribPointer(v,f.size,f.type||i.FLOAT,f.normalized,f.stride,f.start),f.instance)if(this.hasInstance)i.vertexAttribDivisor(v,f.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,n,i,s){const{gl:o}=this,a=this._activeGeometry;if(a.indexBuffer){const l=a.indexBuffer.data.BYTES_PER_ELEMENT,h=l===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?a.instanced?o.drawElementsInstanced(e,n||a.indexBuffer.data.length,h,(i||0)*l,s||1):o.drawElements(e,n||a.indexBuffer.data.length,h,(i||0)*l):console.warn("unsupported index buffer type: uint32")}else a.instanced?o.drawArraysInstanced(e,i,n||a.getSize(),s||1):o.drawArrays(e,i,n||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}pK.extension={type:wt.RendererSystem,name:"geometry"};Gt.add(pK);const v9=new Fn;class mK{constructor(e,n){this._texture=e,this.mapCoord=new Fn,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof n>"u"?.5:n,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,n){n===void 0&&(n=e);const i=this.mapCoord;for(let s=0;s<e.length;s+=2){const o=e[s],a=e[s+1];n[s]=o*i.a+a*i.c+i.tx,n[s+1]=o*i.b+a*i.d+i.ty}return n}update(e){const n=this._texture;if(!n||!n.valid||!e&&this._textureID===n._updateID)return!1;this._textureID=n._updateID,this._updateID++;const i=n._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const s=n.orig,o=n.trim;o&&(v9.set(s.width/o.width,0,0,s.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(v9));const a=n.baseTexture,l=this.uClampFrame,h=this.clampMargin/a.resolution,u=this.clampOffset;return l[0]=(n._frame.x+h+u)/a.width,l[1]=(n._frame.y+h+u)/a.height,l[2]=(n._frame.x+n._frame.width-h+u)/a.width,l[3]=(n._frame.y+n._frame.height-h+u)/a.height,this.uClampOffset[0]=u/a.realWidth,this.uClampOffset[1]=u/a.realHeight,this.isSimple=n._frame.width===a.width&&n._frame.height===a.height&&n.rotate===0,!0}}var GUe=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,HUe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class QUe extends Zs{constructor(e,n,i){let s=null;typeof e!="string"&&n===void 0&&i===void 0&&(s=e,e=void 0,n=void 0,i=void 0),super(e||HUe,n||GUe,i),this.maskSprite=s,this.maskMatrix=new Fn}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,n,i,s){const o=this._maskSprite,a=o._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new mK(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,o).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,e.applyFilter(this,n,i,s))}}class jUe{constructor(e=null){this.type=Lr.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Zs.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Lr.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class gK{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,n){let i=n;if(!i.isMaskData){const o=this.maskDataPool.pop()||new jUe;o.pooled=!0,o.maskObject=n,i=o}const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(s),i._colorMask=s?s._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==Lr.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Lr.SCISSOR:this.renderer.scissor.push(i);break;case Lr.STENCIL:this.renderer.stencil.push(i);break;case Lr.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Lr.COLOR:this.pushColorMask(i);break}i.type===Lr.SPRITE&&this.maskStack.push(i)}pop(e){const n=this.maskStack.pop();if(!(!n||n._target!==e)){if(n.enabled)switch(n.type){case Lr.SCISSOR:this.renderer.scissor.pop(n);break;case Lr.STENCIL:this.renderer.stencil.pop(n.maskObject);break;case Lr.SPRITE:this.popSpriteMask(n);break;case Lr.COLOR:this.popColorMask(n);break}if(n.reset(),n.pooled&&this.maskDataPool.push(n),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===Lr.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(e){const n=e.maskObject;n?n.isSprite?e.type=Lr.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Lr.SCISSOR:e.type=Lr.STENCIL:e.type=Lr.COLOR}pushSpriteMask(e){const{maskObject:n}=e,i=e._target;let s=e._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new QUe])),s[0].resolution=e.resolution,s[0].multisample=e.multisample,s[0].maskSprite=n;const o=i.filterArea;i.filterArea=n.getBounds(!0),this.renderer.filter.push(i,s),i.filterArea=o,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const n=e._colorMask,i=e._colorMask=n&e.colorMask;i!==n&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(e){const n=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==n&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}gK.extension={type:wt.RendererSystem,name:"mask"};Gt.add(gK);class vK{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:n}=this.renderer,i=this.getStackLength();this.maskStack=e;const s=this.getStackLength();s!==i&&(s===0?n.disable(this.glConst):(n.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const y9=new Fn,b9=[],yK=class JO extends vK{constructor(e){super(e),this.glConst=kt.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const n=e._scissorRect,{maskObject:i}=e,{renderer:s}=this,o=s.renderTexture,a=i.getBounds(!0,b9.pop()??new ki);this.roundFrameToPixels(a,o.current?o.current.resolution:s.resolution,o.sourceFrame,o.destinationFrame,s.projection.transform),n&&a.fit(n),e._scissorRectLocal=a}static isMatrixRotated(e){if(!e)return!1;const{a:n,b:i,c:s,d:o}=e;return(Math.abs(i)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(n)>1e-4||Math.abs(o)>1e-4)}testScissor(e){const{maskObject:n}=e;if(!n.isFastRect||!n.isFastRect()||JO.isMatrixRotated(n.worldTransform)||JO.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const i=e._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(e,n,i,s,o){JO.isMatrixRotated(o)||(o=o?y9.copyFrom(o):y9.identity(),o.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.renderer.filter.transformAABB(o,e),e.fit(s),e.x=Math.round(e.x*n),e.y=Math.round(e.y*n),e.width=Math.round(e.width*n),e.height=Math.round(e.height*n))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:n}=this.renderer;e._scissorRect||n.enable(n.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:n}=this.renderer;e&&b9.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():n.disable(n.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let n;this.renderer.renderTexture.current?n=e.y:n=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,n,e.width,e.height)}};yK.extension={type:wt.RendererSystem,name:"scissor"};let YUe=yK;Gt.add(YUe);class bK extends vK{constructor(e){super(e),this.glConst=kt.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const n=e.maskObject,{gl:i}=this.renderer,s=e._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;const o=e._colorMask;o!==0&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,s,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),n.renderable=!0,n.render(this.renderer),this.renderer.batch.flush(),n.renderable=!1,o!==0&&(e._colorMask=o,i.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()}pop(e){const n=this.renderer.gl;if(this.getStackLength()===0)n.disable(n.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=i?i._colorMask:15;s!==0&&(i._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilOp(n.KEEP,n.KEEP,n.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,s!==0&&(i._colorMask=s,n.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}bK.extension={type:wt.RendererSystem,name:"stencil"};Gt.add(bK);class xK{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Xi("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return Xi("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return Xi("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const n in e)this.plugins[n]=new e[n](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}xK.extension={type:[wt.RendererSystem,wt.CanvasRendererSystem],name:"_plugin"};Gt.add(xK);class wK{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Fn,this.transform=null}update(e,n,i,s){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=n||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,s),this.transform&&this.projectionMatrix.append(this.transform);const o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(e,n,i,s){const o=this.projectionMatrix,a=s?-1:1;o.identity(),o.a=1/n.width*2,o.d=a*(1/n.height*2),o.tx=-1-n.x*o.a,o.ty=-a-n.y*o.d}setTransform(e){}destroy(){this.renderer=null}}wK.extension={type:wt.RendererSystem,name:"projection"};Gt.add(wK);const qUe=new j5,x9=new ki;class _K{constructor(e){this.renderer=e,this._tempMatrix=new Fn}generateTexture(e,n){const{region:i,...s}=n||{},o=(i==null?void 0:i.copyTo(x9))||e.getLocalBounds(x9,!0),a=s.resolution||this.renderer.resolution;o.width=Math.max(o.width,1/a),o.height=Math.max(o.height,1/a),s.width=o.width,s.height=o.height,s.resolution=a,s.multisample??(s.multisample=this.renderer.multisample);const l=Rp.create(s);this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;const h=e.transform;return e.transform=qUe,this.renderer.render(e,{renderTexture:l,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=h,l}destroy(){}}_K.extension={type:[wt.RendererSystem,wt.CanvasRendererSystem],name:"textureGenerator"};Gt.add(_K);const sf=new ki,Oy=new ki;class OK{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ki,this.destinationFrame=new ki,this.viewportFrame=new ki}contextChange(){var n;const e=(n=this.renderer)==null?void 0:n.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,n,i){const s=this.renderer;this.current=e;let o,a,l;e?(o=e.baseTexture,l=o.resolution,n||(sf.width=e.frame.width,sf.height=e.frame.height,n=sf),i||(Oy.x=e.frame.x,Oy.y=e.frame.y,Oy.width=n.width,Oy.height=n.height,i=Oy),a=o.framebuffer):(l=s.resolution,n||(sf.width=s._view.screen.width,sf.height=s._view.screen.height,n=sf),i||(i=sf,i.width=n.width,i.height=n.height));const h=this.viewportFrame;h.x=i.x*l,h.y=i.y*l,h.width=i.width*l,h.height=i.height*l,e||(h.y=s.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(a,h),this.renderer.projection.update(i,n,l,!a),e?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(n),this.destinationFrame.copyFrom(i)}clear(e,n){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,s=Un.shared.setValue(e||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&s.premultiply(s.alpha);const o=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,l=o.width!==a.width||o.height!==a.height;if(l){let{x:h,y:u,width:f,height:p}=this.viewportFrame;h=Math.round(h),u=Math.round(u),f=Math.round(f),p=Math.round(p),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,u,f,p)}this.renderer.framebuffer.clear(s.red,s.green,s.blue,s.alpha,n),l&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}OK.extension={type:wt.RendererSystem,name:"renderTexture"};Gt.add(OK);class ZUe{constructor(e,n){this.program=e,this.uniformData=n,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function KUe(r,e){const n={},i=e.getProgramParameter(r,e.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const o=e.getActiveAttrib(r,s);if(o.name.startsWith("gl_"))continue;const a=oK(e,o.type),l={type:a,name:o.name,size:sK(a),location:e.getAttribLocation(r,o.name)};n[o.name]=l}return n}function JUe(r,e){const n={},i=e.getProgramParameter(r,e.ACTIVE_UNIFORMS);for(let s=0;s<i;s++){const o=e.getActiveUniform(r,s),a=o.name.replace(/\[.*?\]$/,""),l=!!o.name.match(/\[.*?\]$/),h=oK(e,o.type);n[a]={name:a,index:s,type:h,size:o.size,isArray:l,value:nK(h,o.size)}}return n}function eVe(r,e){var l;const n=u9(r,r.VERTEX_SHADER,e.vertexSrc),i=u9(r,r.FRAGMENT_SHADER,e.fragmentSrc),s=r.createProgram();r.attachShader(s,n),r.attachShader(s,i);const o=(l=e.extra)==null?void 0:l.transformFeedbackVaryings;if(o&&(typeof r.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(s,o.names,o.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||AUe(r,s,n,i),e.attributeData=KUe(s,r),e.uniformData=JUe(s,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const h=Object.keys(e.attributeData);h.sort((u,f)=>u>f?1:-1);for(let u=0;u<h.length;u++)e.attributeData[h[u]].location=u,r.bindAttribLocation(s,u,h[u]);r.linkProgram(s)}r.deleteShader(n),r.deleteShader(i);const a={};for(const h in e.uniformData){const u=e.uniformData[h];a[h]={location:r.getUniformLocation(s,h),value:nK(u.type,u.size)}}return new ZUe(s,a)}function tVe(r,e,n,i,s){n.buffer.update(s)}const iVe={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},SK={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function nVe(r){const e=r.map(o=>({data:o,offset:0,dataLen:0,dirty:0}));let n=0,i=0,s=0;for(let o=0;o<e.length;o++){const a=e[o];if(n=SK[a.data.type],a.data.size>1&&(n=Math.max(n,16)*a.data.size),a.dataLen=n,i%n!==0&&i<16){const l=i%n%16;i+=l,s+=l}i+n>16?(s=Math.ceil(s/16)*16,a.offset=s,s+=n,i=n):(a.offset=s,i+=n,s+=n)}return s=Math.ceil(s/16)*16,{uboElements:e,size:s}}function rVe(r,e){const n=[];for(const i in r)e[i]&&n.push(e[i]);return n.sort((i,s)=>i.index-s.index),n}function sVe(r,e){if(!r.autoManage)return{size:0,syncFunc:tVe};const n=rVe(r.uniforms,e),{uboElements:i,size:s}=nVe(n),o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<i.length;a++){const l=i[a],h=r.uniforms[l.data.name],u=l.data.name;let f=!1;for(let p=0;p<Eg.length;p++){const m=Eg[p];if(m.codeUbo&&m.test(l.data,h)){o.push(`offset = ${l.offset/4};`,Eg[p].codeUbo(l.data.name,h)),f=!0;break}}if(!f)if(l.data.size>1){const p=sK(l.data.type),m=Math.max(SK[l.data.type]/16,1),v=p/m,y=(4-v%4)%4;o.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*m}; i++)
                {
                    for(var j = 0; j < ${v}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${y};
                }

                `)}else{const p=iVe[l.data.type];o.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${l.offset/4};
                ${p};
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}let oVe=0;const sO={textureCount:0,uboCount:0};class CK{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=oVe++}systemCheck(){if(!PUe())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,n){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const i=e.program,s=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(s.program)),n||(sO.textureCount=0,sO.uboCount=0,this.syncUniformGroup(e.uniformGroup,sO)),s}setUniforms(e){const n=this.shader.program,i=n.glPrograms[this.renderer.CONTEXT_UID];n.syncUniforms(i.uniformData,e,this.renderer)}syncUniformGroup(e,n){const i=this.getGlProgram();(!e.static||e.dirtyId!==i.uniformDirtyGroups[e.id])&&(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,n))}syncUniforms(e,n,i){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(n.uniformData,e.uniforms,this.renderer,i)}createSyncGroups(e){const n=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[n]||(this.cache[n]=TUe(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[n],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,n){const i=this.getGlProgram();if(!e.static||e.dirtyId!==0||!i.uniformGroups[e.id]){e.dirtyId=0;const s=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,n);e.buffer.update(),s(i.uniformData,e.uniforms,this.renderer,sO,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[n])}createSyncBufferGroup(e,n,i){const{gl:s}=this.renderer;this.renderer.buffer.bind(e.buffer);const o=this.gl.getUniformBlockIndex(n.program,i);n.uniformBufferBindings[i]=this.shader.uniformBindCount,s.uniformBlockBinding(n.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;const a=this.getSignature(e,this.shader.program.uniformData,"ubo");let l=this._uboCache[a];if(l||(l=this._uboCache[a]=sVe(e,this.shader.program.uniformData)),e.autoManage){const h=new Float32Array(l.size/4);e.buffer.update(h)}return n.uniformGroups[e.id]=l.syncFunc,n.uniformGroups[e.id]}getSignature(e,n,i){const s=e.uniforms,o=[`${i}-`];for(const a in s)o.push(a),n[a]&&o.push(n[a].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const n=this.gl,i=e.program,s=eVe(n,i);return i.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}CK.extension={type:wt.RendererSystem,name:"shader"};Gt.add(CK);class wC{constructor(e){this.renderer=e}run(e){const{renderer:n}=this;n.runners.init.emit(n.options),e.hello&&console.log(`PixiJS 7.4.2 - ${n.rendererLogId} - https://pixijs.com`),n.resize(n.screen.width,n.screen.height)}destroy(){}}wC.defaultOptions={hello:!1},wC.extension={type:[wt.RendererSystem,wt.CanvasRendererSystem],name:"startup"};Gt.add(wC);function aVe(r,e=[]){return e[di.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.ADD]=[r.ONE,r.ONE],e[di.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.NONE]=[0,0],e[di.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],e[di.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],e[di.SRC_IN]=[r.DST_ALPHA,r.ZERO],e[di.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],e[di.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],e[di.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],e[di.DST_IN]=[r.ZERO,r.SRC_ALPHA],e[di.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],e[di.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],e[di.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],e[di.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],e}const lVe=0,cVe=1,hVe=2,uVe=3,dVe=4,fVe=5,TK=class CR{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=di.NONE,this._blendEq=!1,this.map=[],this.map[lVe]=this.setBlend,this.map[cVe]=this.setOffset,this.map[hVe]=this.setCullFace,this.map[uVe]=this.setDepthTest,this.map[dVe]=this.setFrontFace,this.map[fVe]=this.setDepthMask,this.checks=[],this.defaultState=new Sc,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=aVe(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let n=this.stateId^e.data,i=0;for(;n;)n&1&&this.map[i].call(this,!!(e.data&1<<i)),n=n>>1,i++;this.stateId=e.data}for(let n=0;n<this.checks.length;n++)this.checks[n](this,e)}forceState(e){e=e||this.defaultState;for(let n=0;n<this.map.length;n++)this.map[n].call(this,!!(e.data&1<<n));for(let n=0;n<this.checks.length;n++)this.checks[n](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(CR.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(CR.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const n=this.blendModes[e],i=this.gl;n.length===2?i.blendFunc(n[0],n[1]):i.blendFuncSeparate(n[0],n[1],n[2],n[3]),n.length===6?(this._blendEq=!0,i.blendEquationSeparate(n[4],n[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(e,n){this.gl.polygonOffset(e,n)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,n){const i=this.checks.indexOf(e);n&&i===-1?this.checks.push(e):!n&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(e,n){e.setBlendMode(n.blendMode)}static checkPolygonOffset(e,n){e.setPolygonOffset(1,n.polygonOffset)}destroy(){this.gl=null}};TK.extension={type:wt.RendererSystem,name:"state"};let pVe=TK;Gt.add(pVe);class mVe extends rx{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const n=(e.priority??[]).filter(s=>e.systems[s]),i=[...n,...Object.keys(e.systems).filter(s=>!n.includes(s))];for(const s of i)this.addSystem(e.systems[s],s)}addRunners(...e){e.forEach(n=>{this.runners[n]=new pl(n)})}addSystem(e,n){const i=new e(this);if(this[n])throw new Error(`Whoops! The name "${n}" is already in use`);this[n]=i,this._systemsHash[n]=i;for(const s in this.runners)this.runners[s].add(i);return this}emitWithCustomOptions(e,n){const i=Object.keys(this._systemsHash);e.items.forEach(s=>{const o=i.find(a=>this._systemsHash[a]===s);s[e.name](n[o])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const jy=class eS{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=eS.defaultMaxIdle,this.checkCountMax=eS.defaultCheckCountMax,this.mode=eS.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==V5.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,n=e.managedTextures;let i=!1;for(let s=0;s<n.length;s++){const o=n[s];o.resource&&this.count-o.touched>this.maxIdle&&(e.destroyTexture(o,!0),n[s]=null,i=!0)}if(i){let s=0;for(let o=0;o<n.length;o++)n[o]!==null&&(n[s++]=n[o]);n.length=s}}unload(e){const n=this.renderer.texture,i=e._texture;i&&!i.framebuffer&&n.destroyTexture(i);for(let s=e.children.length-1;s>=0;s--)this.unload(e.children[s])}destroy(){this.renderer=null}};jy.defaultMode=V5.AUTO,jy.defaultMaxIdle=60*60,jy.defaultCheckCountMax=60*10,jy.extension={type:wt.RendererSystem,name:"textureGC"};let vf=jy;Gt.add(vf);class dk{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Jt.UNSIGNED_BYTE,this.internalFormat=rt.RGBA,this.samplerType=0}}function gVe(r){let e;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?e={[r.RGB]:At.FLOAT,[r.RGBA]:At.FLOAT,[r.ALPHA]:At.FLOAT,[r.LUMINANCE]:At.FLOAT,[r.LUMINANCE_ALPHA]:At.FLOAT,[r.R8]:At.FLOAT,[r.R8_SNORM]:At.FLOAT,[r.RG8]:At.FLOAT,[r.RG8_SNORM]:At.FLOAT,[r.RGB8]:At.FLOAT,[r.RGB8_SNORM]:At.FLOAT,[r.RGB565]:At.FLOAT,[r.RGBA4]:At.FLOAT,[r.RGB5_A1]:At.FLOAT,[r.RGBA8]:At.FLOAT,[r.RGBA8_SNORM]:At.FLOAT,[r.RGB10_A2]:At.FLOAT,[r.RGB10_A2UI]:At.FLOAT,[r.SRGB8]:At.FLOAT,[r.SRGB8_ALPHA8]:At.FLOAT,[r.R16F]:At.FLOAT,[r.RG16F]:At.FLOAT,[r.RGB16F]:At.FLOAT,[r.RGBA16F]:At.FLOAT,[r.R32F]:At.FLOAT,[r.RG32F]:At.FLOAT,[r.RGB32F]:At.FLOAT,[r.RGBA32F]:At.FLOAT,[r.R11F_G11F_B10F]:At.FLOAT,[r.RGB9_E5]:At.FLOAT,[r.R8I]:At.INT,[r.R8UI]:At.UINT,[r.R16I]:At.INT,[r.R16UI]:At.UINT,[r.R32I]:At.INT,[r.R32UI]:At.UINT,[r.RG8I]:At.INT,[r.RG8UI]:At.UINT,[r.RG16I]:At.INT,[r.RG16UI]:At.UINT,[r.RG32I]:At.INT,[r.RG32UI]:At.UINT,[r.RGB8I]:At.INT,[r.RGB8UI]:At.UINT,[r.RGB16I]:At.INT,[r.RGB16UI]:At.UINT,[r.RGB32I]:At.INT,[r.RGB32UI]:At.UINT,[r.RGBA8I]:At.INT,[r.RGBA8UI]:At.UINT,[r.RGBA16I]:At.INT,[r.RGBA16UI]:At.UINT,[r.RGBA32I]:At.INT,[r.RGBA32UI]:At.UINT,[r.DEPTH_COMPONENT16]:At.FLOAT,[r.DEPTH_COMPONENT24]:At.FLOAT,[r.DEPTH_COMPONENT32F]:At.FLOAT,[r.DEPTH_STENCIL]:At.FLOAT,[r.DEPTH24_STENCIL8]:At.FLOAT,[r.DEPTH32F_STENCIL8]:At.FLOAT}:e={[r.RGB]:At.FLOAT,[r.RGBA]:At.FLOAT,[r.ALPHA]:At.FLOAT,[r.LUMINANCE]:At.FLOAT,[r.LUMINANCE_ALPHA]:At.FLOAT,[r.DEPTH_STENCIL]:At.FLOAT},e}function vVe(r){let e;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?e={[Jt.UNSIGNED_BYTE]:{[rt.RGBA]:r.RGBA8,[rt.RGB]:r.RGB8,[rt.RG]:r.RG8,[rt.RED]:r.R8,[rt.RGBA_INTEGER]:r.RGBA8UI,[rt.RGB_INTEGER]:r.RGB8UI,[rt.RG_INTEGER]:r.RG8UI,[rt.RED_INTEGER]:r.R8UI,[rt.ALPHA]:r.ALPHA,[rt.LUMINANCE]:r.LUMINANCE,[rt.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[Jt.BYTE]:{[rt.RGBA]:r.RGBA8_SNORM,[rt.RGB]:r.RGB8_SNORM,[rt.RG]:r.RG8_SNORM,[rt.RED]:r.R8_SNORM,[rt.RGBA_INTEGER]:r.RGBA8I,[rt.RGB_INTEGER]:r.RGB8I,[rt.RG_INTEGER]:r.RG8I,[rt.RED_INTEGER]:r.R8I},[Jt.UNSIGNED_SHORT]:{[rt.RGBA_INTEGER]:r.RGBA16UI,[rt.RGB_INTEGER]:r.RGB16UI,[rt.RG_INTEGER]:r.RG16UI,[rt.RED_INTEGER]:r.R16UI,[rt.DEPTH_COMPONENT]:r.DEPTH_COMPONENT16},[Jt.SHORT]:{[rt.RGBA_INTEGER]:r.RGBA16I,[rt.RGB_INTEGER]:r.RGB16I,[rt.RG_INTEGER]:r.RG16I,[rt.RED_INTEGER]:r.R16I},[Jt.UNSIGNED_INT]:{[rt.RGBA_INTEGER]:r.RGBA32UI,[rt.RGB_INTEGER]:r.RGB32UI,[rt.RG_INTEGER]:r.RG32UI,[rt.RED_INTEGER]:r.R32UI,[rt.DEPTH_COMPONENT]:r.DEPTH_COMPONENT24},[Jt.INT]:{[rt.RGBA_INTEGER]:r.RGBA32I,[rt.RGB_INTEGER]:r.RGB32I,[rt.RG_INTEGER]:r.RG32I,[rt.RED_INTEGER]:r.R32I},[Jt.FLOAT]:{[rt.RGBA]:r.RGBA32F,[rt.RGB]:r.RGB32F,[rt.RG]:r.RG32F,[rt.RED]:r.R32F,[rt.DEPTH_COMPONENT]:r.DEPTH_COMPONENT32F},[Jt.HALF_FLOAT]:{[rt.RGBA]:r.RGBA16F,[rt.RGB]:r.RGB16F,[rt.RG]:r.RG16F,[rt.RED]:r.R16F},[Jt.UNSIGNED_SHORT_5_6_5]:{[rt.RGB]:r.RGB565},[Jt.UNSIGNED_SHORT_4_4_4_4]:{[rt.RGBA]:r.RGBA4},[Jt.UNSIGNED_SHORT_5_5_5_1]:{[rt.RGBA]:r.RGB5_A1},[Jt.UNSIGNED_INT_2_10_10_10_REV]:{[rt.RGBA]:r.RGB10_A2,[rt.RGBA_INTEGER]:r.RGB10_A2UI},[Jt.UNSIGNED_INT_10F_11F_11F_REV]:{[rt.RGB]:r.R11F_G11F_B10F},[Jt.UNSIGNED_INT_5_9_9_9_REV]:{[rt.RGB]:r.RGB9_E5},[Jt.UNSIGNED_INT_24_8]:{[rt.DEPTH_STENCIL]:r.DEPTH24_STENCIL8},[Jt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[rt.DEPTH_STENCIL]:r.DEPTH32F_STENCIL8}}:e={[Jt.UNSIGNED_BYTE]:{[rt.RGBA]:r.RGBA,[rt.RGB]:r.RGB,[rt.ALPHA]:r.ALPHA,[rt.LUMINANCE]:r.LUMINANCE,[rt.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[Jt.UNSIGNED_SHORT_5_6_5]:{[rt.RGB]:r.RGB},[Jt.UNSIGNED_SHORT_4_4_4_4]:{[rt.RGBA]:r.RGBA},[Jt.UNSIGNED_SHORT_5_5_5_1]:{[rt.RGBA]:r.RGBA}},e}class EK{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Oi,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=vVe(e),this.samplerTypes=gVe(e);const n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=n;for(let s=0;s<n;s++)this.boundTextures[s]=null;this.emptyTextures={};const i=new dk(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new dk(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(e,n=0){const{gl:i}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const s=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[n]!==e&&(this.currentLocation!==n&&(this.currentLocation=n,i.activeTexture(i.TEXTURE0+n)),i.bindTexture(e.target,s.texture)),s.dirtyId!==e.dirtyId?(this.currentLocation!==n&&(this.currentLocation=n,i.activeTexture(i.TEXTURE0+n)),this.updateTexture(e)):s.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[n]=e}else this.currentLocation!==n&&(this.currentLocation=n,i.activeTexture(i.TEXTURE0+n)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[n]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:n,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<i.length;s++)i[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<i.length;s++)i[s]===e&&(this.currentLocation!==s&&(n.activeTexture(n.TEXTURE0+s),this.currentLocation=s),n.bindTexture(e.target,this.emptyTextures[e.target].texture),i[s]=null)}ensureSamplerType(e){const{boundTextures:n,hasIntegerTextures:i,CONTEXT_UID:s}=this;if(i)for(let o=e-1;o>=0;--o){const a=n[o];a&&a._glTextures[s].samplerType!==At.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(e){const n=new dk(this.gl.createTexture());return n.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=n,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),n}initTextureType(e,n){var i;n.internalFormat=((i=this.internalFormats[e.type])==null?void 0:i[e.format])??e.format,n.samplerType=this.samplerTypes[n.internalFormat]??At.FLOAT,this.webGLVersion===2&&e.type===Jt.HALF_FLOAT?n.type=this.gl.HALF_FLOAT:n.type=e.type}updateTexture(e){var s;const n=e._glTextures[this.CONTEXT_UID];if(!n)return;const i=this.renderer;if(this.initTextureType(e,n),(s=e.resource)==null?void 0:s.upload(i,e,n))n.samplerType!==At.FLOAT&&(this.hasIntegerTextures=!0);else{const o=e.realWidth,a=e.realHeight,l=i.gl;(n.width!==o||n.height!==a||n.dirtyId<0)&&(n.width=o,n.height=a,l.texImage2D(e.target,0,n.internalFormat,o,a,0,e.format,n.type,null))}e.dirtyStyleId!==n.dirtyStyleId&&this.updateTextureStyle(e),n.dirtyId=e.dirtyId}destroyTexture(e,n){const{gl:i}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!n)){const s=this.managedTextures.indexOf(e);s!==-1&&Tg(this.managedTextures,s,1)}}updateTextureStyle(e){var i;const n=e._glTextures[this.CONTEXT_UID];n&&((e.mipmap===yc.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?n.mipmap=!1:n.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?n.wrapMode=Zu.CLAMP:n.wrapMode=e.wrapMode,(i=e.resource)!=null&&i.style(this.renderer,e,n)||this.setStyle(e,n),n.dirtyStyleId=e.dirtyStyleId)}setStyle(e,n){const i=this.gl;if(n.mipmap&&e.mipmap!==yc.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,n.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,n.wrapMode),n.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===oh.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const s=this.renderer.context.extensions.anisotropicFiltering;if(s&&e.anisotropicLevel>0&&e.scaleMode===oh.LINEAR){const o=Math.min(e.anisotropicLevel,i.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,s.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===oh.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===oh.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}EK.extension={type:wt.RendererSystem,name:"texture"};Gt.add(EK);class MK{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:n,CONTEXT_UID:i}=this,s=e._glTransformFeedbacks[i]||this.createGLTransformFeedback(e);n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,s)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,n){const{gl:i,renderer:s}=this;n&&s.shader.bind(n),i.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:n,renderer:i,CONTEXT_UID:s}=this,o=n.createTransformFeedback();e._glTransformFeedbacks[s]=o,n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,o);for(let a=0;a<e.buffers.length;a++){const l=e.buffers[a];l&&(i.buffer.update(l),l._glBuffers[s].refCount++,n.bindBufferBase(n.TRANSFORM_FEEDBACK_BUFFER,a,l._glBuffers[s].buffer||null))}return n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),o}disposeTransformFeedback(e,n){const i=e._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;e.disposeRunner.remove(this);const o=this.renderer.buffer;if(o)for(let a=0;a<e.buffers.length;a++){const l=e.buffers[a];if(!l)continue;const h=l._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!n&&o.dispose(l,n))}i&&(n||s.deleteTransformFeedback(i),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}MK.extension={type:wt.RendererSystem,name:"transformFeedback"};Gt.add(MK);class _C{constructor(e){this.renderer=e}init(e){this.screen=new ki(0,0,e.width,e.height),this.element=e.view||kt.ADAPTER.createCanvas(),this.resolution=e.resolution||kt.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,n){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(n*this.resolution);const i=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=i,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",i,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var n;e&&((n=this.element.parentNode)==null||n.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}_C.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},_C.extension={type:[wt.RendererSystem,wt.CanvasRendererSystem],name:"_view"};Gt.add(_C);kt.PREFER_ENV=Pp.WEBGL2;kt.STRICT_TEXTURE_CACHE=!1;kt.RENDER_OPTIONS={...xC.defaultOptions,...bC.defaultOptions,..._C.defaultOptions,...wC.defaultOptions};Object.defineProperties(kt,{WRAP_MODE:{get(){return Oi.defaultOptions.wrapMode},set(r){Xi("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Oi.defaultOptions.wrapMode=r}},SCALE_MODE:{get(){return Oi.defaultOptions.scaleMode},set(r){Xi("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Oi.defaultOptions.scaleMode=r}},MIPMAP_TEXTURES:{get(){return Oi.defaultOptions.mipmap},set(r){Xi("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Oi.defaultOptions.mipmap=r}},ANISOTROPIC_LEVEL:{get(){return Oi.defaultOptions.anisotropicLevel},set(r){Xi("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Oi.defaultOptions.anisotropicLevel=r}},FILTER_RESOLUTION:{get(){return Xi("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Zs.defaultResolution},set(r){Zs.defaultResolution=r}},FILTER_MULTISAMPLE:{get(){return Xi("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Zs.defaultMultisample},set(r){Zs.defaultMultisample=r}},SPRITE_MAX_TEXTURES:{get(){return gf.defaultMaxTextures},set(r){Xi("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),gf.defaultMaxTextures=r}},SPRITE_BATCH_SIZE:{get(){return gf.defaultBatchSize},set(r){Xi("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),gf.defaultBatchSize=r}},CAN_UPLOAD_SAME_BUFFER:{get(){return gf.canUploadSameBuffer},set(r){Xi("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),gf.canUploadSameBuffer=r}},GC_MODE:{get(){return vf.defaultMode},set(r){Xi("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),vf.defaultMode=r}},GC_MAX_IDLE:{get(){return vf.defaultMaxIdle},set(r){Xi("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),vf.defaultMaxIdle=r}},GC_MAX_CHECK_COUNT:{get(){return vf.defaultCheckCountMax},set(r){Xi("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),vf.defaultCheckCountMax=r}},PRECISION_VERTEX:{get(){return ch.defaultVertexPrecision},set(r){Xi("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),ch.defaultVertexPrecision=r}},PRECISION_FRAGMENT:{get(){return ch.defaultFragmentPrecision},set(r){Xi("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),ch.defaultFragmentPrecision=r}}});var vp=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(vp||{});class fk{constructor(e,n=null,i=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=n,this.priority=i,this.once=s}match(e,n=null){return this.fn===e&&this.context===n}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const n=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),n}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const n=this.next;return this.next=e?null:n,this.previous=null,n}}const AK=class Go{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new fk(null,null,1/0),this.deltaMS=1/Go.targetFPMS,this.elapsedMS=1/Go.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,n,i=vp.NORMAL){return this._addListener(new fk(e,n,i))}addOnce(e,n,i=vp.NORMAL){return this._addListener(new fk(e,n,i,!0))}_addListener(e){let n=this._head.next,i=this._head;if(!n)e.connect(i);else{for(;n;){if(e.priority>n.priority){e.connect(i);break}i=n,n=n.next}e.previous||e.connect(i)}return this._startIfPossible(),this}remove(e,n){let i=this._head.next;for(;i;)i.match(e,n)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,n=this._head;for(;n=n.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let n;if(e>this.lastTime){if(n=this.elapsedMS=e-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),n*=this.speed,this._minElapsedMS){const o=e-this._lastFrame|0;if(o<this._minElapsedMS)return;this._lastFrame=e-o%this._minElapsedMS}this.deltaMS=n,this.deltaTime=this.deltaMS*Go.targetFPMS;const i=this._head;let s=i.next;for(;s;)s=s.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const n=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,n)/1e3,Go.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const n=Math.max(this.minFPS,e);this._minElapsedMS=1/(n/1e3)}}static get shared(){if(!Go._shared){const e=Go._shared=new Go;e.autoStart=!0,e._protected=!0}return Go._shared}static get system(){if(!Go._system){const e=Go._system=new Go;e.autoStart=!0,e._protected=!0}return Go._system}};AK.targetFPMS=.06;let ia=AK;Object.defineProperties(kt,{TARGET_FPMS:{get(){return ia.targetFPMS},set(r){Xi("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ia.targetFPMS=r}}});class kK{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(n){this._ticker&&this._ticker.remove(this.render,this),this._ticker=n,n&&n.add(this.render,this,vp.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?ia.shared:new ia,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}kK.extension=wt.Application;Gt.add(kK);const PK=[];Gt.handleByList(wt.Renderer,PK);function yVe(r){for(const e of PK)if(e.test(r))return new e(r);throw new Error("Unable to auto-detect a suitable renderer.")}var bVe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,xVe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const wVe=bVe,RK=xVe;class IK{constructor(e){this.renderer=e}contextChange(e){let n;if(this.renderer.context.webGLVersion===1){const i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),n=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{const i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),n=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}n>=Sr.HIGH?this.multisample=Sr.HIGH:n>=Sr.MEDIUM?this.multisample=Sr.MEDIUM:n>=Sr.LOW?this.multisample=Sr.LOW:this.multisample=Sr.NONE}destroy(){}}IK.extension={type:wt.RendererSystem,name:"_multisample"};Gt.add(IK);class _Ve{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class NK{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:n,CONTEXT_UID:i}=this,s=e._glBuffers[i]||this.createGLBuffer(e);n.bindBuffer(e.type,s.buffer)}unbind(e){const{gl:n}=this;n.bindBuffer(e,null)}bindBufferBase(e,n){const{gl:i,CONTEXT_UID:s}=this;if(this.boundBufferBases[n]!==e){const o=e._glBuffers[s]||this.createGLBuffer(e);this.boundBufferBases[n]=e,i.bindBufferBase(i.UNIFORM_BUFFER,n,o.buffer)}}bindBufferRange(e,n,i){const{gl:s,CONTEXT_UID:o}=this;i=i||0;const a=e._glBuffers[o]||this.createGLBuffer(e);s.bindBufferRange(s.UNIFORM_BUFFER,n||0,a.buffer,i*256,256)}update(e){const{gl:n,CONTEXT_UID:i}=this,s=e._glBuffers[i]||this.createGLBuffer(e);if(e._updateID!==s.updateID)if(s.updateID=e._updateID,n.bindBuffer(e.type,s.buffer),s.byteLength>=e.data.byteLength)n.bufferSubData(e.type,0,e.data);else{const o=e.static?n.STATIC_DRAW:n.DYNAMIC_DRAW;s.byteLength=e.data.byteLength,n.bufferData(e.type,e.data,o)}}dispose(e,n){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const i=e._glBuffers[this.CONTEXT_UID],s=this.gl;e.disposeRunner.remove(this),i&&(n||s.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const n=Object.keys(this.managedBuffers);for(let i=0;i<n.length;i++)this.dispose(this.managedBuffers[n[i]],e)}createGLBuffer(e){const{CONTEXT_UID:n,gl:i}=this;return e._glBuffers[n]=new _Ve(i.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[n]}}NK.extension={type:wt.RendererSystem,name:"buffer"};Gt.add(NK);class DK{constructor(e){this.renderer=e}render(e,n){const i=this.renderer;let s,o,a,l;if(n&&(s=n.renderTexture,o=n.clear,a=n.transform,l=n.skipUpdateTransform),this.renderingToScreen=!s,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=a,!i.context.isLost){if(s||(this.lastObjectRendered=e),!l){const h=e.enableTempParent();e.updateTransform(),e.disableTempParent(h)}i.renderTexture.bind(s),i.batch.currentRenderer.start(),(o??i.background.clearBeforeRender)&&i.renderTexture.clear(),e.render(i),i.batch.currentRenderer.flush(),s&&(n.blit&&i.framebuffer.blit(),s.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}DK.extension={type:wt.RendererSystem,name:"objectRenderer"};Gt.add(DK);const tS=class TR extends mVe{constructor(e){super(),this.type=yZ.WEBGL,e=Object.assign({},kt.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ml({projectionMatrix:new Fn},!0);const n={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:TR.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(n),"useContextAlpha"in e&&(Xi("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=TR.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:G$e()}render(e,n){this.objectRenderer.render(e,n)}resize(e,n){this._view.resizeView(e,n)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Xi("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Xi("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Xi("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Xi("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Xi("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Xi("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Xi("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Xi("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,n){return this.textureGenerator.generateTexture(e,n)}};tS.extension={type:wt.Renderer,priority:1},tS.__plugins={},tS.__systems={};let q5=tS;Gt.handleByMap(wt.RendererPlugin,q5.__plugins);Gt.handleByMap(wt.RendererSystem,q5.__systems);Gt.add(q5);class LK extends vb{constructor(e,n){const{width:i,height:s}=n||{};super(i,s),this.items=[],this.itemDirtyIds=[];for(let o=0;o<e;o++){const a=new Oi;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,n){for(let i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof vb?this.addResourceAt(e[i],i):this.addResourceAt(eK(e[i],n),i))}dispose(){for(let e=0,n=this.length;e<n;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,n){if(!this.items[n])throw new Error(`Index ${n} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[n].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)}unbind(e){super.unbind(e);for(let n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(n=>n.resource).filter(n=>n).map(n=>n.load());return this._load=Promise.all(e).then(()=>{const{realWidth:n,realHeight:i}=this.items[0];return this.resize(n,i),this.update(),Promise.resolve(this)}),this._load}}class OVe extends LK{constructor(e,n){const{width:i,height:s}=n||{};let o,a;Array.isArray(e)?(o=e,a=e.length):a=e,super(a,{width:i,height:s}),o&&this.initFromArray(o,n)}addBaseTextureAt(e,n){if(e.resource)this.addResourceAt(e.resource,n);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Og.TEXTURE_2D_ARRAY}upload(e,n,i){const{length:s,itemDirtyIds:o,items:a}=this,{gl:l}=e;i.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,s,0,n.format,i.type,null);for(let h=0;h<s;h++){const u=a[h];o[h]<u.dirtyId&&(o[h]=u.dirtyId,u.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,h,u.resource.width,u.resource.height,1,n.format,i.type,u.resource.source))}return!0}}class SVe extends kh{constructor(e){super(e)}static test(e){const{OffscreenCanvas:n}=globalThis;return n&&e instanceof n?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const BK=class Yy extends LK{constructor(e,n){const{width:i,height:s,autoLoad:o,linkBaseTexture:a}=n||{};if(e&&e.length!==Yy.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:i,height:s});for(let l=0;l<Yy.SIDES;l++)this.items[l].target=Og.TEXTURE_CUBE_MAP_POSITIVE_X+l;this.linkBaseTexture=a!==!1,e&&this.initFromArray(e,n),o!==!1&&this.load()}bind(e){super.bind(e),e.target=Og.TEXTURE_CUBE_MAP}addBaseTextureAt(e,n,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[n])throw new Error(`Index ${n} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,n);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Og.TEXTURE_CUBE_MAP_POSITIVE_X+n,e.parentTextureArray=this.baseTexture,this.items[n]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[n]=e,this}upload(e,n,i){const s=this.itemDirtyIds;for(let o=0;o<Yy.SIDES;o++){const a=this.items[o];(s[o]<a.dirtyId||i.dirtyId<n.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(e,a,i),s[o]=a.dirtyId):s[o]<-1&&(e.gl.texImage2D(a.target,0,i.internalFormat,n.realWidth,n.realHeight,0,n.format,i.type,null),s[o]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Yy.SIDES}};BK.SIDES=6;let CVe=BK;class eg extends kh{constructor(e,n){n=n||{};let i,s,o;typeof e=="string"?(i=eg.EMPTY,s=e,o=!0):(i=e,s=null,o=!1),super(i),this.url=s,this.crossOrigin=n.crossOrigin??!0,this.alphaMode=typeof n.alphaMode=="number"?n.alphaMode:null,this.ownsImageBitmap=n.ownsImageBitmap??o,this._load=null,n.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,n)=>{if(this.url===null){e(this);return}try{const i=await kt.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const s=await i.blob();if(this.destroyed)return;const o=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===To.UNPACK?"premultiply":"none"});if(this.destroyed){o.close();return}this.source=o,this.update(),e(this)}catch(i){if(this.destroyed)return;n(i),this.onError.emit(i)}}),this._load)}upload(e,n,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(n.alphaMode=this.alphaMode),super.upload(e,n,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return eg._EMPTY=eg._EMPTY??kt.ADAPTER.createCanvas(0,0),eg._EMPTY}}const ER=class iS extends kh{constructor(e,n){n=n||{},super(kt.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=n.scale||1,this._overrideWidth=n.width,this._overrideHeight=n.height,this._resolve=null,this._crossorigin=n.crossorigin,this._load=null,n.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},iS.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;kh.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=n=>{this._resolve&&(e.onerror=null,this.onError.emit(n))},e.onload=()=>{if(!this._resolve)return;const n=e.width,i=e.height;if(!n||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=n*this.scale,o=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/i*n,o=this._overrideHeight||this._overrideWidth/n*i),s=Math.round(s),o=Math.round(o);const a=this.source;a.width=s,a.height=o,a._pixiId=`canvas_${gp()}`,a.getContext("2d").drawImage(e,0,0,n,i,0,0,s,o),this._resolve(),this._resolve=null}}static getSize(e){const n=iS.SVG_SIZE.exec(e),i={};return n&&(i[n[1]]=Math.round(parseFloat(n[3])),i[n[5]]=Math.round(parseFloat(n[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,n){return n==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&iS.SVG_XML.test(e)}};ER.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,ER.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let MR=ER;class TVe extends kh{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const AR=class kR extends kh{constructor(e,n){if(n=n||{},!(e instanceof HTMLVideoElement)){const i=document.createElement("video");n.autoLoad!==!1&&i.setAttribute("preload","auto"),n.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),n.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),n.loop===!0&&i.setAttribute("loop",""),n.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const s=e[0].src||e[0];kh.crossOrigin(i,s,n.crossorigin);for(let o=0;o<e.length;++o){const a=document.createElement("source");let{src:l,mime:h}=e[o];if(l=l||e[o],l.startsWith("data:"))h=l.slice(5,l.indexOf(";"));else if(!l.startsWith("blob:")){const u=l.split("?").shift().toLowerCase(),f=u.slice(u.lastIndexOf(".")+1);h=h||kR.MIME_TYPES[f]||`video/${f}`}a.src=l,h&&(a.type=h),i.appendChild(a)}e=i}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=n.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=n.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),n.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const n=ia.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((n,i)=>{this.valid?n(this):(this._resolve=n,this._reject=i,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const n=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!n&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ia.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ia.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ia.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,n){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||kR.TYPES.includes(n)}};AR.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],AR.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let $K=AR;gR.push(eg,cK,SVe,$K,TVe,MR,nT,CVe,OVe);class OC{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?ki.EMPTY:(e=e||new ki(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,n){const{a:i,b:s,c:o,d:a,tx:l,ty:h}=e,u=i*n.x+o*n.y+l,f=s*n.x+a*n.y+h;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,f),this.maxY=Math.max(this.maxY,f)}addQuad(e){let n=this.minX,i=this.minY,s=this.maxX,o=this.maxY,a=e[0],l=e[1];n=a<n?a:n,i=l<i?l:i,s=a>s?a:s,o=l>o?l:o,a=e[2],l=e[3],n=a<n?a:n,i=l<i?l:i,s=a>s?a:s,o=l>o?l:o,a=e[4],l=e[5],n=a<n?a:n,i=l<i?l:i,s=a>s?a:s,o=l>o?l:o,a=e[6],l=e[7],n=a<n?a:n,i=l<i?l:i,s=a>s?a:s,o=l>o?l:o,this.minX=n,this.minY=i,this.maxX=s,this.maxY=o}addFrame(e,n,i,s,o){this.addFrameMatrix(e.worldTransform,n,i,s,o)}addFrameMatrix(e,n,i,s,o){const a=e.a,l=e.b,h=e.c,u=e.d,f=e.tx,p=e.ty;let m=this.minX,v=this.minY,y=this.maxX,x=this.maxY,w=a*n+h*i+f,S=l*n+u*i+p;m=w<m?w:m,v=S<v?S:v,y=w>y?w:y,x=S>x?S:x,w=a*s+h*i+f,S=l*s+u*i+p,m=w<m?w:m,v=S<v?S:v,y=w>y?w:y,x=S>x?S:x,w=a*n+h*o+f,S=l*n+u*o+p,m=w<m?w:m,v=S<v?S:v,y=w>y?w:y,x=S>x?S:x,w=a*s+h*o+f,S=l*s+u*o+p,m=w<m?w:m,v=S<v?S:v,y=w>y?w:y,x=S>x?S:x,this.minX=m,this.minY=v,this.maxX=y,this.maxY=x}addVertexData(e,n,i){let s=this.minX,o=this.minY,a=this.maxX,l=this.maxY;for(let h=n;h<i;h+=2){const u=e[h],f=e[h+1];s=u<s?u:s,o=f<o?f:o,a=u>a?u:a,l=f>l?f:l}this.minX=s,this.minY=o,this.maxX=a,this.maxY=l}addVertices(e,n,i,s){this.addVerticesMatrix(e.worldTransform,n,i,s)}addVerticesMatrix(e,n,i,s,o=0,a=o){const l=e.a,h=e.b,u=e.c,f=e.d,p=e.tx,m=e.ty;let v=this.minX,y=this.minY,x=this.maxX,w=this.maxY;for(let S=i;S<s;S+=2){const O=n[S],_=n[S+1],T=l*O+u*_+p,A=f*_+h*O+m;v=Math.min(v,T-o),x=Math.max(x,T+o),y=Math.min(y,A-a),w=Math.max(w,A+a)}this.minX=v,this.minY=y,this.maxX=x,this.maxY=w}addBounds(e){const n=this.minX,i=this.minY,s=this.maxX,o=this.maxY;this.minX=e.minX<n?e.minX:n,this.minY=e.minY<i?e.minY:i,this.maxX=e.maxX>s?e.maxX:s,this.maxY=e.maxY>o?e.maxY:o}addBoundsMask(e,n){const i=e.minX>n.minX?e.minX:n.minX,s=e.minY>n.minY?e.minY:n.minY,o=e.maxX<n.maxX?e.maxX:n.maxX,a=e.maxY<n.maxY?e.maxY:n.maxY;if(i<=o&&s<=a){const l=this.minX,h=this.minY,u=this.maxX,f=this.maxY;this.minX=i<l?i:l,this.minY=s<h?s:h,this.maxX=o>u?o:u,this.maxY=a>f?a:f}}addBoundsMatrix(e,n){this.addFrameMatrix(n,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,n){const i=e.minX>n.x?e.minX:n.x,s=e.minY>n.y?e.minY:n.y,o=e.maxX<n.x+n.width?e.maxX:n.x+n.width,a=e.maxY<n.y+n.height?e.maxY:n.y+n.height;if(i<=o&&s<=a){const l=this.minX,h=this.minY,u=this.maxX,f=this.maxY;this.minX=i<l?i:l,this.minY=s<h?s:h,this.maxX=o>u?o:u,this.maxY=a>f?a:f}}pad(e=0,n=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=n,this.maxY+=n)}addFramePad(e,n,i,s,o,a){e-=o,n-=a,i+=o,s+=a,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<n?this.minY:n,this.maxY=this.maxY>s?this.maxY:s}}class Zn extends rx{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new j5,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new OC,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const n=Object.keys(e);for(let i=0;i<n.length;++i){const s=n[i];Object.defineProperty(Zn.prototype,s,Object.getOwnPropertyDescriptor(e,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,n){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),n||(this._boundsRect||(this._boundsRect=new ki),n=this._boundsRect),this._bounds.getRectangle(n)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new ki),e=this._localBoundsRect),this._localBounds||(this._localBounds=new OC);const n=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(i==null?void 0:i.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,o=this._boundsID;this._bounds=this._localBounds;const a=this.getBounds(!1,e);return this.parent=i,this.transform=n,this._bounds=s,this._bounds.updateID+=this._boundsID-o,a}toGlobal(e,n,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,n)}toLocal(e,n,i,s){return n&&(e=n.toGlobal(e,i,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,i)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,n=0,i=1,s=1,o=0,a=0,l=0,h=0,u=0){return this.position.x=e,this.position.y=n,this.scale.x=i||1,this.scale.y=s||1,this.rotation=o,this.skew.x=a,this.skew.y=l,this.pivot.x=h,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new EVe),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*bUe}set angle(e){this.transform.rotation=e*xUe}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const n=this._mask.isMaskData?this._mask.maskObject:this._mask;n&&(n._maskRefCount--,n._maskRefCount===0&&(n.renderable=!0,n.isMask=!1))}if(this._mask=e,this._mask){const n=this._mask.isMaskData?this._mask.maskObject:this._mask;n&&(n._maskRefCount===0&&(n.renderable=!1,n.isMask=!0),n._maskRefCount++)}}}}class EVe extends Zn{constructor(){super(...arguments),this.sortDirty=null}}Zn.prototype.displayObjectUpdateTransform=Zn.prototype.updateTransform;const MVe=new Fn;function AVe(r,e){return r.zIndex===e.zIndex?r._lastSortedIndex-e._lastSortedIndex:r.zIndex-e.zIndex}const UK=class PR extends Zn{constructor(){super(),this.children=[],this.sortableChildren=PR.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let n=0;n<e.length;n++)this.addChild(e[n]);else{const n=e[0];n.parent&&n.parent.removeChild(n),n.parent=this,this.sortDirty=!0,n.transform._parentID=-1,this.children.push(n),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",n,this,this.children.length-1),n.emit("added",this)}return e[0]}addChildAt(e,n){if(n<0||n>this.children.length)throw new Error(`${e}addChildAt: The index ${n} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(n,0,e),this._boundsID++,this.onChildrenChange(n),e.emit("added",this),this.emit("childAdded",e,this,n),e}swapChildren(e,n){if(e===n)return;const i=this.getChildIndex(e),s=this.getChildIndex(n);this.children[i]=n,this.children[s]=e,this.onChildrenChange(i<s?i:s)}getChildIndex(e){const n=this.children.indexOf(e);if(n===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return n}setChildIndex(e,n){if(n<0||n>=this.children.length)throw new Error(`The index ${n} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(e);Tg(this.children,i,1),this.children.splice(n,0,e),this.onChildrenChange(n)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let n=0;n<e.length;n++)this.removeChild(e[n]);else{const n=e[0],i=this.children.indexOf(n);if(i===-1)return null;n.parent=null,n.transform._parentID=-1,Tg(this.children,i,1),this._boundsID++,this.onChildrenChange(i),n.emit("removed",this),this.emit("childRemoved",n,this,i)}return e[0]}removeChildAt(e){const n=this.getChildAt(e);return n.parent=null,n.transform._parentID=-1,Tg(this.children,e,1),this._boundsID++,this.onChildrenChange(e),n.emit("removed",this),this.emit("childRemoved",n,this,e),n}removeChildren(e=0,n=this.children.length){const i=e,s=n,o=s-i;let a;if(o>0&&o<=s){a=this.children.splice(i,o);for(let l=0;l<a.length;++l)a[l].parent=null,a[l].transform&&(a[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let l=0;l<a.length;++l)a[l].emit("removed",this),this.emit("childRemoved",a[l],this,l);return a}else if(o===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let n=0,i=this.children.length;n<i;++n){const s=this.children[n];s._lastSortedIndex=n,!e&&s.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(AVe),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,n=this.children.length;e<n;++e){const i=this.children[e];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const n=this.children[e];if(!(!n.visible||!n.renderable))if(n.calculateBounds(),n._mask){const i=n._mask.isMaskData?n._mask.maskObject:n._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(n._bounds,i._bounds)):this._bounds.addBounds(n._bounds)}else n.filterArea?this._bounds.addBoundsArea(n._bounds,n.filterArea):this._bounds.addBounds(n._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,n=!1){const i=super.getLocalBounds(e);if(!n)for(let s=0,o=this.children.length;s<o;++s){const a=this.children[s];a.visible&&a.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(e){const n=e.renderTexture.sourceFrame;if(!(n.width>0&&n.height>0))return;let i,s;this.cullArea?(i=this.cullArea,s=this.worldTransform):this._render!==PR.prototype._render&&(i=this.getBounds(!0));const o=e.projection.transform;if(o&&(s?(s=MVe.copyFrom(s),s.prepend(o)):s=o),i&&n.intersects(i,s))this._render(e);else if(this.cullArea)return;for(let a=0,l=this.children.length;a<l;++a){const h=this.children[a],u=h.cullable;h.cullable=u||!this.cullArea,h.render(e),h.cullable=u}}render(e){var n;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(n=this.filters)!=null&&n.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let i=0,s=this.children.length;i<s;++i)this.children[i].render(e)}}renderAdvanced(e){var o,a,l;const n=this.filters,i=this._mask;if(n){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let h=0;h<n.length;h++)n[h].enabled&&this._enabledFilters.push(n[h])}const s=n&&((o=this._enabledFilters)==null?void 0:o.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==Lr.NONE));if(s&&e.batch.flush(),n&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.push(this,this._enabledFilters),i&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let h=0,u=this.children.length;h<u;++h)this.children[h].render(e)}s&&e.batch.flush(),i&&e.mask.pop(this),n&&((l=this._enabledFilters)!=null&&l.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const n=typeof e=="boolean"?e:e==null?void 0:e.children,i=this.removeChildren(0,this.children.length);if(n)for(let s=0;s<i.length;++s)i[s].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const n=this.getLocalBounds().width;n!==0?this.scale.x=e/n:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const n=this.getLocalBounds().height;n!==0?this.scale.y=e/n:this.scale.y=1,this._height=e}};UK.defaultSortableChildren=!1;let ss=UK;ss.prototype.containerUpdateTransform=ss.prototype.updateTransform;Object.defineProperties(kt,{SORTABLE_CHILDREN:{get(){return ss.defaultSortableChildren},set(r){Xi("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),ss.defaultSortableChildren=r}}});const Sy=new hi,kVe=new Uint16Array([0,1,2,0,2,3]);class sa extends ss{constructor(e){super(),this._anchor=new lh(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Un(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=di.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||Wt.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=kVe,this.pluginName="batch",this.isSprite=!0,this._roundPixels=kt.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Wu(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Wu(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const n=this.transform.worldTransform,i=n.a,s=n.b,o=n.c,a=n.d,l=n.tx,h=n.ty,u=this.vertexData,f=e.trim,p=e.orig,m=this._anchor;let v=0,y=0,x=0,w=0;if(f?(y=f.x-m._x*p.width,v=y+f.width,w=f.y-m._y*p.height,x=w+f.height):(y=-m._x*p.width,v=y+p.width,w=-m._y*p.height,x=w+p.height),u[0]=i*y+o*w+l,u[1]=a*w+s*y+h,u[2]=i*v+o*w+l,u[3]=a*w+s*v+h,u[4]=i*v+o*x+l,u[5]=a*x+s*v+h,u[6]=i*y+o*x+l,u[7]=a*x+s*y+h,this._roundPixels){const S=kt.RESOLUTION;for(let O=0;O<u.length;++O)u[O]=Math.round(u[O]*S)/S}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,n=this.vertexTrimmedData,i=e.orig,s=this._anchor,o=this.transform.worldTransform,a=o.a,l=o.b,h=o.c,u=o.d,f=o.tx,p=o.ty,m=-s._x*i.width,v=m+i.width,y=-s._y*i.height,x=y+i.height;if(n[0]=a*m+h*y+f,n[1]=u*y+l*m+p,n[2]=a*v+h*y+f,n[3]=u*y+l*v+p,n[4]=a*v+h*x+f,n[5]=u*x+l*v+p,n[6]=a*m+h*x+f,n[7]=u*x+l*m+p,this._roundPixels){const w=kt.RESOLUTION;for(let S=0;S<n.length;++S)n[S]=Math.round(n[S]*w)/w}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,n=this._texture.orig;!e||e.width===n.width&&e.height===n.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new OC),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new ki),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,Sy);const n=this._texture.orig.width,i=this._texture.orig.height,s=-n*this.anchor.x;let o=0;return Sy.x>=s&&Sy.x<s+n&&(o=-i*this.anchor.y,Sy.y>=o&&Sy.y<o+i)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const n=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!n)}this._texture=null}static from(e,n){const i=e instanceof Wt?e:Wt.from(e,n);return new sa(i)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const n=Wu(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const n=Wu(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Wt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const VK=new Fn;Zn.prototype._cacheAsBitmap=!1;Zn.prototype._cacheData=null;Zn.prototype._cacheAsBitmapResolution=null;Zn.prototype._cacheAsBitmapMultisample=null;class PVe{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Zn.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(r){r!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(r){if(this._cacheAsBitmap===r)return;this._cacheAsBitmap=r;let e;r?(this._cacheData||(this._cacheData=new PVe),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});Zn.prototype._renderCached=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(r),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(r))};Zn.prototype._initCachedDisplayObject=function(r){var m,v;if((m=this._cacheData)!=null&&m.sprite)return;const e=this.alpha;this.alpha=1,r.batch.flush();const n=this.getLocalBounds(new ki,!0);if((v=this.filters)!=null&&v.length){const y=this.filters[0].padding;n.pad(y)}const i=this.cacheAsBitmapResolution||r.resolution;n.ceil(i),n.width=Math.max(n.width,1/i),n.height=Math.max(n.height,1/i);const s=r.renderTexture.current,o=r.renderTexture.sourceFrame.clone(),a=r.renderTexture.destinationFrame.clone(),l=r.projection.transform,h=Rp.create({width:n.width,height:n.height,resolution:i,multisample:this.cacheAsBitmapMultisample??r.multisample}),u=`cacheAsBitmap_${gp()}`;this._cacheData.textureCacheId=u,Oi.addToCache(h.baseTexture,u),Wt.addToCache(h,u);const f=this.transform.localTransform.copyTo(VK).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,r.render(this,{renderTexture:h,clear:!0,transform:f,skipUpdateTransform:!1}),r.framebuffer.blit(),r.projection.transform=l,r.renderTexture.bind(s,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const p=new sa(h);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-(n.x/n.width),p.anchor.y=-(n.y/n.height),p.alpha=e,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=p.containsPoint.bind(p)};Zn.prototype._renderCachedCanvas=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(r),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(r))};Zn.prototype._initCachedDisplayObjectCanvas=function(r){var f;if((f=this._cacheData)!=null&&f.sprite)return;const e=this.getLocalBounds(new ki,!0),n=this.alpha;this.alpha=1;const i=r.canvasContext.activeContext,s=r._projTransform,o=this.cacheAsBitmapResolution||r.resolution;e.ceil(o),e.width=Math.max(e.width,1/o),e.height=Math.max(e.height,1/o);const a=Rp.create({width:e.width,height:e.height,resolution:o}),l=`cacheAsBitmap_${gp()}`;this._cacheData.textureCacheId=l,Oi.addToCache(a.baseTexture,l),Wt.addToCache(a,l);const h=VK;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=e.x,h.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,r.render(this,{renderTexture:a,clear:!0,transform:h,skipUpdateTransform:!1}),r.canvasContext.activeContext=i,r._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const u=new sa(a);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=n,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=r._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};Zn.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Zn.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Zn.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Oi.removeFromCache(this._cacheData.textureCacheId),Wt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Zn.prototype._cacheAsBitmapDestroy=function(r){this.cacheAsBitmap=!1,this.destroy(r)};Zn.prototype.name=null;ss.prototype.getChildByName=function(r,e){for(let n=0,i=this.children.length;n<i;n++)if(this.children[n].name===r)return this.children[n];if(e)for(let n=0,i=this.children.length;n<i;n++){const s=this.children[n];if(!s.getChildByName)continue;const o=s.getChildByName(r,!0);if(o)return o}return null};Zn.prototype.getGlobalPosition=function(r=new hi,e=!1){return this.parent?this.parent.toGlobal(this.position,r,e):(r.x=this.position.x,r.y=this.position.y),r};var RVe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class IVe extends Zs{constructor(e=1){super(wVe,RVe,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const NVe={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},DVe=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function LVe(r){const e=NVe[r],n=e.length;let i=DVe,s="";const o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let a;for(let l=0;l<r;l++){let h=o.replace("%index%",l.toString());a=l,l>=n&&(a=r-l-1),h=h.replace("%value%",e[a].toString()),s+=h,s+=`
`}return i=i.replace("%blur%",s),i=i.replace("%size%",r.toString()),i}const BVe=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function $Ve(r,e){const n=Math.ceil(r/2);let i=BVe,s="",o;e?o="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":o="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<r;a++){let l=o.replace("%index%",a.toString());l=l.replace("%sampleIndex%",`${a-(n-1)}.0`),s+=l,s+=`
`}return i=i.replace("%blur%",s),i=i.replace("%size%",r.toString()),i}class RR extends Zs{constructor(e,n=8,i=4,s=Zs.defaultResolution,o=5){const a=$Ve(o,e),l=LVe(o);super(a,l),this.horizontal=e,this.resolution=s,this._quality=0,this.quality=i,this.blur=n}apply(e,n,i,s){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/n.width):this.uniforms.strength=1/i.height*(i.height/n.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/n.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/n.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,n,i,s);else{const o=e.getFilterTexture(),a=e.renderer;let l=n,h=o;this.state.blend=!1,e.applyFilter(this,l,h,ql.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(l,ql.BLIT),this.uniforms.uSampler=h;const f=h;h=l,l=f,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,h,i,s),e.returnFilterTexture(o)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class UVe extends Zs{constructor(e=8,n=4,i=Zs.defaultResolution,s=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new RR(!0,e,n,i,s),this.blurYFilter=new RR(!1,e,n,i,s),this.resolution=i,this.quality=n,this.blur=e,this.repeatEdgePixels=!1}apply(e,n,i,s){const o=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(o&&a){const l=e.getFilterTexture();this.blurXFilter.apply(e,n,l,ql.CLEAR),this.blurYFilter.apply(e,l,i,s),e.returnFilterTexture(l)}else a?this.blurYFilter.apply(e,n,i,s):this.blurXFilter.apply(e,n,i,s)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var VVe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class IR extends Zs{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(RK,VVe,e),this.alpha=1}_loadMatrix(e,n=!1){let i=e;n&&(this._multiply(i,this.uniforms.m,e),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(e,n,i){return e[0]=n[0]*i[0]+n[1]*i[5]+n[2]*i[10]+n[3]*i[15],e[1]=n[0]*i[1]+n[1]*i[6]+n[2]*i[11]+n[3]*i[16],e[2]=n[0]*i[2]+n[1]*i[7]+n[2]*i[12]+n[3]*i[17],e[3]=n[0]*i[3]+n[1]*i[8]+n[2]*i[13]+n[3]*i[18],e[4]=n[0]*i[4]+n[1]*i[9]+n[2]*i[14]+n[3]*i[19]+n[4],e[5]=n[5]*i[0]+n[6]*i[5]+n[7]*i[10]+n[8]*i[15],e[6]=n[5]*i[1]+n[6]*i[6]+n[7]*i[11]+n[8]*i[16],e[7]=n[5]*i[2]+n[6]*i[7]+n[7]*i[12]+n[8]*i[17],e[8]=n[5]*i[3]+n[6]*i[8]+n[7]*i[13]+n[8]*i[18],e[9]=n[5]*i[4]+n[6]*i[9]+n[7]*i[14]+n[8]*i[19]+n[9],e[10]=n[10]*i[0]+n[11]*i[5]+n[12]*i[10]+n[13]*i[15],e[11]=n[10]*i[1]+n[11]*i[6]+n[12]*i[11]+n[13]*i[16],e[12]=n[10]*i[2]+n[11]*i[7]+n[12]*i[12]+n[13]*i[17],e[13]=n[10]*i[3]+n[11]*i[8]+n[12]*i[13]+n[13]*i[18],e[14]=n[10]*i[4]+n[11]*i[9]+n[12]*i[14]+n[13]*i[19]+n[14],e[15]=n[15]*i[0]+n[16]*i[5]+n[17]*i[10]+n[18]*i[15],e[16]=n[15]*i[1]+n[16]*i[6]+n[17]*i[11]+n[18]*i[16],e[17]=n[15]*i[2]+n[16]*i[7]+n[17]*i[12]+n[18]*i[17],e[18]=n[15]*i[3]+n[16]*i[8]+n[17]*i[13]+n[18]*i[18],e[19]=n[15]*i[4]+n[16]*i[9]+n[17]*i[14]+n[18]*i[19]+n[19],e}_colorMatrix(e){const n=new Float32Array(e);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n}brightness(e,n){const i=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(i,n)}tint(e,n){const[i,s,o]=Un.shared.setValue(e).toArray(),a=[i,0,0,0,0,0,s,0,0,0,0,0,o,0,0,0,0,0,1,0];this._loadMatrix(a,n)}greyscale(e,n){const i=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(i,n)}blackAndWhite(e){const n=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(n,e)}hue(e,n){e=(e||0)/180*Math.PI;const i=Math.cos(e),s=Math.sin(e),o=Math.sqrt,a=1/3,l=o(a),h=i+(1-i)*a,u=a*(1-i)-l*s,f=a*(1-i)+l*s,p=a*(1-i)+l*s,m=i+a*(1-i),v=a*(1-i)-l*s,y=a*(1-i)-l*s,x=a*(1-i)+l*s,w=i+a*(1-i),S=[h,u,f,0,0,p,m,v,0,0,y,x,w,0,0,0,0,0,1,0];this._loadMatrix(S,n)}contrast(e,n){const i=(e||0)+1,s=-.5*(i-1),o=[i,0,0,0,s,0,i,0,0,s,0,0,i,0,s,0,0,0,1,0];this._loadMatrix(o,n)}saturate(e=0,n){const i=e*2/3+1,s=(i-1)*-.5,o=[i,s,s,0,0,s,i,s,0,0,s,s,i,0,0,0,0,0,1,0];this._loadMatrix(o,n)}desaturate(){this.saturate(-1)}negative(e){const n=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(n,e)}sepia(e){const n=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(n,e)}technicolor(e){const n=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(n,e)}polaroid(e){const n=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(n,e)}toBGR(e){const n=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(n,e)}kodachrome(e){const n=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(n,e)}browni(e){const n=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(n,e)}vintage(e){const n=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(n,e)}colorTone(e,n,i,s,o){e=e||.2,n=n||.15,i=i||16770432,s=s||3375104;const a=Un.shared,[l,h,u]=a.setValue(i).toArray(),[f,p,m]=a.setValue(s).toArray(),v=[.3,.59,.11,0,0,l,h,u,e,0,f,p,m,n,0,l-f,h-p,u-m,0,0];this._loadMatrix(v,o)}night(e,n){e=e||.1;const i=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(i,n)}predator(e,n){const i=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(i,n)}lsd(e){const n=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(n,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}IR.prototype.grayscale=IR.prototype.greyscale;var FVe=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,zVe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class XVe extends Zs{constructor(e,n){const i=new Fn;e.renderable=!1,super(zVe,FVe,{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=i,n==null&&(n=20),this.scale=new hi(n,n)}apply(e,n,i,s){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const o=this.maskSprite.worldTransform,a=Math.sqrt(o.a*o.a+o.b*o.b),l=Math.sqrt(o.c*o.c+o.d*o.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=o.a/a,this.uniforms.rotation[1]=o.b/a,this.uniforms.rotation[2]=o.c/l,this.uniforms.rotation[3]=o.d/l),e.applyFilter(this,n,i,s)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var WVe=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,GVe=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class HVe extends Zs{constructor(){super(GVe,WVe)}}var QVe=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class jVe extends Zs{constructor(e=.5,n=Math.random()){super(RK,QVe,{uNoise:0,uSeed:0}),this.noise=e,this.seed=n}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const w9={AlphaFilter:IVe,BlurFilter:UVe,BlurFilterPass:RR,ColorMatrixFilter:IR,DisplacementFilter:XVe,FXAAFilter:HVe,NoiseFilter:jVe};Object.entries(w9).forEach(([r,e])=>{Object.defineProperty(w9,r,{get(){return Xi("7.1.0",`filters.${r} has moved to ${r}`),e}})});class YVe{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(ia.system.add(this.tickerUpdate,this,vp.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ia.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Lu=new YVe;class cx{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=cx.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new hi,this.page=new hi,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,n,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,n,i,s,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class SC extends cx{constructor(){super(...arguments),this.client=new hi,this.movement=new hi,this.offset=new hi,this.global=new hi,this.screen=new hi}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,n,i){return e.worldTransform.applyInverse(i||this.global,n)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,n,i,s,o,a,l,h,u,f,p,m,v,y,x){throw new Error("Method not implemented.")}}class al extends SC{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Mg extends SC{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Mg.DOM_DELTA_PIXEL=0,Mg.DOM_DELTA_LINE=1,Mg.DOM_DELTA_PAGE=2;const qVe=2048,ZVe=new hi,pk=new hi;class KVe{constructor(e){this.dispatch=new rx,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,n){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:n,priority:0}),this.mappingTable[e].sort((i,s)=>i.priority-s.priority)}dispatchEvent(e,n){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,n),this.dispatch.emit(n||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const n=this.mappingTable[e.type];if(n)for(let i=0,s=n.length;i<s;i++)n[i].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,n){Lu.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[i](this.rootTarget,this.rootTarget.eventMode,ZVe.set(e,n),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(e,n){if(!e.target)return;const i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let s=0,o=i.length-1;s<o;s++)if(e.currentTarget=i[s],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,n),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let s=i.length-2;s>=0;s--)if(e.currentTarget=i[s],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,n,i=this._allInteractiveElements){if(i.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const s=Array.isArray(n)?n:[n];for(let o=i.length-1;o>=0;o--)s.forEach(a=>{e.currentTarget=i[o],this.notifyTarget(e,a)})}propagationPath(e){const n=[e];for(let i=0;i<qVe&&e!==this.rootTarget;i++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");n.push(e.parent),e=e.parent}return n.reverse(),n}hitTestMoveRecursive(e,n,i,s,o,a=!1){let l=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||n==="dynamic")&&(Lu.pauseUpdate=!1),e.interactiveChildren&&e.children){const f=e.children;for(let p=f.length-1;p>=0;p--){const m=f[p],v=this.hitTestMoveRecursive(m,this._isInteractive(n)?n:m.eventMode,i,s,o,a||o(e,i));if(v){if(v.length>0&&!v[v.length-1].parent)continue;const y=e.isInteractive();(v.length>0||y)&&(y&&this._allInteractiveElements.push(e),v.push(e)),this._hitElements.length===0&&(this._hitElements=v),l=!0}}}const h=this._isInteractive(n),u=e.isInteractive();return h&&u&&this._allInteractiveElements.push(e),a||this._hitElements.length>0?null:l?this._hitElements:h&&!o(e,i)&&s(e,i)?u?[e]:[]:null}hitTestRecursive(e,n,i,s,o){if(this._interactivePrune(e)||o(e,i))return null;if((e.eventMode==="dynamic"||n==="dynamic")&&(Lu.pauseUpdate=!1),e.interactiveChildren&&e.children){const h=e.children;for(let u=h.length-1;u>=0;u--){const f=h[u],p=this.hitTestRecursive(f,this._isInteractive(n)?n:f.eventMode,i,s,o);if(p){if(p.length>0&&!p[p.length-1].parent)continue;const m=e.isInteractive();return(p.length>0||m)&&p.push(e),p}}}const a=this._isInteractive(n),l=e.isInteractive();return a&&s(e,i)?l?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,n){var i;if(e.hitArea&&(e.worldTransform.applyInverse(n,pk),!e.hitArea.contains(pk.x,pk.y)))return!0;if(e._mask){const s=e._mask.isMaskData?e._mask.maskObject:e._mask;if(s&&!((i=s.containsPoint)!=null&&i.call(s,n)))return!0}return!1}hitTestFn(e,n){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(n):!1}notifyTarget(e,n){var o,a;n=n??e.type;const i=`on${n}`;(a=(o=e.currentTarget)[i])==null||a.call(o,e);const s=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${n}capture`:n;this.notifyListeners(e,s),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,n)}mapPointerDown(e){if(!(e instanceof al)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerdown"),n.pointerType==="touch")this.dispatchEvent(n,"touchstart");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const s=n.button===2;this.dispatchEvent(n,s?"rightdown":"mousedown")}const i=this.trackingData(e.pointerId);i.pressTargetsByButton[e.button]=n.composedPath(),this.freeEvent(n)}mapPointerMove(e){var h,u;if(!(e instanceof al)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const n=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const i=n.pointerType==="mouse"||n.pointerType==="pen",s=this.trackingData(e.pointerId),o=this.findMountedTarget(s.overTargets);if(((h=s.overTargets)==null?void 0:h.length)>0&&o!==n.target){const f=e.type==="mousemove"?"mouseout":"pointerout",p=this.createPointerEvent(e,f,o);if(this.dispatchEvent(p,"pointerout"),i&&this.dispatchEvent(p,"mouseout"),!n.composedPath().includes(o)){const m=this.createPointerEvent(e,"pointerleave",o);for(m.eventPhase=m.AT_TARGET;m.target&&!n.composedPath().includes(m.target);)m.currentTarget=m.target,this.notifyTarget(m),i&&this.notifyTarget(m,"mouseleave"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(p)}if(o!==n.target){const f=e.type==="mousemove"?"mouseover":"pointerover",p=this.clonePointerEvent(n,f);this.dispatchEvent(p,"pointerover"),i&&this.dispatchEvent(p,"mouseover");let m=o==null?void 0:o.parent;for(;m&&m!==this.rootTarget.parent&&m!==n.target;)m=m.parent;if(!m||m===this.rootTarget.parent){const v=this.clonePointerEvent(n,"pointerenter");for(v.eventPhase=v.AT_TARGET;v.target&&v.target!==o&&v.target!==this.rootTarget.parent;)v.currentTarget=v.target,this.notifyTarget(v),i&&this.notifyTarget(v,"mouseenter"),v.target=v.target.parent;this.freeEvent(v)}this.freeEvent(p)}const a=[],l=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(n,"pointermove"),l&&a.push("globalpointermove"),n.pointerType==="touch"&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(n,"touchmove"),l&&a.push("globaltouchmove")),i&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(n,"mousemove"),l&&a.push("globalmousemove"),this.cursor=(u=n.target)==null?void 0:u.cursor),a.length>0&&this.all(n,a),this._allInteractiveElements.length=0,this._hitElements.length=0,s.overTargets=n.composedPath(),this.freeEvent(n)}mapPointerOver(e){var a;if(!(e instanceof al)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.trackingData(e.pointerId),i=this.createPointerEvent(e),s=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),s&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(a=i.target)==null?void 0:a.cursor);const o=this.clonePointerEvent(i,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),s&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;n.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(o)}mapPointerOut(e){if(!(e instanceof al)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.trackingData(e.pointerId);if(n.overTargets){const i=e.pointerType==="mouse"||e.pointerType==="pen",s=this.findMountedTarget(n.overTargets),o=this.createPointerEvent(e,"pointerout",s);this.dispatchEvent(o),i&&this.dispatchEvent(o,"mouseout");const a=this.createPointerEvent(e,"pointerleave",s);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),i&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;n.overTargets=null,this.freeEvent(o),this.freeEvent(a)}this.cursor=null}mapPointerUp(e){if(!(e instanceof al)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=performance.now(),i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const l=i.button===2;this.dispatchEvent(i,l?"rightup":"mouseup")}const s=this.trackingData(e.pointerId),o=this.findMountedTarget(s.pressTargetsByButton[e.button]);let a=o;if(o&&!i.composedPath().includes(o)){let l=o;for(;l&&!i.composedPath().includes(l);){if(i.currentTarget=l,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const h=i.button===2;this.notifyTarget(i,h?"rightupoutside":"mouseupoutside")}l=l.parent}delete s.pressTargetsByButton[e.button],a=l}if(a){const l=this.clonePointerEvent(i,"click");l.target=a,l.path=null,s.clicksByButton[e.button]||(s.clicksByButton[e.button]={clickCount:0,target:l.target,timeStamp:n});const h=s.clicksByButton[e.button];if(h.target===l.target&&n-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=l.target,h.timeStamp=n,l.detail=h.clickCount,l.pointerType==="mouse"){const u=l.button===2;this.dispatchEvent(l,u?"rightclick":"click")}else l.pointerType==="touch"&&this.dispatchEvent(l,"tap");this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(i)}mapPointerUpOutside(e){if(!(e instanceof al)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const n=this.trackingData(e.pointerId),i=this.findMountedTarget(n.pressTargetsByButton[e.button]),s=this.createPointerEvent(e);if(i){let o=i;for(;o;)s.currentTarget=o,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"?this.notifyTarget(s,"touchendoutside"):(s.pointerType==="mouse"||s.pointerType==="pen")&&this.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),o=o.parent;delete n.pressTargetsByButton[e.button]}this.freeEvent(s)}mapWheel(e){if(!(e instanceof Mg)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const n=this.createWheelEvent(e);this.dispatchEvent(n),this.freeEvent(n)}findMountedTarget(e){if(!e)return null;let n=e[0];for(let i=1;i<e.length&&e[i].parent===n;i++)n=e[i];return n}createPointerEvent(e,n,i){const s=this.allocateEvent(al);return this.copyPointerData(e,s),this.copyMouseData(e,s),this.copyData(e,s),s.nativeEvent=e.nativeEvent,s.originalEvent=e,s.target=i??this.hitTest(s.global.x,s.global.y)??this._hitElements[0],typeof n=="string"&&(s.type=n),s}createWheelEvent(e){const n=this.allocateEvent(Mg);return this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=this.hitTest(n.global.x,n.global.y),n}clonePointerEvent(e,n){const i=this.allocateEvent(al);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=n??i.type,i}copyWheelData(e,n){n.deltaMode=e.deltaMode,n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ}copyPointerData(e,n){e instanceof al&&n instanceof al&&(n.pointerId=e.pointerId,n.width=e.width,n.height=e.height,n.isPrimary=e.isPrimary,n.pointerType=e.pointerType,n.pressure=e.pressure,n.tangentialPressure=e.tangentialPressure,n.tiltX=e.tiltX,n.tiltY=e.tiltY,n.twist=e.twist)}copyMouseData(e,n){e instanceof SC&&n instanceof SC&&(n.altKey=e.altKey,n.button=e.button,n.buttons=e.buttons,n.client.copyFrom(e.client),n.ctrlKey=e.ctrlKey,n.metaKey=e.metaKey,n.movement.copyFrom(e.movement),n.screen.copyFrom(e.screen),n.shiftKey=e.shiftKey,n.global.copyFrom(e.global))}copyData(e,n){n.isTrusted=e.isTrusted,n.srcElement=e.srcElement,n.timeStamp=performance.now(),n.type=e.type,n.detail=e.detail,n.view=e.view,n.which=e.which,n.layer.copyFrom(e.layer),n.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const n=this.eventPool.get(e).pop()||new e(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=null,n.target=null,n}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const n=e.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(e)}notifyListeners(e,n){const i=e.currentTarget._events[n];if(i&&e.currentTarget.isInteractive())if("fn"in i)i.once&&e.currentTarget.removeListener(n,i.fn,void 0,!0),i.fn.call(i.context,e);else for(let s=0,o=i.length;s<o&&!e.propagationImmediatelyStopped;s++)i[s].once&&e.currentTarget.removeListener(n,i[s].fn,void 0,!0),i[s].fn.call(i[s].context,e)}}const JVe=1,e8e={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},NR=class DR{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new KVe(null),Lu.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new al(null),this.rootWheelEvent=new Mg(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...DR.defaultEventFeatures},{set:(n,i,s)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),n[i]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:n,resolution:i}=this.renderer;this.setTargetElement(n),this.resolution=i,DR._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let n=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(n=!1),this.currentCursor===e)return;this.currentCursor=e;const i=this.cursorStyles[e];if(i)switch(typeof i){case"string":n&&(this.domElement.style.cursor=i);break;case"function":i(e);break;case"object":n&&Object.assign(this.domElement.style,i);break}else n&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const n=this.normalizeToPointerData(e);this.autoPreventDefault&&n[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let i=0,s=n.length;i<s;i++){const o=n[i],a=this.bootstrapEvent(this.rootPointerEvent,o);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Lu.pointerMoved();const n=this.normalizeToPointerData(e);for(let i=0,s=n.length;i<s;i++){const o=this.bootstrapEvent(this.rootPointerEvent,n[i]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let n=e.target;e.composedPath&&e.composedPath().length>0&&(n=e.composedPath()[0]);const i=n!==this.domElement?"outside":"",s=this.normalizeToPointerData(e);for(let o=0,a=s.length;o<a;o++){const l=this.bootstrapEvent(this.rootPointerEvent,s[o]);l.type+=i,this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const n=this.normalizeToPointerData(e);for(let i=0,s=n.length;i<s;i++){const o=this.bootstrapEvent(this.rootPointerEvent,n[i]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const n=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(n)}setTargetElement(e){this.removeEvents(),this.domElement=e,Lu.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Lu.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Lu.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,n,i){const s=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},o=1/this.resolution;e.x=(n-s.left)*(this.domElement.width/s.width)*o,e.y=(i-s.top)*(this.domElement.height/s.height)*o}normalizeToPointerData(e){const n=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let i=0,s=e.changedTouches.length;i<s;i++){const o=e.changedTouches[i];typeof o.button>"u"&&(o.button=0),typeof o.buttons>"u"&&(o.buttons=1),typeof o.isPrimary>"u"&&(o.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,o.type=e.type,n.push(o)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const i=e;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=JVe),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,n.push(i)}else n.push(e);return n}normalizeWheelEvent(e){const n=this.rootWheelEvent;return this.transferMouseData(n,e),n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ,n.deltaMode=e.deltaMode,this.mapPositionToPoint(n.screen,e.clientX,e.clientY),n.global.copyFrom(n.screen),n.offset.copyFrom(n.screen),n.nativeEvent=e,n.type=e.type,n}bootstrapEvent(e,n){return e.originalEvent=null,e.nativeEvent=n,e.pointerId=n.pointerId,e.width=n.width,e.height=n.height,e.isPrimary=n.isPrimary,e.pointerType=n.pointerType,e.pressure=n.pressure,e.tangentialPressure=n.tangentialPressure,e.tiltX=n.tiltX,e.tiltY=n.tiltY,e.twist=n.twist,this.transferMouseData(e,n),this.mapPositionToPoint(e.screen,n.clientX,n.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=n.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=e8e[e.type]||e.type),e}transferMouseData(e,n){e.isTrusted=n.isTrusted,e.srcElement=n.srcElement,e.timeStamp=performance.now(),e.type=n.type,e.altKey=n.altKey,e.button=n.button,e.buttons=n.buttons,e.client.x=n.clientX,e.client.y=n.clientY,e.ctrlKey=n.ctrlKey,e.metaKey=n.metaKey,e.movement.x=n.movementX,e.movement.y=n.movementY,e.page.x=n.pageX,e.page.y=n.pageY,e.relatedTarget=null,e.shiftKey=n.shiftKey}};NR.extension={name:"events",type:[wt.RendererSystem,wt.CanvasRendererSystem]},NR.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let LR=NR;Gt.add(LR);function _9(r){return r==="dynamic"||r==="static"}const t8e={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??_9(LR.defaultEventMode)},set interactive(r){Xi("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=r,this.eventMode=r?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??LR.defaultEventMode},set eventMode(r){this._internalInteractive=_9(r),this._internalEventMode=r},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(r,e,n){const i=typeof n=="boolean"&&n||typeof n=="object"&&n.capture,s=typeof n=="object"?n.signal:void 0,o=typeof n=="object"?n.once===!0:!1,a=typeof e=="function"?void 0:e;r=i?`${r}capture`:r;const l=typeof e=="function"?e:e.handleEvent,h=this;s&&s.addEventListener("abort",()=>{h.off(r,l,a)}),o?h.once(r,l,a):h.on(r,l,a)},removeEventListener(r,e,n){const i=typeof n=="boolean"&&n||typeof n=="object"&&n.capture,s=typeof e=="function"?void 0:e;r=i?`${r}capture`:r,e=typeof e=="function"?e:e.handleEvent,this.off(r,e,s)},dispatchEvent(r){if(!(r instanceof cx))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=null,r.target=this,r.manager.dispatchEvent(r),!r.defaultPrevented}};Zn.mixin(t8e);const i8e={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Zn.mixin(i8e);const n8e=9,oO=100,r8e=0,s8e=0,O9=2,S9=1,o8e=-1e3,a8e=-1e3,l8e=2;class FK{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(ah.tablet||ah.phone)&&this.createTouchHook();const n=document.createElement("div");n.style.width=`${oO}px`,n.style.height=`${oO}px`,n.style.position="absolute",n.style.top=`${r8e}px`,n.style.left=`${s8e}px`,n.style.zIndex=O9.toString(),this.div=n,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${S9}px`,e.style.height=`${S9}px`,e.style.position="absolute",e.style.top=`${o8e}px`,e.style.left=`${a8e}px`,e.style.zIndex=l8e.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const n=e.children;if(n)for(let i=0;i<n.length;i++)this.updateAccessibleObjects(n[i])}update(){const e=performance.now();if(ah.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:n,y:i,width:s,height:o}=this.renderer.view.getBoundingClientRect(),{width:a,height:l,resolution:h}=this.renderer,u=s/a*h,f=o/l*h;let p=this.div;p.style.left=`${n}px`,p.style.top=`${i}px`,p.style.width=`${a}px`,p.style.height=`${l}px`;for(let m=0;m<this.children.length;m++){const v=this.children[m];if(v.renderId!==this.renderId)v._accessibleActive=!1,Tg(this.children,m,1),this.div.removeChild(v._accessibleDiv),this.pool.push(v._accessibleDiv),v._accessibleDiv=null,m--;else{p=v._accessibleDiv;let y=v.hitArea;const x=v.worldTransform;v.hitArea?(p.style.left=`${(x.tx+y.x*x.a)*u}px`,p.style.top=`${(x.ty+y.y*x.d)*f}px`,p.style.width=`${y.width*x.a*u}px`,p.style.height=`${y.height*x.d*f}px`):(y=v.getBounds(),this.capHitArea(y),p.style.left=`${y.x*u}px`,p.style.top=`${y.y*f}px`,p.style.width=`${y.width*u}px`,p.style.height=`${y.height*f}px`,p.title!==v.accessibleTitle&&v.accessibleTitle!==null&&(p.title=v.accessibleTitle),p.getAttribute("aria-label")!==v.accessibleHint&&v.accessibleHint!==null&&p.setAttribute("aria-label",v.accessibleHint)),(v.accessibleTitle!==p.title||v.tabIndex!==p.tabIndex)&&(p.title=v.accessibleTitle,p.tabIndex=v.tabIndex,this.debug&&this.updateDebugHTML(p))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:n,height:i}=this.renderer;e.x+e.width>n&&(e.width=n-e.x),e.y+e.height>i&&(e.height=i-e.y)}addChild(e){let n=this.pool.pop();n||(n=document.createElement("button"),n.style.width=`${oO}px`,n.style.height=`${oO}px`,n.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",n.style.position="absolute",n.style.zIndex=O9.toString(),n.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?n.setAttribute("aria-live","off"):n.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?n.setAttribute("aria-relevant","additions"):n.setAttribute("aria-relevant","text"),n.addEventListener("click",this._onClick.bind(this)),n.addEventListener("focus",this._onFocus.bind(this)),n.addEventListener("focusout",this._onFocusOut.bind(this))),n.style.pointerEvents=e.accessiblePointerEvents,n.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?n.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(n.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&n.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(n),e._accessibleActive=!0,e._accessibleDiv=n,n.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,n){const{displayObject:i}=e.target,s=this.renderer.events.rootBoundary,o=Object.assign(new cx(s),{target:i});s.rootTarget=this.renderer.lastObjectRendered,n.forEach(a=>s.dispatchEvent(o,a))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===n8e&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}FK.extension={name:"accessibility",type:[wt.RendererPlugin,wt.CanvasRendererPlugin]};Gt.add(FK);const zK=class BR{constructor(e){this.stage=new ss,e=Object.assign({forceCanvas:!1},e),this.renderer=yVe(e),BR._plugins.forEach(n=>{n.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,n){const i=BR._plugins.slice(0);i.reverse(),i.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null}};zK._plugins=[];let hx=zK;Gt.handleByList(wt.Application,hx._plugins);class XK{static init(e){Object.defineProperty(this,"resizeTo",{set(n){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=n,n&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let n,i;if(this._resizeTo===globalThis.window)n=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:o}=this._resizeTo;n=s,i=o}this.renderer.resize(n,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}XK.extension=wt.Application;Gt.add(XK);const C9={loader:wt.LoadParser,resolver:wt.ResolveParser,cache:wt.CacheParser,detection:wt.DetectionParser};Gt.handle(wt.Asset,r=>{const e=r.ref;Object.entries(C9).filter(([n])=>!!e[n]).forEach(([n,i])=>Gt.add(Object.assign(e[n],{extension:e[n].extension??i})))},r=>{const e=r.ref;Object.keys(C9).filter(n=>!!e[n]).forEach(n=>Gt.remove(e[n]))});class c8e{constructor(e,n=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=n}add(e){e.forEach(n=>{this._assetList.push(n)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],n=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<n;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function x0(r,e){if(Array.isArray(e)){for(const n of e)if(r.startsWith(`data:${n}`))return!0;return!1}return r.startsWith(`data:${e}`)}function Sd(r,e){const n=r.split("?")[0],i=is.extname(n).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const cl=(r,e,n=!1)=>(Array.isArray(r)||(r=[r]),e?r.map(i=>typeof i=="string"||n?e(i):i):r),$R=(r,e)=>{const n=e.split("?")[1];return n&&(r+=`?${n}`),r};function WK(r,e,n,i,s){const o=e[n];for(let a=0;a<o.length;a++){const l=o[a];n<e.length-1?WK(r.replace(i[n],l),e,n+1,i,s):s.push(r.replace(i[n],l))}}function h8e(r){const e=/\{(.*?)\}/g,n=r.match(e),i=[];if(n){const s=[];n.forEach(o=>{const a=o.substring(1,o.length-1).split(",");s.push(a)}),WK(r,s,0,n,i)}else i.push(r);return i}const CC=r=>!Array.isArray(r);class u8e{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const n=this._cache.get(e);return n||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),n}set(e,n){const i=cl(e);let s;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.test(n)){s=h.getCacheableAssets(i,n);break}}s||(s={},i.forEach(l=>{s[l]=n}));const o=Object.keys(s),a={cacheKeys:o,keys:i};if(i.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{this._cache.has(l)&&this._cache.get(l)!==n&&console.warn("[Cache] already has key:",l),this._cache.set(l,s[l])}),n instanceof Wt){const l=n;i.forEach(h=>{l.baseTexture!==Wt.EMPTY.baseTexture&&Oi.addToCache(l.baseTexture,h),Wt.addToCache(l,h)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const n=this._cacheMap.get(e);n.cacheKeys.forEach(i=>{this._cache.delete(i)}),n.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Of=new u8e;class d8e{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,n,i)=>(this._parsersValidated=!1,e[n]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,n){const i={promise:null,parser:null};return i.promise=(async()=>{var a,l;let s=null,o=null;if(n.loadParser&&(o=this._parserHash[n.loadParser],o||console.warn(`[Assets] specified load parser "${n.loadParser}" not found while loading ${e}`)),!o){for(let h=0;h<this.parsers.length;h++){const u=this.parsers[h];if(u.load&&((a=u.test)!=null&&a.call(u,e,n,this))){o=u;break}}if(!o)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await o.load(e,n,this),i.parser=o;for(let h=0;h<this.parsers.length;h++){const u=this.parsers[h];u.parse&&u.parse&&await((l=u.testParse)==null?void 0:l.call(u,s,n,this))&&(s=await u.parse(s,n,this)||s,i.parser=u)}return s})(),i}async load(e,n){this._parsersValidated||this._validateParsers();let i=0;const s={},o=CC(e),a=cl(e,u=>({alias:[u],src:u})),l=a.length,h=a.map(async u=>{const f=is.toAbsolute(u.src);if(!s[u.src])try{this.promiseCache[f]||(this.promiseCache[f]=this._getLoadPromiseAndParser(f,u)),s[u.src]=await this.promiseCache[f].promise,n&&n(++i/l)}catch(p){throw delete this.promiseCache[f],delete s[u.src],new Error(`[Loader.load] Failed to load ${f}.
${p}`)}});return await Promise.all(h),o?s[a[0].src]:s}async unload(e){const n=cl(e,i=>({alias:[i],src:i})).map(async i=>{var a,l;const s=is.toAbsolute(i.src),o=this.promiseCache[s];if(o){const h=await o.promise;delete this.promiseCache[s],(l=(a=o.parser)==null?void 0:a.unload)==null||l.call(a,h,i,this)}});await Promise.all(n)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,n)=>(e[n.name]&&console.warn(`[Assets] loadParser name conflict "${n.name}"`),{...e,[n.name]:n}),{})}}var Cl=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(Cl||{});const f8e=".json",p8e="application/json",m8e={extension:{type:wt.LoadParser,priority:Cl.Low},name:"loadJson",test(r){return x0(r,p8e)||Sd(r,f8e)},async load(r){return await(await kt.ADAPTER.fetch(r)).json()}};Gt.add(m8e);const g8e=".txt",v8e="text/plain",y8e={name:"loadTxt",extension:{type:wt.LoadParser,priority:Cl.Low},test(r){return x0(r,v8e)||Sd(r,g8e)},async load(r){return await(await kt.ADAPTER.fetch(r)).text()}};Gt.add(y8e);const b8e=["normal","bold","100","200","300","400","500","600","700","800","900"],x8e=[".ttf",".otf",".woff",".woff2"],w8e=["font/ttf","font/otf","font/woff","font/woff2"],_8e=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function O8e(r){const e=is.extname(r),n=is.basename(r,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let i=n.length>0;for(const o of n)if(!o.match(_8e)){i=!1;break}let s=n.join(" ");return i||(s=`"${s.replace(/[\\"]/g,"\\$&")}"`),s}const S8e=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function C8e(r){return S8e.test(r)?r:encodeURI(r)}const T8e={extension:{type:wt.LoadParser,priority:Cl.Low},name:"loadWebFont",test(r){return x0(r,w8e)||Sd(r,x8e)},async load(r,e){var i,s,o;const n=kt.ADAPTER.getFontFaceSet();if(n){const a=[],l=((i=e.data)==null?void 0:i.family)??O8e(r),h=((o=(s=e.data)==null?void 0:s.weights)==null?void 0:o.filter(f=>b8e.includes(f)))??["normal"],u=e.data??{};for(let f=0;f<h.length;f++){const p=h[f],m=new FontFace(l,`url(${C8e(r)})`,{...u,weight:p});await m.load(),n.add(m),a.push(m)}return a.length===1?a[0]:a}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(e=>kt.ADAPTER.getFontFaceSet().delete(e))}};Gt.add(T8e);const E8e=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Ag=null,UR=class{constructor(){Ag||(Ag=URL.createObjectURL(new Blob([E8e],{type:"application/javascript"}))),this.worker=new Worker(Ag)}};UR.revokeObjectURL=function(){Ag&&(URL.revokeObjectURL(Ag),Ag=null)};const M8e=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let kg=null;class GK{constructor(){kg||(kg=URL.createObjectURL(new Blob([M8e],{type:"application/javascript"}))),this.worker=new Worker(kg)}}GK.revokeObjectURL=function(){kg&&(URL.revokeObjectURL(kg),kg=null)};let T9=0,mk;class A8e{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:n}=new UR;n.addEventListener("message",i=>{n.terminate(),UR.revokeObjectURL(),e(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){mk===void 0&&(mk=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<mk&&(this._createdWorkers++,e=new GK().worker,e.addEventListener("message",n=>{this.complete(n.data),this.returnWorker(n.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,n){await this._initWorkers();const i=new Promise((s,o)=>{this.queue.push({id:e,arguments:n,resolve:s,reject:o})});return this.next(),i}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const n=this.queue.pop(),i=n.id;this.resolveHash[T9]={resolve:n.resolve,reject:n.reject},e.postMessage({data:n.arguments,uuid:T9++,id:i})}}const E9=new A8e;function ux(r,e,n){r.resource.internal=!0;const i=new Wt(r),s=()=>{delete e.promiseCache[n],Of.has(n)&&Of.remove(n)};return i.baseTexture.once("destroyed",()=>{n in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),s())}),i.once("destroyed",()=>{r.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),i}const k8e=[".jpeg",".jpg",".png",".webp",".avif"],P8e=["image/jpeg","image/png","image/webp","image/avif"];async function R8e(r){const e=await kt.ADAPTER.fetch(r);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${e.status} ${e.statusText}`);const n=await e.blob();return await createImageBitmap(n)}const aT={name:"loadTextures",extension:{type:wt.LoadParser,priority:Cl.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return x0(r,P8e)||Sd(r,k8e)},async load(r,e,n){var l;const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let s;i?this.config.preferWorkers&&await E9.isImageBitmapSupported()?s=await E9.loadImageBitmap(r):s=await R8e(r):s=await new Promise((h,u)=>{const f=new Image;f.crossOrigin=this.config.crossOrigin,f.src=r,f.complete?h(f):(f.onload=()=>h(f),f.onerror=p=>u(p))});const o={...e.data};o.resolution??(o.resolution=Mh(r)),i&&((l=o.resourceOptions)==null?void 0:l.ownsImageBitmap)===void 0&&(o.resourceOptions={...o.resourceOptions},o.resourceOptions.ownsImageBitmap=!0);const a=new Oi(s,o);return a.resource.src=r,ux(a,n,r)},unload(r){r.destroy(!0)}};Gt.add(aT);const I8e=".svg",N8e="image/svg+xml",D8e={extension:{type:wt.LoadParser,priority:Cl.High},name:"loadSVG",test(r){return x0(r,N8e)||Sd(r,I8e)},async testParse(r){return MR.test(r)},async parse(r,e,n){var o;const i=new MR(r,(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions);await i.load();const s=new Oi(i,{resolution:Mh(r),...e==null?void 0:e.data});return s.resource.src=e.src,ux(s,n,e.src)},async load(r,e){return(await kt.ADAPTER.fetch(r)).text()},unload:aT.unload};Gt.add(D8e);const L8e=[".mp4",".m4v",".webm",".ogv"],B8e=["video/mp4","video/webm","video/ogg"],$8e={name:"loadVideo",extension:{type:wt.LoadParser,priority:Cl.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(r){return x0(r,B8e)||Sd(r,L8e)},async load(r,e,n){var a;let i;const s=await(await kt.ADAPTER.fetch(r)).blob(),o=URL.createObjectURL(s);try{const l={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(a=e==null?void 0:e.data)==null?void 0:a.resourceOptions,autoLoad:!0},h=new $K(o,l);await h.load();const u=new Oi(h,{alphaMode:await W$e(),resolution:Mh(r),...e==null?void 0:e.data});u.resource.src=r,i=ux(u,n,r),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(o)})}catch(l){throw URL.revokeObjectURL(o),l}return i},unload(r){r.destroy(!0)}};Gt.add($8e);class U8e{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,n)=>`${e}${this._bundleIdConnector}${n}`,extractAssetIdFromBundle:(e,n)=>n.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(n=>{this._preferredOrder.push(n),n.priority||(n.priority=Object.keys(n.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const n=e;this._defaultSearchParams=Object.keys(n).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(n[i])}`).join("&")}}getAlias(e){const{alias:n,name:i,src:s,srcs:o}=e;return cl(n||i||s||o,a=>typeof a=="string"?a:Array.isArray(a)?a.map(l=>(l==null?void 0:l.src)??(l==null?void 0:l.srcs)??l):a!=null&&a.src||a!=null&&a.srcs?a.src??a.srcs:a,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(n=>{this.addBundle(n.name,n.assets)})}addBundle(e,n){const i=[];Array.isArray(n)?n.forEach(s=>{const o=s.src??s.srcs,a=s.alias??s.name;let l;if(typeof a=="string"){const h=this._createBundleAssetId(e,a);i.push(h),l=[a,h]}else{const h=a.map(u=>this._createBundleAssetId(e,u));i.push(...h),l=[...a,...h]}this.add({...s,alias:l,src:o})}):Object.keys(n).forEach(s=>{const o=[s,this._createBundleAssetId(e,s)];if(typeof n[s]=="string")this.add({alias:o,src:n[s]});else if(Array.isArray(n[s]))this.add({alias:o,src:n[s]});else{const a=n[s],l=a.src??a.srcs;this.add({...a,alias:o,src:Array.isArray(l)?l:[l]})}i.push(...o)}),this._bundles[e]=i}add(e,n,i,s,o){const a=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(Xi("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),a.push({alias:e,src:n,data:i,format:s,loadParser:o})):Array.isArray(e)?a.push(...e):a.push(e);let l;l=h=>{this.hasKey(h)&&console.warn(`[Resolver] already has key: ${h} overwriting`)},cl(a).forEach(h=>{const{src:u,srcs:f}=h;let{data:p,format:m,loadParser:v}=h;const y=cl(u||f).map(S=>typeof S=="string"?h8e(S):Array.isArray(S)?S:[S]),x=this.getAlias(h);Array.isArray(x)?x.forEach(l):l(x);const w=[];y.forEach(S=>{S.forEach(O=>{let _={};if(typeof O!="object"){_.src=O;for(let T=0;T<this._parsers.length;T++){const A=this._parsers[T];if(A.test(O)){_=A.parse(O);break}}}else p=O.data??p,m=O.format??m,v=O.loadParser??v,_={..._,...O};if(!x)throw new Error(`[Resolver] alias is undefined for this asset: ${_.src}`);_=this.buildResolvedAsset(_,{aliases:x,data:p,format:m,loadParser:v}),w.push(_)})}),x.forEach(S=>{this._assetMap[S]=w})})}resolveBundle(e){const n=CC(e);e=cl(e);const i={};return e.forEach(s=>{const o=this._bundles[s];if(o){const a=this.resolve(o),l={};for(const h in a){const u=a[h];l[this._extractAssetIdFromBundle(s,h)]=u}i[s]=l}}),n?i[e[0]]:i}resolveUrl(e){const n=this.resolve(e);if(typeof e!="string"){const i={};for(const s in n)i[s]=n[s].src;return i}return n.src}resolve(e){const n=CC(e);e=cl(e);const i={};return e.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let o=this._assetMap[s];const a=o[0],l=this._getPreferredOrder(o);l==null||l.priority.forEach(h=>{l.params[h].forEach(u=>{const f=o.filter(p=>p[h]?p[h]===u:!1);f.length&&(o=f)})}),this._resolverHash[s]=o[0]??a}else this._resolverHash[s]=this.buildResolvedAsset({alias:[s],src:s},{});i[s]=this._resolverHash[s]}),n?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let n=0;n<e.length;n++){const i=e[0],s=this._preferredOrder.find(o=>o.params.format.includes(i.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const n=/\?/.test(e)?"&":"?";return`${e}${n}${this._defaultSearchParams}`}buildResolvedAsset(e,n){const{aliases:i,data:s,loadParser:o,format:a}=n;return(this._basePath||this._rootPath)&&(e.src=is.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=i??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...s||{},...e.data},e.loadParser=o??e.loadParser,e.format=a??e.format??is.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class V8e{constructor(){this._detections=[],this._initialized=!1,this.resolver=new U8e,this.loader=new d8e,this.cache=Of,this._backgroundLoader=new c8e(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let l=e.manifest;typeof l=="string"&&(l=await this.load(l)),this.resolver.addManifest(l)}const n=((o=e.texturePreference)==null?void 0:o.resolution)??1,i=typeof n=="number"?[n]:n,s=await this._detectFormats({preferredFormats:(a=e.texturePreference)==null?void 0:a.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e,n,i,s,o){this.resolver.add(e,n,i,s,o)}async load(e,n){this._initialized||await this.init();const i=CC(e),s=cl(e).map(l=>{if(typeof l!="string"){const h=this.resolver.getAlias(l);return h.some(u=>!this.resolver.hasKey(u))&&this.add(l),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(l)||this.add({alias:l,src:l}),l}),o=this.resolver.resolve(s),a=await this._mapLoadToResolve(o,n);return i?a[s[0]]:a}addBundle(e,n){this.resolver.addBundle(e,n)}async loadBundle(e,n){this._initialized||await this.init();let i=!1;typeof e=="string"&&(i=!0,e=[e]);const s=this.resolver.resolveBundle(e),o={},a=Object.keys(s);let l=0,h=0;const u=()=>{n==null||n(++l/h)},f=a.map(p=>{const m=s[p];return h+=Object.keys(m).length,this._mapLoadToResolve(m,u).then(v=>{o[p]=v})});return await Promise.all(f),i?o[e[0]]:o}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const n=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(n))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const n=this.resolver.resolveBundle(e);Object.values(n).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Of.get(e);const n={};for(let i=0;i<e.length;i++)n[i]=Of.get(e[i]);return n}async _mapLoadToResolve(e,n){const i=Object.values(e),s=Object.keys(e);this._backgroundLoader.active=!1;const o=await this.loader.load(i,n);this._backgroundLoader.active=!0;const a={};return i.forEach((l,h)=>{const u=o[l.src],f=[l.src];l.alias&&f.push(...l.alias),a[s[h]]=u,Of.set(f,u)}),a}async unload(e){this._initialized||await this.init();const n=cl(e).map(s=>typeof s!="string"?s.src:s),i=this.resolver.resolve(n);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=cl(e);const n=this.resolver.resolveBundle(e),i=Object.keys(n).map(s=>this._unloadFromResolved(n[s]));await Promise.all(i)}async _unloadFromResolved(e){const n=Object.values(e);n.forEach(i=>{Of.remove(i.src)}),await this.loader.unload(n)}async _detectFormats(e){let n=[];e.preferredFormats&&(n=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const i of e.detections)e.skipDetections||await i.test()?n=await i.add(n):e.skipDetections||(n=await i.remove(n));return n=n.filter((i,s)=>n.indexOf(i)===s),n}get detections(){return this._detections}get preferWorkers(){return aT.config.preferWorkers}set preferWorkers(e){Xi("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(n=>{n.config&&Object.keys(n.config).filter(i=>i in e).forEach(i=>{n.config[i]=e[i]})})}}const Eo=new V8e;Gt.handleByList(wt.LoadParser,Eo.loader.parsers).handleByList(wt.ResolveParser,Eo.resolver.parsers).handleByList(wt.CacheParser,Eo.cache.parsers).handleByList(wt.DetectionParser,Eo.detections);const F8e={extension:wt.CacheParser,test:r=>Array.isArray(r)&&r.every(e=>e instanceof Wt),getCacheableAssets:(r,e)=>{const n={};return r.forEach(i=>{e.forEach((s,o)=>{n[i+(o===0?"":o+1)]=s})}),n}};Gt.add(F8e);async function HK(r){if("Image"in globalThis)return new Promise(e=>{const n=new Image;n.onload=()=>{e(!0)},n.onerror=()=>{e(!1)},n.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(r)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const z8e={extension:{type:wt.DetectionParser,priority:1},test:async()=>HK("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(e=>e!=="avif")};Gt.add(z8e);const X8e={extension:{type:wt.DetectionParser,priority:0},test:async()=>HK("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(e=>e!=="webp")};Gt.add(X8e);const M9=["png","jpg","jpeg"],W8e={extension:{type:wt.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...M9],remove:async r=>r.filter(e=>!M9.includes(e))};Gt.add(W8e);const G8e="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Z5(r){return G8e?!1:document.createElement("video").canPlayType(r)!==""}const H8e={extension:{type:wt.DetectionParser,priority:0},test:async()=>Z5("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(e=>e!=="webm")};Gt.add(H8e);const Q8e={extension:{type:wt.DetectionParser,priority:0},test:async()=>Z5("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(e=>e!=="mp4"&&e!=="m4v")};Gt.add(Q8e);const j8e={extension:{type:wt.DetectionParser,priority:0},test:async()=>Z5("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(e=>e!=="ogv")};Gt.add(j8e);const Y8e={extension:wt.ResolveParser,test:aT.test,parse:r=>{var e;return{resolution:parseFloat(((e=kt.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:is.extname(r).slice(1),src:r}}};Gt.add(Y8e);var ls=(r=>(r[r.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",r[r.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",r[r.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",r[r.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",r[r.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",r[r.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",r[r.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",r[r.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",r[r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",r[r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",r[r.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",r[r.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",r[r.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",r[r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",r[r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",r[r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",r))(ls||{});const TC={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Wl,Xm;function A9(){Xm={bptc:Wl.getExtension("EXT_texture_compression_bptc"),astc:Wl.getExtension("WEBGL_compressed_texture_astc"),etc:Wl.getExtension("WEBGL_compressed_texture_etc"),s3tc:Wl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Wl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Wl.getExtension("WEBGL_compressed_texture_pvrtc")||Wl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Wl.getExtension("WEBGL_compressed_texture_etc1"),atc:Wl.getExtension("WEBGL_compressed_texture_atc")}}const q8e={extension:{type:wt.DetectionParser,priority:2},test:async()=>{const r=kt.ADAPTER.createCanvas().getContext("webgl");return r?(Wl=r,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async r=>{Xm||A9();const e=[];for(const n in Xm)Xm[n]&&e.push(n);return[...e,...r]},remove:async r=>(Xm||A9(),r.filter(e=>!(e in Xm)))};Gt.add(q8e);class Z8e extends nT{constructor(e,n={width:1,height:1,autoLoad:!0}){let i,s;typeof e=="string"?(i=e,s=new Uint8Array):(i=null,s=e),super(s,n),this.origin=i,this.buffer=s?new mR(s):null,this._load=null,this.loaded=!1,this.origin!==null&&n.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new mR(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class Qf extends Z8e{constructor(e,n){super(e,n),this.format=n.format,this.levels=n.levels||1,this._width=n.width,this._height=n.height,this._extension=Qf._formatToExtension(this.format),(n.levelBuffers||this.buffer)&&(this._levelBuffers=n.levelBuffers||Qf._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,n,i){const s=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;s.pixelStorei(s.UNPACK_ALIGNMENT,4);for(let o=0,a=this.levels;o<a;o++){const{levelID:l,levelWidth:h,levelHeight:u,levelBuffer:f}=this._levelBuffers[o];s.compressedTexImage2D(s.TEXTURE_2D,l,this.format,h,u,0,f)}return!0}onBlobLoaded(){this._levelBuffers=Qf._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,n,i,s,o,a,l){const h=new Array(i);let u=e.byteOffset,f=a,p=l,m=f+s-1&~(s-1),v=p+o-1&~(o-1),y=m*v*TC[n];for(let x=0;x<i;x++)h[x]={levelID:x,levelWidth:i>1?f:m,levelHeight:i>1?p:v,levelBuffer:new Uint8Array(e.buffer,u,y)},u+=y,f=f>>1||1,p=p>>1||1,m=f+s-1&~(s-1),v=p+o-1&~(o-1),y=m*v*TC[n];return h}}const gk=4,aO=124,K8e=32,k9=20,J8e=542327876,lO={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},eFe={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},cO={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},tFe=1,iFe=2,nFe=4,rFe=64,sFe=512,oFe=131072,aFe=827611204,lFe=861165636,cFe=894720068,hFe=808540228,uFe=4,dFe={[aFe]:ls.COMPRESSED_RGBA_S3TC_DXT1_EXT,[lFe]:ls.COMPRESSED_RGBA_S3TC_DXT3_EXT,[cFe]:ls.COMPRESSED_RGBA_S3TC_DXT5_EXT},fFe={70:ls.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:ls.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:ls.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:ls.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:ls.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:ls.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:ls.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:ls.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:ls.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:ls.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:ls.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:ls.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:ls.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function pFe(r){const e=new Uint32Array(r);if(e[0]!==J8e)throw new Error("Invalid DDS file magic word");const n=new Uint32Array(r,0,aO/Uint32Array.BYTES_PER_ELEMENT),i=n[lO.HEIGHT],s=n[lO.WIDTH],o=n[lO.MIPMAP_COUNT],a=new Uint32Array(r,lO.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,K8e/Uint32Array.BYTES_PER_ELEMENT),l=a[tFe];if(l&nFe){const h=a[eFe.FOURCC];if(h!==hFe){const O=dFe[h],_=gk+aO,T=new Uint8Array(r,_);return[new Qf(T,{format:O,width:s,height:i,levels:o})]}const u=gk+aO,f=new Uint32Array(e.buffer,u,k9/Uint32Array.BYTES_PER_ELEMENT),p=f[cO.DXGI_FORMAT],m=f[cO.RESOURCE_DIMENSION],v=f[cO.MISC_FLAG],y=f[cO.ARRAY_SIZE],x=fFe[p];if(x===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${p}`);if(v===uFe)throw new Error("DDSParser does not support cubemap textures");if(m===6)throw new Error("DDSParser does not supported 3D texture data");const w=new Array,S=gk+aO+k9;if(y===1)w.push(new Uint8Array(r,S));else{const O=TC[x];let _=0,T=s,A=i;for(let N=0;N<o;N++){const k=Math.max(1,T+3&-4),R=Math.max(1,A+3&-4),E=k*R*O;_+=E,T=T>>>1,A=A>>>1}let P=S;for(let N=0;N<y;N++)w.push(new Uint8Array(r,P,_)),P+=_}return w.map(O=>new Qf(O,{format:x,width:s,height:i,levels:o}))}throw l&rFe?new Error("DDSParser does not support uncompressed texture data."):l&sFe?new Error("DDSParser does not supported YUV uncompressed texture data."):l&oFe?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&iFe?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const P9=[171,75,84,88,32,49,49,187,13,10,26,10],mFe=67305985,rl={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},VR=64,R9={[Jt.UNSIGNED_BYTE]:1,[Jt.UNSIGNED_SHORT]:2,[Jt.INT]:4,[Jt.UNSIGNED_INT]:4,[Jt.FLOAT]:4,[Jt.HALF_FLOAT]:8},gFe={[rt.RGBA]:4,[rt.RGB]:3,[rt.RG]:2,[rt.RED]:1,[rt.LUMINANCE]:1,[rt.LUMINANCE_ALPHA]:2,[rt.ALPHA]:1},vFe={[Jt.UNSIGNED_SHORT_4_4_4_4]:2,[Jt.UNSIGNED_SHORT_5_5_5_1]:2,[Jt.UNSIGNED_SHORT_5_6_5]:2};function yFe(r,e,n=!1){const i=new DataView(e);if(!bFe(r,i))return null;const s=i.getUint32(rl.ENDIANNESS,!0)===mFe,o=i.getUint32(rl.GL_TYPE,s),a=i.getUint32(rl.GL_FORMAT,s),l=i.getUint32(rl.GL_INTERNAL_FORMAT,s),h=i.getUint32(rl.PIXEL_WIDTH,s),u=i.getUint32(rl.PIXEL_HEIGHT,s)||1,f=i.getUint32(rl.PIXEL_DEPTH,s)||1,p=i.getUint32(rl.NUMBER_OF_ARRAY_ELEMENTS,s)||1,m=i.getUint32(rl.NUMBER_OF_FACES,s),v=i.getUint32(rl.NUMBER_OF_MIPMAP_LEVELS,s),y=i.getUint32(rl.BYTES_OF_KEY_VALUE_DATA,s);if(u===0||f!==1)throw new Error("Only 2D textures are supported");if(m!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(p!==1)throw new Error("WebGL does not support array textures");const x=4,w=4,S=h+3&-4,O=u+3&-4,_=new Array(p);let T=h*u;o===0&&(T=S*O);let A;if(o!==0?R9[o]?A=R9[o]*gFe[a]:A=vFe[o]:A=TC[l],A===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const P=n?wFe(i,y,s):null;let N=T*A,k=h,R=u,E=S,D=O,$=VR+y;for(let I=0;I<v;I++){const L=i.getUint32($,s);let U=$+4;for(let V=0;V<p;V++){let X=_[V];X||(X=_[V]=new Array(v)),X[I]={levelID:I,levelWidth:v>1||o!==0?k:E,levelHeight:v>1||o!==0?R:D,levelBuffer:new Uint8Array(e,U,N)},U+=N}$+=L+4,$=$%4!==0?$+4-$%4:$,k=k>>1||1,R=R>>1||1,E=k+x-1&~(x-1),D=R+w-1&~(w-1),N=E*D*A}return o!==0?{uncompressed:_.map(I=>{let L=I[0].levelBuffer,U=!1;return o===Jt.FLOAT?L=new Float32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4):o===Jt.UNSIGNED_INT?(U=!0,L=new Uint32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4)):o===Jt.INT&&(U=!0,L=new Int32Array(I[0].levelBuffer.buffer,I[0].levelBuffer.byteOffset,I[0].levelBuffer.byteLength/4)),{resource:new nT(L,{width:I[0].levelWidth,height:I[0].levelHeight}),type:o,format:U?xFe(a):a}}),kvData:P}:{compressed:_.map(I=>new Qf(null,{format:l,width:h,height:u,levels:v,levelBuffers:I})),kvData:P}}function bFe(r,e){for(let n=0;n<P9.length;n++)if(e.getUint8(n)!==P9[n])return console.error(`${r} is not a valid *.ktx file!`),!1;return!0}function xFe(r){switch(r){case rt.RGBA:return rt.RGBA_INTEGER;case rt.RGB:return rt.RGB_INTEGER;case rt.RG:return rt.RG_INTEGER;case rt.RED:return rt.RED_INTEGER;default:return r}}function wFe(r,e,n){const i=new Map;let s=0;for(;s<e;){const o=r.getUint32(VR+s,n),a=VR+s+4,l=3-(o+3)%4;if(o===0||o>e-s){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<o&&r.getUint8(a+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(r.buffer,a,h)),f=new DataView(r.buffer,a+h+1,o-h-1);i.set(u,f),s+=4+o+l}return i}const _Fe={extension:{type:wt.LoadParser,priority:Cl.High},name:"loadDDS",test(r){return Sd(r,".dds")},async load(r,e,n){const i=await(await kt.ADAPTER.fetch(r)).arrayBuffer(),s=pFe(i).map(o=>{const a=new Oi(o,{mipmap:yc.OFF,alphaMode:To.NO_PREMULTIPLIED_ALPHA,resolution:Mh(r),...e.data});return ux(a,n,r)});return s.length===1?s[0]:s},unload(r){Array.isArray(r)?r.forEach(e=>e.destroy(!0)):r.destroy(!0)}};Gt.add(_Fe);const OFe={extension:{type:wt.LoadParser,priority:Cl.High},name:"loadKTX",test(r){return Sd(r,".ktx")},async load(r,e,n){const i=await(await kt.ADAPTER.fetch(r)).arrayBuffer(),{compressed:s,uncompressed:o,kvData:a}=yFe(r,i),l=s??o,h={mipmap:yc.OFF,alphaMode:To.NO_PREMULTIPLIED_ALPHA,resolution:Mh(r),...e.data},u=l.map(f=>{l===o&&Object.assign(h,{type:f.type,format:f.format});const p=f.resource??f,m=new Oi(p,h);return m.ktxKeyValueData=a,ux(m,n,r)});return u.length===1?u[0]:u},unload(r){Array.isArray(r)?r.forEach(e=>e.destroy(!0)):r.destroy(!0)}};Gt.add(OFe);const SFe=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],CFe={extension:wt.ResolveParser,test:r=>{const e=is.extname(r).slice(1);return["basis","ktx","dds"].includes(e)},parse:r=>{var i,s;const e=r.split("."),n=e.pop();if(["ktx","dds"].includes(n)){const o=e.pop();if(SFe.includes(o))return{resolution:parseFloat(((i=kt.RETINA_PREFIX.exec(r))==null?void 0:i[1])??"1"),format:o,src:r}}return{resolution:parseFloat(((s=kt.RETINA_PREFIX.exec(r))==null?void 0:s[1])??"1"),format:n,src:r}}};Gt.add(CFe);const hO=new ki,TFe=4,QK=class qy{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var n;const e=(n=this.renderer)==null?void 0:n.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,n,i,s){const o=new Image;return o.src=await this.base64(e,n,i,s),o}async base64(e,n,i,s){const o=this.canvas(e,s);if(o.toBlob!==void 0)return new Promise((a,l)=>{o.toBlob(h=>{if(!h){l(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>a(u.result),u.onerror=l,u.readAsDataURL(h)},n,i)});if(o.toDataURL!==void 0)return o.toDataURL(n,i);if(o.convertToBlob!==void 0){const a=await o.convertToBlob({type:n,quality:i});return new Promise((l,h)=>{const u=new FileReader;u.onload=()=>l(u.result),u.onerror=h,u.readAsDataURL(a)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,n){const{pixels:i,width:s,height:o,flipY:a,premultipliedAlpha:l}=this._rawPixels(e,n);a&&qy._flipY(i,s,o),l&&qy._unpremultiplyAlpha(i);const h=new oUe(s,o,1),u=new ImageData(new Uint8ClampedArray(i.buffer),s,o);return h.context.putImageData(u,0,0),h.canvas}pixels(e,n){const{pixels:i,width:s,height:o,flipY:a,premultipliedAlpha:l}=this._rawPixels(e,n);return a&&qy._flipY(i,s,o),l&&qy._unpremultiplyAlpha(i),i}_rawPixels(e,n){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let s,o=!1,a=!1,l,h=!1;e&&(e instanceof Rp?l=e:(l=i.generateTexture(e,{region:n,resolution:i.resolution,multisample:i.multisample}),h=!0,n&&(hO.width=n.width,hO.height=n.height,n=hO)));const u=i.gl;if(l){if(s=l.baseTexture.resolution,n=n??l.frame,o=!1,a=l.baseTexture.alphaMode>0&&l.baseTexture.format===rt.RGBA,!h){i.renderTexture.bind(l);const v=l.framebuffer.glFramebuffers[i.CONTEXT_UID];v.blitFramebuffer&&i.framebuffer.bind(v.blitFramebuffer)}}else s=i.resolution,n||(n=hO,n.width=i.width/s,n.height=i.height/s),o=!0,a=this._rendererPremultipliedAlpha,i.renderTexture.bind();const f=Math.max(Math.round(n.width*s),1),p=Math.max(Math.round(n.height*s),1),m=new Uint8Array(TFe*f*p);return u.readPixels(Math.round(n.x*s),Math.round(n.y*s),f,p,u.RGBA,u.UNSIGNED_BYTE,m),h&&(l==null||l.destroy(!0)),{pixels:m,width:f,height:p,flipY:o,premultipliedAlpha:a}}destroy(){this.renderer=null}static _flipY(e,n,i){const s=n<<2,o=i>>1,a=new Uint8Array(s);for(let l=0;l<o;l++){const h=l*s,u=(i-l-1)*s;a.set(e.subarray(h,h+s)),e.copyWithin(h,u,u+s),e.set(a,u)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const n=e.length;for(let i=0;i<n;i+=4){const s=e[i+3];if(s!==0){const o=255.001/s;e[i]=e[i]*o+.5,e[i+1]=e[i+1]*o+.5,e[i+2]=e[i+2]*o+.5}}}};QK.extension={name:"extract",type:wt.RendererSystem};let EFe=QK;Gt.add(EFe);const EC={build(r){const e=r.points;let n,i,s,o,a,l;if(r.type===ms.CIRC){const y=r.shape;n=y.x,i=y.y,a=l=y.radius,s=o=0}else if(r.type===ms.ELIP){const y=r.shape;n=y.x,i=y.y,a=y.width,l=y.height,s=o=0}else{const y=r.shape,x=y.width/2,w=y.height/2;n=y.x+x,i=y.y+w,a=l=Math.max(0,Math.min(y.radius,Math.min(x,w))),s=x-a,o=w-l}if(!(a>=0&&l>=0&&s>=0&&o>=0)){e.length=0;return}const h=Math.ceil(2.3*Math.sqrt(a+l)),u=h*8+(s?4:0)+(o?4:0);if(e.length=u,u===0)return;if(h===0){e.length=8,e[0]=e[6]=n+s,e[1]=e[3]=i+o,e[2]=e[4]=n-s,e[5]=e[7]=i-o;return}let f=0,p=h*4+(s?2:0)+2,m=p,v=u;{const y=s+a,x=o,w=n+y,S=n-y,O=i+x;if(e[f++]=w,e[f++]=O,e[--p]=O,e[--p]=S,o){const _=i-x;e[m++]=S,e[m++]=_,e[--v]=_,e[--v]=w}}for(let y=1;y<h;y++){const x=Math.PI/2*(y/h),w=s+Math.cos(x)*a,S=o+Math.sin(x)*l,O=n+w,_=n-w,T=i+S,A=i-S;e[f++]=O,e[f++]=T,e[--p]=T,e[--p]=_,e[m++]=_,e[m++]=A,e[--v]=A,e[--v]=O}{const y=s,x=o+l,w=n+y,S=n-y,O=i+x,_=i-x;e[f++]=w,e[f++]=O,e[--v]=_,e[--v]=w,s&&(e[f++]=S,e[f++]=O,e[--v]=_,e[--v]=S)}},triangulate(r,e){const n=r.points,i=e.points,s=e.indices;if(n.length===0)return;let o=i.length/2;const a=o;let l,h;if(r.type!==ms.RREC){const f=r.shape;l=f.x,h=f.y}else{const f=r.shape;l=f.x+f.width/2,h=f.y+f.height/2}const u=r.matrix;i.push(r.matrix?u.a*l+u.c*h+u.tx:l,r.matrix?u.b*l+u.d*h+u.ty:h),o++,i.push(n[0],n[1]);for(let f=2;f<n.length;f+=2)i.push(n[f],n[f+1]),s.push(o++,a,o);s.push(a+1,a,o)}};function I9(r,e=!1){const n=r.length;if(n<6)return;let i=0;for(let s=0,o=r[n-2],a=r[n-1];s<n;s+=2){const l=r[s],h=r[s+1];i+=(l-o)*(h+a),o=l,a=h}if(!e&&i>0||e&&i<=0){const s=n/2;for(let o=s+s%2;o<n;o+=2){const a=n-o-2,l=n-o-1,h=o,u=o+1;[r[a],r[h]]=[r[h],r[a]],[r[l],r[u]]=[r[u],r[l]]}}}const jK={build(r){r.points=r.shape.points.slice()},triangulate(r,e){let n=r.points;const i=r.holes,s=e.points,o=e.indices;if(n.length>=6){I9(n,!1);const a=[];for(let u=0;u<i.length;u++){const f=i[u];I9(f.points,!0),a.push(n.length/2),n=n.concat(f.points)}const l=BLe(n,a,2);if(!l)return;const h=s.length/2;for(let u=0;u<l.length;u+=3)o.push(l[u]+h),o.push(l[u+1]+h),o.push(l[u+2]+h);for(let u=0;u<n.length;u++)s.push(n[u])}}},MFe={build(r){const e=r.shape,n=e.x,i=e.y,s=e.width,o=e.height,a=r.points;a.length=0,s>=0&&o>=0&&a.push(n,i,n+s,i,n+s,i+o,n,i+o)},triangulate(r,e){const n=r.points,i=e.points;if(n.length===0)return;const s=i.length/2;i.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(s,s+1,s+2,s+1,s+2,s+3)}},AFe={build(r){EC.build(r)},triangulate(r,e){EC.triangulate(r,e)}};var xa=(r=>(r.MITER="miter",r.BEVEL="bevel",r.ROUND="round",r))(xa||{}),Gu=(r=>(r.BUTT="butt",r.ROUND="round",r.SQUARE="square",r))(Gu||{});const Jg={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(r,e=20){if(!this.adaptive||!r||isNaN(r))return e;let n=Math.ceil(r/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}};class N9{static curveTo(e,n,i,s,o,a){const l=a[a.length-2],h=a[a.length-1]-n,u=l-e,f=s-n,p=i-e,m=Math.abs(h*p-u*f);if(m<1e-8||o===0)return(a[a.length-2]!==e||a[a.length-1]!==n)&&a.push(e,n),null;const v=h*h+u*u,y=f*f+p*p,x=h*f+u*p,w=o*Math.sqrt(v)/m,S=o*Math.sqrt(y)/m,O=w*x/v,_=S*x/y,T=w*p+S*u,A=w*f+S*h,P=u*(S+O),N=h*(S+O),k=p*(w+_),R=f*(w+_),E=Math.atan2(N-A,P-T),D=Math.atan2(R-A,k-T);return{cx:T+e,cy:A+n,radius:o,startAngle:E,endAngle:D,anticlockwise:u*f>p*h}}static arc(e,n,i,s,o,a,l,h,u){const f=l-a,p=Jg._segmentsCount(Math.abs(f)*o,Math.ceil(Math.abs(f)/yC)*40),m=f/(p*2),v=m*2,y=Math.cos(m),x=Math.sin(m),w=p-1,S=w%1/w;for(let O=0;O<=w;++O){const _=O+S*O,T=m+a+v*_,A=Math.cos(T),P=-Math.sin(T);u.push((y*A+x*P)*o+i,(y*-P+x*A)*o+s)}}}class kFe{constructor(){this.reset()}begin(e,n,i){this.reset(),this.style=e,this.start=n,this.attribStart=i}end(e,n){this.attribSize=n-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class K5{static curveLength(e,n,i,s,o,a,l,h){let u=0,f=0,p=0,m=0,v=0,y=0,x=0,w=0,S=0,O=0,_=0,T=e,A=n;for(let P=1;P<=10;++P)f=P/10,p=f*f,m=p*f,v=1-f,y=v*v,x=y*v,w=x*e+3*y*f*i+3*v*p*o+m*l,S=x*n+3*y*f*s+3*v*p*a+m*h,O=T-w,_=A-S,T=w,A=S,u+=Math.sqrt(O*O+_*_);return u}static curveTo(e,n,i,s,o,a,l){const h=l[l.length-2],u=l[l.length-1];l.length-=2;const f=Jg._segmentsCount(K5.curveLength(h,u,e,n,i,s,o,a));let p=0,m=0,v=0,y=0,x=0;l.push(h,u);for(let w=1,S=0;w<=f;++w)S=w/f,p=1-S,m=p*p,v=m*p,y=S*S,x=y*S,l.push(v*h+3*m*S*e+3*p*y*i+x*o,v*u+3*m*S*n+3*p*y*s+x*a)}}function D9(r,e,n,i,s,o,a,l){const h=r-n*s,u=e-i*s,f=r+n*o,p=e+i*o;let m,v;a?(m=i,v=-n):(m=-i,v=n);const y=h+m,x=u+v,w=f+m,S=p+v;return l.push(y,x,w,S),2}function of(r,e,n,i,s,o,a,l){const h=n-r,u=i-e;let f=Math.atan2(h,u),p=Math.atan2(s-r,o-e);l&&f<p?f+=Math.PI*2:!l&&f>p&&(p+=Math.PI*2);let m=f;const v=p-f,y=Math.abs(v),x=Math.sqrt(h*h+u*u),w=(15*y*Math.sqrt(x)/Math.PI>>0)+1,S=v/w;if(m+=S,l){a.push(r,e,n,i);for(let O=1,_=m;O<w;O++,_+=S)a.push(r,e,r+Math.sin(_)*x,e+Math.cos(_)*x);a.push(r,e,s,o)}else{a.push(n,i,r,e);for(let O=1,_=m;O<w;O++,_+=S)a.push(r+Math.sin(_)*x,e+Math.cos(_)*x,r,e);a.push(s,o,r,e)}return w*2}function PFe(r,e){const n=r.shape;let i=r.points||n.points.slice();const s=e.closePointEps;if(i.length===0)return;const o=r.lineStyle,a=new hi(i[0],i[1]),l=new hi(i[i.length-2],i[i.length-1]),h=n.type!==ms.POLY||n.closeStroke,u=Math.abs(a.x-l.x)<s&&Math.abs(a.y-l.y)<s;if(h){i=i.slice(),u&&(i.pop(),i.pop(),l.set(i[i.length-2],i[i.length-1]));const X=(a.x+l.x)*.5,H=(l.y+a.y)*.5;i.unshift(X,H),i.push(X,H)}const f=e.points,p=i.length/2;let m=i.length;const v=f.length/2,y=o.width/2,x=y*y,w=o.miterLimit*o.miterLimit;let S=i[0],O=i[1],_=i[2],T=i[3],A=0,P=0,N=-(O-T),k=S-_,R=0,E=0,D=Math.sqrt(N*N+k*k);N/=D,k/=D,N*=y,k*=y;const $=o.alignment,I=(1-$)*2,L=$*2;h||(o.cap===Gu.ROUND?m+=of(S-N*(I-L)*.5,O-k*(I-L)*.5,S-N*I,O-k*I,S+N*L,O+k*L,f,!0)+2:o.cap===Gu.SQUARE&&(m+=D9(S,O,N,k,I,L,!0,f))),f.push(S-N*I,O-k*I,S+N*L,O+k*L);for(let X=1;X<p-1;++X){S=i[(X-1)*2],O=i[(X-1)*2+1],_=i[X*2],T=i[X*2+1],A=i[(X+1)*2],P=i[(X+1)*2+1],N=-(O-T),k=S-_,D=Math.sqrt(N*N+k*k),N/=D,k/=D,N*=y,k*=y,R=-(T-P),E=_-A,D=Math.sqrt(R*R+E*E),R/=D,E/=D,R*=y,E*=y;const H=_-S,J=O-T,ee=_-A,ne=P-T,ge=H*ee+J*ne,ye=J*ee-ne*H,ce=ye<0;if(Math.abs(ye)<.001*Math.abs(ge)){f.push(_-N*I,T-k*I,_+N*L,T+k*L),ge>=0&&(o.join===xa.ROUND?m+=of(_,T,_-N*I,T-k*I,_-R*I,T-E*I,f,!1)+4:m+=2,f.push(_-R*L,T-E*L,_+R*I,T+E*I));continue}const we=(-N+S)*(-k+T)-(-N+_)*(-k+O),be=(-R+A)*(-E+T)-(-R+_)*(-E+P),se=(H*be-ee*we)/ye,ae=(ne*we-J*be)/ye,Q=(se-_)*(se-_)+(ae-T)*(ae-T),z=_+(se-_)*I,j=T+(ae-T)*I,te=_-(se-_)*L,W=T-(ae-T)*L,Z=Math.min(H*H+J*J,ee*ee+ne*ne),he=ce?I:L,pe=Z+he*he*x,_e=Q<=pe;let Re=o.join;if(Re===xa.MITER&&Q/x>w&&(Re=xa.BEVEL),_e)switch(Re){case xa.MITER:{f.push(z,j,te,W);break}case xa.BEVEL:{ce?f.push(z,j,_+N*L,T+k*L,z,j,_+R*L,T+E*L):f.push(_-N*I,T-k*I,te,W,_-R*I,T-E*I,te,W),m+=2;break}case xa.ROUND:{ce?(f.push(z,j,_+N*L,T+k*L),m+=of(_,T,_+N*L,T+k*L,_+R*L,T+E*L,f,!0)+4,f.push(z,j,_+R*L,T+E*L)):(f.push(_-N*I,T-k*I,te,W),m+=of(_,T,_-N*I,T-k*I,_-R*I,T-E*I,f,!1)+4,f.push(_-R*I,T-E*I,te,W));break}}else{switch(f.push(_-N*I,T-k*I,_+N*L,T+k*L),Re){case xa.MITER:{ce?f.push(te,W,te,W):f.push(z,j,z,j),m+=2;break}case xa.ROUND:{ce?m+=of(_,T,_+N*L,T+k*L,_+R*L,T+E*L,f,!0)+2:m+=of(_,T,_-N*I,T-k*I,_-R*I,T-E*I,f,!1)+2;break}}f.push(_-R*I,T-E*I,_+R*L,T+E*L),m+=2}}S=i[(p-2)*2],O=i[(p-2)*2+1],_=i[(p-1)*2],T=i[(p-1)*2+1],N=-(O-T),k=S-_,D=Math.sqrt(N*N+k*k),N/=D,k/=D,N*=y,k*=y,f.push(_-N*I,T-k*I,_+N*L,T+k*L),h||(o.cap===Gu.ROUND?m+=of(_-N*(I-L)*.5,T-k*(I-L)*.5,_-N*I,T-k*I,_+N*L,T+k*L,f,!1)+2:o.cap===Gu.SQUARE&&(m+=D9(_,T,N,k,I,L,!1,f)));const U=e.indices,V=Jg.epsilon*Jg.epsilon;for(let X=v;X<m+v-2;++X)S=f[X*2],O=f[X*2+1],_=f[(X+1)*2],T=f[(X+1)*2+1],A=f[(X+2)*2],P=f[(X+2)*2+1],!(Math.abs(S*(T-P)+_*(P-O)+A*(O-T))<V)&&U.push(X,X+1,X+2)}function RFe(r,e){let n=0;const i=r.shape,s=r.points||i.points,o=i.type!==ms.POLY||i.closeStroke;if(s.length===0)return;const a=e.points,l=e.indices,h=s.length/2,u=a.length/2;let f=u;for(a.push(s[0],s[1]),n=1;n<h;n++)a.push(s[n*2],s[n*2+1]),l.push(f,f+1),f++;o&&l.push(f,u)}function L9(r,e){r.lineStyle.native?RFe(r,e):PFe(r,e)}class J5{static curveLength(e,n,i,s,o,a){const l=e-2*i+o,h=n-2*s+a,u=2*i-2*e,f=2*s-2*n,p=4*(l*l+h*h),m=4*(l*u+h*f),v=u*u+f*f,y=2*Math.sqrt(p+m+v),x=Math.sqrt(p),w=2*p*x,S=2*Math.sqrt(v),O=m/x;return(w*y+x*m*(y-S)+(4*v*p-m*m)*Math.log((2*x+O+y)/(O+S)))/(4*w)}static curveTo(e,n,i,s,o){const a=o[o.length-2],l=o[o.length-1],h=Jg._segmentsCount(J5.curveLength(a,l,e,n,i,s));let u=0,f=0;for(let p=1;p<=h;++p){const m=p/h;u=a+(e-a)*m,f=l+(n-l)*m,o.push(u+(e+(i-e)*m-u)*m,f+(n+(s-n)*m-f)*m)}}}const vk={[ms.POLY]:jK,[ms.CIRC]:EC,[ms.ELIP]:EC,[ms.RECT]:MFe,[ms.RREC]:AFe},B9=[],uO=[];class MC{constructor(e,n=null,i=null,s=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=n,this.matrix=s,this.type=e.type}clone(){return new MC(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Pm=new hi,YK=class qK extends tK{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new OC,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),uO.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const n=this.batches[e];n.reset(),B9.push(n)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,n=null,i=null,s=null){const o=new MC(e,n,i,s);return this.graphicsData.push(o),this.dirty++,this}drawHole(e,n=null){if(!this.graphicsData.length)return null;const i=new MC(e,null,null,n),s=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=s.lineStyle,s.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const n=this.graphicsData;for(let i=0;i<n.length;++i){const s=n[i];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(e,Pm):Pm.copyFrom(e),s.shape.contains(Pm.x,Pm.y))){let o=!1;if(s.holes){for(let a=0;a<s.holes.length;a++)if(s.holes[a].shape.contains(Pm.x,Pm.y)){o=!0;break}}if(!o)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,n=this.graphicsData;let i=null,s=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],s=i.style);for(let h=this.shapeIndex;h<n.length;h++){this.shapeIndex++;const u=n[h],f=u.fillStyle,p=u.lineStyle;vk[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(f.visible||p.visible)&&this.processHoles(u.holes);for(let m=0;m<2;m++){const v=m===0?f:p;if(!v.visible)continue;const y=v.texture.baseTexture,x=this.indices.length,w=this.points.length/2;y.wrapMode=Zu.REPEAT,m===0?this.processFill(u):this.processLine(u);const S=this.points.length/2-w;S!==0&&(i&&!this._compareStyles(s,v)&&(i.end(x,w),i=null),i||(i=B9.pop()||new kFe,i.begin(v,x,w),this.batches.push(i),s=v),this.addUvs(this.points,e,v.texture,w,S,v.matrix))}}const o=this.indices.length,a=this.points.length/2;if(i&&i.end(o,a),this.batches.length===0){this.batchable=!0;return}const l=a>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&l===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=l?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,n){return!(!e||!n||e.texture.baseTexture!==n.texture.baseTexture||e.color+e.alpha!==n.color+n.alpha||!!e.native!=!!n.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,n=this.graphicsData.length;e<n;e++){const i=this.graphicsData[e],s=i.fillStyle,o=i.lineStyle;if(s&&!s.texture.baseTexture.valid||o&&!o.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let n=0,i=e.length;n<i;n++){const s=e[n];for(let o=0;o<s.size;o++){const a=s.start+o;this.indicesUint16[a]=this.indicesUint16[a]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let n=0;n<e.length;n++)if(e[n].style.native)return!1;return this.points.length<qK.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++Oi._globalBatch;for(let p=0;p<this.drawCalls.length;p++)this.drawCalls[p].texArray.clear(),uO.push(this.drawCalls[p]);this.drawCalls.length=0;const n=this.colors,i=this.textureIds;let s=uO.pop();s||(s=new yR,s.texArray=new _R),s.texArray.count=0,s.start=0,s.size=0,s.type=sc.TRIANGLES;let o=0,a=null,l=0,h=!1,u=sc.TRIANGLES,f=0;this.drawCalls.push(s);for(let p=0;p<this.batches.length;p++){const m=this.batches[p],v=8,y=m.style,x=y.texture.baseTexture;h!==!!y.native&&(h=!!y.native,u=h?sc.LINES:sc.TRIANGLES,a=null,o=v,e++),a!==x&&(a=x,x._batchEnabled!==e&&(o===v&&(e++,o=0,s.size>0&&(s=uO.pop(),s||(s=new yR,s.texArray=new _R),this.drawCalls.push(s)),s.start=f,s.size=0,s.texArray.count=0,s.type=u),x.touched=1,x._batchEnabled=e,x._batchLocation=o,x.wrapMode=Zu.REPEAT,s.texArray.elements[s.texArray.count++]=x,o++)),s.size+=m.size,f+=m.size,l=x._batchLocation,this.addColors(n,y.color,y.alpha,m.attribSize,m.attribStart),this.addTextureIds(i,l,m.attribSize,m.attribStart)}Oi._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,n=this.uvs,i=this.colors,s=this.textureIds,o=new ArrayBuffer(e.length*3*4),a=new Float32Array(o),l=new Uint32Array(o);let h=0;for(let u=0;u<e.length/2;u++)a[h++]=e[u*2],a[h++]=e[u*2+1],a[h++]=n[u*2],a[h++]=n[u*2+1],l[h++]=i[u],a[h++]=s[u];this._buffer.update(o),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?jK.triangulate(e,this):vk[e.type].triangulate(e,this)}processLine(e){L9(e,this);for(let n=0;n<e.holes.length;n++)L9(e.holes[n],this)}processHoles(e){for(let n=0;n<e.length;n++){const i=e[n];vk[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,n){for(let i=0;i<e.length/2;i++){const s=e[i*2],o=e[i*2+1];e[i*2]=n.a*s+n.c*o+n.tx,e[i*2+1]=n.b*s+n.d*o+n.ty}}addColors(e,n,i,s,o=0){const a=Un.shared.setValue(n).toLittleEndianNumber(),l=Un.shared.setValue(a).toPremultiplied(i);e.length=Math.max(e.length,o+s);for(let h=0;h<s;h++)e[o+h]=l}addTextureIds(e,n,i,s=0){e.length=Math.max(e.length,s+i);for(let o=0;o<i;o++)e[s+o]=n}addUvs(e,n,i,s,o,a=null){let l=0;const h=n.length,u=i.frame;for(;l<o;){let p=e[(s+l)*2],m=e[(s+l)*2+1];if(a){const v=a.a*p+a.c*m+a.tx;m=a.b*p+a.d*m+a.ty,p=v}l++,n.push(p/u.width,m/u.height)}const f=i.baseTexture;(u.width<f.width||u.height<f.height)&&this.adjustUvs(n,i,h,o)}adjustUvs(e,n,i,s){const o=n.baseTexture,a=1e-6,l=i+s*2,h=n.frame,u=h.width/o.width,f=h.height/o.height;let p=h.x/h.width,m=h.y/h.height,v=Math.floor(e[i]+a),y=Math.floor(e[i+1]+a);for(let x=i+2;x<l;x+=2)v=Math.min(v,Math.floor(e[x]+a)),y=Math.min(y,Math.floor(e[x+1]+a));p-=v,m-=y;for(let x=i;x<l;x+=2)e[x]=(e[x]+p)*u,e[x+1]=(e[x+1]+m)*f}};YK.BATCHABLE_SIZE=100;let IFe=YK;class lT{constructor(){this.color=16777215,this.alpha=1,this.texture=Wt.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new lT;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=Wt.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class eN extends lT{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Gu.BUTT,this.join=xa.MITER,this.miterLimit=10}clone(){const e=new eN;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Gu.BUTT,this.join=xa.MITER,this.miterLimit=10}}const yk={},FR=class nS extends ss{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new lT,this._lineStyle=new eN,this._matrix=null,this._holeMode=!1,this.state=Sc.for2d(),this._geometry=e||new IFe,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Un(16777215),this.blendMode=di.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new nS(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,n=0,i,s=.5,o=!1){return typeof e=="number"&&(e={width:e,color:n,alpha:i,alignment:s,native:o}),this.lineTextureStyle(e)}lineTextureStyle(e){const n={width:0,texture:Wt.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Gu.BUTT,join:xa.MITER,miterLimit:10};e=Object.assign(n,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.width>0&&e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:i},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,n=this.currentPath.points.length;n>2&&(this.drawShape(this.currentPath),this.currentPath=new Hf,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[n-2],e[n-1]))}else this.currentPath=new Hf,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,n){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=n,this}lineTo(e,n){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,s=i[i.length-2],o=i[i.length-1];return(s!==e||o!==n)&&i.push(e,n),this}_initCurve(e=0,n=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,n]):this.moveTo(e,n)}quadraticCurveTo(e,n,i,s){this._initCurve();const o=this.currentPath.points;return o.length===0&&this.moveTo(0,0),J5.curveTo(e,n,i,s,o),this}bezierCurveTo(e,n,i,s,o,a){return this._initCurve(),K5.curveTo(e,n,i,s,o,a,this.currentPath.points),this}arcTo(e,n,i,s,o){this._initCurve(e,n);const a=this.currentPath.points,l=N9.curveTo(e,n,i,s,o,a);if(l){const{cx:h,cy:u,radius:f,startAngle:p,endAngle:m,anticlockwise:v}=l;this.arc(h,u,f,p,m,v)}return this}arc(e,n,i,s,o,a=!1){if(s===o)return this;if(!a&&o<=s?o+=yC:a&&s<=o&&(s+=yC),o-s===0)return this;const l=e+Math.cos(s)*i,h=n+Math.sin(s)*i,u=this._geometry.closePointEps;let f=this.currentPath?this.currentPath.points:null;if(f){const p=Math.abs(f[f.length-2]-l),m=Math.abs(f[f.length-1]-h);p<u&&m<u||f.push(l,h)}else this.moveTo(l,h),f=this.currentPath.points;return N9.arc(l,h,e,n,i,s,o,a,f),this}beginFill(e=0,n){return this.beginTextureFill({texture:Wt.WHITE,color:e,alpha:n})}normalizeColor(e){const n=Un.shared.setValue(e.color??0);e.color=n.toNumber(),e.alpha??(e.alpha=n.alpha)}beginTextureFill(e){const n={texture:Wt.WHITE,color:16777215,matrix:null};e=Object.assign(n,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:i},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,n,i,s){return this.drawShape(new ki(e,n,i,s))}drawRoundedRect(e,n,i,s,o){return this.drawShape(new sT(e,n,i,s,o))}drawCircle(e,n,i){return this.drawShape(new lx(e,n,i))}drawEllipse(e,n,i,s){return this.drawShape(new rT(e,n,i,s))}drawPolygon(...e){let n,i=!0;const s=e[0];s.points?(i=s.closeStroke,n=s.points):Array.isArray(e[0])?n=e[0]:n=e;const o=new Hf(n);return o.closeStroke=i,this.drawShape(o),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===ms.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const n=this._geometry;n.updateBatches(),n.batchable?(this.batchDirty!==n.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,n=this.blendMode,i=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(e.points);for(let s=0;s<i;s++){const o=e.batches[s],a=o.style.color,l=new Float32Array(this.vertexData.buffer,o.attribStart*4*2,o.attribSize*2),h=new Float32Array(e.uvsFloat32.buffer,o.attribStart*4*2,o.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,o.start*2,o.size),f={vertexData:l,blendMode:n,indices:u,uvs:h,_batchRGB:Un.shared.setValue(a).toRgbArray(),_tintRGB:a,_texture:o.style.texture,alpha:o.style.alpha,worldAlpha:1};this.batches[s]=f}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let n=0,i=this.batches.length;n<i;n++){const s=this.batches[n];s.worldAlpha=this.worldAlpha*s.alpha,e.plugins[this.pluginName].render(s)}}}_renderDirect(e){const n=this._resolveDirectShader(e),i=this._geometry,s=this.worldAlpha,o=n.uniforms,a=i.drawCalls;o.translationMatrix=this.transform.worldTransform,Un.shared.setValue(this._tintColor).premultiply(s).toArray(o.tint),e.shader.bind(n),e.geometry.bind(i,n),e.state.set(this.state);for(let l=0,h=a.length;l<h;l++)this._renderDrawCallDirect(e,i.drawCalls[l])}_renderDrawCallDirect(e,n){const{texArray:i,type:s,size:o,start:a}=n,l=i.count;for(let h=0;h<l;h++)e.texture.bind(i.elements[h],h);e.geometry.draw(s,o,a)}_resolveDirectShader(e){let n=this.shader;const i=this.pluginName;if(!n){if(!yk[i]){const{maxTextures:s}=e.plugins[i],o=new Int32Array(s);for(let h=0;h<s;h++)o[h]=h;const a={tint:new Float32Array([1,1,1,1]),translationMatrix:new Fn,default:ml.from({uSamplers:o},!0)},l=e.plugins[i]._shader.program;yk[i]=new gl(l,a)}n=yk[i]}return n}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:n,minY:i,maxX:s,maxY:o}=e.bounds;this._bounds.addFrame(this.transform,n,i,s,o)}containsPoint(e){return this.worldTransform.applyInverse(e,nS._TEMP_POINT),this._geometry.containsPoint(nS._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const n=this.batches[e];n._tintRGB=Un.shared.setValue(this._tintColor).multiply(n._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const n=this.transform.worldTransform,i=n.a,s=n.b,o=n.c,a=n.d,l=n.tx,h=n.ty,u=this._geometry.points,f=this.vertexData;let p=0;for(let m=0;m<u.length;m+=2){const v=u[m],y=u[m+1];f[p++]=i*v+o*y+l,f[p++]=a*y+s*v+h}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};FR.curves=Jg,FR._TEMP_POINT=new hi;let e0=FR;class NFe{constructor(e,n){this.uvBuffer=e,this.uvMatrix=n,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const n=this.uvBuffer.data;(!this.data||this.data.length!==n.length)&&(this.data=new Float32Array(n.length)),this.uvMatrix.multiplyUvs(n,this.data),this._updateID++}}const bk=new hi,$9=new Hf,ZK=class KK extends ss{constructor(e,n,i,s=sc.TRIANGLES){super(),this.geometry=e,this.shader=n,this.state=i||Sc.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=kt.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===sc.TRIANGLES&&n.length<KK.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const n=this.shader;n.alpha=this.worldAlpha,n.update&&n.update(),e.batch.flush(),n.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(n),e.state.set(this.state),e.geometry.bind(this.geometry,n),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const n=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=n.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const s=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[s]),e.plugins[s].render(this)}calculateVertices(){const e=this.geometry.buffers[0],n=e.data,i=e._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==n.length&&(this.vertexData=new Float32Array(n.length));const s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,h=s.d,u=s.tx,f=s.ty,p=this.vertexData;for(let m=0;m<p.length/2;m++){const v=n[m*2],y=n[m*2+1];p[m*2]=o*v+l*y+u,p[m*2+1]=a*v+h*y+f}if(this._roundPixels){const m=kt.RESOLUTION;for(let v=0;v<p.length;++v)p[v]=Math.round(p[v]*m)/m}this.vertexDirty=i}calculateUvs(){const e=this.geometry.buffers[1],n=this.shader;n.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new NFe(e,n.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,bk);const n=this.geometry.getBuffer("aVertexPosition").data,i=$9.points,s=this.geometry.getIndex().data,o=s.length,a=this.drawMode===4?3:1;for(let l=0;l+2<o;l+=a){const h=s[l]*2,u=s[l+1]*2,f=s[l+2]*2;if(i[0]=n[h],i[1]=n[h+1],i[2]=n[u],i[3]=n[u+1],i[4]=n[f],i[5]=n[f+1],$9.contains(bk.x,bk.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};ZK.BATCHABLE_SIZE=100;let zR=ZK;class DFe extends Ah{constructor(e,n,i){super();const s=new gr(e),o=new gr(n,!0),a=new gr(i,!0,!0);this.addAttribute("aVertexPosition",s,2,!1,Jt.FLOAT).addAttribute("aTextureCoord",o,2,!1,Jt.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var LFe=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,BFe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class U9 extends gl{constructor(e,n){const i={uSampler:e,alpha:1,uTextureMatrix:Fn.IDENTITY,uColor:new Float32Array([1,1,1,1])};n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n),n.uniforms&&Object.assign(i,n.uniforms),super(n.program||ch.from(BFe,LFe),i),this._colorDirty=!1,this.uvMatrix=new mK(e),this.batchable=n.program===void 0,this.pluginName=n.pluginName,this._tintColor=new Un(n.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=n.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Un.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class V9{constructor(e,n,i){this.geometry=new Ah,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let s=0;s<e.length;++s){let o=e[s];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||Jt.FLOAT,offset:o.offset},n[s]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let n=0;this.indexBuffer=new gr(rUe(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let a=0;a<this.dynamicProperties.length;++a){const l=this.dynamicProperties[a];l.offset=n,n+=l.size,this.dynamicStride+=l.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new gr(this.dynamicData,!1,!1);let s=0;this.staticStride=0;for(let a=0;a<this.staticProperties.length;++a){const l=this.staticProperties[a];l.offset=s,s+=l.size,this.staticStride+=l.size}const o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new gr(this.staticData,!0,!1);for(let a=0;a<this.dynamicProperties.length;++a){const l=this.dynamicProperties[a];e.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===Jt.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let a=0;a<this.staticProperties.length;++a){const l=this.staticProperties[a];e.addAttribute(l.attributeName,this.staticBuffer,0,l.type===Jt.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(e,n,i){for(let s=0;s<this.dynamicProperties.length;s++){const o=this.dynamicProperties[s];o.uploadFunction(e,n,i,o.type===Jt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,n,i){for(let s=0;s<this.staticProperties.length;s++){const o=this.staticProperties[s];o.uploadFunction(e,n,i,o.type===Jt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var $Fe=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,UFe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class JK extends oT{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Fn,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Jt.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=gl.from(UFe,$Fe,{}),this.state=Sc.for2d()}render(e){const n=e.children,i=e._maxSize,s=e._batchSize,o=this.renderer;let a=n.length;if(a===0)return;a>i&&!e.autoResize&&(a=i);let l=e._buffers;l||(l=e._buffers=this.generateBuffers(e));const h=n[0]._texture.baseTexture,u=h.alphaMode>0;this.state.blendMode=KZ(e.blendMode,u),o.state.set(this.state);const f=o.gl,p=e.worldTransform.copyTo(this.tempMatrix);p.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=Un.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);let m=!1;for(let v=0,y=0;v<a;v+=s,y+=1){let x=a-v;x>s&&(x=s),y>=l.length&&l.push(this._generateOneMoreBuffer(e));const w=l[y];w.uploadDynamic(n,v,x);const S=e._bufferUpdateIDs[y]||0;m=m||w._updateID<S,m&&(w._updateID=e._updateID,w.uploadStatic(n,v,x)),o.geometry.bind(w.geometry),f.drawElements(f.TRIANGLES,x*6,f.UNSIGNED_SHORT,0)}}generateBuffers(e){const n=[],i=e._maxSize,s=e._batchSize,o=e._properties;for(let a=0;a<i;a+=s)n.push(new V9(this.properties,o,s));return n}_generateOneMoreBuffer(e){const n=e._batchSize,i=e._properties;return new V9(this.properties,i,n)}uploadVertices(e,n,i,s,o,a){let l=0,h=0,u=0,f=0;for(let p=0;p<i;++p){const m=e[n+p],v=m._texture,y=m.scale.x,x=m.scale.y,w=v.trim,S=v.orig;w?(h=w.x-m.anchor.x*S.width,l=h+w.width,f=w.y-m.anchor.y*S.height,u=f+w.height):(l=S.width*(1-m.anchor.x),h=S.width*-m.anchor.x,u=S.height*(1-m.anchor.y),f=S.height*-m.anchor.y),s[a]=h*y,s[a+1]=f*x,s[a+o]=l*y,s[a+o+1]=f*x,s[a+o*2]=l*y,s[a+o*2+1]=u*x,s[a+o*3]=h*y,s[a+o*3+1]=u*x,a+=o*4}}uploadPosition(e,n,i,s,o,a){for(let l=0;l<i;l++){const h=e[n+l].position;s[a]=h.x,s[a+1]=h.y,s[a+o]=h.x,s[a+o+1]=h.y,s[a+o*2]=h.x,s[a+o*2+1]=h.y,s[a+o*3]=h.x,s[a+o*3+1]=h.y,a+=o*4}}uploadRotation(e,n,i,s,o,a){for(let l=0;l<i;l++){const h=e[n+l].rotation;s[a]=h,s[a+o]=h,s[a+o*2]=h,s[a+o*3]=h,a+=o*4}}uploadUvs(e,n,i,s,o,a){for(let l=0;l<i;++l){const h=e[n+l]._texture._uvs;h?(s[a]=h.x0,s[a+1]=h.y0,s[a+o]=h.x1,s[a+o+1]=h.y1,s[a+o*2]=h.x2,s[a+o*2+1]=h.y2,s[a+o*3]=h.x3,s[a+o*3+1]=h.y3,a+=o*4):(s[a]=0,s[a+1]=0,s[a+o]=0,s[a+o+1]=0,s[a+o*2]=0,s[a+o*2+1]=0,s[a+o*3]=0,s[a+o*3+1]=0,a+=o*4)}}uploadTint(e,n,i,s,o,a){for(let l=0;l<i;++l){const h=e[n+l],u=Un.shared.setValue(h._tintRGB).toPremultiplied(h.alpha,h.texture.baseTexture.alphaMode>0);s[a]=u,s[a+o]=u,s[a+o*2]=u,s[a+o*3]=u,a+=o*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}JK.extension={name:"particle",type:wt.RendererPlugin};Gt.add(JK);var cT=(r=>(r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",r))(cT||{});const dO={willReadFrequently:!0},Gl=class Yt{static get experimentalLetterSpacingSupported(){let e=Yt._experimentalLetterSpacingSupported;if(e!==void 0){const n=kt.ADAPTER.getCanvasRenderingContext2D().prototype;e=Yt._experimentalLetterSpacingSupported="letterSpacing"in n||"textLetterSpacing"in n}return e}constructor(e,n,i,s,o,a,l,h,u){this.text=e,this.style=n,this.width=i,this.height=s,this.lines=o,this.lineWidths=a,this.lineHeight=l,this.maxLineWidth=h,this.fontProperties=u}static measureText(e,n,i,s=Yt._canvas){i=i??n.wordWrap;const o=n.toFontString(),a=Yt.measureFont(o);a.fontSize===0&&(a.fontSize=n.fontSize,a.ascent=n.fontSize);const l=s.getContext("2d",dO);l.font=o;const h=(i?Yt.wordWrap(e,n,s):e).split(/(?:\r\n|\r|\n)/),u=new Array(h.length);let f=0;for(let y=0;y<h.length;y++){const x=Yt._measureText(h[y],n.letterSpacing,l);u[y]=x,f=Math.max(f,x)}let p=f+n.strokeThickness;n.dropShadow&&(p+=n.dropShadowDistance);const m=n.lineHeight||a.fontSize+n.strokeThickness;let v=Math.max(m,a.fontSize+n.strokeThickness*2)+n.leading+(h.length-1)*(m+n.leading);return n.dropShadow&&(v+=n.dropShadowDistance),new Yt(e,n,p,v,h,u,m+n.leading,f,a)}static _measureText(e,n,i){let s=!1;Yt.experimentalLetterSpacingSupported&&(Yt.experimentalLetterSpacing?(i.letterSpacing=`${n}px`,i.textLetterSpacing=`${n}px`,s=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let o=i.measureText(e).width;return o>0&&(s?o-=n:o+=(Yt.graphemeSegmenter(e).length-1)*n),o}static wordWrap(e,n,i=Yt._canvas){const s=i.getContext("2d",dO);let o=0,a="",l="";const h=Object.create(null),{letterSpacing:u,whiteSpace:f}=n,p=Yt.collapseSpaces(f),m=Yt.collapseNewlines(f);let v=!p;const y=n.wordWrapWidth+u,x=Yt.tokenize(e);for(let w=0;w<x.length;w++){let S=x[w];if(Yt.isNewline(S)){if(!m){l+=Yt.addLine(a),v=!p,a="",o=0;continue}S=" "}if(p){const _=Yt.isBreakingSpace(S),T=Yt.isBreakingSpace(a[a.length-1]);if(_&&T)continue}const O=Yt.getFromCache(S,u,h,s);if(O>y)if(a!==""&&(l+=Yt.addLine(a),a="",o=0),Yt.canBreakWords(S,n.breakWords)){const _=Yt.wordWrapSplit(S);for(let T=0;T<_.length;T++){let A=_[T],P=A,N=1;for(;_[T+N];){const R=_[T+N];if(!Yt.canBreakChars(P,R,S,T,n.breakWords))A+=R;else break;P=R,N++}T+=N-1;const k=Yt.getFromCache(A,u,h,s);k+o>y&&(l+=Yt.addLine(a),v=!1,a="",o=0),a+=A,o+=k}}else{a.length>0&&(l+=Yt.addLine(a),a="",o=0);const _=w===x.length-1;l+=Yt.addLine(S,!_),v=!1,a="",o=0}else O+o>y&&(v=!1,l+=Yt.addLine(a),a="",o=0),(a.length>0||!Yt.isBreakingSpace(S)||v)&&(a+=S,o+=O)}return l+=Yt.addLine(a,!1),l}static addLine(e,n=!0){return e=Yt.trimRight(e),e=n?`${e}
`:e,e}static getFromCache(e,n,i,s){let o=i[e];return typeof o!="number"&&(o=Yt._measureText(e,n,s)+n,i[e]=o),o}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let n=e.length-1;n>=0;n--){const i=e[n];if(!Yt.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:Yt._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,n){return typeof e!="string"?!1:Yt._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const n=[];let i="";if(typeof e!="string")return n;for(let s=0;s<e.length;s++){const o=e[s],a=e[s+1];if(Yt.isBreakingSpace(o,a)||Yt.isNewline(o)){i!==""&&(n.push(i),i=""),n.push(o);continue}i+=o}return i!==""&&n.push(i),n}static canBreakWords(e,n){return n}static canBreakChars(e,n,i,s,o){return!0}static wordWrapSplit(e){return Yt.graphemeSegmenter(e)}static measureFont(e){if(Yt._fonts[e])return Yt._fonts[e];const n={ascent:0,descent:0,fontSize:0},i=Yt._canvas,s=Yt._context;s.font=e;const o=Yt.METRICS_STRING+Yt.BASELINE_SYMBOL,a=Math.ceil(s.measureText(o).width);let l=Math.ceil(s.measureText(Yt.BASELINE_SYMBOL).width);const h=Math.ceil(Yt.HEIGHT_MULTIPLIER*l);if(l=l*Yt.BASELINE_MULTIPLIER|0,a===0||h===0)return Yt._fonts[e]=n,n;i.width=a,i.height=h,s.fillStyle="#f00",s.fillRect(0,0,a,h),s.font=e,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(o,0,l);const u=s.getImageData(0,0,a,h).data,f=u.length,p=a*4;let m=0,v=0,y=!1;for(m=0;m<l;++m){for(let x=0;x<p;x+=4)if(u[v+x]!==255){y=!0;break}if(!y)v+=p;else break}for(n.ascent=l-m,v=f-p,y=!1,m=h;m>l;--m){for(let x=0;x<p;x+=4)if(u[v+x]!==255){y=!0;break}if(!y)v-=p;else break}return n.descent=m-l,n.fontSize=n.ascent+n.descent,Yt._fonts[e]=n,n}static clearMetrics(e=""){e?delete Yt._fonts[e]:Yt._fonts={}}static get _canvas(){var e;if(!Yt.__canvas){let n;try{const i=new OffscreenCanvas(0,0);if((e=i.getContext("2d",dO))!=null&&e.measureText)return Yt.__canvas=i,i;n=kt.ADAPTER.createCanvas()}catch{n=kt.ADAPTER.createCanvas()}n.width=n.height=10,Yt.__canvas=n}return Yt.__canvas}static get _context(){return Yt.__context||(Yt.__context=Yt._canvas.getContext("2d",dO)),Yt.__context}};Gl.METRICS_STRING="|ÉqÅ",Gl.BASELINE_SYMBOL="M",Gl.BASELINE_MULTIPLIER=1.4,Gl.HEIGHT_MULTIPLIER=2,Gl.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return e=>[...r.segment(e)].map(n=>n.segment)}return r=>[...r]})(),Gl.experimentalLetterSpacing=!1,Gl._fonts={},Gl._newlines=[10,13],Gl._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let ku=Gl;const VFe=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],eJ=class Zy{constructor(e){this.styleID=0,this.reset(),wk(this,e,e)}clone(){const e={};return wk(e,this,Zy.defaultStyle),new Zy(e)}reset(){wk(this,Zy.defaultStyle,Zy.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const n=xk(e);this._dropShadowColor!==n&&(this._dropShadowColor=n,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const n=xk(e);this._fill!==n&&(this._fill=n,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){FFe(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const n=xk(e);this._stroke!==n&&(this._stroke=n,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let n=this.fontFamily;Array.isArray(this.fontFamily)||(n=this.fontFamily.split(","));for(let i=n.length-1;i>=0;i--){let s=n[i].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!VFe.includes(s)&&(s=`"${s}"`),n[i]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${n.join(",")}`}};eJ.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:cT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let fd=eJ;function xk(r){const e=Un.shared,n=i=>{const s=e.setValue(i);return s.alpha===1?s.toHex():s.toRgbaString()};return Array.isArray(r)?r.map(n):n(r)}function FFe(r,e){if(!Array.isArray(r)||!Array.isArray(e)||r.length!==e.length)return!1;for(let n=0;n<r.length;++n)if(r[n]!==e[n])return!1;return!0}function wk(r,e,n){for(const i in n)Array.isArray(e[i])?r[i]=e[i].slice():r[i]=e[i]}const zFe={texture:!0,children:!1,baseTexture:!0},tJ=class XR extends sa{constructor(e,n,i){let s=!1;i||(i=kt.ADAPTER.createCanvas(),s=!0),i.width=3,i.height=3;const o=Wt.from(i);o.orig=new ki,o.trim=new ki,super(o),this._ownCanvas=s,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=XR.defaultResolution??kt.RESOLUTION,this._autoResolution=XR.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=n,this.localStyleID=-1}static get experimentalLetterSpacing(){return ku.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Xi("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ku.experimentalLetterSpacing=e}updateText(e){const n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const i=this.context,s=ku.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,l=s.lines,h=s.lineHeight,u=s.lineWidths,f=s.maxLineWidth,p=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+n.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+n.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=n.strokeThickness,i.textBaseline=n.textBaseline,i.lineJoin=n.lineJoin,i.miterLimit=n.miterLimit;let m,v;const y=n.dropShadow?2:1;for(let x=0;x<y;++x){const w=n.dropShadow&&x===0,S=w?Math.ceil(Math.max(1,a)+n.padding*2):0,O=S*this._resolution;if(w){i.fillStyle="black",i.strokeStyle="black";const T=n.dropShadowColor,A=n.dropShadowBlur*this._resolution,P=n.dropShadowDistance*this._resolution;i.shadowColor=Un.shared.setValue(T).setAlpha(n.dropShadowAlpha).toRgbaString(),i.shadowBlur=A,i.shadowOffsetX=Math.cos(n.dropShadowAngle)*P,i.shadowOffsetY=Math.sin(n.dropShadowAngle)*P+O}else i.fillStyle=this._generateFillStyle(n,l,s),i.strokeStyle=n.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let _=(h-p.fontSize)/2;h-p.fontSize<0&&(_=0);for(let T=0;T<l.length;T++)m=n.strokeThickness/2,v=n.strokeThickness/2+T*h+p.ascent+_,n.align==="right"?m+=f-u[T]:n.align==="center"&&(m+=(f-u[T])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(l[T],m+n.padding,v+n.padding-S,!0),n.fill&&this.drawLetterSpacing(l[T],m+n.padding,v+n.padding-S)}this.updateTexture()}drawLetterSpacing(e,n,i,s=!1){const o=this._style.letterSpacing;let a=!1;if(ku.experimentalLetterSpacingSupported&&(ku.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,a=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),o===0||a){s?this.context.strokeText(e,n,i):this.context.fillText(e,n,i);return}let l=n;const h=ku.graphemeSegmenter(e);let u=this.context.measureText(e).width,f=0;for(let p=0;p<h.length;++p){const m=h[p];s?this.context.strokeText(m,l,i):this.context.fillText(m,l,i);let v="";for(let y=p+1;y<h.length;++y)v+=h[y];f=this.context.measureText(v).width,l+=u-f+o,u=f}}updateTexture(){const e=this.canvas;if(this._style.trim){const a=lUe(e);a.data&&(e.width=a.width,e.height=a.height,this.context.putImageData(a.data,0,0))}const n=this._texture,i=this._style,s=i.trim?0:i.padding,o=n.baseTexture;n.trim.width=n._frame.width=e.width/this._resolution,n.trim.height=n._frame.height=e.height/this._resolution,n.trim.x=-s,n.trim.y=-s,n.orig.width=n._frame.width-s*2,n.orig.height=n._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(e.width,e.height,this._resolution),n.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,n){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,n)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,n,i){const s=e.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let o;const a=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,h=this.canvas.width/this._resolution-a-l*2,u=this.canvas.height/this._resolution-a-l*2,f=s.slice(),p=e.fillGradientStops.slice();if(!p.length){const m=f.length+1;for(let v=1;v<m;++v)p.push(v/m)}if(f.unshift(s[0]),p.unshift(0),f.push(s[s.length-1]),p.push(1),e.fillGradientType===cT.LINEAR_VERTICAL){o=this.context.createLinearGradient(h/2,l,h/2,u+l);const m=i.fontProperties.fontSize+e.strokeThickness;for(let v=0;v<n.length;v++){const y=i.lineHeight*(v-1)+m,x=i.lineHeight*v;let w=x;v>0&&y>x&&(w=(x+y)/2);const S=x+m,O=i.lineHeight*(v+1);let _=S;v+1<n.length&&O<S&&(_=(S+O)/2);const T=(_-w)/u;for(let A=0;A<f.length;A++){let P=0;typeof p[A]=="number"?P=p[A]:P=A/f.length;let N=Math.min(1,Math.max(0,w/u+P*T));N=Number(N.toFixed(5)),o.addColorStop(N,f[A])}}}else{o=this.context.createLinearGradient(l,u/2,h+l,u/2);const m=f.length+1;let v=1;for(let y=0;y<f.length;y++){let x;typeof p[y]=="number"?x=p[y]:x=v/m,o.addColorStop(x,f[y]),v++}}return o}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},zFe,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const n=Wu(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const n=Wu(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof fd?this._style=e:this._style=new fd(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};tJ.defaultAutoResolution=!0;let tN=tJ;class XFe{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function WFe(r,e){var i;let n=!1;if((i=r==null?void 0:r._textures)!=null&&i.length){for(let s=0;s<r._textures.length;s++)if(r._textures[s]instanceof Wt){const o=r._textures[s].baseTexture;e.includes(o)||(e.push(o),n=!0)}}return n}function GFe(r,e){if(r.baseTexture instanceof Oi){const n=r.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function HFe(r,e){if(r._texture&&r._texture instanceof Wt){const n=r._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function QFe(r,e){return e instanceof tN?(e.updateText(!0),!0):!1}function jFe(r,e){if(e instanceof fd){const n=e.toFontString();return ku.measureFont(n),!0}return!1}function YFe(r,e){if(r instanceof tN){e.includes(r.style)||e.push(r.style),e.includes(r)||e.push(r);const n=r._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function qFe(r,e){return r instanceof fd?(e.includes(r)||e.push(r),!0):!1}const iJ=class nJ{constructor(e){this.limiter=new XFe(nJ.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(YFe),this.registerFindHook(qFe),this.registerFindHook(WFe),this.registerFindHook(GFe),this.registerFindHook(HFe),this.registerUploadHook(QFe),this.registerUploadHook(jFe)}upload(e){return new Promise(n=>{e&&this.add(e),this.queue.length?(this.completes.push(n),this.ticking||(this.ticking=!0,ia.system.addOnce(this.tick,this,vp.UTILITY))):n()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let n=!1;if(e&&!e._destroyed){for(let i=0,s=this.uploadHooks.length;i<s;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),n=!0;break}}n||this.queue.shift()}if(this.queue.length)ia.system.addOnce(this.tick,this,vp.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let n=0,i=e.length;n<i;n++)e[n]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let n=0,i=this.addHooks.length;n<i&&!this.addHooks[n](e,this.queue);n++);if(e instanceof ss)for(let n=e.children.length-1;n>=0;n--)this.add(e.children[n]);return this}destroy(){this.ticking&&ia.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};iJ.uploadsPerFrame=4;let WR=iJ;Object.defineProperties(kt,{UPLOADS_PER_FRAME:{get(){return WR.uploadsPerFrame},set(r){Xi("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),WR.uploadsPerFrame=r}}});function rJ(r,e){return e instanceof Oi?(e._glTextures[r.CONTEXT_UID]||r.texture.bind(e),!0):!1}function ZFe(r,e){if(!(e instanceof e0))return!1;const{geometry:n}=e;e.finishPoly(),n.updateBatches();const{batches:i}=n;for(let s=0;s<i.length;s++){const{texture:o}=i[s].style;o&&rJ(r,o.baseTexture)}return n.batchable||r.geometry.bind(n,e._resolveDirectShader(r)),!0}function KFe(r,e){return r instanceof e0?(e.push(r),!0):!1}class sJ extends WR{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(KFe),this.registerUploadHook(rJ),this.registerUploadHook(ZFe)}}sJ.extension={name:"prepare",type:wt.RendererSystem};Gt.add(sJ);var JFe=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,eze=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,tze=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,F9=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,ize=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const fO=new Fn;class oJ extends oT{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new uK,this.state=Sc.for2d()}contextChange(){const e=this.renderer,n={globals:e.globalUniforms};this.simpleShader=gl.from(F9,ize,n),this.shader=e.context.webGLVersion>1?gl.from(eze,JFe,n):gl.from(F9,tze,n)}render(e){const n=this.renderer,i=this.quad;let s=i.vertices;s[0]=s[6]=e._width*-e.anchor.x,s[1]=s[3]=e._height*-e.anchor.y,s[2]=s[4]=e._width*(1-e.anchor.x),s[5]=s[7]=e._height*(1-e.anchor.y);const o=e.uvRespectAnchor?e.anchor.x:0,a=e.uvRespectAnchor?e.anchor.y:0;s=i.uvs,s[0]=s[6]=-o,s[1]=s[3]=-a,s[2]=s[4]=1-o,s[5]=s[7]=1-a,i.invalidate();const l=e._texture,h=l.baseTexture,u=h.alphaMode>0,f=e.tileTransform.localTransform,p=e.uvMatrix;let m=h.isPowerOfTwo&&l.frame.width===h.width&&l.frame.height===h.height;m&&(h._glTextures[n.CONTEXT_UID]?m=h.wrapMode!==Zu.CLAMP:h.wrapMode===Zu.CLAMP&&(h.wrapMode=Zu.REPEAT));const v=m?this.simpleShader:this.shader,y=l.width,x=l.height,w=e._width,S=e._height;fO.set(f.a*y/w,f.b*y/S,f.c*x/w,f.d*x/S,f.tx/w,f.ty/S),fO.invert(),m?fO.prepend(p.mapCoord):(v.uniforms.uMapCoord=p.mapCoord.toArray(!0),v.uniforms.uClampFrame=p.uClampFrame,v.uniforms.uClampOffset=p.uClampOffset),v.uniforms.uTransform=fO.toArray(!0),v.uniforms.uColor=Un.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(v.uniforms.uColor),v.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),v.uniforms.uSampler=l,n.shader.bind(v),n.geometry.bind(i),this.state.blendMode=KZ(e.blendMode,u),n.state.set(this.state),n.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}oJ.extension={name:"tilingSprite",type:wt.RendererPlugin};Gt.add(oJ);const aJ=class Ky{constructor(e,n,i){this.linkedSheets=[],(e instanceof Oi||e instanceof Wt)&&(e={texture:e,data:n,resolutionFilename:i});const{texture:s,data:o,resolutionFilename:a=null,cachePrefix:l=""}=e;this.cachePrefix=l,this._texture=s instanceof Wt?s:null,this.baseTexture=s instanceof Oi?s:this._texture.baseTexture,this.textures={},this.animations={},this.data=o;const h=this.baseTexture.resource;this.resolution=this._updateResolution(a||(h?h.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:n}=this.data.meta;let i=Mh(e,null);return i===null&&(i=typeof n=="number"?n:parseFloat(n??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Ky.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let n=e;const i=Ky.BATCH_SIZE;for(;n-e<i&&n<this._frameKeys.length;){const s=this._frameKeys[n],o=this._frames[s],a=o.frame;if(a){let l=null,h=null;const u=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,f=new ki(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);o.rotated?l=new ki(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):l=new ki(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(h=new ki(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[s]=new Wt(this.baseTexture,l,f,h,o.rotated?2:0,o.anchor,o.borders),Wt.addToCache(this.textures[s],this.cachePrefix+s.toString())}n++}}_processAnimations(){const e=this.data.animations||{};for(const n in e){this.animations[n]=[];for(let i=0;i<e[n].length;i++){const s=e[n][i];this.animations[n].push(this.textures[s])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Ky.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Ky.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var n;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((n=this._texture)==null||n.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};aJ.BATCH_SIZE=1e3;let z9=aJ;const nze=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function lJ(r,e,n){const i={};if(r.forEach(s=>{i[s]=e}),Object.keys(e.textures).forEach(s=>{i[`${e.cachePrefix}${s}`]=e.textures[s]}),!n){const s=is.dirname(r[0]);e.linkedSheets.forEach((o,a)=>{Object.assign(i,lJ([`${s}/${e.data.meta.related_multi_packs[a]}`],o,!0))})}return i}const rze={extension:wt.Asset,cache:{test:r=>r instanceof z9,getCacheableAssets:(r,e)=>lJ(r,e,!1)},resolver:{test:r=>{const e=r.split("?")[0].split("."),n=e.pop(),i=e.pop();return n==="json"&&nze.includes(i)},parse:r=>{var n;const e=r.split(".");return{resolution:parseFloat(((n=kt.RETINA_PREFIX.exec(r))==null?void 0:n[1])??"1"),format:e[e.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:wt.LoadParser,priority:Cl.Normal},async testParse(r,e){return is.extname(e.src).toLowerCase()===".json"&&!!r.frames},async parse(r,e,n){var f,p;const{texture:i,imageFilename:s,cachePrefix:o}=(e==null?void 0:e.data)??{};let a=is.dirname(e.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let l;if(i&&i.baseTexture)l=i;else{const m=$R(a+(s??r.meta.image),e.src);l=(await n.load([m]))[m]}const h=new z9({texture:l.baseTexture,data:r,resolutionFilename:e.src,cachePrefix:o});await h.parse();const u=(f=r==null?void 0:r.meta)==null?void 0:f.related_multi_packs;if(Array.isArray(u)){const m=[];for(const y of u){if(typeof y!="string")continue;let x=a+y;(p=e.data)!=null&&p.ignoreMultiPack||(x=$R(x,e.src),m.push(n.load({src:x,data:{ignoreMultiPack:!0}})))}const v=await Promise.all(m);h.linkedSheets=v,v.forEach(y=>{y.linkedSheets=[h].concat(h.linkedSheets.filter(x=>x!==y))})}return h},unload(r){r.destroy(!0)}}};Gt.add(rze);class AC{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class rS{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const n=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const o in n){const a=n[o].match(/^[a-z]+/gm)[0],l=n[o].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),h={};for(const u in l){const f=l[u].split("="),p=f[0],m=f[1].replace(/"/gm,""),v=parseFloat(m),y=isNaN(v)?m:v;h[p]=y}i[a].push(h)}const s=new AC;return i.info.forEach(o=>s.info.push({face:o.face,size:parseInt(o.size,10)})),i.common.forEach(o=>s.common.push({lineHeight:parseInt(o.lineHeight,10)})),i.page.forEach(o=>s.page.push({id:parseInt(o.id,10),file:o.file})),i.char.forEach(o=>s.char.push({id:parseInt(o.id,10),page:parseInt(o.page,10),x:parseInt(o.x,10),y:parseInt(o.y,10),width:parseInt(o.width,10),height:parseInt(o.height,10),xoffset:parseInt(o.xoffset,10),yoffset:parseInt(o.yoffset,10),xadvance:parseInt(o.xadvance,10)})),i.kerning.forEach(o=>s.kerning.push({first:parseInt(o.first,10),second:parseInt(o.second,10),amount:parseInt(o.amount,10)})),i.distanceField.forEach(o=>s.distanceField.push({distanceRange:parseInt(o.distanceRange,10),fieldType:o.fieldType})),s}}class GR{static test(e){const n=e;return typeof e!="string"&&"getElementsByTagName"in e&&n.getElementsByTagName("page").length&&n.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const n=new AC,i=e.getElementsByTagName("info"),s=e.getElementsByTagName("common"),o=e.getElementsByTagName("page"),a=e.getElementsByTagName("char"),l=e.getElementsByTagName("kerning"),h=e.getElementsByTagName("distanceField");for(let u=0;u<i.length;u++)n.info.push({face:i[u].getAttribute("face"),size:parseInt(i[u].getAttribute("size"),10)});for(let u=0;u<s.length;u++)n.common.push({lineHeight:parseInt(s[u].getAttribute("lineHeight"),10)});for(let u=0;u<o.length;u++)n.page.push({id:parseInt(o[u].getAttribute("id"),10)||0,file:o[u].getAttribute("file")});for(let u=0;u<a.length;u++){const f=a[u];n.char.push({id:parseInt(f.getAttribute("id"),10),page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xoffset:parseInt(f.getAttribute("xoffset"),10),yoffset:parseInt(f.getAttribute("yoffset"),10),xadvance:parseInt(f.getAttribute("xadvance"),10)})}for(let u=0;u<l.length;u++)n.kerning.push({first:parseInt(l[u].getAttribute("first"),10),second:parseInt(l[u].getAttribute("second"),10),amount:parseInt(l[u].getAttribute("amount"),10)});for(let u=0;u<h.length;u++)n.distanceField.push({fieldType:h[u].getAttribute("fieldType"),distanceRange:parseInt(h[u].getAttribute("distanceRange"),10)});return n}}class HR{static test(e){return typeof e=="string"&&e.includes("<font>")?GR.test(kt.ADAPTER.parseXML(e)):!1}static parse(e){return GR.parse(kt.ADAPTER.parseXML(e))}}const _k=[rS,GR,HR];function sze(r){for(let e=0;e<_k.length;e++)if(_k[e].test(r))return _k[e];return null}function oze(r,e,n,i,s,o){const a=n.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let l;const h=n.dropShadow?n.dropShadowDistance:0,u=n.padding||0,f=r.width/i-h-u*2,p=r.height/i-h-u*2,m=a.slice(),v=n.fillGradientStops.slice();if(!v.length){const y=m.length+1;for(let x=1;x<y;++x)v.push(x/y)}if(m.unshift(a[0]),v.unshift(0),m.push(a[a.length-1]),v.push(1),n.fillGradientType===cT.LINEAR_VERTICAL){l=e.createLinearGradient(f/2,u,f/2,p+u);let y=0;const x=(o.fontProperties.fontSize+n.strokeThickness)/p;for(let w=0;w<s.length;w++){const S=o.lineHeight*w;for(let O=0;O<m.length;O++){let _=0;typeof v[O]=="number"?_=v[O]:_=O/m.length;const T=S/p+_*x;let A=Math.max(y,T);A=Math.min(A,1),l.addColorStop(A,m[O]),y=A}}}else{l=e.createLinearGradient(u,p/2,f+u,p/2);const y=m.length+1;let x=1;for(let w=0;w<m.length;w++){let S;typeof v[w]=="number"?S=v[w]:S=x/y,l.addColorStop(S,m[w]),x++}}return l}function aze(r,e,n,i,s,o,a){const l=n.text,h=n.fontProperties;e.translate(i,s),e.scale(o,o);const u=a.strokeThickness/2,f=-(a.strokeThickness/2);if(e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=oze(r,e,a,o,[l],n),e.strokeStyle=a.stroke,a.dropShadow){const p=a.dropShadowColor,m=a.dropShadowBlur*o,v=a.dropShadowDistance*o;e.shadowColor=Un.shared.setValue(p).setAlpha(a.dropShadowAlpha).toRgbaString(),e.shadowBlur=m,e.shadowOffsetX=Math.cos(a.dropShadowAngle)*v,e.shadowOffsetY=Math.sin(a.dropShadowAngle)*v}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;a.stroke&&a.strokeThickness&&e.strokeText(l,u,f+n.lineHeight-h.descent),a.fill&&e.fillText(l,u,f+n.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function sS(r){return r.codePointAt?r.codePointAt(0):r.charCodeAt(0)}function cJ(r){return Array.from?Array.from(r):r.split("")}function lze(r){typeof r=="string"&&(r=[r]);const e=[];for(let n=0,i=r.length;n<i;n++){const s=r[n];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);const o=s[0].charCodeAt(0),a=s[1].charCodeAt(0);if(a<o)throw new Error("[BitmapFont]: Invalid character range.");for(let l=o,h=a;l<=h;l++)e.push(String.fromCharCode(l))}else e.push(...cJ(s))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const _u=class Hl{constructor(e,n,i){var f;const[s]=e.info,[o]=e.common,[a]=e.page,[l]=e.distanceField,h=Mh(a.file),u={};this._ownsTextures=i,this.font=s.face,this.size=s.size,this.lineHeight=o.lineHeight/h,this.chars={},this.pageTextures=u;for(let p=0;p<e.page.length;p++){const{id:m,file:v}=e.page[p];u[m]=n instanceof Array?n[p]:n[v],l!=null&&l.fieldType&&l.fieldType!=="none"&&(u[m].baseTexture.alphaMode=To.NO_PREMULTIPLIED_ALPHA,u[m].baseTexture.mipmap=yc.OFF)}for(let p=0;p<e.char.length;p++){const{id:m,page:v}=e.char[p];let{x:y,y:x,width:w,height:S,xoffset:O,yoffset:_,xadvance:T}=e.char[p];y/=h,x/=h,w/=h,S/=h,O/=h,_/=h,T/=h;const A=new ki(y+u[v].frame.x/h,x+u[v].frame.y/h,w,S);this.chars[m]={xOffset:O,yOffset:_,xAdvance:T,kerning:{},texture:new Wt(u[v].baseTexture,A),page:v}}for(let p=0;p<e.kerning.length;p++){let{first:m,second:v,amount:y}=e.kerning[p];m/=h,v/=h,y/=h,this.chars[v]&&(this.chars[v].kerning[m]=y)}this.distanceFieldRange=l==null?void 0:l.distanceRange,this.distanceFieldType=((f=l==null?void 0:l.fieldType)==null?void 0:f.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,n,i){let s;if(e instanceof AC)s=e;else{const a=sze(e);if(!a)throw new Error("Unrecognized data format for font.");s=a.parse(e)}n instanceof Wt&&(n=[n]);const o=new Hl(s,n,i);return Hl.available[o.font]=o,o}static uninstall(e){const n=Hl.available[e];if(!n)throw new Error(`No font found named '${e}'`);n.destroy(),delete Hl.available[e]}static from(e,n,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:o,resolution:a,textureWidth:l,textureHeight:h,...u}=Object.assign({},Hl.defaultOptions,i),f=lze(s),p=n instanceof fd?n:new fd(n),m=l,v=new AC;v.info[0]={face:p.fontFamily,size:p.fontSize},v.common[0]={lineHeight:p.fontSize};let y=0,x=0,w,S,O,_=0;const T=[];for(let P=0;P<f.length;P++){w||(w=kt.ADAPTER.createCanvas(),w.width=l,w.height=h,S=w.getContext("2d"),O=new Oi(w,{resolution:a,...u}),T.push(new Wt(O)),v.page.push({id:T.length-1,file:""}));const N=f[P],k=ku.measureText(N,p,!1,w),R=k.width,E=Math.ceil(k.height),D=Math.ceil((p.fontStyle==="italic"?2:1)*R);if(x>=h-E*a){if(x===0)throw new Error(`[BitmapFont] textureHeight ${h}px is too small (fontFamily: '${p.fontFamily}', fontSize: ${p.fontSize}px, char: '${N}')`);--P,w=null,S=null,O=null,x=0,y=0,_=0;continue}if(_=Math.max(E+k.fontProperties.descent,_),D*a+y>=m){if(y===0)throw new Error(`[BitmapFont] textureWidth ${l}px is too small (fontFamily: '${p.fontFamily}', fontSize: ${p.fontSize}px, char: '${N}')`);--P,x+=_*a,x=Math.ceil(x),y=0,_=0;continue}aze(w,S,k,y,x,a,p);const $=sS(k.text);v.char.push({id:$,page:T.length-1,x:y/a,y:x/a,width:D,height:E,xoffset:0,yoffset:0,xadvance:R-(p.dropShadow?p.dropShadowDistance:0)-(p.stroke?p.strokeThickness:0)}),y+=(D+2*o)*a,y=Math.ceil(y)}if(!(i!=null&&i.skipKerning))for(let P=0,N=f.length;P<N;P++){const k=f[P];for(let R=0;R<N;R++){const E=f[R],D=S.measureText(k).width,$=S.measureText(E).width,I=S.measureText(k+E).width-(D+$);I&&v.kerning.push({first:sS(k),second:sS(E),amount:I})}}const A=new Hl(v,T,!0);return Hl.available[e]!==void 0&&Hl.uninstall(e),Hl.available[e]=A,A}};_u.ALPHA=[["a","z"],["A","Z"]," "],_u.NUMERIC=[["0","9"]],_u.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],_u.ASCII=[[" ","~"]],_u.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_u.ALPHANUMERIC},_u.available={};let Ou=_u;var cze=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,hze=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const X9=[],W9=[],G9=[],uze=class hJ extends ss{constructor(e,n={}){super();const{align:i,tint:s,maxWidth:o,letterSpacing:a,fontName:l,fontSize:h}=Object.assign({},hJ.styleDefaults,n);if(!Ou.available[l])throw new Error(`Missing BitmapFont "${l}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new Un(s),this._font=void 0,this._fontName=l,this._fontSize=h,this.text=e,this._maxWidth=o,this._maxLineHeight=0,this._letterSpacing=a,this._anchor=new lh(()=>{this.dirty=!0},this,0,0),this._roundPixels=kt.ROUND_PIXELS,this.dirty=!0,this._resolution=kt.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var D;const e=Ou.available[this._fontName],n=this.fontSize,i=n/e.size,s=new hi,o=[],a=[],l=[],h=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=cJ(h),f=this._maxWidth*e.size/n,p=e.distanceFieldType==="none"?X9:W9;let m=null,v=0,y=0,x=0,w=-1,S=0,O=0,_=0,T=0;for(let $=0;$<u.length;$++){const I=u[$],L=sS(I);if(/(?:\s)/.test(I)&&(w=$,S=v,T++),I==="\r"||I===`
`){a.push(v),l.push(-1),y=Math.max(y,v),++x,++O,s.x=0,s.y+=e.lineHeight,m=null,T=0;continue}const U=e.chars[L];if(!U)continue;m&&U.kerning[m]&&(s.x+=U.kerning[m]);const V=G9.pop()||{texture:Wt.EMPTY,line:0,charCode:0,prevSpaces:0,position:new hi};V.texture=U.texture,V.line=x,V.charCode=L,V.position.x=Math.round(s.x+U.xOffset+this._letterSpacing/2),V.position.y=Math.round(s.y+U.yOffset),V.prevSpaces=T,o.push(V),v=V.position.x+Math.max(U.xAdvance-U.xOffset,U.texture.orig.width),s.x+=U.xAdvance+this._letterSpacing,_=Math.max(_,U.yOffset+U.texture.height),m=L,w!==-1&&f>0&&s.x>f&&(++O,Tg(o,1+w-O,1+$-w),$=w,w=-1,a.push(S),l.push(o.length>0?o[o.length-1].prevSpaces:0),y=Math.max(y,S),x++,s.x=0,s.y+=e.lineHeight,m=null,T=0)}const A=u[u.length-1];A!=="\r"&&A!==`
`&&(/(?:\s)/.test(A)&&(v=S),a.push(v),y=Math.max(y,v),l.push(-1));const P=[];for(let $=0;$<=x;$++){let I=0;this._align==="right"?I=y-a[$]:this._align==="center"?I=(y-a[$])/2:this._align==="justify"&&(I=l[$]<0?0:(y-a[$])/l[$]),P.push(I)}const N=o.length,k={},R=[],E=this._activePagesMeshData;p.push(...E);for(let $=0;$<N;$++){const I=o[$].texture,L=I.baseTexture.uid;if(!k[L]){let U=p.pop();if(!U){const X=new DFe;let H,J;e.distanceFieldType==="none"?(H=new U9(Wt.EMPTY),J=di.NORMAL):(H=new U9(Wt.EMPTY,{program:ch.from(hze,cze),uniforms:{uFWidth:0}}),J=di.NORMAL_NPM);const ee=new zR(X,H);ee.blendMode=J,U={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:ee,vertices:null,uvs:null,indices:null}}U.index=0,U.indexCount=0,U.vertexCount=0,U.uvsCount=0,U.total=0;const{_textureCache:V}=this;V[L]=V[L]||new Wt(I.baseTexture),U.mesh.texture=V[L],U.mesh.tint=this._tintColor.value,R.push(U),k[L]=U}k[L].total++}for(let $=0;$<E.length;$++)R.includes(E[$])||this.removeChild(E[$].mesh);for(let $=0;$<R.length;$++)R[$].mesh.parent!==this&&this.addChild(R[$].mesh);this._activePagesMeshData=R;for(const $ in k){const I=k[$],L=I.total;if(!(((D=I.indices)==null?void 0:D.length)>6*L)||I.vertices.length<zR.BATCHABLE_SIZE*2)I.vertices=new Float32Array(4*2*L),I.uvs=new Float32Array(4*2*L),I.indices=new Uint16Array(6*L);else{const U=I.total,V=I.vertices;for(let X=U*4*2;X<V.length;X++)V[X]=0}I.mesh.size=6*L}for(let $=0;$<N;$++){const I=o[$];let L=I.position.x+P[I.line]*(this._align==="justify"?I.prevSpaces:1);this._roundPixels&&(L=Math.round(L));const U=L*i,V=I.position.y*i,X=I.texture,H=k[X.baseTexture.uid],J=X.frame,ee=X._uvs,ne=H.index++;H.indices[ne*6+0]=0+ne*4,H.indices[ne*6+1]=1+ne*4,H.indices[ne*6+2]=2+ne*4,H.indices[ne*6+3]=0+ne*4,H.indices[ne*6+4]=2+ne*4,H.indices[ne*6+5]=3+ne*4,H.vertices[ne*8+0]=U,H.vertices[ne*8+1]=V,H.vertices[ne*8+2]=U+J.width*i,H.vertices[ne*8+3]=V,H.vertices[ne*8+4]=U+J.width*i,H.vertices[ne*8+5]=V+J.height*i,H.vertices[ne*8+6]=U,H.vertices[ne*8+7]=V+J.height*i,H.uvs[ne*8+0]=ee.x0,H.uvs[ne*8+1]=ee.y0,H.uvs[ne*8+2]=ee.x1,H.uvs[ne*8+3]=ee.y1,H.uvs[ne*8+4]=ee.x2,H.uvs[ne*8+5]=ee.y2,H.uvs[ne*8+6]=ee.x3,H.uvs[ne*8+7]=ee.y3}this._textWidth=y*i,this._textHeight=(s.y+e.lineHeight)*i;for(const $ in k){const I=k[$];if(this.anchor.x!==0||this.anchor.y!==0){let X=0;const H=this._textWidth*this.anchor.x,J=this._textHeight*this.anchor.y;for(let ee=0;ee<I.total;ee++)I.vertices[X++]-=H,I.vertices[X++]-=J,I.vertices[X++]-=H,I.vertices[X++]-=J,I.vertices[X++]-=H,I.vertices[X++]-=J,I.vertices[X++]-=H,I.vertices[X++]-=J}this._maxLineHeight=_*i;const L=I.mesh.geometry.getBuffer("aVertexPosition"),U=I.mesh.geometry.getBuffer("aTextureCoord"),V=I.mesh.geometry.getIndex();L.data=I.vertices,U.data=I.uvs,V.data=I.indices,L.update(),U.update(),V.update()}for(let $=0;$<o.length;$++)G9.push(o[$]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:n,distanceFieldType:i,size:s}=Ou.available[this._fontName];if(i!=="none"){const{a:o,b:a,c:l,d:h}=this.worldTransform,u=Math.sqrt(o*o+a*a),f=Math.sqrt(l*l+h*h),p=(Math.abs(u)+Math.abs(f))/2,m=this.fontSize/s,v=e._view.resolution;for(const y of this._activePagesMeshData)y.mesh.shader.uniforms.uFWidth=p*n*m*v}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=Ou.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let n=0;n<this._activePagesMeshData.length;n++)this._activePagesMeshData[n].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Ou.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Ou.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:n}=this,i=Ou.available[this._fontName].distanceFieldType==="none"?X9:W9;i.push(...this._activePagesMeshData);for(const s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],i.filter(s=>n[s.mesh.texture.baseTexture.uid]).forEach(s=>{s.mesh.texture=Wt.EMPTY});for(const s in n)n[s].destroy(),delete n[s];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};uze.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const dze=[".xml",".fnt"],fze={extension:{type:wt.LoadParser,priority:Cl.Normal},name:"loadBitmapFont",test(r){return dze.includes(is.extname(r).toLowerCase())},async testParse(r){return rS.test(r)||HR.test(r)},async parse(r,e,n){const i=rS.test(r)?rS.parse(r):HR.parse(r),{src:s}=e,{page:o}=i,a=[];for(let u=0;u<o.length;++u){const f=o[u].file;let p=is.join(is.dirname(s),f);p=$R(p,s),a.push(p)}const l=await n.load(a),h=a.map(u=>l[u]);return Ou.install(i,h,!0)},async load(r,e){return(await kt.ADAPTER.fetch(r)).text()},unload(r){r.destroy()}};Gt.add(fze);const QR=class Wm extends fd{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new Wm(Object.keys(Wm.defaultOptions).reduce((n,i)=>({...n,[i]:e[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete Wm.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,n={}){const{availableFonts:i}=Wm;if(i[e]){const s=i[e];return this._fonts.push(s),s.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return kt.ADAPTER.fetch(e).then(s=>s.blob()).then(async s=>new Promise((o,a)=>{const l=URL.createObjectURL(s),h=new FileReader;h.onload=()=>o([l,h.result]),h.onerror=a,h.readAsDataURL(s)})).then(async([s,o])=>{const a=Object.assign({family:is.basename(e,is.extname(e)),weight:"normal",style:"normal",display:"auto",src:s,dataSrc:o,refs:1,originalUrl:e,fontFace:null},n);i[e]=a,this._fonts.push(a),this.styleID++;const l=new FontFace(a.family,`url(${a.src})`,{weight:a.weight,style:a.style,display:a.display});a.fontFace=l,await l.load(),document.fonts.add(l),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const n=e.filter(i=>!this._overrides.includes(i));n.length>0&&(this._overrides.push(...n),this.styleID++)}removeOverride(...e){const n=e.filter(i=>this._overrides.includes(i));n.length>0&&(this._overrides=this._overrides.filter(i=>!n.includes(i)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,n)=>`${e}
            @font-face {
                font-family: "${n.family}";
                src: url('${n.dataSrc}');
                font-weight: ${n.weight};
                font-style: ${n.style};
                font-display: ${n.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=iUe(e)),typeof e=="number"?tUe(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const n=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&n<1&&(e+=(n*255|0).toString(16).padStart(2,"0"));const o=`${i}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${o} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${o} ${e}`}reset(){Object.assign(this,Wm.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(n=>setTimeout(n,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=kt.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};QR.availableFonts={},QR.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Ok=QR;const pO=class Gm extends sa{constructor(e="",n={}){super(Wt.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,s=Wt.from(i,{scaleMode:kt.SCALE_MODE,resourceOptions:{autoLoad:!1}});s.orig=new ki,s.trim=new ki,this.texture=s;const o="http://www.w3.org/2000/svg",a="http://www.w3.org/1999/xhtml",l=document.createElementNS(o,"svg"),h=document.createElementNS(o,"foreignObject"),u=document.createElementNS(a,"div"),f=document.createElementNS(a,"style");h.setAttribute("width","10000"),h.setAttribute("height","10000"),h.style.overflow="hidden",l.appendChild(h),this.maxWidth=Gm.defaultMaxWidth,this.maxHeight=Gm.defaultMaxHeight,this._domElement=u,this._styleElement=f,this._svgRoot=l,this._foreignObject=h,this._foreignObject.appendChild(f),this._foreignObject.appendChild(u),this._image=i,this._loadImage=new Image,this._autoResolution=Gm.defaultAutoResolution,this._resolution=Gm.defaultResolution??kt.RESOLUTION,this.text=e,this.style=n}measureText(e){var f,p;const{text:n,style:i,resolution:s}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:n,style:i.toCSS(s)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const o=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:a,height:l}=o;(a>this.maxWidth||l>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const h=Math.min(this.maxWidth,Math.ceil(a)),u=Math.min(this.maxHeight,Math.ceil(l));return this._svgRoot.setAttribute("width",h.toString()),this._svgRoot.setAttribute("height",u.toString()),n!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(f=this._style)==null?void 0:f.toCSS(s)}),this._styleElement.textContent=(p=this._style)==null?void 0:p.toGlobalCSS()),{width:h+i.padding*2,height:u+i.padding*2}}async updateText(e=!0){const{style:n,_image:i,_loadImage:s}=this;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),!this.dirty&&e)return;const{width:o,height:a}=this.measureText();i.width=s.width=Math.ceil(Math.max(1,o)),i.height=s.height=Math.ceil(Math.max(1,a)),this._updateID++;const l=this._updateID;await new Promise(h=>{s.onload=async()=>{if(l<this._updateID){h();return}await n.onBeforeDraw(),i.src=s.src,s.onload=null,s.src="",this.updateTexture(),h()};const u=new XMLSerializer().serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(u)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:n,_image:i,resolution:s}=this,{padding:o}=e,{baseTexture:a}=n;n.trim.width=n._frame.width=i.width/s,n.trim.height=n._frame.height=i.height/s,n.trim.x=-o,n.trim.y=-o,n.orig.width=n._frame.width-o*2,n.orig.height=n._frame.height-o*2,this._onTextureUpdate(),a.setRealSize(i.width,i.height,s),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var i,s,o,a,l;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Gm.defaultDestroyOptions,e),super.destroy(e);const n=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=n,(s=this._svgRoot)==null||s.remove(),this._svgRoot=n,(o=this._domElement)==null||o.remove(),this._domElement=n,(a=this._foreignObject)==null||a.remove(),this._foreignObject=n,(l=this._styleElement)==null||l.remove(),this._styleElement=n,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=n,this._image.src="",this._image=n}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const n=Wu(this.scale.x)||1;this.scale.x=n*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const n=Wu(this.scale.y)||1;this.scale.y=n*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Ok?(this.ownsStyle=!1,this._style=e):e instanceof fd?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Ok.from(e)):(this.ownsStyle=!0,this._style=new Ok(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};pO.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},pO.defaultMaxWidth=2024,pO.defaultMaxHeight=2024,pO.defaultAutoResolution=!0;const{abs:Cy,cos:Hc,sin:Rm,acos:pze,atan2:Ty,sqrt:vu,pow:ya}=Math;function Ey(r){return r<0?-ya(-r,1/3):ya(r,1/3)}const uJ=Math.PI,mO=2*uJ,yu=uJ/2,mze=1e-6,Sk=Number.MAX_SAFE_INTEGER||9007199254740991,Ck=Number.MIN_SAFE_INTEGER||-9007199254740991,gze={x:0,y:0,z:0},st={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,e){const n=e(r);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),vu(i)},compute:function(r,e,n){if(r===0)return e[0].t=0,e[0];const i=e.length-1;if(r===1)return e[i].t=1,e[i];const s=1-r;let o=e;if(i===0)return e[0].t=r,e[0];if(i===1){const l={x:s*o[0].x+r*o[1].x,y:s*o[0].y+r*o[1].y,t:r};return n&&(l.z=s*o[0].z+r*o[1].z),l}if(i<4){let l=s*s,h=r*r,u,f,p,m=0;i===2?(o=[o[0],o[1],o[2],gze],u=l,f=s*r*2,p=h):i===3&&(u=l*s,f=l*r*3,p=s*h*3,m=r*h);const v={x:u*o[0].x+f*o[1].x+p*o[2].x+m*o[3].x,y:u*o[0].y+f*o[1].y+p*o[2].y+m*o[3].y,t:r};return n&&(v.z=u*o[0].z+f*o[1].z+p*o[2].z+m*o[3].z),v}const a=JSON.parse(JSON.stringify(e));for(;a.length>1;){for(let l=0;l<a.length-1;l++)a[l]={x:a[l].x+(a[l+1].x-a[l].x)*r,y:a[l].y+(a[l+1].y-a[l].y)*r},typeof a[l].z<"u"&&(a[l].z=a[l].z+(a[l+1].z-a[l].z)*r);a.splice(a.length-1,1)}return a[0].t=r,a[0]},computeWithRatios:function(r,e,n,i){const s=1-r,o=n,a=e;let l=o[0],h=o[1],u=o[2],f=o[3],p;if(l*=s,h*=r,a.length===2)return p=l+h,{x:(l*a[0].x+h*a[1].x)/p,y:(l*a[0].y+h*a[1].y)/p,z:i?(l*a[0].z+h*a[1].z)/p:!1,t:r};if(l*=s,h*=2*s,u*=r*r,a.length===3)return p=l+h+u,{x:(l*a[0].x+h*a[1].x+u*a[2].x)/p,y:(l*a[0].y+h*a[1].y+u*a[2].y)/p,z:i?(l*a[0].z+h*a[1].z+u*a[2].z)/p:!1,t:r};if(l*=s,h*=1.5*s,u*=3*s,f*=r*r*r,a.length===4)return p=l+h+u+f,{x:(l*a[0].x+h*a[1].x+u*a[2].x+f*a[3].x)/p,y:(l*a[0].y+h*a[1].y+u*a[2].y+f*a[3].y)/p,z:i?(l*a[0].z+h*a[1].z+u*a[2].z+f*a[3].z)/p:!1,t:r}},derive:function(r,e){const n=[];for(let i=r,s=i.length,o=s-1;s>1;s--,o--){const a=[];for(let l=0,h;l<o;l++)h={x:o*(i[l+1].x-i[l].x),y:o*(i[l+1].y-i[l].y)},e&&(h.z=o*(i[l+1].z-i[l].z)),a.push(h);n.push(a),i=a}return n},between:function(r,e,n){return e<=r&&r<=n||st.approximately(r,e)||st.approximately(r,n)},approximately:function(r,e,n){return Cy(r-e)<=(n||mze)},length:function(r){const n=st.Tvalues.length;let i=0;for(let s=0,o;s<n;s++)o=.5*st.Tvalues[s]+.5,i+=st.Cvalues[s]*st.arcfn(o,r);return .5*i},map:function(r,e,n,i,s){const o=n-e,a=s-i,l=r-e,h=l/o;return i+a*h},lerp:function(r,e,n){const i={x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(i.z=e.z+r*(n.z-e.z)),i},pointToString:function(r){let e=r.x+"/"+r.y;return typeof r.z<"u"&&(e+="/"+r.z),e},pointsToString:function(r){return"["+r.map(st.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,e,n){const i=e.x-r.x,s=e.y-r.y,o=n.x-r.x,a=n.y-r.y,l=i*a-s*o,h=i*o+s*a;return Ty(l,h)},round:function(r,e){const n=""+r,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(r,e){const n=r.x-e.x,i=r.y-e.y;return vu(n*n+i*i)},closest:function(r,e){let n=ya(2,63),i,s;return r.forEach(function(o,a){s=st.dist(e,o),s<n&&(n=s,i=a)}),{mdist:n,mpos:i}},abcratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=ya(r,e)+ya(1-r,e),i=n-1;return Cy(i/n)},projectionratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=ya(1-r,e),i=ya(r,e)+n;return n/i},lli8:function(r,e,n,i,s,o,a,l){const h=(r*i-e*n)*(s-a)-(r-n)*(s*l-o*a),u=(r*i-e*n)*(o-l)-(e-i)*(s*l-o*a),f=(r-n)*(o-l)-(e-i)*(s-a);return f==0?!1:{x:h/f,y:u/f}},lli4:function(r,e,n,i){const s=r.x,o=r.y,a=e.x,l=e.y,h=n.x,u=n.y,f=i.x,p=i.y;return st.lli8(s,o,a,l,h,u,f,p)},lli:function(r,e){return st.lli4(r,r.c,e,e.c)},makeline:function(r,e){return new An(r.x,r.y,(r.x+e.x)/2,(r.y+e.y)/2,e.x,e.y)},findbbox:function(r){let e=Sk,n=Sk,i=Ck,s=Ck;return r.forEach(function(o){const a=o.bbox();e>a.x.min&&(e=a.x.min),n>a.y.min&&(n=a.y.min),i<a.x.max&&(i=a.x.max),s<a.y.max&&(s=a.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+s)/2,max:s,size:s-n}}},shapeintersections:function(r,e,n,i,s){if(!st.bboxoverlap(e,i))return[];const o=[],a=[r.startcap,r.forward,r.back,r.endcap],l=[n.startcap,n.forward,n.back,n.endcap];return a.forEach(function(h){h.virtual||l.forEach(function(u){if(u.virtual)return;const f=h.intersects(u,s);f.length>0&&(f.c1=h,f.c2=u,f.s1=r,f.s2=n,o.push(f))})}),o},makeshape:function(r,e,n){const i=e.points.length,s=r.points.length,o=st.makeline(e.points[i-1],r.points[0]),a=st.makeline(r.points[s-1],e.points[0]),l={startcap:o,forward:r,back:e,endcap:a,bbox:st.findbbox([o,r,e,a])};return l.intersections=function(h){return st.shapeintersections(l,l.bbox,h,h.bbox,n)},l},getminmax:function(r,e,n){if(!n)return{min:0,max:0};let i=Sk,s=Ck,o,a;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let l=0,h=n.length;l<h;l++)o=n[l],a=r.get(o),a[e]<i&&(i=a[e]),a[e]>s&&(s=a[e]);return{min:i,mid:(i+s)/2,max:s,size:s-i}},align:function(r,e){const n=e.p1.x,i=e.p1.y,s=-Ty(e.p2.y-i,e.p2.x-n),o=function(a){return{x:(a.x-n)*Hc(s)-(a.y-i)*Rm(s),y:(a.x-n)*Rm(s)+(a.y-i)*Hc(s)}};return r.map(o)},roots:function(r,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=r.length-1,i=st.align(r,e),s=function(N){return 0<=N&&N<=1};if(n===2){const N=i[0].y,k=i[1].y,R=i[2].y,E=N-2*k+R;if(E!==0){const D=-vu(k*k-N*R),$=-N+k,I=-(D+$)/E,L=-(-D+$)/E;return[I,L].filter(s)}else if(k!==R&&E===0)return[(2*k-R)/(2*k-2*R)].filter(s);return[]}const o=i[0].y,a=i[1].y,l=i[2].y,h=i[3].y;let u=-o+3*a-3*l+h,f=3*o-6*a+3*l,p=-3*o+3*a,m=o;if(st.approximately(u,0)){if(st.approximately(f,0))return st.approximately(p,0)?[]:[-m/p].filter(s);const N=vu(p*p-4*f*m),k=2*f;return[(N-p)/k,(-p-N)/k].filter(s)}f/=u,p/=u,m/=u;const v=(3*p-f*f)/3,y=v/3,x=(2*f*f*f-9*f*p+27*m)/27,w=x/2,S=w*w+y*y*y;let O,_,T,A,P;if(S<0){const N=-v/3,k=N*N*N,R=vu(k),E=-x/(2*R),D=E<-1?-1:E>1?1:E,$=pze(D),I=Ey(R),L=2*I;return T=L*Hc($/3)-f/3,A=L*Hc(($+mO)/3)-f/3,P=L*Hc(($+2*mO)/3)-f/3,[T,A,P].filter(s)}else{if(S===0)return O=w<0?Ey(-w):-Ey(w),T=2*O-f/3,A=-O-f/3,[T,A].filter(s);{const N=vu(S);return O=Ey(-w+N),_=Ey(w+N),[O-_-f/3].filter(s)}}},droots:function(r){if(r.length===3){const e=r[0],n=r[1],i=r[2],s=e-2*n+i;if(s!==0){const o=-vu(n*n-e*i),a=-e+n,l=-(o+a)/s,h=-(-o+a)/s;return[l,h]}else if(n!==i&&s===0)return[(2*n-i)/(2*(n-i))];return[]}if(r.length===2){const e=r[0],n=r[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(r,e,n,i,s){let o,a,l,h,u=0,f=0;const p=st.compute(r,e),m=st.compute(r,n),v=p.x*p.x+p.y*p.y;if(i?(o=vu(ya(p.y*m.z-m.y*p.z,2)+ya(p.z*m.x-m.z*p.x,2)+ya(p.x*m.y-m.x*p.y,2)),a=ya(v+p.z*p.z,3/2)):(o=p.x*m.y-p.y*m.x,a=ya(v,3/2)),o===0||a===0)return{k:0,r:0};if(u=o/a,f=a/o,!s){const y=st.curvature(r-.001,e,n,i,!0).k,x=st.curvature(r+.001,e,n,i,!0).k;h=(x-u+(u-y))/2,l=(Cy(x-u)+Cy(u-y))/2}return{k:u,r:f,dk:h,adk:l}},inflections:function(r){if(r.length<4)return[];const e=st.align(r,{p1:r[0],p2:r.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,s=e[1].x*e[2].y,o=e[3].x*e[2].y,a=18*(-3*n+2*i+3*s-o),l=18*(3*n-i-3*s),h=18*(s-n);if(st.approximately(a,0)){if(!st.approximately(l,0)){let m=-h/l;if(0<=m&&m<=1)return[m]}return[]}const u=2*a;if(st.approximately(u,0))return[];const f=l*l-4*a*h;if(f<0)return[];const p=Math.sqrt(f);return[(p-l)/u,-(l+p)/u].filter(function(m){return 0<=m&&m<=1})},bboxoverlap:function(r,e){const n=["x","y"],i=n.length;for(let s=0,o,a,l,h;s<i;s++)if(o=n[s],a=r[o].mid,l=e[o].mid,h=(r[o].size+e[o].size)/2,Cy(a-l)>=h)return!1;return!0},expandbox:function(r,e){e.x.min<r.x.min&&(r.x.min=e.x.min),e.y.min<r.y.min&&(r.y.min=e.y.min),e.z&&e.z.min<r.z.min&&(r.z.min=e.z.min),e.x.max>r.x.max&&(r.x.max=e.x.max),e.y.max>r.y.max&&(r.y.max=e.y.max),e.z&&e.z.max>r.z.max&&(r.z.max=e.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,e,n){const i=r.bbox(),s=e.bbox(),o=1e5,a=n||.5;if(i.x.size+i.y.size<a&&s.x.size+s.y.size<a)return[(o*(r._t1+r._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];let l=r.split(.5),h=e.split(.5),u=[{left:l.left,right:h.left},{left:l.left,right:h.right},{left:l.right,right:h.right},{left:l.right,right:h.left}];u=u.filter(function(p){return st.bboxoverlap(p.left.bbox(),p.right.bbox())});let f=[];return u.length===0||(u.forEach(function(p){f=f.concat(st.pairiteration(p.left,p.right,a))}),f=f.filter(function(p,m){return f.indexOf(p)===m})),f},getccenter:function(r,e,n){const i=e.x-r.x,s=e.y-r.y,o=n.x-e.x,a=n.y-e.y,l=i*Hc(yu)-s*Rm(yu),h=i*Rm(yu)+s*Hc(yu),u=o*Hc(yu)-a*Rm(yu),f=o*Rm(yu)+a*Hc(yu),p=(r.x+e.x)/2,m=(r.y+e.y)/2,v=(e.x+n.x)/2,y=(e.y+n.y)/2,x=p+l,w=m+h,S=v+u,O=y+f,_=st.lli8(p,m,x,w,v,y,S,O),T=st.dist(_,r);let A=Ty(r.y-_.y,r.x-_.x),P=Ty(e.y-_.y,e.x-_.x),N=Ty(n.y-_.y,n.x-_.x),k;return A<N?((A>P||P>N)&&(A+=mO),A>N&&(k=N,N=A,A=k)):N<P&&P<A?(k=N,N=A,A=k):N+=mO,_.s=A,_.e=N,_.r=T,_},numberSort:function(r,e){return r-e}};class b1{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return st.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var n=e[0].bbox(),i=1;i<e.length;i++)st.expandbox(n,e[i].bbox());return n}offset(e){const n=[];return this.curves.forEach(function(i){n.push(...i.offset(e))}),new b1(n)}}const{abs:My,min:H9,max:Q9,cos:vze,sin:yze,acos:bze,sqrt:Ay}=Math,xze=Math.PI;class An{constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;const v=[];n.forEach(function(y){["x","y","z"].forEach(function(x){typeof y[x]<"u"&&v.push(y[x])})}),n=v}let s=!1;const o=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const a=this._3d=!s&&(o===9||o===12)||e&&e[0]&&typeof e[0].z<"u",l=this.points=[];for(let v=0,y=a?3:2;v<o;v+=y){var h={x:n[v],y:n[v+1]};a&&(h.z=n[v+2]),l.push(h)}const u=this.order=l.length-1,f=this.dims=["x","y"];a&&f.push("z"),this.dimlen=f.length;const p=st.align(l,{p1:l[0],p2:l[u]}),m=st.dist(l[0],l[u]);this._linear=p.reduce((v,y)=>v+My(y.y),0)<m/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,i,s){if(typeof s>"u"&&(s=.5),s===0)return new An(n,n,i);if(s===1)return new An(e,n,n);const o=An.getABC(2,e,n,i,s);return new An(e,o.A,i)}static cubicFromPoints(e,n,i,s,o){typeof s>"u"&&(s=.5);const a=An.getABC(3,e,n,i,s);typeof o>"u"&&(o=st.dist(n,a.C));const l=o*(1-s)/s,h=st.dist(e,i),u=(i.x-e.x)/h,f=(i.y-e.y)/h,p=o*u,m=o*f,v=l*u,y=l*f,x={x:n.x-p,y:n.y-m},w={x:n.x+v,y:n.y+y},S=a.A,O={x:S.x+(x.x-S.x)/(1-s),y:S.y+(x.y-S.y)/(1-s)},_={x:S.x+(w.x-S.x)/s,y:S.y+(w.y-S.y)/s},T={x:e.x+(O.x-e.x)/s,y:e.y+(O.y-e.y)/s},A={x:i.x+(_.x-i.x)/(1-s),y:i.y+(_.y-i.y)/(1-s)};return new An(e,T,A,i)}static getUtils(){return st}getUtils(){return An.getUtils()}static get PolyBezier(){return b1}valueOf(){return this.toString()}toString(){return st.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,n=e[0].x,i=e[0].y,s=["M",n,i,this.order===2?"Q":"C"];for(let o=1,a=e.length;o<a;o++)s.push(e[o].x),s.push(e[o].y);return s.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=st.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,n=st.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return st.length(this.derivative.bind(this))}static getABC(e=2,n,i,s,o=.5){const a=st.projectionratio(o,e),l=1-a,h={x:a*n.x+l*s.x,y:a*n.y+l*s.y},u=st.abcratio(o,e);return{A:{x:i.x+(i.x-h.x)/u,y:i.y+(i.y-h.y)/u},B:i,C:h,S:n,E:s}}getABC(e,n){n=n||this.get(e);let i=this.points[0],s=this.points[this.order];return An.getABC(this.order,i,n,s,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,i,s;n<e;n++)s=n/(e-1),i=this.compute(s),i.t=s,this._lut.push(i);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),s=[];for(let o=0,a,l=0;o<i.length;o++)a=i[o],st.dist(a,e)<n&&(s.push(a),l+=o/i.length);return s.length?t/=s.length:!1}project(e){const n=this.getLUT(),i=n.length-1,s=st.closest(n,e),o=s.mpos,a=(o-1)/i,l=(o+1)/i,h=.1/i;let u=s.mdist,f=a,p=f,m;u+=1;for(let v;f<l+h;f+=h)m=this.compute(f),v=st.dist(e,m),v<u&&(u=v,p=f);return p=p<0?0:p>1?1:p,m=this.compute(p),m.t=p,m.d=u,m}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?st.computeWithRatios(e,this.points,this.ratios,this._3d):st.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,n=[e[0]],i=e.length;for(let s=1,o,a;s<i;s++)o=e[s],a=e[s-1],n[s]={x:(i-s)/i*o.x+s/i*a.x,y:(i-s)/i*o.y+s/i*a.y};return n[i]=e[i-1],new An(n)}derivative(e){return st.compute(e,this.dpoints[0],this._3d)}dderivative(e){return st.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new An(st.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return st.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return st.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const n=this.derivative(e),i=Ay(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/i,y:n.x/i}}__normal3(e){const n=this.derivative(e),i=this.derivative(e+.01),s=Ay(n.x*n.x+n.y*n.y+n.z*n.z),o=Ay(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=s,n.y/=s,n.z/=s,i.x/=o,i.y/=o,i.z/=o;const a={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},l=Ay(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=l,a.y/=l,a.z/=l;const h=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{t:e,x:h[0]*n.x+h[1]*n.y+h[2]*n.z,y:h[3]*n.x+h[4]*n.y+h[5]*n.z,z:h[6]*n.x+h[7]*n.y+h[8]*n.z}}hull(e){let n=this.points,i=[],s=[],o=0;for(s[o++]=n[0],s[o++]=n[1],s[o++]=n[2],this.order===3&&(s[o++]=n[3]);n.length>1;){i=[];for(let a=0,l,h=n.length-1;a<h;a++)l=st.lerp(e,n[a],n[a+1]),s[o++]=l,i.push(l);n=i}return s}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;const i=this.hull(e),s={left:this.order===2?new An([i[0],i[3],i[5]]):new An([i[0],i[4],i[7],i[9]]),right:this.order===2?new An([i[5],i[4],i[2]]):new An([i[9],i[8],i[6],i[3]]),span:i};return s.left._t1=st.map(0,0,1,this._t1,this._t2),s.left._t2=st.map(e,0,1,this._t1,this._t2),s.right._t1=st.map(e,0,1,this._t1,this._t2),s.right._t2=st.map(1,0,1,this._t1,this._t2),n?(n=st.map(n,e,1,0,1),s.right.split(n).left):s}extrema(){const e={};let n=[];return this.dims.forEach((function(i){let s=function(a){return a[i]},o=this.dpoints[0].map(s);e[i]=st.droots(o),this.order===3&&(o=this.dpoints[1].map(s),e[i]=e[i].concat(st.droots(o))),e[i]=e[i].filter(function(a){return a>=0&&a<=1}),n=n.concat(e[i].sort(st.numberSort))}).bind(this)),e.values=n.sort(st.numberSort).filter(function(i,s){return n.indexOf(i)===s}),e}bbox(){const e=this.extrema(),n={};return this.dims.forEach((function(i){n[i]=st.getminmax(this,i,e[i])}).bind(this)),n}overlaps(e){const n=this.bbox(),i=e.bbox();return st.bboxoverlap(n,i)}offset(e,n){if(typeof n<"u"){const i=this.get(e),s=this.normal(e),o={c:i,n:s,x:i.x+s.x*n,y:i.y+s.y*n};return this._3d&&(o.z=i.z+s.z*n),o}if(this._linear){const i=this.normal(0),s=this.points.map(function(o){const a={x:o.x+e*i.x,y:o.y+e*i.y};return o.z&&i.z&&(a.z=o.z+e*i.z),a});return[new An(s)]}return this.reduce().map(function(i){return i._linear?i.offset(e)[0]:i.scale(e)})}simple(){if(this.order===3){const s=st.angle(this.points[0],this.points[3],this.points[1]),o=st.angle(this.points[0],this.points[3],this.points[2]);if(s>0&&o<0||s<0&&o>0)return!1}const e=this.normal(0),n=this.normal(1);let i=e.x*n.x+e.y*n.y;return this._3d&&(i+=e.z*n.z),My(bze(i))<xze/3}reduce(){let e,n=0,i=0,s=.01,o,a=[],l=[],h=this.extrema().values;for(h.indexOf(0)===-1&&(h=[0].concat(h)),h.indexOf(1)===-1&&h.push(1),n=h[0],e=1;e<h.length;e++)i=h[e],o=this.split(n,i),o._t1=n,o._t2=i,a.push(o),n=i;return a.forEach(function(u){for(n=0,i=0;i<=1;)for(i=n+s;i<=1+s;i+=s)if(o=u.split(n,i),!o.simple()){if(i-=s,My(n-i)<s)return[];o=u.split(n,i),o._t1=st.map(n,0,1,u._t1,u._t2),o._t2=st.map(i,0,1,u._t1,u._t2),l.push(o),n=i;break}n<1&&(o=u.split(n,1),o._t1=st.map(n,0,1,u._t1,u._t2),o._t2=u._t2,l.push(o))}),l}translate(e,n,i){i=typeof i=="number"?i:n;const s=this.order;let o=this.points.map((a,l)=>(1-l/s)*n+l/s*i);return new An(this.points.map((a,l)=>({x:a.x+e.x*o[l],y:a.y+e.y*o[l]})))}scale(e){const n=this.order;let i=!1;if(typeof e=="function"&&(i=e),i&&n===2)return this.raise().scale(i);const s=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):e,i?i(1):e);const a=i?i(0):e,l=i?i(1):e,h=[this.offset(0,10),this.offset(1,10)],u=[],f=st.lli4(h[0],h[0].c,h[1],h[1].c);if(!f)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(p){const m=u[p*n]=st.copy(o[p*n]);m.x+=(p?l:a)*h[p].n.x,m.y+=(p?l:a)*h[p].n.y}),i?([0,1].forEach(function(p){if(!(n===2&&p)){var m=o[p+1],v={x:m.x-f.x,y:m.y-f.y},y=i?i((p+1)/n):e;i&&!s&&(y=-y);var x=Ay(v.x*v.x+v.y*v.y);v.x/=x,v.y/=x,u[p+1]={x:m.x+y*v.x,y:m.y+y*v.y}}}),new An(u)):([0,1].forEach(p=>{if(n===2&&p)return;const m=u[p*n],v=this.derivative(p),y={x:m.x+v.x,y:m.y+v.y};u[p+1]=st.lli4(m,y,f,o[p+1])}),new An(u))}outline(e,n,i,s){if(n=n===void 0?e:n,this._linear){const A=this.normal(0),P=this.points[0],N=this.points[this.points.length-1];let k,R,E;i===void 0&&(i=e,s=n),k={x:P.x+A.x*e,y:P.y+A.y*e},E={x:N.x+A.x*i,y:N.y+A.y*i},R={x:(k.x+E.x)/2,y:(k.y+E.y)/2};const D=[k,R,E];k={x:P.x-A.x*n,y:P.y-A.y*n},E={x:N.x-A.x*s,y:N.y-A.y*s},R={x:(k.x+E.x)/2,y:(k.y+E.y)/2};const $=[E,R,k],I=st.makeline($[2],D[0]),L=st.makeline(D[2],$[0]),U=[I,new An(D),L,new An($)];return new b1(U)}const o=this.reduce(),a=o.length,l=[];let h=[],u,f=0,p=this.length();const m=typeof i<"u"&&typeof s<"u";function v(A,P,N,k,R){return function(E){const D=k/N,$=(k+R)/N,I=P-A;return st.map(E,0,1,A+D*I,A+$*I)}}o.forEach(function(A){const P=A.length();m?(l.push(A.scale(v(e,i,p,f,P))),h.push(A.scale(v(-n,-s,p,f,P)))):(l.push(A.scale(e)),h.push(A.scale(-n))),f+=P}),h=h.map(function(A){return u=A.points,u[3]?A.points=[u[3],u[2],u[1],u[0]]:A.points=[u[2],u[1],u[0]],A}).reverse();const y=l[0].points[0],x=l[a-1].points[l[a-1].points.length-1],w=h[a-1].points[h[a-1].points.length-1],S=h[0].points[0],O=st.makeline(w,y),_=st.makeline(x,S),T=[O].concat(l).concat([_]).concat(h);return new b1(T)}outlineshapes(e,n,i){n=n||e;const s=this.outline(e,n).curves,o=[];for(let a=1,l=s.length;a<l/2;a++){const h=st.makeshape(s[a],s[l-a],i);h.startcap.virtual=a>1,h.endcap.virtual=a<l/2-1,o.push(h)}return o}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof An&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){const n=H9(e.p1.x,e.p2.x),i=H9(e.p1.y,e.p2.y),s=Q9(e.p1.x,e.p2.x),o=Q9(e.p1.y,e.p2.y);return st.roots(this.points,e).filter(a=>{var l=this.get(a);return st.between(l.x,n,s)&&st.between(l.y,i,o)})}selfintersects(e){const n=this.reduce(),i=n.length-2,s=[];for(let o=0,a,l,h;o<i;o++)l=n.slice(o,o+1),h=n.slice(o+2),a=this.curveintersects(l,h,e),s.push(...a);return s}curveintersects(e,n,i){const s=[];e.forEach(function(a){n.forEach(function(l){a.overlaps(l)&&s.push({left:a,right:l})})});let o=[];return s.forEach(function(a){const l=st.pairiteration(a.left,a.right,i);l.length>0&&(o=o.concat(l))}),o}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,i,s){const o=(s-i)/4,a=this.get(i+o),l=this.get(s-o),h=st.dist(e,n),u=st.dist(e,a),f=st.dist(e,l);return My(u-h)+My(f-h)}_iterate(e,n){let i=0,s=1,o;do{o=0,s=1;let a=this.get(i),l,h,u,f,p=!1,m=!1,v,y=s,x=1;do if(m=p,f=u,y=(i+s)/2,l=this.get(y),h=this.get(s),u=st.getccenter(a,l,h),u.interval={start:i,end:s},p=this._error(u,a,i,s)<=e,v=m&&!p,v||(x=s),p){if(s>=1){if(u.interval.end=x=1,f=u,s>1){let S={x:u.x+u.r*vze(u.e),y:u.y+u.r*yze(u.e)};u.e+=st.angle({x:u.x,y:u.y},S,this.get(1))}break}s=s+(s-i)/2}else s=y;while(!v&&o++<100);if(o>=100)break;f=f||u,n.push(f),i=x}while(s<1);return n}}dj();const wze=xt("p",{style:{width:"100px"}},"算法：",-1),_ze=xt("p",{style:{width:"100px"}},"纹理类型：",-1),Oze=`
attribute vec2 aPosition;
attribute vec3 aColor;
attribute vec2 aUV;

varying vec3 vColor;
varying vec2 vUV;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;

void main() {

    mat3 mvp = projectionMatrix * translationMatrix;
    gl_Position = vec4((mvp * vec3(aPosition, 1.0)).xy, 0.0, 1.0);

    vColor = aColor;
    vUV = aUV;
}
`,Sze=`
varying vec3 vColor;
varying vec2 vUV;

uniform sampler2D uTexture;

void main() {
    gl_FragColor = texture2D(uTexture, vUV) * vec4(vColor, 1.0);
}
`,Cze={__name:"CurveRopePixi",async setup(r){let e,n;const i=ot(null);let s=null,o=-1,a=null,l=null,h=null;const u=ot([{value:0,label:"纹理1"},{value:1,label:"纹理2"},{value:2,label:"纹理3"}]),f=ot(2),p=ot(["以t分割","以长度分割","平行曲线方式"]),m=ot("以长度分割"),v=ot(!1);Gi(v,()=>{P()});const y=ot(30);Gi(y,()=>{P()});const x=[([e,n]=_O(()=>Eo.load("./img/rope1.png")),e=await e,n(),e),([e,n]=_O(()=>Eo.load("./img/rope2.png")),e=await e,n(),e),([e,n]=_O(()=>Eo.load("./img/rope3.png")),e=await e,n(),e)];function w(){return a.children.map(E=>new hi(E.x,E.y))}function S(E){x[f.value];let D=[],$=[],I=[];const L=new An(...E),U=L.getLUT(y.value);for(let V=0;V<U.length&&V!=U.length-1;V++){const X=U[V];L.derivative(X.t);const H=L.normal(X.t);H.x*=20,H.y*=20;const J=U[V+1];L.derivative(J.t);const ee=L.normal(J.t);ee.x*=20,ee.y*=20;let ne=[new hi(X.x+H.x,X.y+H.y),new hi(X.x-H.x,X.y-H.y),new hi(J.x-ee.x,J.y-ee.y),new hi(J.x+ee.x,J.y+ee.y)];D.push(ne[0].x,ne[0].y),D.push(ne[1].x,ne[1].y),D.push(ne[2].x,ne[2].y),D.push(ne[0].x,ne[0].y),D.push(ne[2].x,ne[2].y),D.push(ne[3].x,ne[3].y),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),I.push(0,0),I.push(1,0),I.push(1,1),I.push(0,0),I.push(1,1),I.push(0,1)}return _(D,$,I)}function O(E){x[f.value];let D=[],$=[],I=[];const L=new An(...E),U=L.length(),V=y.value;let X=L.getLUT(300),H=U/V,J=0,ee=0;for(let ne=1;ne<=V;ne++){let ge=H*ne;for(let ye=ee+1;ye<X.length;ye++){let ce=X[ye-1],we=X[ye];const be=we.x-ce.x,se=we.y-ce.y;if(J+=Math.sqrt(be*be+se*se),J>=ge||ye==X.length-1){const ae=X[ee],Q=L.normal(ae.t);Q.x*=20,Q.y*=20;const z=we,j=L.normal(z.t);j.x*=20,j.y*=20;let te=[new hi(ae.x+Q.x,ae.y+Q.y),new hi(ae.x-Q.x,ae.y-Q.y),new hi(z.x-j.x,z.y-j.y),new hi(z.x+j.x,z.y+j.y)];ee=ye,D.push(te[0].x,te[0].y),D.push(te[1].x,te[1].y),D.push(te[2].x,te[2].y),D.push(te[0].x,te[0].y),D.push(te[2].x,te[2].y),D.push(te[3].x,te[3].y),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),I.push(0,0),I.push(1,0),I.push(1,1),I.push(0,0),I.push(1,1),I.push(0,1);break}}}return _(D,$,I)}function _(E,D,$){const L={uTexture:x[f.value]},U=new Ah().addAttribute("aPosition",E,2).addAttribute("aColor",D,3).addAttribute("aUV",$,2),V=gl.from(Oze,Sze,L);return l=new zR(U,V),l}function T(E){let D=0;for(let $=0;$<E.length;$++){const I=E[$];D+=I.length()}return D}function A(E){x[f.value];let D=[],$=[],I=[];const L=new An(...E),U=L.offset(20),V=L.offset(-20),X=[L,U,V],H=[L.length(),T(U),T(V)],J=y.value,ee=[H[0]/J,H[1]/J,H[2]/J],ne=new Map;function ge(be,se){let ae=ne.get(be);if(ae||(ae=be.getLUT(),ne[be]=ae),se==0)return ae[0];let Q=0;for(let z=1;z<ae.length;z++){const j=ae[z].x-ae[z-1].x,te=ae[z].y-ae[z-1].y,W=Math.sqrt(j*j+te*te);if(Q+=W,Q>=se||z==ae.length-1)return ae[z]}}function ye(be,se){const ae=X[be],Q=ae.map(W=>W.length());let z=ae.length-1;for(let W=0;W<Q.length-1;W++)if(se<=Q[W]){z=W;break}else se-=Q[W];let j=ae[z];return ge(j,se)}let ce=ye(1,0),we=ye(2,0);for(let be=1;be<=J;be++){let se=be*ee[1],ae=be*ee[2];const Q=ce,z=we,j=ye(1,se),te=ye(2,ae);let W=[new hi(z.x,z.y),new hi(Q.x,Q.y),new hi(j.x,j.y),new hi(te.x,te.y)];ce=j,we=te,D.push(W[0].x,W[0].y),D.push(W[1].x,W[1].y),D.push(W[2].x,W[2].y),D.push(W[0].x,W[0].y),D.push(W[2].x,W[2].y),D.push(W[3].x,W[3].y),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),$.push(1,1,1),I.push(0,0),I.push(1,0),I.push(1,1),I.push(0,0),I.push(1,1),I.push(0,1)}return _(D,$,I)}function P(){let E=w();if(l&&(s.stage.removeChild(l),l=null),m.value=="以t分割"?l=S(E):m.value=="以长度分割"?l=O(E):m.value=="平行曲线方式"&&(l=A(E)),l&&(l.eventMode="none",s.stage.addChild(l)),h&&(s.stage.removeChild(h),h=null),h=new ss,s.stage.addChild(h),h&&v.value){const D=new e0,$=l.geometry.buffers[0].data;for(let I=0;I<$.length/12;I++){const L=I*12,U=[new hi($[L+0],$[L+1]),new hi($[L+2],$[L+3]),new hi($[L+4],$[L+5]),new hi($[L+10],$[L+11])];D.lineStyle(1,11141120),D.moveTo(U[0].x,U[0].y),D.lineTo(U[1].x,U[1].y),D.lineTo(U[2].x,U[2].y),D.lineTo(U[3].x,U[3].y),D.lineTo(U[0].x,U[0].y)}h.addChild(D)}for(let D=0;D<E.length;D++){let $=a.children[D];$.clear(),$.beginFill(44469,1),$.drawCircle(0,0,$.hitArea.radius),$.endFill(),D===o&&($.lineStyle(3,3751494,1),$.drawCircle(0,0,$.hitArea.radius))}}function N(E){const D=E.data.global;for(let $=0;$<a.children.length;$++){const I=a.children[$];let L=I.toLocal(D);if(L.x*L.x+L.y*L.y<I.hitArea.radius*I.hitArea.radius){o=$;break}}P()}function k(E){o=-1,P()}function R(E){if(o>=0){const{x:D,y:$}=E.data.global;let I=a.toLocal({x:D,y:$});a.children[o].position.set(I.x,I.y),P()}}return Gi(m,()=>{P()}),Gi(f,()=>{P()}),Xn(async()=>{s=new hx({background:"#eeeeee",resizeTo:i.value}),i.value.appendChild(s.view);const E={x:s.screen.width/2,y:s.screen.height/2};s.stage.eventMode="static",s.stage.hitArea=s.screen,s.stage.on("pointerupoutside",k),s.stage.on("pointerdown",N),s.stage.on("pointerup",k),s.stage.on("pointermove",R);{a=new ss,s.stage.addChild(a);for(let $=0;$<4;$++){let I=new e0;a.addChild(I),I.hitArea=new lx(0,0,30)}let D=a.children.slice(a.children.length-4);D[0].position.set(E.x,E.y+300),D[1].position.set(E.x-300,E.y-100),D[2].position.set(E.x+300,E.y+100),D[3].position.set(E.x,E.y-300),P()}document.addEventListener("keydown",D=>{D.key>=1&&D.key<=9&&x[D.key-1]&&(f.value=D.key-1,P())})}),(E,D)=>{const $=bt("Option"),I=bt("Select"),L=bt("ListItem"),U=bt("Checkbox"),V=bt("InputNumber"),X=bt("List"),H=bt("Col"),J=bt("Row");return ri(),Ar(J,null,{default:qe(()=>[Pe(H,{span:4},{default:qe(()=>[Pe(X,{style:{"padding-left":"20px"}},{default:qe(()=>[Pe(L,null,{default:qe(()=>[wze,Pe(I,{modelValue:m.value,"onUpdate:modelValue":D[0]||(D[0]=ee=>m.value=ee)},{default:qe(()=>[(ri(!0),Ji(yn,null,hc(p.value,ee=>(ri(),Ar($,{value:ee,key:ee},{default:qe(()=>[tn(bh(ee),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Pe(L,null,{default:qe(()=>[_ze,Pe(I,{modelValue:f.value,"onUpdate:modelValue":D[1]||(D[1]=ee=>f.value=ee)},{default:qe(()=>[(ri(!0),Ji(yn,null,hc(u.value,ee=>(ri(),Ar($,{value:ee.value,key:ee.value},{default:qe(()=>[tn(bh(ee.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Pe(L,null,{default:qe(()=>[Pe(U,{modelValue:v.value,"onUpdate:modelValue":D[2]||(D[2]=ee=>v.value=ee)},{default:qe(()=>[tn("显示网格")]),_:1},8,["modelValue"])]),_:1}),Pe(L,null,{default:qe(()=>[tn(" 分段数： "),Pe(V,{modelValue:y.value,"onUpdate:modelValue":D[3]||(D[3]=ee=>y.value=ee),min:1,max:100,step:10,"controls-outside":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),Pe(H,{span:20},{default:qe(()=>[xt("div",{ref_key:"rootRef",ref:i,style:{width:"100%",height:"98vh"}},null,512)]),_:1})]),_:1})}}},Tze={__name:"PixiHello",setup(r){const e=Qn(null);var n={};async function i(){let h=new sa(n.assets.rope1);h.anchor.set(.5,.5),h.position.set(n.center.x,n.center.y),n.app.stage.addChild(h),n.rope=h}function s(){n.rope.position.set(n.mousePos.x,n.mousePos.y)}function o(h){n.mousePos=h.global,updatePlayerPos()}function a(h){n.mousePos=h.global}function l(h){n.mousePos=h.global}return Xn(async()=>{n.app=new hx({background:"#eeeeee",resizeTo:e.value}),e.value.appendChild(n.app.view),n.center={x:n.app.screen.width/2,y:n.app.screen.height/2},n.app.stage.eventMode="static",n.app.stage.hitArea=n.app.screen,n.app.stage.on("pointerdown",o),n.app.stage.on("pointermove",a),n.app.stage.on("pointerup",l),n.mousePos={x:n.center.x,y:n.center.y},Eo.addBundle("assets",{rope1:"img/rope1.png"}),n.assets=await Eo.loadBundle("assets"),i(),n.app.ticker.add(s)}),Po(()=>{n.app.destroy(!0,!0)}),(h,u)=>(ri(),Ji("div",{ref_key:"rootRef",ref:e,style:{width:"100%",height:"98vh"}},null,512))}};function j9(r,e){if(e===lG)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),r;if(e===SS||e===$I){let n=r.getIndex();if(n===null){const a=[],l=r.getAttribute("position");if(l!==void 0){for(let h=0;h<l.count;h++)a.push(h);r.setIndex(a),n=r.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),r}const i=n.count-2,s=[];if(e===SS)for(let a=1;a<=i;a++)s.push(n.getX(0)),s.push(n.getX(a)),s.push(n.getX(a+1));else for(let a=0;a<i;a++)a%2===0?(s.push(n.getX(a)),s.push(n.getX(a+1)),s.push(n.getX(a+2))):(s.push(n.getX(a+2)),s.push(n.getX(a+1)),s.push(n.getX(a)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=r.clone();return o.setIndex(s),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),r}class Eze extends xs{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new Rze(n)}),this.register(function(n){return new Ize(n)}),this.register(function(n){return new zze(n)}),this.register(function(n){return new Xze(n)}),this.register(function(n){return new Wze(n)}),this.register(function(n){return new Dze(n)}),this.register(function(n){return new Lze(n)}),this.register(function(n){return new Bze(n)}),this.register(function(n){return new $ze(n)}),this.register(function(n){return new Pze(n)}),this.register(function(n){return new Uze(n)}),this.register(function(n){return new Nze(n)}),this.register(function(n){return new Fze(n)}),this.register(function(n){return new Vze(n)}),this.register(function(n){return new Aze(n)}),this.register(function(n){return new Gze(n)}),this.register(function(n){return new Hze(n)})}load(e,n,i,s){const o=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const u=fl.extractUrlBase(e);a=fl.resolveURL(u,this.path)}else a=fl.extractUrlBase(e);this.manager.itemStart(e);const l=function(u){s?s(u):console.error(u),o.manager.itemError(e),o.manager.itemEnd(e)},h=new aa(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(e,function(u){try{o.parse(u,a,function(f){n(f),o.manager.itemEnd(e)},l)}catch(f){l(f)}},i,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,i,s){let o;const a={},l={},h=new TextDecoder;if(typeof e=="string")o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(h.decode(new Uint8Array(e,0,4))===dJ){try{a[Wi.KHR_BINARY_GLTF]=new Qze(e)}catch(p){s&&s(p);return}o=JSON.parse(a[Wi.KHR_BINARY_GLTF].content)}else o=JSON.parse(h.decode(e));else o=e;if(o.asset===void 0||o.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new o9e(o,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const p=this.pluginCallbacks[f](u);p.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[p.name]=p,a[p.name]=!0}if(o.extensionsUsed)for(let f=0;f<o.extensionsUsed.length;++f){const p=o.extensionsUsed[f],m=o.extensionsRequired||[];switch(p){case Wi.KHR_MATERIALS_UNLIT:a[p]=new kze;break;case Wi.KHR_DRACO_MESH_COMPRESSION:a[p]=new jze(o,this.dracoLoader);break;case Wi.KHR_TEXTURE_TRANSFORM:a[p]=new Yze;break;case Wi.KHR_MESH_QUANTIZATION:a[p]=new qze;break;default:m.indexOf(p)>=0&&l[p]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+p+'".')}}u.setExtensions(a),u.setPlugins(l),u.parse(i,s)}parseAsync(e,n){const i=this;return new Promise(function(s,o){i.parse(e,n,s,o)})}}function Mze(){let r={};return{get:function(e){return r[e]},add:function(e,n){r[e]=n},remove:function(e){delete r[e]},removeAll:function(){r={}}}}const Wi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Aze{constructor(e){this.parser=e,this.name=Wi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let i=0,s=n.length;i<s;i++){const o=n[i];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const n=this.parser,i="light:"+e;let s=n.cache.get(i);if(s)return s;const o=n.json,h=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let u;const f=new nt(16777215);h.color!==void 0&&f.setRGB(h.color[0],h.color[1],h.color[2],ns);const p=h.range!==void 0?h.range:0;switch(h.type){case"directional":u=new Ub(f),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new X1(f),u.distance=p;break;case"spot":u=new $b(f),u.distance=p,h.spot=h.spot||{},h.spot.innerConeAngle=h.spot.innerConeAngle!==void 0?h.spot.innerConeAngle:0,h.spot.outerConeAngle=h.spot.outerConeAngle!==void 0?h.spot.outerConeAngle:Math.PI/4,u.angle=h.spot.outerConeAngle,u.penumbra=1-h.spot.innerConeAngle/h.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+h.type)}return u.position.set(0,0,0),u.decay=2,Pu(u,h),h.intensity!==void 0&&(u.intensity=h.intensity),u.name=n.createUniqueName(h.name||"light_"+e),s=Promise.resolve(u),n.cache.add(i,s),s}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,i=this.parser,o=i.json.nodes[e],l=(o.extensions&&o.extensions[this.name]||{}).light;return l===void 0?null:this._loadLight(l).then(function(h){return i._getNodeRef(n.cache,l,h)})}}class kze{constructor(){this.name=Wi.KHR_MATERIALS_UNLIT}getMaterialType(){return vs}extendParams(e,n,i){const s=[];e.color=new nt(1,1,1),e.opacity=1;const o=n.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const a=o.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],ns),e.opacity=a[3]}o.baseColorTexture!==void 0&&s.push(i.assignTexture(e,"map",o.baseColorTexture,Jr))}return Promise.all(s)}}class Pze{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name].emissiveStrength;return o!==void 0&&(n.emissiveIntensity=o),Promise.resolve()}}class Rze{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],a=s.extensions[this.name];if(a.clearcoatFactor!==void 0&&(n.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&o.push(i.assignTexture(n,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&o.push(i.assignTexture(n,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(o.push(i.assignTexture(n,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const l=a.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new Xe(l,l)}return Promise.all(o)}}class Ize{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name];return n.dispersion=o.dispersion!==void 0?o.dispersion:0,Promise.resolve()}}class Nze{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],a=s.extensions[this.name];return a.iridescenceFactor!==void 0&&(n.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&o.push(i.assignTexture(n,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(n.iridescenceIOR=a.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&o.push(i.assignTexture(n,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(o)}}class Dze{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[];n.sheenColor=new nt(0,0,0),n.sheenRoughness=0,n.sheen=1;const a=s.extensions[this.name];if(a.sheenColorFactor!==void 0){const l=a.sheenColorFactor;n.sheenColor.setRGB(l[0],l[1],l[2],ns)}return a.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&o.push(i.assignTexture(n,"sheenColorMap",a.sheenColorTexture,Jr)),a.sheenRoughnessTexture!==void 0&&o.push(i.assignTexture(n,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(o)}}class Lze{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],a=s.extensions[this.name];return a.transmissionFactor!==void 0&&(n.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&o.push(i.assignTexture(n,"transmissionMap",a.transmissionTexture)),Promise.all(o)}}class Bze{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],a=s.extensions[this.name];n.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&o.push(i.assignTexture(n,"thicknessMap",a.thicknessTexture)),n.attenuationDistance=a.attenuationDistance||1/0;const l=a.attenuationColor||[1,1,1];return n.attenuationColor=new nt().setRGB(l[0],l[1],l[2],ns),Promise.all(o)}}class $ze{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=s.extensions[this.name];return n.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}}class Uze{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],a=s.extensions[this.name];n.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&o.push(i.assignTexture(n,"specularIntensityMap",a.specularTexture));const l=a.specularColorFactor||[1,1,1];return n.specularColor=new nt().setRGB(l[0],l[1],l[2],ns),a.specularColorTexture!==void 0&&o.push(i.assignTexture(n,"specularColorMap",a.specularColorTexture,Jr)),Promise.all(o)}}class Vze{constructor(e){this.parser=e,this.name=Wi.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],a=s.extensions[this.name];return n.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&o.push(i.assignTexture(n,"bumpMap",a.bumpTexture)),Promise.all(o)}}class Fze{constructor(e){this.parser=e,this.name=Wi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ua}extendMaterialParams(e,n){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const o=[],a=s.extensions[this.name];return a.anisotropyStrength!==void 0&&(n.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(n.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&o.push(i.assignTexture(n,"anisotropyMap",a.anisotropyTexture)),Promise.all(o)}}class zze{constructor(e){this.parser=e,this.name=Wi.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,i=n.json,s=i.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const o=s.extensions[this.name],a=n.options.ktx2Loader;if(!a){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,o.source,a)}}class Xze{constructor(e){this.parser=e,this.name=Wi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,i=this.parser,s=i.json,o=s.textures[e];if(!o.extensions||!o.extensions[n])return null;const a=o.extensions[n],l=s.images[a.source];let h=i.textureLoader;if(l.uri){const u=i.options.manager.getHandler(l.uri);u!==null&&(h=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,a.source,h);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Wze{constructor(e){this.parser=e,this.name=Wi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,i=this.parser,s=i.json,o=s.textures[e];if(!o.extensions||!o.extensions[n])return null;const a=o.extensions[n],l=s.images[a.source];let h=i.textureLoader;if(l.uri){const u=i.options.manager.getHandler(l.uri);u!==null&&(h=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,a.source,h);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Gze{constructor(e){this.name=Wi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,i=n.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const s=i.extensions[this.name],o=this.parser.getDependency("buffer",s.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(l){const h=s.byteOffset||0,u=s.byteLength||0,f=s.count,p=s.byteStride,m=new Uint8Array(l,h,u);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(f,p,m,s.mode,s.filter).then(function(v){return v.buffer}):a.ready.then(function(){const v=new ArrayBuffer(f*p);return a.decodeGltfBuffer(new Uint8Array(v),f,p,m,s.mode,s.filter),v})})}else return null}}class Hze{constructor(e){this.name=Wi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,i=n.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const s=n.meshes[i.mesh];for(const u of s.primitives)if(u.mode!==ba.TRIANGLES&&u.mode!==ba.TRIANGLE_STRIP&&u.mode!==ba.TRIANGLE_FAN&&u.mode!==void 0)return null;const a=i.extensions[this.name].attributes,l=[],h={};for(const u in a)l.push(this.parser.getDependency("accessor",a[u]).then(f=>(h[u]=f,h[u])));return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then(u=>{const f=u.pop(),p=f.isGroup?f.children:[f],m=u[0].count,v=[];for(const y of p){const x=new dt,w=new le,S=new ur,O=new le(1,1,1),_=new jI(y.geometry,y.material,m);for(let T=0;T<m;T++)h.TRANSLATION&&w.fromBufferAttribute(h.TRANSLATION,T),h.ROTATION&&S.fromBufferAttribute(h.ROTATION,T),h.SCALE&&O.fromBufferAttribute(h.SCALE,T),_.setMatrixAt(T,x.compose(w,S,O));for(const T in h)if(T==="_COLOR_0"){const A=h[T];_.instanceColor=new rp(A.array,A.itemSize,A.normalized)}else T!=="TRANSLATION"&&T!=="ROTATION"&&T!=="SCALE"&&y.geometry.setAttribute(T,h[T]);Li.prototype.copy.call(_,y),this.parser.assignFinalMaterial(_),v.push(_)}return f.isGroup?(f.clear(),f.add(...v),f):v[0]}))}}const dJ="glTF",ky=12,Y9={JSON:1313821514,BIN:5130562};class Qze{constructor(e){this.name=Wi.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,ky),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==dJ)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-ky,o=new DataView(e,ky);let a=0;for(;a<s;){const l=o.getUint32(a,!0);a+=4;const h=o.getUint32(a,!0);if(a+=4,h===Y9.JSON){const u=new Uint8Array(e,ky+a,l);this.content=i.decode(u)}else if(h===Y9.BIN){const u=ky+a;this.body=e.slice(u,u+l)}a+=l}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class jze{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Wi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const i=this.json,s=this.dracoLoader,o=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,l={},h={},u={};for(const f in a){const p=jR[f]||f.toLowerCase();l[p]=a[f]}for(const f in e.attributes){const p=jR[f]||f.toLowerCase();if(a[f]!==void 0){const m=i.accessors[e.attributes[f]],v=Pg[m.componentType];u[p]=v.name,h[p]=m.normalized===!0}}return n.getDependency("bufferView",o).then(function(f){return new Promise(function(p,m){s.decodeDracoFile(f,function(v){for(const y in v.attributes){const x=v.attributes[y],w=h[y];w!==void 0&&(x.normalized=w)}p(v)},l,u,ns,m)})})}}class Yze{constructor(){this.name=Wi.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class qze{constructor(){this.name=Wi.KHR_MESH_QUANTIZATION}}class fJ extends f0{constructor(e,n,i,s){super(e,n,i,s)}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s*3+s;for(let a=0;a!==s;a++)n[a]=i[o+a];return n}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,h=l*2,u=l*3,f=s-n,p=(i-n)/f,m=p*p,v=m*p,y=e*u,x=y-u,w=-2*v+3*m,S=v-m,O=1-w,_=S-m+p;for(let T=0;T!==l;T++){const A=a[x+T+l],P=a[x+T+h]*f,N=a[y+T+l],k=a[y+T]*f;o[T]=O*A+_*P+w*N+S*k}return o}}const Zze=new ur;class Kze extends fJ{interpolate_(e,n,i,s){const o=super.interpolate_(e,n,i,s);return Zze.fromArray(o).normalize().toArray(o),o}}const ba={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Pg={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},q9={9728:Er,9729:ir,9984:Eb,9985:Bf,9986:Bu,9987:Ko},Z9={33071:Ps,33648:ep,10497:yl},Tk={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},jR={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},bu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Jze={CUBICSPLINE:void 0,LINEAR:id,STEP:ip},Ek={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function e9e(r){return r.DefaultMaterial===void 0&&(r.DefaultMaterial=new d0({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:dc})),r.DefaultMaterial}function af(r,e,n){for(const i in n.extensions)r[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=n.extensions[i])}function Pu(r,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(r.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function t9e(r,e,n){let i=!1,s=!1,o=!1;for(let u=0,f=e.length;u<f;u++){const p=e[u];if(p.POSITION!==void 0&&(i=!0),p.NORMAL!==void 0&&(s=!0),p.COLOR_0!==void 0&&(o=!0),i&&s&&o)break}if(!i&&!s&&!o)return Promise.resolve(r);const a=[],l=[],h=[];for(let u=0,f=e.length;u<f;u++){const p=e[u];if(i){const m=p.POSITION!==void 0?n.getDependency("accessor",p.POSITION):r.attributes.position;a.push(m)}if(s){const m=p.NORMAL!==void 0?n.getDependency("accessor",p.NORMAL):r.attributes.normal;l.push(m)}if(o){const m=p.COLOR_0!==void 0?n.getDependency("accessor",p.COLOR_0):r.attributes.color;h.push(m)}}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(h)]).then(function(u){const f=u[0],p=u[1],m=u[2];return i&&(r.morphAttributes.position=f),s&&(r.morphAttributes.normal=p),o&&(r.morphAttributes.color=m),r.morphTargetsRelative=!0,r})}function i9e(r,e){if(r.updateMorphTargets(),e.weights!==void 0)for(let n=0,i=e.weights.length;n<i;n++)r.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(r.morphTargetInfluences.length===n.length){r.morphTargetDictionary={};for(let i=0,s=n.length;i<s;i++)r.morphTargetDictionary[n[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function n9e(r){let e;const n=r.extensions&&r.extensions[Wi.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+Mk(n.attributes):e=r.indices+":"+Mk(r.attributes)+":"+r.mode,r.targets!==void 0)for(let i=0,s=r.targets.length;i<s;i++)e+=":"+Mk(r.targets[i]);return e}function Mk(r){let e="";const n=Object.keys(r).sort();for(let i=0,s=n.length;i<s;i++)e+=n[i]+":"+r[n[i]]+";";return e}function YR(r){switch(r){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function r9e(r){return r.search(/\.jpe?g($|\?)/i)>0||r.search(/^data\:image\/jpeg/)===0?"image/jpeg":r.search(/\.webp($|\?)/i)>0||r.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const s9e=new dt;class o9e{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new Mze,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,s=!1,o=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,o=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||s&&o<98?this.textureLoader=new Bb(this.options.manager):this.textureLoader=new fH(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new aa(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const i=this,s=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(a){const l={scene:a[0][s.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:s.asset,parser:i,userData:{}};return af(o,l,s),Pu(l,s),Promise.all(i._invokeAll(function(h){return h.afterRoot&&h.afterRoot(l)})).then(function(){for(const h of l.scenes)h.updateMatrixWorld();e(l)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],i=this.json.meshes||[];for(let s=0,o=n.length;s<o;s++){const a=n[s].joints;for(let l=0,h=a.length;l<h;l++)e[a[l]].isBone=!0}for(let s=0,o=e.length;s<o;s++){const a=e[s];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(i[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,i){if(e.refs[n]<=1)return i;const s=i.clone(),o=(a,l)=>{const h=this.associations.get(a);h!=null&&this.associations.set(l,h);for(const[u,f]of a.children.entries())o(f,l.children[u])};return o(i,s),s.name+="_instance_"+e.uses[n]++,s}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let i=0;i<n.length;i++){const s=e(n[i]);if(s)return s}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const i=[];for(let s=0;s<n.length;s++){const o=e(n[s]);o&&i.push(o)}return i}getDependency(e,n){const i=e+":"+n;let s=this.cache.get(i);if(!s){switch(e){case"scene":s=this.loadScene(n);break;case"node":s=this._invokeOne(function(o){return o.loadNode&&o.loadNode(n)});break;case"mesh":s=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(n)});break;case"accessor":s=this.loadAccessor(n);break;case"bufferView":s=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(n)});break;case"buffer":s=this.loadBuffer(n);break;case"material":s=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(n)});break;case"texture":s=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(n)});break;case"skin":s=this.loadSkin(n);break;case"animation":s=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(n)});break;case"camera":s=this.loadCamera(n);break;default:if(s=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,n)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(i,s)}return s}getDependencies(e){let n=this.cache.get(e);if(!n){const i=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(s.map(function(o,a){return i.getDependency(e,a)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],i=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[Wi.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(o,a){i.load(fl.resolveURL(n.uri,s.path),o,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(i){const s=n.byteLength||0,o=n.byteOffset||0;return i.slice(o,o+s)})}loadAccessor(e){const n=this,i=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const a=Tk[s.type],l=Pg[s.componentType],h=s.normalized===!0,u=new l(s.count*a);return Promise.resolve(new Di(u,a,h))}const o=[];return s.bufferView!==void 0?o.push(this.getDependency("bufferView",s.bufferView)):o.push(null),s.sparse!==void 0&&(o.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(o).then(function(a){const l=a[0],h=Tk[s.type],u=Pg[s.componentType],f=u.BYTES_PER_ELEMENT,p=f*h,m=s.byteOffset||0,v=s.bufferView!==void 0?i.bufferViews[s.bufferView].byteStride:void 0,y=s.normalized===!0;let x,w;if(v&&v!==p){const S=Math.floor(m/v),O="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+S+":"+s.count;let _=n.cache.get(O);_||(x=new u(l,S*v,s.count*v/f),_=new c0(x,v/f),n.cache.add(O,_)),w=new fc(_,h,m%v/f,y)}else l===null?x=new u(s.count*h):x=new u(l,m,s.count*h),w=new Di(x,h,y);if(s.sparse!==void 0){const S=Tk.SCALAR,O=Pg[s.sparse.indices.componentType],_=s.sparse.indices.byteOffset||0,T=s.sparse.values.byteOffset||0,A=new O(a[1],_,s.sparse.count*S),P=new u(a[2],T,s.sparse.count*h);l!==null&&(w=new Di(w.array.slice(),w.itemSize,w.normalized));for(let N=0,k=A.length;N<k;N++){const R=A[N];if(w.setX(R,P[N*h]),h>=2&&w.setY(R,P[N*h+1]),h>=3&&w.setZ(R,P[N*h+2]),h>=4&&w.setW(R,P[N*h+3]),h>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w})}loadTexture(e){const n=this.json,i=this.options,o=n.textures[e].source,a=n.images[o];let l=this.textureLoader;if(a.uri){const h=i.manager.getHandler(a.uri);h!==null&&(l=h)}return this.loadTextureImage(e,o,l)}loadTextureImage(e,n,i){const s=this,o=this.json,a=o.textures[e],l=o.images[n],h=(l.uri||l.bufferView)+":"+a.sampler;if(this.textureCache[h])return this.textureCache[h];const u=this.loadImageSource(n,i).then(function(f){f.flipY=!1,f.name=a.name||l.name||"",f.name===""&&typeof l.uri=="string"&&l.uri.startsWith("data:image/")===!1&&(f.name=l.uri);const m=(o.samplers||{})[a.sampler]||{};return f.magFilter=q9[m.magFilter]||ir,f.minFilter=q9[m.minFilter]||Ko,f.wrapS=Z9[m.wrapS]||yl,f.wrapT=Z9[m.wrapT]||yl,s.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[h]=u,u}loadImageSource(e,n){const i=this,s=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(p=>p.clone());const a=s.images[e],l=self.URL||self.webkitURL;let h=a.uri||"",u=!1;if(a.bufferView!==void 0)h=i.getDependency("bufferView",a.bufferView).then(function(p){u=!0;const m=new Blob([p],{type:a.mimeType});return h=l.createObjectURL(m),h});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(h).then(function(p){return new Promise(function(m,v){let y=m;n.isImageBitmapLoader===!0&&(y=function(x){const w=new qn(x);w.needsUpdate=!0,m(w)}),n.load(fl.resolveURL(p,o.path),y,void 0,v)})}).then(function(p){return u===!0&&l.revokeObjectURL(h),p.userData.mimeType=a.mimeType||r9e(a.uri),p}).catch(function(p){throw console.error("THREE.GLTFLoader: Couldn't load texture",h),p});return this.sourceCache[e]=f,f}assignTexture(e,n,i,s){const o=this;return this.getDependency("texture",i.index).then(function(a){if(!a)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(a=a.clone(),a.channel=i.texCoord),o.extensions[Wi.KHR_TEXTURE_TRANSFORM]){const l=i.extensions!==void 0?i.extensions[Wi.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const h=o.associations.get(a);a=o.extensions[Wi.KHR_TEXTURE_TRANSFORM].extendTexture(a,l),o.associations.set(a,h)}}return s!==void 0&&(a.colorSpace=s),e[n]=a,a})}assignFinalMaterial(e){const n=e.geometry;let i=e.material;const s=n.attributes.tangent===void 0,o=n.attributes.color!==void 0,a=n.attributes.normal===void 0;if(e.isPoints){const l="PointsMaterial:"+i.uuid;let h=this.cache.get(l);h||(h=new r2,Xr.prototype.copy.call(h,i),h.color.copy(i.color),h.map=i.map,h.sizeAttenuation=!1,this.cache.add(l,h)),i=h}else if(e.isLine){const l="LineBasicMaterial:"+i.uuid;let h=this.cache.get(l);h||(h=new bs,Xr.prototype.copy.call(h,i),h.color.copy(i.color),h.map=i.map,this.cache.add(l,h)),i=h}if(s||o||a){let l="ClonedMaterial:"+i.uuid+":";s&&(l+="derivative-tangents:"),o&&(l+="vertex-colors:"),a&&(l+="flat-shading:");let h=this.cache.get(l);h||(h=i.clone(),o&&(h.vertexColors=!0),a&&(h.flatShading=!0),s&&(h.normalScale&&(h.normalScale.y*=-1),h.clearcoatNormalScale&&(h.clearcoatNormalScale.y*=-1)),this.cache.add(l,h),this.associations.set(h,this.associations.get(i))),i=h}e.material=i}getMaterialType(){return d0}loadMaterial(e){const n=this,i=this.json,s=this.extensions,o=i.materials[e];let a;const l={},h=o.extensions||{},u=[];if(h[Wi.KHR_MATERIALS_UNLIT]){const p=s[Wi.KHR_MATERIALS_UNLIT];a=p.getMaterialType(),u.push(p.extendParams(l,o,n))}else{const p=o.pbrMetallicRoughness||{};if(l.color=new nt(1,1,1),l.opacity=1,Array.isArray(p.baseColorFactor)){const m=p.baseColorFactor;l.color.setRGB(m[0],m[1],m[2],ns),l.opacity=m[3]}p.baseColorTexture!==void 0&&u.push(n.assignTexture(l,"map",p.baseColorTexture,Jr)),l.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,l.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(u.push(n.assignTexture(l,"metalnessMap",p.metallicRoughnessTexture)),u.push(n.assignTexture(l,"roughnessMap",p.metallicRoughnessTexture))),a=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,l)})))}o.doubleSided===!0&&(l.side=Qs);const f=o.alphaMode||Ek.OPAQUE;if(f===Ek.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,f===Ek.MASK&&(l.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&a!==vs&&(u.push(n.assignTexture(l,"normalMap",o.normalTexture)),l.normalScale=new Xe(1,1),o.normalTexture.scale!==void 0)){const p=o.normalTexture.scale;l.normalScale.set(p,p)}if(o.occlusionTexture!==void 0&&a!==vs&&(u.push(n.assignTexture(l,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(l.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&a!==vs){const p=o.emissiveFactor;l.emissive=new nt().setRGB(p[0],p[1],p[2],ns)}return o.emissiveTexture!==void 0&&a!==vs&&u.push(n.assignTexture(l,"emissiveMap",o.emissiveTexture,Jr)),Promise.all(u).then(function(){const p=new a(l);return o.name&&(p.name=o.name),Pu(p,o),n.associations.set(p,{materials:e}),o.extensions&&af(s,p,o),p})}createUniqueName(e){const n=Ai.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,i=this.extensions,s=this.primitiveCache;function o(l){return i[Wi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,n).then(function(h){return K9(h,l,n)})}const a=[];for(let l=0,h=e.length;l<h;l++){const u=e[l],f=n9e(u),p=s[f];if(p)a.push(p.promise);else{let m;u.extensions&&u.extensions[Wi.KHR_DRACO_MESH_COMPRESSION]?m=o(u):m=K9(new vi,u,n),s[f]={primitive:u,promise:m},a.push(m)}}return Promise.all(a)}loadMesh(e){const n=this,i=this.json,s=this.extensions,o=i.meshes[e],a=o.primitives,l=[];for(let h=0,u=a.length;h<u;h++){const f=a[h].material===void 0?e9e(this.cache):this.getDependency("material",a[h].material);l.push(f)}return l.push(n.loadGeometries(a)),Promise.all(l).then(function(h){const u=h.slice(0,h.length-1),f=h[h.length-1],p=[];for(let v=0,y=f.length;v<y;v++){const x=f[v],w=a[v];let S;const O=u[v];if(w.mode===ba.TRIANGLES||w.mode===ba.TRIANGLE_STRIP||w.mode===ba.TRIANGLE_FAN||w.mode===void 0)S=o.isSkinnedMesh===!0?new n2(x,O):new ln(x,O),S.isSkinnedMesh===!0&&S.normalizeSkinWeights(),w.mode===ba.TRIANGLE_STRIP?S.geometry=j9(S.geometry,$I):w.mode===ba.TRIANGLE_FAN&&(S.geometry=j9(S.geometry,SS));else if(w.mode===ba.LINES)S=new _l(x,O);else if(w.mode===ba.LINE_STRIP)S=new pc(x,O);else if(w.mode===ba.LINE_LOOP)S=new YI(x,O);else if(w.mode===ba.POINTS)S=new qI(x,O);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);Object.keys(S.geometry.morphAttributes).length>0&&i9e(S,o),S.name=n.createUniqueName(o.name||"mesh_"+e),Pu(S,o),w.extensions&&af(s,S,w),n.assignFinalMaterial(S),p.push(S)}for(let v=0,y=p.length;v<y;v++)n.associations.set(p[v],{meshes:e,primitives:v});if(p.length===1)return o.extensions&&af(s,p[0],o),p[0];const m=new qs;o.extensions&&af(s,m,o),n.associations.set(m,{meshes:e});for(let v=0,y=p.length;v<y;v++)m.add(p[v]);return m})}loadCamera(e){let n;const i=this.json.cameras[e],s=i[i.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?n=new fn(fs.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):i.type==="orthographic"&&(n=new Jo(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),i.name&&(n.name=this.createUniqueName(i.name)),Pu(n,i),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],i=[];for(let s=0,o=n.joints.length;s<o;s++)i.push(this._loadNodeShallow(n.joints[s]));return n.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",n.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(s){const o=s.pop(),a=s,l=[],h=[];for(let u=0,f=a.length;u<f;u++){const p=a[u];if(p){l.push(p);const m=new dt;o!==null&&m.fromArray(o.array,u*16),h.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[u])}return new h0(l,h)})}loadAnimation(e){const n=this.json,i=this,s=n.animations[e],o=s.name?s.name:"animation_"+e,a=[],l=[],h=[],u=[],f=[];for(let p=0,m=s.channels.length;p<m;p++){const v=s.channels[p],y=s.samplers[v.sampler],x=v.target,w=x.node,S=s.parameters!==void 0?s.parameters[y.input]:y.input,O=s.parameters!==void 0?s.parameters[y.output]:y.output;x.node!==void 0&&(a.push(this.getDependency("node",w)),l.push(this.getDependency("accessor",S)),h.push(this.getDependency("accessor",O)),u.push(y),f.push(x))}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(h),Promise.all(u),Promise.all(f)]).then(function(p){const m=p[0],v=p[1],y=p[2],x=p[3],w=p[4],S=[];for(let O=0,_=m.length;O<_;O++){const T=m[O],A=v[O],P=y[O],N=x[O],k=w[O];if(T===void 0)continue;T.updateMatrix&&T.updateMatrix();const R=i._createAnimationTracks(T,A,P,N,k);if(R)for(let E=0;E<R.length;E++)S.push(R[E])}return new op(o,void 0,S)})}createNodeMesh(e){const n=this.json,i=this,s=n.nodes[e];return s.mesh===void 0?null:i.getDependency("mesh",s.mesh).then(function(o){const a=i._getNodeRef(i.meshCache,s.mesh,o);return s.weights!==void 0&&a.traverse(function(l){if(l.isMesh)for(let h=0,u=s.weights.length;h<u;h++)l.morphTargetInfluences[h]=s.weights[h]}),a})}loadNode(e){const n=this.json,i=this,s=n.nodes[e],o=i._loadNodeShallow(e),a=[],l=s.children||[];for(let u=0,f=l.length;u<f;u++)a.push(i.getDependency("node",l[u]));const h=s.skin===void 0?Promise.resolve(null):i.getDependency("skin",s.skin);return Promise.all([o,Promise.all(a),h]).then(function(u){const f=u[0],p=u[1],m=u[2];m!==null&&f.traverse(function(v){v.isSkinnedMesh&&v.bind(m,s9e)});for(let v=0,y=p.length;v<y;v++)f.add(p[v]);return f})}_loadNodeShallow(e){const n=this.json,i=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const o=n.nodes[e],a=o.name?s.createUniqueName(o.name):"",l=[],h=s._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return h&&l.push(h),o.camera!==void 0&&l.push(s.getDependency("camera",o.camera).then(function(u){return s._getNodeRef(s.cameraCache,o.camera,u)})),s._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){l.push(u)}),this.nodeCache[e]=Promise.all(l).then(function(u){let f;if(o.isBone===!0?f=new Fg:u.length>1?f=new qs:u.length===1?f=u[0]:f=new Li,f!==u[0])for(let p=0,m=u.length;p<m;p++)f.add(u[p]);if(o.name&&(f.userData.name=o.name,f.name=a),Pu(f,o),o.extensions&&af(i,f,o),o.matrix!==void 0){const p=new dt;p.fromArray(o.matrix),f.applyMatrix4(p)}else o.translation!==void 0&&f.position.fromArray(o.translation),o.rotation!==void 0&&f.quaternion.fromArray(o.rotation),o.scale!==void 0&&f.scale.fromArray(o.scale);return s.associations.has(f)||s.associations.set(f,{}),s.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const n=this.extensions,i=this.json.scenes[e],s=this,o=new qs;i.name&&(o.name=s.createUniqueName(i.name)),Pu(o,i),i.extensions&&af(n,o,i);const a=i.nodes||[],l=[];for(let h=0,u=a.length;h<u;h++)l.push(s.getDependency("node",a[h]));return Promise.all(l).then(function(h){for(let f=0,p=h.length;f<p;f++)o.add(h[f]);const u=f=>{const p=new Map;for(const[m,v]of s.associations)(m instanceof Xr||m instanceof qn)&&p.set(m,v);return f.traverse(m=>{const v=s.associations.get(m);v!=null&&p.set(m,v)}),p};return s.associations=u(o),o})}_createAnimationTracks(e,n,i,s,o){const a=[],l=e.name?e.name:e.uuid,h=[];bu[o.path]===bu.weights?e.traverse(function(m){m.morphTargetInfluences&&h.push(m.name?m.name:m.uuid)}):h.push(l);let u;switch(bu[o.path]){case bu.weights:u=nd;break;case bu.rotation:u=_h;break;case bu.position:case bu.scale:u=rd;break;default:switch(i.itemSize){case 1:u=nd;break;case 2:case 3:default:u=rd;break}break}const f=s.interpolation!==void 0?Jze[s.interpolation]:id,p=this._getArrayFromAccessor(i);for(let m=0,v=h.length;m<v;m++){const y=new u(h[m]+"."+bu[o.path],n.array,p,f);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(y),a.push(y)}return a}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const i=YR(n.constructor),s=new Float32Array(n.length);for(let o=0,a=n.length;o<a;o++)s[o]=n[o]*i;n=s}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const s=this instanceof _h?Kze:fJ;return new s(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function a9e(r,e,n){const i=e.attributes,s=new vr;if(i.POSITION!==void 0){const l=n.json.accessors[i.POSITION],h=l.min,u=l.max;if(h!==void 0&&u!==void 0){if(s.set(new le(h[0],h[1],h[2]),new le(u[0],u[1],u[2])),l.normalized){const f=YR(Pg[l.componentType]);s.min.multiplyScalar(f),s.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const o=e.targets;if(o!==void 0){const l=new le,h=new le;for(let u=0,f=o.length;u<f;u++){const p=o[u];if(p.POSITION!==void 0){const m=n.json.accessors[p.POSITION],v=m.min,y=m.max;if(v!==void 0&&y!==void 0){if(h.setX(Math.max(Math.abs(v[0]),Math.abs(y[0]))),h.setY(Math.max(Math.abs(v[1]),Math.abs(y[1]))),h.setZ(Math.max(Math.abs(v[2]),Math.abs(y[2]))),m.normalized){const x=YR(Pg[m.componentType]);h.multiplyScalar(x)}l.max(h)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(l)}r.boundingBox=s;const a=new ts;s.getCenter(a.center),a.radius=s.min.distanceTo(s.max)/2,r.boundingSphere=a}function K9(r,e,n){const i=e.attributes,s=[];function o(a,l){return n.getDependency("accessor",a).then(function(h){r.setAttribute(l,h)})}for(const a in i){const l=jR[a]||a.toLowerCase();l in r.attributes||s.push(o(i[a],l))}if(e.indices!==void 0&&!r.index){const a=n.getDependency("accessor",e.indices).then(function(l){r.setIndex(l)});s.push(a)}return dn.workingColorSpace!==ns&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${dn.workingColorSpace}" not supported.`),Pu(r,e),a9e(r,e,n),Promise.all(s).then(function(){return e.targets!==void 0?t9e(r,e.targets,n):r})}class l9e extends Nb{constructor(e,n={}){const i=n.font;if(i===void 0)super();else{const s=i.generateShapes(e,n.size);n.depth===void 0&&n.height!==void 0&&console.warn("THREE.TextGeometry: .height is now depreciated. Please use .depth instead"),n.depth=n.depth!==void 0?n.depth:n.height!==void 0?n.height:50,n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(s,n)}this.type="TextGeometry"}}class c9e extends xs{constructor(e){super(e)}load(e,n,i,s){const o=this,a=new aa(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){const h=o.parse(JSON.parse(l));n&&n(h)},i,s)}parse(e){return new h9e(e)}}class h9e{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,n=100){const i=[],s=u9e(e,n,this.data);for(let o=0,a=s.length;o<a;o++)i.push(...s[o].toShapes());return i}}function u9e(r,e,n){const i=Array.from(r),s=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*s,a=[];let l=0,h=0;for(let u=0;u<i.length;u++){const f=i[u];if(f===`
`)l=0,h-=o;else{const p=d9e(f,s,l,h,n);l+=p.offsetX,a.push(p.path)}}return a}function d9e(r,e,n,i,s){const o=s.glyphs[r]||s.glyphs["?"];if(!o){console.error('THREE.Font: character "'+r+'" does not exists in font family '+s.familyName+".");return}const a=new d4;let l,h,u,f,p,m,v,y;if(o.o){const x=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let w=0,S=x.length;w<S;)switch(x[w++]){case"m":l=x[w++]*e+n,h=x[w++]*e+i,a.moveTo(l,h);break;case"l":l=x[w++]*e+n,h=x[w++]*e+i,a.lineTo(l,h);break;case"q":u=x[w++]*e+n,f=x[w++]*e+i,p=x[w++]*e+n,m=x[w++]*e+i,a.quadraticCurveTo(p,m,u,f);break;case"b":u=x[w++]*e+n,f=x[w++]*e+i,p=x[w++]*e+n,m=x[w++]*e+i,v=x[w++]*e+n,y=x[w++]*e+i,a.bezierCurveTo(p,m,v,y,u,f);break}}return{offsetX:o.ha*e,path:a}}class dl{constructor(e){e===void 0&&(e=[0,0,0,0,0,0,0,0,0]),this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const n=this.elements;n[0]=e.x,n[4]=e.y,n[8]=e.z}getTrace(e){e===void 0&&(e=new re);const n=this.elements;return e.x=n[0],e.y=n[4],e.z=n[8],e}vmult(e,n){n===void 0&&(n=new re);const i=this.elements,s=e.x,o=e.y,a=e.z;return n.x=i[0]*s+i[1]*o+i[2]*a,n.y=i[3]*s+i[4]*o+i[5]*a,n.z=i[6]*s+i[7]*o+i[8]*a,n}smult(e){for(let n=0;n<this.elements.length;n++)this.elements[n]*=e}mmult(e,n){n===void 0&&(n=new dl);const i=this.elements,s=e.elements,o=n.elements,a=i[0],l=i[1],h=i[2],u=i[3],f=i[4],p=i[5],m=i[6],v=i[7],y=i[8],x=s[0],w=s[1],S=s[2],O=s[3],_=s[4],T=s[5],A=s[6],P=s[7],N=s[8];return o[0]=a*x+l*O+h*A,o[1]=a*w+l*_+h*P,o[2]=a*S+l*T+h*N,o[3]=u*x+f*O+p*A,o[4]=u*w+f*_+p*P,o[5]=u*S+f*T+p*N,o[6]=m*x+v*O+y*A,o[7]=m*w+v*_+y*P,o[8]=m*S+v*T+y*N,n}scale(e,n){n===void 0&&(n=new dl);const i=this.elements,s=n.elements;for(let o=0;o!==3;o++)s[3*o+0]=e.x*i[3*o+0],s[3*o+1]=e.y*i[3*o+1],s[3*o+2]=e.z*i[3*o+2];return n}solve(e,n){n===void 0&&(n=new re);const i=3,s=4,o=[];let a,l;for(a=0;a<i*s;a++)o.push(0);for(a=0;a<3;a++)for(l=0;l<3;l++)o[a+s*l]=this.elements[a+3*l];o[3+4*0]=e.x,o[3+4*1]=e.y,o[3+4*2]=e.z;let h=3;const u=h;let f;const p=4;let m;do{if(a=u-h,o[a+s*a]===0){for(l=a+1;l<u;l++)if(o[a+s*l]!==0){f=p;do m=p-f,o[m+s*a]+=o[m+s*l];while(--f);break}}if(o[a+s*a]!==0)for(l=a+1;l<u;l++){const v=o[a+s*l]/o[a+s*a];f=p;do m=p-f,o[m+s*l]=m<=a?0:o[m+s*l]-o[m+s*a]*v;while(--f)}}while(--h);if(n.z=o[2*s+3]/o[2*s+2],n.y=(o[1*s+3]-o[1*s+2]*n.z)/o[1*s+1],n.x=(o[0*s+3]-o[0*s+2]*n.z-o[0*s+1]*n.y)/o[0*s+0],isNaN(n.x)||isNaN(n.y)||isNaN(n.z)||n.x===1/0||n.y===1/0||n.z===1/0)throw`Could not solve equation! Got x=[${n.toString()}], b=[${e.toString()}], A=[${this.toString()}]`;return n}e(e,n,i){if(i===void 0)return this.elements[n+3*e];this.elements[n+3*e]=i}copy(e){for(let n=0;n<e.elements.length;n++)this.elements[n]=e.elements[n];return this}toString(){let e="";const n=",";for(let i=0;i<9;i++)e+=this.elements[i]+n;return e}reverse(e){e===void 0&&(e=new dl);const n=3,i=6,s=f9e;let o,a;for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+i*a]=this.elements[o+3*a];s[3+6*0]=1,s[3+6*1]=0,s[3+6*2]=0,s[4+6*0]=0,s[4+6*1]=1,s[4+6*2]=0,s[5+6*0]=0,s[5+6*1]=0,s[5+6*2]=1;let l=3;const h=l;let u;const f=i;let p;do{if(o=h-l,s[o+i*o]===0){for(a=o+1;a<h;a++)if(s[o+i*a]!==0){u=f;do p=f-u,s[p+i*o]+=s[p+i*a];while(--u);break}}if(s[o+i*o]!==0)for(a=o+1;a<h;a++){const m=s[o+i*a]/s[o+i*o];u=f;do p=f-u,s[p+i*a]=p<=o?0:s[p+i*a]-s[p+i*o]*m;while(--u)}}while(--l);o=2;do{a=o-1;do{const m=s[o+i*a]/s[o+i*o];u=i;do p=i-u,s[p+i*a]=s[p+i*a]-s[p+i*o]*m;while(--u)}while(a--)}while(--o);o=2;do{const m=1/s[o+i*o];u=i;do p=i-u,s[p+i*o]=s[p+i*o]*m;while(--u)}while(o--);o=2;do{a=2;do{if(p=s[n+a+i*o],isNaN(p)||p===1/0)throw`Could not reverse! A=[${this.toString()}]`;e.e(o,a,p)}while(a--)}while(o--);return e}setRotationFromQuaternion(e){const n=e.x,i=e.y,s=e.z,o=e.w,a=n+n,l=i+i,h=s+s,u=n*a,f=n*l,p=n*h,m=i*l,v=i*h,y=s*h,x=o*a,w=o*l,S=o*h,O=this.elements;return O[3*0+0]=1-(m+y),O[3*0+1]=f-S,O[3*0+2]=p+w,O[3*1+0]=f+S,O[3*1+1]=1-(u+y),O[3*1+2]=v-x,O[3*2+0]=p-w,O[3*2+1]=v+x,O[3*2+2]=1-(u+m),this}transpose(e){e===void 0&&(e=new dl);const n=this.elements,i=e.elements;let s;return i[0]=n[0],i[4]=n[4],i[8]=n[8],s=n[1],i[1]=n[3],i[3]=s,s=n[2],i[2]=n[6],i[6]=s,s=n[5],i[5]=n[7],i[7]=s,e}}const f9e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class re{constructor(e,n,i){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=e,this.y=n,this.z=i}cross(e,n){n===void 0&&(n=new re);const i=e.x,s=e.y,o=e.z,a=this.x,l=this.y,h=this.z;return n.x=l*o-h*s,n.y=h*i-a*o,n.z=a*s-l*i,n}set(e,n,i){return this.x=e,this.y=n,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,n){if(n)n.x=e.x+this.x,n.y=e.y+this.y,n.z=e.z+this.z;else return new re(this.x+e.x,this.y+e.y,this.z+e.z)}vsub(e,n){if(n)n.x=this.x-e.x,n.y=this.y-e.y,n.z=this.z-e.z;else return new re(this.x-e.x,this.y-e.y,this.z-e.z)}crossmat(){return new dl([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,n=this.y,i=this.z,s=Math.sqrt(e*e+n*n+i*i);if(s>0){const o=1/s;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return s}unit(e){e===void 0&&(e=new re);const n=this.x,i=this.y,s=this.z;let o=Math.sqrt(n*n+i*i+s*s);return o>0?(o=1/o,e.x=n*o,e.y=i*o,e.z=s*o):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,n=this.y,i=this.z;return Math.sqrt(e*e+n*n+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const n=this.x,i=this.y,s=this.z,o=e.x,a=e.y,l=e.z;return Math.sqrt((o-n)*(o-n)+(a-i)*(a-i)+(l-s)*(l-s))}distanceSquared(e){const n=this.x,i=this.y,s=this.z,o=e.x,a=e.y,l=e.z;return(o-n)*(o-n)+(a-i)*(a-i)+(l-s)*(l-s)}scale(e,n){n===void 0&&(n=new re);const i=this.x,s=this.y,o=this.z;return n.x=e*i,n.y=e*s,n.z=e*o,n}vmul(e,n){return n===void 0&&(n=new re),n.x=e.x*this.x,n.y=e.y*this.y,n.z=e.z*this.z,n}addScaledVector(e,n,i){return i===void 0&&(i=new re),i.x=this.x+e*n.x,i.y=this.y+e*n.y,i.z=this.z+e*n.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return this.x===0&&this.y===0&&this.z===0}negate(e){return e===void 0&&(e=new re),e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,n){const i=this.length();if(i>0){const s=p9e,o=1/i;s.set(this.x*o,this.y*o,this.z*o);const a=m9e;Math.abs(s.x)<.9?(a.set(1,0,0),s.cross(a,e)):(a.set(0,1,0),s.cross(a,e)),s.cross(e,n)}else e.set(1,0,0),n.set(0,1,0)}toString(){return`${this.x},${this.y},${this.z}`}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,n,i){const s=this.x,o=this.y,a=this.z;i.x=s+(e.x-s)*n,i.y=o+(e.y-o)*n,i.z=a+(e.z-a)*n}almostEquals(e,n){return n===void 0&&(n=1e-6),!(Math.abs(this.x-e.x)>n||Math.abs(this.y-e.y)>n||Math.abs(this.z-e.z)>n)}almostZero(e){return e===void 0&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,n){return this.negate(J9),J9.almostEquals(e,n)}clone(){return new re(this.x,this.y,this.z)}}re.ZERO=new re(0,0,0);re.UNIT_X=new re(1,0,0);re.UNIT_Y=new re(0,1,0);re.UNIT_Z=new re(0,0,1);const p9e=new re,m9e=new re,J9=new re;class ca{constructor(e){e===void 0&&(e={}),this.lowerBound=new re,this.upperBound=new re,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,n,i,s){const o=this.lowerBound,a=this.upperBound,l=i;o.copy(e[0]),l&&l.vmult(o,o),a.copy(o);for(let h=1;h<e.length;h++){let u=e[h];l&&(l.vmult(u,e7),u=e7),u.x>a.x&&(a.x=u.x),u.x<o.x&&(o.x=u.x),u.y>a.y&&(a.y=u.y),u.y<o.y&&(o.y=u.y),u.z>a.z&&(a.z=u.z),u.z<o.z&&(o.z=u.z)}return n&&(n.vadd(o,o),n.vadd(a,a)),s&&(o.x-=s,o.y-=s,o.z-=s,a.x+=s,a.y+=s,a.z+=s),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return new ca().copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const n=this.lowerBound,i=this.upperBound,s=e.lowerBound,o=e.upperBound,a=s.x<=i.x&&i.x<=o.x||n.x<=o.x&&o.x<=i.x,l=s.y<=i.y&&i.y<=o.y||n.y<=o.y&&o.y<=i.y,h=s.z<=i.z&&i.z<=o.z||n.z<=o.z&&o.z<=i.z;return a&&l&&h}volume(){const e=this.lowerBound,n=this.upperBound;return(n.x-e.x)*(n.y-e.y)*(n.z-e.z)}contains(e){const n=this.lowerBound,i=this.upperBound,s=e.lowerBound,o=e.upperBound;return n.x<=s.x&&i.x>=o.x&&n.y<=s.y&&i.y>=o.y&&n.z<=s.z&&i.z>=o.z}getCorners(e,n,i,s,o,a,l,h){const u=this.lowerBound,f=this.upperBound;e.copy(u),n.set(f.x,u.y,u.z),i.set(f.x,f.y,u.z),s.set(u.x,f.y,f.z),o.set(f.x,u.y,f.z),a.set(u.x,f.y,u.z),l.set(u.x,u.y,f.z),h.copy(f)}toLocalFrame(e,n){const i=t7,s=i[0],o=i[1],a=i[2],l=i[3],h=i[4],u=i[5],f=i[6],p=i[7];this.getCorners(s,o,a,l,h,u,f,p);for(let m=0;m!==8;m++){const v=i[m];e.pointToLocal(v,v)}return n.setFromPoints(i)}toWorldFrame(e,n){const i=t7,s=i[0],o=i[1],a=i[2],l=i[3],h=i[4],u=i[5],f=i[6],p=i[7];this.getCorners(s,o,a,l,h,u,f,p);for(let m=0;m!==8;m++){const v=i[m];e.pointToWorld(v,v)}return n.setFromPoints(i)}overlapsRay(e){const{direction:n,from:i}=e,s=1/n.x,o=1/n.y,a=1/n.z,l=(this.lowerBound.x-i.x)*s,h=(this.upperBound.x-i.x)*s,u=(this.lowerBound.y-i.y)*o,f=(this.upperBound.y-i.y)*o,p=(this.lowerBound.z-i.z)*a,m=(this.upperBound.z-i.z)*a,v=Math.max(Math.max(Math.min(l,h),Math.min(u,f)),Math.min(p,m)),y=Math.min(Math.min(Math.max(l,h),Math.max(u,f)),Math.max(p,m));return!(y<0||v>y)}}const e7=new re,t7=[new re,new re,new re,new re,new re,new re,new re,new re];class i7{constructor(){this.matrix=[]}get(e,n){let{index:i}=e,{index:s}=n;if(s>i){const o=s;s=i,i=o}return this.matrix[(i*(i+1)>>1)+s-1]}set(e,n,i){let{index:s}=e,{index:o}=n;if(o>s){const a=o;o=s,s=a}this.matrix[(s*(s+1)>>1)+o-1]=i?1:0}reset(){for(let e=0,n=this.matrix.length;e!==n;e++)this.matrix[e]=0}setNumObjects(e){this.matrix.length=e*(e-1)>>1}}class pJ{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;return i[e]===void 0&&(i[e]=[]),i[e].includes(n)||i[e].push(n),this}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return!!(i[e]!==void 0&&i[e].includes(n))}hasAnyEventListener(e){return this._listeners===void 0?!1:this._listeners[e]!==void 0}removeEventListener(e,n){if(this._listeners===void 0)return this;const i=this._listeners;if(i[e]===void 0)return this;const s=i[e].indexOf(n);return s!==-1&&i[e].splice(s,1),this}dispatchEvent(e){if(this._listeners===void 0)return this;const i=this._listeners[e.type];if(i!==void 0){e.target=this;for(let s=0,o=i.length;s<o;s++)i[s].call(this,e)}return this}}class Cr{constructor(e,n,i,s){e===void 0&&(e=0),n===void 0&&(n=0),i===void 0&&(i=0),s===void 0&&(s=1),this.x=e,this.y=n,this.z=i,this.w=s}set(e,n,i,s){return this.x=e,this.y=n,this.z=i,this.w=s,this}toString(){return`${this.x},${this.y},${this.z},${this.w}`}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,n){const i=Math.sin(n*.5);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(n*.5),this}toAxisAngle(e){e===void 0&&(e=new re),this.normalize();const n=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,n]}setFromVectors(e,n){if(e.isAntiparallelTo(n)){const i=g9e,s=v9e;e.tangents(i,s),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(n);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(e.length()**2*n.length()**2)+e.dot(n),this.normalize()}return this}mult(e,n){n===void 0&&(n=new Cr);const i=this.x,s=this.y,o=this.z,a=this.w,l=e.x,h=e.y,u=e.z,f=e.w;return n.x=i*f+a*l+s*u-o*h,n.y=s*f+a*h+o*l-i*u,n.z=o*f+a*u+i*h-s*l,n.w=a*f-i*l-s*h-o*u,n}inverse(e){e===void 0&&(e=new Cr);const n=this.x,i=this.y,s=this.z,o=this.w;this.conjugate(e);const a=1/(n*n+i*i+s*s+o*o);return e.x*=a,e.y*=a,e.z*=a,e.w*=a,e}conjugate(e){return e===void 0&&(e=new Cr),e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return e===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,n){n===void 0&&(n=new re);const i=e.x,s=e.y,o=e.z,a=this.x,l=this.y,h=this.z,u=this.w,f=u*i+l*o-h*s,p=u*s+h*i-a*o,m=u*o+a*s-l*i,v=-a*i-l*s-h*o;return n.x=f*u+v*-a+p*-h-m*-l,n.y=p*u+v*-l+m*-a-f*-h,n.z=m*u+v*-h+f*-l-p*-a,n}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,n){n===void 0&&(n="YZX");let i,s,o;const a=this.x,l=this.y,h=this.z,u=this.w;switch(n){case"YZX":const f=a*l+h*u;if(f>.499&&(i=2*Math.atan2(a,u),s=Math.PI/2,o=0),f<-.499&&(i=-2*Math.atan2(a,u),s=-Math.PI/2,o=0),i===void 0){const p=a*a,m=l*l,v=h*h;i=Math.atan2(2*l*u-2*a*h,1-2*m-2*v),s=Math.asin(2*f),o=Math.atan2(2*a*u-2*l*h,1-2*p-2*v)}break;default:throw new Error(`Euler order ${n} not supported yet.`)}e.y=i,e.z=s,e.x=o}setFromEuler(e,n,i,s){s===void 0&&(s="XYZ");const o=Math.cos(e/2),a=Math.cos(n/2),l=Math.cos(i/2),h=Math.sin(e/2),u=Math.sin(n/2),f=Math.sin(i/2);return s==="XYZ"?(this.x=h*a*l+o*u*f,this.y=o*u*l-h*a*f,this.z=o*a*f+h*u*l,this.w=o*a*l-h*u*f):s==="YXZ"?(this.x=h*a*l+o*u*f,this.y=o*u*l-h*a*f,this.z=o*a*f-h*u*l,this.w=o*a*l+h*u*f):s==="ZXY"?(this.x=h*a*l-o*u*f,this.y=o*u*l+h*a*f,this.z=o*a*f+h*u*l,this.w=o*a*l-h*u*f):s==="ZYX"?(this.x=h*a*l-o*u*f,this.y=o*u*l+h*a*f,this.z=o*a*f-h*u*l,this.w=o*a*l+h*u*f):s==="YZX"?(this.x=h*a*l+o*u*f,this.y=o*u*l+h*a*f,this.z=o*a*f-h*u*l,this.w=o*a*l-h*u*f):s==="XZY"&&(this.x=h*a*l-o*u*f,this.y=o*u*l-h*a*f,this.z=o*a*f+h*u*l,this.w=o*a*l+h*u*f),this}clone(){return new Cr(this.x,this.y,this.z,this.w)}slerp(e,n,i){i===void 0&&(i=new Cr);const s=this.x,o=this.y,a=this.z,l=this.w;let h=e.x,u=e.y,f=e.z,p=e.w,m,v,y,x,w;return v=s*h+o*u+a*f+l*p,v<0&&(v=-v,h=-h,u=-u,f=-f,p=-p),1-v>1e-6?(m=Math.acos(v),y=Math.sin(m),x=Math.sin((1-n)*m)/y,w=Math.sin(n*m)/y):(x=1-n,w=n),i.x=x*s+w*h,i.y=x*o+w*u,i.z=x*a+w*f,i.w=x*l+w*p,i}integrate(e,n,i,s){s===void 0&&(s=new Cr);const o=e.x*i.x,a=e.y*i.y,l=e.z*i.z,h=this.x,u=this.y,f=this.z,p=this.w,m=n*.5;return s.x+=m*(o*p+a*f-l*u),s.y+=m*(a*p+l*h-o*f),s.z+=m*(l*p+o*u-a*h),s.w+=m*(-o*h-a*u-l*f),s}}const g9e=new re,v9e=new re,y9e={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class zt{constructor(e){e===void 0&&(e={}),this.id=zt.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=e.collisionResponse?e.collisionResponse:!0,this.collisionFilterGroup=e.collisionFilterGroup!==void 0?e.collisionFilterGroup:1,this.collisionFilterMask=e.collisionFilterMask!==void 0?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw`computeBoundingSphereRadius() not implemented for shape type ${this.type}`}volume(){throw`volume() not implemented for shape type ${this.type}`}calculateLocalInertia(e,n){throw`calculateLocalInertia() not implemented for shape type ${this.type}`}calculateWorldAABB(e,n,i,s){throw`calculateWorldAABB() not implemented for shape type ${this.type}`}}zt.idCounter=0;zt.types=y9e;class un{constructor(e){e===void 0&&(e={}),this.position=new re,this.quaternion=new Cr,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,n){return un.pointToLocalFrame(this.position,this.quaternion,e,n)}pointToWorld(e,n){return un.pointToWorldFrame(this.position,this.quaternion,e,n)}vectorToWorldFrame(e,n){return n===void 0&&(n=new re),this.quaternion.vmult(e,n),n}static pointToLocalFrame(e,n,i,s){return s===void 0&&(s=new re),i.vsub(e,s),n.conjugate(n7),n7.vmult(s,s),s}static pointToWorldFrame(e,n,i,s){return s===void 0&&(s=new re),n.vmult(i,s),s.vadd(e,s),s}static vectorToWorldFrame(e,n,i){return i===void 0&&(i=new re),e.vmult(n,i),i}static vectorToLocalFrame(e,n,i,s){return s===void 0&&(s=new re),n.w*=-1,n.vmult(i,s),n.w*=-1,s}}const n7=new Cr;class x1 extends zt{constructor(e){e===void 0&&(e={});const{vertices:n=[],faces:i=[],normals:s=[],axes:o,boundingSphereRadius:a}=e;super({type:zt.types.CONVEXPOLYHEDRON}),this.vertices=n,this.faces=i,this.faceNormals=s,this.faceNormals.length===0&&this.computeNormals(),a?this.boundingSphereRadius=a:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=o?o.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,n=this.vertices,i=this.uniqueEdges;i.length=0;const s=new re;for(let o=0;o!==e.length;o++){const a=e[o],l=a.length;for(let h=0;h!==l;h++){const u=(h+1)%l;n[a[h]].vsub(n[a[u]],s),s.normalize();let f=!1;for(let p=0;p!==i.length;p++)if(i[p].almostEquals(s)||i[p].almostEquals(s)){f=!0;break}f||i.push(s.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let s=0;s<this.faces[e].length;s++)if(!this.vertices[this.faces[e][s]])throw new Error(`Vertex ${this.faces[e][s]} not found!`);const n=this.faceNormals[e]||new re;this.getFaceNormal(e,n),n.negate(n),this.faceNormals[e]=n;const i=this.vertices[this.faces[e][0]];if(n.dot(i)<0){console.error(`.faceNormals[${e}] = Vec3(${n.toString()}) looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.`);for(let s=0;s<this.faces[e].length;s++)console.warn(`.vertices[${this.faces[e][s]}] = Vec3(${this.vertices[this.faces[e][s]].toString()})`)}}}getFaceNormal(e,n){const i=this.faces[e],s=this.vertices[i[0]],o=this.vertices[i[1]],a=this.vertices[i[2]];x1.computeNormal(s,o,a,n)}static computeNormal(e,n,i,s){const o=new re,a=new re;n.vsub(e,a),i.vsub(n,o),o.cross(a,s),s.isZero()||s.normalize()}clipAgainstHull(e,n,i,s,o,a,l,h,u){const f=new re;let p=-1,m=-Number.MAX_VALUE;for(let y=0;y<i.faces.length;y++){f.copy(i.faceNormals[y]),o.vmult(f,f);const x=f.dot(a);x>m&&(m=x,p=y)}const v=[];for(let y=0;y<i.faces[p].length;y++){const x=i.vertices[i.faces[p][y]],w=new re;w.copy(x),o.vmult(w,w),s.vadd(w,w),v.push(w)}p>=0&&this.clipFaceAgainstHull(a,e,n,v,l,h,u)}findSeparatingAxis(e,n,i,s,o,a,l,h){const u=new re,f=new re,p=new re,m=new re,v=new re,y=new re;let x=Number.MAX_VALUE;const w=this;if(w.uniqueAxes)for(let S=0;S!==w.uniqueAxes.length;S++){i.vmult(w.uniqueAxes[S],u);const O=w.testSepAxis(u,e,n,i,s,o);if(O===!1)return!1;O<x&&(x=O,a.copy(u))}else{const S=l?l.length:w.faces.length;for(let O=0;O<S;O++){const _=l?l[O]:O;u.copy(w.faceNormals[_]),i.vmult(u,u);const T=w.testSepAxis(u,e,n,i,s,o);if(T===!1)return!1;T<x&&(x=T,a.copy(u))}}if(e.uniqueAxes)for(let S=0;S!==e.uniqueAxes.length;S++){o.vmult(e.uniqueAxes[S],f);const O=w.testSepAxis(f,e,n,i,s,o);if(O===!1)return!1;O<x&&(x=O,a.copy(f))}else{const S=h?h.length:e.faces.length;for(let O=0;O<S;O++){const _=h?h[O]:O;f.copy(e.faceNormals[_]),o.vmult(f,f);const T=w.testSepAxis(f,e,n,i,s,o);if(T===!1)return!1;T<x&&(x=T,a.copy(f))}}for(let S=0;S!==w.uniqueEdges.length;S++){i.vmult(w.uniqueEdges[S],m);for(let O=0;O!==e.uniqueEdges.length;O++)if(o.vmult(e.uniqueEdges[O],v),m.cross(v,y),!y.almostZero()){y.normalize();const _=w.testSepAxis(y,e,n,i,s,o);if(_===!1)return!1;_<x&&(x=_,a.copy(y))}}return s.vsub(n,p),p.dot(a)>0&&a.negate(a),!0}testSepAxis(e,n,i,s,o,a){const l=this;x1.project(l,e,i,s,Ak),x1.project(n,e,o,a,kk);const h=Ak[0],u=Ak[1],f=kk[0],p=kk[1];if(h<p||f<u)return!1;const m=h-p,v=f-u;return m<v?m:v}calculateLocalInertia(e,n){const i=new re,s=new re;this.computeLocalAABB(s,i);const o=i.x-s.x,a=i.y-s.y,l=i.z-s.z;n.x=1/12*e*(2*a*2*a+2*l*2*l),n.y=1/12*e*(2*o*2*o+2*l*2*l),n.z=1/12*e*(2*a*2*a+2*o*2*o)}getPlaneConstantOfFace(e){const n=this.faces[e],i=this.faceNormals[e],s=this.vertices[n[0]];return-i.dot(s)}clipFaceAgainstHull(e,n,i,s,o,a,l){const h=new re,u=new re,f=new re,p=new re,m=new re,v=new re,y=new re,x=new re,w=this,S=[],O=s,_=S;let T=-1,A=Number.MAX_VALUE;for(let E=0;E<w.faces.length;E++){h.copy(w.faceNormals[E]),i.vmult(h,h);const D=h.dot(e);D<A&&(A=D,T=E)}if(T<0)return;const P=w.faces[T];P.connectedFaces=[];for(let E=0;E<w.faces.length;E++)for(let D=0;D<w.faces[E].length;D++)P.indexOf(w.faces[E][D])!==-1&&E!==T&&P.connectedFaces.indexOf(E)===-1&&P.connectedFaces.push(E);const N=P.length;for(let E=0;E<N;E++){const D=w.vertices[P[E]],$=w.vertices[P[(E+1)%N]];D.vsub($,u),f.copy(u),i.vmult(f,f),n.vadd(f,f),p.copy(this.faceNormals[T]),i.vmult(p,p),n.vadd(p,p),f.cross(p,m),m.negate(m),v.copy(D),i.vmult(v,v),n.vadd(v,v);const I=P.connectedFaces[E];y.copy(this.faceNormals[I]);const L=this.getPlaneConstantOfFace(I);x.copy(y),i.vmult(x,x);const U=L-x.dot(n);for(this.clipFaceAgainstPlane(O,_,x,U);O.length;)O.shift();for(;_.length;)O.push(_.shift())}y.copy(this.faceNormals[T]);const k=this.getPlaneConstantOfFace(T);x.copy(y),i.vmult(x,x);const R=k-x.dot(n);for(let E=0;E<O.length;E++){let D=x.dot(O[E])+R;if(D<=o&&(console.log(`clamped: depth=${D} to minDist=${o}`),D=o),D<=a){const $=O[E];if(D<=1e-6){const I={point:$,normal:x,depth:D};l.push(I)}}}}clipFaceAgainstPlane(e,n,i,s){let o,a;const l=e.length;if(l<2)return n;let h=e[e.length-1],u=e[0];o=i.dot(h)+s;for(let f=0;f<l;f++){if(u=e[f],a=i.dot(u)+s,o<0)if(a<0){const p=new re;p.copy(u),n.push(p)}else{const p=new re;h.lerp(u,o/(o-a),p),n.push(p)}else if(a<0){const p=new re;h.lerp(u,o/(o-a),p),n.push(p),n.push(u)}h=u,o=a}return n}computeWorldVertices(e,n){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new re);const i=this.vertices,s=this.worldVertices;for(let o=0;o!==this.vertices.length;o++)n.vmult(i[o],s[o]),e.vadd(s[o],s[o]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,n){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let s=0;s<this.vertices.length;s++){const o=i[s];o.x<e.x?e.x=o.x:o.x>n.x&&(n.x=o.x),o.y<e.y?e.y=o.y:o.y>n.y&&(n.y=o.y),o.z<e.z?e.z=o.z:o.z>n.z&&(n.z=o.z)}}computeWorldFaceNormals(e){const n=this.faceNormals.length;for(;this.worldFaceNormals.length<n;)this.worldFaceNormals.push(new re);const i=this.faceNormals,s=this.worldFaceNormals;for(let o=0;o!==n;o++)e.vmult(i[o],s[o]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const n=this.vertices;for(let i=0;i!==n.length;i++){const s=n[i].lengthSquared();s>e&&(e=s)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,n,i,s){const o=this.vertices;let a,l,h,u,f,p,m=new re;for(let v=0;v<o.length;v++){m.copy(o[v]),n.vmult(m,m),e.vadd(m,m);const y=m;(a===void 0||y.x<a)&&(a=y.x),(u===void 0||y.x>u)&&(u=y.x),(l===void 0||y.y<l)&&(l=y.y),(f===void 0||y.y>f)&&(f=y.y),(h===void 0||y.z<h)&&(h=y.z),(p===void 0||y.z>p)&&(p=y.z)}i.set(a,l,h),s.set(u,f,p)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e){e===void 0&&(e=new re);const n=this.vertices;for(let i=0;i<n.length;i++)e.vadd(n[i],e);return e.scale(1/n.length,e),e}transformAllPoints(e,n){const i=this.vertices.length,s=this.vertices;if(n){for(let o=0;o<i;o++){const a=s[o];n.vmult(a,a)}for(let o=0;o<this.faceNormals.length;o++){const a=this.faceNormals[o];n.vmult(a,a)}}if(e)for(let o=0;o<i;o++){const a=s[o];a.vadd(e,a)}}pointIsInside(e){const n=this.vertices,i=this.faces,s=this.faceNormals,o=null,a=new re;this.getAveragePointLocal(a);for(let l=0;l<this.faces.length;l++){let h=s[l];const u=n[i[l][0]],f=new re;e.vsub(u,f);const p=h.dot(f),m=new re;a.vsub(u,m);const v=h.dot(m);if(p<0&&v>0||p>0&&v<0)return!1}return o?1:-1}static project(e,n,i,s,o){const a=e.vertices.length,l=b9e;let h=0,u=0;const f=x9e,p=e.vertices;f.setZero(),un.vectorToLocalFrame(i,s,n,l),un.pointToLocalFrame(i,s,f,f);const m=f.dot(l);u=h=p[0].dot(l);for(let v=1;v<a;v++){const y=p[v].dot(l);y>h&&(h=y),y<u&&(u=y)}if(u-=m,h-=m,u>h){const v=u;u=h,h=v}o[0]=h,o[1]=u}}const Ak=[],kk=[];new re;const b9e=new re,x9e=new re;class yb extends zt{constructor(e){super({type:zt.types.BOX}),this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,n=this.halfExtents.y,i=this.halfExtents.z,s=re,o=[new s(-e,-n,-i),new s(e,-n,-i),new s(e,n,-i),new s(-e,n,-i),new s(-e,-n,i),new s(e,-n,i),new s(e,n,i),new s(-e,n,i)],a=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],l=[new s(0,0,1),new s(0,1,0),new s(1,0,0)],h=new x1({vertices:o,faces:a,axes:l});this.convexPolyhedronRepresentation=h,h.material=this.material}calculateLocalInertia(e,n){return n===void 0&&(n=new re),yb.calculateInertia(this.halfExtents,e,n),n}static calculateInertia(e,n,i){const s=e;i.x=1/12*n*(2*s.y*2*s.y+2*s.z*2*s.z),i.y=1/12*n*(2*s.x*2*s.x+2*s.z*2*s.z),i.z=1/12*n*(2*s.y*2*s.y+2*s.x*2*s.x)}getSideNormals(e,n){const i=e,s=this.halfExtents;if(i[0].set(s.x,0,0),i[1].set(0,s.y,0),i[2].set(0,0,s.z),i[3].set(-s.x,0,0),i[4].set(0,-s.y,0),i[5].set(0,0,-s.z),n!==void 0)for(let o=0;o!==i.length;o++)n.vmult(i[o],i[o]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,n,i){const s=this.halfExtents,o=[[s.x,s.y,s.z],[-s.x,s.y,s.z],[-s.x,-s.y,s.z],[-s.x,-s.y,-s.z],[s.x,-s.y,-s.z],[s.x,s.y,-s.z],[-s.x,s.y,-s.z],[s.x,-s.y,s.z]];for(let a=0;a<o.length;a++)xu.set(o[a][0],o[a][1],o[a][2]),n.vmult(xu,xu),e.vadd(xu,xu),i(xu.x,xu.y,xu.z)}calculateWorldAABB(e,n,i,s){const o=this.halfExtents;$l[0].set(o.x,o.y,o.z),$l[1].set(-o.x,o.y,o.z),$l[2].set(-o.x,-o.y,o.z),$l[3].set(-o.x,-o.y,-o.z),$l[4].set(o.x,-o.y,-o.z),$l[5].set(o.x,o.y,-o.z),$l[6].set(-o.x,o.y,-o.z),$l[7].set(o.x,-o.y,o.z);const a=$l[0];n.vmult(a,a),e.vadd(a,a),s.copy(a),i.copy(a);for(let l=1;l<8;l++){const h=$l[l];n.vmult(h,h),e.vadd(h,h);const u=h.x,f=h.y,p=h.z;u>s.x&&(s.x=u),f>s.y&&(s.y=f),p>s.z&&(s.z=p),u<i.x&&(i.x=u),f<i.y&&(i.y=f),p<i.z&&(i.z=p)}}}const xu=new re,$l=[new re,new re,new re,new re,new re,new re,new re,new re],iN={DYNAMIC:1,STATIC:2,KINEMATIC:4},nN={AWAKE:0,SLEEPY:1,SLEEPING:2};class Dt extends pJ{constructor(e){e===void 0&&(e={}),super(),this.id=Dt.idCounter++,this.index=-1,this.world=null,this.vlambda=new re,this.collisionFilterGroup=typeof e.collisionFilterGroup=="number"?e.collisionFilterGroup:1,this.collisionFilterMask=typeof e.collisionFilterMask=="number"?e.collisionFilterMask:-1,this.collisionResponse=typeof e.collisionResponse=="boolean"?e.collisionResponse:!0,this.position=new re,this.previousPosition=new re,this.interpolatedPosition=new re,this.initPosition=new re,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new re,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new re,this.force=new re;const n=typeof e.mass=="number"?e.mass:0;this.mass=n,this.invMass=n>0?1/n:0,this.material=e.material||null,this.linearDamping=typeof e.linearDamping=="number"?e.linearDamping:.01,this.type=n<=0?Dt.STATIC:Dt.DYNAMIC,typeof e.type==typeof Dt.STATIC&&(this.type=e.type),this.allowSleep=typeof e.allowSleep<"u"?e.allowSleep:!0,this.sleepState=Dt.AWAKE,this.sleepSpeedLimit=typeof e.sleepSpeedLimit<"u"?e.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof e.sleepTimeLimit<"u"?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new re,this.quaternion=new Cr,this.initQuaternion=new Cr,this.previousQuaternion=new Cr,this.interpolatedQuaternion=new Cr,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new re,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new re,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new re,this.invInertia=new re,this.invInertiaWorld=new dl,this.invMassSolve=0,this.invInertiaSolve=new re,this.invInertiaWorldSolve=new dl,this.fixedRotation=typeof e.fixedRotation<"u"?e.fixedRotation:!1,this.angularDamping=typeof e.angularDamping<"u"?e.angularDamping:.01,this.linearFactor=new re(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new re(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new ca,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new re,this.isTrigger=!!e.isTrigger,e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=Dt.AWAKE,this.wakeUpAfterNarrowphase=!1,e===Dt.SLEEPING&&this.dispatchEvent(Dt.wakeupEvent)}sleep(){this.sleepState=Dt.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const n=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),s=this.sleepSpeedLimit**2;n===Dt.AWAKE&&i<s?(this.sleepState=Dt.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(Dt.sleepyEvent)):n===Dt.SLEEPY&&i>s?this.wakeUp():n===Dt.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(Dt.sleepEvent))}}updateSolveMassProperties(){this.sleepState===Dt.SLEEPING||this.type===Dt.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,n){return n===void 0&&(n=new re),e.vsub(this.position,n),this.quaternion.conjugate().vmult(n,n),n}vectorToLocalFrame(e,n){return n===void 0&&(n=new re),this.quaternion.conjugate().vmult(e,n),n}pointToWorldFrame(e,n){return n===void 0&&(n=new re),this.quaternion.vmult(e,n),n.vadd(this.position,n),n}vectorToWorldFrame(e,n){return n===void 0&&(n=new re),this.quaternion.vmult(e,n),n}addShape(e,n,i){const s=new re,o=new Cr;return n&&s.copy(n),i&&o.copy(i),this.shapes.push(e),this.shapeOffsets.push(s),this.shapeOrientations.push(o),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const n=this.shapes.indexOf(e);return n===-1?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(n,1),this.shapeOffsets.splice(n,1),this.shapeOrientations.splice(n,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,n=this.shapeOffsets,i=e.length;let s=0;for(let o=0;o!==i;o++){const a=e[o];a.updateBoundingSphereRadius();const l=n[o].length(),h=a.boundingSphereRadius;l+h>s&&(s=l+h)}this.boundingRadius=s}updateAABB(){const e=this.shapes,n=this.shapeOffsets,i=this.shapeOrientations,s=e.length,o=w9e,a=_9e,l=this.quaternion,h=this.aabb,u=O9e;for(let f=0;f!==s;f++){const p=e[f];l.vmult(n[f],o),o.vadd(this.position,o),l.mult(i[f],a),p.calculateWorldAABB(o,a,u.lowerBound,u.upperBound),f===0?h.copy(u):h.extend(u)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const n=this.invInertia;if(!(n.x===n.y&&n.y===n.z&&!e)){const i=S9e,s=C9e;i.setRotationFromQuaternion(this.quaternion),i.transpose(s),i.scale(n,i),i.mmult(s,this.invInertiaWorld)}}applyForce(e,n){if(n===void 0&&(n=new re),this.type!==Dt.DYNAMIC)return;this.sleepState===Dt.SLEEPING&&this.wakeUp();const i=T9e;n.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,n){if(n===void 0&&(n=new re),this.type!==Dt.DYNAMIC)return;const i=E9e,s=M9e;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(n,s),this.applyForce(i,s)}applyTorque(e){this.type===Dt.DYNAMIC&&(this.sleepState===Dt.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,n){if(n===void 0&&(n=new re),this.type!==Dt.DYNAMIC)return;this.sleepState===Dt.SLEEPING&&this.wakeUp();const i=n,s=A9e;s.copy(e),s.scale(this.invMass,s),this.velocity.vadd(s,this.velocity);const o=k9e;i.cross(e,o),this.invInertiaWorld.vmult(o,o),this.angularVelocity.vadd(o,this.angularVelocity)}applyLocalImpulse(e,n){if(n===void 0&&(n=new re),this.type!==Dt.DYNAMIC)return;const i=P9e,s=R9e;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(n,s),this.applyImpulse(i,s)}updateMassProperties(){const e=I9e;this.invMass=this.mass>0?1/this.mass:0;const n=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),yb.calculateInertia(e,this.mass,n),this.invInertia.set(n.x>0&&!i?1/n.x:0,n.y>0&&!i?1/n.y:0,n.z>0&&!i?1/n.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,n){const i=new re;return e.vsub(this.position,i),this.angularVelocity.cross(i,n),this.velocity.vadd(n,n),n}integrate(e,n,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),!(this.type===Dt.DYNAMIC||this.type===Dt.KINEMATIC)||this.sleepState===Dt.SLEEPING)return;const s=this.velocity,o=this.angularVelocity,a=this.position,l=this.force,h=this.torque,u=this.quaternion,f=this.invMass,p=this.invInertiaWorld,m=this.linearFactor,v=f*e;s.x+=l.x*v*m.x,s.y+=l.y*v*m.y,s.z+=l.z*v*m.z;const y=p.elements,x=this.angularFactor,w=h.x*x.x,S=h.y*x.y,O=h.z*x.z;o.x+=e*(y[0]*w+y[1]*S+y[2]*O),o.y+=e*(y[3]*w+y[4]*S+y[5]*O),o.z+=e*(y[6]*w+y[7]*S+y[8]*O),a.x+=s.x*e,a.y+=s.y*e,a.z+=s.z*e,u.integrate(this.angularVelocity,e,this.angularFactor,u),n&&(i?u.normalizeFast():u.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}Dt.idCounter=0;Dt.COLLIDE_EVENT_NAME="collide";Dt.DYNAMIC=iN.DYNAMIC;Dt.STATIC=iN.STATIC;Dt.KINEMATIC=iN.KINEMATIC;Dt.AWAKE=nN.AWAKE;Dt.SLEEPY=nN.SLEEPY;Dt.SLEEPING=nN.SLEEPING;Dt.wakeupEvent={type:"wakeup"};Dt.sleepyEvent={type:"sleepy"};Dt.sleepEvent={type:"sleep"};const w9e=new re,_9e=new Cr,O9e=new ca,S9e=new dl,C9e=new dl;new dl;const T9e=new re,E9e=new re,M9e=new re,A9e=new re,k9e=new re,P9e=new re,R9e=new re,I9e=new re;class N9e{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(e,n,i){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(e,n){return!(!(e.collisionFilterGroup&n.collisionFilterMask)||!(n.collisionFilterGroup&e.collisionFilterMask)||(e.type&Dt.STATIC||e.sleepState===Dt.SLEEPING)&&(n.type&Dt.STATIC||n.sleepState===Dt.SLEEPING))}intersectionTest(e,n,i,s){this.useBoundingBoxes?this.doBoundingBoxBroadphase(e,n,i,s):this.doBoundingSphereBroadphase(e,n,i,s)}doBoundingSphereBroadphase(e,n,i,s){const o=D9e;n.position.vsub(e.position,o);const a=(e.boundingRadius+n.boundingRadius)**2;o.lengthSquared()<a&&(i.push(e),s.push(n))}doBoundingBoxBroadphase(e,n,i,s){e.aabbNeedsUpdate&&e.updateAABB(),n.aabbNeedsUpdate&&n.updateAABB(),e.aabb.overlaps(n.aabb)&&(i.push(e),s.push(n))}makePairsUnique(e,n){const i=L9e,s=B9e,o=$9e,a=e.length;for(let l=0;l!==a;l++)s[l]=e[l],o[l]=n[l];e.length=0,n.length=0;for(let l=0;l!==a;l++){const h=s[l].id,u=o[l].id,f=h<u?`${h},${u}`:`${u},${h}`;i[f]=l,i.keys.push(f)}for(let l=0;l!==i.keys.length;l++){const h=i.keys.pop(),u=i[h];e.push(s[u]),n.push(o[u]),delete i[h]}}setWorld(e){}static boundingSphereCheck(e,n){const i=new re;e.position.vsub(n.position,i);const s=e.shapes[0],o=n.shapes[0];return Math.pow(s.boundingSphereRadius+o.boundingSphereRadius,2)>i.lengthSquared()}aabbQuery(e,n,i){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const D9e=new re;new re;new Cr;new re;const L9e={keys:[]},B9e=[],$9e=[];new re;new re;new re;class U9e extends N9e{constructor(){super()}collisionPairs(e,n,i){const s=e.bodies,o=s.length;let a,l;for(let h=0;h!==o;h++)for(let u=0;u!==h;u++)a=s[h],l=s[u],this.needBroadphaseCollision(a,l)&&this.intersectionTest(a,l,n,i)}aabbQuery(e,n,i){i===void 0&&(i=[]);for(let s=0;s<e.bodies.length;s++){const o=e.bodies[s];o.aabbNeedsUpdate&&o.updateAABB(),o.aabb.overlaps(n)&&i.push(o)}return i}}class kC{constructor(){this.rayFromWorld=new re,this.rayToWorld=new re,this.hitNormalWorld=new re,this.hitPointWorld=new re,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,n,i,s,o,a,l){this.rayFromWorld.copy(e),this.rayToWorld.copy(n),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(s),this.shape=o,this.body=a,this.distance=l}}let mJ,gJ,vJ,yJ,bJ,xJ,wJ;const rN={CLOSEST:1,ANY:2,ALL:4};mJ=zt.types.SPHERE;gJ=zt.types.PLANE;vJ=zt.types.BOX;yJ=zt.types.CYLINDER;bJ=zt.types.CONVEXPOLYHEDRON;xJ=zt.types.HEIGHTFIELD;wJ=zt.types.TRIMESH;class Or{get[mJ](){return this._intersectSphere}get[gJ](){return this._intersectPlane}get[vJ](){return this._intersectBox}get[yJ](){return this._intersectConvex}get[bJ](){return this._intersectConvex}get[xJ](){return this._intersectHeightfield}get[wJ](){return this._intersectTrimesh}constructor(e,n){e===void 0&&(e=new re),n===void 0&&(n=new re),this.from=e.clone(),this.to=n.clone(),this.direction=new re,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Or.ANY,this.result=new kC,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,n){return this.mode=n.mode||Or.ANY,this.result=n.result||new kC,this.skipBackfaces=!!n.skipBackfaces,this.collisionFilterMask=typeof n.collisionFilterMask<"u"?n.collisionFilterMask:-1,this.collisionFilterGroup=typeof n.collisionFilterGroup<"u"?n.collisionFilterGroup:-1,this.checkCollisionResponse=typeof n.checkCollisionResponse<"u"?n.checkCollisionResponse:!0,n.from&&this.from.copy(n.from),n.to&&this.to.copy(n.to),this.callback=n.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(r7),Pk.length=0,e.broadphase.aabbQuery(e,r7,Pk),this.intersectBodies(Pk),this.hasHit}intersectBody(e,n){n&&(this.result=n,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||!(this.collisionFilterGroup&e.collisionFilterMask)||!(e.collisionFilterGroup&this.collisionFilterMask))return;const s=V9e,o=F9e;for(let a=0,l=e.shapes.length;a<l;a++){const h=e.shapes[a];if(!(i&&!h.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[a],o),e.quaternion.vmult(e.shapeOffsets[a],s),s.vadd(e.position,s),this.intersectShape(h,o,s,e),this.result.shouldStop))break}}intersectBodies(e,n){n&&(this.result=n,this.updateDirection());for(let i=0,s=e.length;!this.result.shouldStop&&i<s;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,n,i,s){const o=this.from;if(t7e(o,this.direction,i)>e.boundingSphereRadius)return;const l=this[e.type];l&&l.call(this,e,n,i,s,e)}_intersectBox(e,n,i,s,o){return this._intersectConvex(e.convexPolyhedronRepresentation,n,i,s,o)}_intersectPlane(e,n,i,s,o){const a=this.from,l=this.to,h=this.direction,u=new re(0,0,1);n.vmult(u,u);const f=new re;a.vsub(i,f);const p=f.dot(u);l.vsub(i,f);const m=f.dot(u);if(p*m>0||a.distanceTo(l)<p)return;const v=u.dot(h);if(Math.abs(v)<this.precision)return;const y=new re,x=new re,w=new re;a.vsub(i,y);const S=-u.dot(y)/v;h.scale(S,x),a.vadd(x,w),this.reportIntersection(u,w,o,s,-1)}getAABB(e){const{lowerBound:n,upperBound:i}=e,s=this.to,o=this.from;n.x=Math.min(s.x,o.x),n.y=Math.min(s.y,o.y),n.z=Math.min(s.z,o.z),i.x=Math.max(s.x,o.x),i.y=Math.max(s.y,o.y),i.z=Math.max(s.z,o.z)}_intersectHeightfield(e,n,i,s,o){e.data,e.elementSize;const a=z9e;a.from.copy(this.from),a.to.copy(this.to),un.pointToLocalFrame(i,n,a.from,a.from),un.pointToLocalFrame(i,n,a.to,a.to),a.updateDirection();const l=X9e;let h,u,f,p;h=u=0,f=p=e.data.length-1;const m=new ca;a.getAABB(m),e.getIndexOfPosition(m.lowerBound.x,m.lowerBound.y,l,!0),h=Math.max(h,l[0]),u=Math.max(u,l[1]),e.getIndexOfPosition(m.upperBound.x,m.upperBound.y,l,!0),f=Math.min(f,l[0]+1),p=Math.min(p,l[1]+1);for(let v=h;v<f;v++)for(let y=u;y<p;y++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(v,y,m),!!m.overlapsRay(a)){if(e.getConvexTrianglePillar(v,y,!1),un.pointToWorldFrame(i,n,e.pillarOffset,gO),this._intersectConvex(e.pillarConvex,n,gO,s,o,s7),this.result.shouldStop)return;e.getConvexTrianglePillar(v,y,!0),un.pointToWorldFrame(i,n,e.pillarOffset,gO),this._intersectConvex(e.pillarConvex,n,gO,s,o,s7)}}}_intersectSphere(e,n,i,s,o){const a=this.from,l=this.to,h=e.radius,u=(l.x-a.x)**2+(l.y-a.y)**2+(l.z-a.z)**2,f=2*((l.x-a.x)*(a.x-i.x)+(l.y-a.y)*(a.y-i.y)+(l.z-a.z)*(a.z-i.z)),p=(a.x-i.x)**2+(a.y-i.y)**2+(a.z-i.z)**2-h**2,m=f**2-4*u*p,v=W9e,y=G9e;if(!(m<0))if(m===0)a.lerp(l,m,v),v.vsub(i,y),y.normalize(),this.reportIntersection(y,v,o,s,-1);else{const x=(-f-Math.sqrt(m))/(2*u),w=(-f+Math.sqrt(m))/(2*u);if(x>=0&&x<=1&&(a.lerp(l,x,v),v.vsub(i,y),y.normalize(),this.reportIntersection(y,v,o,s,-1)),this.result.shouldStop)return;w>=0&&w<=1&&(a.lerp(l,w,v),v.vsub(i,y),y.normalize(),this.reportIntersection(y,v,o,s,-1))}}_intersectConvex(e,n,i,s,o,a){const l=H9e,h=o7,u=a&&a.faceList||null,f=e.faces,p=e.vertices,m=e.faceNormals,v=this.direction,y=this.from,x=this.to,w=y.distanceTo(x),S=u?u.length:f.length,O=this.result;for(let _=0;!O.shouldStop&&_<S;_++){const T=u?u[_]:_,A=f[T],P=m[T],N=n,k=i;h.copy(p[A[0]]),N.vmult(h,h),h.vadd(k,h),h.vsub(y,h),N.vmult(P,l);const R=v.dot(l);if(Math.abs(R)<this.precision)continue;const E=l.dot(h)/R;if(!(E<0)){v.scale(E,ho),ho.vadd(y,ho),sl.copy(p[A[0]]),N.vmult(sl,sl),k.vadd(sl,sl);for(let D=1;!O.shouldStop&&D<A.length-1;D++){Ul.copy(p[A[D]]),Vl.copy(p[A[D+1]]),N.vmult(Ul,Ul),N.vmult(Vl,Vl),k.vadd(Ul,Ul),k.vadd(Vl,Vl);const $=ho.distanceTo(y);!(Or.pointInTriangle(ho,sl,Ul,Vl)||Or.pointInTriangle(ho,Ul,sl,Vl))||$>w||this.reportIntersection(l,ho,o,s,T)}}}}_intersectTrimesh(e,n,i,s,o,a){const l=Q9e,h=J9e,u=e7e,f=o7,p=j9e,m=Y9e,v=q9e,y=K9e,x=Z9e,w=e.indices;e.vertices;const S=this.from,O=this.to,_=this.direction;u.position.copy(i),u.quaternion.copy(n),un.vectorToLocalFrame(i,n,_,p),un.pointToLocalFrame(i,n,S,m),un.pointToLocalFrame(i,n,O,v),v.x*=e.scale.x,v.y*=e.scale.y,v.z*=e.scale.z,m.x*=e.scale.x,m.y*=e.scale.y,m.z*=e.scale.z,v.vsub(m,p),p.normalize();const T=m.distanceSquared(v);e.tree.rayQuery(this,u,h);for(let A=0,P=h.length;!this.result.shouldStop&&A!==P;A++){const N=h[A];e.getNormal(N,l),e.getVertex(w[N*3],sl),sl.vsub(m,f);const k=p.dot(l),R=l.dot(f)/k;if(R<0)continue;p.scale(R,ho),ho.vadd(m,ho),e.getVertex(w[N*3+1],Ul),e.getVertex(w[N*3+2],Vl);const E=ho.distanceSquared(m);!(Or.pointInTriangle(ho,Ul,sl,Vl)||Or.pointInTriangle(ho,sl,Ul,Vl))||E>T||(un.vectorToWorldFrame(n,l,x),un.pointToWorldFrame(i,n,ho,y),this.reportIntersection(x,y,o,s,N))}h.length=0}reportIntersection(e,n,i,s,o){const a=this.from,l=this.to,h=a.distanceTo(n),u=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(u.hitFaceIndex=typeof o<"u"?o:-1,this.mode){case Or.ALL:this.hasHit=!0,u.set(a,l,e,n,i,s,h),u.hasHit=!0,this.callback(u);break;case Or.CLOSEST:(h<u.distance||!u.hasHit)&&(this.hasHit=!0,u.hasHit=!0,u.set(a,l,e,n,i,s,h));break;case Or.ANY:this.hasHit=!0,u.hasHit=!0,u.set(a,l,e,n,i,s,h),u.shouldStop=!0;break}}static pointInTriangle(e,n,i,s){s.vsub(n,Sf),i.vsub(n,Py),e.vsub(n,Rk);const o=Sf.dot(Sf),a=Sf.dot(Py),l=Sf.dot(Rk),h=Py.dot(Py),u=Py.dot(Rk);let f,p;return(f=h*l-a*u)>=0&&(p=o*u-a*l)>=0&&f+p<o*h-a*a}}Or.CLOSEST=rN.CLOSEST;Or.ANY=rN.ANY;Or.ALL=rN.ALL;const r7=new ca,Pk=[],Py=new re,Rk=new re,V9e=new re,F9e=new Cr,ho=new re,sl=new re,Ul=new re,Vl=new re;new re;new kC;const s7={faceList:[0]},gO=new re,z9e=new Or,X9e=[],W9e=new re,G9e=new re,H9e=new re;new re;new re;const o7=new re,Q9e=new re,j9e=new re,Y9e=new re,q9e=new re,Z9e=new re,K9e=new re;new ca;const J9e=[],e7e=new un,Sf=new re,vO=new re;function t7e(r,e,n){n.vsub(r,Sf);const i=Sf.dot(e);return e.scale(i,vO),vO.vadd(r,vO),n.distanceTo(vO)}class i7e{static defaults(e,n){e===void 0&&(e={});for(let i in n)i in e||(e[i]=n[i]);return e}}class a7{constructor(){this.spatial=new re,this.rotational=new re}multiplyElement(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)}multiplyVectors(e,n){return e.dot(this.spatial)+n.dot(this.rotational)}}class dx{constructor(e,n,i,s){i===void 0&&(i=-1e6),s===void 0&&(s=1e6),this.id=dx.idCounter++,this.minForce=i,this.maxForce=s,this.bi=e,this.bj=n,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new a7,this.jacobianElementB=new a7,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(e,n,i){const s=n,o=e,a=i;this.a=4/(a*(1+4*s)),this.b=4*s/(1+4*s),this.eps=4/(a*a*o*(1+4*s))}computeB(e,n,i){const s=this.computeGW(),o=this.computeGq(),a=this.computeGiMf();return-o*e-s*n-a*i}computeGq(){const e=this.jacobianElementA,n=this.jacobianElementB,i=this.bi,s=this.bj,o=i.position,a=s.position;return e.spatial.dot(o)+n.spatial.dot(a)}computeGW(){const e=this.jacobianElementA,n=this.jacobianElementB,i=this.bi,s=this.bj,o=i.velocity,a=s.velocity,l=i.angularVelocity,h=s.angularVelocity;return e.multiplyVectors(o,l)+n.multiplyVectors(a,h)}computeGWlambda(){const e=this.jacobianElementA,n=this.jacobianElementB,i=this.bi,s=this.bj,o=i.vlambda,a=s.vlambda,l=i.wlambda,h=s.wlambda;return e.multiplyVectors(o,l)+n.multiplyVectors(a,h)}computeGiMf(){const e=this.jacobianElementA,n=this.jacobianElementB,i=this.bi,s=this.bj,o=i.force,a=i.torque,l=s.force,h=s.torque,u=i.invMassSolve,f=s.invMassSolve;return o.scale(u,l7),l.scale(f,c7),i.invInertiaWorldSolve.vmult(a,h7),s.invInertiaWorldSolve.vmult(h,u7),e.multiplyVectors(l7,h7)+n.multiplyVectors(c7,u7)}computeGiMGt(){const e=this.jacobianElementA,n=this.jacobianElementB,i=this.bi,s=this.bj,o=i.invMassSolve,a=s.invMassSolve,l=i.invInertiaWorldSolve,h=s.invInertiaWorldSolve;let u=o+a;return l.vmult(e.rotational,yO),u+=yO.dot(e.rotational),h.vmult(n.rotational,yO),u+=yO.dot(n.rotational),u}addToWlambda(e){const n=this.jacobianElementA,i=this.jacobianElementB,s=this.bi,o=this.bj,a=n7e;s.vlambda.addScaledVector(s.invMassSolve*e,n.spatial,s.vlambda),o.vlambda.addScaledVector(o.invMassSolve*e,i.spatial,o.vlambda),s.invInertiaWorldSolve.vmult(n.rotational,a),s.wlambda.addScaledVector(e,a,s.wlambda),o.invInertiaWorldSolve.vmult(i.rotational,a),o.wlambda.addScaledVector(e,a,o.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}dx.idCounter=0;const l7=new re,c7=new re,h7=new re,u7=new re,yO=new re,n7e=new re;class r7e extends dx{constructor(e,n,i){i===void 0&&(i=1e6),super(e,n,0,i),this.restitution=0,this.ri=new re,this.rj=new re,this.ni=new re}computeB(e){const n=this.a,i=this.b,s=this.bi,o=this.bj,a=this.ri,l=this.rj,h=s7e,u=o7e,f=s.velocity,p=s.angularVelocity;s.force,s.torque;const m=o.velocity,v=o.angularVelocity;o.force,o.torque;const y=a7e,x=this.jacobianElementA,w=this.jacobianElementB,S=this.ni;a.cross(S,h),l.cross(S,u),S.negate(x.spatial),h.negate(x.rotational),w.spatial.copy(S),w.rotational.copy(u),y.copy(o.position),y.vadd(l,y),y.vsub(s.position,y),y.vsub(a,y);const O=S.dot(y),_=this.restitution+1,T=_*m.dot(S)-_*f.dot(S)+v.dot(u)-p.dot(h),A=this.computeGiMf();return-O*n-T*i-e*A}getImpactVelocityAlongNormal(){const e=l7e,n=c7e,i=h7e,s=u7e,o=d7e;return this.bi.position.vadd(this.ri,i),this.bj.position.vadd(this.rj,s),this.bi.getVelocityAtWorldPoint(i,e),this.bj.getVelocityAtWorldPoint(s,n),e.vsub(n,o),this.ni.dot(o)}}const s7e=new re,o7e=new re,a7e=new re,l7e=new re,c7e=new re,h7e=new re,u7e=new re,d7e=new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;class d7 extends dx{constructor(e,n,i){super(e,n,-i,i),this.ri=new re,this.rj=new re,this.t=new re}computeB(e){this.a;const n=this.b;this.bi,this.bj;const i=this.ri,s=this.rj,o=f7e,a=p7e,l=this.t;i.cross(l,o),s.cross(l,a);const h=this.jacobianElementA,u=this.jacobianElementB;l.negate(h.spatial),o.negate(h.rotational),u.spatial.copy(l),u.rotational.copy(a);const f=this.computeGW(),p=this.computeGiMf();return-f*n-e*p}}const f7e=new re,p7e=new re;class hT{constructor(e,n,i){i=i7e.defaults(i,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=hT.idCounter++,this.materials=[e,n],this.friction=i.friction,this.restitution=i.restitution,this.contactEquationStiffness=i.contactEquationStiffness,this.contactEquationRelaxation=i.contactEquationRelaxation,this.frictionEquationStiffness=i.frictionEquationStiffness,this.frictionEquationRelaxation=i.frictionEquationRelaxation}}hT.idCounter=0;class jf{constructor(e){e===void 0&&(e={});let n="";typeof e=="string"&&(n=e,e={}),this.name=n,this.id=jf.idCounter++,this.friction=typeof e.friction<"u"?e.friction:-1,this.restitution=typeof e.restitution<"u"?e.restitution:-1}}jf.idCounter=0;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new Or;new re;new re;new re;new re(1,0,0),new re(0,1,0),new re(0,0,1);new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new re;new ca;new re;new ca;new re;new re;new re;new re;new re;new re;new re;new ca;new re;new un;new ca;class m7e{constructor(){this.equations=[]}solve(e,n){return 0}addEquation(e){e.enabled&&!e.bi.isTrigger&&!e.bj.isTrigger&&this.equations.push(e)}removeEquation(e){const n=this.equations,i=n.indexOf(e);i!==-1&&n.splice(i,1)}removeAllEquations(){this.equations.length=0}}class g7e extends m7e{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(e,n){let i=0;const s=this.iterations,o=this.tolerance*this.tolerance,a=this.equations,l=a.length,h=n.bodies,u=h.length,f=e;let p,m,v,y,x,w;if(l!==0)for(let T=0;T!==u;T++)h[T].updateSolveMassProperties();const S=y7e,O=b7e,_=v7e;S.length=l,O.length=l,_.length=l;for(let T=0;T!==l;T++){const A=a[T];_[T]=0,O[T]=A.computeB(f),S[T]=1/A.computeC()}if(l!==0){for(let P=0;P!==u;P++){const N=h[P],k=N.vlambda,R=N.wlambda;k.set(0,0,0),R.set(0,0,0)}for(i=0;i!==s;i++){y=0;for(let P=0;P!==l;P++){const N=a[P];p=O[P],m=S[P],w=_[P],x=N.computeGWlambda(),v=m*(p-x-N.eps*w),w+v<N.minForce?v=N.minForce-w:w+v>N.maxForce&&(v=N.maxForce-w),_[P]+=v,y+=v>0?v:-v,N.addToWlambda(v)}if(y*y<o)break}for(let P=0;P!==u;P++){const N=h[P],k=N.velocity,R=N.angularVelocity;N.vlambda.vmul(N.linearFactor,N.vlambda),k.vadd(N.vlambda,k),N.wlambda.vmul(N.angularFactor,N.wlambda),R.vadd(N.wlambda,R)}let T=a.length;const A=1/f;for(;T--;)a[T].multiplier=_[T]*A}return i}}const v7e=[],y7e=[],b7e=[];Dt.STATIC;class x7e{constructor(){this.objects=[],this.type=Object}release(){const e=arguments.length;for(let n=0;n!==e;n++)this.objects.push(n<0||arguments.length<=n?void 0:arguments[n]);return this}get(){return this.objects.length===0?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(e){const n=this.objects;for(;n.length>e;)n.pop();for(;n.length<e;)n.push(this.constructObject());return this}}class w7e extends x7e{constructor(){super(...arguments),this.type=re}constructObject(){return new re}}const Dn={sphereSphere:zt.types.SPHERE,spherePlane:zt.types.SPHERE|zt.types.PLANE,boxBox:zt.types.BOX|zt.types.BOX,sphereBox:zt.types.SPHERE|zt.types.BOX,planeBox:zt.types.PLANE|zt.types.BOX,convexConvex:zt.types.CONVEXPOLYHEDRON,sphereConvex:zt.types.SPHERE|zt.types.CONVEXPOLYHEDRON,planeConvex:zt.types.PLANE|zt.types.CONVEXPOLYHEDRON,boxConvex:zt.types.BOX|zt.types.CONVEXPOLYHEDRON,sphereHeightfield:zt.types.SPHERE|zt.types.HEIGHTFIELD,boxHeightfield:zt.types.BOX|zt.types.HEIGHTFIELD,convexHeightfield:zt.types.CONVEXPOLYHEDRON|zt.types.HEIGHTFIELD,sphereParticle:zt.types.PARTICLE|zt.types.SPHERE,planeParticle:zt.types.PLANE|zt.types.PARTICLE,boxParticle:zt.types.BOX|zt.types.PARTICLE,convexParticle:zt.types.PARTICLE|zt.types.CONVEXPOLYHEDRON,cylinderCylinder:zt.types.CYLINDER,sphereCylinder:zt.types.SPHERE|zt.types.CYLINDER,planeCylinder:zt.types.PLANE|zt.types.CYLINDER,boxCylinder:zt.types.BOX|zt.types.CYLINDER,convexCylinder:zt.types.CONVEXPOLYHEDRON|zt.types.CYLINDER,heightfieldCylinder:zt.types.HEIGHTFIELD|zt.types.CYLINDER,particleCylinder:zt.types.PARTICLE|zt.types.CYLINDER,sphereTrimesh:zt.types.SPHERE|zt.types.TRIMESH,planeTrimesh:zt.types.PLANE|zt.types.TRIMESH};class _7e{get[Dn.sphereSphere](){return this.sphereSphere}get[Dn.spherePlane](){return this.spherePlane}get[Dn.boxBox](){return this.boxBox}get[Dn.sphereBox](){return this.sphereBox}get[Dn.planeBox](){return this.planeBox}get[Dn.convexConvex](){return this.convexConvex}get[Dn.sphereConvex](){return this.sphereConvex}get[Dn.planeConvex](){return this.planeConvex}get[Dn.boxConvex](){return this.boxConvex}get[Dn.sphereHeightfield](){return this.sphereHeightfield}get[Dn.boxHeightfield](){return this.boxHeightfield}get[Dn.convexHeightfield](){return this.convexHeightfield}get[Dn.sphereParticle](){return this.sphereParticle}get[Dn.planeParticle](){return this.planeParticle}get[Dn.boxParticle](){return this.boxParticle}get[Dn.convexParticle](){return this.convexParticle}get[Dn.cylinderCylinder](){return this.convexConvex}get[Dn.sphereCylinder](){return this.sphereConvex}get[Dn.planeCylinder](){return this.planeConvex}get[Dn.boxCylinder](){return this.boxConvex}get[Dn.convexCylinder](){return this.convexConvex}get[Dn.heightfieldCylinder](){return this.heightfieldCylinder}get[Dn.particleCylinder](){return this.particleCylinder}get[Dn.sphereTrimesh](){return this.sphereTrimesh}get[Dn.planeTrimesh](){return this.planeTrimesh}constructor(e){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new w7e,this.world=e,this.currentContactMaterial=e.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(e,n,i,s,o,a){let l;this.contactPointPool.length?(l=this.contactPointPool.pop(),l.bi=e,l.bj=n):l=new r7e(e,n),l.enabled=e.collisionResponse&&n.collisionResponse&&i.collisionResponse&&s.collisionResponse;const h=this.currentContactMaterial;l.restitution=h.restitution,l.setSpookParams(h.contactEquationStiffness,h.contactEquationRelaxation,this.world.dt);const u=i.material||e.material,f=s.material||n.material;return u&&f&&u.restitution>=0&&f.restitution>=0&&(l.restitution=u.restitution*f.restitution),l.si=o||i,l.sj=a||s,l}createFrictionEquationsFromContact(e,n){const i=e.bi,s=e.bj,o=e.si,a=e.sj,l=this.world,h=this.currentContactMaterial;let u=h.friction;const f=o.material||i.material,p=a.material||s.material;if(f&&p&&f.friction>=0&&p.friction>=0&&(u=f.friction*p.friction),u>0){const m=u*(l.frictionGravity||l.gravity).length();let v=i.invMass+s.invMass;v>0&&(v=1/v);const y=this.frictionEquationPool,x=y.length?y.pop():new d7(i,s,m*v),w=y.length?y.pop():new d7(i,s,m*v);return x.bi=w.bi=i,x.bj=w.bj=s,x.minForce=w.minForce=-m*v,x.maxForce=w.maxForce=m*v,x.ri.copy(e.ri),x.rj.copy(e.rj),w.ri.copy(e.ri),w.rj.copy(e.rj),e.ni.tangents(x.t,w.t),x.setSpookParams(h.frictionEquationStiffness,h.frictionEquationRelaxation,l.dt),w.setSpookParams(h.frictionEquationStiffness,h.frictionEquationRelaxation,l.dt),x.enabled=w.enabled=e.enabled,n.push(x,w),!0}return!1}createFrictionFromAverage(e){let n=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(n,this.frictionResult)||e===1)return;const i=this.frictionResult[this.frictionResult.length-2],s=this.frictionResult[this.frictionResult.length-1];lf.setZero(),Im.setZero(),Nm.setZero();const o=n.bi;n.bj;for(let l=0;l!==e;l++)n=this.result[this.result.length-1-l],n.bi!==o?(lf.vadd(n.ni,lf),Im.vadd(n.ri,Im),Nm.vadd(n.rj,Nm)):(lf.vsub(n.ni,lf),Im.vadd(n.rj,Im),Nm.vadd(n.ri,Nm));const a=1/e;Im.scale(a,i.ri),Nm.scale(a,i.rj),s.ri.copy(i.ri),s.rj.copy(i.rj),lf.normalize(),lf.tangents(i.t,s.t)}getContacts(e,n,i,s,o,a,l){this.contactPointPool=o,this.frictionEquationPool=l,this.result=s,this.frictionResult=a;const h=C7e,u=T7e,f=O7e,p=S7e;for(let m=0,v=e.length;m!==v;m++){const y=e[m],x=n[m];let w=null;y.material&&x.material&&(w=i.getContactMaterial(y.material,x.material)||null);const S=y.type&Dt.KINEMATIC&&x.type&Dt.STATIC||y.type&Dt.STATIC&&x.type&Dt.KINEMATIC||y.type&Dt.KINEMATIC&&x.type&Dt.KINEMATIC;for(let O=0;O<y.shapes.length;O++){y.quaternion.mult(y.shapeOrientations[O],h),y.quaternion.vmult(y.shapeOffsets[O],f),f.vadd(y.position,f);const _=y.shapes[O];for(let T=0;T<x.shapes.length;T++){x.quaternion.mult(x.shapeOrientations[T],u),x.quaternion.vmult(x.shapeOffsets[T],p),p.vadd(x.position,p);const A=x.shapes[T];if(!(_.collisionFilterMask&A.collisionFilterGroup&&A.collisionFilterMask&_.collisionFilterGroup)||f.distanceTo(p)>_.boundingSphereRadius+A.boundingSphereRadius)continue;let P=null;_.material&&A.material&&(P=i.getContactMaterial(_.material,A.material)||null),this.currentContactMaterial=P||w||i.defaultContactMaterial;const N=_.type|A.type,k=this[N];if(k){let R=!1;_.type<A.type?R=k.call(this,_,A,f,p,h,u,y,x,_,A,S):R=k.call(this,A,_,p,f,u,h,x,y,_,A,S),R&&S&&(i.shapeOverlapKeeper.set(_.id,A.id),i.bodyOverlapKeeper.set(y.id,x.id))}}}}}sphereSphere(e,n,i,s,o,a,l,h,u,f,p){if(p)return i.distanceSquared(s)<(e.radius+n.radius)**2;const m=this.createContactEquation(l,h,e,n,u,f);s.vsub(i,m.ni),m.ni.normalize(),m.ri.copy(m.ni),m.rj.copy(m.ni),m.ri.scale(e.radius,m.ri),m.rj.scale(-n.radius,m.rj),m.ri.vadd(i,m.ri),m.ri.vsub(l.position,m.ri),m.rj.vadd(s,m.rj),m.rj.vsub(h.position,m.rj),this.result.push(m),this.createFrictionEquationsFromContact(m,this.frictionResult)}spherePlane(e,n,i,s,o,a,l,h,u,f,p){const m=this.createContactEquation(l,h,e,n,u,f);if(m.ni.set(0,0,1),a.vmult(m.ni,m.ni),m.ni.negate(m.ni),m.ni.normalize(),m.ni.scale(e.radius,m.ri),i.vsub(s,bO),m.ni.scale(m.ni.dot(bO),f7),bO.vsub(f7,m.rj),-bO.dot(m.ni)<=e.radius){if(p)return!0;const v=m.ri,y=m.rj;v.vadd(i,v),v.vsub(l.position,v),y.vadd(s,y),y.vsub(h.position,y),this.result.push(m),this.createFrictionEquationsFromContact(m,this.frictionResult)}}boxBox(e,n,i,s,o,a,l,h,u,f,p){return e.convexPolyhedronRepresentation.material=e.material,n.convexPolyhedronRepresentation.material=n.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,n.convexPolyhedronRepresentation.collisionResponse=n.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,n.convexPolyhedronRepresentation,i,s,o,a,l,h,e,n,p)}sphereBox(e,n,i,s,o,a,l,h,u,f,p){const m=this.v3pool,v=K7e;i.vsub(s,xO),n.getSideNormals(v,a);const y=e.radius;let x=!1;const w=eXe,S=tXe,O=iXe;let _=null,T=0,A=0,P=0,N=null;for(let V=0,X=v.length;V!==X&&x===!1;V++){const H=Y7e;H.copy(v[V]);const J=H.length();H.normalize();const ee=xO.dot(H);if(ee<J+y&&ee>0){const ne=q7e,ge=Z7e;ne.copy(v[(V+1)%3]),ge.copy(v[(V+2)%3]);const ye=ne.length(),ce=ge.length();ne.normalize(),ge.normalize();const we=xO.dot(ne),be=xO.dot(ge);if(we<ye&&we>-ye&&be<ce&&be>-ce){const se=Math.abs(ee-J-y);if((N===null||se<N)&&(N=se,A=we,P=be,_=J,w.copy(H),S.copy(ne),O.copy(ge),T++,p))return!0}}}if(T){x=!0;const V=this.createContactEquation(l,h,e,n,u,f);w.scale(-y,V.ri),V.ni.copy(w),V.ni.negate(V.ni),w.scale(_,w),S.scale(A,S),w.vadd(S,w),O.scale(P,O),w.vadd(O,V.rj),V.ri.vadd(i,V.ri),V.ri.vsub(l.position,V.ri),V.rj.vadd(s,V.rj),V.rj.vsub(h.position,V.rj),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult)}let k=m.get();const R=J7e;for(let V=0;V!==2&&!x;V++)for(let X=0;X!==2&&!x;X++)for(let H=0;H!==2&&!x;H++)if(k.set(0,0,0),V?k.vadd(v[0],k):k.vsub(v[0],k),X?k.vadd(v[1],k):k.vsub(v[1],k),H?k.vadd(v[2],k):k.vsub(v[2],k),s.vadd(k,R),R.vsub(i,R),R.lengthSquared()<y*y){if(p)return!0;x=!0;const J=this.createContactEquation(l,h,e,n,u,f);J.ri.copy(R),J.ri.normalize(),J.ni.copy(J.ri),J.ri.scale(y,J.ri),J.rj.copy(k),J.ri.vadd(i,J.ri),J.ri.vsub(l.position,J.ri),J.rj.vadd(s,J.rj),J.rj.vsub(h.position,J.rj),this.result.push(J),this.createFrictionEquationsFromContact(J,this.frictionResult)}m.release(k),k=null;const E=m.get(),D=m.get(),$=m.get(),I=m.get(),L=m.get(),U=v.length;for(let V=0;V!==U&&!x;V++)for(let X=0;X!==U&&!x;X++)if(V%3!==X%3){v[X].cross(v[V],E),E.normalize(),v[V].vadd(v[X],D),$.copy(i),$.vsub(D,$),$.vsub(s,$);const H=$.dot(E);E.scale(H,I);let J=0;for(;J===V%3||J===X%3;)J++;L.copy(i),L.vsub(I,L),L.vsub(D,L),L.vsub(s,L);const ee=Math.abs(H),ne=L.length();if(ee<v[J].length()&&ne<y){if(p)return!0;x=!0;const ge=this.createContactEquation(l,h,e,n,u,f);D.vadd(I,ge.rj),ge.rj.copy(ge.rj),L.negate(ge.ni),ge.ni.normalize(),ge.ri.copy(ge.rj),ge.ri.vadd(s,ge.ri),ge.ri.vsub(i,ge.ri),ge.ri.normalize(),ge.ri.scale(y,ge.ri),ge.ri.vadd(i,ge.ri),ge.ri.vsub(l.position,ge.ri),ge.rj.vadd(s,ge.rj),ge.rj.vsub(h.position,ge.rj),this.result.push(ge),this.createFrictionEquationsFromContact(ge,this.frictionResult)}}m.release(E,D,$,I,L)}planeBox(e,n,i,s,o,a,l,h,u,f,p){return n.convexPolyhedronRepresentation.material=n.material,n.convexPolyhedronRepresentation.collisionResponse=n.collisionResponse,n.convexPolyhedronRepresentation.id=n.id,this.planeConvex(e,n.convexPolyhedronRepresentation,i,s,o,a,l,h,e,n,p)}convexConvex(e,n,i,s,o,a,l,h,u,f,p,m,v){const y=vXe;if(!(i.distanceTo(s)>e.boundingSphereRadius+n.boundingSphereRadius)&&e.findSeparatingAxis(n,i,o,s,a,y,m,v)){const x=[],w=yXe;e.clipAgainstHull(i,o,n,s,a,y,-100,100,x);let S=0;for(let O=0;O!==x.length;O++){if(p)return!0;const _=this.createContactEquation(l,h,e,n,u,f),T=_.ri,A=_.rj;y.negate(_.ni),x[O].normal.negate(w),w.scale(x[O].depth,w),x[O].point.vadd(w,T),A.copy(x[O].point),T.vsub(i,T),A.vsub(s,A),T.vadd(i,T),T.vsub(l.position,T),A.vadd(s,A),A.vsub(h.position,A),this.result.push(_),S++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(_,this.frictionResult)}this.enableFrictionReduction&&S&&this.createFrictionFromAverage(S)}}sphereConvex(e,n,i,s,o,a,l,h,u,f,p){const m=this.v3pool;i.vsub(s,nXe);const v=n.faceNormals,y=n.faces,x=n.vertices,w=e.radius;let S=!1;for(let O=0;O!==x.length;O++){const _=x[O],T=aXe;a.vmult(_,T),s.vadd(T,T);const A=oXe;if(T.vsub(i,A),A.lengthSquared()<w*w){if(p)return!0;S=!0;const P=this.createContactEquation(l,h,e,n,u,f);P.ri.copy(A),P.ri.normalize(),P.ni.copy(P.ri),P.ri.scale(w,P.ri),T.vsub(s,P.rj),P.ri.vadd(i,P.ri),P.ri.vsub(l.position,P.ri),P.rj.vadd(s,P.rj),P.rj.vsub(h.position,P.rj),this.result.push(P),this.createFrictionEquationsFromContact(P,this.frictionResult);return}}for(let O=0,_=y.length;O!==_&&S===!1;O++){const T=v[O],A=y[O],P=lXe;a.vmult(T,P);const N=cXe;a.vmult(x[A[0]],N),N.vadd(s,N);const k=hXe;P.scale(-w,k),i.vadd(k,k);const R=uXe;k.vsub(N,R);const E=R.dot(P),D=dXe;if(i.vsub(N,D),E<0&&D.dot(P)>0){const $=[];for(let I=0,L=A.length;I!==L;I++){const U=m.get();a.vmult(x[A[I]],U),s.vadd(U,U),$.push(U)}if(j7e($,P,i)){if(p)return!0;S=!0;const I=this.createContactEquation(l,h,e,n,u,f);P.scale(-w,I.ri),P.negate(I.ni);const L=m.get();P.scale(-E,L);const U=m.get();P.scale(-w,U),i.vsub(s,I.rj),I.rj.vadd(U,I.rj),I.rj.vadd(L,I.rj),I.rj.vadd(s,I.rj),I.rj.vsub(h.position,I.rj),I.ri.vadd(i,I.ri),I.ri.vsub(l.position,I.ri),m.release(L),m.release(U),this.result.push(I),this.createFrictionEquationsFromContact(I,this.frictionResult);for(let V=0,X=$.length;V!==X;V++)m.release($[V]);return}else for(let I=0;I!==A.length;I++){const L=m.get(),U=m.get();a.vmult(x[A[(I+1)%A.length]],L),a.vmult(x[A[(I+2)%A.length]],U),s.vadd(L,L),s.vadd(U,U);const V=rXe;U.vsub(L,V);const X=sXe;V.unit(X);const H=m.get(),J=m.get();i.vsub(L,J);const ee=J.dot(X);X.scale(ee,H),H.vadd(L,H);const ne=m.get();if(H.vsub(i,ne),ee>0&&ee*ee<V.lengthSquared()&&ne.lengthSquared()<w*w){if(p)return!0;const ge=this.createContactEquation(l,h,e,n,u,f);H.vsub(s,ge.rj),H.vsub(i,ge.ni),ge.ni.normalize(),ge.ni.scale(w,ge.ri),ge.rj.vadd(s,ge.rj),ge.rj.vsub(h.position,ge.rj),ge.ri.vadd(i,ge.ri),ge.ri.vsub(l.position,ge.ri),this.result.push(ge),this.createFrictionEquationsFromContact(ge,this.frictionResult);for(let ye=0,ce=$.length;ye!==ce;ye++)m.release($[ye]);m.release(L),m.release(U),m.release(H),m.release(ne),m.release(J);return}m.release(L),m.release(U),m.release(H),m.release(ne),m.release(J)}for(let I=0,L=$.length;I!==L;I++)m.release($[I])}}}planeConvex(e,n,i,s,o,a,l,h,u,f,p){const m=fXe,v=pXe;v.set(0,0,1),o.vmult(v,v);let y=0;const x=mXe;for(let w=0;w!==n.vertices.length;w++)if(m.copy(n.vertices[w]),a.vmult(m,m),s.vadd(m,m),m.vsub(i,x),v.dot(x)<=0){if(p)return!0;const O=this.createContactEquation(l,h,e,n,u,f),_=gXe;v.scale(v.dot(x),_),m.vsub(_,_),_.vsub(i,O.ri),O.ni.copy(v),m.vsub(s,O.rj),O.ri.vadd(i,O.ri),O.ri.vsub(l.position,O.ri),O.rj.vadd(s,O.rj),O.rj.vsub(h.position,O.rj),this.result.push(O),y++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(O,this.frictionResult)}this.enableFrictionReduction&&y&&this.createFrictionFromAverage(y)}boxConvex(e,n,i,s,o,a,l,h,u,f,p){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,n,i,s,o,a,l,h,e,n,p)}sphereHeightfield(e,n,i,s,o,a,l,h,u,f,p){const m=n.data,v=e.radius,y=n.elementSize,x=kXe,w=AXe;un.pointToLocalFrame(s,a,i,w);let S=Math.floor((w.x-v)/y)-1,O=Math.ceil((w.x+v)/y)+1,_=Math.floor((w.y-v)/y)-1,T=Math.ceil((w.y+v)/y)+1;if(O<0||T<0||S>m.length||_>m[0].length)return;S<0&&(S=0),O<0&&(O=0),_<0&&(_=0),T<0&&(T=0),S>=m.length&&(S=m.length-1),O>=m.length&&(O=m.length-1),T>=m[0].length&&(T=m[0].length-1),_>=m[0].length&&(_=m[0].length-1);const A=[];n.getRectMinMax(S,_,O,T,A);const P=A[0],N=A[1];if(w.z-v>N||w.z+v<P)return;const k=this.result;for(let R=S;R<O;R++)for(let E=_;E<T;E++){const D=k.length;let $=!1;if(n.getConvexTrianglePillar(R,E,!1),un.pointToWorldFrame(s,a,n.pillarOffset,x),i.distanceTo(x)<n.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&($=this.sphereConvex(e,n.pillarConvex,i,x,o,a,l,h,e,n,p)),p&&$||(n.getConvexTrianglePillar(R,E,!0),un.pointToWorldFrame(s,a,n.pillarOffset,x),i.distanceTo(x)<n.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&($=this.sphereConvex(e,n.pillarConvex,i,x,o,a,l,h,e,n,p)),p&&$))return!0;if(k.length-D>2)return}}boxHeightfield(e,n,i,s,o,a,l,h,u,f,p){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexHeightfield(e.convexPolyhedronRepresentation,n,i,s,o,a,l,h,e,n,p)}convexHeightfield(e,n,i,s,o,a,l,h,u,f,p){const m=n.data,v=n.elementSize,y=e.boundingSphereRadius,x=EXe,w=MXe,S=TXe;un.pointToLocalFrame(s,a,i,S);let O=Math.floor((S.x-y)/v)-1,_=Math.ceil((S.x+y)/v)+1,T=Math.floor((S.y-y)/v)-1,A=Math.ceil((S.y+y)/v)+1;if(_<0||A<0||O>m.length||T>m[0].length)return;O<0&&(O=0),_<0&&(_=0),T<0&&(T=0),A<0&&(A=0),O>=m.length&&(O=m.length-1),_>=m.length&&(_=m.length-1),A>=m[0].length&&(A=m[0].length-1),T>=m[0].length&&(T=m[0].length-1);const P=[];n.getRectMinMax(O,T,_,A,P);const N=P[0],k=P[1];if(!(S.z-y>k||S.z+y<N))for(let R=O;R<_;R++)for(let E=T;E<A;E++){let D=!1;if(n.getConvexTrianglePillar(R,E,!1),un.pointToWorldFrame(s,a,n.pillarOffset,x),i.distanceTo(x)<n.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(D=this.convexConvex(e,n.pillarConvex,i,x,o,a,l,h,null,null,p,w,null)),p&&D||(n.getConvexTrianglePillar(R,E,!0),un.pointToWorldFrame(s,a,n.pillarOffset,x),i.distanceTo(x)<n.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(D=this.convexConvex(e,n.pillarConvex,i,x,o,a,l,h,null,null,p,w,null)),p&&D))return!0}}sphereParticle(e,n,i,s,o,a,l,h,u,f,p){const m=_Xe;if(m.set(0,0,1),s.vsub(i,m),m.lengthSquared()<=e.radius*e.radius){if(p)return!0;const y=this.createContactEquation(h,l,n,e,u,f);m.normalize(),y.rj.copy(m),y.rj.scale(e.radius,y.rj),y.ni.copy(m),y.ni.negate(y.ni),y.ri.set(0,0,0),this.result.push(y),this.createFrictionEquationsFromContact(y,this.frictionResult)}}planeParticle(e,n,i,s,o,a,l,h,u,f,p){const m=bXe;m.set(0,0,1),l.quaternion.vmult(m,m);const v=xXe;if(s.vsub(l.position,v),m.dot(v)<=0){if(p)return!0;const x=this.createContactEquation(h,l,n,e,u,f);x.ni.copy(m),x.ni.negate(x.ni),x.ri.set(0,0,0);const w=wXe;m.scale(m.dot(s),w),s.vsub(w,w),x.rj.copy(w),this.result.push(x),this.createFrictionEquationsFromContact(x,this.frictionResult)}}boxParticle(e,n,i,s,o,a,l,h,u,f,p){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexParticle(e.convexPolyhedronRepresentation,n,i,s,o,a,l,h,e,n,p)}convexParticle(e,n,i,s,o,a,l,h,u,f,p){let m=-1;const v=SXe,y=CXe;let x=null;const w=OXe;if(w.copy(s),w.vsub(i,w),o.conjugate(p7),p7.vmult(w,w),e.pointIsInside(w)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(i,o),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(o);for(let S=0,O=e.faces.length;S!==O;S++){const _=[e.worldVertices[e.faces[S][0]]],T=e.worldFaceNormals[S];s.vsub(_[0],m7);const A=-T.dot(m7);if(x===null||Math.abs(A)<Math.abs(x)){if(p)return!0;x=A,m=S,v.copy(T)}}if(m!==-1){const S=this.createContactEquation(h,l,n,e,u,f);v.scale(x,y),y.vadd(s,y),y.vsub(i,y),S.rj.copy(y),v.negate(S.ni),S.ri.set(0,0,0);const O=S.ri,_=S.rj;O.vadd(s,O),O.vsub(h.position,O),_.vadd(i,_),_.vsub(l.position,_),this.result.push(S),this.createFrictionEquationsFromContact(S,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}heightfieldCylinder(e,n,i,s,o,a,l,h,u,f,p){return this.convexHeightfield(n,e,s,i,a,o,h,l,u,f,p)}particleCylinder(e,n,i,s,o,a,l,h,u,f,p){return this.convexParticle(n,e,s,i,a,o,h,l,u,f,p)}sphereTrimesh(e,n,i,s,o,a,l,h,u,f,p){const m=N7e,v=D7e,y=L7e,x=B7e,w=$7e,S=U7e,O=X7e,_=I7e,T=P7e,A=W7e;un.pointToLocalFrame(s,a,i,w);const P=e.radius;O.lowerBound.set(w.x-P,w.y-P,w.z-P),O.upperBound.set(w.x+P,w.y+P,w.z+P),n.getTrianglesInAABB(O,A);const N=R7e,k=e.radius*e.radius;for(let I=0;I<A.length;I++)for(let L=0;L<3;L++)if(n.getVertex(n.indices[A[I]*3+L],N),N.vsub(w,T),T.lengthSquared()<=k){if(_.copy(N),un.pointToWorldFrame(s,a,_,N),N.vsub(i,T),p)return!0;let U=this.createContactEquation(l,h,e,n,u,f);U.ni.copy(T),U.ni.normalize(),U.ri.copy(U.ni),U.ri.scale(e.radius,U.ri),U.ri.vadd(i,U.ri),U.ri.vsub(l.position,U.ri),U.rj.copy(N),U.rj.vsub(h.position,U.rj),this.result.push(U),this.createFrictionEquationsFromContact(U,this.frictionResult)}for(let I=0;I<A.length;I++)for(let L=0;L<3;L++){n.getVertex(n.indices[A[I]*3+L],m),n.getVertex(n.indices[A[I]*3+(L+1)%3],v),v.vsub(m,y),w.vsub(v,S);const U=S.dot(y);w.vsub(m,S);let V=S.dot(y);if(V>0&&U<0&&(w.vsub(m,S),x.copy(y),x.normalize(),V=S.dot(x),x.scale(V,S),S.vadd(m,S),S.distanceTo(w)<e.radius)){if(p)return!0;const H=this.createContactEquation(l,h,e,n,u,f);S.vsub(w,H.ni),H.ni.normalize(),H.ni.scale(e.radius,H.ri),H.ri.vadd(i,H.ri),H.ri.vsub(l.position,H.ri),un.pointToWorldFrame(s,a,S,S),S.vsub(h.position,H.rj),un.vectorToWorldFrame(a,H.ni,H.ni),un.vectorToWorldFrame(a,H.ri,H.ri),this.result.push(H),this.createFrictionEquationsFromContact(H,this.frictionResult)}}const R=V7e,E=F7e,D=z7e,$=k7e;for(let I=0,L=A.length;I!==L;I++){n.getTriangleVertices(A[I],R,E,D),n.getNormal(A[I],$),w.vsub(R,S);let U=S.dot($);if($.scale(U,S),w.vsub(S,S),U=S.distanceTo(w),Or.pointInTriangle(S,R,E,D)&&U<e.radius){if(p)return!0;let V=this.createContactEquation(l,h,e,n,u,f);S.vsub(w,V.ni),V.ni.normalize(),V.ni.scale(e.radius,V.ri),V.ri.vadd(i,V.ri),V.ri.vsub(l.position,V.ri),un.pointToWorldFrame(s,a,S,S),S.vsub(h.position,V.rj),un.vectorToWorldFrame(a,V.ni,V.ni),un.vectorToWorldFrame(a,V.ri,V.ri),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult)}}A.length=0}planeTrimesh(e,n,i,s,o,a,l,h,u,f,p){const m=new re,v=E7e;v.set(0,0,1),o.vmult(v,v);for(let y=0;y<n.vertices.length/3;y++){n.getVertex(y,m);const x=new re;x.copy(m),un.pointToWorldFrame(s,a,x,m);const w=M7e;if(m.vsub(i,w),v.dot(w)<=0){if(p)return!0;const O=this.createContactEquation(l,h,e,n,u,f);O.ni.copy(v);const _=A7e;v.scale(w.dot(v),_),m.vsub(_,_),O.ri.copy(_),O.ri.vsub(l.position,O.ri),O.rj.copy(m),O.rj.vsub(h.position,O.rj),this.result.push(O),this.createFrictionEquationsFromContact(O,this.frictionResult)}}}}const lf=new re,Im=new re,Nm=new re,O7e=new re,S7e=new re,C7e=new Cr,T7e=new Cr,E7e=new re,M7e=new re,A7e=new re,k7e=new re,P7e=new re;new re;const R7e=new re,I7e=new re,N7e=new re,D7e=new re,L7e=new re,B7e=new re,$7e=new re,U7e=new re,V7e=new re,F7e=new re,z7e=new re,X7e=new ca,W7e=[],bO=new re,f7=new re,G7e=new re,H7e=new re,Q7e=new re;function j7e(r,e,n){let i=null;const s=r.length;for(let o=0;o!==s;o++){const a=r[o],l=G7e;r[(o+1)%s].vsub(a,l);const h=H7e;l.cross(e,h);const u=Q7e;n.vsub(a,u);const f=h.dot(u);if(i===null||f>0&&i===!0||f<=0&&i===!1){i===null&&(i=f>0);continue}else return!1}return!0}const xO=new re,Y7e=new re,q7e=new re,Z7e=new re,K7e=[new re,new re,new re,new re,new re,new re],J7e=new re,eXe=new re,tXe=new re,iXe=new re,nXe=new re,rXe=new re,sXe=new re,oXe=new re,aXe=new re,lXe=new re,cXe=new re,hXe=new re,uXe=new re,dXe=new re;new re;new re;const fXe=new re,pXe=new re,mXe=new re,gXe=new re,vXe=new re,yXe=new re,bXe=new re,xXe=new re,wXe=new re,_Xe=new re,p7=new Cr,OXe=new re;new re;const SXe=new re,m7=new re,CXe=new re,TXe=new re,EXe=new re,MXe=[0],AXe=new re,kXe=new re;class g7{constructor(){this.current=[],this.previous=[]}getKey(e,n){if(n<e){const i=n;n=e,e=i}return e<<16|n}set(e,n){const i=this.getKey(e,n),s=this.current;let o=0;for(;i>s[o];)o++;if(i!==s[o]){for(let a=s.length-1;a>=o;a--)s[a+1]=s[a];s[o]=i}}tick(){const e=this.current;this.current=this.previous,this.previous=e,this.current.length=0}getDiff(e,n){const i=this.current,s=this.previous,o=i.length,a=s.length;let l=0;for(let h=0;h<o;h++){let u=!1;const f=i[h];for(;f>s[l];)l++;u=f===s[l],u||v7(e,f)}l=0;for(let h=0;h<a;h++){let u=!1;const f=s[h];for(;f>i[l];)l++;u=i[l]===f,u||v7(n,f)}}}function v7(r,e){r.push((e&4294901760)>>16,e&65535)}const Ik=(r,e)=>r<e?`${r}-${e}`:`${e}-${r}`;class PXe{constructor(){this.data={keys:[]}}get(e,n){const i=Ik(e,n);return this.data[i]}set(e,n,i){const s=Ik(e,n);this.get(e,n)||this.data.keys.push(s),this.data[s]=i}delete(e,n){const i=Ik(e,n),s=this.data.keys.indexOf(i);s!==-1&&this.data.keys.splice(s,1),delete this.data[i]}reset(){const e=this.data,n=e.keys;for(;n.length>0;){const i=n.pop();delete e[i]}}}class RXe extends pJ{constructor(e){e===void 0&&(e={}),super(),this.dt=-1,this.allowSleep=!!e.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=e.quatNormalizeSkip!==void 0?e.quatNormalizeSkip:0,this.quatNormalizeFast=e.quatNormalizeFast!==void 0?e.quatNormalizeFast:!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new re,e.gravity&&this.gravity.copy(e.gravity),e.frictionGravity&&(this.frictionGravity=new re,this.frictionGravity.copy(e.frictionGravity)),this.broadphase=e.broadphase!==void 0?e.broadphase:new U9e,this.bodies=[],this.hasActiveBodies=!1,this.solver=e.solver!==void 0?e.solver:new g7e,this.constraints=[],this.narrowphase=new _7e(this),this.collisionMatrix=new i7,this.collisionMatrixPrevious=new i7,this.bodyOverlapKeeper=new g7,this.shapeOverlapKeeper=new g7,this.contactmaterials=[],this.contactMaterialTable=new PXe,this.defaultMaterial=new jf("default"),this.defaultContactMaterial=new hT(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(e,n){return this.contactMaterialTable.get(e.id,n.id)}collisionMatrixTick(){const e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=e,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(e){this.constraints.push(e)}removeConstraint(e){const n=this.constraints.indexOf(e);n!==-1&&this.constraints.splice(n,1)}rayTest(e,n,i){i instanceof kC?this.raycastClosest(e,n,{skipBackfaces:!0},i):this.raycastAll(e,n,{skipBackfaces:!0},i)}raycastAll(e,n,i,s){return i===void 0&&(i={}),i.mode=Or.ALL,i.from=e,i.to=n,i.callback=s,Nk.intersectWorld(this,i)}raycastAny(e,n,i,s){return i===void 0&&(i={}),i.mode=Or.ANY,i.from=e,i.to=n,i.result=s,Nk.intersectWorld(this,i)}raycastClosest(e,n,i,s){return i===void 0&&(i={}),i.mode=Or.CLOSEST,i.from=e,i.to=n,i.result=s,Nk.intersectWorld(this,i)}addBody(e){this.bodies.includes(e)||(e.index=this.bodies.length,this.bodies.push(e),e.world=this,e.initPosition.copy(e.position),e.initVelocity.copy(e.velocity),e.timeLastSleepy=this.time,e instanceof Dt&&(e.initAngularVelocity.copy(e.angularVelocity),e.initQuaternion.copy(e.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=e,this.idToBodyMap[e.id]=e,this.dispatchEvent(this.addBodyEvent))}removeBody(e){e.world=null;const n=this.bodies.length-1,i=this.bodies,s=i.indexOf(e);if(s!==-1){i.splice(s,1);for(let o=0;o!==i.length;o++)i[o].index=o;this.collisionMatrix.setNumObjects(n),this.removeBodyEvent.body=e,delete this.idToBodyMap[e.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(e){return this.idToBodyMap[e]}getShapeById(e){const n=this.bodies;for(let i=0;i<n.length;i++){const s=n[i].shapes;for(let o=0;o<s.length;o++){const a=s[o];if(a.id===e)return a}}return null}addContactMaterial(e){this.contactmaterials.push(e),this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)}removeContactMaterial(e){const n=this.contactmaterials.indexOf(e);n!==-1&&(this.contactmaterials.splice(n,1),this.contactMaterialTable.delete(e.materials[0].id,e.materials[1].id))}fixedStep(e,n){e===void 0&&(e=1/60),n===void 0&&(n=10);const i=Br.now()/1e3;if(!this.lastCallTime)this.step(e,void 0,n);else{const s=i-this.lastCallTime;this.step(e,s,n)}this.lastCallTime=i}step(e,n,i){if(i===void 0&&(i=10),n===void 0)this.internalStep(e),this.time+=e;else{this.accumulator+=n;const s=Br.now();let o=0;for(;this.accumulator>=e&&o<i&&(this.internalStep(e),this.accumulator-=e,o++,!(Br.now()-s>e*1e3)););this.accumulator=this.accumulator%e;const a=this.accumulator/e;for(let l=0;l!==this.bodies.length;l++){const h=this.bodies[l];h.previousPosition.lerp(h.position,a,h.interpolatedPosition),h.previousQuaternion.slerp(h.quaternion,a,h.interpolatedQuaternion),h.previousQuaternion.normalize()}this.time+=n}}internalStep(e){this.dt=e;const n=this.contacts,i=BXe,s=$Xe,o=this.bodies.length,a=this.bodies,l=this.solver,h=this.gravity,u=this.doProfiling,f=this.profile,p=Dt.DYNAMIC;let m=-1/0;const v=this.constraints,y=LXe;h.length();const x=h.x,w=h.y,S=h.z;let O=0;for(u&&(m=Br.now()),O=0;O!==o;O++){const I=a[O];if(I.type===p){const L=I.force,U=I.mass;L.x+=U*x,L.y+=U*w,L.z+=U*S}}for(let I=0,L=this.subsystems.length;I!==L;I++)this.subsystems[I].update();u&&(m=Br.now()),i.length=0,s.length=0,this.broadphase.collisionPairs(this,i,s),u&&(f.broadphase=Br.now()-m);let _=v.length;for(O=0;O!==_;O++){const I=v[O];if(!I.collideConnected)for(let L=i.length-1;L>=0;L-=1)(I.bodyA===i[L]&&I.bodyB===s[L]||I.bodyB===i[L]&&I.bodyA===s[L])&&(i.splice(L,1),s.splice(L,1))}this.collisionMatrixTick(),u&&(m=Br.now());const T=DXe,A=n.length;for(O=0;O!==A;O++)T.push(n[O]);n.length=0;const P=this.frictionEquations.length;for(O=0;O!==P;O++)y.push(this.frictionEquations[O]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(i,s,this,n,T,this.frictionEquations,y),u&&(f.narrowphase=Br.now()-m),u&&(m=Br.now()),O=0;O<this.frictionEquations.length;O++)l.addEquation(this.frictionEquations[O]);const N=n.length;for(let I=0;I!==N;I++){const L=n[I],U=L.bi,V=L.bj,X=L.si,H=L.sj;let J;if(U.material&&V.material?J=this.getContactMaterial(U.material,V.material)||this.defaultContactMaterial:J=this.defaultContactMaterial,J.friction,U.material&&V.material&&(U.material.friction>=0&&V.material.friction>=0&&U.material.friction*V.material.friction,U.material.restitution>=0&&V.material.restitution>=0&&(L.restitution=U.material.restitution*V.material.restitution)),l.addEquation(L),U.allowSleep&&U.type===Dt.DYNAMIC&&U.sleepState===Dt.SLEEPING&&V.sleepState===Dt.AWAKE&&V.type!==Dt.STATIC){const ee=V.velocity.lengthSquared()+V.angularVelocity.lengthSquared(),ne=V.sleepSpeedLimit**2;ee>=ne*2&&(U.wakeUpAfterNarrowphase=!0)}if(V.allowSleep&&V.type===Dt.DYNAMIC&&V.sleepState===Dt.SLEEPING&&U.sleepState===Dt.AWAKE&&U.type!==Dt.STATIC){const ee=U.velocity.lengthSquared()+U.angularVelocity.lengthSquared(),ne=U.sleepSpeedLimit**2;ee>=ne*2&&(V.wakeUpAfterNarrowphase=!0)}this.collisionMatrix.set(U,V,!0),this.collisionMatrixPrevious.get(U,V)||(Ry.body=V,Ry.contact=L,U.dispatchEvent(Ry),Ry.body=U,V.dispatchEvent(Ry)),this.bodyOverlapKeeper.set(U.id,V.id),this.shapeOverlapKeeper.set(X.id,H.id)}for(this.emitContactEvents(),u&&(f.makeContactConstraints=Br.now()-m,m=Br.now()),O=0;O!==o;O++){const I=a[O];I.wakeUpAfterNarrowphase&&(I.wakeUp(),I.wakeUpAfterNarrowphase=!1)}for(_=v.length,O=0;O!==_;O++){const I=v[O];I.update();for(let L=0,U=I.equations.length;L!==U;L++){const V=I.equations[L];l.addEquation(V)}}l.solve(e,this),u&&(f.solve=Br.now()-m),l.removeAllEquations();const k=Math.pow;for(O=0;O!==o;O++){const I=a[O];if(I.type&p){const L=k(1-I.linearDamping,e),U=I.velocity;U.scale(L,U);const V=I.angularVelocity;if(V){const X=k(1-I.angularDamping,e);V.scale(X,V)}}}this.dispatchEvent(NXe),u&&(m=Br.now());const E=this.stepnumber%(this.quatNormalizeSkip+1)===0,D=this.quatNormalizeFast;for(O=0;O!==o;O++)a[O].integrate(e,E,D);this.clearForces(),this.broadphase.dirty=!0,u&&(f.integrate=Br.now()-m),this.stepnumber+=1,this.dispatchEvent(IXe);let $=!0;if(this.allowSleep)for($=!1,O=0;O!==o;O++){const I=a[O];I.sleepTick(this.time),I.sleepState!==Dt.SLEEPING&&($=!0)}this.hasActiveBodies=$}emitContactEvents(){const e=this.hasAnyEventListener("beginContact"),n=this.hasAnyEventListener("endContact");if((e||n)&&this.bodyOverlapKeeper.getDiff(Qc,jc),e){for(let o=0,a=Qc.length;o<a;o+=2)Iy.bodyA=this.getBodyById(Qc[o]),Iy.bodyB=this.getBodyById(Qc[o+1]),this.dispatchEvent(Iy);Iy.bodyA=Iy.bodyB=null}if(n){for(let o=0,a=jc.length;o<a;o+=2)Ny.bodyA=this.getBodyById(jc[o]),Ny.bodyB=this.getBodyById(jc[o+1]),this.dispatchEvent(Ny);Ny.bodyA=Ny.bodyB=null}Qc.length=jc.length=0;const i=this.hasAnyEventListener("beginShapeContact"),s=this.hasAnyEventListener("endShapeContact");if((i||s)&&this.shapeOverlapKeeper.getDiff(Qc,jc),i){for(let o=0,a=Qc.length;o<a;o+=2){const l=this.getShapeById(Qc[o]),h=this.getShapeById(Qc[o+1]);Yc.shapeA=l,Yc.shapeB=h,l&&(Yc.bodyA=l.body),h&&(Yc.bodyB=h.body),this.dispatchEvent(Yc)}Yc.bodyA=Yc.bodyB=Yc.shapeA=Yc.shapeB=null}if(s){for(let o=0,a=jc.length;o<a;o+=2){const l=this.getShapeById(jc[o]),h=this.getShapeById(jc[o+1]);qc.shapeA=l,qc.shapeB=h,l&&(qc.bodyA=l.body),h&&(qc.bodyB=h.body),this.dispatchEvent(qc)}qc.bodyA=qc.bodyB=qc.shapeA=qc.shapeB=null}}clearForces(){const e=this.bodies,n=e.length;for(let i=0;i!==n;i++){const s=e[i];s.force,s.torque,s.force.set(0,0,0),s.torque.set(0,0,0)}}}new ca;const Nk=new Or,Br=globalThis.performance||{};if(!Br.now){let r=Date.now();Br.timing&&Br.timing.navigationStart&&(r=Br.timing.navigationStart),Br.now=()=>Date.now()-r}new re;const IXe={type:"postStep"},NXe={type:"preStep"},Ry={type:Dt.COLLIDE_EVENT_NAME,body:null,contact:null},DXe=[],LXe=[],BXe=[],$Xe=[],Qc=[],jc=[],Iy={type:"beginContact",bodyA:null,bodyB:null},Ny={type:"endContact",bodyA:null,bodyB:null},Yc={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},qc={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},UXe={style:{position:"relative",width:"100%",height:"100vh"}},VXe=xt("div",{id:"pixiDom",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}},null,-1),FXe=xt("div",{id:"threeDom",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}},null,-1),zXe=[VXe,FXe],XXe={__name:"Game2048",setup(r){var e=new Eze,n=new c9e,i={border:{minX:-10,maxX:10,minY:-10,maxY:10},world:new RXe};window.g=i;var s=["#E0F7E6","#B2E9C1","#8CDBAA","#66CC99","#4CAF89","#3F9E8C","#348899","#2979A5","#1F5F9E","#1A4976","#6A5ACD","#9575CD","#AB47BC","#D81B60","#FF7043","#FFB300","#FFA000","#E53935","#C62828","#8E0000"];function o(P){const N=parseInt(P.substring(1),16),k=N>>16&255,R=N>>8&255,E=N&255;return(k*299+R*587+E*114)/1e3>128?"#000000":"#FFFFFF"}function a(P){var N=new vr().setFromObject(P);return N.getSize(new le)}i.test=function(){console.log("test",a(i.player.cubes[0]))};async function l(){i.player=new h([2]),i.scene.add(i.player),i.player.add(i.camera)}class h extends qs{constructor(N){super(),this.cubes=[];for(var k=0;k<N.length;k++)this.addCube(N[k]);this.speed=1,this.frame=0,this.moveItems=[],this.moveDir=null,this.mergingIndex=-1}setSpeed(N){this.speed=N}updatePre(){if(this.moveDir){for(var N=this.frame,k=[],R=0;R<this.cubes.length;R++){var E=this.cubes[R];k.push(N),N-=60}for(var R=0;R<this.cubes.length;R++){var E=this.cubes[R],N=k[R],D=null;if(R==0){var D=this.moveDir.clone().multiplyScalar(this.speed);E.body.velocity.set(D.x,D.y,0),E.body.quaternion.setFromAxisAngle(new re(0,0,1),Math.atan2(D.y,D.x))}else{var $=this.moveItems.find(V=>V.frame===N);if(!$){E.body.position.copy(this.getCubeStandPos(R));continue}E.body.position.copy($.position),E.body.quaternion.setFromAxisAngle(new re(0,0,1),Math.atan2($.moveDir.y,$.moveDir.x))}}}}updateAfter(){var N=this.cubes[0];this.position.copy(N.body.position);var N=this.cubes[0];this.moveItems.push({frame:this.frame,moveDir:this.moveDir,velocity:N.body.velocity.clone(),position:this.position.clone()}),this.moveItems.length>1e5&&this.moveItems.shift(),this.frame+=1}checkMerge(){for(var N=Date.now(),k={},R=0;R<this.cubes.length;R++){var E=this.cubes[R];if(!(N-E.createTime<700)){var D=E.num;if(k[D]||(k[D]=[]),k[D].push(E),k[D].length==2)break}}var $=[];for(var D in k){var I=k[D];if(I.length>=2){$=I;break}}return $.length==0?!1:(this.mergingCube=$[1],this.mergingCubes=$,this.mergingIndex=this.cubes.indexOf(this.mergingCube),this.mergingStep=10,$.length>0)}doMergeReplace(){var N=this.mergingCubes[0],k=this.mergingCubes[1],R=N.num+k.num,E=this.cubes.indexOf(N);this.removeCube(N),this.removeCube(k),this.addCube(R,E)}addCube(N,k){k??(k=this.cubes.length);var R=u(N,k==0);k!=0&&(R.body.isTrigger=!0,R.body.type=Dt.KINEMATIC),R.body.material=i.snakeMaterial,R.body.position.copy(this.getCubeStandPos(k)),this.cubes.splice(k,0,R),R.createTime=Date.now(),i.scene.add(R)}removeCube(N){var k=this.cubes.indexOf(N);k>=0&&(this.cubes.splice(k,1),i.scene.remove(N))}getCubeStandPos(N){var k=this.position.clone();if(N==0)return k;{var R=this.cubes[N-1],E=a(R);let D=new le(1,0,0);return D.applyMatrix4(R.modelParent.matrixWorld),D.normalize().multiplyScalar(-E.x),k.add(D),k}}setMoveDir(N){this.moveDir=N.clone().normalize()}}function u(P,N){var k=new qs;k.num=P;var R=Math.log2(P)-1,E=s[R],D=1+R*.1;k.scale.set(D,D,D),k.modelParent=new qs,k.add(k.modelParent),k.model=i.assets.cube.scene.clone(),k.model.castShadow=!0,k.modelParent.add(k.model),k.model.traverse(ee=>{ee.isMesh&&(ee.material=new d0({color:E,transparent:!0,opacity:1}),ee.castShadow=!0)}),k.model.rotateX(Math.PI/2),k.text=new ln(new l9e(P.toString(),{font:i.assets.font,size:.6,depth:0,curveSegments:10,bevelEnabled:!0,bevelThickness:.01,bevelSize:.02,bevelSegments:3}),new vs({color:12255232})),k.add(k.text);var $=1-R*.05;k.text.scale.set($,$,$);var I=o(E);k.text.material.color.set(I);var L=new vr().setFromObject(k.text),U=L.getSize(new le),V=new vr().setFromObject(k),X=V.getSize(new le);if(k.text.position.set(-U.x/2,-U.y/2,X.z/2),N){var N=i.assets.trigo.scene.clone();k.modelParent.add(N),N.position.set(.8,0,0)}const H=new yb(new re(.5,.5,.25)),J=new Dt({mass:.1,fixedRotation:!0,position:new re(0,0,0),shape:H,material:i.cubeMaterial});return i.world.addBody(J),J.obj=k,k.body=J,k}function f(){requestAnimationFrame(f),i.player&&!i.paused&&i.player.updatePre();{i.world.step(1/60);for(let P=0;P<i.world.bodies.length;++P){const N=i.world.bodies[P],k=N.obj;k.position.copy(N.position),k.quaternion.copy(N.quaternion)}}i.player&&!i.paused&&i.player.updateAfter(),p(),i.mouse&&i.mouse.buttons===1&&i.rope&&i.rope.position.set(i.mouse.global.x,i.mouse.global.y),i.controls&&i.controls.update(),i.renderer.render(i.scene,i.camera)}function p(P){i.foodCube&&!P||(i.foodCube=u(2),i.scene.add(i.foodCube),i.foodCube.body.position.set(0,-2,0))}function m(){const P=new Xe;P.x=i.mouse.x/i.renderer.domElement.clientWidth*2-1,P.y=-(i.mouse.y/i.renderer.domElement.clientHeight)*2+1,i.raycaster.setFromCamera(P,i.camera);const N=new wa(new le(0,0,1),0),k=new le;i.raycaster.ray.intersectPlane(N,k);var R=k.clone().sub(i.player.position);R.z=0,i.player.setMoveDir(R)}function v(P){i.mouse=P,i.player.setSpeed(5),m()}function y(P){i.mouse=P,m()}function x(P){i.mouse=P,i.player.setSpeed(1),m()}function w(P){i.keys[P.key]=!0,P.key==="f"?(i.player.cubes[i.player.cubes.length-1].num,i.player.addCube(2)):P.key==="p"?i.paused=!i.paused:P.key==="s"?(i.paused=!0,i.player.update()):P.key==="a"&&p(!0)}function S(P){delete i.keys[P.key]}function O(){var P=document.getElementById("threeDom"),N=new np;i.scene=N;var k=new fn(75,P.clientWidth/P.clientHeight,.1,1e3);i.camera=k,k.position.set(0,0,10),N.add(k);var R=new dg({antialias:!0});i.renderer=R,R.setSize(P.clientWidth,P.clientHeight),R.setClearColor(14741224,1),R.shadowMap.enabled=!0,R.shadowMap.type=QC,P.appendChild(R.domElement);var E=new b2(16777215,1);N.add(E);var D=new Ub(16777215,3);D.position.set(1,1,1),D.castShadow=!0,N.add(D),i.raycaster=new _2}function _(P,N,k){const R=new yb(new re(N.x/2,N.y/2,N.z/2)),E=new Dt({mass:0,position:P,shape:R,material:i.groundMaterial});i.world.addBody(E);const D=new Rh(N.x,N.y,N.z),$=new fg({color:k}),I=new ln(D,$);I.receiveShadow=!0,i.scene.add(I),E.obj=I,I.body=E}function T(){i.world.gravity.set(0,0,-10),i.groundMaterial=new jf({friction:.06,restitution:.2}),i.snakeMaterial=new jf({friction:0,restitution:.2}),i.cubeMaterial=new jf({friction:.06,restitution:.2}),_(new re(0,i.border.maxY+.5,-.25),{x:i.border.maxX-i.border.minX,y:1,z:1},"#3f72af"),_(new re(0,i.border.minY-.5,-.25),{x:i.border.maxX-i.border.minX,y:1,z:1},"#3f72af"),_(new re(i.border.minX-.5,0,-.25),{x:1,y:i.border.maxY-i.border.minY+2,z:1},"#3f72af"),_(new re(i.border.maxX+.5,0,-.25),{x:1,y:i.border.maxY-i.border.minY+2,z:1},"#3f72af"),_(new re(0,0,-.75),{x:i.border.maxX-i.border.minX,y:i.border.maxY-i.border.minY+2,z:1},"#00b8a9")}async function A(){Eo.addBundle("assets",{rope1:"img/rope1.png"}),i.assets=await Eo.loadBundle("assets");for(var P=[{name:"cube",url:"game2048/cube.glb",loader:e},{name:"trigo",url:"game2048/trigo.glb",loader:e},{name:"font",url:"fonts/gentilis_regular.typeface.json",loader:n}],N=0;N<P.length;N++){var k=P[N],R=await k.loader.loadAsync(k.url);i.assets[k.name]=R}}return Xn(async()=>{var P=document.getElementById("pixiDom");i.app=new hx({resizeTo:P,transparent:!0,backgroundAlpha:0}),P.appendChild(i.app.view),i.center={x:i.app.screen.width/2,y:i.app.screen.height/2},i.keys={},i.preKeys={},await A(),O(),T(),l(),f(),document.addEventListener("pointerdown",v),document.addEventListener("pointermove",y),document.addEventListener("pointerup",x),document.addEventListener("keydown",w),document.addEventListener("keyup",S)}),Po(()=>{i.app.destroy(!0,!0)}),(P,N)=>(ri(),Ji("div",UXe,zXe))}};var qR={exports:{}};(function(r,e){(function(n,i){i(e,vj)})(Ia,function(n,i){const s=typeof window<"u",o=function(){return s&&document.addEventListener?function(c,d,g,M=!1){c&&d&&g&&c.addEventListener(d,g,M)}:function(c,d,g){c&&d&&g&&c.attachEvent("on"+d,g)}}(),a=function(){return s&&document.removeEventListener?function(c,d,g,M=!1){c&&d&&c.removeEventListener(d,g,M)}:function(c,d,g){c&&d&&c.detachEvent("on"+d,g)}}();var l=(c,d)=>{const g=c.__vccOpts||c;for(const[M,C]of d)g[M]=C;return g};const h="ivu-affix";function u(c,d){const g=d?"pageYOffset":"pageXOffset",M=d?"scrollTop":"scrollLeft";let C=c[g];return s&&typeof C!="number"&&(C=window.document.documentElement[M]),C}function f(c){if(!s)return;const d=c.getBoundingClientRect(),g=u(window,!0),M=u(window),C=window.document.body,b=C.clientTop||0,B=C.clientLeft||0;return{top:d.top+g-b,left:d.left+M-B}}const p={name:"Affix",emits:["on-change"],props:{offsetTop:{type:Number,default:0},offsetBottom:{type:Number},useCapture:{type:Boolean,default:!1}},data(){return{affix:!1,styles:{},slot:!1,slotStyle:{}}},computed:{offsetType(){let c="top";return this.offsetBottom>=0&&(c="bottom"),c},classes(){return[{[`${h}`]:this.affix}]}},mounted(){o(window,"scroll",this.handleScroll,this.useCapture),o(window,"resize",this.handleScroll,this.useCapture),i.nextTick(()=>{this.handleScroll()})},beforeUnmount(){a(window,"scroll",this.handleScroll,this.useCapture),a(window,"resize",this.handleScroll,this.useCapture)},methods:{handleScroll(){if(!s)return;const c=this.affix,d=u(window,!0),g=f(this.$el),M=window.innerHeight,C=this.$el.getElementsByTagName("div")[0].offsetHeight;g.top-this.offsetTop<d&&this.offsetType=="top"&&!c?(this.affix=!0,this.slotStyle={width:this.$refs.point.clientWidth+"px",height:this.$refs.point.clientHeight+"px"},this.slot=!0,this.styles={top:`${this.offsetTop}px`,left:`${g.left}px`,width:`${this.$el.offsetWidth}px`},this.$emit("on-change",!0)):g.top-this.offsetTop>d&&this.offsetType=="top"&&c&&(this.slot=!1,this.slotStyle={},this.affix=!1,this.styles=null,this.$emit("on-change",!1)),g.top+this.offsetBottom+C>d+M&&this.offsetType=="bottom"&&!c?(this.affix=!0,this.styles={bottom:`${this.offsetBottom}px`,left:`${g.left}px`,width:`${this.$el.offsetWidth}px`},this.$emit("on-change",!0)):g.top+this.offsetBottom+C<d+M&&this.offsetType=="bottom"&&c&&(this.affix=!1,this.styles=null,this.$emit("on-change",!1))}}};function m(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",null,[i.createElementVNode("div",{ref:"point",class:i.normalizeClass(b.classes),style:i.normalizeStyle(C.styles)},[i.renderSlot(c.$slots,"default")],6),i.withDirectives(i.createElementVNode("div",{style:i.normalizeStyle(C.slotStyle)},null,4),[[i.vShow,C.slot]])])}var v=l(p,[["render",m]]);const y="ivu-icon",x={name:"Icon",props:{type:{type:String,default:""},size:[Number,String],color:String,custom:{type:String,default:""}},computed:{classes(){return[`${y}`,{[`${y}-${this.type}`]:this.type!=="",[`${this.custom}`]:this.custom!==""}]},styles(){let c={};return this.size&&(c["font-size"]=`${this.size}px`),this.color&&(c.color=this.color),c}}};function w(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("i",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.styles)},null,6)}var S=l(x,[["render",w]]);function O(c,d){for(let g=0;g<d.length;g++)if(c===d[g])return!0;return!1}let _;function T(c){if(s&&_===void 0){const d=document.createElement("div");d.style.width="100%",d.style.height="200px";const g=document.createElement("div"),M=g.style;M.position="absolute",M.top=0,M.left=0,M.pointerEvents="none",M.visibility="hidden",M.width="200px",M.height="150px",M.overflow="hidden",g.appendChild(d),document.body.appendChild(g);const C=d.offsetWidth;g.style.overflow="scroll";let b=d.offsetWidth;C===b&&(b=g.clientWidth),document.body.removeChild(g),_=C-b}return _}const A=s&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)||!1,P=/([\:\-\_]+(.))/g,N=/^moz([A-Z])/;function k(c){return c.replace(P,function(d,g,M,C){return C?M.toUpperCase():M}).replace(N,"Moz$1")}function R(c,d){if(s){if(!c||!d)return null;d=k(d),d==="float"&&(d="cssFloat");try{const g=document.defaultView.getComputedStyle(c,"");return c.style[d]||g?g[d]:null}catch{return c.style[d]}}}function E(c){return c.toString()[0].toUpperCase()+c.toString().slice(1)}function D(c){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(c)]}function $(c){const d=D(c);let g;if(d==="array")g=[];else if(d==="object")g={};else return c;if(d==="array")for(let M=0;M<c.length;M++)g.push($(c[M]));else if(d==="object")for(let M in c)g[M]=$(c[M]);return g}function I(c,d=0,g,M=500,C){if(!s)return;window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Y){return window.setTimeout(Y,1e3/60)});const b=Math.abs(d-g),B=Math.ceil(b/M*50);function F(Y,G,K){if(Y===G){C&&C();return}let fe=Y+K>G?G:Y+K;Y>G&&(fe=Y-K<G?G:Y-K),c===window?window.scrollTo(fe,fe):c.scrollTop=fe,window.requestAnimationFrame(()=>F(fe,G,K))}F(d,g,B)}function L(c,d,g){typeof d=="string"?g=[d]:g=d;let M=c.$parent,C=M.$options.name;for(;M&&(!C||g.indexOf(C)<0);)M=M.$parent,M&&(C=M.$options.name);return M}function U(c,d){let g=[];const M=c.$parent;return M?(M.$options.name===d&&g.push(M),g.concat(U(M,d))):[]}const V=function(c){return(c||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")};function X(c,d){if(!c||!d)return!1;if(d.indexOf(" ")!==-1)throw new Error("className should not contain space.");return c.classList?c.classList.contains(d):(" "+c.className+" ").indexOf(" "+d+" ")>-1}function H(c,d){if(!c)return;let g=c.className;const M=(d||"").split(" ");for(let C=0,b=M.length;C<b;C++){const B=M[C];!B||(c.classList?c.classList.add(B):X(c,B)||(g+=" "+B))}c.classList||(c.className=g)}function J(c,d){if(!c||!d)return;const g=d.split(" ");let M=" "+c.className+" ";for(let C=0,b=g.length;C<b;C++){const B=g[C];!B||(c.classList?c.classList.remove(B):X(c,B)&&(M=M.replace(" "+B+" "," ")))}c.classList||(c.className=V(M))}const ee={xs:"480px",sm:"576px",md:"768px",lg:"992px",xl:"1200px",xxl:"1600px"};function ne(){if(!s)return;const c=d=>({media:d,matches:!1,on(){},off(){}});window.matchMedia=window.matchMedia||c}const ge=/#([^#]+)$/;async function ye(c,d="unnamed"){if(!s)return Promise.reject();try{const g=await(await fetch(c)).blob();if(!g)return Promise.reject();const M=URL.createObjectURL(g),C=document.createElement("a");return C.setAttribute("href",M),C.setAttribute("download",d),C.click(),URL.revokeObjectURL(M),Promise.resolve()}catch(g){return Promise.reject(g)}}const ce="ivu-alert",we={name:"Alert",components:{Icon:S},props:{type:{validator(c){return O(c,["success","info","warning","error"])},default:"info"},closable:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!1},banner:{type:Boolean,default:!1},fade:{type:Boolean,default:!0}},data(){return{closed:!1,desc:!1}},computed:{wrapClasses(){return[`${ce}`,`${ce}-${this.type}`,{[`${ce}-with-icon`]:this.showIcon,[`${ce}-with-desc`]:this.desc,[`${ce}-with-banner`]:this.banner}]},messageClasses(){return`${ce}-message`},descClasses(){return`${ce}-desc`},closeClasses(){return`${ce}-close`},iconClasses(){return`${ce}-icon`},iconType(){let c="";switch(this.type){case"success":c="ios-checkmark-circle";break;case"info":c="ios-information-circle";break;case"warning":c="ios-alert";break;case"error":c="ios-close-circle";break}return this.desc&&(c+="-outline"),c}},methods:{close(c){this.closed=!0,this.$emit("on-close",c)}},mounted(){this.desc=this.$slots.desc!==void 0}};function be(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createBlock(i.Transition,{name:g.fade?"fade":""},{default:i.withCtx(()=>[C.closed?i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.wrapClasses)},[g.showIcon?(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass(b.iconClasses)},[i.renderSlot(c.$slots,"icon",{},()=>[i.createVNode(B,{type:b.iconType},null,8,["type"])])],2)):i.createCommentVNode("",!0),i.createElementVNode("span",{class:i.normalizeClass(b.messageClasses)},[i.renderSlot(c.$slots,"default")],2),i.createElementVNode("span",{class:i.normalizeClass(b.descClasses)},[i.renderSlot(c.$slots,"desc")],2),g.closable?(i.openBlock(),i.createElementBlock("a",{key:1,class:i.normalizeClass(b.closeClasses),onClick:d[0]||(d[0]=(...F)=>b.close&&b.close(...F))},[i.renderSlot(c.$slots,"close",{},()=>[i.createVNode(B,{type:"ios-close"})])],2)):i.createCommentVNode("",!0)],2))]),_:3},8,["name"])}var se=l(we,[["render",be]]);const ae={name:"Anchor",provide(){return{AnchorInstance:this}},emits:["on-change","on-select"],props:{affix:{type:Boolean,default:!0},offsetTop:{type:Number,default:0},offsetBottom:Number,bounds:{type:Number,default:5},container:null,showInk:{type:Boolean,default:!1},scrollOffset:{type:Number,default:0}},data(){return{prefix:"ivu-anchor",isAffixed:!1,inkTop:0,animating:!1,currentLink:"",currentId:"",scrollContainer:null,scrollElement:null,wrapperTop:0,upperFirstTitle:!0,links:[]}},computed:{wrapperComponent(){return this.affix?"Affix":"div"},wrapperStyle(){return{maxHeight:this.offsetTop?`calc(100vh - ${this.offsetTop}px)`:"100vh"}},containerIsWindow(){return this.scrollContainer===window},titlesOffsetArr(){const c=this.links.map(g=>g.link.href).map(g=>g.split("#")[1]);let d=[];return s&&c.forEach(g=>{const M=document.getElementById(g);M&&d.push({link:`#${g}`,offset:M.offsetTop-this.scrollElement.offsetTop})}),d}},methods:{handleAffixStateChange(c){this.isAffixed=this.affix&&c},handleScroll(c){if(this.upperFirstTitle=!!this.titlesOffsetArr[0]&&c.target.scrollTop<this.titlesOffsetArr[0].offset,this.animating)return;const d=s?document.documentElement.scrollTop||document.body.scrollTop||c.target.scrollTop:0;this.getCurrentScrollAtTitleId(d)},handleHashChange(){if(!s)return;const c=window.location.href,d=ge.exec(c);!d||(this.currentLink=d[0],this.currentId=d[1])},handleScrollTo(){if(!s)return;const c=document.getElementById(this.currentId),d=document.querySelector(`a[data-href="${this.currentLink}"]`);let g=this.scrollOffset;if(d&&(g=parseFloat(d.getAttribute("data-scroll-offset"))),!c)return;const M=c.offsetTop-this.wrapperTop-g;this.animating=!0,I(this.scrollContainer,this.scrollElement.scrollTop,M,600,()=>{this.animating=!1}),this.handleSetInkTop()},handleSetInkTop(){if(!s)return;const c=document.querySelector(`a[data-href="${this.currentLink}"]`);if(!c)return;const d=c.offsetTop,g=d<0?this.offsetTop:d;this.inkTop=g},getCurrentScrollAtTitleId(c){let d=-1,g=this.titlesOffsetArr.length,M={link:"#",offset:0};for(c+=this.bounds;++d<g;){let C=this.titlesOffsetArr[d],b=this.titlesOffsetArr[d+1];if(c>=C.offset&&c<(b&&b.offset||1/0)){M=this.titlesOffsetArr[d];break}}this.currentLink=M.link,this.handleSetInkTop()},getContainer(){!s||(this.scrollContainer=this.container?typeof this.container=="string"?document.querySelector(this.container):this.container:window,this.scrollElement=this.container?this.scrollContainer:document.documentElement||document.body)},removeListener(){a(this.scrollContainer,"scroll",this.handleScroll),a(window,"hashchange",this.handleHashChange)},init(){this.handleHashChange(),i.nextTick(()=>{this.removeListener(),this.getContainer(),this.wrapperTop=this.containerIsWindow?0:this.scrollElement.offsetTop,this.handleScrollTo(),this.handleSetInkTop(),this.titlesOffsetArr[0]&&(this.upperFirstTitle=this.scrollElement.scrollTop<this.titlesOffsetArr[0].offset),o(this.scrollContainer,"scroll",this.handleScroll),o(window,"hashchange",this.handleHashChange)})},addLink(c,d){this.links.push({id:c,link:d})},removeLink(c){const d=this.links.findIndex(g=>g.id===c);this.links.splice(d,1)}},watch:{$route(){this.currentLink="",this.currentId="",this.handleHashChange(),i.nextTick(()=>{this.handleScrollTo()})},container(){this.init()},currentLink(c,d){this.$emit("on-change",c,d)}},mounted(){this.init()},beforeUnmount(){this.removeListener()}};function Q(c,d,g,M,C,b){return i.openBlock(),i.createBlock(i.resolveDynamicComponent(b.wrapperComponent),{"offset-top":g.offsetTop,"offset-bottom":g.offsetBottom,onOnChange:b.handleAffixStateChange},{default:i.withCtx(()=>[i.createElementVNode("div",{class:i.normalizeClass(`${C.prefix}-wrapper`),style:i.normalizeStyle(b.wrapperStyle)},[i.createElementVNode("div",{class:i.normalizeClass(`${C.prefix}`)},[i.createElementVNode("div",{class:i.normalizeClass(`${C.prefix}-ink`)},[i.withDirectives(i.createElementVNode("span",{class:i.normalizeClass(`${C.prefix}-ink-ball`),style:i.normalizeStyle({top:`${C.inkTop}px`})},null,6),[[i.vShow,g.showInk]])],2),i.renderSlot(c.$slots,"default")],2)],6)]),_:3},40,["offset-top","offset-bottom","onOnChange"])}var z=l(ae,[["render",Q]]);function j(c=32){const d="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",g=d.length;let M="";for(let C=0;C<c;C++)M+=d.charAt(Math.floor(Math.random()*g));return M}const te={name:"AnchorLink",inject:["AnchorInstance"],props:{href:String,title:String,scrollOffset:{type:Number,default(){return i.inject("AnchorInstance").scrollOffset}}},data(){return{prefix:"ivu-anchor-link",id:j(6)}},computed:{anchorLinkClasses(){return[this.prefix,this.AnchorInstance.currentLink===this.href?`${this.prefix}-active`:""]},linkTitleClasses(){return[`${this.prefix}-title`]}},methods:{goAnchor(){this.currentLink=this.href,this.AnchorInstance.handleHashChange(),this.AnchorInstance.handleScrollTo(),this.AnchorInstance.$emit("on-select",this.href),this.$router?this.$router.push(this.href,()=>{}):s&&(window.location.href=this.href)}},mounted(){this.AnchorInstance.addLink(this.id,this),i.nextTick(()=>{this.AnchorInstance.init()})},beforeUnmount(){this.AnchorInstance.removeLink(this.id)}},W=["href","data-scroll-offset","data-href","title"];function Z(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.anchorLinkClasses)},[i.createElementVNode("a",{class:i.normalizeClass(b.linkTitleClasses),href:g.href,"data-scroll-offset":g.scrollOffset,"data-href":g.href,onClick:d[0]||(d[0]=i.withModifiers((...B)=>b.goAnchor&&b.goAnchor(...B),["prevent"])),title:g.title},i.toDisplayString(g.title),11,W),i.renderSlot(c.$slots,"default")],2)}var he=l(te,[["render",Z]]),pe={props:{to:{type:[Object,String]},replace:{type:Boolean,default:!1},target:{type:String,validator(c){return O(c,["_blank","_self","_parent","_top"])},default:"_self"},append:{type:Boolean,required:!1,default:!1}},computed:{linkUrl(){if(typeof this.to!="string")return null;if(this.to.includes("//"))return this.to;const c=this.$router;if(c){const d=this.$route,g=c.resolve(this.to,d,this.append);return g?g.href:this.to}return this.to}},methods:{handleOpenTo(){if(!s)return;const c=this.$router;let d=this.to;if(c){const g=this.$route,M=c.resolve(this.to,g,this.append);d=M?M.href:this.to}typeof this.to!="string"&&window.open(d)},handleClick(c=!1){const d=this.$router;!s||(c?this.handleOpenTo():d?typeof this.to=="string"&&this.to.includes("//")?window.location.href=this.to:this.replace?this.$router.replace(this.to,()=>{}):this.$router.push(this.to,()=>{}):window.location.href=this.to)},handleCheckClick(c,d=!1){if(this.to){if(this.target==="_blank")return this.handleOpenTo(),!1;c.preventDefault(),this.handleClick(d)}}}};function _e(c,d){let g=!1;return d.forEach(M=>{c.includes(M)&&(g=!0)}),g}const Re={name:"Auth",mixins:[pe],emits:["click"],props:{authority:{type:[String,Array,Function,Boolean],default:!0},access:{type:[String,Array]},prevent:{type:Boolean,default:!1},message:{type:String,default:"您没有权限进行此操作"},customTip:{type:Boolean,default:!1},display:{type:String}},computed:{isPermission(){let c;if(typeof this.authority=="boolean")c=this.authority;else if(this.authority instanceof Function)c=this.authority();else{const d=typeof this.authority=="string"?[this.authority]:this.authority,g=typeof this.access=="string"?[this.access]:this.access;c=_e(d,g)}return c},options(){let c={};return this.display&&(c.display=this.display),{class:{"ivu-auth":!0,"ivu-auth-permission":this.isPermission,"ivu-auth-no-math":!this.isPermission,"ivu-auth-redirect":!this.isPermission&&this.to,"ivu-auth-prevent":this.prevent},style:c}}},render(){return this.isPermission?i.h("div",this.options,this.$slots.default()):this.to?i.h("div",this.options):this.prevent?i.h("div",Object.assign({},this.options,{onClick:this.handlePreventClick}),[i.h("div",{class:"ivu-auth-prevent-no-match"},this.$slots.default())]):i.h("div",this.options,this.$slots.noMatch())},methods:{handlePreventClick(c){this.isPermission||(this.customTip||this.$Message.info({content:this.message,duration:3}),this.$emit("click",c))}},created(){!this.isPermission&&this.to&&this.handleClick(!1)}};var ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Ia<"u"?Ia:typeof self<"u"?self:{};function q(c){throw new Error('Could not dynamically require "'+c+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var me={exports:{}};/**!
* @fileOverview Kickass library to create and place poppers near their reference elements.
* @version 1.16.1
* @license
* Copyright (c) 2016 Federico Zivolo and contributors
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/(function(c,d){(function(g,M){c.exports=M()})(ie,function(){var g=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",M=function(){for(var oe=["Edge","Trident","Firefox"],Se=0;Se<oe.length;Se+=1)if(g&&navigator.userAgent.indexOf(oe[Se])>=0)return 1;return 0}();function C(oe){var Se=!1;return function(){Se||(Se=!0,window.Promise.resolve().then(function(){Se=!1,oe()}))}}function b(oe){var Se=!1;return function(){Se||(Se=!0,setTimeout(function(){Se=!1,oe()},M))}}var B=g&&window.Promise,F=B?C:b;function Y(oe){var Se={};return oe&&Se.toString.call(oe)==="[object Function]"}function G(oe,Se){if(oe.nodeType!==1)return[];var Ae=oe.ownerDocument.defaultView,De=Ae.getComputedStyle(oe,null);return Se?De[Se]:De}function K(oe){return oe.nodeName==="HTML"?oe:oe.parentNode||oe.host}function fe(oe){if(!oe)return document.body;switch(oe.nodeName){case"HTML":case"BODY":return oe.ownerDocument.body;case"#document":return oe.body}var Se=G(oe),Ae=Se.overflow,De=Se.overflowX,Je=Se.overflowY;return/(auto|scroll|overlay)/.test(Ae+Je+De)?oe:fe(K(oe))}function Ee(oe){return oe&&oe.referenceNode?oe.referenceNode:oe}var Ce=g&&!!(window.MSInputMethodContext&&document.documentMode),Oe=g&&/MSIE 10/.test(navigator.userAgent);function ue(oe){return oe===11?Ce:oe===10?Oe:Ce||Oe}function Ne(oe){if(!oe)return document.documentElement;for(var Se=ue(10)?document.body:null,Ae=oe.offsetParent||null;Ae===Se&&oe.nextElementSibling;)Ae=(oe=oe.nextElementSibling).offsetParent;var De=Ae&&Ae.nodeName;return!De||De==="BODY"||De==="HTML"?oe?oe.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(Ae.nodeName)!==-1&&G(Ae,"position")==="static"?Ne(Ae):Ae}function jt(oe){var Se=oe.nodeName;return Se==="BODY"?!1:Se==="HTML"||Ne(oe.firstElementChild)===oe}function _t(oe){return oe.parentNode!==null?_t(oe.parentNode):oe}function Et(oe,Se){if(!oe||!oe.nodeType||!Se||!Se.nodeType)return document.documentElement;var Ae=oe.compareDocumentPosition(Se)&Node.DOCUMENT_POSITION_FOLLOWING,De=Ae?oe:Se,Je=Ae?Se:oe,Ke=document.createRange();Ke.setStart(De,0),Ke.setEnd(Je,0);var it=Ke.commonAncestorContainer;if(oe!==it&&Se!==it||De.contains(Je))return jt(it)?it:Ne(it);var ht=_t(oe);return ht.host?Et(ht.host,Se):Et(oe,_t(Se).host)}function je(oe){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",Ae=Se==="top"?"scrollTop":"scrollLeft",De=oe.nodeName;if(De==="BODY"||De==="HTML"){var Je=oe.ownerDocument.documentElement,Ke=oe.ownerDocument.scrollingElement||Je;return Ke[Ae]}return oe[Ae]}function Le(oe,Se){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,De=je(Se,"top"),Je=je(Se,"left"),Ke=Ae?-1:1;return oe.top+=De*Ke,oe.bottom+=De*Ke,oe.left+=Je*Ke,oe.right+=Je*Ke,oe}function tt(oe,Se){var Ae=Se==="x"?"Left":"Top",De=Ae==="Left"?"Right":"Bottom";return parseFloat(oe["border"+Ae+"Width"])+parseFloat(oe["border"+De+"Width"])}function Ze(oe,Se,Ae,De){return Math.max(Se["offset"+oe],Se["scroll"+oe],Ae["client"+oe],Ae["offset"+oe],Ae["scroll"+oe],ue(10)?parseInt(Ae["offset"+oe])+parseInt(De["margin"+(oe==="Height"?"Top":"Left")])+parseInt(De["margin"+(oe==="Height"?"Bottom":"Right")]):0)}function ti(oe){var Se=oe.body,Ae=oe.documentElement,De=ue(10)&&getComputedStyle(Ae);return{height:Ze("Height",Se,Ae,De),width:Ze("Width",Se,Ae,De)}}var ii=function(oe,Se){if(!(oe instanceof Se))throw new TypeError("Cannot call a class as a function")},$t=function(){function oe(Se,Ae){for(var De=0;De<Ae.length;De++){var Je=Ae[De];Je.enumerable=Je.enumerable||!1,Je.configurable=!0,"value"in Je&&(Je.writable=!0),Object.defineProperty(Se,Je.key,Je)}}return function(Se,Ae,De){return Ae&&oe(Se.prototype,Ae),De&&oe(Se,De),Se}}(),Mt=function(oe,Se,Ae){return Se in oe?Object.defineProperty(oe,Se,{value:Ae,enumerable:!0,configurable:!0,writable:!0}):oe[Se]=Ae,oe},Ft=Object.assign||function(oe){for(var Se=1;Se<arguments.length;Se++){var Ae=arguments[Se];for(var De in Ae)Object.prototype.hasOwnProperty.call(Ae,De)&&(oe[De]=Ae[De])}return oe};function si(oe){return Ft({},oe,{right:oe.left+oe.width,bottom:oe.top+oe.height})}function Ut(oe){var Se={};try{if(ue(10)){Se=oe.getBoundingClientRect();var Ae=je(oe,"top"),De=je(oe,"left");Se.top+=Ae,Se.left+=De,Se.bottom+=Ae,Se.right+=De}else Se=oe.getBoundingClientRect()}catch{}var Je={left:Se.left,top:Se.top,width:Se.right-Se.left,height:Se.bottom-Se.top},Ke=oe.nodeName==="HTML"?ti(oe.ownerDocument):{},it=Ke.width||oe.clientWidth||Je.width,ht=Ke.height||oe.clientHeight||Je.height,Ct=oe.offsetWidth-it,ni=oe.offsetHeight-ht;if(Ct||ni){var li=G(oe);Ct-=tt(li,"x"),ni-=tt(li,"y"),Je.width-=Ct,Je.height-=ni}return si(Je)}function Ot(oe,Se){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,De=ue(10),Je=Se.nodeName==="HTML",Ke=Ut(oe),it=Ut(Se),ht=fe(oe),Ct=G(Se),ni=parseFloat(Ct.borderTopWidth),li=parseFloat(Ct.borderLeftWidth);Ae&&Je&&(it.top=Math.max(it.top,0),it.left=Math.max(it.left,0));var Zt=si({top:Ke.top-it.top-ni,left:Ke.left-it.left-li,width:Ke.width,height:Ke.height});if(Zt.marginTop=0,Zt.marginLeft=0,!De&&Je){var ci=parseFloat(Ct.marginTop),Yi=parseFloat(Ct.marginLeft);Zt.top-=ni-ci,Zt.bottom-=ni-ci,Zt.left-=li-Yi,Zt.right-=li-Yi,Zt.marginTop=ci,Zt.marginLeft=Yi}return(De&&!Ae?Se.contains(ht):Se===ht&&ht.nodeName!=="BODY")&&(Zt=Le(Zt,Se)),Zt}function pt(oe){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Ae=oe.ownerDocument.documentElement,De=Ot(oe,Ae),Je=Math.max(Ae.clientWidth,window.innerWidth||0),Ke=Math.max(Ae.clientHeight,window.innerHeight||0),it=Se?0:je(Ae),ht=Se?0:je(Ae,"left"),Ct={top:it-De.top+De.marginTop,left:ht-De.left+De.marginLeft,width:Je,height:Ke};return si(Ct)}function Xt(oe){var Se=oe.nodeName;if(Se==="BODY"||Se==="HTML")return!1;if(G(oe,"position")==="fixed")return!0;var Ae=K(oe);return Ae?Xt(Ae):!1}function Tt(oe){if(!oe||!oe.parentElement||ue())return document.documentElement;for(var Se=oe.parentElement;Se&&G(Se,"transform")==="none";)Se=Se.parentElement;return Se||document.documentElement}function mi(oe,Se,Ae,De){var Je=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,Ke={top:0,left:0},it=Je?Tt(oe):Et(oe,Ee(Se));if(De==="viewport")Ke=pt(it,Je);else{var ht=void 0;De==="scrollParent"?(ht=fe(K(Se)),ht.nodeName==="BODY"&&(ht=oe.ownerDocument.documentElement)):De==="window"?ht=oe.ownerDocument.documentElement:ht=De;var Ct=Ot(ht,it,Je);if(ht.nodeName==="HTML"&&!Xt(it)){var ni=ti(oe.ownerDocument),li=ni.height,Zt=ni.width;Ke.top+=Ct.top-Ct.marginTop,Ke.bottom=li+Ct.top,Ke.left+=Ct.left-Ct.marginLeft,Ke.right=Zt+Ct.left}else Ke=Ct}Ae=Ae||0;var ci=typeof Ae=="number";return Ke.left+=ci?Ae:Ae.left||0,Ke.top+=ci?Ae:Ae.top||0,Ke.right-=ci?Ae:Ae.right||0,Ke.bottom-=ci?Ae:Ae.bottom||0,Ke}function xi(oe){var Se=oe.width,Ae=oe.height;return Se*Ae}function hn(oe,Se,Ae,De,Je){var Ke=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(oe.indexOf("auto")===-1)return oe;var it=mi(Ae,De,Ke,Je),ht={top:{width:it.width,height:Se.top-it.top},right:{width:it.right-Se.right,height:it.height},bottom:{width:it.width,height:it.bottom-Se.bottom},left:{width:Se.left-it.left,height:it.height}},Ct=Object.keys(ht).map(function(ci){return Ft({key:ci},ht[ci],{area:xi(ht[ci])})}).sort(function(ci,Yi){return Yi.area-ci.area}),ni=Ct.filter(function(ci){var Yi=ci.width,qi=ci.height;return Yi>=Ae.clientWidth&&qi>=Ae.clientHeight}),li=ni.length>0?ni[0].key:Ct[0].key,Zt=oe.split("-")[1];return li+(Zt?"-"+Zt:"")}function Cn(oe,Se,Ae){var De=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,Je=De?Tt(Se):Et(Se,Ee(Ae));return Ot(Ae,Je,De)}function Hn(oe){var Se=oe.ownerDocument.defaultView,Ae=Se.getComputedStyle(oe),De=parseFloat(Ae.marginTop||0)+parseFloat(Ae.marginBottom||0),Je=parseFloat(Ae.marginLeft||0)+parseFloat(Ae.marginRight||0),Ke={width:oe.offsetWidth+Je,height:oe.offsetHeight+De};return Ke}function er(oe){var Se={left:"right",right:"left",bottom:"top",top:"bottom"};return oe.replace(/left|right|bottom|top/g,function(Ae){return Se[Ae]})}function as(oe,Se,Ae){Ae=Ae.split("-")[0];var De=Hn(oe),Je={width:De.width,height:De.height},Ke=["right","left"].indexOf(Ae)!==-1,it=Ke?"top":"left",ht=Ke?"left":"top",Ct=Ke?"height":"width",ni=Ke?"width":"height";return Je[it]=Se[it]+Se[Ct]/2-De[Ct]/2,Ae===ht?Je[ht]=Se[ht]-De[ni]:Je[ht]=Se[er(ht)],Je}function oo(oe,Se){return Array.prototype.find?oe.find(Se):oe.filter(Se)[0]}function Qa(oe,Se,Ae){if(Array.prototype.findIndex)return oe.findIndex(function(Je){return Je[Se]===Ae});var De=oo(oe,function(Je){return Je[Se]===Ae});return oe.indexOf(De)}function ja(oe,Se,Ae){var De=Ae===void 0?oe:oe.slice(0,Qa(oe,"name",Ae));return De.forEach(function(Je){Je.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var Ke=Je.function||Je.fn;Je.enabled&&Y(Ke)&&(Se.offsets.popper=si(Se.offsets.popper),Se.offsets.reference=si(Se.offsets.reference),Se=Ke(Se,Je))}),Se}function Rt(){if(!this.state.isDestroyed){var oe={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};oe.offsets.reference=Cn(this.state,this.popper,this.reference,this.options.positionFixed),oe.placement=hn(this.options.placement,oe.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),oe.originalPlacement=oe.placement,oe.positionFixed=this.options.positionFixed,oe.offsets.popper=as(this.popper,oe.offsets.reference,oe.placement),oe.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",oe=ja(this.modifiers,oe),this.state.isCreated?this.options.onUpdate(oe):(this.state.isCreated=!0,this.options.onCreate(oe))}}function fi(oe,Se){return oe.some(function(Ae){var De=Ae.name,Je=Ae.enabled;return Je&&De===Se})}function ji(oe){for(var Se=[!1,"ms","Webkit","Moz","O"],Ae=oe.charAt(0).toUpperCase()+oe.slice(1),De=0;De<Se.length;De++){var Je=Se[De],Ke=Je?""+Je+Ae:oe;if(typeof document.body.style[Ke]<"u")return Ke}return null}function Yr(){return this.state.isDestroyed=!0,fi(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[ji("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function zs(oe){var Se=oe.ownerDocument;return Se?Se.defaultView:window}function Rc(oe,Se,Ae,De){var Je=oe.nodeName==="BODY",Ke=Je?oe.ownerDocument.defaultView:oe;Ke.addEventListener(Se,Ae,{passive:!0}),Je||Rc(fe(Ke.parentNode),Se,Ae,De),De.push(Ke)}function Kh(oe,Se,Ae,De){Ae.updateBound=De,zs(oe).addEventListener("resize",Ae.updateBound,{passive:!0});var Je=fe(oe);return Rc(Je,"scroll",Ae.updateBound,Ae.scrollParents),Ae.scrollElement=Je,Ae.eventsEnabled=!0,Ae}function Xs(){this.state.eventsEnabled||(this.state=Kh(this.reference,this.options,this.state,this.scheduleUpdate))}function vn(oe,Se){return zs(oe).removeEventListener("resize",Se.updateBound),Se.scrollParents.forEach(function(Ae){Ae.removeEventListener("scroll",Se.updateBound)}),Se.updateBound=null,Se.scrollParents=[],Se.scrollElement=null,Se.eventsEnabled=!1,Se}function ao(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=vn(this.reference,this.state))}function Ya(oe){return oe!==""&&!isNaN(parseFloat(oe))&&isFinite(oe)}function Uo(oe,Se){Object.keys(Se).forEach(function(Ae){var De="";["width","height","top","right","bottom","left"].indexOf(Ae)!==-1&&Ya(Se[Ae])&&(De="px"),oe.style[Ae]=Se[Ae]+De})}function qa(oe,Se){Object.keys(Se).forEach(function(Ae){var De=Se[Ae];De!==!1?oe.setAttribute(Ae,Se[Ae]):oe.removeAttribute(Ae)})}function qp(oe){return Uo(oe.instance.popper,oe.styles),qa(oe.instance.popper,oe.attributes),oe.arrowElement&&Object.keys(oe.arrowStyles).length&&Uo(oe.arrowElement,oe.arrowStyles),oe}function tw(oe,Se,Ae,De,Je){var Ke=Cn(Je,Se,oe,Ae.positionFixed),it=hn(Ae.placement,Ke,Se,oe,Ae.modifiers.flip.boundariesElement,Ae.modifiers.flip.padding);return Se.setAttribute("x-placement",it),Uo(Se,{position:Ae.positionFixed?"fixed":"absolute"}),Ae}function Zp(oe,Se){var Ae=oe.offsets,De=Ae.popper,Je=Ae.reference,Ke=Math.round,it=Math.floor,ht=function(Il){return Il},Ct=Ke(Je.width),ni=Ke(De.width),li=["left","right"].indexOf(oe.placement)!==-1,Zt=oe.placement.indexOf("-")!==-1,ci=Ct%2===ni%2,Yi=Ct%2===1&&ni%2===1,qi=Se?li||Zt||ci?Ke:it:ht,Nr=Se?Ke:ht;return{left:qi(Yi&&!Zt&&Se?De.left-1:De.left),top:Nr(De.top),bottom:Nr(De.bottom),right:qi(De.right)}}var iw=g&&/Firefox/i.test(navigator.userAgent);function nw(oe,Se){var Ae=Se.x,De=Se.y,Je=oe.offsets.popper,Ke=oo(oe.instance.modifiers,function(Ud){return Ud.name==="applyStyle"}).gpuAcceleration;Ke!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var it=Ke!==void 0?Ke:Se.gpuAcceleration,ht=Ne(oe.instance.popper),Ct=Ut(ht),ni={position:Je.position},li=Zp(oe,window.devicePixelRatio<2||!iw),Zt=Ae==="bottom"?"top":"bottom",ci=De==="right"?"left":"right",Yi=ji("transform"),qi=void 0,Nr=void 0;if(Zt==="bottom"?ht.nodeName==="HTML"?Nr=-ht.clientHeight+li.bottom:Nr=-Ct.height+li.bottom:Nr=li.top,ci==="right"?ht.nodeName==="HTML"?qi=-ht.clientWidth+li.right:qi=-Ct.width+li.right:qi=li.left,it&&Yi)ni[Yi]="translate3d("+qi+"px, "+Nr+"px, 0)",ni[Zt]=0,ni[ci]=0,ni.willChange="transform";else{var Il=Zt==="bottom"?-1:1,Kp=ci==="right"?-1:1;ni[Zt]=Nr*Il,ni[ci]=qi*Kp,ni.willChange=Zt+", "+ci}var pa={"x-placement":oe.placement};return oe.attributes=Ft({},pa,oe.attributes),oe.styles=Ft({},ni,oe.styles),oe.arrowStyles=Ft({},oe.offsets.arrow,oe.arrowStyles),oe}function rv(oe,Se,Ae){var De=oo(oe,function(ht){var Ct=ht.name;return Ct===Se}),Je=!!De&&oe.some(function(ht){return ht.name===Ae&&ht.enabled&&ht.order<De.order});if(!Je){var Ke="`"+Se+"`",it="`"+Ae+"`";console.warn(it+" modifier is required by "+Ke+" modifier in order to work, be sure to include it before "+Ke+"!")}return Je}function xr(oe,Se){var Ae;if(!rv(oe.instance.modifiers,"arrow","keepTogether"))return oe;var De=Se.element;if(typeof De=="string"){if(De=oe.instance.popper.querySelector(De),!De)return oe}else if(!oe.instance.popper.contains(De))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),oe;var Je=oe.placement.split("-")[0],Ke=oe.offsets,it=Ke.popper,ht=Ke.reference,Ct=["left","right"].indexOf(Je)!==-1,ni=Ct?"height":"width",li=Ct?"Top":"Left",Zt=li.toLowerCase(),ci=Ct?"left":"top",Yi=Ct?"bottom":"right",qi=Hn(De)[ni];ht[Yi]-qi<it[Zt]&&(oe.offsets.popper[Zt]-=it[Zt]-(ht[Yi]-qi)),ht[Zt]+qi>it[Yi]&&(oe.offsets.popper[Zt]+=ht[Zt]+qi-it[Yi]),oe.offsets.popper=si(oe.offsets.popper);var Nr=ht[Zt]+ht[ni]/2-qi/2,Il=G(oe.instance.popper),Kp=parseFloat(Il["margin"+li]),pa=parseFloat(Il["border"+li+"Width"]),Ud=Nr-oe.offsets.popper[Zt]-Kp-pa;return Ud=Math.max(Math.min(it[ni]-qi,Ud),0),oe.arrowElement=De,oe.offsets.arrow=(Ae={},Mt(Ae,Zt,Math.round(Ud)),Mt(Ae,ci,""),Ae),oe}function Za(oe){return oe==="end"?"start":oe==="start"?"end":oe}var Ic=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Ka=Ic.slice(3);function rw(oe){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Ae=Ka.indexOf(oe),De=Ka.slice(Ae+1).concat(Ka.slice(0,Ae));return Se?De.reverse():De}var Jh={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function TE(oe,Se){if(fi(oe.instance.modifiers,"inner")||oe.flipped&&oe.placement===oe.originalPlacement)return oe;var Ae=mi(oe.instance.popper,oe.instance.reference,Se.padding,Se.boundariesElement,oe.positionFixed),De=oe.placement.split("-")[0],Je=er(De),Ke=oe.placement.split("-")[1]||"",it=[];switch(Se.behavior){case Jh.FLIP:it=[De,Je];break;case Jh.CLOCKWISE:it=rw(De);break;case Jh.COUNTERCLOCKWISE:it=rw(De,!0);break;default:it=Se.behavior}return it.forEach(function(ht,Ct){if(De!==ht||it.length===Ct+1)return oe;De=oe.placement.split("-")[0],Je=er(De);var ni=oe.offsets.popper,li=oe.offsets.reference,Zt=Math.floor,ci=De==="left"&&Zt(ni.right)>Zt(li.left)||De==="right"&&Zt(ni.left)<Zt(li.right)||De==="top"&&Zt(ni.bottom)>Zt(li.top)||De==="bottom"&&Zt(ni.top)<Zt(li.bottom),Yi=Zt(ni.left)<Zt(Ae.left),qi=Zt(ni.right)>Zt(Ae.right),Nr=Zt(ni.top)<Zt(Ae.top),Il=Zt(ni.bottom)>Zt(Ae.bottom),Kp=De==="left"&&Yi||De==="right"&&qi||De==="top"&&Nr||De==="bottom"&&Il,pa=["top","bottom"].indexOf(De)!==-1,Ud=!!Se.flipVariations&&(pa&&Ke==="start"&&Yi||pa&&Ke==="end"&&qi||!pa&&Ke==="start"&&Nr||!pa&&Ke==="end"&&Il),Hfe=!!Se.flipVariationsByContent&&(pa&&Ke==="start"&&qi||pa&&Ke==="end"&&Yi||!pa&&Ke==="start"&&Il||!pa&&Ke==="end"&&Nr),WB=Ud||Hfe;(ci||Kp||WB)&&(oe.flipped=!0,(ci||Kp)&&(De=it[Ct+1]),WB&&(Ke=Za(Ke)),oe.placement=De+(Ke?"-"+Ke:""),oe.offsets.popper=Ft({},oe.offsets.popper,as(oe.instance.popper,oe.offsets.reference,oe.placement)),oe=ja(oe.instance.modifiers,oe,"flip"))}),oe}function sv(oe){var Se=oe.offsets,Ae=Se.popper,De=Se.reference,Je=oe.placement.split("-")[0],Ke=Math.floor,it=["top","bottom"].indexOf(Je)!==-1,ht=it?"right":"bottom",Ct=it?"left":"top",ni=it?"width":"height";return Ae[ht]<Ke(De[Ct])&&(oe.offsets.popper[Ct]=Ke(De[Ct])-Ae[ni]),Ae[Ct]>Ke(De[ht])&&(oe.offsets.popper[Ct]=Ke(De[ht])),oe}function EE(oe,Se,Ae,De){var Je=oe.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),Ke=+Je[1],it=Je[2];if(!Ke)return oe;if(it.indexOf("%")===0){var ht=void 0;switch(it){case"%p":ht=Ae;break;case"%":case"%r":default:ht=De}var Ct=si(ht);return Ct[Se]/100*Ke}else if(it==="vh"||it==="vw"){var ni=void 0;return it==="vh"?ni=Math.max(document.documentElement.clientHeight,window.innerHeight||0):ni=Math.max(document.documentElement.clientWidth,window.innerWidth||0),ni/100*Ke}else return Ke}function $fe(oe,Se,Ae,De){var Je=[0,0],Ke=["right","left"].indexOf(De)!==-1,it=oe.split(/(\+|\-)/).map(function(li){return li.trim()}),ht=it.indexOf(oo(it,function(li){return li.search(/,|\s/)!==-1}));it[ht]&&it[ht].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var Ct=/\s*,\s*|\s+/,ni=ht!==-1?[it.slice(0,ht).concat([it[ht].split(Ct)[0]]),[it[ht].split(Ct)[1]].concat(it.slice(ht+1))]:[it];return ni=ni.map(function(li,Zt){var ci=(Zt===1?!Ke:Ke)?"height":"width",Yi=!1;return li.reduce(function(qi,Nr){return qi[qi.length-1]===""&&["+","-"].indexOf(Nr)!==-1?(qi[qi.length-1]=Nr,Yi=!0,qi):Yi?(qi[qi.length-1]+=Nr,Yi=!1,qi):qi.concat(Nr)},[]).map(function(qi){return EE(qi,ci,Se,Ae)})}),ni.forEach(function(li,Zt){li.forEach(function(ci,Yi){Ya(ci)&&(Je[Zt]+=ci*(li[Yi-1]==="-"?-1:1))})}),Je}function Ufe(oe,Se){var Ae=Se.offset,De=oe.placement,Je=oe.offsets,Ke=Je.popper,it=Je.reference,ht=De.split("-")[0],Ct=void 0;return Ya(+Ae)?Ct=[+Ae,0]:Ct=$fe(Ae,Ke,it,ht),ht==="left"?(Ke.top+=Ct[0],Ke.left-=Ct[1]):ht==="right"?(Ke.top+=Ct[0],Ke.left+=Ct[1]):ht==="top"?(Ke.left+=Ct[0],Ke.top-=Ct[1]):ht==="bottom"&&(Ke.left+=Ct[0],Ke.top+=Ct[1]),oe.popper=Ke,oe}function Vfe(oe,Se){var Ae=Se.boundariesElement||Ne(oe.instance.popper);oe.instance.reference===Ae&&(Ae=Ne(Ae));var De=ji("transform"),Je=oe.instance.popper.style,Ke=Je.top,it=Je.left,ht=Je[De];Je.top="",Je.left="",Je[De]="";var Ct=mi(oe.instance.popper,oe.instance.reference,Se.padding,Ae,oe.positionFixed);Je.top=Ke,Je.left=it,Je[De]=ht,Se.boundaries=Ct;var ni=Se.priority,li=oe.offsets.popper,Zt={primary:function(ci){var Yi=li[ci];return li[ci]<Ct[ci]&&!Se.escapeWithReference&&(Yi=Math.max(li[ci],Ct[ci])),Mt({},ci,Yi)},secondary:function(ci){var Yi=ci==="right"?"left":"top",qi=li[Yi];return li[ci]>Ct[ci]&&!Se.escapeWithReference&&(qi=Math.min(li[Yi],Ct[ci]-(ci==="right"?li.width:li.height))),Mt({},Yi,qi)}};return ni.forEach(function(ci){var Yi=["left","top"].indexOf(ci)!==-1?"primary":"secondary";li=Ft({},li,Zt[Yi](ci))}),oe.offsets.popper=li,oe}function Ffe(oe){var Se=oe.placement,Ae=Se.split("-")[0],De=Se.split("-")[1];if(De){var Je=oe.offsets,Ke=Je.reference,it=Je.popper,ht=["bottom","top"].indexOf(Ae)!==-1,Ct=ht?"left":"top",ni=ht?"width":"height",li={start:Mt({},Ct,Ke[Ct]),end:Mt({},Ct,Ke[Ct]+Ke[ni]-it[ni])};oe.offsets.popper=Ft({},it,li[De])}return oe}function zfe(oe){if(!rv(oe.instance.modifiers,"hide","preventOverflow"))return oe;var Se=oe.offsets.reference,Ae=oo(oe.instance.modifiers,function(De){return De.name==="preventOverflow"}).boundaries;if(Se.bottom<Ae.top||Se.left>Ae.right||Se.top>Ae.bottom||Se.right<Ae.left){if(oe.hide===!0)return oe;oe.hide=!0,oe.attributes["x-out-of-boundaries"]=""}else{if(oe.hide===!1)return oe;oe.hide=!1,oe.attributes["x-out-of-boundaries"]=!1}return oe}function Xfe(oe){var Se=oe.placement,Ae=Se.split("-")[0],De=oe.offsets,Je=De.popper,Ke=De.reference,it=["left","right"].indexOf(Ae)!==-1,ht=["top","left"].indexOf(Ae)===-1;return Je[it?"left":"top"]=Ke[Ae]-(ht?Je[it?"width":"height"]:0),oe.placement=er(Se),oe.offsets.popper=si(Je),oe}var Wfe={shift:{order:100,enabled:!0,fn:Ffe},offset:{order:200,enabled:!0,fn:Ufe,offset:0},preventOverflow:{order:300,enabled:!0,fn:Vfe,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:sv},arrow:{order:500,enabled:!0,fn:xr,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:TE,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:Xfe},hide:{order:800,enabled:!0,fn:zfe},computeStyle:{order:850,enabled:!0,fn:nw,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:qp,onLoad:tw,gpuAcceleration:void 0}},Gfe={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:Wfe},sw=function(){function oe(Se,Ae){var De=this,Je=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ii(this,oe),this.scheduleUpdate=function(){return requestAnimationFrame(De.update)},this.update=F(this.update.bind(this)),this.options=Ft({},oe.Defaults,Je),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=Se&&Se.jquery?Se[0]:Se,this.popper=Ae&&Ae.jquery?Ae[0]:Ae,this.options.modifiers={},Object.keys(Ft({},oe.Defaults.modifiers,Je.modifiers)).forEach(function(it){De.options.modifiers[it]=Ft({},oe.Defaults.modifiers[it]||{},Je.modifiers?Je.modifiers[it]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(it){return Ft({name:it},De.options.modifiers[it])}).sort(function(it,ht){return it.order-ht.order}),this.modifiers.forEach(function(it){it.enabled&&Y(it.onLoad)&&it.onLoad(De.reference,De.popper,De.options,it,De.state)}),this.update();var Ke=this.options.eventsEnabled;Ke&&this.enableEventListeners(),this.state.eventsEnabled=Ke}return $t(oe,[{key:"update",value:function(){return Rt.call(this)}},{key:"destroy",value:function(){return Yr.call(this)}},{key:"enableEventListeners",value:function(){return Xs.call(this)}},{key:"disableEventListeners",value:function(){return ao.call(this)}}]),oe}();return sw.Utils=(typeof window<"u"?window:ie).PopperUtils,sw.placements=Ic,sw.Defaults=Gfe,sw})})(me);var ve=me.exports;let Te=0,ke=0;function He(){Te++}function Ue(){ke++}const We={name:"Drop",emits:["mouseenter","mouseleave","click"],props:{placement:{type:String,default:"bottom-start"},className:{type:String},transfer:{type:Boolean},eventsEnabled:{type:Boolean,default:!1},visible:{type:Boolean},classes:{type:Object,default:()=>{}},styles:{type:Object,default:()=>{}},transitionName:{type:String,default:"transition-drop"},boundariesElement:{default:"window"}},data(){return{popper:null,width:"",popperStatus:!1,tIndex:this.handleGetIndex()}},computed:{mergedStyle(){let c={};return this.width&&(c.minWidth=`${this.width}px`),this.transfer&&(c["z-index"]=1060+this.tIndex),Object.assign({},this.styles,c)},mergedClass(){return Object.assign({},this.classes,{[this.className]:this.className})}},methods:{update(){i.nextTick(()=>{this.popper?(this.popper.update(),this.popperStatus=!0):this.popper=new ve(this.$parent.$refs.reference,this.$refs.drop,{eventsEnabled:this.eventsEnabled,placement:this.placement,modifiers:{computeStyle:{gpuAcceleration:!1},preventOverflow:{boundariesElement:this.boundariesElement}},onCreate:()=>{this.resetTransformOrigin(),i.nextTick(this.popper.update())},onUpdate:()=>{this.resetTransformOrigin()}}),this.$parent.$options.name==="iSelect"&&(this.width=parseInt(R(this.$parent.$el,"width"))),this.tIndex=this.handleGetIndex()})},destroy(){this.popper&&setTimeout(()=>{this.popper&&!this.popperStatus&&(this.popper.popper.style.display="none",this.popper.destroy(),this.popper=null),this.popperStatus=!1},300)},resetTransformOrigin(){if(!this.popper)return;let c=this.popper.popper.getAttribute("x-placement"),d=c.split("-")[0],g=c.split("-")[1];c==="left"||c==="right"||(this.popper.popper.style.transformOrigin=d==="bottom"||d!=="top"&&g==="start"?"center top":"center bottom")},handleGetIndex(){return He(),Te},handleMouseenter(c){this.$emit("mouseenter",c)},handleMouseleave(c){this.$emit("mouseleave",c)},handleOnUpdatePopper(){this.update()},handleOnDestroyPopper(){this.destroy()},handleClick(c){this.$emit("click",c)}},beforeUnmount(){this.popper&&(this.popper.destroy(),this.popper=null)}};function ct(c,d,g,M,C,b){return i.openBlock(),i.createBlock(i.Teleport,{to:"body",disabled:!g.transfer},[i.createVNode(i.Transition,{name:g.transitionName},{default:i.withCtx(()=>[i.withDirectives(i.createElementVNode("div",i.mergeProps({class:["ivu-select-dropdown",b.mergedClass],ref:"drop",style:b.mergedStyle},c.$attrs,{onMouseenter:d[0]||(d[0]=(...B)=>b.handleMouseenter&&b.handleMouseenter(...B)),onMouseleave:d[1]||(d[1]=(...B)=>b.handleMouseleave&&b.handleMouseleave(...B)),onClick:d[2]||(d[2]=i.withModifiers((...B)=>b.handleClick&&b.handleClick(...B),["stop"]))}),[i.renderSlot(c.$slots,"default")],16),[[i.vShow,g.visible]])]),_:3},8,["name"])],8,["disabled"])}var Ye=l(We,[["render",ct]]);function lt(c){s&&typeof window.viewuiplus<"u"&&("langs"in viewuiplus||(viewuiplus.langs={}),viewuiplus.langs[c.i.locale]=c)}const Lt={i:{locale:"zh-CN",select:{placeholder:"请选择",noMatch:"无匹配数据",loading:"加载中"},table:{noDataText:"暂无数据",noFilteredDataText:"暂无筛选结果",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},datepicker:{selectDate:"选择日期",selectTime:"选择时间",startTime:"开始时间",endTime:"结束时间",clear:"清空",ok:"确定",datePanelLabel:"[yyyy年] [m月]",month:"月",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",year:"年",weekStartDay:"0",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{m1:"1月",m2:"2月",m3:"3月",m4:"4月",m5:"5月",m6:"6月",m7:"7月",m8:"8月",m9:"9月",m10:"10月",m11:"11月",m12:"12月"}},transfer:{titles:{source:"源列表",target:"目的列表"},filterPlaceholder:"请输入搜索内容",notFoundText:"列表为空"},modal:{okText:"确定",cancelText:"取消"},poptip:{okText:"确定",cancelText:"取消"},page:{prev:"上一页",next:"下一页",total:"共",item:"条",items:"条",prev5:"向前 5 页",next5:"向后 5 页",page:"条/页",goto:"跳至",p:"页"},rate:{star:"星",stars:"星"},time:{before:"前",after:"后",just:"刚刚",seconds:"秒",minutes:"分钟",hours:"小时",days:"天"},tree:{emptyText:"暂无数据"},image:{zoomIn:"放大",zoomOut:"缩小",rotateLeft:"左旋转",rotateRight:"右旋转",fail:"失败",preview:"预览"}}};lt(Lt);var Bt=function(c){return gt(c)&&!ei(c)};function gt(c){return!!c&&typeof c=="object"}function ei(c){var d=Object.prototype.toString.call(c);return d==="[object RegExp]"||d==="[object Date]"||Ve(c)}var wi=typeof Symbol=="function"&&Symbol.for,Me=wi?Symbol.for("react.element"):60103;function Ve(c){return c.$$typeof===Me}function xe(c){return Array.isArray(c)?[]:{}}function Fe(c,d){return d.clone!==!1&&d.isMergeableObject(c)?vt(xe(c),c,d):c}function Ge(c,d,g){return c.concat(d).map(function(M){return Fe(M,g)})}function at(c,d,g){var M={};return g.isMergeableObject(c)&&Object.keys(c).forEach(function(C){M[C]=Fe(c[C],g)}),Object.keys(d).forEach(function(C){!g.isMergeableObject(d[C])||!c[C]?M[C]=Fe(d[C],g):M[C]=vt(c[C],d[C],g)}),M}function vt(c,d,g){g=g||{},g.arrayMerge=g.arrayMerge||Ge,g.isMergeableObject=g.isMergeableObject||Bt;var M=Array.isArray(d),C=Array.isArray(c),b=M===C;return b?M?g.arrayMerge(c,d,g):at(c,d,g):Fe(d,g)}vt.all=function(c,d){if(!Array.isArray(c))throw new Error("first argument should be an array");return c.reduce(function(g,M){return vt(g,M,d)},{})};var Vi=vt;const Fi=/(%|)\{([0-9a-zA-Z_]+)\}/g;function en(){function c(g,M){return Object.prototype.hasOwnProperty.call(g,M)}function d(g,...M){return M.length===1&&typeof M[0]=="object"&&(M=M[0]),(!M||!M.hasOwnProperty)&&(M={}),g===void 0?"":g.replace(Fi,(C,b,B,F)=>{let Y;return g[F-1]==="{"&&g[F+C.length]==="}"?B:(Y=c(M,B)?M[B]:null,Y??"")})}return d}const Wn=en();let Ii=Lt;const Hr={zh:Lt};let Kn=null,_0={},Rr=null,fx=function(){if(Reflect.has(this,"$t"))return this.$t(...arguments);if(Rr&&Rr.global)return Rr.global.t(...arguments);if(Rr&&Rr.locale){if(!_0[Rr.locale]||Kn!=Rr.locale){_0[Rr.locale]=!0;let c=Rr.getLocaleMessage(Rr.locale)||{},d={};Vi(d,Hr[Rr.locale],c),Ii=d,Rr.setLocaleMessage(Rr.locale,d),Kn=Rr.locale}return Rr.hlang(...arguments)}};const Cd=function(c,d){let g=fx.apply(this,arguments);if(g!=null)return g;const M=c.split(".");let C=Ii;for(let b=0,B=M.length;b<B;b++){const F=M[b];if(g=C[F],b===B-1)return Wn(g,d);if(!g)return"";C=g}return""};var Dh={use:function(c){Ii=c||Ii},t:Cd,i18n:function(c){Rr=c}},gn={methods:{t(...c){return Cd.apply(this,c)}}},za={data(){return{globalConfig:{}}},created(){const c=i.getCurrentInstance();this.globalConfig=c.appContext.config.globalProperties.$VIEWUI}};const Lh="ivu-select",dT={name:"iSelectHead",mixins:[gn,za],components:{Icon:S},emits:["on-input-focus","on-input-blur","on-keydown","on-enter","on-clear","on-query-change"],inject:["SelectInstance"],props:{disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},remote:{type:Boolean,default:!1},initialLabel:{type:[String,Number,Array]},values:{type:Array,default:()=>[]},clearable:{type:[Function,Boolean],default:!1},inputElementId:{type:String},placeholder:{type:String},queryProp:{type:String,default:""},prefix:{type:String},maxTagCount:{type:Number},maxTagPlaceholder:{type:Function},allowCreate:{type:Boolean},showCreateItem:{type:Boolean}},data(){return{prefixCls:Lh,query:"",inputLength:20,remoteInitialLabel:this.initialLabel,preventRemoteCall:!1}},computed:{singleDisplayClasses(){const{filterable:c,multiple:d,showPlaceholder:g}=this;return[{[Lh+"-head-with-prefix"]:this.showPrefix,[Lh+"-placeholder"]:g&&!c,[Lh+"-selected-value"]:!g&&!d&&!c}]},singleDisplayValue(){return this.multiple&&this.values.length>0||this.filterable?"":`${this.selectedSingle}`||this.localePlaceholder},showPlaceholder(){let c=!1;if(this.multiple)!this.values.length>0&&(c=!0);else{const d=this.values[0];(typeof d>"u"||String(d).trim()==="")&&(c=!this.remoteInitialLabel)}return c},resetSelect(){return!this.showPlaceholder&&this.clearable},inputStyle(){let c={};return this.multiple&&(this.showPlaceholder?c.width="100%":c.width=`${this.inputLength}px`),c},localePlaceholder(){return this.placeholder===void 0?this.t("i.select.placeholder"):this.placeholder},selectedSingle(){const c=this.values[0];return c?c.label:this.remoteInitialLabel||""},selectedMultiple(){return(this.multiple?this.values:[]).filter((c,d)=>this.maxTagCount===void 0||d<this.maxTagCount)},headCls(){return{[`${Lh}-head-flex`]:this.filterable&&this.showPrefix}},arrowType(){const c=this.globalConfig;let d="ios-arrow-down";return c&&(c.select.customArrow?d="":c.select.arrow&&(d=c.select.arrow)),d},customArrowType(){const c=this.globalConfig;let d="";return c&&c.select.customArrow&&(d=c.select.customArrow),d},showPrefix(){const c=this.$slots.prefix&&this.$slots.prefix();let d=!1;return c&&(d=c[0].children.length>0),d||this.prefix},arrowSize(){const c=this.globalConfig;let d="";return c&&c.select.arrowSize&&(d=c.select.arrowSize),d}},methods:{onInputFocus(){this.$emit("on-input-focus")},onInputBlur(){this.showCreateItem||(this.values.length||(this.query=""),this.$emit("on-input-blur"))},removeTag(c){if(this.disabled)return!1;this.SelectInstance.handleOnSelectSelected(c)},resetInputState(){this.inputLength=this.$refs.input.value.length*12+20,this.$emit("on-keydown")},handleInputDelete(c){const d=c.target.value;this.multiple&&this.selectedMultiple.length&&this.query===""&&d===""&&this.removeTag(this.selectedMultiple[this.selectedMultiple.length-1])},handleInputEnter(c){this.$emit("on-enter"),this.showCreateItem&&c.stopPropagation()},onHeaderClick(c){this.filterable&&c.target===this.$el&&this.$refs.input.focus()},onClear(){this.$emit("on-clear")}},watch:{values([c]){if(this.filterable){if(this.preventRemoteCall=!0,this.multiple){this.query="",this.preventRemoteCall=!1;return}typeof c>"u"||c===""||c===null?this.query="":this.query=c.label,i.nextTick(()=>this.preventRemoteCall=!1)}},query(c){if(this.preventRemoteCall){this.preventRemoteCall=!1;return}this.$emit("on-query-change",c)},queryProp(c){c!==this.query&&(this.query=c)}}},fT={key:1,class:"ivu-tag ivu-tag-checked"},pT={class:"ivu-tag-text ivu-select-max-tag"},de=["id","disabled","placeholder"];function Ie(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("div",{onClick:d[6]||(d[6]=(...F)=>b.onHeaderClick&&b.onHeaderClick(...F)),class:i.normalizeClass(b.headCls)},[b.showPrefix?(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass([C.prefixCls+"-prefix"])},[i.renderSlot(c.$slots,"prefix",{},()=>[g.prefix?(i.openBlock(),i.createBlock(B,{key:0,type:g.prefix},null,8,["type"])):i.createCommentVNode("",!0)])],2)):i.createCommentVNode("",!0),(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.selectedMultiple,(F,Y)=>(i.openBlock(),i.createElementBlock("div",{class:"ivu-tag ivu-tag-checked",key:Y},[i.createElementVNode("span",{class:i.normalizeClass(["ivu-tag-text",{"ivu-select-multiple-tag-hidden":F.disabled}])},i.toDisplayString(F.tag!==void 0?F.tag:F.label),3),F.disabled?i.createCommentVNode("",!0):(i.openBlock(),i.createBlock(B,{key:0,type:"ios-close",onClick:i.withModifiers(G=>b.removeTag(F),["stop"])},null,8,["onClick"]))]))),128)),g.maxTagCount!==void 0&&g.values.length>g.maxTagCount?(i.openBlock(),i.createElementBlock("div",fT,[i.createElementVNode("span",pT,[g.maxTagPlaceholder?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createTextVNode(i.toDisplayString(g.maxTagPlaceholder(g.values.length-g.maxTagCount)),1)],64)):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createTextVNode("+ "+i.toDisplayString(g.values.length-g.maxTagCount)+"...",1)],64))])])):i.createCommentVNode("",!0),i.withDirectives(i.createElementVNode("span",{class:i.normalizeClass(b.singleDisplayClasses)},i.toDisplayString(b.singleDisplayValue),3),[[i.vShow,b.singleDisplayValue]]),g.filterable?i.withDirectives((i.openBlock(),i.createElementBlock("input",{key:2,id:g.inputElementId,type:"text","onUpdate:modelValue":d[0]||(d[0]=F=>C.query=F),disabled:g.disabled,class:i.normalizeClass([C.prefixCls+"-input"]),placeholder:b.showPlaceholder?b.localePlaceholder:"",style:i.normalizeStyle(b.inputStyle),autocomplete:"off",spellcheck:"false",onKeydown:[d[1]||(d[1]=(...F)=>b.resetInputState&&b.resetInputState(...F)),d[2]||(d[2]=i.withKeys((...F)=>b.handleInputDelete&&b.handleInputDelete(...F),["delete"])),d[3]||(d[3]=i.withKeys((...F)=>b.handleInputEnter&&b.handleInputEnter(...F),["enter"]))],onFocus:d[4]||(d[4]=(...F)=>b.onInputFocus&&b.onInputFocus(...F)),onBlur:d[5]||(d[5]=(...F)=>b.onInputBlur&&b.onInputBlur(...F)),ref:"input"},null,46,de)),[[i.vModelText,C.query]]):i.createCommentVNode("",!0),b.resetSelect?(i.openBlock(),i.createBlock(B,{key:3,type:"ios-close-circle",class:i.normalizeClass([C.prefixCls+"-arrow"]),onClick:i.withModifiers(b.onClear,["stop"])},null,8,["class","onClick"])):i.createCommentVNode("",!0),!b.resetSelect&&!g.remote?(i.openBlock(),i.createBlock(B,{key:4,type:b.arrowType,custom:b.customArrowType,size:b.arrowSize,class:i.normalizeClass([C.prefixCls+"-arrow"])},null,8,["type","custom","size","class"])):i.createCommentVNode("",!0)],2)}var ze=l(dT,[["render",Ie]]);const $e="click",Be=Object.create(null),yt=Object.create(null),Ht=[Be,yt],qt=function(c,d,g){const{target:M}=g,C=function(B){const{el:F}=B;if(F!==M&&!F.contains(M)){const{binding:Y}=B;Y.modifiers.stop&&g.stopPropagation(),Y.modifiers.prevent&&g.preventDefault(),Y.value.call(c,g)}},b=function(B){return d[B].forEach(C)};Object.keys(d).forEach(b)},ai=function(c){qt(this,Be,c)},bi=function(c){qt(this,yt,c)},Si=function(c){return c?ai:bi},Ti=Object.defineProperties({},{$_captureInstances:{value:Be},$_nonCaptureInstances:{value:yt},$_onCaptureEvent:{value:ai},$_onNonCaptureEvent:{value:bi},beforeMount:{value:function(c,d){if(typeof d.value!="function")throw new TypeError("Binding value must be a function.");let g;const M=d.modifiers;M.click?g="click":M.mousedown?g="mousedown":M.touchstart?g="touchstart":g=$e;const C=d.arg,b={...d,modifiers:{capture:!1,prevent:!1,stop:!1,...d.modifiers}},B=C?Be:yt;Array.isArray(B[g])||(B[g]=[]),B[g].push({el:c,binding:b})===1&&typeof document=="object"&&document&&document.addEventListener(g,Si(C),C)}},unmounted:{value:function(c){const d=function(M){return M.el!==c},g=function(M){const C=Object.keys(M);if(C.length){const b=M===Be,B=function(F){const Y=M[F].filter(d);Y.length?M[F]=Y:(typeof document=="object"&&document&&document.removeEventListener(F,Si(b),b),delete M[F])};C.forEach(B)}};Ht.forEach(g)}},version:{enumerable:!0,value:"3.7.1"}});var Ei={inject:{FormInstance:{default:""},FormItemInstance:{default:null}},computed:{itemDisabled(){let c=this.disabled;return!c&&this.FormInstance&&(c=this.FormInstance.disabled),c?!0:null}},methods:{handleFormItemChange(c,d){this.FormItemInstance&&(c==="blur"?this.FormItemInstance.formBlur(d):c==="change"&&this.FormItemInstance.formChange(d))}}};const _n="ivu-select",Bs=(c,d,g)=>{const M=JSON.stringify(c),C=JSON.stringify(d),b=JSON.stringify(g.map(B=>B.value));return M!==C||M!==b||b!==C},ha=300,on={name:"iSelect",mixins:[gn,Ei],components:{Drop:Ye,SelectHead:ze,Icon:S},directives:{clickOutside:Ti},emits:["on-set-default-options","on-clear","on-clickoutside","on-select","on-create","on-change","on-query-change","on-open-change","update:modelValue"],provide(){return{SelectInstance:this}},props:{modelValue:{type:[String,Number,Array],default:""},label:{type:[String,Number,Array],default:""},defaultLabel:{type:[String,Number,Array],default:""},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placeholder:{type:String},filterable:{type:Boolean,default:!1},filterMethod:{type:Function},remoteMethod:{type:Function},loading:{type:Boolean,default:!1},loadingText:{type:String},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},labelInValue:{type:Boolean,default:!1},notFoundText:{type:String},placement:{validator(c){return O(c,["top","bottom","top-start","bottom-start","top-end","bottom-end"])},default:"bottom-start"},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},autoComplete:{type:Boolean,default:!1},name:{type:String},elementId:{type:String},transferClassName:{type:String},prefix:{type:String},maxTagCount:{type:Number},maxTagPlaceholder:{type:Function},allowCreate:{type:Boolean,default:!1},capture:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},filterByLabel:{type:Boolean,default:!1},eventsEnabled:{type:Boolean,default:!1},hideNotFound:{type:Boolean,default:!1}},mounted(){if(!this.remote&&this.slotOptions.length>0&&(this.values=this.getInitialValue().map(c=>typeof c!="number"&&!c?null:this.getOptionData(c)).filter(Boolean)),this.checkUpdateStatus(),this.remote&&this.modelValue&&this.defaultLabel){if(!this.multiple)this.query=this.defaultLabel,this.modelValue&&this.defaultLabel&&this.values.push({label:this.defaultLabel,value:this.modelValue});else if(this.multiple&&this.defaultLabel instanceof Array&&this.modelValue.length===this.defaultLabel.length){const c=this.modelValue.map((d,g)=>({value:d,label:this.defaultLabel[g]}));setTimeout(()=>{this.values=c})}}},data(){return{prefixCls:_n,values:[],dropDownWidth:0,visible:!1,focusIndex:-1,isFocused:!1,query:"",initialLabel:this.label,hasMouseHoverHead:!1,slotOptions:[],caretPosition:-1,lastRemoteQuery:"",unchangedQuery:!0,hasExpectedValue:!1,isTyping:!1,preventRemoteCall:!1,filterQueryChange:!1,slotOptionsMap:new Map,isLocking:!1}},computed:{classes(){return[`${_n}`,{[`${_n}-visible`]:this.visible,[`${_n}-disabled`]:this.itemDisabled,[`${_n}-multiple`]:this.multiple,[`${_n}-single`]:!this.multiple,[`${_n}-${this.size}`]:!!this.size}]},dropdownCls(){return{[_n+"-dropdown-transfer"]:this.transfer,[_n+"-multiple"]:this.multiple&&this.transfer,"ivu-auto-complete":this.autoComplete,[this.transferClassName]:this.transferClassName}},selectionCls(){return{[`${_n}-selection`]:!this.autoComplete,[`${_n}-selection-focused`]:this.isFocused}},localeNotFoundText(){return typeof this.notFoundText>"u"?this.t("i.select.noMatch"):this.notFoundText},localeLoadingText(){return typeof this.loadingText>"u"?this.t("i.select.loading"):this.loadingText},showCreateItem(){let c=!1;const{allowCreate:d,query:g,slotOptions:M}=this;return d&&g!==""&&(c=!0,(M||[]).find(C=>C.proxy&&C.proxy.showLabel===g)&&(c=!1)),c},transitionName(){return this.placement==="bottom"?"slide-up":"slide-down"},dropVisible(){let c=!0;const d=this.slotOptions.length===0;return!this.loading&&this.remote&&this.query===""&&d&&(c=!1),this.autoComplete&&d&&(c=!1),this.visible&&c},showNotFoundLabel(){const{loading:c,remote:d,slotOptions:g,hideNotFound:M}=this,C=g||[],b=C.find(B=>B.proxy.isShow);return(C.length===0||!b)&&(!d||d&&!c)&&!M},publicValue(){return this.multiple?this.values.map(c=>c.value):(this.values[0]||{}).value},canBeCleared(){const c=this.hasMouseHoverHead,d=!this.multiple&&!this.itemDisabled&&this.clearable;return c&&d&&this.reset},selectTabindex(){return this.itemDisabled||this.filterable?-1:0},remote(){return typeof this.remoteMethod=="function"}},methods:{setQuery(c){if(c){this.onQueryChange(c);return}c===null&&(this.onQueryChange(""),this.values=[],this.lastRemoteQuery="")},clearSingleSelect(){this.multiple||this.$emit("update:modelValue",""),this.$emit("on-clear"),this.hideMenu(),this.clearable&&this.reset()},getOptionData(c){const d=this.slotOptions.find(({props:C})=>C.value===c);if(!d)return null;const{optionLabel:g,disabled:M}=d.proxy||{};return{value:c,label:g,disabled:M}},getInitialValue(){const{multiple:c,remote:d,modelValue:g}=this;let M=Array.isArray(g)?g:[g];if(!c&&(typeof M[0]>"u"||String(M[0]).trim()===""&&!Number.isFinite(M[0]))&&(M=[]),d&&!c&&g){const C=this.getOptionData(g);this.query=C?C.label:String(g)}return M.filter(C=>!!C||C===0)},validateOption({children:c,elm:d,propsData:g}){const M=g.value,C=g.label||"",b=d&&d.textContent||(c||[]).reduce((Y,G)=>{const K=G.elm?G.elm.textContent:G.text;return`${Y} ${K}`},"")||"",B=this.filterByLabel?[C].toString():[M,C,b].toString(),F=this.query.toLowerCase().trim();return B.toLowerCase().includes(F)},toggleMenu(c,d){if(this.itemDisabled)return!1;this.visible=typeof d<"u"?d:!this.visible,this.visible&&(this.dropDownWidth=this.$el.getBoundingClientRect().width,this.$refs.dropdown.handleOnUpdatePopper())},hideMenu(){this.toggleMenu(null,!1),this.isTyping=!1,setTimeout(()=>this.unchangedQuery=!0,ha)},onClickOutside(c){if(this.visible){if(c.type==="mousedown"){c.preventDefault();return}if(this.transfer){const d=this.$refs.dropdown.$refs.drop;if(d===c.target||d.contains(c.target))return}if(this.filterable){const d=this.$el.querySelector('input[type="text"]');this.caretPosition=d.selectionStart,i.nextTick(()=>{const g=this.caretPosition===-1?d.value.length:this.caretPosition;d.setSelectionRange(g,g)})}this.autoComplete||c.stopPropagation(),c.preventDefault(),this.hideMenu(),this.isFocused=!0,this.$emit("on-clickoutside",c)}else this.caretPosition=-1,this.isFocused=!1},reset(){this.query="",this.focusIndex=-1,this.unchangedQuery=!0,this.values=[],this.filterQueryChange=!1},handleKeydown(c){const d=c.key||c.code,g=c.keyCode||c.which;if(!(d==="Backspace"||g===8))if(this.visible){if(c.preventDefault(),d==="Tab"&&c.stopPropagation(),d==="Escape"&&(c.stopPropagation(),this.hideMenu()),d==="ArrowUp"&&this.navigateOptions(-1),d==="ArrowDown"&&this.navigateOptions(1),d==="Enter"){if(this.focusIndex===-1)return this.hideMenu();const M=this.slotOptions[this.focusIndex];if(M){const C=this.getOptionData(M.props.value);this.onOptionClick(C)}else this.hideMenu()}}else["ArrowUp","ArrowDown"].includes(c.key)&&this.toggleMenu(null,!0)},navigateOptions(c){const d=this.slotOptions,g=d.length-1;if(g<0)return;let M=this.focusIndex+c;M<0&&(M=g),M>g&&(M=0);let C,b=null;if(c>0){C=-1;for(let B=0;B<d.length;B++){const{proxy:F}=d[B];if(!F.disabled&&(C=B),F.isShow&&b===null)b=B;else if(!F.isShow){C=B;continue}if(C>=M)break}}else{C=d.length;for(let B=g;B>=0;B--){const{proxy:F}=d[B];if(!F.disabled&&(C=B),F.isShow&&b===null)b=B;else if(!F.isShow){C=B;continue}if(C<=M)break}}M=d[C].proxy.isShow?C:b,this.focusIndex=M},onOptionClick(c){if(this.multiple?(this.remote?this.lastRemoteQuery=this.lastRemoteQuery||this.query:this.lastRemoteQuery="",this.values.find(({value:d})=>d===c.value)?this.values=this.values.filter(({value:d})=>d!==c.value):this.values=this.values.concat(c),this.isFocused=!0):(this.query=String(c.label).trim(),this.values=[c],this.lastRemoteQuery="",this.hideMenu()),this.focusIndex=this.slotOptions.findIndex(d=>d?d.props.value===c.value:!1),this.filterable){const d=this.$el.querySelector('input[type="text"]');this.autoComplete||i.nextTick(()=>d.focus())}this.$emit("on-select",c),this.$refs.dropdown.handleOnUpdatePopper(),setTimeout(()=>{this.filterQueryChange=!1},ha)},onQueryChange(c){if(this.isTyping=!0,c.length>0&&c!==this.query)if(s&&this.autoComplete){let d=document.hasFocus&&document.hasFocus()&&document.activeElement===this.$el.querySelector("input");this.visible=d}else this.visible=!0;this.query=c,this.unchangedQuery=this.visible,this.filterQueryChange=!0},toggleHeaderFocus({type:c}){this.itemDisabled||(this.isFocused=c==="focus")},checkUpdateStatus(){this.getInitialValue().length>0&&this.slotOptions.length===0&&(this.hasExpectedValue=!0)},handleCreateItem(){if(this.allowCreate&&this.query!==""&&this.showCreateItem){const c=this.query;this.$emit("on-create",c),this.query="";const d={value:c,label:c,tag:void 0};this.$refs.dropdown.handleOnUpdatePopper(),setTimeout(()=>{this.onOptionClick(d)})}},handleOnSelectSelected(c){this.onOptionClick(c)},focus(){this.filterable&&(this.$refs.selectHead.$refs.input.focus(),this.toggleMenu())},lazyUpdateValue(c){const{getInitialValue:d,isLocking:g,defaultLabel:M,remote:C,modelValue:b,values:B}=this,F=!!(M&&M.length);(b&&b.length||B.length||F)&&C&&c||g||(this.isLocking=!0,i.nextTick(()=>{this.values=d().map(this.getOptionData).filter(Boolean),this.isLocking=!1}))}},watch:{modelValue(c){const{publicValue:d,values:g}=this;this.checkUpdateStatus(),c===""?(this.values=[],this.query=""):Bs(c,d,g)&&(this.lazyUpdateValue(),this.multiple||this.handleFormItemChange("change",this.publicValue))},values(c,d){const g=JSON.stringify(c),M=JSON.stringify(d);let C=this.publicValue;if(g!==M&&C!==this.modelValue){let b=this.publicValue;this.labelInValue&&(this.multiple?b=this.values:b=this.values[0]),(Array.isArray(C)&&!C.length&&this.modelValue===null||C===void 0&&this.modelValue===null)&&(C=null),this.$emit("update:modelValue",C),this.$emit("on-change",b),this.handleFormItemChange("change",b)}},query(c){this.focusIndex=-1,this.$emit("on-query-change",c);const{remoteMethod:d,lastRemoteQuery:g}=this,M=d&&c!==""&&(c!==g||!g)&&!this.preventRemoteCall;if(this.preventRemoteCall=!1,M){const C=this.remoteMethod(c);this.initialLabel="",C&&C.then&&C.then(b=>{b&&(this.options=b)})}this.visible&&this.$refs.dropdown.handleOnUpdatePopper(),c!==""&&this.remote&&(this.lastRemoteQuery=c)},isFocused(c){(this.filterable?this.$el.querySelector('input[type="text"]'):this.$el)[this.isFocused?"focus":"blur"]();const[d]=this.values;if(d&&this.filterable&&!this.multiple&&!c){const g=String(d.label||d.value).trim();g&&this.query!==g&&(this.preventRemoteCall=!0,this.query=g)}},focusIndex(c){if(!(c<0||this.autoComplete)&&this.slotOptions[c]){const d=this.slotOptions[c].proxy.$el,g=this.$refs.dropdown.$refs.drop;let M=d.getBoundingClientRect().bottom-g.getBoundingClientRect().bottom,C=d.getBoundingClientRect().top-g.getBoundingClientRect().top;M>0&&(g.scrollTop+=M),C<0&&(g.scrollTop+=C)}},dropVisible(c){c?this.$refs.dropdown.handleOnUpdatePopper():this.$refs.dropdown.handleOnDestroyPopper()},visible(c){this.$emit("on-open-change",c)}}},_i=["tabindex"],Td=["name","value"];function Mn(c,d,g,M,C,b){const B=i.resolveComponent("select-head"),F=i.resolveComponent("Icon"),Y=i.resolveComponent("Drop"),G=i.resolveDirective("click-outside");return i.withDirectives((i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.createElementVNode("div",{ref:"reference",class:i.normalizeClass(b.selectionCls),tabindex:b.selectTabindex,onBlur:d[2]||(d[2]=(...K)=>b.toggleHeaderFocus&&b.toggleHeaderFocus(...K)),onFocus:d[3]||(d[3]=(...K)=>b.toggleHeaderFocus&&b.toggleHeaderFocus(...K)),onClick:d[4]||(d[4]=(...K)=>b.toggleMenu&&b.toggleMenu(...K)),onKeydown:[d[5]||(d[5]=i.withKeys((...K)=>b.handleKeydown&&b.handleKeydown(...K),["esc"])),d[6]||(d[6]=i.withKeys((...K)=>b.handleKeydown&&b.handleKeydown(...K),["enter"])),d[7]||(d[7]=i.withKeys(i.withModifiers((...K)=>b.handleKeydown&&b.handleKeydown(...K),["prevent"]),["up"])),d[8]||(d[8]=i.withKeys(i.withModifiers((...K)=>b.handleKeydown&&b.handleKeydown(...K),["prevent"]),["down"])),d[9]||(d[9]=i.withKeys((...K)=>b.handleKeydown&&b.handleKeydown(...K),["tab"])),d[10]||(d[10]=i.withKeys((...K)=>b.handleKeydown&&b.handleKeydown(...K),["delete"]))],onMouseenter:d[11]||(d[11]=K=>C.hasMouseHoverHead=!0),onMouseleave:d[12]||(d[12]=K=>C.hasMouseHoverHead=!1)},[i.renderSlot(c.$slots,"input",{},()=>[i.createElementVNode("input",{type:"hidden",name:g.name,value:b.publicValue},null,8,Td),i.createVNode(B,{ref:"selectHead",filterable:g.filterable,multiple:g.multiple,values:C.values,clearable:b.canBeCleared,prefix:g.prefix,disabled:c.itemDisabled,remote:b.remote,"input-element-id":g.elementId,"initial-label":C.initialLabel,placeholder:g.placeholder,"query-prop":C.query,"max-tag-count":g.maxTagCount,"max-tag-placeholder":g.maxTagPlaceholder,"allow-create":g.allowCreate,"show-create-item":b.showCreateItem,onOnQueryChange:b.onQueryChange,onOnInputFocus:d[0]||(d[0]=K=>C.isFocused=!0),onOnInputBlur:d[1]||(d[1]=K=>C.isFocused=!1),onOnClear:b.clearSingleSelect,onOnEnter:b.handleCreateItem},{prefix:i.withCtx(()=>[i.renderSlot(c.$slots,"prefix")]),_:3},8,["filterable","multiple","values","clearable","prefix","disabled","remote","input-element-id","initial-label","placeholder","query-prop","max-tag-count","max-tag-placeholder","allow-create","show-create-item","onOnQueryChange","onOnClear","onOnEnter"])])],42,_i),i.createVNode(Y,{ref:"dropdown",classes:b.dropdownCls,visible:b.dropVisible,placement:g.placement,eventsEnabled:g.eventsEnabled,transfer:g.transfer,"transition-name":"transition-drop"},{default:i.withCtx(()=>[i.withDirectives(i.createElementVNode("ul",{class:i.normalizeClass([C.prefixCls+"-not-found"])},[i.createElementVNode("li",null,i.toDisplayString(b.localeNotFoundText),1)],2),[[i.vShow,b.showNotFoundLabel&&!g.allowCreate]]),!b.remote||b.remote&&!g.loading?(i.openBlock(),i.createElementBlock("ul",{key:0,class:i.normalizeClass(C.prefixCls+"-dropdown-list")},[b.showCreateItem?(i.openBlock(),i.createElementBlock("li",{key:0,class:i.normalizeClass(C.prefixCls+"-item"),onClick:d[13]||(d[13]=(...K)=>b.handleCreateItem&&b.handleCreateItem(...K))},[i.createTextVNode(i.toDisplayString(C.query)+" ",1),i.createVNode(F,{type:"md-return-left",class:i.normalizeClass(C.prefixCls+"-item-enter")},null,8,["class"])],2)):i.createCommentVNode("",!0),i.renderSlot(c.$slots,"default")],2)):(i.openBlock(),i.createElementBlock("ul",{key:1,class:i.normalizeClass(C.prefixCls+"-dropdown-list")},[b.showCreateItem?(i.openBlock(),i.createElementBlock("li",{key:0,class:i.normalizeClass(C.prefixCls+"-item"),onClick:d[14]||(d[14]=(...K)=>b.handleCreateItem&&b.handleCreateItem(...K))},[i.createTextVNode(i.toDisplayString(C.query)+" ",1),i.createVNode(F,{type:"md-return-left",class:i.normalizeClass(C.prefixCls+"-item-enter")},null,8,["class"])],2)):i.createCommentVNode("",!0)],2)),i.withDirectives(i.createElementVNode("ul",{class:i.normalizeClass([C.prefixCls+"-loading"])},i.toDisplayString(b.localeLoadingText),3),[[i.vShow,g.loading]])]),_:3},8,["classes","visible","placement","eventsEnabled","transfer"])],2)),[[G,b.onClickOutside,g.capture],[G,b.onClickOutside,g.capture,{mousedown:!0}],[G,b.onClickOutside,g.capture,{touchstart:!0}]])}var $s=l(on,[["render",Mn]]);const Ed="ivu-select-item",Md={name:"iOption",componentName:"select-item",mixins:[Ei],emits:["on-select-selected"],inject:{SelectInstance:{default:null},OptionGroupInstance:{default:null}},props:{value:{type:[String,Number],required:!0},label:{type:[String,Number]},disabled:{type:Boolean,default:!1},tag:{type:[String,Number]}},data(){return{searchLabel:"",autoComplete:!1,id:j(6),instance:null}},computed:{classes(){return[`${Ed}`,{[`${Ed}-disabled`]:this.itemDisabled,[`${Ed}-selected`]:this.selected&&!this.autoComplete,[`${Ed}-focus`]:this.isFocused}]},showLabel(){return this.label?this.label:this.value},optionLabel(){return this.label||this.$el&&this.$el.textContent},isFocused(){const c=this.SelectInstance;let d=c.slotOptions||[];const g=c.focusIndex,M=c.$slots.default;if(this.autoComplete&&M){d=[];let b=M();for(;b.length>0;){const B=b.shift();B.type&&typeof B.type=="object"&&B.type.name==="iOption"?d.push(B):Array.isArray(B.children)&&(b=b.concat(B.children))}}const C=d[g];return C&&C.props&&C.props.value===this.value},isShow(){const c=this.SelectInstance,d=c.filterable,g=c.query.toLowerCase().trim(),M=c.filterByLabel,C=c.slotOptionsMap,{props:b}=C.get(this.value)||{props:{}},B=this.label||this.$el&&this.$el.textContent;let F=(B||b.value||"").toLowerCase();M&&(F=(B||"").toLowerCase());const Y=F.includes(g);return!d||d&&(Y||!c.filterQueryChange)||D(c.remoteMethod)==="function"},selected(){return(this.SelectInstance.values||[]).find(c=>c.value===this.value)}},methods:{select(){if(this.itemDisabled)return!1;this.SelectInstance.handleOnSelectSelected({value:this.value,label:this.optionLabel,tag:this.tag})},addOption(){const c=this.SelectInstance,d=this.OptionGroupInstance,{id:g,value:M,instance:C}=this;if(d&&d.optionList.push({...C,id:g,tag:"option"}),c){c.slotOptions.push({...C,id:g,tag:"option"}),c.slotOptionsMap.set(M,C);const{modelValue:b}=c;(b&&b.length||D(b)==="number")&&c.lazyUpdateValue(!0)}},removeOption(){const c=this.OptionGroupInstance,d=this.SelectInstance,{id:g,value:M}=this;if(c){const C=c.optionList.findIndex(b=>b.id===g);C!==-1&&c.optionList.splice(C,1)}if(d){const C=this.SelectInstance,b=C.slotOptions.findIndex(B=>B.id===g);b!==-1&&C.slotOptions.splice(b,1),C.slotOptionsMap.has(M)&&C.slotOptionsMap.delete(M)}}},created(){this.instance=i.getCurrentInstance()},mounted(){this.addOption();const c=L(this,"iSelect");c&&(this.autoComplete=c.autoComplete)},beforeUnmount(){i.nextTick(()=>{this.removeOption(),this.instance=null})}};function O0(c,d,g,M,C,b){return i.withDirectives((i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(b.classes),onClick:d[0]||(d[0]=i.withModifiers((...B)=>b.select&&b.select(...B),["stop"])),onMousedown:d[1]||(d[1]=i.withModifiers(()=>{},["prevent"]))},[i.renderSlot(c.$slots,"default",{},()=>[i.createTextVNode(i.toDisplayString(b.showLabel),1)])],34)),[[i.vShow,b.isShow]])}var Jn=l(Md,[["render",O0]]);const Tl=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important
`,S0=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];let _s={},ro;function mT(c,d=!1){if(!s)return;const g=c.getAttribute("id")||c.getAttribute("data-reactid")||c.getAttribute("name");if(d&&_s[g])return _s[g];const M=window.getComputedStyle(c),C=M.getPropertyValue("box-sizing")||M.getPropertyValue("-moz-box-sizing")||M.getPropertyValue("-webkit-box-sizing"),b=parseFloat(M.getPropertyValue("padding-bottom"))+parseFloat(M.getPropertyValue("padding-top")),B=parseFloat(M.getPropertyValue("border-bottom-width"))+parseFloat(M.getPropertyValue("border-top-width")),F={sizingStyle:S0.map(Y=>`${Y}:${M.getPropertyValue(Y)}`).join(";"),paddingSize:b,borderSize:B,boxSizing:C};return d&&g&&(_s[g]=F),F}function px(c,d=null,g=null,M=!1){s&&!ro&&(ro=document.createElement("textarea"),document.body.appendChild(ro)),c.getAttribute("wrap")?ro.setAttribute("wrap",c.getAttribute("wrap")):ro.removeAttribute("wrap");let{paddingSize:C,borderSize:b,boxSizing:B,sizingStyle:F}=mT(c,M);ro.setAttribute("style",`${F};${Tl}`),ro.value=c.value||c.placeholder||"";let Y=Number.MIN_SAFE_INTEGER,G=Number.MAX_SAFE_INTEGER,K=ro.scrollHeight,fe;if(B==="border-box"?K=K+b:B==="content-box"&&(K=K-C),d!==null||g!==null){ro.value=" ";let Ee=ro.scrollHeight-C;d!==null&&(Y=Ee*d,B==="border-box"&&(Y=Y+C+b),K=Math.max(Y,K)),g!==null&&(G=Ee*g,B==="border-box"&&(G=G+C+b),fe=K>G?"":"hidden",K=Math.min(G,K))}return g||(fe="hidden"),{height:`${K}px`,minHeight:`${Y}px`,maxHeight:`${G}px`,overflowY:fe}}const br="ivu-input",CJ={name:"Input",mixins:[Ei],emits:["on-enter","on-search","on-keydown","on-keypress","on-keyup","on-click","on-focus","on-blur","on-change","on-input-change","on-clear","update:modelValue"],props:{type:{validator(c){return O(c,["text","textarea","password","url","email","date","number","tel"])},default:"text"},modelValue:{type:[String,Number],default:""},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},placeholder:{type:String,default:""},maxlength:{type:[String,Number]},disabled:{type:Boolean,default:!1},icon:String,autosize:{type:[Boolean,Object],default:!1},rows:{type:Number,default:2},readonly:{type:Boolean,default:!1},name:{type:String},number:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},spellcheck:{type:Boolean,default:!1},autocomplete:{type:String,default:"off"},clearable:{type:Boolean,default:!1},elementId:{type:String},wrap:{validator(c){return O(c,["hard","soft"])},default:"soft"},prefix:{type:String,default:""},suffix:{type:String,default:""},search:{type:Boolean,default:!1},enterButton:{type:[Boolean,String],default:!1},showWordLimit:{type:Boolean,default:!1},password:{type:Boolean,default:!1},border:{type:Boolean,default:!0}},data(){return{currentValue:this.modelValue,prefixCls:br,slotReady:!1,textareaStyles:{},isOnComposition:!1,showPassword:!1,clearableIconOffset:0}},computed:{currentType(){let c=this.type;return c==="password"&&this.password&&this.showPassword&&(c="text"),c},prepend(){let c=!1;return this.type!=="textarea"&&(c=this.$slots.prepend!==void 0),c},append(){let c=!1;return this.type!=="textarea"&&(c=this.$slots.append!==void 0),c},showPrefix(){let c=!1;return this.type!=="textarea"&&(c=this.prefix!==""||this.$slots.prefix!==void 0),c},showSuffix(){let c=!1;return this.type!=="textarea"&&(c=this.suffix!==""||this.$slots.suffix!==void 0),c},wrapClasses(){return[`${br}-wrapper`,{[`${br}-wrapper-${this.size}`]:!!this.size,[`${br}-type-${this.type}`]:this.type,[`${br}-group`]:this.prepend||this.append||this.search&&this.enterButton,[`${br}-group-${this.size}`]:(this.prepend||this.append||this.search&&this.enterButton)&&!!this.size,[`${br}-group-with-prepend`]:this.prepend,[`${br}-group-with-append`]:this.append||this.search&&this.enterButton,[`${br}-hide-icon`]:this.append,[`${br}-with-search`]:this.search&&this.enterButton,[`${br}-wrapper-disabled`]:this.itemDisabled}]},inputClasses(){return[`${br}`,{[`${br}-${this.size}`]:!!this.size,[`${br}-disabled`]:this.itemDisabled,[`${br}-no-border`]:!this.border,[`${br}-with-prefix`]:this.showPrefix,[`${br}-with-suffix`]:this.showSuffix||this.search&&this.enterButton===!1}]},textareaClasses(){return[`${br}`,{[`${br}-disabled`]:this.itemDisabled,[`${br}-no-border`]:!this.border}]},upperLimit(){return this.maxlength},textLength(){return typeof this.modelValue=="number"?String(this.modelValue).length:(this.modelValue||"").length},clearableStyles(){const c={};let d=this.clearableIconOffset;return d&&(c.transform=`translateX(-${d}px)`),c}},methods:{handleEnter(c){this.$emit("on-enter",c),this.search&&this.$emit("on-search",this.currentValue)},handleKeydown(c){this.$emit("on-keydown",c)},handleKeypress(c){this.$emit("on-keypress",c)},handleKeyup(c){this.$emit("on-keyup",c)},handleIconClick(c){this.$emit("on-click",c)},handleFocus(c){this.$emit("on-focus",c)},handleBlur(c){this.$emit("on-blur",c),L(this,["DatePicker","TimePicker","Cascader","Search"])||this.handleFormItemChange("blur",this.currentValue)},handleComposition(c){c.type==="compositionstart"&&(this.isOnComposition=!0),c.type==="compositionend"&&(this.isOnComposition=!1,this.handleInput(c))},handleInput(c){if(this.isOnComposition)return;let d=c.target.value;this.number&&d!==""&&(d=Number.isNaN(Number(d))?d:Number(d)),this.$emit("update:modelValue",d),this.setCurrentValue(d),this.$emit("on-change",c)},handleChange(c){this.$emit("on-input-change",c)},setCurrentValue(c){c!==this.currentValue&&(i.nextTick(()=>{this.resizeTextarea()}),this.currentValue=c,L(this,["DatePicker","TimePicker","Cascader","Search"])||this.handleFormItemChange("change",c))},resizeTextarea(){const c=this.autosize;if(!c||this.type!=="textarea")return!1;const d=c.minRows,g=c.maxRows;this.textareaStyles=px(this.$refs.textarea,d,g)},focus(c){const d=this.type==="textarea"?this.$refs.textarea:this.$refs.input;d.focus(c);const{cursor:g}=c||{};if(g){const M=d.value.length;switch(g){case"start":d.setSelectionRange(0,0);break;case"end":d.setSelectionRange(M,M);break;default:d.setSelectionRange(0,M)}}},blur(){this.type==="textarea"?this.$refs.textarea.blur():this.$refs.input.blur()},handleClear(){const c={target:{value:""}};this.$emit("update:modelValue",""),this.setCurrentValue(""),this.$emit("on-change",c),this.$emit("on-clear")},handleSearch(){if(this.itemDisabled)return!1;this.$refs.input.focus(),this.$emit("on-search",this.currentValue)},handleToggleShowPassword(){if(this.itemDisabled)return!1;this.showPassword=!this.showPassword,this.focus();const c=this.currentValue.length;setTimeout(()=>{this.$refs.input.setSelectionRange(c,c)},0)},handleCalcIconOffset(){const c=this.$el.querySelectorAll(".ivu-input-group-append")[0];c?this.clearableIconOffset=c.offsetWidth:this.clearableIconOffset=0}},watch:{modelValue(c){this.setCurrentValue(c)},type(){i.nextTick(this.handleCalcIconOffset)}},mounted(){this.slotReady=!0,this.resizeTextarea(),this.handleCalcIconOffset()},updated(){i.nextTick(this.handleCalcIconOffset)}},TJ={key:4,class:"ivu-input-suffix"},EJ={key:5,class:"ivu-input-word-count"},MJ={key:0,class:"ivu-icon ivu-icon-ios-eye-outline"},AJ={key:1,class:"ivu-icon ivu-icon-ios-eye-off-outline"},kJ=["id","autocomplete","spellcheck","type","placeholder","disabled","maxlength","readonly","name","value","number","autofocus"],PJ={key:0,class:"ivu-icon ivu-icon-ios-search"},RJ={key:9,class:"ivu-input-prefix"},IJ=["id","wrap","autocomplete","spellcheck","placeholder","disabled","rows","maxlength","readonly","name","value","autofocus"],NJ={key:0,class:"ivu-input-word-count"};function DJ(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses)},[g.type!=="textarea"?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[b.prepend?i.withDirectives((i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-group-prepend"])},[i.renderSlot(c.$slots,"prepend")],2)),[[i.vShow,C.slotReady]]):i.createCommentVNode("",!0),g.clearable&&C.currentValue&&!c.itemDisabled?(i.openBlock(),i.createElementBlock("i",{key:1,class:i.normalizeClass(["ivu-icon",["ivu-icon-ios-close-circle",C.prefixCls+"-icon",C.prefixCls+"-icon-clear",C.prefixCls+"-icon-normal"]]),onClick:d[0]||(d[0]=(...B)=>b.handleClear&&b.handleClear(...B)),style:i.normalizeStyle(b.clearableStyles)},null,6)):g.icon?(i.openBlock(),i.createElementBlock("i",{key:2,class:i.normalizeClass(["ivu-icon",["ivu-icon-"+g.icon,C.prefixCls+"-icon",C.prefixCls+"-icon-normal"]]),onClick:d[1]||(d[1]=(...B)=>b.handleIconClick&&b.handleIconClick(...B))},null,2)):g.search&&g.enterButton===!1?(i.openBlock(),i.createElementBlock("i",{key:3,class:i.normalizeClass(["ivu-icon ivu-icon-ios-search",[C.prefixCls+"-icon",C.prefixCls+"-icon-normal",C.prefixCls+"-search-icon"]]),onClick:d[2]||(d[2]=(...B)=>b.handleSearch&&b.handleSearch(...B))},null,2)):b.showSuffix?(i.openBlock(),i.createElementBlock("span",TJ,[i.renderSlot(c.$slots,"suffix",{},()=>[g.suffix?(i.openBlock(),i.createElementBlock("i",{key:0,class:i.normalizeClass(["ivu-icon",["ivu-icon-"+g.suffix]])},null,2)):i.createCommentVNode("",!0)])])):g.showWordLimit?(i.openBlock(),i.createElementBlock("span",EJ,i.toDisplayString(b.textLength)+"/"+i.toDisplayString(b.upperLimit),1)):g.password?(i.openBlock(),i.createElementBlock("span",{key:6,class:"ivu-input-suffix",onClick:d[3]||(d[3]=(...B)=>b.handleToggleShowPassword&&b.handleToggleShowPassword(...B))},[C.showPassword?(i.openBlock(),i.createElementBlock("i",MJ)):(i.openBlock(),i.createElementBlock("i",AJ))])):i.createCommentVNode("",!0),i.createVNode(i.Transition,{name:"fade"},{default:i.withCtx(()=>[g.icon?i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("i",{key:0,class:i.normalizeClass(["ivu-icon ivu-icon-ios-loading ivu-load-loop",[C.prefixCls+"-icon",C.prefixCls+"-icon-validate"]])},null,2))]),_:1}),i.createElementVNode("input",{id:g.elementId,autocomplete:g.autocomplete,spellcheck:g.spellcheck,ref:"input",type:b.currentType,class:i.normalizeClass(b.inputClasses),placeholder:g.placeholder,disabled:c.itemDisabled,maxlength:g.maxlength,readonly:g.readonly,name:g.name,value:C.currentValue,number:g.number,autofocus:g.autofocus,onKeyup:[d[4]||(d[4]=i.withKeys((...B)=>b.handleEnter&&b.handleEnter(...B),["enter"])),d[5]||(d[5]=(...B)=>b.handleKeyup&&b.handleKeyup(...B))],onKeypress:d[6]||(d[6]=(...B)=>b.handleKeypress&&b.handleKeypress(...B)),onKeydown:d[7]||(d[7]=(...B)=>b.handleKeydown&&b.handleKeydown(...B)),onFocus:d[8]||(d[8]=(...B)=>b.handleFocus&&b.handleFocus(...B)),onBlur:d[9]||(d[9]=(...B)=>b.handleBlur&&b.handleBlur(...B)),onCompositionstart:d[10]||(d[10]=(...B)=>b.handleComposition&&b.handleComposition(...B)),onCompositionupdate:d[11]||(d[11]=(...B)=>b.handleComposition&&b.handleComposition(...B)),onCompositionend:d[12]||(d[12]=(...B)=>b.handleComposition&&b.handleComposition(...B)),onInput:d[13]||(d[13]=(...B)=>b.handleInput&&b.handleInput(...B)),onChange:d[14]||(d[14]=(...B)=>b.handleChange&&b.handleChange(...B))},null,42,kJ),b.append?i.withDirectives((i.openBlock(),i.createElementBlock("div",{key:7,class:i.normalizeClass([C.prefixCls+"-group-append"])},[i.renderSlot(c.$slots,"append")],2)),[[i.vShow,C.slotReady]]):g.search&&g.enterButton?(i.openBlock(),i.createElementBlock("div",{key:8,class:i.normalizeClass([C.prefixCls+"-group-append",C.prefixCls+"-search"]),onClick:d[15]||(d[15]=(...B)=>b.handleSearch&&b.handleSearch(...B))},[g.enterButton===!0?(i.openBlock(),i.createElementBlock("i",PJ)):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createTextVNode(i.toDisplayString(g.enterButton),1)],64))],2)):b.showPrefix?(i.openBlock(),i.createElementBlock("span",RJ,[i.renderSlot(c.$slots,"prefix",{},()=>[g.prefix?(i.openBlock(),i.createElementBlock("i",{key:0,class:i.normalizeClass(["ivu-icon",["ivu-icon-"+g.prefix]])},null,2)):i.createCommentVNode("",!0)])])):i.createCommentVNode("",!0)],64)):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createElementVNode("textarea",{id:g.elementId,wrap:g.wrap,autocomplete:g.autocomplete,spellcheck:g.spellcheck,ref:"textarea",class:i.normalizeClass(b.textareaClasses),style:i.normalizeStyle(C.textareaStyles),placeholder:g.placeholder,disabled:c.itemDisabled,rows:g.rows,maxlength:g.maxlength,readonly:g.readonly,name:g.name,value:C.currentValue,autofocus:g.autofocus,onKeyup:[d[16]||(d[16]=i.withKeys((...B)=>b.handleEnter&&b.handleEnter(...B),["enter"])),d[17]||(d[17]=(...B)=>b.handleKeyup&&b.handleKeyup(...B))],onKeypress:d[18]||(d[18]=(...B)=>b.handleKeypress&&b.handleKeypress(...B)),onKeydown:d[19]||(d[19]=(...B)=>b.handleKeydown&&b.handleKeydown(...B)),onFocus:d[20]||(d[20]=(...B)=>b.handleFocus&&b.handleFocus(...B)),onBlur:d[21]||(d[21]=(...B)=>b.handleBlur&&b.handleBlur(...B)),onCompositionstart:d[22]||(d[22]=(...B)=>b.handleComposition&&b.handleComposition(...B)),onCompositionupdate:d[23]||(d[23]=(...B)=>b.handleComposition&&b.handleComposition(...B)),onCompositionend:d[24]||(d[24]=(...B)=>b.handleComposition&&b.handleComposition(...B)),onInput:d[25]||(d[25]=(...B)=>b.handleInput&&b.handleInput(...B))},`
            `,46,IJ),g.showWordLimit?(i.openBlock(),i.createElementBlock("span",NJ,i.toDisplayString(b.textLength)+"/"+i.toDisplayString(b.upperLimit),1)):i.createCommentVNode("",!0)],64))],2)}var ua=l(CJ,[["render",DJ]]);const LJ={name:"AutoComplete",mixins:[Ei],components:{iSelect:$s,iOption:Jn,iInput:ua},emits:["update:modelValue","on-change","on-search","on-select","on-focus","on-blur","on-clear"],props:{modelValue:{type:[String,Number],default:""},label:{type:[String,Number],default:""},data:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placeholder:{type:String},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},icon:{type:String},filterMethod:{type:[Function,Boolean],default:!1},placement:{validator(c){return O(c,["top","bottom","top-start","bottom-start","top-end","bottom-end"])},default:"bottom-start"},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},transferClassName:{type:String},capture:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},eventsEnabled:{type:Boolean,default:!1}},data(){return{currentValue:this.modelValue,disableEmitChange:!1}},computed:{inputIcon(){let c="";return this.clearable&&this.currentValue&&!this.disabled?c="ios-close-circle":this.icon&&(c=this.icon),c},filteredData(){return this.filterMethod?this.data.filter(c=>this.filterMethod(this.currentValue,c)):this.data}},watch:{modelValue(c){this.currentValue!==c&&(this.disableEmitChange=!0),this.currentValue=c},currentValue(c){if(this.$refs.select.setQuery(c),this.$emit("update:modelValue",c),this.disableEmitChange){this.disableEmitChange=!1;return}this.$emit("on-change",c),this.handleFormItemChange("change",c)}},methods:{remoteMethod(c){this.$emit("on-search",c)},handleSelect(c){const d=c.value;d!=null&&(this.currentValue=d,this.$refs.input.blur(),this.$emit("on-select",d))},handleFocus(c){this.$emit("on-focus",c)},handleBlur(c){this.$emit("on-blur",c)},handleClear(){!this.clearable||(this.currentValue="",this.$refs.select.reset(),this.$emit("on-clear"))},handleClickOutside(){i.nextTick(()=>{this.$refs.input.blur()})}}};function BJ(c,d,g,M,C,b){const B=i.resolveComponent("i-input"),F=i.resolveComponent("i-option"),Y=i.resolveComponent("i-select");return i.openBlock(),i.createBlock(Y,{ref:"select",class:"ivu-auto-complete",label:g.label,disabled:c.itemDisabled,clearable:g.clearable,placeholder:g.placeholder,size:g.size,placement:g.placement,"model-value":C.currentValue,"transfer-class-name":g.transferClassName,filterable:"",remote:"","auto-complete":"","remote-method":b.remoteMethod,onOnSelect:b.handleSelect,onOnClickoutside:b.handleClickOutside,transfer:g.transfer,capture:g.capture,eventsEnabled:g.eventsEnabled},{input:i.withCtx(()=>[i.renderSlot(c.$slots,"input",{},()=>[i.createVNode(B,{"element-id":g.elementId,ref:"input",modelValue:C.currentValue,"onUpdate:modelValue":d[0]||(d[0]=G=>C.currentValue=G),name:g.name,placeholder:g.placeholder,disabled:c.itemDisabled,size:g.size,icon:b.inputIcon,onOnClick:b.handleClear,onOnFocus:b.handleFocus,onOnBlur:b.handleBlur},null,8,["element-id","modelValue","name","placeholder","disabled","size","icon","onOnClick","onOnFocus","onOnBlur"])])]),default:i.withCtx(()=>[i.renderSlot(c.$slots,"default",{},()=>[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.filteredData,G=>(i.openBlock(),i.createBlock(F,{value:G,key:G},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(G),1)]),_:2},1032,["value"]))),128))])]),_:3},8,["label","disabled","clearable","placeholder","size","placement","model-value","transfer-class-name","remote-method","onOnSelect","onOnClickoutside","transfer","capture","eventsEnabled"])}var sN=l(LJ,[["render",BJ]]);const Ip="ivu-avatar",oN=["small","large","default"],$J={name:"Avatar",components:{Icon:S},emits:["on-error"],props:{shape:{validator(c){return O(c,["circle","square"])},default:"circle"},size:{type:[String,Number],default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},src:{type:String},icon:{type:String},customIcon:{type:String,default:""}},data(){return{prefixCls:Ip,scale:1,childrenWidth:0,isSlotShow:!1,slotTemp:null}},computed:{classes(){return[`${Ip}`,`${Ip}-${this.shape}`,{[`${Ip}-image`]:!!this.src,[`${Ip}-icon`]:!!this.icon||!!this.customIcon,[`${Ip}-${this.size}`]:O(this.size,oN)}]},styles(){let c={};return this.size&&!O(this.size,oN)&&(c.width=`${this.size}px`,c.height=`${this.size}px`,c.lineHeight=`${this.size}px`,c.fontSize=`${this.size/2}px`),c},childrenStyle(){let c={};return this.isSlotShow&&(c={msTransform:`scale(${this.scale})`,WebkitTransform:`scale(${this.scale})`,transform:`scale(${this.scale})`,position:"absolute",display:"inline-block",left:`calc(50% - ${Math.round(this.childrenWidth/2)}px)`}),c}},watch:{size(c,d){c!==d&&this.setScale()}},methods:{setScale(){if(this.isSlotShow=!this.src&&!this.icon,this.$refs.children){this.childrenWidth=this.$refs.children.offsetWidth;const c=this.$el.getBoundingClientRect().width;c-8<this.childrenWidth?this.scale=(c-8)/this.childrenWidth:this.scale=1}},handleError(c){this.$emit("on-error",c)}},beforeCreate(){this.slotTemp=this.$slots.default?this.$slots.default():null},mounted(){this.setScale()},updated(){const c=this.$slots.default?this.$slots.default():null;c&&c!==this.slotTemp&&this.setScale()}},UJ=["src"];function VJ(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("span",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.styles)},[g.src?(i.openBlock(),i.createElementBlock("img",{key:0,src:g.src,onError:d[0]||(d[0]=(...F)=>b.handleError&&b.handleError(...F))},null,40,UJ)):g.icon||g.customIcon?(i.openBlock(),i.createBlock(B,{key:1,type:g.icon,custom:g.customIcon},null,8,["type","custom"])):(i.openBlock(),i.createElementBlock("span",{key:2,ref:"children",class:i.normalizeClass([C.prefixCls+"-string"]),style:i.normalizeStyle(b.childrenStyle)},[i.renderSlot(c.$slots,"default")],6))],6)}var C0=l($J,[["render",VJ]]),aN={emits:["on-popper-show","on-popper-hide","created","update:modelValue"],props:{eventsEnabled:{type:Boolean,default:!1},placement:{type:String,default:"bottom"},boundariesPadding:{type:Number,default:5},reference:Object,popper:Object,offset:{default:0},modelValue:{type:Boolean,default:!1},transition:String,options:{type:Object,default(){return{modifiers:{computeStyle:{gpuAcceleration:!1},preventOverflow:{boundariesElement:"window"}}}}}},data(){return{visible:this.modelValue}},watch:{modelValue:{immediate:!0,handler(c){this.visible=c,this.$emit("update:modelValue",c)}},visible(c){c?(this.handleIndexIncrease&&this.handleIndexIncrease(),this.updatePopper(),this.$emit("on-popper-show")):this.$emit("on-popper-hide"),this.$emit("update:modelValue",c)}},methods:{createPopper(){if(!/^(top|bottom|left|right)(-start|-end)?$/g.test(this.placement))return;const c=this.options,d=this.popper||this.$refs.popper,g=this.reference||this.$refs.reference;!d||!g||(this.popperJS&&this.popperJS.hasOwnProperty("destroy")&&this.popperJS.destroy(),c.eventsEnabled=this.eventsEnabled,c.placement=this.placement,c.modifiers.offset||(c.modifiers.offset={}),c.modifiers.offset.offset=this.offset,c.onCreate=()=>{i.nextTick(this.updatePopper),this.$emit("created",this)},this.popperJS=new ve(g,d,c))},updatePopper(){this.popperJS?this.popperJS.update():this.createPopper()},doDestroy(){this.visible||(this.popperJS.destroy(),this.popperJS=null)}},updated(){i.nextTick(()=>this.updatePopper())},beforeUnmount(){this.popperJS&&this.popperJS.destroy()}};const Np="ivu-tooltip",FJ={name:"Tooltip",mixins:[aN],props:{placement:{validator(c){return O(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},content:{type:[String,Number],default:""},delay:{type:Number,default:100},disabled:{type:Boolean,default:!1},controlled:{type:Boolean,default:!1},always:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},theme:{validator(c){return O(c,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number]},transferClassName:{type:String}},data(){return{prefixCls:Np,tIndex:this.handleGetIndex()}},computed:{innerStyles(){const c={};return this.maxWidth&&(c["max-width"]=`${this.maxWidth}px`),c},innerClasses(){return[`${Np}-inner`,{[`${Np}-inner-with-width`]:!!this.maxWidth}]},dropStyles(){let c={};return this.transfer&&(c["z-index"]=1060+this.tIndex),c},dropdownCls(){return[`${Np}-popper`,`${Np}-${this.theme}`,{[Np+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}]}},watch:{content(){this.updatePopper()}},methods:{handleShowPopper(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.visible=!0},this.delay),this.tIndex=this.handleGetIndex()},handleClosePopper(){this.timeout&&(clearTimeout(this.timeout),this.controlled||(this.timeout=setTimeout(()=>{this.visible=!1},100)))},handleGetIndex(){return He(),Te}},mounted(){this.always&&this.updatePopper()}};function zJ(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([C.prefixCls]),onMouseenter:d[2]||(d[2]=(...B)=>b.handleShowPopper&&b.handleShowPopper(...B)),onMouseleave:d[3]||(d[3]=(...B)=>b.handleClosePopper&&b.handleClosePopper(...B))},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-rel"]),ref:"reference"},[i.renderSlot(c.$slots,"default")],2),(i.openBlock(),i.createBlock(i.Teleport,{to:"body",disabled:!g.transfer},[i.createVNode(i.Transition,{name:"fade"},{default:i.withCtx(()=>[i.withDirectives(i.createElementVNode("div",{ref:"popper",class:i.normalizeClass(b.dropdownCls),style:i.normalizeStyle(b.dropStyles),onMouseenter:d[0]||(d[0]=(...B)=>b.handleShowPopper&&b.handleShowPopper(...B)),onMouseleave:d[1]||(d[1]=(...B)=>b.handleClosePopper&&b.handleClosePopper(...B))},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content"])},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-arrow"])},null,2),i.createElementVNode("div",{class:i.normalizeClass(b.innerClasses),style:i.normalizeStyle(b.innerStyles)},[i.renderSlot(c.$slots,"content",{},()=>[i.createTextVNode(i.toDisplayString(g.content),1)])],6)],2)],38),[[i.vShow,!g.disabled&&(c.visible||g.always)]])]),_:3})],8,["disabled"]))],34)}var Cc=l(FJ,[["render",zJ]]);const XJ={name:"AvatarList",components:{Avatar:C0,Tooltip:Cc},props:{list:{type:Array,default(){return[]}},shape:{validator(c){return O(c,["circle","square"])},default:"circle"},size:{validator(c){return O(c,["small","large","default"])},default:"default"},excessStyle:{type:Object,default(){return{}}},max:{type:Number},tooltip:{type:Boolean,default:!0},placement:{validator(c){return O(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"top"},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}}},computed:{currentList(){const c=this.list.length,d=this.max;return c<=d?[...this.list]:[...this.list].slice(0,d)}}},WJ={key:0,class:"ivu-avatar-list-item ivu-avatar-list-item-excess"},GJ={key:1,class:"ivu-avatar-list-item ivu-avatar-list-item-excess"};function HJ(c,d,g,M,C,b){const B=i.resolveComponent("Avatar"),F=i.resolveComponent("Tooltip");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["ivu-avatar-list","ivu-avatar-list-"+g.size])},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.currentList,(Y,G)=>(i.openBlock(),i.createElementBlock("div",{class:"ivu-avatar-list-item",key:G},[g.tooltip&&Y.tip?(i.openBlock(),i.createBlock(F,{key:0,content:Y.tip,placement:g.placement,transfer:g.transfer},{default:i.withCtx(()=>[i.createVNode(B,{src:Y.src,size:g.size,shape:g.shape},null,8,["src","size","shape"])]),_:2},1032,["content","placement","transfer"])):(i.openBlock(),i.createBlock(B,{key:1,src:Y.src,size:g.size,shape:g.shape},null,8,["src","size","shape"]))]))),128)),c.$slots.extra?(i.openBlock(),i.createElementBlock("div",WJ,[i.createVNode(B,{size:g.size,shape:g.shape,style:i.normalizeStyle(g.excessStyle)},{default:i.withCtx(()=>[i.renderSlot(c.$slots,"extra")]),_:3},8,["size","shape","style"])])):g.list.length>g.max?(i.openBlock(),i.createElementBlock("div",GJ,[i.createVNode(B,{size:g.size,shape:g.shape,style:i.normalizeStyle(g.excessStyle)},{default:i.withCtx(()=>[i.renderSlot(c.$slots,"excess",{},()=>[i.createTextVNode("+"+i.toDisplayString(g.list.length-g.max),1)])]),_:3},8,["size","shape","style"])])):i.createCommentVNode("",!0)],2)}var lN=l(XJ,[["render",HJ]]);const gT="ivu-back-top",QJ={name:"BackTop",emits:["on-click"],props:{height:{type:Number,default:400},bottom:{type:Number,default:30},right:{type:Number,default:30},duration:{type:Number,default:1e3}},data(){return{backTop:!1}},mounted(){o(window,"scroll",this.handleScroll),o(window,"resize",this.handleScroll)},beforeUnmount(){a(window,"scroll",this.handleScroll),a(window,"resize",this.handleScroll)},computed:{classes(){return[`${gT}`,{[`${gT}-show`]:this.backTop}]},styles(){return{bottom:`${this.bottom}px`,right:`${this.right}px`}},innerClasses(){return`${gT}-inner`}},methods:{handleScroll(){!s||(this.backTop=window.pageYOffset>=this.height)},back(){if(!s)return;const c=document.documentElement.scrollTop||document.body.scrollTop;I(window,c,0,this.duration),this.$emit("on-click")}}},jJ=[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-up"},null,-1)];function YJ(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.styles),onClick:d[0]||(d[0]=(...B)=>b.back&&b.back(...B))},[i.renderSlot(c.$slots,"default",{},()=>[i.createElementVNode("div",{class:i.normalizeClass(b.innerClasses)},jJ,2)])],6)}var cN=l(QJ,[["render",YJ]]);const hN=["blue","green","red","yellow","pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],El="ivu-badge",qJ={name:"Badge",props:{count:Number,dot:{type:Boolean,default:!1},overflowCount:{type:[Number,String],default:99},className:String,showZero:{type:Boolean,default:!1},text:{type:String,default:""},status:{validator(c){return O(c,["success","processing","default","error","warning"])}},type:{validator(c){return O(c,["success","primary","normal","error","warning","info"])}},offset:{type:Array},color:{type:String}},computed:{classes(){return`${El}`},dotClasses(){return`${El}-dot`},countClasses(){return[`${El}-count`,{[`${this.className}`]:!!this.className,[`${El}-count-alone`]:this.alone,[`${El}-count-${this.type}`]:!!this.type}]},customCountClasses(){return[`${El}-count`,`${El}-count-custom`,{[`${this.className}`]:!!this.className}]},statusClasses(){return[`${El}-status-dot`,{[`${El}-status-${this.status}`]:!!this.status,[`${El}-status-${this.color}`]:!!this.color&&O(this.color,hN)}]},statusStyles(){return O(this.color,hN)?{}:{backgroundColor:this.color}},styles(){const c={};return this.offset&&this.offset.length===2&&(c["margin-top"]=`${this.offset[0]}px`,c["margin-right"]=`${this.offset[1]}px`),c},finalCount(){return this.text!==""?this.text:parseInt(this.count)>=parseInt(this.overflowCount)?`${this.overflowCount}+`:this.count},badge(){let c=!1;return this.count&&(c=parseInt(this.count)!==0),this.dot&&(c=!0,this.count!==null&&parseInt(this.count)===0&&(c=!1)),this.text!==""&&(c=!0),c||this.showZero},hasCount(){return!!(this.count||this.text!==""||this.showZero&&parseInt(this.count)===0)},alone(){return this.$slots.default===void 0}}},ZJ={class:"ivu-badge-status-text"};function KJ(c,d,g,M,C,b){return g.dot?(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass(b.classes),ref:"badge"},[i.renderSlot(c.$slots,"default"),i.withDirectives(i.createElementVNode("sup",{class:i.normalizeClass(b.dotClasses),style:i.normalizeStyle(b.styles)},null,6),[[i.vShow,b.badge]])],2)):g.status||g.color?(i.openBlock(),i.createElementBlock("span",{key:1,class:i.normalizeClass([b.classes,"ivu-badge-status"]),ref:"badge"},[i.createElementVNode("span",{class:i.normalizeClass(b.statusClasses),style:i.normalizeStyle(b.statusStyles)},null,6),i.createElementVNode("span",ZJ,[i.renderSlot(c.$slots,"text",{},()=>[i.createTextVNode(i.toDisplayString(g.text),1)])])],2)):(i.openBlock(),i.createElementBlock("span",{key:2,class:i.normalizeClass(b.classes),ref:"badge"},[i.renderSlot(c.$slots,"default"),c.$slots.count?(i.openBlock(),i.createElementBlock("sup",{key:0,style:i.normalizeStyle(b.styles),class:i.normalizeClass(b.customCountClasses)},[i.renderSlot(c.$slots,"count")],6)):b.hasCount?i.withDirectives((i.openBlock(),i.createElementBlock("sup",{key:1,style:i.normalizeStyle(b.styles),class:i.normalizeClass(b.countClasses)},[i.renderSlot(c.$slots,"text",{},()=>[i.createTextVNode(i.toDisplayString(b.finalCount),1)])],6)),[[i.vShow,b.badge]]):i.createCommentVNode("",!0)],2))}var mx=l(qJ,[["render",KJ]]);const JJ={name:"Breadcrumb",provide(){return{BreadcrumbInstance:this}},props:{separator:{type:String,default:"/"}}},eee={class:"ivu-breadcrumb"};function tee(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",eee,[i.renderSlot(c.$slots,"default")])}var vT=l(JJ,[["render",tee]]);const uN="ivu-breadcrumb-item",iee={name:"BreadcrumbItem",mixins:[pe],inject:["BreadcrumbInstance"],props:{},data(){return{showSeparator:!1}},computed:{linkClasses(){return`${uN}-link`},separatorClasses(){return`${uN}-separator`},separator(){return this.BreadcrumbInstance.separator}},mounted(){this.showSeparator=this.$slots.separator!==void 0}},nee=["href","target"],ree=["innerHTML"];function see(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("span",null,[c.to?(i.openBlock(),i.createElementBlock("a",{key:0,href:c.linkUrl,target:c.target,class:i.normalizeClass(b.linkClasses),onClick:[d[0]||(d[0]=i.withModifiers(B=>c.handleCheckClick(B,!1),["exact"])),d[1]||(d[1]=i.withModifiers(B=>c.handleCheckClick(B,!0),["ctrl"])),d[2]||(d[2]=i.withModifiers(B=>c.handleCheckClick(B,!0),["meta"]))]},[i.renderSlot(c.$slots,"default")],10,nee)):(i.openBlock(),i.createElementBlock("span",{key:1,class:i.normalizeClass(b.linkClasses)},[i.renderSlot(c.$slots,"default")],2)),C.showSeparator?(i.openBlock(),i.createElementBlock("span",{key:3,class:i.normalizeClass(b.separatorClasses)},[i.renderSlot(c.$slots,"separator")],2)):(i.openBlock(),i.createElementBlock("span",{key:2,class:i.normalizeClass(b.separatorClasses),innerHTML:b.separator},null,10,ree))])}var yT=l(iee,[["render",see]]);const Bh="ivu-btn",Us={name:"Button",mixins:[pe,Ei],components:{Icon:S},emits:["click"],props:{type:{validator(c){return O(c,["default","primary","dashed","text","info","success","warning","error"])},default:"default"},shape:{validator(c){return O(c,["circle","circle-outline"])}},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},loading:Boolean,disabled:Boolean,htmlType:{default:"button",validator(c){return O(c,["button","submit","reset"])}},icon:{type:String,default:""},customIcon:{type:String,default:""},long:{type:Boolean,default:!1},ghost:{type:Boolean,default:!1}},computed:{showSlot(){return!!this.$slots.default},classes(){return[`${Bh}`,`${Bh}-${this.type}`,{[`${Bh}-long`]:this.long,[`${Bh}-${this.shape}`]:!!this.shape,[`${Bh}-${this.size}`]:this.size!=="default",[`${Bh}-loading`]:this.loading!=null&&this.loading,[`${Bh}-icon-only`]:!this.showSlot&&(!!this.icon||!!this.customIcon||this.loading),[`${Bh}-ghost`]:this.ghost}]},isHrefPattern(){const{to:c}=this;return!!c},tagName(){const{isHrefPattern:c}=this;return c?"a":"button"},tagProps(){const{isHrefPattern:c}=this;if(c){const{linkUrl:d,target:g}=this;return{href:d,target:g}}else{const{htmlType:d}=this;return{type:d}}}},methods:{handleClickLink(c){this.$emit("click",c);const d=c.ctrlKey||c.metaKey;this.handleCheckClick(c,d)}},render(){let c;this.tagName==="button"?c="button":this.tagName==="a"&&(c="a");let d=[];return this.loading&&d.push(i.h(S,{class:"ivu-load-loop",type:"ios-loading"})),(this.icon||this.customIcon)&&!this.loading&&d.push(i.h(S,{type:this.icon,custom:this.customIcon})),this.$slots.default&&d.push(i.h("span",{ref:"slot"},this.$slots.default())),i.h(c,{class:this.classes,disabled:this.itemDisabled,onClick:this.handleClickLink,...this.tagProps},d)}},gx="ivu-btn-group",oee={name:"ButtonGroup",props:{size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},shape:{validator(c){return O(c,["circle","circle-outline"])}},vertical:{type:Boolean,default:!1}},computed:{classes(){return[`${gx}`,{[`${gx}-${this.size}`]:!!this.size,[`${gx}-${this.shape}`]:!!this.shape,[`${gx}-vertical`]:this.vertical}]}}};function aee(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.renderSlot(c.$slots,"default")],2)}var bT=l(oee,[["render",aee]]);const T0="ivu-radio-group";let lee=0;const cee=Date.now(),hee={name:"RadioGroup",mixins:[Ei],emits:["update:modelValue","on-change"],provide(){return{RadioGroupInstance:this}},props:{modelValue:{type:[String,Number],default:""},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},type:{validator(c){return O(c,["button"])}},vertical:{type:Boolean,default:!1},name:{type:String,default:()=>`ivuRadioGroup_${cee}_${lee++}`},buttonStyle:{validator(c){return O(c,["default","solid"])},default:"default"}},data(){return{currentValue:this.modelValue,children:[]}},computed:{classes(){return[`${T0}`,{[`${T0}-${this.size}`]:!!this.size,[`ivu-radio-${this.size}`]:!!this.size,[`${T0}-${this.type}`]:!!this.type,[`${T0}-button-${this.buttonStyle}`]:this.type==="button"&&this.buttonStyle!=="default",[`${T0}-vertical`]:this.vertical}]}},methods:{change(c){this.currentValue=c.value,this.$emit("update:modelValue",c.value),this.$emit("on-change",c.value),this.handleFormItemChange("change",c.value)}},watch:{modelValue(){this.currentValue!==this.modelValue&&(this.currentValue=this.modelValue)}}},uee=["name"];function dee(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),name:g.name},[i.renderSlot(c.$slots,"default")],10,uee)}var vx=l(hee,[["render",dee]]);const Ro="ivu-radio",fee={name:"Radio",mixins:[Ei],emits:["update:modelValue","on-change"],inject:{RadioGroupInstance:{default:null}},props:{modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},label:{type:[String,Number]},disabled:{type:Boolean,default:!1},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},name:{type:String},border:{type:Boolean,default:!1}},data(){return{groupName:this.name,parent:this.RadioGroupInstance,focusWrapper:!1,focusInner:!1}},computed:{wrapClasses(){return[`${Ro}-wrapper`,{[`${Ro}-group-item`]:this.group,[`${Ro}-wrapper-checked`]:this.currentValue,[`${Ro}-wrapper-disabled`]:this.itemDisabled,[`${Ro}-${this.size}`]:!!this.size,[`${Ro}-focus`]:this.focusWrapper,[`${Ro}-border`]:this.border}]},radioClasses(){return[`${Ro}`,{[`${Ro}-checked`]:this.currentValue,[`${Ro}-disabled`]:this.itemDisabled}]},innerClasses(){return[`${Ro}-inner`,{[`${Ro}-focus`]:this.focusInner}]},inputClasses(){return`${Ro}-input`},currentValue(){return this.RadioGroupInstance?this.RadioGroupInstance.currentValue===this.label:this.modelValue===this.trueValue},group(){return!!this.RadioGroupInstance}},mounted(){this.parent&&(this.name&&this.name!==this.parent.name?console.warn&&console.warn("[View UI] Name does not match Radio Group name."):this.groupName=this.parent.name)},methods:{change(c){if(this.itemDisabled)return!1;const d=c.target.checked?this.trueValue:this.falseValue;this.$emit("update:modelValue",d),this.group?this.label!==void 0&&this.parent.change({value:this.label,checked:this.modelValue}):(this.$emit("on-change",d),this.handleFormItemChange("change",d))},onBlur(){this.focusWrapper=!1,this.focusInner=!1},onFocus(){this.group&&this.parent.type==="button"?this.focusWrapper=!0:this.focusInner=!0}},watch:{modelValue(c){if(!(c===this.trueValue||c===this.falseValue))throw"Value should be trueValue or falseValue."}}},pee=["disabled","checked","name"];function mee(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("label",{class:i.normalizeClass(b.wrapClasses)},[i.createElementVNode("span",{class:i.normalizeClass(b.radioClasses)},[i.createElementVNode("span",{class:i.normalizeClass(b.innerClasses)},null,2),i.createElementVNode("input",{type:"radio",class:i.normalizeClass(b.inputClasses),disabled:c.itemDisabled,checked:b.currentValue,name:C.groupName,onChange:d[0]||(d[0]=(...B)=>b.change&&b.change(...B)),onFocus:d[1]||(d[1]=(...B)=>b.onFocus&&b.onFocus(...B)),onBlur:d[2]||(d[2]=(...B)=>b.onBlur&&b.onBlur(...B))},null,42,pee)],2),i.renderSlot(c.$slots,"default",{},()=>[i.createTextVNode(i.toDisplayString(g.label),1)])],2)}var yx=l(fee,[["render",mee]]),dN={exports:{}};(function(c,d){(function(g,M){c.exports=M()})(ie,function(){var g=1e3,M=6e4,C=36e5,b="millisecond",B="second",F="minute",Y="hour",G="day",K="week",fe="month",Ee="quarter",Ce="year",Oe="date",ue="Invalid Date",Ne=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,jt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_t={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Ut){var Ot=["th","st","nd","rd"],pt=Ut%100;return"["+Ut+(Ot[(pt-20)%10]||Ot[pt]||Ot[0])+"]"}},Et=function(Ut,Ot,pt){var Xt=String(Ut);return!Xt||Xt.length>=Ot?Ut:""+Array(Ot+1-Xt.length).join(pt)+Ut},je={s:Et,z:function(Ut){var Ot=-Ut.utcOffset(),pt=Math.abs(Ot),Xt=Math.floor(pt/60),Tt=pt%60;return(Ot<=0?"+":"-")+Et(Xt,2,"0")+":"+Et(Tt,2,"0")},m:function Ut(Ot,pt){if(Ot.date()<pt.date())return-Ut(pt,Ot);var Xt=12*(pt.year()-Ot.year())+(pt.month()-Ot.month()),Tt=Ot.clone().add(Xt,fe),mi=pt-Tt<0,xi=Ot.clone().add(Xt+(mi?-1:1),fe);return+(-(Xt+(pt-Tt)/(mi?Tt-xi:xi-Tt))||0)},a:function(Ut){return Ut<0?Math.ceil(Ut)||0:Math.floor(Ut)},p:function(Ut){return{M:fe,y:Ce,w:K,d:G,D:Oe,h:Y,m:F,s:B,ms:b,Q:Ee}[Ut]||String(Ut||"").toLowerCase().replace(/s$/,"")},u:function(Ut){return Ut===void 0}},Le="en",tt={};tt[Le]=_t;var Ze="$isDayjsObject",ti=function(Ut){return Ut instanceof Ft||!(!Ut||!Ut[Ze])},ii=function Ut(Ot,pt,Xt){var Tt;if(!Ot)return Le;if(typeof Ot=="string"){var mi=Ot.toLowerCase();tt[mi]&&(Tt=mi),pt&&(tt[mi]=pt,Tt=mi);var xi=Ot.split("-");if(!Tt&&xi.length>1)return Ut(xi[0])}else{var hn=Ot.name;tt[hn]=Ot,Tt=hn}return!Xt&&Tt&&(Le=Tt),Tt||!Xt&&Le},$t=function(Ut,Ot){if(ti(Ut))return Ut.clone();var pt=typeof Ot=="object"?Ot:{};return pt.date=Ut,pt.args=arguments,new Ft(pt)},Mt=je;Mt.l=ii,Mt.i=ti,Mt.w=function(Ut,Ot){return $t(Ut,{locale:Ot.$L,utc:Ot.$u,x:Ot.$x,$offset:Ot.$offset})};var Ft=function(){function Ut(pt){this.$L=ii(pt.locale,null,!0),this.parse(pt),this.$x=this.$x||pt.x||{},this[Ze]=!0}var Ot=Ut.prototype;return Ot.parse=function(pt){this.$d=function(Xt){var Tt=Xt.date,mi=Xt.utc;if(Tt===null)return new Date(NaN);if(Mt.u(Tt))return new Date;if(Tt instanceof Date)return new Date(Tt);if(typeof Tt=="string"&&!/Z$/i.test(Tt)){var xi=Tt.match(Ne);if(xi){var hn=xi[2]-1||0,Cn=(xi[7]||"0").substring(0,3);return mi?new Date(Date.UTC(xi[1],hn,xi[3]||1,xi[4]||0,xi[5]||0,xi[6]||0,Cn)):new Date(xi[1],hn,xi[3]||1,xi[4]||0,xi[5]||0,xi[6]||0,Cn)}}return new Date(Tt)}(pt),this.init()},Ot.init=function(){var pt=this.$d;this.$y=pt.getFullYear(),this.$M=pt.getMonth(),this.$D=pt.getDate(),this.$W=pt.getDay(),this.$H=pt.getHours(),this.$m=pt.getMinutes(),this.$s=pt.getSeconds(),this.$ms=pt.getMilliseconds()},Ot.$utils=function(){return Mt},Ot.isValid=function(){return this.$d.toString()!==ue},Ot.isSame=function(pt,Xt){var Tt=$t(pt);return this.startOf(Xt)<=Tt&&Tt<=this.endOf(Xt)},Ot.isAfter=function(pt,Xt){return $t(pt)<this.startOf(Xt)},Ot.isBefore=function(pt,Xt){return this.endOf(Xt)<$t(pt)},Ot.$g=function(pt,Xt,Tt){return Mt.u(pt)?this[Xt]:this.set(Tt,pt)},Ot.unix=function(){return Math.floor(this.valueOf()/1e3)},Ot.valueOf=function(){return this.$d.getTime()},Ot.startOf=function(pt,Xt){var Tt=this,mi=!!Mt.u(Xt)||Xt,xi=Mt.p(pt),hn=function(Rt,fi){var ji=Mt.w(Tt.$u?Date.UTC(Tt.$y,fi,Rt):new Date(Tt.$y,fi,Rt),Tt);return mi?ji:ji.endOf(G)},Cn=function(Rt,fi){return Mt.w(Tt.toDate()[Rt].apply(Tt.toDate("s"),(mi?[0,0,0,0]:[23,59,59,999]).slice(fi)),Tt)},Hn=this.$W,er=this.$M,as=this.$D,oo="set"+(this.$u?"UTC":"");switch(xi){case Ce:return mi?hn(1,0):hn(31,11);case fe:return mi?hn(1,er):hn(0,er+1);case K:var Qa=this.$locale().weekStart||0,ja=(Hn<Qa?Hn+7:Hn)-Qa;return hn(mi?as-ja:as+(6-ja),er);case G:case Oe:return Cn(oo+"Hours",0);case Y:return Cn(oo+"Minutes",1);case F:return Cn(oo+"Seconds",2);case B:return Cn(oo+"Milliseconds",3);default:return this.clone()}},Ot.endOf=function(pt){return this.startOf(pt,!1)},Ot.$set=function(pt,Xt){var Tt,mi=Mt.p(pt),xi="set"+(this.$u?"UTC":""),hn=(Tt={},Tt[G]=xi+"Date",Tt[Oe]=xi+"Date",Tt[fe]=xi+"Month",Tt[Ce]=xi+"FullYear",Tt[Y]=xi+"Hours",Tt[F]=xi+"Minutes",Tt[B]=xi+"Seconds",Tt[b]=xi+"Milliseconds",Tt)[mi],Cn=mi===G?this.$D+(Xt-this.$W):Xt;if(mi===fe||mi===Ce){var Hn=this.clone().set(Oe,1);Hn.$d[hn](Cn),Hn.init(),this.$d=Hn.set(Oe,Math.min(this.$D,Hn.daysInMonth())).$d}else hn&&this.$d[hn](Cn);return this.init(),this},Ot.set=function(pt,Xt){return this.clone().$set(pt,Xt)},Ot.get=function(pt){return this[Mt.p(pt)]()},Ot.add=function(pt,Xt){var Tt,mi=this;pt=Number(pt);var xi=Mt.p(Xt),hn=function(er){var as=$t(mi);return Mt.w(as.date(as.date()+Math.round(er*pt)),mi)};if(xi===fe)return this.set(fe,this.$M+pt);if(xi===Ce)return this.set(Ce,this.$y+pt);if(xi===G)return hn(1);if(xi===K)return hn(7);var Cn=(Tt={},Tt[F]=M,Tt[Y]=C,Tt[B]=g,Tt)[xi]||1,Hn=this.$d.getTime()+pt*Cn;return Mt.w(Hn,this)},Ot.subtract=function(pt,Xt){return this.add(-1*pt,Xt)},Ot.format=function(pt){var Xt=this,Tt=this.$locale();if(!this.isValid())return Tt.invalidDate||ue;var mi=pt||"YYYY-MM-DDTHH:mm:ssZ",xi=Mt.z(this),hn=this.$H,Cn=this.$m,Hn=this.$M,er=Tt.weekdays,as=Tt.months,oo=Tt.meridiem,Qa=function(fi,ji,Yr,zs){return fi&&(fi[ji]||fi(Xt,mi))||Yr[ji].slice(0,zs)},ja=function(fi){return Mt.s(hn%12||12,fi,"0")},Rt=oo||function(fi,ji,Yr){var zs=fi<12?"AM":"PM";return Yr?zs.toLowerCase():zs};return mi.replace(jt,function(fi,ji){return ji||function(Yr){switch(Yr){case"YY":return String(Xt.$y).slice(-2);case"YYYY":return Mt.s(Xt.$y,4,"0");case"M":return Hn+1;case"MM":return Mt.s(Hn+1,2,"0");case"MMM":return Qa(Tt.monthsShort,Hn,as,3);case"MMMM":return Qa(as,Hn);case"D":return Xt.$D;case"DD":return Mt.s(Xt.$D,2,"0");case"d":return String(Xt.$W);case"dd":return Qa(Tt.weekdaysMin,Xt.$W,er,2);case"ddd":return Qa(Tt.weekdaysShort,Xt.$W,er,3);case"dddd":return er[Xt.$W];case"H":return String(hn);case"HH":return Mt.s(hn,2,"0");case"h":return ja(1);case"hh":return ja(2);case"a":return Rt(hn,Cn,!0);case"A":return Rt(hn,Cn,!1);case"m":return String(Cn);case"mm":return Mt.s(Cn,2,"0");case"s":return String(Xt.$s);case"ss":return Mt.s(Xt.$s,2,"0");case"SSS":return Mt.s(Xt.$ms,3,"0");case"Z":return xi}return null}(fi)||xi.replace(":","")})},Ot.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Ot.diff=function(pt,Xt,Tt){var mi,xi=this,hn=Mt.p(Xt),Cn=$t(pt),Hn=(Cn.utcOffset()-this.utcOffset())*M,er=this-Cn,as=function(){return Mt.m(xi,Cn)};switch(hn){case Ce:mi=as()/12;break;case fe:mi=as();break;case Ee:mi=as()/3;break;case K:mi=(er-Hn)/6048e5;break;case G:mi=(er-Hn)/864e5;break;case Y:mi=er/C;break;case F:mi=er/M;break;case B:mi=er/g;break;default:mi=er}return Tt?mi:Mt.a(mi)},Ot.daysInMonth=function(){return this.endOf(fe).$D},Ot.$locale=function(){return tt[this.$L]},Ot.locale=function(pt,Xt){if(!pt)return this.$L;var Tt=this.clone(),mi=ii(pt,Xt,!0);return mi&&(Tt.$L=mi),Tt},Ot.clone=function(){return Mt.w(this.$d,this)},Ot.toDate=function(){return new Date(this.valueOf())},Ot.toJSON=function(){return this.isValid()?this.toISOString():null},Ot.toISOString=function(){return this.$d.toISOString()},Ot.toString=function(){return this.$d.toUTCString()},Ut}(),si=Ft.prototype;return $t.prototype=si,[["$ms",b],["$s",B],["$m",F],["$H",Y],["$W",G],["$M",fe],["$y",Ce],["$D",Oe]].forEach(function(Ut){si[Ut[1]]=function(Ot){return this.$g(Ot,Ut[0],Ut[1])}}),$t.extend=function(Ut,Ot){return Ut.$i||(Ut(Ot,Ft,$t),Ut.$i=!0),$t},$t.locale=ii,$t.isDayjs=ti,$t.unix=function(Ut){return $t(1e3*Ut)},$t.en=tt[Le],$t.Ls=tt,$t.p={},$t})})(dN);var Io=dN.exports,fN=1/0,pN=9007199254740991,gee=17976931348623157e292,mN=NaN,vee="[object Function]",yee="[object GeneratorFunction]",bee="[object Symbol]",xee=/^\s+|\s+$/g,wee=/^[-+]0x[0-9a-f]+$/i,_ee=/^0b[01]+$/i,Oee=/^0o[0-7]+$/i,See=/^(?:0|[1-9]\d*)$/,Cee=parseInt,Tee=Object.prototype,gN=Tee.toString,Eee=Math.ceil,Mee=Math.max;function Aee(c,d,g){var M=-1,C=c.length;d<0&&(d=-d>C?0:C+d),g=g>C?C:g,g<0&&(g+=C),C=d>g?0:g-d>>>0,d>>>=0;for(var b=Array(C);++M<C;)b[M]=c[M+d];return b}function kee(c,d){return d=d??pN,!!d&&(typeof c=="number"||See.test(c))&&c>-1&&c%1==0&&c<d}function Pee(c,d,g){if(!bx(g))return!1;var M=typeof d;return(M=="number"?Nee(g)&&kee(d,g.length):M=="string"&&d in g)?Iee(g[d],c):!1}function Ree(c,d,g){(g?Pee(c,d,g):d===void 0)?d=1:d=Mee(Vee(d),0);var M=c?c.length:0;if(!M||d<1)return[];for(var C=0,b=0,B=Array(Eee(M/d));C<M;)B[b++]=Aee(c,C,C+=d);return B}function Iee(c,d){return c===d||c!==c&&d!==d}function Nee(c){return c!=null&&Lee(c.length)&&!Dee(c)}function Dee(c){var d=bx(c)?gN.call(c):"";return d==vee||d==yee}function Lee(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=pN}function bx(c){var d=typeof c;return!!c&&(d=="object"||d=="function")}function Bee(c){return!!c&&typeof c=="object"}function $ee(c){return typeof c=="symbol"||Bee(c)&&gN.call(c)==bee}function Uee(c){if(!c)return c===0?c:0;if(c=Fee(c),c===fN||c===-fN){var d=c<0?-1:1;return d*gee}return c===c?c:0}function Vee(c){var d=Uee(c),g=d%1;return d===d?g?d-g:d:0}function Fee(c){if(typeof c=="number")return c;if($ee(c))return mN;if(bx(c)){var d=typeof c.valueOf=="function"?c.valueOf():c;c=bx(d)?d+"":d}if(typeof c!="string")return c===0?c:+c;c=c.replace(xee,"");var g=_ee.test(c);return g||Oee.test(c)?Cee(c.slice(2),g?2:8):wee.test(c)?mN:+c}var vN=Ree,yN={emits:["on-cell-click","on-cell-contextmenu"],methods:{handleCellClick(c){this.CalendarInstance.$emit("on-cell-click",c)},handleCellContextmenu(c){this.CalendarInstance.$emit("on-cell-contextmenu",c)}}};const zee={name:"CalendarMonth",mixins:[yN],inject:["CalendarInstance"],props:{date:Object},data(){return{firstDayOfWeek:this.CalendarInstance.firstDayOfWeek,weekDays:this.CalendarInstance.locale.weekDays}},computed:{finalWeekDays(){return this.weekDays.slice(this.firstDayOfWeek).concat(this.weekDays.slice(0,this.firstDayOfWeek))},days(){let c=[];const d=Io(this.date.format("YYYY-MM-01")),g=d.day(),M=this.firstDayOfWeek,C=M<=g?g-M:7-(M-g);for(let Y=0;Y<C;Y++){const G=d.subtract(C-Y,"day"),K={text:G.format("YYYY-MM-DD"),date:G.format("D"),type:"prev"};c.push(K)}const b=d.daysInMonth();for(let Y=0;Y<b;Y++){const G=d.add(Y,"day"),K={text:G.format("YYYY-MM-DD"),date:G.format("D"),type:"current"};c.push(K)}const B=42-c.length,F=d.add(1,"month");for(let Y=0;Y<B;Y++){const G=F.add(Y,"day"),K={text:G.format("YYYY-MM-DD"),date:G.format("D"),type:"next"};c.push(K)}return c},chunkDays(){return vN(this.days,7)},dayStyles(){let c={};return this.CalendarInstance.cellHeight!==100&&(c.height=`${this.CalendarInstance.cellHeight}px`),c},currentDate(){return this.date.format("YYYY-MM-DD")}},methods:{handleClickDate(c){this.CalendarInstance.handleChangeDate(Io(c))}}},Xee={class:"ivu-calendar-table",cellspacing:"0",cellpadding:"0"},Wee=["onClick","onContextmenu"],Gee=["onClick"],Hee={class:"ivu-calendar-table-day-title"},Qee={class:"ivu-calendar-table-day-slot"};function jee(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("table",Xee,[i.createElementVNode("thead",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.finalWeekDays,B=>(i.openBlock(),i.createElementBlock("th",{key:B},i.toDisplayString(B),1))),128))]),i.createElementVNode("tbody",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.chunkDays,(B,F)=>(i.openBlock(),i.createElementBlock("tr",{key:F},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(B,Y=>(i.openBlock(),i.createElementBlock("td",{key:Y.text,onClick:G=>c.handleCellClick(Y),onContextmenu:i.withModifiers(G=>c.handleCellContextmenu(Y),["prevent"])},[i.createElementVNode("div",{class:i.normalizeClass(["ivu-calendar-table-day",{"ivu-calendar-table-day-other":Y.type!=="current","ivu-calendar-table-day-current":Y.text===b.currentDate}]),style:i.normalizeStyle(b.dayStyles),onClick:G=>b.handleClickDate(Y.text)},[i.createElementVNode("div",Hee,i.toDisplayString(Y.date),1),i.createElementVNode("div",Qee,[i.renderSlot(c.$slots,"month",{date:new Date(Y.date),data:{type:Y.type+"-month",day:Y.text,selected:Y.text===b.currentDate}})])],14,Gee)],40,Wee))),128))]))),128))])])}var Yee=l(zee,[["render",jee]]);const qee={name:"CalendarYear",mixins:[yN],inject:["CalendarInstance"],props:{date:Object},data(){return{}},computed:{months(){let c=[];const d=Io(this.date.format("YYYY-01-01"));for(let g=0;g<12;g++){const M=d.add(g,"month");c.push({text:M.format("YYYY-MM"),month:this.CalendarInstance.locale.months[g],type:"current"})}return c},chunkMonths(){return vN(this.months,3)},dayStyles(){let c={};return this.CalendarInstance.cellHeight!==100&&(c.height=`${this.CalendarInstance.cellHeight}px`),c},currentMonth(){return this.date.format("YYYY-MM")}},methods:{handleClickDate(c){this.CalendarInstance.handleChangeDate(Io(c))}}},Zee={class:"ivu-calendar-table ivu-calendar-table-year",cellspacing:"0",cellpadding:"0"},Kee=["onClick","onContextmenu"],Jee=["onClick"],ete={class:"ivu-calendar-table-day-title"},tte={class:"ivu-calendar-table-day-slot"};function ite(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("table",Zee,[i.createElementVNode("tbody",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.chunkMonths,(B,F)=>(i.openBlock(),i.createElementBlock("tr",{key:F},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(B,Y=>(i.openBlock(),i.createElementBlock("td",{key:Y.text,onClick:G=>c.handleCellClick(Y),onContextmenu:i.withModifiers(G=>c.handleCellContextmenu(Y),["prevent"])},[i.createElementVNode("div",{class:i.normalizeClass(["ivu-calendar-table-day",{"ivu-calendar-table-day-current":Y.text===b.currentMonth}]),style:i.normalizeStyle(b.dayStyles),onClick:G=>b.handleClickDate(Y.text)},[i.createElementVNode("div",ete,i.toDisplayString(Y.month),1),i.createElementVNode("div",tte,[i.renderSlot(c.$slots,"year",{month:new Date(Y.month),data:{type:Y.type+"-year",month:Y.text,selected:Y.text===b.currentMonth}})])],14,Jee)],40,Kee))),128))]))),128))])])}var nte=l(qee,[["render",ite]]);const rte={name:"Calendar",components:{CalendarMonth:Yee,CalendarYear:nte,ButtonGroup:bT,Button:Us,RadioGroup:vx,Radio:yx,Icon:S},emits:["on-type-change","on-prev","on-next","on-today","on-change","update:modelValue","on-cell-click","on-cell-contextmenu"],provide(){return{CalendarInstance:this}},props:{modelValue:{type:[Date,String,Number]},type:{validator(c){return O(c,["month","year"])},default:"month"},cellHeight:{type:Number,default:100},showHeader:{type:Boolean,default:!0},headerType:{validator(c){return O(c,["simple","full"])},default:"simple"},firstDayOfWeek:{validator(c){return O(c,[1,2,3,4,5,6,7])},default:1},hideType:{type:Boolean,default:!1},locale:{type:Object,default(){return{today:"今天",type:{month:"月",year:"年"},weekDays:["日","一","二","三","四","五","六"],months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]}}}},data(){const c=this.modelValue?this.modelValue:new Date;return{currentValue:Io(c),mode:this.type}},watch:{modelValue(c){const d=c||new Date;this.currentValue=Io(d)},type(c){this.mode=c}},computed:{headerTitle(){if(this.mode==="month")return this.currentValue.format("YYYY 年 M 月");if(this.mode==="year")return this.currentValue.format("YYYY 年")}},methods:{handleChangeType(c){this.$emit("on-type-change",c)},handlePrev(){const c=this.currentValue.format("YYYY-MM-01");let d;this.mode==="month"?d=Io(c).subtract(1,"month"):this.mode==="year"&&(d=Io(c).subtract(1,"year")),this.handleChangeDate(d),this.$emit("on-prev")},handleNext(){const c=this.currentValue.format("YYYY-MM-01");let d;this.mode==="month"?d=Io(c).add(1,"month"):this.mode==="year"&&(d=Io(c).add(1,"year")),this.handleChangeDate(d),this.$emit("on-next")},handleToday(){const c=Io(new Date),d=c.format("YYYY-MM-DD"),g=this.currentValue.format("YYYY-MM-DD");d!==g&&this.handleChangeDate(c),this.$emit("on-today")},handleChangeDate(c){this.currentValue=c;const d=new Date(c.format("YYYY-MM-DD"));this.$emit("update:modelValue",d),this.$emit("on-change",d)}}},ste={class:"ivu-calendar"},ote={key:0,class:"ivu-calendar-header"},ate={class:"ivu-calendar-header-title"},lte={class:"ivu-calendar-header-action"},cte={class:"ivu-calendar-body"};function hte(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("Button"),Y=i.resolveComponent("ButtonGroup"),G=i.resolveComponent("Radio"),K=i.resolveComponent("RadioGroup"),fe=i.resolveComponent("CalendarMonth"),Ee=i.resolveComponent("CalendarYear");return i.openBlock(),i.createElementBlock("div",ste,[g.showHeader?(i.openBlock(),i.createElementBlock("div",ote,[i.renderSlot(c.$slots,"header",{},()=>[i.createElementVNode("div",ate,[i.renderSlot(c.$slots,"headerTitle",{},()=>[i.createTextVNode(i.toDisplayString(b.headerTitle),1)])]),i.createElementVNode("div",lte,[g.headerType==="simple"?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createVNode(Y,null,{default:i.withCtx(()=>[i.createVNode(F,{onClick:b.handlePrev},{default:i.withCtx(()=>[i.createVNode(B,{type:"ios-arrow-back"})]),_:1},8,["onClick"]),i.createVNode(F,{onClick:b.handleToday},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(g.locale.today),1)]),_:1},8,["onClick"]),i.createVNode(F,{onClick:b.handleNext},{default:i.withCtx(()=>[i.createVNode(B,{type:"ios-arrow-forward"})]),_:1},8,["onClick"])]),_:1}),g.hideType?i.createCommentVNode("",!0):(i.openBlock(),i.createBlock(K,{key:0,modelValue:C.mode,"onUpdate:modelValue":d[0]||(d[0]=Ce=>C.mode=Ce),type:"button",class:"ivu-ml",onOnChange:b.handleChangeType},{default:i.withCtx(()=>[i.createVNode(G,{label:"month"},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(g.locale.type.month),1)]),_:1}),i.createVNode(G,{label:"year"},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(g.locale.type.year),1)]),_:1})]),_:1},8,["modelValue","onOnChange"]))],64)):g.headerType==="full"?(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[],64)):i.createCommentVNode("",!0)])])])):i.createCommentVNode("",!0),i.createElementVNode("div",cte,[C.mode==="month"?(i.openBlock(),i.createBlock(fe,{key:0,date:C.currentValue},{month:i.withCtx(({date:Ce,data:Oe})=>[i.renderSlot(c.$slots,"month",{date:Ce,data:Oe})]),_:3},8,["date"])):C.mode==="year"?(i.openBlock(),i.createBlock(Ee,{key:1,date:C.currentValue},{year:i.withCtx(({month:Ce,data:Oe})=>[i.renderSlot(c.$slots,"year",{month:Ce,data:Oe})]),_:3},8,["date"])):i.createCommentVNode("",!0)])])}var bN=l(rte,[["render",hte]]);const Tc="ivu-col";function ute(c){return typeof c=="number"?`${c} ${c} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(c)?`0 0 ${c}`:c}const dte={name:"iCol",inject:["RowInstance"],props:{span:[Number,String],order:[Number,String],offset:[Number,String],push:[Number,String],pull:[Number,String],className:String,xs:[Number,Object],sm:[Number,Object],md:[Number,Object],lg:[Number,Object],xl:[Number,Object],xxl:[Number,Object],flex:{type:[Number,String],default:""}},computed:{gutter(){return this.RowInstance.gutter},classes(){let c=[`${Tc}`,{[`${Tc}-span-${this.span}`]:this.span,[`${Tc}-order-${this.order}`]:this.order,[`${Tc}-offset-${this.offset}`]:this.offset,[`${Tc}-push-${this.push}`]:this.push,[`${Tc}-pull-${this.pull}`]:this.pull,[`${this.className}`]:!!this.className}];return["xs","sm","md","lg","xl","xxl"].forEach(d=>{if(typeof this[d]=="number")c.push(`${Tc}-span-${d}-${this[d]}`);else if(typeof this[d]=="object"){let g=this[d];Object.keys(g).forEach(M=>{c.push(M!=="span"?`${Tc}-${d}-${M}-${g[M]}`:`${Tc}-span-${d}-${g[M]}`)})}}),c},styles(){let c={};return this.gutter!==0&&(c={paddingLeft:this.gutter/2+"px",paddingRight:this.gutter/2+"px"}),this.flex&&(c.flex=ute(this.flex)),c}}};function fte(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.styles)},[i.renderSlot(c.$slots,"default")],6)}var Ml=l(dte,[["render",fte]]);const Ad="ivu-row",pte={name:"Row",provide(){return{RowInstance:this}},props:{type:{validator(c){return O(c,["flex"])}},align:{validator(c){return O(c,["top","middle","bottom"])}},justify:{validator(c){return O(c,["start","end","center","space-around","space-between"])}},gutter:{type:Number,default:0},className:String,wrap:{type:Boolean,default:!0}},computed:{classes(){return[`${Ad}`,{[`${Ad}-${this.type}`]:!!this.type,[`${Ad}-${this.type}-${this.align}`]:!!this.align&&this.type,[`${Ad}-${this.type}-${this.justify}`]:!!this.justify&&this.type,[`${Ad}-${this.align}`]:!!this.align,[`${Ad}-${this.justify}`]:!!this.justify,[`${this.className}`]:!!this.className,[`${Ad}-no-wrap`]:!this.wrap}]},styles(){let c={};return this.gutter!==0&&(c={marginLeft:this.gutter/-2+"px",marginRight:this.gutter/-2+"px"}),c}}};function mte(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.styles)},[i.renderSlot(c.$slots,"default")],6)}var $h=l(pte,[["render",mte]]);function kd(){return kd=Object.assign||function(c){for(var d=1;d<arguments.length;d++){var g=arguments[d];for(var M in g)Object.prototype.hasOwnProperty.call(g,M)&&(c[M]=g[M])}return c},kd.apply(this,arguments)}function gte(c,d){c.prototype=Object.create(d.prototype),c.prototype.constructor=c,E0(c,d)}function xT(c){return xT=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},xT(c)}function E0(c,d){return E0=Object.setPrototypeOf||function(g,M){return g.__proto__=M,g},E0(c,d)}function vte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xx(c,d,g){return vte()?xx=Reflect.construct:xx=function(M,C,b){var B=[null];B.push.apply(B,C);var F=Function.bind.apply(M,B),Y=new F;return b&&E0(Y,b.prototype),Y},xx.apply(null,arguments)}function yte(c){return Function.toString.call(c).indexOf("[native code]")!==-1}function wT(c){var d=typeof Map=="function"?new Map:void 0;return wT=function(g){if(g===null||!yte(g))return g;if(typeof g!="function")throw new TypeError("Super expression must either be null or a function");if(typeof d<"u"){if(d.has(g))return d.get(g);d.set(g,M)}function M(){return xx(g,arguments,xT(this).constructor)}return M.prototype=Object.create(g.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),E0(M,g)},wT(c)}var bte=/%[sdj%]/g,xte=function(){};function _T(c){if(!c||!c.length)return null;var d={};return c.forEach(function(g){var M=g.field;d[M]=d[M]||[],d[M].push(g)}),d}function No(){for(var c=arguments.length,d=new Array(c),g=0;g<c;g++)d[g]=arguments[g];var M=1,C=d[0],b=d.length;if(typeof C=="function")return C.apply(null,d.slice(1));if(typeof C=="string"){var B=String(C).replace(bte,function(F){if(F==="%%")return"%";if(M>=b)return F;switch(F){case"%s":return String(d[M++]);case"%d":return Number(d[M++]);case"%j":try{return JSON.stringify(d[M++])}catch{return"[Circular]"}break;default:return F}});return B}return C}function wte(c){return c==="string"||c==="url"||c==="hex"||c==="email"||c==="date"||c==="pattern"}function Ir(c,d){return!!(c==null||d==="array"&&Array.isArray(c)&&!c.length||wte(d)&&typeof c=="string"&&!c)}function _te(c,d,g){var M=[],C=0,b=c.length;function B(F){M.push.apply(M,F),C++,C===b&&g(M)}c.forEach(function(F){d(F,B)})}function xN(c,d,g){var M=0,C=c.length;function b(B){if(B&&B.length){g(B);return}var F=M;M=M+1,F<C?d(c[F],b):g([])}b([])}function Ote(c){var d=[];return Object.keys(c).forEach(function(g){d.push.apply(d,c[g])}),d}var wN=function(c){gte(d,c);function d(g,M){var C;return C=c.call(this,"Async Validation Error")||this,C.errors=g,C.fields=M,C}return d}(wT(Error));function Ste(c,d,g,M){if(d.first){var C=new Promise(function(fe,Ee){var Ce=function(ue){return M(ue),ue.length?Ee(new wN(ue,_T(ue))):fe()},Oe=Ote(c);xN(Oe,g,Ce)});return C.catch(function(fe){return fe}),C}var b=d.firstFields||[];b===!0&&(b=Object.keys(c));var B=Object.keys(c),F=B.length,Y=0,G=[],K=new Promise(function(fe,Ee){var Ce=function(Oe){if(G.push.apply(G,Oe),Y++,Y===F)return M(G),G.length?Ee(new wN(G,_T(G))):fe()};B.length||(M(G),fe()),B.forEach(function(Oe){var ue=c[Oe];b.indexOf(Oe)!==-1?xN(ue,g,Ce):_te(ue,g,Ce)})});return K.catch(function(fe){return fe}),K}function _N(c){return function(d){return d&&d.message?(d.field=d.field||c.fullField,d):{message:typeof d=="function"?d():d,field:d.field||c.fullField}}}function ON(c,d){if(d){for(var g in d)if(d.hasOwnProperty(g)){var M=d[g];typeof M=="object"&&typeof c[g]=="object"?c[g]=kd({},c[g],M):c[g]=M}}return c}function SN(c,d,g,M,C,b){c.required&&(!g.hasOwnProperty(c.field)||Ir(d,b||c.type))&&M.push(No(C.messages.required,c.fullField))}function Cte(c,d,g,M,C){(/^\s+$/.test(d)||d==="")&&M.push(No(C.messages.whitespace,c.fullField))}var OT={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},M0={integer:function(c){return M0.number(c)&&parseInt(c,10)===c},float:function(c){return M0.number(c)&&!M0.integer(c)},array:function(c){return Array.isArray(c)},regexp:function(c){if(c instanceof RegExp)return!0;try{return!!new RegExp(c)}catch{return!1}},date:function(c){return typeof c.getTime=="function"&&typeof c.getMonth=="function"&&typeof c.getYear=="function"&&!isNaN(c.getTime())},number:function(c){return isNaN(c)?!1:typeof c=="number"},object:function(c){return typeof c=="object"&&!M0.array(c)},method:function(c){return typeof c=="function"},email:function(c){return typeof c=="string"&&!!c.match(OT.email)&&c.length<255},url:function(c){return typeof c=="string"&&!!c.match(OT.url)},hex:function(c){return typeof c=="string"&&!!c.match(OT.hex)}};function Tte(c,d,g,M,C){if(c.required&&d===void 0){SN(c,d,g,M,C);return}var b=["integer","float","array","regexp","object","method","email","number","date","url","hex"],B=c.type;b.indexOf(B)>-1?M0[B](d)||M.push(No(C.messages.types[B],c.fullField,c.type)):B&&typeof d!==c.type&&M.push(No(C.messages.types[B],c.fullField,c.type))}function Ete(c,d,g,M,C){var b=typeof c.len=="number",B=typeof c.min=="number",F=typeof c.max=="number",Y=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,G=d,K=null,fe=typeof d=="number",Ee=typeof d=="string",Ce=Array.isArray(d);if(fe?K="number":Ee?K="string":Ce&&(K="array"),!K)return!1;Ce&&(G=d.length),Ee&&(G=d.replace(Y,"_").length),b?G!==c.len&&M.push(No(C.messages[K].len,c.fullField,c.len)):B&&!F&&G<c.min?M.push(No(C.messages[K].min,c.fullField,c.min)):F&&!B&&G>c.max?M.push(No(C.messages[K].max,c.fullField,c.max)):B&&F&&(G<c.min||G>c.max)&&M.push(No(C.messages[K].range,c.fullField,c.min,c.max))}var Dp="enum";function Mte(c,d,g,M,C){c[Dp]=Array.isArray(c[Dp])?c[Dp]:[],c[Dp].indexOf(d)===-1&&M.push(No(C.messages[Dp],c.fullField,c[Dp].join(", ")))}function Ate(c,d,g,M,C){if(c.pattern){if(c.pattern instanceof RegExp)c.pattern.lastIndex=0,c.pattern.test(d)||M.push(No(C.messages.pattern.mismatch,c.fullField,d,c.pattern));else if(typeof c.pattern=="string"){var b=new RegExp(c.pattern);b.test(d)||M.push(No(C.messages.pattern.mismatch,c.fullField,d,c.pattern))}}}var Qi={required:SN,whitespace:Cte,type:Tte,range:Ete,enum:Mte,pattern:Ate};function kte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d,"string")&&!c.required)return g();Qi.required(c,d,M,b,C,"string"),Ir(d,"string")||(Qi.type(c,d,M,b,C),Qi.range(c,d,M,b,C),Qi.pattern(c,d,M,b,C),c.whitespace===!0&&Qi.whitespace(c,d,M,b,C))}g(b)}function Pte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d)&&!c.required)return g();Qi.required(c,d,M,b,C),d!==void 0&&Qi.type(c,d,M,b,C)}g(b)}function Rte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(d===""&&(d=void 0),Ir(d)&&!c.required)return g();Qi.required(c,d,M,b,C),d!==void 0&&(Qi.type(c,d,M,b,C),Qi.range(c,d,M,b,C))}g(b)}function Ite(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d)&&!c.required)return g();Qi.required(c,d,M,b,C),d!==void 0&&Qi.type(c,d,M,b,C)}g(b)}function Nte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d)&&!c.required)return g();Qi.required(c,d,M,b,C),Ir(d)||Qi.type(c,d,M,b,C)}g(b)}function Dte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d)&&!c.required)return g();Qi.required(c,d,M,b,C),d!==void 0&&(Qi.type(c,d,M,b,C),Qi.range(c,d,M,b,C))}g(b)}function Lte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d)&&!c.required)return g();Qi.required(c,d,M,b,C),d!==void 0&&(Qi.type(c,d,M,b,C),Qi.range(c,d,M,b,C))}g(b)}function Bte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(d==null&&!c.required)return g();Qi.required(c,d,M,b,C,"array"),d!=null&&(Qi.type(c,d,M,b,C),Qi.range(c,d,M,b,C))}g(b)}function $te(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d)&&!c.required)return g();Qi.required(c,d,M,b,C),d!==void 0&&Qi.type(c,d,M,b,C)}g(b)}var Ute="enum";function Vte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d)&&!c.required)return g();Qi.required(c,d,M,b,C),d!==void 0&&Qi[Ute](c,d,M,b,C)}g(b)}function Fte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d,"string")&&!c.required)return g();Qi.required(c,d,M,b,C),Ir(d,"string")||Qi.pattern(c,d,M,b,C)}g(b)}function zte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d,"date")&&!c.required)return g();if(Qi.required(c,d,M,b,C),!Ir(d,"date")){var F;d instanceof Date?F=d:F=new Date(d),Qi.type(c,F,M,b,C),F&&Qi.range(c,F.getTime(),M,b,C)}}g(b)}function Xte(c,d,g,M,C){var b=[],B=Array.isArray(d)?"array":typeof d;Qi.required(c,d,M,b,C,B),g(b)}function ST(c,d,g,M,C){var b=c.type,B=[],F=c.required||!c.required&&M.hasOwnProperty(c.field);if(F){if(Ir(d,b)&&!c.required)return g();Qi.required(c,d,M,B,C,b),Ir(d,b)||Qi.type(c,d,M,B,C)}g(B)}function Wte(c,d,g,M,C){var b=[],B=c.required||!c.required&&M.hasOwnProperty(c.field);if(B){if(Ir(d)&&!c.required)return g();Qi.required(c,d,M,b,C)}g(b)}var A0={string:kte,method:Pte,number:Rte,boolean:Ite,regexp:Nte,integer:Dte,float:Lte,array:Bte,object:$te,enum:Vte,pattern:Fte,date:zte,url:ST,hex:ST,email:ST,required:Xte,any:Wte};function CT(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var c=JSON.parse(JSON.stringify(this));return c.clone=this.clone,c}}}var TT=CT();function Uh(c){this.rules=null,this._messages=TT,this.define(c)}Uh.prototype={messages:function(c){return c&&(this._messages=ON(CT(),c)),this._messages},define:function(c){if(!c)throw new Error("Cannot configure a schema with no rules");if(typeof c!="object"||Array.isArray(c))throw new Error("Rules must be an object");this.rules={};var d,g;for(d in c)c.hasOwnProperty(d)&&(g=c[d],this.rules[d]=Array.isArray(g)?g:[g])},validate:function(c,d,g){var M=this;d===void 0&&(d={}),g===void 0&&(g=function(){});var C=c,b=d,B=g;if(typeof b=="function"&&(B=b,b={}),!this.rules||Object.keys(this.rules).length===0)return B&&B(),Promise.resolve();function F(Oe){var ue,Ne=[],jt={};function _t(Et){if(Array.isArray(Et)){var je;Ne=(je=Ne).concat.apply(je,Et)}else Ne.push(Et)}for(ue=0;ue<Oe.length;ue++)_t(Oe[ue]);Ne.length?jt=_T(Ne):(Ne=null,jt=null),B(Ne,jt)}if(b.messages){var Y=this.messages();Y===TT&&(Y=CT()),ON(Y,b.messages),b.messages=Y}else b.messages=this.messages();var G,K,fe={},Ee=b.keys||Object.keys(this.rules);Ee.forEach(function(Oe){G=M.rules[Oe],K=C[Oe],G.forEach(function(ue){var Ne=ue;typeof Ne.transform=="function"&&(C===c&&(C=kd({},C)),K=C[Oe]=Ne.transform(K)),typeof Ne=="function"?Ne={validator:Ne}:Ne=kd({},Ne),Ne.validator=M.getValidationMethod(Ne),Ne.field=Oe,Ne.fullField=Ne.fullField||Oe,Ne.type=M.getType(Ne),Ne.validator&&(fe[Oe]=fe[Oe]||[],fe[Oe].push({rule:Ne,value:K,source:C,field:Oe}))})});var Ce={};return Ste(fe,b,function(Oe,ue){var Ne=Oe.rule,jt=(Ne.type==="object"||Ne.type==="array")&&(typeof Ne.fields=="object"||typeof Ne.defaultField=="object");jt=jt&&(Ne.required||!Ne.required&&Oe.value),Ne.field=Oe.field;function _t(Le,tt){return kd({},tt,{fullField:Ne.fullField+"."+Le})}function Et(Le){Le===void 0&&(Le=[]);var tt=Le;if(Array.isArray(tt)||(tt=[tt]),!b.suppressWarning&&tt.length&&Uh.warning("async-validator:",tt),tt.length&&Ne.message!==void 0&&(tt=[].concat(Ne.message)),tt=tt.map(_N(Ne)),b.first&&tt.length)return Ce[Ne.field]=1,ue(tt);if(!jt)ue(tt);else{if(Ne.required&&!Oe.value)return Ne.message!==void 0?tt=[].concat(Ne.message).map(_N(Ne)):b.error&&(tt=[b.error(Ne,No(b.messages.required,Ne.field))]),ue(tt);var Ze={};if(Ne.defaultField)for(var ti in Oe.value)Oe.value.hasOwnProperty(ti)&&(Ze[ti]=Ne.defaultField);Ze=kd({},Ze,Oe.rule.fields);for(var ii in Ze)if(Ze.hasOwnProperty(ii)){var $t=Array.isArray(Ze[ii])?Ze[ii]:[Ze[ii]];Ze[ii]=$t.map(_t.bind(null,ii))}var Mt=new Uh(Ze);Mt.messages(b.messages),Oe.rule.options&&(Oe.rule.options.messages=b.messages,Oe.rule.options.error=b.error),Mt.validate(Oe.value,Oe.rule.options||b,function(Ft){var si=[];tt&&tt.length&&si.push.apply(si,tt),Ft&&Ft.length&&si.push.apply(si,Ft),ue(si.length?si:null)})}}var je;Ne.asyncValidator?je=Ne.asyncValidator(Ne,Oe.value,Et,Oe.source,b):Ne.validator&&(je=Ne.validator(Ne,Oe.value,Et,Oe.source,b),je===!0?Et():je===!1?Et(Ne.message||Ne.field+" fails"):je instanceof Array?Et(je):je instanceof Error&&Et(je.message)),je&&je.then&&je.then(function(){return Et()},function(Le){return Et(Le)})},function(Oe){F(Oe)})},getType:function(c){if(c.type===void 0&&c.pattern instanceof RegExp&&(c.type="pattern"),typeof c.validator!="function"&&c.type&&!A0.hasOwnProperty(c.type))throw new Error(No("Unknown rule type %s",c.type));return c.type||"string"},getValidationMethod:function(c){if(typeof c.validator=="function")return c.validator;var d=Object.keys(c),g=d.indexOf("message");return g!==-1&&d.splice(g,1),d.length===1&&d[0]==="required"?A0.required:A0[this.getType(c)]||!1}},Uh.register=function(c,d){if(typeof d!="function")throw new Error("Cannot register a validator by type, validator is not a function");A0[c]=d},Uh.warning=xte,Uh.messages=TT,Uh.validators=A0;const k0="ivu-form-item";function CN(c,d){let g=c;d=d.replace(/\[(\w+)\]/g,".$1"),d=d.replace(/^\./,"");let M=d.split("."),C=0;for(let b=M.length;C<b-1;++C){let B=M[C];if(B in g)g=g[B];else throw new Error("[View UI warn]: please transfer a valid prop path to form item!")}return{o:g,k:M[C],v:g[M[C]]}}const Gte={name:"FormItem",inject:["FormInstance"],provide(){return{FormItemInstance:this}},props:{label:{type:String,default:""},labelWidth:{type:Number},prop:{type:String},required:{type:Boolean,default:!1},rules:{type:[Object,Array]},error:{type:String},validateStatus:{type:Boolean},showMessage:{type:Boolean,default:!0},labelFor:{type:String}},data(){return{prefixCls:k0,isRequired:!1,validateState:"",validateMessage:"",validateDisabled:!1,validator:{}}},watch:{error:{handler(c){this.validateMessage=c,this.validateState=c?"error":""},immediate:!0},validateStatus(c){this.validateState=c},rules(){this.setRules()},required(c,d){this.isRequired=c,d&&!c&&this.resetField()}},computed:{classes(){return[`${k0}`,{[`${k0}-required`]:this.required||this.isRequired,[`${k0}-error`]:this.validateState==="error",[`${k0}-validating`]:this.validateState==="validating"}]},fieldValue(){const c=this.FormInstance.model;if(!c||!this.prop)return;let d=this.prop;return d.indexOf(":")!==-1&&(d=d.replace(/:/,".")),CN(c,d).v},labelStyles(){let c={};const d=this.labelWidth===0||this.labelWidth?this.labelWidth:this.FormInstance.labelWidth;return(d||d===0)&&(c.width=`${d}px`),c},contentStyles(){let c={};const d=this.labelWidth===0||this.labelWidth?this.labelWidth:this.FormInstance.labelWidth;return(d||d===0)&&(c.marginLeft=`${d}px`),c}},methods:{setRules(){let c=this.getRules();c.length&&this.required||(c.length?c.every(d=>{this.isRequired=d.required}):this.required&&(this.isRequired=this.required))},getRules(){let c=this.FormInstance.rules;const d=this.rules;return c=c?c[this.prop]:[],[].concat(d||c||[])},getFilteredRule(c){return this.getRules().filter(d=>!d.trigger||d.trigger.indexOf(c)!==-1)},validate(c,d=function(){}){let g=this.getFilteredRule(c);if(!g||g.length===0)if(this.required)g=[{required:!0}];else return d(),!0;this.validateState="validating";let M={};M[this.prop]=g;const C=new Uh(M);let b={};b[this.prop]=this.fieldValue,C.validate(b,{firstFields:!0},B=>{this.validateState=B?"error":"success",this.validateMessage=B?B[0].message:"",d(this.validateMessage),this.FormInstance&&this.FormInstance.$emit("on-validate",this.prop,!B,this.validateMessage||null)}),this.validateDisabled=!1},resetField(){this.validateState="",this.validateMessage="";let c=this.FormInstance.model,d=this.fieldValue,g=this.prop;g.indexOf(":")!==-1&&(g=g.replace(/:/,"."));let M=CN(c,g);Array.isArray(d)&&this.initialValue!==null?(this.validateDisabled=!0,M.o[M.k]=[].concat(this.initialValue)):(this.validateDisabled=!0,M.o[M.k]=this.initialValue)},onFieldBlur(){this.validate("blur")},onFieldChange(){if(this.validateDisabled){this.validateDisabled=!1;return}this.validate("change")},formBlur(){this.onFieldBlur()},formChange(){this.onFieldChange()}},mounted(){this.prop&&(this.FormInstance.addField(this),Object.defineProperty(this,"initialValue",{value:this.fieldValue}),this.setRules())},beforeUnmount(){this.FormInstance.removeField(this)}},Hte=["for"];function Qte(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[g.label||c.$slots.label?(i.openBlock(),i.createElementBlock("label",{key:0,class:i.normalizeClass([C.prefixCls+"-label"]),for:g.labelFor,style:i.normalizeStyle(b.labelStyles)},[i.renderSlot(c.$slots,"label",{},()=>[i.createTextVNode(i.toDisplayString(g.label)+i.toDisplayString(b.FormInstance.colon),1)])],14,Hte)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content"]),style:i.normalizeStyle(b.contentStyles)},[i.renderSlot(c.$slots,"default"),i.createVNode(i.Transition,{name:"fade"},{default:i.withCtx(()=>[C.validateState==="error"&&g.showMessage&&b.FormInstance.showMessage?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-error-tip"])},i.toDisplayString(C.validateMessage),3)):i.createCommentVNode("",!0)]),_:1})],6)],2)}var wx=l(Gte,[["render",Qte]]),ET={UserName:"请输入用户名！",Password:"请输入密码！",Email:"请输入邮箱！",Mobile:"请输入手机号码！",Captcha:"请输入验证码！"},P0={inject:["LoginInstance"],emits:["on-change"],props:{rules:{type:[Object,Array],default(){const c=i.getCurrentInstance().type.name;return[{required:!0,message:ET[c],trigger:"change"}]}},value:{type:String},name:{type:String,required:!0},enterToSubmit:{type:Boolean,default:!1}},data(){return{prop:""}},methods:{handleChange(c){this.LoginInstance.formValidate[this.prop]=c,this.$emit("on-change",c)},handleEnter(){this.enterToSubmit&&this.LoginInstance.handleSubmit()},handleSetValue(){const c=this.$props;c.value&&(this.LoginInstance.formValidate[this.prop]=c.value)},handleGetProps(){let c=this.$props.name;const d={prefix:this.prefix,placeholder:this.placeholder,type:this.type,size:"large",modelValue:this.LoginInstance.formValidate[this.prop]};return c&&(d.name=c),Object.assign(d,this.$attrs)}},render(){const c=this.handleGetProps(),d=i.h(ua,{...c,"onUpdate:modelValue":this.handleChange,"onOn-enter":this.handleEnter}),g=i.h(wx,{prop:this.prop,rules:this.rules},()=>[d]);return i.h("div",{class:this.className},[g])},created(){const c=this.name,d=Object.assign({},this.LoginInstance.formValidate);d[c]="",this.LoginInstance.formValidate=d,this.prop=c,this.handleSetValue()}};const TN={name:"Captcha",mixins:[P0],emits:["on-get-captcha"],props:{field:{type:[String,Array]},countDown:{type:Number,default:60},text:{type:String},unitText:{type:String,default:"秒"},beforeClick:Function},data(){return{className:"ivu-login-captcha",prefix:"ios-keypad-outline",placeholder:"请输入验证码",type:"text",buttonDisabled:!1,limitCountDown:0}},methods:{handleClickCaptcha(){if(this.field){const c=typeof this.field=="string"?[this.field]:this.field;this.LoginInstance.handleValidate(c,d=>{d&&this.handleBeforeGetCaptcha()})}else this.handleBeforeGetCaptcha()},handleBeforeGetCaptcha(){if(!this.beforeClick)return this.handleGetCaptcha();const c=this.beforeClick();c&&c.then?c.then(()=>{this.handleGetCaptcha()}):this.handleGetCaptcha()},handleGetCaptcha(){this.countDown>0&&(this.buttonDisabled=!0,this.limitCountDown=this.countDown,this.handleCountDown()),this.$emit("on-get-captcha",this.LoginInstance.formValidate[this.prop],JSON.parse(JSON.stringify(this.LoginInstance.formValidate)))},handleCountDown(){this.timer=setTimeout(()=>{this.limitCountDown--,this.limitCountDown===0?(this.buttonDisabled=!1,clearTimeout(this.timer)):this.handleCountDown()},1e3)}},render(){const c=this.$attrs,d=this.handleGetProps(),g={size:"large",type:"default",long:!0,disabled:this.buttonDisabled};"size"in c&&(g.size=c.size),"button-type"in c&&(g.type=c["button-type"]);let M;this.$slots.text?M=this.$slots.text:this.limitCountDown!==0?M=()=>`${this.limitCountDown} ${this.unitText}`:this.text?M=()=>this.text:M=()=>"获取验证码";const C=i.h(Us,{...g,onClick:this.handleClickCaptcha},M),b=i.h(ua,{...d,"onUpdate:modelValue":this.handleChange,"onOn-enter":this.handleEnter}),B=i.h(Ml,{span:16},()=>[b]),F=i.h(Ml,{span:8},()=>[C]),Y=i.h($h,{gutter:8},()=>[B,F]),G=i.h(wx,{prop:this.prop,rules:this.rules},()=>[Y]);return i.h("div",{class:this.className},[G])},beforeUnmount(){this.timer&&clearTimeout(this.timer)}},Pd="ivu-card",EN=16,jte={name:"Card",mixins:[pe],components:{Icon:S},props:{bordered:{type:Boolean,default:!0},disHover:{type:Boolean,default:!1},shadow:{type:Boolean,default:!1},padding:{type:Number,default:EN},title:{type:String},icon:{type:String}},data(){return{showHead:!0,showExtra:!0}},computed:{classes(){return[`${Pd}`,{[`${Pd}-bordered`]:this.bordered&&!this.shadow,[`${Pd}-dis-hover`]:this.disHover||this.shadow,[`${Pd}-shadow`]:this.shadow}]},headClasses(){return`${Pd}-head`},extraClasses(){return`${Pd}-extra`},bodyClasses(){return`${Pd}-body`},bodyStyles(){return this.padding!==EN?{padding:`${this.padding}px`}:""},isHrefPattern(){const{to:c}=this;return!!c},tagName(){const{isHrefPattern:c}=this;return c?"a":"div"},tagProps(){const{isHrefPattern:c}=this;if(c){const{linkUrl:d,target:g}=this;return{href:d,target:g}}else return{}}},methods:{handleClickLink(c){if(!this.isHrefPattern)return;const d=c.ctrlKey||c.metaKey;this.handleCheckClick(c,d)}},mounted(){this.showHead=this.title||this.$slots.title!==void 0,this.showExtra=this.$slots.extra!==void 0}},Yte={key:0};function qte(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createBlock(i.resolveDynamicComponent(b.tagName),i.mergeProps({class:b.classes},b.tagProps,{onClick:b.handleClickLink}),{default:i.withCtx(()=>[C.showHead?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.headClasses)},[i.renderSlot(c.$slots,"title",{},()=>[g.title?(i.openBlock(),i.createElementBlock("p",Yte,[g.icon?(i.openBlock(),i.createBlock(B,{key:0,type:g.icon},null,8,["type"])):i.createCommentVNode("",!0),i.createElementVNode("span",null,i.toDisplayString(g.title),1)])):i.createCommentVNode("",!0)])],2)):i.createCommentVNode("",!0),C.showExtra?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass(b.extraClasses)},[i.renderSlot(c.$slots,"extra")],2)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass(b.bodyClasses),style:i.normalizeStyle(b.bodyStyles)},[i.renderSlot(c.$slots,"default")],6)]),_:3},16,["class","onClick"])}var MN=l(jte,[["render",qte]]);const Lp="ivu-carousel",Zte={name:"Carousel",provide(){return{CarouselInstance:this}},components:{Icon:S},emits:["on-change","on-click","update:modelValue"],props:{arrow:{type:String,default:"hover",validator(c){return O(c,["hover","always","never"])}},autoplay:{type:Boolean,default:!1},autoplaySpeed:{type:Number,default:2e3},loop:{type:Boolean,default:!1},easing:{type:String,default:"ease"},dots:{type:String,default:"inside",validator(c){return O(c,["inside","outside","none"])}},radiusDot:{type:Boolean,default:!1},trigger:{type:String,default:"click",validator(c){return O(c,["click","hover"])}},modelValue:{type:Number,default:0},height:{type:[String,Number],default:"auto",validator(c){return c==="auto"||Object.prototype.toString.call(c)==="[object Number]"}}},data(){return{prefixCls:Lp,listWidth:0,trackWidth:0,trackOffset:0,trackCopyOffset:0,showCopyTrack:!1,slides:[],slideInstances:[],timer:null,ready:!1,currentIndex:this.modelValue,trackIndex:this.modelValue,copyTrackIndex:this.modelValue,hideTrackPos:-1,carouselItemList:[]}},computed:{classes(){return[`${Lp}`]},trackStyles(){const c=this.trackIndex===-1?"hidden":"visible";return{width:`${this.trackWidth}px`,transform:`translate3d(${-this.trackOffset}px, 0px, 0px)`,transition:`transform 500ms ${this.easing}`,visibility:c}},copyTrackStyles(){return{width:`${this.trackWidth}px`,transform:`translate3d(${-this.trackCopyOffset}px, 0px, 0px)`,transition:`transform 500ms ${this.easing}`,position:"absolute"}},arrowClasses(){return[`${Lp}-arrow`,`${Lp}-arrow-${this.arrow}`]},dotsClasses(){return[`${Lp}-dots`,`${Lp}-dots-${this.dots}`]}},methods:{findChild(c){this.carouselItemList.length&&this.carouselItemList.forEach(d=>{c(d.carouselItem)})},initCopyTrackDom(){i.nextTick(()=>{this.$refs.copyTrack.innerHTML=this.$refs.originTrack.innerHTML})},updateSlides(c){let d=[],g=1;this.findChild(M=>{d.push({$el:M.$el}),M.index=g++,c&&this.slideInstances.push(M)}),this.slides=d,this.updatePos()},updatePos(){this.findChild(c=>{c.width=this.listWidth,c.height=typeof this.height=="number"?`${this.height}px`:this.height}),this.trackWidth=(this.slides.length||0)*this.listWidth},slotChange(){i.nextTick(()=>{this.slides=[],this.slideInstances=[],this.updateSlides(!0,!0),this.updatePos(),this.updateOffset()})},handleResize(){this.listWidth=parseInt(R(this.$el,"width")),this.updatePos(),this.updateOffset()},updateTrackPos(c){this.showCopyTrack?this.trackIndex=c:this.copyTrackIndex=c},updateTrackIndex(c){this.showCopyTrack?this.copyTrackIndex=c:this.trackIndex=c,this.currentIndex=c},add(c){let d=this.slides.length;this.loop&&(c>0?this.hideTrackPos=-1:this.hideTrackPos=d,this.updateTrackPos(this.hideTrackPos));const g=this.showCopyTrack?this.copyTrackIndex:this.trackIndex;let M=g+c;for(;M<0;)M+=d;(c>0&&M===d||c<0&&M===d-1)&&this.loop?(this.showCopyTrack=!this.showCopyTrack,this.trackIndex+=c,this.copyTrackIndex+=c):(this.loop||(M=M%this.slides.length),this.updateTrackIndex(M)),this.currentIndex=M===this.slides.length?0:M,this.$emit("on-change",g,this.currentIndex),this.$emit("update:modelValue",this.currentIndex)},arrowEvent(c){this.setAutoplay(),this.add(c)},dotsEvent(c,d){let g=this.showCopyTrack?this.copyTrackIndex:this.trackIndex;const M=this.currentIndex;c===this.trigger&&g!==d&&(this.updateTrackIndex(d),this.$emit("on-change",M,this.currentIndex),this.$emit("update:modelValue",d),this.setAutoplay())},setAutoplay(){!s||(window.clearInterval(this.timer),this.autoplay&&(this.timer=window.setInterval(()=>{this.add(1)},this.autoplaySpeed)))},updateOffset(){i.nextTick(()=>{let c=this.copyTrackIndex>0?-1:1;this.trackOffset=this.trackIndex*this.listWidth,this.trackCopyOffset=this.copyTrackIndex*this.listWidth+c})},handleClick(c){this.$emit("on-click",this[c])}},watch:{autoplay(){this.setAutoplay()},autoplaySpeed(){this.setAutoplay()},trackIndex(){this.updateOffset()},copyTrackIndex(){this.updateOffset()},height(){this.updatePos()},modelValue(c){this.updateTrackIndex(c),this.setAutoplay()}},mounted(){this.updateSlides(!0),this.handleResize(),this.setAutoplay(),o(window,"resize",this.handleResize)},beforeUnmount(){a(window,"resize",this.handleResize)}},Kte=["onClick","onMouseover"];function Jte(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.createElementVNode("button",{type:"button",class:i.normalizeClass([b.arrowClasses,"left"]),onClick:d[0]||(d[0]=F=>b.arrowEvent(-1))},[i.createVNode(B,{type:"ios-arrow-back"})],2),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-list"])},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-track",C.showCopyTrack?"":"higher"]),style:i.normalizeStyle(b.trackStyles),ref:"originTrack",onClick:d[1]||(d[1]=F=>b.handleClick("currentIndex"))},[i.renderSlot(c.$slots,"default")],6),g.loop?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-track",C.showCopyTrack?"higher":""]),style:i.normalizeStyle(b.copyTrackStyles),ref:"copyTrack",onClick:d[2]||(d[2]=F=>b.handleClick("copyTrackIndex"))},null,6)):i.createCommentVNode("",!0)],2),i.createElementVNode("button",{type:"button",class:i.normalizeClass([b.arrowClasses,"right"]),onClick:d[3]||(d[3]=F=>b.arrowEvent(1))},[i.createVNode(B,{type:"ios-arrow-forward"})],2),i.createElementVNode("ul",{class:i.normalizeClass(b.dotsClasses)},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(C.slides.length,F=>(i.openBlock(),i.createElementBlock("li",{key:F,class:i.normalizeClass([F-1===C.currentIndex?C.prefixCls+"-active":""]),onClick:Y=>b.dotsEvent("click",F-1),onMouseover:Y=>b.dotsEvent("hover",F-1)},[i.createElementVNode("button",{type:"button",class:i.normalizeClass([g.radiusDot?"radius":""])},null,2)],42,Kte))),128))],2)],2)}var AN=l(Zte,[["render",Jte]]);const eie="ivu-carousel-item",tie={componentName:"carousel-item",name:"CarouselItem",inject:["CarouselInstance"],data(){return{prefixCls:eie,width:0,height:"auto",left:0,id:j(6)}},computed:{styles(){return{width:`${this.width}px`,height:`${this.height}`,left:`${this.left}px`}}},watch:{width(c){c&&this.CarouselInstance.loop&&i.nextTick(()=>{this.CarouselInstance.initCopyTrackDom()})},height(c){c&&this.CarouselInstance.loop&&i.nextTick(()=>{this.CarouselInstance.initCopyTrackDom()})}},methods:{addInstance(){const c=this.CarouselInstance;c.carouselItemList||(c.carouselItemList=[]),c.carouselItemList.push({id:this.id,carouselItem:this})},removeInstance(){const c=this.CarouselInstance;if(!c.carouselItemList)return;const d=c.carouselItemList.findIndex(g=>g.id===this.id);c.carouselItemList.splice(d,1)}},mounted(){this.addInstance(),this.CarouselInstance.slotChange()},beforeUnmount(){this.removeInstance(),this.CarouselInstance.slotChange()}};function iie(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(C.prefixCls),style:i.normalizeStyle(b.styles)},[i.renderSlot(c.$slots,"default")],6)}var kN=l(tie,[["render",iie]]);const nie={name:"Casitem",components:{Icon:S},mixins:[za],props:{data:Object,prefixCls:String,tmpItem:Object},computed:{classes(){return[`${this.prefixCls}-menu-item`,{[`${this.prefixCls}-menu-item-active`]:this.tmpItem.value===this.data.value,[`${this.prefixCls}-menu-item-disabled`]:this.data.disabled}]},showArrow(){return this.data.children&&this.data.children.length||"loading"in this.data&&!this.data.loading},showLoading(){return"loading"in this.data&&this.data.loading},arrowType(){const c=this.globalConfig;let d="ios-arrow-forward";return c&&(c.cascader.customItemArrow?d="":c.cascader.itemArrow&&(d=c.cascader.itemArrow)),d},customArrowType(){const c=this.globalConfig;let d="";return c&&c.cascader.customItemArrow&&(d=c.cascader.customItemArrow),d},arrowSize(){const c=this.globalConfig;let d="";return c&&c.cascader.itemArrowSize&&(d=c.cascader.itemArrowSize),d}}},rie={key:1,class:"ivu-icon ivu-icon-ios-loading ivu-load-loop ivu-cascader-menu-item-loading"};function sie(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(b.classes)},[i.createTextVNode(i.toDisplayString(g.data.label)+" ",1),b.showArrow?(i.openBlock(),i.createBlock(B,{key:0,type:b.arrowType,custom:b.customArrowType,size:b.arrowSize},null,8,["type","custom","size"])):i.createCommentVNode("",!0),b.showLoading?(i.openBlock(),i.createElementBlock("i",rie)):i.createCommentVNode("",!0)],2)}var oie=l(nie,[["render",sie]]);let aie=1;const lie={name:"Caspanel",components:{Casitem:oie},inject:["CascaderInstance"],provide(){return{CaspanelInstance:this}},props:{data:{type:Array,default(){return[]}},disabled:Boolean,changeOnSelect:Boolean,trigger:String,prefixCls:String},data(){return{tmpItem:{},result:[],sublist:[],id:j(6),childCaspanelList:[]}},watch:{data(){this.sublist=[]}},methods:{handleClickItem(c){this.trigger!=="click"&&c.children&&c.children.length||this.handleTriggerItem(c,!1,!0)},handleHoverItem(c){this.trigger!=="hover"||!c.children||!c.children.length||this.handleTriggerItem(c,!1,!0)},handleTriggerItem(c,d=!1,g=!1){if(c.disabled)return;const M=L(this,"Cascader");if(c.loading!==void 0&&!c.children.length&&M&&M.loadData){M.loadData(c,()=>{g&&(M.isLoadedChildren=!0),c.children.length&&this.handleTriggerItem(c)});return}const C=this.getBaseItem(c);(this.changeOnSelect||C.label!==this.tmpItem.label||C.value!==this.tmpItem.value||C.label===this.tmpItem.label&&C.value===this.tmpItem.value)&&(this.tmpItem=C,this.emitUpdate([C])),c.children&&c.children.length?(this.sublist=c.children,this.CascaderInstance.handleOnResultChange({lastValue:!1,changeOnSelect:this.changeOnSelect,fromInit:d}),this.changeOnSelect&&this.childCaspanelList.length&&this.childCaspanelList[0].caspanel.handleOnClear(!0)):(this.sublist=[],this.CascaderInstance.handleOnResultChange({lastValue:!0,changeOnSelect:this.changeOnSelect,fromInit:d})),M&&M.$refs.drop.update()},updateResult(c){this.result=[this.tmpItem].concat(c),this.emitUpdate(this.result)},getBaseItem(c){let d=Object.assign({},c);return d.children&&delete d.children,d},emitUpdate(c){this.$parent.$options.name==="Caspanel"?this.$parent.updateResult(c):this.CascaderInstance.updateResult(c)},getKey(){return aie++},handleOnFindSelected(c){let d=[...c.value];for(let g=0;g<d.length;g++)for(let M=0;M<this.data.length;M++)if(d[g]===this.data[M].value)return this.handleTriggerItem(this.data[M],!0),d.splice(0,1),i.nextTick(()=>{this.childCaspanelList.length&&this.childCaspanelList[0].caspanel.handleOnFindSelected({value:d})}),!1},handleOnClear(c=!1){this.sublist=[],this.tmpItem={},c&&this.childCaspanelList.length&&this.childCaspanelList[0].caspanel.handleOnClear(!0)},addCaspanel(){const c=this.CascaderInstance;c.caspanelList||(c.caspanelList=[]),c.caspanelList.push({id:this.id,caspanel:this});const d=L(this,"Caspanel");d&&(d.childCaspanelList||(d.childCaspanelList=[]),d.childCaspanelList.push({id:this.id,caspanel:this}))},removeCaspanel(){const c=this.CascaderInstance;if(c.caspanelList&&c.caspanelList.length){const g=c.caspanelList.findIndex(M=>M.id===this.id);c.caspanelList.splice(g,1)}const d=L(this,"Caspanel");if(d&&d.childCaspanelList&&d.childCaspanelList.length){const g=d.childCaspanelList.findIndex(M=>M.id===this.id);d.childCaspanelList.splice(g,1)}}},mounted(){this.addCaspanel()},beforeUnmount(){this.removeCaspanel()}};function cie(c,d,g,M,C,b){const B=i.resolveComponent("Casitem"),F=i.resolveComponent("Caspanel",!0);return i.openBlock(),i.createElementBlock("span",null,[g.data&&g.data.length?(i.openBlock(),i.createElementBlock("ul",{key:0,class:i.normalizeClass([g.prefixCls+"-menu"])},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.data,(Y,G)=>(i.openBlock(),i.createBlock(B,{key:G,"prefix-cls":g.prefixCls,data:Y,"tmp-item":C.tmpItem,onClick:i.withModifiers(K=>b.handleClickItem(Y),["stop"]),onMouseenter:i.withModifiers(K=>b.handleHoverItem(Y),["stop"])},null,8,["prefix-cls","data","tmp-item","onClick","onMouseenter"]))),128))],2)):i.createCommentVNode("",!0),C.sublist&&C.sublist.length?(i.openBlock(),i.createBlock(F,{key:1,"prefix-cls":g.prefixCls,data:C.sublist,disabled:g.disabled,trigger:g.trigger,"change-on-select":g.changeOnSelect},null,8,["prefix-cls","data","disabled","trigger","change-on-select"])):i.createCommentVNode("",!0)])}var hie=l(lie,[["render",cie]]),MT={beforeMount(c,d,g){function M(C){if(c.contains(C.target))return!1;d.value(C)}c.__vueClickOutside__=M,s&&document.addEventListener("click",M)},unmounted(c,d){s&&document.removeEventListener("click",c.__vueClickOutside__),delete c.__vueClickOutside__}};const Vh="ivu-cascader",uie="ivu-select",die={name:"Cascader",mixins:[gn,Ei,za],components:{iInput:ua,Drop:Ye,Icon:S,Caspanel:hie},directives:{clickOutside:MT},emits:["on-change","on-visible-change","update:modelValue"],provide(){return{CascaderInstance:this}},props:{data:{type:Array,default(){return[]}},modelValue:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},placeholder:{type:String},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},trigger:{validator(c){return O(c,["click","hover"])},default:"click"},changeOnSelect:{type:Boolean,default:!1},renderFormat:{type:Function,default(c){return c.join(" / ")}},loadData:{type:Function},filterable:{type:Boolean,default:!1},notFoundText:{type:String},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},capture:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},transferClassName:{type:String},eventsEnabled:{type:Boolean,default:!1}},data(){return{prefixCls:Vh,selectPrefixCls:uie,visible:!1,selected:[],tmpSelected:[],updatingValue:!1,currentValue:this.modelValue||[],query:"",validDataStr:"",isLoadedChildren:!1,isValueNull:!1,caspanelList:[]}},computed:{classes(){return[`${Vh}`,{[`${Vh}-show-clear`]:this.showCloseIcon,[`${Vh}-size-${this.size}`]:!!this.size,[`${Vh}-visible`]:this.visible,[`${Vh}-disabled`]:this.itemDisabled,[`${Vh}-not-found`]:this.filterable&&this.query!==""&&!this.querySelections.length}]},showCloseIcon(){return this.currentValue&&this.currentValue.length&&this.clearable&&!this.itemDisabled},displayRender(){let c=[];for(let d=0;d<this.selected.length;d++)c.push(this.selected[d].label);return this.renderFormat(c,this.selected)},displayInputRender(){return this.filterable?"":this.displayRender},localePlaceholder(){return this.placeholder===void 0?this.t("i.select.placeholder"):this.placeholder},inputPlaceholder(){return this.filterable&&this.currentValue.length?null:this.localePlaceholder},localeNotFoundText(){return this.notFoundText===void 0?this.t("i.select.noMatch"):this.notFoundText},querySelections(){let c=[];function d(g,M,C){const b=$(g);for(let B=0;B<b.length;B++){let F=b[B];F.__label=M?M+" / "+F.label:F.label,F.__value=C?C+","+F.value:F.value,F.children&&F.children.length?(d(F.children,F.__label,F.__value),delete F.__label,delete F.__value):c.push({label:F.__label,value:F.__value,display:F.__label,item:F,disabled:!!F.disabled})}}return d(this.data),c=c.filter(g=>g.label?g.label.indexOf(this.query)>-1:!1).map(g=>(g.display=g.display.replace(new RegExp(this.query,"g"),`<span>${this.query}</span>`),g)),c},arrowType(){const c=this.globalConfig;let d="ios-arrow-down";return c&&(c.cascader.customArrow?d="":c.cascader.arrow&&(d=c.cascader.arrow)),d},customArrowType(){const c=this.globalConfig;let d="";return c&&c.cascader.customArrow&&(d=c.cascader.customArrow),d},arrowSize(){const c=this.globalConfig;let d="";return c&&c.cascader.arrowSize&&(d=c.cascader.arrowSize),d},dropdownCls(){return{[Vh+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}}},methods:{clearSelect(){if(this.itemDisabled)return!1;const c=JSON.stringify(this.currentValue);this.currentValue=this.selected=this.tmpSelected=[],this.handleClose(),this.emitValue(this.currentValue,c),this.caspanelList.forEach(d=>{d.caspanel.handleOnClear()})},handleClose(){this.visible=!1},toggleOpen(){if(this.itemDisabled)return!1;this.visible?this.filterable||this.handleClose():this.onFocus()},onFocus(){this.visible=!0,this.currentValue.length||this.caspanelList.forEach(c=>{c.caspanel.handleOnClear()})},updateResult(c){this.tmpSelected=c},updateSelected(c=!1,d=!1){(!this.changeOnSelect||c||d)&&this.caspanelList.forEach(g=>{g.caspanel.handleOnFindSelected({value:this.currentValue})})},emitValue(c,d){JSON.stringify(c)!==d&&(this.$emit("on-change",this.currentValue,JSON.parse(JSON.stringify(this.selected))),i.nextTick(()=>{this.handleFormItemChange("change",{value:this.currentValue,selected:JSON.parse(JSON.stringify(this.selected))})}))},handleInput(c){this.query=c.target.value},handleSelectItem(c){const d=this.querySelections[c];if(d.item.disabled)return!1;this.query="",this.$refs.input.currentValue="";const g=JSON.stringify(this.currentValue);this.currentValue=d.value.split(","),setTimeout(()=>{this.emitValue(this.currentValue,g),this.handleClose()},0)},handleFocus(){this.$refs.input.focus()},getValidData(c){const d=$(c);function g(M){const C=Object.assign({},M);return"loading"in C&&delete C.loading,"__value"in C&&delete C.__value,"__label"in C&&delete C.__label,"children"in C&&C.children.length&&(C.children=C.children.map(b=>g(b))),C}return d.map(M=>g(M))},handleOnResultChange(c){const d=c.lastValue,g=c.changeOnSelect,M=c.fromInit;if(d||g){const C=JSON.stringify(this.currentValue);this.selected=this.tmpSelected;let b=[];this.selected.forEach(B=>{b.push(B.value)}),M||(this.updatingValue=!0,this.currentValue=b,this.emitValue(this.currentValue,C))}d&&!M&&this.handleClose()}},created(){this.validDataStr=JSON.stringify(this.getValidData(this.data))},mounted(){this.updateSelected(!0)},watch:{visible(c){c?(this.currentValue.length&&this.updateSelected(),this.transfer&&this.$refs.drop.update(),this.$refs.drop.handleOnUpdatePopper()):(this.filterable&&(this.query="",this.$refs.input.currentValue=""),this.transfer&&this.$refs.drop.destroy(),this.$refs.drop.handleOnDestroyPopper()),this.$emit("on-visible-change",c)},modelValue(c){c===null&&(this.isValueNull=!0),this.currentValue=c||[],(c===null||!c.length)&&(this.selected=[])},currentValue(){if(this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",this.currentValue),this.updatingValue){this.updatingValue=!1;return}this.updateSelected(!0)},data:{deep:!0,handler(){const c=JSON.stringify(this.getValidData(this.data));c!==this.validDataStr&&(this.validDataStr=c,this.isLoadedChildren||i.nextTick(()=>this.updateSelected(!1,this.changeOnSelect)),this.isLoadedChildren=!1)}}}},fie=["name","value"],pie=["onClick","innerHTML"];function mie(c,d,g,M,C,b){const B=i.resolveComponent("i-input"),F=i.resolveComponent("Icon"),Y=i.resolveComponent("Caspanel"),G=i.resolveComponent("Drop"),K=i.resolveDirective("click-outside");return i.withDirectives((i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-rel"]),onClick:d[1]||(d[1]=(...fe)=>b.toggleOpen&&b.toggleOpen(...fe)),ref:"reference"},[i.createElementVNode("input",{type:"hidden",name:g.name,value:C.currentValue},null,8,fie),i.renderSlot(c.$slots,"default",{},()=>[i.createVNode(B,{"element-id":g.elementId,ref:"input",readonly:!g.filterable,disabled:c.itemDisabled,modelValue:b.displayInputRender,onOnChange:b.handleInput,size:g.size,placeholder:b.inputPlaceholder},null,8,["element-id","readonly","disabled","modelValue","onOnChange","size","placeholder"]),i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-label"]),onClick:d[0]||(d[0]=(...fe)=>b.handleFocus&&b.handleFocus(...fe))},i.toDisplayString(b.displayRender),3),[[i.vShow,g.filterable&&C.query===""]]),i.withDirectives(i.createVNode(F,{type:"ios-close-circle",class:i.normalizeClass([C.prefixCls+"-arrow"]),onClick:i.withModifiers(b.clearSelect,["stop"])},null,8,["class","onClick"]),[[i.vShow,b.showCloseIcon]]),i.createVNode(F,{type:b.arrowType,custom:b.customArrowType,size:b.arrowSize,class:i.normalizeClass([C.prefixCls+"-arrow"])},null,8,["type","custom","size","class"])])],2),i.createVNode(G,{ref:"drop",visible:C.visible,classes:b.dropdownCls,eventsEnabled:g.eventsEnabled,"transition-name":"transition-drop",transfer:g.transfer},{default:i.withCtx(()=>[i.createElementVNode("div",null,[i.withDirectives(i.createVNode(Y,{ref:"caspanel","prefix-cls":C.prefixCls,data:g.data,disabled:c.itemDisabled,"change-on-select":g.changeOnSelect,trigger:g.trigger},null,8,["prefix-cls","data","disabled","change-on-select","trigger"]),[[i.vShow,!g.filterable||g.filterable&&C.query===""]]),i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-dropdown"])},[i.createElementVNode("ul",{class:i.normalizeClass([C.selectPrefixCls+"-dropdown-list"])},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.querySelections,(fe,Ee)=>(i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass([C.selectPrefixCls+"-item",{[C.selectPrefixCls+"-item-disabled"]:fe.disabled}]),key:Ee,onClick:Ce=>b.handleSelectItem(Ee),innerHTML:fe.display},null,10,pie))),128))],2)],2),[[i.vShow,g.filterable&&C.query!==""&&b.querySelections.length]]),i.withDirectives(i.createElementVNode("ul",{class:i.normalizeClass([C.prefixCls+"-not-found-tip"])},[i.createElementVNode("li",null,i.toDisplayString(b.localeNotFoundText),1)],2),[[i.vShow,g.filterable&&C.query!==""&&!b.querySelections.length||!g.data.length]])])]),_:1},8,["visible","classes","eventsEnabled","transfer"])],2)),[[K,b.handleClose]])}var PN=l(die,[["render",mie]]);const gie={name:"CellItem",props:{title:{type:String,default:""},label:{type:String,default:""},extra:{type:String,default:""}}},vie={class:"ivu-cell-item"},yie={class:"ivu-cell-icon"},bie={class:"ivu-cell-main"},xie={class:"ivu-cell-title"},wie={class:"ivu-cell-label"},_ie={class:"ivu-cell-footer"},Oie={class:"ivu-cell-extra"};function Sie(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",vie,[i.createElementVNode("div",yie,[i.renderSlot(c.$slots,"icon")]),i.createElementVNode("div",bie,[i.createElementVNode("div",xie,[i.renderSlot(c.$slots,"default",{},()=>[i.createTextVNode(i.toDisplayString(g.title),1)])]),i.createElementVNode("div",wie,[i.renderSlot(c.$slots,"label",{},()=>[i.createTextVNode(i.toDisplayString(g.label),1)])])]),i.createElementVNode("div",_ie,[i.createElementVNode("span",Oie,[i.renderSlot(c.$slots,"extra",{},()=>[i.createTextVNode(i.toDisplayString(g.extra),1)])])])])}var Cie=l(gie,[["render",Sie]]);const R0="ivu-cell",Tie={name:"Cell",inject:["CellGroupInstance"],mixins:[pe,za],components:{CellItem:Cie,Icon:S},props:{name:{type:[String,Number]},title:{type:String,default:""},label:{type:String,default:""},extra:{type:String,default:""},disabled:{type:Boolean,default:!1},selected:{type:Boolean,default:!1}},data(){return{prefixCls:R0}},computed:{classes(){return[`${R0}`,{[`${R0}-disabled`]:this.disabled,[`${R0}-selected`]:this.selected,[`${R0}-with-link`]:this.to}]},arrowType(){const c=this.globalConfig;let d="ios-arrow-forward";return c&&(c.cell.customArrow?d="":c.cell.arrow&&(d=c.cell.arrow)),d},customArrowType(){const c=this.globalConfig;let d="";return c&&c.cell.customArrow&&(d=c.cell.customArrow),d},arrowSize(){const c=this.globalConfig;let d="";return c&&c.cell.arrowSize&&(d=c.cell.arrowSize),d}},methods:{handleClickItem(c,d){this.CellGroupInstance.handleClick(this.name),this.handleCheckClick(c,d)}}},Eie=["href","target"],Mie={key:2,class:"ivu-cell-arrow"};function Aie(c,d,g,M,C,b){const B=i.resolveComponent("CellItem"),F=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[c.to?(i.openBlock(),i.createElementBlock("a",{key:0,href:c.linkUrl,target:c.target,class:"ivu-cell-link",onClick:[d[0]||(d[0]=i.withModifiers(Y=>b.handleClickItem(Y,!1),["exact"])),d[1]||(d[1]=i.withModifiers(Y=>b.handleClickItem(Y,!0),["ctrl"])),d[2]||(d[2]=i.withModifiers(Y=>b.handleClickItem(Y,!0),["meta"]))]},[i.createVNode(B,{title:g.title,label:g.label,extra:g.extra},{icon:i.withCtx(()=>[i.renderSlot(c.$slots,"icon")]),default:i.withCtx(()=>[i.renderSlot(c.$slots,"default")]),extra:i.withCtx(()=>[i.renderSlot(c.$slots,"extra")]),label:i.withCtx(()=>[i.renderSlot(c.$slots,"label")]),_:3},8,["title","label","extra"])],8,Eie)):(i.openBlock(),i.createElementBlock("div",{key:1,class:"ivu-cell-link",onClick:d[3]||(d[3]=(...Y)=>b.handleClickItem&&b.handleClickItem(...Y))},[i.createVNode(B,{title:g.title,label:g.label,extra:g.extra},{icon:i.withCtx(()=>[i.renderSlot(c.$slots,"icon")]),default:i.withCtx(()=>[i.renderSlot(c.$slots,"default")]),extra:i.withCtx(()=>[i.renderSlot(c.$slots,"extra")]),label:i.withCtx(()=>[i.renderSlot(c.$slots,"label")]),_:3},8,["title","label","extra"])])),c.to?(i.openBlock(),i.createElementBlock("div",Mie,[i.renderSlot(c.$slots,"arrow",{},()=>[i.createVNode(F,{type:b.arrowType,custom:b.customArrowType,size:b.arrowSize},null,8,["type","custom","size"])])])):i.createCommentVNode("",!0)],2)}var RN=l(Tie,[["render",Aie]]);const kie={name:"CellGroup",emits:["on-click"],provide(){return{CellGroupInstance:this}},methods:{handleClick(c){this.$emit("on-click",c)}}},Pie={class:"ivu-cell-group"};function Rie(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",Pie,[i.renderSlot(c.$slots,"default")])}var IN=l(kie,[["render",Rie]]);const Do="ivu-checkbox",Iie={name:"Checkbox",mixins:[Ei],emits:["update:modelValue","on-change"],inject:{CheckboxGroupInstance:{default:null}},props:{disabled:{type:Boolean,default:!1},modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},label:{type:[String,Number,Boolean]},indeterminate:{type:Boolean,default:!1},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},name:{type:String},border:{type:Boolean,default:!1}},data(){return{showSlot:!0,focusInner:!1,model:[]}},computed:{wrapClasses(){return[`${Do}-wrapper`,{[`${Do}-group-item`]:this.group,[`${Do}-wrapper-checked`]:this.currentValue,[`${Do}-wrapper-disabled`]:this.itemDisabled,[`${Do}-${this.size}`]:!!this.size,[`${Do}-border`]:this.border}]},checkboxClasses(){return[`${Do}`,{[`${Do}-checked`]:this.currentValue,[`${Do}-disabled`]:this.itemDisabled,[`${Do}-indeterminate`]:this.indeterminate}]},innerClasses(){return[`${Do}-inner`,{[`${Do}-focus`]:this.focusInner}]},inputClasses(){return`${Do}-input`},currentValue(){return this.CheckboxGroupInstance?this.CheckboxGroupInstance.modelValue.indexOf(this.label)>=0:this.modelValue===this.trueValue},group(){return!!this.CheckboxGroupInstance}},mounted(){this.CheckboxGroupInstance||(this.showSlot=this.$slots.default!==void 0)},methods:{change(c){if(this.itemDisabled)return!1;const d=c.target.checked?this.trueValue:this.falseValue;this.$emit("update:modelValue",d),this.group?this.CheckboxGroupInstance.change(this.model):(this.$emit("on-change",d),this.handleFormItemChange("change",d))},onBlur(){this.focusInner=!1},onFocus(){this.focusInner=!0}},watch:{modelValue(c){if(!(c===this.trueValue||c===this.falseValue))throw"Value should be trueValue or falseValue."},"CheckboxGroupInstance.modelValue":{handler(c){this.model=c||[]},immediate:!0}}},Nie=["disabled","value","name"],Die=["disabled","checked","name"],Lie={key:0,class:"ivu-checkbox-label-text"};function Bie(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("label",{class:i.normalizeClass(b.wrapClasses)},[i.createElementVNode("span",{class:i.normalizeClass(b.checkboxClasses)},[i.createElementVNode("span",{class:i.normalizeClass(b.innerClasses)},null,2),b.group?i.withDirectives((i.openBlock(),i.createElementBlock("input",{key:0,type:"checkbox",class:i.normalizeClass(b.inputClasses),disabled:c.itemDisabled,value:g.label,"onUpdate:modelValue":d[0]||(d[0]=B=>C.model=B),name:g.name,onChange:d[1]||(d[1]=(...B)=>b.change&&b.change(...B)),onFocus:d[2]||(d[2]=(...B)=>b.onFocus&&b.onFocus(...B)),onBlur:d[3]||(d[3]=(...B)=>b.onBlur&&b.onBlur(...B))},null,42,Nie)),[[i.vModelCheckbox,C.model]]):(i.openBlock(),i.createElementBlock("input",{key:1,type:"checkbox",class:i.normalizeClass(b.inputClasses),disabled:c.itemDisabled,checked:b.currentValue,name:g.name,onChange:d[4]||(d[4]=(...B)=>b.change&&b.change(...B)),onFocus:d[5]||(d[5]=(...B)=>b.onFocus&&b.onFocus(...B)),onBlur:d[6]||(d[6]=(...B)=>b.onBlur&&b.onBlur(...B))},null,42,Die))],2),C.showSlot?(i.openBlock(),i.createElementBlock("span",Lie,[i.renderSlot(c.$slots,"default",{},()=>[i.createTextVNode(i.toDisplayString(g.label),1)])])):i.createCommentVNode("",!0)],2)}var Bp=l(Iie,[["render",Bie]]);const $ie="ivu-checkbox-group",Uie={name:"CheckboxGroup",mixins:[Ei],emits:["update:modelValue","on-change"],provide(){return{CheckboxGroupInstance:this}},props:{modelValue:{type:Array,default(){return[]}},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}}},data(){return{currentValue:this.modelValue||[],children:[]}},computed:{classes(){return[`${$ie}`,{[`ivu-checkbox-${this.size}`]:!!this.size}]}},methods:{change(c){this.currentValue=c,this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c)}}};function Vie(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.renderSlot(c.$slots,"default")],2)}var AT=l(Uie,[["render",Vie]]);const NN="ivu-chart-circle",Fie={name:"iCircle",props:{percent:{type:Number,default:0},size:{type:Number,default:120},strokeWidth:{type:Number,default:6},strokeColor:{type:[String,Array],default:"#2d8cf0"},strokeLinecap:{validator(c){return O(c,["square","round"])},default:"round"},trailWidth:{type:Number,default:5},trailColor:{type:String,default:"#eaeef2"},dashboard:{type:Boolean,default:!1}},data(){return{id:`ivu-chart-circle-${j(3)}`}},computed:{circleSize(){return{width:`${this.size}px`,height:`${this.size}px`}},computedStrokeWidth(){return this.percent===0&&this.dashboard?0:this.strokeWidth},radius(){return 50-this.strokeWidth/2},pathString(){return this.dashboard?`M 50,50 m 0,${this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,-${2*this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,${2*this.radius}`:`M 50,50 m 0,-${this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,${2*this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,-${2*this.radius}`},len(){return Math.PI*2*this.radius},trailStyle(){let c={};return this.dashboard&&(c={"stroke-dasharray":`${this.len-75}px ${this.len}px`,"stroke-dashoffset":`-${75/2}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s"}),c},pathStyle(){let c={};return this.dashboard?c={"stroke-dasharray":`${this.percent/100*(this.len-75)}px ${this.len}px`,"stroke-dashoffset":`-${75/2}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .6s ease 0s, stroke .6s, stroke-width .06s ease .6s"}:c={"stroke-dasharray":`${this.len}px ${this.len}px`,"stroke-dashoffset":`${(100-this.percent)/100*this.len}px`,transition:"stroke-dashoffset 0.6s ease 0s, stroke 0.6s ease"},c},wrapClasses(){return`${NN}`},innerClasses(){return`${NN}-inner`},strokeValue(){let c=this.strokeColor;return typeof this.strokeColor!="string"&&(c=`url(#${this.id})`),c},showDefs(){return typeof this.strokeColor!="string"}}},zie={viewBox:"0 0 100 100"},Xie={key:0},Wie=["id"],Gie=["stop-color"],Hie=["stop-color"],Qie=["d","stroke","stroke-width","stroke-linecap"],jie=["d","stroke-linecap","stroke","stroke-width"];function Yie(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{style:i.normalizeStyle(b.circleSize),class:i.normalizeClass(b.wrapClasses)},[(i.openBlock(),i.createElementBlock("svg",zie,[b.showDefs?(i.openBlock(),i.createElementBlock("defs",Xie,[i.createElementVNode("linearGradient",{id:C.id,x1:"100%",y1:"0%",x2:"0%",y2:"0%"},[i.createElementVNode("stop",{offset:"0%","stop-color":g.strokeColor[0]},null,8,Gie),i.createElementVNode("stop",{offset:"100%","stop-color":g.strokeColor[1]},null,8,Hie)],8,Wie)])):i.createCommentVNode("",!0),i.createElementVNode("path",{d:b.pathString,stroke:g.trailColor,"stroke-width":g.trailWidth,"fill-opacity":0,style:i.normalizeStyle(b.trailStyle),"stroke-linecap":g.strokeLinecap},null,12,Qie),i.createElementVNode("path",{d:b.pathString,"stroke-linecap":g.strokeLinecap,stroke:b.strokeValue,"stroke-width":b.computedStrokeWidth,"fill-opacity":"0",style:i.normalizeStyle(b.pathStyle)},null,12,jie)])),i.createElementVNode("div",{class:i.normalizeClass(b.innerClasses)},[i.renderSlot(c.$slots,"default")],2)],6)}var _x=l(Fie,[["render",Yie]]);const Ox="ivu-dropdown",qie={name:"Dropdown",directives:{clickOutside:MT},components:{Drop:Ye},emits:["on-visible-change","on-clickoutside","on-click","on-hover-click","on-haschild-click"],props:{trigger:{validator(c){return O(c,["click","hover","custom","contextMenu"])},default:"hover"},placement:{validator(c){return O(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},visible:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},transferClassName:{type:String},stopPropagation:{type:Boolean,default:!1},capture:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},eventsEnabled:{type:Boolean,default:!1},boundariesElement:{default:"window"}},computed:{transition(){return["bottom-start","bottom","bottom-end"].indexOf(this.placement)>-1?"slide-up":"fade"},dropdownCls(){return{[Ox+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}},relClasses(){return[`${Ox}-rel`,{[`${Ox}-rel-user-select-none`]:this.trigger==="contextMenu"}]}},data(){return{prefixCls:Ox,currentVisible:this.visible,timeout:null}},watch:{visible(c){this.currentVisible=c},currentVisible(c){c?this.$refs.drop.update():this.$refs.drop.destroy(),this.$emit("on-visible-change",c)}},methods:{handleClick(){if(this.trigger==="custom"||this.trigger!=="click")return!1;this.hasParent()||(this.currentVisible=!this.currentVisible)},handleRightClick(){if(this.trigger==="custom"||this.trigger!=="contextMenu")return!1;this.currentVisible=!this.currentVisible},handleMouseenter(){if(this.trigger==="custom"||this.trigger!=="hover")return!1;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.currentVisible=!0},250)},handleMouseleave(){if(this.trigger==="custom"||this.trigger!=="hover")return!1;this.timeout&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.currentVisible=!1},150))},onClickoutside(c){this.handleClose(),this.handleRightClose(),this.currentVisible&&this.$emit("on-clickoutside",c)},handleClose(){if(this.trigger==="custom"||this.trigger!=="click")return!1;this.currentVisible=!1},handleRightClose(){if(this.trigger==="custom"||this.trigger!=="contextMenu")return!1;this.currentVisible=!1},hasParent(){return L(this,"Dropdown")||!1},handleHaschildClick(){i.nextTick(()=>{if(this.trigger==="custom")return!1;this.currentVisible=!0});const c=this.hasParent();c&&c.handleHaschildClick()},handleItemClick(c){if(this.stopPropagation)return;const d=this.hasParent();d?d.handleItemClick(c):this.$emit("on-click",c)},handleHoverClick(){const c=this.hasParent();c?(i.nextTick(()=>{if(this.trigger==="custom")return!1;this.currentVisible=!1}),c.handleHoverClick()):i.nextTick(()=>{if(this.trigger==="custom")return!1;this.currentVisible=!1})}}};function Zie(c,d,g,M,C,b){const B=i.resolveComponent("Drop"),F=i.resolveDirective("click-outside");return i.withDirectives((i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([C.prefixCls]),onMouseenter:d[2]||(d[2]=(...Y)=>b.handleMouseenter&&b.handleMouseenter(...Y)),onMouseleave:d[3]||(d[3]=(...Y)=>b.handleMouseleave&&b.handleMouseleave(...Y))},[i.createElementVNode("div",{class:i.normalizeClass(b.relClasses),ref:"reference",onClick:d[0]||(d[0]=(...Y)=>b.handleClick&&b.handleClick(...Y)),onContextmenu:d[1]||(d[1]=i.withModifiers((...Y)=>b.handleRightClick&&b.handleRightClick(...Y),["prevent"]))},[i.renderSlot(c.$slots,"default")],34),i.createVNode(B,{ref:"drop",visible:C.currentVisible,classes:b.dropdownCls,placement:g.placement,eventsEnabled:g.eventsEnabled,boundariesElement:g.boundariesElement,transfer:g.transfer,"transition-name":"transition-drop",onMouseenter:b.handleMouseenter,onMouseleave:b.handleMouseleave},{default:i.withCtx(()=>[i.renderSlot(c.$slots,"list")]),_:3},8,["visible","classes","placement","eventsEnabled","boundariesElement","transfer","onMouseenter","onMouseleave"])],34)),[[F,b.onClickoutside]])}var Rd=l(qie,[["render",Zie]]);const Kie={name:"DropdownMenu"},Jie={class:"ivu-dropdown-menu"};function ene(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("ul",Jie,[i.renderSlot(c.$slots,"default")])}var Id=l(Kie,[["render",ene]]);const da="ivu-tag",Ec=["default","primary","success","warning","error","blue","green","red","yellow","pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],tne=["pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],ine={name:"Tag",components:{Icon:S},emits:["on-change","on-close"],props:{closable:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},checked:{type:Boolean,default:!0},color:{type:String,default:"default"},type:{validator(c){return O(c,["border","dot"])}},name:{type:[String,Number]},size:{validator(c){return O(c,["default","medium","large"])},default:"default"}},data(){return{isChecked:this.checked}},computed:{classes(){return[`${da}`,`${da}-size-${this.size}`,{[`${da}-${this.color}`]:!!this.color&&O(this.color,Ec),[`${da}-${this.type}`]:!!this.type,[`${da}-closable`]:this.closable,[`${da}-checked`]:this.isChecked,[`${da}-checkable`]:this.checkable}]},wraperStyles(){return O(this.color,Ec)?{}:{background:this.isChecked?this.defaultTypeColor:"transparent",borderWidth:"1px",borderStyle:"solid",borderColor:this.type!=="dot"&&this.type!=="border"&&this.isChecked?this.borderColor:this.lineColor,color:this.lineColor}},textClasses(){return[`${da}-text`,this.type==="border"&&O(this.color,Ec)?`${da}-color-${this.color}`:"",this.type!=="dot"&&this.type!=="border"&&this.color!=="default"&&this.isChecked&&tne.indexOf(this.color)<0?`${da}-color-white`:""]},dotClasses(){return`${da}-dot-inner`},iconClass(){return this.type==="dot"?"":this.type==="border"?O(this.color,Ec)?`${da}-color-${this.color}`:"":this.color!==void 0?this.color==="default"?"":"rgb(255, 255, 255)":""},showDot(){return!!this.type&&this.type==="dot"},lineColor(){return this.type==="dot"?"":this.type==="border"?this.color!==void 0?O(this.color,Ec)?"":this.color:"":this.color!==void 0?this.color==="default"?"":"rgb(255, 255, 255)":""},borderColor(){return this.color!==void 0?this.color==="default"?"":this.color:""},dotColor(){return this.color!==void 0?O(this.color,Ec)?"":this.color:""},textColorStyle(){return O(this.color,Ec)?{}:this.type!=="dot"&&this.type!=="border"?this.isChecked?{color:this.lineColor}:{}:{color:this.lineColor}},bgColorStyle(){return O(this.color,Ec)?{}:{background:this.dotColor}},defaultTypeColor(){return this.type!=="dot"&&this.type!=="border"&&this.color!==void 0?O(this.color,Ec)?"":this.color:""}},methods:{close(c){this.name===void 0?this.$emit("on-close",c):this.$emit("on-close",c,this.name)},check(){if(!this.checkable)return;const c=!this.isChecked;this.isChecked=c,this.name===void 0?this.$emit("on-change",c):this.$emit("on-change",c,this.name)}},watch:{checked(c){this.isChecked=c}}};function nne(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),onClick:d[0]||(d[0]=i.withModifiers((...F)=>b.check&&b.check(...F),["stop"])),style:i.normalizeStyle(b.wraperStyles)},[b.showDot?(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass(b.dotClasses),style:i.normalizeStyle(b.bgColorStyle)},null,6)):i.createCommentVNode("",!0),i.createElementVNode("span",{class:i.normalizeClass(b.textClasses),style:i.normalizeStyle(b.textColorStyle)},[i.renderSlot(c.$slots,"default")],6),g.closable?(i.openBlock(),i.createBlock(B,{key:1,class:i.normalizeClass(b.iconClass),color:b.lineColor,type:"ios-close",onClick:i.withModifiers(b.close,["stop"])},null,8,["class","color","onClick"])):i.createCommentVNode("",!0)],6)}var $p=l(ine,[["render",nne]]),DN={11e4:{l:"Z1",n:"北京",c:"110000",p:"86"},12e4:{l:"Z1",n:"天津",c:"120000",p:"86"},13e4:{l:"H",n:"河北",c:"130000",p:"86"},14e4:{l:"S",n:"山西",c:"140000",p:"86"},15e4:{l:"N",n:"内蒙古",c:"150000",p:"86"},21e4:{l:"L",n:"辽宁",c:"210000",p:"86"},22e4:{l:"J",n:"吉林",c:"220000",p:"86"},23e4:{l:"H",n:"黑龙江",c:"230000",p:"86"},31e4:{l:"Z1",n:"上海",c:"310000",p:"86"},32e4:{l:"J",n:"江苏",c:"320000",p:"86"},33e4:{l:"Z",n:"浙江",c:"330000",p:"86"},34e4:{l:"A",n:"安徽",c:"340000",p:"86"},35e4:{l:"F",n:"福建",c:"350000",p:"86"},36e4:{l:"J",n:"江西",c:"360000",p:"86"},37e4:{l:"S",n:"山东",c:"370000",p:"86"},41e4:{l:"H",n:"河南",c:"410000",p:"86"},42e4:{l:"H",n:"湖北",c:"420000",p:"86"},43e4:{l:"H",n:"湖南",c:"430000",p:"86"},44e4:{l:"G",n:"广东",c:"440000",p:"86"},45e4:{l:"G",n:"广西",c:"450000",p:"86"},46e4:{l:"H",n:"海南",c:"460000",p:"86"},5e5:{l:"Z1",n:"重庆",c:"500000",p:"86"},51e4:{l:"S",n:"四川",c:"510000",p:"86"},52e4:{l:"G",n:"贵州",c:"520000",p:"86"},53e4:{l:"Y",n:"云南",c:"530000",p:"86"},54e4:{l:"X",n:"西藏",c:"540000",p:"86"},61e4:{l:"S",n:"陕西",c:"610000",p:"86"},62e4:{l:"G",n:"甘肃",c:"620000",p:"86"},63e4:{l:"Q",n:"青海",c:"630000",p:"86"},64e4:{l:"N",n:"宁夏",c:"640000",p:"86"},65e4:{l:"X",n:"新疆",c:"650000",p:"86"},71e4:{l:"T",n:"台湾",c:"710000",p:"86"},81e4:{l:"Z2",n:"香港",c:"810000",p:"86"},82e4:{l:"Z2",n:"澳门",c:"820000",p:"86"}},Up={11e4:{l:"B",n:"北京市",c:"110000",p:"86"},12e4:{l:"T",n:"天津市",c:"120000",p:"86"},130100:{l:"S",n:"石家庄市",c:"130100",p:"130000"},130200:{l:"T",n:"唐山市",c:"130200",p:"130000"},130300:{l:"Q",n:"秦皇岛市",c:"130300",p:"130000"},130400:{l:"H",n:"邯郸市",c:"130400",p:"130000"},130500:{l:"X",n:"邢台市",c:"130500",p:"130000"},130600:{l:"B",n:"保定市",c:"130600",p:"130000"},130700:{l:"Z",n:"张家口市",c:"130700",p:"130000"},130800:{l:"C",n:"承德市",c:"130800",p:"130000"},130900:{l:"C",n:"沧州市",c:"130900",p:"130000"},131e3:{l:"L",n:"廊坊市",c:"131000",p:"130000"},131100:{l:"H",n:"衡水市",c:"131100",p:"130000"},139001:{l:"D",n:"定州市",c:"139001",p:"130000"},139002:{l:"X",n:"辛集市",c:"139002",p:"130000"},140100:{l:"T",n:"太原市",c:"140100",p:"140000"},140200:{l:"D",n:"大同市",c:"140200",p:"140000"},140300:{l:"Y",n:"阳泉市",c:"140300",p:"140000"},140400:{l:"C",n:"长治市",c:"140400",p:"140000"},140500:{l:"J",n:"晋城市",c:"140500",p:"140000"},140600:{l:"S",n:"朔州市",c:"140600",p:"140000"},140700:{l:"J",n:"晋中市",c:"140700",p:"140000"},140800:{l:"Y",n:"运城市",c:"140800",p:"140000"},140900:{l:"X",n:"忻州市",c:"140900",p:"140000"},141e3:{l:"L",n:"临汾市",c:"141000",p:"140000"},141100:{l:"L",n:"吕梁市",c:"141100",p:"140000"},150100:{l:"H",n:"呼和浩特市",c:"150100",p:"150000"},150200:{l:"B",n:"包头市",c:"150200",p:"150000"},150300:{l:"W",n:"乌海市",c:"150300",p:"150000"},150400:{l:"C",n:"赤峰市",c:"150400",p:"150000"},150500:{l:"T",n:"通辽市",c:"150500",p:"150000"},150600:{l:"E",n:"鄂尔多斯市",c:"150600",p:"150000"},150700:{l:"H",n:"呼伦贝尔市",c:"150700",p:"150000"},150800:{l:"B",n:"巴彦淖尔市",c:"150800",p:"150000"},150900:{l:"W",n:"乌兰察布市",c:"150900",p:"150000"},152200:{l:"X",n:"兴安盟",c:"152200",p:"150000"},152500:{l:"X",n:"锡林郭勒盟",c:"152500",p:"150000"},152900:{l:"A",n:"阿拉善盟",c:"152900",p:"150000"},210100:{l:"S",n:"沈阳市",c:"210100",p:"210000"},210200:{l:"D",n:"大连市",c:"210200",p:"210000"},210300:{l:"A",n:"鞍山市",c:"210300",p:"210000"},210400:{l:"F",n:"抚顺市",c:"210400",p:"210000"},210500:{l:"B",n:"本溪市",c:"210500",p:"210000"},210600:{l:"D",n:"丹东市",c:"210600",p:"210000"},210700:{l:"J",n:"锦州市",c:"210700",p:"210000"},210800:{l:"Y",n:"营口市",c:"210800",p:"210000"},210900:{l:"F",n:"阜新市",c:"210900",p:"210000"},211e3:{l:"L",n:"辽阳市",c:"211000",p:"210000"},211100:{l:"P",n:"盘锦市",c:"211100",p:"210000"},211200:{l:"T",n:"铁岭市",c:"211200",p:"210000"},211300:{l:"C",n:"朝阳市",c:"211300",p:"210000"},211400:{l:"H",n:"葫芦岛市",c:"211400",p:"210000"},220100:{l:"C",n:"长春市",c:"220100",p:"220000"},220200:{l:"J",n:"吉林市",c:"220200",p:"220000"},220300:{l:"S",n:"四平市",c:"220300",p:"220000"},220400:{l:"L",n:"辽源市",c:"220400",p:"220000"},220500:{l:"T",n:"通化市",c:"220500",p:"220000"},220600:{l:"B",n:"白山市",c:"220600",p:"220000"},220700:{l:"S",n:"松原市",c:"220700",p:"220000"},220800:{l:"B",n:"白城市",c:"220800",p:"220000"},222400:{l:"Y",n:"延边朝鲜族自治州",c:"222400",p:"220000"},230100:{l:"H",n:"哈尔滨市",c:"230100",p:"230000"},230200:{l:"Q",n:"齐齐哈尔市",c:"230200",p:"230000"},230300:{l:"J",n:"鸡西市",c:"230300",p:"230000"},230400:{l:"H",n:"鹤岗市",c:"230400",p:"230000"},230500:{l:"S",n:"双鸭山市",c:"230500",p:"230000"},230600:{l:"D",n:"大庆市",c:"230600",p:"230000"},230700:{l:"Y",n:"伊春市",c:"230700",p:"230000"},230800:{l:"J",n:"佳木斯市",c:"230800",p:"230000"},230900:{l:"Q",n:"七台河市",c:"230900",p:"230000"},231e3:{l:"M",n:"牡丹江市",c:"231000",p:"230000"},231100:{l:"H",n:"黑河市",c:"231100",p:"230000"},231200:{l:"S",n:"绥化市",c:"231200",p:"230000"},232700:{l:"D",n:"大兴安岭地区",c:"232700",p:"230000"},31e4:{l:"S",n:"上海市",c:"310000",p:"86"},320100:{l:"N",n:"南京市",c:"320100",p:"320000"},320200:{l:"W",n:"无锡市",c:"320200",p:"320000"},320300:{l:"X",n:"徐州市",c:"320300",p:"320000"},320400:{l:"C",n:"常州市",c:"320400",p:"320000"},320500:{l:"S",n:"苏州市",c:"320500",p:"320000"},320600:{l:"N",n:"南通市",c:"320600",p:"320000"},320700:{l:"L",n:"连云港市",c:"320700",p:"320000"},320800:{l:"H",n:"淮安市",c:"320800",p:"320000"},320900:{l:"Y",n:"盐城市",c:"320900",p:"320000"},321e3:{l:"Y",n:"扬州市",c:"321000",p:"320000"},321100:{l:"Z",n:"镇江市",c:"321100",p:"320000"},321200:{l:"T",n:"泰州市",c:"321200",p:"320000"},321300:{l:"X",n:"宿迁市",c:"321300",p:"320000"},330100:{l:"H",n:"杭州市",c:"330100",p:"330000"},330200:{l:"N",n:"宁波市",c:"330200",p:"330000"},330300:{l:"W",n:"温州市",c:"330300",p:"330000"},330400:{l:"J",n:"嘉兴市",c:"330400",p:"330000"},330500:{l:"H",n:"湖州市",c:"330500",p:"330000"},330600:{l:"S",n:"绍兴市",c:"330600",p:"330000"},330700:{l:"J",n:"金华市",c:"330700",p:"330000"},330800:{l:"Q",n:"衢州市",c:"330800",p:"330000"},330900:{l:"Z",n:"舟山市",c:"330900",p:"330000"},331e3:{l:"T",n:"台州市",c:"331000",p:"330000"},331100:{l:"L",n:"丽水市",c:"331100",p:"330000"},340100:{l:"H",n:"合肥市",c:"340100",p:"340000"},340200:{l:"W",n:"芜湖市",c:"340200",p:"340000"},340300:{l:"B",n:"蚌埠市",c:"340300",p:"340000"},340400:{l:"H",n:"淮南市",c:"340400",p:"340000"},340500:{l:"M",n:"马鞍山市",c:"340500",p:"340000"},340600:{l:"H",n:"淮北市",c:"340600",p:"340000"},340700:{l:"T",n:"铜陵市",c:"340700",p:"340000"},340800:{l:"A",n:"安庆市",c:"340800",p:"340000"},341e3:{l:"H",n:"黄山市",c:"341000",p:"340000"},341100:{l:"C",n:"滁州市",c:"341100",p:"340000"},341200:{l:"F",n:"阜阳市",c:"341200",p:"340000"},341300:{l:"X",n:"宿州市",c:"341300",p:"340000"},341500:{l:"L",n:"六安市",c:"341500",p:"340000"},341600:{l:"B",n:"亳州市",c:"341600",p:"340000"},341700:{l:"C",n:"池州市",c:"341700",p:"340000"},341800:{l:"X",n:"宣城市",c:"341800",p:"340000"},350100:{l:"F",n:"福州市",c:"350100",p:"350000"},350200:{l:"S",n:"厦门市",c:"350200",p:"350000"},350300:{l:"P",n:"莆田市",c:"350300",p:"350000"},350400:{l:"S",n:"三明市",c:"350400",p:"350000"},350500:{l:"Q",n:"泉州市",c:"350500",p:"350000"},350600:{l:"Z",n:"漳州市",c:"350600",p:"350000"},350700:{l:"N",n:"南平市",c:"350700",p:"350000"},350800:{l:"L",n:"龙岩市",c:"350800",p:"350000"},350900:{l:"N",n:"宁德市",c:"350900",p:"350000"},360100:{l:"N",n:"南昌市",c:"360100",p:"360000"},360200:{l:"J",n:"景德镇市",c:"360200",p:"360000"},360300:{l:"P",n:"萍乡市",c:"360300",p:"360000"},360400:{l:"J",n:"九江市",c:"360400",p:"360000"},360500:{l:"X",n:"新余市",c:"360500",p:"360000"},360600:{l:"Y",n:"鹰潭市",c:"360600",p:"360000"},360700:{l:"G",n:"赣州市",c:"360700",p:"360000"},360800:{l:"J",n:"吉安市",c:"360800",p:"360000"},360900:{l:"Y",n:"宜春市",c:"360900",p:"360000"},361e3:{l:"F",n:"抚州市",c:"361000",p:"360000"},361100:{l:"S",n:"上饶市",c:"361100",p:"360000"},370100:{l:"J",n:"济南市",c:"370100",p:"370000"},370200:{l:"Q",n:"青岛市",c:"370200",p:"370000"},370300:{l:"Z",n:"淄博市",c:"370300",p:"370000"},370400:{l:"Z",n:"枣庄市",c:"370400",p:"370000"},370500:{l:"D",n:"东营市",c:"370500",p:"370000"},370600:{l:"Y",n:"烟台市",c:"370600",p:"370000"},370700:{l:"W",n:"潍坊市",c:"370700",p:"370000"},370800:{l:"J",n:"济宁市",c:"370800",p:"370000"},370900:{l:"T",n:"泰安市",c:"370900",p:"370000"},371e3:{l:"W",n:"威海市",c:"371000",p:"370000"},371100:{l:"R",n:"日照市",c:"371100",p:"370000"},371200:{l:"L",n:"莱芜市",c:"371200",p:"370000"},371300:{l:"L",n:"临沂市",c:"371300",p:"370000"},371400:{l:"D",n:"德州市",c:"371400",p:"370000"},371500:{l:"L",n:"聊城市",c:"371500",p:"370000"},371600:{l:"B",n:"滨州市",c:"371600",p:"370000"},371700:{l:"H",n:"菏泽市",c:"371700",p:"370000"},410100:{l:"Z",n:"郑州市",c:"410100",p:"410000"},410200:{l:"K",n:"开封市",c:"410200",p:"410000"},410300:{l:"L",n:"洛阳市",c:"410300",p:"410000"},410400:{l:"P",n:"平顶山市",c:"410400",p:"410000"},410500:{l:"A",n:"安阳市",c:"410500",p:"410000"},410600:{l:"H",n:"鹤壁市",c:"410600",p:"410000"},410700:{l:"X",n:"新乡市",c:"410700",p:"410000"},410800:{l:"J",n:"焦作市",c:"410800",p:"410000"},410900:{l:"P",n:"濮阳市",c:"410900",p:"410000"},411e3:{l:"X",n:"许昌市",c:"411000",p:"410000"},411100:{l:"L",n:"漯河市",c:"411100",p:"410000"},411200:{l:"S",n:"三门峡市",c:"411200",p:"410000"},411300:{l:"N",n:"南阳市",c:"411300",p:"410000"},411400:{l:"S",n:"商丘市",c:"411400",p:"410000"},411500:{l:"X",n:"信阳市",c:"411500",p:"410000"},411600:{l:"Z",n:"周口市",c:"411600",p:"410000"},411700:{l:"Z",n:"驻马店市",c:"411700",p:"410000"},419001:{l:"J",n:"济源市",c:"419001",p:"410000"},420100:{l:"W",n:"武汉市",c:"420100",p:"420000"},420200:{l:"H",n:"黄石市",c:"420200",p:"420000"},420300:{l:"S",n:"十堰市",c:"420300",p:"420000"},420500:{l:"Y",n:"宜昌市",c:"420500",p:"420000"},420600:{l:"X",n:"襄阳市",c:"420600",p:"420000"},420700:{l:"E",n:"鄂州市",c:"420700",p:"420000"},420800:{l:"J",n:"荆门市",c:"420800",p:"420000"},420900:{l:"X",n:"孝感市",c:"420900",p:"420000"},421e3:{l:"J",n:"荆州市",c:"421000",p:"420000"},421100:{l:"H",n:"黄冈市",c:"421100",p:"420000"},421200:{l:"X",n:"咸宁市",c:"421200",p:"420000"},421300:{l:"S",n:"随州市",c:"421300",p:"420000"},422800:{l:"E",n:"恩施土家族苗族自治州",c:"422800",p:"420000"},429004:{l:"X",n:"仙桃市",c:"429004",p:"420000"},429005:{l:"Q",n:"潜江市",c:"429005",p:"420000"},429006:{l:"T",n:"天门市",c:"429006",p:"420000"},429021:{l:"S",n:"神农架林区",c:"429021",p:"420000"},430100:{l:"C",n:"长沙市",c:"430100",p:"430000"},430200:{l:"Z",n:"株洲市",c:"430200",p:"430000"},430300:{l:"X",n:"湘潭市",c:"430300",p:"430000"},430400:{l:"H",n:"衡阳市",c:"430400",p:"430000"},430500:{l:"S",n:"邵阳市",c:"430500",p:"430000"},430600:{l:"Y",n:"岳阳市",c:"430600",p:"430000"},430700:{l:"C",n:"常德市",c:"430700",p:"430000"},430800:{l:"Z",n:"张家界市",c:"430800",p:"430000"},430900:{l:"Y",n:"益阳市",c:"430900",p:"430000"},431e3:{l:"C",n:"郴州市",c:"431000",p:"430000"},431100:{l:"Y",n:"永州市",c:"431100",p:"430000"},431200:{l:"H",n:"怀化市",c:"431200",p:"430000"},431300:{l:"L",n:"娄底市",c:"431300",p:"430000"},433100:{l:"X",n:"湘西土家族苗族自治州",c:"433100",p:"430000"},440100:{l:"G",n:"广州市",c:"440100",p:"440000"},440200:{l:"S",n:"韶关市",c:"440200",p:"440000"},440300:{l:"S",n:"深圳市",c:"440300",p:"440000"},440400:{l:"Z",n:"珠海市",c:"440400",p:"440000"},440500:{l:"S",n:"汕头市",c:"440500",p:"440000"},440600:{l:"F",n:"佛山市",c:"440600",p:"440000"},440700:{l:"J",n:"江门市",c:"440700",p:"440000"},440800:{l:"Z",n:"湛江市",c:"440800",p:"440000"},440900:{l:"M",n:"茂名市",c:"440900",p:"440000"},441200:{l:"Z",n:"肇庆市",c:"441200",p:"440000"},441300:{l:"H",n:"惠州市",c:"441300",p:"440000"},441400:{l:"M",n:"梅州市",c:"441400",p:"440000"},441500:{l:"S",n:"汕尾市",c:"441500",p:"440000"},441600:{l:"H",n:"河源市",c:"441600",p:"440000"},441700:{l:"Y",n:"阳江市",c:"441700",p:"440000"},441800:{l:"Q",n:"清远市",c:"441800",p:"440000"},441900:{l:"D",n:"东莞市",c:"441900",p:"440000"},442e3:{l:"Z",n:"中山市",c:"442000",p:"440000"},445100:{l:"C",n:"潮州市",c:"445100",p:"440000"},445200:{l:"J",n:"揭阳市",c:"445200",p:"440000"},445300:{l:"Y",n:"云浮市",c:"445300",p:"440000"},450100:{l:"N",n:"南宁市",c:"450100",p:"450000"},450200:{l:"L",n:"柳州市",c:"450200",p:"450000"},450300:{l:"G",n:"桂林市",c:"450300",p:"450000"},450400:{l:"W",n:"梧州市",c:"450400",p:"450000"},450500:{l:"B",n:"北海市",c:"450500",p:"450000"},450600:{l:"F",n:"防城港市",c:"450600",p:"450000"},450700:{l:"Q",n:"钦州市",c:"450700",p:"450000"},450800:{l:"G",n:"贵港市",c:"450800",p:"450000"},450900:{l:"Y",n:"玉林市",c:"450900",p:"450000"},451e3:{l:"B",n:"百色市",c:"451000",p:"450000"},451100:{l:"H",n:"贺州市",c:"451100",p:"450000"},451200:{l:"H",n:"河池市",c:"451200",p:"450000"},451300:{l:"L",n:"来宾市",c:"451300",p:"450000"},451400:{l:"C",n:"崇左市",c:"451400",p:"450000"},460100:{l:"H",n:"海口市",c:"460100",p:"460000"},460200:{l:"S",n:"三亚市",c:"460200",p:"460000"},460300:{l:"S",n:"三沙市",c:"460300",p:"460000"},460400:{l:"D",n:"儋州市",c:"460400",p:"460000"},469001:{l:"W",n:"五指山市",c:"469001",p:"460000"},469002:{l:"Q",n:"琼海市",c:"469002",p:"460000"},469005:{l:"W",n:"文昌市",c:"469005",p:"460000"},469006:{l:"W",n:"万宁市",c:"469006",p:"460000"},469007:{l:"D",n:"东方市",c:"469007",p:"460000"},469021:{l:"D",n:"定安县",c:"469021",p:"460000"},469022:{l:"T",n:"屯昌县",c:"469022",p:"460000"},469023:{l:"C",n:"澄迈县",c:"469023",p:"460000"},469024:{l:"L",n:"临高县",c:"469024",p:"460000"},469025:{l:"B",n:"白沙黎族自治县",c:"469025",p:"460000"},469026:{l:"C",n:"昌江黎族自治县",c:"469026",p:"460000"},469027:{l:"L",n:"乐东黎族自治县",c:"469027",p:"460000"},469028:{l:"L",n:"陵水黎族自治县",c:"469028",p:"460000"},469029:{l:"B",n:"保亭黎族苗族自治县",c:"469029",p:"460000"},469030:{l:"Q",n:"琼中黎族苗族自治县",c:"469030",p:"460000"},5e5:{l:"C",n:"重庆市",c:"500000",p:"86"},510100:{l:"C",n:"成都市",c:"510100",p:"510000"},510300:{l:"Z",n:"自贡市",c:"510300",p:"510000"},510400:{l:"P",n:"攀枝花市",c:"510400",p:"510000"},510500:{l:"L",n:"泸州市",c:"510500",p:"510000"},510600:{l:"D",n:"德阳市",c:"510600",p:"510000"},510700:{l:"M",n:"绵阳市",c:"510700",p:"510000"},510800:{l:"G",n:"广元市",c:"510800",p:"510000"},510900:{l:"S",n:"遂宁市",c:"510900",p:"510000"},511e3:{l:"N",n:"内江市",c:"511000",p:"510000"},511100:{l:"L",n:"乐山市",c:"511100",p:"510000"},511300:{l:"N",n:"南充市",c:"511300",p:"510000"},511400:{l:"M",n:"眉山市",c:"511400",p:"510000"},511500:{l:"Y",n:"宜宾市",c:"511500",p:"510000"},511600:{l:"G",n:"广安市",c:"511600",p:"510000"},511700:{l:"D",n:"达州市",c:"511700",p:"510000"},511800:{l:"Y",n:"雅安市",c:"511800",p:"510000"},511900:{l:"B",n:"巴中市",c:"511900",p:"510000"},512e3:{l:"Z",n:"资阳市",c:"512000",p:"510000"},513200:{l:"A",n:"阿坝藏族羌族自治州",c:"513200",p:"510000"},513300:{l:"G",n:"甘孜藏族自治州",c:"513300",p:"510000"},513400:{l:"L",n:"凉山彝族自治州",c:"513400",p:"510000"},520100:{l:"G",n:"贵阳市",c:"520100",p:"520000"},520200:{l:"L",n:"六盘水市",c:"520200",p:"520000"},520300:{l:"Z",n:"遵义市",c:"520300",p:"520000"},520400:{l:"A",n:"安顺市",c:"520400",p:"520000"},520500:{l:"B",n:"毕节市",c:"520500",p:"520000"},520600:{l:"T",n:"铜仁市",c:"520600",p:"520000"},522300:{l:"Q",n:"黔西南布依族苗族自治州",c:"522300",p:"520000"},522600:{l:"Q",n:"黔东南苗族侗族自治州",c:"522600",p:"520000"},522700:{l:"Q",n:"黔南布依族苗族自治州",c:"522700",p:"520000"},530100:{l:"K",n:"昆明市",c:"530100",p:"530000"},530300:{l:"Q",n:"曲靖市",c:"530300",p:"530000"},530400:{l:"Y",n:"玉溪市",c:"530400",p:"530000"},530500:{l:"B",n:"保山市",c:"530500",p:"530000"},530600:{l:"Z",n:"昭通市",c:"530600",p:"530000"},530700:{l:"L",n:"丽江市",c:"530700",p:"530000"},530800:{l:"P",n:"普洱市",c:"530800",p:"530000"},530900:{l:"L",n:"临沧市",c:"530900",p:"530000"},532300:{l:"C",n:"楚雄彝族自治州",c:"532300",p:"530000"},532500:{l:"H",n:"红河哈尼族彝族自治州",c:"532500",p:"530000"},532600:{l:"W",n:"文山壮族苗族自治州",c:"532600",p:"530000"},532800:{l:"X",n:"西双版纳傣族自治州",c:"532800",p:"530000"},532900:{l:"D",n:"大理白族自治州",c:"532900",p:"530000"},533100:{l:"D",n:"德宏傣族景颇族自治州",c:"533100",p:"530000"},533300:{l:"N",n:"怒江傈僳族自治州",c:"533300",p:"530000"},533400:{l:"D",n:"迪庆藏族自治州",c:"533400",p:"530000"},540100:{l:"L",n:"拉萨市",c:"540100",p:"540000"},540200:{l:"R",n:"日喀则市",c:"540200",p:"540000"},540300:{l:"C",n:"昌都市",c:"540300",p:"540000"},540400:{l:"L",n:"林芝市",c:"540400",p:"540000"},540500:{l:"S",n:"山南市",c:"540500",p:"540000"},542400:{l:"N",n:"那曲地区",c:"542400",p:"540000"},542500:{l:"A",n:"阿里地区",c:"542500",p:"540000"},610100:{l:"X",n:"西安市",c:"610100",p:"610000"},610200:{l:"T",n:"铜川市",c:"610200",p:"610000"},610300:{l:"B",n:"宝鸡市",c:"610300",p:"610000"},610400:{l:"X",n:"咸阳市",c:"610400",p:"610000"},610500:{l:"W",n:"渭南市",c:"610500",p:"610000"},610600:{l:"Y",n:"延安市",c:"610600",p:"610000"},610700:{l:"H",n:"汉中市",c:"610700",p:"610000"},610800:{l:"Y",n:"榆林市",c:"610800",p:"610000"},610900:{l:"A",n:"安康市",c:"610900",p:"610000"},611e3:{l:"S",n:"商洛市",c:"611000",p:"610000"},620100:{l:"L",n:"兰州市",c:"620100",p:"620000"},620200:{l:"J",n:"嘉峪关市",c:"620200",p:"620000"},620300:{l:"J",n:"金昌市",c:"620300",p:"620000"},620400:{l:"B",n:"白银市",c:"620400",p:"620000"},620500:{l:"T",n:"天水市",c:"620500",p:"620000"},620600:{l:"W",n:"武威市",c:"620600",p:"620000"},620700:{l:"Z",n:"张掖市",c:"620700",p:"620000"},620800:{l:"P",n:"平凉市",c:"620800",p:"620000"},620900:{l:"J",n:"酒泉市",c:"620900",p:"620000"},621e3:{l:"Q",n:"庆阳市",c:"621000",p:"620000"},621100:{l:"D",n:"定西市",c:"621100",p:"620000"},621200:{l:"L",n:"陇南市",c:"621200",p:"620000"},622900:{l:"L",n:"临夏回族自治州",c:"622900",p:"620000"},623e3:{l:"G",n:"甘南藏族自治州",c:"623000",p:"620000"},630100:{l:"X",n:"西宁市",c:"630100",p:"630000"},630200:{l:"H",n:"海东市",c:"630200",p:"630000"},632200:{l:"H",n:"海北藏族自治州",c:"632200",p:"630000"},632300:{l:"H",n:"黄南藏族自治州",c:"632300",p:"630000"},632500:{l:"H",n:"海南藏族自治州",c:"632500",p:"630000"},632600:{l:"G",n:"果洛藏族自治州",c:"632600",p:"630000"},632700:{l:"Y",n:"玉树藏族自治州",c:"632700",p:"630000"},632800:{l:"H",n:"海西蒙古族藏族自治州",c:"632800",p:"630000"},640100:{l:"Y",n:"银川市",c:"640100",p:"640000"},640200:{l:"S",n:"石嘴山市",c:"640200",p:"640000"},640300:{l:"W",n:"吴忠市",c:"640300",p:"640000"},640400:{l:"G",n:"固原市",c:"640400",p:"640000"},640500:{l:"Z",n:"中卫市",c:"640500",p:"640000"},650100:{l:"W",n:"乌鲁木齐市",c:"650100",p:"650000"},650200:{l:"K",n:"克拉玛依市",c:"650200",p:"650000"},650400:{l:"T",n:"吐鲁番市",c:"650400",p:"650000"},650500:{l:"H",n:"哈密市",c:"650500",p:"650000"},652300:{l:"C",n:"昌吉回族自治州",c:"652300",p:"650000"},652700:{l:"B",n:"博尔塔拉蒙古自治州",c:"652700",p:"650000"},652800:{l:"B",n:"巴音郭楞蒙古自治州",c:"652800",p:"650000"},652900:{l:"A",n:"阿克苏地区",c:"652900",p:"650000"},653e3:{l:"K",n:"克孜勒苏柯尔克孜自治州",c:"653000",p:"650000"},653100:{l:"K",n:"喀什地区",c:"653100",p:"650000"},653200:{l:"H",n:"和田地区",c:"653200",p:"650000"},654e3:{l:"Y",n:"伊犁哈萨克自治州",c:"654000",p:"650000"},654200:{l:"T",n:"塔城地区",c:"654200",p:"650000"},654300:{l:"A",n:"阿勒泰地区",c:"654300",p:"650000"},659001:{l:"S",n:"石河子市",c:"659001",p:"650000"},659002:{l:"A",n:"阿拉尔市",c:"659002",p:"650000"},659003:{l:"T",n:"图木舒克市",c:"659003",p:"650000"},659004:{l:"W",n:"五家渠市",c:"659004",p:"650000"},659006:{l:"T",n:"铁门关市",c:"659006",p:"650000"},710101:{l:"J",n:"金门",c:"710101",p:"710000"},710102:{l:"L",n:"连江",c:"710102",p:"710000"},710103:{l:"M",n:"苗栗",c:"710103",p:"710000"},710104:{l:"N",n:"南投",c:"710104",p:"710000"},710105:{l:"P",n:"澎湖",c:"710105",p:"710000"},710106:{l:"P",n:"屏东",c:"710106",p:"710000"},710107:{l:"T",n:"台东",c:"710107",p:"710000"},710108:{l:"T",n:"台中",c:"710108",p:"710000"},710109:{l:"T",n:"台南",c:"710109",p:"710000"},710110:{l:"T",n:"台北",c:"710110",p:"710000"},710111:{l:"T",n:"桃园",c:"710111",p:"710000"},710112:{l:"Y",n:"云林",c:"710112",p:"710000"},710113:{l:"X",n:"新北",c:"710113",p:"710000"},710114:{l:"Z",n:"彰化",c:"710114",p:"710000"},710115:{l:"J",n:"嘉义",c:"710115",p:"710000"},710116:{l:"X",n:"新竹",c:"710116",p:"710000"},710117:{l:"H",n:"花莲",c:"710117",p:"710000"},710118:{l:"Y",n:"宜兰",c:"710118",p:"710000"},710119:{l:"G",n:"高雄",c:"710119",p:"710000"},710120:{l:"J",n:"基隆",c:"710120",p:"710000"},81e4:{l:"X",n:"香港特别行政区",c:"810000",p:"86"},82e4:{l:"A",n:"澳门特别行政区",c:"820000",p:"86"}};function I0(c){return c.replace("市","").replace("地区","").replace("特别行政区","")}function rne(){const c=$(Up),d=[];for(let g in c){const M=c[g];M.n=I0(M.n),d.push(M)}return d}function LN(c,d){if(!d)return"";const g=c.find(M=>M.n===d);return g?g.c:(console.error("[View UI warn]: City name error."),"")}function sne(c,d){return c.find(g=>g.c===d).n}const one={name:"City",mixins:[Ei],components:{Dropdown:Rd,DropdownMenu:Id,Select:$s,Option:Jn,Tag:$p,Icon:S,RadioGroup:vx,Radio:yx},emits:["on-change","update:modelValue"],props:{modelValue:{type:String},useName:{type:Boolean,default:!1},cities:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showSuffix:{type:Boolean,default:!1},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},placeholder:{type:String,default:"请选择"},searchPlaceholder:{type:String,default:"输入城市名称搜索"},transferClassName:{type:String}},data(){const c=rne();return{currentValue:this.useName?LN(c,this.modelValue):this.modelValue,visible:!1,provinceList:[],cityListByProvince:[],cityListByLetter:{},allCities:c,listType:"province",queryCity:""}},watch:{modelValue(c){const d=this.useName?LN(this.allCities,c):c;this.currentValue=d}},computed:{showCloseIcon(){return this.currentValue&&this.clearable&&!this.itemDisabled},classes(){return[{"ivu-city-show-clear":this.showCloseIcon,[`ivu-city-size-${this.size}`]:!!this.size,"ivu-city-visible":this.visible,"ivu-city-disabled":this.itemDisabled}]},transferClasses(){let c="ivu-city-transfer";return this.transferClassName&&(c+=` ${this.transferClassName}`),c},relCities(){const c=[];return this.cities.length&&this.cities.forEach(d=>{const g=Up[d];g.n=I0(g.n),c.push(g)}),c},codeToName(){if(!this.currentValue)return this.placeholder;const c=Up[this.currentValue].n;return this.showSuffix?c:I0(c)}},methods:{handleSelect(c){c&&(this.handleChangeValue(c),i.nextTick(()=>{this.queryCity=""}))},handleChangeValue(c){this.currentValue=c,this.visible=!1;const d=this.useName?sne(this.allCities,c):c;this.$emit("update:modelValue",d),this.$emit("on-change",Up[c]),this.handleFormItemChange("change",c)},handleClickLetter(c){let d=c;d==="直辖市"?d="Z1":d==="港澳"&&(d="Z2");const g=`.ivu-city-${d}`,M=this.$refs.list,C=M.querySelectorAll(g)[0].offsetTop,b=M.offsetTop;M.scrollTop=C-b},clearSelect(){if(this.itemDisabled)return!1},handleToggleOpen(){if(this.itemDisabled)return!1;this.visible=!this.visible},handleVisibleChange(c){this.visible=c},handleClickOutside(c){this.$refs.city.contains(c.target)||(this.visible=!1)},handleGetProvinceByLetter(){const c={A:{n:"A",p:[],c:[]},F:{n:"F",p:[],c:[]},G:{n:"G",p:[],c:[]},H:{n:"H",p:[],c:[]},J:{n:"J",p:[],c:[]},L:{n:"L",p:[],c:[]},N:{n:"N",p:[],c:[]},Q:{n:"Q",p:[],c:[]},S:{n:"S",p:[],c:[]},T:{n:"T",p:[],c:[]},X:{n:"X",p:[],c:[]},Y:{n:"Y",p:[],c:[]},Z:{n:"Z",p:[],c:[]},Z1:{n:"直辖市",p:[],c:[]},Z2:{n:"港澳",p:[],c:[]}};for(let d in DN){const g=DN[d];c[g.l].p.push(g)}this.provinceList=c},handleGetCityByProvince(){const c=$(this.provinceList),d=[],g=$(Up),M=[{p:{n:"直辖市",p:"86",l:"Z1"},c:[]},{p:{n:"港澳",p:"86",l:"Z2"},c:[]}];for(let C in c){const b=c[C];for(let B=0;B<b.p.length;B++){const F=b.p[B],Y=F.c,G={p:F,c:[]};for(let K in g){const fe=g[K];fe.n=I0(fe.n),Y===fe.p&&G.c.push(fe)}C==="Z1"?M[0].c.push(g[Y]):C==="Z2"?M[1].c.push(g[Y]):d.push(G)}}this.cityListByProvince=d.concat(M)},handleGetCityByLetter(){const c=$(Up),d={A:[],B:[],C:[],D:[],E:[],F:[],G:[],H:[],J:[],K:[],L:[],M:[],N:[],P:[],Q:[],R:[],S:[],T:[],W:[],X:[],Y:[],Z:[]};for(let g in c){const M=c[g];M.n=I0(M.n),d[M.l].push(M)}this.cityListByLetter=d}},created(){this.handleGetProvinceByLetter(),this.handleGetCityByProvince(),this.handleGetCityByLetter()}},ane=["name","value"],lne={class:"ivu-city-drop"},cne={key:0,class:"ivu-city-drop-cities"},hne=["onClick"],une={class:"ivu-city-drop-menu"},dne={class:"ivu-city-drop-type"},fne={class:"ivu-city-drop-search"},pne={key:1,class:"ivu-city-drop-list"},mne={class:"ivu-city-drop-list-letter"},gne={class:"ivu-city-drop-list-main",ref:"list"},vne=["onClick"],yne={key:2,class:"ivu-city-drop-list"},bne={class:"ivu-city-drop-list-letter"},xne={class:"ivu-city-drop-list-main ivu-city-drop-list-main-city",ref:"list"},wne=["onClick"];function _ne(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("Radio"),Y=i.resolveComponent("RadioGroup"),G=i.resolveComponent("Option"),K=i.resolveComponent("Select"),fe=i.resolveComponent("Tag"),Ee=i.resolveComponent("DropdownMenu"),Ce=i.resolveComponent("Dropdown");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["ivu-city",b.classes]),ref:"city"},[i.createVNode(Ce,{trigger:"custom",visible:C.visible,transfer:g.transfer,placement:"bottom-start","transfer-class-name":b.transferClasses,onOnVisibleChange:b.handleVisibleChange,onOnClickoutside:b.handleClickOutside},{list:i.withCtx(()=>[i.createVNode(Ee,{onClick:d[3]||(d[3]=i.withModifiers(()=>{},["stop"]))},{default:i.withCtx(()=>[i.createElementVNode("div",lne,[g.cities.length?(i.openBlock(),i.createElementBlock("div",cne,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.relCities,Oe=>(i.openBlock(),i.createElementBlock("span",{key:Oe.n,onClick:ue=>b.handleChangeValue(Oe.c)},i.toDisplayString(Oe.n),9,hne))),128))])):i.createCommentVNode("",!0),i.createElementVNode("div",une,[i.createElementVNode("div",dne,[i.createVNode(Y,{modelValue:C.listType,"onUpdate:modelValue":d[1]||(d[1]=Oe=>C.listType=Oe),type:"button",size:"small"},{default:i.withCtx(()=>[i.createVNode(F,{label:"province"},{default:i.withCtx(()=>[i.createTextVNode("按省份")]),_:1}),i.createVNode(F,{label:"city"},{default:i.withCtx(()=>[i.createTextVNode("按城市")]),_:1})]),_:1},8,["modelValue"])]),i.createElementVNode("div",fne,[i.createVNode(K,{modelValue:C.queryCity,"onUpdate:modelValue":d[2]||(d[2]=Oe=>C.queryCity=Oe),filterable:"",size:"small",transfer:"",placeholder:g.searchPlaceholder,onOnChange:b.handleSelect},{default:i.withCtx(()=>[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(C.allCities,Oe=>(i.openBlock(),i.createBlock(G,{value:Oe.c,key:Oe.c},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(Oe.n),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","placeholder","onOnChange"])])]),C.listType==="province"?(i.openBlock(),i.createElementBlock("div",pne,[i.createElementVNode("div",mne,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(C.provinceList,Oe=>(i.openBlock(),i.createBlock(fe,{onClick:ue=>b.handleClickLetter(Oe.n),type:"border",fade:!1,key:Oe.n},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(Oe.n),1)]),_:2},1032,["onClick"]))),128))]),i.createElementVNode("div",gne,[i.createElementVNode("dl",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(C.cityListByProvince,Oe=>(i.openBlock(),i.createElementBlock(i.Fragment,{key:Oe.p.n},[i.createElementVNode("dt",{class:i.normalizeClass("ivu-city-"+Oe.p.l)},i.toDisplayString(Oe.p.n)+"：",3),i.createElementVNode("dd",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(Oe.c,ue=>(i.openBlock(),i.createElementBlock("li",{key:ue.n,onClick:Ne=>b.handleChangeValue(ue.c)},i.toDisplayString(ue.n),9,vne))),128))])],64))),128))])],512)])):i.createCommentVNode("",!0),C.listType==="city"?(i.openBlock(),i.createElementBlock("div",yne,[i.createElementVNode("div",bne,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(C.cityListByLetter,(Oe,ue)=>(i.openBlock(),i.createBlock(fe,{onClick:Ne=>b.handleClickLetter(ue),type:"border",fade:!1,key:ue},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(ue),1)]),_:2},1032,["onClick"]))),128))]),i.createElementVNode("div",xne,[i.createElementVNode("dl",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(C.cityListByLetter,(Oe,ue)=>(i.openBlock(),i.createElementBlock(i.Fragment,{key:ue},[i.createElementVNode("dt",{class:i.normalizeClass("ivu-city-"+ue)},i.toDisplayString(ue)+"：",3),i.createElementVNode("dd",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(Oe,Ne=>(i.openBlock(),i.createElementBlock("li",{key:Ne.n,onClick:jt=>b.handleChangeValue(Ne.c)},i.toDisplayString(Ne.n),9,wne))),128))])],64))),128))])],512)])):i.createCommentVNode("",!0)])]),_:1})]),default:i.withCtx(()=>[i.createElementVNode("div",{class:"ivu-city-rel",onClick:d[0]||(d[0]=i.withModifiers((...Oe)=>b.handleToggleOpen&&b.handleToggleOpen(...Oe),["prevent","stop"]))},[i.createElementVNode("input",{type:"hidden",name:g.name,value:C.currentValue},null,8,ane),i.renderSlot(c.$slots,"default",{},()=>[i.createElementVNode("span",null,i.toDisplayString(b.codeToName),1),i.withDirectives(i.createVNode(B,{type:"ios-close-circle",class:"ivu-city-arrow",onClick:i.withModifiers(b.clearSelect,["stop"])},null,8,["onClick"]),[[i.vShow,b.showCloseIcon]]),i.createVNode(B,{type:"ios-arrow-down",class:"ivu-city-arrow"})])])]),_:3},8,["visible","transfer","transfer-class-name","onOnVisibleChange","onOnClickoutside"])],2)}var BN=l(one,[["render",_ne]]);const $N="ivu-collapse",One={name:"Collapse",emits:["on-change","update:modelValue"],provide(){return{CollapseInstance:this}},props:{accordion:{type:Boolean,default:!1},modelValue:{type:[Array,String]},simple:{type:Boolean,default:!1}},data(){return{currentValue:this.modelValue,panelCount:0}},computed:{classes(){return[`${$N}`,{[`${$N}-simple`]:this.simple}]}},methods:{getActiveKey(){let c=this.currentValue||[];const d=this.accordion;Array.isArray(c)||(c=[c]),d&&c.length>1&&(c=[c[0]]);for(let g=0;g<c.length;g++)c[g]=c[g].toString();return c},toggle(c){const d=c.name.toString();let g=[];if(this.accordion)c.isActive||g.push(d);else{let M=this.getActiveKey();const C=M.indexOf(d);c.isActive?C>-1&&M.splice(C,1):C<0&&M.push(d),g=M}this.currentValue=g,this.$emit("update:modelValue",g),this.$emit("on-change",g)}},watch:{modelValue(c){this.currentValue=c}}};function Sne(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.renderSlot(c.$slots,"default")],2)}var UN=l(One,[["render",Sne]]);function Sx(c){return Sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},Sx(c)}var Cne=/^\s+/,Tne=/\s+$/;function Qt(c,d){if(c=c||"",d=d||{},c instanceof Qt)return c;if(!(this instanceof Qt))return new Qt(c,d);var g=Ene(c);this._originalInput=c,this._r=g.r,this._g=g.g,this._b=g.b,this._a=g.a,this._roundA=Math.round(100*this._a)/100,this._format=d.format||g.format,this._gradientType=d.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=g.ok}Qt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var c=this.toRgb();return(c.r*299+c.g*587+c.b*114)/1e3},getLuminance:function(){var c=this.toRgb(),d,g,M,C,b,B;return d=c.r/255,g=c.g/255,M=c.b/255,d<=.03928?C=d/12.92:C=Math.pow((d+.055)/1.055,2.4),g<=.03928?b=g/12.92:b=Math.pow((g+.055)/1.055,2.4),M<=.03928?B=M/12.92:B=Math.pow((M+.055)/1.055,2.4),.2126*C+.7152*b+.0722*B},setAlpha:function(c){return this._a=GN(c),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var c=FN(this._r,this._g,this._b);return{h:c.h*360,s:c.s,v:c.v,a:this._a}},toHsvString:function(){var c=FN(this._r,this._g,this._b),d=Math.round(c.h*360),g=Math.round(c.s*100),M=Math.round(c.v*100);return this._a==1?"hsv("+d+", "+g+"%, "+M+"%)":"hsva("+d+", "+g+"%, "+M+"%, "+this._roundA+")"},toHsl:function(){var c=VN(this._r,this._g,this._b);return{h:c.h*360,s:c.s,l:c.l,a:this._a}},toHslString:function(){var c=VN(this._r,this._g,this._b),d=Math.round(c.h*360),g=Math.round(c.s*100),M=Math.round(c.l*100);return this._a==1?"hsl("+d+", "+g+"%, "+M+"%)":"hsla("+d+", "+g+"%, "+M+"%, "+this._roundA+")"},toHex:function(c){return zN(this._r,this._g,this._b,c)},toHexString:function(c){return"#"+this.toHex(c)},toHex8:function(c){return Pne(this._r,this._g,this._b,this._a,c)},toHex8String:function(c){return"#"+this.toHex8(c)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Gn(this._r,255)*100)+"%",g:Math.round(Gn(this._g,255)*100)+"%",b:Math.round(Gn(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Gn(this._r,255)*100)+"%, "+Math.round(Gn(this._g,255)*100)+"%, "+Math.round(Gn(this._b,255)*100)+"%)":"rgba("+Math.round(Gn(this._r,255)*100)+"%, "+Math.round(Gn(this._g,255)*100)+"%, "+Math.round(Gn(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:Xne[zN(this._r,this._g,this._b,!0)]||!1},toFilter:function(c){var d="#"+XN(this._r,this._g,this._b,this._a),g=d,M=this._gradientType?"GradientType = 1, ":"";if(c){var C=Qt(c);g="#"+XN(C._r,C._g,C._b,C._a)}return"progid:DXImageTransform.Microsoft.gradient("+M+"startColorstr="+d+",endColorstr="+g+")"},toString:function(c){var d=!!c;c=c||this._format;var g=!1,M=this._a<1&&this._a>=0,C=!d&&M&&(c==="hex"||c==="hex6"||c==="hex3"||c==="hex4"||c==="hex8"||c==="name");return C?c==="name"&&this._a===0?this.toName():this.toRgbString():(c==="rgb"&&(g=this.toRgbString()),c==="prgb"&&(g=this.toPercentageRgbString()),(c==="hex"||c==="hex6")&&(g=this.toHexString()),c==="hex3"&&(g=this.toHexString(!0)),c==="hex4"&&(g=this.toHex8String(!0)),c==="hex8"&&(g=this.toHex8String()),c==="name"&&(g=this.toName()),c==="hsl"&&(g=this.toHslString()),c==="hsv"&&(g=this.toHsvString()),g||this.toHexString())},clone:function(){return Qt(this.toString())},_applyModification:function(c,d){var g=c.apply(null,[this].concat([].slice.call(d)));return this._r=g._r,this._g=g._g,this._b=g._b,this.setAlpha(g._a),this},lighten:function(){return this._applyModification(Dne,arguments)},brighten:function(){return this._applyModification(Lne,arguments)},darken:function(){return this._applyModification(Bne,arguments)},desaturate:function(){return this._applyModification(Rne,arguments)},saturate:function(){return this._applyModification(Ine,arguments)},greyscale:function(){return this._applyModification(Nne,arguments)},spin:function(){return this._applyModification($ne,arguments)},_applyCombination:function(c,d){return c.apply(null,[this].concat([].slice.call(d)))},analogous:function(){return this._applyCombination(Fne,arguments)},complement:function(){return this._applyCombination(Une,arguments)},monochromatic:function(){return this._applyCombination(zne,arguments)},splitcomplement:function(){return this._applyCombination(Vne,arguments)},triad:function(){return this._applyCombination(WN,[3])},tetrad:function(){return this._applyCombination(WN,[4])}},Qt.fromRatio=function(c,d){if(Sx(c)=="object"){var g={};for(var M in c)c.hasOwnProperty(M)&&(M==="a"?g[M]=c[M]:g[M]=N0(c[M]));c=g}return Qt(c,d)};function Ene(c){var d={r:0,g:0,b:0},g=1,M=null,C=null,b=null,B=!1,F=!1;return typeof c=="string"&&(c=Qne(c)),Sx(c)=="object"&&(Mc(c.r)&&Mc(c.g)&&Mc(c.b)?(d=Mne(c.r,c.g,c.b),B=!0,F=String(c.r).substr(-1)==="%"?"prgb":"rgb"):Mc(c.h)&&Mc(c.s)&&Mc(c.v)?(M=N0(c.s),C=N0(c.v),d=kne(c.h,M,C),B=!0,F="hsv"):Mc(c.h)&&Mc(c.s)&&Mc(c.l)&&(M=N0(c.s),b=N0(c.l),d=Ane(c.h,M,b),B=!0,F="hsl"),c.hasOwnProperty("a")&&(g=c.a)),g=GN(g),{ok:B,format:c.format||F,r:Math.min(255,Math.max(d.r,0)),g:Math.min(255,Math.max(d.g,0)),b:Math.min(255,Math.max(d.b,0)),a:g}}function Mne(c,d,g){return{r:Gn(c,255)*255,g:Gn(d,255)*255,b:Gn(g,255)*255}}function VN(c,d,g){c=Gn(c,255),d=Gn(d,255),g=Gn(g,255);var M=Math.max(c,d,g),C=Math.min(c,d,g),b,B,F=(M+C)/2;if(M==C)b=B=0;else{var Y=M-C;switch(B=F>.5?Y/(2-M-C):Y/(M+C),M){case c:b=(d-g)/Y+(d<g?6:0);break;case d:b=(g-c)/Y+2;break;case g:b=(c-d)/Y+4;break}b/=6}return{h:b,s:B,l:F}}function Ane(c,d,g){var M,C,b;c=Gn(c,360),d=Gn(d,100),g=Gn(g,100);function B(G,K,fe){return fe<0&&(fe+=1),fe>1&&(fe-=1),fe<1/6?G+(K-G)*6*fe:fe<1/2?K:fe<2/3?G+(K-G)*(2/3-fe)*6:G}if(d===0)M=C=b=g;else{var F=g<.5?g*(1+d):g+d-g*d,Y=2*g-F;M=B(Y,F,c+1/3),C=B(Y,F,c),b=B(Y,F,c-1/3)}return{r:M*255,g:C*255,b:b*255}}function FN(c,d,g){c=Gn(c,255),d=Gn(d,255),g=Gn(g,255);var M=Math.max(c,d,g),C=Math.min(c,d,g),b,B,F=M,Y=M-C;if(B=M===0?0:Y/M,M==C)b=0;else{switch(M){case c:b=(d-g)/Y+(d<g?6:0);break;case d:b=(g-c)/Y+2;break;case g:b=(c-d)/Y+4;break}b/=6}return{h:b,s:B,v:F}}function kne(c,d,g){c=Gn(c,360)*6,d=Gn(d,100),g=Gn(g,100);var M=Math.floor(c),C=c-M,b=g*(1-d),B=g*(1-C*d),F=g*(1-(1-C)*d),Y=M%6,G=[g,B,b,b,F,g][Y],K=[F,g,g,B,b,b][Y],fe=[b,b,F,g,g,B][Y];return{r:G*255,g:K*255,b:fe*255}}function zN(c,d,g,M){var C=[Xa(Math.round(c).toString(16)),Xa(Math.round(d).toString(16)),Xa(Math.round(g).toString(16))];return M&&C[0].charAt(0)==C[0].charAt(1)&&C[1].charAt(0)==C[1].charAt(1)&&C[2].charAt(0)==C[2].charAt(1)?C[0].charAt(0)+C[1].charAt(0)+C[2].charAt(0):C.join("")}function Pne(c,d,g,M,C){var b=[Xa(Math.round(c).toString(16)),Xa(Math.round(d).toString(16)),Xa(Math.round(g).toString(16)),Xa(HN(M))];return C&&b[0].charAt(0)==b[0].charAt(1)&&b[1].charAt(0)==b[1].charAt(1)&&b[2].charAt(0)==b[2].charAt(1)&&b[3].charAt(0)==b[3].charAt(1)?b[0].charAt(0)+b[1].charAt(0)+b[2].charAt(0)+b[3].charAt(0):b.join("")}function XN(c,d,g,M){var C=[Xa(HN(M)),Xa(Math.round(c).toString(16)),Xa(Math.round(d).toString(16)),Xa(Math.round(g).toString(16))];return C.join("")}Qt.equals=function(c,d){return!c||!d?!1:Qt(c).toRgbString()==Qt(d).toRgbString()},Qt.random=function(){return Qt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function Rne(c,d){d=d===0?0:d||10;var g=Qt(c).toHsl();return g.s-=d/100,g.s=Cx(g.s),Qt(g)}function Ine(c,d){d=d===0?0:d||10;var g=Qt(c).toHsl();return g.s+=d/100,g.s=Cx(g.s),Qt(g)}function Nne(c){return Qt(c).desaturate(100)}function Dne(c,d){d=d===0?0:d||10;var g=Qt(c).toHsl();return g.l+=d/100,g.l=Cx(g.l),Qt(g)}function Lne(c,d){d=d===0?0:d||10;var g=Qt(c).toRgb();return g.r=Math.max(0,Math.min(255,g.r-Math.round(255*-(d/100)))),g.g=Math.max(0,Math.min(255,g.g-Math.round(255*-(d/100)))),g.b=Math.max(0,Math.min(255,g.b-Math.round(255*-(d/100)))),Qt(g)}function Bne(c,d){d=d===0?0:d||10;var g=Qt(c).toHsl();return g.l-=d/100,g.l=Cx(g.l),Qt(g)}function $ne(c,d){var g=Qt(c).toHsl(),M=(g.h+d)%360;return g.h=M<0?360+M:M,Qt(g)}function Une(c){var d=Qt(c).toHsl();return d.h=(d.h+180)%360,Qt(d)}function WN(c,d){if(isNaN(d)||d<=0)throw new Error("Argument to polyad must be a positive number");for(var g=Qt(c).toHsl(),M=[Qt(c)],C=360/d,b=1;b<d;b++)M.push(Qt({h:(g.h+b*C)%360,s:g.s,l:g.l}));return M}function Vne(c){var d=Qt(c).toHsl(),g=d.h;return[Qt(c),Qt({h:(g+72)%360,s:d.s,l:d.l}),Qt({h:(g+216)%360,s:d.s,l:d.l})]}function Fne(c,d,g){d=d||6,g=g||30;var M=Qt(c).toHsl(),C=360/g,b=[Qt(c)];for(M.h=(M.h-(C*d>>1)+720)%360;--d;)M.h=(M.h+C)%360,b.push(Qt(M));return b}function zne(c,d){d=d||6;for(var g=Qt(c).toHsv(),M=g.h,C=g.s,b=g.v,B=[],F=1/d;d--;)B.push(Qt({h:M,s:C,v:b})),b=(b+F)%1;return B}Qt.mix=function(c,d,g){g=g===0?0:g||50;var M=Qt(c).toRgb(),C=Qt(d).toRgb(),b=g/100,B={r:(C.r-M.r)*b+M.r,g:(C.g-M.g)*b+M.g,b:(C.b-M.b)*b+M.b,a:(C.a-M.a)*b+M.a};return Qt(B)},Qt.readability=function(c,d){var g=Qt(c),M=Qt(d);return(Math.max(g.getLuminance(),M.getLuminance())+.05)/(Math.min(g.getLuminance(),M.getLuminance())+.05)},Qt.isReadable=function(c,d,g){var M=Qt.readability(c,d),C,b;switch(b=!1,C=jne(g),C.level+C.size){case"AAsmall":case"AAAlarge":b=M>=4.5;break;case"AAlarge":b=M>=3;break;case"AAAsmall":b=M>=7;break}return b},Qt.mostReadable=function(c,d,g){var M=null,C=0,b,B,F,Y;g=g||{},B=g.includeFallbackColors,F=g.level,Y=g.size;for(var G=0;G<d.length;G++)b=Qt.readability(c,d[G]),b>C&&(C=b,M=Qt(d[G]));return Qt.isReadable(c,M,{level:F,size:Y})||!B?M:(g.includeFallbackColors=!1,Qt.mostReadable(c,["#fff","#000"],g))};var kT=Qt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Xne=Qt.hexNames=Wne(kT);function Wne(c){var d={};for(var g in c)c.hasOwnProperty(g)&&(d[c[g]]=g);return d}function GN(c){return c=parseFloat(c),(isNaN(c)||c<0||c>1)&&(c=1),c}function Gn(c,d){Gne(c)&&(c="100%");var g=Hne(c);return c=Math.min(d,Math.max(0,parseFloat(c))),g&&(c=parseInt(c*d,10)/100),Math.abs(c-d)<1e-6?1:c%d/parseFloat(d)}function Cx(c){return Math.min(1,Math.max(0,c))}function Lo(c){return parseInt(c,16)}function Gne(c){return typeof c=="string"&&c.indexOf(".")!=-1&&parseFloat(c)===1}function Hne(c){return typeof c=="string"&&c.indexOf("%")!=-1}function Xa(c){return c.length==1?"0"+c:""+c}function N0(c){return c<=1&&(c=c*100+"%"),c}function HN(c){return Math.round(parseFloat(c)*255).toString(16)}function QN(c){return Lo(c)/255}var Wa=function(){var c="[-\\+]?\\d+%?",d="[-\\+]?\\d*\\.\\d+%?",g="(?:"+d+")|(?:"+c+")",M="[\\s|\\(]+("+g+")[,|\\s]+("+g+")[,|\\s]+("+g+")\\s*\\)?",C="[\\s|\\(]+("+g+")[,|\\s]+("+g+")[,|\\s]+("+g+")[,|\\s]+("+g+")\\s*\\)?";return{CSS_UNIT:new RegExp(g),rgb:new RegExp("rgb"+M),rgba:new RegExp("rgba"+C),hsl:new RegExp("hsl"+M),hsla:new RegExp("hsla"+C),hsv:new RegExp("hsv"+M),hsva:new RegExp("hsva"+C),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Mc(c){return!!Wa.CSS_UNIT.exec(c)}function Qne(c){c=c.replace(Cne,"").replace(Tne,"").toLowerCase();var d=!1;if(kT[c])c=kT[c],d=!0;else if(c=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var g;return(g=Wa.rgb.exec(c))?{r:g[1],g:g[2],b:g[3]}:(g=Wa.rgba.exec(c))?{r:g[1],g:g[2],b:g[3],a:g[4]}:(g=Wa.hsl.exec(c))?{h:g[1],s:g[2],l:g[3]}:(g=Wa.hsla.exec(c))?{h:g[1],s:g[2],l:g[3],a:g[4]}:(g=Wa.hsv.exec(c))?{h:g[1],s:g[2],v:g[3]}:(g=Wa.hsva.exec(c))?{h:g[1],s:g[2],v:g[3],a:g[4]}:(g=Wa.hex8.exec(c))?{r:Lo(g[1]),g:Lo(g[2]),b:Lo(g[3]),a:QN(g[4]),format:d?"name":"hex8"}:(g=Wa.hex6.exec(c))?{r:Lo(g[1]),g:Lo(g[2]),b:Lo(g[3]),format:d?"name":"hex"}:(g=Wa.hex4.exec(c))?{r:Lo(g[1]+""+g[1]),g:Lo(g[2]+""+g[2]),b:Lo(g[3]+""+g[3]),a:QN(g[4]+""+g[4]),format:d?"name":"hex8"}:(g=Wa.hex3.exec(c))?{r:Lo(g[1]+""+g[1]),g:Lo(g[2]+""+g[2]),b:Lo(g[3]+""+g[3]),format:d?"name":"hex"}:!1}function jne(c){var d,g;return c=c||{level:"AA",size:"small"},d=(c.level||"AA").toUpperCase(),g=(c.size||"small").toLowerCase(),d!=="AA"&&d!=="AAA"&&(d="AA"),g!=="small"&&g!=="large"&&(g="small"),{level:d,size:g}}var jN={inject:["ColorPickerInstance"],methods:{handleEscape(c){this.ColorPickerInstance.handleOnEscapeKeydown(c)}}},D0={data(){return{prefixCls:"ivu-color-picker",inputPrefixCls:"ivu-input",iconPrefixCls:"ivu-icon",transferPrefixCls:"ivu-transfer"}}};function PT(c,d){const g=Qt(c),{_a:M}=g;return M==null&&g.setAlpha(d||1),g}function Yne(c,d){const g=d&&d.a;if(d){if(d.hsl)return PT(d.hsl,g);if(d.hex&&d.hex.length>0)return PT(d.hex,g)}return PT(d,g)}function L0(c,d){const g=c===""?"#2d8cf0":c,M=Yne(c,g),C=M.toHsl(),b=M.toHsv();return C.s===0&&(C.h=g.h||g.hsl&&g.hsl.h||d||0,b.h=C.h),b.v<.0164&&(b.h=g.h||g.hsv&&g.hsv.h||0,b.s=g.s||g.hsv&&g.hsv.s||0),C.l<.01&&(C.h=g.h||g.hsl&&g.hsl.h||0,C.s=g.s||g.hsl&&g.hsl.s||0),{hsl:C,hex:M.toHexString().toUpperCase(),rgba:M.toRgb(),hsv:b,oldHue:g.h||d||C.h,source:g.source,a:g.a||M.getAlpha()}}function Ga(c,d,g){return c<d?d:c>g?g:c}function YN(c,d,g){return O(c,d)?g:0}function qN(c,d){return c.touches?c.touches[0][d]:0}function B0(c){const{r:d,g,b:M,a:C}=c;return`rgba(${[d,g,M,C].join(",")})`}const qne={name:"RecommendedColors",mixins:[jN,D0],emits:["picker-color","change"],props:{list:{type:Array,default:void 0}},data(){const c=Math.ceil(this.list.length/12),d=1;return{left:-d,right:d,up:-d,down:d,powerKey:"shiftKey",grid:{x:1,y:1},rows:c,columns:12}},computed:{hideClass(){return`${this.prefixCls}-hide`},linearIndex(){return this.getLinearIndex(this.grid)},currentCircle(){return this.$refs[`color-circle-${this.linearIndex}`][0]}},methods:{getLinearIndex(c){return this.columns*(c.y-1)+c.x-1},getMaxLimit(c){return c==="x"?this.columns:this.rows},handleArrow(c,d,g){c.preventDefault(),c.stopPropagation(),this.blurColor();const M={...this.grid};c[this.powerKey]?g<0?M[d]=1:M[d]=this.getMaxLimit(d):M[d]+=g;const C=this.getLinearIndex(M);C>=0&&C<this.list.length&&(this.grid[d]=Ga(M[d],1,this.getMaxLimit(d))),this.focusColor()},blurColor(){this.currentCircle.classList.add(this.hideClass)},focusColor(){this.currentCircle.classList.remove(this.hideClass)},handleEnter(c){this.handleClick(c,this.currentCircle)},handleClick(c,d){c.preventDefault(),c.stopPropagation(),this.$refs.reference.focus();const g=d||c.target,M=g.dataset.colorId||g.parentElement.dataset.colorId;if(M){this.blurColor();const C=Number(M)+1;this.grid.x=C%this.columns||this.columns,this.grid.y=Math.ceil(C/this.columns),this.focusColor(),this.$emit("picker-color",this.list[M]),this.$emit("change",{hex:this.list[M],source:"hex"})}},lineBreak(c,d){if(!d)return!1;const g=d+1;return g<c.length&&g%this.columns===0}}},Zne=["data-color-id"],Kne={key:0};function Jne(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{ref:"reference",tabindex:"0",onClick:d[0]||(d[0]=(...B)=>b.handleClick&&b.handleClick(...B)),onKeydown:[d[1]||(d[1]=i.withKeys((...B)=>c.handleEscape&&c.handleEscape(...B),["esc"])),d[2]||(d[2]=i.withKeys((...B)=>b.handleEnter&&b.handleEnter(...B),["enter"])),d[3]||(d[3]=i.withKeys(B=>b.handleArrow(B,"x",C.left),["left"])),d[4]||(d[4]=i.withKeys(B=>b.handleArrow(B,"x",C.right),["right"])),d[5]||(d[5]=i.withKeys(B=>b.handleArrow(B,"y",C.up),["up"])),d[6]||(d[6]=i.withKeys(B=>b.handleArrow(B,"y",C.down),["down"]))],onBlur:d[7]||(d[7]=(...B)=>b.blurColor&&b.blurColor(...B)),onFocus:d[8]||(d[8]=(...B)=>b.focusColor&&b.focusColor(...B))},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.list,(B,F)=>(i.openBlock(),i.createElementBlock(i.Fragment,{key:B+":"+F},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-picker-colors-wrapper"])},[i.createElementVNode("div",{"data-color-id":F},[i.createElementVNode("div",{style:i.normalizeStyle({background:B}),class:i.normalizeClass([c.prefixCls+"-picker-colors-wrapper-color"])},null,6),i.createElementVNode("div",{ref_for:!0,ref:"color-circle-"+F,class:i.normalizeClass([c.prefixCls+"-picker-colors-wrapper-circle",b.hideClass])},null,2)],8,Zne)],2),b.lineBreak(g.list,F)?(i.openBlock(),i.createElementBlock("br",Kne)):i.createCommentVNode("",!0)],64))),128))],544)}var ere=l(qne,[["render",Jne]]),$0={mixins:[jN],props:{focused:{type:Boolean,default:!1},value:{type:Object,default:void 0}},created(){this.focused&&setTimeout(()=>this.$el.focus(),1)},beforeUnmount(){this.unbindEventListeners()},methods:{handleLeft(c){this.handleSlide(c,this.left,"left")},handleRight(c){this.handleSlide(c,this.right,"right")},handleUp(c){this.handleSlide(c,this.up,"up")},handleDown(c){this.handleSlide(c,this.down,"down")},handleMouseDown(c){this.ColorPickerInstance.handleOnDragging(!0),this.handleChange(c,!0),o(window,"mousemove",this.handleChange),o(window,"mouseup",this.handleMouseUp)},handleMouseUp(){this.unbindEventListeners()},unbindEventListeners(){a(window,"mousemove",this.handleChange),a(window,"mouseup",this.handleMouseUp),setTimeout(()=>this.ColorPickerInstance.handleOnDragging(!1),1)},getLeft(c){if(!s)return;const{container:d}=this.$refs,g=d.getBoundingClientRect().left+window.pageXOffset;return(c.pageX||qN(c,"PageX"))-g},getTop(c){if(!s)return;const{container:d}=this.$refs,g=d.getBoundingClientRect().top+window.pageYOffset;return(c.pageY||qN(c,"PageY"))-g}}};const tre={name:"Saturation",mixins:[$0,D0],emits:["change"],data(){return{left:-.01,right:.01,up:.01,down:-.01,multiplier:10,powerKey:"shiftKey"}},computed:{bgColorStyle(){return{background:`hsl(${this.value.hsv.h}, 100%, 50%)`}},pointerStyle(){return{top:`${-(this.value.hsv.v*100)+1+100}%`,left:`${this.value.hsv.s*100}%`}}},methods:{change(c,d,g,M){this.$emit("change",{h:c,s:d,v:g,a:M,source:"hsva"})},handleSlide(c,d,g){c.preventDefault(),c.stopPropagation();const M=c[this.powerKey]?d*this.multiplier:d,{h:C,s:b,v:B,a:F}=this.value.hsv,Y=Ga(b+YN(g,["left","right"],M),0,1),G=Ga(B+YN(g,["up","down"],M),0,1);this.change(C,Y,G,F)},handleChange(c){c.preventDefault(),c.stopPropagation();const{clientWidth:d,clientHeight:g}=this.$refs.container,M=Ga(this.getLeft(c),0,d),C=Ga(this.getTop(c),0,g),b=M/d,B=Ga(1-C/g,0,1);this.change(this.value.hsv.h,b,B,this.value.hsv.a)},handleMouseDown(c){$0.methods.handleMouseDown.call(this,c),o(window,"mouseup",this.handleChange)},unbindEventListeners(c){$0.methods.unbindEventListeners.call(this,c),a(window,"mouseup",this.handleChange)}}};function ire(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([c.prefixCls+"-saturation-wrapper"]),tabindex:"0",onKeydown:[d[1]||(d[1]=i.withKeys((...B)=>c.handleEscape&&c.handleEscape(...B),["esc"])),d[3]||(d[3]=i.withKeys((...B)=>c.handleLeft&&c.handleLeft(...B),["left"])),d[4]||(d[4]=i.withKeys((...B)=>c.handleRight&&c.handleRight(...B),["right"])),d[5]||(d[5]=i.withKeys((...B)=>c.handleUp&&c.handleUp(...B),["up"])),d[6]||(d[6]=i.withKeys((...B)=>c.handleDown&&c.handleDown(...B),["down"]))],onClick:d[2]||(d[2]=B=>c.$el.focus())},[i.createElementVNode("div",{ref:"container",style:i.normalizeStyle(b.bgColorStyle),class:i.normalizeClass([c.prefixCls+"-saturation"]),onMousedown:d[0]||(d[0]=(...B)=>b.handleMouseDown&&b.handleMouseDown(...B))},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-saturation--white"])},null,2),i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-saturation--black"])},null,2),i.createElementVNode("div",{style:i.normalizeStyle(b.pointerStyle),class:i.normalizeClass([c.prefixCls+"-saturation-pointer"])},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-saturation-circle"])},null,2)],6)],38)],34)}var nre=l(tre,[["render",ire]]);const rre={name:"Hue",mixins:[$0,D0],emits:["change"],data(){const c=.06944444444444445,d=20*c;return{left:-c,right:c,up:d,down:-d,powerKey:"shiftKey",percent:Ga(this.value.hsl.h*100/360,0,100)}},watch:{value(){this.percent=Ga(this.value.hsl.h*100/360,0,100)}},methods:{change(c){this.percent=Ga(c,0,100);const{h:d,s:g,l:M,a:C}=this.value.hsl,b=Ga(c/100*360,0,360);d!==b&&this.$emit("change",{h:b,s:g,l:M,a:C,source:"hsl"})},handleSlide(c,d){if(c.preventDefault(),c.stopPropagation(),c[this.powerKey]){this.change(d<0?0:100);return}this.change(this.percent+d)},handleChange(c){c.preventDefault(),c.stopPropagation();const d=this.getLeft(c);if(d<0){this.change(0);return}const{clientWidth:g}=this.$refs.container;if(d>g){this.change(100);return}this.change(d*100/g)}}};function sre(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([c.prefixCls+"-hue"]),tabindex:"0",onClick:d[3]||(d[3]=B=>c.$el.focus()),onKeydown:[d[4]||(d[4]=i.withKeys((...B)=>c.handleEscape&&c.handleEscape(...B),["esc"])),d[5]||(d[5]=i.withKeys((...B)=>c.handleLeft&&c.handleLeft(...B),["left"])),d[6]||(d[6]=i.withKeys((...B)=>c.handleRight&&c.handleRight(...B),["right"])),d[7]||(d[7]=i.withKeys((...B)=>c.handleUp&&c.handleUp(...B),["up"])),d[8]||(d[8]=i.withKeys((...B)=>c.handleDown&&c.handleDown(...B),["down"]))]},[i.createElementVNode("div",{ref:"container",class:i.normalizeClass([c.prefixCls+"-hue-container"]),onMousedown:d[0]||(d[0]=(...B)=>c.handleMouseDown&&c.handleMouseDown(...B)),onTouchmove:d[1]||(d[1]=(...B)=>b.handleChange&&b.handleChange(...B)),onTouchstart:d[2]||(d[2]=(...B)=>b.handleChange&&b.handleChange(...B))},[i.createElementVNode("div",{style:i.normalizeStyle({top:0,left:`${C.percent}%`}),class:i.normalizeClass([c.prefixCls+"-hue-pointer"])},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-hue-picker"])},null,2)],6)],34)],34)}var ore=l(rre,[["render",sre]]);const are={name:"Alpha",mixins:[$0,D0],emits:["change"],data(){return{left:-1,right:1,up:10,down:-10,powerKey:"shiftKey"}},computed:{gradientStyle(){const{r:c,g:d,b:g}=this.value.rgba,M=B0({r:c,g:d,b:g,a:0}),C=B0({r:c,g:d,b:g,a:1});return{background:`linear-gradient(to right, ${M} 0%, ${C} 100%)`}}},methods:{change(c){const{h:d,s:g,l:M}=this.value.hsl,{a:C}=this.value;C!==c&&this.$emit("change",{h:d,s:g,l:M,a:c,source:"rgba"})},handleSlide(c,d){c.preventDefault(),c.stopPropagation(),this.change(Ga(c[this.powerKey]?d:Math.round(this.value.hsl.a*100+d)/100,0,1))},handleChange(c){c.preventDefault(),c.stopPropagation();const d=this.getLeft(c);if(d<0){this.change(0);return}const{clientWidth:g}=this.$refs.container;if(d>g){this.change(1);return}this.change(Math.round(d*100/g)/100)}}};function lre(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([c.prefixCls+"-alpha"]),tabindex:"0",onClick:d[3]||(d[3]=B=>c.$el.focus()),onKeydown:[d[4]||(d[4]=i.withKeys((...B)=>c.handleEscape&&c.handleEscape(...B),["esc"])),d[5]||(d[5]=i.withKeys((...B)=>c.handleLeft&&c.handleLeft(...B),["left"])),d[6]||(d[6]=i.withKeys((...B)=>c.handleRight&&c.handleRight(...B),["right"])),d[7]||(d[7]=i.withKeys((...B)=>c.handleUp&&c.handleUp(...B),["up"])),d[8]||(d[8]=i.withKeys((...B)=>c.handleDown&&c.handleDown(...B),["down"]))]},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-alpha-checkboard-wrap"])},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-alpha-checkerboard"])},null,2)],2),i.createElementVNode("div",{style:i.normalizeStyle(b.gradientStyle),class:i.normalizeClass([c.prefixCls+"-alpha-gradient"])},null,6),i.createElementVNode("div",{ref:"container",class:i.normalizeClass([c.prefixCls+"-alpha-container"]),onMousedown:d[0]||(d[0]=(...B)=>c.handleMouseDown&&c.handleMouseDown(...B)),onTouchmove:d[1]||(d[1]=(...B)=>b.handleChange&&b.handleChange(...B)),onTouchstart:d[2]||(d[2]=(...B)=>b.handleChange&&b.handleChange(...B))},[i.createElementVNode("div",{style:i.normalizeStyle({top:0,left:`${c.value.a*100}%`}),class:i.normalizeClass([c.prefixCls+"-alpha-pointer"])},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-alpha-picker"])},null,2)],6)],34)],34)}var cre=l(are,[["render",lre]]);const hre={name:"ColorPicker",components:{Drop:Ye,RecommendColors:ere,Saturation:nre,Hue:ore,Alpha:cre,iInput:ua,iButton:Us,Icon:S},directives:{clickOutside:Ti},mixins:[gn,D0,Ei,za],emits:["on-active-change","on-open-change","on-change","on-pick-success","on-pick-clear","update:modelValue"],provide(){return{ColorPickerInstance:this}},props:{modelValue:{type:String,default:void 0},hue:{type:Boolean,default:!0},alpha:{type:Boolean,default:!1},recommend:{type:Boolean,default:!1},format:{type:String,validator(c){return O(c,["hsl","hsv","hex","rgb"])},default:void 0},colors:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},hideDropDown:{type:Boolean,default:!1},placement:{type:String,validator(c){return O(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String,default:void 0},editable:{type:Boolean,default:!0},capture:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},transferClassName:{type:String},eventsEnabled:{type:Boolean,default:!1}},data(){return{val:L0(this.modelValue||""),currentValue:this.modelValue||"",dragging:!1,visible:!1,recommendedColor:["#2d8cf0","#19be6b","#ff9900","#ed4014","#00b5ff","#19c919","#f9e31c","#ea1a1a","#9b1dea","#00c2b1","#ac7a33","#1d35ea","#8bc34a","#f16b62","#ea4ca3","#0d94aa","#febd79","#5d4037","#00bcd4","#f06292","#cddc39","#607d8b","#000000","#ffffff"]}},computed:{arrowClasses(){return[`${this.inputPrefixCls}-icon`,`${this.inputPrefixCls}-icon-normal`]},transition(){return O(this.placement,["bottom-start","bottom","bottom-end"])?"slide-up":"fade"},saturationColors:{get(){return this.val},set(c){this.val=c,this.$emit("on-active-change",this.formatColor)}},classes(){return[`${this.prefixCls}`,{[`${this.prefixCls}-transfer`]:this.transfer}]},wrapClasses(){return[`${this.prefixCls}-rel`,`${this.prefixCls}-${this.size}`,`${this.inputPrefixCls}-wrapper`,`${this.inputPrefixCls}-wrapper-${this.size}`,{[`${this.prefixCls}-disabled`]:this.itemDisabled}]},inputClasses(){return[`${this.prefixCls}-input`,`${this.inputPrefixCls}`,`${this.inputPrefixCls}-${this.size}`,{[`${this.prefixCls}-focused`]:this.visible,[`${this.prefixCls}-disabled`]:this.itemDisabled}]},dropClasses(){return{[`${this.transferPrefixCls}-no-max-height`]:!0,[`${this.prefixCls}-transfer`]:this.transfer,[`${this.prefixCls}-hide-drop`]:this.hideDropDown,[this.transferClassName]:this.transferClassName}},displayedColorStyle(){return{backgroundColor:B0(this.visible?this.saturationColors.rgba:Qt(this.modelValue).toRgb())}},formatColor(){const{format:c,saturationColors:d}=this;if(c){if(c==="hsl")return Qt(d.hsl).toHslString();if(c==="hsv")return Qt(d.hsv).toHsvString();if(c==="hex")return d.hex;if(c==="rgb")return B0(d.rgba)}else if(this.alpha)return B0(d.rgba);return d.hex},confirmColorClasses(){return[`${this.prefixCls}-confirm-color`,{[`${this.prefixCls}-confirm-color-editable`]:this.editable}]},arrowType(){const c=this.globalConfig;let d="ios-arrow-down";return c&&(c.colorPicker.customArrow?d="":c.colorPicker.arrow&&(d=c.colorPicker.arrow)),d},customArrowType(){const c=this.globalConfig;let d="";return c&&c.colorPicker.customArrow&&(d=c.colorPicker.customArrow),d},arrowSize(){const c=this.globalConfig;let d="";return c&&c.colorPicker.arrowSize&&(d=c.colorPicker.arrowSize),d}},watch:{modelValue(c){this.val=L0(c||"")},visible(c){this.val=L0(this.modelValue||""),this.$refs.drop[c?"update":"destroy"](),this.$emit("on-open-change",!!c)}},methods:{setDragging(c){this.dragging=c},handleClose(c){if(this.visible){if(this.dragging||c.type==="mousedown"){this.$refs.editColorInput&&c.target!==this.$refs.editColorInput.$el.querySelector("input")&&c.preventDefault();return}if(this.transfer){const d=this.$refs.drop.$refs.drop;if(d===c.target||d.contains(c.target))return}this.closer(c);return}this.visible=!1},toggleVisible(){this.itemDisabled||(this.visible=!this.visible,this.$refs.input.focus())},childChange(c){this.colorChange(c)},colorChange(c,d){this.oldHue=this.saturationColors.hsl.h,this.saturationColors=L0(c,d||this.oldHue)},closer(c){c&&(c.preventDefault(),c.stopPropagation()),this.visible=!1,this.$refs.input.focus()},handleButtons(c,d){this.currentValue=d,this.$emit("update:modelValue",d),this.$emit("on-change",d),this.handleFormItemChange("change",d),this.closer(c)},handleSuccess(c){this.handleButtons(c,this.formatColor),this.$emit("on-pick-success")},handleClear(c){this.handleButtons(c,""),this.$emit("on-pick-clear")},handleSelectColor(c){this.val=L0(c),this.$emit("on-active-change",this.formatColor)},handleEditColor(c){const d=c.target.value;this.handleSelectColor(d)},handleFirstTab(c){c.shiftKey&&(c.preventDefault(),c.stopPropagation(),this.$refs.ok.$el.focus())},handleLastTab(c){c.shiftKey||(c.preventDefault(),c.stopPropagation(),this.$refs.saturation.$el.focus())},onTab(c){this.visible&&c.preventDefault()},onEscape(c){this.visible&&this.closer(c)},onArrow(c){this.visible||(c.preventDefault(),c.stopPropagation(),this.visible=!0)},handleOnEscapeKeydown(c){this.closer(c)},handleOnDragging(c){this.setDragging(c)}}},ure=["name","value"],dre=["tabindex"];function fre(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("Saturation"),Y=i.resolveComponent("Hue"),G=i.resolveComponent("Alpha"),K=i.resolveComponent("recommend-colors"),fe=i.resolveComponent("i-input"),Ee=i.resolveComponent("i-button"),Ce=i.resolveComponent("Drop"),Oe=i.resolveDirective("click-outside");return i.withDirectives((i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.createElementVNode("div",{ref:"reference",class:i.normalizeClass(b.wrapClasses),onClick:d[4]||(d[4]=(...ue)=>b.toggleVisible&&b.toggleVisible(...ue))},[i.createElementVNode("input",{name:g.name,value:C.currentValue,type:"hidden"},null,8,ure),i.createVNode(B,{type:b.arrowType,custom:b.customArrowType,size:b.arrowSize,class:i.normalizeClass(b.arrowClasses)},null,8,["type","custom","size","class"]),i.createElementVNode("div",{ref:"input",tabindex:c.itemDisabled?void 0:0,class:i.normalizeClass(b.inputClasses),onKeydown:[d[0]||(d[0]=i.withKeys((...ue)=>b.onTab&&b.onTab(...ue),["tab"])),d[1]||(d[1]=i.withKeys((...ue)=>b.onEscape&&b.onEscape(...ue),["esc"])),d[2]||(d[2]=i.withKeys((...ue)=>b.onArrow&&b.onArrow(...ue),["up"])),d[3]||(d[3]=i.withKeys((...ue)=>b.onArrow&&b.onArrow(...ue),["down"]))]},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-color"])},[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-color-empty"])},[i.createElementVNode("i",{class:i.normalizeClass([c.iconPrefixCls,c.iconPrefixCls+"-ios-close"])},null,2)],2),[[i.vShow,g.modelValue===""&&!C.visible]]),i.withDirectives(i.createElementVNode("div",{style:i.normalizeStyle(b.displayedColorStyle)},null,4),[[i.vShow,g.modelValue||C.visible]])],2)],42,dre)],2),i.createVNode(Ce,{ref:"drop",visible:C.visible,placement:g.placement,transfer:g.transfer,classes:b.dropClasses,eventsEnabled:g.eventsEnabled,"transition-name":"transition-drop"},{default:i.withCtx(()=>[i.createVNode(i.Transition,{name:"fade"},{default:i.withCtx(()=>[C.visible?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([c.prefixCls+"-picker"])},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-picker-wrapper"])},[i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-picker-panel"])},[i.createVNode(F,{ref:"saturation",value:b.saturationColors,focused:C.visible,onChange:b.childChange,onKeydown:i.withKeys(b.handleFirstTab,["tab"])},null,8,["value","focused","onChange","onKeydown"])],2),g.hue?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([c.prefixCls+"-picker-hue-slider"])},[i.createVNode(Y,{value:b.saturationColors,onChange:b.childChange},null,8,["value","onChange"])],2)):i.createCommentVNode("",!0),g.alpha?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass([c.prefixCls+"-picker-alpha-slider"])},[i.createVNode(G,{value:b.saturationColors,onChange:b.childChange},null,8,["value","onChange"])],2)):i.createCommentVNode("",!0),g.colors.length?(i.openBlock(),i.createBlock(K,{key:2,list:g.colors,class:i.normalizeClass([c.prefixCls+"-picker-colors"]),onPickerColor:b.handleSelectColor},null,8,["list","class","onPickerColor"])):i.createCommentVNode("",!0),!g.colors.length&&g.recommend?(i.openBlock(),i.createBlock(K,{key:3,list:C.recommendedColor,class:i.normalizeClass([c.prefixCls+"-picker-colors"]),onPickerColor:b.handleSelectColor},null,8,["list","class","onPickerColor"])):i.createCommentVNode("",!0)],2),i.createElementVNode("div",{class:i.normalizeClass([c.prefixCls+"-confirm"])},[i.createElementVNode("span",{class:i.normalizeClass(b.confirmColorClasses)},[g.editable?(i.openBlock(),i.createBlock(fe,{key:0,ref:"editColorInput",modelValue:b.formatColor,size:"small",onOnEnter:b.handleEditColor,onOnBlur:b.handleEditColor},null,8,["modelValue","onOnEnter","onOnBlur"])):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createTextVNode(i.toDisplayString(b.formatColor),1)],64))],2),i.createVNode(Ee,{class:i.normalizeClass([c.prefixCls+"-confirm-btn-cancel"]),ref:"clear",tabindex:0,size:"small",onClick:b.handleClear,onKeydown:[i.withKeys(b.handleClear,["enter"]),i.withKeys(b.closer,["esc"])]},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(c.t("i.datepicker.clear")),1)]),_:1},8,["class","onClick","onKeydown"]),i.createVNode(Ee,{ref:"ok",tabindex:0,size:"small",type:"primary",onClick:b.handleSuccess,onKeydown:[i.withKeys(b.handleLastTab,["tab"]),i.withKeys(b.handleSuccess,["enter"]),i.withKeys(b.closer,["esc"])]},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(c.t("i.datepicker.ok")),1)]),_:1},8,["onClick","onKeydown"])],2)],2)):i.createCommentVNode("",!0)]),_:1})]),_:1},8,["visible","placement","transfer","classes","eventsEnabled"])],2)),[[Oe,b.handleClose,g.capture]])}var ZN=l(hre,[["render",fre]]);const pre="ivu-layout",mre={name:"Content",computed:{wrapClasses(){return`${pre}-content`}}};function gre(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses)},[i.renderSlot(c.$slots,"default")],2)}var RT=l(mre,[["render",gre]]);function vre(c){var d;if(c.nodeName==="SELECT")c.focus(),d=c.value;else if(c.nodeName==="INPUT"||c.nodeName==="TEXTAREA"){var g=c.hasAttribute("readonly");g||c.setAttribute("readonly",""),c.select(),c.setSelectionRange(0,c.value.length),g||c.removeAttribute("readonly"),d=c.value}else{c.hasAttribute("contenteditable")&&c.focus();var M=window.getSelection(),C=document.createRange();C.selectNodeContents(c),M.removeAllRanges(),M.addRange(C),d=M.toString()}return d}var yre=vre,KN={name:"RenderCell",props:{render:Function},render(){return this.render(i.h)}};const bre={components:{RenderCell:KN},props:{prefixCls:{type:String,default:""},duration:{type:Number,default:1.5},type:{type:String},content:{type:String,default:""},withIcon:Boolean,render:{type:Function},hasTitle:Boolean,styles:{type:Object,default:function(){return{right:"50%"}}},closable:{type:Boolean,default:!1},className:{type:String},name:{type:String,required:!0},onClose:{type:Function},transitionName:{type:String},background:{type:Boolean,default:!1},msgType:{type:String}},data(){return{withDesc:!1}},computed:{baseClass(){return`${this.prefixCls}-notice`},renderFunc(){return this.render||function(){}},classes(){return[this.baseClass,{[`${this.className}`]:!!this.className,[`${this.baseClass}-closable`]:this.closable,[`${this.baseClass}-with-desc`]:this.withDesc,[`${this.baseClass}-with-background`]:this.background}]},contentClasses(){return[`${this.baseClass}-content`,this.render!==void 0?`${this.baseClass}-content-with-render`:""]},messageContentClasses(){return[`${this.baseClass}-content`,{[`${this.baseClass}-content-${this.msgType}`]:this.msgType,[`${this.baseClass}-content-background`]:this.background}]},contentWithIcon(){return[this.withIcon?`${this.prefixCls}-content-with-icon`:"",!this.hasTitle&&this.withIcon?`${this.prefixCls}-content-with-render-notitle`:""]},messageClasses(){return[`${this.baseClass}-content`,this.render!==void 0?`${this.baseClass}-content-with-render`:""]}},methods:{clearCloseTimer(){this.closeTimer&&(clearTimeout(this.closeTimer),this.closeTimer=null)},close(){this.clearCloseTimer(),this.onClose(),this.$parent.$parent.close(this.name)},handleEnter(c){this.type==="message"&&(c.style.height=c.scrollHeight+"px")},handleLeave(c){this.type==="message"&&s&&document.getElementsByClassName("ivu-message-notice").length!==1&&(c.style.height=0,c.style.paddingTop=0,c.style.paddingBottom=0)}},mounted(){if(this.handleEnter(this.$el),this.clearCloseTimer(),this.duration!==0&&(this.closeTimer=setTimeout(()=>{this.close()},this.duration*1e3)),this.prefixCls==="ivu-notice"){let c=this.$refs.content.querySelectorAll(`.${this.prefixCls}-desc`)[0];this.withDesc=this.render?!0:c?c.innerHTML!=="":!1}},beforeUnmount(){this.handleLeave(this.$el),this.clearCloseTimer()}},xre=["innerHTML"],wre=[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-close"},null,-1)],_re=["innerHTML"],Ore=[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-close"},null,-1)];function Sre(c,d,g,M,C,b){const B=i.resolveComponent("render-cell");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(g.styles)},[g.type==="notice"?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createElementVNode("div",{class:i.normalizeClass(b.contentClasses),ref:"content",innerHTML:g.content},null,10,xre),i.createElementVNode("div",{class:i.normalizeClass(b.contentWithIcon)},[i.createVNode(B,{render:b.renderFunc},null,8,["render"])],2),g.closable?(i.openBlock(),i.createElementBlock("a",{key:0,class:i.normalizeClass([b.baseClass+"-close"]),onClick:d[0]||(d[0]=(...F)=>b.close&&b.close(...F))},wre,2)):i.createCommentVNode("",!0)],64)):i.createCommentVNode("",!0),g.type==="message"?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass(b.messageContentClasses),ref:"content"},[i.createElementVNode("div",{class:i.normalizeClass([b.baseClass+"-content-text"]),innerHTML:g.content},null,10,_re),i.createElementVNode("div",{class:i.normalizeClass([b.baseClass+"-content-text"])},[i.createVNode(B,{render:b.renderFunc},null,8,["render"])],2),g.closable?(i.openBlock(),i.createElementBlock("a",{key:0,class:i.normalizeClass([b.baseClass+"-close"]),onClick:d[1]||(d[1]=(...F)=>b.close&&b.close(...F))},Ore,2)):i.createCommentVNode("",!0)],2)):i.createCommentVNode("",!0)],6)}var Cre=l(bre,[["render",Sre]]);const Tre="ivu-notification";let Ere=0;const Mre=Date.now();function Are(){return"ivuNotification_"+Mre+"_"+Ere++}const kre={components:{Notice:Cre},props:{prefixCls:{type:String,default:Tre},styles:{type:Object,default:function(){return{top:"65px",left:"50%"}}},content:{type:String},className:{type:String},transitionName:{type:String}},data(){return{notices:[],tIndex:this.handleGetIndex()}},computed:{classes(){return[`${this.prefixCls}`,{[`${this.className}`]:!!this.className}]},wrapStyles(){let c=Object.assign({},this.styles);return c["z-index"]=1010+this.tIndex,c}},methods:{add(c){const d=c.name||Are();let g=Object.assign({styles:{right:"50%"},content:"",duration:1.5,closable:!1,name:d},c);this.notices.push(g),this.tIndex=this.handleGetIndex()},close(c){const d=this.notices;for(let g=0;g<d.length;g++)if(d[g].name===c){this.notices.splice(g,1);break}},closeAll(){this.notices=[]},handleGetIndex(){return He(),Te}}};function Pre(c,d,g,M,C,b){const B=i.resolveComponent("Notice");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.wrapStyles)},[i.createVNode(i.TransitionGroup,{name:g.transitionName,appear:""},{default:i.withCtx(()=>[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(C.notices,F=>(i.openBlock(),i.createBlock(B,{key:F.name,"prefix-cls":g.prefixCls,styles:F.styles,type:F.type,content:F.content,duration:F.duration,render:F.render,"has-title":F.hasTitle,withIcon:F.withIcon,closable:F.closable,name:F.name,"transition-name":F.transitionName,background:F.background,"msg-type":F.msgType,"on-close":F.onClose},null,8,["prefix-cls","styles","type","content","duration","render","has-title","withIcon","closable","name","transition-name","background","msg-type","on-close"]))),128))]),_:1},8,["name"])],6)}var Tx=l(kre,[["render",Pre]]);Tx.newInstance=c=>{if(!s)return;const d=c||{};let g=null;const M=i.createApp({render(){return i.h(Tx,Object.assign({ref:"notification"},d))},created(){g=i.getCurrentInstance()}}),C=document.createElement("div");document.body.appendChild(C),M.mount(C);const b=g.refs.notification;return{notice(B){b.add(B)},remove(B){b.close(B)},component:b,destroy(B){b.closeAll(),s&&setTimeout(function(){document.body.removeChild(document.getElementsByClassName(B)[0])},500)}}};const IT="ivu-message",JN="ivu-icon",eD="ivu_message_key_",Vp={top:24,duration:1.5,background:!1};let Ex,tD=1;const Rre={info:"ios-information-circle",success:"ios-checkmark-circle",warning:"ios-alert",error:"ios-close-circle",loading:"ios-loading"},iD="move-up";function nD(){return Ex=Ex||Tx.newInstance({prefixCls:IT,styles:{top:`${Vp.top}px`},transitionName:iD}),Ex}function Ire(c="",d=Vp.duration,g,M=function(){},C=!1,b=function(){},B=Vp.background){const F=Rre[g],Y=g==="loading"?" ivu-load-loop":"";let G=nD();return G.notice({name:`${eD}${tD}`,duration:d,styles:{},transitionName:iD,content:`
            <div class="${IT}-custom-content ${IT}-${g}">
                <i class="${JN} ${JN}-${F} ${Y}"></i>
                <span>${c}</span>
            </div>
        `,render:b,onClose:M,closable:C,type:"message",msgType:g,background:B}),function(){let K=tD++;return function(){G.remove(`${eD}${K}`)}}()}var U0={name:"Message",info(c){return this.message("info",c)},success(c){return this.message("success",c)},warning(c){return this.message("warning",c)},error(c){return this.message("error",c)},loading(c){return this.message("loading",c)},message(c,d){return typeof d=="string"&&(d={content:d}),Ire(d.content,d.duration,c,d.onClose,d.closable,d.render,d.background)},config(c){(c.top||c.top===0)&&(Vp.top=c.top),(c.duration||c.duration===0)&&(Vp.duration=c.duration),c.background&&(Vp.background=c.background)},destroy(){let c=nD();Ex=null,c.destroy("ivu-message")}};const Nre="复制成功",Dre="复制失败";function Mx({text:c="",successTip:d=Nre,errorTip:g=Dre,success:M,error:C,showTip:b=!0}){if(!s)return;const B=document.documentElement.getAttribute("dir")==="rtl",F=document.createElement("textarea");F.style.fontSize="12pt",F.style.border="0",F.style.padding="0",F.style.margin="0",F.style.position="absolute",F.style[B?"right":"left"]="-9999px";let Y=window.pageYOffset||document.documentElement.scrollTop;F.style.top=`${Y}px`,F.setAttribute("readonly",""),F.value=c,document.body.appendChild(F),yre(F);let G;try{G=document.execCommand("copy"),b&&U0.success({content:d}),document.body.removeChild(F),M&&M.call()}catch{G=!1,b&&U0.error({content:g}),document.body.removeChild(F),C&&C.call()}}function NT(c){return c*1<10?`0${c}`:c}const Lre={name:"CountDown",emits:["on-end"],props:{format:{type:Function},target:{type:[Date,Number]},interval:{type:Number,default:1e3}},data(){return{lastTime:""}},methods:{initTime(){let c=0,d=0;try{Object.prototype.toString.call(this.target)==="[object Date]"?d=this.target.getTime():d=new Date(this.target).getTime()}catch(g){throw new Error("invalid target prop",g)}return c=d-new Date().getTime(),c<0?0:c},tick(){let{lastTime:c}=this;this.timer=setTimeout(()=>{c<this.interval?(clearTimeout(this.timer),this.lastTime=0,this.$emit("on-end")):(c-=this.interval,this.lastTime=c,this.tick())},this.interval)},defaultFormat(c){const d=Math.floor(c/36e5),g=Math.floor((c-d*36e5)/6e4),M=Math.floor((c-d*36e5-g*6e4)/1e3);return`${NT(d)}:${NT(g)}:${NT(M)}`}},computed:{result(){const{format:c=this.defaultFormat}=this;return c(this.lastTime)}},watch:{target(){this.timer&&clearTimeout(this.timer),this.lastTime=this.initTime(),this.tick()}},created(){this.lastTime=this.initTime()},mounted(){this.tick()},beforeUnmount(){this.timer&&clearTimeout(this.timer)}};function Bre(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("span",null,i.toDisplayString(b.result),1)}var rD=l(Lre,[["render",Bre]]),DT={exports:{}};(function(c,d){(function(g,M){c.exports=M(q,d,c)})(ie,function(g,M,C){var b=function(B,F,Y,G,K,fe){function Ee(je){var Le,tt,Ze,ti,ii,$t,Mt=je<0;if(je=Math.abs(je).toFixed(ue.decimals),je+="",Le=je.split("."),tt=Le[0],Ze=Le.length>1?ue.options.decimal+Le[1]:"",ue.options.useGrouping){for(ti="",ii=0,$t=tt.length;ii<$t;++ii)ii!==0&&ii%3===0&&(ti=ue.options.separator+ti),ti=tt[$t-ii-1]+ti;tt=ti}return ue.options.numerals.length&&(tt=tt.replace(/[0-9]/g,function(Ft){return ue.options.numerals[+Ft]}),Ze=Ze.replace(/[0-9]/g,function(Ft){return ue.options.numerals[+Ft]})),(Mt?"-":"")+ue.options.prefix+tt+Ze+ue.options.suffix}function Ce(je,Le,tt,Ze){return tt*(-Math.pow(2,-10*je/Ze)+1)*1024/1023+Le}function Oe(je){return typeof je=="number"&&!isNaN(je)}var ue=this;if(ue.version=function(){return"1.9.3"},ue.options={useEasing:!0,useGrouping:!0,separator:",",decimal:".",easingFn:Ce,formattingFn:Ee,prefix:"",suffix:"",numerals:[]},fe&&typeof fe=="object")for(var Ne in ue.options)fe.hasOwnProperty(Ne)&&fe[Ne]!==null&&(ue.options[Ne]=fe[Ne]);ue.options.separator===""?ue.options.useGrouping=!1:ue.options.separator=""+ue.options.separator;for(var jt=0,_t=["webkit","moz","ms","o"],Et=0;Et<_t.length&&!window.requestAnimationFrame;++Et)window.requestAnimationFrame=window[_t[Et]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[_t[Et]+"CancelAnimationFrame"]||window[_t[Et]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(je,Le){var tt=new Date().getTime(),Ze=Math.max(0,16-(tt-jt)),ti=window.setTimeout(function(){je(tt+Ze)},Ze);return jt=tt+Ze,ti}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(je){clearTimeout(je)}),ue.initialize=function(){return!!ue.initialized||(ue.error="",ue.d=typeof B=="string"?document.getElementById(B):B,ue.d?(ue.startVal=Number(F),ue.endVal=Number(Y),Oe(ue.startVal)&&Oe(ue.endVal)?(ue.decimals=Math.max(0,G||0),ue.dec=Math.pow(10,ue.decimals),ue.duration=1e3*Number(K)||2e3,ue.countDown=ue.startVal>ue.endVal,ue.frameVal=ue.startVal,ue.initialized=!0,!0):(ue.error="[CountUp] startVal ("+F+") or endVal ("+Y+") is not a number",!1)):(ue.error="[CountUp] target is null or undefined",!1))},ue.printValue=function(je){var Le=ue.options.formattingFn(je);ue.d.tagName==="INPUT"?this.d.value=Le:ue.d.tagName==="text"||ue.d.tagName==="tspan"?this.d.textContent=Le:this.d.innerHTML=Le},ue.count=function(je){ue.startTime||(ue.startTime=je),ue.timestamp=je;var Le=je-ue.startTime;ue.remaining=ue.duration-Le,ue.options.useEasing?ue.countDown?ue.frameVal=ue.startVal-ue.options.easingFn(Le,0,ue.startVal-ue.endVal,ue.duration):ue.frameVal=ue.options.easingFn(Le,ue.startVal,ue.endVal-ue.startVal,ue.duration):ue.countDown?ue.frameVal=ue.startVal-(ue.startVal-ue.endVal)*(Le/ue.duration):ue.frameVal=ue.startVal+(ue.endVal-ue.startVal)*(Le/ue.duration),ue.countDown?ue.frameVal=ue.frameVal<ue.endVal?ue.endVal:ue.frameVal:ue.frameVal=ue.frameVal>ue.endVal?ue.endVal:ue.frameVal,ue.frameVal=Math.round(ue.frameVal*ue.dec)/ue.dec,ue.printValue(ue.frameVal),Le<ue.duration?ue.rAF=requestAnimationFrame(ue.count):ue.callback&&ue.callback()},ue.start=function(je){ue.initialize()&&(ue.callback=je,ue.rAF=requestAnimationFrame(ue.count))},ue.pauseResume=function(){ue.paused?(ue.paused=!1,delete ue.startTime,ue.duration=ue.remaining,ue.startVal=ue.frameVal,requestAnimationFrame(ue.count)):(ue.paused=!0,cancelAnimationFrame(ue.rAF))},ue.reset=function(){ue.paused=!1,delete ue.startTime,ue.initialized=!1,ue.initialize()&&(cancelAnimationFrame(ue.rAF),ue.printValue(ue.startVal))},ue.update=function(je){if(ue.initialize()){if(je=Number(je),!Oe(je))return void(ue.error="[CountUp] update() - new endVal is not a number: "+je);ue.error="",je!==ue.frameVal&&(cancelAnimationFrame(ue.rAF),ue.paused=!1,delete ue.startTime,ue.startVal=ue.frameVal,ue.endVal=je,ue.countDown=ue.startVal>ue.endVal,ue.rAF=requestAnimationFrame(ue.count))}},ue.initialize()&&ue.printValue(ue.startVal)};return b})})(DT,DT.exports);var $re=DT.exports;const Ure={name:"CountUp",props:{start:{type:Number,required:!1,default:0},end:{type:Number,required:!0},decimals:{type:Number,required:!1,default:0},duration:{type:Number,required:!1,default:2},options:{type:Object,required:!1,default(){return{}}},callback:{type:Function,required:!1,default:()=>{}}},data(){return{CountUp:null}},watch:{end(c){this.CountUp&&this.CountUp.update&&this.CountUp.update(c)}},mounted(){this.init()},methods:{init(){this.CountUp||(this.CountUp=new $re(this.$el,this.start,this.end,this.decimals,this.duration,this.options),this.CountUp.start(()=>{this.callback(this.CountUp)}))},destroy(){this.CountUp=null}},beforeUnmounted(){this.destroy()},start(c){this.CountUp&&this.CountUp.start&&this.CountUp.start(()=>{c&&c(this.CountUp)})},pauseResume(){this.CountUp&&this.CountUp.pauseResume&&this.CountUp.pauseResume()},reset(){this.CountUp&&this.CountUp.reset&&this.CountUp.reset()},update(c){this.CountUp&&this.CountUp.update&&this.CountUp.update(c)}},Vre={class:"ivu-count-up"};function Fre(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("span",Vre)}var sD=l(Ure,[["render",Fre]]),Ha={},oD=/d{1,4}|M{1,4}|yy(?:yy)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,Nd=/\d\d?/,zre=/\d{3}/,Xre=/\d{4}/,Ax=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,aD=function(){};function lD(c,d){for(var g=[],M=0,C=c.length;M<C;M++)g.push(c[M].substr(0,d));return g}function cD(c){return function(d,g,M){var C=M[c].indexOf(g.charAt(0).toUpperCase()+g.substr(1).toLowerCase());~C&&(d.month=C)}}function Al(c,d){for(c=String(c),d=d||2;c.length<d;)c="0"+c;return c}var hD=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],uD=["January","February","March","April","May","June","July","August","September","October","November","December"],Wre=lD(uD,3),Gre=lD(hD,3);Ha.i18n={dayNamesShort:Gre,dayNames:hD,monthNamesShort:Wre,monthNames:uD,amPm:["am","pm"],DoFn:function(c){return c+["th","st","nd","rd"][c%10>3?0:(c-c%10!==10)*c%10]}};var dD={D:function(c){return c.getDay()},DD:function(c){return Al(c.getDay())},Do:function(c,d){return d.DoFn(c.getDate())},d:function(c){return c.getDate()},dd:function(c){return Al(c.getDate())},ddd:function(c,d){return d.dayNamesShort[c.getDay()]},dddd:function(c,d){return d.dayNames[c.getDay()]},M:function(c){return c.getMonth()+1},MM:function(c){return Al(c.getMonth()+1)},MMM:function(c,d){return d.monthNamesShort[c.getMonth()]},MMMM:function(c,d){return d.monthNames[c.getMonth()]},yy:function(c){return String(c.getFullYear()).substr(2)},yyyy:function(c){return c.getFullYear()},h:function(c){return c.getHours()%12||12},hh:function(c){return Al(c.getHours()%12||12)},H:function(c){return c.getHours()},HH:function(c){return Al(c.getHours())},m:function(c){return c.getMinutes()},mm:function(c){return Al(c.getMinutes())},s:function(c){return c.getSeconds()},ss:function(c){return Al(c.getSeconds())},S:function(c){return Math.round(c.getMilliseconds()/100)},SS:function(c){return Al(Math.round(c.getMilliseconds()/10),2)},SSS:function(c){return Al(c.getMilliseconds(),3)},a:function(c,d){return c.getHours()<12?d.amPm[0]:d.amPm[1]},A:function(c,d){return c.getHours()<12?d.amPm[0].toUpperCase():d.amPm[1].toUpperCase()},ZZ:function(c){var d=c.getTimezoneOffset();return(d>0?"-":"+")+Al(Math.floor(Math.abs(d)/60)*100+Math.abs(d)%60,4)}},or={d:[Nd,function(c,d){c.day=d}],M:[Nd,function(c,d){c.month=d-1}],yy:[Nd,function(c,d){var g=new Date,M=+(""+g.getFullYear()).substr(0,2);c.year=""+(d>68?M-1:M)+d}],h:[Nd,function(c,d){c.hour=d}],m:[Nd,function(c,d){c.minute=d}],s:[Nd,function(c,d){c.second=d}],yyyy:[Xre,function(c,d){c.year=d}],S:[/\d/,function(c,d){c.millisecond=d*100}],SS:[/\d{2}/,function(c,d){c.millisecond=d*10}],SSS:[zre,function(c,d){c.millisecond=d}],D:[Nd,aD],ddd:[Ax,aD],MMM:[Ax,cD("monthNamesShort")],MMMM:[Ax,cD("monthNames")],a:[Ax,function(c,d,g){var M=d.toLowerCase();M===g.amPm[0]?c.isPm=!1:M===g.amPm[1]&&(c.isPm=!0)}],ZZ:[/[\+\-]\d\d:?\d\d/,function(c,d){var g=(d+"").match(/([\+\-]|\d\d)/gi),M;g&&(M=+(g[1]*60)+parseInt(g[2],10),c.timezoneOffset=g[0]==="+"?M:-M)}]};or.DD=or.DD,or.dddd=or.ddd,or.Do=or.dd=or.d,or.mm=or.m,or.hh=or.H=or.HH=or.h,or.MM=or.M,or.ss=or.s,or.A=or.a,Ha.masks={default:"ddd MMM dd yyyy HH:mm:ss",shortDate:"M/D/yy",mediumDate:"MMM d, yyyy",longDate:"MMMM d, yyyy",fullDate:"dddd, MMMM d, yyyy",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},Ha.format=function(c,d,g){var M=g||Ha.i18n;if(typeof c=="number"&&(c=new Date(c)),Object.prototype.toString.call(c)!=="[object Date]"||isNaN(c.getTime()))throw new Error("Invalid Date in fecha.format");return d=Ha.masks[d]||d||Ha.masks.default,d.replace(oD,function(C){return C in dD?dD[C](c,M):C.slice(1,C.length-1)})},Ha.parse=function(c,d,g){var M=g||Ha.i18n;if(typeof d!="string")throw new Error("Invalid format in fecha.parse");if(d=Ha.masks[d]||d,c.length>1e3)return!1;var C=!0,b={};if(d.replace(oD,function(Y){if(or[Y]){var G=or[Y],K=c.search(G[0]);~K?c.replace(G[0],function(fe){return G[1](b,fe,M),c=c.substr(K+fe.length),fe}):C=!1}return or[Y]?"":Y.slice(1,Y.length-1)}),!C)return!1;var B=new Date;b.isPm===!0&&b.hour!=null&&+b.hour!=12?b.hour=+b.hour+12:b.isPm===!1&&+b.hour==12&&(b.hour=0);var F;return b.timezoneOffset!=null?(b.minute=+(b.minute||0)-+b.timezoneOffset,F=new Date(Date.UTC(b.year||B.getFullYear(),b.month||0,b.day||1,b.hour||0,b.minute||0,b.second||0,b.millisecond||0))):F=new Date(b.year||B.getFullYear(),b.month||0,b.day||1,b.hour||0,b.minute||0,b.second||0,b.millisecond||0),F};const LT=function(c){let d=new Date(c);return isNaN(d.getTime())&&typeof c=="string"&&(d=c.split("-").map(Number),d[1]+=1,d=new Date(...d)),isNaN(d.getTime())?null:d},Vs=function(c){const d=new Date(c);return d.setHours(0,0,0,0),d.getTime()},Hre=(c,d,g)=>{if(!d||!g)return!1;const[M,C]=[d,g].sort();return c>=M&&c<=C},V0=function(c,d){return c=LT(c),c?Ha.format(c,d||"yyyy-MM-dd"):""},kx=function(c,d){return Ha.parse(c,d||"yyyy-MM-dd")},fD=function(c,d){return new Date(c,d+1,0).getDate()},pD=function(c,d){const g=new Date(c),M=g.getMonth()+d,C=fD(g.getFullYear(),M);return C<g.getDate()&&g.setDate(C),g.setMonth(M),g},kl=function(){const c=new Date;return c.setHours(0),c.setMinutes(0),c.setSeconds(0),c},BT=function(){const c={yyyy:g=>g.getFullYear(),m:g=>g.getMonth()+1,mm:g=>("0"+(g.getMonth()+1)).slice(-2),mmm:(g,M)=>g.toLocaleDateString(M,{month:"long"}).slice(0,3),Mmm:(g,M)=>{const C=g.toLocaleDateString(M,{month:"long"});return(C[0].toUpperCase()+C.slice(1).toLowerCase()).slice(0,3)},mmmm:(g,M)=>g.toLocaleDateString(M,{month:"long"}),Mmmm:(g,M)=>{const C=g.toLocaleDateString(M,{month:"long"});return C[0].toUpperCase()+C.slice(1).toLowerCase()}},d=new RegExp(["yyyy","Mmmm","mmmm","Mmm","mmm","mm","m"].join("|"),"g");return function(g,M,C){const b=/(\[[^\]]+\])([^\[\]]+)(\[[^\]]+\])/,B=M.match(b).slice(1),F=B[1],Y=[B[0],B[2]].map(G=>({label:G.replace(/\[[^\]]+\]/,K=>K.slice(1,-1).replace(d,fe=>c[fe](C,g))),type:G.indexOf("yy")!=-1?"year":"month"}));return{separator:F,labels:Y}}}(),mD={date:"yyyy-MM-dd",month:"yyyy-MM",year:"yyyy",datetime:"yyyy-MM-dd HH:mm:ss",time:"HH:mm:ss",timerange:"HH:mm:ss",daterange:"yyyy-MM-dd",datetimerange:"yyyy-MM-dd HH:mm:ss"},F0=function(c,d){return V0(c,d)},z0=function(c,d){return kx(c,d)},$T=function(c,d,g){if(Array.isArray(c)&&c.length===2){const M=c[0],C=c[1];if(M&&C)return V0(M,d)+g+V0(C,d)}else if(!Array.isArray(c)&&c instanceof Date)return V0(c,d);return""},UT=function(c,d,g){const M=Array.isArray(c)?c:c.split(g);if(M.length===2){const C=M[0],b=M[1];return[C instanceof Date?C:kx(C,d),b instanceof Date?b:kx(b,d)]}return[]},Fp={default:{formatter(c){return c?""+c:""},parser(c){return c===void 0||c===""?null:c}},date:{formatter:F0,parser:z0},datetime:{formatter:F0,parser:z0},daterange:{formatter:$T,parser:UT},datetimerange:{formatter:$T,parser:UT},timerange:{formatter:$T,parser:UT},time:{formatter:F0,parser:z0},month:{formatter:F0,parser:z0},year:{formatter:F0,parser:z0},multiple:{formatter:(c,d)=>c.filter(Boolean).map(g=>V0(g,d)).join(","),parser:(c,d)=>(typeof c=="string"?c.split(","):c).map(g=>g instanceof Date?g:(typeof g=="string"?g=g.trim():typeof g!="number"&&!g&&(g=""),kx(g,d)))},number:{formatter(c){return c?""+c:""},parser(c){let d=Number(c);return isNaN(c)?null:d}}},Px="ivu-date-picker",Qre="ivu-picker",jre=c=>c.reduce((d,g)=>d&&!g||typeof g=="string"&&g.trim()==="",!0),Yre={40:"up",39:"right",38:"down",37:"left"},zp=(c,d,g)=>{if(c==="left")return d*-1;if(c==="right")return d*1;if(c==="up")return g*1;if(c==="down")return g*-1},qre=c=>{const d="ivu-date-picker-btn-pulse";c.classList.add(d),setTimeout(()=>c.classList.remove(d),200)},VT=c=>c?[c.getHours(),c.getMinutes(),c.getSeconds()]:[0,0,0],Zre={mixins:[Ei,za],components:{iInput:ua,Drop:Ye,Icon:S},directives:{clickOutside:Ti},emits:["on-clickoutside","on-clear","on-change","on-ok","on-open-change","update:modelValue"],provide(){return{PickerInstance:this}},props:{format:{type:String},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},confirm:{type:Boolean,default:!1},open:{type:Boolean,default:null},multiple:{type:Boolean,default:!1},timePickerOptions:{type:Object,default:()=>({})},splitPanels:{type:Boolean,default:!1},showWeekNumbers:{type:Boolean,default:!1},startDate:{type:Date},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},placeholder:{type:String,default:""},placement:{validator(c){return O(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom-start"},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},steps:{type:Array,default:()=>[]},modelValue:{type:[Date,String,Array]},options:{type:Object,default:()=>({})},separator:{type:String,default:" - "},capture:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},transferClassName:{type:String},eventsEnabled:{type:Boolean,default:!1}},data(){const c=this.type.includes("range"),d=c?[null,null]:[null],g=jre((c?this.modelValue:[this.modelValue])||[])?d:this.parseDate(this.modelValue),M=g.map(VT);return{prefixCls:Px,showClose:!1,visible:!1,internalValue:g,disableClickOutSide:!1,disableCloseUnderTransfer:!1,selectionMode:this.onSelectionModeChange(this.type),forceInputRerender:1,isFocused:!1,focusedDate:g[0]||this.startDate||new Date,focusedTime:{column:0,picker:0,time:M,active:!1},internalFocus:!1,isValueNull:!1,timeSpinnerList:[],panelTableList:[]}},computed:{wrapperClasses(){return[Px,{[Px+"-focused"]:this.isFocused}]},publicVModelValue(){if(this.multiple)return this.internalValue.slice();{const c=this.type.includes("range");let d=this.internalValue.map(g=>g instanceof Date?new Date(g):g||"");return this.type.match(/^time/)&&(d=d.map(this.formatDate)),c||this.multiple?d:d[0]}},publicStringValue(){const{formatDate:c,publicVModelValue:d,type:g}=this;return g.match(/^time/)?d:this.multiple?c(d):Array.isArray(d)?d.map(c):c(d)},opened(){return this.open===null?this.visible:this.open},transition(){return this.placement.match(/^bottom/)?"slide-up":"slide-down"},visualValue(){return this.formatDate(this.internalValue)},isConfirm(){return this.confirm||this.type==="datetime"||this.type==="datetimerange"||this.multiple},arrowType(){const c=this.globalConfig;let d="";if(this.type==="time"||this.type==="timerange")d="ios-time-outline",c&&(c.timePicker.customIcon?d="":c.timePicker.icon&&(d=c.timePicker.icon));else{const g=this.globalConfig;d="ios-calendar-outline",g&&(g.datePicker.customIcon?d="":g.datePicker.icon&&(d=g.datePicker.icon))}return this.showClose&&(d="ios-close-circle"),d},customArrowType(){const c=this.globalConfig;let d="";return this.showClose||(this.type==="time"||this.type==="timerange"?c&&c.timePicker.customIcon&&(d=c.timePicker.customIcon):c&&c.datePicker.customIcon&&(d=c.datePicker.customIcon)),d},arrowSize(){const c=this.globalConfig;let d="";return this.showClose||(this.type==="time"||this.type==="timerange"?c&&c.timePicker.iconSize&&(d=c.timePicker.iconSize):c&&c.datePicker.iconSize&&(d=c.datePicker.iconSize)),d},dropdownCls(){return{[Px+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}}},methods:{onSelectionModeChange(c){return c.match(/^date/)&&(c="date"),this.selectionMode=O(c,["year","month","date","time"])&&c,this.selectionMode},handleTransferClick(){this.transfer&&(this.disableCloseUnderTransfer=!0)},handleClose(c){if(this.disableCloseUnderTransfer)return this.disableCloseUnderTransfer=!1,!1;if(c&&c.type==="mousedown"&&this.visible){c.preventDefault(),c.stopPropagation();return}if(this.visible){const d=this.$refs.pickerPanel&&this.$refs.pickerPanel.$el;if(c&&d&&d.contains(c.target))return;this.visible=!1,c&&c.preventDefault(),c&&c.stopPropagation(),this.$emit("on-clickoutside",c);return}this.isFocused=!1,this.disableClickOutSide=!1},handleFocus(c){this.readonly||(this.isFocused=!0,!(c&&c.type==="focus")&&(this.itemDisabled||(this.visible=!0)))},handleBlur(c){if(this.internalFocus){this.internalFocus=!1;return}if(this.visible){c.preventDefault();return}this.isFocused=!1,this.onSelectionModeChange(this.type),this.internalValue=this.internalValue.slice(),this.reset(),this.$refs.pickerPanel.onToggleVisibility(!1)},handleKeydown(c){const d=c.keyCode;if(d===9)if(this.visible)if(c.stopPropagation(),c.preventDefault(),this.isConfirm){const M=`.${Qre}-confirm > *`,C=this.$refs.drop.$el.querySelectorAll(M);this.internalFocus=!0,[...C][c.shiftKey?"pop":"shift"]().focus()}else this.handleClose();else this.focused=!1;const g=[37,38,39,40];if(!this.visible&&g.includes(d)){this.visible=!0;return}if(d===27&&this.visible&&(c.stopPropagation(),this.handleClose()),d===13){const M=this.timeSpinnerList.map(C=>C.timeSpinner);if(M.length>0){const C=M[0].showSeconds?3:2,b=Math.floor(this.focusedTime.column/C),B=this.focusedTime.time[b];M[b].chooseValue(B);return}if(this.type.match(/range/))this.$refs.pickerPanel.handleRangePick(this.focusedDate,"date");else{const C=this.panelTableList.map(B=>B.panelTable),b=B=>{const F=["year","month","date"].indexOf(this.type)+1;return[B.getFullYear(),B.getMonth(),B.getDate()].slice(0,F).join("-")};C.find(({cells:B})=>B.find(({date:F,disabled:Y})=>b(F)===b(this.focusedDate)&&!Y))&&this.onPick(this.focusedDate,!1,"date")}}!g.includes(d)||(this.focusedTime.active&&c.preventDefault(),this.navigateDatePanel(Yre[d],c.shiftKey))},reset(){this.$refs.pickerPanel.reset&&this.$refs.pickerPanel.reset()},navigateTimePanel(c){this.focusedTime.active=!0;const d=c.match(/left|right/),g=c.match(/up|down/),M=this.timeSpinnerList.map(G=>G.timeSpinner),C=(M[0].showSeconds?3:2)*M.length,b=(G=>(G+(d?c==="left"?-1:1:0)+C)%C)(this.focusedTime.column),B=C/M.length,F=Math.floor(b/B),Y=b%B;if(d){const G=this.internalValue.map(VT);this.focusedTime={...this.focusedTime,column:b,time:G},M.forEach((K,fe)=>{fe===F?K.updateFocusedTime(Y,G[F]):K.updateFocusedTime(-1,K.focusedTime)})}if(g){const G=c==="up"?1:-1,K=["hours","minutes","seconds"],fe=M[F][`${K[Y]}List`],Ee=(fe.findIndex(({text:ue})=>this.focusedTime.time[F][Y]===ue)+G+fe.length)%fe.length,Ce=fe[Ee].text,Oe=this.focusedTime.time.map((ue,Ne)=>(Ne!==F||(ue[Y]=Ce),ue));this.focusedTime={...this.focusedTime,time:Oe},M.forEach((ue,Ne)=>{Ne===F?ue.updateFocusedTime(Y,Oe[Ne]):ue.updateFocusedTime(-1,ue.focusedTime)})}},navigateDatePanel(c,d){const g=this.timeSpinnerList.map(b=>b.timeSpinner);if(g.length>0){this.navigateTimePanel(c,d,g);return}if(d){this.type==="year"?this.focusedDate=new Date(this.focusedDate.getFullYear()+zp(c,0,10),this.focusedDate.getMonth(),this.focusedDate.getDate()):this.focusedDate=new Date(this.focusedDate.getFullYear()+zp(c,0,1),this.focusedDate.getMonth()+zp(c,1,0),this.focusedDate.getDate());const b=c.match(/left|down/)?"prev":"next",B=c.match(/up|down/)?"-double":"",F=this.$refs.drop.$el.querySelector(`.ivu-date-picker-${b}-btn-arrow${B}`);F&&qre(F);return}const M=this.focusedDate||this.internalValue&&this.internalValue[0]||new Date,C=new Date(M);if(this.type.match(/^date/)){const b=fD(M.getFullYear(),M.getMonth()),B=M.getDate(),F=C.getDate()+zp(c,1,7);F<1?c.match(/left|right/)?(C.setMonth(C.getMonth()+1),C.setDate(F)):C.setDate(B+Math.floor((b-B)/7)*7):F>b?c.match(/left|right/)?(C.setMonth(C.getMonth()-1),C.setDate(F)):C.setDate(B%7):C.setDate(F)}this.type.match(/^month/)&&C.setMonth(C.getMonth()+zp(c,1,3)),this.type.match(/^year/)&&C.setFullYear(C.getFullYear()+zp(c,1,3)),this.focusedDate=C},handleInputChange(c){const d=this.type.includes("range")||this.multiple,g=this.visualValue,M=c.target.value,C=this.parseDate(M),b=this.options&&typeof this.options.disabledDate=="function"&&this.options.disabledDate,B=d?C:C[0],F=b&&b(B),Y=C.reduce((G,K)=>G&&K instanceof Date,!0);M!==g&&!F&&Y?(this.emitChange(this.type),this.internalValue=C):this.forceInputRerender++},handleInputMouseenter(){this.readonly||this.itemDisabled||this.visualValue&&this.clearable&&(this.showClose=!0)},handleInputMouseleave(){this.showClose=!1},handleIconClick(c){this.showClose?(c&&c.stopPropagation(),this.handleClear()):this.itemDisabled||this.handleFocus()},handleClear(){this.visible=!1,this.internalValue=this.internalValue.map(()=>null),this.$emit("on-clear"),this.handleFormItemChange("change",""),this.emitChange(this.type),this.reset(),setTimeout(()=>this.onSelectionModeChange(this.type),500)},emitChange(c){i.nextTick(()=>{this.$emit("on-change",this.publicStringValue,c),this.handleFormItemChange("change",this.publicStringValue)})},parseDate(c){const d=this.type.includes("range"),g=this.type,M=(Fp[g]||Fp.default).parser,C=this.format||mD[g],b=Fp.multiple.parser;if(c&&g==="time"&&!(c instanceof Date))c=M(c,C,this.separator);else if(this.multiple&&c)c=b(c,C,this.separator);else if(d)if(!c)c=[null,null];else if(typeof c=="string")c=M(c,C,this.separator);else if(g==="timerange")c=M(c,C,this.separator).map(B=>B||"");else{const[B,F]=c;B instanceof Date&&F instanceof Date?c=c.map(Y=>new Date(Y)):typeof B=="string"&&typeof F=="string"?c=M(c.join(this.separator),C,this.separator):(!B||!F)&&(c=[null,null])}else typeof c=="string"&&g.indexOf("time")!==0&&(c=M(c,C)||null);return d||this.multiple?c||[]:[c]},formatDate(c){const d=mD[this.type];if(this.multiple){const g=Fp.multiple.formatter;return g(c,this.format||d,this.separator)}else{const{formatter:g}=Fp[this.type]||Fp.default;return g(c,this.format||d,this.separator)}},onPick(c,d=!1,g){if(this.multiple){const M=c.getTime(),C=this.internalValue.findIndex(B=>B&&B.getTime()===M),b=[...this.internalValue,c].filter(Boolean).map(B=>B.getTime()).filter((B,F,Y)=>Y.indexOf(B)===F&&F!==C);this.internalValue=b.map(B=>new Date(B))}else c=this.parseDate(c),this.internalValue=Array.isArray(c)?c:[c];this.internalValue[0]&&(this.focusedDate=this.internalValue[0]),this.focusedTime={...this.focusedTime,time:this.internalValue.map(VT)},this.isConfirm||this.onSelectionModeChange(this.type),this.isConfirm||(this.visible=!!d),this.emitChange(g)},onPickSuccess(){this.visible=!1,this.$emit("on-ok"),this.focus(),this.reset()},focus(){this.$refs.input&&this.$refs.input.focus()},updatePopper(){this.$refs.drop.update()},handleOnFocusInput(){this.focus()},handleOnUpdatePopper(){this.updatePopper()}},watch:{visible(c){c===!1&&this.$refs.drop.destroy(),c&&this.$refs.drop.update(),this.$emit("on-open-change",c)},modelValue(c){c===null&&(this.isValueNull=!0),this.internalValue=this.parseDate(c)},open(c){this.visible=c===!0},type(c){this.onSelectionModeChange(c)},publicVModelValue(c,d){const g=JSON.stringify(c),M=JSON.stringify(d);(g!==M||typeof c!=typeof d)&&(this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",c))}},mounted(){this.open!==null&&(this.visible=this.open)}};function Kre(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("i-input"),Y=i.resolveComponent("Drop"),G=i.resolveDirective("click-outside");return i.withDirectives((i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapperClasses)},[i.createElementVNode("div",{ref:"reference",class:i.normalizeClass([C.prefixCls+"-rel"])},[i.renderSlot(c.$slots,"default",{},()=>[(i.openBlock(),i.createBlock(F,{key:C.forceInputRerender,"element-id":g.elementId,class:i.normalizeClass([C.prefixCls+"-editor"]),readonly:!g.editable||g.readonly,disabled:c.itemDisabled,size:g.size,placeholder:g.placeholder,"model-value":b.visualValue,name:g.name,ref:"input",onOnInputChange:b.handleInputChange,onOnFocus:b.handleFocus,onOnBlur:b.handleBlur,onClick:b.handleFocus,onKeydown:b.handleKeydown,onMouseenter:b.handleInputMouseenter,onMouseleave:b.handleInputMouseleave},{suffix:i.withCtx(()=>[i.createVNode(B,{onClick:b.handleIconClick,type:b.arrowType,custom:b.customArrowType,size:b.arrowSize},null,8,["onClick","type","custom","size"])]),_:1},8,["element-id","class","readonly","disabled","size","placeholder","model-value","name","onOnInputChange","onOnFocus","onOnBlur","onClick","onKeydown","onMouseenter","onMouseleave"]))])],2),i.createVNode(Y,{ref:"drop",visible:b.opened,classes:b.dropdownCls,placement:g.placement,eventsEnabled:g.eventsEnabled,transfer:g.transfer,"transition-name":"transition-drop",onClick:b.handleTransferClick},{default:i.withCtx(()=>[i.createElementVNode("div",null,[(i.openBlock(),i.createBlock(i.resolveDynamicComponent(c.panel),i.mergeProps({ref:"pickerPanel",visible:C.visible,showTime:c.type==="datetime"||c.type==="datetimerange",confirm:b.isConfirm,selectionMode:C.selectionMode,steps:g.steps,format:g.format,"model-value":C.internalValue,"start-date":g.startDate,"split-panels":g.splitPanels,"show-week-numbers":g.showWeekNumbers,"picker-type":c.type,multiple:g.multiple,"focused-date":C.focusedDate,"time-picker-options":g.timePickerOptions},c.ownPickerProps,{onOnPick:b.onPick,onOnPickClear:b.handleClear,onOnPickSuccess:b.onPickSuccess,onOnPickClick:d[0]||(d[0]=K=>C.disableClickOutSide=!0),onOnSelectionModeChange:b.onSelectionModeChange}),null,16,["visible","showTime","confirm","selectionMode","steps","format","model-value","start-date","split-panels","show-week-numbers","picker-type","multiple","focused-date","time-picker-options","onOnPick","onOnPickClear","onOnPickSuccess","onOnSelectionModeChange"]))])]),_:1},8,["visible","classes","placement","eventsEnabled","transfer","onClick"])],2)),[[G,b.handleClose,g.capture,{mousedown:!0}],[G,b.handleClose,g.capture,{touchstart:!0}],[G,b.handleClose,g.capture]])}var gD=l(Zre,[["render",Kre]]),vD=1e3*60*60*24;function yD(c,d){return new Date(c,d+1,0).getDate()}function bD(c,d,g){return d===0&&g>50?c-1:d===11&&g<10?c+1:c}function xD(c,d,g,M){d>11&&(d=0,c++);var C=new Date(c,d,g);M&&C.setDate(C.getDate()+4-(C.getDay()||7));var b=M?C.getFullYear():c,B=new Date(b,0,1),F=1+Math.round((C-B)/vD);M||(F+=B.getDay());var Y=Math.ceil(F/7);if(!M){var G=new Date(c,d,g),K=new Date(c+1,0,1),fe=K.getDay();G.getTime()>=K.getTime()-vD*fe&&(Y=1)}return Y}function Jre(c,d,g){for(var M=this.lang||"en",C=this.onlyDays,b=typeof this.weekStart>"u"?1:this.weekStart,B=b===1,F=[],Y=new Date(c,d,1),G=Y.getDay()||(B?7:0),K=b-G,fe=xD(c,d,1,B),Ee=yD(c,d),Ce=yD(c,d-1),Oe,ue,Ne,jt=bD(c,d,fe),_t={month:d,year:c,daysInMonth:Ee},Et=0;Et<7;Et++){Ne=K;for(var je=0;je<8;je++){Et>0&&je>0&&K++,K>Ee||K<1?(ue=K>Ee?K-Ee:Ce+K,Oe=K>Ee?d+1:d-1):(ue=K,Oe=d);var Le=function(){return je===0?"weekLabel":Et===0?"dayLabel":K<1?"prevMonth":K>Ee?"nextMonth":"monthDay"}(),tt=Ne!==K&&Et>0,Ze={desc:tt?ue:fe,week:fe,type:Le,format:B?"ISO 8601":"US",date:tt?new Date(Date.UTC(c,Oe,ue)):!1,year:jt,index:F.length};g&&(typeof g=="function"?Ze=g.call(_t,Ze,M):g.forEach(function(ti){Ze=ti.call(_t,Ze,M)})),C&&tt?F.push(Ze):C||F.push(Ze)}Et>0&&(fe=xD(c,Oe,ue+1,B)),jt=bD(c,d,fe)}return _t.cells=F,_t}var ese=function(c){return Jre.bind(c)},tse={weekPlaceholder:"",columnNames:{en:{0:"w",1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday",7:"sunday"},sv:{0:"v",1:"måndag",2:"tisdag",3:"onsdag",4:"torsdag",5:"fredag",6:"lördag",7:"söndag"},pt:{0:"s",1:"segunda",2:"terça",3:"quarta",4:"quinta",5:"sexta",6:"sábado",7:"domingo"}},monthNames:{en:["January","February","March","April","May","June","July","August","September","October","November","December"],sv:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],pt:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"]},classes:{dayLabel:"day-of-week",weekLabel:"week-number",prevMonth:"inactive",nextMonth:"inactive",monthDay:"day-in-month"}},Pl=tse;function ise(c){return c==null?!1:c.constructor===Array||c.constructor===Object}function wD(c,d){for(var g in c)d[g]?ise(c[g])&&wD(c[g],d[g]):d[g]=c[g]}function _D(c,d){var g=[Pl.classes[c.type]];return c.class?c.class=(typeof c.class=="string"?[c.class]:c.class).concat(g):c.class=g,c.type.indexOf("Label")>0&&(c.index==0&&Pl.weekPlaceholder?c.desc=Pl.weekPlaceholder:c.index<8?c.desc=Pl.columnNames[d][c.index]:c.index%8==0&&(c.desc=c.week)),c.date&&(c.monthName=Pl.monthNames[d][c.date.getMonth()]),this.monthName||(this.monthName=Pl.monthNames[d][this.month]),this.labels||(this.labels={monthNames:Pl.monthNames[d],columnNames:Pl.columnNames[d],classes:Pl.classes}),c}_D.setLabels=function(c){wD(c,Pl)};var nse=_D,rse={Generator:ese,addLabels:nse},FT={name:"PanelTable",emits:["on-pick","on-pick-click","on-change-range"],inject:["PickerInstance"],props:{tableDate:{type:Date,required:!0},disabledDate:{type:Function},selectionMode:{type:String,required:!0},modelValue:{type:Array,required:!0},rangeState:{type:Object,default:()=>({from:null,to:null,selecting:!1})},focusedDate:{type:Date,required:!0}},data(){return{id:j(6)}},computed:{dates(){const{selectionMode:c,modelValue:d,rangeState:g}=this;return c==="range"&&g.selecting?[g.from]:d}},methods:{handleClick(c,d){if(d.stopPropagation(),c.disabled||c.type==="weekLabel")return;const g=new Date(Vs(c.date));this.$emit("on-pick",g),this.$emit("on-pick-click")},handleMouseMove(c){if(!this.rangeState.selecting||c.disabled)return;const d=c.date;this.$emit("on-change-range",d)},addPanelTable(){const c=this.PickerInstance;c.panelTableList||(c.panelTableList=[]),c.panelTableList.push({id:this.id,panelTable:this})},removePanelTable(){const c=this.PickerInstance;if(c.panelTableList&&c.panelTableList.length){const d=c.panelTableList.findIndex(g=>g.id===this.id);c.panelTableList.splice(d,1)}}},mounted(){this.addPanelTable()},beforeUnmount(){this.removePanelTable()}},In="ivu-date-picker-cells";const sse={mixins:[gn,FT],props:{showWeekNumbers:{type:Boolean,default:!1}},computed:{classes(){return[`${In}`,{[`${In}-show-week-numbers`]:this.showWeekNumbers}]},calendar(){const c=Number(this.t("i.datepicker.weekStartDay"));return new rse.Generator({onlyDays:!this.showWeekNumbers,weekStart:c})},headerDays(){const c=Number(this.t("i.datepicker.weekStartDay")),d=["sun","mon","tue","wed","thu","fri","sat"].map(M=>this.t("i.datepicker.weeks."+M)),g=d.splice(c,7-c).concat(d.splice(0,c));return this.showWeekNumbers?[""].concat(g):g},cells(){const c=this.tableDate.getFullYear(),d=this.tableDate.getMonth(),g=Vs(new Date),M=this.dates.filter(Boolean).map(Vs),[C,b]=this.dates.map(Vs),B=this.rangeState.from&&Vs(this.rangeState.from),F=this.rangeState.to&&Vs(this.rangeState.to),Y=this.selectionMode==="range",G=typeof this.disabledDate=="function"&&this.disabledDate;return this.calendar(c,d,K=>{K.date instanceof Date&&K.date.setTime(K.date.getTime()+K.date.getTimezoneOffset()*6e4+480*60*1e3);const fe=K.date&&Vs(K.date),Ee=K.date&&d===K.date.getMonth();return{...K,type:fe===g?"today":K.type,selected:Ee&&M.includes(fe),disabled:K.date&&G&&G(new Date(fe)),range:Ee&&Y&&Hre(fe,B,F),start:Ee&&Y&&fe===C,end:Ee&&Y&&fe===b}}).cells.slice(this.showWeekNumbers?8:0)}},methods:{getCellCls(c){return[`${In}-cell`,{[`${In}-cell-selected`]:c.selected||c.start||c.end,[`${In}-cell-disabled`]:c.disabled,[`${In}-cell-today`]:c.type==="today",[`${In}-cell-prev-month`]:c.type==="prevMonth",[`${In}-cell-next-month`]:c.type==="nextMonth",[`${In}-cell-week-label`]:c.type==="weekLabel",[`${In}-cell-range`]:c.range&&!c.start&&!c.end,[`${In}-focused`]:Vs(c.date)===Vs(this.focusedDate)}]}}},ose={class:"ivu-date-picker-cells-header"},ase=["onClick","onMouseenter"];function lse(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.createElementVNode("div",ose,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.headerDays,B=>(i.openBlock(),i.createElementBlock("span",{key:B},i.toDisplayString(B),1))),128))]),(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.cells,(B,F)=>(i.openBlock(),i.createElementBlock("span",{key:String(B.date)+F,class:i.normalizeClass(b.getCellCls(B)),onClick:Y=>c.handleClick(B,Y),onMouseenter:Y=>c.handleMouseMove(B)},[i.createElementVNode("em",null,i.toDisplayString(B.desc),1)],42,ase))),128))],2)}var OD=l(sse,[["render",lse]]);const cse={mixins:[FT],props:{},computed:{classes(){return[`${In}`,`${In}-year`]},startYear(){return Math.floor(this.tableDate.getFullYear()/10)*10},cells(){let c=[];const d={text:"",selected:!1,disabled:!1},g=this.dates.filter(Boolean).map(C=>Vs(new Date(C.getFullYear(),0,1))),M=Vs(new Date(this.focusedDate.getFullYear(),0,1));for(let C=0;C<10;C++){const b=$(d);b.date=new Date(this.startYear+C,0,1),b.disabled=typeof this.disabledDate=="function"&&this.disabledDate(b.date)&&this.selectionMode==="year";const B=Vs(b.date);b.selected=g.includes(B),b.focused=B===M,c.push(b)}return c}},methods:{getCellCls(c){return[`${In}-cell`,{[`${In}-cell-selected`]:c.selected,[`${In}-cell-disabled`]:c.disabled,[`${In}-cell-focused`]:c.focused,[`${In}-cell-range`]:c.range&&!c.start&&!c.end}]}}},hse=["onClick","onMouseenter"];function use(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.cells,B=>(i.openBlock(),i.createElementBlock("span",{class:i.normalizeClass(b.getCellCls(B)),key:B.date,onClick:F=>c.handleClick(B,F),onMouseenter:F=>c.handleMouseMove(B)},[i.createElementVNode("em",null,i.toDisplayString(B.date.getFullYear()),1)],42,hse))),128))],2)}var SD=l(cse,[["render",use]]);const dse={mixins:[gn,FT],props:{},computed:{classes(){return[`${In}`,`${In}-month`]},cells(){let c=[];const d={text:"",selected:!1,disabled:!1},g=this.tableDate.getFullYear(),M=this.dates.filter(Boolean).map(b=>Vs(new Date(b.getFullYear(),b.getMonth(),1))),C=Vs(new Date(this.focusedDate.getFullYear(),this.focusedDate.getMonth(),1));for(let b=0;b<12;b++){const B=$(d);B.date=new Date(g,b,1),B.text=this.tCell(b+1);const F=Vs(B.date);B.disabled=typeof this.disabledDate=="function"&&this.disabledDate(B.date)&&this.selectionMode==="month",B.selected=M.includes(F),B.focused=F===C,c.push(B)}return c}},methods:{getCellCls(c){return[`${In}-cell`,{[`${In}-cell-selected`]:c.selected,[`${In}-cell-disabled`]:c.disabled,[`${In}-cell-focused`]:c.focused,[`${In}-cell-range`]:c.range&&!c.start&&!c.end}]},tCell(c){return this.t(`i.datepicker.months.m${c}`)}}},fse=["onClick","onMouseenter"];function pse(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.cells,B=>(i.openBlock(),i.createElementBlock("span",{class:i.normalizeClass(b.getCellCls(B)),key:B.text,onClick:F=>c.handleClick(B,F),onMouseenter:F=>c.handleMouseMove(B)},[i.createElementVNode("em",null,i.toDisplayString(B.text),1)],42,fse))),128))],2)}var CD=l(dse,[["render",pse]]),Rx={props:{disabledHours:{type:Array,default(){return[]}},disabledMinutes:{type:Array,default(){return[]}},disabledSeconds:{type:Array,default(){return[]}},hideDisabledOptions:{type:Boolean,default:!1}}};const Dd="ivu-time-picker-cells",zT=["hours","minutes","seconds"],mse={name:"TimeSpinner",mixins:[Rx],emits:["on-change","on-pick-click"],inject:["PickerInstance"],props:{hours:{type:[Number,String],default:NaN},minutes:{type:[Number,String],default:NaN},seconds:{type:[Number,String],default:NaN},showSeconds:{type:Boolean,default:!0},steps:{type:Array,default:()=>[]}},data(){return{spinerSteps:[1,1,1].map((c,d)=>Math.abs(this.steps[d])||c),prefixCls:Dd,compiled:!1,focusedColumn:-1,focusedTime:[0,0,0],id:j(6)}},computed:{classes(){return[`${Dd}`,{[`${Dd}-with-seconds`]:this.showSeconds}]},hoursList(){let c=[];const d=this.spinerSteps[0],g=this.focusedColumn===0&&this.focusedTime[0],M={text:0,selected:!1,disabled:!1,hide:!1};for(let C=0;C<24;C+=d){const b=$(M);b.text=C,b.focused=C===g,this.disabledHours.length&&this.disabledHours.indexOf(C)>-1&&(b.disabled=!0,this.hideDisabledOptions&&(b.hide=!0)),this.hours===C&&(b.selected=!0),c.push(b)}return c},minutesList(){let c=[];const d=this.spinerSteps[1],g=this.focusedColumn===1&&this.focusedTime[1],M={text:0,selected:!1,disabled:!1,hide:!1};for(let C=0;C<60;C+=d){const b=$(M);b.text=C,b.focused=C===g,this.disabledMinutes.length&&this.disabledMinutes.indexOf(C)>-1&&(b.disabled=!0,this.hideDisabledOptions&&(b.hide=!0)),this.minutes===C&&(b.selected=!0),c.push(b)}return c},secondsList(){let c=[];const d=this.spinerSteps[2],g=this.focusedColumn===2&&this.focusedTime[2],M={text:0,selected:!1,disabled:!1,hide:!1};for(let C=0;C<60;C+=d){const b=$(M);b.text=C,b.focused=C===g,this.disabledSeconds.length&&this.disabledSeconds.indexOf(C)>-1&&(b.disabled=!0,this.hideDisabledOptions&&(b.hide=!0)),this.seconds===C&&(b.selected=!0),c.push(b)}return c}},methods:{getCellCls(c){return[`${Dd}-cell`,{[`${Dd}-cell-selected`]:c.selected,[`${Dd}-cell-focused`]:c.focused,[`${Dd}-cell-disabled`]:c.disabled}]},chooseValue(c){const d=zT.reduce((g,M,C)=>{const b=c[C];return this[M]===b?g:{...g,[M]:b}},{});Object.keys(d).length>0&&this.emitChange(d)},handleClick(c,d){if(d.disabled)return;const g={[c]:d.text};this.emitChange(g)},emitChange(c){this.$emit("on-change",c),this.$emit("on-pick-click")},scroll(c,d){const g=this.$refs[c].scrollTop,M=24*this.getScrollIndex(c,d);I(this.$refs[c],g,M,500)},getScrollIndex(c,d){const g=E(c),M=this[`disabled${g}`];if(M.length&&this.hideDisabledOptions){let C=0;M.forEach(b=>b<=d?C++:""),d-=C}return d},updateScroll(){i.nextTick(()=>{zT.forEach(c=>{this.$refs[c].scrollTop=24*this[`${c}List`].findIndex(d=>d.text==this[c])})})},formatTime(c){return c<10?"0"+c:c},updateFocusedTime(c,d){this.focusedColumn=c,this.focusedTime=d.slice()},addTimeSpinner(){const c=this.PickerInstance;c.timeSpinnerList||(c.timeSpinnerList=[]),c.timeSpinnerList.push({id:this.id,timeSpinner:this})},removeTimeSpinner(){const c=this.PickerInstance;if(c.timeSpinnerList&&c.timeSpinnerList.length){const d=c.timeSpinnerList.findIndex(g=>g.id===this.id);c.timeSpinnerList.splice(d,1)}}},watch:{hours(c){!this.compiled||this.scroll("hours",this.hoursList.findIndex(d=>d.text==c))},minutes(c){!this.compiled||this.scroll("minutes",this.minutesList.findIndex(d=>d.text==c))},seconds(c){!this.compiled||this.scroll("seconds",this.secondsList.findIndex(d=>d.text==c))},focusedTime(c,d){zT.forEach((g,M)=>{if(c[M]===d[M]||typeof c[M]>"u")return;const C=this[`${g}List`].findIndex(b=>b.text===c[M]);this.scroll(g,C)})}},mounted(){this.addTimeSpinner(),i.nextTick(()=>this.compiled=!0)},beforeUnmount(){this.removeTimeSpinner()}},gse=["onClick"],vse=["onClick"],yse=["onClick"];function bse(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-list"]),ref:"hours"},[i.createElementVNode("ul",{class:i.normalizeClass([C.prefixCls+"-ul"])},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.hoursList,B=>i.withDirectives((i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(b.getCellCls(B)),key:B.text,onClick:F=>b.handleClick("hours",B)},i.toDisplayString(b.formatTime(B.text)),11,gse)),[[i.vShow,!B.hide]])),128))],2)],2),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-list"]),ref:"minutes"},[i.createElementVNode("ul",{class:i.normalizeClass([C.prefixCls+"-ul"])},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.minutesList,B=>i.withDirectives((i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(b.getCellCls(B)),key:B.text,onClick:F=>b.handleClick("minutes",B)},i.toDisplayString(b.formatTime(B.text)),11,vse)),[[i.vShow,!B.hide]])),128))],2)],2),i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-list"]),ref:"seconds"},[i.createElementVNode("ul",{class:i.normalizeClass([C.prefixCls+"-ul"])},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.secondsList,B=>i.withDirectives((i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(b.getCellCls(B)),key:B.text,onClick:F=>b.handleClick("seconds",B)},i.toDisplayString(b.formatTime(B.text)),11,yse)),[[i.vShow,!B.hide]])),128))],2)],2),[[i.vShow,g.showSeconds]])],2)}var TD=l(mse,[["render",bse]]);const ED="ivu-picker",xse={mixins:[gn],components:{iButton:Us},emits:["on-pick-clear","on-pick-success","on-pick-toggle-time"],inject:["PickerInstance"],props:{showTime:{type:Boolean,default:!1},isTime:{type:Boolean,default:!1},timeDisabled:{type:Boolean,default:!1}},data(){return{prefixCls:ED}},computed:{timeClasses(){return`${ED}-confirm-time`},labels(){const c=["time","clear","ok"],d=[this.isTime?"selectDate":"selectTime","clear","ok"];return c.reduce((g,M,C)=>(g[M]=this.t("i.datepicker."+d[C]),g),{})}},methods:{handleClear(){this.$emit("on-pick-clear")},handleSuccess(){this.$emit("on-pick-success")},handleToggleTime(){this.timeDisabled||(this.$emit("on-pick-toggle-time"),this.PickerInstance.handleOnFocusInput(),this.PickerInstance.handleOnUpdatePopper())},handleTab(c){const d=[...this.$el.children][c.shiftKey?"shift":"pop"]();s&&document.activeElement===d&&(c.preventDefault(),c.stopPropagation(),this.PickerInstance.handleOnFocusInput())}}};function wse(c,d,g,M,C,b){const B=i.resolveComponent("i-button");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([C.prefixCls+"-confirm"]),onKeydownCapture:d[0]||(d[0]=i.withKeys((...F)=>b.handleTab&&b.handleTab(...F),["tab"]))},[g.showTime?(i.openBlock(),i.createBlock(B,{key:0,class:i.normalizeClass(b.timeClasses),size:"small",type:"text",disabled:g.timeDisabled,onClick:b.handleToggleTime},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(b.labels.time),1)]),_:1},8,["class","disabled","onClick"])):i.createCommentVNode("",!0),i.createVNode(B,{size:"small",class:"ivu-picker-confirm-btn-cancel",onClick:b.handleClear,onKeydown:i.withKeys(b.handleClear,["enter"])},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(b.labels.clear),1)]),_:1},8,["onClick","onKeydown"]),i.createVNode(B,{size:"small",type:"primary",onClick:b.handleSuccess,onKeydown:i.withKeys(b.handleSuccess,["enter"])},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(b.labels.ok),1)]),_:1},8,["onClick","onKeydown"])],34)}var Ix=l(xse,[["render",wse]]);const _se="ivu-picker-panel",MD="ivu-date-picker";var Nx={emits:["on-pick-clear","on-pick-success","on-pick-click","on-pick"],props:{confirm:{type:Boolean,default:!1}},methods:{iconBtnCls(c,d=""){return[`${_se}-icon-btn`,`${MD}-${c}-btn`,`${MD}-${c}-btn-arrow${d}`]},handleShortcutClick(c){c.value&&this.$emit("on-pick",c.value()),c.onClick&&c.onClick(this)},handlePickClear(){this.resetView(),this.$emit("on-pick-clear")},handlePickSuccess(){this.resetView(),this.$emit("on-pick-success")},handlePickClick(){this.$emit("on-pick-click")},resetView(){setTimeout(()=>this.currentView=this.selectionMode,500)},handleClear(){this.dates=this.dates.map(()=>null),this.rangeState={},this.$emit("on-pick",this.dates),this.handleConfirm()},handleConfirm(c,d){this.$emit("on-pick",this.dates,c,d||this.type)},onToggleVisibility(c){const{timeSpinner:d,timeSpinnerEnd:g}=this.$refs;c&&d&&d.updateScroll(),c&&g&&g.updateScroll()}}};const Ose="ivu-picker-panel",Sse="ivu-time-picker",Cse=c=>c[0].toUpperCase()+c.slice(1),Tse=(c,d,g,M)=>{const C=new Date(c.getTime());return C.setHours(d),C.setMinutes(g),C.setSeconds(M),C},Ese=(c,d,g)=>g.indexOf(c)===d,AD=()=>!1,Mse={name:"TimePickerPanel",mixins:[Nx,gn,Rx],components:{TimeSpinner:TD,Confirm:Ix},emits:["on-pick"],props:{disabledDate:{type:Function,default:AD},steps:{type:Array,default:()=>[]},format:{type:String,default:"HH:mm:ss"},modelValue:{type:Array,required:!0}},data(){return{prefixCls:Ose,timePrefixCls:Sse,date:this.modelValue[0]||kl(),showDate:!1}},computed:{showSeconds(){return!!(this.format||"").match(/ss/)},visibleDate(){const c=this.date,d=c.getMonth()+1,g=this.t("i.datepicker.year"),M=this.t(`i.datepicker.month${d}`);return`${c.getFullYear()}${g} ${M}`},timeSlots(){return this.modelValue[0]?["getHours","getMinutes","getSeconds"].map(c=>this.date[c]()):[]},disabledHMS(){const c=["disabledHours","disabledMinutes","disabledSeconds"];if(this.disabledDate===AD||!this.modelValue[0])return c.reduce((d,g)=>(d[g]=this[g],d),{});{const d=[24,60,60],g=["Hours","Minutes","Seconds"].map(M=>this[`disabled${M}`]).map((M,C)=>{const b=d[C],B=M;for(let F=0;F<b;F+=this.steps[C]||1){const Y=this.timeSlots.map((K,fe)=>fe===C?F:K),G=Tse(this.date,...Y);this.disabledDate(G,!0)&&B.push(F)}return B.filter(Ese)});return c.reduce((M,C,b)=>(M[C]=g[b],M),{})}}},watch:{modelValue(c){let d=c[0]||kl();d=new Date(d),this.date=d}},methods:{handleChange(c,d=!0){const g=new Date(this.date);Object.keys(c).forEach(M=>g[`set${Cse(M)}`](c[M])),d&&this.$emit("on-pick",g,"time")}},mounted(){this.$parent&&this.$parent.$options.name==="DatePicker"&&(this.showDate=!0)}};function Ase(c,d,g,M,C,b){const B=i.resolveComponent("time-spinner"),F=i.resolveComponent("Confirm");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([C.prefixCls+"-body-wrapper"]),onMousedown:d[0]||(d[0]=i.withModifiers(()=>{},["prevent"]))},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body"])},[C.showDate?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.timePrefixCls+"-header"])},i.toDisplayString(b.visibleDate),3)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content"])},[i.createVNode(B,{ref:"timeSpinner","show-seconds":b.showSeconds,steps:g.steps,hours:b.timeSlots[0],minutes:b.timeSlots[1],seconds:b.timeSlots[2],"disabled-hours":b.disabledHMS.disabledHours,"disabled-minutes":b.disabledHMS.disabledMinutes,"disabled-seconds":b.disabledHMS.disabledSeconds,"hide-disabled-options":c.hideDisabledOptions,onOnChange:b.handleChange,onOnPickClick:c.handlePickClick},null,8,["show-seconds","steps","hours","minutes","seconds","disabled-hours","disabled-minutes","disabled-seconds","hide-disabled-options","onOnChange","onOnPickClick"])],2),c.confirm?(i.openBlock(),i.createBlock(F,{key:1,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess},null,8,["onOnPickClear","onOnPickSuccess"])):i.createCommentVNode("",!0)],2)],34)}var kD=l(Mse,[["render",Ase]]);const kse={props:{datePanelLabel:Object,currentView:String,datePrefixCls:String}};function Pse(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("span",null,[g.datePanelLabel?i.withDirectives((i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass([g.datePrefixCls+"-header-label"]),onClick:d[0]||(d[0]=(...B)=>g.datePanelLabel.labels[0].handler&&g.datePanelLabel.labels[0].handler(...B))},i.toDisplayString(g.datePanelLabel.labels[0].label),3)),[[i.vShow,g.datePanelLabel.labels[0].type==="year"||g.currentView==="date"]]):i.createCommentVNode("",!0),g.datePanelLabel&&g.currentView==="date"?(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createTextVNode(i.toDisplayString(g.datePanelLabel.separator),1)],64)):i.createCommentVNode("",!0),g.datePanelLabel?i.withDirectives((i.openBlock(),i.createElementBlock("span",{key:2,class:i.normalizeClass([g.datePrefixCls+"-header-label"]),onClick:d[1]||(d[1]=(...B)=>g.datePanelLabel.labels[1].handler&&g.datePanelLabel.labels[1].handler(...B))},i.toDisplayString(g.datePanelLabel.labels[1].label),3)),[[i.vShow,g.datePanelLabel.labels[1].type==="year"||g.currentView==="date"]]):i.createCommentVNode("",!0)])}var PD=l(kse,[["render",Pse]]),RD={props:{showTime:{type:Boolean,default:!1},format:{type:String,default:"yyyy-MM-dd"},selectionMode:{type:String,validator(c){return O(c,["year","month","date","time"])},default:"date"},shortcuts:{type:Array,default:()=>[]},disabledDate:{type:Function,default:()=>!1},modelValue:{type:Array,default:()=>[kl(),kl()]},timePickerOptions:{default:()=>({}),type:Object},showWeekNumbers:{type:Boolean,default:!1},startDate:{type:Date},pickerType:{type:String,require:!0},focusedDate:{type:Date,required:!0}},computed:{isTime(){return this.currentView==="time"}},methods:{handleToggleTime(){this.currentView=this.currentView==="time"?"date":"time"}}};const XT="ivu-picker-panel",Rse="ivu-date-picker",Ise={name:"DatePickerPanel",mixins:[Nx,gn,RD],components:{Icon:S,DateTable:OD,YearTable:SD,MonthTable:CD,TimePicker:kD,Confirm:Ix,datePanelLabel:PD},emits:["on-selection-mode-change","on-pick"],props:{multiple:{type:Boolean,default:!1}},data(){const{selectionMode:c,modelValue:d}=this,g=d.slice().sort();return{prefixCls:XT,datePrefixCls:Rse,currentView:c||"date",pickerTable:this.getTableType(c),dates:g,panelDate:this.startDate||g[0]||new Date}},computed:{classes(){return[`${XT}-body-wrapper`,{[`${XT}-with-sidebar`]:this.shortcuts.length}]},panelPickerHandlers(){return this.pickerTable===`${this.currentView}-table`?this.handlePick:this.handlePreSelection},datePanelLabel(){const c=this.t("i.locale"),d=this.t("i.datepicker.datePanelLabel"),g=this.panelDate,{labels:M,separator:C}=BT(c,d,g),b=B=>()=>this.pickerTable=this.getTableType(B);return{separator:C,labels:M.map(B=>(B.handler=b(B.type),B))}},timeDisabled(){return!this.dates[0]}},watch:{modelValue(c){this.dates=c;const d=this.multiple?this.dates[this.dates.length-1]:this.startDate||this.dates[0];this.panelDate=d||new Date},currentView(c){this.$emit("on-selection-mode-change",c),this.currentView==="time"&&i.nextTick(()=>{this.$refs.timePicker.$refs.timeSpinner.updateScroll()})},selectionMode(c){this.currentView=c,this.pickerTable=this.getTableType(c)},focusedDate(c){const d=c.getFullYear()!==this.panelDate.getFullYear(),g=d||c.getMonth()!==this.panelDate.getMonth();(d||g)&&(this.multiple||(this.panelDate=c))}},methods:{reset(){this.currentView=this.selectionMode,this.pickerTable=this.getTableType(this.currentView)},changeYear(c){this.selectionMode==="year"||this.pickerTable==="year-table"?this.panelDate=new Date(this.panelDate.getFullYear()+c*10,0,1):this.panelDate=pD(this.panelDate,c*12)},getTableType(c){return c.match(/^time/)?"time-picker":`${c}-table`},changeMonth(c){this.panelDate=pD(this.panelDate,c)},handlePreSelection(c){this.panelDate=c,this.pickerTable==="year-table"?this.pickerTable="month-table":this.pickerTable=this.getTableType(this.currentView)},handlePick(c,d){const{selectionMode:g,panelDate:M}=this;g==="year"?c=new Date(c.getFullYear(),0,1):g==="month"?c=new Date(M.getFullYear(),c.getMonth(),1):c=new Date(c),this.dates=[c],this.$emit("on-pick",c,!1,d||g)}}},Nse=["onClick"];function Dse(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("date-panel-label"),Y=i.resolveComponent("time-picker"),G=i.resolveComponent("Confirm");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),onMousedown:d[4]||(d[4]=i.withModifiers(()=>{},["prevent"]))},[c.shortcuts.length?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-sidebar"])},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(c.shortcuts,K=>(i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([C.prefixCls+"-shortcut"]),key:K.text,onClick:fe=>c.handleShortcutClick(K)},i.toDisplayString(K.text),11,Nse))),128))],2)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body"])},[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.datePrefixCls+"-header"])},[i.createElementVNode("span",{class:i.normalizeClass(c.iconBtnCls("prev","-double")),onClick:d[0]||(d[0]=K=>b.changeYear(-1))},[i.createVNode(B,{type:"ios-arrow-back"})],2),C.pickerTable==="date-table"?i.withDirectives((i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass(c.iconBtnCls("prev")),onClick:d[1]||(d[1]=K=>b.changeMonth(-1))},[i.createVNode(B,{type:"ios-arrow-back"})],2)),[[i.vShow,C.currentView==="date"]]):i.createCommentVNode("",!0),i.createVNode(F,{"date-panel-label":b.datePanelLabel,"current-view":C.pickerTable.split("-").shift(),"date-prefix-cls":C.datePrefixCls},null,8,["date-panel-label","current-view","date-prefix-cls"]),i.createElementVNode("span",{class:i.normalizeClass(c.iconBtnCls("next","-double")),onClick:d[2]||(d[2]=K=>b.changeYear(1))},[i.createVNode(B,{type:"ios-arrow-forward"})],2),C.pickerTable==="date-table"?i.withDirectives((i.openBlock(),i.createElementBlock("span",{key:1,class:i.normalizeClass(c.iconBtnCls("next")),onClick:d[3]||(d[3]=K=>b.changeMonth(1))},[i.createVNode(B,{type:"ios-arrow-forward"})],2)),[[i.vShow,C.currentView==="date"]]):i.createCommentVNode("",!0)],2),[[i.vShow,C.currentView!=="time"]]),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content"])},[C.currentView!=="time"?(i.openBlock(),i.createBlock(i.resolveDynamicComponent(C.pickerTable),{key:0,ref:"pickerTable","table-date":C.panelDate,"show-week-numbers":c.showWeekNumbers,"model-value":C.dates,"selection-mode":c.selectionMode,"disabled-date":c.disabledDate,"focused-date":c.focusedDate,onOnPick:b.panelPickerHandlers,onOnPickClick:c.handlePickClick},null,40,["table-date","show-week-numbers","model-value","selection-mode","disabled-date","focused-date","onOnPick","onOnPickClick"])):i.createCommentVNode("",!0)],2),i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content"])},[C.currentView==="time"?(i.openBlock(),i.createBlock(Y,i.mergeProps({key:0,ref:"timePicker","model-value":C.dates,format:c.format,"time-disabled":b.timeDisabled,"disabled-date":c.disabledDate,"focused-date":c.focusedDate},c.timePickerOptions,{onOnPick:b.handlePick,onOnPickClick:c.handlePickClick,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess,onOnPickToggleTime:c.handleToggleTime}),null,16,["model-value","format","time-disabled","disabled-date","focused-date","onOnPick","onOnPickClick","onOnPickClear","onOnPickSuccess","onOnPickToggleTime"])):i.createCommentVNode("",!0)],2),[[i.vShow,c.isTime]]),c.confirm?(i.openBlock(),i.createBlock(G,{key:0,"show-time":c.showTime,"is-time":c.isTime,onOnPickToggleTime:c.handleToggleTime,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess},null,8,["show-time","is-time","onOnPickToggleTime","onOnPickClear","onOnPickSuccess"])):i.createCommentVNode("",!0)],2)],34)}var Lse=l(Ise,[["render",Dse]]);const ID="ivu-picker-panel",WT="ivu-time-picker",ND=c=>c[0].toUpperCase()+c.slice(1),Bse={name:"RangeTimePickerPanel",mixins:[Nx,gn,Rx],components:{TimeSpinner:TD,Confirm:Ix},emits:["on-pick"],props:{steps:{type:Array,default:()=>[]},format:{type:String,default:"HH:mm:ss"},modelValue:{type:Array,required:!0}},data(){const[c,d]=this.modelValue.slice();return{prefixCls:ID,timePrefixCls:WT,showDate:!1,dateStart:c||kl(),dateEnd:d||kl()}},computed:{classes(){return[`${ID}-body-wrapper`,`${WT}-with-range`,{[`${WT}-with-seconds`]:this.showSeconds}]},showSeconds(){return!!(this.format||"").match(/ss/)},leftDatePanelLabel(){return this.panelLabelConfig(this.date)},rightDatePanelLabel(){return this.panelLabelConfig(this.dateEnd)}},watch:{modelValue(c){const[d,g]=c.slice();this.dateStart=d||kl(),this.dateEnd=g||kl()}},methods:{panelLabelConfig(c){const d=this.t("i.locale"),g=this.t("i.datepicker.datePanelLabel"),{labels:M,separator:C}=BT(d,g,c||kl());return[M[0].label,C,M[1].label].join("")},handleChange(c,d,g=!0){const M=new Date(this.dateStart);let C=new Date(this.dateEnd);Object.keys(c).forEach(b=>{M[`set${ND(b)}`](c[b])}),Object.keys(d).forEach(b=>{C[`set${ND(b)}`](d[b])}),C<M&&(C=M),g&&this.$emit("on-pick",[M,C],"time")},handleStartChange(c){this.handleChange(c,{})},handleEndChange(c){this.handleChange({},c)},updateScroll(){this.$refs.timeSpinner.updateScroll(),this.$refs.timeSpinnerEnd.updateScroll()}},mounted(){this.$parent&&this.$parent.$options.name==="DatePicker"&&(this.showDate=!0)}};function $se(c,d,g,M,C,b){const B=i.resolveComponent("time-spinner"),F=i.resolveComponent("Confirm");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),onMousedown:d[0]||(d[0]=i.withModifiers(()=>{},["prevent"]))},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body"])},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content",C.prefixCls+"-content-left"])},[i.createElementVNode("div",{class:i.normalizeClass([C.timePrefixCls+"-header"])},[C.showDate?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createTextVNode(i.toDisplayString(b.leftDatePanelLabel),1)],64)):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createTextVNode(i.toDisplayString(c.t("i.datepicker.startTime")),1)],64))],2),i.createVNode(B,{ref:"timeSpinner",steps:g.steps,"show-seconds":b.showSeconds,hours:g.modelValue[0]&&C.dateStart.getHours(),minutes:g.modelValue[0]&&C.dateStart.getMinutes(),seconds:g.modelValue[0]&&C.dateStart.getSeconds(),"disabled-hours":c.disabledHours,"disabled-minutes":c.disabledMinutes,"disabled-seconds":c.disabledSeconds,"hide-disabled-options":c.hideDisabledOptions,onOnChange:b.handleStartChange,onOnPickClick:c.handlePickClick},null,8,["steps","show-seconds","hours","minutes","seconds","disabled-hours","disabled-minutes","disabled-seconds","hide-disabled-options","onOnChange","onOnPickClick"])],2),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content",C.prefixCls+"-content-right"])},[i.createElementVNode("div",{class:i.normalizeClass([C.timePrefixCls+"-header"])},[C.showDate?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createTextVNode(i.toDisplayString(b.rightDatePanelLabel),1)],64)):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createTextVNode(i.toDisplayString(c.t("i.datepicker.endTime")),1)],64))],2),i.createVNode(B,{ref:"timeSpinnerEnd",steps:g.steps,"show-seconds":b.showSeconds,hours:g.modelValue[1]&&C.dateEnd.getHours(),minutes:g.modelValue[1]&&C.dateEnd.getMinutes(),seconds:g.modelValue[1]&&C.dateEnd.getSeconds(),"disabled-hours":c.disabledHours,"disabled-minutes":c.disabledMinutes,"disabled-seconds":c.disabledSeconds,"hide-disabled-options":c.hideDisabledOptions,onOnChange:b.handleEndChange,onOnPickClick:c.handlePickClick},null,8,["steps","show-seconds","hours","minutes","seconds","disabled-hours","disabled-minutes","disabled-seconds","hide-disabled-options","onOnChange","onOnPickClick"])],2),c.confirm?(i.openBlock(),i.createBlock(F,{key:0,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess},null,8,["onOnPickClear","onOnPickSuccess"])):i.createCommentVNode("",!0)],2)],34)}var DD=l(Bse,[["render",$se]]);const Xp="ivu-picker-panel",GT="ivu-date-picker",LD=(c,d)=>!c||!d?0:c.getTime()-d.getTime(),Use={name:"RangeDatePickerPanel",mixins:[Nx,gn,RD],components:{Icon:S,DateTable:OD,YearTable:SD,MonthTable:CD,TimePicker:DD,Confirm:Ix,datePanelLabel:PD},props:{splitPanels:{type:Boolean,default:!1}},data(){const[c,d]=this.modelValue.map(M=>M||kl()),g=this.startDate?this.startDate:c;return{prefixCls:Xp,datePrefixCls:GT,dates:this.modelValue,rangeState:{from:this.modelValue[0],to:this.modelValue[1],selecting:c&&!d},currentView:this.selectionMode||"range",leftPickerTable:`${this.selectionMode}-table`,rightPickerTable:`${this.selectionMode}-table`,leftPanelDate:g,rightPanelDate:new Date(g.getFullYear(),g.getMonth()+1,1)}},computed:{classes(){return[`${Xp}-body-wrapper`,`${GT}-with-range`,{[`${Xp}-with-sidebar`]:this.shortcuts.length,[`${GT}-with-week-numbers`]:this.showWeekNumbers}]},panelBodyClasses(){return[Xp+"-body",{[Xp+"-body-time"]:this.showTime,[Xp+"-body-date"]:!this.showTime}]},leftDatePanelLabel(){return this.panelLabelConfig("left")},rightDatePanelLabel(){return this.panelLabelConfig("right")},leftDatePanelView(){return this.leftPickerTable.split("-").shift()},rightDatePanelView(){return this.rightPickerTable.split("-").shift()},timeDisabled(){return!(this.dates[0]&&this.dates[1])},preSelecting(){const c=`${this.currentView}-table`;return{left:this.leftPickerTable!==c,right:this.rightPickerTable!==c}},panelPickerHandlers(){return{left:this.preSelecting.left?this.handlePreSelection.bind(this,"left"):this.handleRangePick,right:this.preSelecting.right?this.handlePreSelection.bind(this,"right"):this.handleRangePick}}},watch:{modelValue(c){const d=c[0]?LT(c[0]):null,g=c[1]?LT(c[1]):null;this.dates=[d,g].sort(LD),this.rangeState={from:this.dates[0],to:this.dates[1],selecting:!1},this.setPanelDates(this.startDate||this.dates[0]||new Date)},currentView(c){const d=this.leftPanelDate.getMonth(),g=this.rightPanelDate.getMonth(),M=this.leftPanelDate.getFullYear()===this.rightPanelDate.getFullYear();c==="date"&&M&&d===g&&this.changePanelDate("right","Month",1),c==="month"&&M&&this.changePanelDate("right","FullYear",1),c==="year"&&M&&this.changePanelDate("right","FullYear",10)},selectionMode(c){this.currentView=c||"range"},focusedDate(c){this.setPanelDates(c||new Date)}},methods:{reset(){this.currentView=this.selectionMode,this.leftPickerTable=`${this.currentView}-table`,this.rightPickerTable=`${this.currentView}-table`},setPanelDates(c){this.leftPanelDate=c;const d=new Date(c.getFullYear(),c.getMonth()+1,1),g=this.dates[1]?this.dates[1].getTime():this.dates[1];this.rightPanelDate=this.splitPanels?new Date(Math.max(g,d.getTime())):d},panelLabelConfig(c){const d=this.t("i.locale"),g=this.t("i.datepicker.datePanelLabel"),M=F=>{const Y=F=="month"?this.showMonthPicker:this.showYearPicker;return()=>Y(c)},C=this[`${c}PanelDate`],{labels:b,separator:B}=BT(d,g,C);return{separator:B,labels:b.map(F=>(F.handler=M(F.type),F))}},prevYear(c){const d=this.currentView==="year"?-10:-1;this.changePanelDate(c,"FullYear",d)},nextYear(c){const d=this.currentView==="year"?10:1;this.changePanelDate(c,"FullYear",d)},prevMonth(c){this.changePanelDate(c,"Month",-1)},nextMonth(c){this.changePanelDate(c,"Month",1)},changePanelDate(c,d,g,M=!0){const C=new Date(this[`${c}PanelDate`]);if(d==="FullYear"?C[`set${d}`](C[`get${d}`]()+g):C[`set${d}`](C[`get${d}`]()+g,1),this[`${c}PanelDate`]=C,!!M)if(this.splitPanels){const b=c==="left"?"right":"left";c==="left"&&this.leftPanelDate>=this.rightPanelDate&&this.changePanelDate(b,d,1),c==="right"&&this.rightPanelDate<=this.leftPanelDate&&this.changePanelDate(b,d,-1)}else{const b=c==="left"?"right":"left",B=this[`${b}PanelDate`],F=new Date(B);if(d==="Month"){const Y=new Date(F.getFullYear(),F.getMonth()+g+1,0).getDate();F.setDate(Math.min(Y,F.getDate()))}F[`set${d}`](F[`get${d}`]()+g),this[`${b}PanelDate`]=F}},showYearPicker(c){this[`${c}PickerTable`]="year-table"},showMonthPicker(c){this[`${c}PickerTable`]="month-table"},handlePreSelection(c,d){if(this[`${c}PanelDate`]=d,this[`${c}PickerTable`]==="year-table"?this[`${c}PickerTable`]="month-table":this[`${c}PickerTable`]=`${this.currentView}-table`,!this.splitPanels){const g=c==="left"?"right":"left";this[`${g}PanelDate`]=d;const M=g==="left"?-1:1;this.changePanelDate(g,"Month",M,!1)}},handleRangePick(c,d){if(this.rangeState.selecting||this.currentView==="time"){if(this.currentView==="time")this.dates=c;else{const[g,M]=[this.rangeState.from,c].sort(LD);this.dates=[g,M],this.rangeState={from:g,to:M,selecting:!1}}this.handleConfirm(!1,d||"date")}else this.rangeState={from:c,to:null,selecting:!0}},handleChangeRange(c){this.rangeState.to=c}}},Vse=["onClick"];function Fse(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("date-panel-label"),Y=i.resolveComponent("time-picker"),G=i.resolveComponent("Confirm");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),onMousedown:d[8]||(d[8]=i.withModifiers(()=>{},["prevent"]))},[c.shortcuts.length?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-sidebar"])},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(c.shortcuts,K=>(i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([C.prefixCls+"-shortcut"]),key:K.text,onClick:fe=>c.handleShortcutClick(K)},i.toDisplayString(K.text),11,Vse))),128))],2)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass(b.panelBodyClasses)},[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content",C.prefixCls+"-content-left"])},[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.datePrefixCls+"-header"])},[i.createElementVNode("span",{class:i.normalizeClass(c.iconBtnCls("prev","-double")),onClick:d[0]||(d[0]=K=>b.prevYear("left"))},[i.createVNode(B,{type:"ios-arrow-back"})],2),C.leftPickerTable==="date-table"?i.withDirectives((i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass(c.iconBtnCls("prev")),onClick:d[1]||(d[1]=K=>b.prevMonth("left"))},[i.createVNode(B,{type:"ios-arrow-back"})],2)),[[i.vShow,C.currentView==="date"]]):i.createCommentVNode("",!0),i.createVNode(F,{"date-panel-label":b.leftDatePanelLabel,"current-view":b.leftDatePanelView,"date-prefix-cls":C.datePrefixCls},null,8,["date-panel-label","current-view","date-prefix-cls"]),g.splitPanels||C.leftPickerTable!=="date-table"?(i.openBlock(),i.createElementBlock("span",{key:1,class:i.normalizeClass(c.iconBtnCls("next","-double")),onClick:d[2]||(d[2]=K=>b.nextYear("left"))},[i.createVNode(B,{type:"ios-arrow-forward"})],2)):i.createCommentVNode("",!0),g.splitPanels&&C.leftPickerTable==="date-table"?i.withDirectives((i.openBlock(),i.createElementBlock("span",{key:2,class:i.normalizeClass(c.iconBtnCls("next")),onClick:d[3]||(d[3]=K=>b.nextMonth("left"))},[i.createVNode(B,{type:"ios-arrow-forward"})],2)),[[i.vShow,C.currentView==="date"]]):i.createCommentVNode("",!0)],2),[[i.vShow,C.currentView!=="time"]]),C.currentView!=="time"?(i.openBlock(),i.createBlock(i.resolveDynamicComponent(C.leftPickerTable),{key:0,ref:"leftYearTable","table-date":C.leftPanelDate,"selection-mode":"range","disabled-date":c.disabledDate,"range-state":C.rangeState,"show-week-numbers":c.showWeekNumbers,"model-value":b.preSelecting.left?[C.dates[0]]:C.dates,"focused-date":c.focusedDate,onOnChangeRange:b.handleChangeRange,onOnPick:b.panelPickerHandlers.left,onOnPickClick:c.handlePickClick},null,40,["table-date","disabled-date","range-state","show-week-numbers","model-value","focused-date","onOnChangeRange","onOnPick","onOnPickClick"])):i.createCommentVNode("",!0)],2),[[i.vShow,!c.isTime]]),i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content",C.prefixCls+"-content-right"])},[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.datePrefixCls+"-header"])},[g.splitPanels||C.rightPickerTable!=="date-table"?(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass(c.iconBtnCls("prev","-double")),onClick:d[4]||(d[4]=K=>b.prevYear("right"))},[i.createVNode(B,{type:"ios-arrow-back"})],2)):i.createCommentVNode("",!0),g.splitPanels&&C.rightPickerTable==="date-table"?i.withDirectives((i.openBlock(),i.createElementBlock("span",{key:1,class:i.normalizeClass(c.iconBtnCls("prev")),onClick:d[5]||(d[5]=K=>b.prevMonth("right"))},[i.createVNode(B,{type:"ios-arrow-back"})],2)),[[i.vShow,C.currentView==="date"]]):i.createCommentVNode("",!0),i.createVNode(F,{"date-panel-label":b.rightDatePanelLabel,"current-view":b.rightDatePanelView,"date-prefix-cls":C.datePrefixCls},null,8,["date-panel-label","current-view","date-prefix-cls"]),i.createElementVNode("span",{class:i.normalizeClass(c.iconBtnCls("next","-double")),onClick:d[6]||(d[6]=K=>b.nextYear("right"))},[i.createVNode(B,{type:"ios-arrow-forward"})],2),C.rightPickerTable==="date-table"?i.withDirectives((i.openBlock(),i.createElementBlock("span",{key:2,class:i.normalizeClass(c.iconBtnCls("next")),onClick:d[7]||(d[7]=K=>b.nextMonth("right"))},[i.createVNode(B,{type:"ios-arrow-forward"})],2)),[[i.vShow,C.currentView==="date"]]):i.createCommentVNode("",!0)],2),[[i.vShow,C.currentView!=="time"]]),C.currentView!=="time"?(i.openBlock(),i.createBlock(i.resolveDynamicComponent(C.rightPickerTable),{key:0,ref:"rightYearTable","table-date":C.rightPanelDate,"selection-mode":"range","range-state":C.rangeState,"disabled-date":c.disabledDate,"show-week-numbers":c.showWeekNumbers,"model-value":b.preSelecting.right?[C.dates[C.dates.length-1]]:C.dates,"focused-date":c.focusedDate,onOnChangeRange:b.handleChangeRange,onOnPick:b.panelPickerHandlers.right,onOnPickClick:c.handlePickClick},null,40,["table-date","range-state","disabled-date","show-week-numbers","model-value","focused-date","onOnChangeRange","onOnPick","onOnPickClick"])):i.createCommentVNode("",!0)],2),[[i.vShow,!c.isTime]]),i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content"])},[C.currentView==="time"?(i.openBlock(),i.createBlock(Y,i.mergeProps({key:0,ref:"timePicker","model-value":C.dates,format:c.format,"time-disabled":b.timeDisabled},c.timePickerOptions,{onOnPick:b.handleRangePick,onOnPickClick:c.handlePickClick,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess,onOnPickToggleTime:c.handleToggleTime}),null,16,["model-value","format","time-disabled","onOnPick","onOnPickClick","onOnPickClear","onOnPickSuccess","onOnPickToggleTime"])):i.createCommentVNode("",!0)],2),[[i.vShow,c.isTime]]),c.confirm?(i.openBlock(),i.createBlock(G,{key:0,"show-time":c.showTime,"is-time":c.isTime,"time-disabled":b.timeDisabled,onOnPickToggleTime:c.handleToggleTime,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess},null,8,["show-time","is-time","time-disabled","onOnPickToggleTime","onOnPickClear","onOnPickSuccess"])):i.createCommentVNode("",!0)],2)],34)}var zse=l(Use,[["render",Fse]]),BD={name:"CalendarPicker",mixins:[gD],props:{type:{validator(c){return O(c,["year","month","date","daterange","datetime","datetimerange"])},default:"date"}},components:{DatePickerPanel:Lse,RangeDatePickerPanel:zse},computed:{panel(){return this.type==="daterange"||this.type==="datetimerange"?"RangeDatePickerPanel":"DatePickerPanel"},ownPickerProps(){return this.options}}},Xse={1:{xs:24},2:{xs:24,sm:12},3:{xs:24,sm:12,md:8},4:{xs:24,sm:12,md:6}};const $D={name:"Description",inject:["DescriptionListInstance"],props:{term:{type:String}},computed:{styles(){let c={};return this.DescriptionListInstance.gutter!==0&&(c={paddingLeft:this.DescriptionListInstance.gutter/2+"px",paddingRight:this.DescriptionListInstance.gutter/2+"px"}),c}},render(){let c;(this.term||this.$slots.term)&&(this.$slots.term?c=i.h("div",{class:"ivu-description-term"},this.$slots.term()):c=i.h("div",{class:"ivu-description-term"},this.term));const d=i.h("div",{class:"ivu-description-detail"},this.$slots.default()),g=c?[c,d]:[d];return i.h(Ml,{...Xse[this.DescriptionListInstance.col],style:this.styles},()=>g)}},Wse={name:"DescriptionList",components:{Row:$h},provide(){return{DescriptionListInstance:this}},props:{layout:{validator(c){return O(c,["horizontal","vertical"])},default:"horizontal"},title:{type:String},gutter:{type:Number,default:32},col:{validator(c){return O(c,[1,2,3,4])},default:3}}},Gse={key:0,class:"ivu-description-list-title"};function Hse(c,d,g,M,C,b){const B=i.resolveComponent("Row");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["ivu-description-list",{"ivu-description-list-vertical":g.layout==="vertical"}])},[g.title||c.$slots.title?(i.openBlock(),i.createElementBlock("div",Gse,[i.renderSlot(c.$slots,"title",{},()=>[i.createTextVNode(i.toDisplayString(g.title),1)])])):i.createCommentVNode("",!0),i.createVNode(B,{gutter:g.gutter},{default:i.withCtx(()=>[i.renderSlot(c.$slots,"default")]),_:3},8,["gutter"])],2)}var UD=l(Wse,[["render",Hse]]);const Fh="ivu-divider",Qse={name:"Divider",props:{type:{type:String,default:"horizontal",validator(c){return O(c,["horizontal","vertical"])}},orientation:{type:String,default:"center",validator(c){return O(c,["left","right","center"])}},dashed:{type:Boolean,default:!1},size:{validator(c){return O(c,["small","default"])},default:"default"},plain:{type:Boolean,default:!1}},computed:{hasSlot(){return!!this.$slots.default},classes(){return[`${Fh}`,`${Fh}-${this.type}`,`${Fh}-${this.size}`,{[`${Fh}-with-text`]:this.hasSlot&&this.orientation==="center",[`${Fh}-with-text-${this.orientation}`]:this.hasSlot,[`${Fh}-dashed`]:!!this.dashed,[`${Fh}-plain`]:this.plain}]},slotClasses(){return[`${Fh}-inner-text`]}}};function jse(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[b.hasSlot?(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass(b.slotClasses)},[i.renderSlot(c.$slots,"default")],2)):i.createCommentVNode("",!0)],2)}var Dx=l(Qse,[["render",jse]]),HT={props:{lockScroll:{type:Boolean,default:!0}},methods:{checkScrollBar(){if(!s)return;let c=window.innerWidth;if(!c){const d=document.documentElement.getBoundingClientRect();c=d.right-Math.abs(d.left)}this.bodyIsOverflowing=document.body.clientWidth<c,this.bodyIsOverflowing&&(this.scrollBarWidth=T())},checkMaskInVisible(){let c=s?document.getElementsByClassName("ivu-modal-mask")||[]:[];return Array.from(c).every(d=>d.style.display==="none"||d.classList.contains("fade-leave-to"))},setScrollBar(){s&&this.bodyIsOverflowing&&this.scrollBarWidth!==void 0&&(document.body.style.paddingRight=`${this.scrollBarWidth}px`)},resetScrollBar(){s&&(document.body.style.paddingRight="")},addScrollEffect(){!this.lockScroll||(this.checkScrollBar(),this.setScrollBar(),s&&(document.body.style.overflow="hidden"))},removeScrollEffect(){!this.lockScroll||s&&this.checkMaskInVisible()&&(document.body.style.overflow="",this.resetScrollBar())}}};const Fs="ivu-drawer",Yse={name:"Drawer",mixins:[HT],components:{Icon:S},emits:["on-close","on-resize-width","on-visible-change","update:modelValue","on-drag"],provide(){return{DrawerInstance:this}},props:{modelValue:{type:Boolean,default:!1},title:{type:String},width:{type:[Number,String],default:256},height:{type:[Number,String],default:256},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},mask:{type:Boolean,default:!0},maskStyle:{type:Object},styles:{type:Object},scrollable:{type:Boolean,default:!1},placement:{validator(c){return O(c,["left","right","top","bottom"])},default:"right"},zIndex:{type:Number,default:1e3},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!0:c.$VIEWUI.transfer}},className:{type:String},inner:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},beforeClose:Function},data(){return{prefixCls:Fs,visible:this.modelValue,wrapShow:!1,showHead:!0,canMove:!1,dragWidth:this.width,dragHeight:this.height,wrapperWidth:this.width,wrapperHeight:this.height,wrapperLeft:0,minWidth:256,minHeight:256,id:j(6),tableList:[],sliderList:[]}},computed:{wrapClasses(){return[`${Fs}-wrap`,{[`${Fs}-hidden`]:!this.wrapShow,[`${this.className}`]:!!this.className,[`${Fs}-no-mask`]:!this.mask,[`${Fs}-wrap-inner`]:this.inner,[`${Fs}-wrap-dragging`]:this.canMove}]},wrapStyles(){return{zIndex:this.zIndex}},mainStyles(){let c={};if(this.placement==="left"||this.placement==="right"){const d=parseInt(this.dragWidth),g={width:d<=100?`${d}%`:`${d}px`};Object.assign(c,g)}else{const d=parseInt(this.dragHeight),g={height:d<=100?`${d}%`:`${d}px`};Object.assign(c,g)}return c},contentClasses(){return[`${Fs}-content`,{[`${Fs}-content-no-mask`]:!this.mask}]},classes(){return[`${Fs}`,`${Fs}-${this.placement}`,{[`${Fs}-no-header`]:!this.showHead,[`${Fs}-inner`]:this.inner}]},maskClasses(){return[`${Fs}-mask`,{[`${Fs}-mask-inner`]:this.inner}]},transitionName(){return this.placement==="left"||this.placement==="right"?`move-${this.placement}`:this.placement==="top"?"move-up":"move-down"}},methods:{close(){if(!this.beforeClose)return this.handleClose();const c=this.beforeClose();c&&c.then?c.then(()=>{this.handleClose()}):this.handleClose()},handleClose(){this.visible=!1,this.$emit("update:modelValue",!1),this.$emit("on-close")},handleMask(){this.maskClosable&&this.mask&&this.close()},handleWrapClick(c){const d=c.target.getAttribute("class");d&&d.indexOf(`${Fs}-wrap`)>-1&&this.handleMask()},handleMousemove(c){if(!this.canMove||!this.draggable)return;this.handleSetWrapperWidth();const d=c.pageX-this.wrapperLeft;let g=this.placement==="right"?this.wrapperWidth-d:d;g=Math.max(g,parseFloat(this.minWidth)),c.atMin=g===parseFloat(this.minWidth),g<=100&&(g=g/this.wrapperWidth*100),this.dragWidth=g,this.$emit("on-resize-width",parseInt(this.dragWidth)),this.$emit("on-drag","dragging",parseInt(this.dragWidth))},handleSetWrapperWidth(){const{width:c,left:d}=this.$refs.drawer.getBoundingClientRect();this.wrapperWidth=c,this.wrapperLeft=d},handleMouseup(){!this.draggable||(this.canMove=!1,this.$emit("on-drag","end"))},handleTriggerMousedown(){this.canMove=!0,window.getSelection().removeAllRanges(),this.$emit("on-drag","start")},addDrawer(){const c=this.$root;c.drawerList||(c.drawerList=[]),c.drawerList.push({id:this.id,drawer:this})},removeDrawer(){const c=this.$root;if(!c.drawerList)return;const d=c.drawerList.findIndex(g=>g.id===this.id);c.drawerList.splice(d,1)}},mounted(){this.visible&&(this.wrapShow=!0);let c=!0;this.$slots.header===void 0&&!this.title&&(c=!1),this.showHead=c,this.addDrawer(),o(document,"mousemove",this.handleMousemove),o(document,"mouseup",this.handleMouseup),this.handleSetWrapperWidth()},beforeUnmount(){this.removeDrawer(),a(document,"mousemove",this.handleMousemove),a(document,"mouseup",this.handleMouseup),this.removeScrollEffect()},watch:{modelValue(c){this.visible=c},visible(c){c===!1?this.timer=setTimeout(()=>{this.wrapShow=!1,this.$root.drawerList.map(d=>d.drawer).filter(d=>d.id!==this.id).some(d=>d.visible&&!d.scrollable)||this.removeScrollEffect()},300):(this.timer&&clearTimeout(this.timer),this.wrapShow=!0,this.scrollable||this.addScrollEffect()),this.tableList.forEach(d=>{d.table.handleOnVisibleChange(c)}),this.sliderList.forEach(d=>{d.slider.handleOnVisibleChange(c)}),this.$emit("on-visible-change",c)},scrollable(c){c?this.removeScrollEffect():this.addScrollEffect()},title(c){this.$slots.header===void 0&&(this.showHead=!!c)},width(c){this.dragWidth=c},height(c){this.dragHeight=c}}},qse={ref:"drawer"},Zse=i.createElementVNode("div",{class:"ivu-drawer-drag-move-trigger"},[i.createElementVNode("div",{class:"ivu-drawer-drag-move-trigger-point"},[i.createElementVNode("i"),i.createElementVNode("i"),i.createElementVNode("i"),i.createElementVNode("i"),i.createElementVNode("i")])],-1);function Kse(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createBlock(i.Teleport,{to:"body",disabled:!g.transfer},[i.createElementVNode("div",qse,[i.createVNode(i.Transition,{name:"fade"},{default:i.withCtx(()=>[g.mask?i.withDirectives((i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.maskClasses),style:i.normalizeStyle(g.maskStyle),onClick:d[0]||(d[0]=(...F)=>b.handleMask&&b.handleMask(...F))},null,6)),[[i.vShow,C.visible]]):i.createCommentVNode("",!0)]),_:1}),i.createElementVNode("div",{class:i.normalizeClass(b.wrapClasses),style:i.normalizeStyle(b.wrapStyles),onClick:d[3]||(d[3]=(...F)=>b.handleWrapClick&&b.handleWrapClick(...F))},[i.createVNode(i.Transition,{name:b.transitionName},{default:i.withCtx(()=>[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.mainStyles)},[i.createElementVNode("div",{class:i.normalizeClass(b.contentClasses),ref:"content"},[g.closable?(i.openBlock(),i.createElementBlock("a",{key:0,class:"ivu-drawer-close",onClick:d[1]||(d[1]=(...F)=>b.close&&b.close(...F))},[i.renderSlot(c.$slots,"close",{},()=>[i.createVNode(B,{type:"ios-close"})])])):i.createCommentVNode("",!0),C.showHead?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass([C.prefixCls+"-header"])},[i.renderSlot(c.$slots,"header",{},()=>[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-header-inner"])},i.toDisplayString(g.title),3)])],2)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body"]),style:i.normalizeStyle(g.styles)},[i.renderSlot(c.$slots,"default")],6)],2),g.draggable&&(g.placement==="left"||g.placement==="right")?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(["ivu-drawer-drag","ivu-drawer-drag-"+g.placement]),onMousedown:d[2]||(d[2]=(...F)=>b.handleTriggerMousedown&&b.handleTriggerMousedown(...F))},[i.renderSlot(c.$slots,"trigger",{},()=>[Zse])],34)):i.createCommentVNode("",!0)],6),[[i.vShow,C.visible]])]),_:3},8,["name"])],6)],512)],8,["disabled"])}var VD=l(Yse,[["render",Kse]]);const Lx="ivu-dropdown-item",Jse={name:"DropdownItem",props:{name:{type:[String,Number]},disabled:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},divided:{type:Boolean,default:!1}},computed:{classes(){return[`${Lx}`,{[`${Lx}-disabled`]:this.disabled,[`${Lx}-selected`]:this.selected,[`${Lx}-divided`]:this.divided}]}},methods:{handleClick(){if(this.disabled)return;const c=L(this,"Dropdown");this.$parent&&this.$parent.$options.name==="Dropdown"?this.$parent.handleHaschildClick():c&&c.$options.name==="Dropdown"&&c.handleHoverClick(),c.handleItemClick(this.name)}}};function eoe(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(b.classes),onClick:d[0]||(d[0]=(...B)=>b.handleClick&&b.handleClick(...B))},[i.renderSlot(c.$slots,"default")],2)}var FD=l(Jse,[["render",eoe]]);const toe=(c="")=>c.split("").reduce((d,g)=>{const M=g.charCodeAt(0);return M>=0&&M<=128?d+1:d+2},0),ioe=(c="",d)=>{let g=0;return c.split("").reduce((M,C)=>{const b=C.charCodeAt(0);return b>=0&&b<=128?g+=1:g+=2,g<=d?M+C:M},"")},noe={name:"Ellipsis",components:{Tooltip:Cc},emits:["on-show","on-hide"],props:{text:{type:String},height:{type:Number},lines:{type:Number},length:{type:Number},fullWidthRecognition:{type:Boolean,default:!1},autoResize:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},tooltip:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},theme:{validator(c){return O(c,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number],default:250},placement:{validator(c){return O(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"}},data(){return{oversize:!1,computedReady:!1,computedText:""}},watch:{disabled(){this.init()},text(){this.init()},height(){this.init()}},mounted(){this.init()},methods:{init(){this.disabled||(this.computeText(),this.limitShow())},computeText(){this.oversize=!1,this.computedReady=!1,i.nextTick(()=>{let c=this.$refs.text,d=this.$el,g=this.$refs.more,M=1e3,C=this.text,b=this.height;if(!b&&this.lines&&(b=parseInt(R(d,"lineHeight"),10)*this.lines),c){if(this.length)(this.fullWidthRecognition?toe(C):C.length)>this.length&&(this.oversize=!0,g.style.display="inline-block",C=this.fullWidthRecognition?ioe(C,this.length):C.slice(0,this.length));else if(d.offsetHeight>b)for(this.oversize=!0,g.style.display="inline-block";d.offsetHeight>b&&M>0;)d.offsetHeight>b*3?c.innerText=C=C.substring(0,Math.floor(C.length/2)):c.innerText=C=C.substring(0,C.length-1),M--}this.computedText=C})},limitShow(){this.computedReady=!0,i.nextTick(()=>{let c=this.$refs.text,d=this.$el;c&&(c.innerText=this.computedText,d.offsetHeight>this.height?this.$emit("on-hide"):this.$emit("on-show"))})}}},roe={class:"ivu-ellipsis"},soe={class:"ivu-ellipsis-more",ref:"more"},ooe={class:"ivu-ellipsis-more",ref:"more"},aoe={key:1,class:"ivu-ellipsis-hidden"},loe={class:"ivu-ellipsis-more",ref:"more"};function coe(c,d,g,M,C,b){const B=i.resolveComponent("Tooltip");return i.openBlock(),i.createElementBlock("div",roe,[i.renderSlot(c.$slots,"prefix",{class:"ivu-ellipsis-prefix"}),C.computedReady?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[g.tooltip?(i.openBlock(),i.createBlock(B,{key:0,content:g.text,theme:g.theme,"max-width":g.maxWidth,placement:g.placement,transfer:g.transfer},{default:i.withCtx(()=>[i.createElementVNode("span",{class:"ivu-ellipsis-text",ref:"text"},i.toDisplayString(g.text),513),i.withDirectives(i.createElementVNode("span",soe,[i.renderSlot(c.$slots,"more",{},()=>[i.createTextVNode("...")])],512),[[i.vShow,C.oversize]]),i.renderSlot(c.$slots,"suffix",{class:"ivu-ellipsis-suffix"})]),_:3},8,["content","theme","max-width","placement","transfer"])):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createElementVNode("span",{class:"ivu-ellipsis-text",ref:"text"},i.toDisplayString(g.text),513),i.withDirectives(i.createElementVNode("span",ooe,[i.renderSlot(c.$slots,"more",{},()=>[i.createTextVNode("...")])],512),[[i.vShow,C.oversize]]),i.renderSlot(c.$slots,"suffix",{class:"ivu-ellipsis-suffix"})],64))],64)):(i.openBlock(),i.createElementBlock("div",aoe,[i.createElementVNode("span",{class:"ivu-ellipsis-text",ref:"text"},i.toDisplayString(g.text),513),i.withDirectives(i.createElementVNode("span",loe,[i.renderSlot(c.$slots,"more",{},()=>[i.createTextVNode("...")])],512),[[i.vShow,C.oversize]]),i.renderSlot(c.$slots,"suffix",{class:"ivu-ellipsis-suffix"})]))])}var zD=l(noe,[["render",coe]]);const XD={name:"Email",mixins:[P0],data(){return{className:"ivu-login-mail",prefix:"ios-mail-outline",placeholder:"请输入邮箱",type:"email"}},props:{rules:{type:[Object,Array],default(){return[{required:!0,message:ET.Email,trigger:"change"},{type:"email",message:"输入的邮箱格式不正确！",trigger:"change"}]}}}};var Bx={403:{img:"https://file.iviewui.com/iview-pro/icon-403.svg",imgColor:"https://file.iviewui.com/iview-pro/icon-403-color.svg",title:"403",desc:"抱歉，你无权访问该页面"},404:{img:"https://file.iviewui.com/iview-pro/icon-404.svg",imgColor:"https://file.iviewui.com/iview-pro/icon-404-color.svg",title:"404",desc:"抱歉，你访问的页面不存在"},500:{img:"https://file.iviewui.com/iview-pro/icon-500.svg",imgColor:"https://file.iviewui.com/iview-pro/icon-500-color.svg",title:"500",desc:"抱歉，服务器出错了"}};const hoe={name:"Exception",components:{Button:Us},props:{type:{validator(c){return O(c,["403","404","500",403,404,500])},default:"404"},title:{type:String},desc:{type:String},img:{type:String},imgColor:{type:Boolean,default:!1},backText:{type:String,default:"返回首页"},redirect:{type:String,default:"/"}},computed:{imgPath(){return this.img?this.img:this.imgColor?Bx[this.type].imgColor:Bx[this.type].img},titleText(){return this.title?this.title:Bx[this.type].title},descText(){return this.desc?this.desc:Bx[this.type].desc}}},uoe={class:"ivu-exception"},doe={class:"ivu-exception-img"},foe={class:"ivu-exception-content"},poe={class:"ivu-exception-content-desc"},moe={class:"ivu-exception-content-actions"};function goe(c,d,g,M,C,b){const B=i.resolveComponent("Button");return i.openBlock(),i.createElementBlock("div",uoe,[i.createElementVNode("div",doe,[i.createElementVNode("div",{class:"ivu-exception-img-element",style:i.normalizeStyle({"background-image":"url("+b.imgPath+")"})},null,4)]),i.createElementVNode("div",foe,[i.createElementVNode("h1",null,[i.renderSlot(c.$slots,"title",{},()=>[i.createTextVNode(i.toDisplayString(b.titleText),1)])]),i.createElementVNode("div",poe,[i.renderSlot(c.$slots,"desc",{},()=>[i.createTextVNode(i.toDisplayString(b.descText),1)])]),i.createElementVNode("div",moe,[i.renderSlot(c.$slots,"actions",{},()=>[i.createVNode(B,{to:g.redirect,type:"primary",size:"large"},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(g.backText),1)]),_:1},8,["to"])])])])])}var WD=l(hoe,[["render",goe]]);const voe="ivu-layout",yoe={name:"Footer",computed:{wrapClasses(){return`${voe}-footer`}}};function boe(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses)},[i.renderSlot(c.$slots,"default")],2)}var QT=l(yoe,[["render",boe]]);const xoe={name:"FooterToolbar",props:{extra:{type:String}}},woe={class:"ivu-footer-toolbar"},_oe={key:0,class:"ivu-footer-toolbar-left"},Ooe={class:"ivu-footer-toolbar-right"};function Soe(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",woe,[g.extra||c.$slots.extra?(i.openBlock(),i.createElementBlock("div",_oe,[i.renderSlot(c.$slots,"extra",{},()=>[i.createTextVNode(i.toDisplayString(g.extra),1)])])):i.createCommentVNode("",!0),i.createElementVNode("div",Ooe,[i.renderSlot(c.$slots,"default")])])}var GD=l(xoe,[["render",Soe]]);const $x="ivu-form",Coe={name:"iForm",emits:["on-validate"],provide(){return{FormInstance:this}},props:{model:{type:Object},rules:{type:Object},labelWidth:{type:Number},labelPosition:{validator(c){return O(c,["left","right","top"])},default:"right"},inline:{type:Boolean,default:!1},showMessage:{type:Boolean,default:!0},autocomplete:{validator(c){return O(c,["on","off"])},default:"off"},hideRequiredMark:{type:Boolean,default:!1},labelColon:{type:[Boolean,String],default:!1},disabled:{type:Boolean,default:!1}},data(){return{fields:[]}},computed:{classes(){return[`${$x}`,`${$x}-label-${this.labelPosition}`,{[`${$x}-inline`]:this.inline,[`${$x}-hide-required-mark`]:this.hideRequiredMark}]},colon(){let c="";return this.labelColon&&(c=typeof this.labelColon=="boolean"?":":this.labelColon),c}},methods:{resetFields(){this.fields.forEach(c=>{c.resetField()})},validate(c){return new Promise(d=>{let g=!0,M=0;this.fields.length===0&&(d(g),typeof c=="function"&&c(g)),this.fields.forEach(C=>{C.validate("",b=>{b&&(g=!1),++M===this.fields.length&&(d(g),typeof c=="function"&&c(g))})})})},validateField(c,d){const g=this.fields.filter(M=>M.prop===c)[0];if(!g)throw new Error("[View UI warn]: must call validateField with valid prop string!");g.validate("",d)},addField(c){c&&this.fields.push(c)},removeField(c){c.prop&&this.fields.splice(this.fields.indexOf(c),1)}},watch:{rules(){this.validate()}}},Toe=["autocomplete"];function Eoe(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("form",{class:i.normalizeClass(b.classes),autocomplete:g.autocomplete},[i.renderSlot(c.$slots,"default")],10,Toe)}var Ux=l(Coe,[["render",Eoe]]);const Moe={name:"GlobalFooter",components:{Icon:S},props:{links:{type:Array,default(){return[]}},copyright:{type:String}}},Aoe={class:"ivu-global-footer"},koe={key:0,class:"ivu-global-footer-links"},Poe=["href","target","title"],Roe={key:1,class:"ivu-global-footer-copyright"};function Ioe(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("footer",Aoe,[g.links.length||c.$slots.links?(i.openBlock(),i.createElementBlock("div",koe,[i.renderSlot(c.$slots,"links",{},()=>[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.links,F=>(i.openBlock(),i.createElementBlock("a",{href:F.href,target:F.blankTarget?"_blank":"_self",key:F.key,title:F.title},[F.icon?(i.openBlock(),i.createBlock(B,{key:0,type:F.icon},null,8,["type"])):F.customIcon?(i.openBlock(),i.createBlock(B,{key:1,custom:F.customIcon},null,8,["custom"])):i.createCommentVNode("",!0),i.createTextVNode(" "+i.toDisplayString(F.title),1)],8,Poe))),128))])])):i.createCommentVNode("",!0),g.copyright||c.$slots.copyright?(i.openBlock(),i.createElementBlock("div",Roe,[i.renderSlot(c.$slots,"copyright",{},()=>[i.createTextVNode(i.toDisplayString(g.copyright),1)])])):i.createCommentVNode("",!0)])}var HD=l(Moe,[["render",Ioe]]),jT={exports:{}},Noe=jT.exports={};Noe.forEach=function(c,d){for(var g=0;g<c.length;g++){var M=d(c[g]);if(M)return M}};var Doe=function(c){var d=c.stateHandler.getState;function g(B){var F=d(B);return F&&!!F.isDetectable}function M(B){d(B).isDetectable=!0}function C(B){return!!d(B).busy}function b(B,F){d(B).busy=!!F}return{isDetectable:g,markAsDetectable:M,isBusy:C,markBusy:b}},Loe=function(c){var d={};function g(B){var F=c.get(B);return F===void 0?[]:d[F]||[]}function M(B,F){var Y=c.get(B);d[Y]||(d[Y]=[]),d[Y].push(F)}function C(B,F){for(var Y=g(B),G=0,K=Y.length;G<K;++G)if(Y[G]===F){Y.splice(G,1);break}}function b(B){var F=g(B);!F||(F.length=0)}return{get:g,add:M,removeListener:C,removeAllListeners:b}},Boe=function(){var c=1;function d(){return c++}return{generate:d}},$oe=function(c){var d=c.idGenerator,g=c.stateHandler.getState;function M(b){var B=g(b);return B&&B.id!==void 0?B.id:null}function C(b){var B=g(b);if(!B)throw new Error("setId required the element to have a resize detection state.");var F=d.generate();return B.id=F,F}return{get:M,set:C}},Uoe=function(c){function d(){}var g={log:d,warn:d,error:d};if(!c&&window.console){var M=function(C,b){C[b]=function(){var B=console[b];if(B.apply)B.apply(console,arguments);else for(var F=0;F<arguments.length;F++)B(arguments[F])}};M(g,"log"),M(g,"warn"),M(g,"error")}return g},YT={exports:{}},QD=YT.exports={};QD.isIE=function(c){function d(){var M=navigator.userAgent.toLowerCase();return M.indexOf("msie")!==-1||M.indexOf("trident")!==-1||M.indexOf(" edge/")!==-1}if(!d())return!1;if(!c)return!0;var g=function(){var M,C=3,b=document.createElement("div"),B=b.getElementsByTagName("i");do b.innerHTML="<!--[if gt IE "+ ++C+"]><i></i><![endif]-->";while(B[0]);return C>4?C:M}();return c===g},QD.isLegacyOpera=function(){return!!window.opera};var jD={exports:{}},Voe=jD.exports={};Voe.getOption=Foe;function Foe(c,d,g){var M=c[d];return M==null&&g!==void 0?g:M}var YD=jD.exports,zoe=function(c){c=c||{};var d=c.reporter,g=YD.getOption(c,"async",!0),M=YD.getOption(c,"auto",!0);M&&!g&&(d&&d.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),g=!0);var C=qD(),b,B=!1;function F(Ce,Oe){!B&&M&&g&&C.size()===0&&K(),C.add(Ce,Oe)}function Y(){for(B=!0;C.size();){var Ce=C;C=qD(),Ce.process()}B=!1}function G(Ce){B||(Ce===void 0&&(Ce=g),b&&(fe(b),b=null),Ce?K():Y())}function K(){b=Ee(Y)}function fe(Ce){var Oe=clearTimeout;return Oe(Ce)}function Ee(Ce){var Oe=function(ue){return setTimeout(ue,0)};return Oe(Ce)}return{add:F,force:G}};function qD(){var c={},d=0,g=0,M=0;function C(F,Y){Y||(Y=F,F=0),F>g?g=F:F<M&&(M=F),c[F]||(c[F]=[]),c[F].push(Y),d++}function b(){for(var F=M;F<=g;F++)for(var Y=c[F],G=0;G<Y.length;G++){var K=Y[G];K()}}function B(){return d}return{add:C,process:b,size:B}}var qT="_erd";function Xoe(c){return c[qT]={},ZD(c)}function ZD(c){return c[qT]}function Woe(c){delete c[qT]}var Goe={initState:Xoe,getState:ZD,cleanState:Woe},X0=YT.exports,Hoe=function(c){c=c||{};var d=c.reporter,g=c.batchProcessor,M=c.stateHandler.getState;if(!d)throw new Error("Missing required dependency: reporter.");function C(G,K){function fe(){K(G)}if(X0.isIE(8))M(G).object={proxy:fe},G.attachEvent("onresize",fe);else{var Ee=F(G);if(!Ee)throw new Error("Element is not detectable by this strategy.");Ee.contentDocument.defaultView.addEventListener("resize",fe)}}function b(G){var K=c.important?" !important; ":"; ";return(G.join(K)+K).trim()}function B(G,K,fe){fe||(fe=K,K=G,G=null),G=G||{},G.debug;function Ee(Ce,Oe){var ue=b(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),Ne=!1,jt=window.getComputedStyle(Ce),_t=Ce.offsetWidth,Et=Ce.offsetHeight;M(Ce).startSize={width:_t,height:Et};function je(){function Le(){if(jt.position==="static"){Ce.style.setProperty("position","relative",G.important?"important":"");var ti=function(ii,$t,Mt,Ft){function si(Ot){return Ot.replace(/[^-\d\.]/g,"")}var Ut=Mt[Ft];Ut!=="auto"&&si(Ut)!=="0"&&(ii.warn("An element that is positioned static has style."+Ft+"="+Ut+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Ft+" will be set to 0. Element: ",$t),$t.style.setProperty(Ft,"0",G.important?"important":""))};ti(d,Ce,jt,"top"),ti(d,Ce,jt,"right"),ti(d,Ce,jt,"bottom"),ti(d,Ce,jt,"left")}}function tt(){Ne||Le();function ti($t,Mt){if(!$t.contentDocument){var Ft=M($t);Ft.checkForObjectDocumentTimeoutId&&window.clearTimeout(Ft.checkForObjectDocumentTimeoutId),Ft.checkForObjectDocumentTimeoutId=setTimeout(function(){Ft.checkForObjectDocumentTimeoutId=0,ti($t,Mt)},100);return}Mt($t.contentDocument)}var ii=this;ti(ii,function($t){Oe(Ce)})}jt.position!==""&&(Le(),Ne=!0);var Ze=document.createElement("object");Ze.style.cssText=ue,Ze.tabIndex=-1,Ze.type="text/html",Ze.setAttribute("aria-hidden","true"),Ze.onload=tt,X0.isIE()||(Ze.data="about:blank"),M(Ce)&&(Ce.appendChild(Ze),M(Ce).object=Ze,X0.isIE()&&(Ze.data="about:blank"))}g?g.add(je):je()}X0.isIE(8)?fe(K):Ee(K,fe)}function F(G){return M(G).object}function Y(G){if(M(G)){var K=F(G);!K||(X0.isIE(8)?G.detachEvent("onresize",K.proxy):G.removeChild(K),M(G).checkForObjectDocumentTimeoutId&&window.clearTimeout(M(G).checkForObjectDocumentTimeoutId),delete M(G).object)}}return{makeDetectable:B,addListener:C,uninstall:Y}},Qoe=jT.exports.forEach,joe=function(c){c=c||{};var d=c.reporter,g=c.batchProcessor,M=c.stateHandler.getState;c.stateHandler.hasState;var C=c.idHandler;if(!g)throw new Error("Missing required dependency: batchProcessor");if(!d)throw new Error("Missing required dependency: reporter.");var b=K(),B="erd_scroll_detection_scrollbar_style",F="erd_scroll_detection_container";function Y(je){fe(je,B,F)}Y(window.document);function G(je){var Le=c.important?" !important; ":"; ";return(je.join(Le)+Le).trim()}function K(){var je=500,Le=500,tt=document.createElement("div");tt.style.cssText=G(["position: absolute","width: "+je*2+"px","height: "+Le*2+"px","visibility: hidden","margin: 0","padding: 0"]);var Ze=document.createElement("div");Ze.style.cssText=G(["position: absolute","width: "+je+"px","height: "+Le+"px","overflow: scroll","visibility: none","top: "+-je*3+"px","left: "+-Le*3+"px","visibility: hidden","margin: 0","padding: 0"]),Ze.appendChild(tt),document.body.insertBefore(Ze,document.body.firstChild);var ti=je-Ze.clientWidth,ii=Le-Ze.clientHeight;return document.body.removeChild(Ze),{width:ti,height:ii}}function fe(je,Le,tt){function Ze(Mt,Ft){Ft=Ft||function(Ut){je.head.appendChild(Ut)};var si=je.createElement("style");return si.innerHTML=Mt,si.id=Le,Ft(si),si}if(!je.getElementById(Le)){var ti=tt+"_animation",ii=tt+"_animation_active",$t=`/* Created by the element-resize-detector library. */
`;$t+="."+tt+" > div::-webkit-scrollbar { "+G(["display: none"])+` }

`,$t+="."+ii+" { "+G(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+ti,"animation-name: "+ti])+` }
`,$t+="@-webkit-keyframes "+ti+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,$t+="@keyframes "+ti+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",Ze($t)}}function Ee(je){je.className+=" "+F+"_animation_active"}function Ce(je,Le,tt){if(je.addEventListener)je.addEventListener(Le,tt);else if(je.attachEvent)je.attachEvent("on"+Le,tt);else return d.error("[scroll] Don't know how to add event listeners.")}function Oe(je,Le,tt){if(je.removeEventListener)je.removeEventListener(Le,tt);else if(je.detachEvent)je.detachEvent("on"+Le,tt);else return d.error("[scroll] Don't know how to remove event listeners.")}function ue(je){return M(je).container.childNodes[0].childNodes[0].childNodes[0]}function Ne(je){return M(je).container.childNodes[0].childNodes[0].childNodes[1]}function jt(je,Le){var tt=M(je).listeners;if(!tt.push)throw new Error("Cannot add listener to an element that is not detectable.");M(je).listeners.push(Le)}function _t(je,Le,tt){tt||(tt=Le,Le=je,je=null),je=je||{};function Ze(){if(je.debug){var Rt=Array.prototype.slice.call(arguments);if(Rt.unshift(C.get(Le),"Scroll: "),d.log.apply)d.log.apply(null,Rt);else for(var fi=0;fi<Rt.length;fi++)d.log(Rt[fi])}}function ti(Rt){function fi(ji){var Yr=ji.getRootNode&&ji.getRootNode().contains(ji);return ji===ji.ownerDocument.body||ji.ownerDocument.body.contains(ji)||Yr}return!fi(Rt)||window.getComputedStyle(Rt)===null}function ii(Rt){var fi=M(Rt).container.childNodes[0],ji=window.getComputedStyle(fi);return!ji.width||ji.width.indexOf("px")===-1}function $t(){var Rt=window.getComputedStyle(Le),fi={};return fi.position=Rt.position,fi.width=Le.offsetWidth,fi.height=Le.offsetHeight,fi.top=Rt.top,fi.right=Rt.right,fi.bottom=Rt.bottom,fi.left=Rt.left,fi.widthCSS=Rt.width,fi.heightCSS=Rt.height,fi}function Mt(){var Rt=$t();M(Le).startSize={width:Rt.width,height:Rt.height},Ze("Element start size",M(Le).startSize)}function Ft(){M(Le).listeners=[]}function si(){if(Ze("storeStyle invoked."),!M(Le)){Ze("Aborting because element has been uninstalled");return}var Rt=$t();M(Le).style=Rt}function Ut(Rt,fi,ji){M(Rt).lastWidth=fi,M(Rt).lastHeight=ji}function Ot(Rt){return ue(Rt).childNodes[0]}function pt(){return 2*b.width+1}function Xt(){return 2*b.height+1}function Tt(Rt){return Rt+10+pt()}function mi(Rt){return Rt+10+Xt()}function xi(Rt){return Rt*2+pt()}function hn(Rt){return Rt*2+Xt()}function Cn(Rt,fi,ji){var Yr=ue(Rt),zs=Ne(Rt),Rc=Tt(fi),Kh=mi(ji),Xs=xi(fi),vn=hn(ji);Yr.scrollLeft=Rc,Yr.scrollTop=Kh,zs.scrollLeft=Xs,zs.scrollTop=vn}function Hn(){var Rt=M(Le).container;if(!Rt){Rt=document.createElement("div"),Rt.className=F,Rt.style.cssText=G(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),M(Le).container=Rt,Ee(Rt),Le.appendChild(Rt);var fi=function(){M(Le).onRendered&&M(Le).onRendered()};Ce(Rt,"animationstart",fi),M(Le).onAnimationStart=fi}return Rt}function er(){function Rt(){var xr=M(Le).style;if(xr.position==="static"){Le.style.setProperty("position","relative",je.important?"important":"");var Za=function(Ic,Ka,rw,Jh){function TE(EE){return EE.replace(/[^-\d\.]/g,"")}var sv=rw[Jh];sv!=="auto"&&TE(sv)!=="0"&&(Ic.warn("An element that is positioned static has style."+Jh+"="+sv+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Jh+" will be set to 0. Element: ",Ka),Ka.style[Jh]=0)};Za(d,Le,xr,"top"),Za(d,Le,xr,"right"),Za(d,Le,xr,"bottom"),Za(d,Le,xr,"left")}}function fi(xr,Za,Ic,Ka){return xr=xr?xr+"px":"0",Za=Za?Za+"px":"0",Ic=Ic?Ic+"px":"0",Ka=Ka?Ka+"px":"0",["left: "+xr,"top: "+Za,"right: "+Ka,"bottom: "+Ic]}if(Ze("Injecting elements"),!M(Le)){Ze("Aborting because element has been uninstalled");return}Rt();var ji=M(Le).container;ji||(ji=Hn());var Yr=b.width,zs=b.height,Rc=G(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),Kh=G(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(fi(-(1+Yr),-(1+zs),-zs,-Yr))),Xs=G(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),vn=G(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),ao=G(["position: absolute","left: 0","top: 0"]),Ya=G(["position: absolute","width: 200%","height: 200%"]),Uo=document.createElement("div"),qa=document.createElement("div"),qp=document.createElement("div"),tw=document.createElement("div"),Zp=document.createElement("div"),iw=document.createElement("div");Uo.dir="ltr",Uo.style.cssText=Rc,Uo.className=F,qa.className=F,qa.style.cssText=Kh,qp.style.cssText=Xs,tw.style.cssText=ao,Zp.style.cssText=vn,iw.style.cssText=Ya,qp.appendChild(tw),Zp.appendChild(iw),qa.appendChild(qp),qa.appendChild(Zp),Uo.appendChild(qa),ji.appendChild(Uo);function nw(){var xr=M(Le);xr&&xr.onExpand?xr.onExpand():Ze("Aborting expand scroll handler: element has been uninstalled")}function rv(){var xr=M(Le);xr&&xr.onShrink?xr.onShrink():Ze("Aborting shrink scroll handler: element has been uninstalled")}Ce(qp,"scroll",nw),Ce(Zp,"scroll",rv),M(Le).onExpandScroll=nw,M(Le).onShrinkScroll=rv}function as(){function Rt(Xs,vn,ao){var Ya=Ot(Xs),Uo=Tt(vn),qa=mi(ao);Ya.style.setProperty("width",Uo+"px",je.important?"important":""),Ya.style.setProperty("height",qa+"px",je.important?"important":"")}function fi(Xs){var vn=Le.offsetWidth,ao=Le.offsetHeight,Ya=vn!==M(Le).lastWidth||ao!==M(Le).lastHeight;Ze("Storing current size",vn,ao),Ut(Le,vn,ao),g.add(0,function(){if(Ya){if(!M(Le)){Ze("Aborting because element has been uninstalled");return}if(!ji()){Ze("Aborting because element container has not been initialized");return}if(je.debug){var Uo=Le.offsetWidth,qa=Le.offsetHeight;(Uo!==vn||qa!==ao)&&d.warn(C.get(Le),"Scroll: Size changed before updating detector elements.")}Rt(Le,vn,ao)}}),g.add(1,function(){if(!M(Le)){Ze("Aborting because element has been uninstalled");return}if(!ji()){Ze("Aborting because element container has not been initialized");return}Cn(Le,vn,ao)}),Ya&&Xs&&g.add(2,function(){if(!M(Le)){Ze("Aborting because element has been uninstalled");return}if(!ji()){Ze("Aborting because element container has not been initialized");return}Xs()})}function ji(){return!!M(Le).container}function Yr(){function Xs(){return M(Le).lastNotifiedWidth===void 0}Ze("notifyListenersIfNeeded invoked");var vn=M(Le);if(Xs()&&vn.lastWidth===vn.startSize.width&&vn.lastHeight===vn.startSize.height)return Ze("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(vn.lastWidth===vn.lastNotifiedWidth&&vn.lastHeight===vn.lastNotifiedHeight)return Ze("Not notifying: Size already notified");Ze("Current size not notified, notifying..."),vn.lastNotifiedWidth=vn.lastWidth,vn.lastNotifiedHeight=vn.lastHeight,Qoe(M(Le).listeners,function(ao){ao(Le)})}function zs(){if(Ze("startanimation triggered."),ii(Le)){Ze("Ignoring since element is still unrendered...");return}Ze("Element rendered.");var Xs=ue(Le),vn=Ne(Le);(Xs.scrollLeft===0||Xs.scrollTop===0||vn.scrollLeft===0||vn.scrollTop===0)&&(Ze("Scrollbars out of sync. Updating detector elements..."),fi(Yr))}function Rc(){if(Ze("Scroll detected."),ii(Le)){Ze("Scroll event fired while unrendered. Ignoring...");return}fi(Yr)}if(Ze("registerListenersAndPositionElements invoked."),!M(Le)){Ze("Aborting because element has been uninstalled");return}M(Le).onRendered=zs,M(Le).onExpand=Rc,M(Le).onShrink=Rc;var Kh=M(Le).style;Rt(Le,Kh.width,Kh.height)}function oo(){if(Ze("finalizeDomMutation invoked."),!M(Le)){Ze("Aborting because element has been uninstalled");return}var Rt=M(Le).style;Ut(Le,Rt.width,Rt.height),Cn(Le,Rt.width,Rt.height)}function Qa(){tt(Le)}function ja(){Ze("Installing..."),Ft(),Mt(),g.add(0,si),g.add(1,er),g.add(2,as),g.add(3,oo),g.add(4,Qa)}Ze("Making detectable..."),ti(Le)?(Ze("Element is detached"),Hn(),Ze("Waiting until element is attached..."),M(Le).onRendered=function(){Ze("Element is now attached"),ja()}):ja()}function Et(je){var Le=M(je);!Le||(Le.onExpandScroll&&Oe(ue(je),"scroll",Le.onExpandScroll),Le.onShrinkScroll&&Oe(Ne(je),"scroll",Le.onShrinkScroll),Le.onAnimationStart&&Oe(Le.container,"animationstart",Le.onAnimationStart),Le.container&&je.removeChild(Le.container))}return{makeDetectable:_t,addListener:jt,uninstall:Et,initDocument:Y}},W0=jT.exports.forEach,Yoe=Doe,qoe=Loe,Zoe=Boe,Koe=$oe,Joe=Uoe,KD=YT.exports,eae=zoe,zh=Goe,tae=Hoe,iae=joe;function JD(c){return Array.isArray(c)||c.length!==void 0}function eL(c){if(Array.isArray(c))return c;var d=[];return W0(c,function(g){d.push(g)}),d}function tL(c){return c&&c.nodeType===1}var Wp=function(c){c=c||{};var d;if(c.idHandler)d={get:function(_t){return c.idHandler.get(_t,!0)},set:c.idHandler.set};else{var g=Zoe(),M=Koe({idGenerator:g,stateHandler:zh});d=M}var C=c.reporter;if(!C){var b=C===!1;C=Joe(b)}var B=Xh(c,"batchProcessor",eae({reporter:C})),F={};F.callOnAdd=!!Xh(c,"callOnAdd",!0),F.debug=!!Xh(c,"debug",!1);var Y=qoe(d),G=Yoe({stateHandler:zh}),K,fe=Xh(c,"strategy","object"),Ee=Xh(c,"important",!1),Ce={reporter:C,batchProcessor:B,stateHandler:zh,idHandler:d,important:Ee};if(fe==="scroll"&&(KD.isLegacyOpera()?(C.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),fe="object"):KD.isIE(9)&&(C.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),fe="object")),fe==="scroll")K=iae(Ce);else if(fe==="object")K=tae(Ce);else throw new Error("Invalid strategy name: "+fe);var Oe={};function ue(_t,Et,je){function Le(Mt){var Ft=Y.get(Mt);W0(Ft,function(si){si(Mt)})}function tt(Mt,Ft,si){Y.add(Ft,si),Mt&&si(Ft)}if(je||(je=Et,Et=_t,_t={}),!Et)throw new Error("At least one element required.");if(!je)throw new Error("Listener required.");if(tL(Et))Et=[Et];else if(JD(Et))Et=eL(Et);else return C.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var Ze=0,ti=Xh(_t,"callOnAdd",F.callOnAdd),ii=Xh(_t,"onReady",function(){}),$t=Xh(_t,"debug",F.debug);W0(Et,function(Mt){zh.getState(Mt)||(zh.initState(Mt),d.set(Mt));var Ft=d.get(Mt);if($t&&C.log("Attaching listener to element",Ft,Mt),!G.isDetectable(Mt)){if($t&&C.log(Ft,"Not detectable."),G.isBusy(Mt)){$t&&C.log(Ft,"System busy making it detectable"),tt(ti,Mt,je),Oe[Ft]=Oe[Ft]||[],Oe[Ft].push(function(){Ze++,Ze===Et.length&&ii()});return}return $t&&C.log(Ft,"Making detectable..."),G.markBusy(Mt,!0),K.makeDetectable({debug:$t,important:Ee},Mt,function(si){if($t&&C.log(Ft,"onElementDetectable"),zh.getState(si)){G.markAsDetectable(si),G.markBusy(si,!1),K.addListener(si,Le),tt(ti,si,je);var Ut=zh.getState(si);if(Ut&&Ut.startSize){var Ot=si.offsetWidth,pt=si.offsetHeight;(Ut.startSize.width!==Ot||Ut.startSize.height!==pt)&&Le(si)}Oe[Ft]&&W0(Oe[Ft],function(Xt){Xt()})}else $t&&C.log(Ft,"Element uninstalled before being detectable.");delete Oe[Ft],Ze++,Ze===Et.length&&ii()})}$t&&C.log(Ft,"Already detecable, adding listener."),tt(ti,Mt,je),Ze++}),Ze===Et.length&&ii()}function Ne(_t){if(!_t)return C.error("At least one element is required.");if(tL(_t))_t=[_t];else if(JD(_t))_t=eL(_t);else return C.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");W0(_t,function(Et){Y.removeAllListeners(Et),K.uninstall(Et),zh.cleanState(Et)})}function jt(_t){K.initDocument&&K.initDocument(_t)}return{listenTo:ue,removeListener:Y.removeListener,removeAllListeners:Y.removeAllListeners,uninstall:Ne,initDocument:jt}};function Xh(c,d,g){var M=c[d];return M==null&&g!==void 0?g:M}var iL="Expected a function",nL=NaN,nae="[object Symbol]",rae=/^\s+|\s+$/g,sae=/^[-+]0x[0-9a-f]+$/i,oae=/^0b[01]+$/i,aae=/^0o[0-7]+$/i,lae=parseInt,cae=typeof ie=="object"&&ie&&ie.Object===Object&&ie,hae=typeof self=="object"&&self&&self.Object===Object&&self,uae=cae||hae||Function("return this")(),dae=Object.prototype,fae=dae.toString,pae=Math.max,mae=Math.min,ZT=function(){return uae.Date.now()};function gae(c,d,g){var M,C,b,B,F,Y,G=0,K=!1,fe=!1,Ee=!0;if(typeof c!="function")throw new TypeError(iL);d=rL(d)||0,Vx(g)&&(K=!!g.leading,fe="maxWait"in g,b=fe?pae(rL(g.maxWait)||0,d):b,Ee="trailing"in g?!!g.trailing:Ee);function Ce(tt){var Ze=M,ti=C;return M=C=void 0,G=tt,B=c.apply(ti,Ze),B}function Oe(tt){return G=tt,F=setTimeout(jt,d),K?Ce(tt):B}function ue(tt){var Ze=tt-Y,ti=tt-G,ii=d-Ze;return fe?mae(ii,b-ti):ii}function Ne(tt){var Ze=tt-Y,ti=tt-G;return Y===void 0||Ze>=d||Ze<0||fe&&ti>=b}function jt(){var tt=ZT();if(Ne(tt))return _t(tt);F=setTimeout(jt,ue(tt))}function _t(tt){return F=void 0,Ee&&M?Ce(tt):(M=C=void 0,B)}function Et(){F!==void 0&&clearTimeout(F),G=0,M=Y=C=F=void 0}function je(){return F===void 0?B:_t(ZT())}function Le(){var tt=ZT(),Ze=Ne(tt);if(M=arguments,C=this,Y=tt,Ze){if(F===void 0)return Oe(Y);if(fe)return F=setTimeout(jt,d),Ce(Y)}return F===void 0&&(F=setTimeout(jt,d)),B}return Le.cancel=Et,Le.flush=je,Le}function vae(c,d,g){var M=!0,C=!0;if(typeof c!="function")throw new TypeError(iL);return Vx(g)&&(M="leading"in g?!!g.leading:M,C="trailing"in g?!!g.trailing:C),gae(c,d,{leading:M,maxWait:d,trailing:C})}function Vx(c){var d=typeof c;return!!c&&(d=="object"||d=="function")}function yae(c){return!!c&&typeof c=="object"}function bae(c){return typeof c=="symbol"||yae(c)&&fae.call(c)==nae}function rL(c){if(typeof c=="number")return c;if(bae(c))return nL;if(Vx(c)){var d=typeof c.valueOf=="function"?c.valueOf():c;c=Vx(d)?d+"":d}if(typeof c!="string")return c===0?c:+c;c=c.replace(rae,"");var g=oae.test(c);return g||aae.test(c)?lae(c.slice(2),g?2:8):sae.test(c)?nL:+c}var Fx=vae;const xae={name:"Grid",provide(){return{GridInstance:this}},props:{col:{type:Number,default:3},square:{type:Boolean,default:!1},padding:{type:String,default:"24px"},center:{type:Boolean,default:!1},border:{type:Boolean,default:!0},hover:{type:Boolean,default:!1}},data(){return{resizeCount:0,handleResize:()=>{}}},computed:{classes(){return{"ivu-grid-center":this.center,"ivu-grid-border":this.border,"ivu-grid-hover":this.hover}}},methods:{onResize(){this.resizeCount++}},mounted(){this.handleResize=Fx(this.onResize,150,{leading:!1}),this.observer=Wp(),this.observer.listenTo(this.$refs.grid,this.handleResize)},beforeUnmount(){this.observer.removeListener(this.$refs.grid,this.handleResize)}};function wae(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["ivu-grid",b.classes]),ref:"grid"},[i.renderSlot(c.$slots,"default")],2)}var sL=l(xae,[["render",wae]]);const _ae={name:"GridItem",inject:["GridInstance"],data(){return{height:0}},computed:{col(){return this.GridInstance.col},square(){return this.GridInstance.square},styles(){const c={width:`${100/this.col}%`};return this.height&&this.square&&(c.height=`${this.height}px`),c},mainStyles(){return{padding:this.GridInstance.padding}}},watch:{col(){i.nextTick(()=>{this.handleChangeHeight()})},square(){this.handleChangeHeight()},"GridInstance.resizeCount"(){this.handleChangeHeight()}},methods:{handleChangeHeight(){if(this.square){const c=this.$refs.col;this.height=parseFloat(R(c,"width"))}}},mounted(){this.handleChangeHeight()}};function Oae(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:"ivu-grid-item",style:i.normalizeStyle(b.styles),ref:"col"},[i.createElementVNode("div",{class:"ivu-grid-item-main",style:i.normalizeStyle(b.mainStyles)},[i.renderSlot(c.$slots,"default")],4)],4)}var oL=l(_ae,[["render",Oae]]);const Sae="ivu-layout",Cae={name:"Header",computed:{wrapClasses(){return`${Sae}-header`}}};function Tae(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses)},[i.renderSlot(c.$slots,"default")],2)}var KT=l(Cae,[["render",Tae]]);const Kt={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent(c){const{keyCode:d}=c;if(c.altKey&&!c.ctrlKey||c.metaKey||d>=Kt.F1&&d<=Kt.F12)return!1;switch(d){case Kt.ALT:case Kt.CAPS_LOCK:case Kt.CONTEXT_MENU:case Kt.CTRL:case Kt.DOWN:case Kt.END:case Kt.ESC:case Kt.HOME:case Kt.INSERT:case Kt.LEFT:case Kt.MAC_FF_META:case Kt.META:case Kt.NUMLOCK:case Kt.NUM_CENTER:case Kt.PAGE_DOWN:case Kt.PAGE_UP:case Kt.PAUSE:case Kt.PRINT_SCREEN:case Kt.RIGHT:case Kt.SHIFT:case Kt.UP:case Kt.WIN_KEY:case Kt.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey(c){if(c>=Kt.ZERO&&c<=Kt.NINE||c>=Kt.NUM_ZERO&&c<=Kt.NUM_MULTIPLY||c>=Kt.A&&c<=Kt.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&c===0)return!0;switch(c){case Kt.SPACE:case Kt.QUESTION_MARK:case Kt.NUM_PLUS:case Kt.NUM_MINUS:case Kt.NUM_PERIOD:case Kt.NUM_DIVISION:case Kt.SEMICOLON:case Kt.DASH:case Kt.EQUALS:case Kt.COMMA:case Kt.PERIOD:case Kt.SLASH:case Kt.APOSTROPHE:case Kt.SINGLE_QUOTE:case Kt.OPEN_SQUARE_BRACKET:case Kt.BACKSLASH:case Kt.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Wh="ivu-spin",Eae={name:"Spin",mixins:[HT],props:{size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},fix:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},data(){return{showText:!1,visible:!1}},computed:{classes(){return[`${Wh}`,{[`${Wh}-${this.size}`]:!!this.size,[`${Wh}-fix`]:this.fix,[`${Wh}-show-text`]:this.showText,[`${Wh}-fullscreen`]:this.fullscreen}]},mainClasses(){return`${Wh}-main`},dotClasses(){return`${Wh}-dot`},textClasses(){return`${Wh}-text`},fullscreenVisible(){return this.fullscreen?this.visible:!0}},watch:{visible(c){c?this.addScrollEffect():this.removeScrollEffect()}},mounted(){this.showText=!!this.$slots.default&&this.$slots.default().some(c=>c.children&&c.children.length)}};function Mae(c,d,g,M,C,b){return i.openBlock(),i.createBlock(i.Transition,{name:"fade"},{default:i.withCtx(()=>[b.fullscreenVisible&&g.show?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.classes)},[i.createElementVNode("div",{class:i.normalizeClass(b.mainClasses)},[i.createElementVNode("span",{class:i.normalizeClass(b.dotClasses)},null,2),i.createElementVNode("div",{class:i.normalizeClass(b.textClasses)},[i.renderSlot(c.$slots,"default")],2)],2)],2)):i.createCommentVNode("",!0)]),_:3})}var Bo=l(Eae,[["render",Mae]]);const Aae={name:"ImagePreview",mixins:[gn],components:{Icon:S,Spin:Bo,Row:$h,Col:Ml},inheritAttrs:!1,emits:["update:modelValue","on-close","on-switch"],props:{modelValue:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},maskClosable:{type:Boolean,default:!0},previewList:{type:Array,default(){return[]}},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},toolbar:{type:Array,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||!c.$VIEWUI.image||c.$VIEWUI.image.toolbar===""?["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"]:c.$VIEWUI.image.toolbar}}},data(){return{currentIndex:0,scale:1,degree:0,translate:{x:0,y:0},startX:0,startY:0,transition:!0,original:!1,prevOverflow:"",status:"loading",zIndex:1e3,maskIndex:this.getMaskIndex(),downloading:!1}},computed:{imgClasses(){return["ivu-image-preview-image",{"ivu-image-preview-grabbing":!this.transition,"ivu-image-preview-hidden":this.status==="failed","ivu-image-preview-transition":this.transition,"ivu-image-preview-limit":!this.original}]},imageStyle(){let c=this.translate.x/this.scale,d=this.translate.y/this.scale;const g=this.degree%360;return[90,-270].includes(g)&&([c,d]=[d,-c]),[180,-180].includes(g)&&([c,d]=[-c,-d]),[270,-90].includes(g)&&([c,d]=[-d,c]),{transform:`
                        scale(${this.scale})
                        rotate(${this.degree}deg)
                        translate(${c}px, ${d}px)
                    `}},maskStyle(){return{zIndex:this.maskIndex+this.zIndex}},leftClasses(){return["ivu-image-preview-arrow-left",{"ivu-image-preview-arrow-disabled":this.hasLeftSwitchEnd}]},rightClasses(){return["ivu-image-preview-arrow-right",{"ivu-image-preview-arrow-disabled":this.hasRightSwitchEnd}]},hasRightSwitchEnd(){const{currentIndex:c,infinite:d,previewList:g}=this,M=g.length;return d?!1:c>=M-1},hasLeftSwitchEnd(){const{currentIndex:c,infinite:d}=this;return d?!1:c===0},currentSrc(){return this.previewList[this.currentIndex]},failLang(){return this.t("i.image.fail")}},methods:{resetStyle(){this.scale=1,this.degree=0,this.translate.x=0,this.translate.y=0},handleClose(){this.$emit("update:modelValue",!1),this.$emit("on-close")},handleClickMask(){!this.maskClosable||this.handleClose()},handleSwitch(c){c?this.currentIndex+1===this.previewList.length?this.infinite&&(this.resetStyle(),this.currentIndex=0):(this.resetStyle(),this.currentIndex+=1):this.currentIndex===0?this.infinite&&(this.resetStyle(),this.currentIndex=this.previewList.length-1):(this.resetStyle(),this.currentIndex-=1),this.$emit("on-switch",{currentIndex:this.currentIndex})},handleOperation(c){c==="zoomIn"&&this.scale<6&&(this.scale+=.25),c==="zoomOut"&&this.scale>.25&&(this.scale-=.25),c==="rotateLeft"&&(this.degree-=90),c==="rotateRight"&&(this.degree+=90),c==="original"&&(this.original=!this.original,this.transition=!1,this.resetStyle(),setTimeout(()=>{this.transition=!0},0)),c==="download"&&(this.downloading=!0,ye(this.previewList[this.currentIndex]).then(()=>{this.downloading=!1}).catch(()=>{this.downloading=!1}))},handleKeydown(c){if(!this.modelValue)return;const{keyCode:d}=c;d===Kt.LEFT&&this.handleSwitch(!1),d===Kt.RIGHT&&this.handleSwitch(!0),d===Kt.UP&&this.handleOperation("zoomIn"),d===Kt.DOWN&&this.handleOperation("zoomOut"),d===Kt.SPACE&&(c.preventDefault(),this.original=!this.original)},handleKeyup(c){if(!this.modelValue)return;const{keyCode:d}=c;d===Kt.ESC&&this.handleClose()},handleWheel(c){if(!this.modelValue)return;const{deltaY:d}=c;this.handleOperation(d<0?"zoomIn":"zoomOut")},handleMousedown(c){const{pageX:d,pageY:g,which:M}=c;M===1&&(this.startX=d,this.startY=g,this.transition=!1,o(document,"mousemove",this.handleMousemove),o(document,"mouseup",this.handleMouseup))},handleMousemove:Fx(function(c){c.stopPropagation();const{pageX:d,pageY:g}=c;this.translate.x+=d-this.startX,this.translate.y+=g-this.startY,this.startX=d,this.startY=g}),handleMouseup(){this.transition=!0,a(document,"mousemove",this.handleMousemove),a(document,"mouseup",this.handleMouseup)},getBodyOverflow(){return s?document.body.style.overflow:""},setBodyOverflow(c){!s||(document.body.style.overflow=c)},handleImageLoad(){this.status="loaded"},handleImageError(){this.status="failed"},getMaskIndex(){return He(),Te}},watch:{modelValue(c){c?(this.currentIndex=this.initialIndex,this.resetStyle(),this.original=!1,this.prevOverflow=this.getBodyOverflow(),this.setBodyOverflow("hidden"),this.maskIndex=this.getMaskIndex()):this.setBodyOverflow(this.prevOverflow)},currentIndex(){this.status="loading"}},mounted(){o(document,"keydown",this.handleKeydown),o(document,"keyup",this.handleKeyup),o(document,"wheel",this.handleWheel)},beforeUnmount(){a(document,"keydown",this.handleKeydown),a(document,"keyup",this.handleKeyup),a(document,"wheel",this.handleWheel)}},kae={key:1,class:"ivu-image-preview-fail"},Pae=["src"],Rae=[i.createElementVNode("path",{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z","p-id":"7198",fill:"#ffffff"},null,-1),i.createElementVNode("path",{d:"M921 867L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z","p-id":"7199",fill:"#ffffff"},null,-1)],Iae=[i.createElementVNode("path",{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z","p-id":"7413",fill:"#ffffff"},null,-1),i.createElementVNode("path",{d:"M921 867L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z","p-id":"7414",fill:"#ffffff"},null,-1)],Nae=[i.createElementVNode("path",{d:"M358.058667 128H156.970667A28.970667 28.970667 0 0 0 128 157.013333v202.837334c0 7.978667 6.528 14.506667 14.506667 14.506666h43.434666a14.506667 14.506667 0 0 0 14.506667-14.506666V200.448h157.610667a14.506667 14.506667 0 0 0 14.506666-14.506667V142.506667a14.506667 14.506667 0 0 0-14.506666-14.506667zM881.493333 649.642667h-43.434666a14.506667 14.506667 0 0 0-14.506667 14.506666v159.402667h-157.610667a14.506667 14.506667 0 0 0-14.506666 14.506667v43.434666c0 7.978667 6.570667 14.506667 14.506666 14.506667h201.088c16 0 28.970667-12.928 28.970667-29.013333v-202.837334a14.506667 14.506667 0 0 0-14.506667-14.506666zM358.058667 823.552H200.448v-159.402667a14.506667 14.506667 0 0 0-14.506667-14.506666H142.506667a14.506667 14.506667 0 0 0-14.506667 14.506666v202.88c0 16 12.970667 28.970667 29.013333 28.970667h201.045334a14.506667 14.506667 0 0 0 14.506666-14.506667v-43.434666a14.506667 14.506667 0 0 0-14.506666-14.506667zM866.986667 128h-201.088a14.506667 14.506667 0 0 0-14.506667 14.506667v43.434666c0 7.978667 6.570667 14.506667 14.506667 14.506667h157.610666v159.402667c0 7.978667 6.528 14.506667 14.506667 14.506666h43.434667a14.506667 14.506667 0 0 0 14.506666-14.506666V156.970667A28.928 28.928 0 0 0 866.986667 128z","p-id":"26673",fill:"#ffffff"},null,-1)],Dae=[i.createElementVNode("path",{d:"M864 128H160c-19.2 0-32 12.8-32 32v704c0 19.2 12.8 32 32 32h704c19.2 0 32-12.8 32-32V160c0-19.2-12.8-32-32-32z m-32 704H192V192h640v640z","p-id":"1977",fill:"#ffffff"},null,-1),i.createElementVNode("path",{d:"M320 384v288c0 19.2 12.8 32 32 32s32-12.8 32-32V352c0-19.2-12.8-32-32-32h-32c-19.2 0-32 12.8-32 32s12.8 32 32 32zM640 384v288c0 19.2 12.8 32 32 32s32-12.8 32-32V352c0-19.2-12.8-32-32-32h-32c-19.2 0-32 12.8-32 32s12.8 32 32 32z","p-id":"1978",fill:"#ffffff"},null,-1),i.createElementVNode("path",{d:"M512 384m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z","p-id":"1979",fill:"#ffffff"},null,-1),i.createElementVNode("path",{d:"M512 640m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z","p-id":"1980",fill:"#ffffff"},null,-1)],Lae=[i.createElementVNode("path",{d:"M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32z m-44 402H188V494h440v326z m191.3-491.5c-78.8-100.7-196-153.6-314.6-154.2l-0.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7 0.4 12.6-6.1v-63.9c12.9 0.1 25.9 0.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8 11 40.7 14 82.7 8.9 124.8-0.7 5.4-1.4 10.8-2.4 16.1h74.9c14.8-103.6-11.3-213-81-302.3z","p-id":"13309",fill:"#ffffff"},null,-1)],Bae=[i.createElementVNode("path",{d:"M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-0.4-12.6 6.1l-0.2 64c-118.6 0.5-235.8 53.4-314.6 154.2-69.6 89.2-95.7 198.6-81.1 302.4h74.9c-0.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8zM880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32z m-44 402H396V494h440v326z","p-id":"13522",fill:"#ffffff"},null,-1)],$ae=[i.createElementVNode("path",{d:"M505.7 621c3.2 4.1 9.4 4.1 12.6 0l112-141.7c4.1-5.2 0.4-12.9-6.3-12.9h-72.1V120c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v346.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z","p-id":"8826",fill:"#ffffff"},null,-1),i.createElementVNode("path",{d:"M903 516h-64c-4.4 0-8 3.6-8 8v300c0 4.4-3.6 8-8 8H199c-4.4 0-8-3.6-8-8V524c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v372c0 8.8 7.2 16 16 16h768c8.8 0 16-7.2 16-16V524c0-4.4-3.6-8-8-8z","p-id":"8827",fill:"#ffffff"},null,-1)],Uae={class:"ivu-image-preview-operations-item ivu-image-preview-operations-wait ivu-anim-loop",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7816",width:"200",height:"200"},Vae=[i.createElementVNode("path",{d:"M512 64c247.2 0 448 200.8 448 448h-64c0-212-172-384-384-384V64z m0 832c-212 0-384-172-384-384H64c0 247.2 200.8 448 448 448v-64z","p-id":"7817",fill:"#ffffff"},null,-1)];function Fae(c,d,g,M,C,b){const B=i.resolveComponent("Spin"),F=i.resolveComponent("Col"),Y=i.resolveComponent("Row"),G=i.resolveComponent("Icon");return i.openBlock(),i.createBlock(i.Teleport,{to:"body",disabled:!g.transfer},[i.createVNode(i.Transition,{name:"fade"},{default:i.withCtx(()=>[g.modelValue?(i.openBlock(),i.createElementBlock("div",{key:0,class:"ivu-image-preview-mask",style:i.normalizeStyle(b.maskStyle)},null,4)):i.createCommentVNode("",!0)]),_:1}),i.createVNode(i.Transition,{name:"fade"},{default:i.withCtx(()=>[g.modelValue?(i.openBlock(),i.createElementBlock("div",{key:0,class:"ivu-image-preview-wrap",style:i.normalizeStyle(b.maskStyle)},[i.createElementVNode("div",i.mergeProps({class:"ivu-image-preview"},c.$attrs,{onClick:d[14]||(d[14]=i.withModifiers((...K)=>b.handleClickMask&&b.handleClickMask(...K),["stop"]))}),[C.status==="loading"?(i.openBlock(),i.createBlock(B,{key:0,size:"large",class:"ivu-image-preview-loading"})):C.status==="failed"?(i.openBlock(),i.createElementBlock("div",kae,[i.createElementVNode("span",null,i.toDisplayString(b.failLang),1)])):i.createCommentVNode("",!0),(i.openBlock(),i.createElementBlock("img",{class:i.normalizeClass(b.imgClasses),style:i.normalizeStyle(b.imageStyle),src:b.currentSrc,key:C.currentIndex.toString(),onClick:d[0]||(d[0]=i.withModifiers(()=>{},["stop"])),onMousedown:d[1]||(d[1]=i.withModifiers((...K)=>b.handleMousedown&&b.handleMousedown(...K),["stop","prevent"])),onLoad:d[2]||(d[2]=(...K)=>b.handleImageLoad&&b.handleImageLoad(...K)),onError:d[3]||(d[3]=(...K)=>b.handleImageError&&b.handleImageError(...K))},null,46,Pae)),g.toolbar&&g.toolbar.length>0?(i.openBlock(),i.createBlock(Y,{key:2,"class-name":"ivu-image-preview-operations",wrap:!1,onClick:d[11]||(d[11]=i.withModifiers(()=>{},["stop"]))},{default:i.withCtx(()=>[g.toolbar.indexOf("zoomIn")>-1?(i.openBlock(),i.createBlock(F,{key:0,flex:"1",order:g.toolbar.indexOf("zoomIn")+1},{default:i.withCtx(()=>[(i.openBlock(),i.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:d[4]||(d[4]=i.withModifiers(K=>b.handleOperation("zoomIn"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7197",width:"200",height:"200"},Rae))]),_:1},8,["order"])):i.createCommentVNode("",!0),g.toolbar.indexOf("zoomOut")>-1?(i.openBlock(),i.createBlock(F,{key:1,flex:"1",order:g.toolbar.indexOf("zoomOut")+1},{default:i.withCtx(()=>[(i.openBlock(),i.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:d[5]||(d[5]=i.withModifiers(K=>b.handleOperation("zoomOut"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7412",width:"200",height:"200"},Iae))]),_:1},8,["order"])):i.createCommentVNode("",!0),g.toolbar.indexOf("original")>-1?(i.openBlock(),i.createBlock(F,{key:2,flex:"1",order:g.toolbar.indexOf("original")+1},{default:i.withCtx(()=>[i.withDirectives((i.openBlock(),i.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:d[6]||(d[6]=i.withModifiers(K=>b.handleOperation("original"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"26672",width:"200",height:"200"},Nae,512)),[[i.vShow,!this.original]]),i.withDirectives((i.openBlock(),i.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:d[7]||(d[7]=i.withModifiers(K=>b.handleOperation("original"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1976",width:"200",height:"200"},Dae,512)),[[i.vShow,this.original]])]),_:1},8,["order"])):i.createCommentVNode("",!0),g.toolbar.indexOf("rotateLeft")>-1?(i.openBlock(),i.createBlock(F,{key:3,flex:"1",order:g.toolbar.indexOf("rotateLeft")+1},{default:i.withCtx(()=>[(i.openBlock(),i.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:d[8]||(d[8]=i.withModifiers(K=>b.handleOperation("rotateLeft"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13308",width:"200",height:"200"},Lae))]),_:1},8,["order"])):i.createCommentVNode("",!0),g.toolbar.indexOf("rotateRight")>-1?(i.openBlock(),i.createBlock(F,{key:4,flex:"1",order:g.toolbar.indexOf("rotateRight")+1},{default:i.withCtx(()=>[(i.openBlock(),i.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:d[9]||(d[9]=i.withModifiers(K=>b.handleOperation("rotateRight"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13521",width:"200",height:"200"},Bae))]),_:1},8,["order"])):i.createCommentVNode("",!0),g.toolbar.indexOf("download")>-1?(i.openBlock(),i.createBlock(F,{key:5,flex:"1",order:g.toolbar.indexOf("download")+1},{default:i.withCtx(()=>[i.withDirectives((i.openBlock(),i.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:d[10]||(d[10]=i.withModifiers(K=>b.handleOperation("download"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8825",width:"200",height:"200"},$ae,512)),[[i.vShow,!C.downloading]]),i.withDirectives((i.openBlock(),i.createElementBlock("svg",Uae,Vae,512)),[[i.vShow,C.downloading]])]),_:1},8,["order"])):i.createCommentVNode("",!0)]),_:1})):i.createCommentVNode("",!0),g.previewList.length>1?(i.openBlock(),i.createBlock(G,{key:3,class:i.normalizeClass(b.leftClasses),type:"ios-arrow-back",onClick:d[12]||(d[12]=i.withModifiers(K=>b.handleSwitch(!1),["stop"]))},null,8,["class"])):i.createCommentVNode("",!0),g.previewList.length>1?(i.openBlock(),i.createBlock(G,{key:4,class:i.normalizeClass(b.rightClasses),type:"ios-arrow-forward",onClick:d[13]||(d[13]=i.withModifiers(K=>b.handleSwitch(!0),["stop"]))},null,8,["class"])):i.createCommentVNode("",!0),i.createVNode(G,{class:"ivu-image-preview-arrow-close",type:"md-close",onClick:i.withModifiers(b.handleClose,["stop"])},null,8,["onClick"])],16)],4)):i.createCommentVNode("",!0)]),_:1})],8,["disabled"])}var Gh=l(Aae,[["render",Fae]]);const zae=c=>typeof HTMLElement=="object"&&c instanceof HTMLElement,Xae={name:"Image",mixins:[gn],components:{ImagePreview:Gh},emits:["on-load","on-error","on-switch","on-close","on-click"],props:{src:{type:String,default:""},alt:{type:String,default:""},preview:{type:Boolean,default:!1},referrerPolicy:{type:String,default:""},width:{type:[String,Number],default:""},height:{type:[String,Number],default:""},fit:{type:String,default:""},lazy:{type:Boolean,default:!1},scrollContainer:{type:[String],default:""},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},maskClosable:{type:Boolean,default:!0},previewList:{type:Array},infinite:{type:Boolean,default:!0},initialIndex:{type:Number,default:0},previewTip:{type:Boolean,default:!0},toolbar:{type:Array,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||!c.$VIEWUI.image||c.$VIEWUI.image.toolbar===""?["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"]:c.$VIEWUI.image.toolbar}}},data(){return{loadingImage:!1,loading:!1,imageError:!1,scrollElement:null,observer:null,imagePreviewModal:!1}},watch:{src(){this.loadImage()}},computed:{innerClasses(){return["ivu-image-inner",{"ivu-image-cursor":this.preview}]},imgClasses(){return["ivu-image-img",{"ivu-image-img-hidden":this.loading||this.imageError}]},fitStyle(){const c=["fill","contain","cover","none","scale-down"],{fit:d}=this;return c.includes(d)?`object-fit:${d};`:""},imageStyles(){return{width:typeof this.width=="number"?`${this.width}px`:this.width,height:typeof this.height=="number"?`${this.height}px`:this.height}},loadingLang(){return this.t("i.select.loading")},failLang(){return this.t("i.image.fail")},previewLang(){return this.t("i.image.preview")},loadingType(){return this.lazy?"lazy":"eager"}},mounted(){s&&this.handleImageEvent()},methods:{handleLazy(){const c=this.$refs.image;(this.observer=new IntersectionObserver(this.handlerObserveImage,{root:this.scrollElement,rootMargin:"0px",threshold:0})).observe(c)},handlerObserveImage(c){for(let d of c)d.isIntersecting&&(this.offObserver(),this.loadImage())},addLazyImageListener(){const{scrollContainer:c}=this;this.scrollElement=null,zae(c)?this.scrollElement=c:c&&typeof c=="string"&&(this.scrollElement=document.querySelector(c)),this.handleLazy()},handleImageLoad(){this.loading=!1,this.imageError=!1,this.$emit("on-load")},handleImageError(){this.loading=!1,this.imageError=!0,this.loadingImage=!1,this.$emit("on-error")},loadImage(){this.loading=!0,this.imageError=!1,this.loadingImage=!0},handleImageEvent(){const{lazy:c}=this;c?this.addLazyImageListener():this.loadImage()},offObserver(){const{observer:c}=this;c&&c.disconnect()},handlePreview(){const{preview:c,initialIndex:d}=this;c&&(this.imagePreviewModal=!0,this.$emit("on-click",{initialIndex:d}))},handleClose(){this.$emit("on-close")},handleSwitch(c){this.$emit("on-switch",c)}},beforeUnmount(){this.offObserver()}},Wae={key:0,class:"ivu-image-placeholder"},Gae={key:1,class:"ivu-image-error"},Hae=["alt","src","loading","referrerPolicy"],Qae={class:"ivu-image-mark"};function jae(c,d,g,M,C,b){const B=i.resolveComponent("ImagePreview");return i.openBlock(),i.createElementBlock("div",{class:"ivu-image",ref:"image",style:i.normalizeStyle(b.imageStyles)},[C.loading?(i.openBlock(),i.createElementBlock("div",Wae,[i.renderSlot(c.$slots,"placeholder",{},()=>[i.createElementVNode("span",null,i.toDisplayString(b.loadingLang),1)])])):C.imageError?(i.openBlock(),i.createElementBlock("div",Gae,[i.renderSlot(c.$slots,"error",{},()=>[i.createElementVNode("span",null,i.toDisplayString(b.failLang),1)])])):i.createCommentVNode("",!0),C.loadingImage?(i.openBlock(),i.createElementBlock("div",{key:2,class:i.normalizeClass(b.innerClasses),onClick:d[2]||(d[2]=(...F)=>b.handlePreview&&b.handlePreview(...F))},[i.createElementVNode("img",{class:i.normalizeClass(b.imgClasses),style:i.normalizeStyle([b.fitStyle]),alt:g.alt,src:g.src,loading:b.loadingType,referrerPolicy:g.referrerPolicy,onLoad:d[0]||(d[0]=(...F)=>b.handleImageLoad&&b.handleImageLoad(...F)),onError:d[1]||(d[1]=(...F)=>b.handleImageError&&b.handleImageError(...F))},null,46,Hae),g.preview&&g.previewTip?i.renderSlot(c.$slots,"preview",{key:0},()=>[i.createElementVNode("div",Qae,[i.createElementVNode("span",null,i.toDisplayString(b.previewLang),1)])]):i.createCommentVNode("",!0)],2)):i.createCommentVNode("",!0),g.preview?(i.openBlock(),i.createBlock(B,{key:3,modelValue:C.imagePreviewModal,"onUpdate:modelValue":d[3]||(d[3]=F=>C.imagePreviewModal=F),"preview-list":g.previewList,"initial-index":g.initialIndex,infinite:g.infinite,"mask-closable":g.maskClosable,transfer:g.transfer,toolbar:g.toolbar,onOnClose:b.handleClose,onOnSwitch:b.handleSwitch},null,8,["modelValue","preview-list","initial-index","infinite","mask-closable","transfer","toolbar","onOnClose","onOnSwitch"])):i.createCommentVNode("",!0)],4)}var aL=l(Xae,[["render",jae]]);Gh.newInstance=c=>{if(!s)return;const d=c||{};let g=null;const M=i.createApp({data(){return Object.assign({},d,{visible:!1,previewList:[],initialIndex:0,toolbar:["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"],infinite:!0,maskClosable:!0,transfer:!0})},render(){return i.h(Gh,Object.assign({},d,{ref:"imagePreview",modelValue:this.visible,previewList:this.previewList,initialIndex:this.initialIndex,toolbar:this.toolbar,infinite:this.infinite,maskClosable:this.maskClosable,transfer:this.transfer,"onOn-close":this.close}))},methods:{close(){this.visible=!1,setTimeout(()=>{this.destroy(),this.onRemove()},300)},destroy(){M.unmount(),document.body.removeChild(C)},onRemove(){}},created(){g=i.getCurrentInstance()}}),C=document.createElement("div");document.body.appendChild(C),M.mount(C);const b=g.refs.imagePreview;return{show(B){Object.keys(B).forEach(F=>{b.$parent[F]=B[F]}),b.$parent.visible=!0},component:b}};let zx;function Yae(){return zx=zx||Gh.newInstance(),zx}Gh.show=function(c={}){const d=Yae();c.onRemove=function(){zx=null},d.show(c)};const Os="ivu-input-number",Xx="ivu-icon";function Wx(c,d){let g,M,C;try{g=c.toString().split(".")[1].length}catch{g=0}try{M=d.toString().split(".")[1].length}catch{M=0}return C=Math.pow(10,Math.max(g,M)),(Math.round(c*C)+Math.round(d*C))/C}const qae={name:"InputNumber",mixins:[Ei],emits:["on-change","on-focus","on-blur","update:modelValue"],props:{max:{type:Number,default:1/0},min:{type:Number,default:-1/0},step:{type:Number,default:1},activeChange:{type:Boolean,default:!0},modelValue:{type:Number,default:1},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},name:{type:String},precision:{type:Number},elementId:{type:String},formatter:{type:Function},parser:{type:Function},placeholder:{type:String,default:""},controlsOutside:{type:Boolean,default:!1}},data(){return{focused:!1,upDisabled:!1,downDisabled:!1,currentValue:this.modelValue}},computed:{wrapClasses(){return[`${Os}`,{[`${Os}-${this.size}`]:!!this.size,[`${Os}-disabled`]:this.itemDisabled,[`${Os}-focused`]:this.focused,[`${Os}-controls-outside`]:this.controlsOutside}]},handlerClasses(){return`${Os}-handler-wrap`},upClasses(){return[`${Os}-handler`,`${Os}-handler-up`,{[`${Os}-handler-up-disabled`]:this.upDisabled}]},innerUpClasses(){return`${Os}-handler-up-inner ${Xx} ${Xx}-ios-arrow-up`},downClasses(){return[`${Os}-handler`,`${Os}-handler-down`,{[`${Os}-handler-down-disabled`]:this.downDisabled}]},innerDownClasses(){return`${Os}-handler-down-inner ${Xx} ${Xx}-ios-arrow-down`},inputWrapClasses(){return`${Os}-input-wrap`},inputClasses(){return`${Os}-input`},precisionValue(){return this.currentValue?this.precision?this.currentValue.toFixed(this.precision):this.currentValue:this.currentValue},formatterValue(){return this.formatter&&this.precisionValue!==null?this.formatter(this.precisionValue):this.precisionValue}},methods:{preventDefault(c){c.preventDefault()},up(c){const d=Number(c.target.value);if(this.upDisabled&&isNaN(d))return!1;this.changeStep("up",c)},down(c){const d=Number(c.target.value);if(this.downDisabled&&isNaN(d))return!1;this.changeStep("down",c)},changeStep(c,d){if(this.itemDisabled||this.readonly)return!1;const g=Number(d.target.value);let M=Number(this.currentValue);const C=Number(this.step);if(isNaN(M))return!1;if(!isNaN(g)){if(c==="up")if(Wx(g,C)<=this.max)M=g;else return!1;else if(c==="down")if(Wx(g,-C)>=this.min)M=g;else return!1}c==="up"?M=Wx(M,C):c==="down"&&(M=Wx(M,-C)),this.setValue(M)},setValue(c){c&&!isNaN(this.precision)&&(c=Number(Number(c).toFixed(this.precision)));const{min:d,max:g}=this;c!==null&&(c>g?c=g:c<d&&(c=d)),i.nextTick(()=>{this.currentValue=c,this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c)})},focus(c){this.focused=!0,this.$emit("on-focus",c)},blur(){this.focused=!1,this.$emit("on-blur"),L(this,["DatePicker","TimePicker","Cascader","Search"])||this.handleFormItemChange("blur",this.currentValue)},keyDown(c){c.keyCode===38?(c.preventDefault(),this.up(c)):c.keyCode===40&&(c.preventDefault(),this.down(c))},change(c){if(c.type==="change"&&this.activeChange||c.type==="input"&&!this.activeChange)return;let d=c.target.value.trim();if(this.parser&&(d=this.parser(d)),d.length===0){this.setValue(null);return}c.type==="input"&&d.match(/^\-?\.?$|\.$/)||(d=Number(d),isNaN(d)?c.target.value=this.currentValue:(this.currentValue=d,this.setValue(d)))},changeVal(c){if(c=Number(c),isNaN(c))this.upDisabled=!0,this.downDisabled=!0;else{const d=this.step;this.upDisabled=c+d>this.max,this.downDisabled=c-d<this.min}}},mounted(){this.changeVal(this.currentValue)},watch:{modelValue(c){this.currentValue=c},currentValue(c){this.changeVal(c)},min(){this.changeVal(this.currentValue)},max(){this.changeVal(this.currentValue)}}},Zae=[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-remove"},null,-1)],Kae=[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-add"},null,-1)],Jae=["id","disabled","autofocus","readonly","name","value","placeholder"];function ele(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses)},[g.controlsOutside?i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.handlerClasses)},[i.createElementVNode("a",{onClick:d[1]||(d[1]=(...B)=>b.up&&b.up(...B)),class:i.normalizeClass(b.upClasses)},[i.createElementVNode("span",{class:i.normalizeClass(b.innerUpClasses),onClick:d[0]||(d[0]=(...B)=>b.preventDefault&&b.preventDefault(...B))},null,2)],2),i.createElementVNode("a",{onClick:d[3]||(d[3]=(...B)=>b.down&&b.down(...B)),class:i.normalizeClass(b.downClasses)},[i.createElementVNode("span",{class:i.normalizeClass(b.innerDownClasses),onClick:d[2]||(d[2]=(...B)=>b.preventDefault&&b.preventDefault(...B))},null,2)],2)],2)),g.controlsOutside?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass(["ivu-input-number-controls-outside-btn ivu-input-number-controls-outside-down",{"ivu-input-number-controls-outside-btn-disabled":C.downDisabled}]),onClick:d[4]||(d[4]=(...B)=>b.down&&b.down(...B))},Zae,2)):i.createCommentVNode("",!0),g.controlsOutside?(i.openBlock(),i.createElementBlock("div",{key:2,class:i.normalizeClass(["ivu-input-number-controls-outside-btn ivu-input-number-controls-outside-up",{"ivu-input-number-controls-outside-btn-disabled":C.upDisabled}]),onClick:d[5]||(d[5]=(...B)=>b.up&&b.up(...B))},Kae,2)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass(b.inputWrapClasses)},[i.createElementVNode("input",{id:g.elementId,class:i.normalizeClass(b.inputClasses),disabled:c.itemDisabled,autocomplete:"off",spellcheck:"false",autofocus:g.autofocus,onFocus:d[6]||(d[6]=(...B)=>b.focus&&b.focus(...B)),onBlur:d[7]||(d[7]=(...B)=>b.blur&&b.blur(...B)),onKeydown:d[8]||(d[8]=i.withModifiers((...B)=>b.keyDown&&b.keyDown(...B),["stop"])),onInput:d[9]||(d[9]=(...B)=>b.change&&b.change(...B)),onMouseup:d[10]||(d[10]=(...B)=>b.preventDefault&&b.preventDefault(...B)),onChange:d[11]||(d[11]=(...B)=>b.change&&b.change(...B)),readonly:g.readonly||!g.editable,name:g.name,value:b.formatterValue,placeholder:g.placeholder},null,42,Jae)],2)],2)}var JT=l(qae,[["render",ele]]);const lL="ivu-layout",tle={name:"Layout",data(){return{hasSider:!1}},computed:{wrapClasses(){return[`${lL}`,{[`${lL}-has-sider`]:this.hasSider}]}},methods:{findSider(){return this.$slots.default().some(c=>c.type.name==="Sider")}},mounted(){this.hasSider=this.findSider()}};function ile(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses)},[i.renderSlot(c.$slots,"default")],2)}var cL=l(tle,[["render",ile]]);const hL={tooltips:["复制","复制成功"],showTip:!1,successTip:"复制成功",errorTip:"复制失败"},uL={tooltip:"编辑",editing:!1,maxlength:"",autosize:!0,triggerType:"icon"},dL={rows:1,tooltip:!1,suffix:!1,expandable:!1,symbol:"展开"};var G0={emits:["update:modelValue"],mixins:[pe],props:{type:{validator(c){return O(c,["secondary","success","warning","danger",""])},default:""},copyable:{type:Boolean,default:!1},copyText:{type:String,default:""},copyConfig:{type:Object,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.typography.copyConfig===""?hL:c.$VIEWUI.typography.copyConfig}},editable:{type:Boolean,default:!1},editConfig:{type:Object,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.typography.editConfig===""?uL:c.$VIEWUI.typography.editConfig}},ellipsis:{type:Boolean,default:!1},ellipsisConfig:{type:Object,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.typography.ellipsisConfig===""?dL:c.$VIEWUI.typography.ellipsisConfig}},disabled:{type:Boolean,default:!1},code:{type:Boolean,default:!1},delete:{type:Boolean,default:!1},keyboard:{type:Boolean,default:!1},mark:{type:Boolean,default:!1},strong:{type:Boolean,default:!1},underline:{type:Boolean,default:!1},italic:{type:Boolean,default:!1},modelValue:{type:String,default:""},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},theme:{validator(c){return O(c,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number],default:250},placement:{validator(c){return O(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"top"}},computed:{isHrefPattern(){const{to:c}=this;return!!c},linkProps(){if(this.isHrefPattern){const{linkUrl:c,target:d}=this;return{href:c,target:d}}else return{}},mergedCopyConfig(){return Object.assign({},hL,this.copyConfig)},mergedEditConfig(){return Object.assign({},uL,this.editConfig)},mergedEllipsisConfig(){return Object.assign({},dL,this.ellipsisConfig)}},methods:{commonSlots(){const c={};return this.$slots.default&&(c.default=()=>this.$slots.default()),this.$slots.copyIcon&&(c.copyIcon=d=>this.$slots.copyIcon(d)),this.$slots.editIcon&&(c.editIcon=d=>this.$slots.editIcon(d)),this.$slots.enterIcon&&(c.enterIcon=d=>this.$slots.enterIcon(d)),c},commonEvents(){return{"onUpdate:modelValue":this.handleOnUpdateModelValue}},handleOnUpdateModelValue(c){this.$emit("update:modelValue",c)}}};const Gx={name:"TypographyBase",mixins:[G0],emits:["on-copy-success","on-copy-error","on-edit-start","on-edit-end","on-edit-change","on-edit-cancel"],props:{component:{type:String,default:"div"},level:{type:Number,default:0}},data(){return{currentContent:this.modelValue,copied:!1,copyTimeout:null,editing:!1,editContent:"",lastKeyCode:"",isEditESC:!1,ellipsisText:"",ellipsisContent:"",isEllipsis:!1,ellipsisExpanded:!1,observer:null}},created(){this.editing=this.mergedEditConfig.editing||!1,this.editing&&(this.editContent=this.currentContent?this.currentContent:this.handleGetContent())},watch:{modelValue(c){this.currentContent=c},editing(c){c||i.nextTick(()=>{this.handleRemoveObserver(),this.handleCreateObserver()})},isEllipsis(){i.nextTick(()=>{this.handleRemoveObserver(),this.handleCreateObserver()})},ellipsis:{handler(c){c?i.nextTick(()=>{this.handleUpdateEllipsisStatus(),this.handleCreateObserver()}):this.handleRemoveObserver()},immediate:!0}},computed:{classes(){return["ivu-typography",{[`ivu-typography-${this.type}`]:this.type,"ivu-typography-disabled":this.disabled,"ivu-typography-ellipsis-line-clamp":this.ellipsis&&!this.ellipsisExpanded,"ivu-typography-ellipsis-single-line":this.ellipsis&&!this.ellipsisExpanded&&this.mergedEllipsisConfig.rows===1}]}},methods:{wrapperDecorations(){let c=this.currentContent?this.currentContent:this.$slots.default?this.$slots.default():"";function d(g,M){!g||(c=i.h(M,c))}return d(this.strong,"strong"),d(this.underline,"u"),d(this.delete,"del"),d(this.code,"code"),d(this.mark,"mark"),d(this.keyboard,"kbd"),d(this.italic,"i"),c},handleClickContent(c){if(!this.isHrefPattern&&this.component!=="a"){const d=this.mergedEditConfig.triggerType;this.editable&&(d==="text"||d==="both")&&this.handleEdit()}else{const d=c.ctrlKey||c.metaKey;this.handleCheckClick(c,d)}},handleGetContent(){const c=document.createElement("div");document.body.appendChild(c);let d=null,g=null,M="";const C=this.wrapperDecorations();return d=i.createApp({render(){return i.h("div",{ref:"text",style:{display:"none"}},C)},created(){g=i.getCurrentInstance()}}),d.mount(c),M=g.refs.text.innerText,d.unmount(),document.body.removeChild(c),M},handleCopy(){let c="";this.copyText?c=this.copyText:this.currentContent?c=this.currentContent:this.$slots.default&&(c=this.handleGetContent()),Mx({text:this.copyText?this.copyText:c,showTip:this.mergedCopyConfig.showTip,successTip:this.mergedCopyConfig.successTip,errorTip:this.mergedCopyConfig.errorTip,success:()=>{this.$emit("on-copy-success"),this.copied=!0,this.copyTimeout&&clearTimeout(this.copyTimeout),this.copyTimeout=setTimeout(()=>{this.copied=!1},3e3)},error:()=>{this.$emit("on-copy-error")}})},handleEdit(){this.editContent=this.currentContent?this.currentContent:this.handleGetContent(),i.nextTick(()=>{this.editing=!0,this.$emit("on-edit-start"),i.nextTick(()=>{this.$refs.edit.focus({cursor:"end"})})})},handleEditBlur(){if(this.isEditESC){this.isEditESC=!1;return}this.handleEditSave(),this.$emit("on-edit-end",this.editContent)},handleEditChange(c){const d=c.target.value;this.editContent=d,this.$emit("on-edit-change",d)},handleEditSave(){this.$emit("update:modelValue",this.editContent),this.editing=!1},handleEditKeydown(c){const{keyCode:d}=c;d===Kt.ENTER&&c.preventDefault(),this.lastKeyCode=d},handleEditKeyup(c){const{keyCode:d,ctrlKey:g,altKey:M,metaKey:C,shiftKey:b}=c;this.lastKeyCode===d&&!g&&!M&&!C&&!b&&(d===Kt.ENTER?(this.handleEditSave(),this.$emit("on-edit-end",this.editContent)):d===Kt.ESC&&(this.isEditESC=!0,this.$emit("on-edit-cancel"),this.editing=!1))},handleUpdateEllipsisStatus(){if(this.ellipsis&&!this.ellipsisExpanded){const c=this.$refs.typography;this.isEllipsis=c.scrollHeight>c.clientHeight}else this.isEllipsis=!1},handleCreateObserver(){this.ellipsis&&!this.ellipsisExpanded&&(this.observer=Wp(),this.observer.listenTo(this.$refs.typography,this.handleUpdateEllipsisStatus))},handleRemoveObserver(){this.observer&&(this.observer.removeListener(this.$refs.typography,this.handleUpdateEllipsisStatus),this.observer=null)}},render(){let c=[];const d=this.wrapperDecorations();if(c.push(d),this.editable){const g=this.mergedEditConfig.triggerType;if(g==="icon"||g==="both"){const M=this.$slots.editIcon?this.$slots.editIcon():i.h(S,{type:"md-create"}),C=i.h("div",{class:"ivu-typography-edit",onClick:this.handleEdit},M);if(this.mergedEditConfig.tooltip){const b=i.h(Cc,{content:this.mergedEditConfig.tooltip,placement:"top"},()=>C);c.push(b)}else c.push(C)}}if(this.copyable){const g=this.$slots.copyIcon?this.$slots.copyIcon({copied:this.copied}):i.h(S,{type:this.copied?"md-checkmark":"md-copy"}),M=i.h("div",{class:["ivu-typography-copy",{"ivu-typography-copy-success":this.copied}],onClick:this.handleCopy},g);if(this.mergedCopyConfig.tooltips instanceof Array&&this.mergedCopyConfig.tooltips.length===2){const C=i.h(Cc,{content:this.copied?this.mergedCopyConfig.tooltips[1]:this.mergedCopyConfig.tooltips[0],placement:"top"},()=>M);c.push(C)}else c.push(M)}if(this.editing){const g=i.h(ua,{ref:"edit",modelValue:this.editContent,type:"textarea",autosize:this.mergedEditConfig.autosize,maxlength:this.mergedEditConfig.maxlength,"onOn-blur":this.handleEditBlur,"onOn-keydown":this.handleEditKeydown,"onOn-keyup":this.handleEditKeyup,"onOn-change":this.handleEditChange}),M=this.$slots.enterIcon?this.$slots.enterIcon():i.h(S,{type:"md-return-left"}),C=i.h("span",{class:"ivu-typography-edit-content-confirm"},M);return i.h("div",{class:["ivu-typography","ivu-typography-edit-content",{[`ivu-typography-h${this.level}`]:this.level,"ivu-typography-div":!this.level}]},[g,C])}else{const g={};this.ellipsis&&!this.ellipsisExpanded&&(g["-webkit-line-clamp"]=this.mergedEllipsisConfig.rows);const C=i.h(this.component,{ref:"typography",class:this.classes,...this.linkProps,style:g,onClick:this.handleClickContent},[c,null]);return this.ellipsis&&!this.ellipsisExpanded&&this.isEllipsis&&this.mergedEllipsisConfig.tooltip?i.h(Cc,{content:this.mergedEllipsisConfig.tooltip===!0?this.handleGetContent():this.mergedEllipsisConfig.tooltip,placement:this.placement,transfer:this.transfer,theme:this.theme,maxWidth:this.maxWidth},()=>C):C}},beforeUnmount(){this.handleRemoveObserver()}},fL={name:"Link",mixins:[G0],render(){return i.h(Gx,{...this.$props,component:"a",...this.commonEvents()},this.commonSlots())}};function pL(){return He(),Te}let mL=pL();Bo.newInstance=c=>{if(!s)return;const d=c||{};let g=null;const M=i.createApp({data(){return Object.assign({},d,{})},render(){let B="";return this.render?B=i.h(Bo,{fix:!0,fullscreen:!0,ref:"spin"},[this.render(i.h)]):B=i.h(Bo,{size:"large",fix:!0,fullscreen:!0,ref:"spin"}),i.h("div",{class:"ivu-spin-fullscreen ivu-spin-fullscreen-wrapper",style:{"z-index":2010+mL}},[B])},created(){g=i.getCurrentInstance()}}),C=document.createElement("div");document.body.appendChild(C),M.mount(C);const b=g.refs.spin;return{show(){i.nextTick(()=>{g.refs.spin.visible=!0,mL=pL()})},remove(B){b.visible=!1,setTimeout(function(){M.unmount(),document.body.removeChild(C),B()},500)},component:b}};let H0;function gL(c=void 0){return H0=H0||Bo.newInstance({render:c}),H0}function nle(c){const d="render"in c?c.render:void 0;gL(d).show(c)}Bo.show=function(c={}){return nle(c)},Bo.hide=function(){if(!H0)return!1;gL().remove(()=>{H0=null})};const Q0="ivu-list",rle={name:"List",provide(){return{ListInstance:this}},components:{Spin:Bo},props:{border:{type:Boolean,default:!1},itemLayout:{validator(c){return O(c,["horizontal","vertical"])},default:"horizontal"},header:{type:String,default:""},footer:{type:String,default:""},loading:{type:Boolean,default:!1},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},split:{type:Boolean,default:!0}},data(){return{}},computed:{classes(){return[`${Q0}`,`${Q0}-${this.size}`,`${Q0}-${this.itemLayout}`,{[`${Q0}-bordered`]:this.border,[`${Q0}-split`]:this.split}]}},methods:{}},sle={key:0,class:"ivu-list-header"},ole={class:"ivu-list-container"},ale={class:"ivu-list-items"},lle={key:2,class:"ivu-list-footer"};function cle(c,d,g,M,C,b){const B=i.resolveComponent("Spin");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[g.header||c.$slots.header?(i.openBlock(),i.createElementBlock("div",sle,[i.renderSlot(c.$slots,"header",{},()=>[i.createTextVNode(i.toDisplayString(g.header),1)])])):i.createCommentVNode("",!0),i.createElementVNode("div",ole,[i.createElementVNode("ul",ale,[i.renderSlot(c.$slots,"default")])]),g.loading?(i.openBlock(),i.createBlock(B,{key:1,fix:"",size:"large"},{default:i.withCtx(()=>[i.renderSlot(c.$slots,"spin")]),_:3})):i.createCommentVNode("",!0),g.footer||c.$slots.footer?(i.openBlock(),i.createElementBlock("div",lle,[i.renderSlot(c.$slots,"footer",{},()=>[i.createTextVNode(i.toDisplayString(g.footer),1)])])):i.createCommentVNode("",!0)],2)}var vL=l(rle,[["render",cle]]);const hle={name:"ListItem",inject:["ListInstance"],props:{},computed:{itemLayout(){return this.ListInstance.itemLayout},isItemContainsTextNode(){let c;return this.$slots.default().forEach(d=>{typeof d=="string"&&(c=!0)}),c},isFlexMode(){const c=this.$slots.extra;return this.itemLayout==="vertical"?!!c:!this.isItemContainsTextNode},classes(){return[{"ivu-list-item-no-flex":!this.isFlexMode}]}}},ule={class:"ivu-list-item-main"},dle={key:0,class:"ivu-list-item-action"},fle={class:"ivu-list-item-extra"},ple={key:0,class:"ivu-list-item-action"},mle={class:"ivu-list-item-extra"};function gle(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(["ivu-list-item",b.classes])},[b.itemLayout==="vertical"&&c.$slots.extra?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createElementVNode("div",ule,[i.renderSlot(c.$slots,"default"),c.$slots.action?(i.openBlock(),i.createElementBlock("ul",dle,[i.renderSlot(c.$slots,"action")])):i.createCommentVNode("",!0)]),i.createElementVNode("div",fle,[i.renderSlot(c.$slots,"extra")])],64)):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.renderSlot(c.$slots,"default"),c.$slots.action?(i.openBlock(),i.createElementBlock("ul",ple,[i.renderSlot(c.$slots,"action")])):i.createCommentVNode("",!0),i.createElementVNode("div",mle,[i.renderSlot(c.$slots,"extra")])],64))],2)}var yL=l(hle,[["render",gle]]);const vle={name:"ListItemMeta",components:{Avatar:C0},props:{avatar:{type:String,default:""},title:{type:String,default:""},description:{type:String,default:""}}},yle={class:"ivu-list-item-meta"},ble={key:0,class:"ivu-list-item-meta-avatar"},xle={class:"ivu-list-item-meta-content"},wle={key:0,class:"ivu-list-item-meta-title"},_le={key:1,class:"ivu-list-item-meta-description"};function Ole(c,d,g,M,C,b){const B=i.resolveComponent("Avatar");return i.openBlock(),i.createElementBlock("div",yle,[g.avatar||c.$slots.avatar?(i.openBlock(),i.createElementBlock("div",ble,[i.renderSlot(c.$slots,"avatar",{},()=>[i.createVNode(B,{src:g.avatar},null,8,["src"])])])):i.createCommentVNode("",!0),i.createElementVNode("div",xle,[g.title||c.$slots.title?(i.openBlock(),i.createElementBlock("div",wle,[i.renderSlot(c.$slots,"title",{},()=>[i.createTextVNode(i.toDisplayString(g.title),1)])])):i.createCommentVNode("",!0),g.description||c.$slots.description?(i.openBlock(),i.createElementBlock("div",_le,[i.renderSlot(c.$slots,"description",{},()=>[i.createTextVNode(i.toDisplayString(g.description),1)])])):i.createCommentVNode("",!0)])])}var bL=l(vle,[["render",Ole]]);const Hx="ivu-loading-bar",Sle={name:"LoadingBar",props:{color:{type:String,default:"primary"},failedColor:{type:String,default:"error"},height:{type:Number,default:2}},data(){return{percent:0,status:"success",show:!1}},computed:{classes(){return`${Hx}`},innerClasses(){return[`${Hx}-inner`,{[`${Hx}-inner-color-primary`]:this.color==="primary"&&this.status==="success",[`${Hx}-inner-failed-color-error`]:this.failedColor==="error"&&this.status==="error"}]},outerStyles(){return{height:`${this.height}px`}},styles(){let c={width:`${this.percent}%`,height:`${this.height}px`};return this.color!=="primary"&&this.status==="success"&&(c.backgroundColor=this.color),this.failedColor!=="error"&&this.status==="error"&&(c.backgroundColor=this.failedColor),c}}};function Cle(c,d,g,M,C,b){return i.openBlock(),i.createBlock(i.Transition,{name:"fade"},{default:i.withCtx(()=>[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.outerStyles)},[i.createElementVNode("div",{class:i.normalizeClass(b.innerClasses),style:i.normalizeStyle(b.styles)},null,6)],6),[[i.vShow,C.show]])]),_:1})}var eE=l(Sle,[["render",Cle]]);eE.newInstance=c=>{if(!s)return;const d=c||{};let g=null;const M=i.createApp({data(){return d},render(){return i.h(eE,Object.assign({ref:"loadingBar"},d))},created(){g=i.getCurrentInstance()}}),C=document.createElement("div");document.body.appendChild(C),M.mount(C);const b=g.refs.loadingBar;return{update(B){"percent"in B&&(b.percent=B.percent),B.status&&(b.status=B.status),"show"in B&&(b.show=B.show)},component:b,destroy(){M.unmount(),document.body.removeChild(C)}}};let Qx,xL="primary",wL=800,_L="error",OL=2,j0;function SL(){return Qx=Qx||eE.newInstance({color:xL,failedColor:_L,height:OL}),Qx}function Ld(c){SL().update(c)}function CL(){setTimeout(()=>{Ld({show:!1}),setTimeout(()=>{Ld({percent:0})},200)},wL)}function Y0(){j0&&(clearInterval(j0),j0=null)}var tE={start(){if(j0)return;let c=0;Ld({percent:c,status:"success",show:!0}),j0=setInterval(()=>{c+=Math.floor(Math.random()*3+1),c>95&&Y0(),Ld({percent:c,status:"success",show:!0})},200)},update(c){Y0(),Ld({percent:c,status:"success",show:!0})},finish(){Y0(),Ld({percent:100,status:"success",show:!0}),CL()},error(){Y0(),Ld({percent:100,status:"error",show:!0}),CL()},config(c){c.color&&(xL=c.color),c.duration&&(wL=c.duration),c.failedColor&&(_L=c.failedColor),c.height&&(OL=c.height)},destroy(){Y0();let c=SL();Qx=null,c.destroy()}};const Tle={name:"Login",components:{Form:Ux},emits:["on-submit"],provide(){return{LoginInstance:this}},props:{},data(){return{formValidate:{}}},methods:{handleSubmit(){this.$refs.form.validate(c=>{this.$emit("on-submit",c,JSON.parse(JSON.stringify(this.formValidate)))})},handleValidate(c,d){let g=!0;c.forEach(M=>{this.$refs.form.validateField(M,C=>{C&&(g=!1)})}),d(g)}}},Ele={class:"ivu-login"};function Mle(c,d,g,M,C,b){const B=i.resolveComponent("Form");return i.openBlock(),i.createElementBlock("div",Ele,[i.createVNode(B,{ref:"form",model:C.formValidate,onSubmit:d[0]||(d[0]=i.withModifiers(()=>{},["prevent"]))},{default:i.withCtx(()=>[i.renderSlot(c.$slots,"default")]),_:3},8,["model"])])}var TL=l(Tle,[["render",Mle]]);const iE="ivu-menu",Ale={name:"Menu",emits:["on-select","on-open-change"],provide(){return{MenuInstance:this}},props:{mode:{validator(c){return O(c,["horizontal","vertical"])},default:"vertical"},theme:{validator(c){return O(c,["light","dark","primary"])},default:"light"},activeName:{type:[String,Number]},openNames:{type:Array,default(){return[]}},accordion:{type:Boolean,default:!1},width:{type:String,default:"240px"}},data(){return{currentActiveName:this.activeName,openedNames:[],submenuList:[],menuItemList:[],ready:!1}},computed:{classes(){let c=this.theme;return this.mode==="vertical"&&this.theme==="primary"&&(c="light"),[`${iE}`,`${iE}-${c}`,{[`${iE}-${this.mode}`]:this.mode}]},styles(){let c={};return this.mode==="vertical"&&(c.width=this.width),c}},methods:{updateActiveName(){this.currentActiveName===void 0&&(this.currentActiveName=-1),this.submenuList.map(c=>c.submenu).forEach(c=>{c.handleUpdateActiveName(!1)}),this.menuItemList.map(c=>c.menuitem).forEach(c=>{c.handleUpdateActiveName(this.currentActiveName)})},updateOpenKeys(c){const d=[...this.openedNames].indexOf(c),g=this.submenuList.map(C=>C.submenu);if(this.accordion&&g.forEach(C=>{C.opened=!1}),d>=0){let C=null;g.forEach(b=>{b.name===c&&(C=b,b.opened=!1)}),U(C,"Submenu").forEach(b=>{b.opened=!0}),C.childSubmenuList.map(b=>b.submenu).forEach(b=>{b.opened=!1})}else if(this.accordion){let C=null;g.forEach(b=>{b.name===c&&(C=b,b.opened=!0)}),U(C,"Submenu").forEach(b=>{b.opened=!0})}else this.submenuList.map(C=>C.submenu).forEach(C=>{C.name===c&&(C.opened=!0)});let M=g.filter(C=>C.opened).map(C=>C.name);this.openedNames=[...M],this.$emit("on-open-change",M)},updateOpened(){const c=(this.submenuList||[]).map(d=>d.submenu);c.length&&c.forEach(d=>{this.openedNames.indexOf(d.name)>-1?d.opened=!0:d.opened=!1})},handleEmitSelectEvent(c){this.$emit("on-select",c)},handleMenuItemSelect(c){this.currentActiveName=c,this.$emit("on-select",c)}},mounted(){this.openedNames=[...this.openNames],this.updateOpened(),i.nextTick(()=>{this.updateActiveName(),this.ready=!0})},watch:{openNames(c){this.openedNames=c},activeName(c){this.currentActiveName=c},currentActiveName(){this.updateActiveName()}}};function kle(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("ul",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.styles)},[i.renderSlot(c.$slots,"default")],6)}var nE=l(Ale,[["render",kle]]),rE={inject:{MenuInstance:{default:null},SubmenuInstance:{default:null}},data(){return{menu:this.MenuInstance}},computed:{hasParentSubmenu(){return!!this.SubmenuInstance},parentSubmenuNum(){return U(this,"Submenu").length},mode(){return this.MenuInstance.mode}}};const Ple="ivu-menu",Rle={name:"MenuGroup",mixins:[rE],props:{title:{type:String,default:""}},data(){return{prefixCls:Ple}},computed:{groupStyle(){return this.hasParentSubmenu&&this.mode!=="horizontal"?{paddingLeft:43+(this.parentSubmenuNum-1)*28+"px"}:{}}}};function Ile(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass([C.prefixCls+"-item-group"])},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-item-group-title"]),style:i.normalizeStyle(b.groupStyle)},i.toDisplayString(g.title),7),i.createElementVNode("ul",null,[i.renderSlot(c.$slots,"default")])],2)}var EL=l(Rle,[["render",Ile]]);const jx="ivu-menu",Nle={name:"MenuItem",mixins:[rE,pe],props:{name:{type:[String,Number],required:!0},disabled:{type:Boolean,default:!1}},data(){return{active:!1,id:j(6)}},computed:{classes(){return[`${jx}-item`,{[`${jx}-item-active`]:this.active,[`${jx}-item-selected`]:this.active,[`${jx}-item-disabled`]:this.disabled}]},itemStyle(){return this.hasParentSubmenu&&this.mode!=="horizontal"?{paddingLeft:43+(this.parentSubmenuNum-1)*24+"px"}:{}}},methods:{handleClickItem(c,d=!1){if(!this.disabled)if(d||this.target==="_blank"){this.handleCheckClick(c,d);let g=L(this,"Menu");g&&g.handleEmitSelectEvent(this.name)}else L(this,"Submenu")?this.SubmenuInstance.handleMenuItemSelect(this.name):this.MenuInstance.handleMenuItemSelect(this.name),this.handleCheckClick(c,d)},handleUpdateActiveName(c){this.name===c?(this.active=!0,this.SubmenuInstance&&this.SubmenuInstance.handleUpdateActiveName(c)):this.active=!1},addMenuItem(){const c=this.MenuInstance;c.menuItemList||(c.menuItemList=[]),c.menuItemList.push({id:this.id,menuitem:this})},removeMenuItem(){const c=this.MenuInstance;if(c.menuItemList&&c.menuItemList.length){const d=c.menuItemList.findIndex(g=>g.id===this.id);c.menuItemList.splice(d,1)}}},mounted(){this.addMenuItem()},beforeUnmount(){this.removeMenuItem()}},Dle=["href","target"];function Lle(c,d,g,M,C,b){return c.to?(i.openBlock(),i.createElementBlock("a",{key:0,href:c.linkUrl,target:c.target,class:i.normalizeClass(b.classes),onClick:[d[0]||(d[0]=i.withModifiers(B=>b.handleClickItem(B,!1),["exact"])),d[1]||(d[1]=i.withModifiers(B=>b.handleClickItem(B,!0),["ctrl"])),d[2]||(d[2]=i.withModifiers(B=>b.handleClickItem(B,!0),["meta"]))],style:i.normalizeStyle(b.itemStyle)},[i.renderSlot(c.$slots,"default")],14,Dle)):(i.openBlock(),i.createElementBlock("li",{key:1,class:i.normalizeClass(b.classes),onClick:d[3]||(d[3]=i.withModifiers((...B)=>b.handleClickItem&&b.handleClickItem(...B),["stop"])),style:i.normalizeStyle(b.itemStyle)},[i.renderSlot(c.$slots,"default")],6))}var ML=l(Nle,[["render",Lle]]);const AL={name:"Mobile",mixins:[P0],data(){return{className:"ivu-login-mobile",prefix:"ios-phone-portrait",placeholder:"请输入手机号码",type:"text"}},props:{rules:{type:[Object,Array],default(){return[{required:!0,message:ET.Mobile,trigger:"change"},{pattern:/^1\d{10}$/,message:"输入的手机号码格式不正确！",trigger:"change"}]}}}},so="ivu-modal",kL={x:null,y:null,dragX:null,dragY:null,dragging:!1,rect:null},Ble={inheritAttrs:!1,name:"Modal",mixins:[gn,HT],components:{Icon:S,iButton:Us},emits:["on-cancel","on-ok","on-hidden","on-visible-change","update:modelValue"],provide(){return{ModalInstance:this}},props:{modelValue:{type:Boolean,default:!1},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.modal.maskClosable===""?!0:c.$VIEWUI.modal.maskClosable}},title:{type:String},width:{type:[Number,String],default:520},okText:{type:String},cancelText:{type:String},loading:{type:Boolean,default:!1},styles:{type:Object,default(){return{}}},className:{type:String},footerHide:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},transitionNames:{type:Array,default(){return["ease","fade"]}},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!0:c.$VIEWUI.transfer}},fullscreen:{type:Boolean,default:!1},mask:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},sticky:{type:Boolean,default:!1},stickyDistance:{type:Number,default:10},resetDragPosition:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},beforeClose:Function,render:Function},data(){return{prefixCls:so,wrapShow:!1,showHead:!0,buttonLoading:!1,visible:this.modelValue,dragData:$(kL),modalIndex:this.handleGetModalIndex(),isMouseTriggerIn:!1,id:j(6),tableList:[],sliderList:[]}},computed:{wrapClasses(){return[`${so}-wrap`,{[`${so}-hidden`]:!this.wrapShow,[`${this.className}`]:!!this.className,[`${so}-no-mask`]:!this.showMask}]},wrapStyles(){return{zIndex:this.modalIndex+this.zIndex}},maskClasses(){return`${so}-mask`},classes(){return[`${so}`,{[`${so}-fullscreen`]:this.fullscreen,[`${so}-fullscreen-no-header`]:this.fullscreen&&!this.showHead,[`${so}-fullscreen-no-footer`]:this.fullscreen&&this.footerHide}]},contentClasses(){return[`${so}-content`,{[`${so}-content-no-mask`]:!this.showMask,[`${so}-content-drag`]:this.draggable&&!this.fullscreen,[`${so}-content-dragging`]:this.draggable&&this.dragData.dragging}]},mainStyles(){let c={};const d=parseInt(this.width),g=this.dragData.x!==null?{top:0}:{width:d<=100?`${d}%`:`${d}px`},M=this.styles?this.styles:{};return Object.assign(c,g,M),c},contentStyles(){let c={};if(this.draggable&&!this.fullscreen){const d=this.styles.top?parseFloat(this.styles.top):0,g=this.styles.left?parseFloat(this.styles.left):0;this.dragData.x!==null&&(c.left=`${this.dragData.x-g}px`),this.dragData.y!==null&&(c.top=`${this.dragData.y}px`),this.dragData.y!==null&&(c.top=`${this.dragData.y-d}px`);const M=parseInt(this.width),C={width:M<=100?`${M}%`:`${M}px`};Object.assign(c,C)}return c},localeOkText(){return this.okText===void 0?this.t("i.modal.okText"):this.okText},localeCancelText(){return this.cancelText===void 0?this.t("i.modal.cancelText"):this.cancelText},showMask(){return this.mask}},methods:{close(){if(!this.beforeClose)return this.handleClose();const c=this.beforeClose();c&&c.then?c.then(()=>{this.handleClose()}):this.handleClose()},handleClose(){this.visible=!1,this.$emit("update:modelValue",!1),this.$emit("on-cancel")},handleMask(){this.maskClosable&&this.showMask&&this.close()},handleWrapClick(c){if(this.isMouseTriggerIn){this.isMouseTriggerIn=!1;return}const d=c.target.getAttribute("class");d&&d.indexOf(`${so}-wrap`)>-1&&this.handleMask()},handleMousedown(){this.isMouseTriggerIn=!0},cancel(){this.close()},ok(){this.loading?this.buttonLoading=!0:(this.visible=!1,this.$emit("update:modelValue",!1)),this.$emit("on-ok")},EscClose(c){if(this.visible&&this.closable&&c.keyCode===27){const d=this.$root.modalList.map(g=>g.modal).filter(g=>g.$data.visible&&g.$props.closable).sort((g,M)=>g.$data.modalIndex<M.$data.modalIndex?1:-1)[0];setTimeout(()=>{d.close()},0)}},animationFinish(){this.$emit("on-hidden")},handleMoveStart(c){if(!this.draggable||this.fullscreen)return!1;const d=this.$refs.content.getBoundingClientRect();this.dragData.rect=d,this.dragData.x=d.x||d.left,this.dragData.y=d.y||d.top;const g={x:c.clientX,y:c.clientY};this.dragData.dragX=g.x,this.dragData.dragY=g.y,this.dragData.dragging=!0,o(window,"mousemove",this.handleMoveMove),o(window,"mouseup",this.handleMoveEnd)},handleMoveMove(c){if(!this.dragData.dragging||this.fullscreen)return!1;const d={x:c.clientX,y:c.clientY},g={x:d.x-this.dragData.dragX,y:d.y-this.dragData.dragY};if(s&&this.sticky){const M=document.documentElement.clientWidth,C=document.documentElement.clientHeight;this.dragData.x+g.x<=this.stickyDistance&&g.x<0?this.dragData.x=0:this.dragData.x+this.dragData.rect.width-M>-this.stickyDistance&&g.x>0?this.dragData.x=M-this.dragData.rect.width:this.dragData.x+=g.x,this.dragData.y+g.y<=this.stickyDistance&&g.y<0?this.dragData.y=0:this.dragData.y+this.dragData.rect.height-C>-this.stickyDistance&&g.y>0?this.dragData.y=C-this.dragData.rect.height:this.dragData.y+=g.y}else this.dragData.x+=g.x,this.dragData.y+=g.y;this.dragData.dragX=d.x,this.dragData.dragY=d.y},handleMoveEnd(){this.dragData.dragging=!1,a(window,"mousemove",this.handleMoveMove),a(window,"mouseup",this.handleMoveEnd)},handleGetModalIndex(){return He(),Te},handleClickModal(){if(this.draggable){if(ke!==this.lastVisibleIndex){this.lastVisibleIndex=ke;return}this.modalIndex=this.handleGetModalIndex()}},addModal(){const c=this.$root;c.modalList||(c.modalList=[]),c.modalList.push({id:this.id,modal:this})},removeModal(){const c=this.$root;if(!c.modalList)return;const d=c.modalList.findIndex(g=>g.id===this.id);c.modalList.splice(d,1)}},watch:{modelValue(c){this.visible=c},visible(c){c===!1?(this.buttonLoading=!1,this.timer=setTimeout(()=>{this.wrapShow=!1,this.removeScrollEffect()},300)):(this.lastVisible!==c&&(this.modalIndex=this.handleGetModalIndex(),Ue()),this.timer&&clearTimeout(this.timer),this.wrapShow=!0,this.scrollable||this.addScrollEffect()),this.tableList.forEach(d=>{d.table.handleOnVisibleChange(c)}),this.sliderList.forEach(d=>{d.slider.handleOnVisibleChange(c)}),this.$emit("on-visible-change",c),this.lastVisible=c,this.lastVisibleIndex=ke,c&&this.resetDragPosition&&(this.dragData=$(kL))},loading(c){c||(this.buttonLoading=!1)},scrollable(c){c?this.removeScrollEffect():this.addScrollEffect()},title(c){this.$slots.header===void 0&&(this.showHead=!!c)}},mounted(){this.visible&&(this.wrapShow=!0);let c=!0;this.$slots.header===void 0&&!this.title&&(c=!1),this.showHead=c,this.addModal(),s&&document.addEventListener("keydown",this.EscClose)},beforeUnmount(){this.removeModal(),s&&document.removeEventListener("keydown",this.EscClose),this.removeScrollEffect()}};function $le(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("i-button");return i.openBlock(),i.createBlock(i.Teleport,{to:"body",disabled:!g.transfer},[i.createVNode(i.Transition,{name:g.transitionNames[1]},{default:i.withCtx(()=>[b.showMask?i.withDirectives((i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.maskClasses),style:i.normalizeStyle(b.wrapStyles),onClick:d[0]||(d[0]=(...Y)=>b.handleMask&&b.handleMask(...Y))},null,6)),[[i.vShow,C.visible]]):i.createCommentVNode("",!0)]),_:1},8,["name"]),i.createElementVNode("div",{class:i.normalizeClass(b.wrapClasses),style:i.normalizeStyle(b.wrapStyles),onClick:d[5]||(d[5]=(...Y)=>b.handleWrapClick&&b.handleWrapClick(...Y))},[i.createVNode(i.Transition,{name:g.transitionNames[0],onAfterLeave:b.animationFinish},{default:i.withCtx(()=>[i.withDirectives(i.createElementVNode("div",i.mergeProps(c.$attrs,{class:b.classes,style:b.mainStyles,onMousedown:d[4]||(d[4]=(...Y)=>b.handleMousedown&&b.handleMousedown(...Y))}),[i.createElementVNode("div",{class:i.normalizeClass(b.contentClasses),ref:"content",style:i.normalizeStyle(b.contentStyles),onClick:d[3]||(d[3]=(...Y)=>b.handleClickModal&&b.handleClickModal(...Y))},[g.closable?(i.openBlock(),i.createElementBlock("a",{key:0,class:i.normalizeClass([C.prefixCls+"-close"]),onClick:d[1]||(d[1]=(...Y)=>b.close&&b.close(...Y))},[i.renderSlot(c.$slots,"close",{},()=>[i.createVNode(B,{type:"ios-close"})])],2)):i.createCommentVNode("",!0),C.showHead?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass([C.prefixCls+"-header"]),onMousedown:d[2]||(d[2]=(...Y)=>b.handleMoveStart&&b.handleMoveStart(...Y))},[i.renderSlot(c.$slots,"header",{},()=>[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-header-inner"])},i.toDisplayString(g.title),3)])],34)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body"])},[i.renderSlot(c.$slots,"default")],2),g.footerHide?i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("div",{key:2,class:i.normalizeClass([C.prefixCls+"-footer"])},[i.renderSlot(c.$slots,"footer",{},()=>[i.createVNode(F,{type:"text",onClick:b.cancel},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(b.localeCancelText),1)]),_:1},8,["onClick"]),i.createVNode(F,{type:"primary",loading:C.buttonLoading,onClick:b.ok},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(b.localeOkText),1)]),_:1},8,["loading","onClick"])])],2))],6)],16),[[i.vShow,C.visible]])]),_:3},8,["name","onAfterLeave"])],6)],8,["disabled"])}var fa=l(Ble,[["render",$le]]);const Ac="ivu-modal-confirm";fa.newInstance=c=>{if(!s)return;const d=c||{},g=document.createElement("div");document.body.appendChild(g);let M=null;const C=i.createApp({mixins:[gn],data(){return Object.assign({},d,{visible:!1,width:416,title:"",body:"",iconType:"",iconName:"",okText:void 0,cancelText:void 0,showCancel:!1,loading:!1,buttonLoading:!1,scrollable:!1,closable:!1,closing:!1})},render(){let B=[];this.showCancel&&B.push(i.h(Us,{type:"text",onClick:this.cancel},()=>this.localeCancelText)),B.push(i.h(Us,{type:"primary",loading:this.buttonLoading,onClick:this.ok},()=>this.localeOkText));let F;this.render?F=i.h("div",{class:`${Ac}-body ${Ac}-body-render`},[this.render(i.h)]):F=i.h("div",{class:`${Ac}-body`},[i.h("div",{innerHTML:this.body})]);let Y;return this.title&&(Y=i.h("div",{class:`${Ac}-head`},[i.h("div",{class:this.iconTypeCls},[i.h("i",{class:this.iconNameCls})]),i.h("div",{class:`${Ac}-head-title`,innerHTML:this.title})])),i.h(fa,Object.assign({},d,{width:this.width,scrollable:this.scrollable,closable:this.closable,ref:"modal"},{modelValue:this.visible,"onUpdate:modelValue":G=>this.visible=G,"onOn-cancel":this.cancel}),()=>i.h("div",{class:Ac},[Y,F,i.h("div",{class:`${Ac}-footer`},B)]))},computed:{iconTypeCls(){return[`${Ac}-head-icon`,`${Ac}-head-icon-${this.iconType}`]},iconNameCls(){return["ivu-icon",`ivu-icon-${this.iconName}`]},localeOkText(){return this.okText?this.okText:this.t("i.modal.okText")},localeCancelText(){return this.cancelText?this.cancelText:this.t("i.modal.cancelText")}},methods:{cancel(){this.closing||(this.$refs.modal.visible=!1,this.buttonLoading=!1,this.onCancel(),this.remove())},ok(){this.closing||(this.loading?this.buttonLoading=!0:(this.$refs.modal.visible=!1,this.remove()),this.onOk())},remove(){this.closing=!0,setTimeout(()=>{this.closing=!1,this.destroy()},300)},destroy(){C.unmount(),document.body.removeChild(g),this.onRemove()},onOk(){},onCancel(){},onRemove(){}},created(){M=i.getCurrentInstance()}});C.mount(g);const b=M.refs.modal;return{show(B){switch(b.$parent.showCancel=B.showCancel,b.$parent.iconType=B.icon,B.icon){case"info":b.$parent.iconName="ios-information-circle";break;case"success":b.$parent.iconName="ios-checkmark-circle";break;case"warning":b.$parent.iconName="ios-alert";break;case"error":b.$parent.iconName="ios-close-circle";break;case"confirm":b.$parent.iconName="ios-help-circle";break}"width"in B&&(b.$parent.width=B.width),"closable"in B&&(b.$parent.closable=B.closable),"title"in B&&(b.$parent.title=B.title),"content"in B&&(b.$parent.body=B.content),"okText"in B&&(b.$parent.okText=B.okText),"cancelText"in B&&(b.$parent.cancelText=B.cancelText),"onCancel"in B&&(b.$parent.onCancel=B.onCancel),"onOk"in B&&(b.$parent.onOk=B.onOk),"loading"in B&&(b.$parent.loading=B.loading),"scrollable"in B&&(b.$parent.scrollable=B.scrollable),b.$parent.onRemove=B.onRemove,b.visible=!0},remove(){b.visible=!1,b.$parent.buttonLoading=!1,b.$parent.remove()},component:b}};let q0;function PL(c=void 0,d=!0){return q0=q0||fa.newInstance({closable:!1,maskClosable:!1,footerHide:!0,render:c,lockScroll:d}),q0}function Z0(c){const d="render"in c?c.render:void 0,g="lockScroll"in c?c.lockScroll:!0;let M=PL(d,g);c.onRemove=function(){q0=null},M.show(c)}fa.info=function(c={}){return c.icon="info",c.showCancel=!1,Z0(c)},fa.success=function(c={}){return c.icon="success",c.showCancel=!1,Z0(c)},fa.warning=function(c={}){return c.icon="warning",c.showCancel=!1,Z0(c)},fa.error=function(c={}){return c.icon="error",c.showCancel=!1,Z0(c)},fa.confirm=function(c={}){return c.icon="confirm",c.showCancel=!0,Z0(c)},fa.remove=function(){if(!q0)return!1;PL().remove()};const $o="ivu-notice",RL="ivu-icon",Ule="ivu_notice_key_";let IL=24,NL=4.5,Gp,DL=1;const Vle={info:"ios-information-circle",success:"ios-checkmark-circle",warning:"ios-alert",error:"ios-close-circle"},LL="move-notice";function BL(){return Gp=Gp||Tx.newInstance({prefixCls:$o,styles:{top:`${IL}px`,right:0},transitionName:LL}),Gp}function K0(c,d){const g=d.title||"",M=d.desc||"",C=d.name||`${Ule}${DL}`,b=d.onClose||function(){},B=d.render,F=d.duration===0?0:d.duration||NL;DL++;let Y=BL(),G,K;const fe=d.render&&!g?"":M||d.render?` ${$o}-with-desc`:"";if(c==="normal")K=!1,G=`
            <div class="${$o}-custom-content ${$o}-with-normal ${fe}">
                <div class="${$o}-title">${g}</div>
                <div class="${$o}-desc">${M}</div>
            </div>
        `;else{const Ee=Vle[c],Ce=fe===""?"":"-outline";K=!0,G=`
            <div class="${$o}-custom-content ${$o}-with-icon ${$o}-with-${c} ${fe}">
                <span class="${$o}-icon ${$o}-icon-${c}">
                    <i class="${RL} ${RL}-${Ee}${Ce}"></i>
                </span>
                <div class="${$o}-title">${g}</div>
                <div class="${$o}-desc">${M}</div>
            </div>
        `}Y.notice({name:C.toString(),duration:F,styles:{},transitionName:LL,content:G,withIcon:K,render:B,hasTitle:!!g,onClose:b,closable:!0,type:"notice"})}var sE={open(c){return K0("normal",c)},info(c){return K0("info",c)},success(c){return K0("success",c)},warning(c){return K0("warning",c)},error(c){return K0("error",c)},config(c){c.top&&(IL=c.top),(c.duration||c.duration===0)&&(NL=c.duration)},close(c){if(c)c=c.toString(),Gp&&Gp.remove(c);else return!1},destroy(){let c=BL();Gp=null,c.destroy("ivu-notice")}};const Qr="ivu-tabs",oE=300,$L=(c,d,g,M)=>{const C=(c.findIndex(B=>B.name===d)+g+c.length)%c.length,b=c[C];return b.disabled?$L(c,b.name,g):b},UL=(c,d)=>{try{c.focus()}catch{}if(s&&document.activeElement==c&&c!==d)return!0;const g=c.children;for(let M of g)if(UL(M,d))return!0;return!1},Fle={name:"Tabs",mixins:[za],emits:["on-click","on-dblclick","on-contextmenu","on-tab-remove","on-drag-drop","update:modelValue"],components:{Icon:S,Render:KN,Dropdown:Rd,DropdownMenu:Id},provide(){return{TabsInstance:this}},props:{modelValue:{type:[String,Number]},type:{validator(c){return O(c,["line","card"])},default:"line"},size:{validator(c){return O(c,["small","default"])},default:"default"},animated:{type:Boolean,default:!0},captureFocus:{type:Boolean,default:!1},closable:{type:Boolean,default:!1},beforeRemove:Function,name:{type:String},draggable:{type:Boolean,default:!1},autoCloseContextmenu:{type:Boolean,default:!0}},data(){return{prefixCls:Qr,navList:[],barWidth:0,barOffset:0,activeKey:this.modelValue,focusedKey:this.modelValue,showSlot:!1,navStyle:{transform:""},scrollable:!1,transitioning:!1,contextMenuVisible:!1,contextMenuStyles:{top:0,left:0},paneList:[],tableList:[]}},computed:{classes(){return[`${Qr}`,{[`${Qr}-card`]:this.type==="card",[`${Qr}-mini`]:this.size==="small"&&this.type==="line",[`${Qr}-no-animation`]:!this.animated}]},contentClasses(){return[`${Qr}-content`,{[`${Qr}-content-animated`]:this.animated}]},barClasses(){return[`${Qr}-ink-bar`,{[`${Qr}-ink-bar-animated`]:this.animated}]},contentStyle(){const c=this.getTabIndex(this.activeKey),d=c===0?"0%":`-${c}00%`;let g={};return c>-1&&(g={transform:`translateX(${d}) translateZ(0px)`}),g},barStyle(){let c={visibility:"hidden",width:`${this.barWidth}px`};return this.type==="line"&&(c.visibility="visible"),this.animated?c.transform=`translate3d(${this.barOffset}px, 0px, 0px)`:c.left=`${this.barOffset}px`,c},arrowType(){const c=this.globalConfig;let d="ios-close";return c&&(c.tabs.customCloseIcon?d="":c.tabs.closeIcon&&(d=c.tabs.closeIcon)),d},customArrowType(){const c=this.globalConfig;let d="";return c&&c.tabs.customCloseIcon&&(d=c.tabs.customCloseIcon),d},arrowSize(){const c=this.globalConfig;let d="";return c&&c.tabs.closeIconSize&&(d=c.tabs.closeIconSize),d}},methods:{getTabs(){const c=this.paneList.map(g=>g.pane),d=[];return c.forEach(g=>{g.tab&&this.name?g.tab===this.name&&d.push(g):d.push(g)}),d.sort((g,M)=>{if(g.index&&M.index)return g.index>M.index?1:-1}),d},updateNav(){this.navList=[],this.getTabs().forEach((c,d)=>{this.navList.push({labelType:typeof c.label,label:c.label,icon:c.icon||"",name:c.currentName||d,disabled:c.disabled,closable:c.closable,contextMenu:c.contextMenu}),c.currentName||(c.currentName=d),d===0&&(this.activeKey||(this.activeKey=c.currentName||d))}),this.updateStatus(),this.updateBar()},updateBar(){i.nextTick(()=>{const c=this.getTabIndex(this.activeKey);if(!this.$refs.nav)return;const d=this.$refs.nav.querySelectorAll(`.${Qr}-tab`),g=d[c];if(this.barWidth=g?parseFloat(g.offsetWidth):0,c>0){let M=0;const C=this.size==="small"?0:16;for(let b=0;b<c;b++)M+=parseFloat(d[b].offsetWidth)+C;this.barOffset=M}else this.barOffset=0;this.updateNavScroll()})},updateStatus(){this.getTabs().forEach(c=>c.show=c.currentName===this.activeKey||this.animated)},tabCls(c){return[`${Qr}-tab`,{[`${Qr}-tab-disabled`]:c.disabled,[`${Qr}-tab-active`]:c.name===this.activeKey,[`${Qr}-tab-focused`]:c.name===this.focusedKey}]},handleChange(c){if(this.transitioning)return;this.transitioning=!0,setTimeout(()=>this.transitioning=!1,oE);const d=this.navList[c];!d||d.disabled||(this.activeKey=d.name,this.$emit("update:modelValue",d.name),this.$emit("on-click",d.name))},handleDblclick(c){const d=this.navList[c];!d||d.disabled||this.$emit("on-dblclick",d.name)},handleContextmenu(c,d){this.contextMenuVisible&&this.handleClickContextMenuOutside(),i.nextTick(()=>{const g=this.navList[c];if(!g||g.disabled||!g.contextMenu)return;d.preventDefault();const M=this.$refs.tabsWrap.getBoundingClientRect(),C={left:`${d.clientX-M.left}px`,top:`${d.clientY-M.top}px`};this.contextMenuStyles=C,this.contextMenuVisible=!0,this.$emit("on-contextmenu",g,d,C)})},handleClickContextMenuOutside(){this.contextMenuVisible=!1},handlePreventSelect(c,d){const g=this.navList[c];!g||g.disabled||!g.contextMenu||d.preventDefault()},handleTabKeyNavigation(c){if(c.keyCode!==37&&c.keyCode!==39)return;const d=c.keyCode===39?1:-1,g=$L(this.navList,this.focusedKey,d);this.focusedKey=g.name},handleTabKeyboardSelect(c=!1){if(c)return;const d=this.focusedKey||0,g=this.getTabIndex(d);this.handleChange(g)},handleRemove(c){if(!this.beforeRemove)return this.handleRemoveTab(c);const d=this.beforeRemove(c);d&&d.then?d.then(()=>{this.handleRemoveTab(c)}):this.handleRemoveTab(c)},handleRemoveTab(c){const d=this.getTabs(),g=d[c];if(g.currentName===this.activeKey){const M=this.getTabs();let C=-1;if(M.length){const b=d.filter((F,Y)=>!F.disabled&&Y<c),B=d.filter((F,Y)=>!F.disabled&&Y>c);B.length?C=B[0].currentName:b.length?C=b[b.length-1].currentName:C=M[0].currentName}this.activeKey=C,this.$emit("update:modelValue",C)}this.$emit("on-tab-remove",g.currentName),this.updateNav()},showClose(c){return this.type==="card"?c.closable!==null?c.closable:this.closable:!1},scrollPrev(){const c=this.$refs.navScroll.offsetWidth,d=this.getCurrentScrollOffset();if(!d)return;let g=d>c?d-c:0;this.setOffset(g)},scrollNext(){const c=this.$refs.nav.offsetWidth,d=this.$refs.navScroll.offsetWidth,g=this.getCurrentScrollOffset();if(c-g<=d)return;let M=c-g>d*2?g+d:c-d;this.setOffset(M)},getCurrentScrollOffset(){const{navStyle:c}=this;return c.transform?Number(c.transform.match(/translateX\(-(\d+(\.\d+)*)px\)/)[1]):0},getTabIndex(c){return this.navList.findIndex(d=>d.name===c)},setOffset(c){this.navStyle.transform=`translateX(-${c}px)`},scrollToActiveTab(){if(!this.scrollable)return;const c=this.$refs.nav,d=this.$el.querySelector(`.${Qr}-tab-active`);if(!d)return;const g=this.$refs.navScroll,M=d.getBoundingClientRect(),C=g.getBoundingClientRect(),b=c.getBoundingClientRect(),B=this.getCurrentScrollOffset();let F=B;b.right<C.right&&(F=c.offsetWidth-C.width),M.left<C.left?F=B-(C.left-M.left):M.right>C.right&&(F=B+M.right-C.right),B!==F&&this.setOffset(Math.max(F,0))},updateNavScroll(){const c=this.$refs.nav.offsetWidth,d=this.$refs.navScroll.offsetWidth,g=this.getCurrentScrollOffset();d<c?(this.scrollable=!0,c-g<d&&this.setOffset(c-d)):(this.scrollable=!1,g>0&&this.setOffset(0))},handleScroll(c){c.preventDefault(),c.stopPropagation();const d=c.type;let g=0;(d==="DOMMouseScroll"||d==="mousewheel")&&(g=c.wheelDelta?c.wheelDelta:-(c.detail||0)*40),g>0?this.scrollPrev():this.scrollNext()},handleResize(){this.updateNavScroll()},isInsideHiddenElement(){if(!s)return;let c=this.$el.parentNode;for(;c&&c!==document.body;){if(c.style&&c.style.display==="none")return c;c=c.parentNode}return!1},updateVisibility(c){[...this.$refs.panes.querySelectorAll(`.${Qr}-tabpane`)].forEach((d,g)=>{c===g?([...d.children].filter(M=>M.classList.contains(`${Qr}-tabpane`)).forEach(M=>M.style.visibility="visible"),this.captureFocus&&setTimeout(()=>UL(d,d),oE)):setTimeout(()=>{[...d.children].filter(M=>M.classList.contains(`${Qr}-tabpane`)).forEach(M=>M.style.visibility="hidden")},oE)})},handleDrag(c,d){const g=this.navList[c];g&&d.dataTransfer.setData("tab-name",g.name)},handleDrop(c,d){const g=this.navList[c];if(g){const M=d.dataTransfer.getData("tab-name");d.preventDefault();let C=this.navList.map(F=>F.name);const b=parseInt(C.findIndex(F=>F===M)),B=parseInt(C.findIndex(F=>F===g.name));C.splice(B,1,...C.splice(b,1,C[B])),this.$emit("on-drag-drop",M,g.name,b,B,C)}},closeContextMenu(){this.handleClickContextMenuOutside()},handleClickDropdownItem(){this.autoCloseContextmenu&&this.closeContextMenu()}},watch:{modelValue(c){this.activeKey=c,this.focusedKey=c},activeKey(c){this.focusedKey=c,this.updateBar(),this.updateStatus(),this.tableList.forEach(g=>{g.table.handleOnVisibleChange(!0)}),i.nextTick(()=>{this.scrollToActiveTab()});const d=Math.max(this.getTabIndex(this.focusedKey),0);this.updateVisibility(d)}},mounted(){this.showSlot=this.$slots.extra!==void 0,this.observer=Wp(),this.observer.listenTo(this.$refs.navWrap,this.handleResize);const c=this.isInsideHiddenElement();c&&(this.mutationObserver=new A(()=>{c.style.display!=="none"&&(this.updateBar(),this.mutationObserver.disconnect())}),this.mutationObserver.observe(c,{attributes:!0,childList:!0,characterData:!0,attributeFilter:["style"]})),this.handleTabKeyboardSelect(!0),this.updateVisibility(this.getTabIndex(this.activeKey))},beforeUnmount(){this.observer.removeListener(this.$refs.navWrap,this.handleResize),this.mutationObserver&&this.mutationObserver.disconnect()}},zle=["onClick","onDblclick","onContextmenu","onSelectstart","draggable","onDragstart","onDrop"];function Xle(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("Render"),Y=i.resolveComponent("DropdownMenu"),G=i.resolveComponent("Dropdown");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),ref:"tabsWrap"},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-bar"])},[C.showSlot?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-nav-right"])},[i.renderSlot(c.$slots,"extra")],2)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-nav-container"]),tabindex:"0",ref:"navContainer",onKeydown:[d[5]||(d[5]=(...K)=>b.handleTabKeyNavigation&&b.handleTabKeyNavigation(...K)),d[6]||(d[6]=i.withKeys(i.withModifiers(K=>b.handleTabKeyboardSelect(!1),["prevent"]),["space"]))]},[i.createElementVNode("div",{ref:"navWrap",class:i.normalizeClass([C.prefixCls+"-nav-wrap",C.scrollable?C.prefixCls+"-nav-scrollable":""])},[i.createElementVNode("span",{class:i.normalizeClass([C.prefixCls+"-nav-prev",C.scrollable?"":C.prefixCls+"-nav-scroll-disabled"]),onClick:d[0]||(d[0]=(...K)=>b.scrollPrev&&b.scrollPrev(...K))},[i.createVNode(B,{type:"ios-arrow-back"})],2),i.createElementVNode("span",{class:i.normalizeClass([C.prefixCls+"-nav-next",C.scrollable?"":C.prefixCls+"-nav-scroll-disabled"]),onClick:d[1]||(d[1]=(...K)=>b.scrollNext&&b.scrollNext(...K))},[i.createVNode(B,{type:"ios-arrow-forward"})],2),i.createElementVNode("div",{ref:"navScroll",class:i.normalizeClass([C.prefixCls+"-nav-scroll"]),"on:DOMMouseScroll":d[3]||(d[3]=(...K)=>b.handleScroll&&b.handleScroll(...K)),onMousewheel:d[4]||(d[4]=(...K)=>b.handleScroll&&b.handleScroll(...K))},[i.createElementVNode("div",{ref:"nav",class:i.normalizeClass([C.prefixCls+"-nav"]),style:i.normalizeStyle(C.navStyle)},[i.createElementVNode("div",{class:i.normalizeClass(b.barClasses),style:i.normalizeStyle(b.barStyle)},null,6),(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(C.navList,(K,fe)=>(i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.tabCls(K)),key:fe,onClick:Ee=>b.handleChange(fe),onDblclick:Ee=>b.handleDblclick(fe),onContextmenu:i.withModifiers(Ee=>b.handleContextmenu(fe,Ee),["stop"]),onSelectstart:i.withModifiers(Ee=>b.handlePreventSelect(fe,Ee),["stop"]),draggable:g.draggable,onDragstart:Ee=>b.handleDrag(fe,Ee),onDrop:Ee=>b.handleDrop(fe,Ee),onDragover:d[2]||(d[2]=i.withModifiers(()=>{},["prevent"]))},[K.icon!==""?(i.openBlock(),i.createBlock(B,{key:0,type:K.icon},null,8,["type"])):i.createCommentVNode("",!0),K.labelType==="function"?(i.openBlock(),i.createBlock(F,{key:1,render:K.label},null,8,["render"])):(i.openBlock(),i.createElementBlock(i.Fragment,{key:2},[i.createTextVNode(i.toDisplayString(K.label),1)],64)),b.showClose(K)?(i.openBlock(),i.createBlock(B,{key:3,class:i.normalizeClass([C.prefixCls+"-close"]),type:b.arrowType,custom:b.customArrowType,size:b.arrowSize,onClick:i.withModifiers(Ee=>b.handleRemove(fe),["stop"])},null,8,["class","type","custom","size","onClick"])):i.createCommentVNode("",!0)],42,zle))),128))],6)],34)],2)],34)],2),i.createElementVNode("div",{class:i.normalizeClass(b.contentClasses),style:i.normalizeStyle(b.contentStyle),ref:"panes"},[i.renderSlot(c.$slots,"default")],6),i.createElementVNode("div",{class:"ivu-tabs-context-menu",style:i.normalizeStyle(C.contextMenuStyles)},[i.createVNode(G,{trigger:"custom",visible:C.contextMenuVisible,transfer:"",onOnClick:b.handleClickDropdownItem,onOnClickoutside:b.handleClickContextMenuOutside},{list:i.withCtx(()=>[i.createVNode(Y,null,{default:i.withCtx(()=>[i.renderSlot(c.$slots,"contextMenu")]),_:3})]),_:3},8,["visible","onOnClick","onOnClickoutside"])],4)],2)}var Yx=l(Fle,[["render",Xle]]);const Wle={name:"Notification",components:{Dropdown:Rd,DropdownMenu:Id,Badge:mx,Tabs:Yx},emits:["on-visible-change","on-item-click","on-clear","on-load-more","on-tab-change"],provide(){return{NotificationInstance:this}},props:{count:{type:Number},autoCount:{type:Boolean,default:!1},countType:{validator(c){return O(c,["text","badge"])},default:"text"},icon:{type:String,default:"md-notifications-outline"},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},placement:{validator(c){return O(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},badgeProps:{type:Object,default(){return{}}},clearClose:{type:Boolean,default:!1},locale:{type:Object,default(){return{loadedAll:"加载完毕",loading:"加载中...",loadMore:"加载更多",clear:"清空"}}},tab:{type:String},wide:{type:Boolean,default:!1},transferClassName:{type:String}},data(){return{visible:!1,countAll:0,tabList:[]}},computed:{finalCount(){return this.autoCount?this.countAll:this.count},transferClasses(){let c="ivu-notifications-transfer";return this.transferClassName&&(c+=` ${this.transferClassName}`),c}},watch:{visible(c){this.$emit("on-visible-change",c)}},methods:{handleVisibleChange(c){this.visible=c},handleClickOutside(c){this.$refs.notice.contains(c.target)||(this.visible=!1)},handleToggleOpen(){this.visible=!this.visible},handleGetCountAll(){if(this.autoCount){const c=this.tabList.map(g=>g.tab);let d=0;c.forEach(g=>{g.count&&(d+=g.count)}),this.countAll=d}},handleItemClick(c,d){this.$emit("on-item-click",c,d)},handleClear(c){this.$emit("on-clear",c),this.clearClose&&this.handleClose()},handleLoadMore(c){this.$emit("on-load-more",c)},handleClose(){this.visible=!1},handleTabChange(c){const d=this.tabList.map(M=>M.tab);let g={};d.forEach(M=>{M.$refs.tab.currentName===c&&(g=M.handleGetTabBaseInfo())}),this.$emit("on-tab-change",g)}}},Gle={class:"ivu-notifications",ref:"notice"},Hle={class:"ivu-notifications-tabs"},Qle={key:0,class:"ivu-notifications-extra"};function jle(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("Badge"),Y=i.resolveComponent("Tabs"),G=i.resolveComponent("DropdownMenu"),K=i.resolveComponent("Dropdown");return i.openBlock(),i.createElementBlock("div",Gle,[i.createVNode(K,{trigger:"custom",visible:C.visible,transfer:g.transfer,placement:g.placement,"transfer-class-name":b.transferClasses,onOnVisibleChange:b.handleVisibleChange,onOnClickoutside:b.handleClickOutside},{list:i.withCtx(()=>[c.$slots.default?(i.openBlock(),i.createBlock(G,{key:0,onClick:d[1]||(d[1]=i.withModifiers(()=>{},["stop"]))},{default:i.withCtx(()=>[i.createElementVNode("div",{class:i.normalizeClass(["ivu-notifications-list",{"ivu-notifications-list-wide":g.wide}])},[i.createElementVNode("div",Hle,[i.createVNode(Y,{animated:!1,"model-value":g.tab,onOnClick:b.handleTabChange},{default:i.withCtx(()=>[i.renderSlot(c.$slots,"default")]),_:3},8,["model-value","onOnClick"])])],2),c.$slots.extra?(i.openBlock(),i.createElementBlock("div",Qle,[i.renderSlot(c.$slots,"extra")])):i.createCommentVNode("",!0)]),_:3})):i.createCommentVNode("",!0)]),default:i.withCtx(()=>[i.createElementVNode("div",{class:"ivu-notifications-rel",onClick:d[0]||(d[0]=i.withModifiers((...fe)=>b.handleToggleOpen&&b.handleToggleOpen(...fe),["prevent","stop"]))},[i.createVNode(F,i.mergeProps({count:b.finalCount},g.badgeProps),{default:i.withCtx(()=>[i.renderSlot(c.$slots,"icon",{},()=>[i.createVNode(B,{type:g.icon,size:"24"},null,8,["type"])])]),_:3},16,["count"])])]),_:3},8,["visible","transfer","placement","transfer-class-name","onOnVisibleChange","onOnClickoutside"])],512)}var VL=l(Wle,[["render",jle]]);const Yle=(c,d)=>c<=d,J0=c=>c<10?"0"+c:c,FL=(c,d)=>{const g=new Date(c),M=g.getFullYear(),C=J0(g.getMonth()+1),b=J0(g.getDate()),B=J0(g.getHours()),F=J0(g.getMinutes()),Y=J0(g.getSeconds());let G="";return d==="year"?G=M+"-"+C+"-"+b+" "+B+":"+F+":"+Y:G=C+"-"+b+" "+B+":"+F,G},qle=(c,d)=>{const g=new Date().getTime(),M=Yle(c,g);let C=g-c;M||(C=-C);let b="",B=M?d("i.time.before")||"前":d("i.time.after")||"后";return C<1e3?b=d("i.time.just")||"刚刚":C<6e4?b=parseInt(C/1e3)+(d("i.time.seconds")||"秒")+B:C>=6e4&&C<36e5?b=Math.floor(C/6e4)+(d("i.time.minutes")||"分钟")+B:C>=36e5&&C<864e5?b=Math.floor(C/36e5)+(d("i.time.hours")||"小时")+B:C>=864e5&&C<262386e4?b=Math.floor(C/864e5)+(d("i.time.days")||"天")+B:C>=262386e4&&C<=3156786e4&&M?b=FL(c):b=FL(c,"year"),b};function Zle(c,d){return qle(c,d)}const zL="ivu-time",Kle={name:"Time",mixins:[gn],props:{time:{type:[Number,Date,String],required:!0},type:{type:String,validator(c){return O(c,["relative","date","datetime"])},default:"relative"},hash:{type:String,default:""},interval:{type:Number,default:60}},data(){return{date:""}},computed:{classes(){return[`${zL}`,{[`${zL}-with-hash`]:this.hash}]}},watch:{time(){this.setTime()}},methods:{handleClick(){s&&this.hash!==""&&(window.location.hash=this.hash)},setTime(){const c=typeof this.time;let d;if(c==="number"){const g=this.time.toString().length>10?this.time:this.time*1e3;d=new Date(g).getTime()}else c==="object"?d=this.time.getTime():c==="string"&&(d=Io(this.time).valueOf());if(this.type==="relative")this.date=Zle(d,this.t);else{const g=new Date(this.time),M=g.getFullYear(),C=g.getMonth()+1<10?"0"+(g.getMonth()+1):g.getMonth()+1,b=g.getDate()<10?"0"+g.getDate():g.getDate(),B=g.getHours()<10?"0"+g.getHours():g.getHours(),F=g.getMinutes()<10?"0"+g.getMinutes():g.getMinutes(),Y=g.getSeconds()<10?"0"+g.getSeconds():g.getSeconds();this.type==="datetime"?this.date=`${M}-${C}-${b} ${B}:${F}:${Y}`:this.type==="date"&&(this.date=`${M}-${C}-${b}`)}}},mounted(){this.setTime(),this.interval!==0&&(this.timer=setInterval(()=>{this.setTime()},1e3*this.interval))},beforeUnmount(){this.timer&&clearInterval(this.timer)}};function Jle(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("span",{class:i.normalizeClass(b.classes),onClick:d[0]||(d[0]=(...B)=>b.handleClick&&b.handleClick(...B))},i.toDisplayString(C.date),3)}var qx=l(Kle,[["render",Jle]]);const ece={name:"NotificationItem",inject:["NotificationTabInstance","NotificationInstance"],components:{Row:$h,Col:Ml,Avatar:C0,Tag:$p,Time:qx},emits:["on-item-click"],props:{rowProps:{type:Object,default(){return{type:"flex",justify:"center",align:"middle"}}},read:{type:[Boolean,Number],default:!1},icon:{type:String},customIcon:{type:String},iconColor:{type:String},iconSize:{validator(c){return O(c,["small","default","large"])},default:"default"},avatar:{type:String},avatarShape:{validator(c){return O(c,["circle","square"])},default:"circle"},title:{type:String},content:{type:String},time:{type:[Number,Date,String]},timeProps:{type:Object,default(){return{}}},tag:{type:String},tagProps:{type:Object,default(){return{}}},clickClose:{type:Boolean,default:!1}},data(){return{id:j(6)}},computed:{classes(){return{"ivu-notifications-item-unread":this.read===!1||this.read===0}},contentSpan(){return this.icon||this.customIcon||this.avatar||this.$slots.avatar?20:24},iconStyle(){let c={};return this.iconColor&&(c={"background-color":this.iconColor}),c}},methods:{handleClick(){this.$emit("on-item-click",this.$attrs),this.NotificationTabInstance.handleItemClick(this.$attrs),this.clickClose&&this.NotificationInstance.handleClose()},addItem(){this.NotificationTabInstance.itemList.push({id:this.id,item:this})},removeItem(){const c=this.NotificationTabInstance,d=c.itemList.findIndex(g=>g.id===this.id);c.itemList.splice(d,1)}},mounted(){this.addItem(),this.NotificationTabInstance.handleGetItems()},unmounted(){this.NotificationTabInstance.handleGetItems()},beforeUnmount(){this.removeItem()}},tce={class:"ivu-notifications-item-title"},ice={key:0},nce={key:0,class:"ivu-notifications-item-tag"},rce={key:0,class:"ivu-notifications-item-desc"},sce={key:1,class:"ivu-notifications-item-time"};function oce(c,d,g,M,C,b){const B=i.resolveComponent("Avatar"),F=i.resolveComponent("Col"),Y=i.resolveComponent("Tag"),G=i.resolveComponent("Time"),K=i.resolveComponent("Row");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["ivu-notifications-item",b.classes]),onClick:d[0]||(d[0]=(...fe)=>b.handleClick&&b.handleClick(...fe))},[i.renderSlot(c.$slots,"default",{},()=>[i.createVNode(K,i.normalizeProps(i.guardReactiveProps(g.rowProps)),{default:i.withCtx(()=>[g.icon||g.customIcon||g.avatar||c.$slots.avatar?(i.openBlock(),i.createBlock(F,{key:0,span:"4",class:"ivu-notifications-item-icon"},{default:i.withCtx(()=>[i.renderSlot(c.$slots,"avatar",{},()=>[g.icon?(i.openBlock(),i.createBlock(B,{key:0,icon:g.icon,shape:g.avatarShape,size:g.iconSize,style:i.normalizeStyle(b.iconStyle)},null,8,["icon","shape","size","style"])):g.customIcon?(i.openBlock(),i.createBlock(B,{key:1,"custom-icon":g.customIcon,shape:g.avatarShape,size:g.iconSize,style:i.normalizeStyle(b.iconStyle)},null,8,["custom-icon","shape","size","style"])):g.avatar?(i.openBlock(),i.createBlock(B,{key:2,src:g.avatar,shape:g.avatarShape,size:g.iconSize,style:i.normalizeStyle(b.iconStyle)},null,8,["src","shape","size","style"])):i.createCommentVNode("",!0)])]),_:3})):i.createCommentVNode("",!0),i.createVNode(F,{span:b.contentSpan,class:"ivu-notifications-item-content"},{default:i.withCtx(()=>[i.createElementVNode("div",tce,[g.title||c.$slots.title?(i.openBlock(),i.createElementBlock("h4",ice,[i.renderSlot(c.$slots,"title",{},()=>[i.createTextVNode(i.toDisplayString(g.title),1)]),g.tag?(i.openBlock(),i.createElementBlock("div",nce,[i.createVNode(Y,i.normalizeProps(i.guardReactiveProps(g.tagProps)),{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(g.tag),1)]),_:1},16)])):i.createCommentVNode("",!0)])):i.createCommentVNode("",!0)]),g.content||c.$slots.content?(i.openBlock(),i.createElementBlock("div",rce,[i.renderSlot(c.$slots,"content",{},()=>[i.createTextVNode(i.toDisplayString(g.content),1)])])):i.createCommentVNode("",!0),g.time||c.$slots.time?(i.openBlock(),i.createElementBlock("div",sce,[i.renderSlot(c.$slots,"time",{},()=>[i.createVNode(G,i.mergeProps({time:g.time},g.timeProps),null,16,["time"])])])):i.createCommentVNode("",!0)]),_:3},8,["span"])]),_:3},16)])],2)}var XL=l(ece,[["render",oce]]);const ace="ivu-tabs-tabpane",lce={name:"TabPane",inject:["TabsInstance"],props:{name:{type:String},label:{type:[String,Function],default:""},icon:{type:String},disabled:{type:Boolean,default:!1},closable:{type:Boolean,default:null},tab:{type:String},index:{type:Number},contextMenu:{type:Boolean,default:!1}},data(){return{prefixCls:ace,show:!0,currentName:this.name,id:j(6)}},computed:{contentStyle(){return{visibility:this.TabsInstance.activeKey!==this.currentName?"hidden":"visible"}}},methods:{updateNav(){this.TabsInstance.updateNav()},addPane(){const c=this.TabsInstance;c.paneList||(c.paneList=[]),c.paneList.push({id:this.id,pane:this})},removePane(){const c=this.TabsInstance;if(c.paneList&&c.paneList.length){const d=c.paneList.findIndex(g=>g.id===this.id);c.paneList.splice(d,1)}}},watch:{name(c){this.currentName=c,this.updateNav()},label(c){typeof c!="function"&&this.updateNav()},icon(){this.updateNav()},disabled(){this.updateNav()}},mounted(){this.addPane(),this.updateNav()},beforeUnmount(){this.removePane(),this.updateNav()}};function cce(c,d,g,M,C,b){return i.withDirectives((i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(C.prefixCls),style:i.normalizeStyle(b.contentStyle)},[i.renderSlot(c.$slots,"default")],6)),[[i.vShow,C.show]])}var Zx=l(lce,[["render",cce]]);const hce={name:"NotificationTab",inject:["NotificationInstance"],components:{TabPane:Zx,Icon:S},provide(){return{NotificationTabInstance:this}},props:{count:{type:Number},title:{type:String,required:!0},name:{type:String},emptyText:{type:String,default:"目前没有通知"},emptyImage:{type:String,default:"https://file.iviewui.com/iview-pro/icon-no-message.svg"},loadedAll:{type:Boolean,default:!0},showLoadedAll:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},scrollToLoad:{type:Boolean,default:!0},showClear:{type:Boolean,default:!0},showClearIcon:{type:Boolean,default:!0}},data(){return{customLabel:c=>c("div",[c("span",this.title),c(mx,{count:this.count})]),itemCount:0,itemList:[],id:j(6)}},computed:{currentTitle(){const c=this.NotificationInstance.countType;if(c==="text"){const d=this.count?`(${this.count})`:"";return`${this.title} ${d}`}else if(c==="badge")return this.customLabel}},watch:{count:{handler(){this.NotificationInstance.handleGetCountAll()},immediate:!0}},methods:{handleGetTabBaseInfo(){return{name:this.name,title:this.title}},handleGetItems(){const c=this.itemList.map(d=>d.item);this.itemCount=c.length},handleItemClick(c){this.NotificationInstance.handleItemClick(this.handleGetTabBaseInfo(),c)},handleClear(){this.NotificationInstance.handleClear(this.handleGetTabBaseInfo())},handleLoadMore(){this.NotificationInstance.handleLoadMore(this.handleGetTabBaseInfo())},handleScroll(){if(!this.scrollToLoad)return;const c=this.$refs.scroll,d=c.scrollHeight-c.clientHeight-c.scrollTop;!this.loading&&d===0&&this.handleLoadMore()},addTab(){this.NotificationInstance.tabList.push({id:this.id,tab:this})},removeTab(){const c=this.NotificationInstance,d=c.tabList.findIndex(g=>g.id===this.id);c.tabList.splice(d,1)}},mounted(){this.addTab()},beforeUnmount(){this.removeTab()}},uce={class:"ivu-notifications-container-list"},dce={key:0,class:"ivu-notifications-tab-empty"},fce=["src"],pce={class:"ivu-notifications-tab-empty-text"},mce={class:"ivu-notifications-tab-loading"},gce={key:0,class:"ivu-notifications-tab-loading-item ivu-notifications-tab-loading-show"},vce={key:2,class:"ivu-notifications-tab-loading-item ivu-notifications-tab-loading-all"};function yce(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("TabPane");return i.openBlock(),i.createBlock(F,{label:b.currentTitle,name:g.name,ref:"tab",class:"ivu-notifications-tab"},{default:i.withCtx(()=>[i.createElementVNode("div",{class:"ivu-notifications-container",onScroll:d[1]||(d[1]=(...Y)=>b.handleScroll&&b.handleScroll(...Y)),ref:"scroll"},[i.renderSlot(c.$slots,"top"),i.createElementVNode("div",uce,[i.renderSlot(c.$slots,"default")]),!g.loading&&C.itemCount===0?(i.openBlock(),i.createElementBlock("div",dce,[i.renderSlot(c.$slots,"empty",{},()=>[g.emptyImage?(i.openBlock(),i.createElementBlock("img",{key:0,class:"ivu-notifications-tab-empty-img",src:g.emptyImage},null,8,fce)):i.createCommentVNode("",!0),i.createElementVNode("div",pce,i.toDisplayString(g.emptyText),1)])])):i.createCommentVNode("",!0),i.createElementVNode("div",mce,[g.loading?(i.openBlock(),i.createElementBlock("div",gce,[i.renderSlot(c.$slots,"loading",{},()=>[i.createVNode(B,{type:"ios-loading",class:"ivu-load-loop"}),i.createTextVNode(" "+i.toDisplayString(b.NotificationInstance.locale.loading),1)])])):g.loadedAll?g.showLoadedAll&&g.loadedAll?(i.openBlock(),i.createElementBlock("div",vce,[i.renderSlot(c.$slots,"loaded-all",{},()=>[i.createTextVNode(i.toDisplayString(b.NotificationInstance.locale.loadedAll),1)])])):i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("div",{key:1,class:"ivu-notifications-tab-loading-item ivu-notifications-tab-loading-more",onClick:d[0]||(d[0]=(...Y)=>b.handleLoadMore&&b.handleLoadMore(...Y))},[i.renderSlot(c.$slots,"load-more",{},()=>[i.createTextVNode(i.toDisplayString(b.NotificationInstance.locale.loadMore),1)])]))])],544),g.showClear&&C.itemCount!==0?(i.openBlock(),i.createElementBlock("div",{key:0,class:"ivu-notifications-tab-clear",onClick:d[2]||(d[2]=(...Y)=>b.handleClear&&b.handleClear(...Y))},[i.renderSlot(c.$slots,"clear",{},()=>[g.showClearIcon?(i.openBlock(),i.createBlock(B,{key:0,type:"md-done-all"})):i.createCommentVNode("",!0),i.createElementVNode("span",null,i.toDisplayString(b.NotificationInstance.locale.clear)+i.toDisplayString(g.title),1)])])):i.createCommentVNode("",!0)]),_:3},8,["label","name"])}var WL=l(hce,[["render",yce]]);const bce={name:"Trend",components:{Icon:S},props:{flag:{validator(c){return O(c,["up","down"])}},colorful:{type:Boolean,default:!0},reverseColor:{type:Boolean,default:!1},textColor:{type:Boolean,default:!1},showTitle:{type:[Boolean,String],default:!1}},computed:{classes(){return[{"ivu-trend-up":this.flag==="up","ivu-trend-down":this.flag==="down","ivu-trend-reverse-color":this.reverseColor,"ivu-trend-colorful":this.colorful,"ivu-trend-text-color":this.textColor}]},flagType(){return this.flag==="up"?"md-arrow-dropup":this.flag==="down"?"md-arrow-dropdown":""}}},xce={class:"ivu-trend-text"};function wce(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["ivu-trend",b.classes])},[i.createElementVNode("span",xce,[i.renderSlot(c.$slots,"default")]),i.createVNode(B,{type:b.flagType,class:"ivu-trend-flag"},null,8,["type"])],2)}var aE=l(bce,[["render",wce]]);const _ce={name:"NumberInfo",components:{Trend:aE},props:{title:{type:String},subTitle:{type:String},total:{type:[String,Number]},subTotal:{type:[String,Number]},status:{validator(c){return O(c,["up","down"])}},gap:{type:[String,Number],default:8}},computed:{valueStyle(){return{"margin-top":this.gap+"px"}}}},Oce={class:"ivu-number-info"},Sce={key:0,class:"ivu-number-info-title"},Cce={key:1,class:"ivu-number-info-subTitle"},Tce={class:"ivu-number-info-total"},Ece={key:0,class:"ivu-number-info-subTotal"};function Mce(c,d,g,M,C,b){const B=i.resolveComponent("Trend");return i.openBlock(),i.createElementBlock("div",Oce,[g.title||c.$slots.title?(i.openBlock(),i.createElementBlock("div",Sce,[i.renderSlot(c.$slots,"title",{},()=>[i.createTextVNode(i.toDisplayString(g.title),1)])])):i.createCommentVNode("",!0),g.subTitle||c.$slots.subTitle?(i.openBlock(),i.createElementBlock("div",Cce,[i.renderSlot(c.$slots,"subTitle",{},()=>[i.createTextVNode(i.toDisplayString(g.subTitle),1)])])):i.createCommentVNode("",!0),i.createElementVNode("div",{class:"ivu-number-info-value",style:i.normalizeStyle(b.valueStyle)},[i.createElementVNode("span",Tce,[i.renderSlot(c.$slots,"total",{},()=>[i.createTextVNode(i.toDisplayString(g.total),1)])]),g.subTotal||c.$slots.subTotal?(i.openBlock(),i.createElementBlock("span",Ece,[i.renderSlot(c.$slots,"subTotal",{},()=>[i.createVNode(B,{flag:g.status},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(g.subTotal),1)]),_:1},8,["flag"])])])):i.createCommentVNode("",!0)],4)])}var GL=l(_ce,[["render",Mce]]),HL={exports:{}};/*! @preserve
* numeral.js
* version : 2.0.6
* author : Adam Draper
* license : MIT
* http://adamwdraper.github.com/Numeral-js/
*/(function(c){(function(d,g){c.exports?c.exports=g():d.numeral=g()})(ie,function(){var d,g,M="2.0.6",C={},b={},B={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},F={currentLocale:B.currentLocale,zeroFormat:B.zeroFormat,nullFormat:B.nullFormat,defaultFormat:B.defaultFormat,scalePercentBy100:B.scalePercentBy100};function Y(G,K){this._input=G,this._value=K}return d=function(G){var K,fe,Ee,Ce;if(d.isNumeral(G))K=G.value();else if(G===0||typeof G>"u")K=0;else if(G===null||g.isNaN(G))K=null;else if(typeof G=="string")if(F.zeroFormat&&G===F.zeroFormat)K=0;else if(F.nullFormat&&G===F.nullFormat||!G.replace(/[^0-9]+/g,"").length)K=null;else{for(fe in C)if(Ce=typeof C[fe].regexps.unformat=="function"?C[fe].regexps.unformat():C[fe].regexps.unformat,Ce&&G.match(Ce)){Ee=C[fe].unformat;break}Ee=Ee||d._.stringToNumber,K=Ee(G)}else K=Number(G)||null;return new Y(G,K)},d.version=M,d.isNumeral=function(G){return G instanceof Y},d._=g={numberToFormat:function(G,K,fe){var Ee=b[d.options.currentLocale],Ce=!1,Oe=!1,ue=0,Ne="",jt=1e12,_t=1e9,Et=1e6,je=1e3,Le="",tt=!1,Ze,ti,ii,$t,Mt,Ft,si;if(G=G||0,ti=Math.abs(G),d._.includes(K,"(")?(Ce=!0,K=K.replace(/[\(|\)]/g,"")):(d._.includes(K,"+")||d._.includes(K,"-"))&&(Mt=d._.includes(K,"+")?K.indexOf("+"):G<0?K.indexOf("-"):-1,K=K.replace(/[\+|\-]/g,"")),d._.includes(K,"a")&&(Ze=K.match(/a(k|m|b|t)?/),Ze=Ze?Ze[1]:!1,d._.includes(K," a")&&(Ne=" "),K=K.replace(new RegExp(Ne+"a[kmbt]?"),""),ti>=jt&&!Ze||Ze==="t"?(Ne+=Ee.abbreviations.trillion,G=G/jt):ti<jt&&ti>=_t&&!Ze||Ze==="b"?(Ne+=Ee.abbreviations.billion,G=G/_t):ti<_t&&ti>=Et&&!Ze||Ze==="m"?(Ne+=Ee.abbreviations.million,G=G/Et):(ti<Et&&ti>=je&&!Ze||Ze==="k")&&(Ne+=Ee.abbreviations.thousand,G=G/je)),d._.includes(K,"[.]")&&(Oe=!0,K=K.replace("[.]",".")),ii=G.toString().split(".")[0],$t=K.split(".")[1],Ft=K.indexOf(","),ue=(K.split(".")[0].split(",")[0].match(/0/g)||[]).length,$t?(d._.includes($t,"[")?($t=$t.replace("]",""),$t=$t.split("["),Le=d._.toFixed(G,$t[0].length+$t[1].length,fe,$t[1].length)):Le=d._.toFixed(G,$t.length,fe),ii=Le.split(".")[0],d._.includes(Le,".")?Le=Ee.delimiters.decimal+Le.split(".")[1]:Le="",Oe&&Number(Le.slice(1))===0&&(Le="")):ii=d._.toFixed(G,0,fe),Ne&&!Ze&&Number(ii)>=1e3&&Ne!==Ee.abbreviations.trillion)switch(ii=String(Number(ii)/1e3),Ne){case Ee.abbreviations.thousand:Ne=Ee.abbreviations.million;break;case Ee.abbreviations.million:Ne=Ee.abbreviations.billion;break;case Ee.abbreviations.billion:Ne=Ee.abbreviations.trillion;break}if(d._.includes(ii,"-")&&(ii=ii.slice(1),tt=!0),ii.length<ue)for(var Ut=ue-ii.length;Ut>0;Ut--)ii="0"+ii;return Ft>-1&&(ii=ii.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+Ee.delimiters.thousands)),K.indexOf(".")===0&&(ii=""),si=ii+Le+(Ne||""),Ce?si=(Ce&&tt?"(":"")+si+(Ce&&tt?")":""):Mt>=0?si=Mt===0?(tt?"-":"+")+si:si+(tt?"-":"+"):tt&&(si="-"+si),si},stringToNumber:function(G){var K=b[F.currentLocale],fe=G,Ee={thousand:3,million:6,billion:9,trillion:12},Ce,Oe,ue;if(F.zeroFormat&&G===F.zeroFormat)Oe=0;else if(F.nullFormat&&G===F.nullFormat||!G.replace(/[^0-9]+/g,"").length)Oe=null;else{Oe=1,K.delimiters.decimal!=="."&&(G=G.replace(/\./g,"").replace(K.delimiters.decimal,"."));for(Ce in Ee)if(ue=new RegExp("[^a-zA-Z]"+K.abbreviations[Ce]+"(?:\\)|(\\"+K.currency.symbol+")?(?:\\))?)?$"),fe.match(ue)){Oe*=Math.pow(10,Ee[Ce]);break}Oe*=(G.split("-").length+Math.min(G.split("(").length-1,G.split(")").length-1))%2?1:-1,G=G.replace(/[^0-9\.]+/g,""),Oe*=Number(G)}return Oe},isNaN:function(G){return typeof G=="number"&&isNaN(G)},includes:function(G,K){return G.indexOf(K)!==-1},insert:function(G,K,fe){return G.slice(0,fe)+K+G.slice(fe)},reduce:function(G,K){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof K!="function")throw new TypeError(K+" is not a function");var fe=Object(G),Ee=fe.length>>>0,Ce=0,Oe;if(arguments.length===3)Oe=arguments[2];else{for(;Ce<Ee&&!(Ce in fe);)Ce++;if(Ce>=Ee)throw new TypeError("Reduce of empty array with no initial value");Oe=fe[Ce++]}for(;Ce<Ee;Ce++)Ce in fe&&(Oe=K(Oe,fe[Ce],Ce,fe));return Oe},multiplier:function(G){var K=G.toString().split(".");return K.length<2?1:Math.pow(10,K[1].length)},correctionFactor:function(){var G=Array.prototype.slice.call(arguments);return G.reduce(function(K,fe){var Ee=g.multiplier(fe);return K>Ee?K:Ee},1)},toFixed:function(G,K,fe,Ee){var Ce=G.toString().split("."),Oe=K-(Ee||0),ue,Ne,jt,_t;return Ce.length===2?ue=Math.min(Math.max(Ce[1].length,Oe),K):ue=Oe,jt=Math.pow(10,ue),_t=(fe(G+"e+"+ue)/jt).toFixed(ue),Ee>K-ue&&(Ne=new RegExp("\\.?0{1,"+(Ee-(K-ue))+"}$"),_t=_t.replace(Ne,"")),_t}},d.options=F,d.formats=C,d.locales=b,d.locale=function(G){return G&&(F.currentLocale=G.toLowerCase()),F.currentLocale},d.localeData=function(G){if(!G)return b[F.currentLocale];if(G=G.toLowerCase(),!b[G])throw new Error("Unknown locale : "+G);return b[G]},d.reset=function(){for(var G in B)F[G]=B[G]},d.zeroFormat=function(G){F.zeroFormat=typeof G=="string"?G:null},d.nullFormat=function(G){F.nullFormat=typeof G=="string"?G:null},d.defaultFormat=function(G){F.defaultFormat=typeof G=="string"?G:"0.0"},d.register=function(G,K,fe){if(K=K.toLowerCase(),this[G+"s"][K])throw new TypeError(K+" "+G+" already registered.");return this[G+"s"][K]=fe,fe},d.validate=function(G,K){var fe,Ee,Ce,Oe,ue,Ne,jt,_t;if(typeof G!="string"&&(G+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",G)),G=G.trim(),G.match(/^\d+$/))return!0;if(G==="")return!1;try{jt=d.localeData(K)}catch{jt=d.localeData(d.locale())}return Ce=jt.currency.symbol,ue=jt.abbreviations,fe=jt.delimiters.decimal,jt.delimiters.thousands==="."?Ee="\\.":Ee=jt.delimiters.thousands,_t=G.match(/^[^\d]+/),_t!==null&&(G=G.substr(1),_t[0]!==Ce)||(_t=G.match(/[^\d]+$/),_t!==null&&(G=G.slice(0,-1),_t[0]!==ue.thousand&&_t[0]!==ue.million&&_t[0]!==ue.billion&&_t[0]!==ue.trillion))?!1:(Ne=new RegExp(Ee+"{2}"),G.match(/[^\d.,]/g)?!1:(Oe=G.split(fe),Oe.length>2?!1:Oe.length<2?!!Oe[0].match(/^\d+.*\d$/)&&!Oe[0].match(Ne):Oe[0].length===1?!!Oe[0].match(/^\d+$/)&&!Oe[0].match(Ne)&&!!Oe[1].match(/^\d+$/):!!Oe[0].match(/^\d+.*\d$/)&&!Oe[0].match(Ne)&&!!Oe[1].match(/^\d+$/)))},d.fn=Y.prototype={clone:function(){return d(this)},format:function(G,K){var fe=this._value,Ee=G||F.defaultFormat,Ce,Oe,ue;if(K=K||Math.round,fe===0&&F.zeroFormat!==null)Oe=F.zeroFormat;else if(fe===null&&F.nullFormat!==null)Oe=F.nullFormat;else{for(Ce in C)if(Ee.match(C[Ce].regexps.format)){ue=C[Ce].format;break}ue=ue||d._.numberToFormat,Oe=ue(fe,Ee,K)}return Oe},value:function(){return this._value},input:function(){return this._input},set:function(G){return this._value=Number(G),this},add:function(G){var K=g.correctionFactor.call(null,this._value,G);function fe(Ee,Ce,Oe,ue){return Ee+Math.round(K*Ce)}return this._value=g.reduce([this._value,G],fe,0)/K,this},subtract:function(G){var K=g.correctionFactor.call(null,this._value,G);function fe(Ee,Ce,Oe,ue){return Ee-Math.round(K*Ce)}return this._value=g.reduce([G],fe,Math.round(this._value*K))/K,this},multiply:function(G){function K(fe,Ee,Ce,Oe){var ue=g.correctionFactor(fe,Ee);return Math.round(fe*ue)*Math.round(Ee*ue)/Math.round(ue*ue)}return this._value=g.reduce([this._value,G],K,1),this},divide:function(G){function K(fe,Ee,Ce,Oe){var ue=g.correctionFactor(fe,Ee);return Math.round(fe*ue)/Math.round(Ee*ue)}return this._value=g.reduce([this._value,G],K),this},difference:function(G){return Math.abs(d(this._value).subtract(G).value())}},d.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(G){var K=G%10;return~~(G%100/10)===1?"th":K===1?"st":K===2?"nd":K===3?"rd":"th"},currency:{symbol:"$"}}),function(){d.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(G,K,fe){var Ee=d._.includes(K," BPS")?" ":"",Ce;return G=G*1e4,K=K.replace(/\s?BPS/,""),Ce=d._.numberToFormat(G,K,fe),d._.includes(Ce,")")?(Ce=Ce.split(""),Ce.splice(-1,0,Ee+"BPS"),Ce=Ce.join("")):Ce=Ce+Ee+"BPS",Ce},unformat:function(G){return+(d._.stringToNumber(G)*1e-4).toFixed(15)}})}(),function(){var G={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},K={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},fe=G.suffixes.concat(K.suffixes.filter(function(Ce){return G.suffixes.indexOf(Ce)<0})),Ee=fe.join("|");Ee="("+Ee.replace("B","B(?!PS)")+")",d.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(Ee)},format:function(Ce,Oe,ue){var Ne,jt=d._.includes(Oe,"ib")?K:G,_t=d._.includes(Oe," b")||d._.includes(Oe," ib")?" ":"",Et,je,Le;for(Oe=Oe.replace(/\s?i?b/,""),Et=0;Et<=jt.suffixes.length;Et++)if(je=Math.pow(jt.base,Et),Le=Math.pow(jt.base,Et+1),Ce===null||Ce===0||Ce>=je&&Ce<Le){_t+=jt.suffixes[Et],je>0&&(Ce=Ce/je);break}return Ne=d._.numberToFormat(Ce,Oe,ue),Ne+_t},unformat:function(Ce){var Oe=d._.stringToNumber(Ce),ue,Ne;if(Oe){for(ue=G.suffixes.length-1;ue>=0;ue--){if(d._.includes(Ce,G.suffixes[ue])){Ne=Math.pow(G.base,ue);break}if(d._.includes(Ce,K.suffixes[ue])){Ne=Math.pow(K.base,ue);break}}Oe*=Ne||1}return Oe}})}(),function(){d.register("format","currency",{regexps:{format:/(\$)/},format:function(G,K,fe){var Ee=d.locales[d.options.currentLocale],Ce={before:K.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:K.match(/([\+|\-|\)|\s|\$]*)$/)[0]},Oe,ue,Ne;for(K=K.replace(/\s?\$\s?/,""),Oe=d._.numberToFormat(G,K,fe),G>=0?(Ce.before=Ce.before.replace(/[\-\(]/,""),Ce.after=Ce.after.replace(/[\-\)]/,"")):G<0&&!d._.includes(Ce.before,"-")&&!d._.includes(Ce.before,"(")&&(Ce.before="-"+Ce.before),Ne=0;Ne<Ce.before.length;Ne++)switch(ue=Ce.before[Ne],ue){case"$":Oe=d._.insert(Oe,Ee.currency.symbol,Ne);break;case" ":Oe=d._.insert(Oe," ",Ne+Ee.currency.symbol.length-1);break}for(Ne=Ce.after.length-1;Ne>=0;Ne--)switch(ue=Ce.after[Ne],ue){case"$":Oe=Ne===Ce.after.length-1?Oe+Ee.currency.symbol:d._.insert(Oe,Ee.currency.symbol,-(Ce.after.length-(1+Ne)));break;case" ":Oe=Ne===Ce.after.length-1?Oe+" ":d._.insert(Oe," ",-(Ce.after.length-(1+Ne)+Ee.currency.symbol.length-1));break}return Oe}})}(),function(){d.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(G,K,fe){var Ee,Ce=typeof G=="number"&&!d._.isNaN(G)?G.toExponential():"0e+0",Oe=Ce.split("e");return K=K.replace(/e[\+|\-]{1}0/,""),Ee=d._.numberToFormat(Number(Oe[0]),K,fe),Ee+"e"+Oe[1]},unformat:function(G){var K=d._.includes(G,"e+")?G.split("e+"):G.split("e-"),fe=Number(K[0]),Ee=Number(K[1]);Ee=d._.includes(G,"e-")?Ee*=-1:Ee;function Ce(Oe,ue,Ne,jt){var _t=d._.correctionFactor(Oe,ue),Et=Oe*_t*(ue*_t)/(_t*_t);return Et}return d._.reduce([fe,Math.pow(10,Ee)],Ce,1)}})}(),function(){d.register("format","ordinal",{regexps:{format:/(o)/},format:function(G,K,fe){var Ee=d.locales[d.options.currentLocale],Ce,Oe=d._.includes(K," o")?" ":"";return K=K.replace(/\s?o/,""),Oe+=Ee.ordinal(G),Ce=d._.numberToFormat(G,K,fe),Ce+Oe}})}(),function(){d.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(G,K,fe){var Ee=d._.includes(K," %")?" ":"",Ce;return d.options.scalePercentBy100&&(G=G*100),K=K.replace(/\s?\%/,""),Ce=d._.numberToFormat(G,K,fe),d._.includes(Ce,")")?(Ce=Ce.split(""),Ce.splice(-1,0,Ee+"%"),Ce=Ce.join("")):Ce=Ce+Ee+"%",Ce},unformat:function(G){var K=d._.stringToNumber(G);return d.options.scalePercentBy100?K*.01:K}})}(),function(){d.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(G,K,fe){var Ee=Math.floor(G/60/60),Ce=Math.floor((G-Ee*60*60)/60),Oe=Math.round(G-Ee*60*60-Ce*60);return Ee+":"+(Ce<10?"0"+Ce:Ce)+":"+(Oe<10?"0"+Oe:Oe)},unformat:function(G){var K=G.split(":"),fe=0;return K.length===3?(fe=fe+Number(K[0])*60*60,fe=fe+Number(K[1])*60,fe=fe+Number(K[2])):K.length===2&&(fe=fe+Number(K[0])*60,fe=fe+Number(K[1])),Number(fe)}})}(),d})})(HL);var Ace=HL.exports;const kce={name:"Numeral",emits:["on-change"],props:{value:{type:[String,Number]},format:{type:String},prefix:{type:[String,Number]},suffix:{type:[String,Number]}},data(){return{currentValue:""}},watch:{value(){this.init()},format(){this.init()}},methods:{init(){if(this.value!==void 0){const c=Ace(this.value);this.format?this.currentValue=c.format(this.format):this.currentValue=c.value(),this.$emit("on-change",this.currentValue)}},getValue(){return this.currentValue}},mounted(){this.init()}},Pce={class:"ivu-numeral"};function Rce(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("span",Pce,[i.renderSlot(c.$slots,"prefix",{},()=>[i.createTextVNode(i.toDisplayString(g.prefix),1)]),i.createTextVNode(i.toDisplayString(C.currentValue),1),i.renderSlot(c.$slots,"suffix",{},()=>[i.createTextVNode(i.toDisplayString(g.suffix),1)])])}var QL=l(kce,[["render",Rce]]);const Ice="ivu-select-group",Nce={name:"OptionGroup",props:{label:{type:String,default:""}},provide(){return{OptionGroupInstance:this}},inject:["SelectInstance"],data(){return{prefixCls:Ice,hidden:!1,id:j(6),optionList:[]}},computed:{show(){return this.optionList.find(c=>c.proxy&&c.proxy.isShow)}}};function Dce(c,d,g,M,C,b){return i.withDirectives((i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass([C.prefixCls+"-wrap"])},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-title"])},i.toDisplayString(g.label),3),i.createElementVNode("ul",null,[i.createElementVNode("li",{class:i.normalizeClass([C.prefixCls]),ref:"options"},[i.renderSlot(c.$slots,"default")],2)])],2)),[[i.vShow,b.show]])}var jL=l(Nce,[["render",Dce]]);const lE="ivu-page";function Lce(c){return/^[1-9][0-9]*$/.test(c+"")}const Bce={name:"PageOption",mixins:[gn],components:{iSelect:$s,iOption:Jn},emits:["on-size","on-page"],props:{pageSizeOpts:Array,showSizer:Boolean,showElevator:Boolean,current:Number,_current:Number,pageSize:Number,allPages:Number,isSmall:Boolean,placement:String,transfer:Boolean,disabled:Boolean,eventsEnabled:Boolean},data(){return{currentPageSize:this.pageSize}},watch:{pageSize(c){this.currentPageSize=c}},computed:{size(){return this.isSmall?"small":"default"},optsClasses(){return[`${lE}-options`]},sizerClasses(){return[`${lE}-options-sizer`]},ElevatorClasses(){return[`${lE}-options-elevator`]}},methods:{changeSize(){this.$emit("on-size",this.currentPageSize)},changePage(c){let d=c.target.value.trim(),g=0;if(Lce(d)){if(d=Number(d),d!=this.current){const M=this.allPages;d>M?g=M:g=d}}else g=1;g&&(this.$emit("on-page",g),c.target.value=g)}}},$ce=["value","disabled"];function Uce(c,d,g,M,C,b){const B=i.resolveComponent("i-option"),F=i.resolveComponent("i-select");return g.showSizer||g.showElevator?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.optsClasses)},[g.showSizer?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.sizerClasses)},[i.createVNode(F,{modelValue:C.currentPageSize,"onUpdate:modelValue":d[0]||(d[0]=Y=>C.currentPageSize=Y),size:b.size,placement:g.placement,transfer:g.transfer,disabled:g.disabled,eventsEnabled:g.eventsEnabled,onOnChange:b.changeSize},{default:i.withCtx(()=>[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.pageSizeOpts,Y=>(i.openBlock(),i.createBlock(B,{key:Y,value:Y,style:{"text-align":"center"}},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(Y)+" "+i.toDisplayString(c.t("i.page.page")),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","size","placement","transfer","disabled","eventsEnabled","onOnChange"])],2)):i.createCommentVNode("",!0),g.showElevator?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass(b.ElevatorClasses)},[i.createTextVNode(i.toDisplayString(c.t("i.page.goto"))+" ",1),i.createElementVNode("input",{type:"text",value:g._current,autocomplete:"off",spellcheck:"false",disabled:g.disabled,onKeyup:d[1]||(d[1]=i.withKeys((...Y)=>b.changePage&&b.changePage(...Y),["enter"]))},null,40,$ce),i.createTextVNode(" "+i.toDisplayString(c.t("i.page.p")),1)],2)):i.createCommentVNode("",!0)],2)):i.createCommentVNode("",!0)}var Vce=l(Bce,[["render",Uce]]);const Ss="ivu-page",Fce={name:"Page",mixins:[gn],components:{Options:Vce},emits:["update:modelValue","on-change","on-prev","on-next","on-page-size-change"],props:{modelValue:{type:Number,default:1},total:{type:Number,default:0},pageSize:{type:Number,default:10},pageSizeOpts:{type:Array,default(){return[10,20,30,40]}},placement:{validator(c){return O(c,["top","bottom"])},default:"bottom"},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},size:{validator(c){return O(c,["small","default"])}},simple:{type:Boolean,default:!1},showTotal:{type:Boolean,default:!1},showElevator:{type:Boolean,default:!1},showSizer:{type:Boolean,default:!1},className:{type:String},styles:{type:Object},prevText:{type:String,default:""},nextText:{type:String,default:""},disabled:{type:Boolean,default:!1},eventsEnabled:{type:Boolean,default:!1}},data(){return{prefixCls:Ss,currentPage:this.modelValue,currentPageSize:this.pageSize}},watch:{total(c){let d=Math.ceil(c/this.currentPageSize);d<this.currentPage&&(this.currentPage=d===0?1:d)},modelValue(c){this.currentPage=c},pageSize(c){this.currentPageSize=c}},computed:{isSmall(){return this.size==="small"},allPages(){const c=Math.ceil(this.total/this.currentPageSize);return c===0?1:c},simpleWrapClasses(){return[`${Ss}`,`${Ss}-simple`,{[`${this.className}`]:!!this.className}]},simplePagerClasses(){return`${Ss}-simple-pager`},wrapClasses(){return[`${Ss}`,{[`${this.className}`]:!!this.className,[`${Ss}-with-disabled`]:this.disabled,mini:this.size==="small"}]},prevClasses(){return[`${Ss}-prev`,{[`${Ss}-disabled`]:this.currentPage===1||this.disabled,[`${Ss}-custom-text`]:this.prevText!==""}]},nextClasses(){return[`${Ss}-next`,{[`${Ss}-disabled`]:this.currentPage===this.allPages||this.disabled,[`${Ss}-custom-text`]:this.nextText!==""}]},firstPageClasses(){return[`${Ss}-item`,{[`${Ss}-item-active`]:this.currentPage===1}]},lastPageClasses(){return[`${Ss}-item`,{[`${Ss}-item-active`]:this.currentPage===this.allPages}]}},methods:{changePage(c){this.disabled||this.currentPage!=c&&(this.currentPage=c,this.$emit("update:modelValue",c),this.$emit("on-change",c))},prev(){if(this.disabled)return;const c=this.currentPage;if(c<=1)return!1;this.changePage(c-1),this.$emit("on-prev",c-1)},next(){if(this.disabled)return;const c=this.currentPage;if(c>=this.allPages)return!1;this.changePage(c+1),this.$emit("on-next",c+1)},fastPrev(){if(this.disabled)return;const c=this.currentPage-5;c>0?this.changePage(c):this.changePage(1)},fastNext(){if(this.disabled)return;const c=this.currentPage+5;c>this.allPages?this.changePage(this.allPages):this.changePage(c)},onSize(c){this.disabled||(this.currentPageSize=c,this.$emit("on-page-size-change",c),this.changePage(1))},onPage(c){this.disabled||this.changePage(c)},keyDown(c){const d=c.keyCode;d>=48&&d<=57||d>=96&&d<=105||d===8||d===37||d===39||c.preventDefault()},keyUp(c){const d=c.keyCode,g=parseInt(c.target.value);if(d===38)this.prev();else if(d===40)this.next();else if(d===13){let M=1;g>this.allPages?M=this.allPages:g<=0||!g?M=1:M=g,c.target.value=M,this.changePage(M)}}}},zce=["title"],Xce=[i.createElementVNode("a",null,[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-back"})],-1)],Wce=["title"],Gce=["value","disabled"],Hce=i.createElementVNode("span",null,"/",-1),Qce=["title"],jce=[i.createElementVNode("a",null,[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-forward"})],-1)],Yce=["title"],qce={key:1,class:"ivu-icon ivu-icon-ios-arrow-back"},Zce=[i.createElementVNode("a",null,"1",-1)],Kce=["title"],Jce=[i.createElementVNode("a",null,[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-back"}),i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-more"})],-1)],ehe=["title"],the=["title"],ihe=["title"],nhe=["title"],rhe=["title"],she=["title"],ohe=["title"],ahe=["title"],lhe=[i.createElementVNode("a",null,[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-forward"}),i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-more"})],-1)],che=["title"],hhe=["title"],uhe={key:1,class:"ivu-icon ivu-icon-ios-arrow-forward"};function dhe(c,d,g,M,C,b){const B=i.resolveComponent("Options");return g.simple?(i.openBlock(),i.createElementBlock("ul",{key:0,class:i.normalizeClass(b.simpleWrapClasses),style:i.normalizeStyle(g.styles)},[i.createElementVNode("li",{title:c.t("i.page.prev"),class:i.normalizeClass(b.prevClasses),onClick:d[0]||(d[0]=(...F)=>b.prev&&b.prev(...F))},Xce,10,zce),i.createElementVNode("div",{class:i.normalizeClass(b.simplePagerClasses),title:C.currentPage+"/"+b.allPages},[i.createElementVNode("input",{type:"text",value:C.currentPage,autocomplete:"off",spellcheck:"false",disabled:g.disabled,onKeydown:d[1]||(d[1]=(...F)=>b.keyDown&&b.keyDown(...F)),onKeyup:d[2]||(d[2]=(...F)=>b.keyUp&&b.keyUp(...F)),onChange:d[3]||(d[3]=(...F)=>b.keyUp&&b.keyUp(...F))},null,40,Gce),Hce,i.createTextVNode(" "+i.toDisplayString(b.allPages),1)],10,Wce),i.createElementVNode("li",{title:c.t("i.page.next"),class:i.normalizeClass(b.nextClasses),onClick:d[4]||(d[4]=(...F)=>b.next&&b.next(...F))},jce,10,Qce)],6)):(i.openBlock(),i.createElementBlock("ul",{key:1,class:i.normalizeClass(b.wrapClasses),style:i.normalizeStyle(g.styles)},[g.showTotal?(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass([C.prefixCls+"-total"])},[i.renderSlot(c.$slots,"default",{},()=>[i.createTextVNode(i.toDisplayString(c.t("i.page.total"))+" "+i.toDisplayString(g.total)+" ",1),g.total<=1?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createTextVNode(i.toDisplayString(c.t("i.page.item")),1)],64)):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createTextVNode(i.toDisplayString(c.t("i.page.items")),1)],64))])],2)):i.createCommentVNode("",!0),i.createElementVNode("li",{title:c.t("i.page.prev"),class:i.normalizeClass(b.prevClasses),onClick:d[5]||(d[5]=(...F)=>b.prev&&b.prev(...F))},[i.createElementVNode("a",null,[g.prevText!==""?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createTextVNode(i.toDisplayString(g.prevText),1)],64)):(i.openBlock(),i.createElementBlock("i",qce))])],10,Yce),i.createElementVNode("li",{title:"1",class:i.normalizeClass(b.firstPageClasses),onClick:d[6]||(d[6]=F=>b.changePage(1))},Zce,2),C.currentPage>5?(i.openBlock(),i.createElementBlock("li",{key:1,title:c.t("i.page.prev5"),class:i.normalizeClass([C.prefixCls+"-item-jump-prev"]),onClick:d[7]||(d[7]=(...F)=>b.fastPrev&&b.fastPrev(...F))},Jce,10,Kce)):i.createCommentVNode("",!0),C.currentPage===5?(i.openBlock(),i.createElementBlock("li",{key:2,title:C.currentPage-3,class:i.normalizeClass([C.prefixCls+"-item"]),onClick:d[8]||(d[8]=F=>b.changePage(C.currentPage-3))},[i.createElementVNode("a",null,i.toDisplayString(C.currentPage-3),1)],10,ehe)):i.createCommentVNode("",!0),C.currentPage-2>1?(i.openBlock(),i.createElementBlock("li",{key:3,title:C.currentPage-2,class:i.normalizeClass([C.prefixCls+"-item"]),onClick:d[9]||(d[9]=F=>b.changePage(C.currentPage-2))},[i.createElementVNode("a",null,i.toDisplayString(C.currentPage-2),1)],10,the)):i.createCommentVNode("",!0),C.currentPage-1>1?(i.openBlock(),i.createElementBlock("li",{key:4,title:C.currentPage-1,class:i.normalizeClass([C.prefixCls+"-item"]),onClick:d[10]||(d[10]=F=>b.changePage(C.currentPage-1))},[i.createElementVNode("a",null,i.toDisplayString(C.currentPage-1),1)],10,ihe)):i.createCommentVNode("",!0),C.currentPage!=1&&C.currentPage!=b.allPages?(i.openBlock(),i.createElementBlock("li",{key:5,title:C.currentPage,class:i.normalizeClass([C.prefixCls+"-item",C.prefixCls+"-item-active"])},[i.createElementVNode("a",null,i.toDisplayString(C.currentPage),1)],10,nhe)):i.createCommentVNode("",!0),C.currentPage+1<b.allPages?(i.openBlock(),i.createElementBlock("li",{key:6,title:C.currentPage+1,class:i.normalizeClass([C.prefixCls+"-item"]),onClick:d[11]||(d[11]=F=>b.changePage(C.currentPage+1))},[i.createElementVNode("a",null,i.toDisplayString(C.currentPage+1),1)],10,rhe)):i.createCommentVNode("",!0),C.currentPage+2<b.allPages?(i.openBlock(),i.createElementBlock("li",{key:7,title:C.currentPage+2,class:i.normalizeClass([C.prefixCls+"-item"]),onClick:d[12]||(d[12]=F=>b.changePage(C.currentPage+2))},[i.createElementVNode("a",null,i.toDisplayString(C.currentPage+2),1)],10,she)):i.createCommentVNode("",!0),b.allPages-C.currentPage===4?(i.openBlock(),i.createElementBlock("li",{key:8,title:C.currentPage+3,class:i.normalizeClass([C.prefixCls+"-item"]),onClick:d[13]||(d[13]=F=>b.changePage(C.currentPage+3))},[i.createElementVNode("a",null,i.toDisplayString(C.currentPage+3),1)],10,ohe)):i.createCommentVNode("",!0),b.allPages-C.currentPage>=5?(i.openBlock(),i.createElementBlock("li",{key:9,title:c.t("i.page.next5"),class:i.normalizeClass([C.prefixCls+"-item-jump-next"]),onClick:d[14]||(d[14]=(...F)=>b.fastNext&&b.fastNext(...F))},lhe,10,ahe)):i.createCommentVNode("",!0),b.allPages>1?(i.openBlock(),i.createElementBlock("li",{key:10,title:b.allPages,class:i.normalizeClass(b.lastPageClasses),onClick:d[15]||(d[15]=F=>b.changePage(b.allPages))},[i.createElementVNode("a",null,i.toDisplayString(b.allPages),1)],10,che)):i.createCommentVNode("",!0),i.createElementVNode("li",{title:c.t("i.page.next"),class:i.normalizeClass(b.nextClasses),onClick:d[16]||(d[16]=(...F)=>b.next&&b.next(...F))},[i.createElementVNode("a",null,[g.nextText!==""?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createTextVNode(i.toDisplayString(g.nextText),1)],64)):(i.openBlock(),i.createElementBlock("i",uhe))])],10,hhe),i.createVNode(B,{"show-sizer":g.showSizer,"page-size":C.currentPageSize,"page-size-opts":g.pageSizeOpts,placement:g.placement,transfer:g.transfer,"show-elevator":g.showElevator,_current:C.currentPage,current:C.currentPage,disabled:g.disabled,"all-pages":b.allPages,"is-small":b.isSmall,eventsEnabled:g.eventsEnabled,onOnSize:b.onSize,onOnPage:b.onPage},null,8,["show-sizer","page-size","page-size-opts","placement","transfer","show-elevator","_current","current","disabled","all-pages","is-small","eventsEnabled","onOnSize","onOnPage"])],6))}var YL=l(Fce,[["render",dhe]]);const fhe={name:"PageHeader",components:{Breadcrumb:vT,BreadcrumbItem:yT,Divider:Dx,Icon:S,Tabs:Yx,TabPane:Zx},emits:["on-tab-change","on-back"],props:{title:{type:String},back:{type:Boolean,default:!1},logo:{type:String},action:{type:String},content:{type:String},extra:{type:String},breadcrumbList:{type:Array},hiddenBreadcrumb:{type:Boolean,default:!1},tabList:{type:Array},tabActiveKey:{type:String},wide:{type:Boolean,default:!1}},computed:{classes(){return{"ivu-page-header-wide":this.wide}}},methods:{handleTabChange(c){const d=this.tabList.find(g=>g.name===c);this.$emit("on-tab-change",JSON.parse(JSON.stringify(d)))},handleBack(){this.$emit("on-back")}}},phe={key:0,class:"ivu-page-header-breadcrumb"},mhe={class:"ivu-page-header-detail"},ghe={key:1,class:"ivu-page-header-logo"},vhe=["src"],yhe={class:"ivu-page-header-main"},bhe={class:"ivu-page-header-row"},xhe={key:1,class:"ivu-page-header-title"},whe={key:2,class:"ivu-page-header-action"},_he={class:"ivu-page-header-row"},Ohe={key:0,class:"ivu-page-header-content"},She={key:1,class:"ivu-page-header-extra"},Che={key:1,class:"ivu-page-header-tabs"};function The(c,d,g,M,C,b){const B=i.resolveComponent("BreadcrumbItem"),F=i.resolveComponent("Breadcrumb"),Y=i.resolveComponent("Icon"),G=i.resolveComponent("Divider"),K=i.resolveComponent("TabPane"),fe=i.resolveComponent("Tabs");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["ivu-page-header",b.classes])},[c.$slots.breadcrumb||!g.hiddenBreadcrumb?(i.openBlock(),i.createElementBlock("div",phe,[i.renderSlot(c.$slots,"breadcrumb",{},()=>[i.createVNode(F,null,{default:i.withCtx(()=>[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.breadcrumbList,(Ee,Ce)=>(i.openBlock(),i.createBlock(B,{key:Ce,to:Ee.to,replace:Ee.replace,target:Ee.target},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(Ee.title),1)]),_:2},1032,["to","replace","target"]))),128))]),_:1})])])):i.createCommentVNode("",!0),i.createElementVNode("div",mhe,[g.back||c.$slots.back?(i.openBlock(),i.createElementBlock("div",{key:0,class:"ivu-page-header-back",onClick:d[0]||(d[0]=(...Ee)=>b.handleBack&&b.handleBack(...Ee))},[i.renderSlot(c.$slots,"back",{},()=>[i.createVNode(Y,{type:"md-arrow-back"})]),i.createVNode(G,{type:"vertical"})])):i.createCommentVNode("",!0),g.logo||c.$slots.logo?(i.openBlock(),i.createElementBlock("div",ghe,[i.renderSlot(c.$slots,"logo",{},()=>[i.createElementVNode("img",{src:g.logo},null,8,vhe)])])):i.createCommentVNode("",!0),i.createElementVNode("div",yhe,[i.createElementVNode("div",bhe,[g.back||c.$slots.back?(i.openBlock(),i.createElementBlock("div",{key:0,class:"ivu-page-header-back",onClick:d[1]||(d[1]=(...Ee)=>b.handleBack&&b.handleBack(...Ee))},[i.renderSlot(c.$slots,"back",{},()=>[i.createVNode(Y,{type:"md-arrow-back"})]),i.createVNode(G,{type:"vertical"})])):i.createCommentVNode("",!0),g.title||c.$slots.title?(i.openBlock(),i.createElementBlock("div",xhe,[i.renderSlot(c.$slots,"title",{},()=>[i.createTextVNode(i.toDisplayString(g.title),1)])])):i.createCommentVNode("",!0),g.action||c.$slots.action?(i.openBlock(),i.createElementBlock("div",whe,[i.renderSlot(c.$slots,"action",{},()=>[i.createTextVNode(i.toDisplayString(g.action),1)])])):i.createCommentVNode("",!0)]),i.createElementVNode("div",_he,[g.content||c.$slots.content?(i.openBlock(),i.createElementBlock("div",Ohe,[i.renderSlot(c.$slots,"content",{},()=>[i.createTextVNode(i.toDisplayString(g.content),1)])])):i.createCommentVNode("",!0),g.extra||c.$slots.extra?(i.openBlock(),i.createElementBlock("div",She,[i.renderSlot(c.$slots,"extra",{},()=>[i.createTextVNode(i.toDisplayString(g.extra),1)])])):i.createCommentVNode("",!0)])])]),g.tabList&&g.tabList.length?(i.openBlock(),i.createElementBlock("div",Che,[i.createVNode(fe,{animated:!1,"model-value":g.tabActiveKey,onOnClick:b.handleTabChange},{default:i.withCtx(()=>[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.tabList,(Ee,Ce)=>(i.openBlock(),i.createBlock(K,{key:Ce,label:Ee.label,name:Ee.name},null,8,["label","name"]))),128))]),_:1},8,["model-value","onOnClick"])])):i.createCommentVNode("",!0)],2)}var qL=l(fhe,[["render",The]]);const Ehe=i.defineComponent({name:"CollapseTransition",props:{ready:{type:Boolean,default:!0}},setup(c){return{on:{beforeEnter(d){!c.ready||(H(d,"collapse-transition"),d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.style.height="0",d.style.paddingTop=0,d.style.paddingBottom=0)},enter(d){!c.ready||(d.dataset.oldOverflow=d.style.overflow,d.scrollHeight!==0?(d.style.height=d.scrollHeight+"px",d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom):(d.style.height="",d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom),d.style.overflow="hidden")},afterEnter(d){!c.ready||(J(d,"collapse-transition"),d.style.height="",d.style.overflow=d.dataset.oldOverflow)},beforeLeave(d){!c.ready||(d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.dataset.oldOverflow=d.style.overflow,d.style.height=d.scrollHeight+"px",d.style.overflow="hidden")},leave(d){!c.ready||d.scrollHeight!==0&&(H(d,"collapse-transition"),d.style.height=0,d.style.paddingTop=0,d.style.paddingBottom=0)},afterLeave(d){!c.ready||(J(d,"collapse-transition"),d.style.height="",d.style.overflow=d.dataset.oldOverflow,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom)}}}}});function Mhe(c,d,g,M,C,b){return i.openBlock(),i.createBlock(i.Transition,i.toHandlers(c.on),{default:i.withCtx(()=>[i.renderSlot(c.$slots,"default")]),_:3},16)}var cE=l(Ehe,[["render",Mhe]]);const ev="ivu-collapse",Ahe={name:"Panel",components:{Icon:S,CollapseTransition:cE},inject:["CollapseInstance"],props:{name:{type:String},hideArrow:{type:Boolean,default:!1}},data(){return{index:0,mounted:!1}},computed:{itemClasses(){return[`${ev}-item`,{[`${ev}-item-active`]:this.isActive}]},headerClasses(){return`${ev}-header`},contentClasses(){return`${ev}-content`},boxClasses(){return`${ev}-content-box`},isActive(){const c=this.CollapseInstance.getActiveKey(),d=this.name||this.index.toString();return c.indexOf(d)>-1}},methods:{setIndex(){this.index=this.CollapseInstance.panelCount+1,this.CollapseInstance.panelCount=this.index},toggle(){this.CollapseInstance.toggle({name:this.name||this.index,isActive:this.isActive})}},mounted(){this.setIndex(),this.mounted=!0}};function khe(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("collapse-transition");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.itemClasses)},[i.createElementVNode("div",{class:i.normalizeClass(b.headerClasses),onClick:d[0]||(d[0]=(...Y)=>b.toggle&&b.toggle(...Y))},[g.hideArrow?i.createCommentVNode("",!0):(i.openBlock(),i.createBlock(B,{key:0,type:"ios-arrow-forward"})),i.renderSlot(c.$slots,"default")],2),C.mounted?(i.openBlock(),i.createBlock(F,{key:0},{default:i.withCtx(()=>[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass(b.contentClasses)},[i.createElementVNode("div",{class:i.normalizeClass(b.boxClasses)},[i.renderSlot(c.$slots,"content")],2)],2),[[i.vShow,b.isActive]])]),_:3})):i.createCommentVNode("",!0)],2)}var ZL=l(Ahe,[["render",khe]]);const KL={name:"Paragraph",mixins:[G0],render(){return i.h(Gx,{...this.$props,component:"div",...this.commonEvents()},this.commonSlots())}},JL={name:"Password",mixins:[P0],data(){return{className:"ivu-login-password",prefix:"ios-lock-outline",placeholder:"请输入密码",type:"password"}}},Hh="ivu-poptip",Phe={name:"Poptip",mixins:[aN,gn],emits:["on-ok","on-cancel"],directives:{clickOutside:MT},components:{iButton:Us},props:{trigger:{validator(c){return O(c,["click","focus","hover"])},default:"click"},placement:{validator(c){return O(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"top"},title:{type:[String,Number]},content:{type:[String,Number],default:""},width:{type:[String,Number]},confirm:{type:Boolean,default:!1},okText:{type:String},cancelText:{type:String},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},popperClass:{type:String},wordWrap:{type:Boolean,default:!1},padding:{type:String},disabled:{type:Boolean,default:!1},capture:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!1}},transferClassName:{type:String}},data(){return{prefixCls:Hh,showTitle:!0,isInput:!1,disableCloseUnderTransfer:!1,tIndex:this.handleGetIndex()}},computed:{classes(){return[`${Hh}`,{[`${Hh}-confirm`]:this.confirm}]},popperClasses(){return[`${Hh}-popper`,{[`${Hh}-confirm`]:this.transfer&&this.confirm,[`${this.popperClass}`]:!!this.popperClass,[Hh+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}]},styles(){let c={};return this.width&&(c.width=`${this.width}px`),this.transfer&&(c["z-index"]=1060+this.tIndex),c},localeOkText(){return this.okText===void 0?this.t("i.poptip.okText"):this.okText},localeCancelText(){return this.cancelText===void 0?this.t("i.poptip.cancelText"):this.cancelText},contentClasses(){return[`${Hh}-body-content`,{[`${Hh}-body-content-word-wrap`]:this.wordWrap}]},contentPaddingStyle(){const c={};return this.padding!==""&&(c.padding=this.padding),c}},methods:{handleClick(){if(!this.disabled){if(this.confirm)return this.visible=!this.visible,!0;if(this.trigger!=="click")return!1;this.visible=!this.visible}},handleTransferClick(){this.transfer&&(this.disableCloseUnderTransfer=!0)},handleClose(){if(this.disableCloseUnderTransfer)return this.disableCloseUnderTransfer=!1,!1;if(this.confirm)return this.visible=!1,!0;if(this.trigger!=="click")return!1;this.visible=!1},handleFocus(c=!0){if(!this.disabled){if(this.trigger!=="focus"||this.confirm||this.isInput&&!c)return!1;this.visible=!0}},handleBlur(c=!0){if(this.trigger!=="focus"||this.confirm||this.isInput&&!c)return!1;this.visible=!1},handleMouseenter(){if(!this.disabled){if(this.trigger!=="hover"||this.confirm)return!1;this.enterTimer&&clearTimeout(this.enterTimer),this.enterTimer=setTimeout(()=>{this.visible=!0},100)}},handleMouseleave(){if(this.trigger!=="hover"||this.confirm)return!1;this.enterTimer&&(clearTimeout(this.enterTimer),this.enterTimer=setTimeout(()=>{this.visible=!1},100))},cancel(){this.visible=!1,this.$emit("on-cancel")},ok(){this.visible=!1,this.$emit("on-ok")},getInputChildren(){const c=this.$refs.reference.querySelectorAll("input"),d=this.$refs.reference.querySelectorAll("textarea");let g=null;return c.length?g=c[0]:d.length&&(g=d[0]),g},handleGetIndex(){return He(),Te},handleIndexIncrease(){this.tIndex=this.handleGetIndex()}},mounted(){this.confirm||(this.showTitle=this.$slots.title!==void 0||this.title),this.trigger==="focus"&&i.nextTick(()=>{const c=this.getInputChildren();c&&(this.isInput=!0,c.addEventListener("focus",this.handleFocus,!1),c.addEventListener("blur",this.handleBlur,!1))})},beforeUnmount(){const c=this.getInputChildren();c&&(c.removeEventListener("focus",this.handleFocus,!1),c.removeEventListener("blur",this.handleBlur,!1))}},Rhe=i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-help-circle"},null,-1);function Ihe(c,d,g,M,C,b){const B=i.resolveComponent("i-button"),F=i.resolveDirective("click-outside");return i.withDirectives((i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),onMouseenter:d[6]||(d[6]=(...Y)=>b.handleMouseenter&&b.handleMouseenter(...Y)),onMouseleave:d[7]||(d[7]=(...Y)=>b.handleMouseleave&&b.handleMouseleave(...Y))},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-rel"]),ref:"reference",onClick:d[0]||(d[0]=(...Y)=>b.handleClick&&b.handleClick(...Y)),onMousedown:d[1]||(d[1]=Y=>b.handleFocus(!1)),onMouseup:d[2]||(d[2]=Y=>b.handleBlur(!1))},[i.renderSlot(c.$slots,"default")],34),(i.openBlock(),i.createBlock(i.Teleport,{to:"body",disabled:!g.transfer},[i.createVNode(i.Transition,{name:"fade"},{default:i.withCtx(()=>[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass(b.popperClasses),style:i.normalizeStyle(b.styles),ref:"popper",onClick:d[3]||(d[3]=(...Y)=>b.handleTransferClick&&b.handleTransferClick(...Y)),onMouseenter:d[4]||(d[4]=(...Y)=>b.handleMouseenter&&b.handleMouseenter(...Y)),onMouseleave:d[5]||(d[5]=(...Y)=>b.handleMouseleave&&b.handleMouseleave(...Y))},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-content"])},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-arrow"])},null,2),g.confirm?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-inner"])},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body"])},[Rhe,i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body-message"])},[i.renderSlot(c.$slots,"title",{},()=>[i.createTextVNode(i.toDisplayString(g.title),1)])],2)],2),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-footer"])},[i.createVNode(B,{type:"text",size:"small",onClick:b.cancel},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(b.localeCancelText),1)]),_:1},8,["onClick"]),i.createVNode(B,{type:"primary",size:"small",onClick:b.ok},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(b.localeOkText),1)]),_:1},8,["onClick"])],2)],2)):i.createCommentVNode("",!0),g.confirm?i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass([C.prefixCls+"-inner"])},[C.showTitle?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-title"]),style:i.normalizeStyle(b.contentPaddingStyle),ref:"title"},[i.renderSlot(c.$slots,"title",{},()=>[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-title-inner"])},i.toDisplayString(g.title),3)])],6)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body"]),style:i.normalizeStyle(b.contentPaddingStyle)},[i.createElementVNode("div",{class:i.normalizeClass(b.contentClasses)},[i.renderSlot(c.$slots,"content",{},()=>[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body-content-inner"])},i.toDisplayString(g.content),3)])],2)],6)],2))],2)],38),[[i.vShow,c.visible]])]),_:3})],8,["disabled"]))],34)),[[F,b.handleClose]])}var hE=l(Phe,[["render",Ihe]]);const Rl="ivu-progress",Nhe={name:"Progress",components:{Icon:S},props:{percent:{type:Number,default:0},successPercent:{type:Number,default:0},status:{validator(c){return O(c,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1},strokeColor:{type:[String,Array]},textInside:{type:Boolean,default:!1}},data(){return{currentStatus:this.status}},computed:{isStatus(){return this.currentStatus==="wrong"||this.currentStatus==="success"},statusIcon(){let c="";switch(this.currentStatus){case"wrong":c="ios-close-circle";break;case"success":c="ios-checkmark-circle";break}return c},bgStyle(){const c=this.vertical?{height:`${this.percent}%`,width:`${this.strokeWidth}px`}:{width:`${this.percent}%`,height:`${this.strokeWidth}px`};return this.strokeColor&&(typeof this.strokeColor=="string"?c["background-color"]=this.strokeColor:c["background-image"]=`linear-gradient(to right, ${this.strokeColor[0]} 0%, ${this.strokeColor[1]} 100%)`),c},successBgStyle(){return this.vertical?{height:`${this.successPercent}%`,width:`${this.strokeWidth}px`}:{width:`${this.successPercent}%`,height:`${this.strokeWidth}px`}},wrapClasses(){return[`${Rl}`,`${Rl}-${this.currentStatus}`,{[`${Rl}-show-info`]:!this.hideInfo&&!this.textInside,[`${Rl}-vertical`]:this.vertical}]},textClasses(){return`${Rl}-text`},textInnerClasses(){return`${Rl}-text-inner`},outerClasses(){return`${Rl}-outer`},innerClasses(){return`${Rl}-inner`},bgClasses(){return`${Rl}-bg`},successBgClasses(){return`${Rl}-success-bg`}},created(){this.handleStatus()},methods:{handleStatus(c){c?(this.currentStatus="normal",this.$emit("on-status-change","normal")):parseInt(this.percent,10)===100&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent(c,d){c<d?this.handleStatus(!0):this.handleStatus()},status(c){this.currentStatus=c}}},Dhe={key:0,class:"ivu-progress-inner-text"};function Lhe(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses)},[i.createElementVNode("div",{class:i.normalizeClass(b.outerClasses)},[i.createElementVNode("div",{class:i.normalizeClass(b.innerClasses)},[i.createElementVNode("div",{class:i.normalizeClass(b.bgClasses),style:i.normalizeStyle(b.bgStyle)},[g.textInside?(i.openBlock(),i.createElementBlock("div",Dhe,i.toDisplayString(g.percent)+"%",1)):i.createCommentVNode("",!0)],6),i.createElementVNode("div",{class:i.normalizeClass(b.successBgClasses),style:i.normalizeStyle(b.successBgStyle)},null,6)],2)],2),!g.hideInfo&&!g.textInside?(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass(b.textClasses)},[i.renderSlot(c.$slots,"default",{},()=>[b.isStatus?(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass(b.textInnerClasses)},[i.createVNode(B,{type:b.statusIcon},null,8,["type"])],2)):(i.openBlock(),i.createElementBlock("span",{key:1,class:i.normalizeClass(b.textInnerClasses)},i.toDisplayString(g.percent)+"% ",3))])],2)):i.createCommentVNode("",!0)],2)}var Kx=l(Nhe,[["render",Lhe]]);const Qh="ivu-rate",Bhe={name:"Rate",mixins:[gn,Ei],emits:["update:modelValue","on-change"],props:{count:{type:Number,default:5},modelValue:{type:Number,default:0},allowHalf:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},showText:{type:Boolean,default:!1},name:{type:String},clearable:{type:Boolean,default:!1},character:{type:String,default:""},icon:{type:String,default:""},customIcon:{type:String,default:""}},data(){const c=this.modelValue||0;return{prefixCls:Qh,hoverIndex:-1,isHover:!1,isHalf:this.allowHalf&&c.toString().indexOf(".")>=0,currentValue:c}},computed:{classes(){return[`${Qh}`,{[`${Qh}-disabled`]:this.itemDisabled}]},iconClasses(){return["ivu-icon",{[`ivu-icon-${this.icon}`]:this.icon!=="",[`${this.customIcon}`]:this.customIcon!==""}]},showCharacter(){return this.character!==""||this.icon!==""||this.customIcon!==""}},watch:{modelValue(c){this.currentValue=c||0},currentValue(c){this.setHalf(c)}},methods:{starCls(c){const d=this.hoverIndex,g=this.isHover?d:this.currentValue;let M=!1,C=!1;return g>=c&&(M=!0),this.isHover?C=g===c:C=Math.ceil(this.currentValue)===c,[{[`${Qh}-star`]:!this.showCharacter,[`${Qh}-star-chart`]:this.showCharacter,[`${Qh}-star-full`]:!C&&M||C&&!this.isHalf,[`${Qh}-star-half`]:C&&this.isHalf,[`${Qh}-star-zero`]:!M}]},handleMousemove(c,d){if(!this.itemDisabled){if(this.isHover=!0,this.allowHalf){const g=d.target.getAttribute("type")||!1;this.isHalf=g==="half"}else this.isHalf=!1;this.hoverIndex=c}},handleMouseleave(){this.itemDisabled||(this.isHover=!1,this.setHalf(this.currentValue),this.hoverIndex=-1)},setHalf(c){this.isHalf=this.allowHalf&&c.toString().indexOf(".")>=0},handleClick(c){this.itemDisabled||(this.isHalf&&(c-=.5),this.clearable&&Math.abs(c-this.currentValue)<.01&&(c=0),this.currentValue=c,this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c))}}},$he=["name","value"],Uhe=["onMousemove","onClick"],Vhe={key:0},Fhe={key:1};function zhe(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),onMouseleave:d[0]||(d[0]=(...B)=>b.handleMouseleave&&b.handleMouseleave(...B))},[i.createElementVNode("input",{type:"hidden",name:g.name,value:C.currentValue},null,8,$he),(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.count,B=>(i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.starCls(B)),onMousemove:F=>b.handleMousemove(B,F),key:B,onClick:F=>b.handleClick(B)},[b.showCharacter?(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createElementVNode("span",{class:i.normalizeClass([C.prefixCls+"-star-first"]),type:"half"},[g.character!==""?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createTextVNode(i.toDisplayString(g.character),1)],64)):(i.openBlock(),i.createElementBlock("i",{key:1,class:i.normalizeClass(b.iconClasses),type:"half"},null,2))],2),i.createElementVNode("span",{class:i.normalizeClass([C.prefixCls+"-star-second"])},[g.character!==""?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createTextVNode(i.toDisplayString(g.character),1)],64)):(i.openBlock(),i.createElementBlock("i",{key:1,class:i.normalizeClass(b.iconClasses)},null,2))],2)],64)):(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass([C.prefixCls+"-star-content"]),type:"half"},null,2))],42,Uhe))),128)),g.showText?i.withDirectives((i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-text"])},[i.renderSlot(c.$slots,"default",{},()=>[i.createElementVNode("span",null,i.toDisplayString(C.currentValue),1),i.createTextVNode(),C.currentValue<=1?(i.openBlock(),i.createElementBlock("span",Vhe,i.toDisplayString(c.t("i.rate.star")),1)):(i.openBlock(),i.createElementBlock("span",Fhe,i.toDisplayString(c.t("i.rate.stars")),1))])],2)),[[i.vShow,C.currentValue>0]]):i.createCommentVNode("",!0)],34)}var eB=l(Bhe,[["render",zhe]]);const Xhe={name:"Result",components:{Icon:S},props:{type:{validator(c){return O(c,["success","error","warning"])}},title:{type:String},desc:{type:String},extra:{type:String}},computed:{iconClasses(){return{"ivu-result-icon-success":this.type==="success","ivu-result-icon-error":this.type==="error","ivu-result-icon-warning":this.type==="warning"}}}},Whe={class:"ivu-result"},Ghe={key:0,class:"ivu-result-title"},Hhe={key:1,class:"ivu-result-desc"},Qhe={key:2,class:"ivu-result-extra"},jhe={key:3,class:"ivu-result-actions"};function Yhe(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("div",Whe,[i.createElementVNode("div",{class:i.normalizeClass(["ivu-result-icon",b.iconClasses])},[g.type==="success"?(i.openBlock(),i.createBlock(B,{key:0,type:"ios-checkmark"})):i.createCommentVNode("",!0),g.type==="error"?(i.openBlock(),i.createBlock(B,{key:1,type:"ios-close"})):i.createCommentVNode("",!0),g.type==="warning"?(i.openBlock(),i.createBlock(B,{key:2,type:"ios-information"})):i.createCommentVNode("",!0)],2),g.title||c.$slots.title?(i.openBlock(),i.createElementBlock("div",Ghe,[i.renderSlot(c.$slots,"title",{},()=>[i.createTextVNode(i.toDisplayString(g.title),1)])])):i.createCommentVNode("",!0),g.desc||c.$slots.desc?(i.openBlock(),i.createElementBlock("div",Hhe,[i.renderSlot(c.$slots,"desc",{},()=>[i.createTextVNode(i.toDisplayString(g.desc),1)])])):i.createCommentVNode("",!0),g.extra||c.$slots.extra?(i.openBlock(),i.createElementBlock("div",Qhe,[i.renderSlot(c.$slots,"extra",{},()=>[i.createTextVNode(i.toDisplayString(g.extra),1)])])):i.createCommentVNode("",!0),c.$slots.actions?(i.openBlock(),i.createElementBlock("div",jhe,[i.renderSlot(c.$slots,"actions")])):i.createCommentVNode("",!0)])}var tB=l(Xhe,[["render",Yhe]]);const tv="ivu-scroll",qhe={props:["text","active","spinnerHeight"],components:{Spin:Bo,Icon:S},computed:{wrapperClasses(){return[`${tv}-loader-wrapper`,{[`${tv}-loader-wrapper-active`]:this.active}]},spinnerClasses(){return`${tv}-spinner`},iconClasses(){return`${tv}-spinner-icon`},textClasses(){return`${tv}-loader-text`}}};function Zhe(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("Spin");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapperClasses)},[i.createElementVNode("div",{class:i.normalizeClass(b.spinnerClasses)},[i.createVNode(F,{fix:""},{default:i.withCtx(()=>[i.createVNode(B,{type:"ios-loading",size:"18",class:i.normalizeClass(b.iconClasses)},null,8,["class"]),g.text?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.textClasses)},i.toDisplayString(g.text),3)):i.createCommentVNode("",!0)]),_:1})],2)],2)}var Khe=l(qhe,[["render",Zhe]]);const Hp="ivu-scroll",iB={sensitivity:10,minimumStartDragOffset:5},uE=()=>Promise.resolve(),Jhe={name:"Scroll",mixins:[gn],components:{loader:Khe},props:{height:{type:[Number,String],default:300},onReachTop:{type:Function},onReachBottom:{type:Function},onReachEdge:{type:Function},loadingText:{type:String},distanceToEdge:[Number,Array],stopSlide:{type:Boolean,default:!1}},data(){const c=this.calculateProximityThreshold();return{showTopLoader:!1,showBottomLoader:!1,showBodyLoader:!1,lastScroll:0,reachedTopScrollLimit:!0,reachedBottomScrollLimit:!1,topRubberPadding:0,bottomRubberPadding:0,rubberRollBackTimeout:!1,isLoading:!1,pointerTouchDown:null,touchScroll:!1,handleScroll:()=>{},pointerUpHandler:()=>{},pointerMoveHandler:()=>{},topProximityThreshold:c[0],bottomProximityThreshold:c[1]}},computed:{wrapClasses(){return`${Hp}-wrapper`},scrollContainerClasses(){return[`${Hp}-container`,{[`${Hp}-container-loading`]:this.showBodyLoader&&this.stopSlide}]},slotContainerClasses(){return[`${Hp}-content`,{[`${Hp}-content-loading`]:this.showBodyLoader}]},loaderClasses(){return`${Hp}-loader`},wrapperPadding(){return{paddingTop:this.topRubberPadding+"px",paddingBottom:this.bottomRubberPadding+"px"}},localeLoadingText(){return this.loadingText===void 0?this.t("i.select.loading"):this.loadingText}},methods:{waitOneSecond(){return new Promise(c=>{setTimeout(c,1e3)})},calculateProximityThreshold(){const c=this.distanceToEdge;return typeof c>"u"?[20,20]:Array.isArray(c)?c:[c,c]},onCallback(c){if(this.isLoading=!0,this.showBodyLoader=!0,c>0)this.showTopLoader=!0,this.topRubberPadding=20;else{this.showBottomLoader=!0,this.bottomRubberPadding=20;let M=0;const C=this.$refs.scrollContainer,b=C.scrollTop;for(let B=0;B<20;B++)setTimeout(()=>{M=Math.max(M,this.$refs.bottomLoader.getBoundingClientRect().height),C.scrollTop=b+M},B*50)}const d=[this.waitOneSecond(),this.onReachEdge?this.onReachEdge(c):uE()];d.push(c>0?this.onReachTop?this.onReachTop():uE():this.onReachBottom?this.onReachBottom():uE());let g=setTimeout(()=>{this.reset()},5e3);Promise.all(d).then(()=>{clearTimeout(g),this.reset()})},reset(){["showTopLoader","showBottomLoader","showBodyLoader","isLoading","reachedTopScrollLimit","reachedBottomScrollLimit"].forEach(c=>this[c]=!1),this.lastScroll=0,this.topRubberPadding=0,this.bottomRubberPadding=0,clearInterval(this.rubberRollBackTimeout),this.touchScroll&&setTimeout(()=>{a(window,"touchend",this.pointerUpHandler),this.$refs.scrollContainer.removeEventListener("touchmove",this.pointerMoveHandler),this.touchScroll=!1},500)},onWheel(c){if(this.isLoading)return;const d=c.wheelDelta?c.wheelDelta:-(c.detail||c.deltaY);this.stretchEdge(d)},stretchEdge(c){if(clearTimeout(this.rubberRollBackTimeout),!this.onReachEdge){if(c>0){if(!this.onReachTop)return}else if(!this.onReachBottom)return}this.rubberRollBackTimeout=setTimeout(()=>{this.isLoading||this.reset()},250),c>0&&this.reachedTopScrollLimit?(this.topRubberPadding+=5-this.topRubberPadding/5,this.topRubberPadding>this.topProximityThreshold&&this.onCallback(1)):c<0&&this.reachedBottomScrollLimit?(this.bottomRubberPadding+=6-this.bottomRubberPadding/4,this.bottomRubberPadding>this.bottomProximityThreshold&&this.onCallback(-1)):this.onScroll()},onScroll(){const c=this.$refs.scrollContainer;if(this.isLoading||!c)return;const d=Math.sign(this.lastScroll-c.scrollTop),g=c.scrollHeight-c.clientHeight-c.scrollTop,M=this.topProximityThreshold<0?this.topProximityThreshold:0,C=this.bottomProximityThreshold<0?this.bottomProximityThreshold:0;d==-1&&g+C<=iB.sensitivity?this.reachedBottomScrollLimit=!0:d>=0&&c.scrollTop+M<=0?this.reachedTopScrollLimit=!0:(this.reachedTopScrollLimit=!1,this.reachedBottomScrollLimit=!1,this.lastScroll=c.scrollTop)},getTouchCoordinates(c){return{x:c.touches[0].pageX,y:c.touches[0].pageY}},onPointerDown(c){if(!this.isLoading){if(c.type=="touchstart"){const d=this.$refs.scrollContainer;this.reachedTopScrollLimit?d.scrollTop=5:this.reachedBottomScrollLimit&&(d.scrollTop-=5)}c.type=="touchstart"&&this.$refs.scrollContainer.scrollTop==0&&(this.$refs.scrollContainer.scrollTop=5),this.pointerTouchDown=this.getTouchCoordinates(c),o(window,"touchend",this.pointerUpHandler),this.$refs.scrollContainer.parentElement.addEventListener("touchmove",d=>{d.stopPropagation(),this.pointerMoveHandler(d)},{passive:!1,useCapture:!0})}},onPointerMove(c){if(!this.pointerTouchDown||this.isLoading)return;const d=this.getTouchCoordinates(c).y-this.pointerTouchDown.y;this.stretchEdge(d),this.touchScroll||Math.abs(d)>iB.minimumStartDragOffset&&(this.touchScroll=!0)},onPointerUp(){this.pointerTouchDown=null}},created(){this.handleScroll=Fx(this.onScroll,150,{leading:!1}),this.pointerUpHandler=this.onPointerUp.bind(this),this.pointerMoveHandler=Fx(this.onPointerMove,50,{leading:!1})}};function eue(c,d,g,M,C,b){const B=i.resolveComponent("loader");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses),style:{"touch-action":"none"}},[i.createElementVNode("div",{class:i.normalizeClass(b.scrollContainerClasses),style:i.normalizeStyle({height:g.height+"px"}),onScroll:d[0]||(d[0]=(...F)=>C.handleScroll&&C.handleScroll(...F)),onWheel:d[1]||(d[1]=(...F)=>b.onWheel&&b.onWheel(...F)),onTouchstart:d[2]||(d[2]=(...F)=>b.onPointerDown&&b.onPointerDown(...F)),ref:"scrollContainer"},[i.createElementVNode("div",{class:i.normalizeClass(b.loaderClasses),style:i.normalizeStyle({paddingTop:b.wrapperPadding.paddingTop}),ref:"toploader"},[i.createVNode(B,{text:b.localeLoadingText,active:C.showTopLoader},null,8,["text","active"])],6),i.createElementVNode("div",{class:i.normalizeClass(b.slotContainerClasses),ref:"scrollContent"},[i.renderSlot(c.$slots,"default")],2),i.createElementVNode("div",{class:i.normalizeClass(b.loaderClasses),style:i.normalizeStyle({paddingBottom:b.wrapperPadding.paddingBottom}),ref:"bottomLoader"},[i.createVNode(B,{text:b.localeLoadingText,active:C.showBottomLoader},null,8,["text","active"])],6)],38)],2)}var nB=l(Jhe,[["render",eue]]);const tue="COMPLETE",rB="CANCELED";function iue(c){if(s&&"requestAnimationFrame"in window)return window.requestAnimationFrame(c);setTimeout(c,16)}function sB(c,d,g){c===window?c.scrollTo(d,g):(c.scrollLeft=d,c.scrollTop=g)}function nue(c,d,g){if(!s)return;let M=c.getBoundingClientRect(),C=null,b=null,B=null,F=null,Y=null,G=null,K=null,fe=g&&g.left!=null?g.left:.5,Ee=g&&g.top!=null?g.top:.5,Ce=g&&g.leftOffset!=null?g.leftOffset:0,Oe=g&&g.topOffset!=null?g.topOffset:0,ue=fe,Ne=Ee;if(d===window)G=Math.min(M.width,window.innerWidth),K=Math.min(M.height,window.innerHeight),b=M.left+window.pageXOffset-window.innerWidth*ue+G*ue,B=M.top+window.pageYOffset-window.innerHeight*Ne+K*Ne,b-=Ce,B-=Oe,F=b-window.pageXOffset,Y=B-window.pageYOffset;else{G=M.width,K=M.height,C=d.getBoundingClientRect();let jt=M.left-(C.left-d.scrollLeft),_t=M.top-(C.top-d.scrollTop);b=jt+G*ue-d.clientWidth*ue,B=_t+K*Ne-d.clientHeight*Ne,b=Math.max(Math.min(b,d.scrollWidth-d.clientWidth),0),B=Math.max(Math.min(B,d.scrollHeight-d.clientHeight),0),b-=Ce,B-=Oe,F=b-d.scrollLeft,Y=B-d.scrollTop}return{x:b,y:B,differenceX:F,differenceY:Y}}function oB(c){iue(function(){let d=c.scrollOption;if(!d)return;let g=nue(d.target,c,d.align),M=Date.now()-d.startTime,C=Math.min(1/d.time*M,1);if(M>d.time+20)return sB(c,g.x,g.y),c.scrollOption=null,d.end(tue);let b=1-d.ease(C);sB(c,g.x-g.differenceX*b,g.y-g.differenceY*b),oB(c)})}function rue(c,d,g,M){let C=!d.scrollOption,b=d.scrollOption,B=Date.now(),F;b&&b.end(rB);function Y(G){d.scrollOption=null,d.parentElement&&d.parentElement.scrollOption&&d.parentElement.scrollOption.end(G),M(G),d.removeEventListener("touchstart",F)}d.scrollOption={startTime:b?b.startTime:Date.now(),target:c,time:g.time+(b?B-b.startTime:0),ease:g.ease,align:g.align,end:Y},F=Y.bind(null,rB),d.addEventListener("touchstart",F),C&&oB(d)}function aB(c){if(s)return c===window||(c.scrollHeight!==c.clientHeight||c.scrollWidth!==c.clientWidth)&&getComputedStyle(c).overflow!=="hidden"}function sue(){return!0}function dE(c,d,g){if(!c)return;typeof d=="function"&&(g=d,d=null),d||(d={}),d.time=isNaN(d.time)?1e3:d.time,d.ease=d.ease||function(Y){return 1-Math.pow(1-Y,Y/2)};let M=c.parentElement,C=0;function b(Y){C-=1,!C&&g&&g(Y)}let B=d.validTarget||sue,F=d.isScrollable;for(;M;){if(B(M,C)&&(F?F(M,aB):aB(M))&&(C+=1,rue(c,M,d,b)),M=M.parentElement,!M)return;M.tagName==="BODY"&&(M=window)}}function oue(c){if(s&&"requestAnimationFrame"in window)return window.requestAnimationFrame(c);setTimeout(c,16)}function fE(c,d,g){if(!c)return;typeof d=="function"&&(g=d,d=null),d||(d={}),d.time=isNaN(d.time)?500:d.time;const M=c.scrollTop,C=d.to||0,b=Math.abs(M-C),B=Math.ceil(b/d.time*50);function F(Y,G,K){if(Y===G){g&&g();return}let fe=Y+K>G?G:Y+K;Y>G&&(fe=Y-K<G?G:Y-K),c.scrollTop=fe,oue(()=>F(fe,G,K))}F(M,C,B)}const kc="ivu-layout-sider";ne();const aue={name:"Sider",emits:["on-collapse","update:modelValue"],props:{modelValue:{type:Boolean,default:!1},width:{type:[Number,String],default:200},collapsedWidth:{type:[Number,String],default:64},hideTrigger:{type:Boolean,default:!1},breakpoint:{type:String,validator(c){return O(c,["xs","sm","md","lg","xl","xxl"])}},collapsible:{type:Boolean,default:!1},defaultCollapsed:{type:Boolean,default:!1},reverseArrow:{type:Boolean,default:!1}},data(){return{prefixCls:kc,mediaMatched:!1}},computed:{wrapClasses(){return[`${kc}`,this.siderWidth?"":`${kc}-zero-width`,this.modelValue?`${kc}-collapsed`:""]},wrapStyles(){return{width:`${this.siderWidth}px`,minWidth:`${this.siderWidth}px`,maxWidth:`${this.siderWidth}px`,flex:`0 0 ${this.siderWidth}px`}},triggerClasses(){return[`${kc}-trigger`,this.modelValue?`${kc}-trigger-collapsed`:""]},childClasses(){return`${this.prefixCls}-children`},zeroWidthTriggerClasses(){return[`${kc}-zero-width-trigger`,this.reverseArrow?`${kc}-zero-width-trigger-left`:""]},triggerIconClasses(){return["ivu-icon",`ivu-icon-ios-arrow-${this.reverseArrow?"forward":"back"}`,`${kc}-trigger-icon`]},siderWidth(){return this.collapsible?this.modelValue?this.mediaMatched?0:parseInt(this.collapsedWidth):parseInt(this.width):this.width},showZeroTrigger(){return this.collapsible?this.mediaMatched&&!this.hideTrigger||parseInt(this.collapsedWidth)===0&&this.modelValue&&!this.hideTrigger:!1},showBottomTrigger(){return this.collapsible?!this.mediaMatched&&!this.hideTrigger:!1}},methods:{toggleCollapse(){let c=this.collapsible?!this.modelValue:!1;this.$emit("update:modelValue",c)},matchMedia(){if(!s)return;let c;window.matchMedia&&(c=window.matchMedia);let d=this.mediaMatched;this.mediaMatched=c(`(max-width: ${ee[this.breakpoint]})`).matches,this.mediaMatched!==d&&this.$emit("update:modelValue",this.mediaMatched)},onWindowResize(){this.matchMedia()}},watch:{modelValue(c){this.$emit("on-collapse",c)}},mounted(){this.defaultCollapsed&&this.$emit("update:modelValue",this.defaultCollapsed),this.breakpoint!==void 0&&(o(window,"resize",this.onWindowResize),this.matchMedia())},beforeUnmount(){this.breakpoint!==void 0&&a(window,"resize",this.onWindowResize)}},lue=[i.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-menu"},null,-1)];function cue(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses),style:i.normalizeStyle(b.wrapStyles)},[i.withDirectives(i.createElementVNode("span",{onClick:d[0]||(d[0]=(...B)=>b.toggleCollapse&&b.toggleCollapse(...B)),class:i.normalizeClass(b.zeroWidthTriggerClasses)},lue,2),[[i.vShow,b.showZeroTrigger]]),i.createElementVNode("div",{class:i.normalizeClass(b.childClasses)},[i.renderSlot(c.$slots,"default")],2),i.renderSlot(c.$slots,"trigger",{},()=>[i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass(b.triggerClasses),onClick:d[1]||(d[1]=(...B)=>b.toggleCollapse&&b.toggleCollapse(...B)),style:i.normalizeStyle({width:b.siderWidth+"px"})},[i.createElementVNode("i",{class:i.normalizeClass(b.triggerIconClasses)},null,2)],6),[[i.vShow,b.showBottomTrigger]])])],6)}var lB=l(aue,[["render",cue]]);const jh="ivu-skeleton-item",hue={name:"SkeletonItem",components:{Icon:S},inject:{SkeletonInstance:{default:null}},props:{animated:{type:Boolean,default:!1},type:{validator(c){return O(c,["circle","square","rect","image"])},default:"rect"},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},width:{type:[String,Number]},height:{type:[String,Number]},block:{type:Boolean,default:!1},imgSrc:{type:String}},data(){return{prefixCls:jh}},computed:{classes(){return[jh,jh+"-"+this.type,jh+"-"+this.type+"-"+this.size,{[jh+"-animated"]:this.animated||!!this.SkeletonInstance&&this.SkeletonInstance.animated,[jh+"-inline"]:!this.block,[jh+"-with-image"]:this.showImage,[jh+"-round"]:!!this.SkeletonInstance&&this.SkeletonInstance.round}]},styles(){const c={};return["rect","image"].includes(this.type)&&(this.width&&(c.width=typeof this.width=="number"?`${this.width}px`:this.width),this.height&&(c.height=typeof this.height=="number"?`${this.height}px`:this.height),this.showImage&&(c.background=`no-repeat url(${this.imgSrc}) center center`,c.backgroundSize="contain")),c},showIcon(){return this.type==="image"&&!this.imgSrc},showImage(){return this.type==="image"&&!!this.imgSrc},iconSize(){let c=16;return this.size==="large"&&(c=32),this.size==="small"&&(c=10),c}}};function uue(c,d,g,M,C,b){const B=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(b.styles)},[b.showIcon?(i.openBlock(),i.createBlock(B,{key:0,class:i.normalizeClass(C.prefixCls+"-image-icon"),type:"ios-image",size:b.iconSize},null,8,["class","size"])):i.createCommentVNode("",!0)],6)}var pE=l(hue,[["render",uue]]);const Bd="ivu-skeleton",due={name:"Skeleton",components:{SkeletonItem:pE,Row:$h,Col:Ml},provide(){return{SkeletonInstance:this}},props:{animated:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},round:{type:Boolean,default:!1},paragraph:{validator(c){return typeof c=="number"?c>=1:typeof c.rows=="number"&&c.rows>=1},type:[Number,Object],default:3},title:{validator(c){return typeof c=="object"&&c.width?["number","string"].includes(typeof c.width):!0},type:[Boolean,Object],default:!0},avatar:{validator(c){if(typeof c=="object"){if(c.type)return O(c.type,["circle","square"]);if(c.size)return O(c.size,["small","large","default"])}return!0},type:[Boolean,Object],default:!1}},data(){return{prefixCls:Bd}},computed:{classes(){return[Bd,{[Bd+"-with-title"]:this.showTitle,[Bd+"-with-avatar"]:this.showAvatar}]},rows(){return typeof this.paragraph=="number"?this.paragraph:this.paragraph.rows},rowsCount(){return this.rows+Number(this.showTitle)},showTitle(){return!!this.title},titleWidth(){return typeof this.title=="object"&&this.title.width?typeof this.title.width=="string"?this.title.width:`${this.title.width}px`:""},showAvatar(){return!!this.avatar},avatarType(){return typeof this.avatar=="object"&&this.avatar.type?this.avatar.type:"circle"},avatarSize(){return typeof this.avatar=="object"&&this.avatar.size?this.avatar.size:!this.$VIEWUI||this.$VIEWUI.size===""?"default":this.$VIEWUI.size}},methods:{rowClasses(c){return[Bd+"-item-inner",{[Bd+"-item-round"]:this.round,[Bd+"-item-title"]:this.showTitle&&c===1}]},rowWidth(c){if(this.showTitle&&c===1)return this.titleWidth||"38%";if(typeof this.paragraph=="object"){if(typeof this.paragraph.width=="string")return this.paragraph.width;if(typeof this.paragraph.width=="number")return`${this.paragraph.width}px`;const d=c-1-Number(this.showTitle);if(Array.isArray(this.paragraph.width)&&this.paragraph.width[d])return typeof this.paragraph.width[d]=="number"?`${this.paragraph.width[d]}px`:this.paragraph.width[d]}return c===this.rowsCount?"62%":"100%"}}};function fue(c,d,g,M,C,b){const B=i.resolveComponent("SkeletonItem"),F=i.resolveComponent("Col"),Y=i.resolveComponent("Row");return g.loading?(i.openBlock(),i.createElementBlock("div",i.mergeProps({key:0},c.$attrs,{class:b.classes}),[g.loading?i.renderSlot(c.$slots,"template",{key:0},()=>[i.createVNode(Y,null,{default:i.withCtx(()=>[b.showAvatar?(i.openBlock(),i.createBlock(F,{key:0,flex:"0"},{default:i.withCtx(()=>[i.createVNode(B,{type:b.avatarType,size:b.avatarSize,animated:g.animated,class:i.normalizeClass(C.prefixCls+"-item-avatar")},null,8,["type","size","animated","class"])]),_:1})):i.createCommentVNode("",!0),i.createVNode(F,{flex:"1"},{default:i.withCtx(()=>[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.rowsCount,G=>(i.openBlock(),i.createBlock(B,{key:G,class:i.normalizeClass(b.rowClasses(G)),animated:g.animated,width:b.rowWidth(G),block:""},null,8,["class","animated","width"]))),128))]),_:1})]),_:1})]):i.createCommentVNode("",!0)],16)):i.renderSlot(c.$slots,"default",i.normalizeProps(i.mergeProps({key:1},c.$attrs)))}var cB=l(due,[["render",fue]]),pue={name:"SliderMarker",props:{mark:{type:[String,Object]}},render(){let c=typeof this.mark=="string"?this.mark:[this.mark.label];return i.h("div",{class:"ivu-slider-marks-item",style:this.mark.style||{}},c)}};const Pc="ivu-slider",mue={name:"Slider",mixins:[Ei],emits:["update:modelValue","on-input","on-change"],components:{InputNumber:JT,Tooltip:Cc,SliderMarker:pue},inject:{ModalInstance:{default:null},DrawerInstance:{default:null}},props:{min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},range:{type:Boolean,default:!1},modelValue:{type:[Number,Array],default:0},disabled:{type:Boolean,default:!1},showInput:{type:Boolean,default:!1},inputSize:{type:String,default:"default",validator(c){return O(c,["small","large","default"])}},showStops:{type:Boolean,default:!1},tipFormat:{type:Function,default(c){return c}},showTip:{type:String,default:"hover",validator(c){return O(c,["hover","always","never"])}},name:{type:String},activeChange:{type:Boolean,default:!0},marks:{type:Object}},data(){let c=this.checkLimits(Array.isArray(this.modelValue)?this.modelValue:[this.modelValue]);return this.range&&this.modelValue===null&&(c=[0,0]),{prefixCls:Pc,currentValue:c,dragging:!1,pointerDown:"",startX:0,currentX:0,startPos:0,oldValue:[...c],valueIndex:{min:0,max:1},sliderWidth:0,isValueNull:!1,id:j(6)}},watch:{modelValue(c){c===null&&(this.isValueNull=!0),c=this.checkLimits(Array.isArray(c)?c:[c]),!this.dragging&&(c[0]!==this.currentValue[0]||c[1]!==this.currentValue[1])&&(this.isValueNull&&this.range?this.currentValue=[0,0]:this.currentValue=c)},exportValue(c){i.nextTick(()=>{this.$refs.minTooltip.updatePopper(),this.range&&this.$refs.maxTooltip.updatePopper()});const d=this.range?c:c[0];this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",d),this.$emit("on-input",d)}},computed:{classes(){return[`${Pc}`,{[`${Pc}-input`]:this.showInput&&!this.range,[`${Pc}-range`]:this.range,[`${Pc}-disabled`]:this.itemDisabled}]},minButtonClasses(){return[`${Pc}-button`,{[`${Pc}-button-dragging`]:this.pointerDown==="min"}]},maxButtonClasses(){return[`${Pc}-button`,{[`${Pc}-button-dragging`]:this.pointerDown==="max"}]},exportValue(){const c=(String(this.step).split(".")[1]||"").length;return this.currentValue.map(d=>Number(d.toFixed(c)))},minPosition(){return(this.currentValue[0]-this.min)/this.valueRange*100},maxPosition:function(){return(this.currentValue[1]-this.min)/this.valueRange*100},barStyle(){const c={width:(this.currentValue[0]-this.min)/this.valueRange*100+"%"};return this.range&&(c.left=(this.currentValue[0]-this.min)/this.valueRange*100+"%",c.width=(this.currentValue[1]-this.currentValue[0])/this.valueRange*100+"%"),c},stops(){let c=this.valueRange/this.step,d=[],g=100*this.step/this.valueRange;for(let M=1;M<c;M++)d.push(M*g);return d},markList(){return this.marks?Object.keys(this.marks).map(parseFloat).sort((c,d)=>c-d).filter(c=>c<=this.max&&c>=this.min).map(c=>({point:c,position:(c-this.min)*100/(this.max-this.min),mark:this.marks[c]})):[]},tipDisabled(){return this.tipFormat(this.currentValue[0])===null||this.showTip==="never"},valueRange(){return this.max-this.min},firstPosition(){return this.currentValue[0]},secondPosition(){return this.currentValue[1]}},methods:{getPointerX(c){return c.type.indexOf("touch")!==-1?c.touches[0].clientX:c.clientX},checkLimits([c,d]){return c=Math.max(this.min,c),c=Math.min(this.max,c),d=Math.max(this.min,c,d),d=Math.min(this.max,d),[c,d]},getCurrentValue(c,d){if(this.itemDisabled)return;const g=this.valueIndex[d];if(typeof g<"u")return this.currentValue[g]},onKeyLeft(c,d){const g=this.getCurrentValue(c,d);Number.isFinite(g)&&this.changeButtonPosition(g-this.step,d)},onKeyRight(c,d){const g=this.getCurrentValue(c,d);Number.isFinite(g)&&this.changeButtonPosition(g+this.step,d)},onPointerDown(c,d){this.itemDisabled||(c.preventDefault(),this.pointerDown=d,this.onPointerDragStart(c),o(window,"mousemove",this.onPointerDrag),o(window,"touchmove",this.onPointerDrag),o(window,"mouseup",this.onPointerDragEnd),o(window,"touchend",this.onPointerDragEnd))},onPointerDragStart(c){this.dragging=!1,this.startX=this.getPointerX(c),this.startPos=this[`${this.pointerDown}Position`]*this.valueRange/100+this.min},onPointerDrag(c){this.dragging=!0,this.$refs[`${this.pointerDown}Tooltip`].visible=!0,this.currentX=this.getPointerX(c);const d=(this.currentX-this.startX)/this.sliderWidth*this.valueRange;this.changeButtonPosition(this.startPos+d)},onPointerDragEnd(){this.dragging&&(this.dragging=!1,this.$refs[`${this.pointerDown}Tooltip`].visible=!1,this.emitChange()),this.pointerDown="",a(window,"mousemove",this.onPointerDrag),a(window,"touchmove",this.onPointerDrag),a(window,"mouseup",this.onPointerDragEnd),a(window,"touchend",this.onPointerDragEnd)},changeButtonPosition(c,d){const g=d||this.pointerDown,M=g==="min"?0:1;g==="min"?c=this.checkLimits([c,this.max])[0]:c=this.checkLimits([this.min,c])[1];const C=this.handleDecimal(c,this.step),b=this.currentValue;b[M]=c-C,this.range&&(g==="min"&&b[0]>b[1]&&(b[1]=b[0]),g==="max"&&b[0]>b[1]&&(b[0]=b[1])),this.currentValue=[...b],this.dragging||this.currentValue[M]!==this.oldValue[M]&&(this.emitChange(),this.oldValue[M]=this.currentValue[M])},handleDecimal(c,d){if(d<1){let g=d.toString(),M=1,C;try{C=g.split(".")[1].length}catch{C=0}return M=Math.pow(10,C),c*M%(d*M)/M}else return c%d},emitChange(){const c=this.range?this.exportValue:this.exportValue[0];this.$emit("on-change",c),this.handleFormItemChange("change",c)},sliderClick(c){if(this.itemDisabled)return;const d=this.getPointerX(c),g=this.$refs.slider.getBoundingClientRect().left;let M=(d-g)/this.sliderWidth*this.valueRange+this.min,C=M/this.valueRange*100;!this.range||C<=this.minPosition?this.changeButtonPosition(M,"min"):C>=this.maxPosition?this.changeButtonPosition(M,"max"):this.changeButtonPosition(M,M-this.firstPosition<=this.secondPosition-M?"min":"max")},handleInputChange(c){this.currentValue=[c===0?0:c||this.min,this.currentValue[1]],this.emitChange()},handleFocus(c){this.$refs[`${c}Tooltip`].handleShowPopper()},handleBlur(c){this.$refs[`${c}Tooltip`].handleClosePopper()},handleSetSliderWidth(){this.sliderWidth=parseInt(R(this.$refs.slider,"width"),10)},handleOnVisibleChange(c){c&&this.showTip==="always"&&(this.$refs.minTooltip.doDestroy(),this.range&&this.$refs.maxTooltip.doDestroy(),i.nextTick(()=>{this.$refs.minTooltip.updatePopper(),this.range&&this.$refs.maxTooltip.updatePopper()}))},addSlider(c){const d=this[c];!d||(d.sliderList||(d.sliderList=[]),d.sliderList.push({id:this.id,slider:this}))},removeSlider(c){const d=this[c];if(!d||!d.sliderList)return;const g=d.sliderList.findIndex(M=>M.id===this.id);d.sliderList.splice(g,1)}},mounted(){this.addSlider("ModalInstance"),this.addSlider("DrawerInstance"),this.observer=Wp(),this.observer.listenTo(this.$refs.slider,this.handleSetSliderWidth)},beforeUnmount(){this.removeSlider("ModalInstance"),this.removeSlider("DrawerInstance"),this.observer.removeListener(this.$refs.slider,this.handleSetSliderWidth)}},gue=["name","value"],vue={class:"ivu-slider-marks"};function yue(c,d,g,M,C,b){const B=i.resolveComponent("Input-number"),F=i.resolveComponent("SliderMarker"),Y=i.resolveComponent("Tooltip");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[!g.range&&g.showInput?(i.openBlock(),i.createBlock(B,{key:0,min:g.min,size:g.inputSize,max:g.max,step:g.step,modelValue:b.exportValue[0],disabled:c.itemDisabled,"active-change":g.activeChange,onOnChange:b.handleInputChange},null,8,["min","size","max","step","modelValue","disabled","active-change","onOnChange"])):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-wrap"]),ref:"slider",onClick:d[19]||(d[19]=i.withModifiers((...G)=>b.sliderClick&&b.sliderClick(...G),["self"]))},[i.createElementVNode("input",{type:"hidden",name:g.name,value:b.exportValue},null,8,gue),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-bar"]),style:i.normalizeStyle(b.barStyle),onClick:d[0]||(d[0]=i.withModifiers((...G)=>b.sliderClick&&b.sliderClick(...G),["self"]))},null,6),g.showStops?(i.openBlock(!0),i.createElementBlock(i.Fragment,{key:0},i.renderList(b.stops,G=>(i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([C.prefixCls+"-stop"]),key:G,style:i.normalizeStyle({left:G+"%"}),onClick:d[1]||(d[1]=i.withModifiers((...K)=>b.sliderClick&&b.sliderClick(...K),["self"]))},null,6))),128)):i.createCommentVNode("",!0),b.markList.length>0?(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.markList,(G,K)=>(i.openBlock(),i.createElementBlock("div",{key:K,class:i.normalizeClass([C.prefixCls+"-stop"]),style:i.normalizeStyle({left:G.position+"%"}),onClick:d[2]||(d[2]=i.withModifiers((...fe)=>b.sliderClick&&b.sliderClick(...fe),["self"]))},null,6))),128)),i.createElementVNode("div",vue,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.markList,(G,K)=>(i.openBlock(),i.createBlock(F,{key:K,mark:G.mark,style:i.normalizeStyle({left:G.position+"%"}),onClick:b.sliderClick},null,8,["mark","style","onClick"]))),128))])],64)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-button-wrap"]),style:i.normalizeStyle({left:b.minPosition+"%"}),onTouchstart:d[9]||(d[9]=G=>b.onPointerDown(G,"min")),onMousedown:d[10]||(d[10]=G=>b.onPointerDown(G,"min"))},[i.createVNode(Y,{controlled:C.pointerDown==="min",placement:"top",content:g.tipFormat(b.exportValue[0]),disabled:b.tipDisabled,always:g.showTip==="always",ref:"minTooltip"},{default:i.withCtx(()=>[i.createElementVNode("div",{class:i.normalizeClass(b.minButtonClasses),tabindex:"0",onFocus:d[3]||(d[3]=G=>b.handleFocus("min")),onBlur:d[4]||(d[4]=G=>b.handleBlur("min")),onKeydown:[d[5]||(d[5]=i.withKeys(G=>b.onKeyLeft(G,"min"),["left"])),d[6]||(d[6]=i.withKeys(G=>b.onKeyLeft(G,"min"),["down"])),d[7]||(d[7]=i.withKeys(G=>b.onKeyRight(G,"min"),["right"])),d[8]||(d[8]=i.withKeys(G=>b.onKeyRight(G,"min"),["up"]))]},null,34)]),_:1},8,["controlled","content","disabled","always"])],38),g.range?(i.openBlock(),i.createElementBlock("div",{key:2,class:i.normalizeClass([C.prefixCls+"-button-wrap"]),style:i.normalizeStyle({left:b.maxPosition+"%"}),onTouchstart:d[17]||(d[17]=G=>b.onPointerDown(G,"max")),onMousedown:d[18]||(d[18]=G=>b.onPointerDown(G,"max"))},[i.createVNode(Y,{controlled:C.pointerDown==="max",placement:"top",content:g.tipFormat(b.exportValue[1]),disabled:b.tipDisabled,always:g.showTip==="always",ref:"maxTooltip"},{default:i.withCtx(()=>[i.createElementVNode("div",{class:i.normalizeClass(b.maxButtonClasses),tabindex:"0",onFocus:d[11]||(d[11]=G=>b.handleFocus("max")),onBlur:d[12]||(d[12]=G=>b.handleBlur("max")),onKeydown:[d[13]||(d[13]=i.withKeys(G=>b.onKeyLeft(G,"max"),["left"])),d[14]||(d[14]=i.withKeys(G=>b.onKeyLeft(G,"max"),["down"])),d[15]||(d[15]=i.withKeys(G=>b.onKeyRight(G,"max"),["right"])),d[16]||(d[16]=i.withKeys(G=>b.onKeyRight(G,"max"),["up"]))]},null,34)]),_:1},8,["controlled","content","disabled","always"])],38)):i.createCommentVNode("",!0)],2)],2)}var hB=l(mue,[["render",yue]]);const bue={small:8,default:16,large:24},uB={name:"Space",props:{size:{type:[String,Number,Array],validator(c){const d=["small","large","default"];return typeof c=="string"?O(c,d):Array.isArray(c)?c.length>0&&c.every(g=>typeof g=="number"||O(g,d)):!0},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||!c.$VIEWUI.space||c.$VIEWUI.space.size===""?"small":c.$VIEWUI.space.size}},direction:{type:String,validator(c){return O(c,["horizontal","vertical"])},default:"horizontal"},align:{type:String,validator(c){return O(c,["start","end","center","baseline","stretch"])}},wrap:{type:Boolean,default:!1},split:{type:Boolean,default:!1},type:{type:String,validator(c){return O(c,["inline-flex","flex"])},default:"inline-flex"}},computed:{mergedAlign(){if(!this.align){if(this.direction==="horizontal")return"center";if(this.type==="flex")return"stretch"}return this.align},classes(){return["ivu-space",`ivu-space-${this.direction}`,{"ivu-space-flex":this.type==="flex","ivu-space-wrap":this.wrap,[`ivu-space-${this.mergedAlign}`]:this.mergedAlign}]},styles(){const c={};return["number","string"].includes(typeof this.size)&&(c.gap=this.getSize(this.size)),Array.isArray(this.size)&&(this.size.length===1?c.columnGap=this.getSize(this.size[0]):this.size.length>1&&(c.columnGap=this.getSize(this.size[0]),c.rowGap=this.getSize(this.size[1]))),c}},methods:{getSize(c){return`${typeof c=="string"?bue[c]:c||0}px`},filterEmpty(c=[]){const d=[];return c.forEach(g=>{Array.isArray(g)?d.push(...g):g.type===i.Fragment?d.push(...g.children):d.push(g)}),d.filter(g=>!this.isEmptyElement(g))},isEmptyElement(c){return c&&(c.type===i.Comment||c.type===i.Fragment&&c.children.length===0||c.type===i.Text&&c.children.trim()==="")}},render(){const c=this.filterEmpty(this.$slots.default?this.$slots.default():[]),d=c.length;if(d===0)return null;let g=null;return this.split&&!this.$slots.split?g=i.h(Dx,{type:"vertical"}):this.$slots.split&&(g=this.$slots.split()),i.h("div",{class:this.classes,style:this.styles},c.map((M,C)=>{const b=i.h("div",{class:"ivu-space-item"},[M]);return g&&C+1<d?[b,i.h("div",{class:"ivu-space-split"},[g])]:b}))}},xue={name:"Trigger",props:{mode:String},data(){return{prefix:"ivu-split-trigger",initOffset:0}},computed:{isVertical(){return this.mode==="vertical"},classes(){return[this.prefix,this.isVertical?`${this.prefix}-vertical`:`${this.prefix}-horizontal`]},barConClasses(){return[`${this.prefix}-bar-con`,this.isVertical?"vertical":"horizontal"]}}};function wue(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.createElementVNode("div",{class:i.normalizeClass(b.barConClasses)},[d[0]||(i.setBlockTracking(-1),d[0]=(i.openBlock(),i.createElementBlock(i.Fragment,null,i.renderList(8,B=>i.createElementVNode("i",{class:i.normalizeClass(`${C.prefix}-bar`),key:`trigger-${B}`},null,2)),64)),i.setBlockTracking(1),d[0])],2)],2)}var _ue=l(xue,[["render",wue]]);const Oue={name:"Split",components:{Trigger:_ue},emits:["update:modelValue","on-move-start","on-moving","on-move-end"],props:{modelValue:{type:[Number,String],default:.5},mode:{validator(c){return O(c,["horizontal","vertical"])},default:"horizontal"},min:{type:[Number,String],default:"40px"},max:{type:[Number,String],default:"40px"}},data(){return{prefix:"ivu-split",offset:0,oldOffset:0,isMoving:!1,computedMin:0,computedMax:0,currentValue:.5}},computed:{wrapperClasses(){return[`${this.prefix}-wrapper`,this.isMoving?"no-select":""]},paneClasses(){return[`${this.prefix}-pane`,{[`${this.prefix}-pane-moving`]:this.isMoving}]},isHorizontal(){return this.mode==="horizontal"},anotherOffset(){return 100-this.offset},valueIsPx(){return typeof this.modelValue=="string"},offsetSize(){return this.isHorizontal?"offsetWidth":"offsetHeight"}},methods:{px2percent(c,d){return parseFloat(c)/parseFloat(d)},getComputedThresholdValue(c){let d=this.$refs.outerWrapper[this.offsetSize];return this.valueIsPx?typeof this[c]=="string"?this[c]:d*this[c]:typeof this[c]=="string"?this.px2percent(this[c],d):this[c]},getMin(c,d){return this.valueIsPx?`${Math.min(parseFloat(c),parseFloat(d))}px`:Math.min(c,d)},getMax(c,d){return this.valueIsPx?`${Math.max(parseFloat(c),parseFloat(d))}px`:Math.max(c,d)},getAnotherOffset(c){let d=0;return this.valueIsPx?d=`${this.$refs.outerWrapper[this.offsetSize]-parseFloat(c)}px`:d=1-c,d},handleMove(c){let d=(this.isHorizontal?c.pageX:c.pageY)-this.initOffset,g=this.$refs.outerWrapper[this.offsetSize],M=this.valueIsPx?`${parseFloat(this.oldOffset)+d}px`:this.px2percent(g*this.oldOffset+d,g),C=this.getAnotherOffset(M);parseFloat(M)<=parseFloat(this.computedMin)&&(M=this.getMax(M,this.computedMin)),parseFloat(C)<=parseFloat(this.computedMax)&&(M=this.getAnotherOffset(this.getMax(C,this.computedMax))),c.atMin=this.modelValue===this.computedMin,c.atMax=this.valueIsPx?this.getAnotherOffset(this.modelValue)===this.computedMax:this.getAnotherOffset(this.modelValue).toFixed(5)===this.computedMax.toFixed(5),this.$emit("update:modelValue",M),this.$emit("on-moving",c)},handleUp(){this.isMoving=!1,a(document,"mousemove",this.handleMove),a(document,"mouseup",this.handleUp),this.$emit("on-move-end")},handleMousedown(c){this.initOffset=this.isHorizontal?c.pageX:c.pageY,this.oldOffset=this.modelValue,this.isMoving=!0,o(document,"mousemove",this.handleMove),o(document,"mouseup",this.handleUp),this.$emit("on-move-start")},computeOffset(){i.nextTick(()=>{this.computedMin=this.getComputedThresholdValue("min"),this.computedMax=this.getComputedThresholdValue("max"),this.offset=(this.valueIsPx?this.px2percent(this.modelValue,this.$refs.outerWrapper[this.offsetSize]):this.modelValue)*1e4/100})}},watch:{modelValue(c){c!==this.currentValue&&(this.currentValue=c,this.computeOffset())}},mounted(){i.nextTick(()=>{this.computeOffset()}),o(window,"resize",this.computeOffset)},beforeUnmount(){a(window,"resize",this.computeOffset)}};function Sue(c,d,g,M,C,b){const B=i.resolveComponent("trigger");return i.openBlock(),i.createElementBlock("div",{ref:"outerWrapper",class:i.normalizeClass(b.wrapperClasses)},[b.isHorizontal?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(`${C.prefix}-horizontal`)},[i.createElementVNode("div",{style:i.normalizeStyle({right:`${b.anotherOffset}%`}),class:i.normalizeClass(["left-pane",b.paneClasses])},[i.renderSlot(c.$slots,"left")],6),i.createElementVNode("div",{class:i.normalizeClass(`${C.prefix}-trigger-con`),style:i.normalizeStyle({left:`${C.offset}%`}),onMousedown:d[0]||(d[0]=(...F)=>b.handleMousedown&&b.handleMousedown(...F))},[i.renderSlot(c.$slots,"trigger",{},()=>[i.createVNode(B,{mode:"vertical"})])],38),i.createElementVNode("div",{style:i.normalizeStyle({left:`${C.offset}%`}),class:i.normalizeClass(["right-pane",b.paneClasses])},[i.renderSlot(c.$slots,"right")],6)],2)):(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass(`${C.prefix}-vertical`)},[i.createElementVNode("div",{style:i.normalizeStyle({bottom:`${b.anotherOffset}%`}),class:i.normalizeClass(["top-pane",b.paneClasses])},[i.renderSlot(c.$slots,"top")],6),i.createElementVNode("div",{class:i.normalizeClass(`${C.prefix}-trigger-con`),style:i.normalizeStyle({top:`${C.offset}%`}),onMousedown:d[1]||(d[1]=(...F)=>b.handleMousedown&&b.handleMousedown(...F))},[i.renderSlot(c.$slots,"trigger",{},()=>[i.createVNode(B,{mode:"horizontal"})])],38),i.createElementVNode("div",{style:i.normalizeStyle({top:`${C.offset}%`}),class:i.normalizeClass(["bottom-pane",b.paneClasses])},[i.renderSlot(c.$slots,"bottom")],6)],2))],2)}var dB=l(Oue,[["render",Sue]]);const Qp="ivu-steps",fB="ivu-icon",Cue={name:"Step",inject:["StepsInstance"],props:{status:{validator(c){return O(c,["wait","process","finish","error"])}},title:{type:String,default:""},content:{type:String},icon:{type:String}},data(){return{prefixCls:Qp,id:j(6)}},computed:{wrapClasses(){return[`${Qp}-item`,`${Qp}-status-${this.currentStatus}`,{[`${Qp}-custom`]:!!this.icon||!!this.$slots.icon,[`${Qp}-next-error`]:this.nextError}]},iconClasses(){let c="";return this.icon?c=this.icon:this.currentStatus==="finish"?c="ios-checkmark":this.currentStatus==="error"&&(c="ios-close"),[`${Qp}-icon`,`${fB}`,{[`${fB}-${c}`]:c!==""}]},stepNumber(){return this.StepsInstance.steps.findIndex(c=>c.id===this.id)+1},total(){return this.StepsInstance.direction==="horizontal"?this.StepsInstance.steps.length:1},currentStatus(){let c="";if(this.status)c=this.status;else{const d=this.StepsInstance,g=d.current,M=d.steps.findIndex(C=>C.id===this.id);M===g?d.status!=="error"?c="process":c="error":M<g?c="finish":c="wait"}return c},nextError(){let c=!1;const d=this.StepsInstance,g=d.steps.findIndex(M=>M.id===this.id);return g+1<d.steps.length&&d.steps[g+1].currentStatus==="error"&&(c=!0),c}},beforeMount(){this.StepsInstance.addStep(this.id,this)},beforeUnmount(){this.StepsInstance.removeStep(this.id)}},Tue=[i.createElementVNode("i",null,null,-1)],Eue={key:0},Mue={key:1,class:"ivu-steps-icon"};function Aue(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses)},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-tail"])},Tue,2),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-head"])},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-head-inner"])},[!g.icon&&!c.$slots.icon&&b.currentStatus!=="finish"&&b.currentStatus!=="error"?(i.openBlock(),i.createElementBlock("span",Eue,i.toDisplayString(b.stepNumber),1)):c.$slots.icon?(i.openBlock(),i.createElementBlock("span",Mue,[i.renderSlot(c.$slots,"icon")])):(i.openBlock(),i.createElementBlock("span",{key:2,class:i.normalizeClass(b.iconClasses)},null,2))],2)],2),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-main"])},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-title"])},[i.renderSlot(c.$slots,"title",{},()=>[i.createTextVNode(i.toDisplayString(g.title),1)])],2),g.content||c.$slots.content?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-content"])},[i.renderSlot(c.$slots,"content",{},()=>[i.createTextVNode(i.toDisplayString(g.content),1)])],2)):i.createCommentVNode("",!0)],2)],2)}var pB=l(Cue,[["render",Aue]]);const mE="ivu-steps",kue={name:"Steps",provide(){return{StepsInstance:this}},props:{current:{type:Number,default:0},status:{validator(c){return O(c,["wait","process","finish","error"])},default:"process"},size:{validator(c){return O(c,["small"])}},direction:{validator(c){return O(c,["horizontal","vertical"])},default:"horizontal"}},data(){return{steps:[]}},computed:{classes(){return[`${mE}`,`${mE}-${this.direction}`,{[`${mE}-${this.size}`]:!!this.size}]},children(){return this.steps.map(c=>c.step)}},methods:{addStep(c,d){this.steps.push({id:c,step:d})},removeStep(c){const d=this.steps.findIndex(g=>g.id===c);this.steps.splice(d,1)}}};function Pue(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes)},[i.renderSlot(c.$slots,"default")],2)}var mB=l(kue,[["render",Pue]]);const $d="ivu-menu",Rue={name:"Submenu",mixins:[rE,za],components:{Icon:S,Drop:Ye,CollapseTransition:cE},provide(){return{SubmenuInstance:this}},props:{name:{type:[String,Number],required:!0},disabled:{type:Boolean,default:!1}},data(){return{prefixCls:$d,active:!1,opened:!1,dropWidth:parseFloat(R(this.$el,"width")),id:j(6),childSubmenuList:[]}},computed:{classes(){return[`${$d}-submenu`,{[`${$d}-item-active`]:this.active&&!this.hasParentSubmenu,[`${$d}-opened`]:this.opened,[`${$d}-submenu-disabled`]:this.disabled,[`${$d}-submenu-has-parent-submenu`]:this.hasParentSubmenu,[`${$d}-child-item-active`]:this.active}]},accordion(){return this.menu.accordion},dropStyle(){let c={};return this.dropWidth&&(c.minWidth=`${this.dropWidth}px`),c},titleStyle(){return this.hasParentSubmenu&&this.mode!=="horizontal"?{paddingLeft:43+(this.parentSubmenuNum-1)*24+"px"}:{}},arrowType(){const c=this.globalConfig;let d="ios-arrow-down";return c&&(c.menu.customArrow?d="":c.menu.arrow&&(d=c.menu.arrow)),d},customArrowType(){const c=this.globalConfig;let d="";return c&&c.menu.customArrow&&(d=c.menu.customArrow),d},arrowSize(){const c=this.globalConfig;let d="";return c&&c.menu.arrowSize&&(d=c.menu.arrowSize),d}},methods:{handleMouseenter(){this.disabled||this.mode!=="vertical"&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.menu.updateOpenKeys(this.name),this.opened=!0},250))},handleMouseleave(){this.disabled||this.mode!=="vertical"&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.menu.updateOpenKeys(this.name),this.opened=!1},150))},handleClick(){if(this.disabled||this.mode==="horizontal")return;const c=this.opened;this.opened=!c,this.menu.updateOpenKeys(this.name)},addSubmenu(){const c=this.MenuInstance;c.submenuList||(c.submenuList=[]),c.submenuList.push({id:this.id,submenu:this});const d=L(this,"Submenu");d&&(d.childSubmenuList||(d.childSubmenuList=[]),d.childSubmenuList.push({id:this.id,submenu:this}))},removeSubmenu(){const c=this.MenuInstance;if(c.submenuList&&c.submenuList.length){const g=c.submenuList.findIndex(M=>M.id===this.id);c.submenuList.splice(g,1)}const d=L(this,"Submenu");if(d&&d.childSubmenuList&&d.childSubmenuList.length){const g=d.childSubmenuList.findIndex(M=>M.id===this.id);d.childSubmenuList.splice(g,1)}},handleMenuItemSelect(c){this.mode==="horizontal"&&(this.opened=!1),this.MenuInstance.handleMenuItemSelect(c)},handleUpdateActiveName(c){L(this,"Submenu")&&this.SubmenuInstance.handleUpdateActiveName(c),this.childSubmenuList&&this.childSubmenuList.length&&this.childSubmenuList.map(d=>d.submenu).forEach(d=>{d.active=!1}),this.active=c}},watch:{mode(c){c==="horizontal"&&this.$refs.drop.update()},opened(c){this.mode!=="vertical"&&(c?(this.dropWidth=parseFloat(R(this.$el,"width")),this.$refs.drop.update()):this.$refs.drop.destroy())}},mounted(){this.addSubmenu()},beforeUnmount(){this.removeSubmenu()}};function Iue(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("collapse-transition"),Y=i.resolveComponent("Drop");return i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(b.classes),onMouseenter:d[1]||(d[1]=(...G)=>b.handleMouseenter&&b.handleMouseenter(...G)),onMouseleave:d[2]||(d[2]=(...G)=>b.handleMouseleave&&b.handleMouseleave(...G))},[i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-submenu-title"]),ref:"reference",onClick:d[0]||(d[0]=i.withModifiers((...G)=>b.handleClick&&b.handleClick(...G),["stop"])),style:i.normalizeStyle(b.titleStyle)},[i.renderSlot(c.$slots,"title"),i.createVNode(B,{type:b.arrowType,custom:b.customArrowType,size:b.arrowSize,class:i.normalizeClass([C.prefixCls+"-submenu-title-icon"])},null,8,["type","custom","size","class"])],6),c.mode==="vertical"?(i.openBlock(),i.createBlock(F,{key:0,ready:c.menu.ready},{default:i.withCtx(()=>[i.withDirectives(i.createElementVNode("ul",{class:i.normalizeClass([C.prefixCls])},[i.renderSlot(c.$slots,"default")],2),[[i.vShow,C.opened]])]),_:3},8,["ready"])):i.createCommentVNode("",!0),c.mode==="horizontal"?(i.openBlock(),i.createBlock(Y,{key:1,ref:"drop",visible:C.opened,placement:"bottom","transition-name":"slide-up",styles:b.dropStyle},{default:i.withCtx(()=>[i.createElementVNode("ul",{class:i.normalizeClass([C.prefixCls+"-drop-list"])},[i.renderSlot(c.$slots,"default")],2)]),_:3},8,["visible","styles"])):i.createCommentVNode("",!0)],34)}var gB=l(Rue,[["render",Iue]]);const vB={name:"Submit",inject:["LoginInstance"],props:{},methods:{handleSubmit(){this.LoginInstance.handleSubmit()}},render(){const c=Object.assign({size:"large",type:"primary",long:!0},this.$attrs),d=i.h(Us,{...c,onClick:this.handleSubmit},this.$slots.default||(()=>"登录"));return i.h("div",{class:"ivu-login-submit"},[d])}},jp="ivu-switch",Nue={name:"iSwitch",mixins:[Ei],emits:["update:modelValue","on-change"],props:{modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:!1},size:{validator(c){return O(c,["large","small","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},name:{type:String},loading:{type:Boolean,default:!1},trueColor:{type:String},falseColor:{type:String},beforeChange:Function},data(){return{currentValue:this.modelValue}},computed:{wrapClasses(){return[`${jp}`,{[`${jp}-checked`]:this.currentValue===this.trueValue,[`${jp}-disabled`]:this.itemDisabled,[`${jp}-${this.size}`]:!!this.size,[`${jp}-loading`]:this.loading}]},wrapStyles(){let c={};return this.trueColor&&this.currentValue===this.trueValue?(c["border-color"]=this.trueColor,c["background-color"]=this.trueColor):this.falseColor&&this.currentValue===this.falseValue&&(c["border-color"]=this.falseColor,c["background-color"]=this.falseColor),c},innerClasses(){return`${jp}-inner`}},methods:{handleToggle(){const c=this.currentValue===this.trueValue?this.falseValue:this.trueValue;this.currentValue=c,this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c)},toggle(c){if(c.preventDefault(),this.itemDisabled||this.loading)return!1;if(!this.beforeChange)return this.handleToggle();const d=this.beforeChange();d&&d.then?d.then(()=>{this.handleToggle()}):this.handleToggle()}},watch:{modelValue(c){if(c!==this.trueValue&&c!==this.falseValue&&c!==null)throw"Value should be trueValue or falseValue.";this.currentValue=c}}},Due=["name","value"];function Lue(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("span",{tabindex:"0",class:i.normalizeClass(b.wrapClasses),style:i.normalizeStyle(b.wrapStyles),onClick:d[0]||(d[0]=(...B)=>b.toggle&&b.toggle(...B)),onKeydown:d[1]||(d[1]=i.withKeys((...B)=>b.toggle&&b.toggle(...B),["space"]))},[i.createElementVNode("input",{type:"hidden",name:g.name,value:C.currentValue},null,8,Due),i.createElementVNode("span",{class:i.normalizeClass(b.innerClasses)},[C.currentValue===g.trueValue?i.renderSlot(c.$slots,"open",{key:0}):i.createCommentVNode("",!0),C.currentValue===g.falseValue?i.renderSlot(c.$slots,"close",{key:1}):i.createCommentVNode("",!0)],2)],38)}var gE=l(Nue,[["render",Lue]]),Bue={name:"TableRenderHeader",props:{render:Function,column:Object,index:Number},render(){const c={column:this.column,index:this.index};return this.render(i.h,c)}},vE={methods:{alignCls(c,d={}){let g="";return d.cellClassName&&c.key&&d.cellClassName[c.key]&&(g=d.cellClassName[c.key]),[`${this.prefixCls}-column-${c.__id}`,{[`${g}`]:g,[`${c.className}`]:c.className,[`${this.prefixCls}-column-${c.align}`]:c.align,[`${this.prefixCls}-hidden`]:this.fixed==="left"&&c.fixed!=="left"||this.fixed==="right"&&c.fixed!=="right"||!this.fixed&&c.fixed&&(c.fixed==="left"||c.fixed==="right")}]},isPopperShow(c){return c.filters&&(!this.fixed&&!c.fixed||this.fixed==="left"&&c.fixed==="left"||this.fixed==="right"&&c.fixed==="right")},setCellWidth(c){let d="";return c.width?d=c.width:this.columnsWidth[c._index]&&(d=this.columnsWidth[c._index].width),d==="0"&&(d=""),d}}};const $ue={name:"TableHead",mixins:[vE,gn],components:{CheckboxGroup:AT,Checkbox:Bp,Poptip:hE,iButton:Us,renderHeader:Bue},props:{prefixCls:String,styleObject:Object,columns:Array,objData:Object,data:Array,columnsWidth:Object,fixed:{type:[Boolean,String],default:!1},columnRows:Array,fixedColumnRows:Array},data(){return{draggingColumn:null,dragging:!1,dragState:{}}},computed:{styles(){const c=Object.assign({},this.styleObject),d=parseInt(this.styleObject.width);return c.width=`${d}px`,c},isSelectAll(){let c=!0;this.data.length||(c=!1);let d=!0;for(let g in this.objData){const M=this.objData[g];if(!M._isChecked&&!M._isDisabled){c=!1;break}else M.children&&M.children.length&&(c=this.isChildrenSelected(M,c));M._isDisabled&&!M._isChecked?M.children&&M.children.length&&(d=this.isChildrenAllDisabledAndUnSelected(M,d)):d=!1}return d&&(c=!1),c},headRows(){return this.columnRows.length>1?this.fixed?this.fixedColumnRows:this.columnRows:[this.columns]},isSelectDisabled(){let c=!0;if(this.data.length)for(let d in this.objData){const g=this.objData[d];g._isDisabled?g.children&&g.children.length&&(c=this.isChildrenDisabled(g,c)):c=!1}return c}},methods:{cellClasses(c){return[`${this.prefixCls}-cell`,{[`${this.prefixCls}-hidden`]:!this.fixed&&c.fixed&&(c.fixed==="left"||c.fixed==="right"),[`${this.prefixCls}-cell-with-selection`]:c.type==="selection"}]},scrollBarCellClass(){let c=!1;for(let d in this.headRows)for(let g in this.headRows[d]){if(this.headRows[d][g].fixed==="right"){c=!0;break}if(c)break}return[{[`${this.prefixCls}-hidden`]:c}]},itemClasses(c,d){return[`${this.prefixCls}-filter-select-item`,{[`${this.prefixCls}-filter-select-item-selected`]:c._filterChecked[0]===d.value}]},itemAllClasses(c){return[`${this.prefixCls}-filter-select-item`,{[`${this.prefixCls}-filter-select-item-selected`]:!c._filterChecked.length}]},selectAll(){const c=!this.isSelectAll;this.$parent.selectAll(c)},handleSort(c,d){const g=this.columns.find(C=>C._index===c),M=g._index;g._sortType===d&&(d="normal"),this.$parent.handleSort(M,d)},handleSortByHead(c){const d=this.columns.find(g=>g._index===c);if(d.sortable){const g=d._sortType;g==="normal"?this.handleSort(c,"asc"):g==="asc"?this.handleSort(c,"desc"):this.handleSort(c,"normal")}},handleFilter(c){this.$parent.handleFilter(c)},handleSelect(c,d){this.$parent.handleFilterSelect(c,d)},handleReset(c){this.$parent.handleFilterReset(c)},handleFilterHide(c){this.$parent.handleFilterHide(c)},getColumn(c,d){if(this.columnRows.length>1){const g=this.headRows[c][d].__id;return this.columns.filter(M=>M.__id===g)[0]}else return this.headRows[c][d]},handleMouseDown(c,d){if(!this.$isServer&&s&&this.draggingColumn){this.dragging=!0;const g=this.$parent,M=g.$el.getBoundingClientRect().left,C=this.$el.querySelector(`th.ivu-table-column-${c.__id}`).getBoundingClientRect(),b=C.left-M+30;g.showResizeLine=!0,this.dragState={startMouseLeft:d.clientX,startLeft:C.right-M,startColumnLeft:C.left-M,tableLeft:M};const B=g.$refs.resizeLine;B.style.left=this.dragState.startLeft+"px",document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const F=G=>{const K=G.clientX-this.dragState.startMouseLeft,fe=this.dragState.startLeft+K;B.style.left=Math.max(b,fe)+"px"},Y=()=>{if(this.dragging){const{startColumnLeft:G,startLeft:K}=this.dragState,fe=parseInt(B.style.left,10)-G,Ee=g.allColumns.find(Ce=>Ce.__id===c.__id);Ee&&(Ee.width=fe,c.width=fe,g.handleResize()),g.$emit("on-column-width-resize",Ee.width,K-G,c,d),s&&(document.body.style.cursor=""),this.dragging=!1,this.draggingColumn=null,this.dragState={},g.showResizeLine=!1}!s||(document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",Y),document.onselectstart=null,document.ondragstart=null)};if(!s)return;document.addEventListener("mousemove",F),document.addEventListener("mouseup",Y)}},handleMouseMove(c,d){let g=d.target;for(;g&&g.tagName!=="TH";)g=g.parentNode;if(!(!c||!c.resizable)&&s&&!this.dragging){let M=g.getBoundingClientRect();const C=document.body.style;M.width>12&&M.right-d.pageX<8?(C.cursor="col-resize",this.draggingColumn=c):this.dragging||(C.cursor="",this.draggingColumn=null)}},handleMouseOut(){this.$isServer||s&&(document.body.style.cursor="")},isChildrenSelected(c,d){let g=d;return c.children&&c.children.length&&c.children.forEach(M=>{!M._isChecked&&!M._isDisabled?g=!1:M.children&&M.children.length&&(g=this.isChildrenSelected(M,g))}),g},isChildrenAllDisabledAndUnSelected(c,d){let g=d;return c.children&&c.children.length&&c.children.forEach(M=>{M._isDisabled&&!M._isChecked?M.children&&M.children.length&&(g=this.isChildrenAllDisabledAndUnSelected(M,g)):g=!1}),g},isChildrenDisabled(c,d){let g=d;return c.children&&c.children.length&&c.children.forEach(M=>{M._isDisabled?M.children&&M.children.length&&(g=this.isChildrenDisabled(M,g)):g=!1}),g}}},Uue=["width"],Vue=["width"],Fue=["colspan","rowspan"],zue={key:0},Xue=["onClick"],Wue=["onClick"],Gue=["onClick"],Hue=["onMousedown","onMousemove"],Que=["rowspan"];function jue(c,d,g,M,C,b){const B=i.resolveComponent("render-header"),F=i.resolveComponent("Checkbox"),Y=i.resolveComponent("checkbox"),G=i.resolveComponent("checkbox-group"),K=i.resolveComponent("i-button"),fe=i.resolveComponent("Poptip");return i.openBlock(),i.createElementBlock("table",{cellspacing:"0",cellpadding:"0",border:"0",style:i.normalizeStyle(b.styles)},[i.createElementVNode("colgroup",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.columns,(Ee,Ce)=>(i.openBlock(),i.createElementBlock("col",{key:Ce,width:c.setCellWidth(Ee)},null,8,Uue))),128)),c.$parent.showVerticalScrollBar?(i.openBlock(),i.createElementBlock("col",{key:0,width:c.$parent.scrollBarWidth},null,8,Vue)):i.createCommentVNode("",!0)]),i.createElementVNode("thead",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.headRows,(Ee,Ce)=>(i.openBlock(),i.createElementBlock("tr",{key:Ce},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(Ee,(Oe,ue)=>(i.openBlock(),i.createElementBlock("th",{key:ue,colspan:Oe.colSpan,rowspan:Oe.rowSpan,class:i.normalizeClass(c.alignCls(Oe))},[i.createElementVNode("div",{class:i.normalizeClass(b.cellClasses(Oe))},[Oe.type==="expand"?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[Oe.renderHeader?(i.openBlock(),i.createBlock(B,{key:1,render:Oe.renderHeader,column:Oe,index:ue},null,8,["render","column","index"])):(i.openBlock(),i.createElementBlock("span",zue,i.toDisplayString(Oe.title||""),1))],64)):Oe.type==="selection"?(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[Oe.hideSelectAll?i.createCommentVNode("",!0):(i.openBlock(),i.createBlock(F,{key:0,"model-value":b.isSelectAll,disabled:b.isSelectDisabled,onOnChange:b.selectAll},null,8,["model-value","disabled","onOnChange"]))],64)):(i.openBlock(),i.createElementBlock(i.Fragment,{key:2},[Oe.renderHeader?(i.openBlock(),i.createBlock(B,{key:1,render:Oe.renderHeader,column:Oe,index:ue},null,8,["render","column","index"])):(i.openBlock(),i.createElementBlock("span",{key:0,class:i.normalizeClass({[g.prefixCls+"-cell-sort"]:Oe.sortable}),onClick:Ne=>Oe.sortable&&b.handleSortByHead(b.getColumn(Ce,ue)._index)},i.toDisplayString(Oe.title||"#"),11,Xue)),Oe.sortable?(i.openBlock(),i.createElementBlock("span",{key:2,class:i.normalizeClass([g.prefixCls+"-sort"])},[i.createElementVNode("i",{class:i.normalizeClass(["ivu-icon ivu-icon-md-arrow-dropup",{on:b.getColumn(Ce,ue)._sortType==="asc"}]),onClick:Ne=>b.handleSort(b.getColumn(Ce,ue)._index,"asc")},null,10,Wue),i.createElementVNode("i",{class:i.normalizeClass(["ivu-icon ivu-icon-md-arrow-dropdown",{on:b.getColumn(Ce,ue)._sortType==="desc"}]),onClick:Ne=>b.handleSort(b.getColumn(Ce,ue)._index,"desc")},null,10,Gue)],2)):i.createCommentVNode("",!0),c.isPopperShow(Oe)?(i.openBlock(),i.createBlock(fe,{key:3,modelValue:b.getColumn(Ce,ue)._filterVisible,"onUpdate:modelValue":Ne=>b.getColumn(Ce,ue)._filterVisible=Ne,placement:"bottom","popper-class":"ivu-table-popper",transfer:"",capture:!1,onOnPopperHide:Ne=>b.handleFilterHide(b.getColumn(Ce,ue)._index)},i.createSlots({default:i.withCtx(()=>[i.createElementVNode("span",{class:i.normalizeClass([g.prefixCls+"-filter"])},[i.createElementVNode("i",{class:i.normalizeClass(["ivu-icon ivu-icon-ios-funnel",{on:b.getColumn(Ce,ue)._isFiltered}])},null,2)],2)]),_:2},[b.getColumn(Ce,ue)._filterMultiple?{name:"content",fn:i.withCtx(()=>[i.createElementVNode("div",{class:i.normalizeClass([g.prefixCls+"-filter-list"])},[i.createElementVNode("div",{class:i.normalizeClass([g.prefixCls+"-filter-list-item"])},[i.createVNode(G,{modelValue:b.getColumn(Ce,ue)._filterChecked,"onUpdate:modelValue":Ne=>b.getColumn(Ce,ue)._filterChecked=Ne},{default:i.withCtx(()=>[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(Oe.filters,(Ne,jt)=>(i.openBlock(),i.createBlock(Y,{key:jt,label:Ne.value},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(Ne.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],2),i.createElementVNode("div",{class:i.normalizeClass([g.prefixCls+"-filter-footer"])},[i.createVNode(K,{type:"text",size:"small",disabled:!b.getColumn(Ce,ue)._filterChecked.length,onClick:Ne=>b.handleFilter(b.getColumn(Ce,ue)._index)},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(c.t("i.table.confirmFilter")),1)]),_:2},1032,["disabled","onClick"]),i.createVNode(K,{type:"text",size:"small",onClick:Ne=>b.handleReset(b.getColumn(Ce,ue)._index)},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(c.t("i.table.resetFilter")),1)]),_:2},1032,["onClick"])],2)],2)]),key:"0"}:{name:"content",fn:i.withCtx(()=>[i.createElementVNode("div",{class:i.normalizeClass([g.prefixCls+"-filter-list"])},[i.createElementVNode("ul",{class:i.normalizeClass([g.prefixCls+"-filter-list-single"])},[i.createElementVNode("li",{class:i.normalizeClass(b.itemAllClasses(b.getColumn(Ce,ue))),onClick:Ne=>b.handleReset(b.getColumn(Ce,ue)._index)},i.toDisplayString(c.t("i.table.clearFilter")),11,["onClick"]),(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(Oe.filters,Ne=>(i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(b.itemClasses(b.getColumn(Ce,ue),Ne)),key:Ne.value,onClick:jt=>b.handleSelect(b.getColumn(Ce,ue)._index,Ne.value)},i.toDisplayString(Ne.label),11,["onClick"]))),128))],2)],2)]),key:"1"}]),1032,["modelValue","onUpdate:modelValue","onOnPopperHide"])):i.createCommentVNode("",!0)],64))],2),Oe.resizable?(i.openBlock(),i.createElementBlock("div",{key:0,class:"ivu-table-header-resizable",onMousedown:Ne=>b.handleMouseDown(Oe,Ne),onMousemove:Ne=>b.handleMouseMove(Oe,Ne),onMouseout:d[0]||(d[0]=(...Ne)=>b.handleMouseOut&&b.handleMouseOut(...Ne))},null,40,Hue)):i.createCommentVNode("",!0)],10,Fue))),128)),c.$parent.showVerticalScrollBar&&Ce===0?(i.openBlock(),i.createElementBlock("th",{key:0,class:i.normalizeClass(b.scrollBarCellClass()),rowspan:b.headRows.length},null,10,Que)):i.createCommentVNode("",!0)]))),128))])],4)}var Yue=l($ue,[["render",jue]]);const que={props:{row:Object,prefixCls:String,draggable:Boolean,isChildren:Boolean},computed:{objData(){return this.$parent.objData}},methods:{onDrag(c,d){c.dataTransfer.setData("index",d)},onDrop(c,d){const g=c.dataTransfer.getData("index");this.$parent.$parent.dragAndDrop(g,d),c.preventDefault()},allowDrop(c){c.preventDefault()},rowClasses(c){const d=this.isChildren?this.$parent.$parent.getDataByRowKey(this.row._rowKey):this.objData[c];return[`${this.prefixCls}-row`,this.rowClsName(c),{[`${this.prefixCls}-row-highlight`]:d&&d._isHighlight,[`${this.prefixCls}-row-hover`]:d&&d._isHover}]},rowClsName(c){return this.$parent.$parent.rowClassName(this.objData[c],c)}}},Zue=["draggable"];function Kue(c,d,g,M,C,b){return g.draggable?(i.openBlock(),i.createElementBlock("tr",{key:0,class:i.normalizeClass(b.rowClasses(g.row._index)),draggable:g.draggable,onDragstart:d[0]||(d[0]=B=>b.onDrag(B,g.row._index)),onDrop:d[1]||(d[1]=B=>b.onDrop(B,g.row._index)),onDragover:d[2]||(d[2]=B=>b.allowDrop(B))},[i.renderSlot(c.$slots,"default")],42,Zue)):(i.openBlock(),i.createElementBlock("tr",{key:1,class:i.normalizeClass(b.rowClasses(g.row._index)),draggable:!1},[i.renderSlot(c.$slots,"default")],2))}var yE=l(que,[["render",Kue]]),bE={name:"TableExpand",props:{row:Object,render:Function,index:Number,column:{type:Object,default:null}},render(){const c={row:this.row,index:this.index};return this.column&&(c.column=this.column),this.render(i.h,c)}},Jue={name:"TableSlot",inject:["TableInstance"],props:{row:Object,index:Number,column:{type:Object,default:null},display:{type:String,default:"block"}},render(){return i.h("div",{class:{"ivu-table-cell-slot":!0,"ivu-table-cell-slot-inline":this.display==="inline","ivu-table-cell-slot-inline-block":this.display==="inline-block"}},this.TableInstance.$slots[this.column.slot]({row:this.row,column:this.column,index:this.index}))}};const ede={name:"TableCell",components:{Icon:S,Checkbox:Bp,TableExpand:bE,TableSlot:Jue,Tooltip:Cc},inject:["TableInstance"],props:{prefixCls:String,row:Object,column:Object,naturalIndex:Number,index:Number,checked:Boolean,disabled:Boolean,expanded:Boolean,fixed:{type:[Boolean,String],default:!1},treeNode:Boolean,treeLevel:{type:Number,default:0}},data(){return{renderType:"",uid:-1,context:this.$parent.$parent.$parent.currentContext,showTooltip:!1}},computed:{classes(){return[`${this.prefixCls}-cell`,{[`${this.prefixCls}-hidden`]:!this.fixed&&this.column.fixed&&(this.column.fixed==="left"||this.column.fixed==="right"),[`${this.prefixCls}-cell-ellipsis`]:this.column.ellipsis||!1,[`${this.prefixCls}-cell-with-expand`]:this.renderType==="expand",[`${this.prefixCls}-cell-with-selection`]:this.renderType==="selection"}]},expandCls(){return[`${this.prefixCls}-cell-expand`,{[`${this.prefixCls}-cell-expand-expanded`]:this.expanded}]},showChildren(){let c=!1;if(this.renderType==="html"||this.renderType==="normal"||this.renderType==="render"||this.renderType==="slot"){const d=this.row;(d.children&&d.children.length||"_loading"in d)&&this.column.tree&&(c=!0)}return c},showTreeNode(){let c=!1;return(this.renderType==="html"||this.renderType==="normal"||this.renderType==="render"||this.renderType==="slot")&&this.column.tree&&this.treeNode&&(c=!0),c},showLevel(){let c=!1;return(this.renderType==="html"||this.renderType==="normal"||this.renderType==="render"||this.renderType==="slot")&&this.column.tree&&this.treeNode&&(c=!0),c},treeLevelStyle(){return{"padding-left":this.treeLevel*this.TableInstance.indentSize+"px"}},childrenExpand(){return this.TableInstance.getDataByRowKey(this.row._rowKey)._isShowChildren},childrenLoading(){const c=this.TableInstance.getDataByRowKey(this.row._rowKey);return"_loading"in c&&c._loading}},methods:{toggleSelect(){this.treeNode?this.$parent.$parent.$parent.toggleSelect(this.index,this.row._rowKey):this.$parent.$parent.$parent.toggleSelect(this.index)},toggleExpand(){this.$parent.$parent.$parent.toggleExpand(this.index)},handleClick(){},handleTooltipIn(){if(!s)return;const c=this.$refs.content;let d=document.createRange();d.setStart(c,0),d.setEnd(c,c.childNodes.length);const g=d.getBoundingClientRect().width;this.showTooltip=g>c.offsetWidth,d=null},handleToggleTree(){this.$parent.$parent.$parent.toggleTree(this.row._rowKey)}},created(){this.column.type==="index"?this.renderType="index":this.column.type==="selection"?this.renderType="selection":this.column.type==="html"?this.renderType="html":this.column.type==="expand"?this.renderType="expand":this.column.render?this.renderType="render":this.column.slot?this.renderType="slot":this.renderType="normal"}},tde={key:0},ide={key:4,class:"ivu-table-cell-tree ivu-table-cell-tree-empty"},nde=["innerHTML"],rde={key:1};function sde(c,d,g,M,C,b){const B=i.resolveComponent("Checkbox"),F=i.resolveComponent("Icon"),Y=i.resolveComponent("Tooltip"),G=i.resolveComponent("table-expand"),K=i.resolveComponent("table-slot");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),ref:"cell"},[C.renderType==="index"?(i.openBlock(),i.createElementBlock("span",tde,i.toDisplayString(g.column.indexMethod?g.column.indexMethod(g.row,g.naturalIndex):g.naturalIndex+1),1)):i.createCommentVNode("",!0),C.renderType==="selection"?(i.openBlock(),i.createBlock(B,{key:1,"model-value":g.checked,onClick:i.withModifiers(b.handleClick,["stop"]),onOnChange:b.toggleSelect,disabled:g.disabled},null,8,["model-value","onClick","onOnChange","disabled"])):i.createCommentVNode("",!0),b.showLevel?(i.openBlock(),i.createElementBlock("div",{key:2,class:"ivu-table-cell-tree-level",style:i.normalizeStyle(b.treeLevelStyle)},null,4)):i.createCommentVNode("",!0),b.showChildren?(i.openBlock(),i.createElementBlock("div",{key:3,class:i.normalizeClass(["ivu-table-cell-tree",{"ivu-table-cell-tree-loading":b.childrenLoading}]),onClick:d[0]||(d[0]=i.withModifiers((...fe)=>b.handleToggleTree&&b.handleToggleTree(...fe),["prevent","stop"]))},[b.childrenLoading?(i.openBlock(),i.createBlock(F,{key:0,type:"ios-loading",class:"ivu-load-loop"})):b.childrenExpand?(i.openBlock(),i.createBlock(F,{key:2,type:"ios-remove"})):(i.openBlock(),i.createBlock(F,{key:1,type:"ios-add"}))],2)):b.showTreeNode?(i.openBlock(),i.createElementBlock("div",ide)):i.createCommentVNode("",!0),C.renderType==="html"?(i.openBlock(),i.createElementBlock("span",{key:5,innerHTML:g.row[g.column.key]},null,8,nde)):i.createCommentVNode("",!0),C.renderType==="normal"?(i.openBlock(),i.createElementBlock(i.Fragment,{key:6},[g.column.tooltip?(i.openBlock(),i.createBlock(Y,{key:0,transfer:"",content:g.row[g.column.key],theme:g.column.tooltipTheme?g.column.tooltipTheme:b.TableInstance.tooltipTheme,disabled:!C.showTooltip,"max-width":g.column.tooltipMaxWidth?g.column.tooltipMaxWidth:b.TableInstance.tooltipMaxWidth,class:"ivu-table-cell-tooltip"},{default:i.withCtx(()=>[i.createElementVNode("span",{ref:"content",onMouseenter:d[1]||(d[1]=(...fe)=>b.handleTooltipIn&&b.handleTooltipIn(...fe)),class:"ivu-table-cell-tooltip-content"},i.toDisplayString(g.row[g.column.key]),545)]),_:1},8,["content","theme","disabled","max-width"])):(i.openBlock(),i.createElementBlock("span",rde,i.toDisplayString(g.row[g.column.key]),1))],64)):i.createCommentVNode("",!0),C.renderType==="expand"&&!g.row._disableExpand?(i.openBlock(),i.createElementBlock("div",{key:7,class:i.normalizeClass(b.expandCls),onClick:d[2]||(d[2]=(...fe)=>b.toggleExpand&&b.toggleExpand(...fe))},[i.createVNode(F,{type:"ios-arrow-forward"})],2)):i.createCommentVNode("",!0),C.renderType==="render"?(i.openBlock(),i.createBlock(G,{key:8,row:g.row,column:g.column,index:g.index,render:g.column.render},null,8,["row","column","index","render"])):i.createCommentVNode("",!0),C.renderType==="slot"?(i.openBlock(),i.createBlock(K,{key:9,row:g.row,column:g.column,display:g.column.display||"block",index:g.index},null,8,["row","column","display","index"])):i.createCommentVNode("",!0)],2)}var xE=l(ede,[["render",sde]]);const ode={name:"TableBody",mixins:[vE],components:{TableCell:xE,Expand:bE,TableTr:yE},props:{prefixCls:String,styleObject:Object,columns:Array,data:Array,objData:Object,columnsWidth:Object,fixed:{type:[Boolean,String],default:!1},draggable:{type:Boolean,default:!1},rowKey:{type:[Boolean,String],default:!1}},computed:{expandRender(){let c=function(){return""};for(let d=0;d<this.columns.length;d++){const g=this.columns[d];g.type&&g.type==="expand"&&g.render&&(c=g.render)}return c}},methods:{rowChecked(c){return this.objData[c]&&this.objData[c]._isChecked},rowDisabled(c){return this.objData[c]&&this.objData[c]._isDisabled},rowExpanded(c){return this.objData[c]&&this.objData[c]._isExpanded},rowStatusByRowKey(c,d){return this.$parent.getDataByRowKey(d)[c]},handleMouseIn(c,d,g){d.stopPropagation(),this.$parent.handleMouseIn(c,g)},handleMouseOut(c,d,g){d.stopPropagation(),this.$parent.handleMouseOut(c,g)},clickCurrentRow(c,d,g){this.$parent.clickCurrentRow(c,g)},dblclickCurrentRow(c,d,g){d.stopPropagation(),this.$parent.dblclickCurrentRow(c,g)},clickCell(c,d,g,M){this.$parent.$emit("on-cell-click",c,d,c[g],M)},contextmenuCurrentRow(c,d,g){d.stopPropagation(),this.$parent.contextMenu&&d.preventDefault(),this.$parent.contextmenuCurrentRow(c,g,d)},selectStartCurrentRow(){this.$parent.contextMenu},getSpan(c,d,g,M){const C=this.$parent.spanMethod;if(typeof C=="function"){const b=C({row:c,column:d,rowIndex:g,columnIndex:M});let B=1,F=1;return Array.isArray(b)?(B=b[0],F=b[1]):typeof b=="object"&&(B=b.rowspan,F=b.colspan),{rowspan:B,colspan:F}}else return{}},showWithSpan(c,d,g,M){const C=this.getSpan(c,d,g,M);return!("rowspan"in C&&C.rowspan===0||"colspan"in C&&C.colspan===0)},isTrShow(c){let d=!0,g;for(let M in this.objData){const C=this.objData[M],b=C._isShowChildren;if(C._rowKey===c){d=d&&b;break}else if(C.children&&C.children.length&&(g=this.getTrStatus(c,C,d&&b),g[0]&&g[0]._rowKey===c))return g[1]}return d},getTrStatus(c,d,g){let M=g,C;if(d.children&&d.children.length)for(let b=0;b<d.children.length;b++){const B=d.children[b],F=B._isShowChildren;if(B._rowKey===c){C=B,M=M&&F;break}else if(B.children&&B.children.length){const Y=this.getTrStatus(c,B,M&&F);if(Y[0]&&Y[0]._rowKey===c)return Y}}return[C,M]},getLevel(c){let d,g;for(let M=0;M<this.data.length;M++){const C=this.data[M];if(C[this.rowKey]===c){d=0;break}else if(C.children&&C.children.length&&(g=this.getChildLevel(C,c,1),g[0]&&g[0][this.rowKey]===c))return g[1]}return d},getChildLevel(c,d,g){let M,C;if(c.children&&c.children.length)for(let b=0;b<c.children.length;b++){const B=c.children[b];if(B[this.rowKey]===d){C=B,M=g;break}else if(B.children&&B.children.length){const F=this.getChildLevel(B,d,g+1);if(F[0]&&F[0][this.rowKey]===d)return F}}return[C,M]},getChildNode(c,d,g){return d.children&&d.children.length&&d.children.forEach((M,C)=>{let b=[];this.columns.forEach((Y,G)=>{if(this.showWithSpan(M,Y,C,G)){const K=c(xE,{fixed:this.fixed,"prefix-cls":this.prefixCls,row:M,column:Y,"natural-index":C,index:M._index,checked:this.rowStatusByRowKey("_isChecked",M._rowKey),disabled:this.rowStatusByRowKey("_isDisabled",M._rowKey),expanded:this.rowStatusByRowKey("_isExpanded",M._rowKey),treeNode:!0,treeLevel:this.getLevel(M._rowKey),key:Y._columnKey}),fe=c("td",{class:this.alignCls(Y,M),...this.getSpan(M,Y,C,G),onClick:Ee=>this.clickCell(M,Y,Y.key,Ee)},[K]);b.push(fe)}});const B={};this.isTrShow(d._rowKey)||(B.display="none");const F=c(yE,{draggable:!1,row:M,"prefix-cls":this.prefixCls,isChildren:!0,style:B,key:this.rowKey?M._rowKey:C,onMouseenter:Y=>this.handleMouseIn(M._index,Y,M._rowKey),onMouseleave:Y=>this.handleMouseOut(M._index,Y,M._rowKey),onClick:Y=>this.clickCurrentRow(M._index,Y,M._rowKey),onDblclick:Y=>this.dblclickCurrentRow(M._index,Y,M._rowKey),onContextmenu:Y=>this.contextmenuCurrentRow(M._index,Y,M._rowKey),onSelectstart:Y=>this.selectStartCurrentRow(M._index,Y,M._rowKey)},()=>b);g.push(F),M.children&&M.children.length&&this.getChildNode(c,M,g)}),g}},render(){let c=[];this.columns.forEach(C=>{const b=i.h("col",{width:this.setCellWidth(C)});c.push(b)});const d=i.h("colgroup",{},c);let g=[];this.data.forEach((C,b)=>{let B=[];this.columns.forEach((Y,G)=>{if(this.showWithSpan(C,Y,b,G)){const K=i.h(xE,{fixed:this.fixed,"prefix-cls":this.prefixCls,row:C,column:Y,"natural-index":b,index:C._index,checked:this.rowChecked(C._index),disabled:this.rowDisabled(C._index),expanded:this.rowExpanded(C._index),key:Y._columnKey}),fe=i.h("td",{class:this.alignCls(Y,C),...this.getSpan(C,Y,b,G),onClick:Ee=>this.clickCell(C,Y,Y.key,Ee)},[K]);B.push(fe)}});const F=i.h(yE,{draggable:this.draggable,row:C,"prefix-cls":this.prefixCls,key:this.rowKey?C._rowKey:b,onMouseenter:Y=>this.handleMouseIn(C._index,Y),onMouseleave:Y=>this.handleMouseOut(C._index,Y),onClick:Y=>this.clickCurrentRow(C._index,Y),onDblclick:Y=>this.dblclickCurrentRow(C._index,Y),onContextmenu:Y=>this.contextmenuCurrentRow(C._index,Y),onSelectstart:Y=>this.selectStartCurrentRow(C._index,Y)},()=>B);if(g.push(F),this.rowExpanded(C._index)){const Y=i.h(bE,{row:C,render:this.expandRender,index:C._index,key:this.rowKey?C._rowKey:b}),G=i.h("td",{colspan:this.columns.length,class:this.prefixCls+"-expanded-cell"},[Y]),K=i.h("tr",{class:{[this.prefixCls+"-expanded-hidden"]:this.fixed}},[G]);g.push(K)}C.children&&C.children.length&&this.getChildNode(i.h,C,[]).forEach(Y=>{g.push(Y)})});const M=i.h("tbody",{class:this.prefixCls+"-tbody"},[g]);return i.h("table",{cellspacing:"0",cellpadding:"0",border:"0",style:this.styleObject},[d,M])}},ade={name:"TableSummary",mixins:[vE],props:{prefixCls:String,styleObject:Object,columns:Array,data:Object,columnsWidth:Object,fixed:{type:[Boolean,String],default:!1}},methods:{cellCls(c){return[{"ivu-table-hidden":this.fixed==="left"&&c.fixed!=="left"||this.fixed==="right"&&c.fixed!=="right"||!this.fixed&&c.fixed&&(c.fixed==="left"||c.fixed==="right")}]}}},lde={style:{overflow:"hidden"}},cde=["width"],hde={class:"ivu-table-row"};function ude(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("div",lde,[i.createElementVNode("table",{class:"ivu-table-summary",cellspacing:"0",cellpadding:"0",border:"0",style:i.normalizeStyle(g.styleObject)},[i.createElementVNode("colgroup",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.columns,(B,F)=>(i.openBlock(),i.createElementBlock("col",{key:F,width:c.setCellWidth(B)},null,8,cde))),128))]),i.createElementVNode("tbody",{class:i.normalizeClass([g.prefixCls+"-tbody"])},[i.createElementVNode("tr",hde,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.columns,(B,F)=>(i.openBlock(),i.createElementBlock("td",{key:F,class:i.normalizeClass(c.alignCls(B))},[i.createElementVNode("div",{class:i.normalizeClass(["ivu-table-cell",b.cellCls(B)])},[i.createElementVNode("span",null,i.toDisplayString(g.data[B.key].value),1)],2)],2))),128))])],2)],4)])}var dde=l(ade,[["render",ude]]);const fde=`\r
`,wE=(c,d,{separator:g,quoted:M})=>{const C=d.map(b=>M?(b=typeof b=="string"?b.replace(/"/g,'"'):b,`"${b}"`):b);c.push(C.join(g))},pde={separator:",",quoted:!1};function mde(c,d,g,M=!1){g=Object.assign({},pde,g);let C;const b=[],B=[];return c?(C=c.map(F=>typeof F=="string"?F:(M||B.push(typeof F.title<"u"?F.title:F.key),F.key)),B.length>0&&wE(b,B,g)):(C=[],d.forEach(F=>{Array.isArray(F)||(C=C.concat(Object.keys(F)))}),C.length>0&&(C=C.filter((F,Y,G)=>G.indexOf(F)===Y),M||wE(b,C,g))),Array.isArray(d)&&d.forEach(F=>{Array.isArray(F)||(F=C.map(Y=>typeof F[Y]<"u"?F[Y]:"")),wE(b,F,g)}),b.join(fde)}function _E(c){const d=navigator.userAgent;return d.indexOf("compatible")>-1&&d.indexOf("MSIE")>-1?(new RegExp("MSIE (\\d+\\.\\d+);").test(d),parseFloat(RegExp.$1)):!1}const gde={_isIE11(){let c=0;const d=/MSIE (\d+\.\d+);/.test(navigator.userAgent),g=!!navigator.userAgent.match(/Trident\/7.0/),M=navigator.userAgent.indexOf("rv:11.0");return d&&(c=Number(RegExp.$1)),navigator.appVersion.indexOf("MSIE 10")!==-1&&(c=10),g&&M!==-1&&(c=11),c===11},_isEdge(){return/Edge/.test(navigator.userAgent)},_getDownloadUrl(c){const d="\uFEFF";if(s&&window.Blob&&window.URL&&window.URL.createObjectURL){const g=new Blob([d+c],{type:"text/csv"});return URL.createObjectURL(g)}else return"data:attachment/csv;charset=utf-8,"+d+encodeURIComponent(c)},download(c,d){if(s)if(_E()&&_E()<10){const g=window.top.open("about:blank","_blank");g.document.charset="utf-8",g.document.write(d),g.document.close(),g.document.execCommand("SaveAs",c),g.close()}else if(_E()===10||this._isIE11()||this._isEdge()){const g="\uFEFF",M=new Blob([g+d],{type:"text/csv"});navigator.msSaveBlob(M,c)}else{const g=document.createElement("a");g.download=c,g.href=this._getDownloadUrl(d),document.body.appendChild(g),g.click(),document.body.removeChild(g)}}},Jx=(c,d)=>{let g=[],M=[];return c.forEach(C=>{C.fixed&&C.fixed===d?g.push(C):M.push(C)}),g.concat(M)},iv=(c,d=!1)=>{const g=$(c),M=[];return g.forEach(C=>{C.children?(d&&M.push(C),M.push.apply(M,iv(C.children,d))):M.push(C)}),M},vde=(c,d=!1)=>{const g=$(d?d==="left"?Jx(c,"left"):Jx(c,"right"):c);let M=1;const C=(B,F)=>{if(F&&(B.level=F.level+1,M<B.level&&(M=B.level)),B.children){let Y=0;B.children.forEach(G=>{C(G,B),Y+=G.colSpan}),B.colSpan=Y}else B.colSpan=1};g.forEach(B=>{B.level=1,C(B)});const b=[];for(let B=0;B<M;B++)b.push([]);return iv(g,!0).forEach(B=>{B.children?B.rowSpan=1:B.rowSpan=M-B.level+1,b[B.level-1].push(B)}),b},yde=function(c=32){const d="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",g=d.length;let M="";for(let C=0;C<c;C++)M+=d.charAt(Math.floor(Math.random()*g));return M},jr="ivu-table";let yB=1,bde=1;const xde={name:"Table",mixins:[gn],components:{tableHead:Yue,tableBody:ode,tableSummary:dde,Spin:Bo,Dropdown:Rd,DropdownMenu:Id},emits:["on-current-change","on-row-click","on-row-dblclick","on-contextmenu","on-select","on-select-cancel","on-selection-change","on-expand","on-expand-tree","on-select-all","on-select-all-cancel","on-sort-change","on-filter-change","on-drag-drop","on-cell-click","on-column-width-resize"],provide(){return{TableInstance:this}},inject:{TabsInstance:{default:null},ModalInstance:{default:null},DrawerInstance:{default:null}},props:{data:{type:Array,default(){return[]}},columns:{type:Array,default(){return[]}},size:{validator(c){return O(c,["small","large","default"])},default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},width:{type:[Number,String]},height:{type:[Number,String]},maxHeight:{type:[Number,String]},stripe:{type:Boolean,default:!1},border:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},highlightRow:{type:Boolean,default:!1},rowClassName:{type:Function,default(){return""}},context:{type:Object},noDataText:{type:String},noFilteredDataText:{type:String},disabledHover:{type:Boolean},loading:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},tooltipTheme:{validator(c){return O(c,["dark","light"])},default:"dark"},tooltipMaxWidth:{type:Number,default:300},rowKey:{type:[Boolean,String],default:!1},spanMethod:{type:Function},showSummary:{type:Boolean,default:!1},summaryMethod:{type:Function},sumText:{type:String},indentSize:{type:Number,default:16},loadData:{type:Function},updateShowChildren:{type:Boolean,default:!1},contextMenu:{type:Boolean,default:!1},showContextMenu:{type:Boolean,default:!1},fixedShadow:{validator(c){return O(c,["auto","show","hide"])},default:"show"},autoCloseContextmenu:{type:Boolean,default:!0}},data(){const c=this.makeColumnsId(this.columns);return{ready:!1,tableWidth:0,columnsWidth:{},prefixCls:jr,compiledUids:[],objData:this.makeObjData(),rebuildData:[],cloneColumns:this.makeColumns(c),columnRows:this.makeColumnRows(!1,c),leftFixedColumnRows:this.makeColumnRows("left",c),rightFixedColumnRows:this.makeColumnRows("right",c),allColumns:iv(c),showSlotHeader:!0,showSlotFooter:!0,bodyHeight:0,scrollBarWidth:T(),currentContext:this.context,cloneData:$(this.data),showVerticalScrollBar:!1,showHorizontalScrollBar:!1,headerWidth:0,headerHeight:0,showResizeLine:!1,contextMenuVisible:!1,contextMenuStyles:{top:0,left:0},scrollOnTheLeft:!1,scrollOnTheRight:!1,id:j(6)}},computed:{localeNoDataText(){return this.noDataText===void 0?this.t("i.table.noDataText"):this.noDataText},localeNoFilteredDataText(){return this.noFilteredDataText===void 0?this.t("i.table.noFilteredDataText"):this.noFilteredDataText},localeSumText(){return this.sumText===void 0?this.t("i.table.sumText"):this.sumText},wrapClasses(){return[`${jr}-wrapper`,{[`${jr}-hide`]:!this.ready,[`${jr}-with-header`]:this.showSlotHeader,[`${jr}-with-footer`]:this.showSlotFooter,[`${jr}-with-summary`]:this.showSummary,[`${jr}-wrapper-with-border`]:this.border}]},classes(){return[`${jr}`,{[`${jr}-${this.size}`]:!!this.size,[`${jr}-border`]:this.border,[`${jr}-stripe`]:this.stripe,[`${jr}-with-fixed-top`]:!!this.height}]},fixedTableClasses(){return[`${jr}-fixed`,{[`${jr}-fixed-shadow`]:this.fixedShadow==="show"||this.fixedShadow==="auto"&&!this.scrollOnTheLeft}]},fixedRightTableClasses(){return[`${jr}-fixed-right`,{[`${jr}-fixed-shadow`]:this.fixedShadow==="show"||this.fixedShadow==="auto"&&!this.scrollOnTheRight}]},fixedHeaderClasses(){return[`${jr}-fixed-header`,{[`${jr}-fixed-header-with-empty`]:!this.rebuildData.length}]},styles(){let c={},d=0;if(this.showSummary&&(this.size==="small"?d=40:this.size==="large"?d=60:d=48),this.height){let g=parseInt(this.height)+d;c.height=`${g}px`}if(this.maxHeight){const g=parseInt(this.maxHeight)+d;c.maxHeight=`${g}px`}return this.width&&(c.width=`${this.width}px`),c},tableStyle(){let c={};if(this.tableWidth!==0){let d="";this.bodyHeight===0?d=this.tableWidth:d=this.tableWidth-(this.showVerticalScrollBar?this.scrollBarWidth:0),c.width=`${d}px`}return c},tableHeaderStyle(){let c={};if(this.tableWidth!==0){let d="";d=this.tableWidth,c.width=`${d}px`}return c},fixedTableStyle(){let c={},d=0;return this.leftFixedColumns.forEach(g=>{g.fixed&&g.fixed==="left"&&(d+=g._width)}),c.width=`${d}px`,c},fixedRightTableStyle(){let c={},d=0;return this.rightFixedColumns.forEach(g=>{g.fixed&&g.fixed==="right"&&(d+=g._width)}),c.width=`${d}px`,c.right=`${this.showVerticalScrollBar?this.scrollBarWidth:0}px`,c},fixedRightHeaderStyle(){let c={},d=0,g=this.headerHeight+1;return this.showVerticalScrollBar&&(d=this.scrollBarWidth),c.width=`${d}px`,c.height=`${g}px`,c},bodyStyle(){let c={};if(this.bodyHeight!==0){const d=this.bodyHeight;this.height?c.height=`${d}px`:this.maxHeight&&(c.maxHeight=`${d}px`)}return c},fixedBodyStyle(){let c={};if(this.bodyHeight!==0){let d=this.bodyHeight-(this.showHorizontalScrollBar?this.scrollBarWidth:0);const g=this.showHorizontalScrollBar?`${d}px`:`${d-1}px`;this.height?c.height=g:this.maxHeight&&(c.maxHeight=g)}return c},leftFixedColumns(){return Jx(this.cloneColumns,"left")},rightFixedColumns(){return Jx(this.cloneColumns,"right")},isLeftFixed(){return this.columns.some(c=>c.fixed&&c.fixed==="left")},isRightFixed(){return this.columns.some(c=>c.fixed&&c.fixed==="right")},summaryData(){if(!this.showSummary)return{};let c={};return this.summaryMethod?c=this.summaryMethod({columns:this.cloneColumns,data:this.rebuildData}):this.cloneColumns.forEach((d,g)=>{const M=d.key;if(g===0){c[M]={key:d.key,value:this.localeSumText};return}const C=this.rebuildData.map(Y=>Number(Y[d.key])),b=[];let B=!0;C.forEach(Y=>{if(!isNaN(Y)){B=!1;let G=(""+Y).split(".")[1];b.push(G?G.length:0)}});const F=Math.max.apply(null,b);if(B)c[M]={key:d.key,value:""};else{const Y=C.reduce((G,K)=>{const fe=Number(K);return isNaN(fe)?G:parseFloat((G+K).toFixed(Math.min(F,20)))},0);c[M]={key:d.key,value:Y}}}),c}},methods:{rowClsName(c){return this.rowClassName(this.data[c],c)},handleResize(){let c=this.$el.offsetWidth-1,d={},g=0,M=[],C=[],b=[];this.cloneColumns.forEach(K=>{K.width?M.push(K):(C.push(K),K.minWidth&&(g+=K.minWidth),K.maxWidth||b.push(K)),K._width=null});let B=M.map(K=>K.width).reduce((K,fe)=>K+fe,0),F=c-B-g-(this.showVerticalScrollBar?this.scrollBarWidth:0)-1,Y=C.length,G=0;F>0&&Y>0&&(G=parseInt(F/Y));for(let K=0;K<this.cloneColumns.length;K++){const fe=this.cloneColumns[K];let Ee=G+(fe.minWidth?fe.minWidth:0);fe.width?Ee=fe.width:fe._width?Ee=fe._width:(fe.minWidth>Ee?Ee=fe.minWidth:fe.maxWidth<Ee&&(Ee=fe.maxWidth),F>0?(F-=Ee-(fe.minWidth?fe.minWidth:0),Y--,Y>0?G=parseInt(F/Y):G=0):G=0),fe._width=Ee,d[fe._index]={width:Ee}}if(F>0){Y=b.length,G=parseInt(F/Y);for(let K=0;K<b.length;K++){const fe=b[K];let Ee=fe._width+G;Y>1?(Y--,F-=G,G=parseInt(F/Y)):G=0,fe._width=Ee,d[fe._index]={width:Ee}}}this.tableWidth=this.cloneColumns.map(K=>K._width).reduce((K,fe)=>K+fe,0)+(this.showVerticalScrollBar?this.scrollBarWidth:0)+1,this.columnsWidth=d,this.fixedHeader(),this.fixedShadow==="auto"&&i.nextTick(()=>{const K=this.$refs.body;this.scrollOnTheLeft=K.scrollLeft===0,this.scrollOnTheRight=K.scrollWidth===K.scrollLeft+K.clientWidth})},handleMouseIn(c,d){if(this.disabledHover)return;const g=d?this.getDataByRowKey(d):this.objData[c];g._isHover||(g._isHover=!0)},handleMouseOut(c,d){if(this.disabledHover)return;const g=d?this.getDataByRowKey(d):this.objData[c];g._isHover=!1},handleCurrentRow(c,d,g){const M=g?this.getDataByRowKey(g):this.objData[d];let C=null,b=-1;for(let F in this.objData)if(this.objData[F]._isHighlight){b=parseInt(F),this.objData[F]._isHighlight=!1;break}else if(this.objData[F].children&&this.objData[F].children.length){const Y=this.handleResetChildrenRow(this.objData[F]);Y&&(C=JSON.parse(JSON.stringify(Y)))}c==="highlight"&&(M._isHighlight=!0),b>=0&&(C=JSON.parse(JSON.stringify(this.cloneData[b])));const B=c==="highlight"?JSON.parse(JSON.stringify(g?this.getBaseDataByRowKey(g):this.cloneData[d])):null;this.$emit("on-current-change",B,C)},handleResetChildrenRow(c){let d=null;if(c.children&&c.children.length)for(let g=0;g<c.children.length;g++){const M=c.children[g];if(M._isHighlight){M._isHighlight=!1,d=M;break}else M.children&&M.children.length&&(d=this.handleResetChildrenRow(M))}return d},highlightCurrentRow(c,d){const g=d?this.getDataByRowKey(d):this.objData[c];!this.highlightRow||g._isHighlight||this.handleCurrentRow("highlight",c,d)},clearCurrentRow(){!this.highlightRow||this.handleCurrentRow("clear")},clickCurrentRow(c,d){this.highlightCurrentRow(c,d),d?this.$emit("on-row-click",JSON.parse(JSON.stringify(this.getBaseDataByRowKey(d)))):this.$emit("on-row-click",JSON.parse(JSON.stringify(this.cloneData[c])),c)},dblclickCurrentRow(c,d){this.highlightCurrentRow(c,d),d?this.$emit("on-row-dblclick",JSON.parse(JSON.stringify(this.getBaseDataByRowKey(d)))):this.$emit("on-row-dblclick",JSON.parse(JSON.stringify(this.cloneData[c])),c)},contextmenuCurrentRow(c,d,g){this.contextMenuVisible&&this.handleClickContextMenuOutside(),i.nextTick(()=>{const M=this.$refs.tableWrap.getBoundingClientRect(),C={left:`${g.clientX-M.left}px`,top:`${g.clientY-M.top}px`};this.contextMenuStyles=C,this.contextMenuVisible=!0,d?this.$emit("on-contextmenu",JSON.parse(JSON.stringify(this.getBaseDataByRowKey(d))),g,C):this.$emit("on-contextmenu",JSON.parse(JSON.stringify(this.cloneData[c])),g,C)})},getSelection(){let c=[],d=[];for(let M in this.objData){const C=this.objData[M];C._isChecked&&c.push(parseInt(M)),C.children&&C.children.length&&(d=d.concat(this.getSelectionChildrenRowKeys(C,d)))}d=[...new Set(d)];let g=[];return this.data.forEach((M,C)=>{c.indexOf(C)>-1&&(g=g.concat(M)),M.children&&M.children.length&&d.length&&(g=g.concat(this.getSelectionChildren(M,g,d)))}),g=[...new Set(g)],JSON.parse(JSON.stringify(g))},getSelectionChildrenRowKeys(c,d){return c.children&&c.children.length&&c.children.forEach(g=>{g._isChecked&&d.push(g._rowKey),g.children&&g.children.length&&(d=d.concat(this.getSelectionChildrenRowKeys(g,d)))}),d},getSelectionChildren(c,d,g){return c.children&&c.children.length&&c.children.forEach(M=>{g.indexOf(M[this.rowKey])>-1&&(d=d.concat(M)),M.children&&M.children.length&&(d=d.concat(this.getSelectionChildren(M,d,g)))}),d},toggleSelect(c,d){let g={};if(d)g=this.getDataByRowKey(d);else for(let B in this.objData)if(parseInt(B)===c){g=this.objData[B];break}const M=!g._isChecked;g._isChecked=M;const C=this.getSelection(),b=d?this.getBaseDataByRowKey(d,this.data):this.data[c];this.$emit(M?"on-select":"on-select-cancel",C,JSON.parse(JSON.stringify(b))),this.$emit("on-selection-change",C)},toggleExpand(c){let d={};for(let M in this.objData)if(parseInt(M)===c){d=this.objData[M];break}const g=!d._isExpanded;this.objData[c]._isExpanded=g,this.$emit("on-expand",JSON.parse(JSON.stringify(this.cloneData[c])),g),(this.height||this.maxHeight)&&i.nextTick(()=>this.fixedBody())},toggleTree(c){const d=this.getDataByRowKey(c);if(!("_loading"in d&&d._loading)){if("_loading"in d&&!d._loading&&d.children.length===0){const g=this.getBaseDataByRowKey(c,this.data);g._loading=!0,this.loadData(g,M=>{g._loading=!1,M.length&&(g.children=M,i.nextTick(()=>{const C=this.getDataByRowKey(c);C._isShowChildren=!C._isShowChildren,this.updateDataStatus(c,"_showChildren",C._isShowChildren)}))});return}d._isShowChildren=!d._isShowChildren,this.updateShowChildren&&this.updateDataStatus(c,"_showChildren",d._isShowChildren),this.$emit("on-expand-tree",c,d._isShowChildren)}},updateDataStatus(c,d,g){const M=this.getBaseDataByRowKey(c,this.data);M[d]=g},getDataByRowKey(c,d=this.objData){let g=null;for(let M in d){const C=d[M];if(C._rowKey===c){g=C;break}else if(C.children&&C.children.length&&(g=this.getChildrenByRowKey(c,C),g))break}return g},getChildrenByRowKey(c,d){let g=null;if(d.children&&d.children.length)for(let M=0;M<d.children.length;M++){const C=d.children[M];if(C._rowKey===c){g=C;break}else if(C.children&&C.children.length&&(g=this.getChildrenByRowKey(c,C),g))break}return g},getBaseDataByRowKey(c,d=this.cloneData){let g=null;for(let M=0;M<d.length;M++){const C=d[M];if(C[this.rowKey]===c){g=C;break}else if(C.children&&C.children.length&&(g=this.getChildrenDataByRowKey(c,C),g&&g[this.rowKey]===c))return g}return g},getChildrenDataByRowKey(c,d){let g=null;if(d.children&&d.children.length)for(let M=0;M<d.children.length;M++){const C=d.children[M];if(C[this.rowKey]===c){g=C;break}else if(C.children&&C.children.length&&(g=this.getChildrenDataByRowKey(c,C),g))break}return g},selectAll(c){for(const g of this.rebuildData){const M=this.objData[g._index];M._isDisabled||(M._isChecked=c),g.children&&g.children.length&&this.selectAllChildren(M,c)}const d=this.getSelection();c?this.$emit("on-select-all",d):this.$emit("on-select-all-cancel",d),this.$emit("on-selection-change",d)},selectAllChildren(c,d){c.children&&c.children.length&&c.children.map(g=>{g._isDisabled||(g._isChecked=d),g.children&&g.children.length&&this.selectAllChildren(g,d)})},fixedHeader(){this.height||this.maxHeight?i.nextTick(()=>{const c=parseInt(R(this.$refs.title,"height"))||0,d=parseInt(R(this.$refs.header,"height"))||0,g=parseInt(R(this.$refs.footer,"height"))||0;this.height?this.bodyHeight=this.height-c-d-g:this.maxHeight&&(this.bodyHeight=this.maxHeight-c-d-g),i.nextTick(()=>this.fixedBody())}):(this.bodyHeight=0,i.nextTick(()=>this.fixedBody()))},fixedBody(){if(this.$refs.header&&(this.headerWidth=this.$refs.header.children[0].offsetWidth,this.headerHeight=this.$refs.header.children[0].offsetHeight),!this.$refs.tbody||!this.data||this.data.length===0)this.showVerticalScrollBar=!1;else{let c=this.$refs.tbody.$el,d=c.parentElement,g=c.offsetHeight,M=d.offsetHeight;this.showHorizontalScrollBar=d.offsetWidth<c.offsetWidth+(this.showVerticalScrollBar?this.scrollBarWidth:0),this.showVerticalScrollBar=this.bodyHeight?M-(this.showHorizontalScrollBar?this.scrollBarWidth:0)<g:!1,this.showVerticalScrollBar?d.classList.add(this.prefixCls+"-overflowY"):d.classList.remove(this.prefixCls+"-overflowY"),this.showHorizontalScrollBar?d.classList.add(this.prefixCls+"-overflowX"):d.classList.remove(this.prefixCls+"-overflowX")}},hideColumnFilter(){this.cloneColumns.forEach(c=>c._filterVisible=!1)},handleBodyScroll(c){this.scrollOnTheLeft=c.target.scrollLeft===0,this.scrollOnTheRight=c.target.scrollWidth===c.target.scrollLeft+c.target.clientWidth,this.showHeader&&(this.$refs.header.scrollLeft=c.target.scrollLeft),this.isLeftFixed&&(this.$refs.fixedBody.scrollTop=c.target.scrollTop),this.isRightFixed&&(this.$refs.fixedRightBody.scrollTop=c.target.scrollTop),this.showSummary&&this.$refs.summary&&(this.$refs.summary.$el.scrollLeft=c.target.scrollLeft),this.hideColumnFilter()},handleFixedMousewheel(c){let d=c.deltaY;if(!d&&c.detail&&(d=c.detail*40),!d&&c.wheelDeltaY&&(d=-c.wheelDeltaY),!d&&c.wheelDelta&&(d=-c.wheelDelta),!d)return;const g=this.$refs.body,M=g.scrollTop;d<0&&M!==0&&c.preventDefault(),d>0&&g.scrollHeight-g.clientHeight>M&&c.preventDefault();let C=0,b=setInterval(()=>{C+=5,d>0?g.scrollTop+=2:g.scrollTop-=2,C>=Math.abs(d)&&clearInterval(b)},5)},handleMouseWheel(c){const d=c.deltaX,g=this.$refs.body;d>0?g.scrollLeft=g.scrollLeft+10:g.scrollLeft=g.scrollLeft-10},sortData(c,d,g){const M=this.cloneColumns[g].key;c.sort((C,b)=>{if(this.cloneColumns[g].sortMethod)return this.cloneColumns[g].sortMethod(C[M],b[M],d);if(d==="asc")return C[M]>b[M]?1:-1;if(d==="desc")return C[M]<b[M]?1:-1});for(let C=0;C<c.length;C++)c[C].children&&c[C].children.length&&(c[C].children=this.sortData(c[C].children,d,g));return c},handleSort(c,d){const g=this.GetOriginalIndex(c);this.cloneColumns.forEach(C=>C._sortType="normal");const M=this.cloneColumns[g].key;this.cloneColumns[g].sortable!=="custom"&&(d==="normal"?this.rebuildData=this.makeDataWithFilter():this.rebuildData=this.sortData(this.rebuildData,d,g)),this.cloneColumns[g]._sortType=d,this.$emit("on-sort-change",{column:JSON.parse(JSON.stringify(this.allColumns[this.cloneColumns[g]._index])),key:M,order:d})},handleFilterHide(c){this.cloneColumns[c]._isFiltered||(this.cloneColumns[c]._filterChecked=[])},filterData(c,d){return c.filter(g=>{if(typeof d.filterRemote=="function")return!0;let M=!d._filterChecked.length;for(let C=0;C<d._filterChecked.length&&(M=d.filterMethod(d._filterChecked[C],g),!M);C++);return M})},filterOtherData(c,d){let g=this.cloneColumns[d];return typeof g.filterRemote=="function"&&g.filterRemote.call(this.$parent,g._filterChecked,g.key,g),this.cloneColumns.forEach((M,C)=>{C!==d&&(c=this.filterData(c,M))}),c},handleFilter(c){const d=this.cloneColumns[c];let g=this.makeDataWithSort();g=this.filterOtherData(g,c),this.rebuildData=this.filterData(g,d),this.cloneColumns[c]._isFiltered=!0,this.cloneColumns[c]._filterVisible=!1,this.$emit("on-filter-change",d)},GetOriginalIndex(c){return this.cloneColumns.findIndex(d=>d._index===c)},handleFilterSelect(c,d){const g=this.GetOriginalIndex(c);this.cloneColumns[g]._filterChecked=[d],this.handleFilter(g)},handleFilterReset(c){const d=this.GetOriginalIndex(c);this.cloneColumns[d]._isFiltered=!1,this.cloneColumns[d]._filterVisible=!1,this.cloneColumns[d]._filterChecked=[];let g=this.makeDataWithSort();g=this.filterOtherData(g,d),this.rebuildData=g,this.$emit("on-filter-change",this.cloneColumns[d])},makeData(){let c=$(this.data);return c.forEach((d,g)=>{d._index=g,d._rowKey=typeof this.rowKey=="string"?d[this.rowKey]:yB++,d.children&&d.children.length&&(d.children=this.makeChildrenData(d))}),c},makeChildrenData(c){return c.children&&c.children.length?c.children.map((d,g)=>{const M=$(d);return M._index=g,M._rowKey=typeof this.rowKey=="string"?M[this.rowKey]:yB++,M.children&&M.children.length&&(M.children=this.makeChildrenData(M)),M}):c},makeDataWithSort(){let c=this.makeData(),d="normal",g=-1,M=!1;for(let C=0;C<this.cloneColumns.length;C++)if(this.cloneColumns[C]._sortType!=="normal"){d=this.cloneColumns[C]._sortType,g=C,M=this.cloneColumns[C].sortable==="custom";break}return d!=="normal"&&!M&&(c=this.sortData(c,d,g)),c},makeDataWithFilter(){let c=this.makeData();return this.cloneColumns.forEach(d=>c=this.filterData(c,d)),c},makeDataWithSortAndFilter(){let c=this.makeDataWithSort();return this.cloneColumns.forEach(d=>c=this.filterData(c,d)),c},makeObjBaseData(c){const d=$(c);return typeof this.rowKey=="string"&&(d._rowKey=d[this.rowKey]),d._isHover=!1,d._disabled?d._isDisabled=d._disabled:d._isDisabled=!1,d._checked?d._isChecked=d._checked:d._isChecked=!1,d._expanded?d._isExpanded=d._expanded:d._isExpanded=!1,d._highlight?d._isHighlight=d._highlight:d._isHighlight=!1,d},makeObjData(){let c={};return this.data.forEach((d,g)=>{const M=this.makeObjBaseData(d);M.children&&M.children.length&&(M._showChildren?M._isShowChildren=M._showChildren:M._isShowChildren=!1,M.children=this.makeChildrenObjData(M)),c[g]=M}),c},makeChildrenObjData(c){return c.children&&c.children.length?c.children.map(d=>{const g=this.makeObjBaseData(d);return g._showChildren?g._isShowChildren=g._showChildren:g._isShowChildren=!1,g.children&&g.children.length&&(g.children=this.makeChildrenObjData(g)),g}):c},makeColumnsId(c){return $(c).map(d=>("children"in d&&this.makeColumnsId(d.children),d.__id=yde(6),d))},makeColumns(c){let d=$(iv(c)),g=[],M=[],C=[];return d.forEach((b,B)=>{b._index=B,b._columnKey=bde++,b.width=parseInt(b.width),b._width=b.width?b.width:"",b._sortType="normal",b._filterVisible=!1,b._isFiltered=!1,b._filterChecked=[],"filterMultiple"in b?b._filterMultiple=b.filterMultiple:b._filterMultiple=!0,"filteredValue"in b&&(b._filterChecked=b.filteredValue,b._isFiltered=!0),"sortType"in b&&(b._sortType=b.sortType),b.fixed&&b.fixed==="left"?g.push(b):b.fixed&&b.fixed==="right"?M.push(b):C.push(b)}),g.concat(C).concat(M)},makeColumnRows(c,d){return vde(d,c)},exportCsv(c){c.filename?c.filename.indexOf(".csv")===-1&&(c.filename+=".csv"):c.filename="table.csv";let d=[],g=[];c.columns&&c.data?(d=c.columns,g=c.data):(d=this.allColumns,"original"in c||(c.original=!0),g=c.original?this.data:this.rebuildData);let M=!1;"noHeader"in c&&(M=c.noHeader);const C=mde(d,g,c,M);c.callback?c.callback(C):gde.download(c.filename,C)},dragAndDrop(c,d){this.$emit("on-drag-drop",c,d)},handleClickContextMenuOutside(){this.contextMenuVisible=!1},handleOnVisibleChange(c){c&&i.nextTick(()=>{this.handleResize()})},addTable(c){const d=this[c];!d||(d.tableList||(d.tableList=[]),d.tableList.push({id:this.id,table:this}))},removeTable(c){const d=this[c];if(!d||!d.tableList)return;const g=d.tableList.findIndex(M=>M.id===this.id);d.tableList.splice(g,1)},closeContextMenu(){this.handleClickContextMenuOutside()},handleClickDropdownItem(){this.autoCloseContextmenu&&this.closeContextMenu()}},created(){this.context||(this.currentContext=this.$parent),this.showSlotHeader=this.$slots.header!==void 0,this.showSlotFooter=this.$slots.footer!==void 0,this.rebuildData=this.makeDataWithSortAndFilter()},mounted(){this.addTable("TabsInstance"),this.addTable("ModalInstance"),this.addTable("DrawerInstance"),this.handleResize(),i.nextTick(()=>this.ready=!0),o(window,"resize",this.handleResize),this.observer=Wp(),this.observer.listenTo(this.$el,this.handleResize)},beforeUnmount(){this.removeTable("TabsInstance"),this.removeTable("ModalInstance"),this.removeTable("DrawerInstance"),a(window,"resize",this.handleResize),this.observer.removeAllListeners(this.$el),this.observer.uninstall(this.$el),this.observer=null},watch:{data:{handler(){const c=this.rebuildData.length;this.objData=this.makeObjData(),this.rebuildData=this.makeDataWithSortAndFilter(),this.handleResize(),c||this.fixedHeader(),setTimeout(()=>{this.cloneData=$(this.data)},0)},deep:!0},columns:{handler(){const c=this.makeColumnsId(this.columns);this.allColumns=iv(c),this.cloneColumns=this.makeColumns(c),this.columnRows=this.makeColumnRows(!1,c),this.leftFixedColumnRows=this.makeColumnRows("left",c),this.rightFixedColumnRows=this.makeColumnRows("right",c),this.rebuildData=this.makeDataWithSortAndFilter(),this.handleResize()},deep:!0},height(){this.handleResize()},maxHeight(){this.handleResize()},showHorizontalScrollBar(){this.handleResize()},showVerticalScrollBar(){this.handleResize()}}},wde={cellspacing:"0",cellpadding:"0",border:"0"},_de=["innerHTML"],Ode=["innerHTML"],Sde={class:"ivu-table-resize-line",ref:"resizeLine"};function Cde(c,d,g,M,C,b){const B=i.resolveComponent("table-head"),F=i.resolveComponent("table-body"),Y=i.resolveComponent("table-summary"),G=i.resolveComponent("DropdownMenu"),K=i.resolveComponent("Dropdown"),fe=i.resolveComponent("Spin");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.wrapClasses),style:i.normalizeStyle(b.styles),ref:"tableWrap"},[i.createElementVNode("div",{class:i.normalizeClass(b.classes)},[C.showSlotHeader?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-title"]),ref:"title"},[i.renderSlot(c.$slots,"header")],2)):i.createCommentVNode("",!0),g.showHeader?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass([C.prefixCls+"-header"]),ref:"header",onMousewheel:d[0]||(d[0]=(...Ee)=>b.handleMouseWheel&&b.handleMouseWheel(...Ee))},[i.createVNode(B,{"prefix-cls":C.prefixCls,styleObject:b.tableHeaderStyle,columns:C.cloneColumns,"column-rows":C.columnRows,"obj-data":C.objData,"columns-width":C.columnsWidth,data:C.rebuildData},null,8,["prefix-cls","styleObject","columns","column-rows","obj-data","columns-width","data"])],34)):i.createCommentVNode("",!0),i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-body"]),style:i.normalizeStyle(b.bodyStyle),ref:"body",onScroll:d[1]||(d[1]=(...Ee)=>b.handleBodyScroll&&b.handleBodyScroll(...Ee))},[i.createVNode(F,{ref:"tbody",draggable:g.draggable,"prefix-cls":C.prefixCls,styleObject:b.tableStyle,columns:C.cloneColumns,data:C.rebuildData,"row-key":g.rowKey,"columns-width":C.columnsWidth,"obj-data":C.objData},null,8,["draggable","prefix-cls","styleObject","columns","data","row-key","columns-width","obj-data"])],38),[[i.vShow,!(b.localeNoDataText&&(!g.data||g.data.length===0)||b.localeNoFilteredDataText&&(!C.rebuildData||C.rebuildData.length===0))]]),g.showSummary&&g.data&&g.data.length?(i.openBlock(),i.createBlock(Y,{key:2,ref:"summary","prefix-cls":C.prefixCls,styleObject:b.tableStyle,columns:C.cloneColumns,data:b.summaryData,"columns-width":C.columnsWidth},null,8,["prefix-cls","styleObject","columns","data","columns-width"])):i.createCommentVNode("",!0),i.withDirectives(i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-tip"]),style:i.normalizeStyle(b.bodyStyle),onScroll:d[2]||(d[2]=(...Ee)=>b.handleBodyScroll&&b.handleBodyScroll(...Ee))},[i.createElementVNode("table",wde,[i.createElementVNode("tbody",null,[i.createElementVNode("tr",null,[i.createElementVNode("td",{style:i.normalizeStyle({height:b.bodyStyle.height,width:`${C.headerWidth}px`})},[!g.data||g.data.length===0?(i.openBlock(),i.createElementBlock("span",{key:0,innerHTML:b.localeNoDataText},null,8,_de)):(i.openBlock(),i.createElementBlock("span",{key:1,innerHTML:b.localeNoFilteredDataText},null,8,Ode))],4)])])])],38),[[i.vShow,!!b.localeNoDataText&&(!g.data||g.data.length===0)||!!b.localeNoFilteredDataText&&(!C.rebuildData||C.rebuildData.length===0)]]),b.isLeftFixed?(i.openBlock(),i.createElementBlock("div",{key:3,class:i.normalizeClass(b.fixedTableClasses),style:i.normalizeStyle(b.fixedTableStyle)},[g.showHeader?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.fixedHeaderClasses)},[i.createVNode(B,{fixed:"left","prefix-cls":C.prefixCls,styleObject:b.fixedTableStyle,columns:b.leftFixedColumns,"column-rows":C.columnRows,"fixed-column-rows":C.leftFixedColumnRows,"obj-data":C.objData,"columns-width":C.columnsWidth,data:C.rebuildData},null,8,["prefix-cls","styleObject","columns","column-rows","fixed-column-rows","obj-data","columns-width","data"])],2)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-fixed-body"]),style:i.normalizeStyle(b.fixedBodyStyle),ref:"fixedBody",onMousewheel:d[3]||(d[3]=(...Ee)=>b.handleFixedMousewheel&&b.handleFixedMousewheel(...Ee)),"on:DOMMouseScroll":d[4]||(d[4]=(...Ee)=>b.handleFixedMousewheel&&b.handleFixedMousewheel(...Ee))},[i.createVNode(F,{fixed:"left",draggable:g.draggable,"prefix-cls":C.prefixCls,styleObject:b.fixedTableStyle,columns:b.leftFixedColumns,data:C.rebuildData,"row-key":g.rowKey,"columns-width":C.columnsWidth,"obj-data":C.objData},null,8,["draggable","prefix-cls","styleObject","columns","data","row-key","columns-width","obj-data"])],38),g.showSummary&&g.data&&g.data.length?(i.openBlock(),i.createBlock(Y,{key:1,fixed:"left","prefix-cls":C.prefixCls,styleObject:b.fixedTableStyle,columns:b.leftFixedColumns,data:b.summaryData,"columns-width":C.columnsWidth,style:i.normalizeStyle({"margin-top":C.showHorizontalScrollBar?C.scrollBarWidth+"px":0})},null,8,["prefix-cls","styleObject","columns","data","columns-width","style"])):i.createCommentVNode("",!0)],6)):i.createCommentVNode("",!0),b.isRightFixed?(i.openBlock(),i.createElementBlock("div",{key:4,class:i.normalizeClass(b.fixedRightTableClasses),style:i.normalizeStyle(b.fixedRightTableStyle)},[g.showHeader?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(b.fixedHeaderClasses)},[i.createVNode(B,{fixed:"right","prefix-cls":C.prefixCls,styleObject:b.fixedRightTableStyle,columns:b.rightFixedColumns,"column-rows":C.columnRows,"fixed-column-rows":C.rightFixedColumnRows,"obj-data":C.objData,"columns-width":C.columnsWidth,data:C.rebuildData},null,8,["prefix-cls","styleObject","columns","column-rows","fixed-column-rows","obj-data","columns-width","data"])],2)):i.createCommentVNode("",!0),i.createElementVNode("div",{class:i.normalizeClass([C.prefixCls+"-fixed-body"]),style:i.normalizeStyle(b.fixedBodyStyle),ref:"fixedRightBody",onMousewheel:d[5]||(d[5]=(...Ee)=>b.handleFixedMousewheel&&b.handleFixedMousewheel(...Ee)),"on:DOMMouseScroll":d[6]||(d[6]=(...Ee)=>b.handleFixedMousewheel&&b.handleFixedMousewheel(...Ee))},[i.createVNode(F,{fixed:"right",draggable:g.draggable,"prefix-cls":C.prefixCls,styleObject:b.fixedRightTableStyle,columns:b.rightFixedColumns,data:C.rebuildData,"row-key":g.rowKey,"columns-width":C.columnsWidth,"obj-data":C.objData},null,8,["draggable","prefix-cls","styleObject","columns","data","row-key","columns-width","obj-data"])],38),g.showSummary&&g.data&&g.data.length?(i.openBlock(),i.createBlock(Y,{key:1,fixed:"right","prefix-cls":C.prefixCls,styleObject:b.fixedRightTableStyle,columns:b.rightFixedColumns,data:b.summaryData,"columns-width":C.columnsWidth,style:i.normalizeStyle({"margin-top":C.showHorizontalScrollBar?C.scrollBarWidth+"px":0})},null,8,["prefix-cls","styleObject","columns","data","columns-width","style"])):i.createCommentVNode("",!0)],6)):i.createCommentVNode("",!0),b.isRightFixed?(i.openBlock(),i.createElementBlock("div",{key:5,class:i.normalizeClass([C.prefixCls+"-fixed-right-header"]),style:i.normalizeStyle(b.fixedRightHeaderStyle)},null,6)):i.createCommentVNode("",!0),C.showSlotFooter?(i.openBlock(),i.createElementBlock("div",{key:6,class:i.normalizeClass([C.prefixCls+"-footer"]),ref:"footer"},[i.renderSlot(c.$slots,"footer")],2)):i.createCommentVNode("",!0)],2),i.withDirectives(i.createElementVNode("div",Sde,null,512),[[i.vShow,C.showResizeLine]]),g.showContextMenu?(i.openBlock(),i.createElementBlock("div",{key:0,class:"ivu-table-context-menu",style:i.normalizeStyle(C.contextMenuStyles)},[i.createVNode(K,{trigger:"custom",visible:C.contextMenuVisible,transfer:"",onOnClick:b.handleClickDropdownItem,onOnClickoutside:b.handleClickContextMenuOutside},{list:i.withCtx(()=>[i.createVNode(G,null,{default:i.withCtx(()=>[i.renderSlot(c.$slots,"contextMenu")]),_:3})]),_:3},8,["visible","onOnClick","onOnClickoutside"])],4)):i.createCommentVNode("",!0),i.createVNode(fe,{fix:"",size:"large",show:g.loading},{default:i.withCtx(()=>[i.renderSlot(c.$slots,"loading")]),_:3},8,["show"])],6)}var ew=l(xde,[["render",Cde]]);const Tde={name:"TablePaste",components:{Row:$h,Col:Ml,Input:ua,Table:ew},emits:["on-change","on-error","on-success"],props:{value:{type:String},inputProps:{type:Object,default(){return{}}},tableProps:{type:Object,default(){return{}}},hideTable:{type:Boolean,default:!1}},data(){return{content:"",tableColumns:[],tableData:[]}},watch:{value:{handler(c){this.handleResolveContent(c)},immediate:!0}},methods:{handleContentChange(c){const d=c.target.value.trim();this.$emit("on-change",d),this.handleResolveContent(d)},handleResolveContent(c){let d=[];c!==""&&c!==void 0&&(d=c.split(/[\n\u0085\u2028\u2029]|\r\n?/g).map(C=>C.split("	")));const g=this.handleGetErrorIndex(d),M=this.contentToTable(d);this.tableColumns=M.columns,this.tableData=M.data,g.length?this.$emit("on-error",M,g):this.$emit("on-success",M)},handleGetErrorIndex(c){const d=$(c),g=[];if(d.length){const M=d[0].length;d.forEach((C,b)=>{C.length!==M&&g.push(b)})}return g},contentToTable(c){const d=$(c);let g=[],M=[];return d.length>1&&(g=d.shift().map((C,b)=>({title:C,key:`key${b}`})),M=d.map(C=>{const b={};return C.forEach((B,F)=>{b[`key${F}`]=B}),b})),{columns:g,data:M}}}},Ede={class:"ivu-table-paste"},Mde={key:0,class:"ivu-table-paste-input"},Ade={key:0,class:"ivu-table-paste-input"};function kde(c,d,g,M,C,b){const B=i.resolveComponent("Input"),F=i.resolveComponent("Col"),Y=i.resolveComponent("Table"),G=i.resolveComponent("Row");return i.openBlock(),i.createElementBlock("div",Ede,[g.hideTable?(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[g.value!==void 0||!c.$slots.default?(i.openBlock(),i.createElementBlock("div",Ade,[i.renderSlot(c.$slots,"default",{},()=>[i.createVNode(B,i.mergeProps({modelValue:C.content,"onUpdate:modelValue":d[1]||(d[1]=K=>C.content=K),type:"textarea"},g.inputProps,{onOnChange:b.handleContentChange}),null,16,["modelValue","onOnChange"])])])):i.createCommentVNode("",!0)],64)):(i.openBlock(),i.createBlock(G,{key:0,gutter:32},{default:i.withCtx(()=>[i.createVNode(F,{span:"12"},{default:i.withCtx(()=>[g.value!==void 0||!c.$slots.default?(i.openBlock(),i.createElementBlock("div",Mde,[i.renderSlot(c.$slots,"default",{},()=>[i.createVNode(B,i.mergeProps({modelValue:C.content,"onUpdate:modelValue":d[0]||(d[0]=K=>C.content=K),type:"textarea"},g.inputProps,{onOnChange:b.handleContentChange}),null,16,["modelValue","onOnChange"])])])):i.createCommentVNode("",!0)]),_:3}),i.createVNode(F,{span:"12"},{default:i.withCtx(()=>[i.createVNode(Y,i.mergeProps({columns:C.tableColumns,data:C.tableData},g.tableProps),null,16,["columns","data"])]),_:1})]),_:3}))])}var bB=l(Tde,[["render",kde]]);const Pde={name:"TagSelect",mixins:[Ei],components:{Tag:$p,Icon:S},emits:["on-change","on-checked-all","update:modelValue"],provide(){return{TagSelectInstance:this}},props:{modelValue:{type:Array,default(){return[]}},expandable:{type:Boolean,default:!1},hideCheckAll:{type:Boolean,default:!1},locale:{type:Object,default(){return{collapseText:"收起",expandText:"展开"}}}},data(){return{currentValue:this.modelValue,checkedAll:!1,expand:!1,tagSelectOptionList:[]}},computed:{classes(){return{"ivu-tag-select-with-expanded":this.expandable,"ivu-tag-select-expanded":this.expand}}},watch:{modelValue(c){this.currentValue=c,this.handleUpdateTags()}},methods:{handleUpdateTags(){let c=!0;this.tagSelectOptionList.map(d=>d.option).forEach(d=>{this.currentValue.indexOf(d.name)>=0?d.checked=!0:(d.checked=!1,c=!1)}),this.checkedAll=c},handleChangeTag(c){const d=[];let g=!0;this.tagSelectOptionList.map(M=>M.option).forEach(M=>{M.checked?d.push(M.name):g=!1}),this.currentValue=d,this.$emit("update:modelValue",d),this.$emit("on-change",[...d],c),this.handleFormItemChange("change",c),c&&(this.checkedAll=g)},handleCheckAll(c){this.checkedAll=c,this.tagSelectOptionList.map(d=>d.option).forEach(d=>{d.checked=c}),this.handleChangeTag(),this.$emit("on-checked-all",c)},handleToggleExpand(){this.expand=!this.expand}},mounted(){this.handleUpdateTags()}},Rde={key:0,class:"ivu-tag-select-option"},Ide={key:0},Nde={key:1};function Dde(c,d,g,M,C,b){const B=i.resolveComponent("Tag"),F=i.resolveComponent("Icon");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["ivu-tag-select",b.classes])},[g.hideCheckAll?i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("div",Rde,[i.createVNode(B,{checkable:"",checked:C.checkedAll,onOnChange:b.handleCheckAll,color:"primary"},{default:i.withCtx(()=>[i.createTextVNode("全部")]),_:1},8,["checked","onOnChange"])])),i.renderSlot(c.$slots,"default"),g.expandable?(i.openBlock(),i.createElementBlock("a",{key:1,class:"ivu-tag-select-expand-btn",onClick:d[0]||(d[0]=(...Y)=>b.handleToggleExpand&&b.handleToggleExpand(...Y))},[C.expand?(i.openBlock(),i.createElementBlock("span",Ide,i.toDisplayString(g.locale.collapseText),1)):(i.openBlock(),i.createElementBlock("span",Nde,i.toDisplayString(g.locale.expandText),1)),C.expand?(i.openBlock(),i.createBlock(F,{key:2,type:"ios-arrow-up"})):(i.openBlock(),i.createBlock(F,{key:3,type:"ios-arrow-down"}))])):i.createCommentVNode("",!0)],2)}var xB=l(Pde,[["render",Dde]]);const Lde={name:"TagSelectOption",components:{Tag:$p},inject:["TagSelectInstance"],props:{name:{type:[String,Number],required:!0},tagProps:{type:Object,default(){return{}}},color:{type:String,default:"primary"}},data(){return{checked:!1,id:j(6)}},methods:{handleChange(c){this.checked=c,this.TagSelectInstance.handleChangeTag(this.name)},addOption(){this.TagSelectInstance.tagSelectOptionList.push({id:this.id,option:this})},removeOption(){const c=this.TagSelectInstance,d=c.tagSelectOptionList.findIndex(g=>g.id===this.id);c.tagSelectOptionList.splice(d,1)}},mounted(){this.addOption()},beforeUnmount(){this.removeOption()}},Bde={class:"ivu-tag-select-option"};function $de(c,d,g,M,C,b){const B=i.resolveComponent("Tag");return i.openBlock(),i.createElementBlock("div",Bde,[i.createVNode(B,i.mergeProps({checkable:"",checked:C.checked,onOnChange:b.handleChange,color:g.color},g.tagProps),{default:i.withCtx(()=>[i.renderSlot(c.$slots,"default")]),_:3},16,["checked","onOnChange","color"])])}var wB=l(Lde,[["render",$de]]);const _B={name:"Text",mixins:[G0],render(){return i.h(Gx,{...this.$props,component:"span",...this.commonEvents()},this.commonSlots())}},OB="ivu-timeline",Ude={name:"Timeline",props:{pending:{type:Boolean,default:!1}},computed:{classes(){return[`${OB}`,{[`${OB}-pending`]:this.pending}]}}};function Vde(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("ul",{class:i.normalizeClass(b.classes)},[i.renderSlot(c.$slots,"default")],2)}var SB=l(Ude,[["render",Vde]]);const Yp="ivu-timeline",Fde={name:"TimelineItem",props:{color:{type:String,default:"blue"}},data(){return{dot:!1}},mounted(){this.dot=!!this.$refs.dot.innerHTML.length},computed:{itemClasses(){return`${Yp}-item`},tailClasses(){return`${Yp}-item-tail`},headClasses(){return[`${Yp}-item-head`,{[`${Yp}-item-head-custom`]:this.dot,[`${Yp}-item-head-${this.color}`]:this.headColorShow}]},headColorShow(){return this.color==="blue"||this.color==="red"||this.color==="green"},customColor(){let c={};return this.color&&(this.headColorShow||(c={color:this.color,"border-color":this.color})),c},contentClasses(){return`${Yp}-item-content`}}};function zde(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("li",{class:i.normalizeClass(b.itemClasses)},[i.createElementVNode("div",{class:i.normalizeClass(b.tailClasses)},null,2),i.createElementVNode("div",{class:i.normalizeClass(b.headClasses),style:i.normalizeStyle(b.customColor),ref:"dot"},[i.renderSlot(c.$slots,"dot")],6),i.createElementVNode("div",{class:i.normalizeClass(b.contentClasses)},[i.renderSlot(c.$slots,"default")],2)],2)}var CB=l(Fde,[["render",zde]]),TB={mixins:[gD,Rx],components:{TimePickerPanel:kD,RangeTimePickerPanel:DD},props:{type:{validator(c){return O(c,["time","timerange"])},default:"time"}},computed:{panel(){return this.type==="timerange"?"RangeTimePickerPanel":"TimePickerPanel"},ownPickerProps(){return{disabledHours:this.disabledHours,disabledMinutes:this.disabledMinutes,disabledSeconds:this.disabledSeconds,hideDisabledOptions:this.hideDisabledOptions}}},watch:{visible(c){c&&i.nextTick(()=>{this.timeSpinnerList.map(d=>d.timeSpinner).forEach(d=>d.updateScroll())})}}};const EB={name:"Title",mixins:[G0],props:{level:{type:Number,validator(c){return O(c,[1,2,3,4,5,6])},default:1}},render(){return i.h(Gx,{...this.$props,component:`h${this.level}`,...this.commonEvents()},this.commonSlots())}},Xde={name:"Search",components:{Input:ua},emits:["on-query-change","on-query-clear"],props:{prefixCls:String,placeholder:String,query:String},data(){return{currentQuery:this.query}},watch:{query(c){this.currentQuery=c},currentQuery(c){this.$emit("on-query-change",c)}},computed:{icon(){return this.query===""?"ios-search":"ios-close-circle"}},methods:{handleClick(){this.currentQuery!==""&&(this.currentQuery="",this.$emit("on-query-clear"))}}};function Wde(c,d,g,M,C,b){const B=i.resolveComponent("Input");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(g.prefixCls)},[i.createVNode(B,{modelValue:C.currentQuery,"onUpdate:modelValue":d[0]||(d[0]=F=>C.currentQuery=F),size:"small",icon:b.icon,placeholder:g.placeholder,onOnClick:b.handleClick},null,8,["modelValue","icon","placeholder","onOnClick"])],2)}var Gde=l(Xde,[["render",Wde]]);const Hde={name:"TransferList",components:{Search:Gde,Checkbox:Bp},inject:["TransferInstance"],emits:["on-checked-keys-change"],props:{prefixCls:String,data:Array,renderFormat:Function,checkedKeys:Array,listStyle:Object,title:[String,Number],filterable:Boolean,filterPlaceholder:String,filterMethod:Function,notFoundText:String,validKeysCount:Number},data(){return{showItems:[],query:"",showFooter:!0}},watch:{data(){this.updateFilteredData()}},computed:{classes(){return[`${this.prefixCls}`,{[`${this.prefixCls}-with-footer`]:this.showFooter}]},bodyClasses(){return[`${this.prefixCls}-body`,{[`${this.prefixCls}-body-with-search`]:this.filterable,[`${this.prefixCls}-body-with-footer`]:this.showFooter}]},count(){const c=this.validKeysCount;return(c>0?`${c}/`:"")+`${this.data.length}`},checkedAll(){return this.filterData.filter(c=>!c.disabled).length===this.validKeysCount&&this.validKeysCount!==0},checkedAllDisabled(){return this.filterData.filter(c=>!c.disabled).length<=0},filterData(){return this.showItems.filter(c=>this.filterMethod(c,this.query))}},methods:{itemClasses(c){return[`${this.prefixCls}-content-item`,{[`${this.prefixCls}-content-item-disabled`]:c.disabled}]},showLabel(c){return this.renderFormat(c)},isCheck(c){return this.checkedKeys.some(d=>d===c.key)},select(c){if(c.disabled)return;const d=this.checkedKeys.indexOf(c.key);d>-1?this.checkedKeys.splice(d,1):this.checkedKeys.push(c.key),this.TransferInstance.handleCheckedKeys()},updateFilteredData(){this.showItems=this.data},toggleSelectAll(c){const d=c?this.filterData.filter(g=>!g.disabled||this.checkedKeys.indexOf(g.key)>-1).map(g=>g.key):this.filterData.filter(g=>g.disabled&&this.checkedKeys.indexOf(g.key)>-1).map(g=>g.key);this.$emit("on-checked-keys-change",d)},handleQueryClear(){this.query=""},handleQueryChange(c){this.query=c}},created(){this.updateFilteredData()},mounted(){this.showFooter=this.$slots.default!==void 0}},Qde=["onClick"],jde=["innerHTML"];function Yde(c,d,g,M,C,b){const B=i.resolveComponent("Checkbox"),F=i.resolveComponent("Search");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(b.classes),style:i.normalizeStyle(g.listStyle)},[i.createElementVNode("div",{class:i.normalizeClass(g.prefixCls+"-header")},[i.createVNode(B,{modelValue:b.checkedAll,disabled:b.checkedAllDisabled,"onUpdate:modelValue":b.toggleSelectAll},null,8,["modelValue","disabled","onUpdate:modelValue"]),i.createElementVNode("span",{class:i.normalizeClass(g.prefixCls+"-header-title"),onClick:d[0]||(d[0]=Y=>b.toggleSelectAll(!b.checkedAll))},i.toDisplayString(g.title),3),i.createElementVNode("span",{class:i.normalizeClass(g.prefixCls+"-header-count")},i.toDisplayString(b.count),3)],2),i.createElementVNode("div",{class:i.normalizeClass(b.bodyClasses)},[g.filterable?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(g.prefixCls+"-body-search-wrapper")},[i.createVNode(F,{"prefix-cls":g.prefixCls+"-search",query:C.query,onOnQueryClear:b.handleQueryClear,onOnQueryChange:b.handleQueryChange,placeholder:g.filterPlaceholder},null,8,["prefix-cls","query","onOnQueryClear","onOnQueryChange","placeholder"])],2)):i.createCommentVNode("",!0),i.createElementVNode("ul",{class:i.normalizeClass(g.prefixCls+"-content")},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.filterData,(Y,G)=>(i.openBlock(),i.createElementBlock("li",{key:G,class:i.normalizeClass(b.itemClasses(Y)),onClick:i.withModifiers(K=>b.select(Y),["prevent"])},[i.createVNode(B,{modelValue:b.isCheck(Y),disabled:Y.disabled},null,8,["modelValue","disabled"]),i.createElementVNode("span",{innerHTML:b.showLabel(Y)},null,8,jde)],10,Qde))),128)),i.createElementVNode("li",{class:i.normalizeClass(g.prefixCls+"-content-not-found")},i.toDisplayString(g.notFoundText),3)],2)],2),C.showFooter?(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass(g.prefixCls+"-footer")},[i.renderSlot(c.$slots,"default")],2)):i.createCommentVNode("",!0)],6)}var MB=l(Hde,[["render",Yde]]);const qde={name:"Operation",components:{Button:Us,Icon:S},inject:["TransferInstance"],props:{prefixCls:String,operations:Array,leftActive:Boolean,rightActive:Boolean,reverseOperation:Boolean},methods:{moveToLeft(){this.TransferInstance.moveTo("left")},moveToRight(){this.TransferInstance.moveTo("right")}}},Zde={key:0},Kde={key:0},Jde={key:0},efe={key:0};function tfe(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("Button");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(g.prefixCls+"-operation")},[g.reverseOperation?(i.openBlock(),i.createElementBlock(i.Fragment,{key:0},[i.createVNode(F,{type:"primary",size:"small",disabled:!g.leftActive,onClick:b.moveToRight},{default:i.withCtx(()=>[g.operations[1]?(i.openBlock(),i.createElementBlock("span",Zde,i.toDisplayString(g.operations[1]),1)):i.createCommentVNode("",!0),i.createVNode(B,{type:"ios-arrow-forward"})]),_:1},8,["disabled","onClick"]),i.createVNode(F,{type:"primary",size:"small",disabled:!g.rightActive,onClick:b.moveToLeft},{default:i.withCtx(()=>[i.createVNode(B,{type:"ios-arrow-back"}),g.operations[0]?(i.openBlock(),i.createElementBlock("span",Kde,i.toDisplayString(g.operations[0]),1)):i.createCommentVNode("",!0)]),_:1},8,["disabled","onClick"])],64)):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[i.createVNode(F,{type:"primary",size:"small",disabled:!g.rightActive,onClick:b.moveToLeft},{default:i.withCtx(()=>[i.createVNode(B,{type:"ios-arrow-back"}),g.operations[0]?(i.openBlock(),i.createElementBlock("span",Jde,i.toDisplayString(g.operations[0]),1)):i.createCommentVNode("",!0)]),_:1},8,["disabled","onClick"]),i.createVNode(F,{type:"primary",size:"small",disabled:!g.leftActive,onClick:b.moveToRight},{default:i.withCtx(()=>[g.operations[1]?(i.openBlock(),i.createElementBlock("span",efe,i.toDisplayString(g.operations[1]),1)):i.createCommentVNode("",!0),i.createVNode(B,{type:"ios-arrow-forward"})]),_:1},8,["disabled","onClick"])],64))],2)}var ife=l(qde,[["render",tfe]]);const AB="ivu-transfer",kB={name:"Transfer",mixins:[gn,Ei],emits:["on-change","on-selected-change"],provide(){return{TransferInstance:this}},render(){const c=this.$slots.default?this.$slots.default():"";return i.h("div",{class:this.classes},[i.h(MB,{ref:"left",prefixCls:this.prefixCls+"-list",data:this.leftData,renderFormat:this.renderFormat,checkedKeys:this.leftCheckedKeys,validKeysCount:this.leftValidKeysCount,listStyle:this.listStyle,title:this.localeTitles[0],filterable:this.filterable,filterPlaceholder:this.localeFilterPlaceholder,filterMethod:this.filterMethod,notFoundText:this.localeNotFoundText,"onOn-checked-keys-change":this.handleLeftCheckedKeysChange},()=>c),i.h(ife,{prefixCls:this.prefixCls,operations:this.operations,leftActive:this.leftValidKeysCount>0,rightActive:this.rightValidKeysCount>0,reverseOperation:this.reverseOperation}),i.h(MB,{ref:"right",prefixCls:this.prefixCls+"-list",data:this.rightData,renderFormat:this.renderFormat,checkedKeys:this.rightCheckedKeys,validKeysCount:this.rightValidKeysCount,listStyle:this.listStyle,title:this.localeTitles[1],filterable:this.filterable,filterPlaceholder:this.localeFilterPlaceholder,filterMethod:this.filterMethod,notFoundText:this.localeNotFoundText,"onOn-checked-keys-change":this.handleRightCheckedKeysChange},()=>c)])},props:{data:{type:Array,default(){return[]}},renderFormat:{type:Function,default(c){return c.label||c.key}},targetKeys:{type:Array,default(){return[]}},selectedKeys:{type:Array,default(){return[]}},listStyle:{type:Object,default(){return{}}},titles:{type:Array},operations:{type:Array,default(){return[]}},filterable:{type:Boolean,default:!1},filterPlaceholder:{type:String},filterMethod:{type:Function,default(c,d){const g="label"in c?"label":"key";return c[g].indexOf(d)>-1}},notFoundText:{type:String},reverseOperation:{type:Boolean,default:!1}},data(){return{prefixCls:AB,leftData:[],rightData:[],leftCheckedKeys:[],rightCheckedKeys:[]}},computed:{classes(){return[`${AB}`]},leftValidKeysCount(){return this.getValidKeys("left").length},rightValidKeysCount(){return this.getValidKeys("right").length},localeFilterPlaceholder(){return this.filterPlaceholder===void 0?this.t("i.transfer.filterPlaceholder"):this.filterPlaceholder},localeNotFoundText(){return this.notFoundText===void 0?this.t("i.transfer.notFoundText"):this.notFoundText},localeTitles(){return this.titles===void 0?[this.t("i.transfer.titles.source"),this.t("i.transfer.titles.target")]:this.titles}},methods:{getValidKeys(c){return this[`${c}Data`].filter(d=>!d.disabled&&this[`${c}CheckedKeys`].indexOf(d.key)>-1).map(d=>d.key)},splitData(c=!1){this.leftData=[...this.data],this.rightData=[],this.targetKeys.length>0&&this.targetKeys.forEach(d=>{const g=this.leftData.filter((M,C)=>M.key===d?(this.leftData.splice(C,1),!0):!1);g&&g.length>0&&this.rightData.push(g[0])}),c&&this.splitSelectedKey()},splitSelectedKey(){const c=this.selectedKeys;c.length>0&&(this.leftCheckedKeys=this.leftData.filter(d=>c.indexOf(d.key)>-1).map(d=>d.key),this.rightCheckedKeys=this.rightData.filter(d=>c.indexOf(d.key)>-1).map(d=>d.key))},moveTo(c){const d=this.targetKeys,g=c==="left"?"right":"left",M=this.getValidKeys(g),C=c==="right"?M.concat(d):d.filter(b=>!M.some(B=>b===B));this.$refs[g].toggleSelectAll(!1),this.$emit("on-change",C,c,M),this.handleFormItemChange("change",{tarketKeys:C,direction:c,moveKeys:M})},handleLeftCheckedKeysChange(c){this.leftCheckedKeys=c},handleRightCheckedKeysChange(c){this.rightCheckedKeys=c},handleCheckedKeys(){const c=this.getValidKeys("left"),d=this.getValidKeys("right");this.$emit("on-selected-change",c,d)}},watch:{targetKeys(){this.splitData(!1)},data(){this.splitData(!1)}},mounted(){this.splitData(!0)}};var nfe={name:"RenderCell",props:{render:Function,data:Object,node:Array},render(){const c={root:this.node[0],node:this.node[1],data:this.data};return this.render(i.h,c)}};const Yh="ivu-tree",rfe={name:"TreeNode",inject:["TreeInstance"],components:{Checkbox:Bp,Icon:S,CollapseTransition:cE,Render:nfe},props:{data:{type:Object,default:()=>{}},multiple:{type:Boolean,default:!1},childrenKey:{type:String,default:"children"},showCheckbox:{type:Boolean,default:!1},appear:{type:Boolean,default:!1}},data(){return{prefixCls:Yh,appearByClickArrow:!1,globalConfig:{}}},computed:{classes(){return[`${Yh}-children`]},selectedCls(){return[{[`${Yh}-node-selected`]:this.data.selected}]},arrowClasses(){return[`${Yh}-arrow`,{[`${Yh}-arrow-disabled`]:this.data.disabled,[`${Yh}-arrow-open`]:this.data.expand}]},titleClasses(){return[`${Yh}-title`,{[`${Yh}-title-selected`]:this.data.selected}]},showArrow(){return this.data[this.childrenKey]&&this.data[this.childrenKey].length||"loading"in this.data&&!this.data.loading},showLoading(){return"loading"in this.data&&this.data.loading},isParentRender(){const c=L(this,"Tree");return c&&c.render},parentRender(){const c=L(this,"Tree");return c&&c.render?c.render:null},node(){const c=L(this,"Tree");return c?[c.flatState,c.flatState.find(d=>d.nodeKey===this.data.nodeKey)]:[]},children(){return this.data[this.childrenKey]},arrowType(){const c=this.globalConfig;let d="ios-arrow-forward";return c&&(c.tree.customArrow?d="":c.tree.arrow&&(d=c.tree.arrow)),d},customArrowType(){const c=this.globalConfig;let d="";return c&&c.tree.customArrow&&(d=c.tree.customArrow),d},arrowSize(){const c=this.globalConfig;let d="";return c&&c.tree.arrowSize&&(d=c.tree.arrowSize),d}},methods:{handleExpand(){const c=this.data;if(this.appearByClickArrow=!0,c[this.childrenKey].length===0){const d=L(this,"Tree");if(d&&d.loadData){this.data.loading=!0,d.loadData(c,g=>{this.data.loading=!1,g.length&&(this.data[this.childrenKey]=g,i.nextTick(()=>this.handleExpand()))});return}}c[this.childrenKey]&&c[this.childrenKey].length&&(this.data.expand=!this.data.expand,this.TreeInstance.handleToggleExpand(this.data))},handleClickNode(){this.TreeInstance.expandNode?this.showArrow&&this.handleExpand():this.TreeInstance.selectNode&&this.handleSelect()},handleSelect(){this.data.disabled||(this.TreeInstance.showCheckbox&&this.TreeInstance.checkDirectly?this.handleCheck():this.TreeInstance.handleOnSelected(this.data.nodeKey))},handleCheck(){if(this.data.disabled)return;const c={checked:!this.data.checked&&!this.data.indeterminate,nodeKey:this.data.nodeKey};this.TreeInstance.handleOnCheck(c)},handleContextmenu(c,d){c.contextmenu&&(d.preventDefault(),this.TreeInstance.handleOnContextmenu({data:c,event:d}))},handlePreventSelect(c,d){c.contextmenu&&d.preventDefault()}},created(){const c=i.getCurrentInstance();this.globalConfig=c.appContext.config.globalProperties.$VIEWUI}},sfe={key:0,class:"ivu-tree-expand"};function ofe(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("Checkbox"),Y=i.resolveComponent("Render"),G=i.resolveComponent("TreeNode"),K=i.resolveComponent("collapse-transition");return i.openBlock(),i.createElementBlock("ul",{class:i.normalizeClass(b.classes)},[i.createElementVNode("li",{onContextmenu:d[2]||(d[2]=i.withModifiers(fe=>b.handleContextmenu(g.data,fe),["stop"])),onSelectstart:d[3]||(d[3]=i.withModifiers(fe=>b.handlePreventSelect(g.data,fe),["stop"]))},[i.createElementVNode("span",{class:i.normalizeClass(b.arrowClasses),onClick:d[0]||(d[0]=(...fe)=>b.handleExpand&&b.handleExpand(...fe))},[b.showArrow?(i.openBlock(),i.createBlock(B,{key:0,type:b.arrowType,custom:b.customArrowType,size:b.arrowSize},null,8,["type","custom","size"])):i.createCommentVNode("",!0),b.showLoading?(i.openBlock(),i.createBlock(B,{key:1,type:"ios-loading",class:"ivu-load-loop"})):i.createCommentVNode("",!0)],2),g.showCheckbox?(i.openBlock(),i.createBlock(F,{key:0,"model-value":g.data.checked,indeterminate:g.data.indeterminate,disabled:g.data.disabled||g.data.disableCheckbox,onClick:i.withModifiers(b.handleCheck,["prevent"])},null,8,["model-value","indeterminate","disabled","onClick"])):i.createCommentVNode("",!0),i.createElementVNode("span",{class:i.normalizeClass(b.titleClasses),onClick:d[1]||(d[1]=(...fe)=>b.handleClickNode&&b.handleClickNode(...fe))},[g.data.render?(i.openBlock(),i.createBlock(Y,{key:0,render:g.data.render,data:g.data,node:b.node},null,8,["render","data","node"])):b.isParentRender?(i.openBlock(),i.createBlock(Y,{key:1,render:b.parentRender,data:g.data,node:b.node},null,8,["render","data","node"])):(i.openBlock(),i.createElementBlock(i.Fragment,{key:2},[i.createTextVNode(i.toDisplayString(g.data.title),1)],64))],2),i.createVNode(K,{appear:g.appear},{default:i.withCtx(()=>[g.data.expand?(i.openBlock(),i.createElementBlock("div",sfe,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(b.children,(fe,Ee)=>(i.openBlock(),i.createBlock(G,{appear:C.appearByClickArrow,key:Ee,data:fe,multiple:g.multiple,"show-checkbox":g.showCheckbox,"children-key":g.childrenKey},null,8,["appear","data","multiple","show-checkbox","children-key"]))),128))])):i.createCommentVNode("",!0)]),_:1},8,["appear"])],32)],2)}var afe=l(rfe,[["render",ofe]]);const lfe="ivu-tree",cfe={name:"Tree",mixins:[gn],components:{TreeNode:afe,Dropdown:Rd,DropdownMenu:Id},emits:["on-select-change","on-check-change","on-contextmenu","on-toggle-expand"],provide(){return{TreeInstance:this}},props:{data:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!1},checkDirectly:{type:Boolean,default:!1},emptyText:{type:String},childrenKey:{type:String,default:"children"},loadData:{type:Function},render:{type:Function},selectNode:{type:Boolean,default:!0},expandNode:{type:Boolean,default:!1},autoCloseContextmenu:{type:Boolean,default:!0}},data(){return{prefixCls:lfe,stateTree:this.data,flatState:[],contextMenuVisible:!1,contextMenuStyles:{top:0,left:0}}},watch:{data:{deep:!0,handler(){this.stateTree=this.data,this.flatState=this.compileFlatState(),this.rebuildTree()}}},computed:{localeEmptyText(){return typeof this.emptyText>"u"?this.t("i.tree.emptyText"):this.emptyText}},methods:{compileFlatState(){let c=0,d=this.childrenKey;const g=[];function M(C,b){C.nodeKey=c++,g[C.nodeKey]={node:C,nodeKey:C.nodeKey},typeof b<"u"&&(g[C.nodeKey].parent=b.nodeKey,g[b.nodeKey][d].push(C.nodeKey)),C[d]&&(g[C.nodeKey][d]=[],C[d].forEach(B=>M(B,C)))}return this.stateTree.forEach(C=>{M(C)}),g},updateTreeUp(c){const d=this.flatState[c].parent;if(typeof d>"u"||this.checkStrictly)return;const g=this.flatState[c].node,M=this.flatState[d].node;g.checked==M.checked&&g.indeterminate==M.indeterminate||(g.checked==!0?(M.checked=M[this.childrenKey].every(C=>C.checked),M.indeterminate=!M.checked):(M.checked=!1,M.indeterminate=M[this.childrenKey].some(C=>C.checked||C.indeterminate)),this.updateTreeUp(d))},rebuildTree(){this.getCheckedNodes().forEach(c=>{this.updateTreeDown(c,{checked:!0});const d=this.flatState[c.nodeKey].parent;if(!d&&d!==0)return;const g=this.flatState[d].node;typeof c.checked<"u"&&c.checked&&g.checked!=c.checked&&this.updateTreeUp(c.nodeKey)})},getSelectedNodes(){return this.flatState.filter(c=>c.node.selected).map(c=>c.node)},getCheckedNodes(){return this.flatState.filter(c=>c.node.checked).map(c=>c.node)},getCheckedAndIndeterminateNodes(){return this.flatState.filter(c=>c.node.checked||c.node.indeterminate).map(c=>c.node)},updateTreeDown(c,d={}){if(!this.checkStrictly){for(let g in d)c[g]=d[g];c[this.childrenKey]&&c[this.childrenKey].forEach(g=>{this.updateTreeDown(g,d)})}},handleSelect(c){if(!this.flatState[c])return;const d=this.flatState[c].node;if(!this.multiple){const g=this.flatState.findIndex(M=>M.node.selected);g>=0&&g!==c&&(this.flatState[g].node.selected=!1)}d.selected=!d.selected,this.$emit("on-select-change",this.getSelectedNodes(),d)},handleCheck({checked:c,nodeKey:d}){if(!this.flatState[d])return;const g=this.flatState[d].node;g.checked=c,g.indeterminate=!1,this.updateTreeUp(d),this.updateTreeDown(g,{checked:c,indeterminate:!1}),this.$emit("on-check-change",this.getCheckedNodes(),g)},handleContextmenu({data:c,event:d}){this.contextMenuVisible&&this.handleClickContextMenuOutside(),i.nextTick(()=>{const g=this.$refs.treeWrap.getBoundingClientRect(),M={left:`${d.clientX-g.left}px`,top:`${d.clientY-g.top}px`};this.contextMenuStyles=M,this.contextMenuVisible=!0,this.$emit("on-contextmenu",c,d,M)})},handleClickContextMenuOutside(){this.contextMenuVisible=!1},handleOnCheck(c){this.handleCheck(c)},handleOnSelected(c){this.handleSelect(c)},handleToggleExpand(c){this.$emit("on-toggle-expand",c)},handleOnContextmenu(c){this.handleContextmenu(c)},closeContextMenu(){this.handleClickContextMenuOutside()},handleClickDropdownItem(){this.autoCloseContextmenu&&this.closeContextMenu()}},created(){this.flatState=this.compileFlatState(),this.rebuildTree()}};function hfe(c,d,g,M,C,b){const B=i.resolveComponent("TreeNode"),F=i.resolveComponent("DropdownMenu"),Y=i.resolveComponent("Dropdown");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(C.prefixCls),ref:"treeWrap"},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(C.stateTree,(G,K)=>(i.openBlock(),i.createBlock(B,{key:K,data:G,visible:"",multiple:g.multiple,"show-checkbox":g.showCheckbox,"children-key":g.childrenKey},null,8,["data","multiple","show-checkbox","children-key"]))),128)),C.stateTree.length?i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([C.prefixCls+"-empty"])},i.toDisplayString(b.localeEmptyText),3)),i.createElementVNode("div",{class:"ivu-tree-context-menu",style:i.normalizeStyle(C.contextMenuStyles)},[i.createVNode(Y,{trigger:"custom",visible:C.contextMenuVisible,transfer:"",onOnClick:b.handleClickDropdownItem,onOnClickoutside:b.handleClickContextMenuOutside},{list:i.withCtx(()=>[i.createVNode(F,null,{default:i.withCtx(()=>[i.renderSlot(c.$slots,"contextMenu")]),_:3})]),_:3},8,["visible","onOnClick","onOnClickoutside"])],4)],2)}var OE=l(cfe,[["render",hfe]]);const ufe={name:"TreeSelect",components:{Select:$s,Tree:OE},emits:["on-change","update:modelValue","on-open-change"],mixins:[Ei],props:{modelValue:{type:[String,Number,Array]},data:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},loadData:{type:Function},transfer:{type:Boolean,default(){const c=i.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}}},data(){let c=this.modelValue;return c===null&&(this.multiple?c=[]:c=""),{currentValue:c,isChangeValueInTree:!1,isValueChangeByTree:!1,isValueNull:!1}},watch:{modelValue(c){if(this.isChangeValueInTree)this.isChangeValueInTree=!1;else{let d=c;d===null&&(this.isValueNull=!0,this.multiple?d=[]:d=""),this.currentValue=d,this.$refs.select.reset(),this.handleUpdateTreeNodes(this.data,!0)}},data(){this.isChangeValueInTree?this.isChangeValueInTree=!1:(this.$refs.select.reset(),this.handleUpdateTreeNodes(this.data,!0))}},computed:{valueToArray(){return typeof this.currentValue=="object"?this.currentValue:[this.currentValue]},isCheckboxUsable(){return this.multiple&&this.showCheckbox},transferClassName(){return this.transfer?"ivu-tree-select-transfer":""},classes(){return{"ivu-tree-select-with-checkbox":this.showCheckbox}}},methods:{handleSelectNode(c,d){if(this.multiple)c.length?(this.currentValue=c.map(g=>g.value),this.handleUpdateSelectValue(d.value,d.title)):(this.currentValue=[],this.handleUpdateSelectValue("",""));else if(c.length){const g=c[0];this.currentValue=g.value,this.handleUpdateSelectValue(g.value,g.title)}else this.currentValue="",this.handleUpdateSelectValue("","");this.isChangeValueInTree=!0,this.$emit("update:modelValue",this.currentValue),this.$emit("on-change",this.currentValue),this.handleFormItemChange("change",this.currentValue)},handleUpdateTreeNodes(c,d=!1){c.forEach(g=>{this.valueToArray.indexOf(g.value)>=0?(this.isCheckboxUsable?g.checked=!0:g.selected=!0,this.handleUpdateSelectValue(g.value,g.title)):this.isCheckboxUsable?g.checked=!1:g.selected=!1,g.children&&g.children.length&&this.handleUpdateTreeNodes(g.children)}),d&&(this.$refs.select.isFocused=!1)},handleUpdateSelectValue(c,d){c===""?this.$refs.select.reset():(this.isValueChangeByTree=!0,this.$refs.select.onOptionClick({value:c,label:d}))},handleChange(c){this.isValueChangeByTree?this.isValueChangeByTree=!1:(this.currentValue=c,this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c),this.$refs.select.reset(),this.handleUpdateTreeNodes(this.data,!0),i.nextTick(()=>{this.isValueChangeByTree=!1}))},handleOpenChange(c){this.$emit("on-open-change",c)}},mounted(){this.handleUpdateTreeNodes(this.data,!0)}};function dfe(c,d,g,M,C,b){const B=i.resolveComponent("Tree"),F=i.resolveComponent("Select");return i.openBlock(),i.createBlock(F,i.mergeProps({ref:"select"},c.$attrs,{multiple:g.multiple,class:["ivu-tree-select",b.classes],"transfer-class-name":b.transferClassName,onOnChange:b.handleChange,onOnOpenChange:b.handleOpenChange,hideNotFound:"",transfer:g.transfer}),{default:i.withCtx(()=>[i.createVNode(B,{data:g.data,multiple:g.multiple,onOnSelectChange:b.handleSelectNode,onOnCheckChange:b.handleSelectNode,"check-strictly":"","show-checkbox":g.multiple&&g.showCheckbox,"check-directly":"","load-data":g.loadData},null,8,["data","multiple","onOnSelectChange","onOnCheckChange","show-checkbox","load-data"])]),_:1},16,["multiple","class","transfer-class-name","onOnChange","onOnOpenChange","transfer"])}var PB=l(ufe,[["render",dfe]]);const ffe={name:"Typography"},pfe={class:"ivu-typography"};function mfe(c,d,g,M,C,b){return i.openBlock(),i.createElementBlock("article",pfe,[i.renderSlot(c.$slots,"default")])}var RB=l(ffe,[["render",mfe]]);const SE="ivu-upload",gfe={name:"UploadList",components:{Icon:S,iProgress:Kx},emits:["on-file-click","on-file-preview","on-file-remove"],props:{files:{type:Array,default(){return[]}}},data(){return{prefixCls:SE}},methods:{fileCls(c){return[`${SE}-list-file`,{[`${SE}-list-file-finish`]:c.status==="finished"}]},handleClick(c){this.$emit("on-file-click",c)},handlePreview(c){this.$emit("on-file-preview",c)},handleRemove(c){this.$emit("on-file-remove",c)},format(c){const d=c.name.split(".").pop().toLocaleLowerCase()||"";let g="ios-document-outline";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(d)>-1&&(g="ios-image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(d)>-1&&(g="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(d)>-1&&(g="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(d)>-1&&(g="md-document"),["numbers","csv","xls","xlsx"].indexOf(d)>-1&&(g="ios-stats"),["keynote","ppt","pptx"].indexOf(d)>-1&&(g="ios-videocam"),g},parsePercentage(c){return parseInt(c,10)}}},vfe=["onClick"],yfe=["onClick"];function bfe(c,d,g,M,C,b){const B=i.resolveComponent("Icon"),F=i.resolveComponent("i-progress");return i.openBlock(),i.createElementBlock("ul",{class:i.normalizeClass([C.prefixCls+"-list"])},[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(g.files,(Y,G)=>(i.openBlock(),i.createElementBlock("li",{key:G,class:i.normalizeClass(b.fileCls(Y)),onClick:K=>b.handleClick(Y)},[i.createElementVNode("span",{onClick:K=>b.handlePreview(Y)},[i.createVNode(B,{type:b.format(Y)},null,8,["type"]),i.createTextVNode(" "+i.toDisplayString(Y.name),1)],8,yfe),i.withDirectives(i.createVNode(B,{type:"ios-close",class:i.normalizeClass([C.prefixCls+"-list-remove"]),onClick:K=>b.handleRemove(Y)},null,8,["class","onClick"]),[[i.vShow,Y.status==="finished"]]),i.createVNode(i.Transition,{name:"fade"},{default:i.withCtx(()=>[Y.showProgress?(i.openBlock(),i.createBlock(F,{key:0,"stroke-width":2,percent:b.parsePercentage(Y.percentage),status:Y.status==="finished"&&Y.showProgress?"success":"normal"},null,8,["percent","status"])):i.createCommentVNode("",!0)]),_:2},1024)],10,vfe))),128))],2)}var xfe=l(gfe,[["render",bfe]]);function wfe(c,d,g){const M=`fail to post ${c} ${g.status}'`,C=new Error(M);return C.status=g.status,C.method="post",C.url=c,C}function IB(c){const d=c.responseText||c.response;if(!d)return d;try{return JSON.parse(d)}catch{return d}}function _fe(c){if(typeof XMLHttpRequest>"u")return;const d=new XMLHttpRequest,g=c.action;d.upload&&(d.upload.onprogress=function(b){b.total>0&&(b.percent=b.loaded/b.total*100),c.onProgress(b)});const M=new FormData;c.data&&Object.keys(c.data).map(b=>{M.append(b,c.data[b])}),M.append(c.filename,c.file),d.onerror=function(b){c.onError(b)},d.onload=function(){if(d.status<200||d.status>=300)return c.onError(wfe(g,c,d),IB(d));c.onSuccess(IB(d))},d.open("post",g,!0),c.withCredentials&&"withCredentials"in d&&(d.withCredentials=!0);const C=c.headers||{};for(let b in C)C.hasOwnProperty(b)&&C[b]!==null&&d.setRequestHeader(b,C[b]);d.send(M)}const nv="ivu-upload",Ofe={name:"Upload",mixins:[Ei],components:{UploadList:xfe},props:{action:{type:String,required:!0},headers:{type:Object,default(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator(c){return O(c,["select","drag"])},default:"select"},format:{type:Array,default(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default(){return{}}},onSuccess:{type:Function,default(){return{}}},onError:{type:Function,default(){return{}}},onRemove:{type:Function,default(){return{}}},onPreview:{type:Function,default(){return{}}},onExceededSize:{type:Function,default(){return{}}},onFormatError:{type:Function,default(){return{}}},defaultFileList:{type:Array,default(){return[]}},paste:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},webkitdirectory:{type:Boolean,default:!1}},data(){return{prefixCls:nv,dragOver:!1,fileList:[],tempIndex:1}},computed:{classes(){return[`${nv}`,{[`${nv}-select`]:this.type==="select",[`${nv}-drag`]:this.type==="drag",[`${nv}-dragOver`]:this.type==="drag"&&this.dragOver}]}},methods:{handleClick(){this.itemDisabled||this.$refs.input.click()},handleChange(c){const d=c.target.files;!d||(this.uploadFiles(d),this.$refs.input.value=null)},onDrop(c){this.dragOver=!1,!this.itemDisabled&&this.uploadFiles(c.dataTransfer.files)},handlePaste(c){this.itemDisabled||this.paste&&this.uploadFiles(c.clipboardData.files)},uploadFiles(c){let d=Array.prototype.slice.call(c);this.multiple||(d=d.slice(0,1)),d.length!==0&&d.forEach(g=>{this.upload(g)})},upload(c){if(!this.beforeUpload)return this.post(c);const d=this.beforeUpload(c);d&&d.then?d.then(g=>{Object.prototype.toString.call(g)==="[object File]"?this.post(g):this.post(c)},()=>{}):d!==!1&&this.post(c)},post(c){if(this.format.length){const d=c.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(g=>g.toLocaleLowerCase()===d))return this.onFormatError(c,this.fileList),!1}if(this.maxSize&&c.size>this.maxSize*1024)return this.onExceededSize(c,this.fileList),!1;this.handleStart(c),new FormData().append(this.name,c),_fe({headers:this.headers,withCredentials:this.withCredentials,file:c,data:this.data,filename:this.name,action:this.action,onProgress:d=>{this.handleProgress(d,c)},onSuccess:d=>{this.handleSuccess(d,c)},onError:(d,g)=>{this.handleError(d,g,c)}})},handleStart(c){c.uid=Date.now()+this.tempIndex++;const d={status:"uploading",name:c.name,size:c.size,percentage:0,uid:c.uid,showProgress:!0};this.fileList.push(d)},getFile(c){const d=this.fileList;let g;return d.every(M=>(g=c.uid===M.uid?M:null,!g)),g},handleProgress(c,d){const g=this.getFile(d);this.onProgress(c,g,this.fileList),g.percentage=c.percent||0},handleSuccess(c,d){const g=this.getFile(d);g&&(g.status="finished",g.response=c,this.onSuccess(c,g,this.fileList),this.handleFormItemChange("change",g),setTimeout(()=>{g.showProgress=!1},1e3))},handleError(c,d,g){const M=this.getFile(g),C=this.fileList;M.status="fail",C.splice(C.indexOf(M),1),this.onError(c,d,g)},handleRemove(c){const d=this.fileList;d.splice(d.indexOf(c),1),this.onRemove(c,d)},handlePreview(c){c.status==="finished"&&this.onPreview(c)},clearFiles(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler(c){this.fileList=c.map(d=>(d.status="finished",d.percentage=100,d.uid=Date.now()+this.tempIndex++,d))}}}},Sfe=["multiple","webkitdirectory","accept"];function Cfe(c,d,g,M,C,b){const B=i.resolveComponent("upload-list");return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass([C.prefixCls])},[i.createElementVNode("div",{class:i.normalizeClass(b.classes),onClick:d[1]||(d[1]=(...F)=>b.handleClick&&b.handleClick(...F)),onDrop:d[2]||(d[2]=i.withModifiers((...F)=>b.onDrop&&b.onDrop(...F),["prevent"])),onPaste:d[3]||(d[3]=(...F)=>b.handlePaste&&b.handlePaste(...F)),onDragover:d[4]||(d[4]=i.withModifiers(F=>C.dragOver=!0,["prevent"])),onDragleave:d[5]||(d[5]=i.withModifiers(F=>C.dragOver=!1,["prevent"]))},[i.createElementVNode("input",{ref:"input",type:"file",class:i.normalizeClass([C.prefixCls+"-input"]),onChange:d[0]||(d[0]=(...F)=>b.handleChange&&b.handleChange(...F)),multiple:g.multiple,webkitdirectory:g.webkitdirectory,accept:g.accept},null,42,Sfe),i.renderSlot(c.$slots,"default")],34),i.renderSlot(c.$slots,"tip"),g.showUploadList?(i.openBlock(),i.createBlock(B,{key:0,files:C.fileList,onOnFileRemove:b.handleRemove,onOnFilePreview:b.handlePreview},null,8,["files","onOnFileRemove","onOnFilePreview"])):i.createCommentVNode("",!0)],2)}var NB=l(Ofe,[["render",Cfe]]);const DB={name:"UserName",mixins:[P0],data(){return{className:"ivu-login-username",prefix:"ios-contact-outline",placeholder:"请输入用户名",type:"text",validateMessage:"请输入用户名！"}}},Tfe={name:"WordCount",components:{Circle:_x},props:{value:{type:[String,Number],default:""},total:{type:Number,default:0},hideTotal:{type:Boolean,default:!1},overflow:{type:Boolean,default:!1},circle:{type:Boolean,default:!1},size:{type:[String,Number],default:14}},computed:{isOverflow(){return this.value.length>this.total},percent(){let c=this.value.length/this.total*100;return c>100&&(c=100),c},strokeColor(){return this.isOverflow?"#ed4014":"#2d8cf0"}}},Efe={class:"ivu-word-count"},Mfe={key:0,class:"ivu-word-count-prefix"},Afe={key:1,class:"ivu-word-count-prefix ivu-word-count-overflow"},kfe={key:3,class:"ivu-word-count-overflow"},Pfe={key:5,class:"ivu-word-count-suffix"},Rfe={key:6,class:"ivu-word-count-suffix ivu-word-count-overflow"};function Ife(c,d,g,M,C,b){const B=i.resolveComponent("Circle");return i.openBlock(),i.createElementBlock("div",Efe,[g.circle?(i.openBlock(),i.createBlock(B,{key:0,percent:b.percent,size:g.size,"stroke-color":b.strokeColor},null,8,["percent","size","stroke-color"])):(i.openBlock(),i.createElementBlock(i.Fragment,{key:1},[b.isOverflow?(i.openBlock(),i.createElementBlock("span",Afe,[i.renderSlot(c.$slots,"prefix-overflow")])):(i.openBlock(),i.createElementBlock("span",Mfe,[i.renderSlot(c.$slots,"prefix")])),!b.isOverflow||!g.overflow?(i.openBlock(),i.createElementBlock("span",{key:2,class:i.normalizeClass({"ivu-word-count-overflow":b.isOverflow})},[i.renderSlot(c.$slots,"length",{length:g.value.length},()=>[i.createTextVNode(i.toDisplayString(g.value.length),1)])],2)):(i.openBlock(),i.createElementBlock("span",kfe,i.toDisplayString(g.value.length-g.total),1)),g.hideTotal?i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock(i.Fragment,{key:4},[i.renderSlot(c.$slots,"separator",{},()=>[i.createTextVNode(" / ")]),i.renderSlot(c.$slots,"total",{total:g.total},()=>[i.createTextVNode(i.toDisplayString(g.total),1)])],64)),b.isOverflow?(i.openBlock(),i.createElementBlock("span",Rfe,[i.renderSlot(c.$slots,"suffix-overflow")])):(i.openBlock(),i.createElementBlock("span",Pfe,[i.renderSlot(c.$slots,"suffix")]))],64))])}var LB=l(Tfe,[["render",Ife]]),BB=Object.freeze(Object.defineProperty({__proto__:null,Affix:v,Alert:se,Anchor:z,AnchorLink:he,Auth:Re,AutoComplete:sN,Avatar:C0,AvatarList:lN,BackTop:cN,Badge:mx,Breadcrumb:vT,BreadcrumbItem:yT,Button:Us,ButtonGroup:bT,Calendar:bN,Captcha:TN,Card:MN,Carousel:AN,CarouselItem:kN,Cascader:PN,Cell:RN,CellGroup:IN,Checkbox:Bp,CheckboxGroup:AT,Circle:_x,City:BN,Col:Ml,Collapse:UN,ColorPicker:ZN,Content:RT,Copy:Mx,CountDown:rD,CountUp:sD,DatePicker:BD,Description:$D,DescriptionList:UD,Divider:Dx,Drawer:VD,Dropdown:Rd,DropdownItem:FD,DropdownMenu:Id,Ellipsis:zD,Email:XD,Exception:WD,Footer:QT,FooterToolbar:GD,Form:Ux,FormItem:wx,GlobalFooter:HD,Grid:sL,GridItem:oL,Header:KT,Icon:S,Image:aL,ImagePreview:Gh,Input:ua,InputNumber:JT,Layout:cL,Link:fL,List:vL,ListItem:yL,ListItemMeta:bL,LoadingBar:tE,Login:TL,Menu:nE,MenuGroup:EL,MenuItem:ML,Message:U0,Mobile:AL,Modal:fa,Notice:sE,Notification:VL,NotificationItem:XL,NotificationTab:WL,NumberInfo:GL,Numeral:QL,Option:Jn,OptionGroup:jL,Page:YL,PageHeader:qL,Panel:ZL,Paragraph:KL,Password:JL,Poptip:hE,Progress:Kx,Radio:yx,RadioGroup:vx,Rate:eB,Result:tB,Row:$h,Scroll:nB,ScrollIntoView:dE,ScrollTop:fE,Select:$s,Sider:lB,Skeleton:cB,SkeletonItem:pE,Slider:hB,Space:uB,Spin:Bo,Split:dB,Step:pB,Steps:mB,Submenu:gB,Submit:vB,Switch:gE,Table:ew,TablePaste:bB,TabPane:Zx,Tabs:Yx,Tag:$p,TagSelect:xB,TagSelectOption:wB,Text:_B,Time:qx,Timeline:SB,TimelineItem:CB,TimePicker:TB,Title:EB,Tooltip:Cc,Transfer:kB,Tree:OE,TreeSelect:PB,Trend:aE,Typography:RB,Upload:NB,UserName:DB,WordCount:LB},Symbol.toStringTag,{value:"Module"})),Nfe={mounted(c,d){d.value&&(H(c,"ivu-line-clamp"),c.style["-webkit-line-clamp"]=d.value)},updated(c,d){d.value&&(c.style["-webkit-line-clamp"]=d.value)},unmounted(c){J(c,"ivu-line-clamp"),c.style["-webkit-line-clamp"]=null}},Dfe={mounted(c,d){function g(M){d.value(M)}c.__resizeHandler__=g,c.__observer__=Wp(),c.__observer__.listenTo(c,g)},updated(){},unmounted(c,d){c.__observer__.removeListener(c,c.__resizeHandler__),delete c.__resizeHandler__,delete c.__observer__}};function qh(c){return String(c).endsWith("%")?"":"px"}var Zh={display:{mounted(c,d){d.value&&(c.style.display=d.value)},updated(c,d){d.value&&(c.style.display=d.value)},unmounted(c){c.style.display=null}},width:{mounted(c,d){d.value&&(c.style.width=d.value+qh(d.value))},updated(c,d){d.value&&(c.style.width=d.value+qh(d.value))},unmounted(c){c.style.width=null}},height:{mounted(c,d){d.value&&(c.style.height=d.value+qh(d.value))},updated(c,d){d.value&&(c.style.height=d.value+qh(d.value))},unmounted(c){c.style.height=null}},margin:{mounted(c,d){d.value&&(c.style.margin=d.value+qh(d.value))},updated(c,d){d.value&&(c.style.margin=d.value+qh(d.value))},unmounted(c){c.style.margin=null}},padding:{mounted(c,d){d.value&&(c.style.padding=d.value+qh(d.value))},updated(c,d){d.value&&(c.style.padding=d.value+qh(d.value))},unmounted(c){c.style.padding=null}},font:{mounted(c,d){d&&d.value&&(c.style.fontSize=`${d.value}px`)},updated(c,d){d&&d.value&&(c.style.fontSize=`${d.value}px`)},unmounted(c){c.style.fontSize=null}},color:{mounted(c,d){d.value&&(c.style.color=d.value)},updated(c,d){d.value&&(c.style.color=d.value)},unmounted(c){c.style.color=null}},bgColor:{mounted(c,d){d.value&&(c.style.backgroundColor=d.value)},updated(c,d){d.value&&(c.style.backgroundColor=d.value)},unmounted(c){c.style.backgroundColor=null}}},Lfe={name:"view-ui-plus",version:"1.3.17",title:"ViewUIPlus",description:"A high quality UI components Library with Vue.js 3",homepage:"http://www.iviewui.com",keywords:["iview","vue","viewui","viewuiplus","vue.js","component","components","ui","framework"],main:"dist/viewuiplus.min.js",typings:"types/index.d.ts",files:["dist","src","types"],scripts:{dev:"vue-cli-service serve",build:"npm run build:prod && npm run build:style && npm run build:lang","build:style":"gulp --gulpfile build/build-style.js","build:prod":"vite build","build:lang":"vite build --config build/vite.lang.config.js",lint:"vue-cli-service lint --fix"},repository:{type:"git",url:"https://github.com/view-design/ViewUIPlus"},author:"Aresn",license:"MIT",bugs:{url:"https://github.com/view-design/ViewUIPlus/issues"},dependencies:{"async-validator":"^3.3.0","countup.js":"^1.9.3",dayjs:"^1.11.0",deepmerge:"^2.2.1","element-resize-detector":"^1.2.0","js-calendar":"^1.2.3","lodash.chunk":"^4.2.0","lodash.throttle":"^4.1.1",numeral:"^2.0.6","popper.js":"^1.14.6",select:"^1.1.2",tinycolor2:"^1.4.1","v-click-outside-x":"^3.7.1"},devDependencies:{"@vitejs/plugin-vue":"^1.9.3","@vue/cli-plugin-babel":"~4.5.0","@vue/cli-plugin-eslint":"~4.5.0","@vue/cli-service":"~4.5.0","@vue/compiler-sfc":"^3.0.0","babel-eslint":"^10.1.0","babel-plugin-import":"^1.13.3",chai:"^4.2.0","copy-webpack-plugin":"^6.4.1","cross-env":"^5.2.0",eslint:"^6.7.2","eslint-plugin-vue":"^7.0.0-0",gulp:"^4.0.2","gulp-autoprefixer":"^8.0.0","gulp-clean-css":"^4.3.0","gulp-less":"^4.0.1","gulp-rename":"^2.0.0",karma:"^2.0.5","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.1","karma-mocha":"^1.3.0","karma-sinon-chai":"^1.3.3","karma-sourcemap-loader":"^0.3.7","karma-spec-reporter":"^0.0.32","karma-webpack":"^2.0.13",less:"^2.7.3","less-loader":"^4.1.0","lint-staged":"^10.5.4",lolex:"^2.7.5",mocha:"^5.0.4",sinon:"^4.4.2","sinon-chai":"^3.3.0","style-loader":"^0.20.2",tslint:"^5.14.0",typescript:"^3.3.4000","uglifyjs-webpack-plugin":"^1.3.0","url-loader":"^1.1.2",vite:"^2.6.4",vue:"^3.2.47","vue-hot-reload-api":"^2.3.4","vue-html-loader":"^1.2.4","vue-loader":"^17.0.0","vue-router":"^4.0.14","vue-style-loader":"^4.1.3","vue-template-compiler":"^2.6.14"}};const $B={display:Zh.display,width:Zh.width,height:Zh.height,margin:Zh.margin,padding:Zh.padding,font:Zh.font,color:Zh.color,"bg-color":Zh.bgColor,resize:Dfe,"line-clamp":Nfe},UB={...BB,iButton:Us,iCircle:_x,iCol:Ml,iContent:RT,iForm:Ux,iFooter:QT,iHeader:KT,iInput:ua,iMenu:nE,iOption:Jn,iProgress:Kx,iSelect:$s,iSwitch:gE,iTable:ew,iTime:qx},CE=function(c,d={}){CE.installed||(d.locale&&Dh.use(d.locale),d.i18n&&Dh.i18n(d.i18n),Object.keys(UB).forEach(g=>{c.component(g,UB[g])}),Object.keys($B).forEach(g=>{c.directive(g,$B[g])}),c.config.globalProperties.$VIEWUI={size:d.size||"",capture:"capture"in d?d.capture:!0,transfer:"transfer"in d?d.transfer:"",cell:{arrow:d.cell&&d.cell.arrow?d.cell.arrow:"",customArrow:d.cell&&d.cell.customArrow?d.cell.customArrow:"",arrowSize:d.cell&&d.cell.arrowSize?d.cell.arrowSize:""},menu:{arrow:d.menu&&d.menu.arrow?d.menu.arrow:"",customArrow:d.menu&&d.menu.customArrow?d.menu.customArrow:"",arrowSize:d.menu&&d.menu.arrowSize?d.menu.arrowSize:""},modal:{maskClosable:d.modal&&"maskClosable"in d.modal?d.modal.maskClosable:""},tabs:{closeIcon:d.tabs&&d.tabs.closeIcon?d.tabs.closeIcon:"",customCloseIcon:d.tabs&&d.tabs.customCloseIcon?d.tabs.customCloseIcon:"",closeIconSize:d.tabs&&d.tabs.closeIconSize?d.tabs.closeIconSize:""},select:{arrow:d.select&&d.select.arrow?d.select.arrow:"",customArrow:d.select&&d.select.customArrow?d.select.customArrow:"",arrowSize:d.select&&d.select.arrowSize?d.select.arrowSize:""},colorPicker:{arrow:d.colorPicker&&d.colorPicker.arrow?d.colorPicker.arrow:"",customArrow:d.colorPicker&&d.colorPicker.customArrow?d.colorPicker.customArrow:"",arrowSize:d.colorPicker&&d.colorPicker.arrowSize?d.colorPicker.arrowSize:""},cascader:{arrow:d.cascader&&d.cascader.arrow?d.cascader.arrow:"",customArrow:d.cascader&&d.cascader.customArrow?d.cascader.customArrow:"",arrowSize:d.cascader&&d.cascader.arrowSize?d.cascader.arrowSize:"",itemArrow:d.cascader&&d.cascader.itemArrow?d.cascader.itemArrow:"",customItemArrow:d.cascader&&d.cascader.customItemArrow?d.cascader.customItemArrow:"",itemArrowSize:d.cascader&&d.cascader.itemArrowSize?d.cascader.itemArrowSize:""},tree:{arrow:d.tree&&d.tree.arrow?d.tree.arrow:"",customArrow:d.tree&&d.tree.customArrow?d.tree.customArrow:"",arrowSize:d.tree&&d.tree.arrowSize?d.tree.arrowSize:""},datePicker:{icon:d.datePicker&&d.datePicker.icon?d.datePicker.icon:"",customIcon:d.datePicker&&d.datePicker.customIcon?d.datePicker.customIcon:"",iconSize:d.datePicker&&d.datePicker.iconSize?d.datePicker.iconSize:""},timePicker:{icon:d.timePicker&&d.timePicker.icon?d.timePicker.icon:"",customIcon:d.timePicker&&d.timePicker.customIcon?d.timePicker.customIcon:"",iconSize:d.timePicker&&d.timePicker.iconSize?d.timePicker.iconSize:""},typography:{copyConfig:d.typography&&d.typography.copyConfig?d.typography.copyConfig:"",editConfig:d.typography&&d.typography.editConfig?d.typography.editConfig:"",ellipsisConfig:d.typography&&d.typography.ellipsisConfig?d.typography.ellipsisConfig:""},space:{size:d.space&&d.space.size?d.space.size:""},image:{toolbar:d.image&&d.image.toolbar?d.image.toolbar:""}},c.config.globalProperties.$Spin=Bo,c.config.globalProperties.$Loading=tE,c.config.globalProperties.$Message=U0,c.config.globalProperties.$Notice=sE,c.config.globalProperties.$Modal=fa,c.config.globalProperties.$ImagePreview=Gh,c.config.globalProperties.$Copy=Mx,c.config.globalProperties.$ScrollIntoView=dE,c.config.globalProperties.$ScrollTop=fE,c.config.globalProperties.$Date=Io)},VB=Lfe.version,FB=Dh.use,zB=Dh.i18n,XB=c=>{const d=window["viewuiplus/locale"].default;c===d.i.locale?Dh.use(d):console.log(`The ${c} language pack is not loaded.`)},Bfe={version:VB,locale:FB,i18n:zB,install:CE,lang:XB,...BB};n.Affix=v,n.Alert=se,n.Anchor=z,n.AnchorLink=he,n.Auth=Re,n.AutoComplete=sN,n.Avatar=C0,n.AvatarList=lN,n.BackTop=cN,n.Badge=mx,n.Breadcrumb=vT,n.BreadcrumbItem=yT,n.Button=Us,n.ButtonGroup=bT,n.Calendar=bN,n.Captcha=TN,n.Card=MN,n.Carousel=AN,n.CarouselItem=kN,n.Cascader=PN,n.Cell=RN,n.CellGroup=IN,n.Checkbox=Bp,n.CheckboxGroup=AT,n.Circle=_x,n.City=BN,n.Col=Ml,n.Collapse=UN,n.ColorPicker=ZN,n.Content=RT,n.Copy=Mx,n.CountDown=rD,n.CountUp=sD,n.DatePicker=BD,n.Description=$D,n.DescriptionList=UD,n.Divider=Dx,n.Drawer=VD,n.Dropdown=Rd,n.DropdownItem=FD,n.DropdownMenu=Id,n.Ellipsis=zD,n.Email=XD,n.Exception=WD,n.Footer=QT,n.FooterToolbar=GD,n.Form=Ux,n.FormItem=wx,n.GlobalFooter=HD,n.Grid=sL,n.GridItem=oL,n.Header=KT,n.Icon=S,n.Image=aL,n.ImagePreview=Gh,n.Input=ua,n.InputNumber=JT,n.Layout=cL,n.Link=fL,n.List=vL,n.ListItem=yL,n.ListItemMeta=bL,n.LoadingBar=tE,n.Login=TL,n.Menu=nE,n.MenuGroup=EL,n.MenuItem=ML,n.Message=U0,n.Mobile=AL,n.Modal=fa,n.Notice=sE,n.Notification=VL,n.NotificationItem=XL,n.NotificationTab=WL,n.NumberInfo=GL,n.Numeral=QL,n.Option=Jn,n.OptionGroup=jL,n.Page=YL,n.PageHeader=qL,n.Panel=ZL,n.Paragraph=KL,n.Password=JL,n.Poptip=hE,n.Progress=Kx,n.Radio=yx,n.RadioGroup=vx,n.Rate=eB,n.Result=tB,n.Row=$h,n.Scroll=nB,n.ScrollIntoView=dE,n.ScrollTop=fE,n.Select=$s,n.Sider=lB,n.Skeleton=cB,n.SkeletonItem=pE,n.Slider=hB,n.Space=uB,n.Spin=Bo,n.Split=dB,n.Step=pB,n.Steps=mB,n.Submenu=gB,n.Submit=vB,n.Switch=gE,n.TabPane=Zx,n.Table=ew,n.TablePaste=bB,n.Tabs=Yx,n.Tag=$p,n.TagSelect=xB,n.TagSelectOption=wB,n.Text=_B,n.Time=qx,n.TimePicker=TB,n.Timeline=SB,n.TimelineItem=CB,n.Title=EB,n.Tooltip=Cc,n.Transfer=kB,n.Tree=OE,n.TreeSelect=PB,n.Trend=aE,n.Typography=RB,n.Upload=NB,n.UserName=DB,n.WordCount=LB,n.default=Bfe,n.i18n=zB,n.install=CE,n.lang=XB,n.locale=FB,n.version=VB,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})})(qR,qR.exports);var _J=qR.exports;const WXe=jb(_J),OJ=r=>(_p("data-v-455ca2b1"),r=r(),Op(),r),GXe={class:"split-image-container"},HXe=OJ(()=>xt("h1",null,"智能图片拆分",-1)),QXe=OJ(()=>xt("p",null,"将丢失plist的png大图智能拆分成png小图",-1)),jXe={key:0},YXe={__name:"SplitImage",setup(r){let e=ot(!1),n=null,i="",s=[],o=null,a=null,l=null;async function h(){window.cv||await new Promise(x=>{const w=document.createElement("script");w.src="https://cdn.jsdelivr.net/npm/opencv.js",w.async=!0,w.onload=()=>x(),document.body.appendChild(w)}),window.JSZip||await new Promise(x=>{const w=document.createElement("script");w.src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js",w.onload=()=>x(),document.body.appendChild(w)}),a=window.cv,l=window.JSZip}function u(){n&&(n.delete(),n=null),s=[],i=""}function f(x){function w(O){const _=x[O];for(let T=0;T<x.length;++T){if(O===T)continue;const A=x[T];if(_.x>=A.x&&_.y>=A.y&&_.x+_.width<=A.x+A.width&&_.y+_.height<=A.y+A.height)return!0}return!1}const S=[];for(let O=0;O<x.length;++O){const _=x[O];w(O)||_.width<3&&_.height<3||S.push(x[O])}return S}function p(x){u(),o&&x?(o.width=x.width,o.height=x.height):console.warn("canvas 或 eleSrc 未定义");const w=a.imread(x);n=w.clone();const S=new a.MatVector;a.split(w,S);const O=S.get(3),_=new a.Mat;a.threshold(O,_,10,255,a.THRESH_BINARY);const T=new a.MatVector,A=new a.Mat;a.findContours(_,T,A,a.RETR_CCOMP,a.CHAIN_APPROX_SIMPLE);const P=new a.Scalar(255,0,0,255);a.copyMakeBorder(w,w,1,1,1,1,a.BORDER_CONSTANT,P);let N=[];for(let k=0;k<T.size();++k){let R=a.boundingRect(T.get(k));N.push(R)}s=f(N);for(let k=0;k<s.length;++k){let R=s[k],E=new a.Point(R.x,R.y),D=new a.Point(R.x+R.width,R.y+R.height);a.rectangle(w,E,D,new a.Scalar(0,255,0,255),1)}i=`共${s.length}张小图`,a.imshow(o,w),w.delete(),S.delete(),_.delete(),T.delete(),A.delete()}function m(x){if(!x)return;const w=new FileReader;w.readAsDataURL(x),w.onloadend=function(){const S=new window.Image;S.src=this.result,S.onload=function(){p(S)}}}function v(x){return m(x),!1}function y(){if(!n||!s.length)return;const x=new l;let w=0;for(let S=0;S<s.length;++S){const O=s[S],_={x:O.x,y:O.y,width:O.width,height:O.height},T=n.roi(_),A=`image${S+1}`,P=document.createElement("canvas");P.width=O.width,P.height=O.height,a.imshow(P,T),P.toBlob(function(N){x.file(A+".png",N),w++,w===s.length&&x.generateAsync({type:"blob"}).then(function(k){const R=document.createElement("a");R.href=URL.createObjectURL(k),R.download="images.zip",R.click()})}),T.delete()}}return Xn(async()=>{await h(),o=document.getElementById("mycanvas"),window.cv&&window.cv.onRuntimeInitialized?window.cv.onRuntimeInitialized=()=>{e.value=!0,i=""}:e.value=!0,o&&(o.width=512,o.height=512)}),(x,w)=>{const S=bt("Upload"),O=bt("Button"),_=bt("Col"),T=bt("Row");return ri(),Ji("div",GXe,[HXe,QXe,Pe(T,null,{default:qe(()=>[Pe(_,null,{default:qe(()=>[Pe(S,{"before-upload":v,"show-upload-list":!1,disabled:!oi(e),accept:"image/*",action:""},{default:qe(()=>[Pe(oi(_J.Button),{type:"primary",disabled:!oi(e)},{default:qe(()=>[tn("选择大图")]),_:1},8,["disabled"])]),_:1},8,["disabled"]),Pe(O,{type:"success",onClick:y,disabled:!oi(e)},{default:qe(()=>[tn(" 导出小图 ")]),_:1},8,["disabled"])]),_:1})]),_:1}),xt("p",null,bh(oi(i)),1),xt("div",null,[oi(e)?WC("",!0):(ri(),Ji("p",jXe,"正在加载环境...(大约20秒钟)")),xt("canvas",{ref_key:"canvas",ref:o,id:"mycanvas"},null,512)])])}}},qXe=Ap(YXe,[["__scopeId","data-v-455ca2b1"]]);var SJ={exports:{}};(function(r,e){/** @preserve SAT.js - Version 0.9.0 - Copyright 2012 - 2021 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */(function(n,i){r.exports=i()})(Ia,function(){var n={};function i(R,E){this.x=R||0,this.y=E||0}n.Vector=i,n.V=i,i.prototype.copy=i.prototype.copy=function(R){return this.x=R.x,this.y=R.y,this},i.prototype.clone=i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.perp=i.prototype.perp=function(){var R=this.x;return this.x=this.y,this.y=-R,this},i.prototype.rotate=i.prototype.rotate=function(R){var E=this.x,D=this.y;return this.x=E*Math.cos(R)-D*Math.sin(R),this.y=E*Math.sin(R)+D*Math.cos(R),this},i.prototype.reverse=i.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},i.prototype.normalize=i.prototype.normalize=function(){var R=this.len();return R>0&&(this.x=this.x/R,this.y=this.y/R),this},i.prototype.add=i.prototype.add=function(R){return this.x+=R.x,this.y+=R.y,this},i.prototype.sub=i.prototype.sub=function(R){return this.x-=R.x,this.y-=R.y,this},i.prototype.scale=i.prototype.scale=function(R,E){return this.x*=R,this.y*=typeof E<"u"?E:R,this},i.prototype.project=i.prototype.project=function(R){var E=this.dot(R)/R.len2();return this.x=E*R.x,this.y=E*R.y,this},i.prototype.projectN=i.prototype.projectN=function(R){var E=this.dot(R);return this.x=E*R.x,this.y=E*R.y,this},i.prototype.reflect=i.prototype.reflect=function(R){var E=this.x,D=this.y;return this.project(R).scale(2),this.x-=E,this.y-=D,this},i.prototype.reflectN=i.prototype.reflectN=function(R){var E=this.x,D=this.y;return this.projectN(R).scale(2),this.x-=E,this.y-=D,this},i.prototype.dot=i.prototype.dot=function(R){return this.x*R.x+this.y*R.y},i.prototype.len2=i.prototype.len2=function(){return this.dot(this)},i.prototype.len=i.prototype.len=function(){return Math.sqrt(this.len2())};function s(R,E){this.pos=R||new i,this.r=E||0,this.offset=new i}n.Circle=s,s.prototype.getAABBAsBox=s.prototype.getAABBAsBox=function(){var R=this.r,E=this.pos.clone().add(this.offset).sub(new i(R,R));return new a(E,R*2,R*2)},s.prototype.getAABB=s.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},s.prototype.setOffset=s.prototype.setOffset=function(R){return this.offset=R,this};function o(R,E){this.pos=R||new i,this.angle=0,this.offset=new i,this.setPoints(E||[])}n.Polygon=o,o.prototype.setPoints=o.prototype.setPoints=function(R){var E=!this.points||this.points.length!==R.length;if(E){var D,$=this.calcPoints=[],I=this.edges=[],L=this.normals=[];for(D=0;D<R.length;D++){var U=R[D],V=D<R.length-1?R[D+1]:R[0];if(U!==V&&U.x===V.x&&U.y===V.y){R.splice(D,1),D-=1;continue}$.push(new i),I.push(new i),L.push(new i)}}return this.points=R,this._recalc(),this},o.prototype.setAngle=o.prototype.setAngle=function(R){return this.angle=R,this._recalc(),this},o.prototype.setOffset=o.prototype.setOffset=function(R){return this.offset=R,this._recalc(),this},o.prototype.rotate=o.prototype.rotate=function(R){for(var E=this.points,D=E.length,$=0;$<D;$++)E[$].rotate(R);return this._recalc(),this},o.prototype.translate=o.prototype.translate=function(R,E){for(var D=this.points,$=D.length,I=0;I<$;I++)D[I].x+=R,D[I].y+=E;return this._recalc(),this},o.prototype._recalc=function(){var R=this.calcPoints,E=this.edges,D=this.normals,$=this.points,I=this.offset,L=this.angle,U=$.length,V;for(V=0;V<U;V++){var X=R[V].copy($[V]);X.x+=I.x,X.y+=I.y,L!==0&&X.rotate(L)}for(V=0;V<U;V++){var H=R[V],J=V<U-1?R[V+1]:R[0],ee=E[V].copy(J).sub(H);D[V].copy(ee).perp().normalize()}return this},o.prototype.getAABBAsBox=o.prototype.getAABBAsBox=function(){for(var R=this.calcPoints,E=R.length,D=R[0].x,$=R[0].y,I=R[0].x,L=R[0].y,U=1;U<E;U++){var V=R[U];V.x<D?D=V.x:V.x>I&&(I=V.x),V.y<$?$=V.y:V.y>L&&(L=V.y)}return new a(this.pos.clone().add(new i(D,$)),I-D,L-$)},o.prototype.getAABB=o.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},o.prototype.getCentroid=o.prototype.getCentroid=function(){for(var R=this.calcPoints,E=R.length,D=0,$=0,I=0,L=0;L<E;L++){var U=R[L],V=L===E-1?R[0]:R[L+1],X=U.x*V.y-V.x*U.y;D+=(U.x+V.x)*X,$+=(U.y+V.y)*X,I+=X}return I=I*3,D=D/I,$=$/I,new i(D,$)};function a(R,E,D){this.pos=R||new i,this.w=E||0,this.h=D||0}n.Box=a,a.prototype.toPolygon=a.prototype.toPolygon=function(){var R=this.pos,E=this.w,D=this.h;return new o(new i(R.x,R.y),[new i,new i(E,0),new i(E,D),new i(0,D)])};function l(){this.a=null,this.b=null,this.overlapN=new i,this.overlapV=new i,this.clear()}n.Response=l,l.prototype.clear=l.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var h=[],u=0;u<10;u++)h.push(new i);for(var f=[],u=0;u<5;u++)f.push([]);var p=new l,m=new a(new i,1e-6,1e-6).toPolygon();function v(R,E,D){for(var $=Number.MAX_VALUE,I=-Number.MAX_VALUE,L=R.length,U=0;U<L;U++){var V=R[U].dot(E);V<$&&($=V),V>I&&(I=V)}D[0]=$,D[1]=I}function y(R,E,D,$,I,L){var U=f.pop(),V=f.pop(),X=h.pop().copy(E).sub(R),H=X.dot(I);if(v(D,I,U),v($,I,V),V[0]+=H,V[1]+=H,U[0]>V[1]||V[0]>U[1])return h.push(X),f.push(U),f.push(V),!0;if(L){var J=0;if(U[0]<V[0])if(L.aInB=!1,U[1]<V[1])J=U[1]-V[0],L.bInA=!1;else{var ee=U[1]-V[0],ne=V[1]-U[0];J=ee<ne?ee:-ne}else if(L.bInA=!1,U[1]>V[1])J=U[0]-V[1],L.aInB=!1;else{var ee=U[1]-V[0],ne=V[1]-U[0];J=ee<ne?ee:-ne}var ge=Math.abs(J);ge<L.overlap&&(L.overlap=ge,L.overlapN.copy(I),J<0&&L.overlapN.reverse())}return h.push(X),f.push(U),f.push(V),!1}n.isSeparatingAxis=y;function x(R,E){var D=R.len2(),$=E.dot(R);return $<0?w:$>D?O:S}var w=-1,S=0,O=1;function _(R,E){var D=h.pop().copy(R).sub(E.pos).sub(E.offset),$=E.r*E.r,I=D.len2();return h.push(D),I<=$}n.pointInCircle=_;function T(R,E){m.pos.copy(R),p.clear();var D=k(m,E,p);return D&&(D=p.aInB),D}n.pointInPolygon=T;function A(R,E,D){var $=h.pop().copy(E.pos).add(E.offset).sub(R.pos).sub(R.offset),I=R.r+E.r,L=I*I,U=$.len2();if(U>L)return h.push($),!1;if(D){var V=Math.sqrt(U);D.a=R,D.b=E,D.overlap=I-V,D.overlapN.copy($.normalize()),D.overlapV.copy($).scale(D.overlap),D.aInB=R.r<=E.r&&V<=E.r-R.r,D.bInA=E.r<=R.r&&V<=R.r-E.r}return h.push($),!0}n.testCircleCircle=A;function P(R,E,D){for(var $=h.pop().copy(E.pos).add(E.offset).sub(R.pos),I=E.r,L=I*I,U=R.calcPoints,V=U.length,X=h.pop(),H=h.pop(),J=0;J<V;J++){var ee=J===V-1?0:J+1,ne=J===0?V-1:J-1,ge=0,ye=null;X.copy(R.edges[J]),H.copy($).sub(U[J]),D&&H.len2()>L&&(D.aInB=!1);var ce=x(X,H);if(ce===w){X.copy(R.edges[ne]);var we=h.pop().copy($).sub(U[ne]);if(ce=x(X,we),ce===O){var be=H.len();if(be>I)return h.push($),h.push(X),h.push(H),h.push(we),!1;D&&(D.bInA=!1,ye=H.normalize(),ge=I-be)}h.push(we)}else if(ce===O){if(X.copy(R.edges[ee]),H.copy($).sub(U[ee]),ce=x(X,H),ce===w){var be=H.len();if(be>I)return h.push($),h.push(X),h.push(H),!1;D&&(D.bInA=!1,ye=H.normalize(),ge=I-be)}}else{var se=X.perp().normalize(),be=H.dot(se),ae=Math.abs(be);if(be>0&&ae>I)return h.push($),h.push(se),h.push(H),!1;D&&(ye=se,ge=I-be,(be>=0||ge<2*I)&&(D.bInA=!1))}ye&&D&&Math.abs(ge)<Math.abs(D.overlap)&&(D.overlap=ge,D.overlapN.copy(ye))}return D&&(D.a=R,D.b=E,D.overlapV.copy(D.overlapN).scale(D.overlap)),h.push($),h.push(X),h.push(H),!0}n.testPolygonCircle=P;function N(R,E,D){var $=P(E,R,D);if($&&D){var I=D.a,L=D.aInB;D.overlapN.reverse(),D.overlapV.reverse(),D.a=D.b,D.b=I,D.aInB=D.bInA,D.bInA=L}return $}n.testCirclePolygon=N;function k(R,E,D){for(var $=R.calcPoints,I=$.length,L=E.calcPoints,U=L.length,V=0;V<I;V++)if(y(R.pos,E.pos,$,L,R.normals[V],D))return!1;for(var V=0;V<U;V++)if(y(R.pos,E.pos,$,L,E.normals[V],D))return!1;return D&&(D.a=R,D.b=E,D.overlapV.copy(D.overlapN).scale(D.overlap)),!0}return n.testPolygonPolygon=k,n})})(SJ);var oc=SJ.exports;const Ta=Object.freeze({ALL:0,PLAYER:1,PLAYER_BULLET:2,ENERMY:3,ENERMY_BULLET:4,BGCIRCLE:5}),yp=Object.freeze({BG:0,ENERMY:1,PLAYER:2,BULLET:3,EFFECT:4,UI:5});class w0 extends ss{constructor(){super(),this.ShowLayer=yp.BG,this.circleAutoRemove=!0,this.on("added",this.onAdd.bind(this)),this.on("removed",this.onRemoved.bind(this))}get collisionLayer(){return Ta.ALL}getCollider(){return null}onAdd(){window.shooterApp.tickManager.register(this.update.bind(this),this)}onRemoved(e){window.shooterApp.tickManager.unregisterByObj(this)}update(){}onCollide(e){}get ShowLayer(){return this._ShowLayer}set ShowLayer(e){this._ShowLayer=e}isOutOfCircle(e){return this.x*this.x+this.y*this.y>e*e}}class ZXe extends w0{constructor(){super(),this.graphics=new e0,this.addChild(this.graphics),this.stars=[]}get collisionLayer(){return Ta.BGCIRCLE}onCollide(e){e.collisionLayer===Ta.PLAYER_BULLET&&this.shake()}init(){this.radius=window.shooterApp.radius,this.lineWidth=5,this.lineColor=13421772,this.graphics.clear(),this.graphics.lineStyle(this.lineWidth,this.lineColor),this.graphics.drawCircle(0,0,this.radius),this.x=0,this.y=0,this._createStars()}_createStars(){for(const o of this.stars)this.removeChild(o);this.stars=[];const e=window.shooterApp;if(!e||!e.pixi||!e.pixi.screen)return;const n=e.pixi.screen.width,i=e.pixi.screen.height,s=80;for(let o=0;o<s;o++)this._createStar(n,i)}_createStar(e,n){const i=Math.random()*e-e/2,s=Math.random()*n-n/2,o=Math.random()*.4+.2,a=Math.random()*.25+.05,l=sa.from("shooter/star_small.png");l.x=i,l.y=s,l.anchor.set(.5),l.scale.set(o),l.alpha=a,l._baseAlpha=a,l._maxTwinkle=Math.floor(Math.random()*7)+4,l._twinkleCount=0,l._twinkleTime=Math.random()*Math.PI*2,l._twinkleSpeed=Math.random()*.001+1e-4,l._lastSin=Math.sin(l._twinkleTime),l.alpha=l._baseAlpha,this.addChildAt(l,0),this.stars.push(l)}update(e){this._updateShake(e)}shake(e=.01,n=50){this._shakeStrength=e,this._shakeDuration=n,this._shakeTime=0,this._shakeActive=!0}_updateShake(e=16){if(!this._shakeActive){this.graphics&&(this.graphics.scale.x!==1||this.graphics.scale.y!==1)&&this.graphics.scale.set(1,1);return}this._shakeTime+=e;const n=this._shakeTime/this._shakeDuration;if(n>=1){this.graphics&&this.graphics.scale.set(1,1),this._shakeActive=!1;return}const i=Math.random()*Math.PI*2,s=this._shakeStrength*(1-n)*(.7+.3*Math.sin(n*Math.PI*8)),o=1+Math.cos(i)*s,a=1+Math.sin(i)*s;this.graphics&&this.graphics.scale.set(o,a)}_updateStars(e){const n=window.shooterApp;if(!n||!n.pixi||!n.pixi.screen)return;const i=n.pixi.screen.width,s=n.pixi.screen.height;for(let o=this.stars.length-1;o>=0;o--){const a=this.stars[o];a._twinkleTime+=a._twinkleSpeed*e;const l=Math.sin(a._twinkleTime);if(a.alpha=a._baseAlpha*Math.abs(l),a._lastSin<0&&l>=0&&(a._twinkleCount++,a._twinkleCount>=a._maxTwinkle)){this.removeChild(a),this.stars.splice(o,1),this._createStar(i,s);continue}a._lastSin=l}}}class oS{static getLevelData(e){return e<=0?this.levels[0]:e>this.levels.length?this.levels[this.levels.length-1]:this.levels[e-1]}}Nc(oS,"levels",[{maxHp:100,weaponFireInterval:100,expToLevel:100},{maxHp:120,weaponFireInterval:85,expToLevel:120},{maxHp:140,weaponFireInterval:72,expToLevel:144},{maxHp:160,weaponFireInterval:61,expToLevel:173},{maxHp:180,weaponFireInterval:52,expToLevel:207},{maxHp:200,weaponFireInterval:44,expToLevel:248},{maxHp:220,weaponFireInterval:38,expToLevel:298},{maxHp:240,weaponFireInterval:33,expToLevel:358},{maxHp:260,weaponFireInterval:30,expToLevel:430},{maxHp:280,weaponFireInterval:30,expToLevel:516}]);class KXe extends e0{constructor(e,n,i={}){super(),this.x=e,this.y=n,this.alpha=1,this.vx=i.vx||0,this.vy=i.vy||0,this.fade=i.fade||.03,this.color=i.color||16777062+Math.floor(Math.random()*48),this.spikes=i.spikes||5,this.outerRadius=i.outerRadius||2+Math.random()*2,this.innerRadius=i.innerRadius||1+Math.random()*1,this.drawStar()}drawStar(){this.clear(),this.beginFill(this.color);let e=Math.PI/2*3,n=0,i=0,s=Math.PI/this.spikes;this.moveTo(0,-this.outerRadius);for(let o=0;o<this.spikes;o++)n=Math.cos(e)*this.outerRadius,i=Math.sin(e)*this.outerRadius,this.lineTo(n,i),e+=s,n=Math.cos(e)*this.innerRadius,i=Math.sin(e)*this.innerRadius,this.lineTo(n,i),e+=s;this.lineTo(0,-this.outerRadius),this.endFill()}}class JXe extends w0{constructor(e,n,i={}){super(),this.x=e,this.y=n,this.ShowLayer=yp.EFFECT;const s=i.numParticles||2,o=i.fade||.05,a=i.color||16777113,l=i.spikes||5,h=i.outerRadius||4+Math.random()*3,u=i.innerRadius||2+Math.random()*2,f=i.speedMin||3.5,p=i.speedMax||7;this.particles=[];for(let m=0;m<s;m++){const v=Math.random()*Math.PI*2,y=f+Math.random()*(p-f),x=new KXe(0,0,{vx:Math.cos(v)*y,vy:Math.sin(v)*y,fade:o,color:a,spikes:l,outerRadius:h,innerRadius:u});this.addChild(x),this.particles.push(x)}this._onTick=this._onTick.bind(this),window.shooterApp&&window.shooterApp.tickManager&&window.shooterApp.tickManager.register(this._onTick,this)}_onTick(e){e/=10;for(let n=this.particles.length-1;n>=0;n--){const i=this.particles[n];i.x+=i.vx*e,i.y+=i.vy*e,i.alpha-=(i.fade||.03)*e,i.alpha<=0&&(i.parent&&i.parent.removeChild(i),this.particles.splice(n,1))}this.particles.length===0&&window.shooterApp.gameObjectManager.remove(this)}}class eWe extends w0{constructor(e,n,i,s=10){super(),this.ShowLayer=yp.BULLET,this.x=e,this.y=n,this.angle=i,this.speed=s,this.vx=Math.cos(i)*s,this.vy=Math.sin(i)*s,this.alive=!0,this.sprite=sa.from("shooter/bullet1.png"),this.sprite.anchor.set(.5),this.addChild(this.sprite)}get collisionLayer(){return Ta.PLAYER_BULLET}getCollider(){const e=this.sprite?this.sprite.width/2:5;return new oc.Circle(new oc.Vector(this.x,this.y),e)}update(){this.x+=this.vx,this.y+=this.vy}onCollide(e){const n=new JXe(this.x,this.y);window.shooterApp.gameObjectManager.add(n);const i=[Ta.BGCIRCLE,Ta.ENERMY];e&&i.includes(e.collisionLayer)&&window.shooterApp.gameObjectManager.remove(this)}}class tWe extends w0{constructor(n){super();Nc(this,"level",1);this.level=1,this.shooting=!1,this.player=n,this.fireInterval=100,this.cooldown=0}levelUp(){this.level+=1,this.fireInterval=Math.max(30,Math.floor(this.fireInterval*.85))}shoot(){if(this.cooldown>0)return;const n=this.player.angle,i=this.player.x+Math.cos(n)*40,s=this.player.y+Math.sin(n)*40,o=new eWe(i,s,n);window.shooterApp.gameObjectManager.add(o),this.cooldown=this.fireInterval}update(n){this.cooldown>0&&(this.cooldown-=n,this.cooldown<0&&(this.cooldown=0))}}class iWe extends w0{constructor(){super();Nc(this,"exp",0);Nc(this,"level",1);Nc(this,"expToLevel",100);this.sprite=null,this.speed=6,this.turnSpeed=.15,this.angle=0,this.radius=0,this.weapon=null,this.ShowLayer=yp.PLAYER,this.level=1,this.exp=0;const n=oS.getLevelData(this.level);this.maxHp=n.maxHp,this.hp=this.maxHp,this.expToLevel=n.expToLevel,this.bloodBarContainer=null,this.bloodBarBg=null,this.bloodBar=null}get collisionLayer(){return Ta.PLAYER}getCollider(){if(!this.colObj){let n=this.sprite.width/4;this.colObj=new oc.Circle(new oc.Vector(this.x,this.y),n)}return this.colObj&&(this.colObj.pos.x=this.x,this.colObj.pos.y=this.y),this.colObj}async init(){this.level=1,this.exp=0;const n=oS.getLevelData(this.level);this.maxHp=n.maxHp,this.hp=this.maxHp,this.expToLevel=n.expToLevel,this.radius=window.shooterApp.radius,this._tickManager=window.shooterApp.tickManager,this.sprite=sa.from("shooter/ship_E.png"),this.sprite.anchor.set(.5),this.addChild(this.sprite),this.bloodBarContainer=new ss,this.bloodBarBg=sa.from("shooter/player_blood_bg.png"),this.bloodBar=sa.from("shooter/player_blood_bar.png"),this.bloodBarBg.anchor.set(0,1),this.bloodBar.anchor.set(0,1),this.bloodBarContainer.addChild(this.bloodBarBg),this.bloodBarContainer.addChild(this.bloodBar),this.bloodBarContainer.x=-this.sprite.width/2-5,this.bloodBarContainer.y=-this.bloodBar.width/2,this.bloodBarContainer.rotation=Math.PI/2,this.sprite.addChild(this.bloodBarContainer),this.x=0,this.y=0,this.angle=0,this.weapon=new tWe(this),this.addChild(this.weapon),this.updateBloodBar()}addExp(n){for(this.exp+=n;this.exp>=this.expToLevel;)this.exp-=this.expToLevel,this.levelUp();window.shooterApp&&window.shooterApp.updatePlayerStatusUI&&window.shooterApp.updatePlayerStatusUI(this.level,this.exp,this.expToLevel)}levelUp(){this.level+=1;const n=oS.getLevelData(this.level);this.maxHp=n.maxHp,this.hp=this.maxHp,this.expToLevel=n.expToLevel,this.weapon&&typeof this.weapon.levelUp=="function"&&this.weapon.levelUp(n),window.shooterApp&&window.shooterApp.updatePlayerStatusUI&&window.shooterApp.updatePlayerStatusUI(this.level,this.exp,this.expToLevel)}updateWeapon(n){this.weapon&&this.weapon.update(n)}updateBloodBar(){if(!this.bloodBar)return;let n=Math.max(0,Math.min(1,this.hp/this.maxHp));this.bloodBar.scale.x=n}lookAt(n,i){const s=n-this.x,o=i-this.y,a=Math.atan2(o,s);a-this.angle,this.angle=a,this.sprite&&(this.sprite.rotation=this.angle)}moveByKeys(n,i){this.updateBloodBar();let s=0,o=0;if(n.w&&(o-=1),n.s&&(o+=1),n.a&&(s-=1),n.d&&(s+=1),s!==0||o!==0){let a=Math.sqrt(s*s+o*o);s/=a,o/=a;let l=s*this.speed,h=o*this.speed,u=this.x+l,f=this.y+h,p=Math.sqrt(u*u+f*f),m=i!==void 0?i:this.radius;if(p>m){let v=m/p;u*=v,f*=v}this.x=u,this.y=f}}}const nWe=[[!0,!0,!0,!0,!0,!0],[!0,!1,!1,!0,!0,!0],[!0,!1,!1,!0,!1,!0],[!0,!0,!0,!1,!1,!0],[!0,!0,!1,!1,!1,!1],[!0,!0,!0,!0,!1,!1]];class rWe extends ss{constructor(){super(),this.app=window.shooterApp,this.objects=[],this.layerContainers={};for(const e in yp){const n=yp[e],i=new ss;this.layerContainers[n]=i,this.addChild(i)}}add(e){this.objects.includes(e)||(this.objects.push(e),typeof e.ShowLayer=="number"&&this.layerContainers[e.ShowLayer]?this.layerContainers[e.ShowLayer].addChild(e):e instanceof Zn&&e.parent!==this&&this.addChild(e))}remove(e){const n=this.objects.indexOf(e);if(n!==-1){this.objects.splice(n,1);for(const i of Object.values(this.layerContainers))e.parent===i&&i.removeChild(e);e.parent===this&&this.removeChild(e)}}updateAll(){for(let n=this.objects.length-1;n>=0;n--){const i=this.objects[n];i.isOutOfCircle(window.shooterApp.radius)&&(window.shooterApp.bg.onCollide(i),i.onCollide(window.shooterApp.bg))}let e=this.getCollisions();console.log("collisions",e);for(const[n,i]of e)typeof n.onCollide=="function"&&n.onCollide(i),typeof i.onCollide=="function"&&i.onCollide(n)}getCollisions(){var i;const e=[],n=this.objects;for(let s=0;s<n.length;s++)for(let o=s+1;o<n.length;o++){const a=n[s],l=n[o];if(!((i=nWe[a.collisionLayer])!=null&&i[l.collisionLayer]))continue;const h=a.getCollider&&a.getCollider(),u=l.getCollider&&l.getCollider();let f=null;h&&u&&h instanceof oc.Circle&&u instanceof oc.Circle&&(f=oc.testCircleCircle(h,u)),console.log("collider",h instanceof oc.Circle,f),f&&e.push([a,l])}return e}}class sWe{constructor(){this.time=0,this.frame=0,this.updaters=[]}register(e,n){if(!n)throw new Error("TickManager.register: obj 参数不能为空");this.updaters.some(i=>i.fn===e)||this.updaters.push({fn:e,obj:n})}unregister(e){const n=this.updaters.findIndex(i=>i.fn===e);n!==-1&&this.updaters.splice(n,1)}unregisterByObj(e){this.updaters=this.updaters.filter(n=>n.obj!==e)}tick(e){this.time+=e,this.frame++;for(let n=0;n<this.updaters.length;n++)this.updaters[n].fn(e,this.time,this.frame)}}class oWe extends w0{constructor(){super(),this.sprite=null,this.speed=2,this.angle=0,this.radius=0,this.ShowLayer=yp.ENERMY}get collisionLayer(){return Ta.ENERMY}getCollider(){const e=this.sprite?this.sprite.width/2:this.radius||20;return new oc.Circle(new oc.Vector(this.x,this.y),e)}async init(){this.radius=window.shooterApp.radius,this._tickManager=window.shooterApp.tickManager,this.sprite=sa.from("shooter/enemy_B.png"),this.sprite.anchor.set(.5),this.addChild(this.sprite),this.x=0,this.y=0,this.angle=0}updateAI(){this.angle+=.01,this.sprite&&(this.sprite.rotation=this.angle)}onCollide(e){(e.collisionLayer==Ta.PLAYER||e.collisionLayer==Ta.PLAYER_BULLET)&&(e.collisionLayer==Ta.PLAYER&&e.hp!==void 0&&(e.hp-=20,e.hp<0&&(e.hp=0),e.updateBloodBar&&e.updateBloodBar()),e.collisionLayer==Ta.PLAYER_BULLET&&window.shooterApp.player&&typeof window.shooterApp.player.addExp=="function"&&window.shooterApp.player.addExp(10),window.shooterApp.gameObjectManager.remove(this))}}class aWe{constructor(e,n,i={}){this.player=e,this.gameObjectManager=n,this.spawnInterval=i.spawnInterval||2e3,this.batchSize=i.batchSize||1,this.radius=i.spawnRadius||window.shooterApp.radius+60,this.enermies=[],this._lastSpawn=0,this._tick=this._tick.bind(this),window.shooterApp.tickManager.register(this._tick,this)}_tick(e){this._lastSpawn+=e*16.67,this._lastSpawn>=this.spawnInterval&&(this._lastSpawn=0,this.spawnBatch());for(const n of this.enermies)n&&n.updateAI&&n.updateAI(this.player);this.enermies=this.enermies.filter(n=>n.parent)}async spawnBatch(){for(let e=0;e<this.batchSize;e++){const n=Math.random()*Math.PI*2,i=Math.cos(n)*this.radius,s=Math.sin(n)*this.radius,o=new oWe;await o.init(),o.x=i,o.y=s,o.angle=n+Math.PI,o.updateAI=function(a){if(!a)return;const l=a.x-this.x,h=a.y-this.y,u=Math.atan2(h,l);this.angle=u,this.sprite&&(this.sprite.rotation=this.angle);const f=this.speed||2;this.x+=Math.cos(this.angle)*f,this.y+=Math.sin(this.angle)*f},this.gameObjectManager.add(o),this.enermies.push(o)}}destroy(){window.shooterApp.tickManager.unregisterByObj(this),this.enermies.forEach(e=>{e.parent&&e.parent.removeChild(e)}),this.enermies=[]}}const lWe=r=>(_p("data-v-a822f0f1"),r=r(),Op(),r),cWe=lWe(()=>xt("div",{id:"player-status-ui",style:{position:"fixed",top:"16px",right:"24px","z-index":"10",color:"#fff","font-size":"18px","font-family":"monospace","text-align":"right","text-shadow":"0 1px 4px #222","pointer-events":"none"}},[xt("div",{id:"player-level"},"Lv.1"),xt("div",{id:"player-exp"},"EXP: 0/100")],-1)),hWe={__name:"Shooter",setup(r){const e=ot(null);let n={pixi:null,tickManager:null,root:null,bg:null,radius:0,diameter:0,mouse:{x:0,y:0},keys:{w:!1,a:!1,s:!1,d:!1},gameObjectManager:null,shooting:!1};function i(){}function s(){n.tickManager=new sWe,o(),a(),l(),n.enermyManager=new aWe(n.player,n.gameObjectManager)}function o(){n.gameObjectManager=new rWe,n.root.addChild(n.gameObjectManager)}function a(){n.bg=new ZXe,n.gameObjectManager.add(n.bg),n.bg.init()}function l(){n.player=new iWe,n.gameObjectManager.add(n.player),n.player.init()}return Xn(()=>{window.shooterApp=n,window.shooterApp.updatePlayerStatusUI=function(v,y,x){const w=document.getElementById("player-level"),S=document.getElementById("player-exp");w&&(w.textContent=`Lv.${v}`),S&&(S.textContent=`EXP: ${y}/${x}`)};const h=window.innerWidth,u=window.innerHeight;n.diameter=Math.min(h,u)*.9,n.radius=n.diameter/2,window.shooterApp=n,n.pixi=new hx({width:h,height:u,backgroundAlpha:0,antialias:!0}),e.value&&e.value.appendChild(n.pixi.view),n.root=new ss,n.root.x=h/2,n.root.y=u/2,n.pixi.stage.addChild(n.root),window.addEventListener("resize",i);const f=new tN("Loading...",{fontSize:36,fill:16777215});f.anchor.set(.5),f.x=h/2,f.y=u/2,n.pixi.stage.addChild(f);let p=["shooter/ship_E.png","shooter/enemy_B.png","shooter/player_blood_bg.png","shooter/player_blood_bar.png"];Eo&&Eo.load?Eo.load(p).then(()=>{n.pixi.stage.removeChild(f),m()}):(n.pixi.stage.removeChild(f),m());function m(){n.pixi.view.addEventListener("mousemove",v=>{const y=n.pixi.view.getBoundingClientRect();n.mouse.x=v.clientX-y.left-y.width/2,n.mouse.y=v.clientY-y.top-y.height/2}),n.pixi.view.addEventListener("mousedown",v=>{v.button===0&&n.player&&n.player.weapon&&(n.player.weapon.shooting=!0)}),n.pixi.view.addEventListener("mouseup",v=>{v.button===0&&n.player&&n.player.weapon&&(n.player.weapon.shooting=!1)}),window.addEventListener("keydown",v=>{["w","a","s","d"].includes(v.key.toLowerCase())&&(n.keys[v.key.toLowerCase()]=!0)}),window.addEventListener("keyup",v=>{["w","a","s","d"].includes(v.key.toLowerCase())&&(n.keys[v.key.toLowerCase()]=!1)}),s(),n.pixi.ticker.add(v=>{const y=v*1e3/60;n.tickManager&&n.tickManager.tick(y),n.player&&(n.player.lookAt(n.mouse.x,n.mouse.y),n.player.moveByKeys(n.keys,n.radius),n.player.weapon&&n.player.weapon.shooting&&n.player.weapon.shoot()),n.gameObjectManager.updateAll()})}}),Sb(()=>{window.removeEventListener("resize",i),n&&n.enermyManager&&n.enermyManager.destroy(),n&&(n.pixi.destroy(!0,{children:!0}),n=null)}),(h,u)=>(ri(),Ji(yn,null,[xt("div",{ref_key:"pixiContainer",ref:e,class:"pixi-full"},null,512),cWe],64))}},uWe=Ap(hWe,[["__scopeId","data-v-a822f0f1"]]),dWe={key:0},fWe={key:1},pWe={__name:"App",setup(r){const e=[{id:"TankMain",title:"坦克大战",comp:ake},{id:"KonvaMain",title:"Konva示例",comp:lPe},{id:"CoinKnight",title:"金币骑士",comp:fy,link:"CoinKnight/index.html"},{id:"FarmMine",title:"田园扫雷",comp:fy,link:"FarmMine/index.html"},{id:"jigsaw",title:"拼图游戏",comp:fy,link:"jigsaw/index.html"},{id:"tetris",title:"俄罗斯方块",comp:fy,link:"tetris/index.html"},{id:"heart",title:"跳动的爱心",comp:fy,link:"webui/heart.html"},{id:"KonvaStageTest",title:"KonvaStageTest",comp:vPe},{id:"GridSquare",title:"矩形网格",comp:uPe},{id:"GridParallelogramH",title:"横向平行四边形网格",comp:fPe},{id:"GridParallelogramV",title:"纵向平行四边形网格",comp:mPe},{id:"TrigoCalc",title:"三角函数计算器",comp:bPe},{id:"ShaderFragBase",title:"Shader-函数入门",comp:GDe},{id:"ShaderImageBase",title:"Shader-图像入门",comp:qDe},{id:"d-puzzle",title:"d-拼图演示",comp:MA,link:"video/puzzle.mp4"},{id:"d-ice",title:"d-冰块演示",comp:MA,link:"video/ice.mp4"},{id:"d-door",title:"d-传送门",comp:MA,link:"video/door.mp4"},{id:"BallGame",title:"小球碰撞游戏",comp:rLe},{id:"CurveRope",title:"曲线绳子(Three)",comp:gLe},{id:"CurveRopePixi",title:"曲线绳子(Pixi)",comp:Cze},{id:"PixiHello",title:"PixiHello",comp:Tze},{id:"ThreeHello",title:"ThreeHello",comp:cLe},{id:"Game2048",title:"Game2048",comp:XXe},{id:"SplitImage",title:"SplitImage",comp:qXe},{id:"Shooter",title:"Shooter",comp:uWe}],n=ot(window.location.hash.slice(1));window.addEventListener("hashchange",()=>{n.value=window.location.hash.slice(1),document.title="Project:"+n.value});const i=Rn(()=>e.find(o=>o.id===n.value)),s=Rn(()=>{var o;return(o=i.value)==null?void 0:o.comp});return(o,a)=>{const l=bt("GridItem"),h=bt("Grid");return s.value?(ri(),Ji("div",dWe,[(ri(),Ar(q7,null,{default:qe(()=>[i.value.link?(ri(),Ar(Uk(s.value),{key:0,link:i.value.link},null,8,["link"])):(ri(),Ar(Uk(s.value),{key:1}))]),_:1}))])):(ri(),Ji("div",fWe,[Pe(h,{col:5},{default:qe(()=>[(ri(),Ji(yn,null,hc(e,u=>Pe(l,null,{default:qe(()=>[Pe(d0e,{routeData:u},null,8,["routeData"])]),_:2},1024)),64))]),_:1})]))}}};var uT=uW(pWe);uT.use(WXe);uT.use(ESe);uT.use(yj);uT.mount("#app");
