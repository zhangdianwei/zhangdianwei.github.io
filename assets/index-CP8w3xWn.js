var Upe=Object.defineProperty;var Fpe=(s,e,i)=>e in s?Upe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i;var zpe=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var cn=(s,e,i)=>(Fpe(s,typeof e!="symbol"?e+"":e,i),i);var a8e=zpe(Cs=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function i(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=i(r);fetch(r.href,o)}})();/**
* @vue/shared v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function LT(s,e){const i=new Set(s.split(","));return n=>i.has(n)}const kn={},b0=[],Go=()=>{},Xpe=()=>!1,cb=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&(s.charCodeAt(2)>122||s.charCodeAt(2)<97),YR=s=>s.startsWith("onUpdate:"),ts=Object.assign,jR=(s,e)=>{const i=s.indexOf(e);i>-1&&s.splice(i,1)},Wpe=Object.prototype.hasOwnProperty,dn=(s,e)=>Wpe.call(s,e),Lt=Array.isArray,w0=s=>Sy(s)==="[object Map]",Cm=s=>Sy(s)==="[object Set]",JU=s=>Sy(s)==="[object Date]",Hpe=s=>Sy(s)==="[object RegExp]",yi=s=>typeof s=="function",hs=s=>typeof s=="string",du=s=>typeof s=="symbol",Ln=s=>s!==null&&typeof s=="object",qR=s=>(Ln(s)||yi(s))&&yi(s.then)&&yi(s.catch),nH=Object.prototype.toString,Sy=s=>nH.call(s),Gpe=s=>Sy(s).slice(8,-1),sH=s=>Sy(s)==="[object Object]",ZR=s=>hs(s)&&s!=="NaN"&&s[0]!=="-"&&""+parseInt(s,10)===s,O0=LT(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),NT=s=>{const e=Object.create(null);return i=>e[i]||(e[i]=s(i))},Qpe=/-(\w)/g,wo=NT(s=>s.replace(Qpe,(e,i)=>i?i.toUpperCase():"")),Ype=/\B([A-Z])/g,Ea=NT(s=>s.replace(Ype,"-$1").toLowerCase()),hb=NT(s=>s.charAt(0).toUpperCase()+s.slice(1)),Nx=NT(s=>s?`on${hb(s)}`:""),nc=(s,e)=>!Object.is(s,e),S0=(s,e)=>{for(let i=0;i<s.length;i++)s[i](e)},rH=(s,e,i,n=!1)=>{Object.defineProperty(s,e,{configurable:!0,enumerable:!1,writable:n,value:i})},cC=s=>{const e=parseFloat(s);return isNaN(e)?s:e},hC=s=>{const e=hs(s)?Number(s):NaN;return isNaN(e)?s:e};let eF;const oH=()=>eF||(eF=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),jpe="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error",qpe=LT(jpe);function Au(s){if(Lt(s)){const e={};for(let i=0;i<s.length;i++){const n=s[i],r=hs(n)?eme(n):Au(n);if(r)for(const o in r)e[o]=r[o]}return e}else if(hs(s)||Ln(s))return s}const Zpe=/;(?![^(]*\))/g,Kpe=/:([^]+)/,Jpe=/\/\*[^]*?\*\//g;function eme(s){const e={};return s.replace(Jpe,"").split(Zpe).forEach(i=>{if(i){const n=i.split(Kpe);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Cy(s){let e="";if(hs(s))e=s;else if(Lt(s))for(let i=0;i<s.length;i++){const n=Cy(s[i]);n&&(e+=n+" ")}else if(Ln(s))for(const i in s)s[i]&&(e+=i+" ");return e.trim()}function aH(s){if(!s)return null;let{class:e,style:i}=s;return e&&!hs(e)&&(s.class=Cy(e)),i&&(s.style=Au(i)),s}const tme="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ime=LT(tme);function lH(s){return!!s||s===""}function nme(s,e){if(s.length!==e.length)return!1;let i=!0;for(let n=0;i&&n<s.length;n++)i=Kd(s[n],e[n]);return i}function Kd(s,e){if(s===e)return!0;let i=JU(s),n=JU(e);if(i||n)return i&&n?s.getTime()===e.getTime():!1;if(i=du(s),n=du(e),i||n)return s===e;if(i=Lt(s),n=Lt(e),i||n)return i&&n?nme(s,e):!1;if(i=Ln(s),n=Ln(e),i||n){if(!i||!n)return!1;const r=Object.keys(s).length,o=Object.keys(e).length;if(r!==o)return!1;for(const a in s){const l=s.hasOwnProperty(a),h=e.hasOwnProperty(a);if(l&&!h||!l&&h||!Kd(s[a],e[a]))return!1}}return String(s)===String(e)}function VT(s,e){return s.findIndex(i=>Kd(i,e))}const ea=s=>hs(s)?s:s==null?"":Lt(s)||Ln(s)&&(s.toString===nH||!yi(s.toString))?JSON.stringify(s,cH,2):String(s),cH=(s,e)=>e&&e.__v_isRef?cH(s,e.value):w0(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((i,[n,r],o)=>(i[MM(n,o)+" =>"]=r,i),{})}:Cm(e)?{[`Set(${e.size})`]:[...e.values()].map(i=>MM(i))}:du(e)?MM(e):Ln(e)&&!Lt(e)&&!sH(e)?String(e):e,MM=(s,e="")=>{var i;return du(s)?`Symbol(${(i=s.description)!=null?i:e})`:s};/**
* @vue/reactivity v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Sa;class KR{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Sa,!e&&Sa&&(this.index=(Sa.scopes||(Sa.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const i=Sa;try{return Sa=this,e()}finally{Sa=i}}}on(){Sa=this}off(){Sa=this.parent}stop(e){if(this._active){let i,n;for(i=0,n=this.effects.length;i<n;i++)this.effects[i].stop();for(i=0,n=this.cleanups.length;i<n;i++)this.cleanups[i]();if(this.scopes)for(i=0,n=this.scopes.length;i<n;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function sme(s){return new KR(s)}function hH(s,e=Sa){e&&e.active&&e.effects.push(s)}function $T(){return Sa}function JR(s){Sa&&Sa.cleanups.push(s)}let Xp;class q0{constructor(e,i,n,r){this.fn=e,this.trigger=i,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,hH(this,r)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,pf();for(let e=0;e<this._depsLength;e++){const i=this.deps[e];if(i.computed&&(rme(i.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),mf()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=Gd,i=Xp;try{return Gd=!0,Xp=this,this._runnings++,tF(this),this.fn()}finally{iF(this),this._runnings--,Xp=i,Gd=e}}stop(){this.active&&(tF(this),iF(this),this.onStop&&this.onStop(),this.active=!1)}}function rme(s){return s.value}function tF(s){s._trackId++,s._depsLength=0}function iF(s){if(s.deps.length>s._depsLength){for(let e=s._depsLength;e<s.deps.length;e++)uH(s.deps[e],s);s.deps.length=s._depsLength}}function uH(s,e){const i=s.get(e);i!==void 0&&e._trackId!==i&&(s.delete(e),s.size===0&&s.cleanup())}function ome(s,e){s.effect instanceof q0&&(s=s.effect.fn);const i=new q0(s,Go,()=>{i.dirty&&i.run()});e&&(ts(i,e),e.scope&&hH(i,e.scope)),(!e||!e.lazy)&&i.run();const n=i.run.bind(i);return n.effect=i,n}function ame(s){s.effect.stop()}let Gd=!0,B2=0;const dH=[];function pf(){dH.push(Gd),Gd=!1}function mf(){const s=dH.pop();Gd=s===void 0?!0:s}function eD(){B2++}function tD(){for(B2--;!B2&&R2.length;)R2.shift()()}function fH(s,e,i){if(e.get(s)!==s._trackId){e.set(s,s._trackId);const n=s.deps[s._depsLength];n!==e?(n&&uH(n,s),s.deps[s._depsLength++]=e):s._depsLength++}}const R2=[];function pH(s,e,i){eD();for(const n of s.keys()){let r;n._dirtyLevel<e&&(r??(r=s.get(n)===n._trackId))&&(n._shouldSchedule||(n._shouldSchedule=n._dirtyLevel===0),n._dirtyLevel=e),n._shouldSchedule&&(r??(r=s.get(n)===n._trackId))&&(n.trigger(),(!n._runnings||n.allowRecurse)&&n._dirtyLevel!==2&&(n._shouldSchedule=!1,n.scheduler&&R2.push(n.scheduler)))}tD()}const mH=(s,e)=>{const i=new Map;return i.cleanup=s,i.computed=e,i},uC=new WeakMap,Wp=Symbol(""),D2=Symbol("");function ia(s,e,i){if(Gd&&Xp){let n=uC.get(s);n||uC.set(s,n=new Map);let r=n.get(i);r||n.set(i,r=mH(()=>n.delete(i))),fH(Xp,r)}}function nu(s,e,i,n,r,o){const a=uC.get(s);if(!a)return;let l=[];if(e==="clear")l=[...a.values()];else if(i==="length"&&Lt(s)){const h=Number(n);a.forEach((d,f)=>{(f==="length"||!du(f)&&f>=h)&&l.push(d)})}else switch(i!==void 0&&l.push(a.get(i)),e){case"add":Lt(s)?ZR(i)&&l.push(a.get("length")):(l.push(a.get(Wp)),w0(s)&&l.push(a.get(D2)));break;case"delete":Lt(s)||(l.push(a.get(Wp)),w0(s)&&l.push(a.get(D2)));break;case"set":w0(s)&&l.push(a.get(Wp));break}eD();for(const h of l)h&&pH(h,4);tD()}function lme(s,e){const i=uC.get(s);return i&&i.get(e)}const cme=LT("__proto__,__v_isRef,__isVue"),gH=new Set(Object.getOwnPropertyNames(Symbol).filter(s=>s!=="arguments"&&s!=="caller").map(s=>Symbol[s]).filter(du)),nF=hme();function hme(){const s={};return["includes","indexOf","lastIndexOf"].forEach(e=>{s[e]=function(...i){const n=un(this);for(let o=0,a=this.length;o<a;o++)ia(n,"get",o+"");const r=n[e](...i);return r===-1||r===!1?n[e](...i.map(un)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{s[e]=function(...i){pf(),eD();const n=un(this)[e].apply(this,i);return tD(),mf(),n}}),s}function ume(s){du(s)||(s=String(s));const e=un(this);return ia(e,"has",s),e.hasOwnProperty(s)}class yH{constructor(e=!1,i=!1){this._isReadonly=e,this._isShallow=i}get(e,i,n){const r=this._isReadonly,o=this._isShallow;if(i==="__v_isReactive")return!r;if(i==="__v_isReadonly")return r;if(i==="__v_isShallow")return o;if(i==="__v_raw")return n===(r?o?OH:wH:o?bH:_H).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=Lt(e);if(!r){if(a&&dn(nF,i))return Reflect.get(nF,i,n);if(i==="hasOwnProperty")return ume}const l=Reflect.get(e,i,n);return(du(i)?gH.has(i):cme(i))||(r||ia(e,"get",i),o)?l:Ys(l)?a&&ZR(i)?l:l.value:Ln(l)?r?rm(l):Tm(l):l}}class vH extends yH{constructor(e=!1){super(!1,e)}set(e,i,n,r){let o=e[i];if(!this._isShallow){const h=Z0(o);if(!o_(n)&&!Z0(n)&&(o=un(o),n=un(n)),!Lt(e)&&Ys(o)&&!Ys(n))return h?!1:(o.value=n,!0)}const a=Lt(e)&&ZR(i)?Number(i)<e.length:dn(e,i),l=Reflect.set(e,i,n,r);return e===un(r)&&(a?nc(n,o)&&nu(e,"set",i,n):nu(e,"add",i,n)),l}deleteProperty(e,i){const n=dn(e,i);e[i];const r=Reflect.deleteProperty(e,i);return r&&n&&nu(e,"delete",i,void 0),r}has(e,i){const n=Reflect.has(e,i);return(!du(i)||!gH.has(i))&&ia(e,"has",i),n}ownKeys(e){return ia(e,"iterate",Lt(e)?"length":Wp),Reflect.ownKeys(e)}}class xH extends yH{constructor(e=!1){super(!0,e)}set(e,i){return!0}deleteProperty(e,i){return!0}}const dme=new vH,fme=new xH,pme=new vH(!0),mme=new xH(!0),iD=s=>s,UT=s=>Reflect.getPrototypeOf(s);function zw(s,e,i=!1,n=!1){s=s.__v_raw;const r=un(s),o=un(e);i||(nc(e,o)&&ia(r,"get",e),ia(r,"get",o));const{has:a}=UT(r),l=n?iD:i?sD:a_;if(a.call(r,e))return l(s.get(e));if(a.call(r,o))return l(s.get(o));s!==r&&s.get(e)}function Xw(s,e=!1){const i=this.__v_raw,n=un(i),r=un(s);return e||(nc(s,r)&&ia(n,"has",s),ia(n,"has",r)),s===r?i.has(s):i.has(s)||i.has(r)}function Ww(s,e=!1){return s=s.__v_raw,!e&&ia(un(s),"iterate",Wp),Reflect.get(s,"size",s)}function sF(s){s=un(s);const e=un(this);return UT(e).has.call(e,s)||(e.add(s),nu(e,"add",s,s)),this}function rF(s,e){e=un(e);const i=un(this),{has:n,get:r}=UT(i);let o=n.call(i,s);o||(s=un(s),o=n.call(i,s));const a=r.call(i,s);return i.set(s,e),o?nc(e,a)&&nu(i,"set",s,e):nu(i,"add",s,e),this}function oF(s){const e=un(this),{has:i,get:n}=UT(e);let r=i.call(e,s);r||(s=un(s),r=i.call(e,s)),n&&n.call(e,s);const o=e.delete(s);return r&&nu(e,"delete",s,void 0),o}function aF(){const s=un(this),e=s.size!==0,i=s.clear();return e&&nu(s,"clear",void 0,void 0),i}function Hw(s,e){return function(n,r){const o=this,a=o.__v_raw,l=un(a),h=e?iD:s?sD:a_;return!s&&ia(l,"iterate",Wp),a.forEach((d,f)=>n.call(r,h(d),h(f),o))}}function Gw(s,e,i){return function(...n){const r=this.__v_raw,o=un(r),a=w0(o),l=s==="entries"||s===Symbol.iterator&&a,h=s==="keys"&&a,d=r[s](...n),f=i?iD:e?sD:a_;return!e&&ia(o,"iterate",h?D2:Wp),{next(){const{value:p,done:g}=d.next();return g?{value:p,done:g}:{value:l?[f(p[0]),f(p[1])]:f(p),done:g}},[Symbol.iterator](){return this}}}}function Zu(s){return function(...e){return s==="delete"?!1:s==="clear"?void 0:this}}function gme(){const s={get(o){return zw(this,o)},get size(){return Ww(this)},has:Xw,add:sF,set:rF,delete:oF,clear:aF,forEach:Hw(!1,!1)},e={get(o){return zw(this,o,!1,!0)},get size(){return Ww(this)},has:Xw,add:sF,set:rF,delete:oF,clear:aF,forEach:Hw(!1,!0)},i={get(o){return zw(this,o,!0)},get size(){return Ww(this,!0)},has(o){return Xw.call(this,o,!0)},add:Zu("add"),set:Zu("set"),delete:Zu("delete"),clear:Zu("clear"),forEach:Hw(!0,!1)},n={get(o){return zw(this,o,!0,!0)},get size(){return Ww(this,!0)},has(o){return Xw.call(this,o,!0)},add:Zu("add"),set:Zu("set"),delete:Zu("delete"),clear:Zu("clear"),forEach:Hw(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{s[o]=Gw(o,!1,!1),i[o]=Gw(o,!0,!1),e[o]=Gw(o,!1,!0),n[o]=Gw(o,!0,!0)}),[s,i,e,n]}const[yme,vme,xme,_me]=gme();function FT(s,e){const i=e?s?_me:xme:s?vme:yme;return(n,r,o)=>r==="__v_isReactive"?!s:r==="__v_isReadonly"?s:r==="__v_raw"?n:Reflect.get(dn(i,r)&&r in n?i:n,r,o)}const bme={get:FT(!1,!1)},wme={get:FT(!1,!0)},Ome={get:FT(!0,!1)},Sme={get:FT(!0,!0)},_H=new WeakMap,bH=new WeakMap,wH=new WeakMap,OH=new WeakMap;function Cme(s){switch(s){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Tme(s){return s.__v_skip||!Object.isExtensible(s)?0:Cme(Gpe(s))}function Tm(s){return Z0(s)?s:zT(s,!1,dme,bme,_H)}function SH(s){return zT(s,!1,pme,wme,bH)}function rm(s){return zT(s,!0,fme,Ome,wH)}function Ame(s){return zT(s,!0,mme,Sme,OH)}function zT(s,e,i,n,r){if(!Ln(s)||s.__v_raw&&!(e&&s.__v_isReactive))return s;const o=r.get(s);if(o)return o;const a=Tme(s);if(a===0)return s;const l=new Proxy(s,a===2?n:i);return r.set(s,l),l}function C0(s){return Z0(s)?C0(s.__v_raw):!!(s&&s.__v_isReactive)}function Z0(s){return!!(s&&s.__v_isReadonly)}function o_(s){return!!(s&&s.__v_isShallow)}function nD(s){return s?!!s.__v_raw:!1}function un(s){const e=s&&s.__v_raw;return e?un(e):s}function CH(s){return Object.isExtensible(s)&&rH(s,"__v_skip",!0),s}const a_=s=>Ln(s)?Tm(s):s,sD=s=>Ln(s)?rm(s):s;class TH{constructor(e,i,n,r){this.getter=e,this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new q0(()=>e(this._value),()=>T0(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=n}get value(){const e=un(this);return(!e._cacheable||e.effect.dirty)&&nc(e._value,e._value=e.effect.run())&&T0(e,4),rD(e),e.effect._dirtyLevel>=2&&T0(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function Eme(s,e,i=!1){let n,r;const o=yi(s);return o?(n=s,r=Go):(n=s.get,r=s.set),new TH(n,r,o||!r,i)}function rD(s){var e;Gd&&Xp&&(s=un(s),fH(Xp,(e=s.dep)!=null?e:s.dep=mH(()=>s.dep=void 0,s instanceof TH?s:void 0)))}function T0(s,e=4,i){s=un(s);const n=s.dep;n&&pH(n,e)}function Ys(s){return!!(s&&s.__v_isRef===!0)}function gt(s){return AH(s,!1)}function jr(s){return AH(s,!0)}function AH(s,e){return Ys(s)?s:new Mme(s,e)}class Mme{constructor(e,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?e:un(e),this._value=i?e:a_(e)}get value(){return rD(this),this._value}set value(e){const i=this.__v_isShallow||o_(e)||Z0(e);e=i?e:un(e),nc(e,this._rawValue)&&(this._rawValue=e,this._value=i?e:a_(e),T0(this,4))}}function kme(s){T0(s,4)}function ni(s){return Ys(s)?s.value:s}function Pme(s){return yi(s)?s():ni(s)}const Ime={get:(s,e,i)=>ni(Reflect.get(s,e,i)),set:(s,e,i,n)=>{const r=s[e];return Ys(r)&&!Ys(i)?(r.value=i,!0):Reflect.set(s,e,i,n)}};function oD(s){return C0(s)?s:new Proxy(s,Ime)}class Bme{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:i,set:n}=e(()=>rD(this),()=>T0(this));this._get=i,this._set=n}get value(){return this._get()}set value(e){this._set(e)}}function aD(s){return new Bme(s)}function ub(s){const e=Lt(s)?new Array(s.length):{};for(const i in s)e[i]=EH(s,i);return e}class Rme{constructor(e,i,n){this._object=e,this._key=i,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return lme(un(this._object),this._key)}}class Dme{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Lme(s,e,i){return Ys(s)?s:yi(s)?new Dme(s):Ln(s)&&arguments.length>1?EH(s,e,i):gt(s)}function EH(s,e,i){const n=s[e];return Ys(n)?n:new Rme(s,e,i)}const Nme={GET:"get",HAS:"has",ITERATE:"iterate"},Vme={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"};/**
* @vue/runtime-core v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function $me(s,e){}const Ume={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",WATCH_GETTER:2,2:"WATCH_GETTER",WATCH_CALLBACK:3,3:"WATCH_CALLBACK",WATCH_CLEANUP:4,4:"WATCH_CLEANUP",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER"},Fme={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush. This is likely a Vue internals bug. Please open an issue at https://github.com/vuejs/core ."};function su(s,e,i,n){try{return n?s(...n):s()}catch(r){Am(r,e,i)}}function Ra(s,e,i,n){if(yi(s)){const r=su(s,e,i,n);return r&&qR(r)&&r.catch(o=>{Am(o,e,i)}),r}if(Lt(s)){const r=[];for(let o=0;o<s.length;o++)r.push(Ra(s[o],e,i,n));return r}}function Am(s,e,i,n=!0){const r=e?e.vnode:null;if(e){let o=e.parent;const a=e.proxy,l=`https://vuejs.org/error-reference/#runtime-${i}`;for(;o;){const d=o.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](s,a,l)===!1)return}o=o.parent}const h=e.appContext.config.errorHandler;if(h){pf(),su(h,null,10,[s,a,l]),mf();return}}zme(s,i,r,n)}function zme(s,e,i,n=!0){console.error(s)}let l_=!1,L2=!1;const Qr=[];let zc=0;const A0=[];let Cd=null,Sp=0;const MH=Promise.resolve();let lD=null;function Ty(s){const e=lD||MH;return s?e.then(this?s.bind(this):s):e}function Xme(s){let e=zc+1,i=Qr.length;for(;e<i;){const n=e+i>>>1,r=Qr[n],o=c_(r);o<s||o===s&&r.pre?e=n+1:i=n}return e}function XT(s){(!Qr.length||!Qr.includes(s,l_&&s.allowRecurse?zc+1:zc))&&(s.id==null?Qr.push(s):Qr.splice(Xme(s.id),0,s),kH())}function kH(){!l_&&!L2&&(L2=!0,lD=MH.then(PH))}function Wme(s){const e=Qr.indexOf(s);e>zc&&Qr.splice(e,1)}function dC(s){Lt(s)?A0.push(...s):(!Cd||!Cd.includes(s,s.allowRecurse?Sp+1:Sp))&&A0.push(s),kH()}function lF(s,e,i=l_?zc+1:0){for(;i<Qr.length;i++){const n=Qr[i];if(n&&n.pre){if(s&&n.id!==s.uid)continue;Qr.splice(i,1),i--,n()}}}function fC(s){if(A0.length){const e=[...new Set(A0)].sort((i,n)=>c_(i)-c_(n));if(A0.length=0,Cd){Cd.push(...e);return}for(Cd=e,Sp=0;Sp<Cd.length;Sp++)Cd[Sp]();Cd=null,Sp=0}}const c_=s=>s.id==null?1/0:s.id,Hme=(s,e)=>{const i=c_(s)-c_(e);if(i===0){if(s.pre&&!e.pre)return-1;if(e.pre&&!s.pre)return 1}return i};function PH(s){L2=!1,l_=!0,Qr.sort(Hme);try{for(zc=0;zc<Qr.length;zc++){const e=Qr[zc];e&&e.active!==!1&&su(e,null,14)}}finally{zc=0,Qr.length=0,fC(),l_=!1,lD=null,(Qr.length||A0.length)&&PH()}}let Kg,Qw=[];function IH(s,e){var i,n;Kg=s,Kg?(Kg.enabled=!0,Qw.forEach(({event:r,args:o})=>Kg.emit(r,...o)),Qw=[]):typeof window<"u"&&window.HTMLElement&&!((n=(i=window.navigator)==null?void 0:i.userAgent)!=null&&n.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(o=>{IH(o,e)}),setTimeout(()=>{Kg||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Qw=[])},3e3)):Qw=[]}function Gme(s,e,...i){if(s.isUnmounted)return;const n=s.vnode.props||kn;let r=i;const o=e.startsWith("update:"),a=o&&e.slice(7);if(a&&a in n){const f=`${a==="modelValue"?"model":a}Modifiers`,{number:p,trim:g}=n[f]||kn;g&&(r=i.map(y=>hs(y)?y.trim():y)),p&&(r=i.map(cC))}let l,h=n[l=Nx(e)]||n[l=Nx(wo(e))];!h&&o&&(h=n[l=Nx(Ea(e))]),h&&Ra(h,s,6,r);const d=n[l+"Once"];if(d){if(!s.emitted)s.emitted={};else if(s.emitted[l])return;s.emitted[l]=!0,Ra(d,s,6,r)}}function BH(s,e,i=!1){const n=e.emitsCache,r=n.get(s);if(r!==void 0)return r;const o=s.emits;let a={},l=!1;if(!yi(s)){const h=d=>{const f=BH(d,e,!0);f&&(l=!0,ts(a,f))};!i&&e.mixins.length&&e.mixins.forEach(h),s.extends&&h(s.extends),s.mixins&&s.mixins.forEach(h)}return!o&&!l?(Ln(s)&&n.set(s,null),null):(Lt(o)?o.forEach(h=>a[h]=null):ts(a,o),Ln(s)&&n.set(s,a),a)}function WT(s,e){return!s||!cb(e)?!1:(e=e.slice(2).replace(/Once$/,""),dn(s,e[0].toLowerCase()+e.slice(1))||dn(s,Ea(e))||dn(s,e))}let Gs=null,HT=null;function h_(s){const e=Gs;return Gs=s,HT=s&&s.type.__scopeId||null,e}function GT(s){HT=s}function QT(){HT=null}const Qme=s=>Zt;function Zt(s,e=Gs,i){if(!e||s._n)return s;const n=(...r)=>{n._d&&W2(-1);const o=h_(e);let a;try{a=s(...r)}finally{h_(o),n._d&&W2(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function CS(s){const{type:e,vnode:i,proxy:n,withProxy:r,propsOptions:[o],slots:a,attrs:l,emit:h,render:d,renderCache:f,props:p,data:g,setupState:y,ctx:x,inheritAttrs:_}=s,w=h_(s);let O,T;try{if(i.shapeFlag&4){const A=r||n,B=A;O=Aa(d.call(B,A,f,p,y,g,x)),T=l}else{const A=e;O=Aa(A.length>1?A(p,{attrs:l,slots:a,emit:h}):A(p,null)),T=e.props?l:jme(l)}}catch(A){Ux.length=0,Am(A,s,1),O=vt(Dr)}let C=O;if(T&&_!==!1){const A=Object.keys(T),{shapeFlag:B}=C;A.length&&B&7&&(o&&A.some(YR)&&(T=qme(T,o)),C=ih(C,T,!1,!0))}return i.dirs&&(C=ih(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(i.dirs):i.dirs),i.transition&&(C.transition=i.transition),O=C,h_(w),O}function Yme(s,e=!0){let i;for(let n=0;n<s.length;n++){const r=s[n];if(Jd(r)){if(r.type!==Dr||r.children==="v-if"){if(i)return;i=r}}else return}return i}const jme=s=>{let e;for(const i in s)(i==="class"||i==="style"||cb(i))&&((e||(e={}))[i]=s[i]);return e},qme=(s,e)=>{const i={};for(const n in s)(!YR(n)||!(n.slice(9)in e))&&(i[n]=s[n]);return i};function Zme(s,e,i){const{props:n,children:r,component:o}=s,{props:a,children:l,patchFlag:h}=e,d=o.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&h>=0){if(h&1024)return!0;if(h&16)return n?cF(n,a,d):!!a;if(h&8){const f=e.dynamicProps;for(let p=0;p<f.length;p++){const g=f[p];if(a[g]!==n[g]&&!WT(d,g))return!0}}}else return(r||l)&&(!l||!l.$stable)?!0:n===a?!1:n?a?cF(n,a,d):!0:!!a;return!1}function cF(s,e,i){const n=Object.keys(e);if(n.length!==Object.keys(s).length)return!0;for(let r=0;r<n.length;r++){const o=n[r];if(e[o]!==s[o]&&!WT(i,o))return!0}return!1}function cD({vnode:s,parent:e},i){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===s&&(n.el=s.el),n===s)(s=e.vnode).el=i,e=e.parent;else break}}const hD="components",Kme="directives";function Bn(s,e){return uD(hD,s,!0,e)||s}const RH=Symbol.for("v-ndc");function DH(s){return hs(s)?uD(hD,s,!1)||s:s||RH}function Jme(s){return uD(Kme,s)}function uD(s,e,i=!0,n=!1){const r=Gs||or;if(r){const o=r.type;if(s===hD){const l=j2(o,!1);if(l&&(l===e||l===wo(e)||l===hb(wo(e))))return o}const a=hF(r[s]||o[s],e)||hF(r.appContext[s],e);return!a&&n?o:a}}function hF(s,e){return s&&(s[e]||s[wo(e)]||s[hb(wo(e))])}const LH=s=>s.__isSuspense;let N2=0;const ege={name:"Suspense",__isSuspense:!0,process(s,e,i,n,r,o,a,l,h,d){if(s==null)tge(e,i,n,r,o,a,l,h,d);else{if(o&&o.deps>0&&!s.suspense.isInFallback){e.suspense=s.suspense,e.suspense.vnode=e,e.el=s.el;return}ige(s,e,i,n,r,a,l,h,d)}},hydrate:nge,create:dD,normalize:sge},NH=ege;function u_(s,e){const i=s.props&&s.props[e];yi(i)&&i()}function tge(s,e,i,n,r,o,a,l,h){const{p:d,o:{createElement:f}}=h,p=f("div"),g=s.suspense=dD(s,r,n,e,p,i,o,a,l,h);d(null,g.pendingBranch=s.ssContent,p,null,n,g,o,a),g.deps>0?(u_(s,"onPending"),u_(s,"onFallback"),d(null,s.ssFallback,e,i,n,null,o,a),E0(g,s.ssFallback)):g.resolve(!1,!0)}function ige(s,e,i,n,r,o,a,l,{p:h,um:d,o:{createElement:f}}){const p=e.suspense=s.suspense;p.vnode=e,e.el=s.el;const g=e.ssContent,y=e.ssFallback,{activeBranch:x,pendingBranch:_,isInFallback:w,isHydrating:O}=p;if(_)p.pendingBranch=g,Wl(g,_)?(h(_,g,p.hiddenContainer,null,r,p,o,a,l),p.deps<=0?p.resolve():w&&(O||(h(x,y,i,n,r,null,o,a,l),E0(p,y)))):(p.pendingId=N2++,O?(p.isHydrating=!1,p.activeBranch=_):d(_,r,p),p.deps=0,p.effects.length=0,p.hiddenContainer=f("div"),w?(h(null,g,p.hiddenContainer,null,r,p,o,a,l),p.deps<=0?p.resolve():(h(x,y,i,n,r,null,o,a,l),E0(p,y))):x&&Wl(g,x)?(h(x,g,i,n,r,p,o,a,l),p.resolve(!0)):(h(null,g,p.hiddenContainer,null,r,p,o,a,l),p.deps<=0&&p.resolve()));else if(x&&Wl(g,x))h(x,g,i,n,r,p,o,a,l),E0(p,g);else if(u_(e,"onPending"),p.pendingBranch=g,g.shapeFlag&512?p.pendingId=g.component.suspenseId:p.pendingId=N2++,h(null,g,p.hiddenContainer,null,r,p,o,a,l),p.deps<=0)p.resolve();else{const{timeout:T,pendingId:C}=p;T>0?setTimeout(()=>{p.pendingId===C&&p.fallback(y)},T):T===0&&p.fallback(y)}}function dD(s,e,i,n,r,o,a,l,h,d,f=!1){const{p,m:g,um:y,n:x,o:{parentNode:_,remove:w}}=d;let O;const T=rge(s);T&&e&&e.pendingBranch&&(O=e.pendingId,e.deps++);const C=s.props?hC(s.props.timeout):void 0,A=o,B={vnode:s,parent:e,parentComponent:i,namespace:a,container:n,hiddenContainer:r,deps:0,pendingId:N2++,timeout:typeof C=="number"?C:-1,activeBranch:null,pendingBranch:null,isInFallback:!f,isHydrating:f,isUnmounted:!1,effects:[],resolve(I=!1,R=!1){const{vnode:P,activeBranch:k,pendingBranch:E,pendingId:D,effects:L,parentComponent:V,container:F}=B;let j=!1;B.isHydrating?B.isHydrating=!1:I||(j=k&&E.transition&&E.transition.mode==="out-in",j&&(k.transition.afterLeave=()=>{D===B.pendingId&&(g(E,F,o===A?x(k):o,0),dC(L))}),k&&(_(k.el)!==B.hiddenContainer&&(o=x(k)),y(k,V,B,!0)),j||g(E,F,o,0)),E0(B,E),B.pendingBranch=null,B.isInFallback=!1;let Q=B.parent,ee=!1;for(;Q;){if(Q.pendingBranch){Q.effects.push(...L),ee=!0;break}Q=Q.parent}!ee&&!j&&dC(L),B.effects=[],T&&e&&e.pendingBranch&&O===e.pendingId&&(e.deps--,e.deps===0&&!R&&e.resolve()),u_(P,"onResolve")},fallback(I){if(!B.pendingBranch)return;const{vnode:R,activeBranch:P,parentComponent:k,container:E,namespace:D}=B;u_(R,"onFallback");const L=x(P),V=()=>{B.isInFallback&&(p(null,I,E,L,k,null,D,l,h),E0(B,I))},F=I.transition&&I.transition.mode==="out-in";F&&(P.transition.afterLeave=V),B.isInFallback=!0,y(P,k,null,!0),F||V()},move(I,R,P){B.activeBranch&&g(B.activeBranch,I,R,P),B.container=I},next(){return B.activeBranch&&x(B.activeBranch)},registerDep(I,R){const P=!!B.pendingBranch;P&&B.deps++;const k=I.vnode.el;I.asyncDep.catch(E=>{Am(E,I,0)}).then(E=>{if(I.isUnmounted||B.isUnmounted||B.pendingId!==I.suspenseId)return;I.asyncResolved=!0;const{vnode:D}=I;Q2(I,E,!1),k&&(D.el=k);const L=!k&&I.subTree.el;R(I,D,_(k||I.subTree.el),k?null:x(I.subTree),B,a,h),L&&w(L),cD(I,D.el),P&&--B.deps===0&&B.resolve()})},unmount(I,R){B.isUnmounted=!0,B.activeBranch&&y(B.activeBranch,i,I,R),B.pendingBranch&&y(B.pendingBranch,i,I,R)}};return B}function nge(s,e,i,n,r,o,a,l,h){const d=e.suspense=dD(e,n,i,s.parentNode,document.createElement("div"),null,r,o,a,l,!0),f=h(s,d.pendingBranch=e.ssContent,i,d,o,a);return d.deps===0&&d.resolve(!1,!0),f}function sge(s){const{shapeFlag:e,children:i}=s,n=e&32;s.ssContent=uF(n?i.default:i),s.ssFallback=n?uF(i.fallback):vt(Dr)}function uF(s){let e;if(yi(s)){const i=lm&&s._c;i&&(s._d=!1,di()),s=s(),i&&(s._d=!0,e=Qo,_G())}return Lt(s)&&(s=Yme(s)),s=Aa(s),e&&!s.dynamicChildren&&(s.dynamicChildren=e.filter(i=>i!==s)),s}function VH(s,e){e&&e.pendingBranch?Lt(s)?e.effects.push(...s):e.effects.push(s):dC(s)}function E0(s,e){s.activeBranch=e;const{vnode:i,parentComponent:n}=s;let r=e.el;for(;!r&&e.component;)e=e.component.subTree,r=e.el;i.el=r,n&&n.subTree===i&&(n.vnode.el=r,cD(n,r))}function rge(s){const e=s.props&&s.props.suspensible;return e!=null&&e!==!1}const $H=Symbol.for("v-scx"),UH=()=>k0($H);function ru(s,e){return db(s,null,e)}function FH(s,e){return db(s,null,{flush:"post"})}function zH(s,e){return db(s,null,{flush:"sync"})}const Yw={};function an(s,e,i){return db(s,e,i)}function db(s,e,{immediate:i,deep:n,flush:r,once:o,onTrack:a,onTrigger:l}=kn){if(e&&o){const I=e;e=(...R)=>{I(...R),B()}}const h=or,d=I=>n===!0?I:Ip(I,n===!1?1:void 0);let f,p=!1,g=!1;if(Ys(s)?(f=()=>s.value,p=o_(s)):C0(s)?(f=()=>d(s),p=!0):Lt(s)?(g=!0,p=s.some(I=>C0(I)||o_(I)),f=()=>s.map(I=>{if(Ys(I))return I.value;if(C0(I))return d(I);if(yi(I))return su(I,h,2)})):yi(s)?e?f=()=>su(s,h,2):f=()=>(y&&y(),Ra(s,h,3,[x])):f=Go,e&&n){const I=f;f=()=>Ip(I())}let y,x=I=>{y=C.onStop=()=>{su(I,h,4),y=C.onStop=void 0}},_;if(pb)if(x=Go,e?i&&Ra(e,h,3,[f(),g?[]:void 0,x]):f(),r==="sync"){const I=UH();_=I.__watcherHandles||(I.__watcherHandles=[])}else return Go;let w=g?new Array(s.length).fill(Yw):Yw;const O=()=>{if(!(!C.active||!C.dirty))if(e){const I=C.run();(n||p||(g?I.some((R,P)=>nc(R,w[P])):nc(I,w)))&&(y&&y(),Ra(e,h,3,[I,w===Yw?void 0:g&&w[0]===Yw?[]:w,x]),w=I)}else C.run()};O.allowRecurse=!!e;let T;r==="sync"?T=O:r==="post"?T=()=>Er(O,h&&h.suspense):(O.pre=!0,h&&(O.id=h.uid),T=()=>XT(O));const C=new q0(f,Go,T),A=$T(),B=()=>{C.stop(),A&&jR(A.effects,C)};return e?i?O():w=C.run():r==="post"?Er(C.run.bind(C),h&&h.suspense):C.run(),_&&_.push(B),B}function oge(s,e,i){const n=this.proxy,r=hs(s)?s.includes(".")?XH(n,s):()=>n[s]:s.bind(n,n);let o;yi(e)?o=e:(o=e.handler,i=e);const a=hm(this),l=db(r,o.bind(n),i);return a(),l}function XH(s,e){const i=e.split(".");return()=>{let n=s;for(let r=0;r<i.length&&n;r++)n=n[i[r]];return n}}function Ip(s,e=1/0,i){if(e<=0||!Ln(s)||s.__v_skip||(i=i||new Set,i.has(s)))return s;if(i.add(s),e--,Ys(s))Ip(s.value,e,i);else if(Lt(s))for(let n=0;n<s.length;n++)Ip(s[n],e,i);else if(Cm(s)||w0(s))s.forEach(n=>{Ip(n,e,i)});else if(sH(s))for(const n in s)Ip(s[n],e,i);return s}function age(s,e){if(Gs===null)return s;const i=KT(Gs)||Gs.proxy,n=s.dirs||(s.dirs=[]);for(let r=0;r<e.length;r++){let[o,a,l,h=kn]=e[r];o&&(yi(o)&&(o={mounted:o,updated:o}),o.deep&&Ip(a),n.push({dir:o,instance:i,value:a,oldValue:void 0,arg:l,modifiers:h}))}return s}function Vc(s,e,i,n){const r=s.dirs,o=e&&e.dirs;for(let a=0;a<r.length;a++){const l=r[a];o&&(l.oldValue=o[a].value);let h=l.dir[n];h&&(pf(),Ra(h,i,8,[s.el,l,s,e]),mf())}}const Td=Symbol("_leaveCb"),jw=Symbol("_enterCb");function fD(){const s={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return io(()=>{s.isMounted=!0}),ZT(()=>{s.isUnmounting=!0}),s}const Qa=[Function,Array],pD={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Qa,onEnter:Qa,onAfterEnter:Qa,onEnterCancelled:Qa,onBeforeLeave:Qa,onLeave:Qa,onAfterLeave:Qa,onLeaveCancelled:Qa,onBeforeAppear:Qa,onAppear:Qa,onAfterAppear:Qa,onAppearCancelled:Qa},lge={name:"BaseTransition",props:pD,setup(s,{slots:e}){const i=Na(),n=fD();return()=>{const r=e.default&&YT(e.default(),!0);if(!r||!r.length)return;let o=r[0];if(r.length>1){for(const g of r)if(g.type!==Dr){o=g;break}}const a=un(s),{mode:l}=a;if(n.isLeaving)return kM(o);const h=dF(o);if(!h)return kM(o);const d=K0(h,a,n,i);om(h,d);const f=i.subTree,p=f&&dF(f);if(p&&p.type!==Dr&&!Wl(h,p)){const g=K0(p,a,n,i);if(om(p,g),l==="out-in"&&h.type!==Dr)return n.isLeaving=!0,g.afterLeave=()=>{n.isLeaving=!1,i.update.active!==!1&&(i.effect.dirty=!0,i.update())},kM(o);l==="in-out"&&h.type!==Dr&&(g.delayLeave=(y,x,_)=>{const w=HH(n,p);w[String(p.key)]=p,y[Td]=()=>{x(),y[Td]=void 0,delete d.delayedLeave},d.delayedLeave=_})}return o}}},WH=lge;function HH(s,e){const{leavingVNodes:i}=s;let n=i.get(e.type);return n||(n=Object.create(null),i.set(e.type,n)),n}function K0(s,e,i,n){const{appear:r,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:h,onAfterEnter:d,onEnterCancelled:f,onBeforeLeave:p,onLeave:g,onAfterLeave:y,onLeaveCancelled:x,onBeforeAppear:_,onAppear:w,onAfterAppear:O,onAppearCancelled:T}=e,C=String(s.key),A=HH(i,s),B=(P,k)=>{P&&Ra(P,n,9,k)},I=(P,k)=>{const E=k[1];B(P,k),Lt(P)?P.every(D=>D.length<=1)&&E():P.length<=1&&E()},R={mode:o,persisted:a,beforeEnter(P){let k=l;if(!i.isMounted)if(r)k=_||l;else return;P[Td]&&P[Td](!0);const E=A[C];E&&Wl(s,E)&&E.el[Td]&&E.el[Td](),B(k,[P])},enter(P){let k=h,E=d,D=f;if(!i.isMounted)if(r)k=w||h,E=O||d,D=T||f;else return;let L=!1;const V=P[jw]=F=>{L||(L=!0,F?B(D,[P]):B(E,[P]),R.delayedLeave&&R.delayedLeave(),P[jw]=void 0)};k?I(k,[P,V]):V()},leave(P,k){const E=String(s.key);if(P[jw]&&P[jw](!0),i.isUnmounting)return k();B(p,[P]);let D=!1;const L=P[Td]=V=>{D||(D=!0,k(),V?B(x,[P]):B(y,[P]),P[Td]=void 0,A[E]===s&&delete A[E])};A[E]=s,g?I(g,[P,L]):L()},clone(P){return K0(P,e,i,n)}};return R}function kM(s){if(fb(s))return s=ih(s),s.children=null,s}function dF(s){if(!fb(s))return s;const{shapeFlag:e,children:i}=s;if(i){if(e&16)return i[0];if(e&32&&yi(i.default))return i.default()}}function om(s,e){s.shapeFlag&6&&s.component?om(s.component.subTree,e):s.shapeFlag&128?(s.ssContent.transition=e.clone(s.ssContent),s.ssFallback.transition=e.clone(s.ssFallback)):s.transition=e}function YT(s,e=!1,i){let n=[],r=0;for(let o=0;o<s.length;o++){let a=s[o];const l=i==null?a.key:String(i)+String(a.key!=null?a.key:o);a.type===Un?(a.patchFlag&128&&r++,n=n.concat(YT(a.children,e,l))):(e||a.type!==Dr)&&n.push(l!=null?ih(a,{key:l}):a)}if(r>1)for(let o=0;o<n.length;o++)n[o].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function fu(s,e){return yi(s)?ts({name:s.name},e,{setup:s}):s}const Hp=s=>!!s.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function cge(s){yi(s)&&(s={loader:s});const{loader:e,loadingComponent:i,errorComponent:n,delay:r=200,timeout:o,suspensible:a=!0,onError:l}=s;let h=null,d,f=0;const p=()=>(f++,h=null,g()),g=()=>{let y;return h||(y=h=e().catch(x=>{if(x=x instanceof Error?x:new Error(String(x)),l)return new Promise((_,w)=>{l(x,()=>_(p()),()=>w(x),f+1)});throw x}).then(x=>y!==h&&h?h:(x&&(x.__esModule||x[Symbol.toStringTag]==="Module")&&(x=x.default),d=x,x)))};return fu({name:"AsyncComponentWrapper",__asyncLoader:g,get __asyncResolved(){return d},setup(){const y=or;if(d)return()=>PM(d,y);const x=T=>{h=null,Am(T,y,13,!n)};if(a&&y.suspense||pb)return g().then(T=>()=>PM(T,y)).catch(T=>(x(T),()=>n?vt(n,{error:T}):null));const _=gt(!1),w=gt(),O=gt(!!r);return r&&setTimeout(()=>{O.value=!1},r),o!=null&&setTimeout(()=>{if(!_.value&&!w.value){const T=new Error(`Async component timed out after ${o}ms.`);x(T),w.value=T}},o),g().then(()=>{_.value=!0,y.parent&&fb(y.parent.vnode)&&(y.parent.effect.dirty=!0,XT(y.parent.update))}).catch(T=>{x(T),w.value=T}),()=>{if(_.value&&d)return PM(d,y);if(w.value&&n)return vt(n,{error:w.value});if(i&&!O.value)return vt(i)}}})}function PM(s,e){const{ref:i,props:n,children:r,ce:o}=e.vnode,a=vt(s,n,r);return a.ref=i,a.ce=o,delete e.vnode.ce,a}const fb=s=>s.type.__isKeepAlive,hge={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(s,{slots:e}){const i=Na(),n=i.ctx;if(!n.renderer)return()=>{const T=e.default&&e.default();return T&&T.length===1?T[0]:T};const r=new Map,o=new Set;let a=null;const l=i.suspense,{renderer:{p:h,m:d,um:f,o:{createElement:p}}}=n,g=p("div");n.activate=(T,C,A,B,I)=>{const R=T.component;d(T,C,A,0,l),h(R.vnode,T,C,A,R,l,B,T.slotScopeIds,I),Er(()=>{R.isDeactivated=!1,R.a&&S0(R.a);const P=T.props&&T.props.onVnodeMounted;P&&Fo(P,R.parent,T)},l)},n.deactivate=T=>{const C=T.component;d(T,g,null,1,l),Er(()=>{C.da&&S0(C.da);const A=T.props&&T.props.onVnodeUnmounted;A&&Fo(A,C.parent,T),C.isDeactivated=!0},l)};function y(T){IM(T),f(T,i,l,!0)}function x(T){r.forEach((C,A)=>{const B=j2(C.type);B&&(!T||!T(B))&&_(A)})}function _(T){const C=r.get(T);!a||!Wl(C,a)?y(C):a&&IM(a),r.delete(T),o.delete(T)}an(()=>[s.include,s.exclude],([T,C])=>{T&&x(A=>xx(T,A)),C&&x(A=>!xx(C,A))},{flush:"post",deep:!0});let w=null;const O=()=>{w!=null&&r.set(w,BM(i.subTree))};return io(O),qT(O),ZT(()=>{r.forEach(T=>{const{subTree:C,suspense:A}=i,B=BM(C);if(T.type===B.type&&T.key===B.key){IM(B);const I=B.component.da;I&&Er(I,A);return}y(T)})}),()=>{if(w=null,!e.default)return null;const T=e.default(),C=T[0];if(T.length>1)return a=null,T;if(!Jd(C)||!(C.shapeFlag&4)&&!(C.shapeFlag&128))return a=null,C;let A=BM(C);const B=A.type,I=j2(Hp(A)?A.type.__asyncResolved||{}:B),{include:R,exclude:P,max:k}=s;if(R&&(!I||!xx(R,I))||P&&I&&xx(P,I))return a=A,C;const E=A.key==null?B:A.key,D=r.get(E);return A.el&&(A=ih(A),C.shapeFlag&128&&(C.ssContent=A)),w=E,D?(A.el=D.el,A.component=D.component,A.transition&&om(A,A.transition),A.shapeFlag|=512,o.delete(E),o.add(E)):(o.add(E),k&&o.size>parseInt(k,10)&&_(o.values().next().value)),A.shapeFlag|=256,a=A,LH(C.type)?C:A}}},uge=hge;function xx(s,e){return Lt(s)?s.some(i=>xx(i,e)):hs(s)?s.split(",").includes(e):Hpe(s)?s.test(e):!1}function GH(s,e){YH(s,"a",e)}function QH(s,e){YH(s,"da",e)}function YH(s,e,i=or){const n=s.__wdc||(s.__wdc=()=>{let r=i;for(;r;){if(r.isDeactivated)return;r=r.parent}return s()});if(jT(e,n,i),i){let r=i.parent;for(;r&&r.parent;)fb(r.parent.vnode)&&dge(n,e,i,r),r=r.parent}}function dge(s,e,i,n){const r=jT(e,s,n,!0);ra(()=>{jR(n[e],r)},i)}function IM(s){s.shapeFlag&=-257,s.shapeFlag&=-513}function BM(s){return s.shapeFlag&128?s.ssContent:s}function jT(s,e,i=or,n=!1){if(i){const r=i[s]||(i[s]=[]),o=e.__weh||(e.__weh=(...a)=>{if(i.isUnmounted)return;pf();const l=hm(i),h=Ra(e,i,s,a);return l(),mf(),h});return n?r.unshift(o):r.push(o),o}}const Eu=s=>(e,i=or)=>(!pb||s==="sp")&&jT(s,(...n)=>e(...n),i),jH=Eu("bm"),io=Eu("m"),qH=Eu("bu"),qT=Eu("u"),ZT=Eu("bum"),ra=Eu("um"),ZH=Eu("sp"),KH=Eu("rtg"),JH=Eu("rtc");function eG(s,e=or){jT("ec",s,e)}function th(s,e,i,n){let r;const o=i&&i[n];if(Lt(s)||hs(s)){r=new Array(s.length);for(let a=0,l=s.length;a<l;a++)r[a]=e(s[a],a,void 0,o&&o[a])}else if(typeof s=="number"){r=new Array(s);for(let a=0;a<s;a++)r[a]=e(a+1,a,void 0,o&&o[a])}else if(Ln(s))if(s[Symbol.iterator])r=Array.from(s,(a,l)=>e(a,l,void 0,o&&o[l]));else{const a=Object.keys(s);r=new Array(a.length);for(let l=0,h=a.length;l<h;l++){const d=a[l];r[l]=e(s[d],d,l,o&&o[l])}}else r=[];return i&&(i[n]=r),r}function fge(s,e){for(let i=0;i<e.length;i++){const n=e[i];if(Lt(n))for(let r=0;r<n.length;r++)s[n[r].name]=n[r].fn;else n&&(s[n.name]=n.key?(...r)=>{const o=n.fn(...r);return o&&(o.key=n.key),o}:n.fn)}return s}function tG(s,e,i={},n,r){if(Gs.isCE||Gs.parent&&Hp(Gs.parent)&&Gs.parent.isCE)return e!=="default"&&(i.name=e),vt("slot",i,n&&n());let o=s[e];o&&o._c&&(o._d=!1),di();const a=o&&iG(o(i)),l=Ir(Un,{key:i.key||a&&a.key||`_${e}`},a||(n?n():[]),a&&s._===1?64:-2);return!r&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),o&&o._c&&(o._d=!0),l}function iG(s){return s.some(e=>Jd(e)?!(e.type===Dr||e.type===Un&&!iG(e.children)):!0)?s:null}function pge(s,e){const i={};for(const n in s)i[e&&/[A-Z]/.test(n)?`on:${n}`:Nx(n)]=s[n];return i}const V2=s=>s?CG(s)?KT(s)||s.proxy:V2(s.parent):null,Vx=ts(Object.create(null),{$:s=>s,$el:s=>s.vnode.el,$data:s=>s.data,$props:s=>s.props,$attrs:s=>s.attrs,$slots:s=>s.slots,$refs:s=>s.refs,$parent:s=>V2(s.parent),$root:s=>V2(s.root),$emit:s=>s.emit,$options:s=>gD(s),$forceUpdate:s=>s.f||(s.f=()=>{s.effect.dirty=!0,XT(s.update)}),$nextTick:s=>s.n||(s.n=Ty.bind(s.proxy)),$watch:s=>oge.bind(s)}),RM=(s,e)=>s!==kn&&!s.__isScriptSetup&&dn(s,e),$2={get({_:s},e){if(e==="__v_skip")return!0;const{ctx:i,setupState:n,data:r,props:o,accessCache:a,type:l,appContext:h}=s;let d;if(e[0]!=="$"){const y=a[e];if(y!==void 0)switch(y){case 1:return n[e];case 2:return r[e];case 4:return i[e];case 3:return o[e]}else{if(RM(n,e))return a[e]=1,n[e];if(r!==kn&&dn(r,e))return a[e]=2,r[e];if((d=s.propsOptions[0])&&dn(d,e))return a[e]=3,o[e];if(i!==kn&&dn(i,e))return a[e]=4,i[e];U2&&(a[e]=0)}}const f=Vx[e];let p,g;if(f)return e==="$attrs"&&ia(s.attrs,"get",""),f(s);if((p=l.__cssModules)&&(p=p[e]))return p;if(i!==kn&&dn(i,e))return a[e]=4,i[e];if(g=h.config.globalProperties,dn(g,e))return g[e]},set({_:s},e,i){const{data:n,setupState:r,ctx:o}=s;return RM(r,e)?(r[e]=i,!0):n!==kn&&dn(n,e)?(n[e]=i,!0):dn(s.props,e)||e[0]==="$"&&e.slice(1)in s?!1:(o[e]=i,!0)},has({_:{data:s,setupState:e,accessCache:i,ctx:n,appContext:r,propsOptions:o}},a){let l;return!!i[a]||s!==kn&&dn(s,a)||RM(e,a)||(l=o[0])&&dn(l,a)||dn(n,a)||dn(Vx,a)||dn(r.config.globalProperties,a)},defineProperty(s,e,i){return i.get!=null?s._.accessCache[e]=0:dn(i,"value")&&this.set(s,e,i.value,null),Reflect.defineProperty(s,e,i)}},mge=ts({},$2,{get(s,e){if(e!==Symbol.unscopables)return $2.get(s,e,s)},has(s,e){return e[0]!=="_"&&!qpe(e)}});function gge(){return null}function yge(){return null}function vge(s){}function xge(s){}function _ge(){return null}function bge(){}function wge(s,e){return null}function mD(){return sG().slots}function nG(){return sG().attrs}function sG(){const s=Na();return s.setupContext||(s.setupContext=EG(s))}function d_(s){return Lt(s)?s.reduce((e,i)=>(e[i]=null,e),{}):s}function Oge(s,e){const i=d_(s);for(const n in e){if(n.startsWith("__skip"))continue;let r=i[n];r?Lt(r)||yi(r)?r=i[n]={type:r,default:e[n]}:r.default=e[n]:r===null&&(r=i[n]={default:e[n]}),r&&e[`__skip_${n}`]&&(r.skipFactory=!0)}return i}function Sge(s,e){return!s||!e?s||e:Lt(s)&&Lt(e)?s.concat(e):ts({},d_(s),d_(e))}function Cge(s,e){const i={};for(const n in s)e.includes(n)||Object.defineProperty(i,n,{enumerable:!0,get:()=>s[n]});return i}function TS(s){const e=Na();let i=s();return G2(),qR(i)&&(i=i.catch(n=>{throw hm(e),n})),[i,()=>hm(e)]}let U2=!0;function Tge(s){const e=gD(s),i=s.proxy,n=s.ctx;U2=!1,e.beforeCreate&&fF(e.beforeCreate,s,"bc");const{data:r,computed:o,methods:a,watch:l,provide:h,inject:d,created:f,beforeMount:p,mounted:g,beforeUpdate:y,updated:x,activated:_,deactivated:w,beforeDestroy:O,beforeUnmount:T,destroyed:C,unmounted:A,render:B,renderTracked:I,renderTriggered:R,errorCaptured:P,serverPrefetch:k,expose:E,inheritAttrs:D,components:L,directives:V,filters:F}=e;if(d&&Age(d,n,null),a)for(const ee in a){const J=a[ee];yi(J)&&(n[ee]=J.bind(i))}if(r){const ee=r.call(i,i);Ln(ee)&&(s.data=Tm(ee))}if(U2=!0,o)for(const ee in o){const J=o[ee],ue=yi(J)?J.bind(i,i):yi(J.get)?J.get.bind(i,i):Go,oe=!yi(J)&&yi(J.set)?J.set.bind(i):Go,pe=Es({get:ue,set:oe});Object.defineProperty(n,ee,{enumerable:!0,configurable:!0,get:()=>pe.value,set:Ue=>pe.value=Ue})}if(l)for(const ee in l)rG(l[ee],n,i,ee);if(h){const ee=yi(h)?h.call(i):h;Reflect.ownKeys(ee).forEach(J=>{f_(J,ee[J])})}f&&fF(f,s,"c");function Q(ee,J){Lt(J)?J.forEach(ue=>ee(ue.bind(i))):J&&ee(J.bind(i))}if(Q(jH,p),Q(io,g),Q(qH,y),Q(qT,x),Q(GH,_),Q(QH,w),Q(eG,P),Q(JH,I),Q(KH,R),Q(ZT,T),Q(ra,A),Q(ZH,k),Lt(E))if(E.length){const ee=s.exposed||(s.exposed={});E.forEach(J=>{Object.defineProperty(ee,J,{get:()=>i[J],set:ue=>i[J]=ue})})}else s.exposed||(s.exposed={});B&&s.render===Go&&(s.render=B),D!=null&&(s.inheritAttrs=D),L&&(s.components=L),V&&(s.directives=V)}function Age(s,e,i=Go){Lt(s)&&(s=F2(s));for(const n in s){const r=s[n];let o;Ln(r)?"default"in r?o=k0(r.from||n,r.default,!0):o=k0(r.from||n):o=k0(r),Ys(o)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[n]=o}}function fF(s,e,i){Ra(Lt(s)?s.map(n=>n.bind(e.proxy)):s.bind(e.proxy),e,i)}function rG(s,e,i,n){const r=n.includes(".")?XH(i,n):()=>i[n];if(hs(s)){const o=e[s];yi(o)&&an(r,o)}else if(yi(s))an(r,s.bind(i));else if(Ln(s))if(Lt(s))s.forEach(o=>rG(o,e,i,n));else{const o=yi(s.handler)?s.handler.bind(i):e[s.handler];yi(o)&&an(r,o,s)}}function gD(s){const e=s.type,{mixins:i,extends:n}=e,{mixins:r,optionsCache:o,config:{optionMergeStrategies:a}}=s.appContext,l=o.get(e);let h;return l?h=l:!r.length&&!i&&!n?h=e:(h={},r.length&&r.forEach(d=>pC(h,d,a,!0)),pC(h,e,a)),Ln(e)&&o.set(e,h),h}function pC(s,e,i,n=!1){const{mixins:r,extends:o}=e;o&&pC(s,o,i,!0),r&&r.forEach(a=>pC(s,a,i,!0));for(const a in e)if(!(n&&a==="expose")){const l=Ege[a]||i&&i[a];s[a]=l?l(s[a],e[a]):e[a]}return s}const Ege={data:pF,props:mF,emits:mF,methods:_x,computed:_x,beforeCreate:yo,created:yo,beforeMount:yo,mounted:yo,beforeUpdate:yo,updated:yo,beforeDestroy:yo,beforeUnmount:yo,destroyed:yo,unmounted:yo,activated:yo,deactivated:yo,errorCaptured:yo,serverPrefetch:yo,components:_x,directives:_x,watch:kge,provide:pF,inject:Mge};function pF(s,e){return e?s?function(){return ts(yi(s)?s.call(this,this):s,yi(e)?e.call(this,this):e)}:e:s}function Mge(s,e){return _x(F2(s),F2(e))}function F2(s){if(Lt(s)){const e={};for(let i=0;i<s.length;i++)e[s[i]]=s[i];return e}return s}function yo(s,e){return s?[...new Set([].concat(s,e))]:e}function _x(s,e){return s?ts(Object.create(null),s,e):e}function mF(s,e){return s?Lt(s)&&Lt(e)?[...new Set([...s,...e])]:ts(Object.create(null),d_(s),d_(e??{})):e}function kge(s,e){if(!s)return e;if(!e)return s;const i=ts(Object.create(null),s);for(const n in e)i[n]=yo(s[n],e[n]);return i}function oG(){return{app:null,config:{isNativeTag:Xpe,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Pge=0;function Ige(s,e){return function(n,r=null){yi(n)||(n=ts({},n)),r!=null&&!Ln(r)&&(r=null);const o=oG(),a=new WeakSet;let l=!1;const h=o.app={_uid:Pge++,_component:n,_props:r,_container:null,_context:o,_instance:null,version:kG,get config(){return o.config},set config(d){},use(d,...f){return a.has(d)||(d&&yi(d.install)?(a.add(d),d.install(h,...f)):yi(d)&&(a.add(d),d(h,...f))),h},mixin(d){return o.mixins.includes(d)||o.mixins.push(d),h},component(d,f){return f?(o.components[d]=f,h):o.components[d]},directive(d,f){return f?(o.directives[d]=f,h):o.directives[d]},mount(d,f,p){if(!l){const g=vt(n,r);return g.appContext=o,p===!0?p="svg":p===!1&&(p=void 0),f&&e?e(g,d):s(g,d,p),l=!0,h._container=d,d.__vue_app__=h,KT(g.component)||g.component.proxy}},unmount(){l&&(s(null,h._container),delete h._container.__vue_app__)},provide(d,f){return o.provides[d]=f,h},runWithContext(d){const f=M0;M0=h;try{return d()}finally{M0=f}}};return h}}let M0=null;function f_(s,e){if(or){let i=or.provides;const n=or.parent&&or.parent.provides;n===i&&(i=or.provides=Object.create(n)),i[s]=e}}function k0(s,e,i=!1){const n=or||Gs;if(n||M0){const r=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:M0._context.provides;if(r&&s in r)return r[s];if(arguments.length>1)return i&&yi(e)?e.call(n&&n.proxy):e}}function Bge(){return!!(or||Gs||M0)}const aG={},lG=()=>Object.create(aG),cG=s=>Object.getPrototypeOf(s)===aG;function Rge(s,e,i,n=!1){const r={},o=lG();s.propsDefaults=Object.create(null),hG(s,e,r,o);for(const a in s.propsOptions[0])a in r||(r[a]=void 0);i?s.props=n?r:SH(r):s.type.props?s.props=r:s.props=o,s.attrs=o}function Dge(s,e,i,n){const{props:r,attrs:o,vnode:{patchFlag:a}}=s,l=un(r),[h]=s.propsOptions;let d=!1;if((n||a>0)&&!(a&16)){if(a&8){const f=s.vnode.dynamicProps;for(let p=0;p<f.length;p++){let g=f[p];if(WT(s.emitsOptions,g))continue;const y=e[g];if(h)if(dn(o,g))y!==o[g]&&(o[g]=y,d=!0);else{const x=wo(g);r[x]=z2(h,l,x,y,s,!1)}else y!==o[g]&&(o[g]=y,d=!0)}}}else{hG(s,e,r,o)&&(d=!0);let f;for(const p in l)(!e||!dn(e,p)&&((f=Ea(p))===p||!dn(e,f)))&&(h?i&&(i[p]!==void 0||i[f]!==void 0)&&(r[p]=z2(h,l,p,void 0,s,!0)):delete r[p]);if(o!==l)for(const p in o)(!e||!dn(e,p))&&(delete o[p],d=!0)}d&&nu(s.attrs,"set","")}function hG(s,e,i,n){const[r,o]=s.propsOptions;let a=!1,l;if(e)for(let h in e){if(O0(h))continue;const d=e[h];let f;r&&dn(r,f=wo(h))?!o||!o.includes(f)?i[f]=d:(l||(l={}))[f]=d:WT(s.emitsOptions,h)||(!(h in n)||d!==n[h])&&(n[h]=d,a=!0)}if(o){const h=un(i),d=l||kn;for(let f=0;f<o.length;f++){const p=o[f];i[p]=z2(r,h,p,d[p],s,!dn(d,p))}}return a}function z2(s,e,i,n,r,o){const a=s[i];if(a!=null){const l=dn(a,"default");if(l&&n===void 0){const h=a.default;if(a.type!==Function&&!a.skipFactory&&yi(h)){const{propsDefaults:d}=r;if(i in d)n=d[i];else{const f=hm(r);n=d[i]=h.call(null,e),f()}}else n=h}a[0]&&(o&&!l?n=!1:a[1]&&(n===""||n===Ea(i))&&(n=!0))}return n}function uG(s,e,i=!1){const n=e.propsCache,r=n.get(s);if(r)return r;const o=s.props,a={},l=[];let h=!1;if(!yi(s)){const f=p=>{h=!0;const[g,y]=uG(p,e,!0);ts(a,g),y&&l.push(...y)};!i&&e.mixins.length&&e.mixins.forEach(f),s.extends&&f(s.extends),s.mixins&&s.mixins.forEach(f)}if(!o&&!h)return Ln(s)&&n.set(s,b0),b0;if(Lt(o))for(let f=0;f<o.length;f++){const p=wo(o[f]);gF(p)&&(a[p]=kn)}else if(o)for(const f in o){const p=wo(f);if(gF(p)){const g=o[f],y=a[p]=Lt(g)||yi(g)?{type:g}:ts({},g);if(y){const x=xF(Boolean,y.type),_=xF(String,y.type);y[0]=x>-1,y[1]=_<0||x<_,(x>-1||dn(y,"default"))&&l.push(p)}}}const d=[a,l];return Ln(s)&&n.set(s,d),d}function gF(s){return s[0]!=="$"&&!O0(s)}function yF(s){return s===null?"null":typeof s=="function"?s.name||"":typeof s=="object"&&s.constructor&&s.constructor.name||""}function vF(s,e){return yF(s)===yF(e)}function xF(s,e){return Lt(e)?e.findIndex(i=>vF(i,s)):yi(e)&&vF(e,s)?0:-1}const dG=s=>s[0]==="_"||s==="$stable",yD=s=>Lt(s)?s.map(Aa):[Aa(s)],Lge=(s,e,i)=>{if(e._n)return e;const n=Zt((...r)=>yD(e(...r)),i);return n._c=!1,n},fG=(s,e,i)=>{const n=s._ctx;for(const r in s){if(dG(r))continue;const o=s[r];if(yi(o))e[r]=Lge(r,o,n);else if(o!=null){const a=yD(o);e[r]=()=>a}}},pG=(s,e)=>{const i=yD(e);s.slots.default=()=>i},Nge=(s,e)=>{const i=s.slots=lG();if(s.vnode.shapeFlag&32){const n=e._;n?(ts(i,e),rH(i,"_",n,!0)):fG(e,i)}else e&&pG(s,e)},Vge=(s,e,i)=>{const{vnode:n,slots:r}=s;let o=!0,a=kn;if(n.shapeFlag&32){const l=e._;l?i&&l===1?o=!1:(ts(r,e),!i&&l===1&&delete r._):(o=!e.$stable,fG(e,r)),a=e}else e&&(pG(s,e),a={default:1});if(o)for(const l in r)!dG(l)&&a[l]==null&&delete r[l]};function mC(s,e,i,n,r=!1){if(Lt(s)){s.forEach((g,y)=>mC(g,e&&(Lt(e)?e[y]:e),i,n,r));return}if(Hp(n)&&!r)return;const o=n.shapeFlag&4?KT(n.component)||n.component.proxy:n.el,a=r?null:o,{i:l,r:h}=s,d=e&&e.r,f=l.refs===kn?l.refs={}:l.refs,p=l.setupState;if(d!=null&&d!==h&&(hs(d)?(f[d]=null,dn(p,d)&&(p[d]=null)):Ys(d)&&(d.value=null)),yi(h))su(h,l,12,[a,f]);else{const g=hs(h),y=Ys(h);if(g||y){const x=()=>{if(s.f){const _=g?dn(p,h)?p[h]:f[h]:h.value;r?Lt(_)&&jR(_,o):Lt(_)?_.includes(o)||_.push(o):g?(f[h]=[o],dn(p,h)&&(p[h]=f[h])):(h.value=[o],s.k&&(f[s.k]=h.value))}else g?(f[h]=a,dn(p,h)&&(p[h]=a)):y&&(h.value=a,s.k&&(f[s.k]=a))};a?(x.id=-1,Er(x,i)):x()}}}let Ku=!1;const $ge=s=>s.namespaceURI.includes("svg")&&s.tagName!=="foreignObject",Uge=s=>s.namespaceURI.includes("MathML"),qw=s=>{if($ge(s))return"svg";if(Uge(s))return"mathml"},Zw=s=>s.nodeType===8;function Fge(s){const{mt:e,p:i,o:{patchProp:n,createText:r,nextSibling:o,parentNode:a,remove:l,insert:h,createComment:d}}=s,f=(C,A)=>{if(!A.hasChildNodes()){i(null,C,A),fC(),A._vnode=C;return}Ku=!1,p(A.firstChild,C,null,null,null),fC(),A._vnode=C,Ku&&console.error("Hydration completed but contains mismatches.")},p=(C,A,B,I,R,P=!1)=>{P=P||!!A.dynamicChildren;const k=Zw(C)&&C.data==="[",E=()=>_(C,A,B,I,R,k),{type:D,ref:L,shapeFlag:V,patchFlag:F}=A;let j=C.nodeType;A.el=C,F===-2&&(P=!1,A.dynamicChildren=null);let Q=null;switch(D){case am:j!==3?A.children===""?(h(A.el=r(""),a(C),C),Q=C):Q=E():(C.data!==A.children&&(Ku=!0,C.data=A.children),Q=o(C));break;case Dr:T(C)?(Q=o(C),O(A.el=C.content.firstChild,C,B)):j!==8||k?Q=E():Q=o(C);break;case Gp:if(k&&(C=o(C),j=C.nodeType),j===1||j===3){Q=C;const ee=!A.children.length;for(let J=0;J<A.staticCount;J++)ee&&(A.children+=Q.nodeType===1?Q.outerHTML:Q.data),J===A.staticCount-1&&(A.anchor=Q),Q=o(Q);return k?o(Q):Q}else E();break;case Un:k?Q=x(C,A,B,I,R,P):Q=E();break;default:if(V&1)(j!==1||A.type.toLowerCase()!==C.tagName.toLowerCase())&&!T(C)?Q=E():Q=g(C,A,B,I,R,P);else if(V&6){A.slotScopeIds=R;const ee=a(C);if(k?Q=w(C):Zw(C)&&C.data==="teleport start"?Q=w(C,C.data,"teleport end"):Q=o(C),e(A,ee,null,B,I,qw(ee),P),Hp(A)){let J;k?(J=vt(Un),J.anchor=Q?Q.previousSibling:ee.lastChild):J=C.nodeType===3?As(""):vt("div"),J.el=C,A.component.subTree=J}}else V&64?j!==8?Q=E():Q=A.type.hydrate(C,A,B,I,R,P,s,y):V&128&&(Q=A.type.hydrate(C,A,B,I,qw(a(C)),R,P,s,p))}return L!=null&&mC(L,null,I,A),Q},g=(C,A,B,I,R,P)=>{P=P||!!A.dynamicChildren;const{type:k,props:E,patchFlag:D,shapeFlag:L,dirs:V,transition:F}=A,j=k==="input"||k==="option";if(j||D!==-1){V&&Vc(A,null,B,"created");let Q=!1;if(T(C)){Q=yG(I,F)&&B&&B.vnode.props&&B.vnode.props.appear;const J=C.content.firstChild;Q&&F.beforeEnter(J),O(J,C,B),A.el=C=J}if(L&16&&!(E&&(E.innerHTML||E.textContent))){let J=y(C.firstChild,A,C,B,I,R,P);for(;J;){Ku=!0;const ue=J;J=J.nextSibling,l(ue)}}else L&8&&C.textContent!==A.children&&(Ku=!0,C.textContent=A.children);if(E)if(j||!P||D&48)for(const J in E)(j&&(J.endsWith("value")||J==="indeterminate")||cb(J)&&!O0(J)||J[0]===".")&&n(C,J,null,E[J],void 0,void 0,B);else E.onClick&&n(C,"onClick",null,E.onClick,void 0,void 0,B);let ee;(ee=E&&E.onVnodeBeforeMount)&&Fo(ee,B,A),V&&Vc(A,null,B,"beforeMount"),((ee=E&&E.onVnodeMounted)||V||Q)&&VH(()=>{ee&&Fo(ee,B,A),Q&&F.enter(C),V&&Vc(A,null,B,"mounted")},I)}return C.nextSibling},y=(C,A,B,I,R,P,k)=>{k=k||!!A.dynamicChildren;const E=A.children,D=E.length;for(let L=0;L<D;L++){const V=k?E[L]:E[L]=Aa(E[L]);if(C)C=p(C,V,I,R,P,k);else{if(V.type===am&&!V.children)continue;Ku=!0,i(null,V,B,null,I,R,qw(B),P)}}return C},x=(C,A,B,I,R,P)=>{const{slotScopeIds:k}=A;k&&(R=R?R.concat(k):k);const E=a(C),D=y(o(C),A,E,B,I,R,P);return D&&Zw(D)&&D.data==="]"?o(A.anchor=D):(Ku=!0,h(A.anchor=d("]"),E,D),D)},_=(C,A,B,I,R,P)=>{if(Ku=!0,A.el=null,P){const D=w(C);for(;;){const L=o(C);if(L&&L!==D)l(L);else break}}const k=o(C),E=a(C);return l(C),i(null,A,E,k,B,I,qw(E),R),k},w=(C,A="[",B="]")=>{let I=0;for(;C;)if(C=o(C),C&&Zw(C)&&(C.data===A&&I++,C.data===B)){if(I===0)return o(C);I--}return C},O=(C,A,B)=>{const I=A.parentNode;I&&I.replaceChild(C,A);let R=B;for(;R;)R.vnode.el===A&&(R.vnode.el=R.subTree.el=C),R=R.parent},T=C=>C.nodeType===1&&C.tagName.toLowerCase()==="template";return[f,p]}const Er=VH;function vD(s){return gG(s)}function mG(s){return gG(s,Fge)}function gG(s,e){const i=oH();i.__VUE__=!0;const{insert:n,remove:r,patchProp:o,createElement:a,createText:l,createComment:h,setText:d,setElementText:f,parentNode:p,nextSibling:g,setScopeId:y=Go,insertStaticContent:x}=s,_=(z,q,le,he=null,be=null,Ee=null,Z=void 0,G=null,ce=!!q.dynamicChildren)=>{if(z===q)return;z&&!Wl(z,q)&&(he=De(z),Ue(z,be,Ee,!0),z=null),q.patchFlag===-2&&(ce=!1,q.dynamicChildren=null);const{type:de,ref:Oe,shapeFlag:Ae}=q;switch(de){case am:w(z,q,le,he);break;case Dr:O(z,q,le,he);break;case Gp:z==null&&T(q,le,he,Z);break;case Un:L(z,q,le,he,be,Ee,Z,G,ce);break;default:Ae&1?B(z,q,le,he,be,Ee,Z,G,ce):Ae&6?V(z,q,le,he,be,Ee,Z,G,ce):(Ae&64||Ae&128)&&de.process(z,q,le,he,be,Ee,Z,G,ce,W)}Oe!=null&&be&&mC(Oe,z&&z.ref,Ee,q||z,!q)},w=(z,q,le,he)=>{if(z==null)n(q.el=l(q.children),le,he);else{const be=q.el=z.el;q.children!==z.children&&d(be,q.children)}},O=(z,q,le,he)=>{z==null?n(q.el=h(q.children||""),le,he):q.el=z.el},T=(z,q,le,he)=>{[z.el,z.anchor]=x(z.children,q,le,he,z.el,z.anchor)},C=({el:z,anchor:q},le,he)=>{let be;for(;z&&z!==q;)be=g(z),n(z,le,he),z=be;n(q,le,he)},A=({el:z,anchor:q})=>{let le;for(;z&&z!==q;)le=g(z),r(z),z=le;r(q)},B=(z,q,le,he,be,Ee,Z,G,ce)=>{q.type==="svg"?Z="svg":q.type==="math"&&(Z="mathml"),z==null?I(q,le,he,be,Ee,Z,G,ce):k(z,q,be,Ee,Z,G,ce)},I=(z,q,le,he,be,Ee,Z,G)=>{let ce,de;const{props:Oe,shapeFlag:Ae,transition:je,dirs:Ge}=z;if(ce=z.el=a(z.type,Ee,Oe&&Oe.is,Oe),Ae&8?f(ce,z.children):Ae&16&&P(z.children,ce,null,he,be,DM(z,Ee),Z,G),Ge&&Vc(z,null,he,"created"),R(ce,z,z.scopeId,Z,he),Oe){for(const yt in Oe)yt!=="value"&&!O0(yt)&&o(ce,yt,null,Oe[yt],Ee,z.children,he,be,Le);"value"in Oe&&o(ce,"value",null,Oe.value,Ee),(de=Oe.onVnodeBeforeMount)&&Fo(de,he,z)}Ge&&Vc(z,null,he,"beforeMount");const Qe=yG(be,je);Qe&&je.beforeEnter(ce),n(ce,q,le),((de=Oe&&Oe.onVnodeMounted)||Qe||Ge)&&Er(()=>{de&&Fo(de,he,z),Qe&&je.enter(ce),Ge&&Vc(z,null,he,"mounted")},be)},R=(z,q,le,he,be)=>{if(le&&y(z,le),he)for(let Ee=0;Ee<he.length;Ee++)y(z,he[Ee]);if(be){let Ee=be.subTree;if(q===Ee){const Z=be.vnode;R(z,Z,Z.scopeId,Z.slotScopeIds,be.parent)}}},P=(z,q,le,he,be,Ee,Z,G,ce=0)=>{for(let de=ce;de<z.length;de++){const Oe=z[de]=G?Ad(z[de]):Aa(z[de]);_(null,Oe,q,le,he,be,Ee,Z,G)}},k=(z,q,le,he,be,Ee,Z)=>{const G=q.el=z.el;let{patchFlag:ce,dynamicChildren:de,dirs:Oe}=q;ce|=z.patchFlag&16;const Ae=z.props||kn,je=q.props||kn;let Ge;if(le&&Uf(le,!1),(Ge=je.onVnodeBeforeUpdate)&&Fo(Ge,le,q,z),Oe&&Vc(q,z,le,"beforeUpdate"),le&&Uf(le,!0),de?E(z.dynamicChildren,de,G,le,he,DM(q,be),Ee):Z||J(z,q,G,null,le,he,DM(q,be),Ee,!1),ce>0){if(ce&16)D(G,q,Ae,je,le,he,be);else if(ce&2&&Ae.class!==je.class&&o(G,"class",null,je.class,be),ce&4&&o(G,"style",Ae.style,je.style,be),ce&8){const Qe=q.dynamicProps;for(let yt=0;yt<Qe.length;yt++){const Ke=Qe[yt],ht=Ae[Ke],ti=je[Ke];(ti!==ht||Ke==="value")&&o(G,Ke,ht,ti,be,z.children,le,he,Le)}}ce&1&&z.children!==q.children&&f(G,q.children)}else!Z&&de==null&&D(G,q,Ae,je,le,he,be);((Ge=je.onVnodeUpdated)||Oe)&&Er(()=>{Ge&&Fo(Ge,le,q,z),Oe&&Vc(q,z,le,"updated")},he)},E=(z,q,le,he,be,Ee,Z)=>{for(let G=0;G<q.length;G++){const ce=z[G],de=q[G],Oe=ce.el&&(ce.type===Un||!Wl(ce,de)||ce.shapeFlag&70)?p(ce.el):le;_(ce,de,Oe,null,he,be,Ee,Z,!0)}},D=(z,q,le,he,be,Ee,Z)=>{if(le!==he){if(le!==kn)for(const G in le)!O0(G)&&!(G in he)&&o(z,G,le[G],null,Z,q.children,be,Ee,Le);for(const G in he){if(O0(G))continue;const ce=he[G],de=le[G];ce!==de&&G!=="value"&&o(z,G,de,ce,Z,q.children,be,Ee,Le)}"value"in he&&o(z,"value",le.value,he.value,Z)}},L=(z,q,le,he,be,Ee,Z,G,ce)=>{const de=q.el=z?z.el:l(""),Oe=q.anchor=z?z.anchor:l("");let{patchFlag:Ae,dynamicChildren:je,slotScopeIds:Ge}=q;Ge&&(G=G?G.concat(Ge):Ge),z==null?(n(de,le,he),n(Oe,le,he),P(q.children||[],le,Oe,be,Ee,Z,G,ce)):Ae>0&&Ae&64&&je&&z.dynamicChildren?(E(z.dynamicChildren,je,le,be,Ee,Z,G),(q.key!=null||be&&q===be.subTree)&&xD(z,q,!0)):J(z,q,le,Oe,be,Ee,Z,G,ce)},V=(z,q,le,he,be,Ee,Z,G,ce)=>{q.slotScopeIds=G,z==null?q.shapeFlag&512?be.ctx.activate(q,le,he,Z,ce):F(q,le,he,be,Ee,Z,ce):j(z,q,ce)},F=(z,q,le,he,be,Ee,Z)=>{const G=z.component=SG(z,he,be);if(fb(z)&&(G.ctx.renderer=W),TG(G),G.asyncDep){if(be&&be.registerDep(G,Q),!z.el){const ce=G.subTree=vt(Dr);O(null,ce,q,le)}}else Q(G,z,q,le,be,Ee,Z)},j=(z,q,le)=>{const he=q.component=z.component;if(Zme(z,q,le))if(he.asyncDep&&!he.asyncResolved){ee(he,q,le);return}else he.next=q,Wme(he.update),he.effect.dirty=!0,he.update();else q.el=z.el,he.vnode=q},Q=(z,q,le,he,be,Ee,Z)=>{const G=()=>{if(z.isMounted){let{next:Oe,bu:Ae,u:je,parent:Ge,vnode:Qe}=z;{const Ht=vG(z);if(Ht){Oe&&(Oe.el=Qe.el,ee(z,Oe,Z)),Ht.asyncDep.then(()=>{z.isUnmounted||G()});return}}let yt=Oe,Ke;Uf(z,!1),Oe?(Oe.el=Qe.el,ee(z,Oe,Z)):Oe=Qe,Ae&&S0(Ae),(Ke=Oe.props&&Oe.props.onVnodeBeforeUpdate)&&Fo(Ke,Ge,Oe,Qe),Uf(z,!0);const ht=CS(z),ti=z.subTree;z.subTree=ht,_(ti,ht,p(ti.el),De(ti),z,be,Ee),Oe.el=ht.el,yt===null&&cD(z,ht.el),je&&Er(je,be),(Ke=Oe.props&&Oe.props.onVnodeUpdated)&&Er(()=>Fo(Ke,Ge,Oe,Qe),be)}else{let Oe;const{el:Ae,props:je}=q,{bm:Ge,m:Qe,parent:yt}=z,Ke=Hp(q);if(Uf(z,!1),Ge&&S0(Ge),!Ke&&(Oe=je&&je.onVnodeBeforeMount)&&Fo(Oe,yt,q),Uf(z,!0),Ae&&ae){const ht=()=>{z.subTree=CS(z),ae(Ae,z.subTree,z,be,null)};Ke?q.type.__asyncLoader().then(()=>!z.isUnmounted&&ht()):ht()}else{const ht=z.subTree=CS(z);_(null,ht,le,he,z,be,Ee),q.el=ht.el}if(Qe&&Er(Qe,be),!Ke&&(Oe=je&&je.onVnodeMounted)){const ht=q;Er(()=>Fo(Oe,yt,ht),be)}(q.shapeFlag&256||yt&&Hp(yt.vnode)&&yt.vnode.shapeFlag&256)&&z.a&&Er(z.a,be),z.isMounted=!0,q=le=he=null}},ce=z.effect=new q0(G,Go,()=>XT(de),z.scope),de=z.update=()=>{ce.dirty&&ce.run()};de.id=z.uid,Uf(z,!0),de()},ee=(z,q,le)=>{q.component=z;const he=z.vnode.props;z.vnode=q,z.next=null,Dge(z,q.props,he,le),Vge(z,q.children,le),pf(),lF(z),mf()},J=(z,q,le,he,be,Ee,Z,G,ce=!1)=>{const de=z&&z.children,Oe=z?z.shapeFlag:0,Ae=q.children,{patchFlag:je,shapeFlag:Ge}=q;if(je>0){if(je&128){oe(de,Ae,le,he,be,Ee,Z,G,ce);return}else if(je&256){ue(de,Ae,le,he,be,Ee,Z,G,ce);return}}Ge&8?(Oe&16&&Le(de,be,Ee),Ae!==de&&f(le,Ae)):Oe&16?Ge&16?oe(de,Ae,le,he,be,Ee,Z,G,ce):Le(de,be,Ee,!0):(Oe&8&&f(le,""),Ge&16&&P(Ae,le,he,be,Ee,Z,G,ce))},ue=(z,q,le,he,be,Ee,Z,G,ce)=>{z=z||b0,q=q||b0;const de=z.length,Oe=q.length,Ae=Math.min(de,Oe);let je;for(je=0;je<Ae;je++){const Ge=q[je]=ce?Ad(q[je]):Aa(q[je]);_(z[je],Ge,le,null,be,Ee,Z,G,ce)}de>Oe?Le(z,be,Ee,!0,!1,Ae):P(q,le,he,be,Ee,Z,G,ce,Ae)},oe=(z,q,le,he,be,Ee,Z,G,ce)=>{let de=0;const Oe=q.length;let Ae=z.length-1,je=Oe-1;for(;de<=Ae&&de<=je;){const Ge=z[de],Qe=q[de]=ce?Ad(q[de]):Aa(q[de]);if(Wl(Ge,Qe))_(Ge,Qe,le,null,be,Ee,Z,G,ce);else break;de++}for(;de<=Ae&&de<=je;){const Ge=z[Ae],Qe=q[je]=ce?Ad(q[je]):Aa(q[je]);if(Wl(Ge,Qe))_(Ge,Qe,le,null,be,Ee,Z,G,ce);else break;Ae--,je--}if(de>Ae){if(de<=je){const Ge=je+1,Qe=Ge<Oe?q[Ge].el:he;for(;de<=je;)_(null,q[de]=ce?Ad(q[de]):Aa(q[de]),le,Qe,be,Ee,Z,G,ce),de++}}else if(de>je)for(;de<=Ae;)Ue(z[de],be,Ee,!0),de++;else{const Ge=de,Qe=de,yt=new Map;for(de=Qe;de<=je;de++){const _e=q[de]=ce?Ad(q[de]):Aa(q[de]);_e.key!=null&&yt.set(_e.key,de)}let Ke,ht=0;const ti=je-Qe+1;let Ht=!1,Tt=0;const pi=new Array(ti);for(de=0;de<ti;de++)pi[de]=0;for(de=Ge;de<=Ae;de++){const _e=z[de];if(ht>=ti){Ue(_e,be,Ee,!0);continue}let $e;if(_e.key!=null)$e=yt.get(_e.key);else for(Ke=Qe;Ke<=je;Ke++)if(pi[Ke-Qe]===0&&Wl(_e,q[Ke])){$e=Ke;break}$e===void 0?Ue(_e,be,Ee,!0):(pi[$e-Qe]=de+1,$e>=Tt?Tt=$e:Ht=!0,_(_e,q[$e],le,null,be,Ee,Z,G,ce),ht++)}const Ai=Ht?zge(pi):b0;for(Ke=Ai.length-1,de=ti-1;de>=0;de--){const _e=Qe+de,$e=q[_e],fe=_e+1<Oe?q[_e+1].el:he;pi[de]===0?_(null,$e,le,fe,be,Ee,Z,G,ce):Ht&&(Ke<0||de!==Ai[Ke]?pe($e,le,fe,2):Ke--)}}},pe=(z,q,le,he,be=null)=>{const{el:Ee,type:Z,transition:G,children:ce,shapeFlag:de}=z;if(de&6){pe(z.component.subTree,q,le,he);return}if(de&128){z.suspense.move(q,le,he);return}if(de&64){Z.move(z,q,le,W);return}if(Z===Un){n(Ee,q,le);for(let Ae=0;Ae<ce.length;Ae++)pe(ce[Ae],q,le,he);n(z.anchor,q,le);return}if(Z===Gp){C(z,q,le);return}if(he!==2&&de&1&&G)if(he===0)G.beforeEnter(Ee),n(Ee,q,le),Er(()=>G.enter(Ee),be);else{const{leave:Ae,delayLeave:je,afterLeave:Ge}=G,Qe=()=>n(Ee,q,le),yt=()=>{Ae(Ee,()=>{Qe(),Ge&&Ge()})};je?je(Ee,Qe,yt):yt()}else n(Ee,q,le)},Ue=(z,q,le,he=!1,be=!1)=>{const{type:Ee,props:Z,ref:G,children:ce,dynamicChildren:de,shapeFlag:Oe,patchFlag:Ae,dirs:je}=z;if(G!=null&&mC(G,null,le,z,!0),Oe&256){q.ctx.deactivate(z);return}const Ge=Oe&1&&je,Qe=!Hp(z);let yt;if(Qe&&(yt=Z&&Z.onVnodeBeforeUnmount)&&Fo(yt,q,z),Oe&6)Re(z.component,le,he);else{if(Oe&128){z.suspense.unmount(le,he);return}Ge&&Vc(z,null,q,"beforeUnmount"),Oe&64?z.type.remove(z,q,le,be,W,he):de&&(Ee!==Un||Ae>0&&Ae&64)?Le(de,q,le,!1,!0):(Ee===Un&&Ae&384||!be&&Oe&16)&&Le(ce,q,le),he&&tt(z)}(Qe&&(yt=Z&&Z.onVnodeUnmounted)||Ge)&&Er(()=>{yt&&Fo(yt,q,z),Ge&&Vc(z,null,q,"unmounted")},le)},tt=z=>{const{type:q,el:le,anchor:he,transition:be}=z;if(q===Un){ve(le,he);return}if(q===Gp){A(z);return}const Ee=()=>{r(le),be&&!be.persisted&&be.afterLeave&&be.afterLeave()};if(z.shapeFlag&1&&be&&!be.persisted){const{leave:Z,delayLeave:G}=be,ce=()=>Z(le,Ee);G?G(z.el,Ee,ce):ce()}else Ee()},ve=(z,q)=>{let le;for(;z!==q;)le=g(z),r(z),z=le;r(q)},Re=(z,q,le)=>{const{bum:he,scope:be,update:Ee,subTree:Z,um:G}=z;he&&S0(he),be.stop(),Ee&&(Ee.active=!1,Ue(Z,z,q,le)),G&&Er(G,q),Er(()=>{z.isUnmounted=!0},q),q&&q.pendingBranch&&!q.isUnmounted&&z.asyncDep&&!z.asyncResolved&&z.suspenseId===q.pendingId&&(q.deps--,q.deps===0&&q.resolve())},Le=(z,q,le,he=!1,be=!1,Ee=0)=>{for(let Z=Ee;Z<z.length;Z++)Ue(z[Z],q,le,he,be)},De=z=>z.shapeFlag&6?De(z.component.subTree):z.shapeFlag&128?z.suspense.next():g(z.anchor||z.el);let Se=!1;const Y=(z,q,le)=>{z==null?q._vnode&&Ue(q._vnode,null,null,!0):_(q._vnode||null,z,q,null,null,null,le),Se||(Se=!0,lF(),fC(),Se=!1),q._vnode=z},W={p:_,um:Ue,m:pe,r:tt,mt:F,mc:P,pc:J,pbc:E,n:De,o:s};let te,ae;return e&&([te,ae]=e(W)),{render:Y,hydrate:te,createApp:Ige(Y,te)}}function DM({type:s,props:e},i){return i==="svg"&&s==="foreignObject"||i==="mathml"&&s==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:i}function Uf({effect:s,update:e},i){s.allowRecurse=e.allowRecurse=i}function yG(s,e){return(!s||s&&!s.pendingBranch)&&e&&!e.persisted}function xD(s,e,i=!1){const n=s.children,r=e.children;if(Lt(n)&&Lt(r))for(let o=0;o<n.length;o++){const a=n[o];let l=r[o];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=r[o]=Ad(r[o]),l.el=a.el),i||xD(a,l)),l.type===am&&(l.el=a.el)}}function zge(s){const e=s.slice(),i=[0];let n,r,o,a,l;const h=s.length;for(n=0;n<h;n++){const d=s[n];if(d!==0){if(r=i[i.length-1],s[r]<d){e[n]=r,i.push(n);continue}for(o=0,a=i.length-1;o<a;)l=o+a>>1,s[i[l]]<d?o=l+1:a=l;d<s[i[o]]&&(o>0&&(e[n]=i[o-1]),i[o]=n)}}for(o=i.length,a=i[o-1];o-- >0;)i[o]=a,a=e[a];return i}function vG(s){const e=s.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:vG(e)}const Xge=s=>s.__isTeleport,$x=s=>s&&(s.disabled||s.disabled===""),_F=s=>typeof SVGElement<"u"&&s instanceof SVGElement,bF=s=>typeof MathMLElement=="function"&&s instanceof MathMLElement,X2=(s,e)=>{const i=s&&s.to;return hs(i)?e?e(i):null:i},Wge={name:"Teleport",__isTeleport:!0,process(s,e,i,n,r,o,a,l,h,d){const{mc:f,pc:p,pbc:g,o:{insert:y,querySelector:x,createText:_,createComment:w}}=d,O=$x(e.props);let{shapeFlag:T,children:C,dynamicChildren:A}=e;if(s==null){const B=e.el=_(""),I=e.anchor=_("");y(B,i,n),y(I,i,n);const R=e.target=X2(e.props,x),P=e.targetAnchor=_("");R&&(y(P,R),a==="svg"||_F(R)?a="svg":(a==="mathml"||bF(R))&&(a="mathml"));const k=(E,D)=>{T&16&&f(C,E,D,r,o,a,l,h)};O?k(i,I):R&&k(R,P)}else{e.el=s.el;const B=e.anchor=s.anchor,I=e.target=s.target,R=e.targetAnchor=s.targetAnchor,P=$x(s.props),k=P?i:I,E=P?B:R;if(a==="svg"||_F(I)?a="svg":(a==="mathml"||bF(I))&&(a="mathml"),A?(g(s.dynamicChildren,A,k,r,o,a,l),xD(s,e,!0)):h||p(s,e,k,E,r,o,a,l,!1),O)P?e.props&&s.props&&e.props.to!==s.props.to&&(e.props.to=s.props.to):Kw(e,i,B,d,1);else if((e.props&&e.props.to)!==(s.props&&s.props.to)){const D=e.target=X2(e.props,x);D&&Kw(e,D,null,d,0)}else P&&Kw(e,I,R,d,1)}xG(e)},remove(s,e,i,n,{um:r,o:{remove:o}},a){const{shapeFlag:l,children:h,anchor:d,targetAnchor:f,target:p,props:g}=s;if(p&&o(f),a&&o(d),l&16){const y=a||!$x(g);for(let x=0;x<h.length;x++){const _=h[x];r(_,e,i,y,!!_.dynamicChildren)}}},move:Kw,hydrate:Hge};function Kw(s,e,i,{o:{insert:n},m:r},o=2){o===0&&n(s.targetAnchor,e,i);const{el:a,anchor:l,shapeFlag:h,children:d,props:f}=s,p=o===2;if(p&&n(a,e,i),(!p||$x(f))&&h&16)for(let g=0;g<d.length;g++)r(d[g],e,i,2);p&&n(l,e,i)}function Hge(s,e,i,n,r,o,{o:{nextSibling:a,parentNode:l,querySelector:h}},d){const f=e.target=X2(e.props,h);if(f){const p=f._lpa||f.firstChild;if(e.shapeFlag&16)if($x(e.props))e.anchor=d(a(s),e,l(s),i,n,r,o),e.targetAnchor=p;else{e.anchor=a(s);let g=p;for(;g;)if(g=a(g),g&&g.nodeType===8&&g.data==="teleport anchor"){e.targetAnchor=g,f._lpa=e.targetAnchor&&a(e.targetAnchor);break}d(p,e,f,i,n,r,o)}xG(e)}return e.anchor&&a(e.anchor)}const Gge=Wge;function xG(s){const e=s.ctx;if(e&&e.ut){let i=s.children[0].el;for(;i&&i!==s.targetAnchor;)i.nodeType===1&&i.setAttribute("data-v-owner",e.uid),i=i.nextSibling;e.ut()}}const Un=Symbol.for("v-fgt"),am=Symbol.for("v-txt"),Dr=Symbol.for("v-cmt"),Gp=Symbol.for("v-stc"),Ux=[];let Qo=null;function di(s=!1){Ux.push(Qo=s?null:[])}function _G(){Ux.pop(),Qo=Ux[Ux.length-1]||null}let lm=1;function W2(s){lm+=s}function bG(s){return s.dynamicChildren=lm>0?Qo||b0:null,_G(),lm>0&&Qo&&Qo.push(s),s}function hn(s,e,i,n,r,o){return bG(Kt(s,e,i,n,r,o,!0))}function Ir(s,e,i,n,r){return bG(vt(s,e,i,n,r,!0))}function Jd(s){return s?s.__v_isVNode===!0:!1}function Wl(s,e){return s.type===e.type&&s.key===e.key}function Qge(s){}const wG=({key:s})=>s??null,AS=({ref:s,ref_key:e,ref_for:i})=>(typeof s=="number"&&(s=""+s),s!=null?hs(s)||Ys(s)||yi(s)?{i:Gs,r:s,k:e,f:!!i}:s:null);function Kt(s,e=null,i=null,n=0,r=null,o=s===Un?0:1,a=!1,l=!1){const h={__v_isVNode:!0,__v_skip:!0,type:s,props:e,key:e&&wG(e),ref:e&&AS(e),scopeId:HT,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Gs};return l?(bD(h,i),o&128&&s.normalize(h)):i&&(h.shapeFlag|=hs(i)?8:16),lm>0&&!a&&Qo&&(h.patchFlag>0||o&6)&&h.patchFlag!==32&&Qo.push(h),h}const vt=Yge;function Yge(s,e=null,i=null,n=0,r=null,o=!1){if((!s||s===RH)&&(s=Dr),Jd(s)){const l=ih(s,e,!0);return i&&bD(l,i),lm>0&&!o&&Qo&&(l.shapeFlag&6?Qo[Qo.indexOf(s)]=l:Qo.push(l)),l.patchFlag|=-2,l}if(i0e(s)&&(s=s.__vccOpts),e){e=_D(e);let{class:l,style:h}=e;l&&!hs(l)&&(e.class=Cy(l)),Ln(h)&&(nD(h)&&!Lt(h)&&(h=ts({},h)),e.style=Au(h))}const a=hs(s)?1:LH(s)?128:Xge(s)?64:Ln(s)?4:yi(s)?2:0;return Kt(s,e,i,n,r,a,o,!0)}function _D(s){return s?nD(s)||cG(s)?ts({},s):s:null}function ih(s,e,i=!1,n=!1){const{props:r,ref:o,patchFlag:a,children:l,transition:h}=s,d=e?OG(r||{},e):r,f={__v_isVNode:!0,__v_skip:!0,type:s.type,props:d,key:d&&wG(d),ref:e&&e.ref?i&&o?Lt(o)?o.concat(AS(e)):[o,AS(e)]:AS(e):o,scopeId:s.scopeId,slotScopeIds:s.slotScopeIds,children:l,target:s.target,targetAnchor:s.targetAnchor,staticCount:s.staticCount,shapeFlag:s.shapeFlag,patchFlag:e&&s.type!==Un?a===-1?16:a|16:a,dynamicProps:s.dynamicProps,dynamicChildren:s.dynamicChildren,appContext:s.appContext,dirs:s.dirs,transition:h,component:s.component,suspense:s.suspense,ssContent:s.ssContent&&ih(s.ssContent),ssFallback:s.ssFallback&&ih(s.ssFallback),el:s.el,anchor:s.anchor,ctx:s.ctx,ce:s.ce};return h&&n&&(f.transition=h.clone(f)),f}function As(s=" ",e=0){return vt(am,null,s,e)}function jge(s,e){const i=vt(Gp,null,s);return i.staticCount=e,i}function cm(s="",e=!1){return e?(di(),Ir(Dr,null,s)):vt(Dr,null,s)}function Aa(s){return s==null||typeof s=="boolean"?vt(Dr):Lt(s)?vt(Un,null,s.slice()):typeof s=="object"?Ad(s):vt(am,null,String(s))}function Ad(s){return s.el===null&&s.patchFlag!==-1||s.memo?s:ih(s)}function bD(s,e){let i=0;const{shapeFlag:n}=s;if(e==null)e=null;else if(Lt(e))i=16;else if(typeof e=="object")if(n&65){const r=e.default;r&&(r._c&&(r._d=!1),bD(s,r()),r._c&&(r._d=!0));return}else{i=32;const r=e._;!r&&!cG(e)?e._ctx=Gs:r===3&&Gs&&(Gs.slots._===1?e._=1:(e._=2,s.patchFlag|=1024))}else yi(e)?(e={default:e,_ctx:Gs},i=32):(e=String(e),n&64?(i=16,e=[As(e)]):i=8);s.children=e,s.shapeFlag|=i}function OG(...s){const e={};for(let i=0;i<s.length;i++){const n=s[i];for(const r in n)if(r==="class")e.class!==n.class&&(e.class=Cy([e.class,n.class]));else if(r==="style")e.style=Au([e.style,n.style]);else if(cb(r)){const o=e[r],a=n[r];a&&o!==a&&!(Lt(o)&&o.includes(a))&&(e[r]=o?[].concat(o,a):a)}else r!==""&&(e[r]=n[r])}return e}function Fo(s,e,i,n=null){Ra(s,e,7,[i,n])}const qge=oG();let Zge=0;function SG(s,e,i){const n=s.type,r=(e?e.appContext:s.appContext)||qge,o={uid:Zge++,vnode:s,type:n,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new KR(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:uG(n,r),emitsOptions:BH(n,r),emit:null,emitted:null,propsDefaults:kn,inheritAttrs:n.inheritAttrs,ctx:kn,data:kn,props:kn,attrs:kn,slots:kn,refs:kn,setupState:kn,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=e?e.root:o,o.emit=Gme.bind(null,o),s.ce&&s.ce(o),o}let or=null;const Na=()=>or||Gs;let gC,H2;{const s=oH(),e=(i,n)=>{let r;return(r=s[i])||(r=s[i]=[]),r.push(n),o=>{r.length>1?r.forEach(a=>a(o)):r[0](o)}};gC=e("__VUE_INSTANCE_SETTERS__",i=>or=i),H2=e("__VUE_SSR_SETTERS__",i=>pb=i)}const hm=s=>{const e=or;return gC(s),s.scope.on(),()=>{s.scope.off(),gC(e)}},G2=()=>{or&&or.scope.off(),gC(null)};function CG(s){return s.vnode.shapeFlag&4}let pb=!1;function TG(s,e=!1){e&&H2(e);const{props:i,children:n}=s.vnode,r=CG(s);Rge(s,i,r,e),Nge(s,n);const o=r?Kge(s,e):void 0;return e&&H2(!1),o}function Kge(s,e){const i=s.type;s.accessCache=Object.create(null),s.proxy=new Proxy(s.ctx,$2);const{setup:n}=i;if(n){const r=s.setupContext=n.length>1?EG(s):null,o=hm(s);pf();const a=su(n,s,0,[s.props,r]);if(mf(),o(),qR(a)){if(a.then(G2,G2),e)return a.then(l=>{Q2(s,l,e)}).catch(l=>{Am(l,s,0)});s.asyncDep=a}else Q2(s,a,e)}else AG(s,e)}function Q2(s,e,i){yi(e)?s.type.__ssrInlineRender?s.ssrRender=e:s.render=e:Ln(e)&&(s.setupState=oD(e)),AG(s,i)}let yC,Y2;function Jge(s){yC=s,Y2=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,mge))}}const e0e=()=>!yC;function AG(s,e,i){const n=s.type;if(!s.render){if(!e&&yC&&!n.render){const r=n.template||gD(s).template;if(r){const{isCustomElement:o,compilerOptions:a}=s.appContext.config,{delimiters:l,compilerOptions:h}=n,d=ts(ts({isCustomElement:o,delimiters:l},a),h);n.render=yC(r,d)}}s.render=n.render||Go,Y2&&Y2(s)}{const r=hm(s);pf();try{Tge(s)}finally{mf(),r()}}}const t0e={get(s,e){return ia(s,"get",""),s[e]}};function EG(s){const e=i=>{s.exposed=i||{}};return{attrs:new Proxy(s.attrs,t0e),slots:s.slots,emit:s.emit,expose:e}}function KT(s){if(s.exposed)return s.exposeProxy||(s.exposeProxy=new Proxy(oD(CH(s.exposed)),{get(e,i){if(i in e)return e[i];if(i in Vx)return Vx[i](s)},has(e,i){return i in e||i in Vx}}))}function j2(s,e=!0){return yi(s)?s.displayName||s.name:s.name||e&&s.__name}function i0e(s){return yi(s)&&"__vccOpts"in s}const Es=(s,e)=>Eme(s,e,pb);function n0e(s,e,i=kn){const n=Na(),r=wo(e),o=Ea(e),a=aD((h,d)=>{let f;return zH(()=>{const p=s[e];nc(f,p)&&(f=p,d())}),{get(){return h(),i.get?i.get(f):f},set(p){const g=n.vnode.props;!(g&&(e in g||r in g||o in g)&&(`onUpdate:${e}`in g||`onUpdate:${r}`in g||`onUpdate:${o}`in g))&&nc(p,f)&&(f=p,d()),n.emit(`update:${e}`,i.set?i.set(p):p)}}}),l=e==="modelValue"?"modelModifiers":`${e}Modifiers`;return a[Symbol.iterator]=()=>{let h=0;return{next(){return h<2?{value:h++?s[l]||{}:a,done:!1}:{done:!0}}}},a}function vC(s,e,i){const n=arguments.length;return n===2?Ln(e)&&!Lt(e)?Jd(e)?vt(s,null,[e]):vt(s,e):vt(s,null,e):(n>3?i=Array.prototype.slice.call(arguments,2):n===3&&Jd(i)&&(i=[i]),vt(s,e,i))}function s0e(){}function r0e(s,e,i,n){const r=i[n];if(r&&MG(r,s))return r;const o=e();return o.memo=s.slice(),i[n]=o}function MG(s,e){const i=s.memo;if(i.length!=e.length)return!1;for(let n=0;n<i.length;n++)if(nc(i[n],e[n]))return!1;return lm>0&&Qo&&Qo.push(s),!0}const kG="3.4.27",o0e=Go,a0e=Fme,l0e=Kg,c0e=IH,h0e={createComponentInstance:SG,setupComponent:TG,renderComponentRoot:CS,setCurrentRenderingInstance:h_,isVNode:Jd,normalizeVNode:Aa},u0e=h0e,d0e=null,f0e=null,p0e=null;/**
* @vue/runtime-dom v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const m0e="http://www.w3.org/2000/svg",g0e="http://www.w3.org/1998/Math/MathML",Ed=typeof document<"u"?document:null,wF=Ed&&Ed.createElement("template"),y0e={insert:(s,e,i)=>{e.insertBefore(s,i||null)},remove:s=>{const e=s.parentNode;e&&e.removeChild(s)},createElement:(s,e,i,n)=>{const r=e==="svg"?Ed.createElementNS(m0e,s):e==="mathml"?Ed.createElementNS(g0e,s):Ed.createElement(s,i?{is:i}:void 0);return s==="select"&&n&&n.multiple!=null&&r.setAttribute("multiple",n.multiple),r},createText:s=>Ed.createTextNode(s),createComment:s=>Ed.createComment(s),setText:(s,e)=>{s.nodeValue=e},setElementText:(s,e)=>{s.textContent=e},parentNode:s=>s.parentNode,nextSibling:s=>s.nextSibling,querySelector:s=>Ed.querySelector(s),setScopeId(s,e){s.setAttribute(e,"")},insertStaticContent(s,e,i,n,r,o){const a=i?i.previousSibling:e.lastChild;if(r&&(r===o||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),i),!(r===o||!(r=r.nextSibling)););else{wF.innerHTML=n==="svg"?`<svg>${s}</svg>`:n==="mathml"?`<math>${s}</math>`:s;const l=wF.content;if(n==="svg"||n==="mathml"){const h=l.firstChild;for(;h.firstChild;)l.appendChild(h.firstChild);l.removeChild(h)}e.insertBefore(l,i)}return[a?a.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}},Ju="transition",Tv="animation",J0=Symbol("_vtc"),wD=(s,{slots:e})=>vC(WH,IG(s),e);wD.displayName="Transition";const PG={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},v0e=wD.props=ts({},pD,PG),Ff=(s,e=[])=>{Lt(s)?s.forEach(i=>i(...e)):s&&s(...e)},OF=s=>s?Lt(s)?s.some(e=>e.length>1):s.length>1:!1;function IG(s){const e={};for(const L in s)L in PG||(e[L]=s[L]);if(s.css===!1)return e;const{name:i="v",type:n,duration:r,enterFromClass:o=`${i}-enter-from`,enterActiveClass:a=`${i}-enter-active`,enterToClass:l=`${i}-enter-to`,appearFromClass:h=o,appearActiveClass:d=a,appearToClass:f=l,leaveFromClass:p=`${i}-leave-from`,leaveActiveClass:g=`${i}-leave-active`,leaveToClass:y=`${i}-leave-to`}=s,x=x0e(r),_=x&&x[0],w=x&&x[1],{onBeforeEnter:O,onEnter:T,onEnterCancelled:C,onLeave:A,onLeaveCancelled:B,onBeforeAppear:I=O,onAppear:R=T,onAppearCancelled:P=C}=e,k=(L,V,F)=>{wd(L,V?f:l),wd(L,V?d:a),F&&F()},E=(L,V)=>{L._isLeaving=!1,wd(L,p),wd(L,y),wd(L,g),V&&V()},D=L=>(V,F)=>{const j=L?R:T,Q=()=>k(V,L,F);Ff(j,[V,Q]),SF(()=>{wd(V,L?h:o),Fh(V,L?f:l),OF(j)||CF(V,n,_,Q)})};return ts(e,{onBeforeEnter(L){Ff(O,[L]),Fh(L,o),Fh(L,a)},onBeforeAppear(L){Ff(I,[L]),Fh(L,h),Fh(L,d)},onEnter:D(!1),onAppear:D(!0),onLeave(L,V){L._isLeaving=!0;const F=()=>E(L,V);Fh(L,p),Fh(L,g),RG(),SF(()=>{L._isLeaving&&(wd(L,p),Fh(L,y),OF(A)||CF(L,n,w,F))}),Ff(A,[L,F])},onEnterCancelled(L){k(L,!1),Ff(C,[L])},onAppearCancelled(L){k(L,!0),Ff(P,[L])},onLeaveCancelled(L){E(L),Ff(B,[L])}})}function x0e(s){if(s==null)return null;if(Ln(s))return[LM(s.enter),LM(s.leave)];{const e=LM(s);return[e,e]}}function LM(s){return hC(s)}function Fh(s,e){e.split(/\s+/).forEach(i=>i&&s.classList.add(i)),(s[J0]||(s[J0]=new Set)).add(e)}function wd(s,e){e.split(/\s+/).forEach(n=>n&&s.classList.remove(n));const i=s[J0];i&&(i.delete(e),i.size||(s[J0]=void 0))}function SF(s){requestAnimationFrame(()=>{requestAnimationFrame(s)})}let _0e=0;function CF(s,e,i,n){const r=s._endId=++_0e,o=()=>{r===s._endId&&n()};if(i)return setTimeout(o,i);const{type:a,timeout:l,propCount:h}=BG(s,e);if(!a)return n();const d=a+"end";let f=0;const p=()=>{s.removeEventListener(d,g),o()},g=y=>{y.target===s&&++f>=h&&p()};setTimeout(()=>{f<h&&p()},l+1),s.addEventListener(d,g)}function BG(s,e){const i=window.getComputedStyle(s),n=x=>(i[x]||"").split(", "),r=n(`${Ju}Delay`),o=n(`${Ju}Duration`),a=TF(r,o),l=n(`${Tv}Delay`),h=n(`${Tv}Duration`),d=TF(l,h);let f=null,p=0,g=0;e===Ju?a>0&&(f=Ju,p=a,g=o.length):e===Tv?d>0&&(f=Tv,p=d,g=h.length):(p=Math.max(a,d),f=p>0?a>d?Ju:Tv:null,g=f?f===Ju?o.length:h.length:0);const y=f===Ju&&/\b(transform|all)(,|$)/.test(n(`${Ju}Property`).toString());return{type:f,timeout:p,propCount:g,hasTransform:y}}function TF(s,e){for(;s.length<e.length;)s=s.concat(s);return Math.max(...e.map((i,n)=>AF(i)+AF(s[n])))}function AF(s){return s==="auto"?0:Number(s.slice(0,-1).replace(",","."))*1e3}function RG(){return document.body.offsetHeight}function b0e(s,e,i){const n=s[J0];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?s.removeAttribute("class"):i?s.setAttribute("class",e):s.className=e}const xC=Symbol("_vod"),DG=Symbol("_vsh"),LG={beforeMount(s,{value:e},{transition:i}){s[xC]=s.style.display==="none"?"":s.style.display,i&&e?i.beforeEnter(s):Av(s,e)},mounted(s,{value:e},{transition:i}){i&&e&&i.enter(s)},updated(s,{value:e,oldValue:i},{transition:n}){!e!=!i&&(n?e?(n.beforeEnter(s),Av(s,!0),n.enter(s)):n.leave(s,()=>{Av(s,!1)}):Av(s,e))},beforeUnmount(s,{value:e}){Av(s,e)}};function Av(s,e){s.style.display=e?s[xC]:"none",s[DG]=!e}function w0e(){LG.getSSRProps=({value:s})=>{if(!s)return{style:{display:"none"}}}}const NG=Symbol("");function O0e(s){const e=Na();if(!e)return;const i=e.ut=(r=s(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(o=>Z2(o,r))},n=()=>{const r=s(e.proxy);q2(e.subTree,r),i(r)};io(()=>{FH(n);const r=new MutationObserver(n);r.observe(e.subTree.el.parentNode,{childList:!0}),ra(()=>r.disconnect())})}function q2(s,e){if(s.shapeFlag&128){const i=s.suspense;s=i.activeBranch,i.pendingBranch&&!i.isHydrating&&i.effects.push(()=>{q2(i.activeBranch,e)})}for(;s.component;)s=s.component.subTree;if(s.shapeFlag&1&&s.el)Z2(s.el,e);else if(s.type===Un)s.children.forEach(i=>q2(i,e));else if(s.type===Gp){let{el:i,anchor:n}=s;for(;i&&(Z2(i,e),i!==n);)i=i.nextSibling}}function Z2(s,e){if(s.nodeType===1){const i=s.style;let n="";for(const r in e)i.setProperty(`--${r}`,e[r]),n+=`--${r}: ${e[r]};`;i[NG]=n}}const S0e=/(^|;)\s*display\s*:/;function C0e(s,e,i){const n=s.style,r=hs(i);let o=!1;if(i&&!r){if(e)if(hs(e))for(const a of e.split(";")){const l=a.slice(0,a.indexOf(":")).trim();i[l]==null&&ES(n,l,"")}else for(const a in e)i[a]==null&&ES(n,a,"");for(const a in i)a==="display"&&(o=!0),ES(n,a,i[a])}else if(r){if(e!==i){const a=n[NG];a&&(i+=";"+a),n.cssText=i,o=S0e.test(i)}}else e&&s.removeAttribute("style");xC in s&&(s[xC]=o?n.display:"",s[DG]&&(n.display="none"))}const EF=/\s*!important$/;function ES(s,e,i){if(Lt(i))i.forEach(n=>ES(s,e,n));else if(i==null&&(i=""),e.startsWith("--"))s.setProperty(e,i);else{const n=T0e(s,e);EF.test(i)?s.setProperty(Ea(n),i.replace(EF,""),"important"):s[n]=i}}const MF=["Webkit","Moz","ms"],NM={};function T0e(s,e){const i=NM[e];if(i)return i;let n=wo(e);if(n!=="filter"&&n in s)return NM[e]=n;n=hb(n);for(let r=0;r<MF.length;r++){const o=MF[r]+n;if(o in s)return NM[e]=o}return e}const kF="http://www.w3.org/1999/xlink";function A0e(s,e,i,n,r){if(n&&e.startsWith("xlink:"))i==null?s.removeAttributeNS(kF,e.slice(6,e.length)):s.setAttributeNS(kF,e,i);else{const o=ime(e);i==null||o&&!lH(i)?s.removeAttribute(e):s.setAttribute(e,o?"":i)}}function E0e(s,e,i,n,r,o,a){if(e==="innerHTML"||e==="textContent"){n&&a(n,r,o),s[e]=i??"";return}const l=s.tagName;if(e==="value"&&l!=="PROGRESS"&&!l.includes("-")){const d=l==="OPTION"?s.getAttribute("value")||"":s.value,f=i??"";(d!==f||!("_value"in s))&&(s.value=f),i==null&&s.removeAttribute(e),s._value=i;return}let h=!1;if(i===""||i==null){const d=typeof s[e];d==="boolean"?i=lH(i):i==null&&d==="string"?(i="",h=!0):d==="number"&&(i=0,h=!0)}try{s[e]=i}catch{}h&&s.removeAttribute(e)}function Gh(s,e,i,n){s.addEventListener(e,i,n)}function M0e(s,e,i,n){s.removeEventListener(e,i,n)}const PF=Symbol("_vei");function k0e(s,e,i,n,r=null){const o=s[PF]||(s[PF]={}),a=o[e];if(n&&a)a.value=n;else{const[l,h]=P0e(e);if(n){const d=o[e]=R0e(n,r);Gh(s,l,d,h)}else a&&(M0e(s,l,a,h),o[e]=void 0)}}const IF=/(?:Once|Passive|Capture)$/;function P0e(s){let e;if(IF.test(s)){e={};let n;for(;n=s.match(IF);)s=s.slice(0,s.length-n[0].length),e[n[0].toLowerCase()]=!0}return[s[2]===":"?s.slice(3):Ea(s.slice(2)),e]}let VM=0;const I0e=Promise.resolve(),B0e=()=>VM||(I0e.then(()=>VM=0),VM=Date.now());function R0e(s,e){const i=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=i.attached)return;Ra(D0e(n,i.value),e,5,[n])};return i.value=s,i.attached=B0e(),i}function D0e(s,e){if(Lt(e)){const i=s.stopImmediatePropagation;return s.stopImmediatePropagation=()=>{i.call(s),s._stopped=!0},e.map(n=>r=>!r._stopped&&n&&n(r))}else return e}const BF=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&s.charCodeAt(2)>96&&s.charCodeAt(2)<123,L0e=(s,e,i,n,r,o,a,l,h)=>{const d=r==="svg";e==="class"?b0e(s,n,d):e==="style"?C0e(s,i,n):cb(e)?YR(e)||k0e(s,e,i,n,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):N0e(s,e,n,d))?E0e(s,e,n,o,a,l,h):(e==="true-value"?s._trueValue=n:e==="false-value"&&(s._falseValue=n),A0e(s,e,n,d))};function N0e(s,e,i,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in s&&BF(e)&&yi(i));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&s.tagName==="INPUT"||e==="type"&&s.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=s.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return BF(e)&&hs(i)?!1:e in s}/*! #__NO_SIDE_EFFECTS__ */function VG(s,e){const i=fu(s);class n extends JT{constructor(o){super(i,o,e)}}return n.def=i,n}/*! #__NO_SIDE_EFFECTS__ */const V0e=s=>VG(s,jG),$0e=typeof HTMLElement<"u"?HTMLElement:class{};class JT extends $0e{constructor(e,i={},n){super(),this._def=e,this._props=i,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this._ob=null,this.shadowRoot&&n?n(this._createVNode(),this.shadowRoot):(this.attachShadow({mode:"open"}),this._def.__asyncLoader||this._resolveProps(this._def))}connectedCallback(){this._connected=!0,this._instance||(this._resolved?this._update():this._resolveDef())}disconnectedCallback(){this._connected=!1,this._ob&&(this._ob.disconnect(),this._ob=null),Ty(()=>{this._connected||(wC(null,this.shadowRoot),this._instance=null)})}_resolveDef(){this._resolved=!0;for(let n=0;n<this.attributes.length;n++)this._setAttr(this.attributes[n].name);this._ob=new MutationObserver(n=>{for(const r of n)this._setAttr(r.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(n,r=!1)=>{const{props:o,styles:a}=n;let l;if(o&&!Lt(o))for(const h in o){const d=o[h];(d===Number||d&&d.type===Number)&&(h in this._props&&(this._props[h]=hC(this._props[h])),(l||(l=Object.create(null)))[wo(h)]=!0)}this._numberProps=l,r&&this._resolveProps(n),this._applyStyles(a),this._update()},i=this._def.__asyncLoader;i?i().then(n=>e(n,!0)):e(this._def)}_resolveProps(e){const{props:i}=e,n=Lt(i)?i:Object.keys(i||{});for(const r of Object.keys(this))r[0]!=="_"&&n.includes(r)&&this._setProp(r,this[r],!0,!1);for(const r of n.map(wo))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(o){this._setProp(r,o)}})}_setAttr(e){let i=this.hasAttribute(e)?this.getAttribute(e):void 0;const n=wo(e);this._numberProps&&this._numberProps[n]&&(i=hC(i)),this._setProp(n,i,!1)}_getProp(e){return this._props[e]}_setProp(e,i,n=!0,r=!0){i!==this._props[e]&&(this._props[e]=i,r&&this._instance&&this._update(),n&&(i===!0?this.setAttribute(Ea(e),""):typeof i=="string"||typeof i=="number"?this.setAttribute(Ea(e),i+""):i||this.removeAttribute(Ea(e))))}_update(){wC(this._createVNode(),this.shadowRoot)}_createVNode(){const e=vt(this._def,ts({},this._props));return this._instance||(e.ce=i=>{this._instance=i,i.isCE=!0;const n=(o,a)=>{this.dispatchEvent(new CustomEvent(o,{detail:a}))};i.emit=(o,...a)=>{n(o,a),Ea(o)!==o&&n(Ea(o),a)};let r=this;for(;r=r&&(r.parentNode||r.host);)if(r instanceof JT){i.parent=r._instance,i.provides=r._instance.provides;break}}),e}_applyStyles(e){e&&e.forEach(i=>{const n=document.createElement("style");n.textContent=i,this.shadowRoot.appendChild(n)})}}function U0e(s="$style"){{const e=Na();if(!e)return kn;const i=e.type.__cssModules;if(!i)return kn;const n=i[s];return n||kn}}const $G=new WeakMap,UG=new WeakMap,_C=Symbol("_moveCb"),RF=Symbol("_enterCb"),FG={name:"TransitionGroup",props:ts({},v0e,{tag:String,moveClass:String}),setup(s,{slots:e}){const i=Na(),n=fD();let r,o;return qT(()=>{if(!r.length)return;const a=s.moveClass||`${s.name||"v"}-move`;if(!G0e(r[0].el,i.vnode.el,a))return;r.forEach(X0e),r.forEach(W0e);const l=r.filter(H0e);RG(),l.forEach(h=>{const d=h.el,f=d.style;Fh(d,a),f.transform=f.webkitTransform=f.transitionDuration="";const p=d[_C]=g=>{g&&g.target!==d||(!g||/transform$/.test(g.propertyName))&&(d.removeEventListener("transitionend",p),d[_C]=null,wd(d,a))};d.addEventListener("transitionend",p)})}),()=>{const a=un(s),l=IG(a);let h=a.tag||Un;if(r=[],o)for(let d=0;d<o.length;d++){const f=o[d];f.el&&f.el instanceof Element&&(r.push(f),om(f,K0(f,l,n,i)),$G.set(f,f.el.getBoundingClientRect()))}o=e.default?YT(e.default()):[];for(let d=0;d<o.length;d++){const f=o[d];f.key!=null&&om(f,K0(f,l,n,i))}return vt(h,null,o)}}},F0e=s=>delete s.mode;FG.props;const z0e=FG;function X0e(s){const e=s.el;e[_C]&&e[_C](),e[RF]&&e[RF]()}function W0e(s){UG.set(s,s.el.getBoundingClientRect())}function H0e(s){const e=$G.get(s),i=UG.get(s),n=e.left-i.left,r=e.top-i.top;if(n||r){const o=s.el.style;return o.transform=o.webkitTransform=`translate(${n}px,${r}px)`,o.transitionDuration="0s",s}}function G0e(s,e,i){const n=s.cloneNode(),r=s[J0];r&&r.forEach(l=>{l.split(/\s+/).forEach(h=>h&&n.classList.remove(h))}),i.split(/\s+/).forEach(l=>l&&n.classList.add(l)),n.style.display="none";const o=e.nodeType===1?e:e.parentNode;o.appendChild(n);const{hasTransform:a}=BG(n);return o.removeChild(n),a}const ef=s=>{const e=s.props["onUpdate:modelValue"]||!1;return Lt(e)?i=>S0(e,i):e};function Q0e(s){s.target.composing=!0}function DF(s){const e=s.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const pl=Symbol("_assign"),bC={created(s,{modifiers:{lazy:e,trim:i,number:n}},r){s[pl]=ef(r);const o=n||r.props&&r.props.type==="number";Gh(s,e?"change":"input",a=>{if(a.target.composing)return;let l=s.value;i&&(l=l.trim()),o&&(l=cC(l)),s[pl](l)}),i&&Gh(s,"change",()=>{s.value=s.value.trim()}),e||(Gh(s,"compositionstart",Q0e),Gh(s,"compositionend",DF),Gh(s,"change",DF))},mounted(s,{value:e}){s.value=e??""},beforeUpdate(s,{value:e,modifiers:{lazy:i,trim:n,number:r}},o){if(s[pl]=ef(o),s.composing)return;const a=(r||s.type==="number")&&!/^0\d/.test(s.value)?cC(s.value):s.value,l=e??"";a!==l&&(document.activeElement===s&&s.type!=="range"&&(i||n&&s.value.trim()===l)||(s.value=l))}},OD={deep:!0,created(s,e,i){s[pl]=ef(i),Gh(s,"change",()=>{const n=s._modelValue,r=ey(s),o=s.checked,a=s[pl];if(Lt(n)){const l=VT(n,r),h=l!==-1;if(o&&!h)a(n.concat(r));else if(!o&&h){const d=[...n];d.splice(l,1),a(d)}}else if(Cm(n)){const l=new Set(n);o?l.add(r):l.delete(r),a(l)}else a(XG(s,o))})},mounted:LF,beforeUpdate(s,e,i){s[pl]=ef(i),LF(s,e,i)}};function LF(s,{value:e,oldValue:i},n){s._modelValue=e,Lt(e)?s.checked=VT(e,n.props.value)>-1:Cm(e)?s.checked=e.has(n.props.value):e!==i&&(s.checked=Kd(e,XG(s,!0)))}const SD={created(s,{value:e},i){s.checked=Kd(e,i.props.value),s[pl]=ef(i),Gh(s,"change",()=>{s[pl](ey(s))})},beforeUpdate(s,{value:e,oldValue:i},n){s[pl]=ef(n),e!==i&&(s.checked=Kd(e,n.props.value))}},zG={deep:!0,created(s,{value:e,modifiers:{number:i}},n){const r=Cm(e);Gh(s,"change",()=>{const o=Array.prototype.filter.call(s.options,a=>a.selected).map(a=>i?cC(ey(a)):ey(a));s[pl](s.multiple?r?new Set(o):o:o[0]),s._assigning=!0,Ty(()=>{s._assigning=!1})}),s[pl]=ef(n)},mounted(s,{value:e,modifiers:{number:i}}){NF(s,e)},beforeUpdate(s,e,i){s[pl]=ef(i)},updated(s,{value:e,modifiers:{number:i}}){s._assigning||NF(s,e)}};function NF(s,e,i){const n=s.multiple,r=Lt(e);if(!(n&&!r&&!Cm(e))){for(let o=0,a=s.options.length;o<a;o++){const l=s.options[o],h=ey(l);if(n)if(r){const d=typeof h;d==="string"||d==="number"?l.selected=e.some(f=>String(f)===String(h)):l.selected=VT(e,h)>-1}else l.selected=e.has(h);else if(Kd(ey(l),e)){s.selectedIndex!==o&&(s.selectedIndex=o);return}}!n&&s.selectedIndex!==-1&&(s.selectedIndex=-1)}}function ey(s){return"_value"in s?s._value:s.value}function XG(s,e){const i=e?"_trueValue":"_falseValue";return i in s?s[i]:e}const WG={created(s,e,i){Jw(s,e,i,null,"created")},mounted(s,e,i){Jw(s,e,i,null,"mounted")},beforeUpdate(s,e,i,n){Jw(s,e,i,n,"beforeUpdate")},updated(s,e,i,n){Jw(s,e,i,n,"updated")}};function HG(s,e){switch(s){case"SELECT":return zG;case"TEXTAREA":return bC;default:switch(e){case"checkbox":return OD;case"radio":return SD;default:return bC}}}function Jw(s,e,i,n,r){const a=HG(s.tagName,i.props&&i.props.type)[r];a&&a(s,e,i,n)}function Y0e(){bC.getSSRProps=({value:s})=>({value:s}),SD.getSSRProps=({value:s},e)=>{if(e.props&&Kd(e.props.value,s))return{checked:!0}},OD.getSSRProps=({value:s},e)=>{if(Lt(s)){if(e.props&&VT(s,e.props.value)>-1)return{checked:!0}}else if(Cm(s)){if(e.props&&s.has(e.props.value))return{checked:!0}}else if(s)return{checked:!0}},WG.getSSRProps=(s,e)=>{if(typeof e.type!="string")return;const i=HG(e.type.toUpperCase(),e.props&&e.props.type);if(i.getSSRProps)return i.getSSRProps(s,e)}}const j0e=["ctrl","shift","alt","meta"],q0e={stop:s=>s.stopPropagation(),prevent:s=>s.preventDefault(),self:s=>s.target!==s.currentTarget,ctrl:s=>!s.ctrlKey,shift:s=>!s.shiftKey,alt:s=>!s.altKey,meta:s=>!s.metaKey,left:s=>"button"in s&&s.button!==0,middle:s=>"button"in s&&s.button!==1,right:s=>"button"in s&&s.button!==2,exact:(s,e)=>j0e.some(i=>s[`${i}Key`]&&!e.includes(i))},Z0e=(s,e)=>{const i=s._withMods||(s._withMods={}),n=e.join(".");return i[n]||(i[n]=(r,...o)=>{for(let a=0;a<e.length;a++){const l=q0e[e[a]];if(l&&l(r,e))return}return s(r,...o)})},K0e={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},J0e=(s,e)=>{const i=s._withKeys||(s._withKeys={}),n=e.join(".");return i[n]||(i[n]=r=>{if(!("key"in r))return;const o=Ea(r.key);if(e.some(a=>a===o||K0e[a]===o))return s(r)})},GG=ts({patchProp:L0e},y0e);let Fx,VF=!1;function QG(){return Fx||(Fx=vD(GG))}function YG(){return Fx=VF?Fx:mG(GG),VF=!0,Fx}const wC=(...s)=>{QG().render(...s)},jG=(...s)=>{YG().hydrate(...s)},qG=(...s)=>{const e=QG().createApp(...s),{mount:i}=e;return e.mount=n=>{const r=KG(n);if(!r)return;const o=e._component;!yi(o)&&!o.render&&!o.template&&(o.template=r.innerHTML),r.innerHTML="";const a=i(r,!1,ZG(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),a},e},eye=(...s)=>{const e=YG().createApp(...s),{mount:i}=e;return e.mount=n=>{const r=KG(n);if(r)return i(r,!0,ZG(r))},e};function ZG(s){if(s instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&s instanceof MathMLElement)return"mathml"}function KG(s){return hs(s)?document.querySelector(s):s}let $F=!1;const tye=()=>{$F||($F=!0,Y0e(),w0e())};/**
* vue v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const iye=()=>{},nye=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:WH,BaseTransitionPropsValidators:pD,Comment:Dr,DeprecationTypes:p0e,EffectScope:KR,ErrorCodes:Ume,ErrorTypeStrings:a0e,Fragment:Un,KeepAlive:uge,ReactiveEffect:q0,Static:Gp,Suspense:NH,Teleport:Gge,Text:am,TrackOpTypes:Nme,Transition:wD,TransitionGroup:z0e,TriggerOpTypes:Vme,VueElement:JT,assertNumber:$me,callWithAsyncErrorHandling:Ra,callWithErrorHandling:su,camelize:wo,capitalize:hb,cloneVNode:ih,compatUtils:f0e,compile:iye,computed:Es,createApp:qG,createBlock:Ir,createCommentVNode:cm,createElementBlock:hn,createElementVNode:Kt,createHydrationRenderer:mG,createPropsRestProxy:Cge,createRenderer:vD,createSSRApp:eye,createSlots:fge,createStaticVNode:jge,createTextVNode:As,createVNode:vt,customRef:aD,defineAsyncComponent:cge,defineComponent:fu,defineCustomElement:VG,defineEmits:yge,defineExpose:vge,defineModel:bge,defineOptions:xge,defineProps:gge,defineSSRCustomElement:V0e,defineSlots:_ge,devtools:l0e,effect:ome,effectScope:sme,getCurrentInstance:Na,getCurrentScope:$T,getTransitionRawChildren:YT,guardReactiveProps:_D,h:vC,handleError:Am,hasInjectionContext:Bge,hydrate:jG,initCustomFormatter:s0e,initDirectivesForSSR:tye,inject:k0,isMemoSame:MG,isProxy:nD,isReactive:C0,isReadonly:Z0,isRef:Ys,isRuntimeOnly:e0e,isShallow:o_,isVNode:Jd,markRaw:CH,mergeDefaults:Oge,mergeModels:Sge,mergeProps:OG,nextTick:Ty,normalizeClass:Cy,normalizeProps:aH,normalizeStyle:Au,onActivated:GH,onBeforeMount:jH,onBeforeUnmount:ZT,onBeforeUpdate:qH,onDeactivated:QH,onErrorCaptured:eG,onMounted:io,onRenderTracked:JH,onRenderTriggered:KH,onScopeDispose:JR,onServerPrefetch:ZH,onUnmounted:ra,onUpdated:qT,openBlock:di,popScopeId:QT,provide:f_,proxyRefs:oD,pushScopeId:GT,queuePostFlushCb:dC,reactive:Tm,readonly:rm,ref:gt,registerRuntimeCompiler:Jge,render:wC,renderList:th,renderSlot:tG,resolveComponent:Bn,resolveDirective:Jme,resolveDynamicComponent:DH,resolveFilter:d0e,resolveTransitionHooks:K0,setBlockTracking:W2,setDevtoolsHook:c0e,setTransitionHooks:om,shallowReactive:SH,shallowReadonly:Ame,shallowRef:jr,ssrContextKey:$H,ssrUtils:u0e,stop:ame,toDisplayString:ea,toHandlerKey:Nx,toHandlers:pge,toRaw:un,toRef:Lme,toRefs:ub,toValue:Pme,transformVNodeArgs:Qge,triggerRef:kme,unref:ni,useAttrs:nG,useCssModule:U0e,useCssVars:O0e,useModel:n0e,useSSRContext:UH,useSlots:mD,useTransitionState:fD,vModelCheckbox:OD,vModelDynamic:WG,vModelRadio:SD,vModelSelect:zG,vModelText:bC,vShow:LG,version:kG,warn:o0e,watch:an,watchEffect:ru,watchPostEffect:FH,watchSyncEffect:zH,withAsyncContext:TS,withCtx:Zt,withDefaults:wge,withDirectives:age,withKeys:J0e,withMemo:r0e,withModifiers:Z0e,withScopeId:Qme},Symbol.toStringTag,{value:"Module"})),eA=(s,e)=>{const i=s.__vccOpts||s;for(const[n,r]of e)i[n]=r;return i};var Em=(s=>(s[s.WEBGL_LEGACY=0]="WEBGL_LEGACY",s[s.WEBGL=1]="WEBGL",s[s.WEBGL2=2]="WEBGL2",s))(Em||{}),JG=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.WEBGL=1]="WEBGL",s[s.CANVAS=2]="CANVAS",s))(JG||{}),K2=(s=>(s[s.COLOR=16384]="COLOR",s[s.DEPTH=256]="DEPTH",s[s.STENCIL=1024]="STENCIL",s))(K2||{}),mi=(s=>(s[s.NORMAL=0]="NORMAL",s[s.ADD=1]="ADD",s[s.MULTIPLY=2]="MULTIPLY",s[s.SCREEN=3]="SCREEN",s[s.OVERLAY=4]="OVERLAY",s[s.DARKEN=5]="DARKEN",s[s.LIGHTEN=6]="LIGHTEN",s[s.COLOR_DODGE=7]="COLOR_DODGE",s[s.COLOR_BURN=8]="COLOR_BURN",s[s.HARD_LIGHT=9]="HARD_LIGHT",s[s.SOFT_LIGHT=10]="SOFT_LIGHT",s[s.DIFFERENCE=11]="DIFFERENCE",s[s.EXCLUSION=12]="EXCLUSION",s[s.HUE=13]="HUE",s[s.SATURATION=14]="SATURATION",s[s.COLOR=15]="COLOR",s[s.LUMINOSITY=16]="LUMINOSITY",s[s.NORMAL_NPM=17]="NORMAL_NPM",s[s.ADD_NPM=18]="ADD_NPM",s[s.SCREEN_NPM=19]="SCREEN_NPM",s[s.NONE=20]="NONE",s[s.SRC_OVER=0]="SRC_OVER",s[s.SRC_IN=21]="SRC_IN",s[s.SRC_OUT=22]="SRC_OUT",s[s.SRC_ATOP=23]="SRC_ATOP",s[s.DST_OVER=24]="DST_OVER",s[s.DST_IN=25]="DST_IN",s[s.DST_OUT=26]="DST_OUT",s[s.DST_ATOP=27]="DST_ATOP",s[s.ERASE=26]="ERASE",s[s.SUBTRACT=28]="SUBTRACT",s[s.XOR=29]="XOR",s))(mi||{}),Gc=(s=>(s[s.POINTS=0]="POINTS",s[s.LINES=1]="LINES",s[s.LINE_LOOP=2]="LINE_LOOP",s[s.LINE_STRIP=3]="LINE_STRIP",s[s.TRIANGLES=4]="TRIANGLES",s[s.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",s[s.TRIANGLE_FAN=6]="TRIANGLE_FAN",s))(Gc||{}),rt=(s=>(s[s.RGBA=6408]="RGBA",s[s.RGB=6407]="RGB",s[s.RG=33319]="RG",s[s.RED=6403]="RED",s[s.RGBA_INTEGER=36249]="RGBA_INTEGER",s[s.RGB_INTEGER=36248]="RGB_INTEGER",s[s.RG_INTEGER=33320]="RG_INTEGER",s[s.RED_INTEGER=36244]="RED_INTEGER",s[s.ALPHA=6406]="ALPHA",s[s.LUMINANCE=6409]="LUMINANCE",s[s.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",s[s.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",s[s.DEPTH_STENCIL=34041]="DEPTH_STENCIL",s))(rt||{}),P0=(s=>(s[s.TEXTURE_2D=3553]="TEXTURE_2D",s[s.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",s[s.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",s[s.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",s[s.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",s[s.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",s[s.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",s))(P0||{}),qt=(s=>(s[s.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",s[s.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",s[s.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",s[s.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",s[s.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",s[s.UNSIGNED_INT=5125]="UNSIGNED_INT",s[s.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",s[s.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",s[s.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",s[s.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",s[s.BYTE=5120]="BYTE",s[s.SHORT=5122]="SHORT",s[s.INT=5124]="INT",s[s.FLOAT=5126]="FLOAT",s[s.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",s[s.HALF_FLOAT=36193]="HALF_FLOAT",s))(qt||{}),Mt=(s=>(s[s.FLOAT=0]="FLOAT",s[s.INT=1]="INT",s[s.UINT=2]="UINT",s))(Mt||{}),jh=(s=>(s[s.NEAREST=0]="NEAREST",s[s.LINEAR=1]="LINEAR",s))(jh||{}),Qd=(s=>(s[s.CLAMP=33071]="CLAMP",s[s.REPEAT=10497]="REPEAT",s[s.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",s))(Qd||{}),nh=(s=>(s[s.OFF=0]="OFF",s[s.POW2=1]="POW2",s[s.ON=2]="ON",s[s.ON_MANUAL=3]="ON_MANUAL",s))(nh||{}),Yo=(s=>(s[s.NPM=0]="NPM",s[s.UNPACK=1]="UNPACK",s[s.PMA=2]="PMA",s[s.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",s[s.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",s[s.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",s))(Yo||{}),Uc=(s=>(s[s.NO=0]="NO",s[s.YES=1]="YES",s[s.AUTO=2]="AUTO",s[s.BLEND=0]="BLEND",s[s.CLEAR=1]="CLEAR",s[s.BLIT=2]="BLIT",s))(Uc||{}),CD=(s=>(s[s.AUTO=0]="AUTO",s[s.MANUAL=1]="MANUAL",s))(CD||{}),ll=(s=>(s.LOW="lowp",s.MEDIUM="mediump",s.HIGH="highp",s))(ll||{}),ir=(s=>(s[s.NONE=0]="NONE",s[s.SCISSOR=1]="SCISSOR",s[s.STENCIL=2]="STENCIL",s[s.SPRITE=3]="SPRITE",s[s.COLOR=4]="COLOR",s))(ir||{}),Hs=(s=>(s[s.NONE=0]="NONE",s[s.LOW=2]="LOW",s[s.MEDIUM=4]="MEDIUM",s[s.HIGH=8]="HIGH",s))(Hs||{}),Zc=(s=>(s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",s[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",s))(Zc||{});const sye={createCanvas:(s,e)=>{const i=document.createElement("canvas");return i.width=s,i.height=e,i},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,e)=>fetch(s,e),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")},kt={ADAPTER:sye,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var $M=/iPhone/i,UF=/iPod/i,FF=/iPad/i,zF=/\biOS-universal(?:.+)Mac\b/i,UM=/\bAndroid(?:.+)Mobile\b/i,XF=/Android/i,rg=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,e1=/Silk/i,Sh=/Windows Phone/i,WF=/\bWindows(?:.+)ARM\b/i,HF=/BlackBerry/i,GF=/BB10/i,QF=/Opera Mini/i,YF=/\b(CriOS|Chrome)(?:.+)Mobile/i,jF=/Mobile(?:.+)Firefox\b/i,qF=function(s){return typeof s<"u"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream>"u"};function rye(s){return function(e){return e.test(s)}}function ZF(s){var e={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?e.userAgent=s:s&&s.userAgent&&(e={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var i=e.userAgent,n=i.split("[FBAN");typeof n[1]<"u"&&(i=n[0]),n=i.split("Twitter"),typeof n[1]<"u"&&(i=n[0]);var r=rye(i),o={apple:{phone:r($M)&&!r(Sh),ipod:r(UF),tablet:!r($M)&&(r(FF)||qF(e))&&!r(Sh),universal:r(zF),device:(r($M)||r(UF)||r(FF)||r(zF)||qF(e))&&!r(Sh)},amazon:{phone:r(rg),tablet:!r(rg)&&r(e1),device:r(rg)||r(e1)},android:{phone:!r(Sh)&&r(rg)||!r(Sh)&&r(UM),tablet:!r(Sh)&&!r(rg)&&!r(UM)&&(r(e1)||r(XF)),device:!r(Sh)&&(r(rg)||r(e1)||r(UM)||r(XF))||r(/\bokhttp\b/i)},windows:{phone:r(Sh),tablet:r(WF),device:r(Sh)||r(WF)},other:{blackberry:r(HF),blackberry10:r(GF),opera:r(QF),firefox:r(jF),chrome:r(YF),device:r(HF)||r(GF)||r(QF)||r(jF)||r(YF)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const oye=ZF.default??ZF,qh=oye(globalThis.navigator);kt.RETINA_PREFIX=/@([0-9\.]+)x/;kt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ou=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function TD(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function eQ(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var i=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var r=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(i,n,r.get?r:{enumerable:!0,get:function(){return s[n]}})}),i}var tQ={exports:{}};(function(s){var e=Object.prototype.hasOwnProperty,i="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(i=!1));function r(h,d,f){this.fn=h,this.context=d,this.once=f||!1}function o(h,d,f,p,g){if(typeof f!="function")throw new TypeError("The listener must be a function");var y=new r(f,p||h,g),x=i?i+d:d;return h._events[x]?h._events[x].fn?h._events[x]=[h._events[x],y]:h._events[x].push(y):(h._events[x]=y,h._eventsCount++),h}function a(h,d){--h._eventsCount===0?h._events=new n:delete h._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],f,p;if(this._eventsCount===0)return d;for(p in f=this._events)e.call(f,p)&&d.push(i?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},l.prototype.listeners=function(d){var f=i?i+d:d,p=this._events[f];if(!p)return[];if(p.fn)return[p.fn];for(var g=0,y=p.length,x=new Array(y);g<y;g++)x[g]=p[g].fn;return x},l.prototype.listenerCount=function(d){var f=i?i+d:d,p=this._events[f];return p?p.fn?1:p.length:0},l.prototype.emit=function(d,f,p,g,y,x){var _=i?i+d:d;if(!this._events[_])return!1;var w=this._events[_],O=arguments.length,T,C;if(w.fn){switch(w.once&&this.removeListener(d,w.fn,void 0,!0),O){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,f),!0;case 3:return w.fn.call(w.context,f,p),!0;case 4:return w.fn.call(w.context,f,p,g),!0;case 5:return w.fn.call(w.context,f,p,g,y),!0;case 6:return w.fn.call(w.context,f,p,g,y,x),!0}for(C=1,T=new Array(O-1);C<O;C++)T[C-1]=arguments[C];w.fn.apply(w.context,T)}else{var A=w.length,B;for(C=0;C<A;C++)switch(w[C].once&&this.removeListener(d,w[C].fn,void 0,!0),O){case 1:w[C].fn.call(w[C].context);break;case 2:w[C].fn.call(w[C].context,f);break;case 3:w[C].fn.call(w[C].context,f,p);break;case 4:w[C].fn.call(w[C].context,f,p,g);break;default:if(!T)for(B=1,T=new Array(O-1);B<O;B++)T[B-1]=arguments[B];w[C].fn.apply(w[C].context,T)}}return!0},l.prototype.on=function(d,f,p){return o(this,d,f,p,!1)},l.prototype.once=function(d,f,p){return o(this,d,f,p,!0)},l.prototype.removeListener=function(d,f,p,g){var y=i?i+d:d;if(!this._events[y])return this;if(!f)return a(this,y),this;var x=this._events[y];if(x.fn)x.fn===f&&(!g||x.once)&&(!p||x.context===p)&&a(this,y);else{for(var _=0,w=[],O=x.length;_<O;_++)(x[_].fn!==f||g&&!x[_].once||p&&x[_].context!==p)&&w.push(x[_]);w.length?this._events[y]=w.length===1?w[0]:w:a(this,y)}return this},l.prototype.removeAllListeners=function(d){var f;return d?(f=i?i+d:d,this._events[f]&&a(this,f)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=i,l.EventEmitter=l,s.exports=l})(tQ);var aye=tQ.exports;const mb=TD(aye);var AD={exports:{}};AD.exports=tA;AD.exports.default=tA;function tA(s,e,i){i=i||2;var n=e&&e.length,r=n?e[0]*i:s.length,o=iQ(s,0,r,i,!0),a=[];if(!o||o.next===o.prev)return a;var l,h,d,f,p,g,y;if(n&&(o=dye(s,e,o,i)),s.length>80*i){l=d=s[0],h=f=s[1];for(var x=i;x<r;x+=i)p=s[x],g=s[x+1],p<l&&(l=p),g<h&&(h=g),p>d&&(d=p),g>f&&(f=g);y=Math.max(d-l,f-h),y=y!==0?32767/y:0}return p_(o,a,i,l,h,y,0),a}function iQ(s,e,i,n,r){var o,a;if(r===tI(s,e,i,n)>0)for(o=e;o<i;o+=n)a=KF(o,s[o],s[o+1],a);else for(o=i-n;o>=e;o-=n)a=KF(o,s[o],s[o+1],a);return a&&iA(a,a.next)&&(g_(a),a=a.next),a}function um(s,e){if(!s)return s;e||(e=s);var i=s,n;do if(n=!1,!i.steiner&&(iA(i,i.next)||ms(i.prev,i,i.next)===0)){if(g_(i),i=e=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==e);return e}function p_(s,e,i,n,r,o,a){if(s){!a&&o&&yye(s,n,r,o);for(var l=s,h,d;s.prev!==s.next;){if(h=s.prev,d=s.next,o?cye(s,n,r,o):lye(s)){e.push(h.i/i|0),e.push(s.i/i|0),e.push(d.i/i|0),g_(s),s=d.next,l=d.next;continue}if(s=d,s===l){a?a===1?(s=hye(um(s),e,i),p_(s,e,i,n,r,o,2)):a===2&&uye(s,e,i,n,r,o):p_(um(s),e,i,n,r,o,1);break}}}}function lye(s){var e=s.prev,i=s,n=s.next;if(ms(e,i,n)>=0)return!1;for(var r=e.x,o=i.x,a=n.x,l=e.y,h=i.y,d=n.y,f=r<o?r<a?r:a:o<a?o:a,p=l<h?l<d?l:d:h<d?h:d,g=r>o?r>a?r:a:o>a?o:a,y=l>h?l>d?l:d:h>d?h:d,x=n.next;x!==e;){if(x.x>=f&&x.x<=g&&x.y>=p&&x.y<=y&&c0(r,l,o,h,a,d,x.x,x.y)&&ms(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function cye(s,e,i,n){var r=s.prev,o=s,a=s.next;if(ms(r,o,a)>=0)return!1;for(var l=r.x,h=o.x,d=a.x,f=r.y,p=o.y,g=a.y,y=l<h?l<d?l:d:h<d?h:d,x=f<p?f<g?f:g:p<g?p:g,_=l>h?l>d?l:d:h>d?h:d,w=f>p?f>g?f:g:p>g?p:g,O=J2(y,x,e,i,n),T=J2(_,w,e,i,n),C=s.prevZ,A=s.nextZ;C&&C.z>=O&&A&&A.z<=T;){if(C.x>=y&&C.x<=_&&C.y>=x&&C.y<=w&&C!==r&&C!==a&&c0(l,f,h,p,d,g,C.x,C.y)&&ms(C.prev,C,C.next)>=0||(C=C.prevZ,A.x>=y&&A.x<=_&&A.y>=x&&A.y<=w&&A!==r&&A!==a&&c0(l,f,h,p,d,g,A.x,A.y)&&ms(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;C&&C.z>=O;){if(C.x>=y&&C.x<=_&&C.y>=x&&C.y<=w&&C!==r&&C!==a&&c0(l,f,h,p,d,g,C.x,C.y)&&ms(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;A&&A.z<=T;){if(A.x>=y&&A.x<=_&&A.y>=x&&A.y<=w&&A!==r&&A!==a&&c0(l,f,h,p,d,g,A.x,A.y)&&ms(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function hye(s,e,i){var n=s;do{var r=n.prev,o=n.next.next;!iA(r,o)&&nQ(r,n,n.next,o)&&m_(r,o)&&m_(o,r)&&(e.push(r.i/i|0),e.push(n.i/i|0),e.push(o.i/i|0),g_(n),g_(n.next),n=s=o),n=n.next}while(n!==s);return um(n)}function uye(s,e,i,n,r,o){var a=s;do{for(var l=a.next.next;l!==a.prev;){if(a.i!==l.i&&_ye(a,l)){var h=sQ(a,l);a=um(a,a.next),h=um(h,h.next),p_(a,e,i,n,r,o,0),p_(h,e,i,n,r,o,0);return}l=l.next}a=a.next}while(a!==s)}function dye(s,e,i,n){var r=[],o,a,l,h,d;for(o=0,a=e.length;o<a;o++)l=e[o]*n,h=o<a-1?e[o+1]*n:s.length,d=iQ(s,l,h,n,!1),d===d.next&&(d.steiner=!0),r.push(xye(d));for(r.sort(fye),o=0;o<r.length;o++)i=pye(r[o],i);return i}function fye(s,e){return s.x-e.x}function pye(s,e){var i=mye(s,e);if(!i)return e;var n=sQ(i,s);return um(n,n.next),um(i,i.next)}function mye(s,e){var i=e,n=s.x,r=s.y,o=-1/0,a;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var l=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(l<=n&&l>o&&(o=l,a=i.x<i.next.x?i:i.next,l===n))return a}i=i.next}while(i!==e);if(!a)return null;var h=a,d=a.x,f=a.y,p=1/0,g;i=a;do n>=i.x&&i.x>=d&&n!==i.x&&c0(r<f?n:o,r,d,f,r<f?o:n,r,i.x,i.y)&&(g=Math.abs(r-i.y)/(n-i.x),m_(i,s)&&(g<p||g===p&&(i.x>a.x||i.x===a.x&&gye(a,i)))&&(a=i,p=g)),i=i.next;while(i!==h);return a}function gye(s,e){return ms(s.prev,s,e.prev)<0&&ms(e.next,s,s.next)<0}function yye(s,e,i,n){var r=s;do r.z===0&&(r.z=J2(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,vye(r)}function vye(s){var e,i,n,r,o,a,l,h,d=1;do{for(i=s,s=null,o=null,a=0;i;){for(a++,n=i,l=0,e=0;e<d&&(l++,n=n.nextZ,!!n);e++);for(h=d;l>0||h>0&&n;)l!==0&&(h===0||!n||i.z<=n.z)?(r=i,i=i.nextZ,l--):(r=n,n=n.nextZ,h--),o?o.nextZ=r:s=r,r.prevZ=o,o=r;i=n}o.nextZ=null,d*=2}while(a>1);return s}function J2(s,e,i,n,r){return s=(s-i)*r|0,e=(e-n)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function xye(s){var e=s,i=s;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==s);return i}function c0(s,e,i,n,r,o,a,l){return(r-a)*(e-l)>=(s-a)*(o-l)&&(s-a)*(n-l)>=(i-a)*(e-l)&&(i-a)*(o-l)>=(r-a)*(n-l)}function _ye(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!bye(s,e)&&(m_(s,e)&&m_(e,s)&&wye(s,e)&&(ms(s.prev,s,e.prev)||ms(s,e.prev,e))||iA(s,e)&&ms(s.prev,s,s.next)>0&&ms(e.prev,e,e.next)>0)}function ms(s,e,i){return(e.y-s.y)*(i.x-e.x)-(e.x-s.x)*(i.y-e.y)}function iA(s,e){return s.x===e.x&&s.y===e.y}function nQ(s,e,i,n){var r=i1(ms(s,e,i)),o=i1(ms(s,e,n)),a=i1(ms(i,n,s)),l=i1(ms(i,n,e));return!!(r!==o&&a!==l||r===0&&t1(s,i,e)||o===0&&t1(s,n,e)||a===0&&t1(i,s,n)||l===0&&t1(i,e,n))}function t1(s,e,i){return e.x<=Math.max(s.x,i.x)&&e.x>=Math.min(s.x,i.x)&&e.y<=Math.max(s.y,i.y)&&e.y>=Math.min(s.y,i.y)}function i1(s){return s>0?1:s<0?-1:0}function bye(s,e){var i=s;do{if(i.i!==s.i&&i.next.i!==s.i&&i.i!==e.i&&i.next.i!==e.i&&nQ(i,i.next,s,e))return!0;i=i.next}while(i!==s);return!1}function m_(s,e){return ms(s.prev,s,s.next)<0?ms(s,e,s.next)>=0&&ms(s,s.prev,e)>=0:ms(s,e,s.prev)<0||ms(s,s.next,e)<0}function wye(s,e){var i=s,n=!1,r=(s.x+e.x)/2,o=(s.y+e.y)/2;do i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==s);return n}function sQ(s,e){var i=new eI(s.i,s.x,s.y),n=new eI(e.i,e.x,e.y),r=s.next,o=e.prev;return s.next=e,e.prev=s,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function KF(s,e,i,n){var r=new eI(s,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function g_(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function eI(s,e,i){this.i=s,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}tA.deviation=function(s,e,i,n){var r=e&&e.length,o=r?e[0]*i:s.length,a=Math.abs(tI(s,0,o,i));if(r)for(var l=0,h=e.length;l<h;l++){var d=e[l]*i,f=l<h-1?e[l+1]*i:s.length;a-=Math.abs(tI(s,d,f,i))}var p=0;for(l=0;l<n.length;l+=3){var g=n[l]*i,y=n[l+1]*i,x=n[l+2]*i;p+=Math.abs((s[g]-s[x])*(s[y+1]-s[g+1])-(s[g]-s[y])*(s[x+1]-s[g+1]))}return a===0&&p===0?0:Math.abs((p-a)/a)};function tI(s,e,i,n){for(var r=0,o=e,a=i-n;o<i;o+=n)r+=(s[a]-s[o])*(s[o+1]+s[a+1]),a=o;return r}tA.flatten=function(s){for(var e=s[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<s.length;r++){for(var o=0;o<s[r].length;o++)for(var a=0;a<e;a++)i.vertices.push(s[r][o][a]);r>0&&(n+=s[r-1].length,i.holes.push(n))}return i};var Oye=AD.exports;const Sye=TD(Oye);var OC={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */OC.exports;(function(s,e){(function(i){var n=e&&!e.nodeType&&e,r=s&&!s.nodeType&&s,o=typeof ou=="object"&&ou;(o.global===o||o.window===o||o.self===o)&&(i=o);var a,l=2147483647,h=36,d=1,f=26,p=38,g=700,y=72,x=128,_="-",w=/^xn--/,O=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=h-d,B=Math.floor,I=String.fromCharCode,R;function P(oe){throw new RangeError(C[oe])}function k(oe,pe){for(var Ue=oe.length,tt=[];Ue--;)tt[Ue]=pe(oe[Ue]);return tt}function E(oe,pe){var Ue=oe.split("@"),tt="";Ue.length>1&&(tt=Ue[0]+"@",oe=Ue[1]),oe=oe.replace(T,".");var ve=oe.split("."),Re=k(ve,pe).join(".");return tt+Re}function D(oe){for(var pe=[],Ue=0,tt=oe.length,ve,Re;Ue<tt;)ve=oe.charCodeAt(Ue++),ve>=55296&&ve<=56319&&Ue<tt?(Re=oe.charCodeAt(Ue++),(Re&64512)==56320?pe.push(((ve&1023)<<10)+(Re&1023)+65536):(pe.push(ve),Ue--)):pe.push(ve);return pe}function L(oe){return k(oe,function(pe){var Ue="";return pe>65535&&(pe-=65536,Ue+=I(pe>>>10&1023|55296),pe=56320|pe&1023),Ue+=I(pe),Ue}).join("")}function V(oe){return oe-48<10?oe-22:oe-65<26?oe-65:oe-97<26?oe-97:h}function F(oe,pe){return oe+22+75*(oe<26)-((pe!=0)<<5)}function j(oe,pe,Ue){var tt=0;for(oe=Ue?B(oe/g):oe>>1,oe+=B(oe/pe);oe>A*f>>1;tt+=h)oe=B(oe/A);return B(tt+(A+1)*oe/(oe+p))}function Q(oe){var pe=[],Ue=oe.length,tt,ve=0,Re=x,Le=y,De,Se,Y,W,te,ae,z,q,le;for(De=oe.lastIndexOf(_),De<0&&(De=0),Se=0;Se<De;++Se)oe.charCodeAt(Se)>=128&&P("not-basic"),pe.push(oe.charCodeAt(Se));for(Y=De>0?De+1:0;Y<Ue;){for(W=ve,te=1,ae=h;Y>=Ue&&P("invalid-input"),z=V(oe.charCodeAt(Y++)),(z>=h||z>B((l-ve)/te))&&P("overflow"),ve+=z*te,q=ae<=Le?d:ae>=Le+f?f:ae-Le,!(z<q);ae+=h)le=h-q,te>B(l/le)&&P("overflow"),te*=le;tt=pe.length+1,Le=j(ve-W,tt,W==0),B(ve/tt)>l-Re&&P("overflow"),Re+=B(ve/tt),ve%=tt,pe.splice(ve++,0,Re)}return L(pe)}function ee(oe){var pe,Ue,tt,ve,Re,Le,De,Se,Y,W,te,ae=[],z,q,le,he;for(oe=D(oe),z=oe.length,pe=x,Ue=0,Re=y,Le=0;Le<z;++Le)te=oe[Le],te<128&&ae.push(I(te));for(tt=ve=ae.length,ve&&ae.push(_);tt<z;){for(De=l,Le=0;Le<z;++Le)te=oe[Le],te>=pe&&te<De&&(De=te);for(q=tt+1,De-pe>B((l-Ue)/q)&&P("overflow"),Ue+=(De-pe)*q,pe=De,Le=0;Le<z;++Le)if(te=oe[Le],te<pe&&++Ue>l&&P("overflow"),te==pe){for(Se=Ue,Y=h;W=Y<=Re?d:Y>=Re+f?f:Y-Re,!(Se<W);Y+=h)he=Se-W,le=h-W,ae.push(I(F(W+he%le,0))),Se=B(he/le);ae.push(I(F(Se,0))),Re=j(Ue,q,tt==ve),Ue=0,++tt}++Ue,++pe}return ae.join("")}function J(oe){return E(oe,function(pe){return w.test(pe)?Q(pe.slice(4).toLowerCase()):pe})}function ue(oe){return E(oe,function(pe){return O.test(pe)?"xn--"+ee(pe):pe})}if(a={version:"1.4.1",ucs2:{decode:D,encode:L},decode:Q,encode:ee,toASCII:ue,toUnicode:J},n&&r)if(s.exports==n)r.exports=a;else for(R in a)a.hasOwnProperty(R)&&(n[R]=a[R]);else i.punycode=a})(ou)})(OC,OC.exports);var Cye=OC.exports,Ay=TypeError;const Tye={},Aye=Object.freeze(Object.defineProperty({__proto__:null,default:Tye},Symbol.toStringTag,{value:"Module"})),Eye=eQ(Aye);var ED=typeof Map=="function"&&Map.prototype,FM=Object.getOwnPropertyDescriptor&&ED?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,SC=ED&&FM&&typeof FM.get=="function"?FM.get:null,JF=ED&&Map.prototype.forEach,MD=typeof Set=="function"&&Set.prototype,zM=Object.getOwnPropertyDescriptor&&MD?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,CC=MD&&zM&&typeof zM.get=="function"?zM.get:null,ez=MD&&Set.prototype.forEach,Mye=typeof WeakMap=="function"&&WeakMap.prototype,zx=Mye?WeakMap.prototype.has:null,kye=typeof WeakSet=="function"&&WeakSet.prototype,Xx=kye?WeakSet.prototype.has:null,Pye=typeof WeakRef=="function"&&WeakRef.prototype,tz=Pye?WeakRef.prototype.deref:null,Iye=Boolean.prototype.valueOf,Bye=Object.prototype.toString,Rye=Function.prototype.toString,Dye=String.prototype.match,kD=String.prototype.slice,Vd=String.prototype.replace,Lye=String.prototype.toUpperCase,iz=String.prototype.toLowerCase,rQ=RegExp.prototype.test,nz=Array.prototype.concat,Fc=Array.prototype.join,Nye=Array.prototype.slice,sz=Math.floor,iI=typeof BigInt=="function"?BigInt.prototype.valueOf:null,XM=Object.getOwnPropertySymbols,nI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,ty=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Jr=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===ty||!0)?Symbol.toStringTag:null,oQ=Object.prototype.propertyIsEnumerable,rz=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(s){return s.__proto__}:null);function oz(s,e){if(s===1/0||s===-1/0||s!==s||s&&s>-1e3&&s<1e3||rQ.call(/e/,e))return e;var i=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof s=="number"){var n=s<0?-sz(-s):sz(s);if(n!==s){var r=String(n),o=kD.call(e,r.length+1);return Vd.call(r,i,"$&_")+"."+Vd.call(Vd.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Vd.call(e,i,"$&_")}var sI=Eye,az=sI.custom,lz=cQ(az)?az:null,aQ={__proto__:null,double:'"',single:"'"},Vye={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},nA=function s(e,i,n,r){var o=i||{};if(Xh(o,"quoteStyle")&&!Xh(aQ,o.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Xh(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Xh(o,"customInspect")?o.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Xh(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Xh(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var l=o.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return uQ(e,o);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var h=String(e);return l?oz(e,h):h}if(typeof e=="bigint"){var d=String(e)+"n";return l?oz(e,d):d}var f=typeof o.depth>"u"?5:o.depth;if(typeof n>"u"&&(n=0),n>=f&&f>0&&typeof e=="object")return rI(e)?"[Array]":"[Object]";var p=ive(o,n);if(typeof r>"u")r=[];else if(hQ(r,e)>=0)return"[Circular]";function g(V,F,j){if(F&&(r=Nye.call(r),r.push(F)),j){var Q={depth:o.depth};return Xh(o,"quoteStyle")&&(Q.quoteStyle=o.quoteStyle),s(V,Q,n+1,r)}return s(V,o,n+1,r)}if(typeof e=="function"&&!cz(e)){var y=Qye(e),x=n1(e,g);return"[Function"+(y?": "+y:" (anonymous)")+"]"+(x.length>0?" { "+Fc.call(x,", ")+" }":"")}if(cQ(e)){var _=ty?Vd.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):nI.call(e);return typeof e=="object"&&!ty?Ev(_):_}if(Jye(e)){for(var w="<"+iz.call(String(e.nodeName)),O=e.attributes||[],T=0;T<O.length;T++)w+=" "+O[T].name+"="+lQ($ye(O[T].value),"double",o);return w+=">",e.childNodes&&e.childNodes.length&&(w+="..."),w+="</"+iz.call(String(e.nodeName))+">",w}if(rI(e)){if(e.length===0)return"[]";var C=n1(e,g);return p&&!tve(C)?"["+oI(C,p)+"]":"[ "+Fc.call(C,", ")+" ]"}if(Fye(e)){var A=n1(e,g);return!("cause"in Error.prototype)&&"cause"in e&&!oQ.call(e,"cause")?"{ ["+String(e)+"] "+Fc.call(nz.call("[cause]: "+g(e.cause),A),", ")+" }":A.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Fc.call(A,", ")+" }"}if(typeof e=="object"&&a){if(lz&&typeof e[lz]=="function"&&sI)return sI(e,{depth:f-n});if(a!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Yye(e)){var B=[];return JF&&JF.call(e,function(V,F){B.push(g(F,e,!0)+" => "+g(V,e))}),hz("Map",SC.call(e),B,p)}if(Zye(e)){var I=[];return ez&&ez.call(e,function(V){I.push(g(V,e))}),hz("Set",CC.call(e),I,p)}if(jye(e))return WM("WeakMap");if(Kye(e))return WM("WeakSet");if(qye(e))return WM("WeakRef");if(Xye(e))return Ev(g(Number(e)));if(Hye(e))return Ev(g(iI.call(e)));if(Wye(e))return Ev(Iye.call(e));if(zye(e))return Ev(g(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof ou<"u"&&e===ou)return"{ [object globalThis] }";if(!Uye(e)&&!cz(e)){var R=n1(e,g),P=rz?rz(e)===Object.prototype:e instanceof Object||e.constructor===Object,k=e instanceof Object?"":"null prototype",E=!P&&Jr&&Object(e)===e&&Jr in e?kD.call(gf(e),8,-1):k?"Object":"",D=P||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",L=D+(E||k?"["+Fc.call(nz.call([],E||[],k||[]),": ")+"] ":"");return R.length===0?L+"{}":p?L+"{"+oI(R,p)+"}":L+"{ "+Fc.call(R,", ")+" }"}return String(e)};function lQ(s,e,i){var n=i.quoteStyle||e,r=aQ[n];return r+s+r}function $ye(s){return Vd.call(String(s),/"/g,"&quot;")}function rI(s){return gf(s)==="[object Array]"&&(!Jr||!(typeof s=="object"&&Jr in s))}function Uye(s){return gf(s)==="[object Date]"&&(!Jr||!(typeof s=="object"&&Jr in s))}function cz(s){return gf(s)==="[object RegExp]"&&(!Jr||!(typeof s=="object"&&Jr in s))}function Fye(s){return gf(s)==="[object Error]"&&(!Jr||!(typeof s=="object"&&Jr in s))}function zye(s){return gf(s)==="[object String]"&&(!Jr||!(typeof s=="object"&&Jr in s))}function Xye(s){return gf(s)==="[object Number]"&&(!Jr||!(typeof s=="object"&&Jr in s))}function Wye(s){return gf(s)==="[object Boolean]"&&(!Jr||!(typeof s=="object"&&Jr in s))}function cQ(s){if(ty)return s&&typeof s=="object"&&s instanceof Symbol;if(typeof s=="symbol")return!0;if(!s||typeof s!="object"||!nI)return!1;try{return nI.call(s),!0}catch{}return!1}function Hye(s){if(!s||typeof s!="object"||!iI)return!1;try{return iI.call(s),!0}catch{}return!1}var Gye=Object.prototype.hasOwnProperty||function(s){return s in this};function Xh(s,e){return Gye.call(s,e)}function gf(s){return Bye.call(s)}function Qye(s){if(s.name)return s.name;var e=Dye.call(Rye.call(s),/^function\s*([\w$]+)/);return e?e[1]:null}function hQ(s,e){if(s.indexOf)return s.indexOf(e);for(var i=0,n=s.length;i<n;i++)if(s[i]===e)return i;return-1}function Yye(s){if(!SC||!s||typeof s!="object")return!1;try{SC.call(s);try{CC.call(s)}catch{return!0}return s instanceof Map}catch{}return!1}function jye(s){if(!zx||!s||typeof s!="object")return!1;try{zx.call(s,zx);try{Xx.call(s,Xx)}catch{return!0}return s instanceof WeakMap}catch{}return!1}function qye(s){if(!tz||!s||typeof s!="object")return!1;try{return tz.call(s),!0}catch{}return!1}function Zye(s){if(!CC||!s||typeof s!="object")return!1;try{CC.call(s);try{SC.call(s)}catch{return!0}return s instanceof Set}catch{}return!1}function Kye(s){if(!Xx||!s||typeof s!="object")return!1;try{Xx.call(s,Xx);try{zx.call(s,zx)}catch{return!0}return s instanceof WeakSet}catch{}return!1}function Jye(s){return!s||typeof s!="object"?!1:typeof HTMLElement<"u"&&s instanceof HTMLElement?!0:typeof s.nodeName=="string"&&typeof s.getAttribute=="function"}function uQ(s,e){if(s.length>e.maxStringLength){var i=s.length-e.maxStringLength,n="... "+i+" more character"+(i>1?"s":"");return uQ(kD.call(s,0,e.maxStringLength),e)+n}var r=Vye[e.quoteStyle||"single"];r.lastIndex=0;var o=Vd.call(Vd.call(s,r,"\\$1"),/[\x00-\x1f]/g,eve);return lQ(o,"single",e)}function eve(s){var e=s.charCodeAt(0),i={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return i?"\\"+i:"\\x"+(e<16?"0":"")+Lye.call(e.toString(16))}function Ev(s){return"Object("+s+")"}function WM(s){return s+" { ? }"}function hz(s,e,i,n){var r=n?oI(i,n):Fc.call(i,", ");return s+" ("+e+") {"+r+"}"}function tve(s){for(var e=0;e<s.length;e++)if(hQ(s[e],`
`)>=0)return!1;return!0}function ive(s,e){var i;if(s.indent==="	")i="	";else if(typeof s.indent=="number"&&s.indent>0)i=Fc.call(Array(s.indent+1)," ");else return null;return{base:i,prev:Fc.call(Array(e+1),i)}}function oI(s,e){if(s.length===0)return"";var i=`
`+e.prev+e.base;return i+Fc.call(s,","+i)+`
`+e.prev}function n1(s,e){var i=rI(s),n=[];if(i){n.length=s.length;for(var r=0;r<s.length;r++)n[r]=Xh(s,r)?e(s[r],s):""}var o=typeof XM=="function"?XM(s):[],a;if(ty){a={};for(var l=0;l<o.length;l++)a["$"+o[l]]=o[l]}for(var h in s)Xh(s,h)&&(i&&String(Number(h))===h&&h<s.length||ty&&a["$"+h]instanceof Symbol||(rQ.call(/[^\w$]/,h)?n.push(e(h,s)+": "+e(s[h],s)):n.push(h+": "+e(s[h],s))));if(typeof XM=="function")for(var d=0;d<o.length;d++)oQ.call(s,o[d])&&n.push("["+e(o[d])+"]: "+e(s[o[d]],s));return n}var nve=nA,sve=Ay,sA=function(s,e,i){for(var n=s,r;(r=n.next)!=null;n=r)if(r.key===e)return n.next=r.next,i||(r.next=s.next,s.next=r),r},rve=function(s,e){if(s){var i=sA(s,e);return i&&i.value}},ove=function(s,e,i){var n=sA(s,e);n?n.value=i:s.next={key:e,next:s.next,value:i}},ave=function(s,e){return s?!!sA(s,e):!1},lve=function(s,e){if(s)return sA(s,e,!0)},cve=function(){var e,i={assert:function(n){if(!i.has(n))throw new sve("Side channel does not contain "+nve(n))},delete:function(n){var r=e&&e.next,o=lve(e,n);return o&&r&&r===o&&(e=void 0),!!o},get:function(n){return rve(e,n)},has:function(n){return ave(e,n)},set:function(n,r){e||(e={next:void 0}),ove(e,n,r)}};return i},dQ=Object,hve=Error,uve=EvalError,dve=RangeError,fve=ReferenceError,pve=SyntaxError,mve=URIError,gve=Math.abs,yve=Math.floor,vve=Math.max,xve=Math.min,_ve=Math.pow,bve=Math.round,wve=Number.isNaN||function(e){return e!==e},Ove=wve,Sve=function(e){return Ove(e)||e===0?e:e<0?-1:1},Cve=Object.getOwnPropertyDescriptor,MS=Cve;if(MS)try{MS([],"length")}catch{MS=null}var fQ=MS,kS=Object.defineProperty||!1;if(kS)try{kS({},"a",{value:1})}catch{kS=!1}var Tve=kS,HM,uz;function Ave(){return uz||(uz=1,HM=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},i=Symbol("test"),n=Object(i);if(typeof i=="string"||Object.prototype.toString.call(i)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var r=42;e[i]=r;for(var o in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==i||!Object.prototype.propertyIsEnumerable.call(e,i))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(e,i);if(l.value!==r||l.enumerable!==!0)return!1}return!0}),HM}var GM,dz;function Eve(){if(dz)return GM;dz=1;var s=typeof Symbol<"u"&&Symbol,e=Ave();return GM=function(){return typeof s!="function"||typeof Symbol!="function"||typeof s("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},GM}var QM,fz;function pQ(){return fz||(fz=1,QM=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),QM}var YM,pz;function mQ(){if(pz)return YM;pz=1;var s=dQ;return YM=s.getPrototypeOf||null,YM}var jM,mz;function Mve(){if(mz)return jM;mz=1;var s="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,i=Math.max,n="[object Function]",r=function(h,d){for(var f=[],p=0;p<h.length;p+=1)f[p]=h[p];for(var g=0;g<d.length;g+=1)f[g+h.length]=d[g];return f},o=function(h,d){for(var f=[],p=d,g=0;p<h.length;p+=1,g+=1)f[g]=h[p];return f},a=function(l,h){for(var d="",f=0;f<l.length;f+=1)d+=l[f],f+1<l.length&&(d+=h);return d};return jM=function(h){var d=this;if(typeof d!="function"||e.apply(d)!==n)throw new TypeError(s+d);for(var f=o(arguments,1),p,g=function(){if(this instanceof p){var O=d.apply(this,r(f,arguments));return Object(O)===O?O:this}return d.apply(h,r(f,arguments))},y=i(0,d.length-f.length),x=[],_=0;_<y;_++)x[_]="$"+_;if(p=Function("binder","return function ("+a(x,",")+"){ return binder.apply(this,arguments); }")(g),d.prototype){var w=function(){};w.prototype=d.prototype,p.prototype=new w,w.prototype=null}return p},jM}var qM,gz;function rA(){if(gz)return qM;gz=1;var s=Mve();return qM=Function.prototype.bind||s,qM}var ZM,yz;function PD(){return yz||(yz=1,ZM=Function.prototype.call),ZM}var KM,vz;function gQ(){return vz||(vz=1,KM=Function.prototype.apply),KM}var kve=typeof Reflect<"u"&&Reflect&&Reflect.apply,Pve=rA(),Ive=gQ(),Bve=PD(),Rve=kve,Dve=Rve||Pve.call(Bve,Ive),Lve=rA(),Nve=Ay,Vve=PD(),$ve=Dve,yQ=function(e){if(e.length<1||typeof e[0]!="function")throw new Nve("a function is required");return $ve(Lve,Vve,e)},JM,xz;function Uve(){if(xz)return JM;xz=1;var s=yQ,e=fQ,i;try{i=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var n=!!i&&e&&e(Object.prototype,"__proto__"),r=Object,o=r.getPrototypeOf;return JM=n&&typeof n.get=="function"?s([n.get]):typeof o=="function"?function(l){return o(l==null?l:r(l))}:!1,JM}var ek,_z;function Fve(){if(_z)return ek;_z=1;var s=pQ(),e=mQ(),i=Uve();return ek=s?function(r){return s(r)}:e?function(r){if(!r||typeof r!="object"&&typeof r!="function")throw new TypeError("getProto: not an object");return e(r)}:i?function(r){return i(r)}:null,ek}var tk,bz;function zve(){if(bz)return tk;bz=1;var s=Function.prototype.call,e=Object.prototype.hasOwnProperty,i=rA();return tk=i.call(s,e),tk}var en,Xve=dQ,Wve=hve,Hve=uve,Gve=dve,Qve=fve,iy=pve,I0=Ay,Yve=mve,jve=gve,qve=yve,Zve=vve,Kve=xve,Jve=_ve,exe=bve,txe=Sve,vQ=Function,ik=function(s){try{return vQ('"use strict"; return ('+s+").constructor;")()}catch{}},y_=fQ,ixe=Tve,nk=function(){throw new I0},nxe=y_?function(){try{return arguments.callee,nk}catch{try{return y_(arguments,"callee").get}catch{return nk}}}():nk,og=Eve()(),yr=Fve(),sxe=mQ(),rxe=pQ(),xQ=gQ(),gb=PD(),Jg={},oxe=typeof Uint8Array>"u"||!yr?en:yr(Uint8Array),Qp={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?en:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?en:ArrayBuffer,"%ArrayIteratorPrototype%":og&&yr?yr([][Symbol.iterator]()):en,"%AsyncFromSyncIteratorPrototype%":en,"%AsyncFunction%":Jg,"%AsyncGenerator%":Jg,"%AsyncGeneratorFunction%":Jg,"%AsyncIteratorPrototype%":Jg,"%Atomics%":typeof Atomics>"u"?en:Atomics,"%BigInt%":typeof BigInt>"u"?en:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?en:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?en:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?en:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Wve,"%eval%":eval,"%EvalError%":Hve,"%Float32Array%":typeof Float32Array>"u"?en:Float32Array,"%Float64Array%":typeof Float64Array>"u"?en:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?en:FinalizationRegistry,"%Function%":vQ,"%GeneratorFunction%":Jg,"%Int8Array%":typeof Int8Array>"u"?en:Int8Array,"%Int16Array%":typeof Int16Array>"u"?en:Int16Array,"%Int32Array%":typeof Int32Array>"u"?en:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":og&&yr?yr(yr([][Symbol.iterator]())):en,"%JSON%":typeof JSON=="object"?JSON:en,"%Map%":typeof Map>"u"?en:Map,"%MapIteratorPrototype%":typeof Map>"u"||!og||!yr?en:yr(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Xve,"%Object.getOwnPropertyDescriptor%":y_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?en:Promise,"%Proxy%":typeof Proxy>"u"?en:Proxy,"%RangeError%":Gve,"%ReferenceError%":Qve,"%Reflect%":typeof Reflect>"u"?en:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?en:Set,"%SetIteratorPrototype%":typeof Set>"u"||!og||!yr?en:yr(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?en:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":og&&yr?yr(""[Symbol.iterator]()):en,"%Symbol%":og?Symbol:en,"%SyntaxError%":iy,"%ThrowTypeError%":nxe,"%TypedArray%":oxe,"%TypeError%":I0,"%Uint8Array%":typeof Uint8Array>"u"?en:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?en:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?en:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?en:Uint32Array,"%URIError%":Yve,"%WeakMap%":typeof WeakMap>"u"?en:WeakMap,"%WeakRef%":typeof WeakRef>"u"?en:WeakRef,"%WeakSet%":typeof WeakSet>"u"?en:WeakSet,"%Function.prototype.call%":gb,"%Function.prototype.apply%":xQ,"%Object.defineProperty%":ixe,"%Object.getPrototypeOf%":sxe,"%Math.abs%":jve,"%Math.floor%":qve,"%Math.max%":Zve,"%Math.min%":Kve,"%Math.pow%":Jve,"%Math.round%":exe,"%Math.sign%":txe,"%Reflect.getPrototypeOf%":rxe};if(yr)try{null.error}catch(s){var axe=yr(yr(s));Qp["%Error.prototype%"]=axe}var lxe=function s(e){var i;if(e==="%AsyncFunction%")i=ik("async function () {}");else if(e==="%GeneratorFunction%")i=ik("function* () {}");else if(e==="%AsyncGeneratorFunction%")i=ik("async function* () {}");else if(e==="%AsyncGenerator%"){var n=s("%AsyncGeneratorFunction%");n&&(i=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var r=s("%AsyncGenerator%");r&&yr&&(i=yr(r.prototype))}return Qp[e]=i,i},wz={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},yb=rA(),TC=zve(),cxe=yb.call(gb,Array.prototype.concat),hxe=yb.call(xQ,Array.prototype.splice),Oz=yb.call(gb,String.prototype.replace),AC=yb.call(gb,String.prototype.slice),uxe=yb.call(gb,RegExp.prototype.exec),dxe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,fxe=/\\(\\)?/g,pxe=function(e){var i=AC(e,0,1),n=AC(e,-1);if(i==="%"&&n!=="%")throw new iy("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&i!=="%")throw new iy("invalid intrinsic syntax, expected opening `%`");var r=[];return Oz(e,dxe,function(o,a,l,h){r[r.length]=l?Oz(h,fxe,"$1"):a||o}),r},mxe=function(e,i){var n=e,r;if(TC(wz,n)&&(r=wz[n],n="%"+r[0]+"%"),TC(Qp,n)){var o=Qp[n];if(o===Jg&&(o=lxe(n)),typeof o>"u"&&!i)throw new I0("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new iy("intrinsic "+e+" does not exist!")},ID=function(e,i){if(typeof e!="string"||e.length===0)throw new I0("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof i!="boolean")throw new I0('"allowMissing" argument must be a boolean');if(uxe(/^%?[^%]*%?$/,e)===null)throw new iy("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=pxe(e),r=n.length>0?n[0]:"",o=mxe("%"+r+"%",i),a=o.name,l=o.value,h=!1,d=o.alias;d&&(r=d[0],hxe(n,cxe([0,1],d)));for(var f=1,p=!0;f<n.length;f+=1){var g=n[f],y=AC(g,0,1),x=AC(g,-1);if((y==='"'||y==="'"||y==="`"||x==='"'||x==="'"||x==="`")&&y!==x)throw new iy("property names with quotes must have matching quotes");if((g==="constructor"||!p)&&(h=!0),r+="."+g,a="%"+r+"%",TC(Qp,a))l=Qp[a];else if(l!=null){if(!(g in l)){if(!i)throw new I0("base intrinsic for "+e+" exists, but the property is not available.");return}if(y_&&f+1>=n.length){var _=y_(l,g);p=!!_,p&&"get"in _&&!("originalValue"in _.get)?l=_.get:l=l[g]}else p=TC(l,g),l=l[g];p&&!h&&(Qp[a]=l)}}return l},_Q=ID,bQ=yQ,gxe=bQ([_Q("%String.prototype.indexOf%")]),wQ=function(e,i){var n=_Q(e,!!i);return typeof n=="function"&&gxe(e,".prototype.")>-1?bQ([n]):n},yxe=ID,vb=wQ,vxe=nA,xxe=Ay,Sz=yxe("%Map%",!0),_xe=vb("Map.prototype.get",!0),bxe=vb("Map.prototype.set",!0),wxe=vb("Map.prototype.has",!0),Oxe=vb("Map.prototype.delete",!0),Sxe=vb("Map.prototype.size",!0),OQ=!!Sz&&function(){var e,i={assert:function(n){if(!i.has(n))throw new xxe("Side channel does not contain "+vxe(n))},delete:function(n){if(e){var r=Oxe(e,n);return Sxe(e)===0&&(e=void 0),r}return!1},get:function(n){if(e)return _xe(e,n)},has:function(n){return e?wxe(e,n):!1},set:function(n,r){e||(e=new Sz),bxe(e,n,r)}};return i},Cxe=ID,oA=wQ,Txe=nA,s1=OQ,Axe=Ay,ag=Cxe("%WeakMap%",!0),Exe=oA("WeakMap.prototype.get",!0),Mxe=oA("WeakMap.prototype.set",!0),kxe=oA("WeakMap.prototype.has",!0),Pxe=oA("WeakMap.prototype.delete",!0),Ixe=ag?function(){var e,i,n={assert:function(r){if(!n.has(r))throw new Axe("Side channel does not contain "+Txe(r))},delete:function(r){if(ag&&r&&(typeof r=="object"||typeof r=="function")){if(e)return Pxe(e,r)}else if(s1&&i)return i.delete(r);return!1},get:function(r){return ag&&r&&(typeof r=="object"||typeof r=="function")&&e?Exe(e,r):i&&i.get(r)},has:function(r){return ag&&r&&(typeof r=="object"||typeof r=="function")&&e?kxe(e,r):!!i&&i.has(r)},set:function(r,o){ag&&r&&(typeof r=="object"||typeof r=="function")?(e||(e=new ag),Mxe(e,r,o)):s1&&(i||(i=s1()),i.set(r,o))}};return n}:s1,Bxe=Ay,Rxe=nA,Dxe=cve,Lxe=OQ,Nxe=Ixe,Vxe=Nxe||Lxe||Dxe,$xe=function(){var e,i={assert:function(n){if(!i.has(n))throw new Bxe("Side channel does not contain "+Rxe(n))},delete:function(n){return!!e&&e.delete(n)},get:function(n){return e&&e.get(n)},has:function(n){return!!e&&e.has(n)},set:function(n,r){e||(e=Vxe()),e.set(n,r)}};return i},Uxe=String.prototype.replace,Fxe=/%20/g,sk={RFC1738:"RFC1738",RFC3986:"RFC3986"},BD={default:sk.RFC3986,formatters:{RFC1738:function(s){return Uxe.call(s,Fxe,"+")},RFC3986:function(s){return String(s)}},RFC1738:sk.RFC1738,RFC3986:sk.RFC3986},zxe=BD,rk=Object.prototype.hasOwnProperty,Cp=Array.isArray,_c=function(){for(var s=[],e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s}(),Xxe=function(e){for(;e.length>1;){var i=e.pop(),n=i.obj[i.prop];if(Cp(n)){for(var r=[],o=0;o<n.length;++o)typeof n[o]<"u"&&r.push(n[o]);i.obj[i.prop]=r}}},SQ=function(e,i){for(var n=i&&i.plainObjects?{__proto__:null}:{},r=0;r<e.length;++r)typeof e[r]<"u"&&(n[r]=e[r]);return n},Wxe=function s(e,i,n){if(!i)return e;if(typeof i!="object"&&typeof i!="function"){if(Cp(e))e.push(i);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!rk.call(Object.prototype,i))&&(e[i]=!0);else return[e,i];return e}if(!e||typeof e!="object")return[e].concat(i);var r=e;return Cp(e)&&!Cp(i)&&(r=SQ(e,n)),Cp(e)&&Cp(i)?(i.forEach(function(o,a){if(rk.call(e,a)){var l=e[a];l&&typeof l=="object"&&o&&typeof o=="object"?e[a]=s(l,o,n):e.push(o)}else e[a]=o}),e):Object.keys(i).reduce(function(o,a){var l=i[a];return rk.call(o,a)?o[a]=s(o[a],l,n):o[a]=l,o},r)},Hxe=function(e,i){return Object.keys(i).reduce(function(n,r){return n[r]=i[r],n},e)},Gxe=function(s,e,i){var n=s.replace(/\+/g," ");if(i==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},ok=1024,Qxe=function(e,i,n,r,o){if(e.length===0)return e;var a=e;if(typeof e=="symbol"?a=Symbol.prototype.toString.call(e):typeof e!="string"&&(a=String(e)),n==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(y){return"%26%23"+parseInt(y.slice(2),16)+"%3B"});for(var l="",h=0;h<a.length;h+=ok){for(var d=a.length>=ok?a.slice(h,h+ok):a,f=[],p=0;p<d.length;++p){var g=d.charCodeAt(p);if(g===45||g===46||g===95||g===126||g>=48&&g<=57||g>=65&&g<=90||g>=97&&g<=122||o===zxe.RFC1738&&(g===40||g===41)){f[f.length]=d.charAt(p);continue}if(g<128){f[f.length]=_c[g];continue}if(g<2048){f[f.length]=_c[192|g>>6]+_c[128|g&63];continue}if(g<55296||g>=57344){f[f.length]=_c[224|g>>12]+_c[128|g>>6&63]+_c[128|g&63];continue}p+=1,g=65536+((g&1023)<<10|d.charCodeAt(p)&1023),f[f.length]=_c[240|g>>18]+_c[128|g>>12&63]+_c[128|g>>6&63]+_c[128|g&63]}l+=f.join("")}return l},Yxe=function(e){for(var i=[{obj:{o:e},prop:"o"}],n=[],r=0;r<i.length;++r)for(var o=i[r],a=o.obj[o.prop],l=Object.keys(a),h=0;h<l.length;++h){var d=l[h],f=a[d];typeof f=="object"&&f!==null&&n.indexOf(f)===-1&&(i.push({obj:a,prop:d}),n.push(f))}return Xxe(i),e},jxe=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},qxe=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},Zxe=function(e,i){return[].concat(e,i)},Kxe=function(e,i){if(Cp(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(i(e[r]));return n}return i(e)},CQ={arrayToObject:SQ,assign:Hxe,combine:Zxe,compact:Yxe,decode:Gxe,encode:Qxe,isBuffer:qxe,isRegExp:jxe,maybeMap:Kxe,merge:Wxe},TQ=$xe,PS=CQ,Wx=BD,Jxe=Object.prototype.hasOwnProperty,AQ={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,i){return e+"["+i+"]"},repeat:function(e){return e}},$c=Array.isArray,e_e=Array.prototype.push,EQ=function(s,e){e_e.apply(s,$c(e)?e:[e])},t_e=Date.prototype.toISOString,Cz=Wx.default,tr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:PS.encode,encodeValuesOnly:!1,filter:void 0,format:Cz,formatter:Wx.formatters[Cz],indices:!1,serializeDate:function(e){return t_e.call(e)},skipNulls:!1,strictNullHandling:!1},i_e=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},ak={},n_e=function s(e,i,n,r,o,a,l,h,d,f,p,g,y,x,_,w,O,T){for(var C=e,A=T,B=0,I=!1;(A=A.get(ak))!==void 0&&!I;){var R=A.get(e);if(B+=1,typeof R<"u"){if(R===B)throw new RangeError("Cyclic object value");I=!0}typeof A.get(ak)>"u"&&(B=0)}if(typeof f=="function"?C=f(i,C):C instanceof Date?C=y(C):n==="comma"&&$c(C)&&(C=PS.maybeMap(C,function(oe){return oe instanceof Date?y(oe):oe})),C===null){if(a)return d&&!w?d(i,tr.encoder,O,"key",x):i;C=""}if(i_e(C)||PS.isBuffer(C)){if(d){var P=w?i:d(i,tr.encoder,O,"key",x);return[_(P)+"="+_(d(C,tr.encoder,O,"value",x))]}return[_(i)+"="+_(String(C))]}var k=[];if(typeof C>"u")return k;var E;if(n==="comma"&&$c(C))w&&d&&(C=PS.maybeMap(C,d)),E=[{value:C.length>0?C.join(",")||null:void 0}];else if($c(f))E=f;else{var D=Object.keys(C);E=p?D.sort(p):D}var L=h?String(i).replace(/\./g,"%2E"):String(i),V=r&&$c(C)&&C.length===1?L+"[]":L;if(o&&$c(C)&&C.length===0)return V+"[]";for(var F=0;F<E.length;++F){var j=E[F],Q=typeof j=="object"&&j&&typeof j.value<"u"?j.value:C[j];if(!(l&&Q===null)){var ee=g&&h?String(j).replace(/\./g,"%2E"):String(j),J=$c(C)?typeof n=="function"?n(V,ee):V:V+(g?"."+ee:"["+ee+"]");T.set(e,B);var ue=TQ();ue.set(ak,T),EQ(k,s(Q,J,n,r,o,a,l,h,n==="comma"&&w&&$c(C)?null:d,f,p,g,y,x,_,w,O,ue))}}return k},s_e=function(e){if(!e)return tr;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var i=e.charset||tr.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Wx.default;if(typeof e.format<"u"){if(!Jxe.call(Wx.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var r=Wx.formatters[n],o=tr.filter;(typeof e.filter=="function"||$c(e.filter))&&(o=e.filter);var a;if(e.arrayFormat in AQ?a=e.arrayFormat:"indices"in e?a=e.indices?"indices":"repeat":a=tr.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var l=typeof e.allowDots>"u"?e.encodeDotInKeys===!0?!0:tr.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:tr.addQueryPrefix,allowDots:l,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:tr.allowEmptyArrays,arrayFormat:a,charset:i,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:tr.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?tr.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:tr.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:tr.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:tr.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:tr.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:tr.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:tr.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:tr.strictNullHandling}},r_e=function(s,e){var i=s,n=s_e(e),r,o;typeof n.filter=="function"?(o=n.filter,i=o("",i)):$c(n.filter)&&(o=n.filter,r=o);var a=[];if(typeof i!="object"||i===null)return"";var l=AQ[n.arrayFormat],h=l==="comma"&&n.commaRoundTrip;r||(r=Object.keys(i)),n.sort&&r.sort(n.sort);for(var d=TQ(),f=0;f<r.length;++f){var p=r[f],g=i[p];n.skipNulls&&g===null||EQ(a,n_e(g,p,l,h,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,d))}var y=a.join(n.delimiter),x=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?x+="utf8=%26%2310003%3B&":x+="utf8=%E2%9C%93&"),y.length>0?x+y:""},dm=CQ,aI=Object.prototype.hasOwnProperty,Tz=Array.isArray,Ts={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:dm.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},o_e=function(s){return s.replace(/&#(\d+);/g,function(e,i){return String.fromCharCode(parseInt(i,10))})},MQ=function(s,e,i){if(s&&typeof s=="string"&&e.comma&&s.indexOf(",")>-1)return s.split(",");if(e.throwOnLimitExceeded&&i>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(e.arrayLimit===1?"":"s")+" allowed in an array.");return s},a_e="utf8=%26%2310003%3B",l_e="utf8=%E2%9C%93",c_e=function(e,i){var n={__proto__:null},r=i.ignoreQueryPrefix?e.replace(/^\?/,""):e;r=r.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var o=i.parameterLimit===1/0?void 0:i.parameterLimit,a=r.split(i.delimiter,i.throwOnLimitExceeded?o+1:o);if(i.throwOnLimitExceeded&&a.length>o)throw new RangeError("Parameter limit exceeded. Only "+o+" parameter"+(o===1?"":"s")+" allowed.");var l=-1,h,d=i.charset;if(i.charsetSentinel)for(h=0;h<a.length;++h)a[h].indexOf("utf8=")===0&&(a[h]===l_e?d="utf-8":a[h]===a_e&&(d="iso-8859-1"),l=h,h=a.length);for(h=0;h<a.length;++h)if(h!==l){var f=a[h],p=f.indexOf("]="),g=p===-1?f.indexOf("="):p+1,y,x;g===-1?(y=i.decoder(f,Ts.decoder,d,"key"),x=i.strictNullHandling?null:""):(y=i.decoder(f.slice(0,g),Ts.decoder,d,"key"),x=dm.maybeMap(MQ(f.slice(g+1),i,Tz(n[y])?n[y].length:0),function(w){return i.decoder(w,Ts.decoder,d,"value")})),x&&i.interpretNumericEntities&&d==="iso-8859-1"&&(x=o_e(String(x))),f.indexOf("[]=")>-1&&(x=Tz(x)?[x]:x);var _=aI.call(n,y);_&&i.duplicates==="combine"?n[y]=dm.combine(n[y],x):(!_||i.duplicates==="last")&&(n[y]=x)}return n},h_e=function(s,e,i,n){var r=0;if(s.length>0&&s[s.length-1]==="[]"){var o=s.slice(0,-1).join("");r=Array.isArray(e)&&e[o]?e[o].length:0}for(var a=n?e:MQ(e,i,r),l=s.length-1;l>=0;--l){var h,d=s[l];if(d==="[]"&&i.parseArrays)h=i.allowEmptyArrays&&(a===""||i.strictNullHandling&&a===null)?[]:dm.combine([],a);else{h=i.plainObjects?{__proto__:null}:{};var f=d.charAt(0)==="["&&d.charAt(d.length-1)==="]"?d.slice(1,-1):d,p=i.decodeDotInKeys?f.replace(/%2E/g,"."):f,g=parseInt(p,10);!i.parseArrays&&p===""?h={0:a}:!isNaN(g)&&d!==p&&String(g)===p&&g>=0&&i.parseArrays&&g<=i.arrayLimit?(h=[],h[g]=a):p!=="__proto__"&&(h[p]=a)}a=h}return a},u_e=function(e,i,n,r){if(e){var o=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/,l=/(\[[^[\]]*])/g,h=n.depth>0&&a.exec(o),d=h?o.slice(0,h.index):o,f=[];if(d){if(!n.plainObjects&&aI.call(Object.prototype,d)&&!n.allowPrototypes)return;f.push(d)}for(var p=0;n.depth>0&&(h=l.exec(o))!==null&&p<n.depth;){if(p+=1,!n.plainObjects&&aI.call(Object.prototype,h[1].slice(1,-1))&&!n.allowPrototypes)return;f.push(h[1])}if(h){if(n.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+n.depth+" and strictDepth is true");f.push("["+o.slice(h.index)+"]")}return h_e(f,i,n,r)}},d_e=function(e){if(!e)return Ts;if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.decodeDotInKeys<"u"&&typeof e.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(e.decoder!==null&&typeof e.decoder<"u"&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof e.throwOnLimitExceeded<"u"&&typeof e.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var i=typeof e.charset>"u"?Ts.charset:e.charset,n=typeof e.duplicates>"u"?Ts.duplicates:e.duplicates;if(n!=="combine"&&n!=="first"&&n!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var r=typeof e.allowDots>"u"?e.decodeDotInKeys===!0?!0:Ts.allowDots:!!e.allowDots;return{allowDots:r,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Ts.allowEmptyArrays,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Ts.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Ts.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Ts.arrayLimit,charset:i,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ts.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Ts.comma,decodeDotInKeys:typeof e.decodeDotInKeys=="boolean"?e.decodeDotInKeys:Ts.decodeDotInKeys,decoder:typeof e.decoder=="function"?e.decoder:Ts.decoder,delimiter:typeof e.delimiter=="string"||dm.isRegExp(e.delimiter)?e.delimiter:Ts.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Ts.depth,duplicates:n,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Ts.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Ts.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Ts.plainObjects,strictDepth:typeof e.strictDepth=="boolean"?!!e.strictDepth:Ts.strictDepth,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ts.strictNullHandling,throwOnLimitExceeded:typeof e.throwOnLimitExceeded=="boolean"?e.throwOnLimitExceeded:!1}},f_e=function(s,e){var i=d_e(e);if(s===""||s===null||typeof s>"u")return i.plainObjects?{__proto__:null}:{};for(var n=typeof s=="string"?c_e(s,i):s,r=i.plainObjects?{__proto__:null}:{},o=Object.keys(n),a=0;a<o.length;++a){var l=o[a],h=u_e(l,n[l],i,typeof s=="string");r=dm.merge(r,h,i)}return i.allowSparse===!0?r:dm.compact(r)},p_e=r_e,m_e=f_e,g_e=BD,y_e={formats:g_e,parse:m_e,stringify:p_e},v_e=Cye;function au(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var x_e=/^([a-z0-9.+-]+:)/i,__e=/:[0-9]*$/,b_e=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,w_e=["<",">",'"',"`"," ","\r",`
`,"	"],O_e=["{","}","|","\\","^","`"].concat(w_e),lI=["'"].concat(O_e),Az=["%","/","?",";","#"].concat(lI),Ez=["/","?","#"],S_e=255,Mz=/^[+a-z0-9A-Z_-]{0,63}$/,C_e=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,T_e={javascript:!0,"javascript:":!0},cI={javascript:!0,"javascript:":!0},B0={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},hI=y_e;function A_e(s,e,i){if(s&&typeof s=="object"&&s instanceof au)return s;var n=new au;return n.parse(s,e,i),n}au.prototype.parse=function(s,e,i){if(typeof s!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof s);var n=s.indexOf("?"),r=n!==-1&&n<s.indexOf("#")?"?":"#",o=s.split(r),a=/\\/g;o[0]=o[0].replace(a,"/"),s=o.join(r);var l=s;if(l=l.trim(),!i&&s.split("#").length===1){var h=b_e.exec(l);if(h)return this.path=l,this.href=l,this.pathname=h[1],h[2]?(this.search=h[2],e?this.query=hI.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var d=x_e.exec(l);if(d){d=d[0];var f=d.toLowerCase();this.protocol=f,l=l.substr(d.length)}if(i||d||l.match(/^\/\/[^@/]+@[^@/]+/)){var p=l.substr(0,2)==="//";p&&!(d&&cI[d])&&(l=l.substr(2),this.slashes=!0)}if(!cI[d]&&(p||d&&!B0[d])){for(var g=-1,y=0;y<Ez.length;y++){var x=l.indexOf(Ez[y]);x!==-1&&(g===-1||x<g)&&(g=x)}var _,w;g===-1?w=l.lastIndexOf("@"):w=l.lastIndexOf("@",g),w!==-1&&(_=l.slice(0,w),l=l.slice(w+1),this.auth=decodeURIComponent(_)),g=-1;for(var y=0;y<Az.length;y++){var x=l.indexOf(Az[y]);x!==-1&&(g===-1||x<g)&&(g=x)}g===-1&&(g=l.length),this.host=l.slice(0,g),l=l.slice(g),this.parseHost(),this.hostname=this.hostname||"";var O=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!O)for(var T=this.hostname.split(/\./),y=0,C=T.length;y<C;y++){var A=T[y];if(A&&!A.match(Mz)){for(var B="",I=0,R=A.length;I<R;I++)A.charCodeAt(I)>127?B+="x":B+=A[I];if(!B.match(Mz)){var P=T.slice(0,y),k=T.slice(y+1),E=A.match(C_e);E&&(P.push(E[1]),k.unshift(E[2])),k.length&&(l="/"+k.join(".")+l),this.hostname=P.join(".");break}}}this.hostname.length>S_e?this.hostname="":this.hostname=this.hostname.toLowerCase(),O||(this.hostname=v_e.toASCII(this.hostname));var D=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+D,this.href+=this.host,O&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!T_e[f])for(var y=0,C=lI.length;y<C;y++){var V=lI[y];if(l.indexOf(V)!==-1){var F=encodeURIComponent(V);F===V&&(F=escape(V)),l=l.split(V).join(F)}}var j=l.indexOf("#");j!==-1&&(this.hash=l.substr(j),l=l.slice(0,j));var Q=l.indexOf("?");if(Q!==-1?(this.search=l.substr(Q),this.query=l.substr(Q+1),e&&(this.query=hI.parse(this.query)),l=l.slice(0,Q)):e&&(this.search="",this.query={}),l&&(this.pathname=l),B0[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var D=this.pathname||"",ee=this.search||"";this.path=D+ee}return this.href=this.format(),this};au.prototype.format=function(){var s=this.auth||"";s&&(s=encodeURIComponent(s),s=s.replace(/%3A/i,":"),s+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",r=!1,o="";this.host?r=s+this.host:this.hostname&&(r=s+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(o=hI.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||o&&"?"+o||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||B0[e])&&r!==!1?(r="//"+(r||""),i&&i.charAt(0)!=="/"&&(i="/"+i)):r||(r=""),n&&n.charAt(0)!=="#"&&(n="#"+n),a&&a.charAt(0)!=="?"&&(a="?"+a),i=i.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),a=a.replace("#","%23"),e+r+i+a+n};au.prototype.resolve=function(s){return this.resolveObject(A_e(s,!1,!0)).format()};au.prototype.resolveObject=function(s){if(typeof s=="string"){var e=new au;e.parse(s,!1,!0),s=e}for(var i=new au,n=Object.keys(this),r=0;r<n.length;r++){var o=n[r];i[o]=this[o]}if(i.hash=s.hash,s.href==="")return i.href=i.format(),i;if(s.slashes&&!s.protocol){for(var a=Object.keys(s),l=0;l<a.length;l++){var h=a[l];h!=="protocol"&&(i[h]=s[h])}return B0[i.protocol]&&i.hostname&&!i.pathname&&(i.pathname="/",i.path=i.pathname),i.href=i.format(),i}if(s.protocol&&s.protocol!==i.protocol){if(!B0[s.protocol]){for(var d=Object.keys(s),f=0;f<d.length;f++){var p=d[f];i[p]=s[p]}return i.href=i.format(),i}if(i.protocol=s.protocol,!s.host&&!cI[s.protocol]){for(var C=(s.pathname||"").split("/");C.length&&!(s.host=C.shift()););s.host||(s.host=""),s.hostname||(s.hostname=""),C[0]!==""&&C.unshift(""),C.length<2&&C.unshift(""),i.pathname=C.join("/")}else i.pathname=s.pathname;if(i.search=s.search,i.query=s.query,i.host=s.host||"",i.auth=s.auth,i.hostname=s.hostname||s.host,i.port=s.port,i.pathname||i.search){var g=i.pathname||"",y=i.search||"";i.path=g+y}return i.slashes=i.slashes||s.slashes,i.href=i.format(),i}var x=i.pathname&&i.pathname.charAt(0)==="/",_=s.host||s.pathname&&s.pathname.charAt(0)==="/",w=_||x||i.host&&s.pathname,O=w,T=i.pathname&&i.pathname.split("/")||[],C=s.pathname&&s.pathname.split("/")||[],A=i.protocol&&!B0[i.protocol];if(A&&(i.hostname="",i.port=null,i.host&&(T[0]===""?T[0]=i.host:T.unshift(i.host)),i.host="",s.protocol&&(s.hostname=null,s.port=null,s.host&&(C[0]===""?C[0]=s.host:C.unshift(s.host)),s.host=null),w=w&&(C[0]===""||T[0]==="")),_)i.host=s.host||s.host===""?s.host:i.host,i.hostname=s.hostname||s.hostname===""?s.hostname:i.hostname,i.search=s.search,i.query=s.query,T=C;else if(C.length)T||(T=[]),T.pop(),T=T.concat(C),i.search=s.search,i.query=s.query;else if(s.search!=null){if(A){i.host=T.shift(),i.hostname=i.host;var B=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;B&&(i.auth=B.shift(),i.hostname=B.shift(),i.host=i.hostname)}return i.search=s.search,i.query=s.query,(i.pathname!==null||i.search!==null)&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!T.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var I=T.slice(-1)[0],R=(i.host||s.host||T.length>1)&&(I==="."||I==="..")||I==="",P=0,k=T.length;k>=0;k--)I=T[k],I==="."?T.splice(k,1):I===".."?(T.splice(k,1),P++):P&&(T.splice(k,1),P--);if(!w&&!O)for(;P--;P)T.unshift("..");w&&T[0]!==""&&(!T[0]||T[0].charAt(0)!=="/")&&T.unshift(""),R&&T.join("/").substr(-1)!=="/"&&T.push("");var E=T[0]===""||T[0]&&T[0].charAt(0)==="/";if(A){i.hostname=E?"":T.length?T.shift():"",i.host=i.hostname;var B=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;B&&(i.auth=B.shift(),i.hostname=B.shift(),i.host=i.hostname)}return w=w||i.host&&T.length,w&&!E&&T.unshift(""),T.length>0?i.pathname=T.join("/"):(i.pathname=null,i.path=null),(i.pathname!==null||i.search!==null)&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=s.auth||i.auth,i.slashes=i.slashes||s.slashes,i.href=i.format(),i};au.prototype.parseHost=function(){var s=this.host,e=__e.exec(s);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),s=s.substr(0,s.length-e.length)),s&&(this.hostname=s)};const kz={};function Yi(s,e,i=3){if(kz[e])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${s}`):(n=n.split(`
`).splice(i).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${s}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${s}`),console.warn(n))),kz[e]=!0}function kl(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function Mv(s){return s.split("?")[0].split("#")[0]}function E_e(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function M_e(s,e,i){return s.replace(new RegExp(E_e(e),"g"),i)}function k_e(s,e){let i="",n=0,r=-1,o=0,a=-1;for(let l=0;l<=s.length;++l){if(l<s.length)a=s.charCodeAt(l);else{if(a===47)break;a=47}if(a===47){if(!(r===l-1||o===1))if(r!==l-1&&o===2){if(i.length<2||n!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){const h=i.lastIndexOf("/");if(h!==i.length-1){h===-1?(i="",n=0):(i=i.slice(0,h),n=i.length-1-i.lastIndexOf("/")),r=l,o=0;continue}}else if(i.length===2||i.length===1){i="",n=0,r=l,o=0;continue}}}else i.length>0?i+=`/${s.slice(r+1,l)}`:i=s.slice(r+1,l),n=l-r-1;r=l,o=0}else a===46&&o!==-1?++o:o=-1}return i}const Or={toPosix(s){return M_e(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){kl(s),s=this.toPosix(s);const e=/^file:\/\/\//.exec(s);if(e)return e[0];const i=/^[^/:]+:\/{0,2}/.exec(s);return i?i[0]:""},toAbsolute(s,e,i){if(kl(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const n=Mv(this.toPosix(e??kt.ADAPTER.getBaseUrl())),r=Mv(this.toPosix(i??this.rootname(n)));return s=this.toPosix(s),s.startsWith("/")?Or.join(r,s.slice(1)):this.isAbsolute(s)?s:this.join(n,s)},normalize(s){if(kl(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let e="";const i=s.startsWith("/");this.hasProtocol(s)&&(e=this.rootname(s),s=s.slice(e.length));const n=s.endsWith("/");return s=k_e(s),s.length>0&&n&&(s+="/"),i?`/${s}`:e+s},isAbsolute(s){return kl(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let e;for(let i=0;i<s.length;++i){const n=s[i];if(kl(n),n.length>0)if(e===void 0)e=n;else{const r=s[i-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(s){if(kl(s),s.length===0)return".";s=this.toPosix(s);let e=s.charCodeAt(0);const i=e===47;let n=-1,r=!0;const o=this.getProtocol(s),a=s;s=s.slice(o.length);for(let l=s.length-1;l>=1;--l)if(e=s.charCodeAt(l),e===47){if(!r){n=l;break}}else r=!1;return n===-1?i?"/":this.isUrl(a)?o+s:o:i&&n===1?"//":o+s.slice(0,n)},rootname(s){kl(s),s=this.toPosix(s);let e="";if(s.startsWith("/")?e="/":e=this.getProtocol(s),this.isUrl(s)){const i=s.indexOf("/",e.length);i!==-1?e=s.slice(0,i):e=s,e.endsWith("/")||(e+="/")}return e},basename(s,e){kl(s),e&&kl(e),s=Mv(this.toPosix(s));let i=0,n=-1,r=!0,o;if(e!==void 0&&e.length>0&&e.length<=s.length){if(e.length===s.length&&e===s)return"";let a=e.length-1,l=-1;for(o=s.length-1;o>=0;--o){const h=s.charCodeAt(o);if(h===47){if(!r){i=o+1;break}}else l===-1&&(r=!1,l=o+1),a>=0&&(h===e.charCodeAt(a)?--a===-1&&(n=o):(a=-1,n=l))}return i===n?n=l:n===-1&&(n=s.length),s.slice(i,n)}for(o=s.length-1;o>=0;--o)if(s.charCodeAt(o)===47){if(!r){i=o+1;break}}else n===-1&&(r=!1,n=o+1);return n===-1?"":s.slice(i,n)},extname(s){kl(s),s=Mv(this.toPosix(s));let e=-1,i=0,n=-1,r=!0,o=0;for(let a=s.length-1;a>=0;--a){const l=s.charCodeAt(a);if(l===47){if(!r){i=a+1;break}continue}n===-1&&(r=!1,n=a+1),l===46?e===-1?e=a:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===i+1?"":s.slice(e,n)},parse(s){kl(s);const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;s=Mv(this.toPosix(s));let i=s.charCodeAt(0);const n=this.isAbsolute(s);let r;e.root=this.rootname(s),n||this.hasProtocol(s)?r=1:r=0;let o=-1,a=0,l=-1,h=!0,d=s.length-1,f=0;for(;d>=r;--d){if(i=s.charCodeAt(d),i===47){if(!h){a=d+1;break}continue}l===-1&&(h=!1,l=d+1),i===46?o===-1?o=d:f!==1&&(f=1):o!==-1&&(f=-1)}return o===-1||l===-1||f===0||f===1&&o===l-1&&o===a+1?l!==-1&&(a===0&&n?e.base=e.name=s.slice(1,l):e.base=e.name=s.slice(a,l)):(a===0&&n?(e.name=s.slice(1,o),e.base=s.slice(1,l)):(e.name=s.slice(a,o),e.base=s.slice(a,l)),e.ext=s.slice(o,l)),e.dir=this.dirname(s),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let lk;async function P_e(){return lk??(lk=(async()=>{var o;const s=document.createElement("canvas").getContext("webgl");if(!s)return Yo.UNPACK;const e=await new Promise(a=>{const l=document.createElement("video");l.onloadeddata=()=>a(l),l.onerror=()=>a(null),l.autoplay=!1,l.crossOrigin="anonymous",l.preload="auto",l.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",l.load()});if(!e)return Yo.UNPACK;const i=s.createTexture();s.bindTexture(s.TEXTURE_2D,i);const n=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,n),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,i,0),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.NONE),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,e);const r=new Uint8Array(4);return s.readPixels(0,0,1,1,s.RGBA,s.UNSIGNED_BYTE,r),s.deleteFramebuffer(n),s.deleteTexture(i),(o=s.getExtension("WEBGL_lose_context"))==null||o.loseContext(),r[0]<=r[3]?Yo.PMA:Yo.UNPACK})()),lk}let ck;function I_e(){return typeof ck>"u"&&(ck=function(){var e;const s={stencil:!0,failIfMajorPerformanceCaveat:kt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!kt.ADAPTER.getWebGLRenderingContext())return!1;const i=kt.ADAPTER.createCanvas();let n=i.getContext("webgl",s)||i.getContext("experimental-webgl",s);const r=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const o=n.getExtension("WEBGL_lose_context");o&&o.loseContext()}return n=null,r}catch{return!1}}()),ck}var B_e={grad:.9,turn:360,rad:360/(2*Math.PI)},Ch=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},xr=function(s,e,i){return e===void 0&&(e=0),i===void 0&&(i=Math.pow(10,e)),Math.round(i*s)/i+0},cl=function(s,e,i){return e===void 0&&(e=0),i===void 0&&(i=1),s>i?i:s>e?s:e},kQ=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},Pz=function(s){return{r:cl(s.r,0,255),g:cl(s.g,0,255),b:cl(s.b,0,255),a:cl(s.a)}},hk=function(s){return{r:xr(s.r),g:xr(s.g),b:xr(s.b),a:xr(s.a,3)}},R_e=/^#([0-9a-f]{3,8})$/i,r1=function(s){var e=s.toString(16);return e.length<2?"0"+e:e},PQ=function(s){var e=s.r,i=s.g,n=s.b,r=s.a,o=Math.max(e,i,n),a=o-Math.min(e,i,n),l=a?o===e?(i-n)/a:o===i?2+(n-e)/a:4+(e-i)/a:0;return{h:60*(l<0?l+6:l),s:o?a/o*100:0,v:o/255*100,a:r}},IQ=function(s){var e=s.h,i=s.s,n=s.v,r=s.a;e=e/360*6,i/=100,n/=100;var o=Math.floor(e),a=n*(1-i),l=n*(1-(e-o)*i),h=n*(1-(1-e+o)*i),d=o%6;return{r:255*[n,l,a,a,h,n][d],g:255*[h,n,n,l,a,a][d],b:255*[a,a,h,n,n,l][d],a:r}},Iz=function(s){return{h:kQ(s.h),s:cl(s.s,0,100),l:cl(s.l,0,100),a:cl(s.a)}},Bz=function(s){return{h:xr(s.h),s:xr(s.s),l:xr(s.l),a:xr(s.a,3)}},Rz=function(s){return IQ((i=(e=s).s,{h:e.h,s:(i*=((n=e.l)<50?n:100-n)/100)>0?2*i/(n+i)*100:0,v:n+i,a:e.a}));var e,i,n},Hx=function(s){return{h:(e=PQ(s)).h,s:(r=(200-(i=e.s))*(n=e.v)/100)>0&&r<200?i*n/100/(r<=100?r:200-r)*100:0,l:r/2,a:e.a};var e,i,n,r},D_e=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,L_e=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,N_e=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,V_e=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uI={string:[[function(s){var e=R_e.exec(s);return e?(s=e[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?xr(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?xr(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var e=N_e.exec(s)||V_e.exec(s);return e?e[2]!==e[4]||e[4]!==e[6]?null:Pz({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(s){var e=D_e.exec(s)||L_e.exec(s);if(!e)return null;var i,n,r=Iz({h:(i=e[1],n=e[2],n===void 0&&(n="deg"),Number(i)*(B_e[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Rz(r)},"hsl"]],object:[[function(s){var e=s.r,i=s.g,n=s.b,r=s.a,o=r===void 0?1:r;return Ch(e)&&Ch(i)&&Ch(n)?Pz({r:Number(e),g:Number(i),b:Number(n),a:Number(o)}):null},"rgb"],[function(s){var e=s.h,i=s.s,n=s.l,r=s.a,o=r===void 0?1:r;if(!Ch(e)||!Ch(i)||!Ch(n))return null;var a=Iz({h:Number(e),s:Number(i),l:Number(n),a:Number(o)});return Rz(a)},"hsl"],[function(s){var e=s.h,i=s.s,n=s.v,r=s.a,o=r===void 0?1:r;if(!Ch(e)||!Ch(i)||!Ch(n))return null;var a=function(l){return{h:kQ(l.h),s:cl(l.s,0,100),v:cl(l.v,0,100),a:cl(l.a)}}({h:Number(e),s:Number(i),v:Number(n),a:Number(o)});return IQ(a)},"hsv"]]},Dz=function(s,e){for(var i=0;i<e.length;i++){var n=e[i][0](s);if(n)return[n,e[i][1]]}return[null,void 0]},$_e=function(s){return typeof s=="string"?Dz(s.trim(),uI.string):typeof s=="object"&&s!==null?Dz(s,uI.object):[null,void 0]},uk=function(s,e){var i=Hx(s);return{h:i.h,s:cl(i.s+100*e,0,100),l:i.l,a:i.a}},dk=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},Lz=function(s,e){var i=Hx(s);return{h:i.h,s:i.s,l:cl(i.l+100*e,0,100),a:i.a}},dI=function(){function s(e){this.parsed=$_e(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return xr(dk(this.rgba),2)},s.prototype.isDark=function(){return dk(this.rgba)<.5},s.prototype.isLight=function(){return dk(this.rgba)>=.5},s.prototype.toHex=function(){return e=hk(this.rgba),i=e.r,n=e.g,r=e.b,a=(o=e.a)<1?r1(xr(255*o)):"","#"+r1(i)+r1(n)+r1(r)+a;var e,i,n,r,o,a},s.prototype.toRgb=function(){return hk(this.rgba)},s.prototype.toRgbString=function(){return e=hk(this.rgba),i=e.r,n=e.g,r=e.b,(o=e.a)<1?"rgba("+i+", "+n+", "+r+", "+o+")":"rgb("+i+", "+n+", "+r+")";var e,i,n,r,o},s.prototype.toHsl=function(){return Bz(Hx(this.rgba))},s.prototype.toHslString=function(){return e=Bz(Hx(this.rgba)),i=e.h,n=e.s,r=e.l,(o=e.a)<1?"hsla("+i+", "+n+"%, "+r+"%, "+o+")":"hsl("+i+", "+n+"%, "+r+"%)";var e,i,n,r,o},s.prototype.toHsv=function(){return e=PQ(this.rgba),{h:xr(e.h),s:xr(e.s),v:xr(e.v),a:xr(e.a,3)};var e},s.prototype.invert=function(){return Mc({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},s.prototype.saturate=function(e){return e===void 0&&(e=.1),Mc(uk(this.rgba,e))},s.prototype.desaturate=function(e){return e===void 0&&(e=.1),Mc(uk(this.rgba,-e))},s.prototype.grayscale=function(){return Mc(uk(this.rgba,-1))},s.prototype.lighten=function(e){return e===void 0&&(e=.1),Mc(Lz(this.rgba,e))},s.prototype.darken=function(e){return e===void 0&&(e=.1),Mc(Lz(this.rgba,-e))},s.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},s.prototype.alpha=function(e){return typeof e=="number"?Mc({r:(i=this.rgba).r,g:i.g,b:i.b,a:e}):xr(this.rgba.a,3);var i},s.prototype.hue=function(e){var i=Hx(this.rgba);return typeof e=="number"?Mc({h:e,s:i.s,l:i.l,a:i.a}):xr(i.h)},s.prototype.isEqual=function(e){return this.toHex()===Mc(e).toHex()},s}(),Mc=function(s){return s instanceof dI?s:new dI(s)},Nz=[],U_e=function(s){s.forEach(function(e){Nz.indexOf(e)<0&&(e(dI,uI),Nz.push(e))})};function F_e(s,e){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var r in i)n[i[r]]=r;var o={};s.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var l,h,d=n[this.toHex()];if(d)return d;if(a!=null&&a.closest){var f=this.toRgb(),p=1/0,g="black";if(!o.length)for(var y in i)o[y]=new s(i[y]).toRgb();for(var x in i){var _=(l=f,h=o[x],Math.pow(l.r-h.r,2)+Math.pow(l.g-h.g,2)+Math.pow(l.b-h.b,2));_<p&&(p=_,g=x)}return g}},e.string.push([function(a){var l=a.toLowerCase(),h=l==="transparent"?"#0000":i[l];return h?new s(h).toRgb():null},"name"])}U_e([F_e]);const e0=class IS{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof IS)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,i){const n=typeof e;if(n!==typeof i)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===i;if(Array.isArray(e)&&Array.isArray(i)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(i))return e.length!==i.length?!1:e.every((r,o)=>r===i[o]);if(e!==null&&i!==null){const r=Object.keys(e),o=Object.keys(i);return r.length!==o.length?!1:r.every(a=>e[a]===i[a])}return e===i}toRgba(){const[e,i,n,r]=this._components;return{r:e,g:i,b:n,a:r}}toRgb(){const[e,i,n]=this._components;return{r:e,g:i,b:n}}toRgbaString(){const[e,i,n]=this.toUint8RgbArray();return`rgba(${e},${i},${n},${this.alpha})`}toUint8RgbArray(e){const[i,n,r]=this._components;return e=e??[],e[0]=Math.round(i*255),e[1]=Math.round(n*255),e[2]=Math.round(r*255),e}toRgbArray(e){e=e??[];const[i,n,r]=this._components;return e[0]=i,e[1]=n,e[2]=r,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[i,n,r,o]=IS.temp.setValue(e)._components;return this._components[0]*=i,this._components[1]*=n,this._components[2]*=r,this._components[3]*=o,this.refreshInt(),this._value=null,this}premultiply(e,i=!0){return i&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,i=!0){if(e===1)return(255<<24)+this._int;if(e===0)return i?0:this._int;let n=this._int>>16&255,r=this._int>>8&255,o=this._int&255;return i&&(n=n*e+.5|0,r=r*e+.5|0,o=o*e+.5|0),(e*255<<24)+(n<<16)+(r<<8)+o}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[i,n,r]=this._components;return this._components[0]=Math.round(i*e)/e,this._components[1]=Math.round(n*e)/e,this._components[2]=Math.round(r*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[i,n,r,o]=this._components;return e[0]=i,e[1]=n,e[2]=r,e[3]=o,e}normalize(e){let i,n,r,o;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const a=e;i=(a>>16&255)/255,n=(a>>8&255)/255,r=(a&255)/255,o=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[i,n,r,o=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[i,n,r,o=255]=e,i/=255,n/=255,r/=255,o/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const l=IS.HEX_PATTERN.exec(e);l&&(e=`#${l[2]}`)}const a=Mc(e);a.isValid()&&({r:i,g:n,b:r,a:o}=a.rgba,i/=255,n/=255,r/=255)}if(i!==void 0)this._components[0]=i,this._components[1]=n,this._components[2]=r,this._components[3]=o,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,i,n]=this._components;this._int=(e*255<<16)+(i*255<<8)+(n*255|0)}_clamp(e,i=0,n=1){return typeof e=="number"?Math.min(Math.max(e,i),n):(e.forEach((r,o)=>{e[o]=Math.min(Math.max(r,i),n)}),e)}};e0.shared=new e0,e0.temp=new e0,e0.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Zn=e0;function z_e(s){return Yi("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Zn.shared.setValue(s).toHex()}function X_e(s){return Yi("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Zn.shared.setValue(s).toNumber()}function W_e(){const s=[],e=[];for(let n=0;n<32;n++)s[n]=n,e[n]=n;s[mi.NORMAL_NPM]=mi.NORMAL,s[mi.ADD_NPM]=mi.ADD,s[mi.SCREEN_NPM]=mi.SCREEN,e[mi.NORMAL]=mi.NORMAL_NPM,e[mi.ADD]=mi.ADD_NPM,e[mi.SCREEN]=mi.SCREEN_NPM;const i=[];return i.push(e),i.push(s),i}const BQ=W_e();function RQ(s,e){return BQ[e?1:0][s]}function H_e(s,e=null){const i=s*6;if(e=e||new Uint16Array(i),e.length!==i)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${i}`);for(let n=0,r=0;n<i;n+=6,r+=4)e[n+0]=r+0,e[n+1]=r+1,e[n+2]=r+2,e[n+3]=r+0,e[n+4]=r+2,e[n+5]=r+3;return e}function DQ(s){if(s.BYTES_PER_ELEMENT===4)return s instanceof Float32Array?"Float32Array":s instanceof Uint32Array?"Uint32Array":"Int32Array";if(s.BYTES_PER_ELEMENT===2){if(s instanceof Uint16Array)return"Uint16Array"}else if(s.BYTES_PER_ELEMENT===1&&s instanceof Uint8Array)return"Uint8Array";return null}function EC(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function Vz(s){return!(s&s-1)&&!!s}function $z(s){let e=(s>65535?1:0)<<4;s>>>=e;let i=(s>255?1:0)<<3;return s>>>=i,e|=i,i=(s>15?1:0)<<2,s>>>=i,e|=i,i=(s>3?1:0)<<1,s>>>=i,e|=i,e|s>>1}function R0(s,e,i){const n=s.length;let r;if(e>=n||i===0)return;i=e+i>n?n-e:i;const o=n-i;for(r=e;r<o;++r)s[r]=s[r+i];s.length=o}function $d(s){return s===0?0:s<0?-1:1}let G_e=0;function fm(){return++G_e}const fI=class{constructor(s,e,i,n){this.left=s,this.top=e,this.right=i,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};fI.EMPTY=new fI(0,0,0,0);let Uz=fI;const Fz={},kc=Object.create(null),ed=Object.create(null);class Q_e{constructor(e,i,n){this._canvas=kt.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||kt.RESOLUTION,this.resize(e,i)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,i){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(i*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function zz(s,e,i){for(let n=0,r=4*i*e;n<e;++n,r+=4)if(s[r+3]!==0)return!1;return!0}function Xz(s,e,i,n,r){const o=4*e;for(let a=n,l=n*o+4*i;a<=r;++a,l+=o)if(s[l+3]!==0)return!1;return!0}function Y_e(s){const{width:e,height:i}=s,n=s.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const r=n.getImageData(0,0,e,i).data;let o=0,a=0,l=e-1,h=i-1;for(;a<i&&zz(r,e,a);)++a;if(a===i)return Uz.EMPTY;for(;zz(r,e,h);)--h;for(;Xz(r,e,o,a,h);)++o;for(;Xz(r,e,l,a,h);)--l;return++l,++h,new Uz(o,a,l,h)}function j_e(s){const e=Y_e(s),{width:i,height:n}=e;let r=null;if(!e.isEmpty()){const o=s.getContext("2d");if(o===null)throw new TypeError("Failed to get canvas 2D context");r=o.getImageData(e.left,e.top,i,n)}return{width:i,height:n,data:r}}function q_e(s,e=globalThis.location){if(s.startsWith("data:"))return"";e=e||globalThis.location;const i=new URL(s,document.baseURI);return i.hostname!==e.hostname||i.port!==e.port||i.protocol!==e.protocol?"anonymous":""}function pu(s,e=1){var n;const i=(n=kt.RETINA_PREFIX)==null?void 0:n.exec(s);return i?parseFloat(i[1]):e}var xt=(s=>(s.Renderer="renderer",s.Application="application",s.RendererSystem="renderer-webgl-system",s.RendererPlugin="renderer-webgl-plugin",s.CanvasRendererSystem="renderer-canvas-system",s.CanvasRendererPlugin="renderer-canvas-plugin",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s))(xt||{});const pI=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},Wz=(s,e)=>pI(s).priority??e,$t={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(pI).forEach(e=>{e.type.forEach(i=>{var n,r;return(r=(n=this._removeHandlers)[i])==null?void 0:r.call(n,e)})}),this},add(...s){return s.map(pI).forEach(e=>{e.type.forEach(i=>{var o,a;const n=this._addHandlers,r=this._queue;n[i]?(o=n[i])==null||o.call(n,e):(r[i]=r[i]||[],(a=r[i])==null||a.push(e))})}),this},handle(s,e,i){var a;const n=this._addHandlers,r=this._removeHandlers;if(n[s]||r[s])throw new Error(`Extension type ${s} already has a handler`);n[s]=e,r[s]=i;const o=this._queue;return o[s]&&((a=o[s])==null||a.forEach(l=>e(l)),delete o[s]),this},handleByMap(s,e){return this.handle(s,i=>{i.name&&(e[i.name]=i.ref)},i=>{i.name&&delete e[i.name]})},handleByList(s,e,i=-1){return this.handle(s,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((r,o)=>Wz(o,i)-Wz(r,i)))},n=>{const r=e.indexOf(n.ref);r!==-1&&e.splice(r,1)})}};class mI{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const Z_e=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function K_e(s){let e="";for(let i=0;i<s;++i)i>0&&(e+=`
else `),i<s-1&&(e+=`if(test == ${i}.0){}`);return e}function J_e(s,e){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const i=e.createShader(e.FRAGMENT_SHADER);for(;;){const n=Z_e.replace(/%forloop%/gi,K_e(s));if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))s=s/2|0;else break}return s}const fk=0,pk=1,mk=2,gk=3,yk=4,vk=5;class lh{constructor(){this.data=0,this.blendMode=mi.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<fk)}set blend(e){!!(this.data&1<<fk)!==e&&(this.data^=1<<fk)}get offsets(){return!!(this.data&1<<pk)}set offsets(e){!!(this.data&1<<pk)!==e&&(this.data^=1<<pk)}get culling(){return!!(this.data&1<<mk)}set culling(e){!!(this.data&1<<mk)!==e&&(this.data^=1<<mk)}get depthTest(){return!!(this.data&1<<gk)}set depthTest(e){!!(this.data&1<<gk)!==e&&(this.data^=1<<gk)}get depthMask(){return!!(this.data&1<<vk)}set depthMask(e){!!(this.data&1<<vk)!==e&&(this.data^=1<<vk)}get clockwiseFrontFace(){return!!(this.data&1<<yk)}set clockwiseFrontFace(e){!!(this.data&1<<yk)!==e&&(this.data^=1<<yk)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==mi.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new lh;return e.depthTest=!1,e.blend=!0,e}}lh.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const gI=[];function LQ(s,e){if(!s)return null;let i="";if(typeof s=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(s);n&&(i=n[1].toLowerCase())}for(let n=gI.length-1;n>=0;--n){const r=gI[n];if(r.test&&r.test(s,i))return new r(s,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class Zl{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,i,n,r,o,a,l,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:d,items:f}=this;this._aliasCount++;for(let p=0,g=f.length;p<g;p++)f[p][d](e,i,n,r,o,a,l,h);return f===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const i=this.items.indexOf(e);return i!==-1&&(this.ensureNonAliasedItems(),this.items.splice(i,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Zl.prototype,{dispatch:{value:Zl.prototype.emit},run:{value:Zl.prototype.emit}});class v_{constructor(e=0,i=0){this._width=e,this._height=i,this.destroyed=!1,this.internal=!1,this.onResize=new Zl("setRealSize"),this.onUpdate=new Zl("update"),this.onError=new Zl("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,i){(e!==this._width||i!==this._height)&&(this._width=e,this._height=i,this.onResize.emit(e,i))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,i,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,i){return!1}}class aA extends v_{constructor(e,i){const{width:n,height:r}=i||{};if(!n||!r)throw new Error("BufferResource width or height invalid");super(n,r),this.data=e,this.unpackAlignment=i.unpackAlignment??4}upload(e,i,n){const r=e.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,this.unpackAlignment),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===Yo.UNPACK);const o=i.realWidth,a=i.realHeight;return n.width===o&&n.height===a?r.texSubImage2D(i.target,0,0,0,o,a,i.format,n.type,this.data):(n.width=o,n.height=a,r.texImage2D(i.target,0,n.internalFormat,o,a,0,i.format,n.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const ebe={scaleMode:jh.NEAREST,alphaMode:Yo.NPM},yI=class t0 extends mb{constructor(e=null,i=null){super(),i=Object.assign({},t0.defaultOptions,i);const{alphaMode:n,mipmap:r,anisotropicLevel:o,scaleMode:a,width:l,height:h,wrapMode:d,format:f,type:p,target:g,resolution:y,resourceOptions:x}=i;e&&!(e instanceof v_)&&(e=LQ(e,x),e.internal=!0),this.resolution=y||kt.RESOLUTION,this.width=Math.round((l||0)*this.resolution)/this.resolution,this.height=Math.round((h||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=o,this._wrapMode=d,this._scaleMode=a,this.format=f,this.type=p,this.target=g,this.alphaMode=n,this.uid=fm(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=l>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,i){let n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),i!==void 0&&i!==this.mipmap&&(this.mipmap=i,n=!0),n&&this.dirtyStyleId++,this}setSize(e,i,n){return n=n||this.resolution,this.setRealSize(e*n,i*n,n)}setRealSize(e,i,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(i)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Vz(this.realWidth)&&Vz(this.realHeight)}setResolution(e){const i=this.resolution;return i===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*i)/e,this.height=Math.round(this.height*i)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ed[this.cacheId],delete kc[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),t0.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,i,n=kt.STRICT_TEXTURE_CACHE){const r=typeof e=="string";let o=null;if(r)o=e;else{if(!e._pixiId){const l=(i==null?void 0:i.pixiIdPrefix)||"pixiid";e._pixiId=`${l}_${fm()}`}o=e._pixiId}let a=ed[o];if(r&&n&&!a)throw new Error(`The cacheId "${o}" does not exist in BaseTextureCache.`);return a||(a=new t0(e,i),a.cacheId=o,t0.addToCache(a,o)),a}static fromBuffer(e,i,n,r){e=e||new Float32Array(i*n*4);const o=new aA(e,{width:i,height:n,...r==null?void 0:r.resourceOptions});let a,l;return e instanceof Float32Array?(a=rt.RGBA,l=qt.FLOAT):e instanceof Int32Array?(a=rt.RGBA_INTEGER,l=qt.INT):e instanceof Uint32Array?(a=rt.RGBA_INTEGER,l=qt.UNSIGNED_INT):e instanceof Int16Array?(a=rt.RGBA_INTEGER,l=qt.SHORT):e instanceof Uint16Array?(a=rt.RGBA_INTEGER,l=qt.UNSIGNED_SHORT):e instanceof Int8Array?(a=rt.RGBA,l=qt.BYTE):(a=rt.RGBA,l=qt.UNSIGNED_BYTE),o.internal=!0,new t0(o,Object.assign({},ebe,{type:l,format:a},r))}static addToCache(e,i){i&&(e.textureCacheIds.includes(i)||e.textureCacheIds.push(i),ed[i]&&ed[i]!==e&&console.warn(`BaseTexture added to the cache with an id [${i}] that already had an entry`),ed[i]=e)}static removeFromCache(e){if(typeof e=="string"){const i=ed[e];if(i){const n=i.textureCacheIds.indexOf(e);return n>-1&&i.textureCacheIds.splice(n,1),delete ed[e],i}}else if(e!=null&&e.textureCacheIds){for(let i=0;i<e.textureCacheIds.length;++i)delete ed[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null}};yI.defaultOptions={mipmap:nh.POW2,anisotropicLevel:0,scaleMode:jh.LINEAR,wrapMode:Qd.CLAMP,alphaMode:Yo.UNPACK,target:P0.TEXTURE_2D,format:rt.RGBA,type:qt.UNSIGNED_BYTE},yI._globalBatch=0;let Mi=yI;class vI{constructor(){this.texArray=null,this.blend=0,this.type=Gc.TRIANGLES,this.start=0,this.size=0,this.data=null}}let tbe=0;class Is{constructor(e,i=!0,n=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=i,this.id=tbe++,this.disposeRunner=new Zl("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Zc.ELEMENT_ARRAY_BUFFER:Zc.ARRAY_BUFFER}get index(){return this.type===Zc.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Is(e)}}class MC{constructor(e,i=0,n=!1,r=qt.FLOAT,o,a,l,h=1){this.buffer=e,this.size=i,this.normalized=n,this.type=r,this.stride=o,this.start=a,this.instance=l,this.divisor=h}destroy(){this.buffer=null}static from(e,i,n,r,o){return new MC(e,i,n,r,o)}}const ibe={Float32Array,Uint32Array,Int32Array,Uint8Array};function nbe(s,e){let i=0,n=0;const r={};for(let h=0;h<s.length;h++)n+=e[h],i+=s[h].length;const o=new ArrayBuffer(i*4);let a=null,l=0;for(let h=0;h<s.length;h++){const d=e[h],f=s[h],p=DQ(f);r[p]||(r[p]=new ibe[p](o)),a=r[p];for(let g=0;g<f.length;g++){const y=(g/d|0)*n+l,x=g%d;a[y+x]=f[g]}l+=d}return new Float32Array(o)}const Hz={5126:4,5123:2,5121:1};let sbe=0;const rbe={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class mu{constructor(e=[],i={}){this.buffers=e,this.indexBuffer=null,this.attributes=i,this.glVertexArrayObjects={},this.id=sbe++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Zl("disposeGeometry"),this.refCount=0}addAttribute(e,i,n=0,r=!1,o,a,l,h=!1){if(!i)throw new Error("You must pass a buffer when creating an attribute");i instanceof Is||(i instanceof Array&&(i=new Float32Array(i)),i=new Is(i));const d=e.split("|");if(d.length>1){for(let p=0;p<d.length;p++)this.addAttribute(d[p],i,n,r,o);return this}let f=this.buffers.indexOf(i);return f===-1&&(this.buffers.push(i),f=this.buffers.length-1),this.attributes[e]=new MC(f,n,r,o,a,l,h),this.instanced=this.instanced||h,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Is||(e instanceof Array&&(e=new Uint16Array(e)),e=new Is(e)),e.type=Zc.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],i=[],n=new Is;let r;for(r in this.attributes){const o=this.attributes[r],a=this.buffers[o.buffer];e.push(a.data),i.push(o.size*Hz[o.type]/4),o.buffer=0}for(n.data=nbe(e,i),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const i=this.attributes[e];return this.buffers[i.buffer].data.length/(i.stride/4||i.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new mu;for(let i=0;i<this.buffers.length;i++)e.buffers[i]=new Is(this.buffers[i].data.slice(0));for(const i in this.attributes){const n=this.attributes[i];e.attributes[i]=new MC(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Zc.ELEMENT_ARRAY_BUFFER),e}static merge(e){const i=new mu,n=[],r=[],o=[];let a;for(let l=0;l<e.length;l++){a=e[l];for(let h=0;h<a.buffers.length;h++)r[h]=r[h]||0,r[h]+=a.buffers[h].data.length,o[h]=0}for(let l=0;l<a.buffers.length;l++)n[l]=new rbe[DQ(a.buffers[l].data)](r[l]),i.buffers[l]=new Is(n[l]);for(let l=0;l<e.length;l++){a=e[l];for(let h=0;h<a.buffers.length;h++)n[h].set(a.buffers[h].data,o[h]),o[h]+=a.buffers[h].data.length}if(i.attributes=a.attributes,a.indexBuffer){i.indexBuffer=i.buffers[a.buffers.indexOf(a.indexBuffer)],i.indexBuffer.type=Zc.ELEMENT_ARRAY_BUFFER;let l=0,h=0,d=0,f=0;for(let p=0;p<a.buffers.length;p++)if(a.buffers[p]!==a.indexBuffer){f=p;break}for(const p in a.attributes){const g=a.attributes[p];(g.buffer|0)===f&&(h+=g.size*Hz[g.type]/4)}for(let p=0;p<e.length;p++){const g=e[p].indexBuffer.data;for(let y=0;y<g.length;y++)i.indexBuffer.data[y+d]+=l;l+=e[p].buffers[f].data.length/h,d+=g.length}}return i}}class NQ extends mu{constructor(e=!1){super(),this._buffer=new Is(null,e,!1),this._indexBuffer=new Is(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,qt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,qt.FLOAT).addAttribute("aColor",this._buffer,4,!0,qt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,qt.FLOAT).addIndex(this._indexBuffer)}}const kC=Math.PI*2,obe=180/Math.PI,abe=Math.PI/180;var Br=(s=>(s[s.POLY=0]="POLY",s[s.RECT=1]="RECT",s[s.CIRC=2]="CIRC",s[s.ELIP=3]="ELIP",s[s.RREC=4]="RREC",s))(Br||{});class si{constructor(e=0,i=0){this.x=0,this.y=0,this.x=e,this.y=i}clone(){return new si(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,i=e){return this.x=e,this.y=i,this}}si.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const o1=[new si,new si,new si,new si];class Pi{constructor(e=0,i=0,n=0,r=0){this.x=Number(e),this.y=Number(i),this.width=Number(n),this.height=Number(r),this.type=Br.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Pi(0,0,0,0)}clone(){return new Pi(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,i){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&i>=this.y&&i<this.y+this.height}intersects(e,i){if(!i){const P=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=P)return!1;const k=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>k}const n=this.left,r=this.right,o=this.top,a=this.bottom;if(r<=n||a<=o)return!1;const l=o1[0].set(e.left,e.top),h=o1[1].set(e.left,e.bottom),d=o1[2].set(e.right,e.top),f=o1[3].set(e.right,e.bottom);if(d.x<=l.x||h.y<=l.y)return!1;const p=Math.sign(i.a*i.d-i.b*i.c);if(p===0||(i.apply(l,l),i.apply(h,h),i.apply(d,d),i.apply(f,f),Math.max(l.x,h.x,d.x,f.x)<=n||Math.min(l.x,h.x,d.x,f.x)>=r||Math.max(l.y,h.y,d.y,f.y)<=o||Math.min(l.y,h.y,d.y,f.y)>=a))return!1;const g=p*(h.y-l.y),y=p*(l.x-h.x),x=g*n+y*o,_=g*r+y*o,w=g*n+y*a,O=g*r+y*a;if(Math.max(x,_,w,O)<=g*l.x+y*l.y||Math.min(x,_,w,O)>=g*f.x+y*f.y)return!1;const T=p*(l.y-d.y),C=p*(d.x-l.x),A=T*n+C*o,B=T*r+C*o,I=T*n+C*a,R=T*r+C*a;return!(Math.max(A,B,I,R)<=T*l.x+C*l.y||Math.min(A,B,I,R)>=T*f.x+C*f.y)}pad(e=0,i=e){return this.x-=e,this.y-=i,this.width+=e*2,this.height+=i*2,this}fit(e){const i=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),o=Math.min(this.y+this.height,e.y+e.height);return this.x=i,this.width=Math.max(n-i,0),this.y=r,this.height=Math.max(o-r,0),this}ceil(e=1,i=.001){const n=Math.ceil((this.x+this.width-i)*e)/e,r=Math.ceil((this.y+this.height-i)*e)/e;return this.x=Math.floor((this.x+i)*e)/e,this.y=Math.floor((this.y+i)*e)/e,this.width=n-this.x,this.height=r-this.y,this}enlarge(e){const i=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),o=Math.max(this.y+this.height,e.y+e.height);return this.x=i,this.width=n-i,this.y=r,this.height=o-r,this}}Pi.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};let RD=class VQ{constructor(e=0,i=0,n=0){this.x=e,this.y=i,this.radius=n,this.type=Br.CIRC}clone(){return new VQ(this.x,this.y,this.radius)}contains(e,i){if(this.radius<=0)return!1;const n=this.radius*this.radius;let r=this.x-e,o=this.y-i;return r*=r,o*=o,r+o<=n}getBounds(){return new Pi(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}};RD.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class lA{constructor(e=0,i=0,n=0,r=0){this.x=e,this.y=i,this.width=n,this.height=r,this.type=Br.ELIP}clone(){return new lA(this.x,this.y,this.width,this.height)}contains(e,i){if(this.width<=0||this.height<=0)return!1;let n=(e-this.x)/this.width,r=(i-this.y)/this.height;return n*=n,r*=r,n+r<=1}getBounds(){return new Pi(this.x-this.width,this.y-this.height,this.width,this.height)}}lA.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Yp{constructor(...e){let i=Array.isArray(e[0])?e[0]:e;if(typeof i[0]!="number"){const n=[];for(let r=0,o=i.length;r<o;r++)n.push(i[r].x,i[r].y);i=n}this.points=i,this.type=Br.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),i=new Yp(e);return i.closeStroke=this.closeStroke,i}contains(e,i){let n=!1;const r=this.points.length/2;for(let o=0,a=r-1;o<r;a=o++){const l=this.points[o*2],h=this.points[o*2+1],d=this.points[a*2],f=this.points[a*2+1];h>i!=f>i&&e<(d-l)*((i-h)/(f-h))+l&&(n=!n)}return n}}Yp.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((s,e)=>`${s}, ${e}`,"")}]`};class cA{constructor(e=0,i=0,n=0,r=0,o=20){this.x=e,this.y=i,this.width=n,this.height=r,this.radius=o,this.type=Br.RREC}clone(){return new cA(this.x,this.y,this.width,this.height,this.radius)}contains(e,i){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&i>=this.y&&i<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(i>=this.y+n&&i<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let r=e-(this.x+n),o=i-(this.y+n);const a=n*n;if(r*r+o*o<=a||(r=e-(this.x+this.width-n),r*r+o*o<=a)||(o=i-(this.y+this.height-n),r*r+o*o<=a)||(r=e-(this.x+n),r*r+o*o<=a))return!0}return!1}}cA.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class es{constructor(e=1,i=0,n=0,r=1,o=0,a=0){this.array=null,this.a=e,this.b=i,this.c=n,this.d=r,this.tx=o,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,i,n,r,o,a){return this.a=e,this.b=i,this.c=n,this.d=r,this.tx=o,this.ty=a,this}toArray(e,i){this.array||(this.array=new Float32Array(9));const n=i||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,i){i=i||new si;const n=e.x,r=e.y;return i.x=this.a*n+this.c*r+this.tx,i.y=this.b*n+this.d*r+this.ty,i}applyInverse(e,i){i=i||new si;const n=1/(this.a*this.d+this.c*-this.b),r=e.x,o=e.y;return i.x=this.d*n*r+-this.c*n*o+(this.ty*this.c-this.tx*this.d)*n,i.y=this.a*n*o+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,i}translate(e,i){return this.tx+=e,this.ty+=i,this}scale(e,i){return this.a*=e,this.d*=i,this.c*=e,this.b*=i,this.tx*=e,this.ty*=i,this}rotate(e){const i=Math.cos(e),n=Math.sin(e),r=this.a,o=this.c,a=this.tx;return this.a=r*i-this.b*n,this.b=r*n+this.b*i,this.c=o*i-this.d*n,this.d=o*n+this.d*i,this.tx=a*i-this.ty*n,this.ty=a*n+this.ty*i,this}append(e){const i=this.a,n=this.b,r=this.c,o=this.d;return this.a=e.a*i+e.b*r,this.b=e.a*n+e.b*o,this.c=e.c*i+e.d*r,this.d=e.c*n+e.d*o,this.tx=e.tx*i+e.ty*r+this.tx,this.ty=e.tx*n+e.ty*o+this.ty,this}setTransform(e,i,n,r,o,a,l,h,d){return this.a=Math.cos(l+d)*o,this.b=Math.sin(l+d)*o,this.c=-Math.sin(l-h)*a,this.d=Math.cos(l-h)*a,this.tx=e-(n*this.a+r*this.c),this.ty=i-(n*this.b+r*this.d),this}prepend(e){const i=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,r=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=i*e.a+this.ty*e.c+e.tx,this.ty=i*e.b+this.ty*e.d+e.ty,this}decompose(e){const i=this.a,n=this.b,r=this.c,o=this.d,a=e.pivot,l=-Math.atan2(-r,o),h=Math.atan2(n,i),d=Math.abs(l+h);return d<1e-5||Math.abs(kC-d)<1e-5?(e.rotation=h,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=l,e.skew.y=h),e.scale.x=Math.sqrt(i*i+n*n),e.scale.y=Math.sqrt(r*r+o*o),e.position.x=this.tx+(a.x*i+a.y*r),e.position.y=this.ty+(a.x*n+a.y*o),e}invert(){const e=this.a,i=this.b,n=this.c,r=this.d,o=this.tx,a=e*r-i*n;return this.a=r/a,this.b=-i/a,this.c=-n/a,this.d=e/a,this.tx=(n*this.ty-r*o)/a,this.ty=-(e*this.ty-i*o)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new es;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new es}static get TEMP_MATRIX(){return new es}}es.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const mp=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],gp=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],yp=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vp=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],xI=[],$Q=[],a1=Math.sign;function lbe(){for(let s=0;s<16;s++){const e=[];xI.push(e);for(let i=0;i<16;i++){const n=a1(mp[s]*mp[i]+yp[s]*gp[i]),r=a1(gp[s]*mp[i]+vp[s]*gp[i]),o=a1(mp[s]*yp[i]+yp[s]*vp[i]),a=a1(gp[s]*yp[i]+vp[s]*vp[i]);for(let l=0;l<16;l++)if(mp[l]===n&&gp[l]===r&&yp[l]===o&&vp[l]===a){e.push(l);break}}}for(let s=0;s<16;s++){const e=new es;e.set(mp[s],gp[s],yp[s],vp[s],0,0),$Q.push(e)}}lbe();const ps={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>mp[s],uY:s=>gp[s],vX:s=>yp[s],vY:s=>vp[s],inv:s=>s&8?s&15:-s&7,add:(s,e)=>xI[s][e],sub:(s,e)=>xI[s][ps.inv(e)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,e)=>Math.abs(s)*2<=Math.abs(e)?e>=0?ps.S:ps.N:Math.abs(e)*2<=Math.abs(s)?s>0?ps.E:ps.W:e>0?s>0?ps.SE:ps.SW:s>0?ps.NE:ps.NW,matrixAppendRotationInv:(s,e,i=0,n=0)=>{const r=$Q[ps.inv(e)];r.tx=i,r.ty=n,s.append(r)}};class Zh{constructor(e,i,n=0,r=0){this._x=n,this._y=r,this.cb=e,this.scope=i}clone(e=this.cb,i=this.scope){return new Zh(e,i,this._x,this._y)}set(e=0,i=e){return(this._x!==e||this._y!==i)&&(this._x=e,this._y=i,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Zh.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const _I=class{constructor(){this.worldTransform=new es,this.localTransform=new es,this.position=new Zh(this.onChange,this,0,0),this.scale=new Zh(this.onChange,this,1,1),this.pivot=new Zh(this.onChange,this,0,0),this.skew=new Zh(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const s=this.localTransform;this._localID!==this._currentLocalID&&(s.a=this._cx*this.scale.x,s.b=this._sx*this.scale.x,s.c=this._cy*this.scale.y,s.d=this._sy*this.scale.y,s.tx=this.position.x-(this.pivot.x*s.a+this.pivot.y*s.c),s.ty=this.position.y-(this.pivot.x*s.b+this.pivot.y*s.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(s){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==s._worldID){const i=s.worldTransform,n=this.worldTransform;n.a=e.a*i.a+e.b*i.c,n.b=e.a*i.b+e.b*i.d,n.c=e.c*i.a+e.d*i.c,n.d=e.c*i.b+e.d*i.d,n.tx=e.tx*i.a+e.ty*i.c+i.tx,n.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=s._worldID,this._worldID++}}setFromMatrix(s){s.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(s){this._rotation!==s&&(this._rotation=s,this.updateSkew())}};_I.IDENTITY=new _I;let DD=_I;DD.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var cbe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,hbe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Gz(s,e,i){const n=s.createShader(e);return s.shaderSource(n,i),s.compileShader(n),n}function xk(s){const e=new Array(s);for(let i=0;i<e.length;i++)e[i]=!1;return e}function UQ(s,e){switch(s){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return xk(2*e);case"bvec3":return xk(3*e);case"bvec4":return xk(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const D0=[{test:s=>s.type==="float"&&s.size===1&&!s.isArray,code:s=>`
            if(uv["${s}"] !== ud["${s}"].value)
            {
                ud["${s}"].value = uv["${s}"]
                gl.uniform1f(ud["${s}"].location, uv["${s}"])
            }
            `},{test:(s,e)=>(s.type==="sampler2D"||s.type==="samplerCube"||s.type==="sampler2DArray")&&s.size===1&&!s.isArray&&(e==null||e.castToBaseTexture!==void 0),code:s=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${s}"], t);

            if(ud["${s}"].value !== t)
            {
                ud["${s}"].value = t;
                gl.uniform1i(ud["${s}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(s,e)=>s.type==="mat3"&&s.size===1&&!s.isArray&&e.a!==void 0,code:s=>`
            gl.uniformMatrix3fv(ud["${s}"].location, false, uv["${s}"].toArray(true));
            `,codeUbo:s=>`
                var ${s}_matrix = uv.${s}.toArray(true);

                data[offset] = ${s}_matrix[0];
                data[offset+1] = ${s}_matrix[1];
                data[offset+2] = ${s}_matrix[2];
        
                data[offset + 4] = ${s}_matrix[3];
                data[offset + 5] = ${s}_matrix[4];
                data[offset + 6] = ${s}_matrix[5];
        
                data[offset + 8] = ${s}_matrix[6];
                data[offset + 9] = ${s}_matrix[7];
                data[offset + 10] = ${s}_matrix[8];
            `},{test:(s,e)=>s.type==="vec2"&&s.size===1&&!s.isArray&&e.x!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${s}"].location, v.x, v.y);
                }`,codeUbo:s=>`
                v = uv.${s};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:s=>s.type==="vec2"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${s}"].location, v[0], v[1]);
                }
            `},{test:(s,e)=>s.type==="vec4"&&s.size===1&&!s.isArray&&e.width!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${s}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(s,e)=>s.type==="vec4"&&s.size===1&&!s.isArray&&e.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${s}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(s,e)=>s.type==="vec3"&&s.size===1&&!s.isArray&&e.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${s}"].location, v.red, v.green, v.blue)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:s=>s.type==="vec4"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${s}"].location, v[0], v[1], v[2], v[3])
                }`}],ube={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},dbe={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function fbe(s,e){var n;const i=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in s.uniforms){const o=e[r];if(!o){((n=s.uniforms[r])==null?void 0:n.group)===!0&&(s.uniforms[r].ubo?i.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):i.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const a=s.uniforms[r];let l=!1;for(let h=0;h<D0.length;h++)if(D0[h].test(o,a)){i.push(D0[h].code(r,a)),l=!0;break}if(!l){const h=(o.size===1&&!o.isArray?ube:dbe)[o.type].replace("location",`ud["${r}"].location`);i.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",i.join(`
`))}const FQ={};let lg=FQ;function pbe(){if(lg===FQ||lg!=null&&lg.isContextLost()){const s=kt.ADAPTER.createCanvas();let e;kt.PREFER_ENV>=Em.WEBGL2&&(e=s.getContext("webgl2",{})),e||(e=s.getContext("webgl",{})||s.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),lg=e}return lg}let l1;function mbe(){if(!l1){l1=ll.MEDIUM;const s=pbe();if(s&&s.getShaderPrecisionFormat){const e=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT);e&&(l1=e.precision?ll.HIGH:ll.MEDIUM)}}return l1}function Qz(s,e){const i=s.getShaderSource(e).split(`
`).map((d,f)=>`${f}: ${d}`),n=s.getShaderInfoLog(e),r=n.split(`
`),o={},a=r.map(d=>parseFloat(d.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(d=>d&&!o[d]?(o[d]=!0,!0):!1),l=[""];a.forEach(d=>{i[d-1]=`%c${i[d-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=i.join(`
`);l[0]=h,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function gbe(s,e,i,n){s.getProgramParameter(e,s.LINK_STATUS)||(s.getShaderParameter(i,s.COMPILE_STATUS)||Qz(s,i),s.getShaderParameter(n,s.COMPILE_STATUS)||Qz(s,n),console.error("PixiJS Error: Could not initialize shader."),s.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",s.getProgramInfoLog(e)))}const ybe={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function zQ(s){return ybe[s]}let c1=null;const Yz={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function XQ(s,e){if(!c1){const i=Object.keys(Yz);c1={};for(let n=0;n<i.length;++n){const r=i[n];c1[s[r]]=Yz[r]}}return c1[e]}function jz(s,e,i){if(s.substring(0,9)!=="precision"){let n=e;return e===ll.HIGH&&i!==ll.HIGH&&(n=ll.MEDIUM),`precision ${n} float;
${s}`}else if(i!==ll.HIGH&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}let kv;function vbe(){if(typeof kv=="boolean")return kv;try{kv=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{kv=!1}return kv}let xbe=0;const h1={},bI=class i0{constructor(e,i,n="pixi-shader",r={}){this.extra={},this.id=xbe++,this.vertexSrc=e||i0.defaultVertexSrc,this.fragmentSrc=i||i0.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=r,this.vertexSrc.substring(0,8)!=="#version"&&(n=n.replace(/\s+/g,"-"),h1[n]?(h1[n]++,n+=`-${h1[n]}`):h1[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}
${this.fragmentSrc}`,this.vertexSrc=jz(this.vertexSrc,i0.defaultVertexPrecision,ll.HIGH),this.fragmentSrc=jz(this.fragmentSrc,i0.defaultFragmentPrecision,mbe())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return hbe}static get defaultFragmentSrc(){return cbe}static from(e,i,n){const r=e+i;let o=Fz[r];return o||(Fz[r]=o=new i0(e,i,n)),o}};bI.defaultVertexPrecision=ll.HIGH,bI.defaultFragmentPrecision=qh.apple.device?ll.HIGH:ll.MEDIUM;let Kh=bI,_be=0;class Kl{constructor(e,i,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=_be++,this.static=!!i,this.ubo=!!n,e instanceof Is?(this.buffer=e,this.buffer.type=Zc.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Is(new Float32Array(1)),this.buffer.type=Zc.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,i,n){if(!this.ubo)this.uniforms[e]=new Kl(i,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,i,n){return new Kl(e,i,n)}static uboFrom(e,i){return new Kl(e,i??!0,!0)}}class Jl{constructor(e,i){this.uniformBindCount=0,this.program=e,i?i instanceof Kl?this.uniformGroup=i:this.uniformGroup=new Kl(i):this.uniformGroup=new Kl({}),this.disposeRunner=new Zl("disposeShader")}checkUniformExists(e,i){if(i.uniforms[e])return!0;for(const n in i.uniforms){const r=i.uniforms[n];if(r.group===!0&&this.checkUniformExists(e,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,i,n){const r=Kh.from(e,i);return new Jl(r,n)}}class bbe{constructor(e,i){if(this.vertexSrc=e,this.fragTemplate=i,this.programCache={},this.defaultGroupCache={},!i.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!i.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const n=new Int32Array(e);for(let o=0;o<e;o++)n[o]=o;this.defaultGroupCache[e]=Kl.from({uSamplers:n},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${e}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Kh(this.vertexSrc,r)}const i={tint:new Float32Array([1,1,1,1]),translationMatrix:new es,default:this.defaultGroupCache[e]};return new Jl(this.programCache[e],i)}generateSampleSrc(e){let i="";i+=`
`,i+=`
`;for(let n=0;n<e;n++)n>0&&(i+=`
else `),n<e-1&&(i+=`if(vTextureId < ${n}.5)`),i+=`
{`,i+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,i+=`
}`;return i+=`
`,i+=`
`,i}}class wI{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function wbe(){return!qh.apple.device}function Obe(s){let e=!0;const i=kt.ADAPTER.getNavigator();if(qh.tablet||qh.phone){if(qh.apple.device){const n=i.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(e=!1)}if(qh.android.device){const n=i.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(e=!1)}}return e?s:4}class hA{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var Sbe=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Cbe=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const bx=class Ul extends hA{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=NQ,this.vertexSize=6,this.state=lh.for2d(),this.size=Ul.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Obe(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??wbe(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Yi("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Cbe}static get defaultFragmentTemplate(){return Sbe}setShaderGenerator({vertex:e=Ul.defaultVertexSrc,fragment:i=Ul.defaultFragmentTemplate}={}){this.shaderGenerator=new bbe(e,i)}contextChange(){const e=this.renderer.gl;kt.PREFER_ENV===Em.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Ul.defaultMaxTextures),this.maxTextures=J_e(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:i}=Ul,n=this.size/4,r=Math.floor(n/this.maxTextures)+1;for(;e.length<n;)e.push(new vI);for(;i.length<r;)i.push(new wI);for(let o=0;o<this.maxTextures;o++)this._tempBoundTextures[o]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:i}=this,n=Ul._textureArrayPool,r=this.renderer.batch,o=this._tempBoundTextures,a=this.renderer.textureGC.count;let l=++Mi._globalBatch,h=0,d=n[0],f=0;r.copyBoundTextures(o,i);for(let p=0;p<this._bufferSize;++p){const g=e[p];e[p]=null,g._batchEnabled!==l&&(d.count>=i&&(r.boundArray(d,o,l,i),this.buildDrawCalls(d,f,p),f=p,d=n[++h],++l),g._batchEnabled=l,g.touched=a,d.elements[d.count++]=g)}d.count>0&&(r.boundArray(d,o,l,i),this.buildDrawCalls(d,f,this._bufferSize),++h,++l);for(let p=0;p<o.length;p++)o[p]=null;Mi._globalBatch=l}buildDrawCalls(e,i,n){const{_bufferedElements:r,_attributeBuffer:o,_indexBuffer:a,vertexSize:l}=this,h=Ul._drawCallPool;let d=this._dcIndex,f=this._aIndex,p=this._iIndex,g=h[d];g.start=this._iIndex,g.texArray=e;for(let y=i;y<n;++y){const x=r[y],_=x._texture.baseTexture,w=BQ[_.alphaMode?1:0][x.blendMode];r[y]=null,i<y&&g.blend!==w&&(g.size=p-g.start,i=y,g=h[++d],g.texArray=e,g.start=p),this.packInterleavedGeometry(x,o,a,f,p),f+=x.vertexData.length/2*l,p+=x.indices.length,g.blend=w}i<n&&(g.size=p-g.start,++d),this._dcIndex=d,this._aIndex=f,this._iIndex=p}bindAndClearTexArray(e){const i=this.renderer.texture;for(let n=0;n<e.count;n++)i.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:i,_indexBuffer:n}=this;Ul.canUploadSameBuffer?(e[this._flushId]._buffer.update(i.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(i.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:i,state:n}=this.renderer,r=Ul._drawCallPool;let o=null;for(let a=0;a<e;a++){const{texArray:l,type:h,size:d,start:f,blend:p}=r[a];o!==l&&(o=l,this.bindAndClearTexArray(l)),this.state.blendMode=p,n.set(this.state),i.drawElements(h,d,i.UNSIGNED_SHORT,f*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Ul.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const i=EC(Math.ceil(e/8)),n=$z(i),r=i*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let o=this._aBuffers[r];return o||(this._aBuffers[r]=o=new mI(r*this.vertexSize*4)),o}getIndexBuffer(e){const i=EC(Math.ceil(e/12)),n=$z(i),r=i*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let o=this._iBuffers[n];return o||(this._iBuffers[n]=o=new Uint16Array(r)),o}packInterleavedGeometry(e,i,n,r,o){const{uint32View:a,float32View:l}=i,h=r/this.vertexSize,d=e.uvs,f=e.indices,p=e.vertexData,g=e._texture.baseTexture._batchLocation,y=Math.min(e.worldAlpha,1),x=Zn.shared.setValue(e._tintRGB).toPremultiplied(y,e._texture.baseTexture.alphaMode>0);for(let _=0;_<p.length;_+=2)l[r++]=p[_],l[r++]=p[_+1],l[r++]=d[_],l[r++]=d[_+1],a[r++]=x,l[r++]=g;for(let _=0;_<f.length;_++)n[o++]=h+f[_]}};bx.defaultBatchSize=4096,bx.extension={name:"batch",type:xt.RendererPlugin},bx._drawCallPool=[],bx._textureArrayPool=[];let xp=bx;$t.add(xp);var Tbe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Abe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const OI=class wx extends Jl{constructor(e,i,n){const r=Kh.from(e||wx.defaultVertexSrc,i||wx.defaultFragmentSrc);super(r,n),this.padding=0,this.resolution=wx.defaultResolution,this.multisample=wx.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new lh}apply(e,i,n,r,o){e.applyFilter(this,i,n,r)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return Abe}static get defaultFragmentSrc(){return Tbe}};OI.defaultResolution=1,OI.defaultMultisample=Hs.NONE;let bo=OI;class PC{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Zn(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:i,background:n,backgroundAlpha:r}=e,o=n??i;o!==void 0&&(this.color=o),this.alpha=r}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}PC.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},PC.extension={type:[xt.RendererSystem,xt.CanvasRendererSystem],name:"background"};$t.add(PC);class WQ{constructor(e){this.renderer=e,this.emptyRenderer=new hA(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,i){const{boundTextures:n}=this.renderer.texture;for(let r=i-1;r>=0;--r)e[r]=n[r]||null,e[r]&&(e[r]._batchLocation=r)}boundArray(e,i,n,r){const{elements:o,ids:a,count:l}=e;let h=0;for(let d=0;d<l;d++){const f=o[d],p=f._batchLocation;if(p>=0&&p<r&&i[p]===f){a[d]=p;continue}for(;h<r;){const g=i[h];if(g&&g._batchEnabled===n&&g._batchLocation===h){h++;continue}a[d]=h,f._batchLocation=h,i[h]=f;break}}}destroy(){this.renderer=null}}WQ.extension={type:xt.RendererSystem,name:"batch"};$t.add(WQ);let qz=0;class IC{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=qz++}init(e){if(e.context)this.initFromContext(e.context);else{const i=this.renderer.background.alpha<1,n=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:i,premultipliedAlpha:n,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=qz++,this.renderer.runners.contextChange.emit(e);const i=this.renderer.view;i.addEventListener!==void 0&&(i.addEventListener("webglcontextlost",this.handleContextLost,!1),i.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const i=this.createContext(this.renderer.view,e);this.initFromContext(i)}createContext(e,i){let n;if(kt.PREFER_ENV>=Em.WEBGL2&&(n=e.getContext("webgl2",i)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=e.getContext("webgl",i)||e.getContext("experimental-webgl",i),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,i={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,i,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,i,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const i=e.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),i&&!i.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=n||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}IC.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},IC.extension={type:xt.RendererSystem,name:"context"};$t.add(IC);class SI{constructor(e,i){if(this.width=Math.round(e),this.height=Math.round(i),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Zl("disposeFramebuffer"),this.multisample=Hs.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,i){return this.colorTextures[e]=i||new Mi(null,{scaleMode:jh.NEAREST,resolution:1,mipmap:nh.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new Mi(null,{scaleMode:jh.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:nh.OFF,format:rt.DEPTH_COMPONENT,type:qt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,i){if(e=Math.round(e),i=Math.round(i),!e||!i)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&i===this.height)){this.width=e,this.height=i,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const r=this.colorTextures[n],o=r.resolution;r.setSize(e/o,i/o)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,i/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class HQ extends Mi{constructor(e={}){if(typeof e=="number"){const i=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];e={width:i,height:n,scaleMode:r,resolution:o}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=Hs.NONE),super(null,e),this.mipmap=nh.OFF,this.valid=!0,this._clear=new Zn([0,0,0,0]),this.framebuffer=new SI(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,i){this.framebuffer.resize(e*this.resolution,i*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class gu extends v_{constructor(e){const i=e,n=i.naturalWidth||i.videoWidth||i.displayWidth||i.width,r=i.naturalHeight||i.videoHeight||i.displayHeight||i.height;super(n,r),this.source=e,this.noSubImage=!1}static crossOrigin(e,i,n){n===void 0&&!i.startsWith("data:")?e.crossOrigin=q_e(i):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}upload(e,i,n,r){const o=e.gl,a=i.realWidth,l=i.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===Yo.UNPACK),!this.noSubImage&&i.target===o.TEXTURE_2D&&n.width===a&&n.height===l?o.texSubImage2D(o.TEXTURE_2D,0,0,0,i.format,n.type,r):(n.width=a,n.height=l,o.texImage2D(i.target,0,n.internalFormat,i.format,n.type,r)),!0}update(){if(this.destroyed)return;const e=this.source,i=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(i,n),super.update()}dispose(){this.source=null}}class GQ extends gu{constructor(e,i){if(i=i||{},typeof e=="string"){const n=new Image;gu.crossOrigin(n,e,i.crossorigin),n.src=e,e=n}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(i.createBitmap??kt.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,this.bitmap=null,this._load=null,i.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((i,n)=>{const r=this.source;this.url=r.src;const o=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.update(),this._load=null,this.createBitmap?i(this.process()):i(this))};r.complete&&r.src?o():(r.onload=o,r.onerror=a=>{n(a),this.onError.emit(a)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const i=globalThis.createImageBitmap,n=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then(r=>r.blob()).then(r=>i(r,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Yo.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,i,n){if(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,i,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,i,n,this.bitmap),!this.preserveBitmap){let r=!0;const o=i._glTextures;for(const a in o){const l=o[a];if(l!==n&&l.dirtyId!==i.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class LD{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,i,n){const r=i.width,o=i.height;if(n){const a=e.width/2/r,l=e.height/2/o,h=e.x/r+a,d=e.y/o+l;n=ps.add(n,ps.NW),this.x0=h+a*ps.uX(n),this.y0=d+l*ps.uY(n),n=ps.add(n,2),this.x1=h+a*ps.uX(n),this.y1=d+l*ps.uY(n),n=ps.add(n,2),this.x2=h+a*ps.uX(n),this.y2=d+l*ps.uY(n),n=ps.add(n,2),this.x3=h+a*ps.uX(n),this.y3=d+l*ps.uY(n)}else this.x0=e.x/r,this.y0=e.y/o,this.x1=(e.x+e.width)/r,this.y1=e.y/o,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/o,this.x3=e.x/r,this.y3=(e.y+e.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}LD.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Zz=new LD;function u1(s){s.destroy=function(){},s.on=function(){},s.once=function(){},s.emit=function(){}}let Wi=class Xn extends mb{constructor(e,i,n,r,o,a,l){if(super(),this.noFrame=!1,i||(this.noFrame=!0,i=new Pi(0,0,1,1)),e instanceof Xn&&(e=e.baseTexture),this.baseTexture=e,this._frame=i,this.trim=r,this.valid=!1,this.destroyed=!1,this._uvs=Zz,this.uvMatrix=null,this.orig=n||i,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new si(a.x,a.y):new si(0,0),this.defaultBorders=l,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=i:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:i}=this.baseTexture;i!=null&&i.url&&kc[i.url]&&Xn.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Xn.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var r;const e=this._frame.clone(),i=this._frame===this.orig?e:this.orig.clone(),n=new Xn(this.baseTexture,!this.noFrame&&e,i,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=e),n}updateUvs(){this._uvs===Zz&&(this._uvs=new LD),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,i={},n=kt.STRICT_TEXTURE_CACHE){const r=typeof e=="string";let o=null;if(r)o=e;else if(e instanceof Mi){if(!e.cacheId){const l=(i==null?void 0:i.pixiIdPrefix)||"pixiid";e.cacheId=`${l}-${fm()}`,Mi.addToCache(e,e.cacheId)}o=e.cacheId}else{if(!e._pixiId){const l=(i==null?void 0:i.pixiIdPrefix)||"pixiid";e._pixiId=`${l}_${fm()}`}o=e._pixiId}let a=kc[o];if(r&&n&&!a)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return!a&&!(e instanceof Mi)?(i.resolution||(i.resolution=pu(e)),a=new Xn(new Mi(e,i)),a.baseTexture.cacheId=o,Mi.addToCache(a.baseTexture,o),Xn.addToCache(a,o)):!a&&e instanceof Mi&&(a=new Xn(e),Xn.addToCache(a,o)),a}static fromURL(e,i){const n=Object.assign({autoLoad:!1},i==null?void 0:i.resourceOptions),r=Xn.from(e,Object.assign({resourceOptions:n},i),!1),o=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):o.load().then(()=>Promise.resolve(r))}static fromBuffer(e,i,n,r){return new Xn(Mi.fromBuffer(e,i,n,r))}static fromLoader(e,i,n,r){const o=new Mi(e,Object.assign({scaleMode:Mi.defaultOptions.scaleMode,resolution:pu(i)},r)),{resource:a}=o;a instanceof GQ&&(a.url=i);const l=new Xn(o);return n||(n=i),Mi.addToCache(l.baseTexture,n),Xn.addToCache(l,n),n!==i&&(Mi.addToCache(l.baseTexture,i),Xn.addToCache(l,i)),l.baseTexture.valid?Promise.resolve(l):new Promise(h=>{l.baseTexture.once("loaded",()=>h(l))})}static addToCache(e,i){i&&(e.textureCacheIds.includes(i)||e.textureCacheIds.push(i),kc[i]&&kc[i]!==e&&console.warn(`Texture added to the cache with an id [${i}] that already had an entry`),kc[i]=e)}static removeFromCache(e){if(typeof e=="string"){const i=kc[e];if(i){const n=i.textureCacheIds.indexOf(e);return n>-1&&i.textureCacheIds.splice(n,1),delete kc[e],i}}else if(e!=null&&e.textureCacheIds){for(let i=0;i<e.textureCacheIds.length;++i)kc[e.textureCacheIds[i]]===e&&delete kc[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:i,y:n,width:r,height:o}=e,a=i+r>this.baseTexture.width,l=n+o>this.baseTexture.height;if(a||l){const h=a&&l?"and":"or",d=`X: ${i} + ${r} = ${i+r} > ${this.baseTexture.width}`,f=`Y: ${n} + ${o} = ${n+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${d} ${h} ${f}`)}this.valid=r&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Xn._EMPTY||(Xn._EMPTY=new Xn(new Mi),u1(Xn._EMPTY),u1(Xn._EMPTY.baseTexture)),Xn._EMPTY}static get WHITE(){if(!Xn._WHITE){const e=kt.ADAPTER.createCanvas(16,16),i=e.getContext("2d");e.width=16,e.height=16,i.fillStyle="white",i.fillRect(0,0,16,16),Xn._WHITE=new Xn(Mi.from(e)),u1(Xn._WHITE),u1(Xn._WHITE.baseTexture)}return Xn._WHITE}};class Mm extends Wi{constructor(e,i){super(e,i),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,i,n=!0){const r=this.baseTexture.resolution,o=Math.round(e*r)/r,a=Math.round(i*r)/r;this.valid=o>0&&a>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=a,n&&this.baseTexture.resize(o,a),this.updateUvs()}setResolution(e){const{baseTexture:i}=this;i.resolution!==e&&(i.setResolution(e),this.resize(i.width,i.height,!1))}static create(e){return new Mm(new HQ(e))}}class QQ{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,i,n=Hs.NONE){const r=new HQ(Object.assign({width:e,height:i,resolution:1,multisample:n},this.textureOptions));return new Mm(r)}getOptimalTexture(e,i,n=1,r=Hs.NONE){let o;e=Math.max(Math.ceil(e*n-1e-6),1),i=Math.max(Math.ceil(i*n-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||i!==this._pixelsHeight?(e=EC(e),i=EC(i),o=((e&65535)<<16|i&65535)>>>0,r>1&&(o+=r*4294967296)):o=r>1?-r:-1,this.texturePool[o]||(this.texturePool[o]=[]);let a=this.texturePool[o].pop();return a||(a=this.createTexture(e,i,r)),a.filterPoolKey=o,a.setResolution(n),a}getFilterTexture(e,i,n){const r=this.getOptimalTexture(e.width,e.height,i||e.resolution,n||Hs.NONE);return r.filterFrame=e.filterFrame,r}returnTexture(e){const i=e.filterPoolKey;e.filterFrame=null,this.texturePool[i].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const i in this.texturePool){const n=this.texturePool[i];if(n)for(let r=0;r<n.length;r++)n[r].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const i in this.texturePool){if(!(Number(i)<0))continue;const n=this.texturePool[i];if(n)for(let r=0;r<n.length;r++)n[r].destroy(!0);this.texturePool[i]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}QQ.SCREEN_KEY=-1;class Ebe extends mu{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class YQ extends mu{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Is(this.vertices),this.uvBuffer=new Is(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,i){let n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+i.width/e.width,this.uvs[3]=r,this.uvs[4]=n+i.width/e.width,this.uvs[5]=r+i.height/e.height,this.uvs[6]=n,this.uvs[7]=r+i.height/e.height,n=i.x,r=i.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+i.width,this.vertices[3]=r,this.vertices[4]=n+i.width,this.vertices[5]=r+i.height,this.vertices[6]=n,this.vertices[7]=r+i.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Mbe{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Hs.NONE,this.sourceFrame=new Pi,this.destinationFrame=new Pi,this.bindingSourceFrame=new Pi,this.bindingDestinationFrame=new Pi,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const d1=[new si,new si,new si,new si],_k=new es;class jQ{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new QQ,this.statePool=[],this.quad=new Ebe,this.quadUv=new YQ,this.tempRect=new Pi,this.activeState={},this.globalUniforms=new Kl({outputFrame:new Pi,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,i){const n=this.renderer,r=this.defaultFilterStack,o=this.statePool.pop()||new Mbe,a=n.renderTexture;let l,h;if(a.current){const w=a.current;l=w.resolution,h=w.multisample}else l=n.resolution,h=n.multisample;let d=i[0].resolution||l,f=i[0].multisample??h,p=i[0].padding,g=i[0].autoFit,y=i[0].legacy??!0;for(let w=1;w<i.length;w++){const O=i[w];d=Math.min(d,O.resolution||l),f=Math.min(f,O.multisample??h),p=this.useMaxPadding?Math.max(p,O.padding):p+O.padding,g=g&&O.autoFit,y=y||(O.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),r.push(o),o.resolution=d,o.multisample=f,o.legacy=y,o.target=e,o.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),o.sourceFrame.pad(p);const x=this.tempRect.copyFrom(a.sourceFrame);n.projection.transform&&this.transformAABB(_k.copyFrom(n.projection.transform).invert(),x),g?(o.sourceFrame.fit(x),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(x)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,a.current?a.current.resolution:n.resolution,a.sourceFrame,a.destinationFrame,n.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,d,f),o.filters=i,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;const _=this.tempRect;_.x=0,_.y=0,_.width=o.sourceFrame.width,_.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(a.sourceFrame),o.bindingDestinationFrame.copyFrom(a.destinationFrame),o.transform=n.projection.transform,n.projection.transform=null,a.bind(o.renderTexture,o.sourceFrame,_),n.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,i=e.pop(),n=i.filters;this.activeState=i;const r=this.globalUniforms.uniforms;r.outputFrame=i.sourceFrame,r.resolution=i.resolution;const o=r.inputSize,a=r.inputPixel,l=r.inputClamp;if(o[0]=i.destinationFrame.width,o[1]=i.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],a[0]=Math.round(o[0]*i.resolution),a[1]=Math.round(o[1]*i.resolution),a[2]=1/a[0],a[3]=1/a[1],l[0]=.5*a[2],l[1]=.5*a[3],l[2]=i.sourceFrame.width*o[2]-.5*a[2],l[3]=i.sourceFrame.height*o[3]-.5*a[3],i.legacy){const d=r.filterArea;d[0]=i.destinationFrame.width,d[1]=i.destinationFrame.height,d[2]=i.sourceFrame.x,d[3]=i.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const h=e[e.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,i.renderTexture,h.renderTexture,Uc.BLEND,i),this.returnFilterTexture(i.renderTexture);else{let d=i.renderTexture,f=this.getOptimalFilterTexture(d.width,d.height,i.resolution);f.filterFrame=d.filterFrame;let p=0;for(p=0;p<n.length-1;++p){p===1&&i.multisample>1&&(f=this.getOptimalFilterTexture(d.width,d.height,i.resolution),f.filterFrame=d.filterFrame),n[p].apply(this,d,f,Uc.CLEAR,i);const g=d;d=f,f=g}n[p].apply(this,d,h.renderTexture,Uc.BLEND,i),p>1&&i.multisample>1&&this.returnFilterTexture(i.renderTexture),this.returnFilterTexture(d),this.returnFilterTexture(f)}i.clear(),this.statePool.push(i)}bindAndClear(e,i=Uc.CLEAR){const{renderTexture:n,state:r}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const a=this.tempRect;a.x=0,a.y=0,a.width=e.filterFrame.width,a.height=e.filterFrame.height,n.bind(e,e.filterFrame,a)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const o=r.stateId&1||this.forceClear;(i===Uc.CLEAR||i===Uc.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,i,n,r){const o=this.renderer;o.state.set(e.state),this.bindAndClear(n,r),e.uniforms.uSampler=i,e.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(i._frame,i.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(Gc.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(Gc.TRIANGLE_STRIP))}calculateSpriteMatrix(e,i){const{sourceFrame:n,destinationFrame:r}=this.activeState,{orig:o}=i._texture,a=e.set(r.width,0,0,r.height,n.x,n.y),l=i.worldTransform.copyTo(es.TEMP_MATRIX);return l.invert(),a.prepend(l),a.scale(1/o.width,1/o.height),a.translate(i.anchor.x,i.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,i,n=1,r=Hs.NONE){return this.texturePool.getOptimalTexture(e,i,n,r)}getFilterTexture(e,i,n){if(typeof e=="number"){const o=e;e=i,i=o}e=e||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(e.width,e.height,i||e.resolution,n||Hs.NONE);return r.filterFrame=e.filterFrame,r}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,i){const n=d1[0],r=d1[1],o=d1[2],a=d1[3];n.set(i.left,i.top),r.set(i.left,i.bottom),o.set(i.right,i.top),a.set(i.right,i.bottom),e.apply(n,n),e.apply(r,r),e.apply(o,o),e.apply(a,a);const l=Math.min(n.x,r.x,o.x,a.x),h=Math.min(n.y,r.y,o.y,a.y),d=Math.max(n.x,r.x,o.x,a.x),f=Math.max(n.y,r.y,o.y,a.y);i.x=l,i.y=h,i.width=d-l,i.height=f-h}roundFrame(e,i,n,r,o){if(!(e.width<=0||e.height<=0||n.width<=0||n.height<=0)){if(o){const{a,b:l,c:h,d}=o;if((Math.abs(l)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(d)>1e-4))return}o=o?_k.copyFrom(o):_k.identity(),o.translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.transformAABB(o,e),e.ceil(i),this.transformAABB(o.invert(),e)}}}jQ.extension={type:xt.RendererSystem,name:"filter"};$t.add(jQ);class kbe{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Hs.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Pbe=new Pi;class qQ{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new SI(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Pi,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let i=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;kt.PREFER_ENV===Em.WEBGL_LEGACY&&(i=null,n=null),i?e.drawBuffers=r=>i.drawBuffersWEBGL(r):(this.hasMRT=!1,e.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,i,n=0){const{gl:r}=this;if(e){const o=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==n&&(e.dirtyId++,e.dirtyFormat++,o.mipLevel=n),o.dirtyId!==e.dirtyId&&(o.dirtyId=e.dirtyId,o.dirtyFormat!==e.dirtyFormat?(o.dirtyFormat=e.dirtyFormat,o.dirtySize=e.dirtySize,this.updateFramebuffer(e,n)):o.dirtySize!==e.dirtySize&&(o.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let a=0;a<e.colorTextures.length;a++){const l=e.colorTextures[a];this.renderer.texture.unbind(l.parentTextureArray||l)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),i){const a=i.width>>n,l=i.height>>n,h=a/i.width;this.setViewport(i.x*h,i.y*h,a,l)}else{const a=e.width>>n,l=e.height>>n;this.setViewport(0,0,a,l)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),i?this.setViewport(i.x,i.y,i.width,i.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,i,n,r){const o=this.viewport;e=Math.round(e),i=Math.round(i),n=Math.round(n),r=Math.round(r),(o.width!==n||o.height!==r||o.x!==e||o.y!==i)&&(o.x=e,o.y=i,o.width=n,o.height=r,this.gl.viewport(e,i,n,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,i,n,r,o=K2.COLOR|K2.DEPTH){const{gl:a}=this;a.clearColor(e,i,n,r),a.clear(o)}initFramebuffer(e){const{gl:i}=this,n=new kbe(i.createFramebuffer());return n.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(e),e.disposeRunner.add(this),n}resizeFramebuffer(e){const{gl:i}=this,n=e.glFramebuffers[this.CONTEXT_UID];if(n.stencil){i.bindRenderbuffer(i.RENDERBUFFER,n.stencil);let a;this.renderer.context.webGLVersion===1?a=i.DEPTH_STENCIL:e.depth&&e.stencil?a=i.DEPTH24_STENCIL8:e.depth?a=i.DEPTH_COMPONENT24:a=i.STENCIL_INDEX8,n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,a,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,a,e.width,e.height)}const r=e.colorTextures;let o=r.length;i.drawBuffers||(o=Math.min(o,1));for(let a=0;a<o;a++){const l=r[a],h=l.parentTextureArray||l;this.renderer.texture.bind(h,0),a===0&&n.msaaBuffer&&(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,i){const{gl:n}=this,r=e.glFramebuffers[this.CONTEXT_UID],o=e.colorTextures;let a=o.length;n.drawBuffers||(a=Math.min(a,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?r.msaaBuffer=r.msaaBuffer||n.createRenderbuffer():r.msaaBuffer&&(n.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const l=[];for(let h=0;h<a;h++){const d=o[h],f=d.parentTextureArray||d;this.renderer.texture.bind(f,0),h===0&&r.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,f._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,r.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+h,d.target,f._glTextures[this.CONTEXT_UID].texture,i),l.push(n.COLOR_ATTACHMENT0+h))}if(l.length>1&&n.drawBuffers(l),e.depthTexture&&this.writeDepthTexture){const h=e.depthTexture;this.renderer.texture.bind(h,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,i)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){r.stencil=r.stencil||n.createRenderbuffer();let h,d;this.renderer.context.webGLVersion===1?(h=n.DEPTH_STENCIL_ATTACHMENT,d=n.DEPTH_STENCIL):e.depth&&e.stencil?(h=n.DEPTH_STENCIL_ATTACHMENT,d=n.DEPTH24_STENCIL8):e.depth?(h=n.DEPTH_ATTACHMENT,d=n.DEPTH_COMPONENT24):(h=n.STENCIL_ATTACHMENT,d=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,d,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,d,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,h,n.RENDERBUFFER,r.stencil)}else r.stencil&&(n.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:i}=this;let n=Hs.NONE;if(e<=1||i===null)return n;for(let r=0;r<i.length;r++)if(i[r]<=e){n=i[r];break}return n===1&&(n=Hs.NONE),n}blit(e,i,n){const{current:r,renderer:o,gl:a,CONTEXT_UID:l}=this;if(o.context.webGLVersion!==2||!r)return;const h=r.glFramebuffers[l];if(!h)return;if(!e){if(!h.msaaBuffer)return;const f=r.colorTextures[0];if(!f)return;h.blitFramebuffer||(h.blitFramebuffer=new SI(r.width,r.height),h.blitFramebuffer.addColorTexture(0,f)),e=h.blitFramebuffer,e.colorTextures[0]!==f&&(e.colorTextures[0]=f,e.dirtyId++,e.dirtyFormat++),(e.width!==r.width||e.height!==r.height)&&(e.width=r.width,e.height=r.height,e.dirtyId++,e.dirtySize++)}i||(i=Pbe,i.width=r.width,i.height=r.height),n||(n=i);const d=i.width===n.width&&i.height===n.height;this.bind(e),a.bindFramebuffer(a.READ_FRAMEBUFFER,h.framebuffer),a.blitFramebuffer(i.left,i.top,i.right,i.bottom,n.left,n.top,n.right,n.bottom,a.COLOR_BUFFER_BIT,d?a.NEAREST:a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,i){const n=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!n)return;delete e.glFramebuffers[this.CONTEXT_UID];const o=this.managedFramebuffers.indexOf(e);o>=0&&this.managedFramebuffers.splice(o,1),e.disposeRunner.remove(this),i||(r.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&r.deleteRenderbuffer(n.msaaBuffer),n.stencil&&r.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,i)}disposeAll(e){const i=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<i.length;n++)this.disposeFramebuffer(i[n],e)}forceStencil(){const e=this.current;if(!e)return;const i=e.glFramebuffers[this.CONTEXT_UID];if(!i||i.stencil&&e.stencil)return;e.stencil=!0;const n=e.width,r=e.height,o=this.gl,a=i.stencil=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,a);let l,h;this.renderer.context.webGLVersion===1?(l=o.DEPTH_STENCIL_ATTACHMENT,h=o.DEPTH_STENCIL):e.depth?(l=o.DEPTH_STENCIL_ATTACHMENT,h=o.DEPTH24_STENCIL8):(l=o.STENCIL_ATTACHMENT,h=o.STENCIL_INDEX8),i.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,i.multisample,h,n,r):o.renderbufferStorage(o.RENDERBUFFER,h,n,r),o.framebufferRenderbuffer(o.FRAMEBUFFER,l,o.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Pi}destroy(){this.renderer=null}}qQ.extension={type:xt.RendererSystem,name:"framebuffer"};$t.add(qQ);const bk={5126:4,5123:2,5121:1};class ZQ{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,i=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,i.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;kt.PREFER_ENV===Em.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=()=>n.createVertexArrayOES(),e.bindVertexArray=r=>n.bindVertexArrayOES(r),e.deleteVertexArray=r=>n.deleteVertexArrayOES(r)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(i.webGLVersion!==2){const n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=(r,o)=>n.vertexAttribDivisorANGLE(r,o),e.drawElementsInstanced=(r,o,a,l,h)=>n.drawElementsInstancedANGLE(r,o,a,l,h),e.drawArraysInstanced=(r,o,a,l)=>n.drawArraysInstancedANGLE(r,o,a,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=i.webGLVersion===2||!!i.extensions.uint32ElementIndex}bind(e,i){i=i||this.renderer.shader.shader;const{gl:n}=this;let r=e.glVertexArrayObjects[this.CONTEXT_UID],o=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},o=!0);const a=r[i.program.id]||this.initGeometryVao(e,i,o);this._activeGeometry=e,this._activeVao!==a&&(this._activeVao=a,this.hasVao?n.bindVertexArray(a):this.activateVao(e,i.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,i=this.renderer.buffer;for(let n=0;n<e.buffers.length;n++){const r=e.buffers[n];i.update(r)}}checkCompatibility(e,i){const n=e.attributes,r=i.attributeData;for(const o in r)if(!n[o])throw new Error(`shader and geometry incompatible, geometry missing the "${o}" attribute`)}getSignature(e,i){const n=e.attributes,r=i.attributeData,o=["g",e.id];for(const a in n)r[a]&&o.push(a,r[a].location);return o.join("-")}initGeometryVao(e,i,n=!0){const r=this.gl,o=this.CONTEXT_UID,a=this.renderer.buffer,l=i.program;l.glPrograms[o]||this.renderer.shader.generateProgram(i),this.checkCompatibility(e,l);const h=this.getSignature(e,l),d=e.glVertexArrayObjects[this.CONTEXT_UID];let f=d[h];if(f)return d[l.id]=f,f;const p=e.buffers,g=e.attributes,y={},x={};for(const _ in p)y[_]=0,x[_]=0;for(const _ in g)!g[_].size&&l.attributeData[_]?g[_].size=l.attributeData[_].size:g[_].size||console.warn(`PIXI Geometry attribute '${_}' size cannot be determined (likely the bound shader does not have the attribute)`),y[g[_].buffer]+=g[_].size*bk[g[_].type];for(const _ in g){const w=g[_],O=w.size;w.stride===void 0&&(y[w.buffer]===O*bk[w.type]?w.stride=0:w.stride=y[w.buffer]),w.start===void 0&&(w.start=x[w.buffer],x[w.buffer]+=O*bk[w.type])}f=r.createVertexArray(),r.bindVertexArray(f);for(let _=0;_<p.length;_++){const w=p[_];a.bind(w),n&&w._glBuffers[o].refCount++}return this.activateVao(e,l),d[l.id]=f,d[h]=f,r.bindVertexArray(null),a.unbind(Zc.ARRAY_BUFFER),f}disposeGeometry(e,i){var l;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const n=e.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,o=e.buffers,a=(l=this.renderer)==null?void 0:l.buffer;if(e.disposeRunner.remove(this),!!n){if(a)for(let h=0;h<o.length;h++){const d=o[h]._glBuffers[this.CONTEXT_UID];d&&(d.refCount--,d.refCount===0&&!i&&a.dispose(o[h],i))}if(!i){for(const h in n)if(h[0]==="g"){const d=n[h];this._activeVao===d&&this.unbind(),r.deleteVertexArray(d)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const i=Object.keys(this.managedGeometries);for(let n=0;n<i.length;n++)this.disposeGeometry(this.managedGeometries[i[n]],e)}activateVao(e,i){const n=this.gl,r=this.CONTEXT_UID,o=this.renderer.buffer,a=e.buffers,l=e.attributes;e.indexBuffer&&o.bind(e.indexBuffer);let h=null;for(const d in l){const f=l[d],p=a[f.buffer],g=p._glBuffers[r];if(i.attributeData[d]){h!==g&&(o.bind(p),h=g);const y=i.attributeData[d].location;if(n.enableVertexAttribArray(y),n.vertexAttribPointer(y,f.size,f.type||n.FLOAT,f.normalized,f.stride,f.start),f.instance)if(this.hasInstance)n.vertexAttribDivisor(y,f.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,i,n,r){const{gl:o}=this,a=this._activeGeometry;if(a.indexBuffer){const l=a.indexBuffer.data.BYTES_PER_ELEMENT,h=l===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?a.instanced?o.drawElementsInstanced(e,i||a.indexBuffer.data.length,h,(n||0)*l,r||1):o.drawElements(e,i||a.indexBuffer.data.length,h,(n||0)*l):console.warn("unsupported index buffer type: uint32")}else a.instanced?o.drawArraysInstanced(e,n,i||a.getSize(),r||1):o.drawArrays(e,n,i||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}ZQ.extension={type:xt.RendererSystem,name:"geometry"};$t.add(ZQ);const Kz=new es;class KQ{constructor(e,i){this._texture=e,this.mapCoord=new es,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof i>"u"?.5:i,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,i){i===void 0&&(i=e);const n=this.mapCoord;for(let r=0;r<e.length;r+=2){const o=e[r],a=e[r+1];i[r]=o*n.a+a*n.c+n.tx,i[r+1]=o*n.b+a*n.d+n.ty}return i}update(e){const i=this._texture;if(!i||!i.valid||!e&&this._textureID===i._updateID)return!1;this._textureID=i._updateID,this._updateID++;const n=i._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const r=i.orig,o=i.trim;o&&(Kz.set(r.width/o.width,0,0,r.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(Kz));const a=i.baseTexture,l=this.uClampFrame,h=this.clampMargin/a.resolution,d=this.clampOffset;return l[0]=(i._frame.x+h+d)/a.width,l[1]=(i._frame.y+h+d)/a.height,l[2]=(i._frame.x+i._frame.width-h+d)/a.width,l[3]=(i._frame.y+i._frame.height-h+d)/a.height,this.uClampOffset[0]=d/a.realWidth,this.uClampOffset[1]=d/a.realHeight,this.isSimple=i._frame.width===a.width&&i._frame.height===a.height&&i.rotate===0,!0}}var Ibe=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Bbe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Rbe extends bo{constructor(e,i,n){let r=null;typeof e!="string"&&i===void 0&&n===void 0&&(r=e,e=void 0,i=void 0,n=void 0),super(e||Bbe,i||Ibe,n),this.maskSprite=r,this.maskMatrix=new es}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,i,n,r){const o=this._maskSprite,a=o._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new KQ(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,o).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,e.applyFilter(this,i,n,r))}}class Dbe{constructor(e=null){this.type=ir.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=bo.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=ir.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class JQ{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,i){let n=i;if(!n.isMaskData){const o=this.maskDataPool.pop()||new Dbe;o.pooled=!0,o.maskObject=i,n=o}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(r),n._colorMask=r?r._colorMask:15,n.autoDetect&&this.detect(n),n._target=e,n.type!==ir.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case ir.SCISSOR:this.renderer.scissor.push(n);break;case ir.STENCIL:this.renderer.stencil.push(n);break;case ir.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case ir.COLOR:this.pushColorMask(n);break}n.type===ir.SPRITE&&this.maskStack.push(n)}pop(e){const i=this.maskStack.pop();if(!(!i||i._target!==e)){if(i.enabled)switch(i.type){case ir.SCISSOR:this.renderer.scissor.pop(i);break;case ir.STENCIL:this.renderer.stencil.pop(i.maskObject);break;case ir.SPRITE:this.popSpriteMask(i);break;case ir.COLOR:this.popColorMask(i);break}if(i.reset(),i.pooled&&this.maskDataPool.push(i),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===ir.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(e){const i=e.maskObject;i?i.isSprite?e.type=ir.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=ir.SCISSOR:e.type=ir.STENCIL:e.type=ir.COLOR}pushSpriteMask(e){const{maskObject:i}=e,n=e._target;let r=e._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Rbe])),r[0].resolution=e.resolution,r[0].multisample=e.multisample,r[0].maskSprite=i;const o=n.filterArea;n.filterArea=i.getBounds(!0),this.renderer.filter.push(n,r),n.filterArea=o,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const i=e._colorMask,n=e._colorMask=i&e.colorMask;n!==i&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(e){const i=e._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==i&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}JQ.extension={type:xt.RendererSystem,name:"mask"};$t.add(JQ);class e7{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:i}=this.renderer,n=this.getStackLength();this.maskStack=e;const r=this.getStackLength();r!==n&&(r===0?i.disable(this.glConst):(i.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Jz=new es,e4=[],t7=class BS extends e7{constructor(e){super(e),this.glConst=kt.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const i=e._scissorRect,{maskObject:n}=e,{renderer:r}=this,o=r.renderTexture,a=n.getBounds(!0,e4.pop()??new Pi);this.roundFrameToPixels(a,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),i&&a.fit(i),e._scissorRectLocal=a}static isMatrixRotated(e){if(!e)return!1;const{a:i,b:n,c:r,d:o}=e;return(Math.abs(n)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(i)>1e-4||Math.abs(o)>1e-4)}testScissor(e){const{maskObject:i}=e;if(!i.isFastRect||!i.isFastRect()||BS.isMatrixRotated(i.worldTransform)||BS.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const n=e._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(e,i,n,r,o){BS.isMatrixRotated(o)||(o=o?Jz.copyFrom(o):Jz.identity(),o.translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.renderer.filter.transformAABB(o,e),e.fit(r),e.x=Math.round(e.x*i),e.y=Math.round(e.y*i),e.width=Math.round(e.width*i),e.height=Math.round(e.height*i))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:i}=this.renderer;e._scissorRect||i.enable(i.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:i}=this.renderer;e&&e4.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():i.disable(i.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let i;this.renderer.renderTexture.current?i=e.y:i=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,i,e.width,e.height)}};t7.extension={type:xt.RendererSystem,name:"scissor"};let Lbe=t7;$t.add(Lbe);class i7 extends e7{constructor(e){super(e),this.glConst=kt.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const i=e.maskObject,{gl:n}=this.renderer,r=e._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),e._stencilCounter++;const o=e._colorMask;o!==0&&(e._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,r,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),i.renderable=!0,i.render(this.renderer),this.renderer.batch.flush(),i.renderable=!1,o!==0&&(e._colorMask=o,n.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()}pop(e){const i=this.renderer.gl;if(this.getStackLength()===0)i.disable(i.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=n?n._colorMask:15;r!==0&&(n._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilOp(i.KEEP,i.KEEP,i.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,r!==0&&(n._colorMask=r,i.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}i7.extension={type:xt.RendererSystem,name:"stencil"};$t.add(i7);class n7{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Yi("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return Yi("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return Yi("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const i in e)this.plugins[i]=new e[i](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}n7.extension={type:[xt.RendererSystem,xt.CanvasRendererSystem],name:"_plugin"};$t.add(n7);class s7{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new es,this.transform=null}update(e,i,n,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=i||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);const o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(e,i,n,r){const o=this.projectionMatrix,a=r?-1:1;o.identity(),o.a=1/i.width*2,o.d=a*(1/i.height*2),o.tx=-1-i.x*o.a,o.ty=-a-i.y*o.d}setTransform(e){}destroy(){this.renderer=null}}s7.extension={type:xt.RendererSystem,name:"projection"};$t.add(s7);const Nbe=new DD,t4=new Pi;class r7{constructor(e){this.renderer=e,this._tempMatrix=new es}generateTexture(e,i){const{region:n,...r}=i||{},o=(n==null?void 0:n.copyTo(t4))||e.getLocalBounds(t4,!0),a=r.resolution||this.renderer.resolution;o.width=Math.max(o.width,1/a),o.height=Math.max(o.height,1/a),r.width=o.width,r.height=o.height,r.resolution=a,r.multisample??(r.multisample=this.renderer.multisample);const l=Mm.create(r);this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;const h=e.transform;return e.transform=Nbe,this.renderer.render(e,{renderTexture:l,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=h,l}destroy(){}}r7.extension={type:[xt.RendererSystem,xt.CanvasRendererSystem],name:"textureGenerator"};$t.add(r7);const zf=new Pi,Pv=new Pi;class o7{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Pi,this.destinationFrame=new Pi,this.viewportFrame=new Pi}contextChange(){var i;const e=(i=this.renderer)==null?void 0:i.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,i,n){const r=this.renderer;this.current=e;let o,a,l;e?(o=e.baseTexture,l=o.resolution,i||(zf.width=e.frame.width,zf.height=e.frame.height,i=zf),n||(Pv.x=e.frame.x,Pv.y=e.frame.y,Pv.width=i.width,Pv.height=i.height,n=Pv),a=o.framebuffer):(l=r.resolution,i||(zf.width=r._view.screen.width,zf.height=r._view.screen.height,i=zf),n||(n=zf,n.width=i.width,n.height=i.height));const h=this.viewportFrame;h.x=n.x*l,h.y=n.y*l,h.width=n.width*l,h.height=n.height*l,e||(h.y=r.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(a,h),this.renderer.projection.update(n,i,l,!a),e?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(i),this.destinationFrame.copyFrom(n)}clear(e,i){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=Zn.shared.setValue(e||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const o=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,l=o.width!==a.width||o.height!==a.height;if(l){let{x:h,y:d,width:f,height:p}=this.viewportFrame;h=Math.round(h),d=Math.round(d),f=Math.round(f),p=Math.round(p),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,d,f,p)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,i),l&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}o7.extension={type:xt.RendererSystem,name:"renderTexture"};$t.add(o7);class Vbe{constructor(e,i){this.program=e,this.uniformData=i,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function $be(s,e){const i={},n=e.getProgramParameter(s,e.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const o=e.getActiveAttrib(s,r);if(o.name.startsWith("gl_"))continue;const a=XQ(e,o.type),l={type:a,name:o.name,size:zQ(a),location:e.getAttribLocation(s,o.name)};i[o.name]=l}return i}function Ube(s,e){const i={},n=e.getProgramParameter(s,e.ACTIVE_UNIFORMS);for(let r=0;r<n;r++){const o=e.getActiveUniform(s,r),a=o.name.replace(/\[.*?\]$/,""),l=!!o.name.match(/\[.*?\]$/),h=XQ(e,o.type);i[a]={name:a,index:r,type:h,size:o.size,isArray:l,value:UQ(h,o.size)}}return i}function Fbe(s,e){var l;const i=Gz(s,s.VERTEX_SHADER,e.vertexSrc),n=Gz(s,s.FRAGMENT_SHADER,e.fragmentSrc),r=s.createProgram();s.attachShader(r,i),s.attachShader(r,n);const o=(l=e.extra)==null?void 0:l.transformFeedbackVaryings;if(o&&(typeof s.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):s.transformFeedbackVaryings(r,o.names,o.bufferMode==="separate"?s.SEPARATE_ATTRIBS:s.INTERLEAVED_ATTRIBS)),s.linkProgram(r),s.getProgramParameter(r,s.LINK_STATUS)||gbe(s,r,i,n),e.attributeData=$be(r,s),e.uniformData=Ube(r,s),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const h=Object.keys(e.attributeData);h.sort((d,f)=>d>f?1:-1);for(let d=0;d<h.length;d++)e.attributeData[h[d]].location=d,s.bindAttribLocation(r,d,h[d]);s.linkProgram(r)}s.deleteShader(i),s.deleteShader(n);const a={};for(const h in e.uniformData){const d=e.uniformData[h];a[h]={location:s.getUniformLocation(r,h),value:UQ(d.type,d.size)}}return new Vbe(r,a)}function zbe(s,e,i,n,r){i.buffer.update(r)}const Xbe={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},a7={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Wbe(s){const e=s.map(o=>({data:o,offset:0,dataLen:0,dirty:0}));let i=0,n=0,r=0;for(let o=0;o<e.length;o++){const a=e[o];if(i=a7[a.data.type],a.data.size>1&&(i=Math.max(i,16)*a.data.size),a.dataLen=i,n%i!==0&&n<16){const l=n%i%16;n+=l,r+=l}n+i>16?(r=Math.ceil(r/16)*16,a.offset=r,r+=i,n=i):(a.offset=r,n+=i,r+=i)}return r=Math.ceil(r/16)*16,{uboElements:e,size:r}}function Hbe(s,e){const i=[];for(const n in s)e[n]&&i.push(e[n]);return i.sort((n,r)=>n.index-r.index),i}function Gbe(s,e){if(!s.autoManage)return{size:0,syncFunc:zbe};const i=Hbe(s.uniforms,e),{uboElements:n,size:r}=Wbe(i),o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<n.length;a++){const l=n[a],h=s.uniforms[l.data.name],d=l.data.name;let f=!1;for(let p=0;p<D0.length;p++){const g=D0[p];if(g.codeUbo&&g.test(l.data,h)){o.push(`offset = ${l.offset/4};`,D0[p].codeUbo(l.data.name,h)),f=!0;break}}if(!f)if(l.data.size>1){const p=zQ(l.data.type),g=Math.max(a7[l.data.type]/16,1),y=p/g,x=(4-y%4)%4;o.push(`
                cv = ud.${d}.value;
                v = uv.${d};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*g}; i++)
                {
                    for(var j = 0; j < ${y}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${x};
                }

                `)}else{const p=Xbe[l.data.type];o.push(`
                cv = ud.${d}.value;
                v = uv.${d};
                offset = ${l.offset/4};
                ${p};
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}let Qbe=0;const f1={textureCount:0,uboCount:0};class l7{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Qbe++}systemCheck(){if(!vbe())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,i){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const n=e.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),i||(f1.textureCount=0,f1.uboCount=0,this.syncUniformGroup(e.uniformGroup,f1)),r}setUniforms(e){const i=this.shader.program,n=i.glPrograms[this.renderer.CONTEXT_UID];i.syncUniforms(n.uniformData,e,this.renderer)}syncUniformGroup(e,i){const n=this.getGlProgram();(!e.static||e.dirtyId!==n.uniformDirtyGroups[e.id])&&(n.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,i))}syncUniforms(e,i,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(i.uniformData,e.uniforms,this.renderer,n)}createSyncGroups(e){const i=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[i]||(this.cache[i]=fbe(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[i],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,i){const n=this.getGlProgram();if(!e.static||e.dirtyId!==0||!n.uniformGroups[e.id]){e.dirtyId=0;const r=n.uniformGroups[e.id]||this.createSyncBufferGroup(e,n,i);e.buffer.update(),r(n.uniformData,e.uniforms,this.renderer,f1,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,n.uniformBufferBindings[i])}createSyncBufferGroup(e,i,n){const{gl:r}=this.renderer;this.renderer.buffer.bind(e.buffer);const o=this.gl.getUniformBlockIndex(i.program,n);i.uniformBufferBindings[n]=this.shader.uniformBindCount,r.uniformBlockBinding(i.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;const a=this.getSignature(e,this.shader.program.uniformData,"ubo");let l=this._uboCache[a];if(l||(l=this._uboCache[a]=Gbe(e,this.shader.program.uniformData)),e.autoManage){const h=new Float32Array(l.size/4);e.buffer.update(h)}return i.uniformGroups[e.id]=l.syncFunc,i.uniformGroups[e.id]}getSignature(e,i,n){const r=e.uniforms,o=[`${n}-`];for(const a in r)o.push(a),i[a]&&o.push(i[a].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const i=this.gl,n=e.program,r=Fbe(i,n);return n.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}l7.extension={type:xt.RendererSystem,name:"shader"};$t.add(l7);class BC{constructor(e){this.renderer=e}run(e){const{renderer:i}=this;i.runners.init.emit(i.options),e.hello&&console.log(`PixiJS 7.4.2 - ${i.rendererLogId} - https://pixijs.com`),i.resize(i.screen.width,i.screen.height)}destroy(){}}BC.defaultOptions={hello:!1},BC.extension={type:[xt.RendererSystem,xt.CanvasRendererSystem],name:"startup"};$t.add(BC);function Ybe(s,e=[]){return e[mi.NORMAL]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.ADD]=[s.ONE,s.ONE],e[mi.MULTIPLY]=[s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.SCREEN]=[s.ONE,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.OVERLAY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.DARKEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.LIGHTEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.COLOR_DODGE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.COLOR_BURN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.HARD_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.SOFT_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.DIFFERENCE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.EXCLUSION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.HUE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.SATURATION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.COLOR]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.LUMINOSITY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.NONE]=[0,0],e[mi.NORMAL_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.ADD_NPM]=[s.SRC_ALPHA,s.ONE,s.ONE,s.ONE],e[mi.SCREEN_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],e[mi.SRC_IN]=[s.DST_ALPHA,s.ZERO],e[mi.SRC_OUT]=[s.ONE_MINUS_DST_ALPHA,s.ZERO],e[mi.SRC_ATOP]=[s.DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],e[mi.DST_OVER]=[s.ONE_MINUS_DST_ALPHA,s.ONE],e[mi.DST_IN]=[s.ZERO,s.SRC_ALPHA],e[mi.DST_OUT]=[s.ZERO,s.ONE_MINUS_SRC_ALPHA],e[mi.DST_ATOP]=[s.ONE_MINUS_DST_ALPHA,s.SRC_ALPHA],e[mi.XOR]=[s.ONE_MINUS_DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],e[mi.SUBTRACT]=[s.ONE,s.ONE,s.ONE,s.ONE,s.FUNC_REVERSE_SUBTRACT,s.FUNC_ADD],e}const jbe=0,qbe=1,Zbe=2,Kbe=3,Jbe=4,ewe=5,c7=class CI{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=mi.NONE,this._blendEq=!1,this.map=[],this.map[jbe]=this.setBlend,this.map[qbe]=this.setOffset,this.map[Zbe]=this.setCullFace,this.map[Kbe]=this.setDepthTest,this.map[Jbe]=this.setFrontFace,this.map[ewe]=this.setDepthMask,this.checks=[],this.defaultState=new lh,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=Ybe(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let i=this.stateId^e.data,n=0;for(;i;)i&1&&this.map[n].call(this,!!(e.data&1<<n)),i=i>>1,n++;this.stateId=e.data}for(let i=0;i<this.checks.length;i++)this.checks[i](this,e)}forceState(e){e=e||this.defaultState;for(let i=0;i<this.map.length;i++)this.map[i].call(this,!!(e.data&1<<i));for(let i=0;i<this.checks.length;i++)this.checks[i](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(CI.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(CI.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const i=this.blendModes[e],n=this.gl;i.length===2?n.blendFunc(i[0],i[1]):n.blendFuncSeparate(i[0],i[1],i[2],i[3]),i.length===6?(this._blendEq=!0,n.blendEquationSeparate(i[4],i[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(e,i){this.gl.polygonOffset(e,i)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,i){const n=this.checks.indexOf(e);i&&n===-1?this.checks.push(e):!i&&n!==-1&&this.checks.splice(n,1)}static checkBlendMode(e,i){e.setBlendMode(i.blendMode)}static checkPolygonOffset(e,i){e.setPolygonOffset(1,i.polygonOffset)}destroy(){this.gl=null}};c7.extension={type:xt.RendererSystem,name:"state"};let twe=c7;$t.add(twe);class iwe extends mb{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const i=(e.priority??[]).filter(r=>e.systems[r]),n=[...i,...Object.keys(e.systems).filter(r=>!i.includes(r))];for(const r of n)this.addSystem(e.systems[r],r)}addRunners(...e){e.forEach(i=>{this.runners[i]=new Zl(i)})}addSystem(e,i){const n=new e(this);if(this[i])throw new Error(`Whoops! The name "${i}" is already in use`);this[i]=n,this._systemsHash[i]=n;for(const r in this.runners)this.runners[r].add(n);return this}emitWithCustomOptions(e,i){const n=Object.keys(this._systemsHash);e.items.forEach(r=>{const o=n.find(a=>this._systemsHash[a]===r);r[e.name](i[o])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const Ox=class RS{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=RS.defaultMaxIdle,this.checkCountMax=RS.defaultCheckCountMax,this.mode=RS.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==CD.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,i=e.managedTextures;let n=!1;for(let r=0;r<i.length;r++){const o=i[r];o.resource&&this.count-o.touched>this.maxIdle&&(e.destroyTexture(o,!0),i[r]=null,n=!0)}if(n){let r=0;for(let o=0;o<i.length;o++)i[o]!==null&&(i[r++]=i[o]);i.length=r}}unload(e){const i=this.renderer.texture,n=e._texture;n&&!n.framebuffer&&i.destroyTexture(n);for(let r=e.children.length-1;r>=0;r--)this.unload(e.children[r])}destroy(){this.renderer=null}};Ox.defaultMode=CD.AUTO,Ox.defaultMaxIdle=60*60,Ox.defaultCheckCountMax=60*10,Ox.extension={type:xt.RendererSystem,name:"textureGC"};let _p=Ox;$t.add(_p);class wk{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=qt.UNSIGNED_BYTE,this.internalFormat=rt.RGBA,this.samplerType=0}}function nwe(s){let e;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?e={[s.RGB]:Mt.FLOAT,[s.RGBA]:Mt.FLOAT,[s.ALPHA]:Mt.FLOAT,[s.LUMINANCE]:Mt.FLOAT,[s.LUMINANCE_ALPHA]:Mt.FLOAT,[s.R8]:Mt.FLOAT,[s.R8_SNORM]:Mt.FLOAT,[s.RG8]:Mt.FLOAT,[s.RG8_SNORM]:Mt.FLOAT,[s.RGB8]:Mt.FLOAT,[s.RGB8_SNORM]:Mt.FLOAT,[s.RGB565]:Mt.FLOAT,[s.RGBA4]:Mt.FLOAT,[s.RGB5_A1]:Mt.FLOAT,[s.RGBA8]:Mt.FLOAT,[s.RGBA8_SNORM]:Mt.FLOAT,[s.RGB10_A2]:Mt.FLOAT,[s.RGB10_A2UI]:Mt.FLOAT,[s.SRGB8]:Mt.FLOAT,[s.SRGB8_ALPHA8]:Mt.FLOAT,[s.R16F]:Mt.FLOAT,[s.RG16F]:Mt.FLOAT,[s.RGB16F]:Mt.FLOAT,[s.RGBA16F]:Mt.FLOAT,[s.R32F]:Mt.FLOAT,[s.RG32F]:Mt.FLOAT,[s.RGB32F]:Mt.FLOAT,[s.RGBA32F]:Mt.FLOAT,[s.R11F_G11F_B10F]:Mt.FLOAT,[s.RGB9_E5]:Mt.FLOAT,[s.R8I]:Mt.INT,[s.R8UI]:Mt.UINT,[s.R16I]:Mt.INT,[s.R16UI]:Mt.UINT,[s.R32I]:Mt.INT,[s.R32UI]:Mt.UINT,[s.RG8I]:Mt.INT,[s.RG8UI]:Mt.UINT,[s.RG16I]:Mt.INT,[s.RG16UI]:Mt.UINT,[s.RG32I]:Mt.INT,[s.RG32UI]:Mt.UINT,[s.RGB8I]:Mt.INT,[s.RGB8UI]:Mt.UINT,[s.RGB16I]:Mt.INT,[s.RGB16UI]:Mt.UINT,[s.RGB32I]:Mt.INT,[s.RGB32UI]:Mt.UINT,[s.RGBA8I]:Mt.INT,[s.RGBA8UI]:Mt.UINT,[s.RGBA16I]:Mt.INT,[s.RGBA16UI]:Mt.UINT,[s.RGBA32I]:Mt.INT,[s.RGBA32UI]:Mt.UINT,[s.DEPTH_COMPONENT16]:Mt.FLOAT,[s.DEPTH_COMPONENT24]:Mt.FLOAT,[s.DEPTH_COMPONENT32F]:Mt.FLOAT,[s.DEPTH_STENCIL]:Mt.FLOAT,[s.DEPTH24_STENCIL8]:Mt.FLOAT,[s.DEPTH32F_STENCIL8]:Mt.FLOAT}:e={[s.RGB]:Mt.FLOAT,[s.RGBA]:Mt.FLOAT,[s.ALPHA]:Mt.FLOAT,[s.LUMINANCE]:Mt.FLOAT,[s.LUMINANCE_ALPHA]:Mt.FLOAT,[s.DEPTH_STENCIL]:Mt.FLOAT},e}function swe(s){let e;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?e={[qt.UNSIGNED_BYTE]:{[rt.RGBA]:s.RGBA8,[rt.RGB]:s.RGB8,[rt.RG]:s.RG8,[rt.RED]:s.R8,[rt.RGBA_INTEGER]:s.RGBA8UI,[rt.RGB_INTEGER]:s.RGB8UI,[rt.RG_INTEGER]:s.RG8UI,[rt.RED_INTEGER]:s.R8UI,[rt.ALPHA]:s.ALPHA,[rt.LUMINANCE]:s.LUMINANCE,[rt.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[qt.BYTE]:{[rt.RGBA]:s.RGBA8_SNORM,[rt.RGB]:s.RGB8_SNORM,[rt.RG]:s.RG8_SNORM,[rt.RED]:s.R8_SNORM,[rt.RGBA_INTEGER]:s.RGBA8I,[rt.RGB_INTEGER]:s.RGB8I,[rt.RG_INTEGER]:s.RG8I,[rt.RED_INTEGER]:s.R8I},[qt.UNSIGNED_SHORT]:{[rt.RGBA_INTEGER]:s.RGBA16UI,[rt.RGB_INTEGER]:s.RGB16UI,[rt.RG_INTEGER]:s.RG16UI,[rt.RED_INTEGER]:s.R16UI,[rt.DEPTH_COMPONENT]:s.DEPTH_COMPONENT16},[qt.SHORT]:{[rt.RGBA_INTEGER]:s.RGBA16I,[rt.RGB_INTEGER]:s.RGB16I,[rt.RG_INTEGER]:s.RG16I,[rt.RED_INTEGER]:s.R16I},[qt.UNSIGNED_INT]:{[rt.RGBA_INTEGER]:s.RGBA32UI,[rt.RGB_INTEGER]:s.RGB32UI,[rt.RG_INTEGER]:s.RG32UI,[rt.RED_INTEGER]:s.R32UI,[rt.DEPTH_COMPONENT]:s.DEPTH_COMPONENT24},[qt.INT]:{[rt.RGBA_INTEGER]:s.RGBA32I,[rt.RGB_INTEGER]:s.RGB32I,[rt.RG_INTEGER]:s.RG32I,[rt.RED_INTEGER]:s.R32I},[qt.FLOAT]:{[rt.RGBA]:s.RGBA32F,[rt.RGB]:s.RGB32F,[rt.RG]:s.RG32F,[rt.RED]:s.R32F,[rt.DEPTH_COMPONENT]:s.DEPTH_COMPONENT32F},[qt.HALF_FLOAT]:{[rt.RGBA]:s.RGBA16F,[rt.RGB]:s.RGB16F,[rt.RG]:s.RG16F,[rt.RED]:s.R16F},[qt.UNSIGNED_SHORT_5_6_5]:{[rt.RGB]:s.RGB565},[qt.UNSIGNED_SHORT_4_4_4_4]:{[rt.RGBA]:s.RGBA4},[qt.UNSIGNED_SHORT_5_5_5_1]:{[rt.RGBA]:s.RGB5_A1},[qt.UNSIGNED_INT_2_10_10_10_REV]:{[rt.RGBA]:s.RGB10_A2,[rt.RGBA_INTEGER]:s.RGB10_A2UI},[qt.UNSIGNED_INT_10F_11F_11F_REV]:{[rt.RGB]:s.R11F_G11F_B10F},[qt.UNSIGNED_INT_5_9_9_9_REV]:{[rt.RGB]:s.RGB9_E5},[qt.UNSIGNED_INT_24_8]:{[rt.DEPTH_STENCIL]:s.DEPTH24_STENCIL8},[qt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[rt.DEPTH_STENCIL]:s.DEPTH32F_STENCIL8}}:e={[qt.UNSIGNED_BYTE]:{[rt.RGBA]:s.RGBA,[rt.RGB]:s.RGB,[rt.ALPHA]:s.ALPHA,[rt.LUMINANCE]:s.LUMINANCE,[rt.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[qt.UNSIGNED_SHORT_5_6_5]:{[rt.RGB]:s.RGB},[qt.UNSIGNED_SHORT_4_4_4_4]:{[rt.RGBA]:s.RGBA},[qt.UNSIGNED_SHORT_5_5_5_1]:{[rt.RGBA]:s.RGBA}},e}class h7{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Mi,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=swe(e),this.samplerTypes=nwe(e);const i=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=i;for(let r=0;r<i;r++)this.boundTextures[r]=null;this.emptyTextures={};const n=new wk(e.createTexture());e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new wk(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(e,i=0){const{gl:n}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[i]!==e&&(this.currentLocation!==i&&(this.currentLocation=i,n.activeTexture(n.TEXTURE0+i)),n.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId?(this.currentLocation!==i&&(this.currentLocation=i,n.activeTexture(n.TEXTURE0+i)),this.updateTexture(e)):r.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[i]=e}else this.currentLocation!==i&&(this.currentLocation=i,n.activeTexture(n.TEXTURE0+i)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[i]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:i,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<n.length;r++)n[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<n.length;r++)n[r]===e&&(this.currentLocation!==r&&(i.activeTexture(i.TEXTURE0+r),this.currentLocation=r),i.bindTexture(e.target,this.emptyTextures[e.target].texture),n[r]=null)}ensureSamplerType(e){const{boundTextures:i,hasIntegerTextures:n,CONTEXT_UID:r}=this;if(n)for(let o=e-1;o>=0;--o){const a=i[o];a&&a._glTextures[r].samplerType!==Mt.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(e){const i=new wk(this.gl.createTexture());return i.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=i,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),i}initTextureType(e,i){var n;i.internalFormat=((n=this.internalFormats[e.type])==null?void 0:n[e.format])??e.format,i.samplerType=this.samplerTypes[i.internalFormat]??Mt.FLOAT,this.webGLVersion===2&&e.type===qt.HALF_FLOAT?i.type=this.gl.HALF_FLOAT:i.type=e.type}updateTexture(e){var r;const i=e._glTextures[this.CONTEXT_UID];if(!i)return;const n=this.renderer;if(this.initTextureType(e,i),(r=e.resource)==null?void 0:r.upload(n,e,i))i.samplerType!==Mt.FLOAT&&(this.hasIntegerTextures=!0);else{const o=e.realWidth,a=e.realHeight,l=n.gl;(i.width!==o||i.height!==a||i.dirtyId<0)&&(i.width=o,i.height=a,l.texImage2D(e.target,0,i.internalFormat,o,a,0,e.format,i.type,null))}e.dirtyStyleId!==i.dirtyStyleId&&this.updateTextureStyle(e),i.dirtyId=e.dirtyId}destroyTexture(e,i){const{gl:n}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!i)){const r=this.managedTextures.indexOf(e);r!==-1&&R0(this.managedTextures,r,1)}}updateTextureStyle(e){var n;const i=e._glTextures[this.CONTEXT_UID];i&&((e.mipmap===nh.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?i.mipmap=!1:i.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?i.wrapMode=Qd.CLAMP:i.wrapMode=e.wrapMode,(n=e.resource)!=null&&n.style(this.renderer,e,i)||this.setStyle(e,i),i.dirtyStyleId=e.dirtyStyleId)}setStyle(e,i){const n=this.gl;if(i.mipmap&&e.mipmap!==nh.ON_MANUAL&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,i.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,i.wrapMode),i.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===jh.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&e.anisotropicLevel>0&&e.scaleMode===jh.LINEAR){const o=Math.min(e.anisotropicLevel,n.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode===jh.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode===jh.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}h7.extension={type:xt.RendererSystem,name:"texture"};$t.add(h7);class u7{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:i,CONTEXT_UID:n}=this,r=e._glTransformFeedbacks[n]||this.createGLTransformFeedback(e);i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,i){const{gl:n,renderer:r}=this;i&&r.shader.bind(i),n.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:i,renderer:n,CONTEXT_UID:r}=this,o=i.createTransformFeedback();e._glTransformFeedbacks[r]=o,i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,o);for(let a=0;a<e.buffers.length;a++){const l=e.buffers[a];l&&(n.buffer.update(l),l._glBuffers[r].refCount++,i.bindBufferBase(i.TRANSFORM_FEEDBACK_BUFFER,a,l._glBuffers[r].buffer||null))}return i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),o}disposeTransformFeedback(e,i){const n=e._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this);const o=this.renderer.buffer;if(o)for(let a=0;a<e.buffers.length;a++){const l=e.buffers[a];if(!l)continue;const h=l._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!i&&o.dispose(l,i))}n&&(i||r.deleteTransformFeedback(n),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}u7.extension={type:xt.RendererSystem,name:"transformFeedback"};$t.add(u7);class RC{constructor(e){this.renderer=e}init(e){this.screen=new Pi(0,0,e.width,e.height),this.element=e.view||kt.ADAPTER.createCanvas(),this.resolution=e.resolution||kt.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,i){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(i*this.resolution);const n=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=n,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",n,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var i;e&&((i=this.element.parentNode)==null||i.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}RC.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},RC.extension={type:[xt.RendererSystem,xt.CanvasRendererSystem],name:"_view"};$t.add(RC);kt.PREFER_ENV=Em.WEBGL2;kt.STRICT_TEXTURE_CACHE=!1;kt.RENDER_OPTIONS={...IC.defaultOptions,...PC.defaultOptions,...RC.defaultOptions,...BC.defaultOptions};Object.defineProperties(kt,{WRAP_MODE:{get(){return Mi.defaultOptions.wrapMode},set(s){Yi("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Mi.defaultOptions.wrapMode=s}},SCALE_MODE:{get(){return Mi.defaultOptions.scaleMode},set(s){Yi("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Mi.defaultOptions.scaleMode=s}},MIPMAP_TEXTURES:{get(){return Mi.defaultOptions.mipmap},set(s){Yi("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Mi.defaultOptions.mipmap=s}},ANISOTROPIC_LEVEL:{get(){return Mi.defaultOptions.anisotropicLevel},set(s){Yi("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Mi.defaultOptions.anisotropicLevel=s}},FILTER_RESOLUTION:{get(){return Yi("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),bo.defaultResolution},set(s){bo.defaultResolution=s}},FILTER_MULTISAMPLE:{get(){return Yi("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),bo.defaultMultisample},set(s){bo.defaultMultisample=s}},SPRITE_MAX_TEXTURES:{get(){return xp.defaultMaxTextures},set(s){Yi("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),xp.defaultMaxTextures=s}},SPRITE_BATCH_SIZE:{get(){return xp.defaultBatchSize},set(s){Yi("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),xp.defaultBatchSize=s}},CAN_UPLOAD_SAME_BUFFER:{get(){return xp.canUploadSameBuffer},set(s){Yi("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),xp.canUploadSameBuffer=s}},GC_MODE:{get(){return _p.defaultMode},set(s){Yi("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),_p.defaultMode=s}},GC_MAX_IDLE:{get(){return _p.defaultMaxIdle},set(s){Yi("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),_p.defaultMaxIdle=s}},GC_MAX_CHECK_COUNT:{get(){return _p.defaultCheckCountMax},set(s){Yi("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),_p.defaultCheckCountMax=s}},PRECISION_VERTEX:{get(){return Kh.defaultVertexPrecision},set(s){Yi("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Kh.defaultVertexPrecision=s}},PRECISION_FRAGMENT:{get(){return Kh.defaultFragmentPrecision},set(s){Yi("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Kh.defaultFragmentPrecision=s}}});var pm=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(pm||{});class Ok{constructor(e,i=null,n=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=i,this.priority=n,this.once=r}match(e,i=null){return this.fn===e&&this.context===i}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const i=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),i}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const i=this.next;return this.next=e?null:i,this.previous=null,i}}const d7=class wa{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Ok(null,null,1/0),this.deltaMS=1/wa.targetFPMS,this.elapsedMS=1/wa.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,i,n=pm.NORMAL){return this._addListener(new Ok(e,i,n))}addOnce(e,i,n=pm.NORMAL){return this._addListener(new Ok(e,i,n,!0))}_addListener(e){let i=this._head.next,n=this._head;if(!i)e.connect(n);else{for(;i;){if(e.priority>i.priority){e.connect(n);break}n=i,i=i.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,i){let n=this._head.next;for(;n;)n.match(e,i)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,i=this._head;for(;i=i.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let i;if(e>this.lastTime){if(i=this.elapsedMS=e-this.lastTime,i>this._maxElapsedMS&&(i=this._maxElapsedMS),i*=this.speed,this._minElapsedMS){const o=e-this._lastFrame|0;if(o<this._minElapsedMS)return;this._lastFrame=e-o%this._minElapsedMS}this.deltaMS=i,this.deltaTime=this.deltaMS*wa.targetFPMS;const n=this._head;let r=n.next;for(;r;)r=r.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const i=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,i)/1e3,wa.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const i=Math.max(this.minFPS,e);this._minElapsedMS=1/(i/1e3)}}static get shared(){if(!wa._shared){const e=wa._shared=new wa;e.autoStart=!0,e._protected=!0}return wa._shared}static get system(){if(!wa._system){const e=wa._system=new wa;e.autoStart=!0,e._protected=!0}return wa._system}};d7.targetFPMS=.06;let jo=d7;Object.defineProperties(kt,{TARGET_FPMS:{get(){return jo.targetFPMS},set(s){Yi("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),jo.targetFPMS=s}}});class f7{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(i){this._ticker&&this._ticker.remove(this.render,this),this._ticker=i,i&&i.add(this.render,this,pm.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?jo.shared:new jo,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}f7.extension=xt.Application;$t.add(f7);const p7=[];$t.handleByList(xt.Renderer,p7);function rwe(s){for(const e of p7)if(e.test(s))return new e(s);throw new Error("Unable to auto-detect a suitable renderer.")}var owe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,awe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const lwe=owe,m7=awe;class g7{constructor(e){this.renderer=e}contextChange(e){let i;if(this.renderer.context.webGLVersion===1){const n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),i=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{const n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),i=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}i>=Hs.HIGH?this.multisample=Hs.HIGH:i>=Hs.MEDIUM?this.multisample=Hs.MEDIUM:i>=Hs.LOW?this.multisample=Hs.LOW:this.multisample=Hs.NONE}destroy(){}}g7.extension={type:xt.RendererSystem,name:"_multisample"};$t.add(g7);class cwe{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class y7{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:i,CONTEXT_UID:n}=this,r=e._glBuffers[n]||this.createGLBuffer(e);i.bindBuffer(e.type,r.buffer)}unbind(e){const{gl:i}=this;i.bindBuffer(e,null)}bindBufferBase(e,i){const{gl:n,CONTEXT_UID:r}=this;if(this.boundBufferBases[i]!==e){const o=e._glBuffers[r]||this.createGLBuffer(e);this.boundBufferBases[i]=e,n.bindBufferBase(n.UNIFORM_BUFFER,i,o.buffer)}}bindBufferRange(e,i,n){const{gl:r,CONTEXT_UID:o}=this;n=n||0;const a=e._glBuffers[o]||this.createGLBuffer(e);r.bindBufferRange(r.UNIFORM_BUFFER,i||0,a.buffer,n*256,256)}update(e){const{gl:i,CONTEXT_UID:n}=this,r=e._glBuffers[n]||this.createGLBuffer(e);if(e._updateID!==r.updateID)if(r.updateID=e._updateID,i.bindBuffer(e.type,r.buffer),r.byteLength>=e.data.byteLength)i.bufferSubData(e.type,0,e.data);else{const o=e.static?i.STATIC_DRAW:i.DYNAMIC_DRAW;r.byteLength=e.data.byteLength,i.bufferData(e.type,e.data,o)}}dispose(e,i){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const n=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),n&&(i||r.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const i=Object.keys(this.managedBuffers);for(let n=0;n<i.length;n++)this.dispose(this.managedBuffers[i[n]],e)}createGLBuffer(e){const{CONTEXT_UID:i,gl:n}=this;return e._glBuffers[i]=new cwe(n.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[i]}}y7.extension={type:xt.RendererSystem,name:"buffer"};$t.add(y7);class v7{constructor(e){this.renderer=e}render(e,i){const n=this.renderer;let r,o,a,l;if(i&&(r=i.renderTexture,o=i.clear,a=i.transform,l=i.skipUpdateTransform),this.renderingToScreen=!r,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=a,!n.context.isLost){if(r||(this.lastObjectRendered=e),!l){const h=e.enableTempParent();e.updateTransform(),e.disableTempParent(h)}n.renderTexture.bind(r),n.batch.currentRenderer.start(),(o??n.background.clearBeforeRender)&&n.renderTexture.clear(),e.render(n),n.batch.currentRenderer.flush(),r&&(i.blit&&n.framebuffer.blit(),r.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}v7.extension={type:xt.RendererSystem,name:"objectRenderer"};$t.add(v7);const DS=class TI extends iwe{constructor(e){super(),this.type=JG.WEBGL,e=Object.assign({},kt.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Kl({projectionMatrix:new es},!0);const i={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:TI.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(i),"useContextAlpha"in e&&(Yi("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=TI.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:I_e()}render(e,i){this.objectRenderer.render(e,i)}resize(e,i){this._view.resizeView(e,i)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Yi("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Yi("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Yi("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Yi("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Yi("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Yi("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Yi("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Yi("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,i){return this.textureGenerator.generateTexture(e,i)}};DS.extension={type:xt.Renderer,priority:1},DS.__plugins={},DS.__systems={};let ND=DS;$t.handleByMap(xt.RendererPlugin,ND.__plugins);$t.handleByMap(xt.RendererSystem,ND.__systems);$t.add(ND);class x7 extends v_{constructor(e,i){const{width:n,height:r}=i||{};super(n,r),this.items=[],this.itemDirtyIds=[];for(let o=0;o<e;o++){const a=new Mi;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,i){for(let n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof v_?this.addResourceAt(e[n],n):this.addResourceAt(LQ(e[n],i),n))}dispose(){for(let e=0,i=this.length;e<i;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,i){if(!this.items[i])throw new Error(`Index ${i} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[i].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let i=0;i<this.length;i++)this.items[i].parentTextureArray=e,this.items[i].on("update",e.update,e)}unbind(e){super.unbind(e);for(let i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(e).then(()=>{const{realWidth:i,realHeight:n}=this.items[0];return this.resize(i,n),this.update(),Promise.resolve(this)}),this._load}}class hwe extends x7{constructor(e,i){const{width:n,height:r}=i||{};let o,a;Array.isArray(e)?(o=e,a=e.length):a=e,super(a,{width:n,height:r}),o&&this.initFromArray(o,i)}addBaseTextureAt(e,i){if(e.resource)this.addResourceAt(e.resource,i);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=P0.TEXTURE_2D_ARRAY}upload(e,i,n){const{length:r,itemDirtyIds:o,items:a}=this,{gl:l}=e;n.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,i.format,n.type,null);for(let h=0;h<r;h++){const d=a[h];o[h]<d.dirtyId&&(o[h]=d.dirtyId,d.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,h,d.resource.width,d.resource.height,1,i.format,n.type,d.resource.source))}return!0}}class uwe extends gu{constructor(e){super(e)}static test(e){const{OffscreenCanvas:i}=globalThis;return i&&e instanceof i?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const _7=class Sx extends x7{constructor(e,i){const{width:n,height:r,autoLoad:o,linkBaseTexture:a}=i||{};if(e&&e.length!==Sx.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:n,height:r});for(let l=0;l<Sx.SIDES;l++)this.items[l].target=P0.TEXTURE_CUBE_MAP_POSITIVE_X+l;this.linkBaseTexture=a!==!1,e&&this.initFromArray(e,i),o!==!1&&this.load()}bind(e){super.bind(e),e.target=P0.TEXTURE_CUBE_MAP}addBaseTextureAt(e,i,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[i])throw new Error(`Index ${i} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,i);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=P0.TEXTURE_CUBE_MAP_POSITIVE_X+i,e.parentTextureArray=this.baseTexture,this.items[i]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[i]=e,this}upload(e,i,n){const r=this.itemDirtyIds;for(let o=0;o<Sx.SIDES;o++){const a=this.items[o];(r[o]<a.dirtyId||n.dirtyId<i.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(e,a,n),r[o]=a.dirtyId):r[o]<-1&&(e.gl.texImage2D(a.target,0,n.internalFormat,i.realWidth,i.realHeight,0,i.format,n.type,null),r[o]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Sx.SIDES}};_7.SIDES=6;let dwe=_7;class h0 extends gu{constructor(e,i){i=i||{};let n,r,o;typeof e=="string"?(n=h0.EMPTY,r=e,o=!0):(n=e,r=null,o=!1),super(n),this.url=r,this.crossOrigin=i.crossOrigin??!0,this.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,this.ownsImageBitmap=i.ownsImageBitmap??o,this._load=null,i.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,i)=>{if(this.url===null){e(this);return}try{const n=await kt.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await n.blob();if(this.destroyed)return;const o=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Yo.UNPACK?"premultiply":"none"});if(this.destroyed){o.close();return}this.source=o,this.update(),e(this)}catch(n){if(this.destroyed)return;i(n),this.onError.emit(n)}}),this._load)}upload(e,i,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),super.upload(e,i,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return h0._EMPTY=h0._EMPTY??kt.ADAPTER.createCanvas(0,0),h0._EMPTY}}const AI=class LS extends gu{constructor(e,i){i=i||{},super(kt.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=i.scale||1,this._overrideWidth=i.width,this._overrideHeight=i.height,this._resolve=null,this._crossorigin=i.crossorigin,this._load=null,i.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},LS.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;gu.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=i=>{this._resolve&&(e.onerror=null,this.onError.emit(i))},e.onload=()=>{if(!this._resolve)return;const i=e.width,n=e.height;if(!i||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=i*this.scale,o=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/n*i,o=this._overrideHeight||this._overrideWidth/i*n),r=Math.round(r),o=Math.round(o);const a=this.source;a.width=r,a.height=o,a._pixiId=`canvas_${fm()}`,a.getContext("2d").drawImage(e,0,0,i,n,0,0,r,o),this._resolve(),this._resolve=null}}static getSize(e){const i=LS.SVG_SIZE.exec(e),n={};return i&&(n[i[1]]=Math.round(parseFloat(i[3])),n[i[5]]=Math.round(parseFloat(i[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,i){return i==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&LS.SVG_XML.test(e)}};AI.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,AI.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let EI=AI;class fwe extends gu{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}const MI=class kI extends gu{constructor(e,i){if(i=i||{},!(e instanceof HTMLVideoElement)){const n=document.createElement("video");i.autoLoad!==!1&&n.setAttribute("preload","auto"),i.playsinline!==!1&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),i.muted===!0&&(n.setAttribute("muted",""),n.muted=!0),i.loop===!0&&n.setAttribute("loop",""),i.autoPlay!==!1&&n.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const r=e[0].src||e[0];gu.crossOrigin(n,r,i.crossorigin);for(let o=0;o<e.length;++o){const a=document.createElement("source");let{src:l,mime:h}=e[o];if(l=l||e[o],l.startsWith("data:"))h=l.slice(5,l.indexOf(";"));else if(!l.startsWith("blob:")){const d=l.split("?").shift().toLowerCase(),f=d.slice(d.lastIndexOf(".")+1);h=h||kI.MIME_TYPES[f]||`video/${f}`}a.src=l,h&&(a.type=h),n.appendChild(a)}e=n}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=i.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=i.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),i.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const i=jo.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((i,n)=>{this.valid?i(this):(this._resolve=i,this._reject=n,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const i=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!i&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(jo.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(jo.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(jo.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,i){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||kI.TYPES.includes(i)}};MI.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],MI.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let b7=MI;gI.push(h0,GQ,uwe,b7,fwe,EI,aA,dwe,hwe);class DC{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?Pi.EMPTY:(e=e||new Pi(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,i){const{a:n,b:r,c:o,d:a,tx:l,ty:h}=e,d=n*i.x+o*i.y+l,f=r*i.x+a*i.y+h;this.minX=Math.min(this.minX,d),this.maxX=Math.max(this.maxX,d),this.minY=Math.min(this.minY,f),this.maxY=Math.max(this.maxY,f)}addQuad(e){let i=this.minX,n=this.minY,r=this.maxX,o=this.maxY,a=e[0],l=e[1];i=a<i?a:i,n=l<n?l:n,r=a>r?a:r,o=l>o?l:o,a=e[2],l=e[3],i=a<i?a:i,n=l<n?l:n,r=a>r?a:r,o=l>o?l:o,a=e[4],l=e[5],i=a<i?a:i,n=l<n?l:n,r=a>r?a:r,o=l>o?l:o,a=e[6],l=e[7],i=a<i?a:i,n=l<n?l:n,r=a>r?a:r,o=l>o?l:o,this.minX=i,this.minY=n,this.maxX=r,this.maxY=o}addFrame(e,i,n,r,o){this.addFrameMatrix(e.worldTransform,i,n,r,o)}addFrameMatrix(e,i,n,r,o){const a=e.a,l=e.b,h=e.c,d=e.d,f=e.tx,p=e.ty;let g=this.minX,y=this.minY,x=this.maxX,_=this.maxY,w=a*i+h*n+f,O=l*i+d*n+p;g=w<g?w:g,y=O<y?O:y,x=w>x?w:x,_=O>_?O:_,w=a*r+h*n+f,O=l*r+d*n+p,g=w<g?w:g,y=O<y?O:y,x=w>x?w:x,_=O>_?O:_,w=a*i+h*o+f,O=l*i+d*o+p,g=w<g?w:g,y=O<y?O:y,x=w>x?w:x,_=O>_?O:_,w=a*r+h*o+f,O=l*r+d*o+p,g=w<g?w:g,y=O<y?O:y,x=w>x?w:x,_=O>_?O:_,this.minX=g,this.minY=y,this.maxX=x,this.maxY=_}addVertexData(e,i,n){let r=this.minX,o=this.minY,a=this.maxX,l=this.maxY;for(let h=i;h<n;h+=2){const d=e[h],f=e[h+1];r=d<r?d:r,o=f<o?f:o,a=d>a?d:a,l=f>l?f:l}this.minX=r,this.minY=o,this.maxX=a,this.maxY=l}addVertices(e,i,n,r){this.addVerticesMatrix(e.worldTransform,i,n,r)}addVerticesMatrix(e,i,n,r,o=0,a=o){const l=e.a,h=e.b,d=e.c,f=e.d,p=e.tx,g=e.ty;let y=this.minX,x=this.minY,_=this.maxX,w=this.maxY;for(let O=n;O<r;O+=2){const T=i[O],C=i[O+1],A=l*T+d*C+p,B=f*C+h*T+g;y=Math.min(y,A-o),_=Math.max(_,A+o),x=Math.min(x,B-a),w=Math.max(w,B+a)}this.minX=y,this.minY=x,this.maxX=_,this.maxY=w}addBounds(e){const i=this.minX,n=this.minY,r=this.maxX,o=this.maxY;this.minX=e.minX<i?e.minX:i,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>o?e.maxY:o}addBoundsMask(e,i){const n=e.minX>i.minX?e.minX:i.minX,r=e.minY>i.minY?e.minY:i.minY,o=e.maxX<i.maxX?e.maxX:i.maxX,a=e.maxY<i.maxY?e.maxY:i.maxY;if(n<=o&&r<=a){const l=this.minX,h=this.minY,d=this.maxX,f=this.maxY;this.minX=n<l?n:l,this.minY=r<h?r:h,this.maxX=o>d?o:d,this.maxY=a>f?a:f}}addBoundsMatrix(e,i){this.addFrameMatrix(i,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,i){const n=e.minX>i.x?e.minX:i.x,r=e.minY>i.y?e.minY:i.y,o=e.maxX<i.x+i.width?e.maxX:i.x+i.width,a=e.maxY<i.y+i.height?e.maxY:i.y+i.height;if(n<=o&&r<=a){const l=this.minX,h=this.minY,d=this.maxX,f=this.maxY;this.minX=n<l?n:l,this.minY=r<h?r:h,this.maxX=o>d?o:d,this.maxY=a>f?a:f}}pad(e=0,i=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=i,this.maxY+=i)}addFramePad(e,i,n,r,o,a){e-=o,i-=a,n+=o,r+=a,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<i?this.minY:i,this.maxY=this.maxY>r?this.maxY:r}}class xs extends mb{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new DD,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new DC,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const i=Object.keys(e);for(let n=0;n<i.length;++n){const r=i[n];Object.defineProperty(xs.prototype,r,Object.getOwnPropertyDescriptor(e,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,i){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),i||(this._boundsRect||(this._boundsRect=new Pi),i=this._boundsRect),this._bounds.getRectangle(i)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new Pi),e=this._localBoundsRect),this._localBounds||(this._localBounds=new DC);const i=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(n==null?void 0:n.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,o=this._boundsID;this._bounds=this._localBounds;const a=this.getBounds(!1,e);return this.parent=n,this.transform=i,this._bounds=r,this._bounds.updateID+=this._boundsID-o,a}toGlobal(e,i,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,i)}toLocal(e,i,n,r){return i&&(e=i.toGlobal(e,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,i=0,n=1,r=1,o=0,a=0,l=0,h=0,d=0){return this.position.x=e,this.position.y=i,this.scale.x=n||1,this.scale.y=r||1,this.rotation=o,this.skew.x=a,this.skew.y=l,this.pivot.x=h,this.pivot.y=d,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new pwe),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*obe}set angle(e){this.transform.rotation=e*abe}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount--,i._maskRefCount===0&&(i.renderable=!0,i.isMask=!1))}if(this._mask=e,this._mask){const i=this._mask.isMaskData?this._mask.maskObject:this._mask;i&&(i._maskRefCount===0&&(i.renderable=!1,i.isMask=!0),i._maskRefCount++)}}}}class pwe extends xs{constructor(){super(...arguments),this.sortDirty=null}}xs.prototype.displayObjectUpdateTransform=xs.prototype.updateTransform;const mwe=new es;function gwe(s,e){return s.zIndex===e.zIndex?s._lastSortedIndex-e._lastSortedIndex:s.zIndex-e.zIndex}const w7=class PI extends xs{constructor(){super(),this.children=[],this.sortableChildren=PI.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let i=0;i<e.length;i++)this.addChild(e[i]);else{const i=e[0];i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.push(i),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",i,this,this.children.length-1),i.emit("added",this)}return e[0]}addChildAt(e,i){if(i<0||i>this.children.length)throw new Error(`${e}addChildAt: The index ${i} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(i,0,e),this._boundsID++,this.onChildrenChange(i),e.emit("added",this),this.emit("childAdded",e,this,i),e}swapChildren(e,i){if(e===i)return;const n=this.getChildIndex(e),r=this.getChildIndex(i);this.children[n]=i,this.children[r]=e,this.onChildrenChange(n<r?n:r)}getChildIndex(e){const i=this.children.indexOf(e);if(i===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return i}setChildIndex(e,i){if(i<0||i>=this.children.length)throw new Error(`The index ${i} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(e);R0(this.children,n,1),this.children.splice(i,0,e),this.onChildrenChange(i)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let i=0;i<e.length;i++)this.removeChild(e[i]);else{const i=e[0],n=this.children.indexOf(i);if(n===-1)return null;i.parent=null,i.transform._parentID=-1,R0(this.children,n,1),this._boundsID++,this.onChildrenChange(n),i.emit("removed",this),this.emit("childRemoved",i,this,n)}return e[0]}removeChildAt(e){const i=this.getChildAt(e);return i.parent=null,i.transform._parentID=-1,R0(this.children,e,1),this._boundsID++,this.onChildrenChange(e),i.emit("removed",this),this.emit("childRemoved",i,this,e),i}removeChildren(e=0,i=this.children.length){const n=e,r=i,o=r-n;let a;if(o>0&&o<=r){a=this.children.splice(n,o);for(let l=0;l<a.length;++l)a[l].parent=null,a[l].transform&&(a[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let l=0;l<a.length;++l)a[l].emit("removed",this),this.emit("childRemoved",a[l],this,l);return a}else if(o===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let i=0,n=this.children.length;i<n;++i){const r=this.children[i];r._lastSortedIndex=i,!e&&r.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(gwe),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,i=this.children.length;e<i;++e){const n=this.children[e];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const i=this.children[e];if(!(!i.visible||!i.renderable))if(i.calculateBounds(),i._mask){const n=i._mask.isMaskData?i._mask.maskObject:i._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(i._bounds,n._bounds)):this._bounds.addBounds(i._bounds)}else i.filterArea?this._bounds.addBoundsArea(i._bounds,i.filterArea):this._bounds.addBounds(i._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,i=!1){const n=super.getLocalBounds(e);if(!i)for(let r=0,o=this.children.length;r<o;++r){const a=this.children[r];a.visible&&a.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const i=e.renderTexture.sourceFrame;if(!(i.width>0&&i.height>0))return;let n,r;this.cullArea?(n=this.cullArea,r=this.worldTransform):this._render!==PI.prototype._render&&(n=this.getBounds(!0));const o=e.projection.transform;if(o&&(r?(r=mwe.copyFrom(r),r.prepend(o)):r=o),n&&i.intersects(n,r))this._render(e);else if(this.cullArea)return;for(let a=0,l=this.children.length;a<l;++a){const h=this.children[a],d=h.cullable;h.cullable=d||!this.cullArea,h.render(e),h.cullable=d}}render(e){var i;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(i=this.filters)!=null&&i.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let n=0,r=this.children.length;n<r;++n)this.children[n].render(e)}}renderAdvanced(e){var o,a,l;const i=this.filters,n=this._mask;if(i){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let h=0;h<i.length;h++)i[h].enabled&&this._enabledFilters.push(i[h])}const r=i&&((o=this._enabledFilters)==null?void 0:o.length)||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==ir.NONE));if(r&&e.batch.flush(),i&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.push(this,this._enabledFilters),n&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let h=0,d=this.children.length;h<d;++h)this.children[h].render(e)}r&&e.batch.flush(),n&&e.mask.pop(this),i&&((l=this._enabledFilters)!=null&&l.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const i=typeof e=="boolean"?e:e==null?void 0:e.children,n=this.removeChildren(0,this.children.length);if(i)for(let r=0;r<n.length;++r)n[r].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const i=this.getLocalBounds().width;i!==0?this.scale.x=e/i:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const i=this.getLocalBounds().height;i!==0?this.scale.y=e/i:this.scale.y=1,this._height=e}};w7.defaultSortableChildren=!1;let Qt=w7;Qt.prototype.containerUpdateTransform=Qt.prototype.updateTransform;Object.defineProperties(kt,{SORTABLE_CHILDREN:{get(){return Qt.defaultSortableChildren},set(s){Yi("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Qt.defaultSortableChildren=s}}});const Iv=new si,ywe=new Uint16Array([0,1,2,0,2,3]);let rr=class O7 extends Qt{constructor(e){super(),this._anchor=new Zh(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Zn(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=mi.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||Wi.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=ywe,this.pluginName="batch",this.isSprite=!0,this._roundPixels=kt.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=$d(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=$d(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const i=this.transform.worldTransform,n=i.a,r=i.b,o=i.c,a=i.d,l=i.tx,h=i.ty,d=this.vertexData,f=e.trim,p=e.orig,g=this._anchor;let y=0,x=0,_=0,w=0;if(f?(x=f.x-g._x*p.width,y=x+f.width,w=f.y-g._y*p.height,_=w+f.height):(x=-g._x*p.width,y=x+p.width,w=-g._y*p.height,_=w+p.height),d[0]=n*x+o*w+l,d[1]=a*w+r*x+h,d[2]=n*y+o*w+l,d[3]=a*w+r*y+h,d[4]=n*y+o*_+l,d[5]=a*_+r*y+h,d[6]=n*x+o*_+l,d[7]=a*_+r*x+h,this._roundPixels){const O=kt.RESOLUTION;for(let T=0;T<d.length;++T)d[T]=Math.round(d[T]*O)/O}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,i=this.vertexTrimmedData,n=e.orig,r=this._anchor,o=this.transform.worldTransform,a=o.a,l=o.b,h=o.c,d=o.d,f=o.tx,p=o.ty,g=-r._x*n.width,y=g+n.width,x=-r._y*n.height,_=x+n.height;if(i[0]=a*g+h*x+f,i[1]=d*x+l*g+p,i[2]=a*y+h*x+f,i[3]=d*x+l*y+p,i[4]=a*y+h*_+f,i[5]=d*_+l*y+p,i[6]=a*g+h*_+f,i[7]=d*_+l*g+p,this._roundPixels){const w=kt.RESOLUTION;for(let O=0;O<i.length;++O)i[O]=Math.round(i[O]*w)/w}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,i=this._texture.orig;!e||e.width===i.width&&e.height===i.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new DC),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Pi),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,Iv);const i=this._texture.orig.width,n=this._texture.orig.height,r=-i*this.anchor.x;let o=0;return Iv.x>=r&&Iv.x<r+i&&(o=-n*this.anchor.y,Iv.y>=o&&Iv.y<o+n)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const i=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(e,i){const n=e instanceof Wi?e:Wi.from(e,i);return new O7(n)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const i=$d(this.scale.x)||1;this.scale.x=i*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const i=$d(this.scale.y)||1;this.scale.y=i*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Wi.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}};const S7=new es;xs.prototype._cacheAsBitmap=!1;xs.prototype._cacheData=null;xs.prototype._cacheAsBitmapResolution=null;xs.prototype._cacheAsBitmapMultisample=null;class vwe{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(xs.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(s){s!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=s,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(s){s!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=s,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(s){if(this._cacheAsBitmap===s)return;this._cacheAsBitmap=s;let e;s?(this._cacheData||(this._cacheData=new vwe),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});xs.prototype._renderCached=function(s){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(s),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(s))};xs.prototype._initCachedDisplayObject=function(s){var g,y;if((g=this._cacheData)!=null&&g.sprite)return;const e=this.alpha;this.alpha=1,s.batch.flush();const i=this.getLocalBounds(new Pi,!0);if((y=this.filters)!=null&&y.length){const x=this.filters[0].padding;i.pad(x)}const n=this.cacheAsBitmapResolution||s.resolution;i.ceil(n),i.width=Math.max(i.width,1/n),i.height=Math.max(i.height,1/n);const r=s.renderTexture.current,o=s.renderTexture.sourceFrame.clone(),a=s.renderTexture.destinationFrame.clone(),l=s.projection.transform,h=Mm.create({width:i.width,height:i.height,resolution:n,multisample:this.cacheAsBitmapMultisample??s.multisample}),d=`cacheAsBitmap_${fm()}`;this._cacheData.textureCacheId=d,Mi.addToCache(h.baseTexture,d),Wi.addToCache(h,d);const f=this.transform.localTransform.copyTo(S7).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,s.render(this,{renderTexture:h,clear:!0,transform:f,skipUpdateTransform:!1}),s.framebuffer.blit(),s.projection.transform=l,s.renderTexture.bind(r,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const p=new rr(h);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-(i.x/i.width),p.anchor.y=-(i.y/i.height),p.alpha=e,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=p.containsPoint.bind(p)};xs.prototype._renderCachedCanvas=function(s){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(s),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(s))};xs.prototype._initCachedDisplayObjectCanvas=function(s){var f;if((f=this._cacheData)!=null&&f.sprite)return;const e=this.getLocalBounds(new Pi,!0),i=this.alpha;this.alpha=1;const n=s.canvasContext.activeContext,r=s._projTransform,o=this.cacheAsBitmapResolution||s.resolution;e.ceil(o),e.width=Math.max(e.width,1/o),e.height=Math.max(e.height,1/o);const a=Mm.create({width:e.width,height:e.height,resolution:o}),l=`cacheAsBitmap_${fm()}`;this._cacheData.textureCacheId=l,Mi.addToCache(a.baseTexture,l),Wi.addToCache(a,l);const h=S7;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=e.x,h.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,s.render(this,{renderTexture:a,clear:!0,transform:h,skipUpdateTransform:!1}),s.canvasContext.activeContext=n,s._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;const d=new rr(a);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(e.x/e.width),d.anchor.y=-(e.y/e.height),d.alpha=i,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=s._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=d.containsPoint.bind(d)};xs.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};xs.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};xs.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Mi.removeFromCache(this._cacheData.textureCacheId),Wi.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};xs.prototype._cacheAsBitmapDestroy=function(s){this.cacheAsBitmap=!1,this.destroy(s)};xs.prototype.name=null;Qt.prototype.getChildByName=function(s,e){for(let i=0,n=this.children.length;i<n;i++)if(this.children[i].name===s)return this.children[i];if(e)for(let i=0,n=this.children.length;i<n;i++){const r=this.children[i];if(!r.getChildByName)continue;const o=r.getChildByName(s,!0);if(o)return o}return null};xs.prototype.getGlobalPosition=function(s=new si,e=!1){return this.parent?this.parent.toGlobal(this.position,s,e):(s.x=this.position.x,s.y=this.position.y),s};var xwe=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class _we extends bo{constructor(e=1){super(lwe,xwe,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const bwe={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},wwe=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function Owe(s){const e=bwe[s],i=e.length;let n=wwe,r="";const o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let a;for(let l=0;l<s;l++){let h=o.replace("%index%",l.toString());a=l,l>=i&&(a=s-l-1),h=h.replace("%value%",e[a].toString()),r+=h,r+=`
`}return n=n.replace("%blur%",r),n=n.replace("%size%",s.toString()),n}const Swe=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function Cwe(s,e){const i=Math.ceil(s/2);let n=Swe,r="",o;e?o="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":o="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<s;a++){let l=o.replace("%index%",a.toString());l=l.replace("%sampleIndex%",`${a-(i-1)}.0`),r+=l,r+=`
`}return n=n.replace("%blur%",r),n=n.replace("%size%",s.toString()),n}class II extends bo{constructor(e,i=8,n=4,r=bo.defaultResolution,o=5){const a=Cwe(o,e),l=Owe(o);super(a,l),this.horizontal=e,this.resolution=r,this._quality=0,this.quality=n,this.blur=i}apply(e,i,n,r){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/i.width):this.uniforms.strength=1/n.height*(n.height/i.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/i.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/i.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,i,n,r);else{const o=e.getFilterTexture(),a=e.renderer;let l=i,h=o;this.state.blend=!1,e.applyFilter(this,l,h,Uc.CLEAR);for(let d=1;d<this.passes-1;d++){e.bindAndClear(l,Uc.BLIT),this.uniforms.uSampler=h;const f=h;h=l,l=f,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,h,n,r),e.returnFilterTexture(o)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class Twe extends bo{constructor(e=8,i=4,n=bo.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new II(!0,e,i,n,r),this.blurYFilter=new II(!1,e,i,n,r),this.resolution=n,this.quality=i,this.blur=e,this.repeatEdgePixels=!1}apply(e,i,n,r){const o=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(o&&a){const l=e.getFilterTexture();this.blurXFilter.apply(e,i,l,Uc.CLEAR),this.blurYFilter.apply(e,l,n,r),e.returnFilterTexture(l)}else a?this.blurYFilter.apply(e,i,n,r):this.blurXFilter.apply(e,i,n,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var Awe=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class BI extends bo{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(m7,Awe,e),this.alpha=1}_loadMatrix(e,i=!1){let n=e;i&&(this._multiply(n,this.uniforms.m,e),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(e,i,n){return e[0]=i[0]*n[0]+i[1]*n[5]+i[2]*n[10]+i[3]*n[15],e[1]=i[0]*n[1]+i[1]*n[6]+i[2]*n[11]+i[3]*n[16],e[2]=i[0]*n[2]+i[1]*n[7]+i[2]*n[12]+i[3]*n[17],e[3]=i[0]*n[3]+i[1]*n[8]+i[2]*n[13]+i[3]*n[18],e[4]=i[0]*n[4]+i[1]*n[9]+i[2]*n[14]+i[3]*n[19]+i[4],e[5]=i[5]*n[0]+i[6]*n[5]+i[7]*n[10]+i[8]*n[15],e[6]=i[5]*n[1]+i[6]*n[6]+i[7]*n[11]+i[8]*n[16],e[7]=i[5]*n[2]+i[6]*n[7]+i[7]*n[12]+i[8]*n[17],e[8]=i[5]*n[3]+i[6]*n[8]+i[7]*n[13]+i[8]*n[18],e[9]=i[5]*n[4]+i[6]*n[9]+i[7]*n[14]+i[8]*n[19]+i[9],e[10]=i[10]*n[0]+i[11]*n[5]+i[12]*n[10]+i[13]*n[15],e[11]=i[10]*n[1]+i[11]*n[6]+i[12]*n[11]+i[13]*n[16],e[12]=i[10]*n[2]+i[11]*n[7]+i[12]*n[12]+i[13]*n[17],e[13]=i[10]*n[3]+i[11]*n[8]+i[12]*n[13]+i[13]*n[18],e[14]=i[10]*n[4]+i[11]*n[9]+i[12]*n[14]+i[13]*n[19]+i[14],e[15]=i[15]*n[0]+i[16]*n[5]+i[17]*n[10]+i[18]*n[15],e[16]=i[15]*n[1]+i[16]*n[6]+i[17]*n[11]+i[18]*n[16],e[17]=i[15]*n[2]+i[16]*n[7]+i[17]*n[12]+i[18]*n[17],e[18]=i[15]*n[3]+i[16]*n[8]+i[17]*n[13]+i[18]*n[18],e[19]=i[15]*n[4]+i[16]*n[9]+i[17]*n[14]+i[18]*n[19]+i[19],e}_colorMatrix(e){const i=new Float32Array(e);return i[4]/=255,i[9]/=255,i[14]/=255,i[19]/=255,i}brightness(e,i){const n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,i)}tint(e,i){const[n,r,o]=Zn.shared.setValue(e).toArray(),a=[n,0,0,0,0,0,r,0,0,0,0,0,o,0,0,0,0,0,1,0];this._loadMatrix(a,i)}greyscale(e,i){const n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,i)}blackAndWhite(e){const i=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(i,e)}hue(e,i){e=(e||0)/180*Math.PI;const n=Math.cos(e),r=Math.sin(e),o=Math.sqrt,a=1/3,l=o(a),h=n+(1-n)*a,d=a*(1-n)-l*r,f=a*(1-n)+l*r,p=a*(1-n)+l*r,g=n+a*(1-n),y=a*(1-n)-l*r,x=a*(1-n)-l*r,_=a*(1-n)+l*r,w=n+a*(1-n),O=[h,d,f,0,0,p,g,y,0,0,x,_,w,0,0,0,0,0,1,0];this._loadMatrix(O,i)}contrast(e,i){const n=(e||0)+1,r=-.5*(n-1),o=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(o,i)}saturate(e=0,i){const n=e*2/3+1,r=(n-1)*-.5,o=[n,r,r,0,0,r,n,r,0,0,r,r,n,0,0,0,0,0,1,0];this._loadMatrix(o,i)}desaturate(){this.saturate(-1)}negative(e){const i=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(i,e)}sepia(e){const i=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(i,e)}technicolor(e){const i=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(i,e)}polaroid(e){const i=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(i,e)}toBGR(e){const i=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(i,e)}kodachrome(e){const i=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(i,e)}browni(e){const i=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(i,e)}vintage(e){const i=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(i,e)}colorTone(e,i,n,r,o){e=e||.2,i=i||.15,n=n||16770432,r=r||3375104;const a=Zn.shared,[l,h,d]=a.setValue(n).toArray(),[f,p,g]=a.setValue(r).toArray(),y=[.3,.59,.11,0,0,l,h,d,e,0,f,p,g,i,0,l-f,h-p,d-g,0,0];this._loadMatrix(y,o)}night(e,i){e=e||.1;const n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,i)}predator(e,i){const n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,i)}lsd(e){const i=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(i,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}BI.prototype.grayscale=BI.prototype.greyscale;var Ewe=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,Mwe=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class kwe extends bo{constructor(e,i){const n=new es;e.renderable=!1,super(Mwe,Ewe,{mapSampler:e._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=n,i==null&&(i=20),this.scale=new si(i,i)}apply(e,i,n,r){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const o=this.maskSprite.worldTransform,a=Math.sqrt(o.a*o.a+o.b*o.b),l=Math.sqrt(o.c*o.c+o.d*o.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=o.a/a,this.uniforms.rotation[1]=o.b/a,this.uniforms.rotation[2]=o.c/l,this.uniforms.rotation[3]=o.d/l),e.applyFilter(this,i,n,r)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var Pwe=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,Iwe=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class Bwe extends bo{constructor(){super(Iwe,Pwe)}}var Rwe=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class Dwe extends bo{constructor(e=.5,i=Math.random()){super(m7,Rwe,{uNoise:0,uSeed:0}),this.noise=e,this.seed=i}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const i4={AlphaFilter:_we,BlurFilter:Twe,BlurFilterPass:II,ColorMatrixFilter:BI,DisplacementFilter:kwe,FXAAFilter:Bwe,NoiseFilter:Dwe};Object.entries(i4).forEach(([s,e])=>{Object.defineProperty(i4,s,{get(){return Yi("7.1.0",`filters.${s} has moved to ${s}`),e}})});class Lwe{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(jo.system.add(this.tickerUpdate,this,pm.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(jo.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Bd=new Lwe;class xb{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=xb.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new si,this.page=new si,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,i,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,i,n,r,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class LC extends xb{constructor(){super(...arguments),this.client=new si,this.movement=new si,this.offset=new si,this.global=new si,this.screen=new si}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,i,n){return e.worldTransform.applyInverse(n||this.global,i)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,i,n,r,o,a,l,h,d,f,p,g,y,x,_){throw new Error("Method not implemented.")}}class Fl extends LC{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class L0 extends LC{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}L0.DOM_DELTA_PIXEL=0,L0.DOM_DELTA_LINE=1,L0.DOM_DELTA_PAGE=2;const Nwe=2048,Vwe=new si,Sk=new si;class $we{constructor(e){this.dispatch=new mb,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,i){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:i,priority:0}),this.mappingTable[e].sort((n,r)=>n.priority-r.priority)}dispatchEvent(e,i){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,i),this.dispatch.emit(i||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const i=this.mappingTable[e.type];if(i)for(let n=0,r=i.length;n<r;n++)i[n].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,i){Bd.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",r=this[n](this.rootTarget,this.rootTarget.eventMode,Vwe.set(e,i),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(e,i){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let r=0,o=n.length-1;r<o;r++)if(e.currentTarget=n[r],this.notifyTarget(e,i),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,i),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let r=n.length-2;r>=0;r--)if(e.currentTarget=n[r],this.notifyTarget(e,i),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,i,n=this._allInteractiveElements){if(n.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const r=Array.isArray(i)?i:[i];for(let o=n.length-1;o>=0;o--)r.forEach(a=>{e.currentTarget=n[o],this.notifyTarget(e,a)})}propagationPath(e){const i=[e];for(let n=0;n<Nwe&&e!==this.rootTarget;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");i.push(e.parent),e=e.parent}return i.reverse(),i}hitTestMoveRecursive(e,i,n,r,o,a=!1){let l=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||i==="dynamic")&&(Bd.pauseUpdate=!1),e.interactiveChildren&&e.children){const f=e.children;for(let p=f.length-1;p>=0;p--){const g=f[p],y=this.hitTestMoveRecursive(g,this._isInteractive(i)?i:g.eventMode,n,r,o,a||o(e,n));if(y){if(y.length>0&&!y[y.length-1].parent)continue;const x=e.isInteractive();(y.length>0||x)&&(x&&this._allInteractiveElements.push(e),y.push(e)),this._hitElements.length===0&&(this._hitElements=y),l=!0}}}const h=this._isInteractive(i),d=e.isInteractive();return h&&d&&this._allInteractiveElements.push(e),a||this._hitElements.length>0?null:l?this._hitElements:h&&!o(e,n)&&r(e,n)?d?[e]:[]:null}hitTestRecursive(e,i,n,r,o){if(this._interactivePrune(e)||o(e,n))return null;if((e.eventMode==="dynamic"||i==="dynamic")&&(Bd.pauseUpdate=!1),e.interactiveChildren&&e.children){const h=e.children;for(let d=h.length-1;d>=0;d--){const f=h[d],p=this.hitTestRecursive(f,this._isInteractive(i)?i:f.eventMode,n,r,o);if(p){if(p.length>0&&!p[p.length-1].parent)continue;const g=e.isInteractive();return(p.length>0||g)&&p.push(e),p}}}const a=this._isInteractive(i),l=e.isInteractive();return a&&r(e,n)?l?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,i){var n;if(e.hitArea&&(e.worldTransform.applyInverse(i,Sk),!e.hitArea.contains(Sk.x,Sk.y)))return!0;if(e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!((n=r.containsPoint)!=null&&n.call(r,i)))return!0}return!1}hitTestFn(e,i){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(i):!1}notifyTarget(e,i){var o,a;i=i??e.type;const n=`on${i}`;(a=(o=e.currentTarget)[n])==null||a.call(o,e);const r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${i}capture`:i;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,i)}mapPointerDown(e){if(!(e instanceof Fl)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerdown"),i.pointerType==="touch")this.dispatchEvent(i,"touchstart");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const r=i.button===2;this.dispatchEvent(i,r?"rightdown":"mousedown")}const n=this.trackingData(e.pointerId);n.pressTargetsByButton[e.button]=i.composedPath(),this.freeEvent(i)}mapPointerMove(e){var h,d;if(!(e instanceof Fl)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const i=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const n=i.pointerType==="mouse"||i.pointerType==="pen",r=this.trackingData(e.pointerId),o=this.findMountedTarget(r.overTargets);if(((h=r.overTargets)==null?void 0:h.length)>0&&o!==i.target){const f=e.type==="mousemove"?"mouseout":"pointerout",p=this.createPointerEvent(e,f,o);if(this.dispatchEvent(p,"pointerout"),n&&this.dispatchEvent(p,"mouseout"),!i.composedPath().includes(o)){const g=this.createPointerEvent(e,"pointerleave",o);for(g.eventPhase=g.AT_TARGET;g.target&&!i.composedPath().includes(g.target);)g.currentTarget=g.target,this.notifyTarget(g),n&&this.notifyTarget(g,"mouseleave"),g.target=g.target.parent;this.freeEvent(g)}this.freeEvent(p)}if(o!==i.target){const f=e.type==="mousemove"?"mouseover":"pointerover",p=this.clonePointerEvent(i,f);this.dispatchEvent(p,"pointerover"),n&&this.dispatchEvent(p,"mouseover");let g=o==null?void 0:o.parent;for(;g&&g!==this.rootTarget.parent&&g!==i.target;)g=g.parent;if(!g||g===this.rootTarget.parent){const y=this.clonePointerEvent(i,"pointerenter");for(y.eventPhase=y.AT_TARGET;y.target&&y.target!==o&&y.target!==this.rootTarget.parent;)y.currentTarget=y.target,this.notifyTarget(y),n&&this.notifyTarget(y,"mouseenter"),y.target=y.target.parent;this.freeEvent(y)}this.freeEvent(p)}const a=[],l=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(i,"pointermove"),l&&a.push("globalpointermove"),i.pointerType==="touch"&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(i,"touchmove"),l&&a.push("globaltouchmove")),n&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(i,"mousemove"),l&&a.push("globalmousemove"),this.cursor=(d=i.target)==null?void 0:d.cursor),a.length>0&&this.all(i,a),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=i.composedPath(),this.freeEvent(i)}mapPointerOver(e){var a;if(!(e instanceof Fl)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.trackingData(e.pointerId),n=this.createPointerEvent(e),r=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),r&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(a=n.target)==null?void 0:a.cursor);const o=this.clonePointerEvent(n,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;i.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(o)}mapPointerOut(e){if(!(e instanceof Fl)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.trackingData(e.pointerId);if(i.overTargets){const n=e.pointerType==="mouse"||e.pointerType==="pen",r=this.findMountedTarget(i.overTargets),o=this.createPointerEvent(e,"pointerout",r);this.dispatchEvent(o),n&&this.dispatchEvent(o,"mouseout");const a=this.createPointerEvent(e,"pointerleave",r);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),n&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;i.overTargets=null,this.freeEvent(o),this.freeEvent(a)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Fl)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=performance.now(),n=this.createPointerEvent(e);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.dispatchEvent(n,l?"rightup":"mouseup")}const r=this.trackingData(e.pointerId),o=this.findMountedTarget(r.pressTargetsByButton[e.button]);let a=o;if(o&&!n.composedPath().includes(o)){let l=o;for(;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const h=n.button===2;this.notifyTarget(n,h?"rightupoutside":"mouseupoutside")}l=l.parent}delete r.pressTargetsByButton[e.button],a=l}if(a){const l=this.clonePointerEvent(n,"click");l.target=a,l.path=null,r.clicksByButton[e.button]||(r.clicksByButton[e.button]={clickCount:0,target:l.target,timeStamp:i});const h=r.clicksByButton[e.button];if(h.target===l.target&&i-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=l.target,h.timeStamp=i,l.detail=h.clickCount,l.pointerType==="mouse"){const d=l.button===2;this.dispatchEvent(l,d?"rightclick":"click")}else l.pointerType==="touch"&&this.dispatchEvent(l,"tap");this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(n)}mapPointerUpOutside(e){if(!(e instanceof Fl)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const i=this.trackingData(e.pointerId),n=this.findMountedTarget(i.pressTargetsByButton[e.button]),r=this.createPointerEvent(e);if(n){let o=n;for(;o;)r.currentTarget=o,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),o=o.parent;delete i.pressTargetsByButton[e.button]}this.freeEvent(r)}mapWheel(e){if(!(e instanceof L0)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const i=this.createWheelEvent(e);this.dispatchEvent(i),this.freeEvent(i)}findMountedTarget(e){if(!e)return null;let i=e[0];for(let n=1;n<e.length&&e[n].parent===i;n++)i=e[n];return i}createPointerEvent(e,i,n){const r=this.allocateEvent(Fl);return this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=n??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],typeof i=="string"&&(r.type=i),r}createWheelEvent(e){const i=this.allocateEvent(L0);return this.copyWheelData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=this.hitTest(i.global.x,i.global.y),i}clonePointerEvent(e,i){const n=this.allocateEvent(Fl);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=i??n.type,n}copyWheelData(e,i){i.deltaMode=e.deltaMode,i.deltaX=e.deltaX,i.deltaY=e.deltaY,i.deltaZ=e.deltaZ}copyPointerData(e,i){e instanceof Fl&&i instanceof Fl&&(i.pointerId=e.pointerId,i.width=e.width,i.height=e.height,i.isPrimary=e.isPrimary,i.pointerType=e.pointerType,i.pressure=e.pressure,i.tangentialPressure=e.tangentialPressure,i.tiltX=e.tiltX,i.tiltY=e.tiltY,i.twist=e.twist)}copyMouseData(e,i){e instanceof LC&&i instanceof LC&&(i.altKey=e.altKey,i.button=e.button,i.buttons=e.buttons,i.client.copyFrom(e.client),i.ctrlKey=e.ctrlKey,i.metaKey=e.metaKey,i.movement.copyFrom(e.movement),i.screen.copyFrom(e.screen),i.shiftKey=e.shiftKey,i.global.copyFrom(e.global))}copyData(e,i){i.isTrusted=e.isTrusted,i.srcElement=e.srcElement,i.timeStamp=performance.now(),i.type=e.type,i.detail=e.detail,i.view=e.view,i.which=e.which,i.layer.copyFrom(e.layer),i.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const i=this.eventPool.get(e).pop()||new e(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=null,i.target=null,i}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const i=e.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),this.eventPool.get(i).push(e)}notifyListeners(e,i){const n=e.currentTarget._events[i];if(n&&e.currentTarget.isInteractive())if("fn"in n)n.once&&e.currentTarget.removeListener(i,n.fn,void 0,!0),n.fn.call(n.context,e);else for(let r=0,o=n.length;r<o&&!e.propagationImmediatelyStopped;r++)n[r].once&&e.currentTarget.removeListener(i,n[r].fn,void 0,!0),n[r].fn.call(n[r].context,e)}}const Uwe=1,Fwe={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},RI=class DI{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new $we(null),Bd.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Fl(null),this.rootWheelEvent=new L0(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...DI.defaultEventFeatures},{set:(i,n,r)=>(n==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=r),i[n]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:i,resolution:n}=this.renderer;this.setTargetElement(i),this.resolution=n,DI._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let i=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(i=!1),this.currentCursor===e)return;this.currentCursor=e;const n=this.cursorStyles[e];if(n)switch(typeof n){case"string":i&&(this.domElement.style.cursor=n);break;case"function":n(e);break;case"object":i&&Object.assign(this.domElement.style,n);break}else i&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const i=this.normalizeToPointerData(e);this.autoPreventDefault&&i[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let n=0,r=i.length;n<r;n++){const o=i[n],a=this.bootstrapEvent(this.rootPointerEvent,o);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Bd.pointerMoved();const i=this.normalizeToPointerData(e);for(let n=0,r=i.length;n<r;n++){const o=this.bootstrapEvent(this.rootPointerEvent,i[n]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let i=e.target;e.composedPath&&e.composedPath().length>0&&(i=e.composedPath()[0]);const n=i!==this.domElement?"outside":"",r=this.normalizeToPointerData(e);for(let o=0,a=r.length;o<a;o++){const l=this.bootstrapEvent(this.rootPointerEvent,r[o]);l.type+=n,this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const i=this.normalizeToPointerData(e);for(let n=0,r=i.length;n<r;n++){const o=this.bootstrapEvent(this.rootPointerEvent,i[n]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const i=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(i)}setTargetElement(e){this.removeEvents(),this.domElement=e,Bd.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Bd.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Bd.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,i,n){const r=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},o=1/this.resolution;e.x=(i-r.left)*(this.domElement.width/r.width)*o,e.y=(n-r.top)*(this.domElement.height/r.height)*o}normalizeToPointerData(e){const i=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let n=0,r=e.changedTouches.length;n<r;n++){const o=e.changedTouches[n];typeof o.button>"u"&&(o.button=0),typeof o.buttons>"u"&&(o.buttons=1),typeof o.isPrimary>"u"&&(o.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,o.type=e.type,i.push(o)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const n=e;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=Uwe),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,i.push(n)}else i.push(e);return i}normalizeWheelEvent(e){const i=this.rootWheelEvent;return this.transferMouseData(i,e),i.deltaX=e.deltaX,i.deltaY=e.deltaY,i.deltaZ=e.deltaZ,i.deltaMode=e.deltaMode,this.mapPositionToPoint(i.screen,e.clientX,e.clientY),i.global.copyFrom(i.screen),i.offset.copyFrom(i.screen),i.nativeEvent=e,i.type=e.type,i}bootstrapEvent(e,i){return e.originalEvent=null,e.nativeEvent=i,e.pointerId=i.pointerId,e.width=i.width,e.height=i.height,e.isPrimary=i.isPrimary,e.pointerType=i.pointerType,e.pressure=i.pressure,e.tangentialPressure=i.tangentialPressure,e.tiltX=i.tiltX,e.tiltY=i.tiltY,e.twist=i.twist,this.transferMouseData(e,i),this.mapPositionToPoint(e.screen,i.clientX,i.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=Fwe[e.type]||e.type),e}transferMouseData(e,i){e.isTrusted=i.isTrusted,e.srcElement=i.srcElement,e.timeStamp=performance.now(),e.type=i.type,e.altKey=i.altKey,e.button=i.button,e.buttons=i.buttons,e.client.x=i.clientX,e.client.y=i.clientY,e.ctrlKey=i.ctrlKey,e.metaKey=i.metaKey,e.movement.x=i.movementX,e.movement.y=i.movementY,e.page.x=i.pageX,e.page.y=i.pageY,e.relatedTarget=null,e.shiftKey=i.shiftKey}};RI.extension={name:"events",type:[xt.RendererSystem,xt.CanvasRendererSystem]},RI.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let LI=RI;$t.add(LI);function n4(s){return s==="dynamic"||s==="static"}const zwe={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??n4(LI.defaultEventMode)},set interactive(s){Yi("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=s,this.eventMode=s?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??LI.defaultEventMode},set eventMode(s){this._internalInteractive=n4(s),this._internalEventMode=s},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(s,e,i){const n=typeof i=="boolean"&&i||typeof i=="object"&&i.capture,r=typeof i=="object"?i.signal:void 0,o=typeof i=="object"?i.once===!0:!1,a=typeof e=="function"?void 0:e;s=n?`${s}capture`:s;const l=typeof e=="function"?e:e.handleEvent,h=this;r&&r.addEventListener("abort",()=>{h.off(s,l,a)}),o?h.once(s,l,a):h.on(s,l,a)},removeEventListener(s,e,i){const n=typeof i=="boolean"&&i||typeof i=="object"&&i.capture,r=typeof e=="function"?void 0:e;s=n?`${s}capture`:s,e=typeof e=="function"?e:e.handleEvent,this.off(s,e,r)},dispatchEvent(s){if(!(s instanceof xb))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return s.defaultPrevented=!1,s.path=null,s.target=this,s.manager.dispatchEvent(s),!s.defaultPrevented}};xs.mixin(zwe);const Xwe={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};xs.mixin(Xwe);const Wwe=9,p1=100,Hwe=0,Gwe=0,s4=2,r4=1,Qwe=-1e3,Ywe=-1e3,jwe=2;class C7{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(qh.tablet||qh.phone)&&this.createTouchHook();const i=document.createElement("div");i.style.width=`${p1}px`,i.style.height=`${p1}px`,i.style.position="absolute",i.style.top=`${Hwe}px`,i.style.left=`${Gwe}px`,i.style.zIndex=s4.toString(),this.div=i,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${r4}px`,e.style.height=`${r4}px`,e.style.position="absolute",e.style.top=`${Qwe}px`,e.style.left=`${Ywe}px`,e.style.zIndex=jwe.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const i=e.children;if(i)for(let n=0;n<i.length;n++)this.updateAccessibleObjects(i[n])}update(){const e=performance.now();if(qh.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:i,y:n,width:r,height:o}=this.renderer.view.getBoundingClientRect(),{width:a,height:l,resolution:h}=this.renderer,d=r/a*h,f=o/l*h;let p=this.div;p.style.left=`${i}px`,p.style.top=`${n}px`,p.style.width=`${a}px`,p.style.height=`${l}px`;for(let g=0;g<this.children.length;g++){const y=this.children[g];if(y.renderId!==this.renderId)y._accessibleActive=!1,R0(this.children,g,1),this.div.removeChild(y._accessibleDiv),this.pool.push(y._accessibleDiv),y._accessibleDiv=null,g--;else{p=y._accessibleDiv;let x=y.hitArea;const _=y.worldTransform;y.hitArea?(p.style.left=`${(_.tx+x.x*_.a)*d}px`,p.style.top=`${(_.ty+x.y*_.d)*f}px`,p.style.width=`${x.width*_.a*d}px`,p.style.height=`${x.height*_.d*f}px`):(x=y.getBounds(),this.capHitArea(x),p.style.left=`${x.x*d}px`,p.style.top=`${x.y*f}px`,p.style.width=`${x.width*d}px`,p.style.height=`${x.height*f}px`,p.title!==y.accessibleTitle&&y.accessibleTitle!==null&&(p.title=y.accessibleTitle),p.getAttribute("aria-label")!==y.accessibleHint&&y.accessibleHint!==null&&p.setAttribute("aria-label",y.accessibleHint)),(y.accessibleTitle!==p.title||y.tabIndex!==p.tabIndex)&&(p.title=y.accessibleTitle,p.tabIndex=y.tabIndex,this.debug&&this.updateDebugHTML(p))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:i,height:n}=this.renderer;e.x+e.width>i&&(e.width=i-e.x),e.y+e.height>n&&(e.height=n-e.y)}addChild(e){let i=this.pool.pop();i||(i=document.createElement("button"),i.style.width=`${p1}px`,i.style.height=`${p1}px`,i.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",i.style.position="absolute",i.style.zIndex=s4.toString(),i.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?i.setAttribute("aria-live","off"):i.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?i.setAttribute("aria-relevant","additions"):i.setAttribute("aria-relevant","text"),i.addEventListener("click",this._onClick.bind(this)),i.addEventListener("focus",this._onFocus.bind(this)),i.addEventListener("focusout",this._onFocusOut.bind(this))),i.style.pointerEvents=e.accessiblePointerEvents,i.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?i.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(i.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&i.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(i),e._accessibleActive=!0,e._accessibleDiv=i,i.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,i){const{displayObject:n}=e.target,r=this.renderer.events.rootBoundary,o=Object.assign(new xb(r),{target:n});r.rootTarget=this.renderer.lastObjectRendered,i.forEach(a=>r.dispatchEvent(o,a))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===Wwe&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}C7.extension={name:"accessibility",type:[xt.RendererPlugin,xt.CanvasRendererPlugin]};$t.add(C7);const T7=class NI{constructor(e){this.stage=new Qt,e=Object.assign({forceCanvas:!1},e),this.renderer=rwe(e),NI._plugins.forEach(i=>{i.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,i){const n=NI._plugins.slice(0);n.reverse(),n.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(i),this.stage=null,this.renderer.destroy(e),this.renderer=null}};T7._plugins=[];let uA=T7;$t.handleByList(xt.Application,uA._plugins);class A7{static init(e){Object.defineProperty(this,"resizeTo",{set(i){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=i,i&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let i,n;if(this._resizeTo===globalThis.window)i=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:o}=this._resizeTo;i=r,n=o}this.renderer.resize(i,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}A7.extension=xt.Application;$t.add(A7);const o4={loader:xt.LoadParser,resolver:xt.ResolveParser,cache:xt.CacheParser,detection:xt.DetectionParser};$t.handle(xt.Asset,s=>{const e=s.ref;Object.entries(o4).filter(([i])=>!!e[i]).forEach(([i,n])=>$t.add(Object.assign(e[i],{extension:e[i].extension??n})))},s=>{const e=s.ref;Object.keys(o4).filter(i=>!!e[i]).forEach(i=>$t.remove(e[i]))});class qwe{constructor(e,i=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=i}add(e){e.forEach(i=>{this._assetList.push(i)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],i=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<i;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Ey(s,e){if(Array.isArray(e)){for(const i of e)if(s.startsWith(`data:${i}`))return!0;return!1}return s.startsWith(`data:${e}`)}function yf(s,e){const i=s.split("?")[0],n=Or.extname(i).toLowerCase();return Array.isArray(e)?e.includes(n):n===e}const Hl=(s,e,i=!1)=>(Array.isArray(s)||(s=[s]),e?s.map(n=>typeof n=="string"||i?e(n):n):s),VI=(s,e)=>{const i=e.split("?")[1];return i&&(s+=`?${i}`),s};function E7(s,e,i,n,r){const o=e[i];for(let a=0;a<o.length;a++){const l=o[a];i<e.length-1?E7(s.replace(n[i],l),e,i+1,n,r):r.push(s.replace(n[i],l))}}function Zwe(s){const e=/\{(.*?)\}/g,i=s.match(e),n=[];if(i){const r=[];i.forEach(o=>{const a=o.substring(1,o.length-1).split(",");r.push(a)}),E7(s,r,0,i,n)}else n.push(s);return n}const NC=s=>!Array.isArray(s);class Kwe{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const i=this._cache.get(e);return i||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),i}set(e,i){const n=Hl(e);let r;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.test(i)){r=h.getCacheableAssets(n,i);break}}r||(r={},n.forEach(l=>{r[l]=i}));const o=Object.keys(r),a={cacheKeys:o,keys:n};if(n.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{this._cache.has(l)&&this._cache.get(l)!==i&&console.warn("[Cache] already has key:",l),this._cache.set(l,r[l])}),i instanceof Wi){const l=i;n.forEach(h=>{l.baseTexture!==Wi.EMPTY.baseTexture&&Mi.addToCache(l.baseTexture,h),Wi.addToCache(l,h)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const i=this._cacheMap.get(e);i.cacheKeys.forEach(n=>{this._cache.delete(n)}),i.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const Tp=new Kwe;let Jwe=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,i,n)=>(this._parsersValidated=!1,e[i]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,i){const n={promise:null,parser:null};return n.promise=(async()=>{var a,l;let r=null,o=null;if(i.loadParser&&(o=this._parserHash[i.loadParser],o||console.warn(`[Assets] specified load parser "${i.loadParser}" not found while loading ${e}`)),!o){for(let h=0;h<this.parsers.length;h++){const d=this.parsers[h];if(d.load&&((a=d.test)!=null&&a.call(d,e,i,this))){o=d;break}}if(!o)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await o.load(e,i,this),n.parser=o;for(let h=0;h<this.parsers.length;h++){const d=this.parsers[h];d.parse&&d.parse&&await((l=d.testParse)==null?void 0:l.call(d,r,i,this))&&(r=await d.parse(r,i,this)||r,n.parser=d)}return r})(),n}async load(e,i){this._parsersValidated||this._validateParsers();let n=0;const r={},o=NC(e),a=Hl(e,d=>({alias:[d],src:d})),l=a.length,h=a.map(async d=>{const f=Or.toAbsolute(d.src);if(!r[d.src])try{this.promiseCache[f]||(this.promiseCache[f]=this._getLoadPromiseAndParser(f,d)),r[d.src]=await this.promiseCache[f].promise,i&&i(++n/l)}catch(p){throw delete this.promiseCache[f],delete r[d.src],new Error(`[Loader.load] Failed to load ${f}.
${p}`)}});return await Promise.all(h),o?r[a[0].src]:r}async unload(e){const i=Hl(e,n=>({alias:[n],src:n})).map(async n=>{var a,l;const r=Or.toAbsolute(n.src),o=this.promiseCache[r];if(o){const h=await o.promise;delete this.promiseCache[r],(l=(a=o.parser)==null?void 0:a.unload)==null||l.call(a,h,n,this)}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,i)=>(e[i.name]&&console.warn(`[Assets] loadParser name conflict "${i.name}"`),{...e,[i.name]:i}),{})}};var ac=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(ac||{});const e1e=".json",t1e="application/json",i1e={extension:{type:xt.LoadParser,priority:ac.Low},name:"loadJson",test(s){return Ey(s,t1e)||yf(s,e1e)},async load(s){return await(await kt.ADAPTER.fetch(s)).json()}};$t.add(i1e);const n1e=".txt",s1e="text/plain",r1e={name:"loadTxt",extension:{type:xt.LoadParser,priority:ac.Low},test(s){return Ey(s,s1e)||yf(s,n1e)},async load(s){return await(await kt.ADAPTER.fetch(s)).text()}};$t.add(r1e);const o1e=["normal","bold","100","200","300","400","500","600","700","800","900"],a1e=[".ttf",".otf",".woff",".woff2"],l1e=["font/ttf","font/otf","font/woff","font/woff2"],c1e=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function h1e(s){const e=Or.extname(s),i=Or.basename(s,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let n=i.length>0;for(const o of i)if(!o.match(c1e)){n=!1;break}let r=i.join(" ");return n||(r=`"${r.replace(/[\\"]/g,"\\$&")}"`),r}const u1e=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function d1e(s){return u1e.test(s)?s:encodeURI(s)}const f1e={extension:{type:xt.LoadParser,priority:ac.Low},name:"loadWebFont",test(s){return Ey(s,l1e)||yf(s,a1e)},async load(s,e){var n,r,o;const i=kt.ADAPTER.getFontFaceSet();if(i){const a=[],l=((n=e.data)==null?void 0:n.family)??h1e(s),h=((o=(r=e.data)==null?void 0:r.weights)==null?void 0:o.filter(f=>o1e.includes(f)))??["normal"],d=e.data??{};for(let f=0;f<h.length;f++){const p=h[f],g=new FontFace(l,`url(${d1e(s)})`,{...d,weight:p});await g.load(),i.add(g),a.push(g)}return a.length===1?a[0]:a}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(e=>kt.ADAPTER.getFontFaceSet().delete(e))}};$t.add(f1e);const p1e=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let N0=null,$I=class{constructor(){N0||(N0=URL.createObjectURL(new Blob([p1e],{type:"application/javascript"}))),this.worker=new Worker(N0)}};$I.revokeObjectURL=function(){N0&&(URL.revokeObjectURL(N0),N0=null)};const m1e=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let V0=null;class M7{constructor(){V0||(V0=URL.createObjectURL(new Blob([m1e],{type:"application/javascript"}))),this.worker=new Worker(V0)}}M7.revokeObjectURL=function(){V0&&(URL.revokeObjectURL(V0),V0=null)};let a4=0,Ck;class g1e{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:i}=new $I;i.addEventListener("message",n=>{i.terminate(),$I.revokeObjectURL(),e(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Ck===void 0&&(Ck=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<Ck&&(this._createdWorkers++,e=new M7().worker,e.addEventListener("message",i=>{this.complete(i.data),this.returnWorker(i.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,i){await this._initWorkers();const n=new Promise((r,o)=>{this.queue.push({id:e,arguments:i,resolve:r,reject:o})});return this.next(),n}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const i=this.queue.pop(),n=i.id;this.resolveHash[a4]={resolve:i.resolve,reject:i.reject},e.postMessage({data:i.arguments,uuid:a4++,id:n})}}const l4=new g1e;function _b(s,e,i){s.resource.internal=!0;const n=new Wi(s),r=()=>{delete e.promiseCache[i],Tp.has(i)&&Tp.remove(i)};return n.baseTexture.once("destroyed",()=>{i in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),r())}),n.once("destroyed",()=>{s.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),n}const y1e=[".jpeg",".jpg",".png",".webp",".avif"],v1e=["image/jpeg","image/png","image/webp","image/avif"];async function x1e(s){const e=await kt.ADAPTER.fetch(s);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${e.status} ${e.statusText}`);const i=await e.blob();return await createImageBitmap(i)}const dA={name:"loadTextures",extension:{type:xt.LoadParser,priority:ac.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return Ey(s,v1e)||yf(s,y1e)},async load(s,e,i){var l;const n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let r;n?this.config.preferWorkers&&await l4.isImageBitmapSupported()?r=await l4.loadImageBitmap(s):r=await x1e(s):r=await new Promise((h,d)=>{const f=new Image;f.crossOrigin=this.config.crossOrigin,f.src=s,f.complete?h(f):(f.onload=()=>h(f),f.onerror=p=>d(p))});const o={...e.data};o.resolution??(o.resolution=pu(s)),n&&((l=o.resourceOptions)==null?void 0:l.ownsImageBitmap)===void 0&&(o.resourceOptions={...o.resourceOptions},o.resourceOptions.ownsImageBitmap=!0);const a=new Mi(r,o);return a.resource.src=s,_b(a,i,s)},unload(s){s.destroy(!0)}};$t.add(dA);const _1e=".svg",b1e="image/svg+xml",w1e={extension:{type:xt.LoadParser,priority:ac.High},name:"loadSVG",test(s){return Ey(s,b1e)||yf(s,_1e)},async testParse(s){return EI.test(s)},async parse(s,e,i){var o;const n=new EI(s,(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions);await n.load();const r=new Mi(n,{resolution:pu(s),...e==null?void 0:e.data});return r.resource.src=e.src,_b(r,i,e.src)},async load(s,e){return(await kt.ADAPTER.fetch(s)).text()},unload:dA.unload};$t.add(w1e);const O1e=[".mp4",".m4v",".webm",".ogv"],S1e=["video/mp4","video/webm","video/ogg"],C1e={name:"loadVideo",extension:{type:xt.LoadParser,priority:ac.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(s){return Ey(s,S1e)||yf(s,O1e)},async load(s,e,i){var a;let n;const r=await(await kt.ADAPTER.fetch(s)).blob(),o=URL.createObjectURL(r);try{const l={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(a=e==null?void 0:e.data)==null?void 0:a.resourceOptions,autoLoad:!0},h=new b7(o,l);await h.load();const d=new Mi(h,{alphaMode:await P_e(),resolution:pu(s),...e==null?void 0:e.data});d.resource.src=s,n=_b(d,i,s),n.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(o)})}catch(l){throw URL.revokeObjectURL(o),l}return n},unload(s){s.destroy(!0)}};$t.add(C1e);class T1e{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,i)=>`${e}${this._bundleIdConnector}${i}`,extractAssetIdFromBundle:(e,i)=>i.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(i=>{this._preferredOrder.push(i),i.priority||(i.priority=Object.keys(i.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const i=e;this._defaultSearchParams=Object.keys(i).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(i[n])}`).join("&")}}getAlias(e){const{alias:i,name:n,src:r,srcs:o}=e;return Hl(i||n||r||o,a=>typeof a=="string"?a:Array.isArray(a)?a.map(l=>(l==null?void 0:l.src)??(l==null?void 0:l.srcs)??l):a!=null&&a.src||a!=null&&a.srcs?a.src??a.srcs:a,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(i=>{this.addBundle(i.name,i.assets)})}addBundle(e,i){const n=[];Array.isArray(i)?i.forEach(r=>{const o=r.src??r.srcs,a=r.alias??r.name;let l;if(typeof a=="string"){const h=this._createBundleAssetId(e,a);n.push(h),l=[a,h]}else{const h=a.map(d=>this._createBundleAssetId(e,d));n.push(...h),l=[...a,...h]}this.add({...r,alias:l,src:o})}):Object.keys(i).forEach(r=>{const o=[r,this._createBundleAssetId(e,r)];if(typeof i[r]=="string")this.add({alias:o,src:i[r]});else if(Array.isArray(i[r]))this.add({alias:o,src:i[r]});else{const a=i[r],l=a.src??a.srcs;this.add({...a,alias:o,src:Array.isArray(l)?l:[l]})}n.push(...o)}),this._bundles[e]=n}add(e,i,n,r,o){const a=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(Yi("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),a.push({alias:e,src:i,data:n,format:r,loadParser:o})):Array.isArray(e)?a.push(...e):a.push(e);let l;l=h=>{this.hasKey(h)&&console.warn(`[Resolver] already has key: ${h} overwriting`)},Hl(a).forEach(h=>{const{src:d,srcs:f}=h;let{data:p,format:g,loadParser:y}=h;const x=Hl(d||f).map(O=>typeof O=="string"?Zwe(O):Array.isArray(O)?O:[O]),_=this.getAlias(h);Array.isArray(_)?_.forEach(l):l(_);const w=[];x.forEach(O=>{O.forEach(T=>{let C={};if(typeof T!="object"){C.src=T;for(let A=0;A<this._parsers.length;A++){const B=this._parsers[A];if(B.test(T)){C=B.parse(T);break}}}else p=T.data??p,g=T.format??g,y=T.loadParser??y,C={...C,...T};if(!_)throw new Error(`[Resolver] alias is undefined for this asset: ${C.src}`);C=this.buildResolvedAsset(C,{aliases:_,data:p,format:g,loadParser:y}),w.push(C)})}),_.forEach(O=>{this._assetMap[O]=w})})}resolveBundle(e){const i=NC(e);e=Hl(e);const n={};return e.forEach(r=>{const o=this._bundles[r];if(o){const a=this.resolve(o),l={};for(const h in a){const d=a[h];l[this._extractAssetIdFromBundle(r,h)]=d}n[r]=l}}),i?n[e[0]]:n}resolveUrl(e){const i=this.resolve(e);if(typeof e!="string"){const n={};for(const r in i)n[r]=i[r].src;return n}return i.src}resolve(e){const i=NC(e);e=Hl(e);const n={};return e.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let o=this._assetMap[r];const a=o[0],l=this._getPreferredOrder(o);l==null||l.priority.forEach(h=>{l.params[h].forEach(d=>{const f=o.filter(p=>p[h]?p[h]===d:!1);f.length&&(o=f)})}),this._resolverHash[r]=o[0]??a}else this._resolverHash[r]=this.buildResolvedAsset({alias:[r],src:r},{});n[r]=this._resolverHash[r]}),i?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let i=0;i<e.length;i++){const n=e[0],r=this._preferredOrder.find(o=>o.params.format.includes(n.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const i=/\?/.test(e)?"&":"?";return`${e}${i}${this._defaultSearchParams}`}buildResolvedAsset(e,i){const{aliases:n,data:r,loadParser:o,format:a}=i;return(this._basePath||this._rootPath)&&(e.src=Or.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...r||{},...e.data},e.loadParser=o??e.loadParser,e.format=a??e.format??Or.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class A1e{constructor(){this._detections=[],this._initialized=!1,this.resolver=new T1e,this.loader=new Jwe,this.cache=Tp,this._backgroundLoader=new qwe(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let l=e.manifest;typeof l=="string"&&(l=await this.load(l)),this.resolver.addManifest(l)}const i=((o=e.texturePreference)==null?void 0:o.resolution)??1,n=typeof i=="number"?[i]:i,r=await this._detectFormats({preferredFormats:(a=e.texturePreference)==null?void 0:a.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:n}}),e.preferences&&this.setPreferences(e.preferences)}add(e,i,n,r,o){this.resolver.add(e,i,n,r,o)}async load(e,i){this._initialized||await this.init();const n=NC(e),r=Hl(e).map(l=>{if(typeof l!="string"){const h=this.resolver.getAlias(l);return h.some(d=>!this.resolver.hasKey(d))&&this.add(l),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(l)||this.add({alias:l,src:l}),l}),o=this.resolver.resolve(r),a=await this._mapLoadToResolve(o,i);return n?a[r[0]]:a}addBundle(e,i){this.resolver.addBundle(e,i)}async loadBundle(e,i){this._initialized||await this.init();let n=!1;typeof e=="string"&&(n=!0,e=[e]);const r=this.resolver.resolveBundle(e),o={},a=Object.keys(r);let l=0,h=0;const d=()=>{i==null||i(++l/h)},f=a.map(p=>{const g=r[p];return h+=Object.keys(g).length,this._mapLoadToResolve(g,d).then(y=>{o[p]=y})});return await Promise.all(f),n?o[e[0]]:o}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const i=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(i))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const i=this.resolver.resolveBundle(e);Object.values(i).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return Tp.get(e);const i={};for(let n=0;n<e.length;n++)i[n]=Tp.get(e[n]);return i}async _mapLoadToResolve(e,i){const n=Object.values(e),r=Object.keys(e);this._backgroundLoader.active=!1;const o=await this.loader.load(n,i);this._backgroundLoader.active=!0;const a={};return n.forEach((l,h)=>{const d=o[l.src],f=[l.src];l.alias&&f.push(...l.alias),a[r[h]]=d,Tp.set(f,d)}),a}async unload(e){this._initialized||await this.init();const i=Hl(e).map(r=>typeof r!="string"?r.src:r),n=this.resolver.resolve(i);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=Hl(e);const i=this.resolver.resolveBundle(e),n=Object.keys(i).map(r=>this._unloadFromResolved(i[r]));await Promise.all(n)}async _unloadFromResolved(e){const i=Object.values(e);i.forEach(n=>{Tp.remove(n.src)}),await this.loader.unload(i)}async _detectFormats(e){let i=[];e.preferredFormats&&(i=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const n of e.detections)e.skipDetections||await n.test()?i=await n.add(i):e.skipDetections||(i=await n.remove(i));return i=i.filter((n,r)=>i.indexOf(n)===r),i}get detections(){return this._detections}get preferWorkers(){return dA.config.preferWorkers}set preferWorkers(e){Yi("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(i=>{i.config&&Object.keys(i.config).filter(n=>n in e).forEach(n=>{i.config[n]=e[n]})})}}const Bp=new A1e;$t.handleByList(xt.LoadParser,Bp.loader.parsers).handleByList(xt.ResolveParser,Bp.resolver.parsers).handleByList(xt.CacheParser,Bp.cache.parsers).handleByList(xt.DetectionParser,Bp.detections);const E1e={extension:xt.CacheParser,test:s=>Array.isArray(s)&&s.every(e=>e instanceof Wi),getCacheableAssets:(s,e)=>{const i={};return s.forEach(n=>{e.forEach((r,o)=>{i[n+(o===0?"":o+1)]=r})}),i}};$t.add(E1e);async function k7(s){if("Image"in globalThis)return new Promise(e=>{const i=new Image;i.onload=()=>{e(!0)},i.onerror=()=>{e(!1)},i.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(s)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const M1e={extension:{type:xt.DetectionParser,priority:1},test:async()=>k7("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(e=>e!=="avif")};$t.add(M1e);const k1e={extension:{type:xt.DetectionParser,priority:0},test:async()=>k7("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(e=>e!=="webp")};$t.add(k1e);const c4=["png","jpg","jpeg"],P1e={extension:{type:xt.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...c4],remove:async s=>s.filter(e=>!c4.includes(e))};$t.add(P1e);const I1e="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function VD(s){return I1e?!1:document.createElement("video").canPlayType(s)!==""}const B1e={extension:{type:xt.DetectionParser,priority:0},test:async()=>VD("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(e=>e!=="webm")};$t.add(B1e);const R1e={extension:{type:xt.DetectionParser,priority:0},test:async()=>VD("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(e=>e!=="mp4"&&e!=="m4v")};$t.add(R1e);const D1e={extension:{type:xt.DetectionParser,priority:0},test:async()=>VD("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(e=>e!=="ogv")};$t.add(D1e);const L1e={extension:xt.ResolveParser,test:dA.test,parse:s=>{var e;return{resolution:parseFloat(((e=kt.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:Or.extname(s).slice(1),src:s}}};$t.add(L1e);var Ar=(s=>(s[s.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",s[s.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",s[s.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",s[s.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",s[s.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",s[s.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",s[s.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",s[s.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",s[s.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",s[s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",s[s.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",s[s.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",s[s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",s[s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",s[s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",s[s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",s[s.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",s[s.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",s[s.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",s[s.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",s[s.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",s[s.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",s[s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",s[s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",s[s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",s))(Ar||{});const VC={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Pc,n0;function h4(){n0={bptc:Pc.getExtension("EXT_texture_compression_bptc"),astc:Pc.getExtension("WEBGL_compressed_texture_astc"),etc:Pc.getExtension("WEBGL_compressed_texture_etc"),s3tc:Pc.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Pc.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Pc.getExtension("WEBGL_compressed_texture_pvrtc")||Pc.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Pc.getExtension("WEBGL_compressed_texture_etc1"),atc:Pc.getExtension("WEBGL_compressed_texture_atc")}}const N1e={extension:{type:xt.DetectionParser,priority:2},test:async()=>{const s=kt.ADAPTER.createCanvas().getContext("webgl");return s?(Pc=s,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async s=>{n0||h4();const e=[];for(const i in n0)n0[i]&&e.push(i);return[...e,...s]},remove:async s=>(n0||h4(),s.filter(e=>!(e in n0)))};$t.add(N1e);class V1e extends aA{constructor(e,i={width:1,height:1,autoLoad:!0}){let n,r;typeof e=="string"?(n=e,r=new Uint8Array):(n=null,r=e),super(r,i),this.origin=n,this.buffer=r?new mI(r):null,this._load=null,this.loaded=!1,this.origin!==null&&i.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new mI(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class jp extends V1e{constructor(e,i){super(e,i),this.format=i.format,this.levels=i.levels||1,this._width=i.width,this._height=i.height,this._extension=jp._formatToExtension(this.format),(i.levelBuffers||this.buffer)&&(this._levelBuffers=i.levelBuffers||jp._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,i,n){const r=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;r.pixelStorei(r.UNPACK_ALIGNMENT,4);for(let o=0,a=this.levels;o<a;o++){const{levelID:l,levelWidth:h,levelHeight:d,levelBuffer:f}=this._levelBuffers[o];r.compressedTexImage2D(r.TEXTURE_2D,l,this.format,h,d,0,f)}return!0}onBlobLoaded(){this._levelBuffers=jp._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=35916&&e<=35919)return"s3tc_sRGB";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e===36196)return"etc1";if(e===35986||e===35987||e===34798)return"atc";if(e>=36492&&e<=36495)return"bptc";if(e===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${e}`)}static _createLevelBuffers(e,i,n,r,o,a,l){const h=new Array(n);let d=e.byteOffset,f=a,p=l,g=f+r-1&~(r-1),y=p+o-1&~(o-1),x=g*y*VC[i];for(let _=0;_<n;_++)h[_]={levelID:_,levelWidth:n>1?f:g,levelHeight:n>1?p:y,levelBuffer:new Uint8Array(e.buffer,d,x)},d+=x,f=f>>1||1,p=p>>1||1,g=f+r-1&~(r-1),y=p+o-1&~(o-1),x=g*y*VC[i];return h}}const Tk=4,m1=124,$1e=32,u4=20,U1e=542327876,g1={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},F1e={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},y1={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},z1e=1,X1e=2,W1e=4,H1e=64,G1e=512,Q1e=131072,Y1e=827611204,j1e=861165636,q1e=894720068,Z1e=808540228,K1e=4,J1e={[Y1e]:Ar.COMPRESSED_RGBA_S3TC_DXT1_EXT,[j1e]:Ar.COMPRESSED_RGBA_S3TC_DXT3_EXT,[q1e]:Ar.COMPRESSED_RGBA_S3TC_DXT5_EXT},eOe={70:Ar.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ar.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ar.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ar.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ar.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ar.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ar.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ar.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ar.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Ar.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Ar.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Ar.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Ar.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function tOe(s){const e=new Uint32Array(s);if(e[0]!==U1e)throw new Error("Invalid DDS file magic word");const i=new Uint32Array(s,0,m1/Uint32Array.BYTES_PER_ELEMENT),n=i[g1.HEIGHT],r=i[g1.WIDTH],o=i[g1.MIPMAP_COUNT],a=new Uint32Array(s,g1.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,$1e/Uint32Array.BYTES_PER_ELEMENT),l=a[z1e];if(l&W1e){const h=a[F1e.FOURCC];if(h!==Z1e){const T=J1e[h],C=Tk+m1,A=new Uint8Array(s,C);return[new jp(A,{format:T,width:r,height:n,levels:o})]}const d=Tk+m1,f=new Uint32Array(e.buffer,d,u4/Uint32Array.BYTES_PER_ELEMENT),p=f[y1.DXGI_FORMAT],g=f[y1.RESOURCE_DIMENSION],y=f[y1.MISC_FLAG],x=f[y1.ARRAY_SIZE],_=eOe[p];if(_===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${p}`);if(y===K1e)throw new Error("DDSParser does not support cubemap textures");if(g===6)throw new Error("DDSParser does not supported 3D texture data");const w=new Array,O=Tk+m1+u4;if(x===1)w.push(new Uint8Array(s,O));else{const T=VC[_];let C=0,A=r,B=n;for(let R=0;R<o;R++){const P=Math.max(1,A+3&-4),k=Math.max(1,B+3&-4),E=P*k*T;C+=E,A=A>>>1,B=B>>>1}let I=O;for(let R=0;R<x;R++)w.push(new Uint8Array(s,I,C)),I+=C}return w.map(T=>new jp(T,{format:_,width:r,height:n,levels:o}))}throw l&H1e?new Error("DDSParser does not support uncompressed texture data."):l&G1e?new Error("DDSParser does not supported YUV uncompressed texture data."):l&Q1e?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&X1e?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const d4=[171,75,84,88,32,49,49,187,13,10,26,10],iOe=67305985,Pl={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},UI=64,f4={[qt.UNSIGNED_BYTE]:1,[qt.UNSIGNED_SHORT]:2,[qt.INT]:4,[qt.UNSIGNED_INT]:4,[qt.FLOAT]:4,[qt.HALF_FLOAT]:8},nOe={[rt.RGBA]:4,[rt.RGB]:3,[rt.RG]:2,[rt.RED]:1,[rt.LUMINANCE]:1,[rt.LUMINANCE_ALPHA]:2,[rt.ALPHA]:1},sOe={[qt.UNSIGNED_SHORT_4_4_4_4]:2,[qt.UNSIGNED_SHORT_5_5_5_1]:2,[qt.UNSIGNED_SHORT_5_6_5]:2};function rOe(s,e,i=!1){const n=new DataView(e);if(!oOe(s,n))return null;const r=n.getUint32(Pl.ENDIANNESS,!0)===iOe,o=n.getUint32(Pl.GL_TYPE,r),a=n.getUint32(Pl.GL_FORMAT,r),l=n.getUint32(Pl.GL_INTERNAL_FORMAT,r),h=n.getUint32(Pl.PIXEL_WIDTH,r),d=n.getUint32(Pl.PIXEL_HEIGHT,r)||1,f=n.getUint32(Pl.PIXEL_DEPTH,r)||1,p=n.getUint32(Pl.NUMBER_OF_ARRAY_ELEMENTS,r)||1,g=n.getUint32(Pl.NUMBER_OF_FACES,r),y=n.getUint32(Pl.NUMBER_OF_MIPMAP_LEVELS,r),x=n.getUint32(Pl.BYTES_OF_KEY_VALUE_DATA,r);if(d===0||f!==1)throw new Error("Only 2D textures are supported");if(g!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(p!==1)throw new Error("WebGL does not support array textures");const _=4,w=4,O=h+3&-4,T=d+3&-4,C=new Array(p);let A=h*d;o===0&&(A=O*T);let B;if(o!==0?f4[o]?B=f4[o]*nOe[a]:B=sOe[o]:B=VC[l],B===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const I=i?lOe(n,x,r):null;let R=A*B,P=h,k=d,E=O,D=T,L=UI+x;for(let V=0;V<y;V++){const F=n.getUint32(L,r);let j=L+4;for(let Q=0;Q<p;Q++){let ee=C[Q];ee||(ee=C[Q]=new Array(y)),ee[V]={levelID:V,levelWidth:y>1||o!==0?P:E,levelHeight:y>1||o!==0?k:D,levelBuffer:new Uint8Array(e,j,R)},j+=R}L+=F+4,L=L%4!==0?L+4-L%4:L,P=P>>1||1,k=k>>1||1,E=P+_-1&~(_-1),D=k+w-1&~(w-1),R=E*D*B}return o!==0?{uncompressed:C.map(V=>{let F=V[0].levelBuffer,j=!1;return o===qt.FLOAT?F=new Float32Array(V[0].levelBuffer.buffer,V[0].levelBuffer.byteOffset,V[0].levelBuffer.byteLength/4):o===qt.UNSIGNED_INT?(j=!0,F=new Uint32Array(V[0].levelBuffer.buffer,V[0].levelBuffer.byteOffset,V[0].levelBuffer.byteLength/4)):o===qt.INT&&(j=!0,F=new Int32Array(V[0].levelBuffer.buffer,V[0].levelBuffer.byteOffset,V[0].levelBuffer.byteLength/4)),{resource:new aA(F,{width:V[0].levelWidth,height:V[0].levelHeight}),type:o,format:j?aOe(a):a}}),kvData:I}:{compressed:C.map(V=>new jp(null,{format:l,width:h,height:d,levels:y,levelBuffers:V})),kvData:I}}function oOe(s,e){for(let i=0;i<d4.length;i++)if(e.getUint8(i)!==d4[i])return console.error(`${s} is not a valid *.ktx file!`),!1;return!0}function aOe(s){switch(s){case rt.RGBA:return rt.RGBA_INTEGER;case rt.RGB:return rt.RGB_INTEGER;case rt.RG:return rt.RG_INTEGER;case rt.RED:return rt.RED_INTEGER;default:return s}}function lOe(s,e,i){const n=new Map;let r=0;for(;r<e;){const o=s.getUint32(UI+r,i),a=UI+r+4,l=3-(o+3)%4;if(o===0||o>e-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<o&&s.getUint8(a+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const d=new TextDecoder().decode(new Uint8Array(s.buffer,a,h)),f=new DataView(s.buffer,a+h+1,o-h-1);n.set(d,f),r+=4+o+l}return n}const cOe={extension:{type:xt.LoadParser,priority:ac.High},name:"loadDDS",test(s){return yf(s,".dds")},async load(s,e,i){const n=await(await kt.ADAPTER.fetch(s)).arrayBuffer(),r=tOe(n).map(o=>{const a=new Mi(o,{mipmap:nh.OFF,alphaMode:Yo.NO_PREMULTIPLIED_ALPHA,resolution:pu(s),...e.data});return _b(a,i,s)});return r.length===1?r[0]:r},unload(s){Array.isArray(s)?s.forEach(e=>e.destroy(!0)):s.destroy(!0)}};$t.add(cOe);const hOe={extension:{type:xt.LoadParser,priority:ac.High},name:"loadKTX",test(s){return yf(s,".ktx")},async load(s,e,i){const n=await(await kt.ADAPTER.fetch(s)).arrayBuffer(),{compressed:r,uncompressed:o,kvData:a}=rOe(s,n),l=r??o,h={mipmap:nh.OFF,alphaMode:Yo.NO_PREMULTIPLIED_ALPHA,resolution:pu(s),...e.data},d=l.map(f=>{l===o&&Object.assign(h,{type:f.type,format:f.format});const p=f.resource??f,g=new Mi(p,h);return g.ktxKeyValueData=a,_b(g,i,s)});return d.length===1?d[0]:d},unload(s){Array.isArray(s)?s.forEach(e=>e.destroy(!0)):s.destroy(!0)}};$t.add(hOe);const uOe=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],dOe={extension:xt.ResolveParser,test:s=>{const e=Or.extname(s).slice(1);return["basis","ktx","dds"].includes(e)},parse:s=>{var n,r;const e=s.split("."),i=e.pop();if(["ktx","dds"].includes(i)){const o=e.pop();if(uOe.includes(o))return{resolution:parseFloat(((n=kt.RETINA_PREFIX.exec(s))==null?void 0:n[1])??"1"),format:o,src:s}}return{resolution:parseFloat(((r=kt.RETINA_PREFIX.exec(s))==null?void 0:r[1])??"1"),format:i,src:s}}};$t.add(dOe);const v1=new Pi,fOe=4,P7=class Cx{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var i;const e=(i=this.renderer)==null?void 0:i.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,i,n,r){const o=new Image;return o.src=await this.base64(e,i,n,r),o}async base64(e,i,n,r){const o=this.canvas(e,r);if(o.toBlob!==void 0)return new Promise((a,l)=>{o.toBlob(h=>{if(!h){l(new Error("ICanvas.toBlob failed!"));return}const d=new FileReader;d.onload=()=>a(d.result),d.onerror=l,d.readAsDataURL(h)},i,n)});if(o.toDataURL!==void 0)return o.toDataURL(i,n);if(o.convertToBlob!==void 0){const a=await o.convertToBlob({type:i,quality:n});return new Promise((l,h)=>{const d=new FileReader;d.onload=()=>l(d.result),d.onerror=h,d.readAsDataURL(a)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,i){const{pixels:n,width:r,height:o,flipY:a,premultipliedAlpha:l}=this._rawPixels(e,i);a&&Cx._flipY(n,r,o),l&&Cx._unpremultiplyAlpha(n);const h=new Q_e(r,o,1),d=new ImageData(new Uint8ClampedArray(n.buffer),r,o);return h.context.putImageData(d,0,0),h.canvas}pixels(e,i){const{pixels:n,width:r,height:o,flipY:a,premultipliedAlpha:l}=this._rawPixels(e,i);return a&&Cx._flipY(n,r,o),l&&Cx._unpremultiplyAlpha(n),n}_rawPixels(e,i){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let r,o=!1,a=!1,l,h=!1;e&&(e instanceof Mm?l=e:(l=n.generateTexture(e,{region:i,resolution:n.resolution,multisample:n.multisample}),h=!0,i&&(v1.width=i.width,v1.height=i.height,i=v1)));const d=n.gl;if(l){if(r=l.baseTexture.resolution,i=i??l.frame,o=!1,a=l.baseTexture.alphaMode>0&&l.baseTexture.format===rt.RGBA,!h){n.renderTexture.bind(l);const y=l.framebuffer.glFramebuffers[n.CONTEXT_UID];y.blitFramebuffer&&n.framebuffer.bind(y.blitFramebuffer)}}else r=n.resolution,i||(i=v1,i.width=n.width/r,i.height=n.height/r),o=!0,a=this._rendererPremultipliedAlpha,n.renderTexture.bind();const f=Math.max(Math.round(i.width*r),1),p=Math.max(Math.round(i.height*r),1),g=new Uint8Array(fOe*f*p);return d.readPixels(Math.round(i.x*r),Math.round(i.y*r),f,p,d.RGBA,d.UNSIGNED_BYTE,g),h&&(l==null||l.destroy(!0)),{pixels:g,width:f,height:p,flipY:o,premultipliedAlpha:a}}destroy(){this.renderer=null}static _flipY(e,i,n){const r=i<<2,o=n>>1,a=new Uint8Array(r);for(let l=0;l<o;l++){const h=l*r,d=(n-l-1)*r;a.set(e.subarray(h,h+r)),e.copyWithin(h,d,d+r),e.set(a,d)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const i=e.length;for(let n=0;n<i;n+=4){const r=e[n+3];if(r!==0){const o=255.001/r;e[n]=e[n]*o+.5,e[n+1]=e[n+1]*o+.5,e[n+2]=e[n+2]*o+.5}}}};P7.extension={name:"extract",type:xt.RendererSystem};let pOe=P7;$t.add(pOe);const $C={build(s){const e=s.points;let i,n,r,o,a,l;if(s.type===Br.CIRC){const x=s.shape;i=x.x,n=x.y,a=l=x.radius,r=o=0}else if(s.type===Br.ELIP){const x=s.shape;i=x.x,n=x.y,a=x.width,l=x.height,r=o=0}else{const x=s.shape,_=x.width/2,w=x.height/2;i=x.x+_,n=x.y+w,a=l=Math.max(0,Math.min(x.radius,Math.min(_,w))),r=_-a,o=w-l}if(!(a>=0&&l>=0&&r>=0&&o>=0)){e.length=0;return}const h=Math.ceil(2.3*Math.sqrt(a+l)),d=h*8+(r?4:0)+(o?4:0);if(e.length=d,d===0)return;if(h===0){e.length=8,e[0]=e[6]=i+r,e[1]=e[3]=n+o,e[2]=e[4]=i-r,e[5]=e[7]=n-o;return}let f=0,p=h*4+(r?2:0)+2,g=p,y=d;{const x=r+a,_=o,w=i+x,O=i-x,T=n+_;if(e[f++]=w,e[f++]=T,e[--p]=T,e[--p]=O,o){const C=n-_;e[g++]=O,e[g++]=C,e[--y]=C,e[--y]=w}}for(let x=1;x<h;x++){const _=Math.PI/2*(x/h),w=r+Math.cos(_)*a,O=o+Math.sin(_)*l,T=i+w,C=i-w,A=n+O,B=n-O;e[f++]=T,e[f++]=A,e[--p]=A,e[--p]=C,e[g++]=C,e[g++]=B,e[--y]=B,e[--y]=T}{const x=r,_=o+l,w=i+x,O=i-x,T=n+_,C=n-_;e[f++]=w,e[f++]=T,e[--y]=C,e[--y]=w,r&&(e[f++]=O,e[f++]=T,e[--y]=C,e[--y]=O)}},triangulate(s,e){const i=s.points,n=e.points,r=e.indices;if(i.length===0)return;let o=n.length/2;const a=o;let l,h;if(s.type!==Br.RREC){const f=s.shape;l=f.x,h=f.y}else{const f=s.shape;l=f.x+f.width/2,h=f.y+f.height/2}const d=s.matrix;n.push(s.matrix?d.a*l+d.c*h+d.tx:l,s.matrix?d.b*l+d.d*h+d.ty:h),o++,n.push(i[0],i[1]);for(let f=2;f<i.length;f+=2)n.push(i[f],i[f+1]),r.push(o++,a,o);r.push(a+1,a,o)}};function p4(s,e=!1){const i=s.length;if(i<6)return;let n=0;for(let r=0,o=s[i-2],a=s[i-1];r<i;r+=2){const l=s[r],h=s[r+1];n+=(l-o)*(h+a),o=l,a=h}if(!e&&n>0||e&&n<=0){const r=i/2;for(let o=r+r%2;o<i;o+=2){const a=i-o-2,l=i-o-1,h=o,d=o+1;[s[a],s[h]]=[s[h],s[a]],[s[l],s[d]]=[s[d],s[l]]}}}const I7={build(s){s.points=s.shape.points.slice()},triangulate(s,e){let i=s.points;const n=s.holes,r=e.points,o=e.indices;if(i.length>=6){p4(i,!1);const a=[];for(let d=0;d<n.length;d++){const f=n[d];p4(f.points,!0),a.push(i.length/2),i=i.concat(f.points)}const l=Sye(i,a,2);if(!l)return;const h=r.length/2;for(let d=0;d<l.length;d+=3)o.push(l[d]+h),o.push(l[d+1]+h),o.push(l[d+2]+h);for(let d=0;d<i.length;d++)r.push(i[d])}}},mOe={build(s){const e=s.shape,i=e.x,n=e.y,r=e.width,o=e.height,a=s.points;a.length=0,r>=0&&o>=0&&a.push(i,n,i+r,n,i+r,n+o,i,n+o)},triangulate(s,e){const i=s.points,n=e.points;if(i.length===0)return;const r=n.length/2;n.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},gOe={build(s){$C.build(s)},triangulate(s,e){$C.triangulate(s,e)}};var il=(s=>(s.MITER="miter",s.BEVEL="bevel",s.ROUND="round",s))(il||{}),Ud=(s=>(s.BUTT="butt",s.ROUND="round",s.SQUARE="square",s))(Ud||{});const ny={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(s,e=20){if(!this.adaptive||!s||isNaN(s))return e;let i=Math.ceil(s/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}};class m4{static curveTo(e,i,n,r,o,a){const l=a[a.length-2],h=a[a.length-1]-i,d=l-e,f=r-i,p=n-e,g=Math.abs(h*p-d*f);if(g<1e-8||o===0)return(a[a.length-2]!==e||a[a.length-1]!==i)&&a.push(e,i),null;const y=h*h+d*d,x=f*f+p*p,_=h*f+d*p,w=o*Math.sqrt(y)/g,O=o*Math.sqrt(x)/g,T=w*_/y,C=O*_/x,A=w*p+O*d,B=w*f+O*h,I=d*(O+T),R=h*(O+T),P=p*(w+C),k=f*(w+C),E=Math.atan2(R-B,I-A),D=Math.atan2(k-B,P-A);return{cx:A+e,cy:B+i,radius:o,startAngle:E,endAngle:D,anticlockwise:d*f>p*h}}static arc(e,i,n,r,o,a,l,h,d){const f=l-a,p=ny._segmentsCount(Math.abs(f)*o,Math.ceil(Math.abs(f)/kC)*40),g=f/(p*2),y=g*2,x=Math.cos(g),_=Math.sin(g),w=p-1,O=w%1/w;for(let T=0;T<=w;++T){const C=T+O*T,A=g+a+y*C,B=Math.cos(A),I=-Math.sin(A);d.push((x*B+_*I)*o+n,(x*-I+_*B)*o+r)}}}class yOe{constructor(){this.reset()}begin(e,i,n){this.reset(),this.style=e,this.start=i,this.attribStart=n}end(e,i){this.attribSize=i-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class $D{static curveLength(e,i,n,r,o,a,l,h){let d=0,f=0,p=0,g=0,y=0,x=0,_=0,w=0,O=0,T=0,C=0,A=e,B=i;for(let I=1;I<=10;++I)f=I/10,p=f*f,g=p*f,y=1-f,x=y*y,_=x*y,w=_*e+3*x*f*n+3*y*p*o+g*l,O=_*i+3*x*f*r+3*y*p*a+g*h,T=A-w,C=B-O,A=w,B=O,d+=Math.sqrt(T*T+C*C);return d}static curveTo(e,i,n,r,o,a,l){const h=l[l.length-2],d=l[l.length-1];l.length-=2;const f=ny._segmentsCount($D.curveLength(h,d,e,i,n,r,o,a));let p=0,g=0,y=0,x=0,_=0;l.push(h,d);for(let w=1,O=0;w<=f;++w)O=w/f,p=1-O,g=p*p,y=g*p,x=O*O,_=x*O,l.push(y*h+3*g*O*e+3*p*x*n+_*o,y*d+3*g*O*i+3*p*x*r+_*a)}}function g4(s,e,i,n,r,o,a,l){const h=s-i*r,d=e-n*r,f=s+i*o,p=e+n*o;let g,y;a?(g=n,y=-i):(g=-n,y=i);const x=h+g,_=d+y,w=f+g,O=p+y;return l.push(x,_,w,O),2}function Xf(s,e,i,n,r,o,a,l){const h=i-s,d=n-e;let f=Math.atan2(h,d),p=Math.atan2(r-s,o-e);l&&f<p?f+=Math.PI*2:!l&&f>p&&(p+=Math.PI*2);let g=f;const y=p-f,x=Math.abs(y),_=Math.sqrt(h*h+d*d),w=(15*x*Math.sqrt(_)/Math.PI>>0)+1,O=y/w;if(g+=O,l){a.push(s,e,i,n);for(let T=1,C=g;T<w;T++,C+=O)a.push(s,e,s+Math.sin(C)*_,e+Math.cos(C)*_);a.push(s,e,r,o)}else{a.push(i,n,s,e);for(let T=1,C=g;T<w;T++,C+=O)a.push(s+Math.sin(C)*_,e+Math.cos(C)*_,s,e);a.push(r,o,s,e)}return w*2}function vOe(s,e){const i=s.shape;let n=s.points||i.points.slice();const r=e.closePointEps;if(n.length===0)return;const o=s.lineStyle,a=new si(n[0],n[1]),l=new si(n[n.length-2],n[n.length-1]),h=i.type!==Br.POLY||i.closeStroke,d=Math.abs(a.x-l.x)<r&&Math.abs(a.y-l.y)<r;if(h){n=n.slice(),d&&(n.pop(),n.pop(),l.set(n[n.length-2],n[n.length-1]));const ee=(a.x+l.x)*.5,J=(l.y+a.y)*.5;n.unshift(ee,J),n.push(ee,J)}const f=e.points,p=n.length/2;let g=n.length;const y=f.length/2,x=o.width/2,_=x*x,w=o.miterLimit*o.miterLimit;let O=n[0],T=n[1],C=n[2],A=n[3],B=0,I=0,R=-(T-A),P=O-C,k=0,E=0,D=Math.sqrt(R*R+P*P);R/=D,P/=D,R*=x,P*=x;const L=o.alignment,V=(1-L)*2,F=L*2;h||(o.cap===Ud.ROUND?g+=Xf(O-R*(V-F)*.5,T-P*(V-F)*.5,O-R*V,T-P*V,O+R*F,T+P*F,f,!0)+2:o.cap===Ud.SQUARE&&(g+=g4(O,T,R,P,V,F,!0,f))),f.push(O-R*V,T-P*V,O+R*F,T+P*F);for(let ee=1;ee<p-1;++ee){O=n[(ee-1)*2],T=n[(ee-1)*2+1],C=n[ee*2],A=n[ee*2+1],B=n[(ee+1)*2],I=n[(ee+1)*2+1],R=-(T-A),P=O-C,D=Math.sqrt(R*R+P*P),R/=D,P/=D,R*=x,P*=x,k=-(A-I),E=C-B,D=Math.sqrt(k*k+E*E),k/=D,E/=D,k*=x,E*=x;const J=C-O,ue=T-A,oe=C-B,pe=I-A,Ue=J*oe+ue*pe,tt=ue*oe-pe*J,ve=tt<0;if(Math.abs(tt)<.001*Math.abs(Ue)){f.push(C-R*V,A-P*V,C+R*F,A+P*F),Ue>=0&&(o.join===il.ROUND?g+=Xf(C,A,C-R*V,A-P*V,C-k*V,A-E*V,f,!1)+4:g+=2,f.push(C-k*F,A-E*F,C+k*V,A+E*V));continue}const Re=(-R+O)*(-P+A)-(-R+C)*(-P+T),Le=(-k+B)*(-E+A)-(-k+C)*(-E+I),De=(J*Le-oe*Re)/tt,Se=(pe*Re-ue*Le)/tt,Y=(De-C)*(De-C)+(Se-A)*(Se-A),W=C+(De-C)*V,te=A+(Se-A)*V,ae=C-(De-C)*F,z=A-(Se-A)*F,q=Math.min(J*J+ue*ue,oe*oe+pe*pe),le=ve?V:F,he=q+le*le*_,be=Y<=he;let Ee=o.join;if(Ee===il.MITER&&Y/_>w&&(Ee=il.BEVEL),be)switch(Ee){case il.MITER:{f.push(W,te,ae,z);break}case il.BEVEL:{ve?f.push(W,te,C+R*F,A+P*F,W,te,C+k*F,A+E*F):f.push(C-R*V,A-P*V,ae,z,C-k*V,A-E*V,ae,z),g+=2;break}case il.ROUND:{ve?(f.push(W,te,C+R*F,A+P*F),g+=Xf(C,A,C+R*F,A+P*F,C+k*F,A+E*F,f,!0)+4,f.push(W,te,C+k*F,A+E*F)):(f.push(C-R*V,A-P*V,ae,z),g+=Xf(C,A,C-R*V,A-P*V,C-k*V,A-E*V,f,!1)+4,f.push(C-k*V,A-E*V,ae,z));break}}else{switch(f.push(C-R*V,A-P*V,C+R*F,A+P*F),Ee){case il.MITER:{ve?f.push(ae,z,ae,z):f.push(W,te,W,te),g+=2;break}case il.ROUND:{ve?g+=Xf(C,A,C+R*F,A+P*F,C+k*F,A+E*F,f,!0)+2:g+=Xf(C,A,C-R*V,A-P*V,C-k*V,A-E*V,f,!1)+2;break}}f.push(C-k*V,A-E*V,C+k*F,A+E*F),g+=2}}O=n[(p-2)*2],T=n[(p-2)*2+1],C=n[(p-1)*2],A=n[(p-1)*2+1],R=-(T-A),P=O-C,D=Math.sqrt(R*R+P*P),R/=D,P/=D,R*=x,P*=x,f.push(C-R*V,A-P*V,C+R*F,A+P*F),h||(o.cap===Ud.ROUND?g+=Xf(C-R*(V-F)*.5,A-P*(V-F)*.5,C-R*V,A-P*V,C+R*F,A+P*F,f,!1)+2:o.cap===Ud.SQUARE&&(g+=g4(C,A,R,P,V,F,!1,f)));const j=e.indices,Q=ny.epsilon*ny.epsilon;for(let ee=y;ee<g+y-2;++ee)O=f[ee*2],T=f[ee*2+1],C=f[(ee+1)*2],A=f[(ee+1)*2+1],B=f[(ee+2)*2],I=f[(ee+2)*2+1],!(Math.abs(O*(A-I)+C*(I-T)+B*(T-A))<Q)&&j.push(ee,ee+1,ee+2)}function xOe(s,e){let i=0;const n=s.shape,r=s.points||n.points,o=n.type!==Br.POLY||n.closeStroke;if(r.length===0)return;const a=e.points,l=e.indices,h=r.length/2,d=a.length/2;let f=d;for(a.push(r[0],r[1]),i=1;i<h;i++)a.push(r[i*2],r[i*2+1]),l.push(f,f+1),f++;o&&l.push(f,d)}function y4(s,e){s.lineStyle.native?xOe(s,e):vOe(s,e)}class UD{static curveLength(e,i,n,r,o,a){const l=e-2*n+o,h=i-2*r+a,d=2*n-2*e,f=2*r-2*i,p=4*(l*l+h*h),g=4*(l*d+h*f),y=d*d+f*f,x=2*Math.sqrt(p+g+y),_=Math.sqrt(p),w=2*p*_,O=2*Math.sqrt(y),T=g/_;return(w*x+_*g*(x-O)+(4*y*p-g*g)*Math.log((2*_+T+x)/(T+O)))/(4*w)}static curveTo(e,i,n,r,o){const a=o[o.length-2],l=o[o.length-1],h=ny._segmentsCount(UD.curveLength(a,l,e,i,n,r));let d=0,f=0;for(let p=1;p<=h;++p){const g=p/h;d=a+(e-a)*g,f=l+(i-l)*g,o.push(d+(e+(n-e)*g-d)*g,f+(i+(r-i)*g-f)*g)}}}const Ak={[Br.POLY]:I7,[Br.CIRC]:$C,[Br.ELIP]:$C,[Br.RECT]:mOe,[Br.RREC]:gOe},v4=[],x1=[];class UC{constructor(e,i=null,n=null,r=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=n,this.fillStyle=i,this.matrix=r,this.type=e.type}clone(){return new UC(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const cg=new si,B7=class R7 extends NQ{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new DC,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),x1.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const i=this.batches[e];i.reset(),v4.push(i)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,i=null,n=null,r=null){const o=new UC(e,i,n,r);return this.graphicsData.push(o),this.dirty++,this}drawHole(e,i=null){if(!this.graphicsData.length)return null;const n=new UC(e,null,null,i),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const i=this.graphicsData;for(let n=0;n<i.length;++n){const r=i[n];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(e,cg):cg.copyFrom(e),r.shape.contains(cg.x,cg.y))){let o=!1;if(r.holes){for(let a=0;a<r.holes.length;a++)if(r.holes[a].shape.contains(cg.x,cg.y)){o=!0;break}}if(!o)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,i=this.graphicsData;let n=null,r=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],r=n.style);for(let h=this.shapeIndex;h<i.length;h++){this.shapeIndex++;const d=i[h],f=d.fillStyle,p=d.lineStyle;Ak[d.type].build(d),d.matrix&&this.transformPoints(d.points,d.matrix),(f.visible||p.visible)&&this.processHoles(d.holes);for(let g=0;g<2;g++){const y=g===0?f:p;if(!y.visible)continue;const x=y.texture.baseTexture,_=this.indices.length,w=this.points.length/2;x.wrapMode=Qd.REPEAT,g===0?this.processFill(d):this.processLine(d);const O=this.points.length/2-w;O!==0&&(n&&!this._compareStyles(r,y)&&(n.end(_,w),n=null),n||(n=v4.pop()||new yOe,n.begin(y,_,w),this.batches.push(n),r=y),this.addUvs(this.points,e,y.texture,w,O,y.matrix))}}const o=this.indices.length,a=this.points.length/2;if(n&&n.end(o,a),this.batches.length===0){this.batchable=!0;return}const l=a>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&l===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=l?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,i){return!(!e||!i||e.texture.baseTexture!==i.texture.baseTexture||e.color+e.alpha!==i.color+i.alpha||!!e.native!=!!i.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,i=this.graphicsData.length;e<i;e++){const n=this.graphicsData[e],r=n.fillStyle,o=n.lineStyle;if(r&&!r.texture.baseTexture.valid||o&&!o.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let i=0,n=e.length;i<n;i++){const r=e[i];for(let o=0;o<r.size;o++){const a=r.start+o;this.indicesUint16[a]=this.indicesUint16[a]-r.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let i=0;i<e.length;i++)if(e[i].style.native)return!1;return this.points.length<R7.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++Mi._globalBatch;for(let p=0;p<this.drawCalls.length;p++)this.drawCalls[p].texArray.clear(),x1.push(this.drawCalls[p]);this.drawCalls.length=0;const i=this.colors,n=this.textureIds;let r=x1.pop();r||(r=new vI,r.texArray=new wI),r.texArray.count=0,r.start=0,r.size=0,r.type=Gc.TRIANGLES;let o=0,a=null,l=0,h=!1,d=Gc.TRIANGLES,f=0;this.drawCalls.push(r);for(let p=0;p<this.batches.length;p++){const g=this.batches[p],y=8,x=g.style,_=x.texture.baseTexture;h!==!!x.native&&(h=!!x.native,d=h?Gc.LINES:Gc.TRIANGLES,a=null,o=y,e++),a!==_&&(a=_,_._batchEnabled!==e&&(o===y&&(e++,o=0,r.size>0&&(r=x1.pop(),r||(r=new vI,r.texArray=new wI),this.drawCalls.push(r)),r.start=f,r.size=0,r.texArray.count=0,r.type=d),_.touched=1,_._batchEnabled=e,_._batchLocation=o,_.wrapMode=Qd.REPEAT,r.texArray.elements[r.texArray.count++]=_,o++)),r.size+=g.size,f+=g.size,l=_._batchLocation,this.addColors(i,x.color,x.alpha,g.attribSize,g.attribStart),this.addTextureIds(n,l,g.attribSize,g.attribStart)}Mi._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,i=this.uvs,n=this.colors,r=this.textureIds,o=new ArrayBuffer(e.length*3*4),a=new Float32Array(o),l=new Uint32Array(o);let h=0;for(let d=0;d<e.length/2;d++)a[h++]=e[d*2],a[h++]=e[d*2+1],a[h++]=i[d*2],a[h++]=i[d*2+1],l[h++]=n[d],a[h++]=r[d];this._buffer.update(o),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?I7.triangulate(e,this):Ak[e.type].triangulate(e,this)}processLine(e){y4(e,this);for(let i=0;i<e.holes.length;i++)y4(e.holes[i],this)}processHoles(e){for(let i=0;i<e.length;i++){const n=e[i];Ak[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,i){for(let n=0;n<e.length/2;n++){const r=e[n*2],o=e[n*2+1];e[n*2]=i.a*r+i.c*o+i.tx,e[n*2+1]=i.b*r+i.d*o+i.ty}}addColors(e,i,n,r,o=0){const a=Zn.shared.setValue(i).toLittleEndianNumber(),l=Zn.shared.setValue(a).toPremultiplied(n);e.length=Math.max(e.length,o+r);for(let h=0;h<r;h++)e[o+h]=l}addTextureIds(e,i,n,r=0){e.length=Math.max(e.length,r+n);for(let o=0;o<n;o++)e[r+o]=i}addUvs(e,i,n,r,o,a=null){let l=0;const h=i.length,d=n.frame;for(;l<o;){let p=e[(r+l)*2],g=e[(r+l)*2+1];if(a){const y=a.a*p+a.c*g+a.tx;g=a.b*p+a.d*g+a.ty,p=y}l++,i.push(p/d.width,g/d.height)}const f=n.baseTexture;(d.width<f.width||d.height<f.height)&&this.adjustUvs(i,n,h,o)}adjustUvs(e,i,n,r){const o=i.baseTexture,a=1e-6,l=n+r*2,h=i.frame,d=h.width/o.width,f=h.height/o.height;let p=h.x/h.width,g=h.y/h.height,y=Math.floor(e[n]+a),x=Math.floor(e[n+1]+a);for(let _=n+2;_<l;_+=2)y=Math.min(y,Math.floor(e[_]+a)),x=Math.min(x,Math.floor(e[_+1]+a));p-=y,g-=x;for(let _=n;_<l;_+=2)e[_]=(e[_]+p)*d,e[_+1]=(e[_+1]+g)*f}};B7.BATCHABLE_SIZE=100;let _Oe=B7;class fA{constructor(){this.color=16777215,this.alpha=1,this.texture=Wi.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new fA;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=Wi.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class FD extends fA{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Ud.BUTT,this.join=il.MITER,this.miterLimit=10}clone(){const e=new FD;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Ud.BUTT,this.join=il.MITER,this.miterLimit=10}}const Ek={},FI=class NS extends Qt{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new fA,this._lineStyle=new FD,this._matrix=null,this._holeMode=!1,this.state=lh.for2d(),this._geometry=e||new _Oe,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Zn(16777215),this.blendMode=mi.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new NS(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,i=0,n,r=.5,o=!1){return typeof e=="number"&&(e={width:e,color:i,alpha:n,alignment:r,native:o}),this.lineTextureStyle(e)}lineTextureStyle(e){const i={width:0,texture:Wi.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Ud.BUTT,join:il.MITER,miterLimit:10};e=Object.assign(i,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.width>0&&e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:n},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,i=this.currentPath.points.length;i>2&&(this.drawShape(this.currentPath),this.currentPath=new Yp,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[i-2],e[i-1]))}else this.currentPath=new Yp,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,i){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=i,this}lineTo(e,i){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,r=n[n.length-2],o=n[n.length-1];return(r!==e||o!==i)&&n.push(e,i),this}_initCurve(e=0,i=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,i]):this.moveTo(e,i)}quadraticCurveTo(e,i,n,r){this._initCurve();const o=this.currentPath.points;return o.length===0&&this.moveTo(0,0),UD.curveTo(e,i,n,r,o),this}bezierCurveTo(e,i,n,r,o,a){return this._initCurve(),$D.curveTo(e,i,n,r,o,a,this.currentPath.points),this}arcTo(e,i,n,r,o){this._initCurve(e,i);const a=this.currentPath.points,l=m4.curveTo(e,i,n,r,o,a);if(l){const{cx:h,cy:d,radius:f,startAngle:p,endAngle:g,anticlockwise:y}=l;this.arc(h,d,f,p,g,y)}return this}arc(e,i,n,r,o,a=!1){if(r===o)return this;if(!a&&o<=r?o+=kC:a&&r<=o&&(r+=kC),o-r===0)return this;const l=e+Math.cos(r)*n,h=i+Math.sin(r)*n,d=this._geometry.closePointEps;let f=this.currentPath?this.currentPath.points:null;if(f){const p=Math.abs(f[f.length-2]-l),g=Math.abs(f[f.length-1]-h);p<d&&g<d||f.push(l,h)}else this.moveTo(l,h),f=this.currentPath.points;return m4.arc(l,h,e,i,n,r,o,a,f),this}beginFill(e=0,i){return this.beginTextureFill({texture:Wi.WHITE,color:e,alpha:i})}normalizeColor(e){const i=Zn.shared.setValue(e.color??0);e.color=i.toNumber(),e.alpha??(e.alpha=i.alpha)}beginTextureFill(e){const i={texture:Wi.WHITE,color:16777215,matrix:null};e=Object.assign(i,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const n=e.alpha>0;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,i,n,r){return this.drawShape(new Pi(e,i,n,r))}drawRoundedRect(e,i,n,r,o){return this.drawShape(new cA(e,i,n,r,o))}drawCircle(e,i,n){return this.drawShape(new RD(e,i,n))}drawEllipse(e,i,n,r){return this.drawShape(new lA(e,i,n,r))}drawPolygon(...e){let i,n=!0;const r=e[0];r.points?(n=r.closeStroke,i=r.points):Array.isArray(e[0])?i=e[0]:i=e;const o=new Yp(i);return o.closeStroke=n,this.drawShape(o),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===Br.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const i=this._geometry;i.updateBatches(),i.batchable?(this.batchDirty!==i.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,i=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(let r=0;r<n;r++){const o=e.batches[r],a=o.style.color,l=new Float32Array(this.vertexData.buffer,o.attribStart*4*2,o.attribSize*2),h=new Float32Array(e.uvsFloat32.buffer,o.attribStart*4*2,o.attribSize*2),d=new Uint16Array(e.indicesUint16.buffer,o.start*2,o.size),f={vertexData:l,blendMode:i,indices:d,uvs:h,_batchRGB:Zn.shared.setValue(a).toRgbArray(),_tintRGB:a,_texture:o.style.texture,alpha:o.style.alpha,worldAlpha:1};this.batches[r]=f}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let i=0,n=this.batches.length;i<n;i++){const r=this.batches[i];r.worldAlpha=this.worldAlpha*r.alpha,e.plugins[this.pluginName].render(r)}}}_renderDirect(e){const i=this._resolveDirectShader(e),n=this._geometry,r=this.worldAlpha,o=i.uniforms,a=n.drawCalls;o.translationMatrix=this.transform.worldTransform,Zn.shared.setValue(this._tintColor).premultiply(r).toArray(o.tint),e.shader.bind(i),e.geometry.bind(n,i),e.state.set(this.state);for(let l=0,h=a.length;l<h;l++)this._renderDrawCallDirect(e,n.drawCalls[l])}_renderDrawCallDirect(e,i){const{texArray:n,type:r,size:o,start:a}=i,l=n.count;for(let h=0;h<l;h++)e.texture.bind(n.elements[h],h);e.geometry.draw(r,o,a)}_resolveDirectShader(e){let i=this.shader;const n=this.pluginName;if(!i){if(!Ek[n]){const{maxTextures:r}=e.plugins[n],o=new Int32Array(r);for(let h=0;h<r;h++)o[h]=h;const a={tint:new Float32Array([1,1,1,1]),translationMatrix:new es,default:Kl.from({uSamplers:o},!0)},l=e.plugins[n]._shader.program;Ek[n]=new Jl(l,a)}i=Ek[n]}return i}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:i,minY:n,maxX:r,maxY:o}=e.bounds;this._bounds.addFrame(this.transform,i,n,r,o)}containsPoint(e){return this.worldTransform.applyInverse(e,NS._TEMP_POINT),this._geometry.containsPoint(NS._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const i=this.batches[e];i._tintRGB=Zn.shared.setValue(this._tintColor).multiply(i._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const i=this.transform.worldTransform,n=i.a,r=i.b,o=i.c,a=i.d,l=i.tx,h=i.ty,d=this._geometry.points,f=this.vertexData;let p=0;for(let g=0;g<d.length;g+=2){const y=d[g],x=d[g+1];f[p++]=n*y+o*x+l,f[p++]=a*x+r*y+h}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};FI.curves=ny,FI._TEMP_POINT=new si;let ki=FI;class bOe{constructor(e,i){this.uvBuffer=e,this.uvMatrix=i,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const i=this.uvBuffer.data;(!this.data||this.data.length!==i.length)&&(this.data=new Float32Array(i.length)),this.uvMatrix.multiplyUvs(i,this.data),this._updateID++}}const Mk=new si,x4=new Yp,D7=class L7 extends Qt{constructor(e,i,n,r=Gc.TRIANGLES){super(),this.geometry=e,this.shader=i,this.state=n||lh.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=kt.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const i=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Gc.TRIANGLES&&i.length<L7.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const i=this.shader;i.alpha=this.worldAlpha,i.update&&i.update(),e.batch.flush(),i.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(i),e.state.set(this.state),e.geometry.bind(this.geometry,i),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const i=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=i.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const r=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[r]),e.plugins[r].render(this)}calculateVertices(){const e=this.geometry.buffers[0],i=e.data,n=e._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==i.length&&(this.vertexData=new Float32Array(i.length));const r=this.transform.worldTransform,o=r.a,a=r.b,l=r.c,h=r.d,d=r.tx,f=r.ty,p=this.vertexData;for(let g=0;g<p.length/2;g++){const y=i[g*2],x=i[g*2+1];p[g*2]=o*y+l*x+d,p[g*2+1]=a*y+h*x+f}if(this._roundPixels){const g=kt.RESOLUTION;for(let y=0;y<p.length;++y)p[y]=Math.round(p[y]*g)/g}this.vertexDirty=n}calculateUvs(){const e=this.geometry.buffers[1],i=this.shader;i.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new bOe(e,i.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Mk);const i=this.geometry.getBuffer("aVertexPosition").data,n=x4.points,r=this.geometry.getIndex().data,o=r.length,a=this.drawMode===4?3:1;for(let l=0;l+2<o;l+=a){const h=r[l]*2,d=r[l+1]*2,f=r[l+2]*2;if(n[0]=i[h],n[1]=i[h+1],n[2]=i[d],n[3]=i[d+1],n[4]=i[f],n[5]=i[f+1],x4.contains(Mk.x,Mk.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};D7.BATCHABLE_SIZE=100;let zI=D7;class wOe extends mu{constructor(e,i,n){super();const r=new Is(e),o=new Is(i,!0),a=new Is(n,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,qt.FLOAT).addAttribute("aTextureCoord",o,2,!1,qt.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var OOe=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,SOe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class _4 extends Jl{constructor(e,i){const n={uSampler:e,alpha:1,uTextureMatrix:es.IDENTITY,uColor:new Float32Array([1,1,1,1])};i=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},i),i.uniforms&&Object.assign(n,i.uniforms),super(i.program||Kh.from(SOe,OOe),n),this._colorDirty=!1,this.uvMatrix=new KQ(e),this.batchable=i.program===void 0,this.pluginName=i.pluginName,this._tintColor=new Zn(i.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=i.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Zn.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class b4{constructor(e,i,n){this.geometry=new mu,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<e.length;++r){let o=e[r];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||qt.FLOAT,offset:o.offset},i[r]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let i=0;this.indexBuffer=new Is(H_e(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let a=0;a<this.dynamicProperties.length;++a){const l=this.dynamicProperties[a];l.offset=i,i+=l.size,this.dynamicStride+=l.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Is(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let a=0;a<this.staticProperties.length;++a){const l=this.staticProperties[a];l.offset=r,r+=l.size,this.staticStride+=l.size}const o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new Is(this.staticData,!0,!1);for(let a=0;a<this.dynamicProperties.length;++a){const l=this.dynamicProperties[a];e.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===qt.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let a=0;a<this.staticProperties.length;++a){const l=this.staticProperties[a];e.addAttribute(l.attributeName,this.staticBuffer,0,l.type===qt.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(e,i,n){for(let r=0;r<this.dynamicProperties.length;r++){const o=this.dynamicProperties[r];o.uploadFunction(e,i,n,o.type===qt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,i,n){for(let r=0;r<this.staticProperties.length;r++){const o=this.staticProperties[r];o.uploadFunction(e,i,n,o.type===qt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var COe=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,TOe=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class N7 extends hA{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new es,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:qt.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Jl.from(TOe,COe,{}),this.state=lh.for2d()}render(e){const i=e.children,n=e._maxSize,r=e._batchSize,o=this.renderer;let a=i.length;if(a===0)return;a>n&&!e.autoResize&&(a=n);let l=e._buffers;l||(l=e._buffers=this.generateBuffers(e));const h=i[0]._texture.baseTexture,d=h.alphaMode>0;this.state.blendMode=RQ(e.blendMode,d),o.state.set(this.state);const f=o.gl,p=e.worldTransform.copyTo(this.tempMatrix);p.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=Zn.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,d).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);let g=!1;for(let y=0,x=0;y<a;y+=r,x+=1){let _=a-y;_>r&&(_=r),x>=l.length&&l.push(this._generateOneMoreBuffer(e));const w=l[x];w.uploadDynamic(i,y,_);const O=e._bufferUpdateIDs[x]||0;g=g||w._updateID<O,g&&(w._updateID=e._updateID,w.uploadStatic(i,y,_)),o.geometry.bind(w.geometry),f.drawElements(f.TRIANGLES,_*6,f.UNSIGNED_SHORT,0)}}generateBuffers(e){const i=[],n=e._maxSize,r=e._batchSize,o=e._properties;for(let a=0;a<n;a+=r)i.push(new b4(this.properties,o,r));return i}_generateOneMoreBuffer(e){const i=e._batchSize,n=e._properties;return new b4(this.properties,n,i)}uploadVertices(e,i,n,r,o,a){let l=0,h=0,d=0,f=0;for(let p=0;p<n;++p){const g=e[i+p],y=g._texture,x=g.scale.x,_=g.scale.y,w=y.trim,O=y.orig;w?(h=w.x-g.anchor.x*O.width,l=h+w.width,f=w.y-g.anchor.y*O.height,d=f+w.height):(l=O.width*(1-g.anchor.x),h=O.width*-g.anchor.x,d=O.height*(1-g.anchor.y),f=O.height*-g.anchor.y),r[a]=h*x,r[a+1]=f*_,r[a+o]=l*x,r[a+o+1]=f*_,r[a+o*2]=l*x,r[a+o*2+1]=d*_,r[a+o*3]=h*x,r[a+o*3+1]=d*_,a+=o*4}}uploadPosition(e,i,n,r,o,a){for(let l=0;l<n;l++){const h=e[i+l].position;r[a]=h.x,r[a+1]=h.y,r[a+o]=h.x,r[a+o+1]=h.y,r[a+o*2]=h.x,r[a+o*2+1]=h.y,r[a+o*3]=h.x,r[a+o*3+1]=h.y,a+=o*4}}uploadRotation(e,i,n,r,o,a){for(let l=0;l<n;l++){const h=e[i+l].rotation;r[a]=h,r[a+o]=h,r[a+o*2]=h,r[a+o*3]=h,a+=o*4}}uploadUvs(e,i,n,r,o,a){for(let l=0;l<n;++l){const h=e[i+l]._texture._uvs;h?(r[a]=h.x0,r[a+1]=h.y0,r[a+o]=h.x1,r[a+o+1]=h.y1,r[a+o*2]=h.x2,r[a+o*2+1]=h.y2,r[a+o*3]=h.x3,r[a+o*3+1]=h.y3,a+=o*4):(r[a]=0,r[a+1]=0,r[a+o]=0,r[a+o+1]=0,r[a+o*2]=0,r[a+o*2+1]=0,r[a+o*3]=0,r[a+o*3+1]=0,a+=o*4)}}uploadTint(e,i,n,r,o,a){for(let l=0;l<n;++l){const h=e[i+l],d=Zn.shared.setValue(h._tintRGB).toPremultiplied(h.alpha,h.texture.baseTexture.alphaMode>0);r[a]=d,r[a+o]=d,r[a+o*2]=d,r[a+o*3]=d,a+=o*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}N7.extension={name:"particle",type:xt.RendererPlugin};$t.add(N7);var pA=(s=>(s[s.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",s[s.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",s))(pA||{});const _1={willReadFrequently:!0},Ic=class Wt{static get experimentalLetterSpacingSupported(){let e=Wt._experimentalLetterSpacingSupported;if(e!==void 0){const i=kt.ADAPTER.getCanvasRenderingContext2D().prototype;e=Wt._experimentalLetterSpacingSupported="letterSpacing"in i||"textLetterSpacing"in i}return e}constructor(e,i,n,r,o,a,l,h,d){this.text=e,this.style=i,this.width=n,this.height=r,this.lines=o,this.lineWidths=a,this.lineHeight=l,this.maxLineWidth=h,this.fontProperties=d}static measureText(e,i,n,r=Wt._canvas){n=n??i.wordWrap;const o=i.toFontString(),a=Wt.measureFont(o);a.fontSize===0&&(a.fontSize=i.fontSize,a.ascent=i.fontSize);const l=r.getContext("2d",_1);l.font=o;const h=(n?Wt.wordWrap(e,i,r):e).split(/(?:\r\n|\r|\n)/),d=new Array(h.length);let f=0;for(let x=0;x<h.length;x++){const _=Wt._measureText(h[x],i.letterSpacing,l);d[x]=_,f=Math.max(f,_)}let p=f+i.strokeThickness;i.dropShadow&&(p+=i.dropShadowDistance);const g=i.lineHeight||a.fontSize+i.strokeThickness;let y=Math.max(g,a.fontSize+i.strokeThickness*2)+i.leading+(h.length-1)*(g+i.leading);return i.dropShadow&&(y+=i.dropShadowDistance),new Wt(e,i,p,y,h,d,g+i.leading,f,a)}static _measureText(e,i,n){let r=!1;Wt.experimentalLetterSpacingSupported&&(Wt.experimentalLetterSpacing?(n.letterSpacing=`${i}px`,n.textLetterSpacing=`${i}px`,r=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let o=n.measureText(e).width;return o>0&&(r?o-=i:o+=(Wt.graphemeSegmenter(e).length-1)*i),o}static wordWrap(e,i,n=Wt._canvas){const r=n.getContext("2d",_1);let o=0,a="",l="";const h=Object.create(null),{letterSpacing:d,whiteSpace:f}=i,p=Wt.collapseSpaces(f),g=Wt.collapseNewlines(f);let y=!p;const x=i.wordWrapWidth+d,_=Wt.tokenize(e);for(let w=0;w<_.length;w++){let O=_[w];if(Wt.isNewline(O)){if(!g){l+=Wt.addLine(a),y=!p,a="",o=0;continue}O=" "}if(p){const C=Wt.isBreakingSpace(O),A=Wt.isBreakingSpace(a[a.length-1]);if(C&&A)continue}const T=Wt.getFromCache(O,d,h,r);if(T>x)if(a!==""&&(l+=Wt.addLine(a),a="",o=0),Wt.canBreakWords(O,i.breakWords)){const C=Wt.wordWrapSplit(O);for(let A=0;A<C.length;A++){let B=C[A],I=B,R=1;for(;C[A+R];){const k=C[A+R];if(!Wt.canBreakChars(I,k,O,A,i.breakWords))B+=k;else break;I=k,R++}A+=R-1;const P=Wt.getFromCache(B,d,h,r);P+o>x&&(l+=Wt.addLine(a),y=!1,a="",o=0),a+=B,o+=P}}else{a.length>0&&(l+=Wt.addLine(a),a="",o=0);const C=w===_.length-1;l+=Wt.addLine(O,!C),y=!1,a="",o=0}else T+o>x&&(y=!1,l+=Wt.addLine(a),a="",o=0),(a.length>0||!Wt.isBreakingSpace(O)||y)&&(a+=O,o+=T)}return l+=Wt.addLine(a,!1),l}static addLine(e,i=!0){return e=Wt.trimRight(e),e=i?`${e}
`:e,e}static getFromCache(e,i,n,r){let o=n[e];return typeof o!="number"&&(o=Wt._measureText(e,i,r)+i,n[e]=o),o}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let i=e.length-1;i>=0;i--){const n=e[i];if(!Wt.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:Wt._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,i){return typeof e!="string"?!1:Wt._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const i=[];let n="";if(typeof e!="string")return i;for(let r=0;r<e.length;r++){const o=e[r],a=e[r+1];if(Wt.isBreakingSpace(o,a)||Wt.isNewline(o)){n!==""&&(i.push(n),n=""),i.push(o);continue}n+=o}return n!==""&&i.push(n),i}static canBreakWords(e,i){return i}static canBreakChars(e,i,n,r,o){return!0}static wordWrapSplit(e){return Wt.graphemeSegmenter(e)}static measureFont(e){if(Wt._fonts[e])return Wt._fonts[e];const i={ascent:0,descent:0,fontSize:0},n=Wt._canvas,r=Wt._context;r.font=e;const o=Wt.METRICS_STRING+Wt.BASELINE_SYMBOL,a=Math.ceil(r.measureText(o).width);let l=Math.ceil(r.measureText(Wt.BASELINE_SYMBOL).width);const h=Math.ceil(Wt.HEIGHT_MULTIPLIER*l);if(l=l*Wt.BASELINE_MULTIPLIER|0,a===0||h===0)return Wt._fonts[e]=i,i;n.width=a,n.height=h,r.fillStyle="#f00",r.fillRect(0,0,a,h),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(o,0,l);const d=r.getImageData(0,0,a,h).data,f=d.length,p=a*4;let g=0,y=0,x=!1;for(g=0;g<l;++g){for(let _=0;_<p;_+=4)if(d[y+_]!==255){x=!0;break}if(!x)y+=p;else break}for(i.ascent=l-g,y=f-p,x=!1,g=h;g>l;--g){for(let _=0;_<p;_+=4)if(d[y+_]!==255){x=!0;break}if(!x)y-=p;else break}return i.descent=g-l,i.fontSize=i.ascent+i.descent,Wt._fonts[e]=i,i}static clearMetrics(e=""){e?delete Wt._fonts[e]:Wt._fonts={}}static get _canvas(){var e;if(!Wt.__canvas){let i;try{const n=new OffscreenCanvas(0,0);if((e=n.getContext("2d",_1))!=null&&e.measureText)return Wt.__canvas=n,n;i=kt.ADAPTER.createCanvas()}catch{i=kt.ADAPTER.createCanvas()}i.width=i.height=10,Wt.__canvas=i}return Wt.__canvas}static get _context(){return Wt.__context||(Wt.__context=Wt._canvas.getContext("2d",_1)),Wt.__context}};Ic.METRICS_STRING="|q",Ic.BASELINE_SYMBOL="M",Ic.BASELINE_MULTIPLIER=1.4,Ic.HEIGHT_MULTIPLIER=2,Ic.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return e=>[...s.segment(e)].map(i=>i.segment)}return s=>[...s]})(),Ic.experimentalLetterSpacing=!1,Ic._fonts={},Ic._newlines=[10,13],Ic._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Md=Ic;const AOe=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],V7=class Tx{constructor(e){this.styleID=0,this.reset(),Pk(this,e,e)}clone(){const e={};return Pk(e,this,Tx.defaultStyle),new Tx(e)}reset(){Pk(this,Tx.defaultStyle,Tx.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const i=kk(e);this._dropShadowColor!==i&&(this._dropShadowColor=i,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const i=kk(e);this._fill!==i&&(this._fill=i,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){EOe(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const i=kk(e);this._stroke!==i&&(this._stroke=i,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let i=this.fontFamily;Array.isArray(this.fontFamily)||(i=this.fontFamily.split(","));for(let n=i.length-1;n>=0;n--){let r=i[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!AOe.includes(r)&&(r=`"${r}"`),i[n]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${i.join(",")}`}};V7.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:pA.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Da=V7;function kk(s){const e=Zn.shared,i=n=>{const r=e.setValue(n);return r.alpha===1?r.toHex():r.toRgbaString()};return Array.isArray(s)?s.map(i):i(s)}function EOe(s,e){if(!Array.isArray(s)||!Array.isArray(e)||s.length!==e.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==e[i])return!1;return!0}function Pk(s,e,i){for(const n in i)Array.isArray(e[n])?s[n]=e[n].slice():s[n]=e[n]}const MOe={texture:!0,children:!1,baseTexture:!0},$7=class XI extends rr{constructor(e,i,n){let r=!1;n||(n=kt.ADAPTER.createCanvas(),r=!0),n.width=3,n.height=3;const o=Wi.from(n);o.orig=new Pi,o.trim=new Pi,super(o),this._ownCanvas=r,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=XI.defaultResolution??kt.RESOLUTION,this._autoResolution=XI.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=i,this.localStyleID=-1}static get experimentalLetterSpacing(){return Md.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Yi("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Md.experimentalLetterSpacing=e}updateText(e){const i=this._style;if(this.localStyleID!==i.styleID&&(this.dirty=!0,this.localStyleID=i.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const n=this.context,r=Md.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=r.width,a=r.height,l=r.lines,h=r.lineHeight,d=r.lineWidths,f=r.maxLineWidth,p=r.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+i.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+i.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=i.strokeThickness,n.textBaseline=i.textBaseline,n.lineJoin=i.lineJoin,n.miterLimit=i.miterLimit;let g,y;const x=i.dropShadow?2:1;for(let _=0;_<x;++_){const w=i.dropShadow&&_===0,O=w?Math.ceil(Math.max(1,a)+i.padding*2):0,T=O*this._resolution;if(w){n.fillStyle="black",n.strokeStyle="black";const A=i.dropShadowColor,B=i.dropShadowBlur*this._resolution,I=i.dropShadowDistance*this._resolution;n.shadowColor=Zn.shared.setValue(A).setAlpha(i.dropShadowAlpha).toRgbaString(),n.shadowBlur=B,n.shadowOffsetX=Math.cos(i.dropShadowAngle)*I,n.shadowOffsetY=Math.sin(i.dropShadowAngle)*I+T}else n.fillStyle=this._generateFillStyle(i,l,r),n.strokeStyle=i.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let C=(h-p.fontSize)/2;h-p.fontSize<0&&(C=0);for(let A=0;A<l.length;A++)g=i.strokeThickness/2,y=i.strokeThickness/2+A*h+p.ascent+C,i.align==="right"?g+=f-d[A]:i.align==="center"&&(g+=(f-d[A])/2),i.stroke&&i.strokeThickness&&this.drawLetterSpacing(l[A],g+i.padding,y+i.padding-O,!0),i.fill&&this.drawLetterSpacing(l[A],g+i.padding,y+i.padding-O)}this.updateTexture()}drawLetterSpacing(e,i,n,r=!1){const o=this._style.letterSpacing;let a=!1;if(Md.experimentalLetterSpacingSupported&&(Md.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,a=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),o===0||a){r?this.context.strokeText(e,i,n):this.context.fillText(e,i,n);return}let l=i;const h=Md.graphemeSegmenter(e);let d=this.context.measureText(e).width,f=0;for(let p=0;p<h.length;++p){const g=h[p];r?this.context.strokeText(g,l,n):this.context.fillText(g,l,n);let y="";for(let x=p+1;x<h.length;++x)y+=h[x];f=this.context.measureText(y).width,l+=d-f+o,d=f}}updateTexture(){const e=this.canvas;if(this._style.trim){const a=j_e(e);a.data&&(e.width=a.width,e.height=a.height,this.context.putImageData(a.data,0,0))}const i=this._texture,n=this._style,r=n.trim?0:n.padding,o=i.baseTexture;i.trim.width=i._frame.width=e.width/this._resolution,i.trim.height=i._frame.height=e.height/this._resolution,i.trim.x=-r,i.trim.y=-r,i.orig.width=i._frame.width-r*2,i.orig.height=i._frame.height-r*2,this._onTextureUpdate(),o.setRealSize(e.width,e.height,this._resolution),i.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,i){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,i)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,i,n){const r=e.fill;if(Array.isArray(r)){if(r.length===1)return r[0]}else return r;let o;const a=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,h=this.canvas.width/this._resolution-a-l*2,d=this.canvas.height/this._resolution-a-l*2,f=r.slice(),p=e.fillGradientStops.slice();if(!p.length){const g=f.length+1;for(let y=1;y<g;++y)p.push(y/g)}if(f.unshift(r[0]),p.unshift(0),f.push(r[r.length-1]),p.push(1),e.fillGradientType===pA.LINEAR_VERTICAL){o=this.context.createLinearGradient(h/2,l,h/2,d+l);const g=n.fontProperties.fontSize+e.strokeThickness;for(let y=0;y<i.length;y++){const x=n.lineHeight*(y-1)+g,_=n.lineHeight*y;let w=_;y>0&&x>_&&(w=(_+x)/2);const O=_+g,T=n.lineHeight*(y+1);let C=O;y+1<i.length&&T<O&&(C=(O+T)/2);const A=(C-w)/d;for(let B=0;B<f.length;B++){let I=0;typeof p[B]=="number"?I=p[B]:I=B/f.length;let R=Math.min(1,Math.max(0,w/d+I*A));R=Number(R.toFixed(5)),o.addColorStop(R,f[B])}}}else{o=this.context.createLinearGradient(l,d/2,h+l,d/2);const g=f.length+1;let y=1;for(let x=0;x<f.length;x++){let _;typeof p[x]=="number"?_=p[x]:_=y/g,o.addColorStop(_,f[x]),y++}}return o}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},MOe,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const i=$d(this.scale.x)||1;this.scale.x=i*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const i=$d(this.scale.y)||1;this.scale.y=i*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Da?this._style=e:this._style=new Da(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};$7.defaultAutoResolution=!0;let Xi=$7;class kOe{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function POe(s,e){var n;let i=!1;if((n=s==null?void 0:s._textures)!=null&&n.length){for(let r=0;r<s._textures.length;r++)if(s._textures[r]instanceof Wi){const o=s._textures[r].baseTexture;e.includes(o)||(e.push(o),i=!0)}}return i}function IOe(s,e){if(s.baseTexture instanceof Mi){const i=s.baseTexture;return e.includes(i)||e.push(i),!0}return!1}function BOe(s,e){if(s._texture&&s._texture instanceof Wi){const i=s._texture.baseTexture;return e.includes(i)||e.push(i),!0}return!1}function ROe(s,e){return e instanceof Xi?(e.updateText(!0),!0):!1}function DOe(s,e){if(e instanceof Da){const i=e.toFontString();return Md.measureFont(i),!0}return!1}function LOe(s,e){if(s instanceof Xi){e.includes(s.style)||e.push(s.style),e.includes(s)||e.push(s);const i=s._texture.baseTexture;return e.includes(i)||e.push(i),!0}return!1}function NOe(s,e){return s instanceof Da?(e.includes(s)||e.push(s),!0):!1}const U7=class F7{constructor(e){this.limiter=new kOe(F7.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(LOe),this.registerFindHook(NOe),this.registerFindHook(POe),this.registerFindHook(IOe),this.registerFindHook(BOe),this.registerUploadHook(ROe),this.registerUploadHook(DOe)}upload(e){return new Promise(i=>{e&&this.add(e),this.queue.length?(this.completes.push(i),this.ticking||(this.ticking=!0,jo.system.addOnce(this.tick,this,pm.UTILITY))):i()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let i=!1;if(e&&!e._destroyed){for(let n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,e)){this.queue.shift(),i=!0;break}}i||this.queue.shift()}if(this.queue.length)jo.system.addOnce(this.tick,this,pm.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let i=0,n=e.length;i<n;i++)e[i]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let i=0,n=this.addHooks.length;i<n&&!this.addHooks[i](e,this.queue);i++);if(e instanceof Qt)for(let i=e.children.length-1;i>=0;i--)this.add(e.children[i]);return this}destroy(){this.ticking&&jo.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};U7.uploadsPerFrame=4;let WI=U7;Object.defineProperties(kt,{UPLOADS_PER_FRAME:{get(){return WI.uploadsPerFrame},set(s){Yi("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),WI.uploadsPerFrame=s}}});function z7(s,e){return e instanceof Mi?(e._glTextures[s.CONTEXT_UID]||s.texture.bind(e),!0):!1}function VOe(s,e){if(!(e instanceof ki))return!1;const{geometry:i}=e;e.finishPoly(),i.updateBatches();const{batches:n}=i;for(let r=0;r<n.length;r++){const{texture:o}=n[r].style;o&&z7(s,o.baseTexture)}return i.batchable||s.geometry.bind(i,e._resolveDirectShader(s)),!0}function $Oe(s,e){return s instanceof ki?(e.push(s),!0):!1}class X7 extends WI{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook($Oe),this.registerUploadHook(z7),this.registerUploadHook(VOe)}}X7.extension={name:"prepare",type:xt.RendererSystem};$t.add(X7);var UOe=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,FOe=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,zOe=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,w4=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,XOe=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const b1=new es;class W7 extends hA{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new YQ,this.state=lh.for2d()}contextChange(){const e=this.renderer,i={globals:e.globalUniforms};this.simpleShader=Jl.from(w4,XOe,i),this.shader=e.context.webGLVersion>1?Jl.from(FOe,UOe,i):Jl.from(w4,zOe,i)}render(e){const i=this.renderer,n=this.quad;let r=n.vertices;r[0]=r[6]=e._width*-e.anchor.x,r[1]=r[3]=e._height*-e.anchor.y,r[2]=r[4]=e._width*(1-e.anchor.x),r[5]=r[7]=e._height*(1-e.anchor.y);const o=e.uvRespectAnchor?e.anchor.x:0,a=e.uvRespectAnchor?e.anchor.y:0;r=n.uvs,r[0]=r[6]=-o,r[1]=r[3]=-a,r[2]=r[4]=1-o,r[5]=r[7]=1-a,n.invalidate();const l=e._texture,h=l.baseTexture,d=h.alphaMode>0,f=e.tileTransform.localTransform,p=e.uvMatrix;let g=h.isPowerOfTwo&&l.frame.width===h.width&&l.frame.height===h.height;g&&(h._glTextures[i.CONTEXT_UID]?g=h.wrapMode!==Qd.CLAMP:h.wrapMode===Qd.CLAMP&&(h.wrapMode=Qd.REPEAT));const y=g?this.simpleShader:this.shader,x=l.width,_=l.height,w=e._width,O=e._height;b1.set(f.a*x/w,f.b*x/O,f.c*_/w,f.d*_/O,f.tx/w,f.ty/O),b1.invert(),g?b1.prepend(p.mapCoord):(y.uniforms.uMapCoord=p.mapCoord.toArray(!0),y.uniforms.uClampFrame=p.uClampFrame,y.uniforms.uClampOffset=p.uClampOffset),y.uniforms.uTransform=b1.toArray(!0),y.uniforms.uColor=Zn.shared.setValue(e.tint).premultiply(e.worldAlpha,d).toArray(y.uniforms.uColor),y.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),y.uniforms.uSampler=l,i.shader.bind(y),i.geometry.bind(n),this.state.blendMode=RQ(e.blendMode,d),i.state.set(this.state),i.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}W7.extension={name:"tilingSprite",type:xt.RendererPlugin};$t.add(W7);const H7=class Ax{constructor(e,i,n){this.linkedSheets=[],(e instanceof Mi||e instanceof Wi)&&(e={texture:e,data:i,resolutionFilename:n});const{texture:r,data:o,resolutionFilename:a=null,cachePrefix:l=""}=e;this.cachePrefix=l,this._texture=r instanceof Wi?r:null,this.baseTexture=r instanceof Mi?r:this._texture.baseTexture,this.textures={},this.animations={},this.data=o;const h=this.baseTexture.resource;this.resolution=this._updateResolution(a||(h?h.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:i}=this.data.meta;let n=pu(e,null);return n===null&&(n=typeof i=="number"?i:parseFloat(i??"1")),n!==1&&this.baseTexture.setResolution(n),n}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Ax.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let i=e;const n=Ax.BATCH_SIZE;for(;i-e<n&&i<this._frameKeys.length;){const r=this._frameKeys[i],o=this._frames[r],a=o.frame;if(a){let l=null,h=null;const d=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,f=new Pi(0,0,Math.floor(d.w)/this.resolution,Math.floor(d.h)/this.resolution);o.rotated?l=new Pi(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):l=new Pi(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(h=new Pi(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[r]=new Wi(this.baseTexture,l,f,h,o.rotated?2:0,o.anchor,o.borders),Wi.addToCache(this.textures[r],this.cachePrefix+r.toString())}i++}}_processAnimations(){const e=this.data.animations||{};for(const i in e){this.animations[i]=[];for(let n=0;n<e[i].length;n++){const r=e[i][n];this.animations[i].push(this.textures[r])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Ax.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Ax.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var i;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((i=this._texture)==null||i.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};H7.BATCH_SIZE=1e3;let O4=H7;const WOe=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function G7(s,e,i){const n={};if(s.forEach(r=>{n[r]=e}),Object.keys(e.textures).forEach(r=>{n[`${e.cachePrefix}${r}`]=e.textures[r]}),!i){const r=Or.dirname(s[0]);e.linkedSheets.forEach((o,a)=>{Object.assign(n,G7([`${r}/${e.data.meta.related_multi_packs[a]}`],o,!0))})}return n}const HOe={extension:xt.Asset,cache:{test:s=>s instanceof O4,getCacheableAssets:(s,e)=>G7(s,e,!1)},resolver:{test:s=>{const e=s.split("?")[0].split("."),i=e.pop(),n=e.pop();return i==="json"&&WOe.includes(n)},parse:s=>{var i;const e=s.split(".");return{resolution:parseFloat(((i=kt.RETINA_PREFIX.exec(s))==null?void 0:i[1])??"1"),format:e[e.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:xt.LoadParser,priority:ac.Normal},async testParse(s,e){return Or.extname(e.src).toLowerCase()===".json"&&!!s.frames},async parse(s,e,i){var f,p;const{texture:n,imageFilename:r,cachePrefix:o}=(e==null?void 0:e.data)??{};let a=Or.dirname(e.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let l;if(n&&n.baseTexture)l=n;else{const g=VI(a+(r??s.meta.image),e.src);l=(await i.load([g]))[g]}const h=new O4({texture:l.baseTexture,data:s,resolutionFilename:e.src,cachePrefix:o});await h.parse();const d=(f=s==null?void 0:s.meta)==null?void 0:f.related_multi_packs;if(Array.isArray(d)){const g=[];for(const x of d){if(typeof x!="string")continue;let _=a+x;(p=e.data)!=null&&p.ignoreMultiPack||(_=VI(_,e.src),g.push(i.load({src:_,data:{ignoreMultiPack:!0}})))}const y=await Promise.all(g);h.linkedSheets=y,y.forEach(x=>{x.linkedSheets=[h].concat(h.linkedSheets.filter(_=>_!==x))})}return h},unload(s){s.destroy(!0)}}};$t.add(HOe);class FC{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class VS{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const i=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const o in i){const a=i[o].match(/^[a-z]+/gm)[0],l=i[o].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),h={};for(const d in l){const f=l[d].split("="),p=f[0],g=f[1].replace(/"/gm,""),y=parseFloat(g),x=isNaN(y)?g:y;h[p]=x}n[a].push(h)}const r=new FC;return n.info.forEach(o=>r.info.push({face:o.face,size:parseInt(o.size,10)})),n.common.forEach(o=>r.common.push({lineHeight:parseInt(o.lineHeight,10)})),n.page.forEach(o=>r.page.push({id:parseInt(o.id,10),file:o.file})),n.char.forEach(o=>r.char.push({id:parseInt(o.id,10),page:parseInt(o.page,10),x:parseInt(o.x,10),y:parseInt(o.y,10),width:parseInt(o.width,10),height:parseInt(o.height,10),xoffset:parseInt(o.xoffset,10),yoffset:parseInt(o.yoffset,10),xadvance:parseInt(o.xadvance,10)})),n.kerning.forEach(o=>r.kerning.push({first:parseInt(o.first,10),second:parseInt(o.second,10),amount:parseInt(o.amount,10)})),n.distanceField.forEach(o=>r.distanceField.push({distanceRange:parseInt(o.distanceRange,10),fieldType:o.fieldType})),r}}class HI{static test(e){const i=e;return typeof e!="string"&&"getElementsByTagName"in e&&i.getElementsByTagName("page").length&&i.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const i=new FC,n=e.getElementsByTagName("info"),r=e.getElementsByTagName("common"),o=e.getElementsByTagName("page"),a=e.getElementsByTagName("char"),l=e.getElementsByTagName("kerning"),h=e.getElementsByTagName("distanceField");for(let d=0;d<n.length;d++)i.info.push({face:n[d].getAttribute("face"),size:parseInt(n[d].getAttribute("size"),10)});for(let d=0;d<r.length;d++)i.common.push({lineHeight:parseInt(r[d].getAttribute("lineHeight"),10)});for(let d=0;d<o.length;d++)i.page.push({id:parseInt(o[d].getAttribute("id"),10)||0,file:o[d].getAttribute("file")});for(let d=0;d<a.length;d++){const f=a[d];i.char.push({id:parseInt(f.getAttribute("id"),10),page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xoffset:parseInt(f.getAttribute("xoffset"),10),yoffset:parseInt(f.getAttribute("yoffset"),10),xadvance:parseInt(f.getAttribute("xadvance"),10)})}for(let d=0;d<l.length;d++)i.kerning.push({first:parseInt(l[d].getAttribute("first"),10),second:parseInt(l[d].getAttribute("second"),10),amount:parseInt(l[d].getAttribute("amount"),10)});for(let d=0;d<h.length;d++)i.distanceField.push({fieldType:h[d].getAttribute("fieldType"),distanceRange:parseInt(h[d].getAttribute("distanceRange"),10)});return i}}class GI{static test(e){return typeof e=="string"&&e.includes("<font>")?HI.test(kt.ADAPTER.parseXML(e)):!1}static parse(e){return HI.parse(kt.ADAPTER.parseXML(e))}}const Ik=[VS,HI,GI];function GOe(s){for(let e=0;e<Ik.length;e++)if(Ik[e].test(s))return Ik[e];return null}function QOe(s,e,i,n,r,o){const a=i.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let l;const h=i.dropShadow?i.dropShadowDistance:0,d=i.padding||0,f=s.width/n-h-d*2,p=s.height/n-h-d*2,g=a.slice(),y=i.fillGradientStops.slice();if(!y.length){const x=g.length+1;for(let _=1;_<x;++_)y.push(_/x)}if(g.unshift(a[0]),y.unshift(0),g.push(a[a.length-1]),y.push(1),i.fillGradientType===pA.LINEAR_VERTICAL){l=e.createLinearGradient(f/2,d,f/2,p+d);let x=0;const _=(o.fontProperties.fontSize+i.strokeThickness)/p;for(let w=0;w<r.length;w++){const O=o.lineHeight*w;for(let T=0;T<g.length;T++){let C=0;typeof y[T]=="number"?C=y[T]:C=T/g.length;const A=O/p+C*_;let B=Math.max(x,A);B=Math.min(B,1),l.addColorStop(B,g[T]),x=B}}}else{l=e.createLinearGradient(d,p/2,f+d,p/2);const x=g.length+1;let _=1;for(let w=0;w<g.length;w++){let O;typeof y[w]=="number"?O=y[w]:O=_/x,l.addColorStop(O,g[w]),_++}}return l}function YOe(s,e,i,n,r,o,a){const l=i.text,h=i.fontProperties;e.translate(n,r),e.scale(o,o);const d=a.strokeThickness/2,f=-(a.strokeThickness/2);if(e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=QOe(s,e,a,o,[l],i),e.strokeStyle=a.stroke,a.dropShadow){const p=a.dropShadowColor,g=a.dropShadowBlur*o,y=a.dropShadowDistance*o;e.shadowColor=Zn.shared.setValue(p).setAlpha(a.dropShadowAlpha).toRgbaString(),e.shadowBlur=g,e.shadowOffsetX=Math.cos(a.dropShadowAngle)*y,e.shadowOffsetY=Math.sin(a.dropShadowAngle)*y}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;a.stroke&&a.strokeThickness&&e.strokeText(l,d,f+i.lineHeight-h.descent),a.fill&&e.fillText(l,d,f+i.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function $S(s){return s.codePointAt?s.codePointAt(0):s.charCodeAt(0)}function Q7(s){return Array.from?Array.from(s):s.split("")}function jOe(s){typeof s=="string"&&(s=[s]);const e=[];for(let i=0,n=s.length;i<n;i++){const r=s[i];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const o=r[0].charCodeAt(0),a=r[1].charCodeAt(0);if(a<o)throw new Error("[BitmapFont]: Invalid character range.");for(let l=o,h=a;l<=h;l++)e.push(String.fromCharCode(l))}else e.push(...Q7(r))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const Od=class Bc{constructor(e,i,n){var f;const[r]=e.info,[o]=e.common,[a]=e.page,[l]=e.distanceField,h=pu(a.file),d={};this._ownsTextures=n,this.font=r.face,this.size=r.size,this.lineHeight=o.lineHeight/h,this.chars={},this.pageTextures=d;for(let p=0;p<e.page.length;p++){const{id:g,file:y}=e.page[p];d[g]=i instanceof Array?i[p]:i[y],l!=null&&l.fieldType&&l.fieldType!=="none"&&(d[g].baseTexture.alphaMode=Yo.NO_PREMULTIPLIED_ALPHA,d[g].baseTexture.mipmap=nh.OFF)}for(let p=0;p<e.char.length;p++){const{id:g,page:y}=e.char[p];let{x,y:_,width:w,height:O,xoffset:T,yoffset:C,xadvance:A}=e.char[p];x/=h,_/=h,w/=h,O/=h,T/=h,C/=h,A/=h;const B=new Pi(x+d[y].frame.x/h,_+d[y].frame.y/h,w,O);this.chars[g]={xOffset:T,yOffset:C,xAdvance:A,kerning:{},texture:new Wi(d[y].baseTexture,B),page:y}}for(let p=0;p<e.kerning.length;p++){let{first:g,second:y,amount:x}=e.kerning[p];g/=h,y/=h,x/=h,this.chars[y]&&(this.chars[y].kerning[g]=x)}this.distanceFieldRange=l==null?void 0:l.distanceRange,this.distanceFieldType=((f=l==null?void 0:l.fieldType)==null?void 0:f.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,i,n){let r;if(e instanceof FC)r=e;else{const a=GOe(e);if(!a)throw new Error("Unrecognized data format for font.");r=a.parse(e)}i instanceof Wi&&(i=[i]);const o=new Bc(r,i,n);return Bc.available[o.font]=o,o}static uninstall(e){const i=Bc.available[e];if(!i)throw new Error(`No font found named '${e}'`);i.destroy(),delete Bc.available[e]}static from(e,i,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:r,padding:o,resolution:a,textureWidth:l,textureHeight:h,...d}=Object.assign({},Bc.defaultOptions,n),f=jOe(r),p=i instanceof Da?i:new Da(i),g=l,y=new FC;y.info[0]={face:p.fontFamily,size:p.fontSize},y.common[0]={lineHeight:p.fontSize};let x=0,_=0,w,O,T,C=0;const A=[];for(let I=0;I<f.length;I++){w||(w=kt.ADAPTER.createCanvas(),w.width=l,w.height=h,O=w.getContext("2d"),T=new Mi(w,{resolution:a,...d}),A.push(new Wi(T)),y.page.push({id:A.length-1,file:""}));const R=f[I],P=Md.measureText(R,p,!1,w),k=P.width,E=Math.ceil(P.height),D=Math.ceil((p.fontStyle==="italic"?2:1)*k);if(_>=h-E*a){if(_===0)throw new Error(`[BitmapFont] textureHeight ${h}px is too small (fontFamily: '${p.fontFamily}', fontSize: ${p.fontSize}px, char: '${R}')`);--I,w=null,O=null,T=null,_=0,x=0,C=0;continue}if(C=Math.max(E+P.fontProperties.descent,C),D*a+x>=g){if(x===0)throw new Error(`[BitmapFont] textureWidth ${l}px is too small (fontFamily: '${p.fontFamily}', fontSize: ${p.fontSize}px, char: '${R}')`);--I,_+=C*a,_=Math.ceil(_),x=0,C=0;continue}YOe(w,O,P,x,_,a,p);const L=$S(P.text);y.char.push({id:L,page:A.length-1,x:x/a,y:_/a,width:D,height:E,xoffset:0,yoffset:0,xadvance:k-(p.dropShadow?p.dropShadowDistance:0)-(p.stroke?p.strokeThickness:0)}),x+=(D+2*o)*a,x=Math.ceil(x)}if(!(n!=null&&n.skipKerning))for(let I=0,R=f.length;I<R;I++){const P=f[I];for(let k=0;k<R;k++){const E=f[k],D=O.measureText(P).width,L=O.measureText(E).width,V=O.measureText(P+E).width-(D+L);V&&y.kerning.push({first:$S(P),second:$S(E),amount:V})}}const B=new Bc(y,A,!0);return Bc.available[e]!==void 0&&Bc.uninstall(e),Bc.available[e]=B,B}};Od.ALPHA=[["a","z"],["A","Z"]," "],Od.NUMERIC=[["0","9"]],Od.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Od.ASCII=[[" ","~"]],Od.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Od.ALPHANUMERIC},Od.available={};let Sd=Od;var qOe=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,ZOe=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const S4=[],C4=[],T4=[],KOe=class Y7 extends Qt{constructor(e,i={}){super();const{align:n,tint:r,maxWidth:o,letterSpacing:a,fontName:l,fontSize:h}=Object.assign({},Y7.styleDefaults,i);if(!Sd.available[l])throw new Error(`Missing BitmapFont "${l}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new Zn(r),this._font=void 0,this._fontName=l,this._fontSize=h,this.text=e,this._maxWidth=o,this._maxLineHeight=0,this._letterSpacing=a,this._anchor=new Zh(()=>{this.dirty=!0},this,0,0),this._roundPixels=kt.ROUND_PIXELS,this.dirty=!0,this._resolution=kt.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var D;const e=Sd.available[this._fontName],i=this.fontSize,n=i/e.size,r=new si,o=[],a=[],l=[],h=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",d=Q7(h),f=this._maxWidth*e.size/i,p=e.distanceFieldType==="none"?S4:C4;let g=null,y=0,x=0,_=0,w=-1,O=0,T=0,C=0,A=0;for(let L=0;L<d.length;L++){const V=d[L],F=$S(V);if(/(?:\s)/.test(V)&&(w=L,O=y,A++),V==="\r"||V===`
`){a.push(y),l.push(-1),x=Math.max(x,y),++_,++T,r.x=0,r.y+=e.lineHeight,g=null,A=0;continue}const j=e.chars[F];if(!j)continue;g&&j.kerning[g]&&(r.x+=j.kerning[g]);const Q=T4.pop()||{texture:Wi.EMPTY,line:0,charCode:0,prevSpaces:0,position:new si};Q.texture=j.texture,Q.line=_,Q.charCode=F,Q.position.x=Math.round(r.x+j.xOffset+this._letterSpacing/2),Q.position.y=Math.round(r.y+j.yOffset),Q.prevSpaces=A,o.push(Q),y=Q.position.x+Math.max(j.xAdvance-j.xOffset,j.texture.orig.width),r.x+=j.xAdvance+this._letterSpacing,C=Math.max(C,j.yOffset+j.texture.height),g=F,w!==-1&&f>0&&r.x>f&&(++T,R0(o,1+w-T,1+L-w),L=w,w=-1,a.push(O),l.push(o.length>0?o[o.length-1].prevSpaces:0),x=Math.max(x,O),_++,r.x=0,r.y+=e.lineHeight,g=null,A=0)}const B=d[d.length-1];B!=="\r"&&B!==`
`&&(/(?:\s)/.test(B)&&(y=O),a.push(y),x=Math.max(x,y),l.push(-1));const I=[];for(let L=0;L<=_;L++){let V=0;this._align==="right"?V=x-a[L]:this._align==="center"?V=(x-a[L])/2:this._align==="justify"&&(V=l[L]<0?0:(x-a[L])/l[L]),I.push(V)}const R=o.length,P={},k=[],E=this._activePagesMeshData;p.push(...E);for(let L=0;L<R;L++){const V=o[L].texture,F=V.baseTexture.uid;if(!P[F]){let j=p.pop();if(!j){const ee=new wOe;let J,ue;e.distanceFieldType==="none"?(J=new _4(Wi.EMPTY),ue=mi.NORMAL):(J=new _4(Wi.EMPTY,{program:Kh.from(ZOe,qOe),uniforms:{uFWidth:0}}),ue=mi.NORMAL_NPM);const oe=new zI(ee,J);oe.blendMode=ue,j={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:oe,vertices:null,uvs:null,indices:null}}j.index=0,j.indexCount=0,j.vertexCount=0,j.uvsCount=0,j.total=0;const{_textureCache:Q}=this;Q[F]=Q[F]||new Wi(V.baseTexture),j.mesh.texture=Q[F],j.mesh.tint=this._tintColor.value,k.push(j),P[F]=j}P[F].total++}for(let L=0;L<E.length;L++)k.includes(E[L])||this.removeChild(E[L].mesh);for(let L=0;L<k.length;L++)k[L].mesh.parent!==this&&this.addChild(k[L].mesh);this._activePagesMeshData=k;for(const L in P){const V=P[L],F=V.total;if(!(((D=V.indices)==null?void 0:D.length)>6*F)||V.vertices.length<zI.BATCHABLE_SIZE*2)V.vertices=new Float32Array(4*2*F),V.uvs=new Float32Array(4*2*F),V.indices=new Uint16Array(6*F);else{const j=V.total,Q=V.vertices;for(let ee=j*4*2;ee<Q.length;ee++)Q[ee]=0}V.mesh.size=6*F}for(let L=0;L<R;L++){const V=o[L];let F=V.position.x+I[V.line]*(this._align==="justify"?V.prevSpaces:1);this._roundPixels&&(F=Math.round(F));const j=F*n,Q=V.position.y*n,ee=V.texture,J=P[ee.baseTexture.uid],ue=ee.frame,oe=ee._uvs,pe=J.index++;J.indices[pe*6+0]=0+pe*4,J.indices[pe*6+1]=1+pe*4,J.indices[pe*6+2]=2+pe*4,J.indices[pe*6+3]=0+pe*4,J.indices[pe*6+4]=2+pe*4,J.indices[pe*6+5]=3+pe*4,J.vertices[pe*8+0]=j,J.vertices[pe*8+1]=Q,J.vertices[pe*8+2]=j+ue.width*n,J.vertices[pe*8+3]=Q,J.vertices[pe*8+4]=j+ue.width*n,J.vertices[pe*8+5]=Q+ue.height*n,J.vertices[pe*8+6]=j,J.vertices[pe*8+7]=Q+ue.height*n,J.uvs[pe*8+0]=oe.x0,J.uvs[pe*8+1]=oe.y0,J.uvs[pe*8+2]=oe.x1,J.uvs[pe*8+3]=oe.y1,J.uvs[pe*8+4]=oe.x2,J.uvs[pe*8+5]=oe.y2,J.uvs[pe*8+6]=oe.x3,J.uvs[pe*8+7]=oe.y3}this._textWidth=x*n,this._textHeight=(r.y+e.lineHeight)*n;for(const L in P){const V=P[L];if(this.anchor.x!==0||this.anchor.y!==0){let ee=0;const J=this._textWidth*this.anchor.x,ue=this._textHeight*this.anchor.y;for(let oe=0;oe<V.total;oe++)V.vertices[ee++]-=J,V.vertices[ee++]-=ue,V.vertices[ee++]-=J,V.vertices[ee++]-=ue,V.vertices[ee++]-=J,V.vertices[ee++]-=ue,V.vertices[ee++]-=J,V.vertices[ee++]-=ue}this._maxLineHeight=C*n;const F=V.mesh.geometry.getBuffer("aVertexPosition"),j=V.mesh.geometry.getBuffer("aTextureCoord"),Q=V.mesh.geometry.getIndex();F.data=V.vertices,j.data=V.uvs,Q.data=V.indices,F.update(),j.update(),Q.update()}for(let L=0;L<o.length;L++)T4.push(o[L]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:i,distanceFieldType:n,size:r}=Sd.available[this._fontName];if(n!=="none"){const{a:o,b:a,c:l,d:h}=this.worldTransform,d=Math.sqrt(o*o+a*a),f=Math.sqrt(l*l+h*h),p=(Math.abs(d)+Math.abs(f))/2,g=this.fontSize/r,y=e._view.resolution;for(const x of this._activePagesMeshData)x.mesh.shader.uniforms.uFWidth=p*i*g*y}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=Sd.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let i=0;i<this._activePagesMeshData.length;i++)this._activePagesMeshData[i].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!Sd.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??Sd.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:i}=this,n=Sd.available[this._fontName].distanceFieldType==="none"?S4:C4;n.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],n.filter(r=>i[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=Wi.EMPTY});for(const r in i)i[r].destroy(),delete i[r];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};KOe.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const JOe=[".xml",".fnt"],eSe={extension:{type:xt.LoadParser,priority:ac.Normal},name:"loadBitmapFont",test(s){return JOe.includes(Or.extname(s).toLowerCase())},async testParse(s){return VS.test(s)||GI.test(s)},async parse(s,e,i){const n=VS.test(s)?VS.parse(s):GI.parse(s),{src:r}=e,{page:o}=n,a=[];for(let d=0;d<o.length;++d){const f=o[d].file;let p=Or.join(Or.dirname(r),f);p=VI(p,r),a.push(p)}const l=await i.load(a),h=a.map(d=>l[d]);return Sd.install(n,h,!0)},async load(s,e){return(await kt.ADAPTER.fetch(s)).text()},unload(s){s.destroy()}};$t.add(eSe);const QI=class s0 extends Da{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new s0(Object.keys(s0.defaultOptions).reduce((i,n)=>({...i,[n]:e[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete s0.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,i={}){const{availableFonts:n}=s0;if(n[e]){const r=n[e];return this._fonts.push(r),r.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return kt.ADAPTER.fetch(e).then(r=>r.blob()).then(async r=>new Promise((o,a)=>{const l=URL.createObjectURL(r),h=new FileReader;h.onload=()=>o([l,h.result]),h.onerror=a,h.readAsDataURL(r)})).then(async([r,o])=>{const a=Object.assign({family:Or.basename(e,Or.extname(e)),weight:"normal",style:"normal",display:"auto",src:r,dataSrc:o,refs:1,originalUrl:e,fontFace:null},i);n[e]=a,this._fonts.push(a),this.styleID++;const l=new FontFace(a.family,`url(${a.src})`,{weight:a.weight,style:a.style,display:a.display});a.fontFace=l,await l.load(),document.fonts.add(l),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const i=e.filter(n=>!this._overrides.includes(n));i.length>0&&(this._overrides.push(...i),this.styleID++)}removeOverride(...e){const i=e.filter(n=>this._overrides.includes(n));i.length>0&&(this._overrides=this._overrides.filter(n=>!i.includes(n)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,i)=>`${e}
            @font-face {
                font-family: "${i.family}";
                src: url('${i.dataSrc}');
                font-weight: ${i.weight};
                font-style: ${i.style};
                font-display: ${i.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=X_e(e)),typeof e=="number"?z_e(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const i=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&i<1&&(e+=(i*255|0).toString(16).padStart(2,"0"));const o=`${n}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${o} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${o} ${e}`}reset(){Object.assign(this,s0.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(i=>setTimeout(i,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=kt.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};QI.availableFonts={},QI.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Bk=QI;const w1=class r0 extends rr{constructor(e="",i={}){super(Wi.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const n=new Image,r=Wi.from(n,{scaleMode:kt.SCALE_MODE,resourceOptions:{autoLoad:!1}});r.orig=new Pi,r.trim=new Pi,this.texture=r;const o="http://www.w3.org/2000/svg",a="http://www.w3.org/1999/xhtml",l=document.createElementNS(o,"svg"),h=document.createElementNS(o,"foreignObject"),d=document.createElementNS(a,"div"),f=document.createElementNS(a,"style");h.setAttribute("width","10000"),h.setAttribute("height","10000"),h.style.overflow="hidden",l.appendChild(h),this.maxWidth=r0.defaultMaxWidth,this.maxHeight=r0.defaultMaxHeight,this._domElement=d,this._styleElement=f,this._svgRoot=l,this._foreignObject=h,this._foreignObject.appendChild(f),this._foreignObject.appendChild(d),this._image=n,this._loadImage=new Image,this._autoResolution=r0.defaultAutoResolution,this._resolution=r0.defaultResolution??kt.RESOLUTION,this.text=e,this.style=i}measureText(e){var f,p;const{text:i,style:n,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:i,style:n.toCSS(r)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const o=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:a,height:l}=o;(a>this.maxWidth||l>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const h=Math.min(this.maxWidth,Math.ceil(a)),d=Math.min(this.maxHeight,Math.ceil(l));return this._svgRoot.setAttribute("width",h.toString()),this._svgRoot.setAttribute("height",d.toString()),i!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:(f=this._style)==null?void 0:f.toCSS(r)}),this._styleElement.textContent=(p=this._style)==null?void 0:p.toGlobalCSS()),{width:h+n.padding*2,height:d+n.padding*2}}async updateText(e=!0){const{style:i,_image:n,_loadImage:r}=this;if(this.localStyleID!==i.styleID&&(this.dirty=!0,this.localStyleID=i.styleID),!this.dirty&&e)return;const{width:o,height:a}=this.measureText();n.width=r.width=Math.ceil(Math.max(1,o)),n.height=r.height=Math.ceil(Math.max(1,a)),this._updateID++;const l=this._updateID;await new Promise(h=>{r.onload=async()=>{if(l<this._updateID){h();return}await i.onBeforeDraw(),n.src=r.src,r.onload=null,r.src="",this.updateTexture(),h()};const d=new XMLSerializer().serializeToString(this._svgRoot);r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(d)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:i,_image:n,resolution:r}=this,{padding:o}=e,{baseTexture:a}=i;i.trim.width=i._frame.width=n.width/r,i.trim.height=i._frame.height=n.height/r,i.trim.x=-o,i.trim.y=-o,i.orig.width=i._frame.width-o*2,i.orig.height=i._frame.height-o*2,this._onTextureUpdate(),a.setRealSize(n.width,n.height,r),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var n,r,o,a,l;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},r0.defaultDestroyOptions,e),super.destroy(e);const i=null;this.ownsStyle&&((n=this._style)==null||n.cleanFonts()),this._style=i,(r=this._svgRoot)==null||r.remove(),this._svgRoot=i,(o=this._domElement)==null||o.remove(),this._domElement=i,(a=this._foreignObject)==null||a.remove(),this._foreignObject=i,(l=this._styleElement)==null||l.remove(),this._styleElement=i,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=i,this._image.src="",this._image=i}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const i=$d(this.scale.x)||1;this.scale.x=i*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const i=$d(this.scale.y)||1;this.scale.y=i*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Bk?(this.ownsStyle=!1,this._style=e):e instanceof Da?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Bk.from(e)):(this.ownsStyle=!0,this._style=new Bk(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};w1.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},w1.defaultMaxWidth=2024,w1.defaultMaxHeight=2024,w1.defaultAutoResolution=!0;const tSe={key:0,class:"loader-container"},iSe={class:"loader-content"},nSe={key:0,class:"current-file"},sSe={class:"progress-bar"},rSe={class:"progress-text"},oSe={__name:"PixiLoader",props:{textureUrls:{type:Array,required:!0}},emits:["loaded","progress"],setup(s,{expose:e,emit:i}){const n=s,r=i,o=gt(!0),a=gt(0),l=gt(0),h=gt(0),d=gt(""),f=gt({}),p=async()=>{if(!n.textureUrls||n.textureUrls.length===0){o.value=!1,r("loaded",{});return}h.value=n.textureUrls.length,l.value=0,a.value=0,d.value="";for(let g=0;g<n.textureUrls.length;g++){const y=n.textureUrls[g],x=y.split("/").pop();d.value=x;try{const _=await new Promise((w,O)=>{const T=Wi.from(y);if(T.baseTexture.valid){w(T);return}T.baseTexture.on("loaded",()=>{w(T)}),T.baseTexture.on("error",C=>{console.error(`: ${y}`,C),O(C)})});f.value[y]=_,l.value++,a.value=Math.round(l.value/h.value*100),r("progress",{loaded:l.value,total:h.value,progress:a.value,currentUrl:y,currentFileName:x})}catch(_){console.error(`: ${y}`,_),d.value=`: ${x}`;return}}d.value="",o.value=!1,r("loaded",f.value)};return an(()=>n.textureUrls,g=>{g&&g.length>0&&(o.value=!0,f.value={},p())},{immediate:!0}),e({textures:f,isLoading:o,progress:a,currentFileName:d,reload:p}),(g,y)=>o.value?(di(),hn("div",tSe,[Kt("div",iSe,[d.value?(di(),hn("div",nSe,ea(d.value),1)):cm("",!0),Kt("div",sSe,[Kt("div",{class:"progress-fill",style:Au({width:a.value+"%"})},null,4)]),Kt("div",rSe,ea(l.value)+"/"+ea(h.value),1)])])):cm("",!0)}},zD=eA(oSe,[["__scopeId","data-v-c476f797"]]),Pp=class Pp{constructor(){this.pixi=null,this.textures={},this.ticker=null,this.logic=null,this.ui=null,this.uiContainer=null,this.playerData=null}static get instance(){return Pp._instance||(Pp._instance=new Pp),Pp._instance}setUI(e){let i=this.ui;i&&i.removeFromParent(),this.ui=e,this.uiContainer.addChild(this.ui),i&&this.makeUIAppear(this.ui)}get winW(){return this.pixi.screen.width}get winH(){return this.pixi.screen.height}makeUIAppear(e,i){if(!e)return;e.x=this.winW/2,e.visible=!0;const n=Date.now(),r=.5,o=this.winW/2,a=0,l=()=>{const h=(Date.now()-n)/1e3,d=Math.min(h/r,1),f=this.easeOutCubic(d);e.x=o+(a-o)*f,d<1?requestAnimationFrame(l):(i&&i(),e.onAppearFinish&&e.onAppearFinish())};requestAnimationFrame(l)}makeUIDisappear(e,i){if(!e)return;const n=Date.now(),r=.5,o=0,a=-this.winW/2,l=()=>{const h=(Date.now()-n)/1e3,d=Math.min(h/r,1),f=this.easeInCubic(d);e.x=o+(a-o)*f,d<1?requestAnimationFrame(l):i&&i()};requestAnimationFrame(l)}easeOutCubic(e){return 1-Math.pow(1-e,3)}easeInCubic(e){return e*e*e}};cn(Pp,"_instance");let Va=Pp;function aSe(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function mA(s,e={}){const i=window.innerWidth,n=window.innerHeight,r=e.isFullScreen||aSe();let o=0,a=0;if(r){const h=i/n,d=e.designWidth/e.designHeight;h>d?(a=e.designHeight,o=a*h):(o=e.designWidth,a=o/h)}else o=e.designWidth,a=e.designHeight;let l=Math.min(i/o,n/a);l*=e.scale||1,s.style.width=o+"px",s.style.height=a+"px",s.style.transform=`scale(${l})`,s.style.transformOrigin="center",console.log("initDom",o,a,s.clientWidth,s.clientHeight,s.style.transform,s.style.transformOrigin)}function XD(s){return new uA({width:s.clientWidth,height:s.clientHeight,antialias:!1,autoDensity:!1,view:s})}class lSe{constructor(){this.resetPlayerData(),this.resetOneLevelData()}resetPlayerData(){this.levelId=0,this.playerLives=3}resetOneLevelData(){this.enermyDestroyed=[],this.levelEndType=0,this.levelStartTime=Date.now()}addEnemyDestroyed(e,i){this.enermyDestroyed[e]||(this.enermyDestroyed[e]=0),this.enermyDestroyed[e]+=i}calculateLevelTime(){const e=Date.now();return Math.floor((e-this.levelStartTime)/1e3)}getFormattedLevelTime(){const e=this.calculateLevelTime(),i=Math.floor(e/60),n=e%60;return`${i.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}}class j7{constructor(){this._entries=[],this._ticker=new jo,this._ticker.start(),this._onTick=this._onTick.bind(this),this._ticker.add(this._onTick,this)}_onTick(){const e=this._ticker.deltaMS/1e3;if(this._entries.length===0)return;const i=new Set;for(const n of this._entries){if(n.interval<=0){try{n.cb(e)}catch(r){console.error("Ticker tick error:",r)}n.once&&i.add(n.id);continue}for(n.acc+=e;n.acc>=n.interval;){n.acc-=n.interval;try{n.cb(n.interval)}catch(r){console.error("Ticker tick error:",r)}if(n.once){i.add(n.id);break}}}if(i.size)for(const n of i)this._removeById(n)}_genId(){return`${Date.now().toString(36)}_${Math.random().toString(36).slice(2,8)}`}_removeById(e){const i=this._entries.findIndex(r=>r.id===e);if(i===-1)return!1;const n=this._entries[i];if(n&&n.target&&typeof n.target.off=="function"&&n._onRemoved)try{n.target.off("removed",n._onRemoved)}catch{}return this._entries.splice(i,1),!0}_bindAutoRemove(e){const i=e.target;if(!i||typeof i.on!="function")return;const n=()=>this.removeTick(e.id);e._onRemoved=n;try{i.on("removed",n)}catch{}}tick(e,i=0,n=null){const r=this._genId(),o={id:r,cb:e,interval:Number(i)||0,acc:0,once:!1,target:n};return this._entries.push(o),n&&this._bindAutoRemove(o),r}tickOnce(e,i=0,n=null){const r=this._genId(),o={id:r,cb:e,interval:Number(i)||0,acc:0,once:!0,target:n};return this._entries.push(o),n&&this._bindAutoRemove(o),r}removeTick(e){if(typeof e=="string"){this._removeById(e);return}typeof e=="function"&&(this._entries=this._entries.filter(i=>i.cb!==e))}stop(){this._entries=[],this._ticker.stop()}}new j7;const cSe={tankAppear:{pattern:"born_",frameCount:6,totalCount:1,frameRate:8},tankExplode:{pattern:"explode_",frameCount:3,totalCount:1,frameRate:8}};class hSe extends Qt{constructor(e={}){super();const{imgNamePattern:i="born_",frameCount:n=1,frameRate:r=8,basePath:o="tank2",totalCount:a=1,onComplete:l=null}=e;this.imgNamePattern=i,this.frameCount=n,this.basePath=o,this.totalCount=a,this.playedRounds=0,this.currentFrame=0,this.isPlaying=!1,this.frameRate=r,this.frameTime=1/this.frameRate,this.accumulator=0,this.onComplete=l,this.sprites=[],this.createSprites(),this.visible=!1,this.tankApp=Va.instance,this._tickId=null,this._onTick=h=>this.update(h)}createSprites(){for(let e=1;e<=this.frameCount;e++){const i=Wi.from(`${this.basePath}/${this.imgNamePattern}${e}.png`),n=rr.from(i);n.anchor.set(.5),n.visible=!1,this.sprites.push(n),this.addChild(n)}}play(){this.isPlaying=!0,this.currentFrame=0,this.accumulator=0,this.playedRounds=0,this.visible=!0,this.updateFrame(),this.tankApp&&this.tankApp.ticker&&!this._tickId&&(this._tickId=this.tankApp.ticker.tick(this._onTick,0,this))}stop(){this.isPlaying=!1,this.visible=!1,this.hideAllSprites(),this.tankApp&&this.tankApp.ticker&&this._tickId&&(this.tankApp.ticker.removeTick(this._tickId),this._tickId=null),this.removeFromParent()}update(e){if(!this.isPlaying)return;this.accumulator+=e;let i=!1;for(;this.accumulator>=this.frameTime;)if(this.accumulator-=this.frameTime,this.currentFrame++,i=!0,this.currentFrame>=this.frameCount&&(this.currentFrame=0,this.playedRounds++,this.playedRounds>=this.totalCount)){this.stop(),typeof this.onComplete=="function"&&this.onComplete();return}i&&this.updateFrame()}updateFrame(){this.hideAllSprites(),this.currentFrame<this.sprites.length&&(this.sprites[this.currentFrame].visible=!0)}hideAllSprites(){this.sprites.forEach(e=>{e.visible=!1})}setOnComplete(e){this.onComplete=e}}function WD(s,e){const i=cSe[s]||{},n=new hSe({imgNamePattern:i.pattern??"born_",frameCount:i.frameCount??1,frameRate:i.frameRate??8,totalCount:i.totalCount??1,basePath:i.basePath??"tank2",onComplete:e||null});return n.play(),n}const rs={EMPTY:0,BRICK:1,IRON:2,GRASS:3,WATER:4},nr={UP:0,RIGHT:1,DOWN:2,LEFT:3},Tn=32,uSe=26,dSe=26,Bv=dSe*Tn,O1=uSe*Tn,Xc={PLAYER:0,ENEMY_1:1,ENEMY_2:2,ENEMY_3:3,ENEMY_4:4},A4={[Xc.PLAYER]:{speed:100,health:1,power:1},[Xc.ENEMY_1]:{speed:80,health:1,power:1},[Xc.ENEMY_2]:{speed:100,health:2,power:1},[Xc.ENEMY_3]:{speed:120,health:3,power:1},[Xc.ENEMY_4]:{speed:100,health:4,power:2}};function q7(s,e,i){switch(e){case nr.UP:s.y-=i;break;case nr.DOWN:s.y+=i;break;case nr.LEFT:s.x-=i;break;case nr.RIGHT:s.x+=i;break}}const Rk={PLAYER:"player",ENEMY:"enemy"};class fSe extends Qt{constructor(e){super(),this.tankApp=Va.instance,this.owner=e,this.bulletType=e.tankType===Xc.PLAYER?Rk.PLAYER:Rk.ENEMY,this.direction=e.direction,this.power=1,this.speed=400,this.size=20,this.x=this.owner.x,this.y=this.owner.y,this.createSprite(),this.tankApp.ui.addBullet(this),this.owner&&this.owner.onBulletAdded&&this.owner.onBulletAdded(this)}getPower(){return this.power}setPower(e){this.power=e}getBlood(){return this.blood}setBlood(e){this.blood=e,this.blood<=0&&this.makeDead()}createSprite(){const e=new ki;this.bulletType===Rk.PLAYER?e.beginFill(65280):e.beginFill(16711680),e.drawRect(-this.size/2,-this.size/2,this.size,this.size),e.endFill(),this.sprite=e,this.addChild(this.sprite);const i=this.direction*90*Math.PI/180;this.sprite.rotation=i}update(e){q7(this,this.direction,this.speed*e),this.tankApp.ui.isInBounds(this.x,this.y)||this.makeDead()}makeDead(){this.isDead=!0,this.visible=!1,this.owner&&this.owner.onBulletDestroyed&&this.owner.onBulletDestroyed(),this.tankApp.ui.onBulletDeadFinish(this)}getBounds(){const e=this.size*1;return{x:this.x,y:this.y,width:e,height:e}}}class Z7 extends Qt{constructor(e){super(),this.tankApp=Va.instance,this.textures=this.tankApp.textures,this.tankType=e,this.direction=nr.UP,this.size=64,this.isMoving=!1,this.isShooting=!1,this.shootOnce=!1,this.invincibleTime=0,this.animationTimer=0,this.currentFrame=0,this.animationSpeed=.15,this.shootTimer=0,this.shootCooldown=.15,this.maxBullets=1,this.currentBullets=0,this.initByTankType(e)}initByTankType(e){this.tankType=e;const i=A4[e]||A4[Xc.PLAYER];this.speed=i.speed,this.health=i.health,this.power=i.power,this.initSprites()}initSprites(){this.tankSprites=[];let e;this.tankType===Xc.PLAYER?e="tank2/player1_run_":e=`tank2/enermys/enermy_${this.tankType}_run_`;for(let i=1;i<=2;i++){const n=rr.from(this.textures[`${e}${i}.png`]);n.anchor.set(.5),n.visible=!1,this.tankSprites.push(n),this.addChild(n)}}appear(){this.setInvincible();const e=WD("tankAppear",()=>{this.onAppearFinish()});this.addChild(e)}onAppearFinish(){this.setInvincible(!1),this.enterNextFrame()}isInvincible(){return this.invincibleTime>0}setInvincible(e=3){this.invincibleTime=e}setDirection(e){this.direction=e,this.tankSprites.forEach(i=>i.rotation=e*(Math.PI/2))}setMoving(e){this.isMoving=e}setShooting(e){this.isShooting=e}setShootOnce(){this.shootOnce=!0}shoot(){return new fSe(this)}onBulletAdded(e){this.currentBullets++}onBulletDestroyed(){this.currentBullets>0&&this.currentBullets--}checkCorrectPath(){const e=Tn/2,i=Math.round(this.x/e)*e,n=Math.round(this.y/e)*e;this.x=i,this.y=n}checkMoving(e){const i=this.tankApp.ui.map;if(this.isMoving){let n=i.getMovableDistance(this.getBounds(),this.direction);n<=0&&(this.checkCorrectPath(),n=i.getMovableDistance(this.getBounds(),this.direction));let r=this.tankApp.ui.getMovableDistance(this.getBounds(),this.direction,this);n=Math.min(n,r);let o=this.speed*e,a=Math.min(n,o);a>0&&q7(this,this.direction,a)}this.isMoving&&(this.animationTimer+=e,this.animationTimer>=this.animationSpeed&&(this.animationTimer=0,this.enterNextFrame()))}checkShooting(e){this.shootTimer>0&&(this.shootTimer-=e),!(this.shootTimer>0)&&(this.currentBullets>=this.maxBullets||(this.isShooting||this.shootOnce)&&(this.shootOnce=!1,this.shootTimer=this.shootCooldown,this.shoot()))}checkInvincible(e){this.invincibleTime>0?(this.invincibleTime-=e,this.alpha=Math.sin(Date.now()*.01)>0?1:.5):this.alpha=1}takeDamage(e){this.invincibleTime>0||(this.health-=e,this.health<=0&&this.makeDead())}makeDead(){this.isDead=!0,this.visible=!1,this.tankApp.ui.addEffect("tankExplode",this.x,this.y,this.onDeadFinish.bind(this))}onDeadFinish(){this.tankApp.ui.onTankDeadFinish(this)}update(e){this.isDead||(this.checkMoving(e),this.checkShooting(e),this.checkInvincible(e))}setCurrentFrame(e){this.tankSprites.forEach((i,n)=>{i.visible=n===e}),this.currentFrame=e}enterNextFrame(){this.setCurrentFrame((this.currentFrame+1)%this.tankSprites.length)}getBounds(){return{x:this.x,y:this.y,width:this.size,height:this.size}}}class pSe extends Qt{constructor(){super(),this.tankApp=Va.instance,this.textures=this.tankApp.textures,this.isDead=!1,this.size=Tn*2,this.createSprite()}createSprite(){this.sprite=rr.from("tank2/bigtile_6.png"),this.sprite.width=this.size,this.sprite.height=this.size,this.sprite.anchor.set(.5,.5),this.addChild(this.sprite)}takeDamage(e){this.isDead||(this.isDead=!0,this.changeToDestroyedSprite(),this.addExplodeEffect())}changeToDestroyedSprite(){this.sprite.texture=Wi.from("tank2/bigtile_7.png")}addExplodeEffect(){const e=WD("tankExplode",()=>{this.tankApp.ui.onHomeDeadFinish(this)});e.x=0,e.y=0,this.addChild(e)}getBounds(){return{x:this.x-this.size/2,y:this.y-this.size/2,width:this.size,height:this.size}}checkCollision(e,i){const n=this.getBounds();return e>=n.x&&e<=n.x+n.width&&i>=n.y&&i<=n.y+n.height}}class mSe{constructor(e){this.gameUI=e,this.keys={},this.moveKeys=[],this._onKeyDown=null,this._onKeyUp=null,this.setupInput()}setupInput(){this._onKeyDown||(this._onKeyDown=e=>{this.keys[e.code]=!0,this.keyDown(e.code)}),this._onKeyUp||(this._onKeyUp=e=>{this.keys[e.code]=!1,this.keyUp(e.code)}),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),console.log("TankCompInput.setupInput")}keyDown(e){const i=this.gameUI.player;if(i)switch(e){case"ArrowUp":case"KeyW":case"ArrowRight":case"KeyD":case"ArrowDown":case"KeyS":case"ArrowLeft":case"KeyA":this.addMoveKey(e);break;case"Space":i.setShooting(!0);break}}keyUp(e){const i=this.gameUI.player;if(i)switch(e){case"ArrowUp":case"KeyW":case"ArrowRight":case"KeyD":case"ArrowDown":case"KeyS":case"ArrowLeft":case"KeyA":this.removeMoveKey(e);break;case"Space":i.setShooting(!1);break}}addMoveKey(e){this.moveKeys.includes(e)||(this.moveKeys.push(e),this.checkMovePlayer())}removeMoveKey(e){let i=this.moveKeys.indexOf(e);i!==-1&&(this.moveKeys.splice(i,1),this.checkMovePlayer())}checkMovePlayer(){const e=this.gameUI.player,i=this.moveKeys[this.moveKeys.length-1];i?i==="ArrowUp"||i==="KeyW"?(e.setDirection(0),e.setMoving(!0)):i==="ArrowRight"||i==="KeyD"?(e.setDirection(1),e.setMoving(!0)):i==="ArrowDown"||i==="KeyS"?(e.setDirection(2),e.setMoving(!0)):(i==="ArrowLeft"||i==="KeyA")&&(e.setDirection(3),e.setMoving(!0)):e.setMoving(!1)}makeDead(){this._onKeyDown&&(window.removeEventListener("keydown",this._onKeyDown),this._onKeyDown=null),this._onKeyUp&&(window.removeEventListener("keyup",this._onKeyUp),this._onKeyUp=null),console.log("TankCompInput.makeDead")}}class E4 extends Qt{constructor(e,i,n){super(),this.row=e,this.col=i,this.type=n,this.tankApp=Va.instance,this.tileSize=32,this.blood=2,this.createSprite(),this.setPosition()}getBlood(){return this.blood}setBlood(e){this.blood=e,this.blood==1&&(this.sprite.alpha=.5)}createSprite(){switch(this.type){case rs.BRICK:this.sprite=rr.from("tank2/bigtile_1_tile_1.png");break;case rs.IRON:this.sprite=rr.from("tank2/bigtile_2_tile_1.png");break;case rs.GRASS:this.sprite=rr.from("tank2/bigtile_3_tile_1.png");break;case rs.WATER:this.sprite=rr.from("tank2/bigtile_3_tile_1.png");break;default:this.sprite=new ki,this.sprite.beginFill(8421504),this.sprite.drawRect(0,0,this.tileSize,this.tileSize),this.sprite.endFill()}this.sprite.width=this.tileSize,this.sprite.height=this.tileSize,this.addChild(this.sprite)}setPosition(){this.x=this.col*this.tileSize,this.y=this.row*this.tileSize}setType(e){this.type=e,this.removeChild(this.sprite),this.createSprite(),this.setPosition()}getType(){return this.type}makeDead(){this.parent&&this.parent.removeChild(this)}}const K7=[{id:1,name:"",map:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,2,2,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,2,2,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,2,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0],totalEnemies:20,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.4,type2:.3,type3:.2,type4:.1},itemDropRates:{life:.1,stop:.15,iron:.1,bomb:.05,star:.1,shield:.1}},{id:2,name:"",map:[0,0,0,0,0,0,2,2,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,2,2,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,2,2,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,1,2,2,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,1,2,2,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,3,3,0,0,0,0,1,1,0,0,0,0,2,2,0,0,0,0,1,1,3,3,1,1,2,2,3,3,0,0,0,0,1,1,0,0,0,0,2,2,0,0,0,0,1,1,3,3,1,1,2,2,3,3,3,3,0,0,0,0,0,0,1,1,0,0,0,0,2,2,0,0,3,3,0,0,0,0,3,3,3,3,0,0,0,0,0,0,1,1,0,0,0,0,2,2,0,0,3,3,0,0,0,0,0,0,1,1,1,1,1,1,3,3,3,3,3,3,2,2,0,0,0,0,3,3,1,1,0,0,0,0,1,1,1,1,1,1,3,3,3,3,3,3,2,2,0,0,0,0,3,3,1,1,0,0,0,0,0,0,0,0,2,2,3,3,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,2,2,3,3,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,2,2,1,1,0,0,2,2,0,0,1,1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,2,2,1,1,0,0,2,2,0,0,1,1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1,1,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1,1,1,1,0,0],totalEnemies:25,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.35,type2:.35,type3:.2,type4:.1},itemDropRates:{life:.12,stop:.12,iron:.12,bomb:.08,star:.12,shield:.12}},{id:3,name:"",map:[0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,1,1,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,1,1,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,0,0,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,2,0,0,0,0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,2,2,0,0,0,0,2,2,0,0,0,0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,0,0,1,1,1,0,0,0,1,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,2,2,2,2,2,2,2,2,1,1,0,0,0,0,3,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,2,2,0,0,1,1,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0,1,1,1,1,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0,1,1,1,1,0,0,3,0,0,0,0,1,1,1,1,0,0,0,2,2,2,2,2,2,0,0,3,3,1,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,3,3,1,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0],totalEnemies:30,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.3,type2:.35,type3:.25,type4:.1},itemDropRates:{life:.15,stop:.1,iron:.15,bomb:.1,star:.15,shield:.1}},{id:4,name:"",map:[],totalEnemies:35,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.25,type2:.35,type3:.3,type4:.1},itemDropRates:{life:.18,stop:.08,iron:.18,bomb:.12,star:.18,shield:.08}},{id:5,name:"",map:[],totalEnemies:40,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.2,type2:.35,type3:.35,type4:.1},itemDropRates:{life:.2,stop:.05,iron:.2,bomb:.15,star:.2,shield:.05}}];class gSe{constructor(e){this.gameUI=e,this.tankApp=e.tankApp,this.textures=e.textures,this.config=null,this.mapCols=26,this.mapRows=26,this.tiles=[],this.renderLayers=null}setRenderLayers(e){this.renderLayers=e}loadLevel(e){return this.config=K7[e],this.initTilesFromMap(this.config.map),!0}initTilesFromMap(e){for(let i=0;i<this.mapRows;i++){this.tiles[i]=[];for(let n=0;n<this.mapCols;n++){const r=i*this.mapCols+n,o=e[r]||rs.EMPTY;if(o>rs.EMPTY){const a=new E4(i,n,o);this.tiles[i][n]=a,this.addTileToRenderLayer(a,o)}else this.tiles[i][n]=null}}}addTileToRenderLayer(e,i){const n=this.renderLayers;switch(i){case rs.BRICK:case rs.IRON:case rs.WATER:n.tiles.addChild(e);break;case rs.GRASS:n.grass.addChild(e);break}}clearTiles(){this.tiles.forEach(e=>{e&&e.forEach(i=>{i&&i.parent&&i.parent.removeChild(i)})}),this.tiles=[]}getTileType(e,i){if(e>=0&&e<this.mapRows&&i>=0&&i<this.mapCols){const n=this.tiles[e]&&this.tiles[e][i];if(n)return n.isHome,n.type}return rs.EMPTY}setTileType(e,i,n){if(e>=0&&e<this.mapRows&&i>=0&&i<this.mapCols)if(n===rs.EMPTY){if(this.tiles[e]&&this.tiles[e][i]){const r=this.tiles[e][i];r.parent&&r.parent.removeChild(r),this.tiles[e][i]=null}}else if(this.tiles[e]||(this.tiles[e]=[]),this.tiles[e][i])this.tiles[e][i].setType(n);else{const r=new E4(e,i,n);this.tiles[e][i]=r,this.addTileToRenderLayer(r,n)}}isWalkable(e,i){const n=Math.floor(e/Tn),r=Math.floor(i/Tn),o=this.getTileType(r,n);return o===rs.EMPTY||o===rs.GRASS}isRectWalkable(e,i,n=16){const r=e-n,o=e+n-1,a=i-n,l=i+n-1,h=Math.floor(r/Tn),d=Math.floor(o/Tn),f=Math.floor(a/Tn),p=Math.floor(l/Tn);for(let g=f;g<=p;g++)for(let y=h;y<=d;y++){const x=this.getTileType(g,y);if(!(x===rs.EMPTY||x===rs.GRASS))return!1}return!0}getMovableDistance(e,i){const n=e.x,r=e.y,o=e.width,a=e.height;let l=4;const h=[{x:n-o/2,y:r-a/2},{x:n+o/2,y:r-a/2},{x:n-o/2,y:r+a/2},{x:n+o/2,y:r+a/2}],g=[{x:n-o/2+l,y:r-a/2+l},{x:n+o/2-l,y:r-a/2+l},{x:n-o/2+l,y:r+a/2-l},{x:n+o/2-l,y:r+a/2-l}].map(x=>this.worldToGrid(x.x,x.y)).map(x=>this.findNextNotWalkRC(x,i)).map(x=>this.gridToWorld(x.row,x.col)),y=[];for(let x=0;x<h.length;x++)i===0?y.push(h[x].y-(g[x].y+Tn)):i===1?y.push(g[x].x-h[x].x):i===2?y.push(g[x].y-h[x].y):y.push(h[x].x-(g[x].x+Tn));return Math.min(...y)}findNextCanWalkRC(e,i){let n=e.row,r=e.col;const o=(a,l)=>{const h=this.getTileType(a,l);return h===rs.EMPTY||h===rs.GRASS};if(i===0){for(;n-1>=0&&o(n-1,r);)n--;return{row:n,col:r}}if(i===2){for(;n+1<this.mapRows&&o(n+1,r);)n++;return{row:n,col:r}}if(i===1){for(;r+1<this.mapCols&&o(n,r+1);)r++;return{row:n,col:r}}for(;r-1>=0&&o(n,r-1);)r--;return{row:n,col:r}}passable(e,i){if(e<0||e>=this.mapRows||i<0||i>=this.mapCols)return!1;const n=this.getTileType(e,i);return n===rs.EMPTY||n===rs.GRASS}findNextNotWalkRC(e,i){let n=e.row,r=e.col;if(i===0){for(;this.passable(n,r);)n--;return{row:n,col:r}}if(i===2){for(;this.passable(n,r);)n++;return{row:n,col:r}}if(i===1){for(;this.passable(n,r);)r++;return{row:n,col:r}}for(;this.passable(n,r);)r--;return{row:n,col:r}}worldToGrid(e,i){const n=Math.floor(e/Tn);return{row:Math.floor(i/Tn),col:n}}gridToWorld(e,i){return{x:i*Tn,y:e*Tn}}findRCsInBounds(e){const i=[],n=e.x-e.width/2,r=e.y-e.height/2,o=e.x+e.width/2,a=e.y+e.height/2,l=Math.floor(r/Tn),h=Math.floor(a/Tn),d=Math.floor(n/Tn),f=Math.floor(o/Tn);for(let p=l;p<=h;p++)for(let g=d;g<=f;g++)p>=0&&p<this.mapRows&&g>=0&&g<this.mapCols&&i.push({row:p,col:g});return i}checkCollisionBullet(e){if(e.isDead)return;let i=e.getBounds(),n=this.findRCsInBounds(i);for(let r=0;r<n.length;r++){let o=n[r],a=this.tiles[o.row][o.col];a&&(a.type===rs.BRICK?(a.setBlood(a.getBlood()-e.getPower()),a.getBlood()<=0&&this.setTileType(o.row,o.col,rs.EMPTY),e.makeDead()):a.type===rs.IRON&&(e.getPower()>=2&&this.setTileType(o.row,o.col,rs.EMPTY),e.makeDead()))}}}class ySe extends Z7{constructor(e){super(e),this.aiTimer=0,this.moveTimer=0,this.resetShootTimer(),this.aiState=""}random(e,i){return Math.random()*(i-e)+e}onAppearFinish(){super.onAppearFinish(),this.checkAI(0),this.setMoving(!0),this.setShooting(!0)}resetShootTimer(e="normal"){e==="fast"?this.shootTimer=this.random(1,3):this.shootTimer=this.random(1,3)}update(e){this.checkAI(e),super.update(e)}checkAI(e){this.aiTimer-=e,this.moveTimer-=e,this.shootTimer-=e,this.aiTimer<=0&&(this.aiTimer=2,this.makeDecision()),this.moveTimer<=0&&(this.moveTimer=1,this.executeMovement()),this.shootTimer<=0&&(this.resetShootTimer(),this.setShootOnce(!0))}makeDecision(){const e=Math.random(),i=this.aiState;e<1?(this.aiState="random",this.randomWander(i!=="random"),i==="huntHome"&&this.resetShootTimer("normal")):(this.aiState="huntHome",this.huntHome(i!=="huntHome"))}randomWander(e){e?this.changeDirection():Math.random()<.3&&this.changeDirection()}huntHome(e){e&&this.resetShootTimer("fast");const i=25,n=Math.round(this.y/Tn);if(n<i)this.setDirection(nr.DOWN);else if(n>i)this.setDirection(nr.UP);else if(Math.random()<.3){const r=[nr.LEFT,nr.RIGHT],o=r[Math.floor(Math.random()*r.length)];this.setDirection(o)}}executeMovement(){this.tankApp.ui.map.getMovableDistance(this.getBounds(),this.direction)<=0&&this.changeDirection()}changeDirection(){const e=this.direction,i=[nr.UP,nr.RIGHT,nr.DOWN,nr.LEFT],n=[];for(const a of i){const l=this.tankApp.ui.map.getMovableDistance(this.getBounds(),a),h=this.tankApp.ui.getMovableDistance(this.getBounds(),a,this);Math.min(l,h)>Tn/2&&n.push(a)}if(n.length===0)return;const r=Math.random();let o;if(r<.1)o=nr.DOWN;else if(r<.5)o=e;else if(r<.9){const a=[(e+1)%4,(e+3)%4];o=a[Math.floor(Math.random()*a.length)]}else o=(e+2)%4;if(n.includes(o))this.setDirection(o);else{const a=n[Math.floor(Math.random()*n.length)];this.setDirection(a)}}getDirectionToHome(){const e=this.tankApp.ui.home;if(!e)return nr.DOWN;const i=e.x-this.x,n=e.y-this.y;return Math.abs(i)>Math.abs(n)?i>0?nr.RIGHT:nr.LEFT:n>0?nr.DOWN:nr.UP}}class vSe{constructor(e){this.gameUI=e,this.spawnIndex=1,this.spawnCount=0}update(e){const i=this.gameUI.map,n=this.gameUI.enemies.length<i.config.maxEnemiesOnScreen,r=this.spawnCount<i.config.totalEnemies;n&&r&&this.createEnemy()}isFinished(){return this.spawnCount>=this.gameUI.map.config.totalEnemies&&this.gameUI.enemies.length===0}getRemainingEnemies(){return this.gameUI.map.config.totalEnemies-this.spawnCount}createEnemy(){const e=Xc.ENEMY_1+this.spawnIndex%4,i=new ySe(e),{r:n,c:r}=this.getStartRC();i.x=r*Tn,i.y=n*Tn,i.setDirection(2),i.appear(),this.spawnIndex=(this.spawnIndex+1)%3,this.gameUI.addEnemy(i),this.spawnCount++}getStartRC(){switch(this.spawnIndex){case 0:return{r:1,c:1};case 1:return{r:1,c:Math.floor(this.gameUI.map.mapCols/2)};case 2:return{r:1,c:this.gameUI.map.mapCols-1}}}}class xSe extends Qt{constructor(e){super(),this.tankApp=Va.instance,this.gameUI=e,this.panelWidth=300,this.panelHeight=600,this.x=this.tankApp.winW-this.panelWidth,this.y=this.tankApp.winH/2,this.createPanel(),this.createInfoTexts()}createPanel(){const e=new ki;e.beginFill(0,.8),e.drawRoundedRect(0,-this.panelHeight/2,this.panelWidth,this.panelHeight,10),e.endFill(),e.lineStyle(2,16777215,.8),e.drawRoundedRect(0,-this.panelHeight/2,this.panelWidth,this.panelHeight,10),this.addChild(e)}createInfoTexts(){const e=new Da({fontFamily:"Arial",fontSize:20,fill:16777215,align:"left"}),i=new Da({fontFamily:"Arial",fontSize:28,fill:65280,align:"center",fontWeight:"bold"}),n=new Xi("",i);n.anchor.set(.5,0),n.x=this.panelWidth/2,n.y=-this.panelHeight/2+30,this.addChild(n),this.levelText=new Xi(": 1",e),this.levelText.x=30,this.levelText.y=-this.panelHeight/2+80,this.addChild(this.levelText),this.livesText=new Xi(": 3",e),this.livesText.x=30,this.livesText.y=-this.panelHeight/2+120,this.addChild(this.livesText),this.enemyText=new Xi(": 0/0",e),this.enemyText.x=30,this.enemyText.y=-this.panelHeight/2+160,this.addChild(this.enemyText);const r=new ki;r.lineStyle(2,16777215,.5),r.moveTo(30,-this.panelHeight/2+200),r.lineTo(this.panelWidth-30,-this.panelHeight/2+200),this.addChild(r)}updateView(){this.levelText.text=`: ${this.tankApp.playerData.levelId+1}`,this.livesText.text=`: ${this.tankApp.playerData.playerLives}`,this.updateEnemyInfo()}updateEnemyInfo(){const e=this.gameUI.map.config.totalEnemies,i=this.gameUI.enemySpawner.getRemainingEnemies();this.enemyText.text=`: ${i}/${e}`}}class _Se extends Qt{constructor(){super(),this.tankApp=Va.instance,this.textures=this.tankApp.textures,this.tileRoot=new Qt,this.addChild(this.tileRoot),this.tileRoot.position.set(-Bv/2,-O1/2),this.createMapBorder(),this.input=null,this.map=null,this.enemySpawner=null,this.renderLayers={background:null,tiles:null,tank:null,bullets:null,grass:null,effect:null},this.createRenderLayers(),this.initComps(),this.on("removed",this.makeDead,this),this.startLevel(),this.side.updateView()}onAppearFinish(){this.createPlayer()}createMapBorder(){const e=new ki;e.lineStyle(3,16777215,.5),e.drawRoundedRect(-Bv/2,-O1/2,Bv,O1,8),this.addChild(e)}createRenderLayers(){this.renderLayers.background=new Qt,this.renderLayers.tiles=new Qt,this.renderLayers.tank=new Qt,this.renderLayers.bullets=new Qt,this.renderLayers.grass=new Qt,this.renderLayers.effect=new Qt,this.tileRoot.addChild(this.renderLayers.background),this.tileRoot.addChild(this.renderLayers.tiles),this.tileRoot.addChild(this.renderLayers.tank),this.tileRoot.addChild(this.renderLayers.bullets),this.tileRoot.addChild(this.renderLayers.grass),this.tileRoot.addChild(this.renderLayers.effect)}initComps(){this.updater=[],this.map=new gSe(this),this.map.setRenderLayers(this.renderLayers),this.input=new mSe(this),this.enemySpawner=new vSe(this),this.updater.push(this.enemySpawner),this.side=new xSe(this),this.addChild(this.side),this.side.position.set(Bv/2+50,0)}update(e){this.tankApp.playerData.levelEndType==0&&(this.updater.forEach(i=>{i.update(e)}),this.player&&this.player.update(e),this.enemies.forEach(i=>{i.update(e)}),this.playerBullets.forEach(i=>{i.update(e)}),this.enemyBullets.forEach(i=>{i.update(e)}),this.checkCollisions())}addBullet(e){e.bulletType==="player"?this.playerBullets.push(e):this.enemyBullets.push(e),this.renderLayers.bullets.addChild(e)}removeBullet(e){if(this.renderLayers.bullets.removeChild(e),e.bulletType==="player"){let i=this.playerBullets.indexOf(e);i!==-1&&this.playerBullets.splice(i,1)}else{let i=this.enemyBullets.indexOf(e);i!==-1&&this.enemyBullets.splice(i,1)}}addEnemy(e){this.enemies.push(e),this.renderLayers.tank.addChild(e)}removeEnemy(e){this.renderLayers.tank.removeChild(e);let i=this.enemies.indexOf(e);i!==-1&&this.enemies.splice(i,1)}addPlayer(e){this.player=e,this.renderLayers.tank.addChild(e)}removePlayer(e){this.renderLayers.tank.removeChild(e),this.player=null}addEffect(e,i,n,r){const o=WD(e,r);o.x=i,o.y=n,this.renderLayers.effect.addChild(o)}startLevel(){this.clearLevel(),this.map.loadLevel(this.tankApp.playerData.levelId),this.createHome()}nextLevel(){this.tankApp.playerData.levelId++,this.startLevel()}clearLevel(){this.home=null,this.player=null,this.enemies=[],this.playerBullets=[],this.enemyBullets=[];for(let e in this.renderLayers)this.renderLayers[e]&&this.renderLayers[e].removeChildren()}createPlayer(){this.player&&this.player.parent&&this.player.parent.removeChild(this.player),this.player=new Z7(Xc.PLAYER),this.renderLayers.tank.addChild(this.player);const e=this.map.mapRows-1,i=this.map.mapCols/2-1;let n=e,r=i-2;this.player.x=r*Tn,this.player.y=n*Tn,this.player.appear()}createHome(){this.home&&this.home.parent&&this.home.parent.removeChild(this.home);const e=this.map.mapRows-1,i=this.map.mapCols/2-1;this.home=new pSe,this.home.x=i*Tn+Tn,this.home.y=(e-1)*Tn+Tn,this.renderLayers.tank.addChild(this.home)}checkCollisions(){const e=this.playerBullets.concat(),i=this.enemyBullets.concat(),n=[...e,...i],r=this.player,o=this.enemies;for(let a=0;a<n.length;a++){const l=n[a];this.map.checkCollisionBullet(l)}if(this.home&&!this.home.isDead)for(let a=0;a<n.length;a++){const l=n[a];this.home.checkCollision(l.x,l.y)&&(this.home.takeDamage(l.power),l.makeDead())}e.forEach(a=>{o.forEach(l=>{this.checkBulletTankCollision(a,l)&&(l.takeDamage(a.power),a.makeDead())})}),i.forEach(a=>{r&&this.checkBulletTankCollision(a,r)&&(r.takeDamage(a.power),a.makeDead())}),e.forEach(a=>{i.forEach(l=>{this.checkBulletBulletCollision(a,l)&&(a.makeDead(),l.makeDead())})})}checkBulletTankCollision(e,i){if(!e||!i||e.isDead||i.isDead)return!1;const n=e.getBounds(),r=i.getBounds();return n.x<r.x+r.width&&n.x+n.width>r.x&&n.y<r.y+r.height&&n.y+n.height>r.y}checkBulletBulletCollision(e,i){if(!e||!i||e.isDead||i.isDead)return!1;const n=e.getBounds(),r=i.getBounds();return n.x<r.x+r.width&&n.x+n.width>r.x&&n.y<r.y+r.height&&n.y+n.height>r.y}checkTankTankCollision(e,i){if(!e||!i||e===i)return!1;const n=e.getBounds(),r=i.getBounds();return n.x<r.x+r.width&&n.x+n.width>r.x&&n.y<r.y+r.height&&n.y+n.height>r.y}getMovableDistance(e,i,n=null){const r=e.x,o=e.y,a=e.width,l=e.height,h=[this.player,...this.enemies].filter(f=>f&&f!==n);let d=1/0;for(const f of h){const p=f.getBounds(),g=p.x,y=p.y,x=p.width,_=p.height;let w=1/0;i===0?r-a/2<g+x/2&&r+a/2>g-x/2&&(w=o-l/2-(y+_/2)):i===1?o-l/2<y+_/2&&o+l/2>y-_/2&&(w=g-x/2-(r+a/2)):i===2?r-a/2<g+x/2&&r+a/2>g-x/2&&(w=y-_/2-(o+l/2)):i===3&&o-l/2<y+_/2&&o+l/2>y-_/2&&(w=r-a/2-(g+x/2)),w<d&&(d=w)}return d===1/0||d<0?1e3:d}isInBounds(e,i){return e>=0&&e<Bv&&i>=0&&i<O1}onTankDeadFinish(e){e===this.player?(this.removePlayer(e),this.checkCreatePlayer()):(this.removeEnemy(e),this.tankApp.playerData.addEnemyDestroyed(e.tankType,1)),this.side.updateView(),this.checkGameState()}onHomeDeadFinish(e){this.home=null,this.checkGameState()}onBulletDeadFinish(e){this.removeBullet(e)}checkCreatePlayer(){this.tankApp.playerData.playerLives>0&&(this.tankApp.playerData.playerLives--,this.createPlayer())}checkGameState(){if(this.tankApp.playerData.levelEndType==0){do{if(this.enemySpawner.isFinished()){this.tankApp.playerData.levelEndType=1;break}if(!this.home){this.tankApp.playerData.levelEndType=2;break}if(!this.player&&this.tankApp.playerData.playerLives==0){this.tankApp.playerData.levelEndType=2;break}}while(!1);this.tankApp.playerData.levelEndType&&this.tankApp.ticker.tickOnce(()=>{this.tankApp.logic.setUI("TankEndUI")},1)}}makeDead(){this.input.makeDead()}}function zC(s,e){s.eventMode="static",s.cursor="pointer",s.on("pointerdown",o=>{o.preventDefault(),o.stopPropagation()}),s.on("pointertap",o=>{o.preventDefault(),o.stopPropagation(),e(o)});const i=o=>{o.preventDefault(),o.stopPropagation(),s.scale.set(.95)},n=o=>{o.preventDefault(),o.stopPropagation(),s.scale.set(1)},r=o=>{o.preventDefault(),o.stopPropagation(),s.scale.set(1)};return s.on("pointerdown",i),s.on("pointerup",n),s.on("pointerupoutside",r),s.on("touchstart",o=>{o.preventDefault(),o.stopPropagation(),i(o)}),s.on("touchend",o=>{o.preventDefault(),o.stopPropagation(),n(o)}),s.on("touchcancel",o=>{o.preventDefault(),o.stopPropagation(),r(o)}),s}class bSe extends Qt{constructor(){super(),this.tankApp=Va.instance,this.textures=this.tankApp.textures,this.titleText=null,this.singlePlayerButton=null,this.createUI()}createUI(){this.createTitle(),this.createButtons(),this.createBackground()}createTitle(){const e=Math.min(this.tankApp.winW,this.tankApp.winH)*.08,i=e*.5;this.titleText=new Xi("",{fontFamily:"Arial",fontSize:e,fontWeight:"bold",fill:16766720,align:"center",dropShadow:!0,dropShadowColor:0,dropShadowBlur:8,dropShadowDistance:4,stroke:9127187,strokeThickness:3}),this.titleText.anchor.set(.5,.5),this.titleText.x=0,this.titleText.y=-this.tankApp.winH*.15,this.addChild(this.titleText);const n=new Xi("TANK BATTLE",{fontFamily:"Arial",fontSize:i,fontWeight:"bold",fill:16753920,align:"center",dropShadow:!0,dropShadowColor:0,dropShadowBlur:4,dropShadowDistance:2});n.anchor.set(.5,.5),n.x=0,n.y=-this.tankApp.winH*.08,this.addChild(n)}createButtons(){const e=this.tankApp.winW*.2,i=this.tankApp.winH*.06;this.tankApp.winH*.08;const n=this.tankApp.winH*.1,r=Math.min(e,i)*.3;this.singlePlayerButton=this.createButton("",2263842,()=>{this.onSinglePlayer()},e,i,r),this.singlePlayerButton.x=0,this.singlePlayerButton.y=n,this.addChild(this.singlePlayerButton)}createButton(e,i,n,r,o,a){const l=new Qt,h=new ki;h.beginFill(i),h.lineStyle(4,16777215,1),h.drawRoundedRect(-r/2,-o/2,r,o,o*.25),h.endFill();const d=new Xi(e,{fontFamily:"Arial",fontSize:a,fontWeight:"bold",fill:16777215,align:"center",dropShadow:!0,dropShadowColor:0,dropShadowBlur:3,dropShadowDistance:2});return d.anchor.set(.5,.5),l.addChild(h),l.addChild(d),zC(l,n),l.on("pointerover",()=>{h.tint=13421772,l.scale.set(1.05)}),l.on("pointerout",()=>{h.tint=16777215,l.scale.set(1)}),l}createBackground(){this.createDecorativeBorder()}createDecorativeBorder(){const e=this.tankApp.winW*.8,i=this.tankApp.winH*.8,n=Math.min(this.tankApp.winW,this.tankApp.winH)*.02,r=Math.min(this.tankApp.winW,this.tankApp.winH)*.003,o=new ki;o.lineStyle(r,16766720,.8),o.drawRoundedRect(-e/2,-i/2,e,i,n),[{x:-e/2+n,y:-i/2+n},{x:e/2-n,y:-i/2+n},{x:-e/2+n,y:i/2-n},{x:e/2-n,y:i/2-n}].forEach(l=>{o.beginFill(16766720,.3),o.drawRect(l.x-n/2,l.y-n/2,n,n),o.endFill()}),this.addChildAt(o,0)}onSinglePlayer(){this.tankApp.playerData.levelId=0,this.tankApp.logic.setUI("TankGameUI")}}class wSe extends Qt{constructor(){super(),this.tankApp=Va.instance,this.panelWidth=800,this.panelHeight=600,this.createPanel(),this.createTitle(),this.createStats(),this.createButtons(),this.updateTitleAndButton(),this.updateStats()}createPanel(){const e=new ki;e.beginFill(0,.9),e.drawRoundedRect(-this.panelWidth/2,-this.panelHeight/2,this.panelWidth,this.panelHeight,15),e.endFill(),e.lineStyle(3,16777215,.8),e.drawRoundedRect(-this.panelWidth/2,-this.panelHeight/2,this.panelWidth,this.panelHeight,15),this.addChild(e)}createTitle(){const e=new Da({fontFamily:"Arial",fontSize:32,fill:65280,align:"center",fontWeight:"bold"});this.titleText=new Xi("",e),this.titleText.anchor.set(.5,0),this.titleText.x=0,this.titleText.y=-this.panelHeight/2+40,this.addChild(this.titleText)}createStats(){const e=new Da({fontFamily:"Arial",fontSize:20,fill:16777215,align:"left"});new Da({fontFamily:"Arial",fontSize:18,fill:16776960,align:"left"}),this.timeText=new Xi(": 00:00",e),this.timeText.x=-this.panelWidth/2+50,this.timeText.y=-this.panelHeight/2+100,this.addChild(this.timeText)}createButtons(){this.actionBtn=this.createButton("",0,150),this.addChild(this.actionBtn),this.setupButtonEvents()}createButton(e,i,n){const r=new Qt,o=new ki;o.beginFill(3355443,.8),o.drawRoundedRect(-80,-25,160,50,8),o.endFill(),o.lineStyle(2,16777215,.8),o.drawRoundedRect(-80,-25,160,50,8),r.addChild(o);const a=new Xi(e,{fontFamily:"Arial",fontSize:18,fill:16777215,align:"center",fontWeight:"bold"});return a.anchor.set(.5,.5),r.addChild(a),r.x=i,r.y=n,r.eventMode="static",r.cursor="pointer",r.on("pointerover",()=>{o.clear(),o.beginFill(5592405,.9),o.drawRoundedRect(-80,-25,160,50,8),o.endFill(),o.lineStyle(2,65280,1),o.drawRoundedRect(-80,-25,160,50,8)}),r.on("pointerout",()=>{o.clear(),o.beginFill(3355443,.8),o.drawRoundedRect(-80,-25,160,50,8),o.endFill(),o.lineStyle(2,16777215,.8),o.drawRoundedRect(-80,-25,160,50,8)}),r}setupButtonEvents(){this.actionBtn.on("pointerdown",()=>{this.onActionButtonClick()})}onActionButtonClick(){this.tankApp.playerData&&(this.tankApp.playerData.levelEndType===1?this.isLastLevel()?this.onBackToStart():this.onNextLevel():this.onRestart())}onBackToStart(){console.log(""),this.tankApp.logic&&this.tankApp.logic.setUI&&this.tankApp.logic.setUI("TankStartUI")}onRestart(){console.log(""),this.tankApp.playerData&&this.tankApp.playerData.resetOneLevelData(),this.tankApp.logic&&this.tankApp.logic.setUI&&this.tankApp.logic.setUI("TankGameUI")}onNextLevel(){console.log(""),this.tankApp.playerData&&(this.tankApp.playerData.levelId++,this.tankApp.playerData.resetOneLevelData()),this.tankApp.logic&&this.tankApp.logic.setUI&&this.tankApp.logic.setUI("TankGameUI")}updateStats(){this.tankApp.playerData&&(this.timeText.text=`: ${this.tankApp.playerData.getFormattedLevelTime()}`)}setTitle(e){this.titleText.text=e}isLastLevel(){if(!this.tankApp.playerData)return!1;const e=K7.length;return this.tankApp.playerData.levelId-1>=e}updateTitleAndButton(){if(!this.tankApp.playerData)return;this.tankApp.playerData.levelEndType===1?(this.titleText.text="",this.titleText.style.fill=65280):(this.titleText.text="",this.titleText.style.fill=16711680);const e=this.actionBtn.children[1];this.tankApp.playerData.levelEndType===1?this.isLastLevel()?e.text="":e.text="":e.text=""}show(){this.visible=!0,this.alpha=1}hide(){this.visible=!1,this.alpha=0}}class OSe{constructor(){this.tankApp=Va.instance}init(e){mA(e,{designWidth:1920,designHeight:1080,isFullScreen:!1}),this.tankApp.pixi=XD(e),this.tankApp.uiContainer=new Qt,this.tankApp.pixi.stage.addChild(this.tankApp.uiContainer),this.tankApp.uiContainer.position.set(this.tankApp.pixi.screen.width/2,this.tankApp.pixi.screen.height/2),this.tankApp.ticker=new j7,this._gameTickId=this.tankApp.ticker.tick(i=>this.update(i),0),this.tankApp.playerData=new lSe,this.setUI("TankStartUI")}setUI(e){e==="TankStartUI"?this.tankApp.setUI(new bSe):e==="TankGameUI"?this.tankApp.setUI(new _Se):e==="TankEndUI"&&this.tankApp.setUI(new wSe)}update(e){this.tankApp.ui&&this.tankApp.ui.update&&this.tankApp.ui.update(e)}makeDead(){this.tankApp.ticker&&(this.tankApp.ticker.stop(),this.tankApp.ticker=null),this.tankApp.pixi&&(this.tankApp.pixi.destroy(!0),this.tankApp.pixi=null)}}const SSe={class:"game-container"},CSe={__name:"TankGame",setup(s){const e=gt(null),i=gt(["tank2/bigtile_1_tile_1.png","tank2/bigtile_2_tile_1.png","tank2/bigtile_3_tile_1.png","tank2/bigtile_4_tile_1.png","tank2/bigtile_6.png","tank2/player1_run_1.png","tank2/player1_run_2.png","tank2/enermys/enermy_1_run_1.png","tank2/enermys/enermy_1_run_2.png","tank2/enermys/enermy_2_run_1.png","tank2/enermys/enermy_2_run_2.png","tank2/enermys/enermy_3_run_1.png","tank2/enermys/enermy_3_run_2.png","tank2/enermys/enermy_4_run_1.png","tank2/enermys/enermy_4_run_2.png","tank2/born_1.png","tank2/born_2.png","tank2/born_3.png","tank2/born_4.png","tank2/born_5.png","tank2/born_6.png","tank2/explode_1.png","tank2/explode_2.png","tank2/explode_3.png"]),n=Va.instance;n.logic=new OSe;const r=o=>{n.textures=o,n.logic.init(e.value)};return ra(()=>{n.logic.makeDead()}),(o,a)=>(di(),hn("div",SSe,[vt(zD,{textureUrls:i.value,onLoaded:r},null,8,["textureUrls"]),Kt("canvas",{ref_key:"gameContainer",ref:e},null,512)]))}},TSe=["src"],Dk={__name:"EasyLink",props:{link:String,width:Number,height:Number},setup(s){const e=s,i=gt(null);return io(()=>{var n=e.width?`${n}px`:"100%",r=e.height?`${r}px`:"100vh";i.value={width:n,height:r}}),(n,r)=>(di(),hn("iframe",{src:e.link,style:Au(i.value)},null,12,TSe))}},ASe={style:{"margin-top":"32px",padding:"24px 12px",background:"#fff","border-radius":"12px","box-shadow":"0 2px 8px #f0f1f2"}},ESe=Kt("h1",{style:{"text-align":"center"}},"",-1),MSe={__name:"TrigoCalc",setup(s){const e=gt(0),i=gt(0),n=gt(0),r=gt(0),o=gt(0),a=gt(0),l=gt(0);let h=!1;an(i,()=>{d(i,g=>g)}),an(n,()=>{d(n,g=>g*180/Math.PI)}),an(r,()=>{d(r,g=>Math.asin(g))}),an(o,()=>{d(o,g=>Math.acos(g))}),an(a,()=>{d(a,g=>Math.atan(g))}),an(l,()=>{d(l,g=>Math.atan(1/g))});function d(g,y){if(h)return;const x=f(g.value);e.value=y(x)}function f(g){let y=parseFloat(g);return y||(y=0),Math.abs(y)<.001&&(y=0),y}an(e,p);async function p(){h=!0;const g=e.value*Math.PI/180;i.value=e.value,n.value=g,r.value=Math.sin(g),o.value=Math.cos(g),a.value=Math.tan(g),a.value?l.value=1/a.value:l.value=0,i.value=parseFloat(i.value.toFixed(3)),n.value=parseFloat(n.value.toFixed(3)),r.value=parseFloat(r.value.toFixed(3)),o.value=parseFloat(o.value.toFixed(3)),a.value=parseFloat(a.value.toFixed(3)),l.value=parseFloat(l.value.toFixed(3)),await Ty(),h=!1}return io(()=>{e.value=30}),(g,y)=>{const x=Bn("Input"),_=Bn("Col"),w=Bn("Row");return di(),Ir(w,{justify:"center"},{default:Zt(()=>[vt(_,{xs:24,sm:16,md:10,lg:8,xl:6},{default:Zt(()=>[Kt("div",ASe,[ESe,vt(x,{type:"number",modelValue:i.value,"onUpdate:modelValue":y[0]||(y[0]=O=>i.value=O),style:{"margin-bottom":"12px"}},{prepend:Zt(()=>[As("")]),_:1},8,["modelValue"]),vt(x,{type:"number",modelValue:n.value,"onUpdate:modelValue":y[1]||(y[1]=O=>n.value=O),style:{"margin-bottom":"12px"}},{prepend:Zt(()=>[As("")]),_:1},8,["modelValue"]),vt(x,{type:"number",modelValue:r.value,"onUpdate:modelValue":y[2]||(y[2]=O=>r.value=O),style:{"margin-bottom":"12px"}},{prepend:Zt(()=>[As("")]),_:1},8,["modelValue"]),vt(x,{type:"number",modelValue:o.value,"onUpdate:modelValue":y[3]||(y[3]=O=>o.value=O),style:{"margin-bottom":"12px"}},{prepend:Zt(()=>[As("")]),_:1},8,["modelValue"]),vt(x,{type:"number",modelValue:a.value,"onUpdate:modelValue":y[4]||(y[4]=O=>a.value=O),style:{"margin-bottom":"12px"}},{prepend:Zt(()=>[As("")]),_:1},8,["modelValue"]),vt(x,{type:"number",modelValue:l.value,"onUpdate:modelValue":y[5]||(y[5]=O=>l.value=O)},{prepend:Zt(()=>[As("")]),_:1},8,["modelValue"])])]),_:1})]),_:1})}}};/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const My="164",bp={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Wh={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},J7=0,YI=1,e9=2,kSe=3,PSe=0,HD=1,GD=2,Dc=3,yu=0,qr=1,Wo=2,lu=0,qp=1,XC=2,jI=3,qI=4,t9=5,Rd=100,i9=101,n9=102,s9=103,r9=104,o9=200,a9=201,l9=202,c9=203,WC=204,HC=205,h9=206,u9=207,d9=208,f9=209,p9=210,m9=211,g9=212,y9=213,v9=214,x9=0,_9=1,b9=2,x_=3,w9=4,O9=5,S9=6,C9=7,bb=0,T9=1,A9=2,cu=0,E9=1,M9=2,k9=3,QD=4,P9=5,I9=6,B9=7,ZI="attached",R9="detached",gA=300,vu=301,tf=302,__=303,b_=304,ky=306,sy=1e3,Pa=1001,ry=1002,ar=1003,yA=1004,ISe=1004,Rp=1005,BSe=1005,Bs=1006,$0=1007,RSe=1007,Gl=1008,DSe=1008,sc=1009,D9=1010,L9=1011,YD=1012,jD=1013,mm=1014,hl=1015,Py=1016,qD=1017,ZD=1018,Iy=1020,N9=35902,V9=1021,$9=1022,qo=1023,U9=1024,F9=1025,Zp=1026,oy=1027,KD=1028,JD=1029,z9=1030,eL=1031,tL=1033,US=33776,FS=33777,zS=33778,XS=33779,KI=35840,JI=35841,eB=35842,tB=35843,iB=36196,nB=37492,sB=37496,rB=37808,oB=37809,aB=37810,lB=37811,cB=37812,hB=37813,uB=37814,dB=37815,fB=37816,pB=37817,mB=37818,gB=37819,yB=37820,vB=37821,WS=36492,xB=36494,_B=36495,X9=36283,bB=36284,wB=36285,OB=36286,W9=2200,H9=2201,G9=2202,ay=2300,ly=2301,HS=2302,Dp=2400,Lp=2401,w_=2402,vA=2500,iL=2501,LSe=0,NSe=1,VSe=2,Q9=3200,Y9=3201,vf=0,j9=1,Qh="",Ta="srgb",Mu="srgb-linear",xA="display-p3",wb="display-p3-linear",O_="linear",Hn="srgb",S_="rec709",C_="p3",$Se=0,wp=7680,USe=7681,FSe=7682,zSe=7683,XSe=34055,WSe=34056,HSe=5386,GSe=512,QSe=513,YSe=514,jSe=515,qSe=516,ZSe=517,KSe=518,SB=519,q9=512,Z9=513,K9=514,nL=515,J9=516,eY=517,tY=518,iY=519,T_=35044,JSe=35048,eCe=35040,tCe=35045,iCe=35049,nCe=35041,sCe=35046,rCe=35050,oCe=35042,aCe="100",CB="300 es",Qc=2e3,A_=2001;class ch{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(i)===-1&&n[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const o=r.indexOf(i);o!==-1&&r.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let o=0,a=r.length;o<a;o++)r[o].call(this,e);e.target=null}}}const Xr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let M4=1234567;const Kp=Math.PI/180,cy=180/Math.PI;function La(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Xr[s&255]+Xr[s>>8&255]+Xr[s>>16&255]+Xr[s>>24&255]+"-"+Xr[e&255]+Xr[e>>8&255]+"-"+Xr[e>>16&15|64]+Xr[e>>24&255]+"-"+Xr[i&63|128]+Xr[i>>8&255]+"-"+Xr[i>>16&255]+Xr[i>>24&255]+Xr[n&255]+Xr[n>>8&255]+Xr[n>>16&255]+Xr[n>>24&255]).toLowerCase()}function Ms(s,e,i){return Math.max(e,Math.min(i,s))}function sL(s,e){return(s%e+e)%e}function lCe(s,e,i,n,r){return n+(s-e)*(r-n)/(i-e)}function cCe(s,e,i){return s!==e?(i-s)/(e-s):0}function Gx(s,e,i){return(1-i)*s+i*e}function hCe(s,e,i,n){return Gx(s,e,1-Math.exp(-i*n))}function uCe(s,e=1){return e-Math.abs(sL(s,e*2)-e)}function dCe(s,e,i){return s<=e?0:s>=i?1:(s=(s-e)/(i-e),s*s*(3-2*s))}function fCe(s,e,i){return s<=e?0:s>=i?1:(s=(s-e)/(i-e),s*s*s*(s*(s*6-15)+10))}function pCe(s,e){return s+Math.floor(Math.random()*(e-s+1))}function mCe(s,e){return s+Math.random()*(e-s)}function gCe(s){return s*(.5-Math.random())}function yCe(s){s!==void 0&&(M4=s);let e=M4+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function vCe(s){return s*Kp}function xCe(s){return s*cy}function _Ce(s){return(s&s-1)===0&&s!==0}function bCe(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function wCe(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function OCe(s,e,i,n,r){const o=Math.cos,a=Math.sin,l=o(i/2),h=a(i/2),d=o((e+n)/2),f=a((e+n)/2),p=o((e-n)/2),g=a((e-n)/2),y=o((n-e)/2),x=a((n-e)/2);switch(r){case"XYX":s.set(l*f,h*p,h*g,l*d);break;case"YZY":s.set(h*g,l*f,h*p,l*d);break;case"ZXZ":s.set(h*p,h*g,l*f,l*d);break;case"XZX":s.set(l*f,h*x,h*y,l*d);break;case"YXY":s.set(h*y,l*f,h*x,l*d);break;case"ZYZ":s.set(h*x,h*y,l*f,l*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function xo(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function Vi(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const hy={DEG2RAD:Kp,RAD2DEG:cy,generateUUID:La,clamp:Ms,euclideanModulo:sL,mapLinear:lCe,inverseLerp:cCe,lerp:Gx,damp:hCe,pingpong:uCe,smoothstep:dCe,smootherstep:fCe,randInt:pCe,randFloat:mCe,randFloatSpread:gCe,seededRandom:yCe,degToRad:vCe,radToDeg:xCe,isPowerOfTwo:_Ce,ceilPowerOfTwo:bCe,floorPowerOfTwo:wCe,setQuaternionFromProperEuler:OCe,normalize:Vi,denormalize:xo};class Fe{constructor(e=0,i=0){Fe.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,n=this.y,r=e.elements;return this.x=r[0]*i+r[3]*n+r[6],this.y=r[1]*i+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(Ms(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y;return i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const n=Math.cos(i),r=Math.sin(i),o=this.x-e.x,a=this.y-e.y;return this.x=o*n-a*r+e.x,this.y=o*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ni{constructor(e,i,n,r,o,a,l,h,d){Ni.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,n,r,o,a,l,h,d)}set(e,i,n,r,o,a,l,h,d){const f=this.elements;return f[0]=e,f[1]=r,f[2]=l,f[3]=i,f[4]=o,f[5]=h,f[6]=n,f[7]=a,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(e,i,n){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,r=i.elements,o=this.elements,a=n[0],l=n[3],h=n[6],d=n[1],f=n[4],p=n[7],g=n[2],y=n[5],x=n[8],_=r[0],w=r[3],O=r[6],T=r[1],C=r[4],A=r[7],B=r[2],I=r[5],R=r[8];return o[0]=a*_+l*T+h*B,o[3]=a*w+l*C+h*I,o[6]=a*O+l*A+h*R,o[1]=d*_+f*T+p*B,o[4]=d*w+f*C+p*I,o[7]=d*O+f*A+p*R,o[2]=g*_+y*T+x*B,o[5]=g*w+y*C+x*I,o[8]=g*O+y*A+x*R,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],d=e[7],f=e[8];return i*a*f-i*l*d-n*o*f+n*l*h+r*o*d-r*a*h}invert(){const e=this.elements,i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],d=e[7],f=e[8],p=f*a-l*d,g=l*h-f*o,y=d*o-a*h,x=i*p+n*g+r*y;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/x;return e[0]=p*_,e[1]=(r*d-f*n)*_,e[2]=(l*n-r*a)*_,e[3]=g*_,e[4]=(f*i-r*h)*_,e[5]=(r*o-l*i)*_,e[6]=y*_,e[7]=(n*h-d*i)*_,e[8]=(a*i-n*o)*_,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,n,r,o,a,l){const h=Math.cos(o),d=Math.sin(o);return this.set(n*h,n*d,-n*(h*a+d*l)+a+e,-r*d,r*h,-r*(-d*a+h*l)+l+i,0,0,1),this}scale(e,i){return this.premultiply(Lk.makeScale(e,i)),this}rotate(e){return this.premultiply(Lk.makeRotation(-e)),this}translate(e,i){return this.premultiply(Lk.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,n=e.elements;for(let r=0;r<9;r++)if(i[r]!==n[r])return!1;return!0}fromArray(e,i=0){for(let n=0;n<9;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Lk=new Ni;function nY(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}const SCe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function u0(s,e){return new SCe[s](e)}function E_(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function sY(){const s=E_("canvas");return s.style.display="block",s}const k4={};function rY(s){s in k4||(k4[s]=!0,console.warn(s))}const P4=new Ni().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),I4=new Ni().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),S1={[Mu]:{transfer:O_,primaries:S_,toReference:s=>s,fromReference:s=>s},[Ta]:{transfer:Hn,primaries:S_,toReference:s=>s.convertSRGBToLinear(),fromReference:s=>s.convertLinearToSRGB()},[wb]:{transfer:O_,primaries:C_,toReference:s=>s.applyMatrix3(I4),fromReference:s=>s.applyMatrix3(P4)},[xA]:{transfer:Hn,primaries:C_,toReference:s=>s.convertSRGBToLinear().applyMatrix3(I4),fromReference:s=>s.applyMatrix3(P4).convertLinearToSRGB()}},CCe=new Set([Mu,wb]),Mn={enabled:!0,_workingColorSpace:Mu,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(s){if(!CCe.has(s))throw new Error(`Unsupported working color space, "${s}".`);this._workingColorSpace=s},convert:function(s,e,i){if(this.enabled===!1||e===i||!e||!i)return s;const n=S1[e].toReference,r=S1[i].fromReference;return r(n(s))},fromWorkingColorSpace:function(s,e){return this.convert(s,this._workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this._workingColorSpace)},getPrimaries:function(s){return S1[s].primaries},getTransfer:function(s){return s===Qh?O_:S1[s].transfer}};function U0(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function Nk(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let hg;class oY{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{hg===void 0&&(hg=E_("canvas")),hg.width=e.width,hg.height=e.height;const n=hg.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),i=hg}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=E_("canvas");i.width=e.width,i.height=e.height;const n=i.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),o=r.data;for(let a=0;a<o.length;a++)o[a]=U0(o[a]/255)*255;return n.putImageData(r,0,0),i}else if(e.data){const i=e.data.slice(0);for(let n=0;n<i.length;n++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[n]=Math.floor(U0(i[n]/255)*255):i[n]=U0(i[n]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let TCe=0;class Np{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:TCe++}),this.uuid=La(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let o;if(Array.isArray(r)){o=[];for(let a=0,l=r.length;a<l;a++)r[a].isDataTexture?o.push(Vk(r[a].image)):o.push(Vk(r[a]))}else o=Vk(r);n.url=o}return i||(e.images[this.uuid]=n),n}}function Vk(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?oY.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ACe=0;class cs extends ch{constructor(e=cs.DEFAULT_IMAGE,i=cs.DEFAULT_MAPPING,n=Pa,r=Pa,o=Bs,a=Gl,l=qo,h=sc,d=cs.DEFAULT_ANISOTROPY,f=Qh){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ACe++}),this.uuid=La(),this.name="",this.source=new Np(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=o,this.minFilter=a,this.anisotropy=d,this.format=l,this.internalFormat=null,this.type=h,this.offset=new Fe(0,0),this.repeat=new Fe(1,1),this.center=new Fe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ni,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==gA)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case sy:e.x=e.x-Math.floor(e.x);break;case Pa:e.x=e.x<0?0:1;break;case ry:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case sy:e.y=e.y-Math.floor(e.y);break;case Pa:e.y=e.y<0?0:1;break;case ry:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}cs.DEFAULT_IMAGE=null;cs.DEFAULT_MAPPING=gA;cs.DEFAULT_ANISOTROPY=1;class sn{constructor(e=0,i=0,n=0,r=1){sn.prototype.isVector4=!0,this.x=e,this.y=i,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,n,r){return this.x=e,this.y=i,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,n=this.y,r=this.z,o=this.w,a=e.elements;return this.x=a[0]*i+a[4]*n+a[8]*r+a[12]*o,this.y=a[1]*i+a[5]*n+a[9]*r+a[13]*o,this.z=a[2]*i+a[6]*n+a[10]*r+a[14]*o,this.w=a[3]*i+a[7]*n+a[11]*r+a[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,n,r,o;const h=e.elements,d=h[0],f=h[4],p=h[8],g=h[1],y=h[5],x=h[9],_=h[2],w=h[6],O=h[10];if(Math.abs(f-g)<.01&&Math.abs(p-_)<.01&&Math.abs(x-w)<.01){if(Math.abs(f+g)<.1&&Math.abs(p+_)<.1&&Math.abs(x+w)<.1&&Math.abs(d+y+O-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const C=(d+1)/2,A=(y+1)/2,B=(O+1)/2,I=(f+g)/4,R=(p+_)/4,P=(x+w)/4;return C>A&&C>B?C<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(C),r=I/n,o=R/n):A>B?A<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(A),n=I/r,o=P/r):B<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(B),n=R/o,r=P/o),this.set(n,r,o,i),this}let T=Math.sqrt((w-x)*(w-x)+(p-_)*(p-_)+(g-f)*(g-f));return Math.abs(T)<.001&&(T=1),this.x=(w-x)/T,this.y=(p-_)/T,this.z=(g-f)/T,this.w=Math.acos((d+y+O-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this.w=e.w+(i.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class aY extends ch{constructor(e=1,i=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new sn(0,0,e,i),this.scissorTest=!1,this.viewport=new sn(0,0,e,i);const r={width:e,height:i,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Bs,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const o=new cs(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);o.flipY=!1,o.generateMipmaps=n.generateMipmaps,o.internalFormat=n.internalFormat,this.textures=[];const a=n.count;for(let l=0;l<a;l++)this.textures[l]=o.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,i,n=1){if(this.width!==e||this.height!==i||this.depth!==n){this.width=e,this.height=i,this.depth=n;for(let r=0,o=this.textures.length;r<o;r++)this.textures[r].image.width=e,this.textures[r].image.height=i,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const i=Object.assign({},e.texture.image);return this.texture.source=new Np(i),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class gl extends aY{constructor(e=1,i=1,n={}){super(e,i,n),this.isWebGLRenderTarget=!0}}class _A extends cs{constructor(e=null,i=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:n,depth:r},this.magFilter=ar,this.minFilter=ar,this.wrapR=Pa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ECe extends gl{constructor(e=1,i=1,n=1,r={}){super(e,i,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new _A(null,e,i,n),this.texture.isRenderTargetTexture=!0}}class rL extends cs{constructor(e=null,i=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:n,depth:r},this.magFilter=ar,this.minFilter=ar,this.wrapR=Pa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class MCe extends gl{constructor(e=1,i=1,n=1,r={}){super(e,i,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new rL(null,e,i,n),this.texture.isRenderTargetTexture=!0}}class Zr{constructor(e=0,i=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=n,this._w=r}static slerpFlat(e,i,n,r,o,a,l){let h=n[r+0],d=n[r+1],f=n[r+2],p=n[r+3];const g=o[a+0],y=o[a+1],x=o[a+2],_=o[a+3];if(l===0){e[i+0]=h,e[i+1]=d,e[i+2]=f,e[i+3]=p;return}if(l===1){e[i+0]=g,e[i+1]=y,e[i+2]=x,e[i+3]=_;return}if(p!==_||h!==g||d!==y||f!==x){let w=1-l;const O=h*g+d*y+f*x+p*_,T=O>=0?1:-1,C=1-O*O;if(C>Number.EPSILON){const B=Math.sqrt(C),I=Math.atan2(B,O*T);w=Math.sin(w*I)/B,l=Math.sin(l*I)/B}const A=l*T;if(h=h*w+g*A,d=d*w+y*A,f=f*w+x*A,p=p*w+_*A,w===1-l){const B=1/Math.sqrt(h*h+d*d+f*f+p*p);h*=B,d*=B,f*=B,p*=B}}e[i]=h,e[i+1]=d,e[i+2]=f,e[i+3]=p}static multiplyQuaternionsFlat(e,i,n,r,o,a){const l=n[r],h=n[r+1],d=n[r+2],f=n[r+3],p=o[a],g=o[a+1],y=o[a+2],x=o[a+3];return e[i]=l*x+f*p+h*y-d*g,e[i+1]=h*x+f*g+d*p-l*y,e[i+2]=d*x+f*y+l*g-h*p,e[i+3]=f*x-l*p-h*g-d*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,n,r){return this._x=e,this._y=i,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i=!0){const n=e._x,r=e._y,o=e._z,a=e._order,l=Math.cos,h=Math.sin,d=l(n/2),f=l(r/2),p=l(o/2),g=h(n/2),y=h(r/2),x=h(o/2);switch(a){case"XYZ":this._x=g*f*p+d*y*x,this._y=d*y*p-g*f*x,this._z=d*f*x+g*y*p,this._w=d*f*p-g*y*x;break;case"YXZ":this._x=g*f*p+d*y*x,this._y=d*y*p-g*f*x,this._z=d*f*x-g*y*p,this._w=d*f*p+g*y*x;break;case"ZXY":this._x=g*f*p-d*y*x,this._y=d*y*p+g*f*x,this._z=d*f*x+g*y*p,this._w=d*f*p-g*y*x;break;case"ZYX":this._x=g*f*p-d*y*x,this._y=d*y*p+g*f*x,this._z=d*f*x-g*y*p,this._w=d*f*p+g*y*x;break;case"YZX":this._x=g*f*p+d*y*x,this._y=d*y*p+g*f*x,this._z=d*f*x-g*y*p,this._w=d*f*p-g*y*x;break;case"XZY":this._x=g*f*p-d*y*x,this._y=d*y*p-g*f*x,this._z=d*f*x+g*y*p,this._w=d*f*p+g*y*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return i===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const n=i/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,n=i[0],r=i[4],o=i[8],a=i[1],l=i[5],h=i[9],d=i[2],f=i[6],p=i[10],g=n+l+p;if(g>0){const y=.5/Math.sqrt(g+1);this._w=.25/y,this._x=(f-h)*y,this._y=(o-d)*y,this._z=(a-r)*y}else if(n>l&&n>p){const y=2*Math.sqrt(1+n-l-p);this._w=(f-h)/y,this._x=.25*y,this._y=(r+a)/y,this._z=(o+d)/y}else if(l>p){const y=2*Math.sqrt(1+l-n-p);this._w=(o-d)/y,this._x=(r+a)/y,this._y=.25*y,this._z=(h+f)/y}else{const y=2*Math.sqrt(1+p-n-l);this._w=(a-r)/y,this._x=(o+d)/y,this._y=(h+f)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let n=e.dot(i)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ms(this.dot(e),-1,1)))}rotateTowards(e,i){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,i/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const n=e._x,r=e._y,o=e._z,a=e._w,l=i._x,h=i._y,d=i._z,f=i._w;return this._x=n*f+a*l+r*d-o*h,this._y=r*f+a*h+o*l-n*d,this._z=o*f+a*d+n*h-r*l,this._w=a*f-n*l-r*h-o*d,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const n=this._x,r=this._y,o=this._z,a=this._w;let l=a*e._w+n*e._x+r*e._y+o*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=a,this._x=n,this._y=r,this._z=o,this;const h=1-l*l;if(h<=Number.EPSILON){const y=1-i;return this._w=y*a+i*this._w,this._x=y*n+i*this._x,this._y=y*r+i*this._y,this._z=y*o+i*this._z,this.normalize(),this}const d=Math.sqrt(h),f=Math.atan2(d,l),p=Math.sin((1-i)*f)/d,g=Math.sin(i*f)/d;return this._w=a*p+this._w*g,this._x=n*p+this._x*g,this._y=r*p+this._y*g,this._z=o*p+this._z*g,this._onChangeCallback(),this}slerpQuaternions(e,i,n){return this.copy(e).slerp(i,n)}random(){const e=2*Math.PI*Math.random(),i=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),o=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),o*Math.sin(i),o*Math.cos(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ie{constructor(e=0,i=0,n=0){ie.prototype.isVector3=!0,this.x=e,this.y=i,this.z=n}set(e,i,n){return n===void 0&&(n=this.z),this.x=e,this.y=i,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(B4.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(B4.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*i+o[3]*n+o[6]*r,this.y=o[1]*i+o[4]*n+o[7]*r,this.z=o[2]*i+o[5]*n+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,n=this.y,r=this.z,o=e.elements,a=1/(o[3]*i+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*i+o[4]*n+o[8]*r+o[12])*a,this.y=(o[1]*i+o[5]*n+o[9]*r+o[13])*a,this.z=(o[2]*i+o[6]*n+o[10]*r+o[14])*a,this}applyQuaternion(e){const i=this.x,n=this.y,r=this.z,o=e.x,a=e.y,l=e.z,h=e.w,d=2*(a*r-l*n),f=2*(l*i-o*r),p=2*(o*n-a*i);return this.x=i+h*d+a*p-l*f,this.y=n+h*f+l*d-o*p,this.z=r+h*p+o*f-a*d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*i+o[4]*n+o[8]*r,this.y=o[1]*i+o[5]*n+o[9]*r,this.z=o[2]*i+o[6]*n+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const n=e.x,r=e.y,o=e.z,a=i.x,l=i.y,h=i.z;return this.x=r*h-o*l,this.y=o*a-n*h,this.z=n*l-r*a,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const n=e.dot(this)/i;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return $k.copy(this).projectOnVector(e),this.sub($k)}reflect(e){return this.sub($k.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(Ms(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return i*i+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,n){const r=Math.sin(i)*e;return this.x=r*Math.sin(n),this.y=Math.cos(i)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,n){return this.x=e*Math.sin(i),this.y=n,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=n,this.z=r,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,i=Math.random()*2-1,n=Math.sqrt(1-i*i);return this.x=n*Math.cos(e),this.y=i,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const $k=new ie,B4=new Zr;class Nr{constructor(e=new ie(1/0,1/0,1/0),i=new ie(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i+=3)this.expandByPoint(Il.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,n=e.count;i<n;i++)this.expandByPoint(Il.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=Il.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const o=n.getAttribute("position");if(i===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let a=0,l=o.count;a<l;a++)e.isMesh===!0?e.getVertexPosition(a,Il):Il.fromBufferAttribute(o,a),Il.applyMatrix4(e.matrixWorld),this.expandByPoint(Il);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),C1.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),C1.copy(n.boundingBox)),C1.applyMatrix4(e.matrixWorld),this.union(C1)}const r=e.children;for(let o=0,a=r.length;o<a;o++)this.expandByObject(r[o],i);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Il),Il.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,n;return e.normal.x>0?(i=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),i<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Rv),T1.subVectors(this.max,Rv),ug.subVectors(e.a,Rv),dg.subVectors(e.b,Rv),fg.subVectors(e.c,Rv),td.subVectors(dg,ug),id.subVectors(fg,dg),Wf.subVectors(ug,fg);let i=[0,-td.z,td.y,0,-id.z,id.y,0,-Wf.z,Wf.y,td.z,0,-td.x,id.z,0,-id.x,Wf.z,0,-Wf.x,-td.y,td.x,0,-id.y,id.x,0,-Wf.y,Wf.x,0];return!Uk(i,ug,dg,fg,T1)||(i=[1,0,0,0,1,0,0,0,1],!Uk(i,ug,dg,fg,T1))?!1:(A1.crossVectors(td,id),i=[A1.x,A1.y,A1.z],Uk(i,ug,dg,fg,T1))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Il).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Il).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Th[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Th[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Th[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Th[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Th[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Th[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Th[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Th[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Th),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Th=[new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie],Il=new ie,C1=new Nr,ug=new ie,dg=new ie,fg=new ie,td=new ie,id=new ie,Wf=new ie,Rv=new ie,T1=new ie,A1=new ie,Hf=new ie;function Uk(s,e,i,n,r){for(let o=0,a=s.length-3;o<=a;o+=3){Hf.fromArray(s,o);const l=r.x*Math.abs(Hf.x)+r.y*Math.abs(Hf.y)+r.z*Math.abs(Hf.z),h=e.dot(Hf),d=i.dot(Hf),f=n.dot(Hf);if(Math.max(-Math.max(h,d,f),Math.min(h,d,f))>l)return!1}return!0}const kCe=new Nr,Dv=new ie,Fk=new ie;class Vr{constructor(e=new ie,i=-1){this.isSphere=!0,this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const n=this.center;i!==void 0?n.copy(i):kCe.setFromPoints(e).getCenter(n);let r=0;for(let o=0,a=e.length;o<a;o++)r=Math.max(r,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const n=this.center.distanceToSquared(e);return i.copy(e),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Dv.subVectors(e,this.center);const i=Dv.lengthSq();if(i>this.radius*this.radius){const n=Math.sqrt(i),r=(n-this.radius)*.5;this.center.addScaledVector(Dv,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Fk.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Dv.copy(e.center).add(Fk)),this.expandByPoint(Dv.copy(e.center).sub(Fk))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ah=new ie,zk=new ie,E1=new ie,nd=new ie,Xk=new ie,M1=new ie,Wk=new ie;class km{constructor(e=new ie,i=new ie(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ah)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=Ah.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(Ah.copy(this.origin).addScaledVector(this.direction,i),Ah.distanceToSquared(e))}distanceSqToSegment(e,i,n,r){zk.copy(e).add(i).multiplyScalar(.5),E1.copy(i).sub(e).normalize(),nd.copy(this.origin).sub(zk);const o=e.distanceTo(i)*.5,a=-this.direction.dot(E1),l=nd.dot(this.direction),h=-nd.dot(E1),d=nd.lengthSq(),f=Math.abs(1-a*a);let p,g,y,x;if(f>0)if(p=a*h-l,g=a*l-h,x=o*f,p>=0)if(g>=-x)if(g<=x){const _=1/f;p*=_,g*=_,y=p*(p+a*g+2*l)+g*(a*p+g+2*h)+d}else g=o,p=Math.max(0,-(a*g+l)),y=-p*p+g*(g+2*h)+d;else g=-o,p=Math.max(0,-(a*g+l)),y=-p*p+g*(g+2*h)+d;else g<=-x?(p=Math.max(0,-(-a*o+l)),g=p>0?-o:Math.min(Math.max(-o,-h),o),y=-p*p+g*(g+2*h)+d):g<=x?(p=0,g=Math.min(Math.max(-o,-h),o),y=g*(g+2*h)+d):(p=Math.max(0,-(a*o+l)),g=p>0?o:Math.min(Math.max(-o,-h),o),y=-p*p+g*(g+2*h)+d);else g=a>0?-o:o,p=Math.max(0,-(a*g+l)),y=-p*p+g*(g+2*h)+d;return n&&n.copy(this.origin).addScaledVector(this.direction,p),r&&r.copy(zk).addScaledVector(E1,g),y}intersectSphere(e,i){Ah.subVectors(e.center,this.origin);const n=Ah.dot(this.direction),r=Ah.dot(Ah)-n*n,o=e.radius*e.radius;if(r>o)return null;const a=Math.sqrt(o-r),l=n-a,h=n+a;return h<0?null:l<0?this.at(h,i):this.at(l,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/i;return n>=0?n:null}intersectPlane(e,i){const n=this.distanceToPlane(e);return n===null?null:this.at(n,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let n,r,o,a,l,h;const d=1/this.direction.x,f=1/this.direction.y,p=1/this.direction.z,g=this.origin;return d>=0?(n=(e.min.x-g.x)*d,r=(e.max.x-g.x)*d):(n=(e.max.x-g.x)*d,r=(e.min.x-g.x)*d),f>=0?(o=(e.min.y-g.y)*f,a=(e.max.y-g.y)*f):(o=(e.max.y-g.y)*f,a=(e.min.y-g.y)*f),n>a||o>r||((o>n||isNaN(n))&&(n=o),(a<r||isNaN(r))&&(r=a),p>=0?(l=(e.min.z-g.z)*p,h=(e.max.z-g.z)*p):(l=(e.max.z-g.z)*p,h=(e.min.z-g.z)*p),n>h||l>r)||((l>n||n!==n)&&(n=l),(h<r||r!==r)&&(r=h),r<0)?null:this.at(n>=0?n:r,i)}intersectsBox(e){return this.intersectBox(e,Ah)!==null}intersectTriangle(e,i,n,r,o){Xk.subVectors(i,e),M1.subVectors(n,e),Wk.crossVectors(Xk,M1);let a=this.direction.dot(Wk),l;if(a>0){if(r)return null;l=1}else if(a<0)l=-1,a=-a;else return null;nd.subVectors(this.origin,e);const h=l*this.direction.dot(M1.crossVectors(nd,M1));if(h<0)return null;const d=l*this.direction.dot(Xk.cross(nd));if(d<0||h+d>a)return null;const f=-l*nd.dot(Wk);return f<0?null:this.at(f/a,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ri{constructor(e,i,n,r,o,a,l,h,d,f,p,g,y,x,_,w){ri.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,n,r,o,a,l,h,d,f,p,g,y,x,_,w)}set(e,i,n,r,o,a,l,h,d,f,p,g,y,x,_,w){const O=this.elements;return O[0]=e,O[4]=i,O[8]=n,O[12]=r,O[1]=o,O[5]=a,O[9]=l,O[13]=h,O[2]=d,O[6]=f,O[10]=p,O[14]=g,O[3]=y,O[7]=x,O[11]=_,O[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ri().fromArray(this.elements)}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(e){const i=this.elements,n=e.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,n){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,i,n){return this.set(e.x,i.x,n.x,0,e.y,i.y,n.y,0,e.z,i.z,n.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,n=e.elements,r=1/pg.setFromMatrixColumn(e,0).length(),o=1/pg.setFromMatrixColumn(e,1).length(),a=1/pg.setFromMatrixColumn(e,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[3]=0,i[4]=n[4]*o,i[5]=n[5]*o,i[6]=n[6]*o,i[7]=0,i[8]=n[8]*a,i[9]=n[9]*a,i[10]=n[10]*a,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,n=e.x,r=e.y,o=e.z,a=Math.cos(n),l=Math.sin(n),h=Math.cos(r),d=Math.sin(r),f=Math.cos(o),p=Math.sin(o);if(e.order==="XYZ"){const g=a*f,y=a*p,x=l*f,_=l*p;i[0]=h*f,i[4]=-h*p,i[8]=d,i[1]=y+x*d,i[5]=g-_*d,i[9]=-l*h,i[2]=_-g*d,i[6]=x+y*d,i[10]=a*h}else if(e.order==="YXZ"){const g=h*f,y=h*p,x=d*f,_=d*p;i[0]=g+_*l,i[4]=x*l-y,i[8]=a*d,i[1]=a*p,i[5]=a*f,i[9]=-l,i[2]=y*l-x,i[6]=_+g*l,i[10]=a*h}else if(e.order==="ZXY"){const g=h*f,y=h*p,x=d*f,_=d*p;i[0]=g-_*l,i[4]=-a*p,i[8]=x+y*l,i[1]=y+x*l,i[5]=a*f,i[9]=_-g*l,i[2]=-a*d,i[6]=l,i[10]=a*h}else if(e.order==="ZYX"){const g=a*f,y=a*p,x=l*f,_=l*p;i[0]=h*f,i[4]=x*d-y,i[8]=g*d+_,i[1]=h*p,i[5]=_*d+g,i[9]=y*d-x,i[2]=-d,i[6]=l*h,i[10]=a*h}else if(e.order==="YZX"){const g=a*h,y=a*d,x=l*h,_=l*d;i[0]=h*f,i[4]=_-g*p,i[8]=x*p+y,i[1]=p,i[5]=a*f,i[9]=-l*f,i[2]=-d*f,i[6]=y*p+x,i[10]=g-_*p}else if(e.order==="XZY"){const g=a*h,y=a*d,x=l*h,_=l*d;i[0]=h*f,i[4]=-p,i[8]=d*f,i[1]=g*p+_,i[5]=a*f,i[9]=y*p-x,i[2]=x*p-y,i[6]=l*f,i[10]=_*p+g}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(PCe,e,ICe)}lookAt(e,i,n){const r=this.elements;return ma.subVectors(e,i),ma.lengthSq()===0&&(ma.z=1),ma.normalize(),sd.crossVectors(n,ma),sd.lengthSq()===0&&(Math.abs(n.z)===1?ma.x+=1e-4:ma.z+=1e-4,ma.normalize(),sd.crossVectors(n,ma)),sd.normalize(),k1.crossVectors(ma,sd),r[0]=sd.x,r[4]=k1.x,r[8]=ma.x,r[1]=sd.y,r[5]=k1.y,r[9]=ma.y,r[2]=sd.z,r[6]=k1.z,r[10]=ma.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,r=i.elements,o=this.elements,a=n[0],l=n[4],h=n[8],d=n[12],f=n[1],p=n[5],g=n[9],y=n[13],x=n[2],_=n[6],w=n[10],O=n[14],T=n[3],C=n[7],A=n[11],B=n[15],I=r[0],R=r[4],P=r[8],k=r[12],E=r[1],D=r[5],L=r[9],V=r[13],F=r[2],j=r[6],Q=r[10],ee=r[14],J=r[3],ue=r[7],oe=r[11],pe=r[15];return o[0]=a*I+l*E+h*F+d*J,o[4]=a*R+l*D+h*j+d*ue,o[8]=a*P+l*L+h*Q+d*oe,o[12]=a*k+l*V+h*ee+d*pe,o[1]=f*I+p*E+g*F+y*J,o[5]=f*R+p*D+g*j+y*ue,o[9]=f*P+p*L+g*Q+y*oe,o[13]=f*k+p*V+g*ee+y*pe,o[2]=x*I+_*E+w*F+O*J,o[6]=x*R+_*D+w*j+O*ue,o[10]=x*P+_*L+w*Q+O*oe,o[14]=x*k+_*V+w*ee+O*pe,o[3]=T*I+C*E+A*F+B*J,o[7]=T*R+C*D+A*j+B*ue,o[11]=T*P+C*L+A*Q+B*oe,o[15]=T*k+C*V+A*ee+B*pe,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[4],r=e[8],o=e[12],a=e[1],l=e[5],h=e[9],d=e[13],f=e[2],p=e[6],g=e[10],y=e[14],x=e[3],_=e[7],w=e[11],O=e[15];return x*(+o*h*p-r*d*p-o*l*g+n*d*g+r*l*y-n*h*y)+_*(+i*h*y-i*d*g+o*a*g-r*a*y+r*d*f-o*h*f)+w*(+i*d*p-i*l*y-o*a*p+n*a*y+o*l*f-n*d*f)+O*(-r*l*f-i*h*p+i*l*g+r*a*p-n*a*g+n*h*f)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=i,r[14]=n),this}invert(){const e=this.elements,i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],d=e[7],f=e[8],p=e[9],g=e[10],y=e[11],x=e[12],_=e[13],w=e[14],O=e[15],T=p*w*d-_*g*d+_*h*y-l*w*y-p*h*O+l*g*O,C=x*g*d-f*w*d-x*h*y+a*w*y+f*h*O-a*g*O,A=f*_*d-x*p*d+x*l*y-a*_*y-f*l*O+a*p*O,B=x*p*h-f*_*h-x*l*g+a*_*g+f*l*w-a*p*w,I=i*T+n*C+r*A+o*B;if(I===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const R=1/I;return e[0]=T*R,e[1]=(_*g*o-p*w*o-_*r*y+n*w*y+p*r*O-n*g*O)*R,e[2]=(l*w*o-_*h*o+_*r*d-n*w*d-l*r*O+n*h*O)*R,e[3]=(p*h*o-l*g*o-p*r*d+n*g*d+l*r*y-n*h*y)*R,e[4]=C*R,e[5]=(f*w*o-x*g*o+x*r*y-i*w*y-f*r*O+i*g*O)*R,e[6]=(x*h*o-a*w*o-x*r*d+i*w*d+a*r*O-i*h*O)*R,e[7]=(a*g*o-f*h*o+f*r*d-i*g*d-a*r*y+i*h*y)*R,e[8]=A*R,e[9]=(x*p*o-f*_*o-x*n*y+i*_*y+f*n*O-i*p*O)*R,e[10]=(a*_*o-x*l*o+x*n*d-i*_*d-a*n*O+i*l*O)*R,e[11]=(f*l*o-a*p*o-f*n*d+i*p*d+a*n*y-i*l*y)*R,e[12]=B*R,e[13]=(f*_*r-x*p*r+x*n*g-i*_*g-f*n*w+i*p*w)*R,e[14]=(x*l*r-a*_*r-x*n*h+i*_*h+a*n*w-i*l*w)*R,e[15]=(a*p*r-f*l*r+f*n*h-i*p*h-a*n*g+i*l*g)*R,this}scale(e){const i=this.elements,n=e.x,r=e.y,o=e.z;return i[0]*=n,i[4]*=r,i[8]*=o,i[1]*=n,i[5]*=r,i[9]*=o,i[2]*=n,i[6]*=r,i[10]*=o,i[3]*=n,i[7]*=r,i[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,n,r))}makeTranslation(e,i,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const n=Math.cos(i),r=Math.sin(i),o=1-n,a=e.x,l=e.y,h=e.z,d=o*a,f=o*l;return this.set(d*a+n,d*l-r*h,d*h+r*l,0,d*l+r*h,f*l+n,f*h-r*a,0,d*h-r*l,f*h+r*a,o*h*h+n,0,0,0,0,1),this}makeScale(e,i,n){return this.set(e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,i,n,r,o,a){return this.set(1,n,o,0,e,1,a,0,i,r,1,0,0,0,0,1),this}compose(e,i,n){const r=this.elements,o=i._x,a=i._y,l=i._z,h=i._w,d=o+o,f=a+a,p=l+l,g=o*d,y=o*f,x=o*p,_=a*f,w=a*p,O=l*p,T=h*d,C=h*f,A=h*p,B=n.x,I=n.y,R=n.z;return r[0]=(1-(_+O))*B,r[1]=(y+A)*B,r[2]=(x-C)*B,r[3]=0,r[4]=(y-A)*I,r[5]=(1-(g+O))*I,r[6]=(w+T)*I,r[7]=0,r[8]=(x+C)*R,r[9]=(w-T)*R,r[10]=(1-(g+_))*R,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,i,n){const r=this.elements;let o=pg.set(r[0],r[1],r[2]).length();const a=pg.set(r[4],r[5],r[6]).length(),l=pg.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],Bl.copy(this);const d=1/o,f=1/a,p=1/l;return Bl.elements[0]*=d,Bl.elements[1]*=d,Bl.elements[2]*=d,Bl.elements[4]*=f,Bl.elements[5]*=f,Bl.elements[6]*=f,Bl.elements[8]*=p,Bl.elements[9]*=p,Bl.elements[10]*=p,i.setFromRotationMatrix(Bl),n.x=o,n.y=a,n.z=l,this}makePerspective(e,i,n,r,o,a,l=Qc){const h=this.elements,d=2*o/(i-e),f=2*o/(n-r),p=(i+e)/(i-e),g=(n+r)/(n-r);let y,x;if(l===Qc)y=-(a+o)/(a-o),x=-2*a*o/(a-o);else if(l===A_)y=-a/(a-o),x=-a*o/(a-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return h[0]=d,h[4]=0,h[8]=p,h[12]=0,h[1]=0,h[5]=f,h[9]=g,h[13]=0,h[2]=0,h[6]=0,h[10]=y,h[14]=x,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,i,n,r,o,a,l=Qc){const h=this.elements,d=1/(i-e),f=1/(n-r),p=1/(a-o),g=(i+e)*d,y=(n+r)*f;let x,_;if(l===Qc)x=(a+o)*p,_=-2*p;else if(l===A_)x=o*p,_=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return h[0]=2*d,h[4]=0,h[8]=0,h[12]=-g,h[1]=0,h[5]=2*f,h[9]=0,h[13]=-y,h[2]=0,h[6]=0,h[10]=_,h[14]=-x,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const i=this.elements,n=e.elements;for(let r=0;r<16;r++)if(i[r]!==n[r])return!1;return!0}fromArray(e,i=0){for(let n=0;n<16;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e[i+9]=n[9],e[i+10]=n[10],e[i+11]=n[11],e[i+12]=n[12],e[i+13]=n[13],e[i+14]=n[14],e[i+15]=n[15],e}}const pg=new ie,Bl=new ri,PCe=new ie(0,0,0),ICe=new ie(1,1,1),sd=new ie,k1=new ie,ma=new ie,R4=new ri,D4=new Zr;class To{constructor(e=0,i=0,n=0,r=To.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,n,r=this._order){return this._x=e,this._y=i,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,n=!0){const r=e.elements,o=r[0],a=r[4],l=r[8],h=r[1],d=r[5],f=r[9],p=r[2],g=r[6],y=r[10];switch(i){case"XYZ":this._y=Math.asin(Ms(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-f,y),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(g,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Ms(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(l,y),this._z=Math.atan2(h,d)):(this._y=Math.atan2(-p,o),this._z=0);break;case"ZXY":this._x=Math.asin(Ms(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-p,y),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(h,o));break;case"ZYX":this._y=Math.asin(-Ms(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(g,y),this._z=Math.atan2(h,o)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(Ms(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-p,o)):(this._x=0,this._y=Math.atan2(l,y));break;case"XZY":this._z=Math.asin(-Ms(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(g,d),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-f,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,n){return R4.makeRotationFromQuaternion(e),this.setFromRotationMatrix(R4,i,n)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return D4.setFromEuler(this),this.setFromQuaternion(D4,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}To.DEFAULT_ORDER="XYZ";class bA{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let BCe=0;const L4=new ie,mg=new Zr,Eh=new ri,P1=new ie,Lv=new ie,RCe=new ie,DCe=new Zr,N4=new ie(1,0,0),V4=new ie(0,1,0),$4=new ie(0,0,1),U4={type:"added"},LCe={type:"removed"},gg={type:"childadded",child:null},Hk={type:"childremoved",child:null};class vn extends ch{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:BCe++}),this.uuid=La(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=vn.DEFAULT_UP.clone();const e=new ie,i=new To,n=new Zr,r=new ie(1,1,1);function o(){n.setFromEuler(i,!1)}function a(){i.setFromQuaternion(n,void 0,!1)}i._onChange(o),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ri},normalMatrix:{value:new Ni}}),this.matrix=new ri,this.matrixWorld=new ri,this.matrixAutoUpdate=vn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=vn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new bA,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return mg.setFromAxisAngle(e,i),this.quaternion.multiply(mg),this}rotateOnWorldAxis(e,i){return mg.setFromAxisAngle(e,i),this.quaternion.premultiply(mg),this}rotateX(e){return this.rotateOnAxis(N4,e)}rotateY(e){return this.rotateOnAxis(V4,e)}rotateZ(e){return this.rotateOnAxis($4,e)}translateOnAxis(e,i){return L4.copy(e).applyQuaternion(this.quaternion),this.position.add(L4.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(N4,e)}translateY(e){return this.translateOnAxis(V4,e)}translateZ(e){return this.translateOnAxis($4,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Eh.copy(this.matrixWorld).invert())}lookAt(e,i,n){e.isVector3?P1.copy(e):P1.set(e,i,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Lv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Eh.lookAt(Lv,P1,this.up):Eh.lookAt(P1,Lv,this.up),this.quaternion.setFromRotationMatrix(Eh),r&&(Eh.extractRotation(r.matrixWorld),mg.setFromRotationMatrix(Eh),this.quaternion.premultiply(mg.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(U4),gg.child=e,this.dispatchEvent(gg),gg.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(LCe),Hk.child=e,this.dispatchEvent(Hk),Hk.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Eh.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Eh.multiply(e.parent.matrixWorld)),e.applyMatrix4(Eh),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(U4),gg.child=e,this.dispatchEvent(gg),gg.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,i);if(a!==void 0)return a}}getObjectsByProperty(e,i,n=[]){this[e]===i&&n.push(this);const r=this.children;for(let o=0,a=r.length;o<a;o++)r[o].getObjectsByProperty(e,i,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lv,e,RCe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lv,DCe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let n=0,r=i.length;n<r;n++){const o=i[n];(o.matrixWorldAutoUpdate===!0||e===!0)&&o.updateMatrixWorld(e)}}updateWorldMatrix(e,i){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const r=this.children;for(let o=0,a=r.length;o<a;o++){const l=r[o];l.matrixWorldAutoUpdate===!0&&l.updateWorldMatrix(!1,!0)}}}toJSON(e){const i=e===void 0||typeof e=="string",n={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function o(l,h){return l[h.uuid]===void 0&&(l[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const h=l.shapes;if(Array.isArray(h))for(let d=0,f=h.length;d<f;d++){const p=h[d];o(e.shapes,p)}else o(e.shapes,h)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let h=0,d=this.material.length;h<d;h++)l.push(o(e.materials,this.material[h]));r.material=l}else r.material=o(e.materials,this.material);if(this.children.length>0){r.children=[];for(let l=0;l<this.children.length;l++)r.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let l=0;l<this.animations.length;l++){const h=this.animations[l];r.animations.push(o(e.animations,h))}}if(i){const l=a(e.geometries),h=a(e.materials),d=a(e.textures),f=a(e.images),p=a(e.shapes),g=a(e.skeletons),y=a(e.animations),x=a(e.nodes);l.length>0&&(n.geometries=l),h.length>0&&(n.materials=h),d.length>0&&(n.textures=d),f.length>0&&(n.images=f),p.length>0&&(n.shapes=p),g.length>0&&(n.skeletons=g),y.length>0&&(n.animations=y),x.length>0&&(n.nodes=x)}return n.object=r,n;function a(l){const h=[];for(const d in l){const f=l[d];delete f.metadata,h.push(f)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}vn.DEFAULT_UP=new ie(0,1,0);vn.DEFAULT_MATRIX_AUTO_UPDATE=!0;vn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Rl=new ie,Mh=new ie,Gk=new ie,kh=new ie,yg=new ie,vg=new ie,F4=new ie,Qk=new ie,Yk=new ie,jk=new ie;class Ho{constructor(e=new ie,i=new ie,n=new ie){this.a=e,this.b=i,this.c=n}static getNormal(e,i,n,r){r.subVectors(n,i),Rl.subVectors(e,i),r.cross(Rl);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,i,n,r,o){Rl.subVectors(r,i),Mh.subVectors(n,i),Gk.subVectors(e,i);const a=Rl.dot(Rl),l=Rl.dot(Mh),h=Rl.dot(Gk),d=Mh.dot(Mh),f=Mh.dot(Gk),p=a*d-l*l;if(p===0)return o.set(0,0,0),null;const g=1/p,y=(d*h-l*f)*g,x=(a*f-l*h)*g;return o.set(1-y-x,x,y)}static containsPoint(e,i,n,r){return this.getBarycoord(e,i,n,r,kh)===null?!1:kh.x>=0&&kh.y>=0&&kh.x+kh.y<=1}static getInterpolation(e,i,n,r,o,a,l,h){return this.getBarycoord(e,i,n,r,kh)===null?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(o,kh.x),h.addScaledVector(a,kh.y),h.addScaledVector(l,kh.z),h)}static isFrontFacing(e,i,n,r){return Rl.subVectors(n,i),Mh.subVectors(e,i),Rl.cross(Mh).dot(r)<0}set(e,i,n){return this.a.copy(e),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(e,i,n,r){return this.a.copy(e[i]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,i,n,r){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Rl.subVectors(this.c,this.b),Mh.subVectors(this.a,this.b),Rl.cross(Mh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ho.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return Ho.getBarycoord(e,this.a,this.b,this.c,i)}getInterpolation(e,i,n,r,o){return Ho.getInterpolation(e,this.a,this.b,this.c,i,n,r,o)}containsPoint(e){return Ho.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ho.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const n=this.a,r=this.b,o=this.c;let a,l;yg.subVectors(r,n),vg.subVectors(o,n),Qk.subVectors(e,n);const h=yg.dot(Qk),d=vg.dot(Qk);if(h<=0&&d<=0)return i.copy(n);Yk.subVectors(e,r);const f=yg.dot(Yk),p=vg.dot(Yk);if(f>=0&&p<=f)return i.copy(r);const g=h*p-f*d;if(g<=0&&h>=0&&f<=0)return a=h/(h-f),i.copy(n).addScaledVector(yg,a);jk.subVectors(e,o);const y=yg.dot(jk),x=vg.dot(jk);if(x>=0&&y<=x)return i.copy(o);const _=y*d-h*x;if(_<=0&&d>=0&&x<=0)return l=d/(d-x),i.copy(n).addScaledVector(vg,l);const w=f*x-y*p;if(w<=0&&p-f>=0&&y-x>=0)return F4.subVectors(o,r),l=(p-f)/(p-f+(y-x)),i.copy(r).addScaledVector(F4,l);const O=1/(w+_+g);return a=_*O,l=g*O,i.copy(n).addScaledVector(yg,a).addScaledVector(vg,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const lY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},rd={h:0,s:0,l:0},I1={h:0,s:0,l:0};function qk(s,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?s+(e-s)*6*i:i<1/2?e:i<2/3?s+(e-s)*6*(2/3-i):s}class ft{constructor(e,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,n)}set(e,i,n){if(i===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,i,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=Ta){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Mn.toWorkingColorSpace(this,i),this}setRGB(e,i,n,r=Mn.workingColorSpace){return this.r=e,this.g=i,this.b=n,Mn.toWorkingColorSpace(this,r),this}setHSL(e,i,n,r=Mn.workingColorSpace){if(e=sL(e,1),i=Ms(i,0,1),n=Ms(n,0,1),i===0)this.r=this.g=this.b=n;else{const o=n<=.5?n*(1+i):n+i-n*i,a=2*n-o;this.r=qk(a,o,e+1/3),this.g=qk(a,o,e),this.b=qk(a,o,e-1/3)}return Mn.toWorkingColorSpace(this,r),this}setStyle(e,i=Ta){function n(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=r[1],l=r[2];switch(a){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,i);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,i);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return n(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],a=o.length;if(a===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,i);if(a===6)return this.setHex(parseInt(o,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=Ta){const n=lY[e.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=U0(e.r),this.g=U0(e.g),this.b=U0(e.b),this}copyLinearToSRGB(e){return this.r=Nk(e.r),this.g=Nk(e.g),this.b=Nk(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ta){return Mn.fromWorkingColorSpace(Wr.copy(this),e),Math.round(Ms(Wr.r*255,0,255))*65536+Math.round(Ms(Wr.g*255,0,255))*256+Math.round(Ms(Wr.b*255,0,255))}getHexString(e=Ta){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=Mn.workingColorSpace){Mn.fromWorkingColorSpace(Wr.copy(this),i);const n=Wr.r,r=Wr.g,o=Wr.b,a=Math.max(n,r,o),l=Math.min(n,r,o);let h,d;const f=(l+a)/2;if(l===a)h=0,d=0;else{const p=a-l;switch(d=f<=.5?p/(a+l):p/(2-a-l),a){case n:h=(r-o)/p+(r<o?6:0);break;case r:h=(o-n)/p+2;break;case o:h=(n-r)/p+4;break}h/=6}return e.h=h,e.s=d,e.l=f,e}getRGB(e,i=Mn.workingColorSpace){return Mn.fromWorkingColorSpace(Wr.copy(this),i),e.r=Wr.r,e.g=Wr.g,e.b=Wr.b,e}getStyle(e=Ta){Mn.fromWorkingColorSpace(Wr.copy(this),e);const i=Wr.r,n=Wr.g,r=Wr.b;return e!==Ta?`color(${e} ${i.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,i,n){return this.getHSL(rd),this.setHSL(rd.h+e,rd.s+i,rd.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,n){return this.r=e.r+(i.r-e.r)*n,this.g=e.g+(i.g-e.g)*n,this.b=e.b+(i.b-e.b)*n,this}lerpHSL(e,i){this.getHSL(rd),e.getHSL(I1);const n=Gx(rd.h,I1.h,i),r=Gx(rd.s,I1.s,i),o=Gx(rd.l,I1.l,i);return this.setHSL(n,r,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const i=this.r,n=this.g,r=this.b,o=e.elements;return this.r=o[0]*i+o[3]*n+o[6]*r,this.g=o[1]*i+o[4]*n+o[7]*r,this.b=o[2]*i+o[5]*n+o[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Wr=new ft;ft.NAMES=lY;let NCe=0;class no extends ch{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:NCe++}),this.uuid=La(),this.name="",this.type="Material",this.blending=qp,this.side=yu,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=WC,this.blendDst=HC,this.blendEquation=Rd,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ft(0,0,0),this.blendAlpha=0,this.depthFunc=x_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=SB,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=wp,this.stencilZFail=wp,this.stencilZPass=wp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const n=e[i];if(n===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const r=this[i];if(r===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[i]=n}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==qp&&(n.blending=this.blending),this.side!==yu&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==WC&&(n.blendSrc=this.blendSrc),this.blendDst!==HC&&(n.blendDst=this.blendDst),this.blendEquation!==Rd&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==x_&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==SB&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==wp&&(n.stencilFail=this.stencilFail),this.stencilZFail!==wp&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==wp&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(o){const a=[];for(const l in o){const h=o[l];delete h.metadata,a.push(h)}return a}if(i){const o=r(e.textures),a=r(e.images);o.length>0&&(n.textures=o),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let n=null;if(i!==null){const r=i.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=i[o].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class lc extends no{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new To,this.combine=bb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Yh=VCe();function VCe(){const s=new ArrayBuffer(4),e=new Float32Array(s),i=new Uint32Array(s),n=new Uint32Array(512),r=new Uint32Array(512);for(let h=0;h<256;++h){const d=h-127;d<-27?(n[h]=0,n[h|256]=32768,r[h]=24,r[h|256]=24):d<-14?(n[h]=1024>>-d-14,n[h|256]=1024>>-d-14|32768,r[h]=-d-1,r[h|256]=-d-1):d<=15?(n[h]=d+15<<10,n[h|256]=d+15<<10|32768,r[h]=13,r[h|256]=13):d<128?(n[h]=31744,n[h|256]=64512,r[h]=24,r[h|256]=24):(n[h]=31744,n[h|256]=64512,r[h]=13,r[h|256]=13)}const o=new Uint32Array(2048),a=new Uint32Array(64),l=new Uint32Array(64);for(let h=1;h<1024;++h){let d=h<<13,f=0;for(;!(d&8388608);)d<<=1,f-=8388608;d&=-8388609,f+=947912704,o[h]=d|f}for(let h=1024;h<2048;++h)o[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)a[h]=h<<23;a[31]=1199570944,a[32]=2147483648;for(let h=33;h<63;++h)a[h]=2147483648+(h-32<<23);a[63]=3347054592;for(let h=1;h<64;++h)h!==32&&(l[h]=1024);return{floatView:e,uint32View:i,baseTable:n,shiftTable:r,mantissaTable:o,exponentTable:a,offsetTable:l}}function No(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=Ms(s,-65504,65504),Yh.floatView[0]=s;const e=Yh.uint32View[0],i=e>>23&511;return Yh.baseTable[i]+((e&8388607)>>Yh.shiftTable[i])}function Ex(s){const e=s>>10;return Yh.uint32View[0]=Yh.mantissaTable[Yh.offsetTable[e]+(s&1023)]+Yh.exponentTable[e],Yh.floatView[0]}const $Ce={toHalfFloat:No,fromHalfFloat:Ex},Ns=new ie,B1=new Fe;class rn{constructor(e,i,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=n,this.usage=T_,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=hl,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return rY("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,n){e*=this.itemSize,n*=i.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=i.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)B1.fromBufferAttribute(this,i),B1.applyMatrix3(e),this.setXY(i,B1.x,B1.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)Ns.fromBufferAttribute(this,i),Ns.applyMatrix3(e),this.setXYZ(i,Ns.x,Ns.y,Ns.z);return this}applyMatrix4(e){for(let i=0,n=this.count;i<n;i++)Ns.fromBufferAttribute(this,i),Ns.applyMatrix4(e),this.setXYZ(i,Ns.x,Ns.y,Ns.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)Ns.fromBufferAttribute(this,i),Ns.applyNormalMatrix(e),this.setXYZ(i,Ns.x,Ns.y,Ns.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)Ns.fromBufferAttribute(this,i),Ns.transformDirection(e),this.setXYZ(i,Ns.x,Ns.y,Ns.z);return this}set(e,i=0){return this.array.set(e,i),this}getComponent(e,i){let n=this.array[e*this.itemSize+i];return this.normalized&&(n=xo(n,this.array)),n}setComponent(e,i,n){return this.normalized&&(n=Vi(n,this.array)),this.array[e*this.itemSize+i]=n,this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=xo(i,this.array)),i}setX(e,i){return this.normalized&&(i=Vi(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=xo(i,this.array)),i}setY(e,i){return this.normalized&&(i=Vi(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=xo(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Vi(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=xo(i,this.array)),i}setW(e,i){return this.normalized&&(i=Vi(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=Vi(i,this.array),n=Vi(n,this.array)),this.array[e+0]=i,this.array[e+1]=n,this}setXYZ(e,i,n,r){return e*=this.itemSize,this.normalized&&(i=Vi(i,this.array),n=Vi(n,this.array),r=Vi(r,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,i,n,r,o){return e*=this.itemSize,this.normalized&&(i=Vi(i,this.array),n=Vi(n,this.array),r=Vi(r,this.array),o=Vi(o,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==T_&&(e.usage=this.usage),e}}class UCe extends rn{constructor(e,i,n){super(new Int8Array(e),i,n)}}class FCe extends rn{constructor(e,i,n){super(new Uint8Array(e),i,n)}}class zCe extends rn{constructor(e,i,n){super(new Uint8ClampedArray(e),i,n)}}class XCe extends rn{constructor(e,i,n){super(new Int16Array(e),i,n)}}class oL extends rn{constructor(e,i,n){super(new Uint16Array(e),i,n)}}class WCe extends rn{constructor(e,i,n){super(new Int32Array(e),i,n)}}class aL extends rn{constructor(e,i,n){super(new Uint32Array(e),i,n)}}class HCe extends rn{constructor(e,i,n){super(new Uint16Array(e),i,n),this.isFloat16BufferAttribute=!0}getX(e){let i=Ex(this.array[e*this.itemSize]);return this.normalized&&(i=xo(i,this.array)),i}setX(e,i){return this.normalized&&(i=Vi(i,this.array)),this.array[e*this.itemSize]=No(i),this}getY(e){let i=Ex(this.array[e*this.itemSize+1]);return this.normalized&&(i=xo(i,this.array)),i}setY(e,i){return this.normalized&&(i=Vi(i,this.array)),this.array[e*this.itemSize+1]=No(i),this}getZ(e){let i=Ex(this.array[e*this.itemSize+2]);return this.normalized&&(i=xo(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Vi(i,this.array)),this.array[e*this.itemSize+2]=No(i),this}getW(e){let i=Ex(this.array[e*this.itemSize+3]);return this.normalized&&(i=xo(i,this.array)),i}setW(e,i){return this.normalized&&(i=Vi(i,this.array)),this.array[e*this.itemSize+3]=No(i),this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=Vi(i,this.array),n=Vi(n,this.array)),this.array[e+0]=No(i),this.array[e+1]=No(n),this}setXYZ(e,i,n,r){return e*=this.itemSize,this.normalized&&(i=Vi(i,this.array),n=Vi(n,this.array),r=Vi(r,this.array)),this.array[e+0]=No(i),this.array[e+1]=No(n),this.array[e+2]=No(r),this}setXYZW(e,i,n,r,o){return e*=this.itemSize,this.normalized&&(i=Vi(i,this.array),n=Vi(n,this.array),r=Vi(r,this.array),o=Vi(o,this.array)),this.array[e+0]=No(i),this.array[e+1]=No(n),this.array[e+2]=No(r),this.array[e+3]=No(o),this}}class Ut extends rn{constructor(e,i,n){super(new Float32Array(e),i,n)}}let GCe=0;const Ya=new ri,Zk=new vn,xg=new ie,ga=new Nr,Nv=new Nr,gr=new ie;class $i extends ch{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:GCe++}),this.uuid=La(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(nY(e)?aL:oL)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,n=0){this.groups.push({start:e,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new Ni().getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ya.makeRotationFromQuaternion(e),this.applyMatrix4(Ya),this}rotateX(e){return Ya.makeRotationX(e),this.applyMatrix4(Ya),this}rotateY(e){return Ya.makeRotationY(e),this.applyMatrix4(Ya),this}rotateZ(e){return Ya.makeRotationZ(e),this.applyMatrix4(Ya),this}translate(e,i,n){return Ya.makeTranslation(e,i,n),this.applyMatrix4(Ya),this}scale(e,i,n){return Ya.makeScale(e,i,n),this.applyMatrix4(Ya),this}lookAt(e){return Zk.lookAt(e),Zk.updateMatrix(),this.applyMatrix4(Zk.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(xg).negate(),this.translate(xg.x,xg.y,xg.z),this}setFromPoints(e){const i=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];i.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Ut(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Nr);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ie(-1/0,-1/0,-1/0),new ie(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let n=0,r=i.length;n<r;n++){const o=i[n];ga.setFromBufferAttribute(o),this.morphTargetsRelative?(gr.addVectors(this.boundingBox.min,ga.min),this.boundingBox.expandByPoint(gr),gr.addVectors(this.boundingBox.max,ga.max),this.boundingBox.expandByPoint(gr)):(this.boundingBox.expandByPoint(ga.min),this.boundingBox.expandByPoint(ga.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Vr);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ie,1/0);return}if(e){const n=this.boundingSphere.center;if(ga.setFromBufferAttribute(e),i)for(let o=0,a=i.length;o<a;o++){const l=i[o];Nv.setFromBufferAttribute(l),this.morphTargetsRelative?(gr.addVectors(ga.min,Nv.min),ga.expandByPoint(gr),gr.addVectors(ga.max,Nv.max),ga.expandByPoint(gr)):(ga.expandByPoint(Nv.min),ga.expandByPoint(Nv.max))}ga.getCenter(n);let r=0;for(let o=0,a=e.count;o<a;o++)gr.fromBufferAttribute(e,o),r=Math.max(r,n.distanceToSquared(gr));if(i)for(let o=0,a=i.length;o<a;o++){const l=i[o],h=this.morphTargetsRelative;for(let d=0,f=l.count;d<f;d++)gr.fromBufferAttribute(l,d),h&&(xg.fromBufferAttribute(e,d),gr.add(xg)),r=Math.max(r,n.distanceToSquared(gr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=i.position,r=i.normal,o=i.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new rn(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),l=[],h=[];for(let P=0;P<n.count;P++)l[P]=new ie,h[P]=new ie;const d=new ie,f=new ie,p=new ie,g=new Fe,y=new Fe,x=new Fe,_=new ie,w=new ie;function O(P,k,E){d.fromBufferAttribute(n,P),f.fromBufferAttribute(n,k),p.fromBufferAttribute(n,E),g.fromBufferAttribute(o,P),y.fromBufferAttribute(o,k),x.fromBufferAttribute(o,E),f.sub(d),p.sub(d),y.sub(g),x.sub(g);const D=1/(y.x*x.y-x.x*y.y);isFinite(D)&&(_.copy(f).multiplyScalar(x.y).addScaledVector(p,-y.y).multiplyScalar(D),w.copy(p).multiplyScalar(y.x).addScaledVector(f,-x.x).multiplyScalar(D),l[P].add(_),l[k].add(_),l[E].add(_),h[P].add(w),h[k].add(w),h[E].add(w))}let T=this.groups;T.length===0&&(T=[{start:0,count:e.count}]);for(let P=0,k=T.length;P<k;++P){const E=T[P],D=E.start,L=E.count;for(let V=D,F=D+L;V<F;V+=3)O(e.getX(V+0),e.getX(V+1),e.getX(V+2))}const C=new ie,A=new ie,B=new ie,I=new ie;function R(P){B.fromBufferAttribute(r,P),I.copy(B);const k=l[P];C.copy(k),C.sub(B.multiplyScalar(B.dot(k))).normalize(),A.crossVectors(I,k);const D=A.dot(h[P])<0?-1:1;a.setXYZW(P,C.x,C.y,C.z,D)}for(let P=0,k=T.length;P<k;++P){const E=T[P],D=E.start,L=E.count;for(let V=D,F=D+L;V<F;V+=3)R(e.getX(V+0)),R(e.getX(V+1)),R(e.getX(V+2))}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new rn(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let g=0,y=n.count;g<y;g++)n.setXYZ(g,0,0,0);const r=new ie,o=new ie,a=new ie,l=new ie,h=new ie,d=new ie,f=new ie,p=new ie;if(e)for(let g=0,y=e.count;g<y;g+=3){const x=e.getX(g+0),_=e.getX(g+1),w=e.getX(g+2);r.fromBufferAttribute(i,x),o.fromBufferAttribute(i,_),a.fromBufferAttribute(i,w),f.subVectors(a,o),p.subVectors(r,o),f.cross(p),l.fromBufferAttribute(n,x),h.fromBufferAttribute(n,_),d.fromBufferAttribute(n,w),l.add(f),h.add(f),d.add(f),n.setXYZ(x,l.x,l.y,l.z),n.setXYZ(_,h.x,h.y,h.z),n.setXYZ(w,d.x,d.y,d.z)}else for(let g=0,y=i.count;g<y;g+=3)r.fromBufferAttribute(i,g+0),o.fromBufferAttribute(i,g+1),a.fromBufferAttribute(i,g+2),f.subVectors(a,o),p.subVectors(r,o),f.cross(p),n.setXYZ(g+0,f.x,f.y,f.z),n.setXYZ(g+1,f.x,f.y,f.z),n.setXYZ(g+2,f.x,f.y,f.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,n=e.count;i<n;i++)gr.fromBufferAttribute(e,i),gr.normalize(),e.setXYZ(i,gr.x,gr.y,gr.z)}toNonIndexed(){function e(l,h){const d=l.array,f=l.itemSize,p=l.normalized,g=new d.constructor(h.length*f);let y=0,x=0;for(let _=0,w=h.length;_<w;_++){l.isInterleavedBufferAttribute?y=h[_]*l.data.stride+l.offset:y=h[_]*f;for(let O=0;O<f;O++)g[x++]=d[y++]}return new rn(g,f,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new $i,n=this.index.array,r=this.attributes;for(const l in r){const h=r[l],d=e(h,n);i.setAttribute(l,d)}const o=this.morphAttributes;for(const l in o){const h=[],d=o[l];for(let f=0,p=d.length;f<p;f++){const g=d[f],y=e(g,n);h.push(y)}i.morphAttributes[l]=h}i.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,h=a.length;l<h;l++){const d=a[l];i.addGroup(d.start,d.count,d.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const d in h)h[d]!==void 0&&(e[d]=h[d]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const h in n){const d=n[h];e.data.attributes[h]=d.toJSON(e.data)}const r={};let o=!1;for(const h in this.morphAttributes){const d=this.morphAttributes[h],f=[];for(let p=0,g=d.length;p<g;p++){const y=d[p];f.push(y.toJSON(e.data))}f.length>0&&(r[h]=f,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(i));const r=e.attributes;for(const d in r){const f=r[d];this.setAttribute(d,f.clone(i))}const o=e.morphAttributes;for(const d in o){const f=[],p=o[d];for(let g=0,y=p.length;g<y;g++)f.push(p[g].clone(i));this.morphAttributes[d]=f}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let d=0,f=a.length;d<f;d++){const p=a[d];this.addGroup(p.start,p.count,p.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const z4=new ri,Gf=new km,R1=new Vr,X4=new ie,_g=new ie,bg=new ie,wg=new ie,Kk=new ie,D1=new ie,L1=new Fe,N1=new Fe,V1=new Fe,W4=new ie,H4=new ie,G4=new ie,$1=new ie,U1=new ie;class Dn extends vn{constructor(e=new $i,i=new lc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=r.length;o<a;o++){const l=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}getVertexPosition(e,i){const n=this.geometry,r=n.attributes.position,o=n.morphAttributes.position,a=n.morphTargetsRelative;i.fromBufferAttribute(r,e);const l=this.morphTargetInfluences;if(o&&l){D1.set(0,0,0);for(let h=0,d=o.length;h<d;h++){const f=l[h],p=o[h];f!==0&&(Kk.fromBufferAttribute(p,e),a?D1.addScaledVector(Kk,f):D1.addScaledVector(Kk.sub(i),f))}i.add(D1)}return i}raycast(e,i){const n=this.geometry,r=this.material,o=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),R1.copy(n.boundingSphere),R1.applyMatrix4(o),Gf.copy(e.ray).recast(e.near),!(R1.containsPoint(Gf.origin)===!1&&(Gf.intersectSphere(R1,X4)===null||Gf.origin.distanceToSquared(X4)>(e.far-e.near)**2))&&(z4.copy(o).invert(),Gf.copy(e.ray).applyMatrix4(z4),!(n.boundingBox!==null&&Gf.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,i,Gf)))}_computeIntersections(e,i,n){let r;const o=this.geometry,a=this.material,l=o.index,h=o.attributes.position,d=o.attributes.uv,f=o.attributes.uv1,p=o.attributes.normal,g=o.groups,y=o.drawRange;if(l!==null)if(Array.isArray(a))for(let x=0,_=g.length;x<_;x++){const w=g[x],O=a[w.materialIndex],T=Math.max(w.start,y.start),C=Math.min(l.count,Math.min(w.start+w.count,y.start+y.count));for(let A=T,B=C;A<B;A+=3){const I=l.getX(A),R=l.getX(A+1),P=l.getX(A+2);r=F1(this,O,e,n,d,f,p,I,R,P),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=w.materialIndex,i.push(r))}}else{const x=Math.max(0,y.start),_=Math.min(l.count,y.start+y.count);for(let w=x,O=_;w<O;w+=3){const T=l.getX(w),C=l.getX(w+1),A=l.getX(w+2);r=F1(this,a,e,n,d,f,p,T,C,A),r&&(r.faceIndex=Math.floor(w/3),i.push(r))}}else if(h!==void 0)if(Array.isArray(a))for(let x=0,_=g.length;x<_;x++){const w=g[x],O=a[w.materialIndex],T=Math.max(w.start,y.start),C=Math.min(h.count,Math.min(w.start+w.count,y.start+y.count));for(let A=T,B=C;A<B;A+=3){const I=A,R=A+1,P=A+2;r=F1(this,O,e,n,d,f,p,I,R,P),r&&(r.faceIndex=Math.floor(A/3),r.face.materialIndex=w.materialIndex,i.push(r))}}else{const x=Math.max(0,y.start),_=Math.min(h.count,y.start+y.count);for(let w=x,O=_;w<O;w+=3){const T=w,C=w+1,A=w+2;r=F1(this,a,e,n,d,f,p,T,C,A),r&&(r.faceIndex=Math.floor(w/3),i.push(r))}}}}function QCe(s,e,i,n,r,o,a,l){let h;if(e.side===qr?h=n.intersectTriangle(a,o,r,!0,l):h=n.intersectTriangle(r,o,a,e.side===yu,l),h===null)return null;U1.copy(l),U1.applyMatrix4(s.matrixWorld);const d=i.ray.origin.distanceTo(U1);return d<i.near||d>i.far?null:{distance:d,point:U1.clone(),object:s}}function F1(s,e,i,n,r,o,a,l,h,d){s.getVertexPosition(l,_g),s.getVertexPosition(h,bg),s.getVertexPosition(d,wg);const f=QCe(s,e,i,n,_g,bg,wg,$1);if(f){r&&(L1.fromBufferAttribute(r,l),N1.fromBufferAttribute(r,h),V1.fromBufferAttribute(r,d),f.uv=Ho.getInterpolation($1,_g,bg,wg,L1,N1,V1,new Fe)),o&&(L1.fromBufferAttribute(o,l),N1.fromBufferAttribute(o,h),V1.fromBufferAttribute(o,d),f.uv1=Ho.getInterpolation($1,_g,bg,wg,L1,N1,V1,new Fe)),a&&(W4.fromBufferAttribute(a,l),H4.fromBufferAttribute(a,h),G4.fromBufferAttribute(a,d),f.normal=Ho.getInterpolation($1,_g,bg,wg,W4,H4,G4,new ie),f.normal.dot(n.direction)>0&&f.normal.multiplyScalar(-1));const p={a:l,b:h,c:d,normal:new ie,materialIndex:0};Ho.getNormal(_g,bg,wg,p.normal),f.face=p}return f}class xf extends $i{constructor(e=1,i=1,n=1,r=1,o=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:n,widthSegments:r,heightSegments:o,depthSegments:a};const l=this;r=Math.floor(r),o=Math.floor(o),a=Math.floor(a);const h=[],d=[],f=[],p=[];let g=0,y=0;x("z","y","x",-1,-1,n,i,e,a,o,0),x("z","y","x",1,-1,n,i,-e,a,o,1),x("x","z","y",1,1,e,n,i,r,a,2),x("x","z","y",1,-1,e,n,-i,r,a,3),x("x","y","z",1,-1,e,i,n,r,o,4),x("x","y","z",-1,-1,e,i,-n,r,o,5),this.setIndex(h),this.setAttribute("position",new Ut(d,3)),this.setAttribute("normal",new Ut(f,3)),this.setAttribute("uv",new Ut(p,2));function x(_,w,O,T,C,A,B,I,R,P,k){const E=A/R,D=B/P,L=A/2,V=B/2,F=I/2,j=R+1,Q=P+1;let ee=0,J=0;const ue=new ie;for(let oe=0;oe<Q;oe++){const pe=oe*D-V;for(let Ue=0;Ue<j;Ue++){const tt=Ue*E-L;ue[_]=tt*T,ue[w]=pe*C,ue[O]=F,d.push(ue.x,ue.y,ue.z),ue[_]=0,ue[w]=0,ue[O]=I>0?1:-1,f.push(ue.x,ue.y,ue.z),p.push(Ue/R),p.push(1-oe/P),ee+=1}}for(let oe=0;oe<P;oe++)for(let pe=0;pe<R;pe++){const Ue=g+pe+j*oe,tt=g+pe+j*(oe+1),ve=g+(pe+1)+j*(oe+1),Re=g+(pe+1)+j*oe;h.push(Ue,tt,Re),h.push(tt,ve,Re),J+=6}l.addGroup(y,J,k),y+=J,g+=ee}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xf(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function uy(s){const e={};for(const i in s){e[i]={};for(const n in s[i]){const r=s[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][n]=null):e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}function vo(s){const e={};for(let i=0;i<s.length;i++){const n=uy(s[i]);for(const r in n)e[r]=n[r]}return e}function YCe(s){const e=[];for(let i=0;i<s.length;i++)e.push(s[i].clone());return e}function cY(s){const e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Mn.workingColorSpace}const Ob={clone:uy,merge:vo};var jCe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,qCe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ao extends no{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=jCe,this.fragmentShader=qCe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=uy(e.uniforms),this.uniformsGroups=YCe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?i.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?i.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?i.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?i.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?i.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?i.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?i.uniforms[r]={type:"m4",value:a.toArray()}:i.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(i.extensions=n),i}}class Sb extends vn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ri,this.projectionMatrix=new ri,this.projectionMatrixInverse=new ri,this.coordinateSystem=Qc}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const od=new ie,Q4=new Fe,Y4=new Fe;class Rn extends Sb{constructor(e=50,i=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=cy*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Kp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return cy*2*Math.atan(Math.tan(Kp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,i,n){od.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(od.x,od.y).multiplyScalar(-e/od.z),od.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(od.x,od.y).multiplyScalar(-e/od.z)}getViewSize(e,i){return this.getViewBounds(e,Q4,Y4),i.subVectors(Y4,Q4)}setViewOffset(e,i,n,r,o,a){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(Kp*.5*this.fov)/this.zoom,n=2*i,r=this.aspect*n,o=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const h=a.fullWidth,d=a.fullHeight;o+=a.offsetX*r/h,i-=a.offsetY*n/d,r*=a.width/h,n*=a.height/d}const l=this.filmOffset;l!==0&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,i,i-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const Og=-90,Sg=1;class hY extends vn{constructor(e,i,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Rn(Og,Sg,e,i);r.layers=this.layers,this.add(r);const o=new Rn(Og,Sg,e,i);o.layers=this.layers,this.add(o);const a=new Rn(Og,Sg,e,i);a.layers=this.layers,this.add(a);const l=new Rn(Og,Sg,e,i);l.layers=this.layers,this.add(l);const h=new Rn(Og,Sg,e,i);h.layers=this.layers,this.add(h);const d=new Rn(Og,Sg,e,i);d.layers=this.layers,this.add(d)}updateCoordinateSystem(){const e=this.coordinateSystem,i=this.children.concat(),[n,r,o,a,l,h]=i;for(const d of i)this.remove(d);if(e===Qc)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(e===A_)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const d of i)this.add(d),d.updateMatrixWorld()}update(e,i){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,a,l,h,d,f]=this.children,p=e.getRenderTarget(),g=e.getActiveCubeFace(),y=e.getActiveMipmapLevel(),x=e.xr.enabled;e.xr.enabled=!1;const _=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(i,o),e.setRenderTarget(n,1,r),e.render(i,a),e.setRenderTarget(n,2,r),e.render(i,l),e.setRenderTarget(n,3,r),e.render(i,h),e.setRenderTarget(n,4,r),e.render(i,d),n.texture.generateMipmaps=_,e.setRenderTarget(n,5,r),e.render(i,f),e.setRenderTarget(p,g,y),e.xr.enabled=x,n.texture.needsPMREMUpdate=!0}}class Cb extends cs{constructor(e,i,n,r,o,a,l,h,d,f){e=e!==void 0?e:[],i=i!==void 0?i:vu,super(e,i,n,r,o,a,l,h,d,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class uY extends gl{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Cb(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Bs}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new xf(5,5,5),o=new Ao({name:"CubemapFromEquirect",uniforms:uy(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:qr,blending:lu});o.uniforms.tEquirect.value=i;const a=new Dn(r,o),l=i.minFilter;return i.minFilter===Gl&&(i.minFilter=Bs),new hY(1,10,this).update(e,a),i.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,i,n,r){const o=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(i,n,r);e.setRenderTarget(o)}}const Jk=new ie,ZCe=new ie,KCe=new Ni;class Xl{constructor(e=new ie(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,n,r){return this.normal.set(e,i,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,n){const r=Jk.subVectors(n,i).cross(ZCe.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){const n=e.delta(Jk),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:i.copy(e.start).addScaledVector(n,o)}intersectsLine(e){const i=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return i<0&&n>0||n<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const n=i||KCe.getNormalMatrix(e),r=this.coplanarPoint(Jk).applyMatrix4(e),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Qf=new Vr,z1=new ie;class Tb{constructor(e=new Xl,i=new Xl,n=new Xl,r=new Xl,o=new Xl,a=new Xl){this.planes=[e,i,n,r,o,a]}set(e,i,n,r,o,a){const l=this.planes;return l[0].copy(e),l[1].copy(i),l[2].copy(n),l[3].copy(r),l[4].copy(o),l[5].copy(a),this}copy(e){const i=this.planes;for(let n=0;n<6;n++)i[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,i=Qc){const n=this.planes,r=e.elements,o=r[0],a=r[1],l=r[2],h=r[3],d=r[4],f=r[5],p=r[6],g=r[7],y=r[8],x=r[9],_=r[10],w=r[11],O=r[12],T=r[13],C=r[14],A=r[15];if(n[0].setComponents(h-o,g-d,w-y,A-O).normalize(),n[1].setComponents(h+o,g+d,w+y,A+O).normalize(),n[2].setComponents(h+a,g+f,w+x,A+T).normalize(),n[3].setComponents(h-a,g-f,w-x,A-T).normalize(),n[4].setComponents(h-l,g-p,w-_,A-C).normalize(),i===Qc)n[5].setComponents(h+l,g+p,w+_,A+C).normalize();else if(i===A_)n[5].setComponents(l,p,_,C).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Qf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const i=e.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),Qf.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Qf)}intersectsSprite(e){return Qf.center.set(0,0,0),Qf.radius=.7071067811865476,Qf.applyMatrix4(e.matrixWorld),this.intersectsSphere(Qf)}intersectsSphere(e){const i=this.planes,n=e.center,r=-e.radius;for(let o=0;o<6;o++)if(i[o].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const i=this.planes;for(let n=0;n<6;n++){const r=i[n];if(z1.x=r.normal.x>0?e.max.x:e.min.x,z1.y=r.normal.y>0?e.max.y:e.min.y,z1.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(z1)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let n=0;n<6;n++)if(i[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function dY(){let s=null,e=!1,i=null,n=null;function r(o,a){i(o,a),n=s.requestAnimationFrame(r)}return{start:function(){e!==!0&&i!==null&&(n=s.requestAnimationFrame(r),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(o){i=o},setContext:function(o){s=o}}}function JCe(s){const e=new WeakMap;function i(l,h){const d=l.array,f=l.usage,p=d.byteLength,g=s.createBuffer();s.bindBuffer(h,g),s.bufferData(h,d,f),l.onUploadCallback();let y;if(d instanceof Float32Array)y=s.FLOAT;else if(d instanceof Uint16Array)l.isFloat16BufferAttribute?y=s.HALF_FLOAT:y=s.UNSIGNED_SHORT;else if(d instanceof Int16Array)y=s.SHORT;else if(d instanceof Uint32Array)y=s.UNSIGNED_INT;else if(d instanceof Int32Array)y=s.INT;else if(d instanceof Int8Array)y=s.BYTE;else if(d instanceof Uint8Array)y=s.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)y=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:g,type:y,bytesPerElement:d.BYTES_PER_ELEMENT,version:l.version,size:p}}function n(l,h,d){const f=h.array,p=h._updateRange,g=h.updateRanges;if(s.bindBuffer(d,l),p.count===-1&&g.length===0&&s.bufferSubData(d,0,f),g.length!==0){for(let y=0,x=g.length;y<x;y++){const _=g[y];s.bufferSubData(d,_.start*f.BYTES_PER_ELEMENT,f,_.start,_.count)}h.clearUpdateRanges()}p.count!==-1&&(s.bufferSubData(d,p.offset*f.BYTES_PER_ELEMENT,f,p.offset,p.count),p.count=-1),h.onUploadCallback()}function r(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function o(l){l.isInterleavedBufferAttribute&&(l=l.data);const h=e.get(l);h&&(s.deleteBuffer(h.buffer),e.delete(l))}function a(l,h){if(l.isGLBufferAttribute){const f=e.get(l);(!f||f.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}l.isInterleavedBufferAttribute&&(l=l.data);const d=e.get(l);if(d===void 0)e.set(l,i(l,h));else if(d.version<l.version){if(d.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(d.buffer,l,h),d.version=l.version}}return{get:r,remove:o,update:a}}class _f extends $i{constructor(e=1,i=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:n,heightSegments:r};const o=e/2,a=i/2,l=Math.floor(n),h=Math.floor(r),d=l+1,f=h+1,p=e/l,g=i/h,y=[],x=[],_=[],w=[];for(let O=0;O<f;O++){const T=O*g-a;for(let C=0;C<d;C++){const A=C*p-o;x.push(A,-T,0),_.push(0,0,1),w.push(C/l),w.push(1-O/h)}}for(let O=0;O<h;O++)for(let T=0;T<l;T++){const C=T+d*O,A=T+d*(O+1),B=T+1+d*(O+1),I=T+1+d*O;y.push(C,A,I),y.push(A,B,I)}this.setIndex(y),this.setAttribute("position",new Ut(x,3)),this.setAttribute("normal",new Ut(_,3)),this.setAttribute("uv",new Ut(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _f(e.width,e.height,e.widthSegments,e.heightSegments)}}var eTe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,tTe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,iTe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,nTe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,sTe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,rTe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,oTe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aTe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,lTe=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,cTe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,hTe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,uTe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,dTe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,fTe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,pTe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,mTe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,gTe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,yTe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,vTe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,xTe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,_Te=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,bTe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,wTe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,OTe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,STe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,CTe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,TTe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,ATe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,ETe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,MTe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,kTe="gl_FragColor = linearToOutputTexel( gl_FragColor );",PTe=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,ITe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,BTe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,RTe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,DTe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,LTe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,NTe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,VTe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,$Te=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,UTe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,FTe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,zTe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,XTe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,WTe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,HTe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,GTe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,QTe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,YTe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,jTe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,qTe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,ZTe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,KTe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,JTe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,eAe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,tAe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,iAe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,nAe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,sAe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,rAe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,oAe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,aAe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,lAe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,cAe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,hAe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,uAe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,dAe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,fAe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,pAe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,mAe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,gAe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,yAe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,vAe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,xAe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,_Ae=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,bAe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,wAe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,OAe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,SAe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,CAe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,TAe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,AAe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,EAe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,MAe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,kAe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,PAe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,IAe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,BAe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,RAe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,DAe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,LAe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,NAe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,VAe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,$Ae=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,UAe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,FAe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,zAe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,XAe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,WAe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,HAe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,GAe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,QAe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,YAe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,jAe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,qAe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,ZAe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,KAe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const JAe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,eEe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,tEe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,iEe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nEe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,sEe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rEe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,oEe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,aEe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,lEe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,cEe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,hEe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,uEe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dEe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,fEe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,pEe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mEe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gEe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yEe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,vEe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xEe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,_Ee=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,bEe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wEe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,OEe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,SEe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,CEe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,TEe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,AEe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,EEe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,MEe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kEe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,PEe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,IEe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Ui={alphahash_fragment:eTe,alphahash_pars_fragment:tTe,alphamap_fragment:iTe,alphamap_pars_fragment:nTe,alphatest_fragment:sTe,alphatest_pars_fragment:rTe,aomap_fragment:oTe,aomap_pars_fragment:aTe,batching_pars_vertex:lTe,batching_vertex:cTe,begin_vertex:hTe,beginnormal_vertex:uTe,bsdfs:dTe,iridescence_fragment:fTe,bumpmap_pars_fragment:pTe,clipping_planes_fragment:mTe,clipping_planes_pars_fragment:gTe,clipping_planes_pars_vertex:yTe,clipping_planes_vertex:vTe,color_fragment:xTe,color_pars_fragment:_Te,color_pars_vertex:bTe,color_vertex:wTe,common:OTe,cube_uv_reflection_fragment:STe,defaultnormal_vertex:CTe,displacementmap_pars_vertex:TTe,displacementmap_vertex:ATe,emissivemap_fragment:ETe,emissivemap_pars_fragment:MTe,colorspace_fragment:kTe,colorspace_pars_fragment:PTe,envmap_fragment:ITe,envmap_common_pars_fragment:BTe,envmap_pars_fragment:RTe,envmap_pars_vertex:DTe,envmap_physical_pars_fragment:GTe,envmap_vertex:LTe,fog_vertex:NTe,fog_pars_vertex:VTe,fog_fragment:$Te,fog_pars_fragment:UTe,gradientmap_pars_fragment:FTe,lightmap_pars_fragment:zTe,lights_lambert_fragment:XTe,lights_lambert_pars_fragment:WTe,lights_pars_begin:HTe,lights_toon_fragment:QTe,lights_toon_pars_fragment:YTe,lights_phong_fragment:jTe,lights_phong_pars_fragment:qTe,lights_physical_fragment:ZTe,lights_physical_pars_fragment:KTe,lights_fragment_begin:JTe,lights_fragment_maps:eAe,lights_fragment_end:tAe,logdepthbuf_fragment:iAe,logdepthbuf_pars_fragment:nAe,logdepthbuf_pars_vertex:sAe,logdepthbuf_vertex:rAe,map_fragment:oAe,map_pars_fragment:aAe,map_particle_fragment:lAe,map_particle_pars_fragment:cAe,metalnessmap_fragment:hAe,metalnessmap_pars_fragment:uAe,morphinstance_vertex:dAe,morphcolor_vertex:fAe,morphnormal_vertex:pAe,morphtarget_pars_vertex:mAe,morphtarget_vertex:gAe,normal_fragment_begin:yAe,normal_fragment_maps:vAe,normal_pars_fragment:xAe,normal_pars_vertex:_Ae,normal_vertex:bAe,normalmap_pars_fragment:wAe,clearcoat_normal_fragment_begin:OAe,clearcoat_normal_fragment_maps:SAe,clearcoat_pars_fragment:CAe,iridescence_pars_fragment:TAe,opaque_fragment:AAe,packing:EAe,premultiplied_alpha_fragment:MAe,project_vertex:kAe,dithering_fragment:PAe,dithering_pars_fragment:IAe,roughnessmap_fragment:BAe,roughnessmap_pars_fragment:RAe,shadowmap_pars_fragment:DAe,shadowmap_pars_vertex:LAe,shadowmap_vertex:NAe,shadowmask_pars_fragment:VAe,skinbase_vertex:$Ae,skinning_pars_vertex:UAe,skinning_vertex:FAe,skinnormal_vertex:zAe,specularmap_fragment:XAe,specularmap_pars_fragment:WAe,tonemapping_fragment:HAe,tonemapping_pars_fragment:GAe,transmission_fragment:QAe,transmission_pars_fragment:YAe,uv_pars_fragment:jAe,uv_pars_vertex:qAe,uv_vertex:ZAe,worldpos_vertex:KAe,background_vert:JAe,background_frag:eEe,backgroundCube_vert:tEe,backgroundCube_frag:iEe,cube_vert:nEe,cube_frag:sEe,depth_vert:rEe,depth_frag:oEe,distanceRGBA_vert:aEe,distanceRGBA_frag:lEe,equirect_vert:cEe,equirect_frag:hEe,linedashed_vert:uEe,linedashed_frag:dEe,meshbasic_vert:fEe,meshbasic_frag:pEe,meshlambert_vert:mEe,meshlambert_frag:gEe,meshmatcap_vert:yEe,meshmatcap_frag:vEe,meshnormal_vert:xEe,meshnormal_frag:_Ee,meshphong_vert:bEe,meshphong_frag:wEe,meshphysical_vert:OEe,meshphysical_frag:SEe,meshtoon_vert:CEe,meshtoon_frag:TEe,points_vert:AEe,points_frag:EEe,shadow_vert:MEe,shadow_frag:kEe,sprite_vert:PEe,sprite_frag:IEe},ct={common:{diffuse:{value:new ft(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ni},alphaMap:{value:null},alphaMapTransform:{value:new Ni},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ni}},envmap:{envMap:{value:null},envMapRotation:{value:new Ni},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ni}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ni}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ni},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ni},normalScale:{value:new Fe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ni},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ni}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ni}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ni}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ft(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ft(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ni},alphaTest:{value:0},uvTransform:{value:new Ni}},sprite:{diffuse:{value:new ft(16777215)},opacity:{value:1},center:{value:new Fe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ni},alphaMap:{value:null},alphaMapTransform:{value:new Ni},alphaTest:{value:0}}},rl={basic:{uniforms:vo([ct.common,ct.specularmap,ct.envmap,ct.aomap,ct.lightmap,ct.fog]),vertexShader:Ui.meshbasic_vert,fragmentShader:Ui.meshbasic_frag},lambert:{uniforms:vo([ct.common,ct.specularmap,ct.envmap,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.fog,ct.lights,{emissive:{value:new ft(0)}}]),vertexShader:Ui.meshlambert_vert,fragmentShader:Ui.meshlambert_frag},phong:{uniforms:vo([ct.common,ct.specularmap,ct.envmap,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.fog,ct.lights,{emissive:{value:new ft(0)},specular:{value:new ft(1118481)},shininess:{value:30}}]),vertexShader:Ui.meshphong_vert,fragmentShader:Ui.meshphong_frag},standard:{uniforms:vo([ct.common,ct.envmap,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.roughnessmap,ct.metalnessmap,ct.fog,ct.lights,{emissive:{value:new ft(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ui.meshphysical_vert,fragmentShader:Ui.meshphysical_frag},toon:{uniforms:vo([ct.common,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.gradientmap,ct.fog,ct.lights,{emissive:{value:new ft(0)}}]),vertexShader:Ui.meshtoon_vert,fragmentShader:Ui.meshtoon_frag},matcap:{uniforms:vo([ct.common,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.fog,{matcap:{value:null}}]),vertexShader:Ui.meshmatcap_vert,fragmentShader:Ui.meshmatcap_frag},points:{uniforms:vo([ct.points,ct.fog]),vertexShader:Ui.points_vert,fragmentShader:Ui.points_frag},dashed:{uniforms:vo([ct.common,ct.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ui.linedashed_vert,fragmentShader:Ui.linedashed_frag},depth:{uniforms:vo([ct.common,ct.displacementmap]),vertexShader:Ui.depth_vert,fragmentShader:Ui.depth_frag},normal:{uniforms:vo([ct.common,ct.bumpmap,ct.normalmap,ct.displacementmap,{opacity:{value:1}}]),vertexShader:Ui.meshnormal_vert,fragmentShader:Ui.meshnormal_frag},sprite:{uniforms:vo([ct.sprite,ct.fog]),vertexShader:Ui.sprite_vert,fragmentShader:Ui.sprite_frag},background:{uniforms:{uvTransform:{value:new Ni},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ui.background_vert,fragmentShader:Ui.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ni}},vertexShader:Ui.backgroundCube_vert,fragmentShader:Ui.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ui.cube_vert,fragmentShader:Ui.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ui.equirect_vert,fragmentShader:Ui.equirect_frag},distanceRGBA:{uniforms:vo([ct.common,ct.displacementmap,{referencePosition:{value:new ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ui.distanceRGBA_vert,fragmentShader:Ui.distanceRGBA_frag},shadow:{uniforms:vo([ct.lights,ct.fog,{color:{value:new ft(0)},opacity:{value:1}}]),vertexShader:Ui.shadow_vert,fragmentShader:Ui.shadow_frag}};rl.physical={uniforms:vo([rl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ni},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ni},clearcoatNormalScale:{value:new Fe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ni},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ni},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ni},sheen:{value:0},sheenColor:{value:new ft(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ni},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ni},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ni},transmissionSamplerSize:{value:new Fe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ni},attenuationDistance:{value:0},attenuationColor:{value:new ft(0)},specularColor:{value:new ft(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ni},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ni},anisotropyVector:{value:new Fe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ni}}]),vertexShader:Ui.meshphysical_vert,fragmentShader:Ui.meshphysical_frag};const X1={r:0,b:0,g:0},Yf=new To,BEe=new ri;function REe(s,e,i,n,r,o,a){const l=new ft(0);let h=o===!0?0:1,d,f,p=null,g=0,y=null;function x(T){let C=T.isScene===!0?T.background:null;return C&&C.isTexture&&(C=(T.backgroundBlurriness>0?i:e).get(C)),C}function _(T){let C=!1;const A=x(T);A===null?O(l,h):A&&A.isColor&&(O(A,1),C=!0);const B=s.xr.getEnvironmentBlendMode();B==="additive"?n.buffers.color.setClear(0,0,0,1,a):B==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(s.autoClear||C)&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil)}function w(T,C){const A=x(C);A&&(A.isCubeTexture||A.mapping===ky)?(f===void 0&&(f=new Dn(new xf(1,1,1),new Ao({name:"BackgroundCubeMaterial",uniforms:uy(rl.backgroundCube.uniforms),vertexShader:rl.backgroundCube.vertexShader,fragmentShader:rl.backgroundCube.fragmentShader,side:qr,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(B,I,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(f)),Yf.copy(C.backgroundRotation),Yf.x*=-1,Yf.y*=-1,Yf.z*=-1,A.isCubeTexture&&A.isRenderTargetTexture===!1&&(Yf.y*=-1,Yf.z*=-1),f.material.uniforms.envMap.value=A,f.material.uniforms.flipEnvMap.value=A.isCubeTexture&&A.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=C.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=C.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(BEe.makeRotationFromEuler(Yf)),f.material.toneMapped=Mn.getTransfer(A.colorSpace)!==Hn,(p!==A||g!==A.version||y!==s.toneMapping)&&(f.material.needsUpdate=!0,p=A,g=A.version,y=s.toneMapping),f.layers.enableAll(),T.unshift(f,f.geometry,f.material,0,0,null)):A&&A.isTexture&&(d===void 0&&(d=new Dn(new _f(2,2),new Ao({name:"BackgroundMaterial",uniforms:uy(rl.background.uniforms),vertexShader:rl.background.vertexShader,fragmentShader:rl.background.fragmentShader,side:yu,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(d)),d.material.uniforms.t2D.value=A,d.material.uniforms.backgroundIntensity.value=C.backgroundIntensity,d.material.toneMapped=Mn.getTransfer(A.colorSpace)!==Hn,A.matrixAutoUpdate===!0&&A.updateMatrix(),d.material.uniforms.uvTransform.value.copy(A.matrix),(p!==A||g!==A.version||y!==s.toneMapping)&&(d.material.needsUpdate=!0,p=A,g=A.version,y=s.toneMapping),d.layers.enableAll(),T.unshift(d,d.geometry,d.material,0,0,null))}function O(T,C){T.getRGB(X1,cY(s)),n.buffers.color.setClear(X1.r,X1.g,X1.b,C,a)}return{getClearColor:function(){return l},setClearColor:function(T,C=1){l.set(T),h=C,O(l,h)},getClearAlpha:function(){return h},setClearAlpha:function(T){h=T,O(l,h)},render:_,addToRenderList:w}}function DEe(s,e){const i=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},r=g(null);let o=r,a=!1;function l(E,D,L,V,F){let j=!1;const Q=p(V,L,D);o!==Q&&(o=Q,d(o.object)),j=y(E,V,L,F),j&&x(E,V,L,F),F!==null&&e.update(F,s.ELEMENT_ARRAY_BUFFER),(j||a)&&(a=!1,A(E,D,L,V),F!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(F).buffer))}function h(){return s.createVertexArray()}function d(E){return s.bindVertexArray(E)}function f(E){return s.deleteVertexArray(E)}function p(E,D,L){const V=L.wireframe===!0;let F=n[E.id];F===void 0&&(F={},n[E.id]=F);let j=F[D.id];j===void 0&&(j={},F[D.id]=j);let Q=j[V];return Q===void 0&&(Q=g(h()),j[V]=Q),Q}function g(E){const D=[],L=[],V=[];for(let F=0;F<i;F++)D[F]=0,L[F]=0,V[F]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:D,enabledAttributes:L,attributeDivisors:V,object:E,attributes:{},index:null}}function y(E,D,L,V){const F=o.attributes,j=D.attributes;let Q=0;const ee=L.getAttributes();for(const J in ee)if(ee[J].location>=0){const oe=F[J];let pe=j[J];if(pe===void 0&&(J==="instanceMatrix"&&E.instanceMatrix&&(pe=E.instanceMatrix),J==="instanceColor"&&E.instanceColor&&(pe=E.instanceColor)),oe===void 0||oe.attribute!==pe||pe&&oe.data!==pe.data)return!0;Q++}return o.attributesNum!==Q||o.index!==V}function x(E,D,L,V){const F={},j=D.attributes;let Q=0;const ee=L.getAttributes();for(const J in ee)if(ee[J].location>=0){let oe=j[J];oe===void 0&&(J==="instanceMatrix"&&E.instanceMatrix&&(oe=E.instanceMatrix),J==="instanceColor"&&E.instanceColor&&(oe=E.instanceColor));const pe={};pe.attribute=oe,oe&&oe.data&&(pe.data=oe.data),F[J]=pe,Q++}o.attributes=F,o.attributesNum=Q,o.index=V}function _(){const E=o.newAttributes;for(let D=0,L=E.length;D<L;D++)E[D]=0}function w(E){O(E,0)}function O(E,D){const L=o.newAttributes,V=o.enabledAttributes,F=o.attributeDivisors;L[E]=1,V[E]===0&&(s.enableVertexAttribArray(E),V[E]=1),F[E]!==D&&(s.vertexAttribDivisor(E,D),F[E]=D)}function T(){const E=o.newAttributes,D=o.enabledAttributes;for(let L=0,V=D.length;L<V;L++)D[L]!==E[L]&&(s.disableVertexAttribArray(L),D[L]=0)}function C(E,D,L,V,F,j,Q){Q===!0?s.vertexAttribIPointer(E,D,L,F,j):s.vertexAttribPointer(E,D,L,V,F,j)}function A(E,D,L,V){_();const F=V.attributes,j=L.getAttributes(),Q=D.defaultAttributeValues;for(const ee in j){const J=j[ee];if(J.location>=0){let ue=F[ee];if(ue===void 0&&(ee==="instanceMatrix"&&E.instanceMatrix&&(ue=E.instanceMatrix),ee==="instanceColor"&&E.instanceColor&&(ue=E.instanceColor)),ue!==void 0){const oe=ue.normalized,pe=ue.itemSize,Ue=e.get(ue);if(Ue===void 0)continue;const tt=Ue.buffer,ve=Ue.type,Re=Ue.bytesPerElement,Le=ve===s.INT||ve===s.UNSIGNED_INT||ue.gpuType===jD;if(ue.isInterleavedBufferAttribute){const De=ue.data,Se=De.stride,Y=ue.offset;if(De.isInstancedInterleavedBuffer){for(let W=0;W<J.locationSize;W++)O(J.location+W,De.meshPerAttribute);E.isInstancedMesh!==!0&&V._maxInstanceCount===void 0&&(V._maxInstanceCount=De.meshPerAttribute*De.count)}else for(let W=0;W<J.locationSize;W++)w(J.location+W);s.bindBuffer(s.ARRAY_BUFFER,tt);for(let W=0;W<J.locationSize;W++)C(J.location+W,pe/J.locationSize,ve,oe,Se*Re,(Y+pe/J.locationSize*W)*Re,Le)}else{if(ue.isInstancedBufferAttribute){for(let De=0;De<J.locationSize;De++)O(J.location+De,ue.meshPerAttribute);E.isInstancedMesh!==!0&&V._maxInstanceCount===void 0&&(V._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let De=0;De<J.locationSize;De++)w(J.location+De);s.bindBuffer(s.ARRAY_BUFFER,tt);for(let De=0;De<J.locationSize;De++)C(J.location+De,pe/J.locationSize,ve,oe,pe*Re,pe/J.locationSize*De*Re,Le)}}else if(Q!==void 0){const oe=Q[ee];if(oe!==void 0)switch(oe.length){case 2:s.vertexAttrib2fv(J.location,oe);break;case 3:s.vertexAttrib3fv(J.location,oe);break;case 4:s.vertexAttrib4fv(J.location,oe);break;default:s.vertexAttrib1fv(J.location,oe)}}}}T()}function B(){P();for(const E in n){const D=n[E];for(const L in D){const V=D[L];for(const F in V)f(V[F].object),delete V[F];delete D[L]}delete n[E]}}function I(E){if(n[E.id]===void 0)return;const D=n[E.id];for(const L in D){const V=D[L];for(const F in V)f(V[F].object),delete V[F];delete D[L]}delete n[E.id]}function R(E){for(const D in n){const L=n[D];if(L[E.id]===void 0)continue;const V=L[E.id];for(const F in V)f(V[F].object),delete V[F];delete L[E.id]}}function P(){k(),a=!0,o!==r&&(o=r,d(o.object))}function k(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:l,reset:P,resetDefaultState:k,dispose:B,releaseStatesOfGeometry:I,releaseStatesOfProgram:R,initAttributes:_,enableAttribute:w,disableUnusedAttributes:T}}function LEe(s,e,i){let n;function r(d){n=d}function o(d,f){s.drawArrays(n,d,f),i.update(f,n,1)}function a(d,f,p){p!==0&&(s.drawArraysInstanced(n,d,f,p),i.update(f,n,p))}function l(d,f,p){if(p===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let y=0;y<p;y++)this.render(d[y],f[y]);else{g.multiDrawArraysWEBGL(n,d,0,f,0,p);let y=0;for(let x=0;x<p;x++)y+=f[x];i.update(y,n,1)}}function h(d,f,p,g){if(p===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let x=0;x<d.length;x++)a(d[x],f[x],g[x]);else{y.multiDrawArraysInstancedWEBGL(n,d,0,f,0,g,0,p);let x=0;for(let _=0;_<p;_++)x+=f[_];for(let _=0;_<g.length;_++)i.update(x,n,g[_])}}this.setMode=r,this.render=o,this.renderInstances=a,this.renderMultiDraw=l,this.renderMultiDrawInstances=h}function NEe(s,e,i,n){let r;function o(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");r=s.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(I){return!(I!==qo&&n.convert(I)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(I){const R=I===Py&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==sc&&n.convert(I)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==hl&&!R)}function h(I){if(I==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let d=i.precision!==void 0?i.precision:"highp";const f=h(d);f!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",f,"instead."),d=f);const p=i.logarithmicDepthBuffer===!0,g=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),y=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x=s.getParameter(s.MAX_TEXTURE_SIZE),_=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),w=s.getParameter(s.MAX_VERTEX_ATTRIBS),O=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),T=s.getParameter(s.MAX_VARYING_VECTORS),C=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),A=y>0,B=s.getParameter(s.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:h,textureFormatReadable:a,textureTypeReadable:l,precision:d,logarithmicDepthBuffer:p,maxTextures:g,maxVertexTextures:y,maxTextureSize:x,maxCubemapSize:_,maxAttributes:w,maxVertexUniforms:O,maxVaryings:T,maxFragmentUniforms:C,vertexTextures:A,maxSamples:B}}function VEe(s){const e=this;let i=null,n=0,r=!1,o=!1;const a=new Xl,l=new Ni,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(p,g){const y=p.length!==0||g||n!==0||r;return r=g,n=p.length,y},this.beginShadows=function(){o=!0,f(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(p,g){i=f(p,g,0)},this.setState=function(p,g,y){const x=p.clippingPlanes,_=p.clipIntersection,w=p.clipShadows,O=s.get(p);if(!r||x===null||x.length===0||o&&!w)o?f(null):d();else{const T=o?0:n,C=T*4;let A=O.clippingState||null;h.value=A,A=f(x,g,C,y);for(let B=0;B!==C;++B)A[B]=i[B];O.clippingState=A,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=T}};function d(){h.value!==i&&(h.value=i,h.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function f(p,g,y,x){const _=p!==null?p.length:0;let w=null;if(_!==0){if(w=h.value,x!==!0||w===null){const O=y+_*4,T=g.matrixWorldInverse;l.getNormalMatrix(T),(w===null||w.length<O)&&(w=new Float32Array(O));for(let C=0,A=y;C!==_;++C,A+=4)a.copy(p[C]).applyMatrix4(T,l),a.normal.toArray(w,A),w[A+3]=a.constant}h.value=w,h.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,w}}function $Ee(s){let e=new WeakMap;function i(a,l){return l===__?a.mapping=vu:l===b_&&(a.mapping=tf),a}function n(a){if(a&&a.isTexture){const l=a.mapping;if(l===__||l===b_)if(e.has(a)){const h=e.get(a).texture;return i(h,a.mapping)}else{const h=a.image;if(h&&h.height>0){const d=new uY(h.height);return d.fromEquirectangularTexture(s,a),e.set(a,d),a.addEventListener("dispose",r),i(d.texture,a.mapping)}else return null}}return a}function r(a){const l=a.target;l.removeEventListener("dispose",r);const h=e.get(l);h!==void 0&&(e.delete(l),h.dispose())}function o(){e=new WeakMap}return{get:n,dispose:o}}class Ql extends Sb{constructor(e=-1,i=1,n=1,r=-1,o=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=n,this.bottom=r,this.near=o,this.far=a,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,n,r,o,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=n-e,a=n+e,l=r+i,h=r-i;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=d*this.view.offsetX,a=o+d*this.view.width,l-=f*this.view.offsetY,h=l-f*this.view.height}this.projectionMatrix.makeOrthographic(o,a,l,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const d0=4,j4=[.125,.215,.35,.446,.526,.582],Ap=20,eP=new Ql,q4=new ft;let tP=null,iP=0,nP=0,sP=!1;const Op=(1+Math.sqrt(5))/2,Cg=1/Op,Z4=[new ie(-Op,Cg,0),new ie(Op,Cg,0),new ie(-Cg,0,Op),new ie(Cg,0,Op),new ie(0,Op,-Cg),new ie(0,Op,Cg),new ie(-1,1,-1),new ie(1,1,-1),new ie(-1,1,1),new ie(1,1,1)];class TB{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,n=.1,r=100){tP=this._renderer.getRenderTarget(),iP=this._renderer.getActiveCubeFace(),nP=this._renderer.getActiveMipmapLevel(),sP=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,n,r,o),i>0&&this._blur(o,0,0,i),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=e5(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=J4(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(tP,iP,nP),this._renderer.xr.enabled=sP,e.scissorTest=!1,W1(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===vu||e.mapping===tf?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),tP=this._renderer.getRenderTarget(),iP=this._renderer.getActiveCubeFace(),nP=this._renderer.getActiveMipmapLevel(),sP=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=i||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,n={magFilter:Bs,minFilter:Bs,generateMipmaps:!1,type:Py,format:qo,colorSpace:Mu,depthBuffer:!1},r=K4(e,i,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=K4(e,i,n);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=UEe(o)),this._blurMaterial=FEe(o,e,i)}return r}_compileMaterial(e){const i=new Dn(this._lodPlanes[0],e);this._renderer.compile(i,eP)}_sceneToCubeUV(e,i,n,r){const l=new Rn(90,1,i,n),h=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],f=this._renderer,p=f.autoClear,g=f.toneMapping;f.getClearColor(q4),f.toneMapping=cu,f.autoClear=!1;const y=new lc({name:"PMREM.Background",side:qr,depthWrite:!1,depthTest:!1}),x=new Dn(new xf,y);let _=!1;const w=e.background;w?w.isColor&&(y.color.copy(w),e.background=null,_=!0):(y.color.copy(q4),_=!0);for(let O=0;O<6;O++){const T=O%3;T===0?(l.up.set(0,h[O],0),l.lookAt(d[O],0,0)):T===1?(l.up.set(0,0,h[O]),l.lookAt(0,d[O],0)):(l.up.set(0,h[O],0),l.lookAt(0,0,d[O]));const C=this._cubeSize;W1(r,T*C,O>2?C:0,C,C),f.setRenderTarget(r),_&&f.render(x,l),f.render(e,l)}x.geometry.dispose(),x.material.dispose(),f.toneMapping=g,f.autoClear=p,e.background=w}_textureToCubeUV(e,i){const n=this._renderer,r=e.mapping===vu||e.mapping===tf;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=e5()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=J4());const o=r?this._cubemapMaterial:this._equirectMaterial,a=new Dn(this._lodPlanes[0],o),l=o.uniforms;l.envMap.value=e;const h=this._cubeSize;W1(i,0,0,3*h,2*h),n.setRenderTarget(i),n.render(a,eP)}_applyPMREM(e){const i=this._renderer,n=i.autoClear;i.autoClear=!1;const r=this._lodPlanes.length;for(let o=1;o<r;o++){const a=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),l=Z4[(r-o-1)%Z4.length];this._blur(e,o-1,o,a,l)}i.autoClear=n}_blur(e,i,n,r,o){const a=this._pingPongRenderTarget;this._halfBlur(e,a,i,n,r,"latitudinal",o),this._halfBlur(a,e,n,n,r,"longitudinal",o)}_halfBlur(e,i,n,r,o,a,l){const h=this._renderer,d=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,p=new Dn(this._lodPlanes[r],d),g=d.uniforms,y=this._sizeLods[n]-1,x=isFinite(o)?Math.PI/(2*y):2*Math.PI/(2*Ap-1),_=o/x,w=isFinite(o)?1+Math.floor(f*_):Ap;w>Ap&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${Ap}`);const O=[];let T=0;for(let R=0;R<Ap;++R){const P=R/_,k=Math.exp(-P*P/2);O.push(k),R===0?T+=k:R<w&&(T+=2*k)}for(let R=0;R<O.length;R++)O[R]=O[R]/T;g.envMap.value=e.texture,g.samples.value=w,g.weights.value=O,g.latitudinal.value=a==="latitudinal",l&&(g.poleAxis.value=l);const{_lodMax:C}=this;g.dTheta.value=x,g.mipInt.value=C-n;const A=this._sizeLods[r],B=3*A*(r>C-d0?r-C+d0:0),I=4*(this._cubeSize-A);W1(i,B,I,3*A,2*A),h.setRenderTarget(i),h.render(p,eP)}}function UEe(s){const e=[],i=[],n=[];let r=s;const o=s-d0+1+j4.length;for(let a=0;a<o;a++){const l=Math.pow(2,r);i.push(l);let h=1/l;a>s-d0?h=j4[a-s+d0-1]:a===0&&(h=0),n.push(h);const d=1/(l-2),f=-d,p=1+d,g=[f,f,p,f,p,p,f,f,p,p,f,p],y=6,x=6,_=3,w=2,O=1,T=new Float32Array(_*x*y),C=new Float32Array(w*x*y),A=new Float32Array(O*x*y);for(let I=0;I<y;I++){const R=I%3*2/3-1,P=I>2?0:-1,k=[R,P,0,R+2/3,P,0,R+2/3,P+1,0,R,P,0,R+2/3,P+1,0,R,P+1,0];T.set(k,_*x*I),C.set(g,w*x*I);const E=[I,I,I,I,I,I];A.set(E,O*x*I)}const B=new $i;B.setAttribute("position",new rn(T,_)),B.setAttribute("uv",new rn(C,w)),B.setAttribute("faceIndex",new rn(A,O)),e.push(B),r>d0&&r--}return{lodPlanes:e,sizeLods:i,sigmas:n}}function K4(s,e,i){const n=new gl(s,e,i);return n.texture.mapping=ky,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function W1(s,e,i,n,r){s.viewport.set(e,i,n,r),s.scissor.set(e,i,n,r)}function FEe(s,e,i){const n=new Float32Array(Ap),r=new ie(0,1,0);return new Ao({name:"SphericalGaussianBlur",defines:{n:Ap,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:lL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:lu,depthTest:!1,depthWrite:!1})}function J4(){return new Ao({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:lL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:lu,depthTest:!1,depthWrite:!1})}function e5(){return new Ao({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:lL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:lu,depthTest:!1,depthWrite:!1})}function lL(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function zEe(s){let e=new WeakMap,i=null;function n(l){if(l&&l.isTexture){const h=l.mapping,d=h===__||h===b_,f=h===vu||h===tf;if(d||f){let p=e.get(l);const g=p!==void 0?p.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==g)return i===null&&(i=new TB(s)),p=d?i.fromEquirectangular(l,p):i.fromCubemap(l,p),p.texture.pmremVersion=l.pmremVersion,e.set(l,p),p.texture;if(p!==void 0)return p.texture;{const y=l.image;return d&&y&&y.height>0||f&&y&&r(y)?(i===null&&(i=new TB(s)),p=d?i.fromEquirectangular(l):i.fromCubemap(l),p.texture.pmremVersion=l.pmremVersion,e.set(l,p),l.addEventListener("dispose",o),p.texture):null}}}return l}function r(l){let h=0;const d=6;for(let f=0;f<d;f++)l[f]!==void 0&&h++;return h===d}function o(l){const h=l.target;h.removeEventListener("dispose",o);const d=e.get(h);d!==void 0&&(e.delete(h),d.dispose())}function a(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:a}}function XEe(s){const e={};function i(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=s.getExtension(n)}return e[n]=r,r}return{has:function(n){return i(n)!==null},init:function(){i("EXT_color_buffer_float"),i("WEBGL_clip_cull_distance"),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture"),i("WEBGL_render_shared_exponent")},get:function(n){const r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function WEe(s,e,i,n){const r={},o=new WeakMap;function a(p){const g=p.target;g.index!==null&&e.remove(g.index);for(const x in g.attributes)e.remove(g.attributes[x]);for(const x in g.morphAttributes){const _=g.morphAttributes[x];for(let w=0,O=_.length;w<O;w++)e.remove(_[w])}g.removeEventListener("dispose",a),delete r[g.id];const y=o.get(g);y&&(e.remove(y),o.delete(g)),n.releaseStatesOfGeometry(g),g.isInstancedBufferGeometry===!0&&delete g._maxInstanceCount,i.memory.geometries--}function l(p,g){return r[g.id]===!0||(g.addEventListener("dispose",a),r[g.id]=!0,i.memory.geometries++),g}function h(p){const g=p.attributes;for(const x in g)e.update(g[x],s.ARRAY_BUFFER);const y=p.morphAttributes;for(const x in y){const _=y[x];for(let w=0,O=_.length;w<O;w++)e.update(_[w],s.ARRAY_BUFFER)}}function d(p){const g=[],y=p.index,x=p.attributes.position;let _=0;if(y!==null){const T=y.array;_=y.version;for(let C=0,A=T.length;C<A;C+=3){const B=T[C+0],I=T[C+1],R=T[C+2];g.push(B,I,I,R,R,B)}}else if(x!==void 0){const T=x.array;_=x.version;for(let C=0,A=T.length/3-1;C<A;C+=3){const B=C+0,I=C+1,R=C+2;g.push(B,I,I,R,R,B)}}else return;const w=new(nY(g)?aL:oL)(g,1);w.version=_;const O=o.get(p);O&&e.remove(O),o.set(p,w)}function f(p){const g=o.get(p);if(g){const y=p.index;y!==null&&g.version<y.version&&d(p)}else d(p);return o.get(p)}return{get:l,update:h,getWireframeAttribute:f}}function HEe(s,e,i){let n;function r(g){n=g}let o,a;function l(g){o=g.type,a=g.bytesPerElement}function h(g,y){s.drawElements(n,y,o,g*a),i.update(y,n,1)}function d(g,y,x){x!==0&&(s.drawElementsInstanced(n,y,o,g*a,x),i.update(y,n,x))}function f(g,y,x){if(x===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let w=0;w<x;w++)this.render(g[w]/a,y[w]);else{_.multiDrawElementsWEBGL(n,y,0,o,g,0,x);let w=0;for(let O=0;O<x;O++)w+=y[O];i.update(w,n,1)}}function p(g,y,x,_){if(x===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let O=0;O<g.length;O++)d(g[O]/a,y[O],_[O]);else{w.multiDrawElementsInstancedWEBGL(n,y,0,o,g,0,_,0,x);let O=0;for(let T=0;T<x;T++)O+=y[T];for(let T=0;T<_.length;T++)i.update(O,n,_[T])}}this.setMode=r,this.setIndex=l,this.render=h,this.renderInstances=d,this.renderMultiDraw=f,this.renderMultiDrawInstances=p}function GEe(s){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(o,a,l){switch(i.calls++,a){case s.TRIANGLES:i.triangles+=l*(o/3);break;case s.LINES:i.lines+=l*(o/2);break;case s.LINE_STRIP:i.lines+=l*(o-1);break;case s.LINE_LOOP:i.lines+=l*o;break;case s.POINTS:i.points+=l*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:r,update:n}}function QEe(s,e,i){const n=new WeakMap,r=new sn;function o(a,l,h){const d=a.morphTargetInfluences,f=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,p=f!==void 0?f.length:0;let g=n.get(l);if(g===void 0||g.count!==p){let E=function(){P.dispose(),n.delete(l),l.removeEventListener("dispose",E)};var y=E;g!==void 0&&g.texture.dispose();const x=l.morphAttributes.position!==void 0,_=l.morphAttributes.normal!==void 0,w=l.morphAttributes.color!==void 0,O=l.morphAttributes.position||[],T=l.morphAttributes.normal||[],C=l.morphAttributes.color||[];let A=0;x===!0&&(A=1),_===!0&&(A=2),w===!0&&(A=3);let B=l.attributes.position.count*A,I=1;B>e.maxTextureSize&&(I=Math.ceil(B/e.maxTextureSize),B=e.maxTextureSize);const R=new Float32Array(B*I*4*p),P=new _A(R,B,I,p);P.type=hl,P.needsUpdate=!0;const k=A*4;for(let D=0;D<p;D++){const L=O[D],V=T[D],F=C[D],j=B*I*4*D;for(let Q=0;Q<L.count;Q++){const ee=Q*k;x===!0&&(r.fromBufferAttribute(L,Q),R[j+ee+0]=r.x,R[j+ee+1]=r.y,R[j+ee+2]=r.z,R[j+ee+3]=0),_===!0&&(r.fromBufferAttribute(V,Q),R[j+ee+4]=r.x,R[j+ee+5]=r.y,R[j+ee+6]=r.z,R[j+ee+7]=0),w===!0&&(r.fromBufferAttribute(F,Q),R[j+ee+8]=r.x,R[j+ee+9]=r.y,R[j+ee+10]=r.z,R[j+ee+11]=F.itemSize===4?r.w:1)}}g={count:p,texture:P,size:new Fe(B,I)},n.set(l,g),l.addEventListener("dispose",E)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)h.getUniforms().setValue(s,"morphTexture",a.morphTexture,i);else{let x=0;for(let w=0;w<d.length;w++)x+=d[w];const _=l.morphTargetsRelative?1:1-x;h.getUniforms().setValue(s,"morphTargetBaseInfluence",_),h.getUniforms().setValue(s,"morphTargetInfluences",d)}h.getUniforms().setValue(s,"morphTargetsTexture",g.texture,i),h.getUniforms().setValue(s,"morphTargetsTextureSize",g.size)}return{update:o}}function YEe(s,e,i,n){let r=new WeakMap;function o(h){const d=n.render.frame,f=h.geometry,p=e.get(h,f);if(r.get(p)!==d&&(e.update(p),r.set(p,d)),h.isInstancedMesh&&(h.hasEventListener("dispose",l)===!1&&h.addEventListener("dispose",l),r.get(h)!==d&&(i.update(h.instanceMatrix,s.ARRAY_BUFFER),h.instanceColor!==null&&i.update(h.instanceColor,s.ARRAY_BUFFER),r.set(h,d))),h.isSkinnedMesh){const g=h.skeleton;r.get(g)!==d&&(g.update(),r.set(g,d))}return p}function a(){r=new WeakMap}function l(h){const d=h.target;d.removeEventListener("dispose",l),i.remove(d.instanceMatrix),d.instanceColor!==null&&i.remove(d.instanceColor)}return{update:o,dispose:a}}class cL extends cs{constructor(e,i,n,r,o,a,l,h,d,f){if(f=f!==void 0?f:Zp,f!==Zp&&f!==oy)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&f===Zp&&(n=mm),n===void 0&&f===oy&&(n=Iy),super(null,r,o,a,l,h,f,n,d),this.isDepthTexture=!0,this.image={width:e,height:i},this.magFilter=l!==void 0?l:ar,this.minFilter=h!==void 0?h:ar,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const i=super.toJSON(e);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}const fY=new cs,pY=new cL(1,1);pY.compareFunction=nL;const mY=new _A,gY=new rL,yY=new Cb,t5=[],i5=[],n5=new Float32Array(16),s5=new Float32Array(9),r5=new Float32Array(4);function By(s,e,i){const n=s[0];if(n<=0||n>0)return s;const r=e*i;let o=t5[r];if(o===void 0&&(o=new Float32Array(r),t5[r]=o),e!==0){n.toArray(o,0);for(let a=1,l=0;a!==e;++a)l+=i,s[a].toArray(o,l)}return o}function hr(s,e){if(s.length!==e.length)return!1;for(let i=0,n=s.length;i<n;i++)if(s[i]!==e[i])return!1;return!0}function ur(s,e){for(let i=0,n=e.length;i<n;i++)s[i]=e[i]}function wA(s,e){let i=i5[e];i===void 0&&(i=new Int32Array(e),i5[e]=i);for(let n=0;n!==e;++n)i[n]=s.allocateTextureUnit();return i}function jEe(s,e){const i=this.cache;i[0]!==e&&(s.uniform1f(this.addr,e),i[0]=e)}function qEe(s,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(hr(i,e))return;s.uniform2fv(this.addr,e),ur(i,e)}}function ZEe(s,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(hr(i,e))return;s.uniform3fv(this.addr,e),ur(i,e)}}function KEe(s,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(hr(i,e))return;s.uniform4fv(this.addr,e),ur(i,e)}}function JEe(s,e){const i=this.cache,n=e.elements;if(n===void 0){if(hr(i,e))return;s.uniformMatrix2fv(this.addr,!1,e),ur(i,e)}else{if(hr(i,n))return;r5.set(n),s.uniformMatrix2fv(this.addr,!1,r5),ur(i,n)}}function eMe(s,e){const i=this.cache,n=e.elements;if(n===void 0){if(hr(i,e))return;s.uniformMatrix3fv(this.addr,!1,e),ur(i,e)}else{if(hr(i,n))return;s5.set(n),s.uniformMatrix3fv(this.addr,!1,s5),ur(i,n)}}function tMe(s,e){const i=this.cache,n=e.elements;if(n===void 0){if(hr(i,e))return;s.uniformMatrix4fv(this.addr,!1,e),ur(i,e)}else{if(hr(i,n))return;n5.set(n),s.uniformMatrix4fv(this.addr,!1,n5),ur(i,n)}}function iMe(s,e){const i=this.cache;i[0]!==e&&(s.uniform1i(this.addr,e),i[0]=e)}function nMe(s,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(hr(i,e))return;s.uniform2iv(this.addr,e),ur(i,e)}}function sMe(s,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(hr(i,e))return;s.uniform3iv(this.addr,e),ur(i,e)}}function rMe(s,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(hr(i,e))return;s.uniform4iv(this.addr,e),ur(i,e)}}function oMe(s,e){const i=this.cache;i[0]!==e&&(s.uniform1ui(this.addr,e),i[0]=e)}function aMe(s,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(hr(i,e))return;s.uniform2uiv(this.addr,e),ur(i,e)}}function lMe(s,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(hr(i,e))return;s.uniform3uiv(this.addr,e),ur(i,e)}}function cMe(s,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(hr(i,e))return;s.uniform4uiv(this.addr,e),ur(i,e)}}function hMe(s,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r);const o=this.type===s.SAMPLER_2D_SHADOW?pY:fY;i.setTexture2D(e||o,r)}function uMe(s,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||gY,r)}function dMe(s,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(e||yY,r)}function fMe(s,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(s.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||mY,r)}function pMe(s){switch(s){case 5126:return jEe;case 35664:return qEe;case 35665:return ZEe;case 35666:return KEe;case 35674:return JEe;case 35675:return eMe;case 35676:return tMe;case 5124:case 35670:return iMe;case 35667:case 35671:return nMe;case 35668:case 35672:return sMe;case 35669:case 35673:return rMe;case 5125:return oMe;case 36294:return aMe;case 36295:return lMe;case 36296:return cMe;case 35678:case 36198:case 36298:case 36306:case 35682:return hMe;case 35679:case 36299:case 36307:return uMe;case 35680:case 36300:case 36308:case 36293:return dMe;case 36289:case 36303:case 36311:case 36292:return fMe}}function mMe(s,e){s.uniform1fv(this.addr,e)}function gMe(s,e){const i=By(e,this.size,2);s.uniform2fv(this.addr,i)}function yMe(s,e){const i=By(e,this.size,3);s.uniform3fv(this.addr,i)}function vMe(s,e){const i=By(e,this.size,4);s.uniform4fv(this.addr,i)}function xMe(s,e){const i=By(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,i)}function _Me(s,e){const i=By(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,i)}function bMe(s,e){const i=By(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,i)}function wMe(s,e){s.uniform1iv(this.addr,e)}function OMe(s,e){s.uniform2iv(this.addr,e)}function SMe(s,e){s.uniform3iv(this.addr,e)}function CMe(s,e){s.uniform4iv(this.addr,e)}function TMe(s,e){s.uniform1uiv(this.addr,e)}function AMe(s,e){s.uniform2uiv(this.addr,e)}function EMe(s,e){s.uniform3uiv(this.addr,e)}function MMe(s,e){s.uniform4uiv(this.addr,e)}function kMe(s,e,i){const n=this.cache,r=e.length,o=wA(i,r);hr(n,o)||(s.uniform1iv(this.addr,o),ur(n,o));for(let a=0;a!==r;++a)i.setTexture2D(e[a]||fY,o[a])}function PMe(s,e,i){const n=this.cache,r=e.length,o=wA(i,r);hr(n,o)||(s.uniform1iv(this.addr,o),ur(n,o));for(let a=0;a!==r;++a)i.setTexture3D(e[a]||gY,o[a])}function IMe(s,e,i){const n=this.cache,r=e.length,o=wA(i,r);hr(n,o)||(s.uniform1iv(this.addr,o),ur(n,o));for(let a=0;a!==r;++a)i.setTextureCube(e[a]||yY,o[a])}function BMe(s,e,i){const n=this.cache,r=e.length,o=wA(i,r);hr(n,o)||(s.uniform1iv(this.addr,o),ur(n,o));for(let a=0;a!==r;++a)i.setTexture2DArray(e[a]||mY,o[a])}function RMe(s){switch(s){case 5126:return mMe;case 35664:return gMe;case 35665:return yMe;case 35666:return vMe;case 35674:return xMe;case 35675:return _Me;case 35676:return bMe;case 5124:case 35670:return wMe;case 35667:case 35671:return OMe;case 35668:case 35672:return SMe;case 35669:case 35673:return CMe;case 5125:return TMe;case 36294:return AMe;case 36295:return EMe;case 36296:return MMe;case 35678:case 36198:case 36298:case 36306:case 35682:return kMe;case 35679:case 36299:case 36307:return PMe;case 35680:case 36300:case 36308:case 36293:return IMe;case 36289:case 36303:case 36311:case 36292:return BMe}}class DMe{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.type=i.type,this.setValue=pMe(i.type)}}class LMe{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.type=i.type,this.size=i.size,this.setValue=RMe(i.type)}}class NMe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,n){const r=this.seq;for(let o=0,a=r.length;o!==a;++o){const l=r[o];l.setValue(e,i[l.id],n)}}}const rP=/(\w+)(\])?(\[|\.)?/g;function o5(s,e){s.seq.push(e),s.map[e.id]=e}function VMe(s,e,i){const n=s.name,r=n.length;for(rP.lastIndex=0;;){const o=rP.exec(n),a=rP.lastIndex;let l=o[1];const h=o[2]==="]",d=o[3];if(h&&(l=l|0),d===void 0||d==="["&&a+2===r){o5(i,d===void 0?new DMe(l,s,e):new LMe(l,s,e));break}else{let p=i.map[l];p===void 0&&(p=new NMe(l),o5(i,p)),i=p}}}class GS{constructor(e,i){this.seq=[],this.map={};const n=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const o=e.getActiveUniform(i,r),a=e.getUniformLocation(i,o.name);VMe(o,a,this)}}setValue(e,i,n,r){const o=this.map[i];o!==void 0&&o.setValue(e,n,r)}setOptional(e,i,n){const r=i[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,i,n,r){for(let o=0,a=i.length;o!==a;++o){const l=i[o],h=n[l.id];h.needsUpdate!==!1&&l.setValue(e,h.value,r)}}static seqWithValue(e,i){const n=[];for(let r=0,o=e.length;r!==o;++r){const a=e[r];a.id in i&&n.push(a)}return n}}function a5(s,e,i){const n=s.createShader(e);return s.shaderSource(n,i),s.compileShader(n),n}const $Me=37297;let UMe=0;function FMe(s,e){const i=s.split(`
`),n=[],r=Math.max(e-6,0),o=Math.min(e+6,i.length);for(let a=r;a<o;a++){const l=a+1;n.push(`${l===e?">":" "} ${l}: ${i[a]}`)}return n.join(`
`)}function zMe(s){const e=Mn.getPrimaries(Mn.workingColorSpace),i=Mn.getPrimaries(s);let n;switch(e===i?n="":e===C_&&i===S_?n="LinearDisplayP3ToLinearSRGB":e===S_&&i===C_&&(n="LinearSRGBToLinearDisplayP3"),s){case Mu:case wb:return[n,"LinearTransferOETF"];case Ta:case xA:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",s),[n,"LinearTransferOETF"]}}function l5(s,e,i){const n=s.getShaderParameter(e,s.COMPILE_STATUS),r=s.getShaderInfoLog(e).trim();if(n&&r==="")return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const a=parseInt(o[1]);return i.toUpperCase()+`

`+r+`

`+FMe(s.getShaderSource(e),a)}else return r}function XMe(s,e){const i=zMe(e);return`vec4 ${s}( vec4 value ) { return ${i[0]}( ${i[1]}( value ) ); }`}function WMe(s,e){let i;switch(e){case E9:i="Linear";break;case M9:i="Reinhard";break;case k9:i="OptimizedCineon";break;case QD:i="ACESFilmic";break;case I9:i="AgX";break;case B9:i="Neutral";break;case P9:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+s+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function HMe(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Mx).join(`
`)}function GMe(s){const e=[];for(const i in s){const n=s[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join(`
`)}function QMe(s,e){const i={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const o=s.getActiveAttrib(e,r),a=o.name;let l=1;o.type===s.FLOAT_MAT2&&(l=2),o.type===s.FLOAT_MAT3&&(l=3),o.type===s.FLOAT_MAT4&&(l=4),i[a]={type:o.type,location:s.getAttribLocation(e,a),locationSize:l}}return i}function Mx(s){return s!==""}function c5(s,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function h5(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const YMe=/^[ \t]*#include +<([\w\d./]+)>/gm;function AB(s){return s.replace(YMe,qMe)}const jMe=new Map;function qMe(s,e){let i=Ui[e];if(i===void 0){const n=jMe.get(e);if(n!==void 0)i=Ui[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return AB(i)}const ZMe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function u5(s){return s.replace(ZMe,KMe)}function KMe(s,e,i,n){let r="";for(let o=parseInt(e);o<parseInt(i);o++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function d5(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function JMe(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===HD?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===GD?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===Dc&&(e="SHADOWMAP_TYPE_VSM"),e}function eke(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case vu:case tf:e="ENVMAP_TYPE_CUBE";break;case ky:e="ENVMAP_TYPE_CUBE_UV";break}return e}function tke(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case tf:e="ENVMAP_MODE_REFRACTION";break}return e}function ike(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case bb:e="ENVMAP_BLENDING_MULTIPLY";break;case T9:e="ENVMAP_BLENDING_MIX";break;case A9:e="ENVMAP_BLENDING_ADD";break}return e}function nke(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function ske(s,e,i,n){const r=s.getContext(),o=i.defines;let a=i.vertexShader,l=i.fragmentShader;const h=JMe(i),d=eke(i),f=tke(i),p=ike(i),g=nke(i),y=HMe(i),x=GMe(o),_=r.createProgram();let w,O,T=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(w=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,x].filter(Mx).join(`
`),w.length>0&&(w+=`
`),O=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,x].filter(Mx).join(`
`),O.length>0&&(O+=`
`)):(w=[d5(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,x,i.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",i.batching?"#define USE_BATCHING":"",i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.instancingMorph?"#define USE_INSTANCING_MORPH":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+f:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+h:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Mx).join(`
`),O=[d5(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,x,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+d:"",i.envMap?"#define "+f:"",i.envMap?"#define "+p:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.dispersion?"#define USE_DISPERSION":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+h:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==cu?"#define TONE_MAPPING":"",i.toneMapping!==cu?Ui.tonemapping_pars_fragment:"",i.toneMapping!==cu?WMe("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Ui.colorspace_pars_fragment,XMe("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Mx).join(`
`)),a=AB(a),a=c5(a,i),a=h5(a,i),l=AB(l),l=c5(l,i),l=h5(l,i),a=u5(a),l=u5(l),i.isRawShaderMaterial!==!0&&(T=`#version 300 es
`,w=[y,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,O=["#define varying in",i.glslVersion===CB?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===CB?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+O);const C=T+w+a,A=T+O+l,B=a5(r,r.VERTEX_SHADER,C),I=a5(r,r.FRAGMENT_SHADER,A);r.attachShader(_,B),r.attachShader(_,I),i.index0AttributeName!==void 0?r.bindAttribLocation(_,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_);function R(D){if(s.debug.checkShaderErrors){const L=r.getProgramInfoLog(_).trim(),V=r.getShaderInfoLog(B).trim(),F=r.getShaderInfoLog(I).trim();let j=!0,Q=!0;if(r.getProgramParameter(_,r.LINK_STATUS)===!1)if(j=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(r,_,B,I);else{const ee=l5(r,B,"vertex"),J=l5(r,I,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,r.VALIDATE_STATUS)+`

Material Name: `+D.name+`
Material Type: `+D.type+`

Program Info Log: `+L+`
`+ee+`
`+J)}else L!==""?console.warn("THREE.WebGLProgram: Program Info Log:",L):(V===""||F==="")&&(Q=!1);Q&&(D.diagnostics={runnable:j,programLog:L,vertexShader:{log:V,prefix:w},fragmentShader:{log:F,prefix:O}})}r.deleteShader(B),r.deleteShader(I),P=new GS(r,_),k=QMe(r,_)}let P;this.getUniforms=function(){return P===void 0&&R(this),P};let k;this.getAttributes=function(){return k===void 0&&R(this),k};let E=i.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return E===!1&&(E=r.getProgramParameter(_,$Me)),E},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=UMe++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=B,this.fragmentShader=I,this}let rke=0;class oke{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(i),o=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(o)===!1&&(a.add(o),o.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const n of i)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let n=i.get(e);return n===void 0&&(n=new Set,i.set(e,n)),n}_getShaderStage(e){const i=this.shaderCache;let n=i.get(e);return n===void 0&&(n=new ake(e),i.set(e,n)),n}}class ake{constructor(e){this.id=rke++,this.code=e,this.usedTimes=0}}function lke(s,e,i,n,r,o,a){const l=new bA,h=new oke,d=new Set,f=[],p=r.logarithmicDepthBuffer,g=r.vertexTextures;let y=r.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(k){return d.add(k),k===0?"uv":`uv${k}`}function w(k,E,D,L,V){const F=L.fog,j=V.geometry,Q=k.isMeshStandardMaterial?L.environment:null,ee=(k.isMeshStandardMaterial?i:e).get(k.envMap||Q),J=ee&&ee.mapping===ky?ee.image.height:null,ue=x[k.type];k.precision!==null&&(y=r.getMaxPrecision(k.precision),y!==k.precision&&console.warn("THREE.WebGLProgram.getParameters:",k.precision,"not supported, using",y,"instead."));const oe=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,pe=oe!==void 0?oe.length:0;let Ue=0;j.morphAttributes.position!==void 0&&(Ue=1),j.morphAttributes.normal!==void 0&&(Ue=2),j.morphAttributes.color!==void 0&&(Ue=3);let tt,ve,Re,Le;if(ue){const zi=rl[ue];tt=zi.vertexShader,ve=zi.fragmentShader}else tt=k.vertexShader,ve=k.fragmentShader,h.update(k),Re=h.getVertexShaderID(k),Le=h.getFragmentShaderID(k);const De=s.getRenderTarget(),Se=V.isInstancedMesh===!0,Y=V.isBatchedMesh===!0,W=!!k.map,te=!!k.matcap,ae=!!ee,z=!!k.aoMap,q=!!k.lightMap,le=!!k.bumpMap,he=!!k.normalMap,be=!!k.displacementMap,Ee=!!k.emissiveMap,Z=!!k.metalnessMap,G=!!k.roughnessMap,ce=k.anisotropy>0,de=k.clearcoat>0,Oe=k.dispersion>0,Ae=k.iridescence>0,je=k.sheen>0,Ge=k.transmission>0,Qe=ce&&!!k.anisotropyMap,yt=de&&!!k.clearcoatMap,Ke=de&&!!k.clearcoatNormalMap,ht=de&&!!k.clearcoatRoughnessMap,ti=Ae&&!!k.iridescenceMap,Ht=Ae&&!!k.iridescenceThicknessMap,Tt=je&&!!k.sheenColorMap,pi=je&&!!k.sheenRoughnessMap,Ai=!!k.specularMap,_e=!!k.specularColorMap,$e=!!k.specularIntensityMap,fe=Ge&&!!k.transmissionMap,Ve=Ge&&!!k.thicknessMap,Xe=!!k.gradientMap,at=!!k.alphaMap,pt=k.alphaTest>0,Gi=!!k.alphaHash,Qi=!!k.extensions;let ln=cu;k.toneMapped&&(De===null||De.isXRRenderTarget===!0)&&(ln=s.toneMapping);const is={shaderID:ue,shaderType:k.type,shaderName:k.name,vertexShader:tt,fragmentShader:ve,defines:k.defines,customVertexShaderID:Re,customFragmentShaderID:Le,isRawShaderMaterial:k.isRawShaderMaterial===!0,glslVersion:k.glslVersion,precision:y,batching:Y,instancing:Se,instancingColor:Se&&V.instanceColor!==null,instancingMorph:Se&&V.morphTexture!==null,supportsVertexTextures:g,outputColorSpace:De===null?s.outputColorSpace:De.isXRRenderTarget===!0?De.texture.colorSpace:Mu,alphaToCoverage:!!k.alphaToCoverage,map:W,matcap:te,envMap:ae,envMapMode:ae&&ee.mapping,envMapCubeUVHeight:J,aoMap:z,lightMap:q,bumpMap:le,normalMap:he,displacementMap:g&&be,emissiveMap:Ee,normalMapObjectSpace:he&&k.normalMapType===j9,normalMapTangentSpace:he&&k.normalMapType===vf,metalnessMap:Z,roughnessMap:G,anisotropy:ce,anisotropyMap:Qe,clearcoat:de,clearcoatMap:yt,clearcoatNormalMap:Ke,clearcoatRoughnessMap:ht,dispersion:Oe,iridescence:Ae,iridescenceMap:ti,iridescenceThicknessMap:Ht,sheen:je,sheenColorMap:Tt,sheenRoughnessMap:pi,specularMap:Ai,specularColorMap:_e,specularIntensityMap:$e,transmission:Ge,transmissionMap:fe,thicknessMap:Ve,gradientMap:Xe,opaque:k.transparent===!1&&k.blending===qp&&k.alphaToCoverage===!1,alphaMap:at,alphaTest:pt,alphaHash:Gi,combine:k.combine,mapUv:W&&_(k.map.channel),aoMapUv:z&&_(k.aoMap.channel),lightMapUv:q&&_(k.lightMap.channel),bumpMapUv:le&&_(k.bumpMap.channel),normalMapUv:he&&_(k.normalMap.channel),displacementMapUv:be&&_(k.displacementMap.channel),emissiveMapUv:Ee&&_(k.emissiveMap.channel),metalnessMapUv:Z&&_(k.metalnessMap.channel),roughnessMapUv:G&&_(k.roughnessMap.channel),anisotropyMapUv:Qe&&_(k.anisotropyMap.channel),clearcoatMapUv:yt&&_(k.clearcoatMap.channel),clearcoatNormalMapUv:Ke&&_(k.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ht&&_(k.clearcoatRoughnessMap.channel),iridescenceMapUv:ti&&_(k.iridescenceMap.channel),iridescenceThicknessMapUv:Ht&&_(k.iridescenceThicknessMap.channel),sheenColorMapUv:Tt&&_(k.sheenColorMap.channel),sheenRoughnessMapUv:pi&&_(k.sheenRoughnessMap.channel),specularMapUv:Ai&&_(k.specularMap.channel),specularColorMapUv:_e&&_(k.specularColorMap.channel),specularIntensityMapUv:$e&&_(k.specularIntensityMap.channel),transmissionMapUv:fe&&_(k.transmissionMap.channel),thicknessMapUv:Ve&&_(k.thicknessMap.channel),alphaMapUv:at&&_(k.alphaMap.channel),vertexTangents:!!j.attributes.tangent&&(he||ce),vertexColors:k.vertexColors,vertexAlphas:k.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,pointsUvs:V.isPoints===!0&&!!j.attributes.uv&&(W||at),fog:!!F,useFog:k.fog===!0,fogExp2:!!F&&F.isFogExp2,flatShading:k.flatShading===!0,sizeAttenuation:k.sizeAttenuation===!0,logarithmicDepthBuffer:p,skinning:V.isSkinnedMesh===!0,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:pe,morphTextureStride:Ue,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numLightProbes:E.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:k.dithering,shadowMapEnabled:s.shadowMap.enabled&&D.length>0,shadowMapType:s.shadowMap.type,toneMapping:ln,useLegacyLights:s._useLegacyLights,decodeVideoTexture:W&&k.map.isVideoTexture===!0&&Mn.getTransfer(k.map.colorSpace)===Hn,premultipliedAlpha:k.premultipliedAlpha,doubleSided:k.side===Wo,flipSided:k.side===qr,useDepthPacking:k.depthPacking>=0,depthPacking:k.depthPacking||0,index0AttributeName:k.index0AttributeName,extensionClipCullDistance:Qi&&k.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Qi&&k.extensions.multiDraw===!0&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:k.customProgramCacheKey()};return is.vertexUv1s=d.has(1),is.vertexUv2s=d.has(2),is.vertexUv3s=d.has(3),d.clear(),is}function O(k){const E=[];if(k.shaderID?E.push(k.shaderID):(E.push(k.customVertexShaderID),E.push(k.customFragmentShaderID)),k.defines!==void 0)for(const D in k.defines)E.push(D),E.push(k.defines[D]);return k.isRawShaderMaterial===!1&&(T(E,k),C(E,k),E.push(s.outputColorSpace)),E.push(k.customProgramCacheKey),E.join()}function T(k,E){k.push(E.precision),k.push(E.outputColorSpace),k.push(E.envMapMode),k.push(E.envMapCubeUVHeight),k.push(E.mapUv),k.push(E.alphaMapUv),k.push(E.lightMapUv),k.push(E.aoMapUv),k.push(E.bumpMapUv),k.push(E.normalMapUv),k.push(E.displacementMapUv),k.push(E.emissiveMapUv),k.push(E.metalnessMapUv),k.push(E.roughnessMapUv),k.push(E.anisotropyMapUv),k.push(E.clearcoatMapUv),k.push(E.clearcoatNormalMapUv),k.push(E.clearcoatRoughnessMapUv),k.push(E.iridescenceMapUv),k.push(E.iridescenceThicknessMapUv),k.push(E.sheenColorMapUv),k.push(E.sheenRoughnessMapUv),k.push(E.specularMapUv),k.push(E.specularColorMapUv),k.push(E.specularIntensityMapUv),k.push(E.transmissionMapUv),k.push(E.thicknessMapUv),k.push(E.combine),k.push(E.fogExp2),k.push(E.sizeAttenuation),k.push(E.morphTargetsCount),k.push(E.morphAttributeCount),k.push(E.numDirLights),k.push(E.numPointLights),k.push(E.numSpotLights),k.push(E.numSpotLightMaps),k.push(E.numHemiLights),k.push(E.numRectAreaLights),k.push(E.numDirLightShadows),k.push(E.numPointLightShadows),k.push(E.numSpotLightShadows),k.push(E.numSpotLightShadowsWithMaps),k.push(E.numLightProbes),k.push(E.shadowMapType),k.push(E.toneMapping),k.push(E.numClippingPlanes),k.push(E.numClipIntersection),k.push(E.depthPacking)}function C(k,E){l.disableAll(),E.supportsVertexTextures&&l.enable(0),E.instancing&&l.enable(1),E.instancingColor&&l.enable(2),E.instancingMorph&&l.enable(3),E.matcap&&l.enable(4),E.envMap&&l.enable(5),E.normalMapObjectSpace&&l.enable(6),E.normalMapTangentSpace&&l.enable(7),E.clearcoat&&l.enable(8),E.iridescence&&l.enable(9),E.alphaTest&&l.enable(10),E.vertexColors&&l.enable(11),E.vertexAlphas&&l.enable(12),E.vertexUv1s&&l.enable(13),E.vertexUv2s&&l.enable(14),E.vertexUv3s&&l.enable(15),E.vertexTangents&&l.enable(16),E.anisotropy&&l.enable(17),E.alphaHash&&l.enable(18),E.batching&&l.enable(19),E.dispersion&&l.enable(20),k.push(l.mask),l.disableAll(),E.fog&&l.enable(0),E.useFog&&l.enable(1),E.flatShading&&l.enable(2),E.logarithmicDepthBuffer&&l.enable(3),E.skinning&&l.enable(4),E.morphTargets&&l.enable(5),E.morphNormals&&l.enable(6),E.morphColors&&l.enable(7),E.premultipliedAlpha&&l.enable(8),E.shadowMapEnabled&&l.enable(9),E.useLegacyLights&&l.enable(10),E.doubleSided&&l.enable(11),E.flipSided&&l.enable(12),E.useDepthPacking&&l.enable(13),E.dithering&&l.enable(14),E.transmission&&l.enable(15),E.sheen&&l.enable(16),E.opaque&&l.enable(17),E.pointsUvs&&l.enable(18),E.decodeVideoTexture&&l.enable(19),E.alphaToCoverage&&l.enable(20),k.push(l.mask)}function A(k){const E=x[k.type];let D;if(E){const L=rl[E];D=Ob.clone(L.uniforms)}else D=k.uniforms;return D}function B(k,E){let D;for(let L=0,V=f.length;L<V;L++){const F=f[L];if(F.cacheKey===E){D=F,++D.usedTimes;break}}return D===void 0&&(D=new ske(s,E,k,o),f.push(D)),D}function I(k){if(--k.usedTimes===0){const E=f.indexOf(k);f[E]=f[f.length-1],f.pop(),k.destroy()}}function R(k){h.remove(k)}function P(){h.dispose()}return{getParameters:w,getProgramCacheKey:O,getUniforms:A,acquireProgram:B,releaseProgram:I,releaseShaderCache:R,programs:f,dispose:P}}function cke(){let s=new WeakMap;function e(o){let a=s.get(o);return a===void 0&&(a={},s.set(o,a)),a}function i(o){s.delete(o)}function n(o,a,l){s.get(o)[a]=l}function r(){s=new WeakMap}return{get:e,remove:i,update:n,dispose:r}}function hke(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function f5(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function p5(){const s=[];let e=0;const i=[],n=[],r=[];function o(){e=0,i.length=0,n.length=0,r.length=0}function a(p,g,y,x,_,w){let O=s[e];return O===void 0?(O={id:p.id,object:p,geometry:g,material:y,groupOrder:x,renderOrder:p.renderOrder,z:_,group:w},s[e]=O):(O.id=p.id,O.object=p,O.geometry=g,O.material=y,O.groupOrder=x,O.renderOrder=p.renderOrder,O.z=_,O.group=w),e++,O}function l(p,g,y,x,_,w){const O=a(p,g,y,x,_,w);y.transmission>0?n.push(O):y.transparent===!0?r.push(O):i.push(O)}function h(p,g,y,x,_,w){const O=a(p,g,y,x,_,w);y.transmission>0?n.unshift(O):y.transparent===!0?r.unshift(O):i.unshift(O)}function d(p,g){i.length>1&&i.sort(p||hke),n.length>1&&n.sort(g||f5),r.length>1&&r.sort(g||f5)}function f(){for(let p=e,g=s.length;p<g;p++){const y=s[p];if(y.id===null)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.group=null}}return{opaque:i,transmissive:n,transparent:r,init:o,push:l,unshift:h,finish:f,sort:d}}function uke(){let s=new WeakMap;function e(n,r){const o=s.get(n);let a;return o===void 0?(a=new p5,s.set(n,[a])):r>=o.length?(a=new p5,o.push(a)):a=o[r],a}function i(){s=new WeakMap}return{get:e,dispose:i}}function dke(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new ie,color:new ft};break;case"SpotLight":i={position:new ie,direction:new ie,color:new ft,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new ie,color:new ft,distance:0,decay:0};break;case"HemisphereLight":i={direction:new ie,skyColor:new ft,groundColor:new ft};break;case"RectAreaLight":i={color:new ft,position:new ie,halfWidth:new ie,halfHeight:new ie};break}return s[e.id]=i,i}}}function fke(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fe};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fe};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fe,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=i,i}}}let pke=0;function mke(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function gke(s){const e=new dke,i=fke(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)n.probe.push(new ie);const r=new ie,o=new ri,a=new ri;function l(d,f){let p=0,g=0,y=0;for(let D=0;D<9;D++)n.probe[D].set(0,0,0);let x=0,_=0,w=0,O=0,T=0,C=0,A=0,B=0,I=0,R=0,P=0;d.sort(mke);const k=f===!0?Math.PI:1;for(let D=0,L=d.length;D<L;D++){const V=d[D],F=V.color,j=V.intensity,Q=V.distance,ee=V.shadow&&V.shadow.map?V.shadow.map.texture:null;if(V.isAmbientLight)p+=F.r*j*k,g+=F.g*j*k,y+=F.b*j*k;else if(V.isLightProbe){for(let J=0;J<9;J++)n.probe[J].addScaledVector(V.sh.coefficients[J],j);P++}else if(V.isDirectionalLight){const J=e.get(V);if(J.color.copy(V.color).multiplyScalar(V.intensity*k),V.castShadow){const ue=V.shadow,oe=i.get(V);oe.shadowBias=ue.bias,oe.shadowNormalBias=ue.normalBias,oe.shadowRadius=ue.radius,oe.shadowMapSize=ue.mapSize,n.directionalShadow[x]=oe,n.directionalShadowMap[x]=ee,n.directionalShadowMatrix[x]=V.shadow.matrix,C++}n.directional[x]=J,x++}else if(V.isSpotLight){const J=e.get(V);J.position.setFromMatrixPosition(V.matrixWorld),J.color.copy(F).multiplyScalar(j*k),J.distance=Q,J.coneCos=Math.cos(V.angle),J.penumbraCos=Math.cos(V.angle*(1-V.penumbra)),J.decay=V.decay,n.spot[w]=J;const ue=V.shadow;if(V.map&&(n.spotLightMap[I]=V.map,I++,ue.updateMatrices(V),V.castShadow&&R++),n.spotLightMatrix[w]=ue.matrix,V.castShadow){const oe=i.get(V);oe.shadowBias=ue.bias,oe.shadowNormalBias=ue.normalBias,oe.shadowRadius=ue.radius,oe.shadowMapSize=ue.mapSize,n.spotShadow[w]=oe,n.spotShadowMap[w]=ee,B++}w++}else if(V.isRectAreaLight){const J=e.get(V);J.color.copy(F).multiplyScalar(j),J.halfWidth.set(V.width*.5,0,0),J.halfHeight.set(0,V.height*.5,0),n.rectArea[O]=J,O++}else if(V.isPointLight){const J=e.get(V);if(J.color.copy(V.color).multiplyScalar(V.intensity*k),J.distance=V.distance,J.decay=V.decay,V.castShadow){const ue=V.shadow,oe=i.get(V);oe.shadowBias=ue.bias,oe.shadowNormalBias=ue.normalBias,oe.shadowRadius=ue.radius,oe.shadowMapSize=ue.mapSize,oe.shadowCameraNear=ue.camera.near,oe.shadowCameraFar=ue.camera.far,n.pointShadow[_]=oe,n.pointShadowMap[_]=ee,n.pointShadowMatrix[_]=V.shadow.matrix,A++}n.point[_]=J,_++}else if(V.isHemisphereLight){const J=e.get(V);J.skyColor.copy(V.color).multiplyScalar(j*k),J.groundColor.copy(V.groundColor).multiplyScalar(j*k),n.hemi[T]=J,T++}}O>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=ct.LTC_FLOAT_1,n.rectAreaLTC2=ct.LTC_FLOAT_2):(n.rectAreaLTC1=ct.LTC_HALF_1,n.rectAreaLTC2=ct.LTC_HALF_2)),n.ambient[0]=p,n.ambient[1]=g,n.ambient[2]=y;const E=n.hash;(E.directionalLength!==x||E.pointLength!==_||E.spotLength!==w||E.rectAreaLength!==O||E.hemiLength!==T||E.numDirectionalShadows!==C||E.numPointShadows!==A||E.numSpotShadows!==B||E.numSpotMaps!==I||E.numLightProbes!==P)&&(n.directional.length=x,n.spot.length=w,n.rectArea.length=O,n.point.length=_,n.hemi.length=T,n.directionalShadow.length=C,n.directionalShadowMap.length=C,n.pointShadow.length=A,n.pointShadowMap.length=A,n.spotShadow.length=B,n.spotShadowMap.length=B,n.directionalShadowMatrix.length=C,n.pointShadowMatrix.length=A,n.spotLightMatrix.length=B+I-R,n.spotLightMap.length=I,n.numSpotLightShadowsWithMaps=R,n.numLightProbes=P,E.directionalLength=x,E.pointLength=_,E.spotLength=w,E.rectAreaLength=O,E.hemiLength=T,E.numDirectionalShadows=C,E.numPointShadows=A,E.numSpotShadows=B,E.numSpotMaps=I,E.numLightProbes=P,n.version=pke++)}function h(d,f){let p=0,g=0,y=0,x=0,_=0;const w=f.matrixWorldInverse;for(let O=0,T=d.length;O<T;O++){const C=d[O];if(C.isDirectionalLight){const A=n.directional[p];A.direction.setFromMatrixPosition(C.matrixWorld),r.setFromMatrixPosition(C.target.matrixWorld),A.direction.sub(r),A.direction.transformDirection(w),p++}else if(C.isSpotLight){const A=n.spot[y];A.position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(w),A.direction.setFromMatrixPosition(C.matrixWorld),r.setFromMatrixPosition(C.target.matrixWorld),A.direction.sub(r),A.direction.transformDirection(w),y++}else if(C.isRectAreaLight){const A=n.rectArea[x];A.position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(w),a.identity(),o.copy(C.matrixWorld),o.premultiply(w),a.extractRotation(o),A.halfWidth.set(C.width*.5,0,0),A.halfHeight.set(0,C.height*.5,0),A.halfWidth.applyMatrix4(a),A.halfHeight.applyMatrix4(a),x++}else if(C.isPointLight){const A=n.point[g];A.position.setFromMatrixPosition(C.matrixWorld),A.position.applyMatrix4(w),g++}else if(C.isHemisphereLight){const A=n.hemi[_];A.direction.setFromMatrixPosition(C.matrixWorld),A.direction.transformDirection(w),_++}}}return{setup:l,setupView:h,state:n}}function m5(s){const e=new gke(s),i=[],n=[];function r(f){d.camera=f,i.length=0,n.length=0}function o(f){i.push(f)}function a(f){n.push(f)}function l(f){e.setup(i,f)}function h(f){e.setupView(i,f)}const d={lightsArray:i,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:d,setupLights:l,setupLightsView:h,pushLight:o,pushShadow:a}}function yke(s){let e=new WeakMap;function i(r,o=0){const a=e.get(r);let l;return a===void 0?(l=new m5(s),e.set(r,[l])):o>=a.length?(l=new m5(s),a.push(l)):l=a[o],l}function n(){e=new WeakMap}return{get:i,dispose:n}}class hL extends no{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Q9,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class uL extends no{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const vke=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,xke=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function _ke(s,e,i){let n=new Tb;const r=new Fe,o=new Fe,a=new sn,l=new hL({depthPacking:Y9}),h=new uL,d={},f=i.maxTextureSize,p={[yu]:qr,[qr]:yu,[Wo]:Wo},g=new Ao({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Fe},radius:{value:4}},vertexShader:vke,fragmentShader:xke}),y=g.clone();y.defines.HORIZONTAL_PASS=1;const x=new $i;x.setAttribute("position",new rn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new Dn(x,g),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=HD;let O=this.type;this.render=function(I,R,P){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||I.length===0)return;const k=s.getRenderTarget(),E=s.getActiveCubeFace(),D=s.getActiveMipmapLevel(),L=s.state;L.setBlending(lu),L.buffers.color.setClear(1,1,1,1),L.buffers.depth.setTest(!0),L.setScissorTest(!1);const V=O!==Dc&&this.type===Dc,F=O===Dc&&this.type!==Dc;for(let j=0,Q=I.length;j<Q;j++){const ee=I[j],J=ee.shadow;if(J===void 0){console.warn("THREE.WebGLShadowMap:",ee,"has no shadow.");continue}if(J.autoUpdate===!1&&J.needsUpdate===!1)continue;r.copy(J.mapSize);const ue=J.getFrameExtents();if(r.multiply(ue),o.copy(J.mapSize),(r.x>f||r.y>f)&&(r.x>f&&(o.x=Math.floor(f/ue.x),r.x=o.x*ue.x,J.mapSize.x=o.x),r.y>f&&(o.y=Math.floor(f/ue.y),r.y=o.y*ue.y,J.mapSize.y=o.y)),J.map===null||V===!0||F===!0){const pe=this.type!==Dc?{minFilter:ar,magFilter:ar}:{};J.map!==null&&J.map.dispose(),J.map=new gl(r.x,r.y,pe),J.map.texture.name=ee.name+".shadowMap",J.camera.updateProjectionMatrix()}s.setRenderTarget(J.map),s.clear();const oe=J.getViewportCount();for(let pe=0;pe<oe;pe++){const Ue=J.getViewport(pe);a.set(o.x*Ue.x,o.y*Ue.y,o.x*Ue.z,o.y*Ue.w),L.viewport(a),J.updateMatrices(ee,pe),n=J.getFrustum(),A(R,P,J.camera,ee,this.type)}J.isPointLightShadow!==!0&&this.type===Dc&&T(J,P),J.needsUpdate=!1}O=this.type,w.needsUpdate=!1,s.setRenderTarget(k,E,D)};function T(I,R){const P=e.update(_);g.defines.VSM_SAMPLES!==I.blurSamples&&(g.defines.VSM_SAMPLES=I.blurSamples,y.defines.VSM_SAMPLES=I.blurSamples,g.needsUpdate=!0,y.needsUpdate=!0),I.mapPass===null&&(I.mapPass=new gl(r.x,r.y)),g.uniforms.shadow_pass.value=I.map.texture,g.uniforms.resolution.value=I.mapSize,g.uniforms.radius.value=I.radius,s.setRenderTarget(I.mapPass),s.clear(),s.renderBufferDirect(R,null,P,g,_,null),y.uniforms.shadow_pass.value=I.mapPass.texture,y.uniforms.resolution.value=I.mapSize,y.uniforms.radius.value=I.radius,s.setRenderTarget(I.map),s.clear(),s.renderBufferDirect(R,null,P,y,_,null)}function C(I,R,P,k){let E=null;const D=P.isPointLight===!0?I.customDistanceMaterial:I.customDepthMaterial;if(D!==void 0)E=D;else if(E=P.isPointLight===!0?h:l,s.localClippingEnabled&&R.clipShadows===!0&&Array.isArray(R.clippingPlanes)&&R.clippingPlanes.length!==0||R.displacementMap&&R.displacementScale!==0||R.alphaMap&&R.alphaTest>0||R.map&&R.alphaTest>0){const L=E.uuid,V=R.uuid;let F=d[L];F===void 0&&(F={},d[L]=F);let j=F[V];j===void 0&&(j=E.clone(),F[V]=j,R.addEventListener("dispose",B)),E=j}if(E.visible=R.visible,E.wireframe=R.wireframe,k===Dc?E.side=R.shadowSide!==null?R.shadowSide:R.side:E.side=R.shadowSide!==null?R.shadowSide:p[R.side],E.alphaMap=R.alphaMap,E.alphaTest=R.alphaTest,E.map=R.map,E.clipShadows=R.clipShadows,E.clippingPlanes=R.clippingPlanes,E.clipIntersection=R.clipIntersection,E.displacementMap=R.displacementMap,E.displacementScale=R.displacementScale,E.displacementBias=R.displacementBias,E.wireframeLinewidth=R.wireframeLinewidth,E.linewidth=R.linewidth,P.isPointLight===!0&&E.isMeshDistanceMaterial===!0){const L=s.properties.get(E);L.light=P}return E}function A(I,R,P,k,E){if(I.visible===!1)return;if(I.layers.test(R.layers)&&(I.isMesh||I.isLine||I.isPoints)&&(I.castShadow||I.receiveShadow&&E===Dc)&&(!I.frustumCulled||n.intersectsObject(I))){I.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,I.matrixWorld);const V=e.update(I),F=I.material;if(Array.isArray(F)){const j=V.groups;for(let Q=0,ee=j.length;Q<ee;Q++){const J=j[Q],ue=F[J.materialIndex];if(ue&&ue.visible){const oe=C(I,ue,k,E);I.onBeforeShadow(s,I,R,P,V,oe,J),s.renderBufferDirect(P,null,V,oe,I,J),I.onAfterShadow(s,I,R,P,V,oe,J)}}}else if(F.visible){const j=C(I,F,k,E);I.onBeforeShadow(s,I,R,P,V,j,null),s.renderBufferDirect(P,null,V,j,I,null),I.onAfterShadow(s,I,R,P,V,j,null)}}const L=I.children;for(let V=0,F=L.length;V<F;V++)A(L[V],R,P,k,E)}function B(I){I.target.removeEventListener("dispose",B);for(const P in d){const k=d[P],E=I.target.uuid;E in k&&(k[E].dispose(),delete k[E])}}}function bke(s){function e(){let fe=!1;const Ve=new sn;let Xe=null;const at=new sn(0,0,0,0);return{setMask:function(pt){Xe!==pt&&!fe&&(s.colorMask(pt,pt,pt,pt),Xe=pt)},setLocked:function(pt){fe=pt},setClear:function(pt,Gi,Qi,ln,is){is===!0&&(pt*=ln,Gi*=ln,Qi*=ln),Ve.set(pt,Gi,Qi,ln),at.equals(Ve)===!1&&(s.clearColor(pt,Gi,Qi,ln),at.copy(Ve))},reset:function(){fe=!1,Xe=null,at.set(-1,0,0,0)}}}function i(){let fe=!1,Ve=null,Xe=null,at=null;return{setTest:function(pt){pt?Le(s.DEPTH_TEST):De(s.DEPTH_TEST)},setMask:function(pt){Ve!==pt&&!fe&&(s.depthMask(pt),Ve=pt)},setFunc:function(pt){if(Xe!==pt){switch(pt){case x9:s.depthFunc(s.NEVER);break;case _9:s.depthFunc(s.ALWAYS);break;case b9:s.depthFunc(s.LESS);break;case x_:s.depthFunc(s.LEQUAL);break;case w9:s.depthFunc(s.EQUAL);break;case O9:s.depthFunc(s.GEQUAL);break;case S9:s.depthFunc(s.GREATER);break;case C9:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}Xe=pt}},setLocked:function(pt){fe=pt},setClear:function(pt){at!==pt&&(s.clearDepth(pt),at=pt)},reset:function(){fe=!1,Ve=null,Xe=null,at=null}}}function n(){let fe=!1,Ve=null,Xe=null,at=null,pt=null,Gi=null,Qi=null,ln=null,is=null;return{setTest:function(zi){fe||(zi?Le(s.STENCIL_TEST):De(s.STENCIL_TEST))},setMask:function(zi){Ve!==zi&&!fe&&(s.stencilMask(zi),Ve=zi)},setFunc:function(zi,dr,us){(Xe!==zi||at!==dr||pt!==us)&&(s.stencilFunc(zi,dr,us),Xe=zi,at=dr,pt=us)},setOp:function(zi,dr,us){(Gi!==zi||Qi!==dr||ln!==us)&&(s.stencilOp(zi,dr,us),Gi=zi,Qi=dr,ln=us)},setLocked:function(zi){fe=zi},setClear:function(zi){is!==zi&&(s.clearStencil(zi),is=zi)},reset:function(){fe=!1,Ve=null,Xe=null,at=null,pt=null,Gi=null,Qi=null,ln=null,is=null}}}const r=new e,o=new i,a=new n,l=new WeakMap,h=new WeakMap;let d={},f={},p=new WeakMap,g=[],y=null,x=!1,_=null,w=null,O=null,T=null,C=null,A=null,B=null,I=new ft(0,0,0),R=0,P=!1,k=null,E=null,D=null,L=null,V=null;const F=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let j=!1,Q=0;const ee=s.getParameter(s.VERSION);ee.indexOf("WebGL")!==-1?(Q=parseFloat(/^WebGL (\d)/.exec(ee)[1]),j=Q>=1):ee.indexOf("OpenGL ES")!==-1&&(Q=parseFloat(/^OpenGL ES (\d)/.exec(ee)[1]),j=Q>=2);let J=null,ue={};const oe=s.getParameter(s.SCISSOR_BOX),pe=s.getParameter(s.VIEWPORT),Ue=new sn().fromArray(oe),tt=new sn().fromArray(pe);function ve(fe,Ve,Xe,at){const pt=new Uint8Array(4),Gi=s.createTexture();s.bindTexture(fe,Gi),s.texParameteri(fe,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(fe,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let Qi=0;Qi<Xe;Qi++)fe===s.TEXTURE_3D||fe===s.TEXTURE_2D_ARRAY?s.texImage3D(Ve,0,s.RGBA,1,1,at,0,s.RGBA,s.UNSIGNED_BYTE,pt):s.texImage2D(Ve+Qi,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,pt);return Gi}const Re={};Re[s.TEXTURE_2D]=ve(s.TEXTURE_2D,s.TEXTURE_2D,1),Re[s.TEXTURE_CUBE_MAP]=ve(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),Re[s.TEXTURE_2D_ARRAY]=ve(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),Re[s.TEXTURE_3D]=ve(s.TEXTURE_3D,s.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),a.setClear(0),Le(s.DEPTH_TEST),o.setFunc(x_),le(!1),he(YI),Le(s.CULL_FACE),z(lu);function Le(fe){d[fe]!==!0&&(s.enable(fe),d[fe]=!0)}function De(fe){d[fe]!==!1&&(s.disable(fe),d[fe]=!1)}function Se(fe,Ve){return f[fe]!==Ve?(s.bindFramebuffer(fe,Ve),f[fe]=Ve,fe===s.DRAW_FRAMEBUFFER&&(f[s.FRAMEBUFFER]=Ve),fe===s.FRAMEBUFFER&&(f[s.DRAW_FRAMEBUFFER]=Ve),!0):!1}function Y(fe,Ve){let Xe=g,at=!1;if(fe){Xe=p.get(Ve),Xe===void 0&&(Xe=[],p.set(Ve,Xe));const pt=fe.textures;if(Xe.length!==pt.length||Xe[0]!==s.COLOR_ATTACHMENT0){for(let Gi=0,Qi=pt.length;Gi<Qi;Gi++)Xe[Gi]=s.COLOR_ATTACHMENT0+Gi;Xe.length=pt.length,at=!0}}else Xe[0]!==s.BACK&&(Xe[0]=s.BACK,at=!0);at&&s.drawBuffers(Xe)}function W(fe){return y!==fe?(s.useProgram(fe),y=fe,!0):!1}const te={[Rd]:s.FUNC_ADD,[i9]:s.FUNC_SUBTRACT,[n9]:s.FUNC_REVERSE_SUBTRACT};te[s9]=s.MIN,te[r9]=s.MAX;const ae={[o9]:s.ZERO,[a9]:s.ONE,[l9]:s.SRC_COLOR,[WC]:s.SRC_ALPHA,[p9]:s.SRC_ALPHA_SATURATE,[d9]:s.DST_COLOR,[h9]:s.DST_ALPHA,[c9]:s.ONE_MINUS_SRC_COLOR,[HC]:s.ONE_MINUS_SRC_ALPHA,[f9]:s.ONE_MINUS_DST_COLOR,[u9]:s.ONE_MINUS_DST_ALPHA,[m9]:s.CONSTANT_COLOR,[g9]:s.ONE_MINUS_CONSTANT_COLOR,[y9]:s.CONSTANT_ALPHA,[v9]:s.ONE_MINUS_CONSTANT_ALPHA};function z(fe,Ve,Xe,at,pt,Gi,Qi,ln,is,zi){if(fe===lu){x===!0&&(De(s.BLEND),x=!1);return}if(x===!1&&(Le(s.BLEND),x=!0),fe!==t9){if(fe!==_||zi!==P){if((w!==Rd||C!==Rd)&&(s.blendEquation(s.FUNC_ADD),w=Rd,C=Rd),zi)switch(fe){case qp:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case XC:s.blendFunc(s.ONE,s.ONE);break;case jI:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case qI:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}else switch(fe){case qp:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case XC:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case jI:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case qI:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}O=null,T=null,A=null,B=null,I.set(0,0,0),R=0,_=fe,P=zi}return}pt=pt||Ve,Gi=Gi||Xe,Qi=Qi||at,(Ve!==w||pt!==C)&&(s.blendEquationSeparate(te[Ve],te[pt]),w=Ve,C=pt),(Xe!==O||at!==T||Gi!==A||Qi!==B)&&(s.blendFuncSeparate(ae[Xe],ae[at],ae[Gi],ae[Qi]),O=Xe,T=at,A=Gi,B=Qi),(ln.equals(I)===!1||is!==R)&&(s.blendColor(ln.r,ln.g,ln.b,is),I.copy(ln),R=is),_=fe,P=!1}function q(fe,Ve){fe.side===Wo?De(s.CULL_FACE):Le(s.CULL_FACE);let Xe=fe.side===qr;Ve&&(Xe=!Xe),le(Xe),fe.blending===qp&&fe.transparent===!1?z(lu):z(fe.blending,fe.blendEquation,fe.blendSrc,fe.blendDst,fe.blendEquationAlpha,fe.blendSrcAlpha,fe.blendDstAlpha,fe.blendColor,fe.blendAlpha,fe.premultipliedAlpha),o.setFunc(fe.depthFunc),o.setTest(fe.depthTest),o.setMask(fe.depthWrite),r.setMask(fe.colorWrite);const at=fe.stencilWrite;a.setTest(at),at&&(a.setMask(fe.stencilWriteMask),a.setFunc(fe.stencilFunc,fe.stencilRef,fe.stencilFuncMask),a.setOp(fe.stencilFail,fe.stencilZFail,fe.stencilZPass)),Ee(fe.polygonOffset,fe.polygonOffsetFactor,fe.polygonOffsetUnits),fe.alphaToCoverage===!0?Le(s.SAMPLE_ALPHA_TO_COVERAGE):De(s.SAMPLE_ALPHA_TO_COVERAGE)}function le(fe){k!==fe&&(fe?s.frontFace(s.CW):s.frontFace(s.CCW),k=fe)}function he(fe){fe!==J7?(Le(s.CULL_FACE),fe!==E&&(fe===YI?s.cullFace(s.BACK):fe===e9?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):De(s.CULL_FACE),E=fe}function be(fe){fe!==D&&(j&&s.lineWidth(fe),D=fe)}function Ee(fe,Ve,Xe){fe?(Le(s.POLYGON_OFFSET_FILL),(L!==Ve||V!==Xe)&&(s.polygonOffset(Ve,Xe),L=Ve,V=Xe)):De(s.POLYGON_OFFSET_FILL)}function Z(fe){fe?Le(s.SCISSOR_TEST):De(s.SCISSOR_TEST)}function G(fe){fe===void 0&&(fe=s.TEXTURE0+F-1),J!==fe&&(s.activeTexture(fe),J=fe)}function ce(fe,Ve,Xe){Xe===void 0&&(J===null?Xe=s.TEXTURE0+F-1:Xe=J);let at=ue[Xe];at===void 0&&(at={type:void 0,texture:void 0},ue[Xe]=at),(at.type!==fe||at.texture!==Ve)&&(J!==Xe&&(s.activeTexture(Xe),J=Xe),s.bindTexture(fe,Ve||Re[fe]),at.type=fe,at.texture=Ve)}function de(){const fe=ue[J];fe!==void 0&&fe.type!==void 0&&(s.bindTexture(fe.type,null),fe.type=void 0,fe.texture=void 0)}function Oe(){try{s.compressedTexImage2D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Ae(){try{s.compressedTexImage3D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function je(){try{s.texSubImage2D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Ge(){try{s.texSubImage3D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Qe(){try{s.compressedTexSubImage2D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function yt(){try{s.compressedTexSubImage3D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Ke(){try{s.texStorage2D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function ht(){try{s.texStorage3D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function ti(){try{s.texImage2D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Ht(){try{s.texImage3D.apply(s,arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Tt(fe){Ue.equals(fe)===!1&&(s.scissor(fe.x,fe.y,fe.z,fe.w),Ue.copy(fe))}function pi(fe){tt.equals(fe)===!1&&(s.viewport(fe.x,fe.y,fe.z,fe.w),tt.copy(fe))}function Ai(fe,Ve){let Xe=h.get(Ve);Xe===void 0&&(Xe=new WeakMap,h.set(Ve,Xe));let at=Xe.get(fe);at===void 0&&(at=s.getUniformBlockIndex(Ve,fe.name),Xe.set(fe,at))}function _e(fe,Ve){const at=h.get(Ve).get(fe);l.get(Ve)!==at&&(s.uniformBlockBinding(Ve,at,fe.__bindingPointIndex),l.set(Ve,at))}function $e(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),d={},J=null,ue={},f={},p=new WeakMap,g=[],y=null,x=!1,_=null,w=null,O=null,T=null,C=null,A=null,B=null,I=new ft(0,0,0),R=0,P=!1,k=null,E=null,D=null,L=null,V=null,Ue.set(0,0,s.canvas.width,s.canvas.height),tt.set(0,0,s.canvas.width,s.canvas.height),r.reset(),o.reset(),a.reset()}return{buffers:{color:r,depth:o,stencil:a},enable:Le,disable:De,bindFramebuffer:Se,drawBuffers:Y,useProgram:W,setBlending:z,setMaterial:q,setFlipSided:le,setCullFace:he,setLineWidth:be,setPolygonOffset:Ee,setScissorTest:Z,activeTexture:G,bindTexture:ce,unbindTexture:de,compressedTexImage2D:Oe,compressedTexImage3D:Ae,texImage2D:ti,texImage3D:Ht,updateUBOMapping:Ai,uniformBlockBinding:_e,texStorage2D:Ke,texStorage3D:ht,texSubImage2D:je,texSubImage3D:Ge,compressedTexSubImage2D:Qe,compressedTexSubImage3D:yt,scissor:Tt,viewport:pi,reset:$e}}function wke(s,e,i,n,r,o,a){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),d=new Fe,f=new WeakMap;let p;const g=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(Z,G){return y?new OffscreenCanvas(Z,G):E_("canvas")}function _(Z,G,ce){let de=1;const Oe=Ee(Z);if((Oe.width>ce||Oe.height>ce)&&(de=ce/Math.max(Oe.width,Oe.height)),de<1)if(typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Z instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Z instanceof ImageBitmap||typeof VideoFrame<"u"&&Z instanceof VideoFrame){const Ae=Math.floor(de*Oe.width),je=Math.floor(de*Oe.height);p===void 0&&(p=x(Ae,je));const Ge=G?x(Ae,je):p;return Ge.width=Ae,Ge.height=je,Ge.getContext("2d").drawImage(Z,0,0,Ae,je),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Oe.width+"x"+Oe.height+") to ("+Ae+"x"+je+")."),Ge}else return"data"in Z&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Oe.width+"x"+Oe.height+")."),Z;return Z}function w(Z){return Z.generateMipmaps&&Z.minFilter!==ar&&Z.minFilter!==Bs}function O(Z){s.generateMipmap(Z)}function T(Z,G,ce,de,Oe=!1){if(Z!==null){if(s[Z]!==void 0)return s[Z];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Z+"'")}let Ae=G;if(G===s.RED&&(ce===s.FLOAT&&(Ae=s.R32F),ce===s.HALF_FLOAT&&(Ae=s.R16F),ce===s.UNSIGNED_BYTE&&(Ae=s.R8)),G===s.RED_INTEGER&&(ce===s.UNSIGNED_BYTE&&(Ae=s.R8UI),ce===s.UNSIGNED_SHORT&&(Ae=s.R16UI),ce===s.UNSIGNED_INT&&(Ae=s.R32UI),ce===s.BYTE&&(Ae=s.R8I),ce===s.SHORT&&(Ae=s.R16I),ce===s.INT&&(Ae=s.R32I)),G===s.RG&&(ce===s.FLOAT&&(Ae=s.RG32F),ce===s.HALF_FLOAT&&(Ae=s.RG16F),ce===s.UNSIGNED_BYTE&&(Ae=s.RG8)),G===s.RG_INTEGER&&(ce===s.UNSIGNED_BYTE&&(Ae=s.RG8UI),ce===s.UNSIGNED_SHORT&&(Ae=s.RG16UI),ce===s.UNSIGNED_INT&&(Ae=s.RG32UI),ce===s.BYTE&&(Ae=s.RG8I),ce===s.SHORT&&(Ae=s.RG16I),ce===s.INT&&(Ae=s.RG32I)),G===s.RGB&&ce===s.UNSIGNED_INT_5_9_9_9_REV&&(Ae=s.RGB9_E5),G===s.RGBA){const je=Oe?O_:Mn.getTransfer(de);ce===s.FLOAT&&(Ae=s.RGBA32F),ce===s.HALF_FLOAT&&(Ae=s.RGBA16F),ce===s.UNSIGNED_BYTE&&(Ae=je===Hn?s.SRGB8_ALPHA8:s.RGBA8),ce===s.UNSIGNED_SHORT_4_4_4_4&&(Ae=s.RGBA4),ce===s.UNSIGNED_SHORT_5_5_5_1&&(Ae=s.RGB5_A1)}return(Ae===s.R16F||Ae===s.R32F||Ae===s.RG16F||Ae===s.RG32F||Ae===s.RGBA16F||Ae===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Ae}function C(Z,G){return w(Z)===!0||Z.isFramebufferTexture&&Z.minFilter!==ar&&Z.minFilter!==Bs?Math.log2(Math.max(G.width,G.height))+1:Z.mipmaps!==void 0&&Z.mipmaps.length>0?Z.mipmaps.length:Z.isCompressedTexture&&Array.isArray(Z.image)?G.mipmaps.length:1}function A(Z){const G=Z.target;G.removeEventListener("dispose",A),I(G),G.isVideoTexture&&f.delete(G)}function B(Z){const G=Z.target;G.removeEventListener("dispose",B),P(G)}function I(Z){const G=n.get(Z);if(G.__webglInit===void 0)return;const ce=Z.source,de=g.get(ce);if(de){const Oe=de[G.__cacheKey];Oe.usedTimes--,Oe.usedTimes===0&&R(Z),Object.keys(de).length===0&&g.delete(ce)}n.remove(Z)}function R(Z){const G=n.get(Z);s.deleteTexture(G.__webglTexture);const ce=Z.source,de=g.get(ce);delete de[G.__cacheKey],a.memory.textures--}function P(Z){const G=n.get(Z);if(Z.depthTexture&&Z.depthTexture.dispose(),Z.isWebGLCubeRenderTarget)for(let de=0;de<6;de++){if(Array.isArray(G.__webglFramebuffer[de]))for(let Oe=0;Oe<G.__webglFramebuffer[de].length;Oe++)s.deleteFramebuffer(G.__webglFramebuffer[de][Oe]);else s.deleteFramebuffer(G.__webglFramebuffer[de]);G.__webglDepthbuffer&&s.deleteRenderbuffer(G.__webglDepthbuffer[de])}else{if(Array.isArray(G.__webglFramebuffer))for(let de=0;de<G.__webglFramebuffer.length;de++)s.deleteFramebuffer(G.__webglFramebuffer[de]);else s.deleteFramebuffer(G.__webglFramebuffer);if(G.__webglDepthbuffer&&s.deleteRenderbuffer(G.__webglDepthbuffer),G.__webglMultisampledFramebuffer&&s.deleteFramebuffer(G.__webglMultisampledFramebuffer),G.__webglColorRenderbuffer)for(let de=0;de<G.__webglColorRenderbuffer.length;de++)G.__webglColorRenderbuffer[de]&&s.deleteRenderbuffer(G.__webglColorRenderbuffer[de]);G.__webglDepthRenderbuffer&&s.deleteRenderbuffer(G.__webglDepthRenderbuffer)}const ce=Z.textures;for(let de=0,Oe=ce.length;de<Oe;de++){const Ae=n.get(ce[de]);Ae.__webglTexture&&(s.deleteTexture(Ae.__webglTexture),a.memory.textures--),n.remove(ce[de])}n.remove(Z)}let k=0;function E(){k=0}function D(){const Z=k;return Z>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Z+" texture units while this GPU supports only "+r.maxTextures),k+=1,Z}function L(Z){const G=[];return G.push(Z.wrapS),G.push(Z.wrapT),G.push(Z.wrapR||0),G.push(Z.magFilter),G.push(Z.minFilter),G.push(Z.anisotropy),G.push(Z.internalFormat),G.push(Z.format),G.push(Z.type),G.push(Z.generateMipmaps),G.push(Z.premultiplyAlpha),G.push(Z.flipY),G.push(Z.unpackAlignment),G.push(Z.colorSpace),G.join()}function V(Z,G){const ce=n.get(Z);if(Z.isVideoTexture&&he(Z),Z.isRenderTargetTexture===!1&&Z.version>0&&ce.__version!==Z.version){const de=Z.image;if(de===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(de.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ue(ce,Z,G);return}}i.bindTexture(s.TEXTURE_2D,ce.__webglTexture,s.TEXTURE0+G)}function F(Z,G){const ce=n.get(Z);if(Z.version>0&&ce.__version!==Z.version){Ue(ce,Z,G);return}i.bindTexture(s.TEXTURE_2D_ARRAY,ce.__webglTexture,s.TEXTURE0+G)}function j(Z,G){const ce=n.get(Z);if(Z.version>0&&ce.__version!==Z.version){Ue(ce,Z,G);return}i.bindTexture(s.TEXTURE_3D,ce.__webglTexture,s.TEXTURE0+G)}function Q(Z,G){const ce=n.get(Z);if(Z.version>0&&ce.__version!==Z.version){tt(ce,Z,G);return}i.bindTexture(s.TEXTURE_CUBE_MAP,ce.__webglTexture,s.TEXTURE0+G)}const ee={[sy]:s.REPEAT,[Pa]:s.CLAMP_TO_EDGE,[ry]:s.MIRRORED_REPEAT},J={[ar]:s.NEAREST,[yA]:s.NEAREST_MIPMAP_NEAREST,[Rp]:s.NEAREST_MIPMAP_LINEAR,[Bs]:s.LINEAR,[$0]:s.LINEAR_MIPMAP_NEAREST,[Gl]:s.LINEAR_MIPMAP_LINEAR},ue={[q9]:s.NEVER,[iY]:s.ALWAYS,[Z9]:s.LESS,[nL]:s.LEQUAL,[K9]:s.EQUAL,[tY]:s.GEQUAL,[J9]:s.GREATER,[eY]:s.NOTEQUAL};function oe(Z,G){if(G.type===hl&&e.has("OES_texture_float_linear")===!1&&(G.magFilter===Bs||G.magFilter===$0||G.magFilter===Rp||G.magFilter===Gl||G.minFilter===Bs||G.minFilter===$0||G.minFilter===Rp||G.minFilter===Gl)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(Z,s.TEXTURE_WRAP_S,ee[G.wrapS]),s.texParameteri(Z,s.TEXTURE_WRAP_T,ee[G.wrapT]),(Z===s.TEXTURE_3D||Z===s.TEXTURE_2D_ARRAY)&&s.texParameteri(Z,s.TEXTURE_WRAP_R,ee[G.wrapR]),s.texParameteri(Z,s.TEXTURE_MAG_FILTER,J[G.magFilter]),s.texParameteri(Z,s.TEXTURE_MIN_FILTER,J[G.minFilter]),G.compareFunction&&(s.texParameteri(Z,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(Z,s.TEXTURE_COMPARE_FUNC,ue[G.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(G.magFilter===ar||G.minFilter!==Rp&&G.minFilter!==Gl||G.type===hl&&e.has("OES_texture_float_linear")===!1)return;if(G.anisotropy>1||n.get(G).__currentAnisotropy){const ce=e.get("EXT_texture_filter_anisotropic");s.texParameterf(Z,ce.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(G.anisotropy,r.getMaxAnisotropy())),n.get(G).__currentAnisotropy=G.anisotropy}}}function pe(Z,G){let ce=!1;Z.__webglInit===void 0&&(Z.__webglInit=!0,G.addEventListener("dispose",A));const de=G.source;let Oe=g.get(de);Oe===void 0&&(Oe={},g.set(de,Oe));const Ae=L(G);if(Ae!==Z.__cacheKey){Oe[Ae]===void 0&&(Oe[Ae]={texture:s.createTexture(),usedTimes:0},a.memory.textures++,ce=!0),Oe[Ae].usedTimes++;const je=Oe[Z.__cacheKey];je!==void 0&&(Oe[Z.__cacheKey].usedTimes--,je.usedTimes===0&&R(G)),Z.__cacheKey=Ae,Z.__webglTexture=Oe[Ae].texture}return ce}function Ue(Z,G,ce){let de=s.TEXTURE_2D;(G.isDataArrayTexture||G.isCompressedArrayTexture)&&(de=s.TEXTURE_2D_ARRAY),G.isData3DTexture&&(de=s.TEXTURE_3D);const Oe=pe(Z,G),Ae=G.source;i.bindTexture(de,Z.__webglTexture,s.TEXTURE0+ce);const je=n.get(Ae);if(Ae.version!==je.__version||Oe===!0){i.activeTexture(s.TEXTURE0+ce);const Ge=Mn.getPrimaries(Mn.workingColorSpace),Qe=G.colorSpace===Qh?null:Mn.getPrimaries(G.colorSpace),yt=G.colorSpace===Qh||Ge===Qe?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,G.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,G.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,yt);let Ke=_(G.image,!1,r.maxTextureSize);Ke=be(G,Ke);const ht=o.convert(G.format,G.colorSpace),ti=o.convert(G.type);let Ht=T(G.internalFormat,ht,ti,G.colorSpace,G.isVideoTexture);oe(de,G);let Tt;const pi=G.mipmaps,Ai=G.isVideoTexture!==!0,_e=je.__version===void 0||Oe===!0,$e=Ae.dataReady,fe=C(G,Ke);if(G.isDepthTexture)Ht=s.DEPTH_COMPONENT16,G.type===hl?Ht=s.DEPTH_COMPONENT32F:G.type===mm?Ht=s.DEPTH_COMPONENT24:G.type===Iy&&(Ht=s.DEPTH24_STENCIL8),_e&&(Ai?i.texStorage2D(s.TEXTURE_2D,1,Ht,Ke.width,Ke.height):i.texImage2D(s.TEXTURE_2D,0,Ht,Ke.width,Ke.height,0,ht,ti,null));else if(G.isDataTexture)if(pi.length>0){Ai&&_e&&i.texStorage2D(s.TEXTURE_2D,fe,Ht,pi[0].width,pi[0].height);for(let Ve=0,Xe=pi.length;Ve<Xe;Ve++)Tt=pi[Ve],Ai?$e&&i.texSubImage2D(s.TEXTURE_2D,Ve,0,0,Tt.width,Tt.height,ht,ti,Tt.data):i.texImage2D(s.TEXTURE_2D,Ve,Ht,Tt.width,Tt.height,0,ht,ti,Tt.data);G.generateMipmaps=!1}else Ai?(_e&&i.texStorage2D(s.TEXTURE_2D,fe,Ht,Ke.width,Ke.height),$e&&i.texSubImage2D(s.TEXTURE_2D,0,0,0,Ke.width,Ke.height,ht,ti,Ke.data)):i.texImage2D(s.TEXTURE_2D,0,Ht,Ke.width,Ke.height,0,ht,ti,Ke.data);else if(G.isCompressedTexture)if(G.isCompressedArrayTexture){Ai&&_e&&i.texStorage3D(s.TEXTURE_2D_ARRAY,fe,Ht,pi[0].width,pi[0].height,Ke.depth);for(let Ve=0,Xe=pi.length;Ve<Xe;Ve++)Tt=pi[Ve],G.format!==qo?ht!==null?Ai?$e&&i.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,Ve,0,0,0,Tt.width,Tt.height,Ke.depth,ht,Tt.data,0,0):i.compressedTexImage3D(s.TEXTURE_2D_ARRAY,Ve,Ht,Tt.width,Tt.height,Ke.depth,0,Tt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ai?$e&&i.texSubImage3D(s.TEXTURE_2D_ARRAY,Ve,0,0,0,Tt.width,Tt.height,Ke.depth,ht,ti,Tt.data):i.texImage3D(s.TEXTURE_2D_ARRAY,Ve,Ht,Tt.width,Tt.height,Ke.depth,0,ht,ti,Tt.data)}else{Ai&&_e&&i.texStorage2D(s.TEXTURE_2D,fe,Ht,pi[0].width,pi[0].height);for(let Ve=0,Xe=pi.length;Ve<Xe;Ve++)Tt=pi[Ve],G.format!==qo?ht!==null?Ai?$e&&i.compressedTexSubImage2D(s.TEXTURE_2D,Ve,0,0,Tt.width,Tt.height,ht,Tt.data):i.compressedTexImage2D(s.TEXTURE_2D,Ve,Ht,Tt.width,Tt.height,0,Tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ai?$e&&i.texSubImage2D(s.TEXTURE_2D,Ve,0,0,Tt.width,Tt.height,ht,ti,Tt.data):i.texImage2D(s.TEXTURE_2D,Ve,Ht,Tt.width,Tt.height,0,ht,ti,Tt.data)}else if(G.isDataArrayTexture)Ai?(_e&&i.texStorage3D(s.TEXTURE_2D_ARRAY,fe,Ht,Ke.width,Ke.height,Ke.depth),$e&&i.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,Ke.width,Ke.height,Ke.depth,ht,ti,Ke.data)):i.texImage3D(s.TEXTURE_2D_ARRAY,0,Ht,Ke.width,Ke.height,Ke.depth,0,ht,ti,Ke.data);else if(G.isData3DTexture)Ai?(_e&&i.texStorage3D(s.TEXTURE_3D,fe,Ht,Ke.width,Ke.height,Ke.depth),$e&&i.texSubImage3D(s.TEXTURE_3D,0,0,0,0,Ke.width,Ke.height,Ke.depth,ht,ti,Ke.data)):i.texImage3D(s.TEXTURE_3D,0,Ht,Ke.width,Ke.height,Ke.depth,0,ht,ti,Ke.data);else if(G.isFramebufferTexture){if(_e)if(Ai)i.texStorage2D(s.TEXTURE_2D,fe,Ht,Ke.width,Ke.height);else{let Ve=Ke.width,Xe=Ke.height;for(let at=0;at<fe;at++)i.texImage2D(s.TEXTURE_2D,at,Ht,Ve,Xe,0,ht,ti,null),Ve>>=1,Xe>>=1}}else if(pi.length>0){if(Ai&&_e){const Ve=Ee(pi[0]);i.texStorage2D(s.TEXTURE_2D,fe,Ht,Ve.width,Ve.height)}for(let Ve=0,Xe=pi.length;Ve<Xe;Ve++)Tt=pi[Ve],Ai?$e&&i.texSubImage2D(s.TEXTURE_2D,Ve,0,0,ht,ti,Tt):i.texImage2D(s.TEXTURE_2D,Ve,Ht,ht,ti,Tt);G.generateMipmaps=!1}else if(Ai){if(_e){const Ve=Ee(Ke);i.texStorage2D(s.TEXTURE_2D,fe,Ht,Ve.width,Ve.height)}$e&&i.texSubImage2D(s.TEXTURE_2D,0,0,0,ht,ti,Ke)}else i.texImage2D(s.TEXTURE_2D,0,Ht,ht,ti,Ke);w(G)&&O(de),je.__version=Ae.version,G.onUpdate&&G.onUpdate(G)}Z.__version=G.version}function tt(Z,G,ce){if(G.image.length!==6)return;const de=pe(Z,G),Oe=G.source;i.bindTexture(s.TEXTURE_CUBE_MAP,Z.__webglTexture,s.TEXTURE0+ce);const Ae=n.get(Oe);if(Oe.version!==Ae.__version||de===!0){i.activeTexture(s.TEXTURE0+ce);const je=Mn.getPrimaries(Mn.workingColorSpace),Ge=G.colorSpace===Qh?null:Mn.getPrimaries(G.colorSpace),Qe=G.colorSpace===Qh||je===Ge?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,G.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,G.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Qe);const yt=G.isCompressedTexture||G.image[0].isCompressedTexture,Ke=G.image[0]&&G.image[0].isDataTexture,ht=[];for(let Xe=0;Xe<6;Xe++)!yt&&!Ke?ht[Xe]=_(G.image[Xe],!0,r.maxCubemapSize):ht[Xe]=Ke?G.image[Xe].image:G.image[Xe],ht[Xe]=be(G,ht[Xe]);const ti=ht[0],Ht=o.convert(G.format,G.colorSpace),Tt=o.convert(G.type),pi=T(G.internalFormat,Ht,Tt,G.colorSpace),Ai=G.isVideoTexture!==!0,_e=Ae.__version===void 0||de===!0,$e=Oe.dataReady;let fe=C(G,ti);oe(s.TEXTURE_CUBE_MAP,G);let Ve;if(yt){Ai&&_e&&i.texStorage2D(s.TEXTURE_CUBE_MAP,fe,pi,ti.width,ti.height);for(let Xe=0;Xe<6;Xe++){Ve=ht[Xe].mipmaps;for(let at=0;at<Ve.length;at++){const pt=Ve[at];G.format!==qo?Ht!==null?Ai?$e&&i.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,at,0,0,pt.width,pt.height,Ht,pt.data):i.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,at,pi,pt.width,pt.height,0,pt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ai?$e&&i.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,at,0,0,pt.width,pt.height,Ht,Tt,pt.data):i.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,at,pi,pt.width,pt.height,0,Ht,Tt,pt.data)}}}else{if(Ve=G.mipmaps,Ai&&_e){Ve.length>0&&fe++;const Xe=Ee(ht[0]);i.texStorage2D(s.TEXTURE_CUBE_MAP,fe,pi,Xe.width,Xe.height)}for(let Xe=0;Xe<6;Xe++)if(Ke){Ai?$e&&i.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,0,0,0,ht[Xe].width,ht[Xe].height,Ht,Tt,ht[Xe].data):i.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,0,pi,ht[Xe].width,ht[Xe].height,0,Ht,Tt,ht[Xe].data);for(let at=0;at<Ve.length;at++){const Gi=Ve[at].image[Xe].image;Ai?$e&&i.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,at+1,0,0,Gi.width,Gi.height,Ht,Tt,Gi.data):i.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,at+1,pi,Gi.width,Gi.height,0,Ht,Tt,Gi.data)}}else{Ai?$e&&i.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,0,0,0,Ht,Tt,ht[Xe]):i.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,0,pi,Ht,Tt,ht[Xe]);for(let at=0;at<Ve.length;at++){const pt=Ve[at];Ai?$e&&i.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,at+1,0,0,Ht,Tt,pt.image[Xe]):i.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,at+1,pi,Ht,Tt,pt.image[Xe])}}}w(G)&&O(s.TEXTURE_CUBE_MAP),Ae.__version=Oe.version,G.onUpdate&&G.onUpdate(G)}Z.__version=G.version}function ve(Z,G,ce,de,Oe,Ae){const je=o.convert(ce.format,ce.colorSpace),Ge=o.convert(ce.type),Qe=T(ce.internalFormat,je,Ge,ce.colorSpace);if(!n.get(G).__hasExternalTextures){const Ke=Math.max(1,G.width>>Ae),ht=Math.max(1,G.height>>Ae);Oe===s.TEXTURE_3D||Oe===s.TEXTURE_2D_ARRAY?i.texImage3D(Oe,Ae,Qe,Ke,ht,G.depth,0,je,Ge,null):i.texImage2D(Oe,Ae,Qe,Ke,ht,0,je,Ge,null)}i.bindFramebuffer(s.FRAMEBUFFER,Z),le(G)?l.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,de,Oe,n.get(ce).__webglTexture,0,q(G)):(Oe===s.TEXTURE_2D||Oe>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&Oe<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,de,Oe,n.get(ce).__webglTexture,Ae),i.bindFramebuffer(s.FRAMEBUFFER,null)}function Re(Z,G,ce){if(s.bindRenderbuffer(s.RENDERBUFFER,Z),G.depthBuffer&&!G.stencilBuffer){let de=s.DEPTH_COMPONENT24;if(ce||le(G)){const Oe=G.depthTexture;Oe&&Oe.isDepthTexture&&(Oe.type===hl?de=s.DEPTH_COMPONENT32F:Oe.type===mm&&(de=s.DEPTH_COMPONENT24));const Ae=q(G);le(G)?l.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Ae,de,G.width,G.height):s.renderbufferStorageMultisample(s.RENDERBUFFER,Ae,de,G.width,G.height)}else s.renderbufferStorage(s.RENDERBUFFER,de,G.width,G.height);s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,Z)}else if(G.depthBuffer&&G.stencilBuffer){const de=q(G);ce&&le(G)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,de,s.DEPTH24_STENCIL8,G.width,G.height):le(G)?l.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,de,s.DEPTH24_STENCIL8,G.width,G.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,G.width,G.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,Z)}else{const de=G.textures;for(let Oe=0;Oe<de.length;Oe++){const Ae=de[Oe],je=o.convert(Ae.format,Ae.colorSpace),Ge=o.convert(Ae.type),Qe=T(Ae.internalFormat,je,Ge,Ae.colorSpace),yt=q(G);ce&&le(G)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,yt,Qe,G.width,G.height):le(G)?l.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,yt,Qe,G.width,G.height):s.renderbufferStorage(s.RENDERBUFFER,Qe,G.width,G.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function Le(Z,G){if(G&&G.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(s.FRAMEBUFFER,Z),!(G.depthTexture&&G.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(G.depthTexture).__webglTexture||G.depthTexture.image.width!==G.width||G.depthTexture.image.height!==G.height)&&(G.depthTexture.image.width=G.width,G.depthTexture.image.height=G.height,G.depthTexture.needsUpdate=!0),V(G.depthTexture,0);const de=n.get(G.depthTexture).__webglTexture,Oe=q(G);if(G.depthTexture.format===Zp)le(G)?l.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,de,0,Oe):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,de,0);else if(G.depthTexture.format===oy)le(G)?l.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,de,0,Oe):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,de,0);else throw new Error("Unknown depthTexture format")}function De(Z){const G=n.get(Z),ce=Z.isWebGLCubeRenderTarget===!0;if(Z.depthTexture&&!G.__autoAllocateDepthBuffer){if(ce)throw new Error("target.depthTexture not supported in Cube render targets");Le(G.__webglFramebuffer,Z)}else if(ce){G.__webglDepthbuffer=[];for(let de=0;de<6;de++)i.bindFramebuffer(s.FRAMEBUFFER,G.__webglFramebuffer[de]),G.__webglDepthbuffer[de]=s.createRenderbuffer(),Re(G.__webglDepthbuffer[de],Z,!1)}else i.bindFramebuffer(s.FRAMEBUFFER,G.__webglFramebuffer),G.__webglDepthbuffer=s.createRenderbuffer(),Re(G.__webglDepthbuffer,Z,!1);i.bindFramebuffer(s.FRAMEBUFFER,null)}function Se(Z,G,ce){const de=n.get(Z);G!==void 0&&ve(de.__webglFramebuffer,Z,Z.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),ce!==void 0&&De(Z)}function Y(Z){const G=Z.texture,ce=n.get(Z),de=n.get(G);Z.addEventListener("dispose",B);const Oe=Z.textures,Ae=Z.isWebGLCubeRenderTarget===!0,je=Oe.length>1;if(je||(de.__webglTexture===void 0&&(de.__webglTexture=s.createTexture()),de.__version=G.version,a.memory.textures++),Ae){ce.__webglFramebuffer=[];for(let Ge=0;Ge<6;Ge++)if(G.mipmaps&&G.mipmaps.length>0){ce.__webglFramebuffer[Ge]=[];for(let Qe=0;Qe<G.mipmaps.length;Qe++)ce.__webglFramebuffer[Ge][Qe]=s.createFramebuffer()}else ce.__webglFramebuffer[Ge]=s.createFramebuffer()}else{if(G.mipmaps&&G.mipmaps.length>0){ce.__webglFramebuffer=[];for(let Ge=0;Ge<G.mipmaps.length;Ge++)ce.__webglFramebuffer[Ge]=s.createFramebuffer()}else ce.__webglFramebuffer=s.createFramebuffer();if(je)for(let Ge=0,Qe=Oe.length;Ge<Qe;Ge++){const yt=n.get(Oe[Ge]);yt.__webglTexture===void 0&&(yt.__webglTexture=s.createTexture(),a.memory.textures++)}if(Z.samples>0&&le(Z)===!1){ce.__webglMultisampledFramebuffer=s.createFramebuffer(),ce.__webglColorRenderbuffer=[],i.bindFramebuffer(s.FRAMEBUFFER,ce.__webglMultisampledFramebuffer);for(let Ge=0;Ge<Oe.length;Ge++){const Qe=Oe[Ge];ce.__webglColorRenderbuffer[Ge]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,ce.__webglColorRenderbuffer[Ge]);const yt=o.convert(Qe.format,Qe.colorSpace),Ke=o.convert(Qe.type),ht=T(Qe.internalFormat,yt,Ke,Qe.colorSpace,Z.isXRRenderTarget===!0),ti=q(Z);s.renderbufferStorageMultisample(s.RENDERBUFFER,ti,ht,Z.width,Z.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Ge,s.RENDERBUFFER,ce.__webglColorRenderbuffer[Ge])}s.bindRenderbuffer(s.RENDERBUFFER,null),Z.depthBuffer&&(ce.__webglDepthRenderbuffer=s.createRenderbuffer(),Re(ce.__webglDepthRenderbuffer,Z,!0)),i.bindFramebuffer(s.FRAMEBUFFER,null)}}if(Ae){i.bindTexture(s.TEXTURE_CUBE_MAP,de.__webglTexture),oe(s.TEXTURE_CUBE_MAP,G);for(let Ge=0;Ge<6;Ge++)if(G.mipmaps&&G.mipmaps.length>0)for(let Qe=0;Qe<G.mipmaps.length;Qe++)ve(ce.__webglFramebuffer[Ge][Qe],Z,G,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Qe);else ve(ce.__webglFramebuffer[Ge],Z,G,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0);w(G)&&O(s.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(je){for(let Ge=0,Qe=Oe.length;Ge<Qe;Ge++){const yt=Oe[Ge],Ke=n.get(yt);i.bindTexture(s.TEXTURE_2D,Ke.__webglTexture),oe(s.TEXTURE_2D,yt),ve(ce.__webglFramebuffer,Z,yt,s.COLOR_ATTACHMENT0+Ge,s.TEXTURE_2D,0),w(yt)&&O(s.TEXTURE_2D)}i.unbindTexture()}else{let Ge=s.TEXTURE_2D;if((Z.isWebGL3DRenderTarget||Z.isWebGLArrayRenderTarget)&&(Ge=Z.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),i.bindTexture(Ge,de.__webglTexture),oe(Ge,G),G.mipmaps&&G.mipmaps.length>0)for(let Qe=0;Qe<G.mipmaps.length;Qe++)ve(ce.__webglFramebuffer[Qe],Z,G,s.COLOR_ATTACHMENT0,Ge,Qe);else ve(ce.__webglFramebuffer,Z,G,s.COLOR_ATTACHMENT0,Ge,0);w(G)&&O(Ge),i.unbindTexture()}Z.depthBuffer&&De(Z)}function W(Z){const G=Z.textures;for(let ce=0,de=G.length;ce<de;ce++){const Oe=G[ce];if(w(Oe)){const Ae=Z.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D,je=n.get(Oe).__webglTexture;i.bindTexture(Ae,je),O(Ae),i.unbindTexture()}}}const te=[],ae=[];function z(Z){if(Z.samples>0){if(le(Z)===!1){const G=Z.textures,ce=Z.width,de=Z.height;let Oe=s.COLOR_BUFFER_BIT;const Ae=Z.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,je=n.get(Z),Ge=G.length>1;if(Ge)for(let Qe=0;Qe<G.length;Qe++)i.bindFramebuffer(s.FRAMEBUFFER,je.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Qe,s.RENDERBUFFER,null),i.bindFramebuffer(s.FRAMEBUFFER,je.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Qe,s.TEXTURE_2D,null,0);i.bindFramebuffer(s.READ_FRAMEBUFFER,je.__webglMultisampledFramebuffer),i.bindFramebuffer(s.DRAW_FRAMEBUFFER,je.__webglFramebuffer);for(let Qe=0;Qe<G.length;Qe++){if(Z.resolveDepthBuffer&&(Z.depthBuffer&&(Oe|=s.DEPTH_BUFFER_BIT),Z.stencilBuffer&&Z.resolveStencilBuffer&&(Oe|=s.STENCIL_BUFFER_BIT)),Ge){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,je.__webglColorRenderbuffer[Qe]);const yt=n.get(G[Qe]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,yt,0)}s.blitFramebuffer(0,0,ce,de,0,0,ce,de,Oe,s.NEAREST),h===!0&&(te.length=0,ae.length=0,te.push(s.COLOR_ATTACHMENT0+Qe),Z.depthBuffer&&Z.resolveDepthBuffer===!1&&(te.push(Ae),ae.push(Ae),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,ae)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,te))}if(i.bindFramebuffer(s.READ_FRAMEBUFFER,null),i.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),Ge)for(let Qe=0;Qe<G.length;Qe++){i.bindFramebuffer(s.FRAMEBUFFER,je.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Qe,s.RENDERBUFFER,je.__webglColorRenderbuffer[Qe]);const yt=n.get(G[Qe]).__webglTexture;i.bindFramebuffer(s.FRAMEBUFFER,je.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Qe,s.TEXTURE_2D,yt,0)}i.bindFramebuffer(s.DRAW_FRAMEBUFFER,je.__webglMultisampledFramebuffer)}else if(Z.depthBuffer&&Z.resolveDepthBuffer===!1&&h){const G=Z.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[G])}}}function q(Z){return Math.min(r.maxSamples,Z.samples)}function le(Z){const G=n.get(Z);return Z.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&G.__useRenderToTexture!==!1}function he(Z){const G=a.render.frame;f.get(Z)!==G&&(f.set(Z,G),Z.update())}function be(Z,G){const ce=Z.colorSpace,de=Z.format,Oe=Z.type;return Z.isCompressedTexture===!0||Z.isVideoTexture===!0||ce!==Mu&&ce!==Qh&&(Mn.getTransfer(ce)===Hn?(de!==qo||Oe!==sc)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ce)),G}function Ee(Z){return typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement?(d.width=Z.naturalWidth||Z.width,d.height=Z.naturalHeight||Z.height):typeof VideoFrame<"u"&&Z instanceof VideoFrame?(d.width=Z.displayWidth,d.height=Z.displayHeight):(d.width=Z.width,d.height=Z.height),d}this.allocateTextureUnit=D,this.resetTextureUnits=E,this.setTexture2D=V,this.setTexture2DArray=F,this.setTexture3D=j,this.setTextureCube=Q,this.rebindTextures=Se,this.setupRenderTarget=Y,this.updateRenderTargetMipmap=W,this.updateMultisampleRenderTarget=z,this.setupDepthRenderbuffer=De,this.setupFrameBufferTexture=ve,this.useMultisampledRTT=le}function vY(s,e){function i(n,r=Qh){let o;const a=Mn.getTransfer(r);if(n===sc)return s.UNSIGNED_BYTE;if(n===qD)return s.UNSIGNED_SHORT_4_4_4_4;if(n===ZD)return s.UNSIGNED_SHORT_5_5_5_1;if(n===N9)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===D9)return s.BYTE;if(n===L9)return s.SHORT;if(n===YD)return s.UNSIGNED_SHORT;if(n===jD)return s.INT;if(n===mm)return s.UNSIGNED_INT;if(n===hl)return s.FLOAT;if(n===Py)return s.HALF_FLOAT;if(n===V9)return s.ALPHA;if(n===$9)return s.RGB;if(n===qo)return s.RGBA;if(n===U9)return s.LUMINANCE;if(n===F9)return s.LUMINANCE_ALPHA;if(n===Zp)return s.DEPTH_COMPONENT;if(n===oy)return s.DEPTH_STENCIL;if(n===KD)return s.RED;if(n===JD)return s.RED_INTEGER;if(n===z9)return s.RG;if(n===eL)return s.RG_INTEGER;if(n===tL)return s.RGBA_INTEGER;if(n===US||n===FS||n===zS||n===XS)if(a===Hn)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(n===US)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===FS)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===zS)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===XS)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(n===US)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===FS)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===zS)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===XS)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===KI||n===JI||n===eB||n===tB)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(n===KI)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===JI)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===eB)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===tB)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===iB||n===nB||n===sB)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(n===iB||n===nB)return a===Hn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(n===sB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===rB||n===oB||n===aB||n===lB||n===cB||n===hB||n===uB||n===dB||n===fB||n===pB||n===mB||n===gB||n===yB||n===vB)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(n===rB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===oB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===aB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===lB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===cB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===hB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===uB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===dB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===fB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===pB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===mB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===gB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===yB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===vB)return a===Hn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===WS||n===xB||n===_B)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(n===WS)return a===Hn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===xB)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===_B)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===X9||n===bB||n===wB||n===OB)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(n===WS)return o.COMPRESSED_RED_RGTC1_EXT;if(n===bB)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===wB)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===OB)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Iy?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:i}}class xY extends Rn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let f0=class extends vn{constructor(){super(),this.isGroup=!0,this.type="Group"}};const Oke={type:"move"};class oP{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new f0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new f0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ie),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new f0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ie),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const n of e.hand.values())this._getHandJoint(i,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,n){let r=null,o=null,a=null;const l=this._targetRay,h=this._grip,d=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(d&&e.hand){a=!0;for(const _ of e.hand.values()){const w=i.getJointPose(_,n),O=this._getHandJoint(d,_);w!==null&&(O.matrix.fromArray(w.transform.matrix),O.matrix.decompose(O.position,O.rotation,O.scale),O.matrixWorldNeedsUpdate=!0,O.jointRadius=w.radius),O.visible=w!==null}const f=d.joints["index-finger-tip"],p=d.joints["thumb-tip"],g=f.position.distanceTo(p.position),y=.02,x=.005;d.inputState.pinching&&g>y+x?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&g<=y-x&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(o=i.getPose(e.gripSpace,n),o!==null&&(h.matrix.fromArray(o.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,o.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(o.linearVelocity)):h.hasLinearVelocity=!1,o.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(o.angularVelocity)):h.hasAngularVelocity=!1));l!==null&&(r=i.getPose(e.targetRaySpace,n),r===null&&o!==null&&(r=o),r!==null&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(Oke)))}return l!==null&&(l.visible=r!==null),h!==null&&(h.visible=o!==null),d!==null&&(d.visible=a!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const n=new f0;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[i.jointName]=n,e.add(n)}return e.joints[i.jointName]}}const Ske=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Cke=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Tke{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,i,n){if(this.texture===null){const r=new cs,o=e.properties.get(r);o.__webglTexture=i.texture,(i.depthNear!=n.depthNear||i.depthFar!=n.depthFar)&&(this.depthNear=i.depthNear,this.depthFar=i.depthFar),this.texture=r}}render(e,i){if(this.texture!==null){if(this.mesh===null){const n=i.cameras[0].viewport,r=new Ao({vertexShader:Ske,fragmentShader:Cke,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Dn(new _f(20,20),r)}e.render(this.mesh,i)}}reset(){this.texture=null,this.mesh=null}}class Ake extends ch{constructor(e,i){super();const n=this;let r=null,o=1,a=null,l="local-floor",h=1,d=null,f=null,p=null,g=null,y=null,x=null;const _=new Tke,w=i.getContextAttributes();let O=null,T=null;const C=[],A=[],B=new Fe;let I=null;const R=new Rn;R.layers.enable(1),R.viewport=new sn;const P=new Rn;P.layers.enable(2),P.viewport=new sn;const k=[R,P],E=new xY;E.layers.enable(1),E.layers.enable(2);let D=null,L=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ve){let Re=C[ve];return Re===void 0&&(Re=new oP,C[ve]=Re),Re.getTargetRaySpace()},this.getControllerGrip=function(ve){let Re=C[ve];return Re===void 0&&(Re=new oP,C[ve]=Re),Re.getGripSpace()},this.getHand=function(ve){let Re=C[ve];return Re===void 0&&(Re=new oP,C[ve]=Re),Re.getHandSpace()};function V(ve){const Re=A.indexOf(ve.inputSource);if(Re===-1)return;const Le=C[Re];Le!==void 0&&(Le.update(ve.inputSource,ve.frame,d||a),Le.dispatchEvent({type:ve.type,data:ve.inputSource}))}function F(){r.removeEventListener("select",V),r.removeEventListener("selectstart",V),r.removeEventListener("selectend",V),r.removeEventListener("squeeze",V),r.removeEventListener("squeezestart",V),r.removeEventListener("squeezeend",V),r.removeEventListener("end",F),r.removeEventListener("inputsourceschange",j);for(let ve=0;ve<C.length;ve++){const Re=A[ve];Re!==null&&(A[ve]=null,C[ve].disconnect(Re))}D=null,L=null,_.reset(),e.setRenderTarget(O),y=null,g=null,p=null,r=null,T=null,tt.stop(),n.isPresenting=!1,e.setPixelRatio(I),e.setSize(B.width,B.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ve){o=ve,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ve){l=ve,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||a},this.setReferenceSpace=function(ve){d=ve},this.getBaseLayer=function(){return g!==null?g:y},this.getBinding=function(){return p},this.getFrame=function(){return x},this.getSession=function(){return r},this.setSession=async function(ve){if(r=ve,r!==null){if(O=e.getRenderTarget(),r.addEventListener("select",V),r.addEventListener("selectstart",V),r.addEventListener("selectend",V),r.addEventListener("squeeze",V),r.addEventListener("squeezestart",V),r.addEventListener("squeezeend",V),r.addEventListener("end",F),r.addEventListener("inputsourceschange",j),w.xrCompatible!==!0&&await i.makeXRCompatible(),I=e.getPixelRatio(),e.getSize(B),r.renderState.layers===void 0){const Re={antialias:w.antialias,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:o};y=new XRWebGLLayer(r,i,Re),r.updateRenderState({baseLayer:y}),e.setPixelRatio(1),e.setSize(y.framebufferWidth,y.framebufferHeight,!1),T=new gl(y.framebufferWidth,y.framebufferHeight,{format:qo,type:sc,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil})}else{let Re=null,Le=null,De=null;w.depth&&(De=w.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,Re=w.stencil?oy:Zp,Le=w.stencil?Iy:mm);const Se={colorFormat:i.RGBA8,depthFormat:De,scaleFactor:o};p=new XRWebGLBinding(r,i),g=p.createProjectionLayer(Se),r.updateRenderState({layers:[g]}),e.setPixelRatio(1),e.setSize(g.textureWidth,g.textureHeight,!1),T=new gl(g.textureWidth,g.textureHeight,{format:qo,type:sc,depthTexture:new cL(g.textureWidth,g.textureHeight,Le,void 0,void 0,void 0,void 0,void 0,void 0,Re),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0,resolveDepthBuffer:g.ignoreDepthValues===!1})}T.isXRRenderTarget=!0,this.setFoveation(h),d=null,a=await r.requestReferenceSpace(l),tt.setContext(r),tt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function j(ve){for(let Re=0;Re<ve.removed.length;Re++){const Le=ve.removed[Re],De=A.indexOf(Le);De>=0&&(A[De]=null,C[De].disconnect(Le))}for(let Re=0;Re<ve.added.length;Re++){const Le=ve.added[Re];let De=A.indexOf(Le);if(De===-1){for(let Y=0;Y<C.length;Y++)if(Y>=A.length){A.push(Le),De=Y;break}else if(A[Y]===null){A[Y]=Le,De=Y;break}if(De===-1)break}const Se=C[De];Se&&Se.connect(Le)}}const Q=new ie,ee=new ie;function J(ve,Re,Le){Q.setFromMatrixPosition(Re.matrixWorld),ee.setFromMatrixPosition(Le.matrixWorld);const De=Q.distanceTo(ee),Se=Re.projectionMatrix.elements,Y=Le.projectionMatrix.elements,W=Se[14]/(Se[10]-1),te=Se[14]/(Se[10]+1),ae=(Se[9]+1)/Se[5],z=(Se[9]-1)/Se[5],q=(Se[8]-1)/Se[0],le=(Y[8]+1)/Y[0],he=W*q,be=W*le,Ee=De/(-q+le),Z=Ee*-q;Re.matrixWorld.decompose(ve.position,ve.quaternion,ve.scale),ve.translateX(Z),ve.translateZ(Ee),ve.matrixWorld.compose(ve.position,ve.quaternion,ve.scale),ve.matrixWorldInverse.copy(ve.matrixWorld).invert();const G=W+Ee,ce=te+Ee,de=he-Z,Oe=be+(De-Z),Ae=ae*te/ce*G,je=z*te/ce*G;ve.projectionMatrix.makePerspective(de,Oe,Ae,je,G,ce),ve.projectionMatrixInverse.copy(ve.projectionMatrix).invert()}function ue(ve,Re){Re===null?ve.matrixWorld.copy(ve.matrix):ve.matrixWorld.multiplyMatrices(Re.matrixWorld,ve.matrix),ve.matrixWorldInverse.copy(ve.matrixWorld).invert()}this.updateCamera=function(ve){if(r===null)return;_.texture!==null&&(ve.near=_.depthNear,ve.far=_.depthFar),E.near=P.near=R.near=ve.near,E.far=P.far=R.far=ve.far,(D!==E.near||L!==E.far)&&(r.updateRenderState({depthNear:E.near,depthFar:E.far}),D=E.near,L=E.far,R.near=D,R.far=L,P.near=D,P.far=L,R.updateProjectionMatrix(),P.updateProjectionMatrix(),ve.updateProjectionMatrix());const Re=ve.parent,Le=E.cameras;ue(E,Re);for(let De=0;De<Le.length;De++)ue(Le[De],Re);Le.length===2?J(E,R,P):E.projectionMatrix.copy(R.projectionMatrix),oe(ve,E,Re)};function oe(ve,Re,Le){Le===null?ve.matrix.copy(Re.matrixWorld):(ve.matrix.copy(Le.matrixWorld),ve.matrix.invert(),ve.matrix.multiply(Re.matrixWorld)),ve.matrix.decompose(ve.position,ve.quaternion,ve.scale),ve.updateMatrixWorld(!0),ve.projectionMatrix.copy(Re.projectionMatrix),ve.projectionMatrixInverse.copy(Re.projectionMatrixInverse),ve.isPerspectiveCamera&&(ve.fov=cy*2*Math.atan(1/ve.projectionMatrix.elements[5]),ve.zoom=1)}this.getCamera=function(){return E},this.getFoveation=function(){if(!(g===null&&y===null))return h},this.setFoveation=function(ve){h=ve,g!==null&&(g.fixedFoveation=ve),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=ve)},this.hasDepthSensing=function(){return _.texture!==null};let pe=null;function Ue(ve,Re){if(f=Re.getViewerPose(d||a),x=Re,f!==null){const Le=f.views;y!==null&&(e.setRenderTargetFramebuffer(T,y.framebuffer),e.setRenderTarget(T));let De=!1;Le.length!==E.cameras.length&&(E.cameras.length=0,De=!0);for(let Y=0;Y<Le.length;Y++){const W=Le[Y];let te=null;if(y!==null)te=y.getViewport(W);else{const z=p.getViewSubImage(g,W);te=z.viewport,Y===0&&(e.setRenderTargetTextures(T,z.colorTexture,g.ignoreDepthValues?void 0:z.depthStencilTexture),e.setRenderTarget(T))}let ae=k[Y];ae===void 0&&(ae=new Rn,ae.layers.enable(Y),ae.viewport=new sn,k[Y]=ae),ae.matrix.fromArray(W.transform.matrix),ae.matrix.decompose(ae.position,ae.quaternion,ae.scale),ae.projectionMatrix.fromArray(W.projectionMatrix),ae.projectionMatrixInverse.copy(ae.projectionMatrix).invert(),ae.viewport.set(te.x,te.y,te.width,te.height),Y===0&&(E.matrix.copy(ae.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),De===!0&&E.cameras.push(ae)}const Se=r.enabledFeatures;if(Se&&Se.includes("depth-sensing")){const Y=p.getDepthInformation(Le[0]);Y&&Y.isValid&&Y.texture&&_.init(e,Y,r.renderState)}}for(let Le=0;Le<C.length;Le++){const De=A[Le],Se=C[Le];De!==null&&Se!==void 0&&Se.update(De,Re,d||a)}_.render(e,E),pe&&pe(ve,Re),Re.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Re}),x=null}const tt=new dY;tt.setAnimationLoop(Ue),this.setAnimationLoop=function(ve){pe=ve},this.dispose=function(){}}}const jf=new To,Eke=new ri;function Mke(s,e){function i(w,O){w.matrixAutoUpdate===!0&&w.updateMatrix(),O.value.copy(w.matrix)}function n(w,O){O.color.getRGB(w.fogColor.value,cY(s)),O.isFog?(w.fogNear.value=O.near,w.fogFar.value=O.far):O.isFogExp2&&(w.fogDensity.value=O.density)}function r(w,O,T,C,A){O.isMeshBasicMaterial||O.isMeshLambertMaterial?o(w,O):O.isMeshToonMaterial?(o(w,O),p(w,O)):O.isMeshPhongMaterial?(o(w,O),f(w,O)):O.isMeshStandardMaterial?(o(w,O),g(w,O),O.isMeshPhysicalMaterial&&y(w,O,A)):O.isMeshMatcapMaterial?(o(w,O),x(w,O)):O.isMeshDepthMaterial?o(w,O):O.isMeshDistanceMaterial?(o(w,O),_(w,O)):O.isMeshNormalMaterial?o(w,O):O.isLineBasicMaterial?(a(w,O),O.isLineDashedMaterial&&l(w,O)):O.isPointsMaterial?h(w,O,T,C):O.isSpriteMaterial?d(w,O):O.isShadowMaterial?(w.color.value.copy(O.color),w.opacity.value=O.opacity):O.isShaderMaterial&&(O.uniformsNeedUpdate=!1)}function o(w,O){w.opacity.value=O.opacity,O.color&&w.diffuse.value.copy(O.color),O.emissive&&w.emissive.value.copy(O.emissive).multiplyScalar(O.emissiveIntensity),O.map&&(w.map.value=O.map,i(O.map,w.mapTransform)),O.alphaMap&&(w.alphaMap.value=O.alphaMap,i(O.alphaMap,w.alphaMapTransform)),O.bumpMap&&(w.bumpMap.value=O.bumpMap,i(O.bumpMap,w.bumpMapTransform),w.bumpScale.value=O.bumpScale,O.side===qr&&(w.bumpScale.value*=-1)),O.normalMap&&(w.normalMap.value=O.normalMap,i(O.normalMap,w.normalMapTransform),w.normalScale.value.copy(O.normalScale),O.side===qr&&w.normalScale.value.negate()),O.displacementMap&&(w.displacementMap.value=O.displacementMap,i(O.displacementMap,w.displacementMapTransform),w.displacementScale.value=O.displacementScale,w.displacementBias.value=O.displacementBias),O.emissiveMap&&(w.emissiveMap.value=O.emissiveMap,i(O.emissiveMap,w.emissiveMapTransform)),O.specularMap&&(w.specularMap.value=O.specularMap,i(O.specularMap,w.specularMapTransform)),O.alphaTest>0&&(w.alphaTest.value=O.alphaTest);const T=e.get(O),C=T.envMap,A=T.envMapRotation;if(C&&(w.envMap.value=C,jf.copy(A),jf.x*=-1,jf.y*=-1,jf.z*=-1,C.isCubeTexture&&C.isRenderTargetTexture===!1&&(jf.y*=-1,jf.z*=-1),w.envMapRotation.value.setFromMatrix4(Eke.makeRotationFromEuler(jf)),w.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=O.reflectivity,w.ior.value=O.ior,w.refractionRatio.value=O.refractionRatio),O.lightMap){w.lightMap.value=O.lightMap;const B=s._useLegacyLights===!0?Math.PI:1;w.lightMapIntensity.value=O.lightMapIntensity*B,i(O.lightMap,w.lightMapTransform)}O.aoMap&&(w.aoMap.value=O.aoMap,w.aoMapIntensity.value=O.aoMapIntensity,i(O.aoMap,w.aoMapTransform))}function a(w,O){w.diffuse.value.copy(O.color),w.opacity.value=O.opacity,O.map&&(w.map.value=O.map,i(O.map,w.mapTransform))}function l(w,O){w.dashSize.value=O.dashSize,w.totalSize.value=O.dashSize+O.gapSize,w.scale.value=O.scale}function h(w,O,T,C){w.diffuse.value.copy(O.color),w.opacity.value=O.opacity,w.size.value=O.size*T,w.scale.value=C*.5,O.map&&(w.map.value=O.map,i(O.map,w.uvTransform)),O.alphaMap&&(w.alphaMap.value=O.alphaMap,i(O.alphaMap,w.alphaMapTransform)),O.alphaTest>0&&(w.alphaTest.value=O.alphaTest)}function d(w,O){w.diffuse.value.copy(O.color),w.opacity.value=O.opacity,w.rotation.value=O.rotation,O.map&&(w.map.value=O.map,i(O.map,w.mapTransform)),O.alphaMap&&(w.alphaMap.value=O.alphaMap,i(O.alphaMap,w.alphaMapTransform)),O.alphaTest>0&&(w.alphaTest.value=O.alphaTest)}function f(w,O){w.specular.value.copy(O.specular),w.shininess.value=Math.max(O.shininess,1e-4)}function p(w,O){O.gradientMap&&(w.gradientMap.value=O.gradientMap)}function g(w,O){w.metalness.value=O.metalness,O.metalnessMap&&(w.metalnessMap.value=O.metalnessMap,i(O.metalnessMap,w.metalnessMapTransform)),w.roughness.value=O.roughness,O.roughnessMap&&(w.roughnessMap.value=O.roughnessMap,i(O.roughnessMap,w.roughnessMapTransform)),O.envMap&&(w.envMapIntensity.value=O.envMapIntensity)}function y(w,O,T){w.ior.value=O.ior,O.sheen>0&&(w.sheenColor.value.copy(O.sheenColor).multiplyScalar(O.sheen),w.sheenRoughness.value=O.sheenRoughness,O.sheenColorMap&&(w.sheenColorMap.value=O.sheenColorMap,i(O.sheenColorMap,w.sheenColorMapTransform)),O.sheenRoughnessMap&&(w.sheenRoughnessMap.value=O.sheenRoughnessMap,i(O.sheenRoughnessMap,w.sheenRoughnessMapTransform))),O.clearcoat>0&&(w.clearcoat.value=O.clearcoat,w.clearcoatRoughness.value=O.clearcoatRoughness,O.clearcoatMap&&(w.clearcoatMap.value=O.clearcoatMap,i(O.clearcoatMap,w.clearcoatMapTransform)),O.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=O.clearcoatRoughnessMap,i(O.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),O.clearcoatNormalMap&&(w.clearcoatNormalMap.value=O.clearcoatNormalMap,i(O.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(O.clearcoatNormalScale),O.side===qr&&w.clearcoatNormalScale.value.negate())),O.dispersion>0&&(w.dispersion.value=O.dispersion),O.iridescence>0&&(w.iridescence.value=O.iridescence,w.iridescenceIOR.value=O.iridescenceIOR,w.iridescenceThicknessMinimum.value=O.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=O.iridescenceThicknessRange[1],O.iridescenceMap&&(w.iridescenceMap.value=O.iridescenceMap,i(O.iridescenceMap,w.iridescenceMapTransform)),O.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=O.iridescenceThicknessMap,i(O.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),O.transmission>0&&(w.transmission.value=O.transmission,w.transmissionSamplerMap.value=T.texture,w.transmissionSamplerSize.value.set(T.width,T.height),O.transmissionMap&&(w.transmissionMap.value=O.transmissionMap,i(O.transmissionMap,w.transmissionMapTransform)),w.thickness.value=O.thickness,O.thicknessMap&&(w.thicknessMap.value=O.thicknessMap,i(O.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=O.attenuationDistance,w.attenuationColor.value.copy(O.attenuationColor)),O.anisotropy>0&&(w.anisotropyVector.value.set(O.anisotropy*Math.cos(O.anisotropyRotation),O.anisotropy*Math.sin(O.anisotropyRotation)),O.anisotropyMap&&(w.anisotropyMap.value=O.anisotropyMap,i(O.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=O.specularIntensity,w.specularColor.value.copy(O.specularColor),O.specularColorMap&&(w.specularColorMap.value=O.specularColorMap,i(O.specularColorMap,w.specularColorMapTransform)),O.specularIntensityMap&&(w.specularIntensityMap.value=O.specularIntensityMap,i(O.specularIntensityMap,w.specularIntensityMapTransform))}function x(w,O){O.matcap&&(w.matcap.value=O.matcap)}function _(w,O){const T=e.get(O).light;w.referencePosition.value.setFromMatrixPosition(T.matrixWorld),w.nearDistance.value=T.shadow.camera.near,w.farDistance.value=T.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function kke(s,e,i,n){let r={},o={},a=[];const l=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function h(T,C){const A=C.program;n.uniformBlockBinding(T,A)}function d(T,C){let A=r[T.id];A===void 0&&(x(T),A=f(T),r[T.id]=A,T.addEventListener("dispose",w));const B=C.program;n.updateUBOMapping(T,B);const I=e.render.frame;o[T.id]!==I&&(g(T),o[T.id]=I)}function f(T){const C=p();T.__bindingPointIndex=C;const A=s.createBuffer(),B=T.__size,I=T.usage;return s.bindBuffer(s.UNIFORM_BUFFER,A),s.bufferData(s.UNIFORM_BUFFER,B,I),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,C,A),A}function p(){for(let T=0;T<l;T++)if(a.indexOf(T)===-1)return a.push(T),T;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function g(T){const C=r[T.id],A=T.uniforms,B=T.__cache;s.bindBuffer(s.UNIFORM_BUFFER,C);for(let I=0,R=A.length;I<R;I++){const P=Array.isArray(A[I])?A[I]:[A[I]];for(let k=0,E=P.length;k<E;k++){const D=P[k];if(y(D,I,k,B)===!0){const L=D.__offset,V=Array.isArray(D.value)?D.value:[D.value];let F=0;for(let j=0;j<V.length;j++){const Q=V[j],ee=_(Q);typeof Q=="number"||typeof Q=="boolean"?(D.__data[0]=Q,s.bufferSubData(s.UNIFORM_BUFFER,L+F,D.__data)):Q.isMatrix3?(D.__data[0]=Q.elements[0],D.__data[1]=Q.elements[1],D.__data[2]=Q.elements[2],D.__data[3]=0,D.__data[4]=Q.elements[3],D.__data[5]=Q.elements[4],D.__data[6]=Q.elements[5],D.__data[7]=0,D.__data[8]=Q.elements[6],D.__data[9]=Q.elements[7],D.__data[10]=Q.elements[8],D.__data[11]=0):(Q.toArray(D.__data,F),F+=ee.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,L,D.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function y(T,C,A,B){const I=T.value,R=C+"_"+A;if(B[R]===void 0)return typeof I=="number"||typeof I=="boolean"?B[R]=I:B[R]=I.clone(),!0;{const P=B[R];if(typeof I=="number"||typeof I=="boolean"){if(P!==I)return B[R]=I,!0}else if(P.equals(I)===!1)return P.copy(I),!0}return!1}function x(T){const C=T.uniforms;let A=0;const B=16;for(let R=0,P=C.length;R<P;R++){const k=Array.isArray(C[R])?C[R]:[C[R]];for(let E=0,D=k.length;E<D;E++){const L=k[E],V=Array.isArray(L.value)?L.value:[L.value];for(let F=0,j=V.length;F<j;F++){const Q=V[F],ee=_(Q),J=A%B;J!==0&&B-J<ee.boundary&&(A+=B-J),L.__data=new Float32Array(ee.storage/Float32Array.BYTES_PER_ELEMENT),L.__offset=A,A+=ee.storage}}}const I=A%B;return I>0&&(A+=B-I),T.__size=A,T.__cache={},this}function _(T){const C={boundary:0,storage:0};return typeof T=="number"||typeof T=="boolean"?(C.boundary=4,C.storage=4):T.isVector2?(C.boundary=8,C.storage=8):T.isVector3||T.isColor?(C.boundary=16,C.storage=12):T.isVector4?(C.boundary=16,C.storage=16):T.isMatrix3?(C.boundary=48,C.storage=48):T.isMatrix4?(C.boundary=64,C.storage=64):T.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",T),C}function w(T){const C=T.target;C.removeEventListener("dispose",w);const A=a.indexOf(C.__bindingPointIndex);a.splice(A,1),s.deleteBuffer(r[C.id]),delete r[C.id],delete o[C.id]}function O(){for(const T in r)s.deleteBuffer(r[T]);a=[],r={},o={}}return{bind:h,update:d,dispose:O}}class Qx{constructor(e={}){const{canvas:i=sY(),context:n=null,depth:r=!0,stencil:o=!1,alpha:a=!1,antialias:l=!1,premultipliedAlpha:h=!0,preserveDrawingBuffer:d=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:p=!1}=e;this.isWebGLRenderer=!0;let g;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");g=n.getContextAttributes().alpha}else g=a;const y=new Uint32Array(4),x=new Int32Array(4);let _=null,w=null;const O=[],T=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Ta,this._useLegacyLights=!1,this.toneMapping=cu,this.toneMappingExposure=1;const C=this;let A=!1,B=0,I=0,R=null,P=-1,k=null;const E=new sn,D=new sn;let L=null;const V=new ft(0);let F=0,j=i.width,Q=i.height,ee=1,J=null,ue=null;const oe=new sn(0,0,j,Q),pe=new sn(0,0,j,Q);let Ue=!1;const tt=new Tb;let ve=!1,Re=!1;const Le=new ri,De=new ie,Se={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Y(){return R===null?ee:1}let W=n;function te(se,Ce){return i.getContext(se,Ce)}try{const se={alpha:!0,depth:r,stencil:o,antialias:l,premultipliedAlpha:h,preserveDrawingBuffer:d,powerPreference:f,failIfMajorPerformanceCaveat:p};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${My}`),i.addEventListener("webglcontextlost",fe,!1),i.addEventListener("webglcontextrestored",Ve,!1),i.addEventListener("webglcontextcreationerror",Xe,!1),W===null){const Ce="webgl2";if(W=te(Ce,se),W===null)throw te(Ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(se){throw console.error("THREE.WebGLRenderer: "+se.message),se}let ae,z,q,le,he,be,Ee,Z,G,ce,de,Oe,Ae,je,Ge,Qe,yt,Ke,ht,ti,Ht,Tt,pi,Ai;function _e(){ae=new XEe(W),ae.init(),Tt=new vY(W,ae),z=new NEe(W,ae,e,Tt),q=new bke(W),le=new GEe(W),he=new cke,be=new wke(W,ae,q,he,z,Tt,le),Ee=new $Ee(C),Z=new zEe(C),G=new JCe(W),pi=new DEe(W,G),ce=new WEe(W,G,le,pi),de=new YEe(W,ce,G,le),ht=new QEe(W,z,be),Qe=new VEe(he),Oe=new lke(C,Ee,Z,ae,z,pi,Qe),Ae=new Mke(C,he),je=new uke,Ge=new yke(ae),Ke=new REe(C,Ee,Z,q,de,g,h),yt=new _ke(C,de,z),Ai=new kke(W,le,z,q),ti=new LEe(W,ae,le),Ht=new HEe(W,ae,le),le.programs=Oe.programs,C.capabilities=z,C.extensions=ae,C.properties=he,C.renderLists=je,C.shadowMap=yt,C.state=q,C.info=le}_e();const $e=new Ake(C,W);this.xr=$e,this.getContext=function(){return W},this.getContextAttributes=function(){return W.getContextAttributes()},this.forceContextLoss=function(){const se=ae.get("WEBGL_lose_context");se&&se.loseContext()},this.forceContextRestore=function(){const se=ae.get("WEBGL_lose_context");se&&se.restoreContext()},this.getPixelRatio=function(){return ee},this.setPixelRatio=function(se){se!==void 0&&(ee=se,this.setSize(j,Q,!1))},this.getSize=function(se){return se.set(j,Q)},this.setSize=function(se,Ce,Ne=!0){if($e.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}j=se,Q=Ce,i.width=Math.floor(se*ee),i.height=Math.floor(Ce*ee),Ne===!0&&(i.style.width=se+"px",i.style.height=Ce+"px"),this.setViewport(0,0,se,Ce)},this.getDrawingBufferSize=function(se){return se.set(j*ee,Q*ee).floor()},this.setDrawingBufferSize=function(se,Ce,Ne){j=se,Q=Ce,ee=Ne,i.width=Math.floor(se*Ne),i.height=Math.floor(Ce*Ne),this.setViewport(0,0,se,Ce)},this.getCurrentViewport=function(se){return se.copy(E)},this.getViewport=function(se){return se.copy(oe)},this.setViewport=function(se,Ce,Ne,Be){se.isVector4?oe.set(se.x,se.y,se.z,se.w):oe.set(se,Ce,Ne,Be),q.viewport(E.copy(oe).multiplyScalar(ee).round())},this.getScissor=function(se){return se.copy(pe)},this.setScissor=function(se,Ce,Ne,Be){se.isVector4?pe.set(se.x,se.y,se.z,se.w):pe.set(se,Ce,Ne,Be),q.scissor(D.copy(pe).multiplyScalar(ee).round())},this.getScissorTest=function(){return Ue},this.setScissorTest=function(se){q.setScissorTest(Ue=se)},this.setOpaqueSort=function(se){J=se},this.setTransparentSort=function(se){ue=se},this.getClearColor=function(se){return se.copy(Ke.getClearColor())},this.setClearColor=function(){Ke.setClearColor.apply(Ke,arguments)},this.getClearAlpha=function(){return Ke.getClearAlpha()},this.setClearAlpha=function(){Ke.setClearAlpha.apply(Ke,arguments)},this.clear=function(se=!0,Ce=!0,Ne=!0){let Be=0;if(se){let Ie=!1;if(R!==null){const mt=R.texture.format;Ie=mt===tL||mt===eL||mt===JD}if(Ie){const mt=R.texture.type,Ft=mt===sc||mt===mm||mt===YD||mt===Iy||mt===qD||mt===ZD,Gt=Ke.getClearColor(),li=Ke.getClearAlpha(),Si=Gt.r,Ii=Gt.g,Di=Gt.b;Ft?(y[0]=Si,y[1]=Ii,y[2]=Di,y[3]=li,W.clearBufferuiv(W.COLOR,0,y)):(x[0]=Si,x[1]=Ii,x[2]=Di,x[3]=li,W.clearBufferiv(W.COLOR,0,x))}else Be|=W.COLOR_BUFFER_BIT}Ce&&(Be|=W.DEPTH_BUFFER_BIT),Ne&&(Be|=W.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),W.clear(Be)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",fe,!1),i.removeEventListener("webglcontextrestored",Ve,!1),i.removeEventListener("webglcontextcreationerror",Xe,!1),je.dispose(),Ge.dispose(),he.dispose(),Ee.dispose(),Z.dispose(),de.dispose(),pi.dispose(),Ai.dispose(),Oe.dispose(),$e.dispose(),$e.removeEventListener("sessionstart",zi),$e.removeEventListener("sessionend",dr),us.stop()};function fe(se){se.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),A=!0}function Ve(){console.log("THREE.WebGLRenderer: Context Restored."),A=!1;const se=le.autoReset,Ce=yt.enabled,Ne=yt.autoUpdate,Be=yt.needsUpdate,Ie=yt.type;_e(),le.autoReset=se,yt.enabled=Ce,yt.autoUpdate=Ne,yt.needsUpdate=Be,yt.type=Ie}function Xe(se){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",se.statusMessage)}function at(se){const Ce=se.target;Ce.removeEventListener("dispose",at),pt(Ce)}function pt(se){Gi(se),he.remove(se)}function Gi(se){const Ce=he.get(se).programs;Ce!==void 0&&(Ce.forEach(function(Ne){Oe.releaseProgram(Ne)}),se.isShaderMaterial&&Oe.releaseShaderCache(se))}this.renderBufferDirect=function(se,Ce,Ne,Be,Ie,mt){Ce===null&&(Ce=Se);const Ft=Ie.isMesh&&Ie.matrixWorld.determinant()<0,Gt=fE(se,Ce,Ne,Be,Ie);q.setMaterial(Be,Ft);let li=Ne.index,Si=1;if(Be.wireframe===!0){if(li=ce.getWireframeAttribute(Ne),li===void 0)return;Si=2}const Ii=Ne.drawRange,Di=Ne.attributes.position;let Li=Ii.start*Si,Pn=(Ii.start+Ii.count)*Si;mt!==null&&(Li=Math.max(Li,mt.start*Si),Pn=Math.min(Pn,(mt.start+mt.count)*Si)),li!==null?(Li=Math.max(Li,0),Pn=Math.min(Pn,li.count)):Di!=null&&(Li=Math.max(Li,0),Pn=Math.min(Pn,Di.count));const ao=Pn-Li;if(ao<0||ao===1/0)return;pi.setup(Ie,Be,Gt,Ne,li);let za,mn=ti;if(li!==null&&(za=G.get(li),mn=Ht,mn.setIndex(za)),Ie.isMesh)Be.wireframe===!0?(q.setLineWidth(Be.wireframeLinewidth*Y()),mn.setMode(W.LINES)):mn.setMode(W.TRIANGLES);else if(Ie.isLine){let Ei=Be.linewidth;Ei===void 0&&(Ei=1),q.setLineWidth(Ei*Y()),Ie.isLineSegments?mn.setMode(W.LINES):Ie.isLineLoop?mn.setMode(W.LINE_LOOP):mn.setMode(W.LINE_STRIP)}else Ie.isPoints?mn.setMode(W.POINTS):Ie.isSprite&&mn.setMode(W.TRIANGLES);if(Ie.isBatchedMesh)Ie._multiDrawInstances!==null?mn.renderMultiDrawInstances(Ie._multiDrawStarts,Ie._multiDrawCounts,Ie._multiDrawCount,Ie._multiDrawInstances):mn.renderMultiDraw(Ie._multiDrawStarts,Ie._multiDrawCounts,Ie._multiDrawCount);else if(Ie.isInstancedMesh)mn.renderInstances(Li,ao,Ie.count);else if(Ne.isInstancedBufferGeometry){const Ei=Ne._maxInstanceCount!==void 0?Ne._maxInstanceCount:1/0,Tf=Math.min(Ne.instanceCount,Ei);mn.renderInstances(Li,ao,Tf)}else mn.render(Li,ao)};function Qi(se,Ce,Ne){se.transparent===!0&&se.side===Wo&&se.forceSinglePass===!1?(se.side=qr,se.needsUpdate=!0,Sn(se,Ce,Ne),se.side=yu,se.needsUpdate=!0,Sn(se,Ce,Ne),se.side=Wo):Sn(se,Ce,Ne)}this.compile=function(se,Ce,Ne=null){Ne===null&&(Ne=se),w=Ge.get(Ne),w.init(Ce),T.push(w),Ne.traverseVisible(function(Ie){Ie.isLight&&Ie.layers.test(Ce.layers)&&(w.pushLight(Ie),Ie.castShadow&&w.pushShadow(Ie))}),se!==Ne&&se.traverseVisible(function(Ie){Ie.isLight&&Ie.layers.test(Ce.layers)&&(w.pushLight(Ie),Ie.castShadow&&w.pushShadow(Ie))}),w.setupLights(C._useLegacyLights);const Be=new Set;return se.traverse(function(Ie){const mt=Ie.material;if(mt)if(Array.isArray(mt))for(let Ft=0;Ft<mt.length;Ft++){const Gt=mt[Ft];Qi(Gt,Ne,Ie),Be.add(Gt)}else Qi(mt,Ne,Ie),Be.add(mt)}),T.pop(),w=null,Be},this.compileAsync=function(se,Ce,Ne=null){const Be=this.compile(se,Ce,Ne);return new Promise(Ie=>{function mt(){if(Be.forEach(function(Ft){he.get(Ft).currentProgram.isReady()&&Be.delete(Ft)}),Be.size===0){Ie(se);return}setTimeout(mt,10)}ae.get("KHR_parallel_shader_compile")!==null?mt():setTimeout(mt,10)})};let ln=null;function is(se){ln&&ln(se)}function zi(){us.stop()}function dr(){us.start()}const us=new dY;us.setAnimationLoop(is),typeof self<"u"&&us.setContext(self),this.setAnimationLoop=function(se){ln=se,$e.setAnimationLoop(se),se===null?us.stop():us.start()},$e.addEventListener("sessionstart",zi),$e.addEventListener("sessionend",dr),this.render=function(se,Ce){if(Ce!==void 0&&Ce.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(A===!0)return;se.matrixWorldAutoUpdate===!0&&se.updateMatrixWorld(),Ce.parent===null&&Ce.matrixWorldAutoUpdate===!0&&Ce.updateMatrixWorld(),$e.enabled===!0&&$e.isPresenting===!0&&($e.cameraAutoUpdate===!0&&$e.updateCamera(Ce),Ce=$e.getCamera()),se.isScene===!0&&se.onBeforeRender(C,se,Ce,R),w=Ge.get(se,T.length),w.init(Ce),T.push(w),Le.multiplyMatrices(Ce.projectionMatrix,Ce.matrixWorldInverse),tt.setFromProjectionMatrix(Le),Re=this.localClippingEnabled,ve=Qe.init(this.clippingPlanes,Re),_=je.get(se,O.length),_.init(),O.push(_),zy(se,Ce,0,C.sortObjects),_.finish(),C.sortObjects===!0&&_.sort(J,ue);const Ne=$e.enabled===!1||$e.isPresenting===!1||$e.hasDepthSensing()===!1;Ne&&Ke.addToRenderList(_,se),this.info.render.frame++,ve===!0&&Qe.beginShadows();const Be=w.state.shadowsArray;yt.render(Be,se,Ce),ve===!0&&Qe.endShadows(),this.info.autoReset===!0&&this.info.reset();const Ie=_.opaque,mt=_.transmissive;if(w.setupLights(C._useLegacyLights),Ce.isArrayCamera){const Ft=Ce.cameras;if(mt.length>0)for(let Gt=0,li=Ft.length;Gt<li;Gt++){const Si=Ft[Gt];jb(Ie,mt,se,Si)}Ne&&Ke.render(se);for(let Gt=0,li=Ft.length;Gt<li;Gt++){const Si=Ft[Gt];qs(_,se,Si,Si.viewport)}}else mt.length>0&&jb(Ie,mt,se,Ce),Ne&&Ke.render(se),qs(_,se,Ce);R!==null&&(be.updateMultisampleRenderTarget(R),be.updateRenderTargetMipmap(R)),se.isScene===!0&&se.onAfterRender(C,se,Ce),pi.resetDefaultState(),P=-1,k=null,T.pop(),T.length>0?(w=T[T.length-1],ve===!0&&Qe.setGlobalState(C.clippingPlanes,w.state.camera)):w=null,O.pop(),O.length>0?_=O[O.length-1]:_=null};function zy(se,Ce,Ne,Be){if(se.visible===!1)return;if(se.layers.test(Ce.layers)){if(se.isGroup)Ne=se.renderOrder;else if(se.isLOD)se.autoUpdate===!0&&se.update(Ce);else if(se.isLight)w.pushLight(se),se.castShadow&&w.pushShadow(se);else if(se.isSprite){if(!se.frustumCulled||tt.intersectsSprite(se)){Be&&De.setFromMatrixPosition(se.matrixWorld).applyMatrix4(Le);const Ft=de.update(se),Gt=se.material;Gt.visible&&_.push(se,Ft,Gt,Ne,De.z,null)}}else if((se.isMesh||se.isLine||se.isPoints)&&(!se.frustumCulled||tt.intersectsObject(se))){const Ft=de.update(se),Gt=se.material;if(Be&&(se.boundingSphere!==void 0?(se.boundingSphere===null&&se.computeBoundingSphere(),De.copy(se.boundingSphere.center)):(Ft.boundingSphere===null&&Ft.computeBoundingSphere(),De.copy(Ft.boundingSphere.center)),De.applyMatrix4(se.matrixWorld).applyMatrix4(Le)),Array.isArray(Gt)){const li=Ft.groups;for(let Si=0,Ii=li.length;Si<Ii;Si++){const Di=li[Si],Li=Gt[Di.materialIndex];Li&&Li.visible&&_.push(se,Ft,Li,Ne,De.z,Di)}}else Gt.visible&&_.push(se,Ft,Gt,Ne,De.z,null)}}const mt=se.children;for(let Ft=0,Gt=mt.length;Ft<Gt;Ft++)zy(mt[Ft],Ce,Ne,Be)}function qs(se,Ce,Ne,Be){const Ie=se.opaque,mt=se.transmissive,Ft=se.transparent;w.setupLightsView(Ne),ve===!0&&Qe.setGlobalState(C.clippingPlanes,Ne),Be&&q.viewport(E.copy(Be)),Ie.length>0&&Cf(Ie,Ce,Ne),mt.length>0&&Cf(mt,Ce,Ne),Ft.length>0&&Cf(Ft,Ce,Ne),q.buffers.depth.setTest(!0),q.buffers.depth.setMask(!0),q.buffers.color.setMask(!0),q.setPolygonOffset(!1)}function jb(se,Ce,Ne,Be){if((Ne.isScene===!0?Ne.overrideMaterial:null)!==null)return;w.state.transmissionRenderTarget[Be.id]===void 0&&(w.state.transmissionRenderTarget[Be.id]=new gl(1,1,{generateMipmaps:!0,type:ae.has("EXT_color_buffer_half_float")||ae.has("EXT_color_buffer_float")?Py:sc,minFilter:Gl,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const mt=w.state.transmissionRenderTarget[Be.id],Ft=Be.viewport||E;mt.setSize(Ft.z,Ft.w);const Gt=C.getRenderTarget();C.setRenderTarget(mt),C.getClearColor(V),F=C.getClearAlpha(),F<1&&C.setClearColor(16777215,.5),C.clear();const li=C.toneMapping;C.toneMapping=cu;const Si=Be.viewport;if(Be.viewport!==void 0&&(Be.viewport=void 0),w.setupLightsView(Be),ve===!0&&Qe.setGlobalState(C.clippingPlanes,Be),Cf(se,Ne,Be),be.updateMultisampleRenderTarget(mt),be.updateRenderTargetMipmap(mt),ae.has("WEBGL_multisampled_render_to_texture")===!1){let Ii=!1;for(let Di=0,Li=Ce.length;Di<Li;Di++){const Pn=Ce[Di],ao=Pn.object,za=Pn.geometry,mn=Pn.material,Ei=Pn.group;if(mn.side===Wo&&ao.layers.test(Be.layers)){const Tf=mn.side;mn.side=qr,mn.needsUpdate=!0,Iu(ao,Ne,Be,za,mn,Ei),mn.side=Tf,mn.needsUpdate=!0,Ii=!0}}Ii===!0&&(be.updateMultisampleRenderTarget(mt),be.updateRenderTargetMipmap(mt))}C.setRenderTarget(Gt),C.setClearColor(V,F),Si!==void 0&&(Be.viewport=Si),C.toneMapping=li}function Cf(se,Ce,Ne){const Be=Ce.isScene===!0?Ce.overrideMaterial:null;for(let Ie=0,mt=se.length;Ie<mt;Ie++){const Ft=se[Ie],Gt=Ft.object,li=Ft.geometry,Si=Be===null?Ft.material:Be,Ii=Ft.group;Gt.layers.test(Ne.layers)&&Iu(Gt,Ce,Ne,li,Si,Ii)}}function Iu(se,Ce,Ne,Be,Ie,mt){se.onBeforeRender(C,Ce,Ne,Be,Ie,mt),se.modelViewMatrix.multiplyMatrices(Ne.matrixWorldInverse,se.matrixWorld),se.normalMatrix.getNormalMatrix(se.modelViewMatrix),Ie.onBeforeRender(C,Ce,Ne,Be,se,mt),Ie.transparent===!0&&Ie.side===Wo&&Ie.forceSinglePass===!1?(Ie.side=qr,Ie.needsUpdate=!0,C.renderBufferDirect(Ne,Ce,Be,Ie,se,mt),Ie.side=yu,Ie.needsUpdate=!0,C.renderBufferDirect(Ne,Ce,Be,Ie,se,mt),Ie.side=Wo):C.renderBufferDirect(Ne,Ce,Be,Ie,se,mt),se.onAfterRender(C,Ce,Ne,Be,Ie,mt)}function Sn(se,Ce,Ne){Ce.isScene!==!0&&(Ce=Se);const Be=he.get(se),Ie=w.state.lights,mt=w.state.shadowsArray,Ft=Ie.state.version,Gt=Oe.getParameters(se,Ie.state,mt,Ce,Ne),li=Oe.getProgramCacheKey(Gt);let Si=Be.programs;Be.environment=se.isMeshStandardMaterial?Ce.environment:null,Be.fog=Ce.fog,Be.envMap=(se.isMeshStandardMaterial?Z:Ee).get(se.envMap||Be.environment),Be.envMapRotation=Be.environment!==null&&se.envMap===null?Ce.environmentRotation:se.envMapRotation,Si===void 0&&(se.addEventListener("dispose",at),Si=new Map,Be.programs=Si);let Ii=Si.get(li);if(Ii!==void 0){if(Be.currentProgram===Ii&&Be.lightsStateVersion===Ft)return Bu(se,Gt),Ii}else Gt.uniforms=Oe.getUniforms(se),se.onBuild(Ne,Gt,C),se.onBeforeCompile(Gt,C),Ii=Oe.acquireProgram(Gt,li),Si.set(li,Ii),Be.uniforms=Gt.uniforms;const Di=Be.uniforms;return(!se.isShaderMaterial&&!se.isRawShaderMaterial||se.clipping===!0)&&(Di.clippingPlanes=Qe.uniform),Bu(se,Gt),Be.needsLights=mE(se),Be.lightsStateVersion=Ft,Be.needsLights&&(Di.ambientLightColor.value=Ie.state.ambient,Di.lightProbe.value=Ie.state.probe,Di.directionalLights.value=Ie.state.directional,Di.directionalLightShadows.value=Ie.state.directionalShadow,Di.spotLights.value=Ie.state.spot,Di.spotLightShadows.value=Ie.state.spotShadow,Di.rectAreaLights.value=Ie.state.rectArea,Di.ltc_1.value=Ie.state.rectAreaLTC1,Di.ltc_2.value=Ie.state.rectAreaLTC2,Di.pointLights.value=Ie.state.point,Di.pointLightShadows.value=Ie.state.pointShadow,Di.hemisphereLights.value=Ie.state.hemi,Di.directionalShadowMap.value=Ie.state.directionalShadowMap,Di.directionalShadowMatrix.value=Ie.state.directionalShadowMatrix,Di.spotShadowMap.value=Ie.state.spotShadowMap,Di.spotLightMatrix.value=Ie.state.spotLightMatrix,Di.spotLightMap.value=Ie.state.spotLightMap,Di.pointShadowMap.value=Ie.state.pointShadowMap,Di.pointShadowMatrix.value=Ie.state.pointShadowMatrix),Be.currentProgram=Ii,Be.uniformsList=null,Ii}function xl(se){if(se.uniformsList===null){const Ce=se.currentProgram.getUniforms();se.uniformsList=GS.seqWithValue(Ce.seq,se.uniforms)}return se.uniformsList}function Bu(se,Ce){const Ne=he.get(se);Ne.outputColorSpace=Ce.outputColorSpace,Ne.batching=Ce.batching,Ne.instancing=Ce.instancing,Ne.instancingColor=Ce.instancingColor,Ne.instancingMorph=Ce.instancingMorph,Ne.skinning=Ce.skinning,Ne.morphTargets=Ce.morphTargets,Ne.morphNormals=Ce.morphNormals,Ne.morphColors=Ce.morphColors,Ne.morphTargetsCount=Ce.morphTargetsCount,Ne.numClippingPlanes=Ce.numClippingPlanes,Ne.numIntersection=Ce.numClipIntersection,Ne.vertexAlphas=Ce.vertexAlphas,Ne.vertexTangents=Ce.vertexTangents,Ne.toneMapping=Ce.toneMapping}function fE(se,Ce,Ne,Be,Ie){Ce.isScene!==!0&&(Ce=Se),be.resetTextureUnits();const mt=Ce.fog,Ft=Be.isMeshStandardMaterial?Ce.environment:null,Gt=R===null?C.outputColorSpace:R.isXRRenderTarget===!0?R.texture.colorSpace:Mu,li=(Be.isMeshStandardMaterial?Z:Ee).get(Be.envMap||Ft),Si=Be.vertexColors===!0&&!!Ne.attributes.color&&Ne.attributes.color.itemSize===4,Ii=!!Ne.attributes.tangent&&(!!Be.normalMap||Be.anisotropy>0),Di=!!Ne.morphAttributes.position,Li=!!Ne.morphAttributes.normal,Pn=!!Ne.morphAttributes.color;let ao=cu;Be.toneMapped&&(R===null||R.isXRRenderTarget===!0)&&(ao=C.toneMapping);const za=Ne.morphAttributes.position||Ne.morphAttributes.normal||Ne.morphAttributes.color,mn=za!==void 0?za.length:0,Ei=he.get(Be),Tf=w.state.lights;if(ve===!0&&(Re===!0||se!==k)){const Ur=se===k&&Be.id===P;Qe.setState(Be,se,Ur)}let zn=!1;Be.version===Ei.__version?(Ei.needsLights&&Ei.lightsStateVersion!==Tf.state.version||Ei.outputColorSpace!==Gt||Ie.isBatchedMesh&&Ei.batching===!1||!Ie.isBatchedMesh&&Ei.batching===!0||Ie.isInstancedMesh&&Ei.instancing===!1||!Ie.isInstancedMesh&&Ei.instancing===!0||Ie.isSkinnedMesh&&Ei.skinning===!1||!Ie.isSkinnedMesh&&Ei.skinning===!0||Ie.isInstancedMesh&&Ei.instancingColor===!0&&Ie.instanceColor===null||Ie.isInstancedMesh&&Ei.instancingColor===!1&&Ie.instanceColor!==null||Ie.isInstancedMesh&&Ei.instancingMorph===!0&&Ie.morphTexture===null||Ie.isInstancedMesh&&Ei.instancingMorph===!1&&Ie.morphTexture!==null||Ei.envMap!==li||Be.fog===!0&&Ei.fog!==mt||Ei.numClippingPlanes!==void 0&&(Ei.numClippingPlanes!==Qe.numPlanes||Ei.numIntersection!==Qe.numIntersection)||Ei.vertexAlphas!==Si||Ei.vertexTangents!==Ii||Ei.morphTargets!==Di||Ei.morphNormals!==Li||Ei.morphColors!==Pn||Ei.toneMapping!==ao||Ei.morphTargetsCount!==mn)&&(zn=!0):(zn=!0,Ei.__version=Be.version);let lo=Ei.currentProgram;zn===!0&&(lo=Sn(Be,Ce,Ie));let Af=!1,Ef=!1,Xy=!1;const ds=lo.getUniforms(),dc=Ei.uniforms;if(q.useProgram(lo.program)&&(Af=!0,Ef=!0,Xy=!0),Be.id!==P&&(P=Be.id,Ef=!0),Af||k!==se){ds.setValue(W,"projectionMatrix",se.projectionMatrix),ds.setValue(W,"viewMatrix",se.matrixWorldInverse);const Ur=ds.map.cameraPosition;Ur!==void 0&&Ur.setValue(W,De.setFromMatrixPosition(se.matrixWorld)),z.logarithmicDepthBuffer&&ds.setValue(W,"logDepthBufFC",2/(Math.log(se.far+1)/Math.LN2)),(Be.isMeshPhongMaterial||Be.isMeshToonMaterial||Be.isMeshLambertMaterial||Be.isMeshBasicMaterial||Be.isMeshStandardMaterial||Be.isShaderMaterial)&&ds.setValue(W,"isOrthographic",se.isOrthographicCamera===!0),k!==se&&(k=se,Ef=!0,Xy=!0)}if(Ie.isSkinnedMesh){ds.setOptional(W,Ie,"bindMatrix"),ds.setOptional(W,Ie,"bindMatrixInverse");const Ur=Ie.skeleton;Ur&&(Ur.boneTexture===null&&Ur.computeBoneTexture(),ds.setValue(W,"boneTexture",Ur.boneTexture,be))}Ie.isBatchedMesh&&(ds.setOptional(W,Ie,"batchingTexture"),ds.setValue(W,"batchingTexture",Ie._matricesTexture,be));const Wy=Ne.morphAttributes;if((Wy.position!==void 0||Wy.normal!==void 0||Wy.color!==void 0)&&ht.update(Ie,Ne,lo),(Ef||Ei.receiveShadow!==Ie.receiveShadow)&&(Ei.receiveShadow=Ie.receiveShadow,ds.setValue(W,"receiveShadow",Ie.receiveShadow)),Be.isMeshGouraudMaterial&&Be.envMap!==null&&(dc.envMap.value=li,dc.flipEnvMap.value=li.isCubeTexture&&li.isRenderTargetTexture===!1?-1:1),Be.isMeshStandardMaterial&&Be.envMap===null&&Ce.environment!==null&&(dc.envMapIntensity.value=Ce.environmentIntensity),Ef&&(ds.setValue(W,"toneMappingExposure",C.toneMappingExposure),Ei.needsLights&&pE(dc,Xy),mt&&Be.fog===!0&&Ae.refreshFogUniforms(dc,mt),Ae.refreshMaterialUniforms(dc,Be,ee,Q,w.state.transmissionRenderTarget[se.id]),GS.upload(W,xl(Ei),dc,be)),Be.isShaderMaterial&&Be.uniformsNeedUpdate===!0&&(GS.upload(W,xl(Ei),dc,be),Be.uniformsNeedUpdate=!1),Be.isSpriteMaterial&&ds.setValue(W,"center",Ie.center),ds.setValue(W,"modelViewMatrix",Ie.modelViewMatrix),ds.setValue(W,"normalMatrix",Ie.normalMatrix),ds.setValue(W,"modelMatrix",Ie.matrixWorld),Be.isShaderMaterial||Be.isRawShaderMaterial){const Ur=Be.uniformsGroups;for(let ko=0,gE=Ur.length;ko<gE;ko++){const qb=Ur[ko];Ai.update(qb,lo),Ai.bind(qb,lo)}}return lo}function pE(se,Ce){se.ambientLightColor.needsUpdate=Ce,se.lightProbe.needsUpdate=Ce,se.directionalLights.needsUpdate=Ce,se.directionalLightShadows.needsUpdate=Ce,se.pointLights.needsUpdate=Ce,se.pointLightShadows.needsUpdate=Ce,se.spotLights.needsUpdate=Ce,se.spotLightShadows.needsUpdate=Ce,se.rectAreaLights.needsUpdate=Ce,se.hemisphereLights.needsUpdate=Ce}function mE(se){return se.isMeshLambertMaterial||se.isMeshToonMaterial||se.isMeshPhongMaterial||se.isMeshStandardMaterial||se.isShadowMaterial||se.isShaderMaterial&&se.lights===!0}this.getActiveCubeFace=function(){return B},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(se,Ce,Ne){he.get(se.texture).__webglTexture=Ce,he.get(se.depthTexture).__webglTexture=Ne;const Be=he.get(se);Be.__hasExternalTextures=!0,Be.__autoAllocateDepthBuffer=Ne===void 0,Be.__autoAllocateDepthBuffer||ae.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Be.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(se,Ce){const Ne=he.get(se);Ne.__webglFramebuffer=Ce,Ne.__useDefaultFramebuffer=Ce===void 0},this.setRenderTarget=function(se,Ce=0,Ne=0){R=se,B=Ce,I=Ne;let Be=!0,Ie=null,mt=!1,Ft=!1;if(se){const li=he.get(se);li.__useDefaultFramebuffer!==void 0?(q.bindFramebuffer(W.FRAMEBUFFER,null),Be=!1):li.__webglFramebuffer===void 0?be.setupRenderTarget(se):li.__hasExternalTextures&&be.rebindTextures(se,he.get(se.texture).__webglTexture,he.get(se.depthTexture).__webglTexture);const Si=se.texture;(Si.isData3DTexture||Si.isDataArrayTexture||Si.isCompressedArrayTexture)&&(Ft=!0);const Ii=he.get(se).__webglFramebuffer;se.isWebGLCubeRenderTarget?(Array.isArray(Ii[Ce])?Ie=Ii[Ce][Ne]:Ie=Ii[Ce],mt=!0):se.samples>0&&be.useMultisampledRTT(se)===!1?Ie=he.get(se).__webglMultisampledFramebuffer:Array.isArray(Ii)?Ie=Ii[Ne]:Ie=Ii,E.copy(se.viewport),D.copy(se.scissor),L=se.scissorTest}else E.copy(oe).multiplyScalar(ee).floor(),D.copy(pe).multiplyScalar(ee).floor(),L=Ue;if(q.bindFramebuffer(W.FRAMEBUFFER,Ie)&&Be&&q.drawBuffers(se,Ie),q.viewport(E),q.scissor(D),q.setScissorTest(L),mt){const li=he.get(se.texture);W.framebufferTexture2D(W.FRAMEBUFFER,W.COLOR_ATTACHMENT0,W.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,li.__webglTexture,Ne)}else if(Ft){const li=he.get(se.texture),Si=Ce||0;W.framebufferTextureLayer(W.FRAMEBUFFER,W.COLOR_ATTACHMENT0,li.__webglTexture,Ne||0,Si)}P=-1},this.readRenderTargetPixels=function(se,Ce,Ne,Be,Ie,mt,Ft){if(!(se&&se.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Gt=he.get(se).__webglFramebuffer;if(se.isWebGLCubeRenderTarget&&Ft!==void 0&&(Gt=Gt[Ft]),Gt){q.bindFramebuffer(W.FRAMEBUFFER,Gt);try{const li=se.texture,Si=li.format,Ii=li.type;if(!z.textureFormatReadable(Si)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!z.textureTypeReadable(Ii)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ce>=0&&Ce<=se.width-Be&&Ne>=0&&Ne<=se.height-Ie&&W.readPixels(Ce,Ne,Be,Ie,Tt.convert(Si),Tt.convert(Ii),mt)}finally{const li=R!==null?he.get(R).__webglFramebuffer:null;q.bindFramebuffer(W.FRAMEBUFFER,li)}}},this.copyFramebufferToTexture=function(se,Ce,Ne=0){const Be=Math.pow(2,-Ne),Ie=Math.floor(Ce.image.width*Be),mt=Math.floor(Ce.image.height*Be);be.setTexture2D(Ce,0),W.copyTexSubImage2D(W.TEXTURE_2D,Ne,0,0,se.x,se.y,Ie,mt),q.unbindTexture()},this.copyTextureToTexture=function(se,Ce,Ne,Be=0){const Ie=Ce.image.width,mt=Ce.image.height,Ft=Tt.convert(Ne.format),Gt=Tt.convert(Ne.type);be.setTexture2D(Ne,0),W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,Ne.flipY),W.pixelStorei(W.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ne.premultiplyAlpha),W.pixelStorei(W.UNPACK_ALIGNMENT,Ne.unpackAlignment),Ce.isDataTexture?W.texSubImage2D(W.TEXTURE_2D,Be,se.x,se.y,Ie,mt,Ft,Gt,Ce.image.data):Ce.isCompressedTexture?W.compressedTexSubImage2D(W.TEXTURE_2D,Be,se.x,se.y,Ce.mipmaps[0].width,Ce.mipmaps[0].height,Ft,Ce.mipmaps[0].data):W.texSubImage2D(W.TEXTURE_2D,Be,se.x,se.y,Ft,Gt,Ce.image),Be===0&&Ne.generateMipmaps&&W.generateMipmap(W.TEXTURE_2D),q.unbindTexture()},this.copyTextureToTexture3D=function(se,Ce,Ne,Be,Ie=0){const mt=se.max.x-se.min.x,Ft=se.max.y-se.min.y,Gt=se.max.z-se.min.z,li=Tt.convert(Be.format),Si=Tt.convert(Be.type);let Ii;if(Be.isData3DTexture)be.setTexture3D(Be,0),Ii=W.TEXTURE_3D;else if(Be.isDataArrayTexture||Be.isCompressedArrayTexture)be.setTexture2DArray(Be,0),Ii=W.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}W.pixelStorei(W.UNPACK_FLIP_Y_WEBGL,Be.flipY),W.pixelStorei(W.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Be.premultiplyAlpha),W.pixelStorei(W.UNPACK_ALIGNMENT,Be.unpackAlignment);const Di=W.getParameter(W.UNPACK_ROW_LENGTH),Li=W.getParameter(W.UNPACK_IMAGE_HEIGHT),Pn=W.getParameter(W.UNPACK_SKIP_PIXELS),ao=W.getParameter(W.UNPACK_SKIP_ROWS),za=W.getParameter(W.UNPACK_SKIP_IMAGES),mn=Ne.isCompressedTexture?Ne.mipmaps[Ie]:Ne.image;W.pixelStorei(W.UNPACK_ROW_LENGTH,mn.width),W.pixelStorei(W.UNPACK_IMAGE_HEIGHT,mn.height),W.pixelStorei(W.UNPACK_SKIP_PIXELS,se.min.x),W.pixelStorei(W.UNPACK_SKIP_ROWS,se.min.y),W.pixelStorei(W.UNPACK_SKIP_IMAGES,se.min.z),Ne.isDataTexture||Ne.isData3DTexture?W.texSubImage3D(Ii,Ie,Ce.x,Ce.y,Ce.z,mt,Ft,Gt,li,Si,mn.data):Be.isCompressedArrayTexture?W.compressedTexSubImage3D(Ii,Ie,Ce.x,Ce.y,Ce.z,mt,Ft,Gt,li,mn.data):W.texSubImage3D(Ii,Ie,Ce.x,Ce.y,Ce.z,mt,Ft,Gt,li,Si,mn),W.pixelStorei(W.UNPACK_ROW_LENGTH,Di),W.pixelStorei(W.UNPACK_IMAGE_HEIGHT,Li),W.pixelStorei(W.UNPACK_SKIP_PIXELS,Pn),W.pixelStorei(W.UNPACK_SKIP_ROWS,ao),W.pixelStorei(W.UNPACK_SKIP_IMAGES,za),Ie===0&&Be.generateMipmaps&&W.generateMipmap(Ii),q.unbindTexture()},this.initTexture=function(se){se.isCubeTexture?be.setTextureCube(se,0):se.isData3DTexture?be.setTexture3D(se,0):se.isDataArrayTexture||se.isCompressedArrayTexture?be.setTexture2DArray(se,0):be.setTexture2D(se,0),q.unbindTexture()},this.resetState=function(){B=0,I=0,R=null,q.reset(),pi.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Qc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const i=this.getContext();i.drawingBufferColorSpace=e===xA?"display-p3":"srgb",i.unpackColorSpace=Mn.workingColorSpace===wb?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class OA{constructor(e,i=25e-5){this.isFogExp2=!0,this.name="",this.color=new ft(e),this.density=i}clone(){return new OA(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class SA{constructor(e,i=1,n=1e3){this.isFog=!0,this.name="",this.color=new ft(e),this.near=i,this.far=n}clone(){return new SA(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class dy extends vn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new To,this.environmentIntensity=1,this.environmentRotation=new To,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(i.object.environmentIntensity=this.environmentIntensity),i.object.environmentRotation=this.environmentRotation.toArray(),i}}class Ab{constructor(e,i){this.isInterleavedBuffer=!0,this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=T_,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=La()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return rY("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,n){e*=this.stride,n*=i.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=i.array[n+r];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=La()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(i,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=La()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const mo=new ie;class xu{constructor(e,i,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,n=this.data.count;i<n;i++)mo.fromBufferAttribute(this,i),mo.applyMatrix4(e),this.setXYZ(i,mo.x,mo.y,mo.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)mo.fromBufferAttribute(this,i),mo.applyNormalMatrix(e),this.setXYZ(i,mo.x,mo.y,mo.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)mo.fromBufferAttribute(this,i),mo.transformDirection(e),this.setXYZ(i,mo.x,mo.y,mo.z);return this}getComponent(e,i){let n=this.array[e*this.data.stride+this.offset+i];return this.normalized&&(n=xo(n,this.array)),n}setComponent(e,i,n){return this.normalized&&(n=Vi(n,this.array)),this.data.array[e*this.data.stride+this.offset+i]=n,this}setX(e,i){return this.normalized&&(i=Vi(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=Vi(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=Vi(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=Vi(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=xo(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=xo(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=xo(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=xo(i,this.array)),i}setXY(e,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(i=Vi(i,this.array),n=Vi(n,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this}setXYZ(e,i,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(i=Vi(i,this.array),n=Vi(n,this.array),r=Vi(r,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,i,n,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(i=Vi(i,this.array),n=Vi(n,this.array),r=Vi(r,this.array),o=Vi(o,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)i.push(this.data.array[r+o])}return new rn(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new xu(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)i.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class dL extends no{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ft(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Tg;const Vv=new ie,Ag=new ie,Eg=new ie,Mg=new Fe,$v=new Fe,_Y=new ri,H1=new ie,Uv=new ie,G1=new ie,g5=new Fe,aP=new Fe,y5=new Fe;class bY extends vn{constructor(e=new dL){if(super(),this.isSprite=!0,this.type="Sprite",Tg===void 0){Tg=new $i;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Ab(i,5);Tg.setIndex([0,1,2,0,2,3]),Tg.setAttribute("position",new xu(n,3,0,!1)),Tg.setAttribute("uv",new xu(n,2,3,!1))}this.geometry=Tg,this.material=e,this.center=new Fe(.5,.5)}raycast(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ag.setFromMatrixScale(this.matrixWorld),_Y.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Eg.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Ag.multiplyScalar(-Eg.z);const n=this.material.rotation;let r,o;n!==0&&(o=Math.cos(n),r=Math.sin(n));const a=this.center;Q1(H1.set(-.5,-.5,0),Eg,a,Ag,r,o),Q1(Uv.set(.5,-.5,0),Eg,a,Ag,r,o),Q1(G1.set(.5,.5,0),Eg,a,Ag,r,o),g5.set(0,0),aP.set(1,0),y5.set(1,1);let l=e.ray.intersectTriangle(H1,Uv,G1,!1,Vv);if(l===null&&(Q1(Uv.set(-.5,.5,0),Eg,a,Ag,r,o),aP.set(0,1),l=e.ray.intersectTriangle(H1,G1,Uv,!1,Vv),l===null))return;const h=e.ray.origin.distanceTo(Vv);h<e.near||h>e.far||i.push({distance:h,point:Vv.clone(),uv:Ho.getInterpolation(Vv,H1,Uv,G1,g5,aP,y5,new Fe),face:null,object:this})}copy(e,i){return super.copy(e,i),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Q1(s,e,i,n,r,o){Mg.subVectors(s,i).addScalar(.5).multiply(n),r!==void 0?($v.x=o*Mg.x-r*Mg.y,$v.y=r*Mg.x+o*Mg.y):$v.copy(Mg),s.copy(e),s.x+=$v.x,s.y+=$v.y,s.applyMatrix4(_Y)}const Y1=new ie,v5=new ie;class wY extends vn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const i=e.levels;for(let n=0,r=i.length;n<r;n++){const o=i[n];this.addLevel(o.object.clone(),o.distance,o.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,i=0,n=0){i=Math.abs(i);const r=this.levels;let o;for(o=0;o<r.length&&!(i<r[o].distance);o++);return r.splice(o,0,{distance:i,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const i=this.levels;if(i.length>0){let n,r;for(n=1,r=i.length;n<r;n++){let o=i[n].distance;if(i[n].object.visible&&(o-=o*i[n].hysteresis),e<o)break}return i[n-1].object}return null}raycast(e,i){if(this.levels.length>0){Y1.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Y1);this.getObjectForDistance(r).raycast(e,i)}}update(e){const i=this.levels;if(i.length>1){Y1.setFromMatrixPosition(e.matrixWorld),v5.setFromMatrixPosition(this.matrixWorld);const n=Y1.distanceTo(v5)/e.zoom;i[0].object.visible=!0;let r,o;for(r=1,o=i.length;r<o;r++){let a=i[r].distance;if(i[r].object.visible&&(a-=a*i[r].hysteresis),n>=a)i[r-1].object.visible=!1,i[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<o;r++)i[r].object.visible=!1}}toJSON(e){const i=super.toJSON(e);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const n=this.levels;for(let r=0,o=n.length;r<o;r++){const a=n[r];i.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return i}}const x5=new ie,_5=new sn,b5=new sn,Pke=new ie,w5=new ri,j1=new ie,lP=new Vr,O5=new ri,cP=new km;class OY extends Dn{constructor(e,i){super(e,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=ZI,this.bindMatrix=new ri,this.bindMatrixInverse=new ri,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Nr),this.boundingBox.makeEmpty();const i=e.getAttribute("position");for(let n=0;n<i.count;n++)this.getVertexPosition(n,j1),this.boundingBox.expandByPoint(j1)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Vr),this.boundingSphere.makeEmpty();const i=e.getAttribute("position");for(let n=0;n<i.count;n++)this.getVertexPosition(n,j1),this.boundingSphere.expandByPoint(j1)}copy(e,i){return super.copy(e,i),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,i){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),lP.copy(this.boundingSphere),lP.applyMatrix4(r),e.ray.intersectsSphere(lP)!==!1&&(O5.copy(r).invert(),cP.copy(e.ray).applyMatrix4(O5),!(this.boundingBox!==null&&cP.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,i,cP)))}getVertexPosition(e,i){return super.getVertexPosition(e,i),this.applyBoneTransform(e,i),i}bind(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new sn,i=this.geometry.attributes.skinWeight;for(let n=0,r=i.count;n<r;n++){e.fromBufferAttribute(i,n);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),i.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===ZI?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===R9?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,i){const n=this.skeleton,r=this.geometry;_5.fromBufferAttribute(r.attributes.skinIndex,e),b5.fromBufferAttribute(r.attributes.skinWeight,e),x5.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let o=0;o<4;o++){const a=b5.getComponent(o);if(a!==0){const l=_5.getComponent(o);w5.multiplyMatrices(n.bones[l].matrixWorld,n.boneInverses[l]),i.addScaledVector(Pke.copy(x5).applyMatrix4(w5),a)}}return i.applyMatrix4(this.bindMatrixInverse)}}class fL extends vn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Yd extends cs{constructor(e=null,i=1,n=1,r,o,a,l,h,d=ar,f=ar,p,g){super(null,a,l,h,d,f,r,o,p,g),this.isDataTexture=!0,this.image={data:e,width:i,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const S5=new ri,Ike=new ri;class CA{constructor(e=[],i=[]){this.uuid=La(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new ri)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){const n=new ri;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,i=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let o=0,a=e.length;o<a;o++){const l=e[o]?e[o].matrixWorld:Ike;S5.multiplyMatrices(l,i[o]),S5.toArray(n,o*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new CA(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const i=new Float32Array(e*e*4);i.set(this.boneMatrices);const n=new Yd(i,e,e,qo,hl);return n.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=n,this}getBoneByName(e){for(let i=0,n=this.bones.length;i<n;i++){const r=this.bones[i];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const o=e.bones[n];let a=i[o];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),a=new fL),this.bones.push(a),this.boneInverses.push(new ri().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const i=this.bones,n=this.boneInverses;for(let r=0,o=i.length;r<o;r++){const a=i[r];e.bones.push(a.uuid);const l=n[r];e.boneInverses.push(l.toArray())}return e}}class fy extends rn{constructor(e,i,n,r=1){super(e,i,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const kg=new ri,C5=new ri,q1=[],T5=new Nr,Bke=new ri,Fv=new Dn,zv=new Vr;class SY extends Dn{constructor(e,i,n){super(e,i),this.isInstancedMesh=!0,this.instanceMatrix=new fy(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,Bke)}computeBoundingBox(){const e=this.geometry,i=this.count;this.boundingBox===null&&(this.boundingBox=new Nr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<i;n++)this.getMatrixAt(n,kg),T5.copy(e.boundingBox).applyMatrix4(kg),this.boundingBox.union(T5)}computeBoundingSphere(){const e=this.geometry,i=this.count;this.boundingSphere===null&&(this.boundingSphere=new Vr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<i;n++)this.getMatrixAt(n,kg),zv.copy(e.boundingSphere).applyMatrix4(kg),this.boundingSphere.union(zv)}copy(e,i){return super.copy(e,i),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,i){i.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,i){const n=i.morphTargetInfluences,r=this.morphTexture.source.data.data,o=n.length+1,a=e*o+1;for(let l=0;l<n.length;l++)n[l]=r[a+l]}raycast(e,i){const n=this.matrixWorld,r=this.count;if(Fv.geometry=this.geometry,Fv.material=this.material,Fv.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),zv.copy(this.boundingSphere),zv.applyMatrix4(n),e.ray.intersectsSphere(zv)!==!1))for(let o=0;o<r;o++){this.getMatrixAt(o,kg),C5.multiplyMatrices(n,kg),Fv.matrixWorld=C5,Fv.raycast(e,q1);for(let a=0,l=q1.length;a<l;a++){const h=q1[a];h.instanceId=o,h.object=this,i.push(h)}q1.length=0}}setColorAt(e,i){this.instanceColor===null&&(this.instanceColor=new fy(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,i){const n=i.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new Yd(new Float32Array(r*this.count),r,this.count,KD,hl));const o=this.morphTexture.source.data.data;let a=0;for(let d=0;d<n.length;d++)a+=n[d];const l=this.geometry.morphTargetsRelative?1:1-a,h=r*e;o[h]=l,o.set(n,h+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function Rke(s,e){return s.z-e.z}function Dke(s,e){return e.z-s.z}class Lke{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,i){const n=this.pool,r=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1});const o=n[this.index];r.push(o),this.index++,o.start=e.start,o.count=e.count,o.z=i}reset(){this.list.length=0,this.index=0}}const Pg="batchId",ad=new ri,A5=new ri,Nke=new ri,E5=new ri,hP=new Tb,Z1=new Nr,qf=new Vr,Xv=new ie,uP=new Lke,Hr=new Dn,K1=[];function Vke(s,e,i=0){const n=e.itemSize;if(s.isInterleavedBufferAttribute||s.array.constructor!==e.array.constructor){const r=s.count;for(let o=0;o<r;o++)for(let a=0;a<n;a++)e.setComponent(o+i,a,s.getComponent(o,a))}else e.array.set(s.array,i*n);e.needsUpdate=!0}class CY extends Dn{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,i,n=i*2,r){super(new $i,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=i,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const i=new Float32Array(e*e*4),n=new Yd(i,e,e,qo,hl);this._matricesTexture=n}_initializeGeometry(e){const i=this.geometry,n=this._maxVertexCount,r=this._maxGeometryCount,o=this._maxIndexCount;if(this._geometryInitialized===!1){for(const l in e.attributes){const h=e.getAttribute(l),{array:d,itemSize:f,normalized:p}=h,g=new d.constructor(n*f),y=new rn(g,f,p);i.setAttribute(l,y)}if(e.getIndex()!==null){const l=n>65536?new Uint32Array(o):new Uint16Array(o);i.setIndex(new rn(l,1))}const a=r>65536?new Uint32Array(n):new Uint16Array(n);i.setAttribute(Pg,new rn(a,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(Pg))throw new Error(`BatchedMesh: Geometry cannot use attribute "${Pg}"`);const i=this.geometry;if(!!e.getIndex()!=!!i.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const n in i.attributes){if(n===Pg)continue;if(!e.hasAttribute(n))throw new Error(`BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),o=i.getAttribute(n);if(r.itemSize!==o.itemSize||r.normalized!==o.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Nr);const e=this._geometryCount,i=this.boundingBox,n=this._active;i.makeEmpty();for(let r=0;r<e;r++)n[r]!==!1&&(this.getMatrixAt(r,ad),this.getBoundingBoxAt(r,Z1).applyMatrix4(ad),i.union(Z1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Vr);const e=this._geometryCount,i=this.boundingSphere,n=this._active;i.makeEmpty();for(let r=0;r<e;r++)n[r]!==!1&&(this.getMatrixAt(r,ad),this.getBoundingSphereAt(r,qf).applyMatrix4(ad),i.union(qf))}addGeometry(e,i=-1,n=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let o=null;const a=this._reservedRanges,l=this._drawRanges,h=this._bounds;this._geometryCount!==0&&(o=a[a.length-1]),i===-1?r.vertexCount=e.getAttribute("position").count:r.vertexCount=i,o===null?r.vertexStart=0:r.vertexStart=o.vertexStart+o.vertexCount;const d=e.getIndex(),f=d!==null;if(f&&(n===-1?r.indexCount=d.count:r.indexCount=n,o===null?r.indexStart=0:r.indexStart=o.indexStart+o.indexCount),r.indexStart!==-1&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const p=this._visibility,g=this._active,y=this._matricesTexture,x=this._matricesTexture.image.data;p.push(!0),g.push(!0);const _=this._geometryCount;this._geometryCount++,Nke.toArray(x,_*16),y.needsUpdate=!0,a.push(r),l.push({start:f?r.indexStart:r.vertexStart,count:-1}),h.push({boxInitialized:!1,box:new Nr,sphereInitialized:!1,sphere:new Vr});const w=this.geometry.getAttribute(Pg);for(let O=0;O<r.vertexCount;O++)w.setX(r.vertexStart+O,_);return w.needsUpdate=!0,this.setGeometryAt(_,e),_}setGeometryAt(e,i){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(i);const n=this.geometry,r=n.getIndex()!==null,o=n.getIndex(),a=i.getIndex(),l=this._reservedRanges[e];if(r&&a.count>l.indexCount||i.attributes.position.count>l.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const h=l.vertexStart,d=l.vertexCount;for(const y in n.attributes){if(y===Pg)continue;const x=i.getAttribute(y),_=n.getAttribute(y);Vke(x,_,h);const w=x.itemSize;for(let O=x.count,T=d;O<T;O++){const C=h+O;for(let A=0;A<w;A++)_.setComponent(C,A,0)}_.needsUpdate=!0,_.addUpdateRange(h*w,d*w)}if(r){const y=l.indexStart;for(let x=0;x<a.count;x++)o.setX(y+x,h+a.getX(x));for(let x=a.count,_=l.indexCount;x<_;x++)o.setX(y+x,h);o.needsUpdate=!0,o.addUpdateRange(y,l.indexCount)}const f=this._bounds[e];i.boundingBox!==null?(f.box.copy(i.boundingBox),f.boxInitialized=!0):f.boxInitialized=!1,i.boundingSphere!==null?(f.sphere.copy(i.boundingSphere),f.sphereInitialized=!0):f.sphereInitialized=!1;const p=this._drawRanges[e],g=i.getAttribute("position");return p.count=r?a.count:g.count,this._visibilityChanged=!0,e}deleteGeometry(e){const i=this._active;return e>=i.length||i[e]===!1?this:(i[e]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(e){return this._multiDrawInstances===null?null:this._multiDrawInstances[e]}setInstanceCountAt(e,i){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[e]=i,e}getBoundingBoxAt(e,i){if(this._active[e]===!1)return null;const r=this._bounds[e],o=r.box,a=this.geometry;if(r.boxInitialized===!1){o.makeEmpty();const l=a.index,h=a.attributes.position,d=this._drawRanges[e];for(let f=d.start,p=d.start+d.count;f<p;f++){let g=f;l&&(g=l.getX(g)),o.expandByPoint(Xv.fromBufferAttribute(h,g))}r.boxInitialized=!0}return i.copy(o),i}getBoundingSphereAt(e,i){if(this._active[e]===!1)return null;const r=this._bounds[e],o=r.sphere,a=this.geometry;if(r.sphereInitialized===!1){o.makeEmpty(),this.getBoundingBoxAt(e,Z1),Z1.getCenter(o.center);const l=a.index,h=a.attributes.position,d=this._drawRanges[e];let f=0;for(let p=d.start,g=d.start+d.count;p<g;p++){let y=p;l&&(y=l.getX(y)),Xv.fromBufferAttribute(h,y),f=Math.max(f,o.center.distanceToSquared(Xv))}o.radius=Math.sqrt(f),r.sphereInitialized=!0}return i.copy(o),i}setMatrixAt(e,i){const n=this._active,r=this._matricesTexture,o=this._matricesTexture.image.data,a=this._geometryCount;return e>=a||n[e]===!1?this:(i.toArray(o,e*16),r.needsUpdate=!0,this)}getMatrixAt(e,i){const n=this._active,r=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||n[e]===!1?null:i.fromArray(r,e*16)}setVisibleAt(e,i){const n=this._visibility,r=this._active,o=this._geometryCount;return e>=o||r[e]===!1||n[e]===i?this:(n[e]=i,this._visibilityChanged=!0,this)}getVisibleAt(e){const i=this._visibility,n=this._active,r=this._geometryCount;return e>=r||n[e]===!1?!1:i[e]}raycast(e,i){const n=this._visibility,r=this._active,o=this._drawRanges,a=this._geometryCount,l=this.matrixWorld,h=this.geometry;Hr.material=this.material,Hr.geometry.index=h.index,Hr.geometry.attributes=h.attributes,Hr.geometry.boundingBox===null&&(Hr.geometry.boundingBox=new Nr),Hr.geometry.boundingSphere===null&&(Hr.geometry.boundingSphere=new Vr);for(let d=0;d<a;d++){if(!n[d]||!r[d])continue;const f=o[d];Hr.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(d,Hr.matrixWorld).premultiply(l),this.getBoundingBoxAt(d,Hr.geometry.boundingBox),this.getBoundingSphereAt(d,Hr.geometry.boundingSphere),Hr.raycast(e,K1);for(let p=0,g=K1.length;p<g;p++){const y=K1[p];y.object=this,y.batchId=d,i.push(y)}K1.length=0}Hr.material=null,Hr.geometry.index=null,Hr.geometry.attributes={},Hr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(i=>({...i})),this._reservedRanges=e._reservedRanges.map(i=>({...i})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(i=>({boxInitialized:i.boxInitialized,box:i.box.clone(),sphereInitialized:i.sphereInitialized,sphere:i.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,i,n,r,o){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),l=a===null?1:a.array.BYTES_PER_ELEMENT,h=this._active,d=this._visibility,f=this._multiDrawStarts,p=this._multiDrawCounts,g=this._drawRanges,y=this.perObjectFrustumCulled;y&&(E5.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),hP.setFromProjectionMatrix(E5,e.coordinateSystem));let x=0;if(this.sortObjects){A5.copy(this.matrixWorld).invert(),Xv.setFromMatrixPosition(n.matrixWorld).applyMatrix4(A5);for(let O=0,T=d.length;O<T;O++)if(d[O]&&h[O]){this.getMatrixAt(O,ad),this.getBoundingSphereAt(O,qf).applyMatrix4(ad);let C=!1;if(y&&(C=!hP.intersectsSphere(qf)),!C){const A=Xv.distanceTo(qf.center);uP.push(g[O],A)}}const _=uP.list,w=this.customSort;w===null?_.sort(o.transparent?Dke:Rke):w.call(this,_,n);for(let O=0,T=_.length;O<T;O++){const C=_[O];f[x]=C.start*l,p[x]=C.count,x++}uP.reset()}else for(let _=0,w=d.length;_<w;_++)if(d[_]&&h[_]){let O=!1;if(y&&(this.getMatrixAt(_,ad),this.getBoundingSphereAt(_,qf).applyMatrix4(ad),O=!hP.intersectsSphere(qf)),!O){const T=g[_];f[x]=T.start*l,p[x]=T.count,x++}}this._multiDrawCount=x,this._visibilityChanged=!1}onBeforeShadow(e,i,n,r,o,a){this.onBeforeRender(e,null,r,o,a)}}class Eo extends no{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ft(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const GC=new ie,QC=new ie,M5=new ri,Wv=new km,J1=new Vr,dP=new ie,k5=new ie;let nf=class extends vn{constructor(e=new $i,i=new Eo){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,n=[0];for(let r=1,o=i.count;r<o;r++)GC.fromBufferAttribute(i,r-1),QC.fromBufferAttribute(i,r),n[r]=n[r-1],n[r]+=GC.distanceTo(QC);e.setAttribute("lineDistance",new Ut(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,i){const n=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),J1.copy(n.boundingSphere),J1.applyMatrix4(r),J1.radius+=o,e.ray.intersectsSphere(J1)===!1)return;M5.copy(r).invert(),Wv.copy(e.ray).applyMatrix4(M5);const l=o/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,d=this.isLineSegments?2:1,f=n.index,g=n.attributes.position;if(f!==null){const y=Math.max(0,a.start),x=Math.min(f.count,a.start+a.count);for(let _=y,w=x-1;_<w;_+=d){const O=f.getX(_),T=f.getX(_+1),C=eO(this,e,Wv,h,O,T);C&&i.push(C)}if(this.isLineLoop){const _=f.getX(x-1),w=f.getX(y),O=eO(this,e,Wv,h,_,w);O&&i.push(O)}}else{const y=Math.max(0,a.start),x=Math.min(g.count,a.start+a.count);for(let _=y,w=x-1;_<w;_+=d){const O=eO(this,e,Wv,h,_,_+1);O&&i.push(O)}if(this.isLineLoop){const _=eO(this,e,Wv,h,x-1,y);_&&i.push(_)}}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=r.length;o<a;o++){const l=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}};function eO(s,e,i,n,r,o){const a=s.geometry.attributes.position;if(GC.fromBufferAttribute(a,r),QC.fromBufferAttribute(a,o),i.distanceSqToSegment(GC,QC,dP,k5)>n)return;dP.applyMatrix4(s.matrixWorld);const h=e.ray.origin.distanceTo(dP);if(!(h<e.near||h>e.far))return{distance:h,point:k5.clone().applyMatrix4(s.matrixWorld),index:r,face:null,faceIndex:null,object:s}}const P5=new ie,I5=new ie;class hh extends nf{constructor(e,i){super(e,i),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,n=[];for(let r=0,o=i.count;r<o;r+=2)P5.fromBufferAttribute(i,r),I5.fromBufferAttribute(i,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+P5.distanceTo(I5);e.setAttribute("lineDistance",new Ut(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class TY extends nf{constructor(e,i){super(e,i),this.isLineLoop=!0,this.type="LineLoop"}}class pL extends no{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ft(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const B5=new ri,EB=new km,tO=new Vr,iO=new ie;class AY extends vn{constructor(e=new $i,i=new pL){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,i){const n=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),tO.copy(n.boundingSphere),tO.applyMatrix4(r),tO.radius+=o,e.ray.intersectsSphere(tO)===!1)return;B5.copy(r).invert(),EB.copy(e.ray).applyMatrix4(B5);const l=o/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,d=n.index,p=n.attributes.position;if(d!==null){const g=Math.max(0,a.start),y=Math.min(d.count,a.start+a.count);for(let x=g,_=y;x<_;x++){const w=d.getX(x);iO.fromBufferAttribute(p,w),R5(iO,w,h,r,e,i,this)}}else{const g=Math.max(0,a.start),y=Math.min(p.count,a.start+a.count);for(let x=g,_=y;x<_;x++)iO.fromBufferAttribute(p,x),R5(iO,x,h,r,e,i,this)}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=r.length;o<a;o++){const l=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}}function R5(s,e,i,n,r,o,a){const l=EB.distanceSqToPoint(s);if(l<i){const h=new ie;EB.closestPointToPoint(s,h),h.applyMatrix4(n);const d=r.ray.origin.distanceTo(h);if(d<r.near||d>r.far)return;o.push({distance:d,distanceToRay:Math.sqrt(l),point:h,index:e,face:null,object:a})}}class $ke extends cs{constructor(e,i,n,r,o,a,l,h,d){super(e,i,n,r,o,a,l,h,d),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:Bs,this.magFilter=o!==void 0?o:Bs,this.generateMipmaps=!1;const f=this;function p(){f.needsUpdate=!0,e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(p)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class MB extends cs{constructor(e,i){super({width:e,height:i}),this.isFramebufferTexture=!0,this.magFilter=ar,this.minFilter=ar,this.generateMipmaps=!1,this.needsUpdate=!0}}class Jp extends cs{constructor(e,i,n,r,o,a,l,h,d,f,p,g){super(null,a,l,h,d,f,r,o,p,g),this.isCompressedTexture=!0,this.image={width:i,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Uke extends Jp{constructor(e,i,n,r,o,a){super(e,i,n,o,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Pa}}class Fke extends Jp{constructor(e,i,n){super(void 0,e[0].width,e[0].height,i,n,vu),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class zke extends cs{constructor(e,i,n,r,o,a,l,h,d){super(e,i,n,r,o,a,l,h,d),this.isCanvasTexture=!0,this.needsUpdate=!0}}class cc{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){const n=this.getUtoTmapping(e);return this.getPoint(n,i)}getPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPoint(n/e));return i}getSpacedPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPointAt(n/e));return i}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let n,r=this.getPoint(0),o=0;i.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),o+=n.distanceTo(r),i.push(o),r=n;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){const n=this.getLengths();let r=0;const o=n.length;let a;i?a=i:a=e*n[o-1];let l=0,h=o-1,d;for(;l<=h;)if(r=Math.floor(l+(h-l)/2),d=n[r]-a,d<0)l=r+1;else if(d>0)h=r-1;else{h=r;break}if(r=h,n[r]===a)return r/(o-1);const f=n[r],g=n[r+1]-f,y=(a-f)/g;return(r+y)/(o-1)}getTangent(e,i){let r=e-1e-4,o=e+1e-4;r<0&&(r=0),o>1&&(o=1);const a=this.getPoint(r),l=this.getPoint(o),h=i||(a.isVector2?new Fe:new ie);return h.copy(l).sub(a).normalize(),h}getTangentAt(e,i){const n=this.getUtoTmapping(e);return this.getTangent(n,i)}computeFrenetFrames(e,i){const n=new ie,r=[],o=[],a=[],l=new ie,h=new ri;for(let y=0;y<=e;y++){const x=y/e;r[y]=this.getTangentAt(x,new ie)}o[0]=new ie,a[0]=new ie;let d=Number.MAX_VALUE;const f=Math.abs(r[0].x),p=Math.abs(r[0].y),g=Math.abs(r[0].z);f<=d&&(d=f,n.set(1,0,0)),p<=d&&(d=p,n.set(0,1,0)),g<=d&&n.set(0,0,1),l.crossVectors(r[0],n).normalize(),o[0].crossVectors(r[0],l),a[0].crossVectors(r[0],o[0]);for(let y=1;y<=e;y++){if(o[y]=o[y-1].clone(),a[y]=a[y-1].clone(),l.crossVectors(r[y-1],r[y]),l.length()>Number.EPSILON){l.normalize();const x=Math.acos(Ms(r[y-1].dot(r[y]),-1,1));o[y].applyMatrix4(h.makeRotationAxis(l,x))}a[y].crossVectors(r[y],o[y])}if(i===!0){let y=Math.acos(Ms(o[0].dot(o[e]),-1,1));y/=e,r[0].dot(l.crossVectors(o[0],o[e]))>0&&(y=-y);for(let x=1;x<=e;x++)o[x].applyMatrix4(h.makeRotationAxis(r[x],y*x)),a[x].crossVectors(r[x],o[x])}return{tangents:r,normals:o,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class TA extends cc{constructor(e=0,i=0,n=1,r=1,o=0,a=Math.PI*2,l=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=n,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=a,this.aClockwise=l,this.aRotation=h}getPoint(e,i=new Fe){const n=i,r=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const a=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(a?o=0:o=r),this.aClockwise===!0&&!a&&(o===r?o=-r:o=o-r);const l=this.aStartAngle+e*o;let h=this.aX+this.xRadius*Math.cos(l),d=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const f=Math.cos(this.aRotation),p=Math.sin(this.aRotation),g=h-this.aX,y=d-this.aY;h=g*f-y*p+this.aX,d=g*p+y*f+this.aY}return n.set(h,d)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class EY extends TA{constructor(e,i,n,r,o,a){super(e,i,n,n,r,o,a),this.isArcCurve=!0,this.type="ArcCurve"}}function mL(){let s=0,e=0,i=0,n=0;function r(o,a,l,h){s=o,e=l,i=-3*o+3*a-2*l-h,n=2*o-2*a+l+h}return{initCatmullRom:function(o,a,l,h,d){r(a,l,d*(l-o),d*(h-a))},initNonuniformCatmullRom:function(o,a,l,h,d,f,p){let g=(a-o)/d-(l-o)/(d+f)+(l-a)/f,y=(l-a)/f-(h-a)/(f+p)+(h-l)/p;g*=f,y*=f,r(a,l,g,y)},calc:function(o){const a=o*o,l=a*o;return s+e*o+i*a+n*l}}}const nO=new ie,fP=new mL,pP=new mL,mP=new mL;class MY extends cc{constructor(e=[],i=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=n,this.tension=r}getPoint(e,i=new ie){const n=i,r=this.points,o=r.length,a=(o-(this.closed?0:1))*e;let l=Math.floor(a),h=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o)+1)*o:h===0&&l===o-1&&(l=o-2,h=1);let d,f;this.closed||l>0?d=r[(l-1)%o]:(nO.subVectors(r[0],r[1]).add(r[0]),d=nO);const p=r[l%o],g=r[(l+1)%o];if(this.closed||l+2<o?f=r[(l+2)%o]:(nO.subVectors(r[o-1],r[o-2]).add(r[o-1]),f=nO),this.curveType==="centripetal"||this.curveType==="chordal"){const y=this.curveType==="chordal"?.5:.25;let x=Math.pow(d.distanceToSquared(p),y),_=Math.pow(p.distanceToSquared(g),y),w=Math.pow(g.distanceToSquared(f),y);_<1e-4&&(_=1),x<1e-4&&(x=_),w<1e-4&&(w=_),fP.initNonuniformCatmullRom(d.x,p.x,g.x,f.x,x,_,w),pP.initNonuniformCatmullRom(d.y,p.y,g.y,f.y,x,_,w),mP.initNonuniformCatmullRom(d.z,p.z,g.z,f.z,x,_,w)}else this.curveType==="catmullrom"&&(fP.initCatmullRom(d.x,p.x,g.x,f.x,this.tension),pP.initCatmullRom(d.y,p.y,g.y,f.y,this.tension),mP.initCatmullRom(d.z,p.z,g.z,f.z,this.tension));return n.set(fP.calc(h),pP.calc(h),mP.calc(h)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const r=this.points[i];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(new ie().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function D5(s,e,i,n,r){const o=(n-e)*.5,a=(r-i)*.5,l=s*s,h=s*l;return(2*i-2*n+o+a)*h+(-3*i+3*n-2*o-a)*l+o*s+i}function Xke(s,e){const i=1-s;return i*i*e}function Wke(s,e){return 2*(1-s)*s*e}function Hke(s,e){return s*s*e}function Yx(s,e,i,n){return Xke(s,e)+Wke(s,i)+Hke(s,n)}function Gke(s,e){const i=1-s;return i*i*i*e}function Qke(s,e){const i=1-s;return 3*i*i*s*e}function Yke(s,e){return 3*(1-s)*s*s*e}function jke(s,e){return s*s*s*e}function jx(s,e,i,n,r){return Gke(s,e)+Qke(s,i)+Yke(s,n)+jke(s,r)}class gL extends cc{constructor(e=new Fe,i=new Fe,n=new Fe,r=new Fe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=n,this.v3=r}getPoint(e,i=new Fe){const n=i,r=this.v0,o=this.v1,a=this.v2,l=this.v3;return n.set(jx(e,r.x,o.x,a.x,l.x),jx(e,r.y,o.y,a.y,l.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class kY extends cc{constructor(e=new ie,i=new ie,n=new ie,r=new ie){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=n,this.v3=r}getPoint(e,i=new ie){const n=i,r=this.v0,o=this.v1,a=this.v2,l=this.v3;return n.set(jx(e,r.x,o.x,a.x,l.x),jx(e,r.y,o.y,a.y,l.y),jx(e,r.z,o.z,a.z,l.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class yL extends cc{constructor(e=new Fe,i=new Fe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new Fe){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new Fe){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class PY extends cc{constructor(e=new ie,i=new ie){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=i}getPoint(e,i=new ie){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new ie){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class AA extends cc{constructor(e=new Fe,i=new Fe,n=new Fe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new Fe){const n=i,r=this.v0,o=this.v1,a=this.v2;return n.set(Yx(e,r.x,o.x,a.x),Yx(e,r.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class vL extends cc{constructor(e=new ie,i=new ie,n=new ie){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new ie){const n=i,r=this.v0,o=this.v1,a=this.v2;return n.set(Yx(e,r.x,o.x,a.x),Yx(e,r.y,o.y,a.y),Yx(e,r.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xL extends cc{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,i=new Fe){const n=i,r=this.points,o=(r.length-1)*e,a=Math.floor(o),l=o-a,h=r[a===0?a:a-1],d=r[a],f=r[a>r.length-2?r.length-1:a+1],p=r[a>r.length-3?r.length-1:a+2];return n.set(D5(l,h.x,d.x,f.x,p.x),D5(l,h.y,d.y,f.y,p.y)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const r=this.points[i];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(new Fe().fromArray(r))}return this}}var YC=Object.freeze({__proto__:null,ArcCurve:EY,CatmullRomCurve3:MY,CubicBezierCurve:gL,CubicBezierCurve3:kY,EllipseCurve:TA,LineCurve:yL,LineCurve3:PY,QuadraticBezierCurve:AA,QuadraticBezierCurve3:vL,SplineCurve:xL});class IY extends cc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(i)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new YC[n](i,e))}return this}getPoint(e,i){const n=e*this.getLength(),r=this.getCurveLengths();let o=0;for(;o<r.length;){if(r[o]>=n){const a=r[o]-n,l=this.curves[o],h=l.getLength(),d=h===0?0:1-a/h;return l.getPointAt(d,i)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let i=0;for(let n=0,r=this.curves.length;n<r;n++)i+=this.curves[n].getLength(),e.push(i);return this.cacheLengths=e,e}getSpacedPoints(e=40){const i=[];for(let n=0;n<=e;n++)i.push(this.getPoint(n/e));return this.autoClose&&i.push(i[0]),i}getPoints(e=12){const i=[];let n;for(let r=0,o=this.curves;r<o.length;r++){const a=o[r],l=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,h=a.getPoints(l);for(let d=0;d<h.length;d++){const f=h[d];n&&n.equals(f)||(i.push(f),n=f)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let i=0,n=e.curves.length;i<n;i++){const r=e.curves[i];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let i=0,n=this.curves.length;i<n;i++){const r=this.curves[i];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let i=0,n=e.curves.length;i<n;i++){const r=e.curves[i];this.curves.push(new YC[r.type]().fromJSON(r))}return this}}class M_ extends IY{constructor(e){super(),this.type="Path",this.currentPoint=new Fe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let i=1,n=e.length;i<n;i++)this.lineTo(e[i].x,e[i].y);return this}moveTo(e,i){return this.currentPoint.set(e,i),this}lineTo(e,i){const n=new yL(this.currentPoint.clone(),new Fe(e,i));return this.curves.push(n),this.currentPoint.set(e,i),this}quadraticCurveTo(e,i,n,r){const o=new AA(this.currentPoint.clone(),new Fe(e,i),new Fe(n,r));return this.curves.push(o),this.currentPoint.set(n,r),this}bezierCurveTo(e,i,n,r,o,a){const l=new gL(this.currentPoint.clone(),new Fe(e,i),new Fe(n,r),new Fe(o,a));return this.curves.push(l),this.currentPoint.set(o,a),this}splineThru(e){const i=[this.currentPoint.clone()].concat(e),n=new xL(i);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,i,n,r,o,a){const l=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(e+l,i+h,n,r,o,a),this}absarc(e,i,n,r,o,a){return this.absellipse(e,i,n,n,r,o,a),this}ellipse(e,i,n,r,o,a,l,h){const d=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+d,i+f,n,r,o,a,l,h),this}absellipse(e,i,n,r,o,a,l,h){const d=new TA(e,i,n,r,o,a,l,h);if(this.curves.length>0){const p=d.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(d);const f=d.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Eb extends $i{constructor(e=[new Fe(0,-.5),new Fe(.5,0),new Fe(0,.5)],i=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:i,phiStart:n,phiLength:r},i=Math.floor(i),r=Ms(r,0,Math.PI*2);const o=[],a=[],l=[],h=[],d=[],f=1/i,p=new ie,g=new Fe,y=new ie,x=new ie,_=new ie;let w=0,O=0;for(let T=0;T<=e.length-1;T++)switch(T){case 0:w=e[T+1].x-e[T].x,O=e[T+1].y-e[T].y,y.x=O*1,y.y=-w,y.z=O*0,_.copy(y),y.normalize(),h.push(y.x,y.y,y.z);break;case e.length-1:h.push(_.x,_.y,_.z);break;default:w=e[T+1].x-e[T].x,O=e[T+1].y-e[T].y,y.x=O*1,y.y=-w,y.z=O*0,x.copy(y),y.x+=_.x,y.y+=_.y,y.z+=_.z,y.normalize(),h.push(y.x,y.y,y.z),_.copy(x)}for(let T=0;T<=i;T++){const C=n+T*f*r,A=Math.sin(C),B=Math.cos(C);for(let I=0;I<=e.length-1;I++){p.x=e[I].x*A,p.y=e[I].y,p.z=e[I].x*B,a.push(p.x,p.y,p.z),g.x=T/i,g.y=I/(e.length-1),l.push(g.x,g.y);const R=h[3*I+0]*A,P=h[3*I+1],k=h[3*I+0]*B;d.push(R,P,k)}}for(let T=0;T<i;T++)for(let C=0;C<e.length-1;C++){const A=C+T*e.length,B=A,I=A+e.length,R=A+e.length+1,P=A+1;o.push(B,I,P),o.push(R,P,I)}this.setIndex(o),this.setAttribute("position",new Ut(a,3)),this.setAttribute("uv",new Ut(l,2)),this.setAttribute("normal",new Ut(d,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Eb(e.points,e.segments,e.phiStart,e.phiLength)}}class EA extends Eb{constructor(e=1,i=1,n=4,r=8){const o=new M_;o.absarc(0,-i/2,e,Math.PI*1.5,0),o.absarc(0,i/2,e,0,Math.PI*.5),super(o.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:i,capSegments:n,radialSegments:r}}static fromJSON(e){return new EA(e.radius,e.length,e.capSegments,e.radialSegments)}}class MA extends $i{constructor(e=1,i=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:i,thetaStart:n,thetaLength:r},i=Math.max(3,i);const o=[],a=[],l=[],h=[],d=new ie,f=new Fe;a.push(0,0,0),l.push(0,0,1),h.push(.5,.5);for(let p=0,g=3;p<=i;p++,g+=3){const y=n+p/i*r;d.x=e*Math.cos(y),d.y=e*Math.sin(y),a.push(d.x,d.y,d.z),l.push(0,0,1),f.x=(a[g]/e+1)/2,f.y=(a[g+1]/e+1)/2,h.push(f.x,f.y)}for(let p=1;p<=i;p++)o.push(p,p+1,0);this.setIndex(o),this.setAttribute("position",new Ut(a,3)),this.setAttribute("normal",new Ut(l,3)),this.setAttribute("uv",new Ut(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new MA(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Ry extends $i{constructor(e=1,i=1,n=1,r=32,o=1,a=!1,l=0,h=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:n,radialSegments:r,heightSegments:o,openEnded:a,thetaStart:l,thetaLength:h};const d=this;r=Math.floor(r),o=Math.floor(o);const f=[],p=[],g=[],y=[];let x=0;const _=[],w=n/2;let O=0;T(),a===!1&&(e>0&&C(!0),i>0&&C(!1)),this.setIndex(f),this.setAttribute("position",new Ut(p,3)),this.setAttribute("normal",new Ut(g,3)),this.setAttribute("uv",new Ut(y,2));function T(){const A=new ie,B=new ie;let I=0;const R=(i-e)/n;for(let P=0;P<=o;P++){const k=[],E=P/o,D=E*(i-e)+e;for(let L=0;L<=r;L++){const V=L/r,F=V*h+l,j=Math.sin(F),Q=Math.cos(F);B.x=D*j,B.y=-E*n+w,B.z=D*Q,p.push(B.x,B.y,B.z),A.set(j,R,Q).normalize(),g.push(A.x,A.y,A.z),y.push(V,1-E),k.push(x++)}_.push(k)}for(let P=0;P<r;P++)for(let k=0;k<o;k++){const E=_[k][P],D=_[k+1][P],L=_[k+1][P+1],V=_[k][P+1];f.push(E,D,V),f.push(D,L,V),I+=6}d.addGroup(O,I,0),O+=I}function C(A){const B=x,I=new Fe,R=new ie;let P=0;const k=A===!0?e:i,E=A===!0?1:-1;for(let L=1;L<=r;L++)p.push(0,w*E,0),g.push(0,E,0),y.push(.5,.5),x++;const D=x;for(let L=0;L<=r;L++){const F=L/r*h+l,j=Math.cos(F),Q=Math.sin(F);R.x=k*Q,R.y=w*E,R.z=k*j,p.push(R.x,R.y,R.z),g.push(0,E,0),I.x=j*.5+.5,I.y=Q*.5*E+.5,y.push(I.x,I.y),x++}for(let L=0;L<r;L++){const V=B+L,F=D+L;A===!0?f.push(F,F+1,V):f.push(F+1,F,V),P+=3}d.addGroup(O,P,A===!0?1:2),O+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ry(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class kA extends Ry{constructor(e=1,i=1,n=32,r=1,o=!1,a=0,l=Math.PI*2){super(0,e,i,n,r,o,a,l),this.type="ConeGeometry",this.parameters={radius:e,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:l}}static fromJSON(e){return new kA(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class bf extends $i{constructor(e=[],i=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:i,radius:n,detail:r};const o=[],a=[];l(r),d(n),f(),this.setAttribute("position",new Ut(o,3)),this.setAttribute("normal",new Ut(o.slice(),3)),this.setAttribute("uv",new Ut(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function l(T){const C=new ie,A=new ie,B=new ie;for(let I=0;I<i.length;I+=3)y(i[I+0],C),y(i[I+1],A),y(i[I+2],B),h(C,A,B,T)}function h(T,C,A,B){const I=B+1,R=[];for(let P=0;P<=I;P++){R[P]=[];const k=T.clone().lerp(A,P/I),E=C.clone().lerp(A,P/I),D=I-P;for(let L=0;L<=D;L++)L===0&&P===I?R[P][L]=k:R[P][L]=k.clone().lerp(E,L/D)}for(let P=0;P<I;P++)for(let k=0;k<2*(I-P)-1;k++){const E=Math.floor(k/2);k%2===0?(g(R[P][E+1]),g(R[P+1][E]),g(R[P][E])):(g(R[P][E+1]),g(R[P+1][E+1]),g(R[P+1][E]))}}function d(T){const C=new ie;for(let A=0;A<o.length;A+=3)C.x=o[A+0],C.y=o[A+1],C.z=o[A+2],C.normalize().multiplyScalar(T),o[A+0]=C.x,o[A+1]=C.y,o[A+2]=C.z}function f(){const T=new ie;for(let C=0;C<o.length;C+=3){T.x=o[C+0],T.y=o[C+1],T.z=o[C+2];const A=w(T)/2/Math.PI+.5,B=O(T)/Math.PI+.5;a.push(A,1-B)}x(),p()}function p(){for(let T=0;T<a.length;T+=6){const C=a[T+0],A=a[T+2],B=a[T+4],I=Math.max(C,A,B),R=Math.min(C,A,B);I>.9&&R<.1&&(C<.2&&(a[T+0]+=1),A<.2&&(a[T+2]+=1),B<.2&&(a[T+4]+=1))}}function g(T){o.push(T.x,T.y,T.z)}function y(T,C){const A=T*3;C.x=e[A+0],C.y=e[A+1],C.z=e[A+2]}function x(){const T=new ie,C=new ie,A=new ie,B=new ie,I=new Fe,R=new Fe,P=new Fe;for(let k=0,E=0;k<o.length;k+=9,E+=6){T.set(o[k+0],o[k+1],o[k+2]),C.set(o[k+3],o[k+4],o[k+5]),A.set(o[k+6],o[k+7],o[k+8]),I.set(a[E+0],a[E+1]),R.set(a[E+2],a[E+3]),P.set(a[E+4],a[E+5]),B.copy(T).add(C).add(A).divideScalar(3);const D=w(B);_(I,E+0,T,D),_(R,E+2,C,D),_(P,E+4,A,D)}}function _(T,C,A,B){B<0&&T.x===1&&(a[C]=T.x-1),A.x===0&&A.z===0&&(a[C]=B/2/Math.PI+.5)}function w(T){return Math.atan2(T.z,-T.x)}function O(T){return Math.atan2(-T.y,Math.sqrt(T.x*T.x+T.z*T.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bf(e.vertices,e.indices,e.radius,e.details)}}class PA extends bf{constructor(e=1,i=0){const n=(1+Math.sqrt(5))/2,r=1/n,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,a,e,i),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new PA(e.radius,e.detail)}}const sO=new ie,rO=new ie,gP=new ie,oO=new Ho;class BY extends $i{constructor(e=null,i=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:i},e!==null){const r=Math.pow(10,4),o=Math.cos(Kp*i),a=e.getIndex(),l=e.getAttribute("position"),h=a?a.count:l.count,d=[0,0,0],f=["a","b","c"],p=new Array(3),g={},y=[];for(let x=0;x<h;x+=3){a?(d[0]=a.getX(x),d[1]=a.getX(x+1),d[2]=a.getX(x+2)):(d[0]=x,d[1]=x+1,d[2]=x+2);const{a:_,b:w,c:O}=oO;if(_.fromBufferAttribute(l,d[0]),w.fromBufferAttribute(l,d[1]),O.fromBufferAttribute(l,d[2]),oO.getNormal(gP),p[0]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,p[1]=`${Math.round(w.x*r)},${Math.round(w.y*r)},${Math.round(w.z*r)}`,p[2]=`${Math.round(O.x*r)},${Math.round(O.y*r)},${Math.round(O.z*r)}`,!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let T=0;T<3;T++){const C=(T+1)%3,A=p[T],B=p[C],I=oO[f[T]],R=oO[f[C]],P=`${A}_${B}`,k=`${B}_${A}`;k in g&&g[k]?(gP.dot(g[k].normal)<=o&&(y.push(I.x,I.y,I.z),y.push(R.x,R.y,R.z)),g[k]=null):P in g||(g[P]={index0:d[T],index1:d[C],normal:gP.clone()})}}for(const x in g)if(g[x]){const{index0:_,index1:w}=g[x];sO.fromBufferAttribute(l,_),rO.fromBufferAttribute(l,w),y.push(sO.x,sO.y,sO.z),y.push(rO.x,rO.y,rO.z)}this.setAttribute("position",new Ut(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}let em=class extends M_{constructor(e){super(e),this.uuid=La(),this.type="Shape",this.holes=[]}getPointsHoles(e){const i=[];for(let n=0,r=this.holes.length;n<r;n++)i[n]=this.holes[n].getPoints(e);return i}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let i=0,n=e.holes.length;i<n;i++){const r=e.holes[i];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let i=0,n=this.holes.length;i<n;i++){const r=this.holes[i];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let i=0,n=e.holes.length;i<n;i++){const r=e.holes[i];this.holes.push(new M_().fromJSON(r))}return this}};const qke={triangulate:function(s,e,i=2){const n=e&&e.length,r=n?e[0]*i:s.length;let o=RY(s,0,r,i,!0);const a=[];if(!o||o.next===o.prev)return a;let l,h,d,f,p,g,y;if(n&&(o=tPe(s,e,o,i)),s.length>80*i){l=d=s[0],h=f=s[1];for(let x=i;x<r;x+=i)p=s[x],g=s[x+1],p<l&&(l=p),g<h&&(h=g),p>d&&(d=p),g>f&&(f=g);y=Math.max(d-l,f-h),y=y!==0?32767/y:0}return k_(o,a,i,l,h,y,0),a}};function RY(s,e,i,n,r){let o,a;if(r===dPe(s,e,i,n)>0)for(o=e;o<i;o+=n)a=L5(o,s[o],s[o+1],a);else for(o=i-n;o>=e;o-=n)a=L5(o,s[o],s[o+1],a);return a&&IA(a,a.next)&&(I_(a),a=a.next),a}function gm(s,e){if(!s)return s;e||(e=s);let i=s,n;do if(n=!1,!i.steiner&&(IA(i,i.next)||gs(i.prev,i,i.next)===0)){if(I_(i),i=e=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==e);return e}function k_(s,e,i,n,r,o,a){if(!s)return;!a&&o&&oPe(s,n,r,o);let l=s,h,d;for(;s.prev!==s.next;){if(h=s.prev,d=s.next,o?Kke(s,n,r,o):Zke(s)){e.push(h.i/i|0),e.push(s.i/i|0),e.push(d.i/i|0),I_(s),s=d.next,l=d.next;continue}if(s=d,s===l){a?a===1?(s=Jke(gm(s),e,i),k_(s,e,i,n,r,o,2)):a===2&&ePe(s,e,i,n,r,o):k_(gm(s),e,i,n,r,o,1);break}}}function Zke(s){const e=s.prev,i=s,n=s.next;if(gs(e,i,n)>=0)return!1;const r=e.x,o=i.x,a=n.x,l=e.y,h=i.y,d=n.y,f=r<o?r<a?r:a:o<a?o:a,p=l<h?l<d?l:d:h<d?h:d,g=r>o?r>a?r:a:o>a?o:a,y=l>h?l>d?l:d:h>d?h:d;let x=n.next;for(;x!==e;){if(x.x>=f&&x.x<=g&&x.y>=p&&x.y<=y&&p0(r,l,o,h,a,d,x.x,x.y)&&gs(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function Kke(s,e,i,n){const r=s.prev,o=s,a=s.next;if(gs(r,o,a)>=0)return!1;const l=r.x,h=o.x,d=a.x,f=r.y,p=o.y,g=a.y,y=l<h?l<d?l:d:h<d?h:d,x=f<p?f<g?f:g:p<g?p:g,_=l>h?l>d?l:d:h>d?h:d,w=f>p?f>g?f:g:p>g?p:g,O=kB(y,x,e,i,n),T=kB(_,w,e,i,n);let C=s.prevZ,A=s.nextZ;for(;C&&C.z>=O&&A&&A.z<=T;){if(C.x>=y&&C.x<=_&&C.y>=x&&C.y<=w&&C!==r&&C!==a&&p0(l,f,h,p,d,g,C.x,C.y)&&gs(C.prev,C,C.next)>=0||(C=C.prevZ,A.x>=y&&A.x<=_&&A.y>=x&&A.y<=w&&A!==r&&A!==a&&p0(l,f,h,p,d,g,A.x,A.y)&&gs(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;C&&C.z>=O;){if(C.x>=y&&C.x<=_&&C.y>=x&&C.y<=w&&C!==r&&C!==a&&p0(l,f,h,p,d,g,C.x,C.y)&&gs(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;A&&A.z<=T;){if(A.x>=y&&A.x<=_&&A.y>=x&&A.y<=w&&A!==r&&A!==a&&p0(l,f,h,p,d,g,A.x,A.y)&&gs(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function Jke(s,e,i){let n=s;do{const r=n.prev,o=n.next.next;!IA(r,o)&&DY(r,n,n.next,o)&&P_(r,o)&&P_(o,r)&&(e.push(r.i/i|0),e.push(n.i/i|0),e.push(o.i/i|0),I_(n),I_(n.next),n=s=o),n=n.next}while(n!==s);return gm(n)}function ePe(s,e,i,n,r,o){let a=s;do{let l=a.next.next;for(;l!==a.prev;){if(a.i!==l.i&&cPe(a,l)){let h=LY(a,l);a=gm(a,a.next),h=gm(h,h.next),k_(a,e,i,n,r,o,0),k_(h,e,i,n,r,o,0);return}l=l.next}a=a.next}while(a!==s)}function tPe(s,e,i,n){const r=[];let o,a,l,h,d;for(o=0,a=e.length;o<a;o++)l=e[o]*n,h=o<a-1?e[o+1]*n:s.length,d=RY(s,l,h,n,!1),d===d.next&&(d.steiner=!0),r.push(lPe(d));for(r.sort(iPe),o=0;o<r.length;o++)i=nPe(r[o],i);return i}function iPe(s,e){return s.x-e.x}function nPe(s,e){const i=sPe(s,e);if(!i)return e;const n=LY(i,s);return gm(n,n.next),gm(i,i.next)}function sPe(s,e){let i=e,n=-1/0,r;const o=s.x,a=s.y;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){const g=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(g<=o&&g>n&&(n=g,r=i.x<i.next.x?i:i.next,g===o))return r}i=i.next}while(i!==e);if(!r)return null;const l=r,h=r.x,d=r.y;let f=1/0,p;i=r;do o>=i.x&&i.x>=h&&o!==i.x&&p0(a<d?o:n,a,h,d,a<d?n:o,a,i.x,i.y)&&(p=Math.abs(a-i.y)/(o-i.x),P_(i,s)&&(p<f||p===f&&(i.x>r.x||i.x===r.x&&rPe(r,i)))&&(r=i,f=p)),i=i.next;while(i!==l);return r}function rPe(s,e){return gs(s.prev,s,e.prev)<0&&gs(e.next,s,s.next)<0}function oPe(s,e,i,n){let r=s;do r.z===0&&(r.z=kB(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,aPe(r)}function aPe(s){let e,i,n,r,o,a,l,h,d=1;do{for(i=s,s=null,o=null,a=0;i;){for(a++,n=i,l=0,e=0;e<d&&(l++,n=n.nextZ,!!n);e++);for(h=d;l>0||h>0&&n;)l!==0&&(h===0||!n||i.z<=n.z)?(r=i,i=i.nextZ,l--):(r=n,n=n.nextZ,h--),o?o.nextZ=r:s=r,r.prevZ=o,o=r;i=n}o.nextZ=null,d*=2}while(a>1);return s}function kB(s,e,i,n,r){return s=(s-i)*r|0,e=(e-n)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function lPe(s){let e=s,i=s;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==s);return i}function p0(s,e,i,n,r,o,a,l){return(r-a)*(e-l)>=(s-a)*(o-l)&&(s-a)*(n-l)>=(i-a)*(e-l)&&(i-a)*(o-l)>=(r-a)*(n-l)}function cPe(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!hPe(s,e)&&(P_(s,e)&&P_(e,s)&&uPe(s,e)&&(gs(s.prev,s,e.prev)||gs(s,e.prev,e))||IA(s,e)&&gs(s.prev,s,s.next)>0&&gs(e.prev,e,e.next)>0)}function gs(s,e,i){return(e.y-s.y)*(i.x-e.x)-(e.x-s.x)*(i.y-e.y)}function IA(s,e){return s.x===e.x&&s.y===e.y}function DY(s,e,i,n){const r=lO(gs(s,e,i)),o=lO(gs(s,e,n)),a=lO(gs(i,n,s)),l=lO(gs(i,n,e));return!!(r!==o&&a!==l||r===0&&aO(s,i,e)||o===0&&aO(s,n,e)||a===0&&aO(i,s,n)||l===0&&aO(i,e,n))}function aO(s,e,i){return e.x<=Math.max(s.x,i.x)&&e.x>=Math.min(s.x,i.x)&&e.y<=Math.max(s.y,i.y)&&e.y>=Math.min(s.y,i.y)}function lO(s){return s>0?1:s<0?-1:0}function hPe(s,e){let i=s;do{if(i.i!==s.i&&i.next.i!==s.i&&i.i!==e.i&&i.next.i!==e.i&&DY(i,i.next,s,e))return!0;i=i.next}while(i!==s);return!1}function P_(s,e){return gs(s.prev,s,s.next)<0?gs(s,e,s.next)>=0&&gs(s,s.prev,e)>=0:gs(s,e,s.prev)<0||gs(s,s.next,e)<0}function uPe(s,e){let i=s,n=!1;const r=(s.x+e.x)/2,o=(s.y+e.y)/2;do i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==s);return n}function LY(s,e){const i=new PB(s.i,s.x,s.y),n=new PB(e.i,e.x,e.y),r=s.next,o=e.prev;return s.next=e,e.prev=s,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function L5(s,e,i,n){const r=new PB(s,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function I_(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function PB(s,e,i){this.i=s,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function dPe(s,e,i,n){let r=0;for(let o=e,a=i-n;o<i;o+=n)r+=(s[a]-s[o])*(s[o+1]+s[a+1]),a=o;return r}class Kc{static area(e){const i=e.length;let n=0;for(let r=i-1,o=0;o<i;r=o++)n+=e[r].x*e[o].y-e[o].x*e[r].y;return n*.5}static isClockWise(e){return Kc.area(e)<0}static triangulateShape(e,i){const n=[],r=[],o=[];N5(e),V5(n,e);let a=e.length;i.forEach(N5);for(let h=0;h<i.length;h++)r.push(a),a+=i[h].length,V5(n,i[h]);const l=qke.triangulate(n,r);for(let h=0;h<l.length;h+=3)o.push(l.slice(h,h+3));return o}}function N5(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function V5(s,e){for(let i=0;i<e.length;i++)s.push(e[i].x),s.push(e[i].y)}class BA extends $i{constructor(e=new em([new Fe(.5,.5),new Fe(-.5,.5),new Fe(-.5,-.5),new Fe(.5,-.5)]),i={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:i},e=Array.isArray(e)?e:[e];const n=this,r=[],o=[];for(let l=0,h=e.length;l<h;l++){const d=e[l];a(d)}this.setAttribute("position",new Ut(r,3)),this.setAttribute("uv",new Ut(o,2)),this.computeVertexNormals();function a(l){const h=[],d=i.curveSegments!==void 0?i.curveSegments:12,f=i.steps!==void 0?i.steps:1,p=i.depth!==void 0?i.depth:1;let g=i.bevelEnabled!==void 0?i.bevelEnabled:!0,y=i.bevelThickness!==void 0?i.bevelThickness:.2,x=i.bevelSize!==void 0?i.bevelSize:y-.1,_=i.bevelOffset!==void 0?i.bevelOffset:0,w=i.bevelSegments!==void 0?i.bevelSegments:3;const O=i.extrudePath,T=i.UVGenerator!==void 0?i.UVGenerator:fPe;let C,A=!1,B,I,R,P;O&&(C=O.getSpacedPoints(f),A=!0,g=!1,B=O.computeFrenetFrames(f,!1),I=new ie,R=new ie,P=new ie),g||(w=0,y=0,x=0,_=0);const k=l.extractPoints(d);let E=k.shape;const D=k.holes;if(!Kc.isClockWise(E)){E=E.reverse();for(let ae=0,z=D.length;ae<z;ae++){const q=D[ae];Kc.isClockWise(q)&&(D[ae]=q.reverse())}}const V=Kc.triangulateShape(E,D),F=E;for(let ae=0,z=D.length;ae<z;ae++){const q=D[ae];E=E.concat(q)}function j(ae,z,q){return z||console.error("THREE.ExtrudeGeometry: vec does not exist"),ae.clone().addScaledVector(z,q)}const Q=E.length,ee=V.length;function J(ae,z,q){let le,he,be;const Ee=ae.x-z.x,Z=ae.y-z.y,G=q.x-ae.x,ce=q.y-ae.y,de=Ee*Ee+Z*Z,Oe=Ee*ce-Z*G;if(Math.abs(Oe)>Number.EPSILON){const Ae=Math.sqrt(de),je=Math.sqrt(G*G+ce*ce),Ge=z.x-Z/Ae,Qe=z.y+Ee/Ae,yt=q.x-ce/je,Ke=q.y+G/je,ht=((yt-Ge)*ce-(Ke-Qe)*G)/(Ee*ce-Z*G);le=Ge+Ee*ht-ae.x,he=Qe+Z*ht-ae.y;const ti=le*le+he*he;if(ti<=2)return new Fe(le,he);be=Math.sqrt(ti/2)}else{let Ae=!1;Ee>Number.EPSILON?G>Number.EPSILON&&(Ae=!0):Ee<-Number.EPSILON?G<-Number.EPSILON&&(Ae=!0):Math.sign(Z)===Math.sign(ce)&&(Ae=!0),Ae?(le=-Z,he=Ee,be=Math.sqrt(de)):(le=Ee,he=Z,be=Math.sqrt(de/2))}return new Fe(le/be,he/be)}const ue=[];for(let ae=0,z=F.length,q=z-1,le=ae+1;ae<z;ae++,q++,le++)q===z&&(q=0),le===z&&(le=0),ue[ae]=J(F[ae],F[q],F[le]);const oe=[];let pe,Ue=ue.concat();for(let ae=0,z=D.length;ae<z;ae++){const q=D[ae];pe=[];for(let le=0,he=q.length,be=he-1,Ee=le+1;le<he;le++,be++,Ee++)be===he&&(be=0),Ee===he&&(Ee=0),pe[le]=J(q[le],q[be],q[Ee]);oe.push(pe),Ue=Ue.concat(pe)}for(let ae=0;ae<w;ae++){const z=ae/w,q=y*Math.cos(z*Math.PI/2),le=x*Math.sin(z*Math.PI/2)+_;for(let he=0,be=F.length;he<be;he++){const Ee=j(F[he],ue[he],le);De(Ee.x,Ee.y,-q)}for(let he=0,be=D.length;he<be;he++){const Ee=D[he];pe=oe[he];for(let Z=0,G=Ee.length;Z<G;Z++){const ce=j(Ee[Z],pe[Z],le);De(ce.x,ce.y,-q)}}}const tt=x+_;for(let ae=0;ae<Q;ae++){const z=g?j(E[ae],Ue[ae],tt):E[ae];A?(R.copy(B.normals[0]).multiplyScalar(z.x),I.copy(B.binormals[0]).multiplyScalar(z.y),P.copy(C[0]).add(R).add(I),De(P.x,P.y,P.z)):De(z.x,z.y,0)}for(let ae=1;ae<=f;ae++)for(let z=0;z<Q;z++){const q=g?j(E[z],Ue[z],tt):E[z];A?(R.copy(B.normals[ae]).multiplyScalar(q.x),I.copy(B.binormals[ae]).multiplyScalar(q.y),P.copy(C[ae]).add(R).add(I),De(P.x,P.y,P.z)):De(q.x,q.y,p/f*ae)}for(let ae=w-1;ae>=0;ae--){const z=ae/w,q=y*Math.cos(z*Math.PI/2),le=x*Math.sin(z*Math.PI/2)+_;for(let he=0,be=F.length;he<be;he++){const Ee=j(F[he],ue[he],le);De(Ee.x,Ee.y,p+q)}for(let he=0,be=D.length;he<be;he++){const Ee=D[he];pe=oe[he];for(let Z=0,G=Ee.length;Z<G;Z++){const ce=j(Ee[Z],pe[Z],le);A?De(ce.x,ce.y+C[f-1].y,C[f-1].x+q):De(ce.x,ce.y,p+q)}}}ve(),Re();function ve(){const ae=r.length/3;if(g){let z=0,q=Q*z;for(let le=0;le<ee;le++){const he=V[le];Se(he[2]+q,he[1]+q,he[0]+q)}z=f+w*2,q=Q*z;for(let le=0;le<ee;le++){const he=V[le];Se(he[0]+q,he[1]+q,he[2]+q)}}else{for(let z=0;z<ee;z++){const q=V[z];Se(q[2],q[1],q[0])}for(let z=0;z<ee;z++){const q=V[z];Se(q[0]+Q*f,q[1]+Q*f,q[2]+Q*f)}}n.addGroup(ae,r.length/3-ae,0)}function Re(){const ae=r.length/3;let z=0;Le(F,z),z+=F.length;for(let q=0,le=D.length;q<le;q++){const he=D[q];Le(he,z),z+=he.length}n.addGroup(ae,r.length/3-ae,1)}function Le(ae,z){let q=ae.length;for(;--q>=0;){const le=q;let he=q-1;he<0&&(he=ae.length-1);for(let be=0,Ee=f+w*2;be<Ee;be++){const Z=Q*be,G=Q*(be+1),ce=z+le+Z,de=z+he+Z,Oe=z+he+G,Ae=z+le+G;Y(ce,de,Oe,Ae)}}}function De(ae,z,q){h.push(ae),h.push(z),h.push(q)}function Se(ae,z,q){W(ae),W(z),W(q);const le=r.length/3,he=T.generateTopUV(n,r,le-3,le-2,le-1);te(he[0]),te(he[1]),te(he[2])}function Y(ae,z,q,le){W(ae),W(z),W(le),W(z),W(q),W(le);const he=r.length/3,be=T.generateSideWallUV(n,r,he-6,he-3,he-2,he-1);te(be[0]),te(be[1]),te(be[3]),te(be[1]),te(be[2]),te(be[3])}function W(ae){r.push(h[ae*3+0]),r.push(h[ae*3+1]),r.push(h[ae*3+2])}function te(ae){o.push(ae.x),o.push(ae.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes,n=this.parameters.options;return pPe(i,n,e)}static fromJSON(e,i){const n=[];for(let o=0,a=e.shapes.length;o<a;o++){const l=i[e.shapes[o]];n.push(l)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new YC[r.type]().fromJSON(r)),new BA(n,e.options)}}const fPe={generateTopUV:function(s,e,i,n,r){const o=e[i*3],a=e[i*3+1],l=e[n*3],h=e[n*3+1],d=e[r*3],f=e[r*3+1];return[new Fe(o,a),new Fe(l,h),new Fe(d,f)]},generateSideWallUV:function(s,e,i,n,r,o){const a=e[i*3],l=e[i*3+1],h=e[i*3+2],d=e[n*3],f=e[n*3+1],p=e[n*3+2],g=e[r*3],y=e[r*3+1],x=e[r*3+2],_=e[o*3],w=e[o*3+1],O=e[o*3+2];return Math.abs(l-f)<Math.abs(a-d)?[new Fe(a,1-h),new Fe(d,1-p),new Fe(g,1-x),new Fe(_,1-O)]:[new Fe(l,1-h),new Fe(f,1-p),new Fe(y,1-x),new Fe(w,1-O)]}};function pPe(s,e,i){if(i.shapes=[],Array.isArray(s))for(let n=0,r=s.length;n<r;n++){const o=s[n];i.shapes.push(o.uuid)}else i.shapes.push(s.uuid);return i.options=Object.assign({},e),e.extrudePath!==void 0&&(i.options.extrudePath=e.extrudePath.toJSON()),i}class RA extends bf{constructor(e=1,i=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,o,e,i),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new RA(e.radius,e.detail)}}class Mb extends bf{constructor(e=1,i=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,i),this.type="OctahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new Mb(e.radius,e.detail)}}class DA extends $i{constructor(e=.5,i=1,n=32,r=1,o=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:i,thetaSegments:n,phiSegments:r,thetaStart:o,thetaLength:a},n=Math.max(3,n),r=Math.max(1,r);const l=[],h=[],d=[],f=[];let p=e;const g=(i-e)/r,y=new ie,x=new Fe;for(let _=0;_<=r;_++){for(let w=0;w<=n;w++){const O=o+w/n*a;y.x=p*Math.cos(O),y.y=p*Math.sin(O),h.push(y.x,y.y,y.z),d.push(0,0,1),x.x=(y.x/i+1)/2,x.y=(y.y/i+1)/2,f.push(x.x,x.y)}p+=g}for(let _=0;_<r;_++){const w=_*(n+1);for(let O=0;O<n;O++){const T=O+w,C=T,A=T+n+1,B=T+n+2,I=T+1;l.push(C,A,I),l.push(A,B,I)}}this.setIndex(l),this.setAttribute("position",new Ut(h,3)),this.setAttribute("normal",new Ut(d,3)),this.setAttribute("uv",new Ut(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new DA(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class LA extends $i{constructor(e=new em([new Fe(0,.5),new Fe(-.5,-.5),new Fe(.5,-.5)]),i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:i};const n=[],r=[],o=[],a=[];let l=0,h=0;if(Array.isArray(e)===!1)d(e);else for(let f=0;f<e.length;f++)d(e[f]),this.addGroup(l,h,f),l+=h,h=0;this.setIndex(n),this.setAttribute("position",new Ut(r,3)),this.setAttribute("normal",new Ut(o,3)),this.setAttribute("uv",new Ut(a,2));function d(f){const p=r.length/3,g=f.extractPoints(i);let y=g.shape;const x=g.holes;Kc.isClockWise(y)===!1&&(y=y.reverse());for(let w=0,O=x.length;w<O;w++){const T=x[w];Kc.isClockWise(T)===!0&&(x[w]=T.reverse())}const _=Kc.triangulateShape(y,x);for(let w=0,O=x.length;w<O;w++){const T=x[w];y=y.concat(T)}for(let w=0,O=y.length;w<O;w++){const T=y[w];r.push(T.x,T.y,0),o.push(0,0,1),a.push(T.x,T.y)}for(let w=0,O=_.length;w<O;w++){const T=_[w],C=T[0]+p,A=T[1]+p,B=T[2]+p;n.push(C,A,B),h+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes;return mPe(i,e)}static fromJSON(e,i){const n=[];for(let r=0,o=e.shapes.length;r<o;r++){const a=i[e.shapes[r]];n.push(a)}return new LA(n,e.curveSegments)}}function mPe(s,e){if(e.shapes=[],Array.isArray(s))for(let i=0,n=s.length;i<n;i++){const r=s[i];e.shapes.push(r.uuid)}else e.shapes.push(s.uuid);return e}class kb extends $i{constructor(e=1,i=32,n=16,r=0,o=Math.PI*2,a=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:n,phiStart:r,phiLength:o,thetaStart:a,thetaLength:l},i=Math.max(3,Math.floor(i)),n=Math.max(2,Math.floor(n));const h=Math.min(a+l,Math.PI);let d=0;const f=[],p=new ie,g=new ie,y=[],x=[],_=[],w=[];for(let O=0;O<=n;O++){const T=[],C=O/n;let A=0;O===0&&a===0?A=.5/i:O===n&&h===Math.PI&&(A=-.5/i);for(let B=0;B<=i;B++){const I=B/i;p.x=-e*Math.cos(r+I*o)*Math.sin(a+C*l),p.y=e*Math.cos(a+C*l),p.z=e*Math.sin(r+I*o)*Math.sin(a+C*l),x.push(p.x,p.y,p.z),g.copy(p).normalize(),_.push(g.x,g.y,g.z),w.push(I+A,1-C),T.push(d++)}f.push(T)}for(let O=0;O<n;O++)for(let T=0;T<i;T++){const C=f[O][T+1],A=f[O][T],B=f[O+1][T],I=f[O+1][T+1];(O!==0||a>0)&&y.push(C,A,I),(O!==n-1||h<Math.PI)&&y.push(A,B,I)}this.setIndex(y),this.setAttribute("position",new Ut(x,3)),this.setAttribute("normal",new Ut(_,3)),this.setAttribute("uv",new Ut(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kb(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class NA extends bf{constructor(e=1,i=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,i),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new NA(e.radius,e.detail)}}class VA extends $i{constructor(e=1,i=.4,n=12,r=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:i,radialSegments:n,tubularSegments:r,arc:o},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],h=[],d=[],f=new ie,p=new ie,g=new ie;for(let y=0;y<=n;y++)for(let x=0;x<=r;x++){const _=x/r*o,w=y/n*Math.PI*2;p.x=(e+i*Math.cos(w))*Math.cos(_),p.y=(e+i*Math.cos(w))*Math.sin(_),p.z=i*Math.sin(w),l.push(p.x,p.y,p.z),f.x=e*Math.cos(_),f.y=e*Math.sin(_),g.subVectors(p,f).normalize(),h.push(g.x,g.y,g.z),d.push(x/r),d.push(y/n)}for(let y=1;y<=n;y++)for(let x=1;x<=r;x++){const _=(r+1)*y+x-1,w=(r+1)*(y-1)+x-1,O=(r+1)*(y-1)+x,T=(r+1)*y+x;a.push(_,w,T),a.push(w,O,T)}this.setIndex(a),this.setAttribute("position",new Ut(l,3)),this.setAttribute("normal",new Ut(h,3)),this.setAttribute("uv",new Ut(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new VA(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class $A extends $i{constructor(e=1,i=.4,n=64,r=8,o=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:i,tubularSegments:n,radialSegments:r,p:o,q:a},n=Math.floor(n),r=Math.floor(r);const l=[],h=[],d=[],f=[],p=new ie,g=new ie,y=new ie,x=new ie,_=new ie,w=new ie,O=new ie;for(let C=0;C<=n;++C){const A=C/n*o*Math.PI*2;T(A,o,a,e,y),T(A+.01,o,a,e,x),w.subVectors(x,y),O.addVectors(x,y),_.crossVectors(w,O),O.crossVectors(_,w),_.normalize(),O.normalize();for(let B=0;B<=r;++B){const I=B/r*Math.PI*2,R=-i*Math.cos(I),P=i*Math.sin(I);p.x=y.x+(R*O.x+P*_.x),p.y=y.y+(R*O.y+P*_.y),p.z=y.z+(R*O.z+P*_.z),h.push(p.x,p.y,p.z),g.subVectors(p,y).normalize(),d.push(g.x,g.y,g.z),f.push(C/n),f.push(B/r)}}for(let C=1;C<=n;C++)for(let A=1;A<=r;A++){const B=(r+1)*(C-1)+(A-1),I=(r+1)*C+(A-1),R=(r+1)*C+A,P=(r+1)*(C-1)+A;l.push(B,I,P),l.push(I,R,P)}this.setIndex(l),this.setAttribute("position",new Ut(h,3)),this.setAttribute("normal",new Ut(d,3)),this.setAttribute("uv",new Ut(f,2));function T(C,A,B,I,R){const P=Math.cos(C),k=Math.sin(C),E=B/A*C,D=Math.cos(E);R.x=I*(2+D)*.5*P,R.y=I*(2+D)*k*.5,R.z=I*Math.sin(E)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $A(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class UA extends $i{constructor(e=new vL(new ie(-1,-1,0),new ie(-1,1,0),new ie(1,1,0)),i=64,n=1,r=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:n,radialSegments:r,closed:o};const a=e.computeFrenetFrames(i,o);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const l=new ie,h=new ie,d=new Fe;let f=new ie;const p=[],g=[],y=[],x=[];_(),this.setIndex(x),this.setAttribute("position",new Ut(p,3)),this.setAttribute("normal",new Ut(g,3)),this.setAttribute("uv",new Ut(y,2));function _(){for(let C=0;C<i;C++)w(C);w(o===!1?i:0),T(),O()}function w(C){f=e.getPointAt(C/i,f);const A=a.normals[C],B=a.binormals[C];for(let I=0;I<=r;I++){const R=I/r*Math.PI*2,P=Math.sin(R),k=-Math.cos(R);h.x=k*A.x+P*B.x,h.y=k*A.y+P*B.y,h.z=k*A.z+P*B.z,h.normalize(),g.push(h.x,h.y,h.z),l.x=f.x+n*h.x,l.y=f.y+n*h.y,l.z=f.z+n*h.z,p.push(l.x,l.y,l.z)}}function O(){for(let C=1;C<=i;C++)for(let A=1;A<=r;A++){const B=(r+1)*(C-1)+(A-1),I=(r+1)*C+(A-1),R=(r+1)*C+A,P=(r+1)*(C-1)+A;x.push(B,I,P),x.push(I,R,P)}}function T(){for(let C=0;C<=i;C++)for(let A=0;A<=r;A++)d.x=C/i,d.y=A/r,y.push(d.x,d.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new UA(new YC[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class NY extends $i{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const i=[],n=new Set,r=new ie,o=new ie;if(e.index!==null){const a=e.attributes.position,l=e.index;let h=e.groups;h.length===0&&(h=[{start:0,count:l.count,materialIndex:0}]);for(let d=0,f=h.length;d<f;++d){const p=h[d],g=p.start,y=p.count;for(let x=g,_=g+y;x<_;x+=3)for(let w=0;w<3;w++){const O=l.getX(x+w),T=l.getX(x+(w+1)%3);r.fromBufferAttribute(a,O),o.fromBufferAttribute(a,T),$5(r,o,n)===!0&&(i.push(r.x,r.y,r.z),i.push(o.x,o.y,o.z))}}}else{const a=e.attributes.position;for(let l=0,h=a.count/3;l<h;l++)for(let d=0;d<3;d++){const f=3*l+d,p=3*l+(d+1)%3;r.fromBufferAttribute(a,f),o.fromBufferAttribute(a,p),$5(r,o,n)===!0&&(i.push(r.x,r.y,r.z),i.push(o.x,o.y,o.z))}}this.setAttribute("position",new Ut(i,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function $5(s,e,i){const n=`${s.x},${s.y},${s.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${s.x},${s.y},${s.z}`;return i.has(n)===!0||i.has(r)===!0?!1:(i.add(n),i.add(r),!0)}var U5=Object.freeze({__proto__:null,BoxGeometry:xf,CapsuleGeometry:EA,CircleGeometry:MA,ConeGeometry:kA,CylinderGeometry:Ry,DodecahedronGeometry:PA,EdgesGeometry:BY,ExtrudeGeometry:BA,IcosahedronGeometry:RA,LatheGeometry:Eb,OctahedronGeometry:Mb,PlaneGeometry:_f,PolyhedronGeometry:bf,RingGeometry:DA,ShapeGeometry:LA,SphereGeometry:kb,TetrahedronGeometry:NA,TorusGeometry:VA,TorusKnotGeometry:$A,TubeGeometry:UA,WireframeGeometry:NY});class VY extends no{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ft(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class qx extends Ao{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class _L extends no{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ft(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vf,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new To,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $Y extends _L{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Fe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ms(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ft(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ft(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ft(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class UY extends no{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ft(16777215),this.specular=new ft(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vf,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new To,this.combine=bb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class FY extends no{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ft(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vf,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class zY extends no{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vf,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class XY extends no{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vf,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new To,this.combine=bb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class WY extends no{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ft(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vf,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class HY extends Eo{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Vp(s,e,i){return!s||!i&&s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function GY(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function QY(s){function e(r,o){return s[r]-s[o]}const i=s.length,n=new Array(i);for(let r=0;r!==i;++r)n[r]=r;return n.sort(e),n}function IB(s,e,i){const n=s.length,r=new s.constructor(n);for(let o=0,a=0;a!==n;++o){const l=i[o]*e;for(let h=0;h!==e;++h)r[a++]=s[l+h]}return r}function bL(s,e,i,n){let r=1,o=s[0];for(;o!==void 0&&o[n]===void 0;)o=s[r++];if(o===void 0)return;let a=o[n];if(a!==void 0)if(Array.isArray(a))do a=o[n],a!==void 0&&(e.push(o.time),i.push.apply(i,a)),o=s[r++];while(o!==void 0);else if(a.toArray!==void 0)do a=o[n],a!==void 0&&(e.push(o.time),a.toArray(i,i.length)),o=s[r++];while(o!==void 0);else do a=o[n],a!==void 0&&(e.push(o.time),i.push(a)),o=s[r++];while(o!==void 0)}function gPe(s,e,i,n,r=30){const o=s.clone();o.name=e;const a=[];for(let h=0;h<o.tracks.length;++h){const d=o.tracks[h],f=d.getValueSize(),p=[],g=[];for(let y=0;y<d.times.length;++y){const x=d.times[y]*r;if(!(x<i||x>=n)){p.push(d.times[y]);for(let _=0;_<f;++_)g.push(d.values[y*f+_])}}p.length!==0&&(d.times=Vp(p,d.times.constructor),d.values=Vp(g,d.values.constructor),a.push(d))}o.tracks=a;let l=1/0;for(let h=0;h<o.tracks.length;++h)l>o.tracks[h].times[0]&&(l=o.tracks[h].times[0]);for(let h=0;h<o.tracks.length;++h)o.tracks[h].shift(-1*l);return o.resetDuration(),o}function yPe(s,e=0,i=s,n=30){n<=0&&(n=30);const r=i.tracks.length,o=e/n;for(let a=0;a<r;++a){const l=i.tracks[a],h=l.ValueTypeName;if(h==="bool"||h==="string")continue;const d=s.tracks.find(function(O){return O.name===l.name&&O.ValueTypeName===h});if(d===void 0)continue;let f=0;const p=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=p/3);let g=0;const y=d.getValueSize();d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=y/3);const x=l.times.length-1;let _;if(o<=l.times[0]){const O=f,T=p-f;_=l.values.slice(O,T)}else if(o>=l.times[x]){const O=x*p+f,T=O+p-f;_=l.values.slice(O,T)}else{const O=l.createInterpolant(),T=f,C=p-f;O.evaluate(o),_=O.resultBuffer.slice(T,C)}h==="quaternion"&&new Zr().fromArray(_).normalize().conjugate().toArray(_);const w=d.times.length;for(let O=0;O<w;++O){const T=O*y+g;if(h==="quaternion")Zr.multiplyQuaternionsFlat(d.values,T,_,0,d.values,T);else{const C=y-g*2;for(let A=0;A<C;++A)d.values[T+A]-=_[A]}}}return s.blendMode=iL,s}const vPe={convertArray:Vp,isTypedArray:GY,getKeyframeOrder:QY,sortedArray:IB,flattenJSON:bL,subclip:gPe,makeClipAdditive:yPe};class Pb{constructor(e,i,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new i.constructor(n),this.sampleValues=i,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const i=this.parameterPositions;let n=this._cachedIndex,r=i[n],o=i[n-1];e:{t:{let a;i:{n:if(!(e<r)){for(let l=n+2;;){if(r===void 0){if(e<o)break n;return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===l)break;if(o=r,r=i[++n],e<r)break t}a=i.length;break i}if(!(e>=o)){const l=i[1];e<l&&(n=2,o=l);for(let h=n-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===h)break;if(r=o,o=i[--n-1],e>=o)break t}a=n,n=0;break i}break e}for(;n<a;){const l=n+a>>>1;e<i[l]?a=l:n=l+1}if(r=i[n],o=i[n-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const i=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r;for(let a=0;a!==r;++a)i[a]=n[o+a];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class YY extends Pb{constructor(e,i,n,r){super(e,i,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Dp,endingEnd:Dp}}intervalChanged_(e,i,n){const r=this.parameterPositions;let o=e-2,a=e+1,l=r[o],h=r[a];if(l===void 0)switch(this.getSettings_().endingStart){case Lp:o=e,l=2*i-n;break;case w_:o=r.length-2,l=i+r[o]-r[o+1];break;default:o=e,l=n}if(h===void 0)switch(this.getSettings_().endingEnd){case Lp:a=e,h=2*n-i;break;case w_:a=1,h=n+r[1]-r[0];break;default:a=e-1,h=i}const d=(n-i)*.5,f=this.valueSize;this._weightPrev=d/(i-l),this._weightNext=d/(h-n),this._offsetPrev=o*f,this._offsetNext=a*f}interpolate_(e,i,n,r){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,h=e*l,d=h-l,f=this._offsetPrev,p=this._offsetNext,g=this._weightPrev,y=this._weightNext,x=(n-i)/(r-i),_=x*x,w=_*x,O=-g*w+2*g*_-g*x,T=(1+g)*w+(-1.5-2*g)*_+(-.5+g)*x+1,C=(-1-y)*w+(1.5+y)*_+.5*x,A=y*w-y*_;for(let B=0;B!==l;++B)o[B]=O*a[f+B]+T*a[d+B]+C*a[h+B]+A*a[p+B];return o}}class wL extends Pb{constructor(e,i,n,r){super(e,i,n,r)}interpolate_(e,i,n,r){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,h=e*l,d=h-l,f=(n-i)/(r-i),p=1-f;for(let g=0;g!==l;++g)o[g]=a[d+g]*p+a[h+g]*f;return o}}class jY extends Pb{constructor(e,i,n,r){super(e,i,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class hc{constructor(e,i,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Vp(i,this.TimeBufferType),this.values=Vp(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const i=e.constructor;let n;if(i.toJSON!==this.toJSON)n=i.toJSON(e);else{n={name:e.name,times:Vp(e.times,Array),values:Vp(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new jY(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new wL(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new YY(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case ay:i=this.InterpolantFactoryMethodDiscrete;break;case ly:i=this.InterpolantFactoryMethodLinear;break;case HS:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ay;case this.InterpolantFactoryMethodLinear:return ly;case this.InterpolantFactoryMethodSmooth:return HS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const i=this.times;for(let n=0,r=i.length;n!==r;++n)i[n]+=e}return this}scale(e){if(e!==1){const i=this.times;for(let n=0,r=i.length;n!==r;++n)i[n]*=e}return this}trim(e,i){const n=this.times,r=n.length;let o=0,a=r-1;for(;o!==r&&n[o]<e;)++o;for(;a!==-1&&n[a]>i;)--a;if(++a,o!==0||a!==r){o>=a&&(a=Math.max(a,1),o=a-1);const l=this.getValueSize();this.times=n.slice(o,a),this.values=this.values.slice(o*l,a*l)}return this}validate(){let e=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,o=n.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let l=0;l!==o;l++){const h=n[l];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,h),e=!1;break}if(a!==null&&a>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,h,a),e=!1;break}a=h}if(r!==void 0&&GY(r))for(let l=0,h=r.length;l!==h;++l){const d=r[l];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,d),e=!1;break}}return e}optimize(){const e=this.times.slice(),i=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===HS,o=e.length-1;let a=1;for(let l=1;l<o;++l){let h=!1;const d=e[l],f=e[l+1];if(d!==f&&(l!==1||d!==e[0]))if(r)h=!0;else{const p=l*n,g=p-n,y=p+n;for(let x=0;x!==n;++x){const _=i[p+x];if(_!==i[g+x]||_!==i[y+x]){h=!0;break}}}if(h){if(l!==a){e[a]=e[l];const p=l*n,g=a*n;for(let y=0;y!==n;++y)i[g+y]=i[p+y]}++a}}if(o>0){e[a]=e[o];for(let l=o*n,h=a*n,d=0;d!==n;++d)i[h+d]=i[l+d];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=i.slice(0,a*n)):(this.times=e,this.values=i),this}clone(){const e=this.times.slice(),i=this.values.slice(),n=this.constructor,r=new n(this.name,e,i);return r.createInterpolant=this.createInterpolant,r}}hc.prototype.TimeBufferType=Float32Array;hc.prototype.ValueBufferType=Float32Array;hc.prototype.DefaultInterpolation=ly;class Pm extends hc{}Pm.prototype.ValueTypeName="bool";Pm.prototype.ValueBufferType=Array;Pm.prototype.DefaultInterpolation=ay;Pm.prototype.InterpolantFactoryMethodLinear=void 0;Pm.prototype.InterpolantFactoryMethodSmooth=void 0;class OL extends hc{}OL.prototype.ValueTypeName="color";class B_ extends hc{}B_.prototype.ValueTypeName="number";class qY extends Pb{constructor(e,i,n,r){super(e,i,n,r)}interpolate_(e,i,n,r){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,h=(n-i)/(r-i);let d=e*l;for(let f=d+l;d!==f;d+=4)Zr.slerpFlat(o,0,a,d-l,a,d,h);return o}}class Dy extends hc{InterpolantFactoryMethodLinear(e){return new qY(this.times,this.values,this.getValueSize(),e)}}Dy.prototype.ValueTypeName="quaternion";Dy.prototype.DefaultInterpolation=ly;Dy.prototype.InterpolantFactoryMethodSmooth=void 0;class Im extends hc{}Im.prototype.ValueTypeName="string";Im.prototype.ValueBufferType=Array;Im.prototype.DefaultInterpolation=ay;Im.prototype.InterpolantFactoryMethodLinear=void 0;Im.prototype.InterpolantFactoryMethodSmooth=void 0;class R_ extends hc{}R_.prototype.ValueTypeName="vector";class D_{constructor(e="",i=-1,n=[],r=vA){this.name=e,this.tracks=n,this.duration=i,this.blendMode=r,this.uuid=La(),this.duration<0&&this.resetDuration()}static parse(e){const i=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,l=n.length;a!==l;++a)i.push(_Pe(n[a]).scale(r));const o=new this(e.name,e.duration,i,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const i=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,a=n.length;o!==a;++o)i.push(hc.toJSON(n[o]));return r}static CreateFromMorphTargetSequence(e,i,n,r){const o=i.length,a=[];for(let l=0;l<o;l++){let h=[],d=[];h.push((l+o-1)%o,l,(l+1)%o),d.push(0,1,0);const f=QY(h);h=IB(h,1,f),d=IB(d,1,f),!r&&h[0]===0&&(h.push(o),d.push(d[0])),a.push(new B_(".morphTargetInfluences["+i[l].name+"]",h,d).scale(1/n))}return new this(e,-1,a)}static findByName(e,i){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===i)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,i,n){const r={},o=/^([\w-]*?)([\d]+)$/;for(let l=0,h=e.length;l<h;l++){const d=e[l],f=d.name.match(o);if(f&&f.length>1){const p=f[1];let g=r[p];g||(r[p]=g=[]),g.push(d)}}const a=[];for(const l in r)a.push(this.CreateFromMorphTargetSequence(l,r[l],i,n));return a}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(p,g,y,x,_){if(y.length!==0){const w=[],O=[];bL(y,w,O,x),w.length!==0&&_.push(new p(g,w,O))}},r=[],o=e.name||"default",a=e.fps||30,l=e.blendMode;let h=e.length||-1;const d=e.hierarchy||[];for(let p=0;p<d.length;p++){const g=d[p].keys;if(!(!g||g.length===0))if(g[0].morphTargets){const y={};let x;for(x=0;x<g.length;x++)if(g[x].morphTargets)for(let _=0;_<g[x].morphTargets.length;_++)y[g[x].morphTargets[_]]=-1;for(const _ in y){const w=[],O=[];for(let T=0;T!==g[x].morphTargets.length;++T){const C=g[x];w.push(C.time),O.push(C.morphTarget===_?1:0)}r.push(new B_(".morphTargetInfluence["+_+"]",w,O))}h=y.length*a}else{const y=".bones["+i[p].name+"]";n(R_,y+".position",g,"pos",r),n(Dy,y+".quaternion",g,"rot",r),n(R_,y+".scale",g,"scl",r)}}return r.length===0?null:new this(o,h,r,l)}resetDuration(){const e=this.tracks;let i=0;for(let n=0,r=e.length;n!==r;++n){const o=this.tracks[n];i=Math.max(i,o.times[o.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function xPe(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return B_;case"vector":case"vector2":case"vector3":case"vector4":return R_;case"color":return OL;case"quaternion":return Dy;case"bool":case"boolean":return Pm;case"string":return Im}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function _Pe(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=xPe(s.type);if(s.times===void 0){const i=[],n=[];bL(s.keys,i,n,"value"),s.times=i,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const Jh={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class SL{constructor(e,i,n){const r=this;let o=!1,a=0,l=0,h;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=n,this.itemStart=function(f){l++,o===!1&&r.onStart!==void 0&&r.onStart(f,a,l),o=!0},this.itemEnd=function(f){a++,r.onProgress!==void 0&&r.onProgress(f,a,l),a===l&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(f){r.onError!==void 0&&r.onError(f)},this.resolveURL=function(f){return h?h(f):f},this.setURLModifier=function(f){return h=f,this},this.addHandler=function(f,p){return d.push(f,p),this},this.removeHandler=function(f){const p=d.indexOf(f);return p!==-1&&d.splice(p,2),this},this.getHandler=function(f){for(let p=0,g=d.length;p<g;p+=2){const y=d[p],x=d[p+1];if(y.global&&(y.lastIndex=0),y.test(f))return x}return null}}}const ZY=new SL;class oa{constructor(e){this.manager=e!==void 0?e:ZY,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const n=this;return new Promise(function(r,o){n.load(e,r,i,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}oa.DEFAULT_MATERIAL_NAME="__DEFAULT";const Ph={};class bPe extends Error{constructor(e,i){super(e),this.response=i}}class _u extends oa{constructor(e){super(e)}load(e,i,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=Jh.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{i&&i(o),this.manager.itemEnd(e)},0),o;if(Ph[e]!==void 0){Ph[e].push({onLoad:i,onProgress:n,onError:r});return}Ph[e]=[],Ph[e].push({onLoad:i,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,h=this.responseType;fetch(a).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;const f=Ph[e],p=d.body.getReader(),g=d.headers.get("X-File-Size")||d.headers.get("Content-Length"),y=g?parseInt(g):0,x=y!==0;let _=0;const w=new ReadableStream({start(O){T();function T(){p.read().then(({done:C,value:A})=>{if(C)O.close();else{_+=A.byteLength;const B=new ProgressEvent("progress",{lengthComputable:x,loaded:_,total:y});for(let I=0,R=f.length;I<R;I++){const P=f[I];P.onProgress&&P.onProgress(B)}O.enqueue(A),T()}})}}});return new Response(w)}else throw new bPe(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(h){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(f=>new DOMParser().parseFromString(f,l));case"json":return d.json();default:if(l===void 0)return d.text();{const p=/charset="?([^;"\s]*)"?/i.exec(l),g=p&&p[1]?p[1].toLowerCase():void 0,y=new TextDecoder(g);return d.arrayBuffer().then(x=>y.decode(x))}}}).then(d=>{Jh.add(e,d);const f=Ph[e];delete Ph[e];for(let p=0,g=f.length;p<g;p++){const y=f[p];y.onLoad&&y.onLoad(d)}}).catch(d=>{const f=Ph[e];if(f===void 0)throw this.manager.itemError(e),d;delete Ph[e];for(let p=0,g=f.length;p<g;p++){const y=f[p];y.onError&&y.onError(d)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class wPe extends oa{constructor(e){super(e)}load(e,i,n,r){const o=this,a=new _u(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{i(o.parse(JSON.parse(l)))}catch(h){r?r(h):console.error(h),o.manager.itemError(e)}},n,r)}parse(e){const i=[];for(let n=0;n<e.length;n++){const r=D_.parse(e[n]);i.push(r)}return i}}class OPe extends oa{constructor(e){super(e)}load(e,i,n,r){const o=this,a=[],l=new Jp,h=new _u(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(o.withCredentials);let d=0;function f(p){h.load(e[p],function(g){const y=o.parse(g,!0);a[p]={width:y.width,height:y.height,format:y.format,mipmaps:y.mipmaps},d+=1,d===6&&(y.mipmapCount===1&&(l.minFilter=Bs),l.image=a,l.format=y.format,l.needsUpdate=!0,i&&i(l))},n,r)}if(Array.isArray(e))for(let p=0,g=e.length;p<g;++p)f(p);else h.load(e,function(p){const g=o.parse(p,!0);if(g.isCubemap){const y=g.mipmaps.length/g.mipmapCount;for(let x=0;x<y;x++){a[x]={mipmaps:[]};for(let _=0;_<g.mipmapCount;_++)a[x].mipmaps.push(g.mipmaps[x*g.mipmapCount+_]),a[x].format=g.format,a[x].width=g.width,a[x].height=g.height}l.image=a}else l.image.width=g.width,l.image.height=g.height,l.mipmaps=g.mipmaps;g.mipmapCount===1&&(l.minFilter=Bs),l.format=g.format,l.needsUpdate=!0,i&&i(l)},n,r);return l}}class L_ extends oa{constructor(e){super(e)}load(e,i,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=Jh.get(e);if(a!==void 0)return o.manager.itemStart(e),setTimeout(function(){i&&i(a),o.manager.itemEnd(e)},0),a;const l=E_("img");function h(){f(),Jh.add(e,this),i&&i(this),o.manager.itemEnd(e)}function d(p){f(),r&&r(p),o.manager.itemError(e),o.manager.itemEnd(e)}function f(){l.removeEventListener("load",h,!1),l.removeEventListener("error",d,!1)}return l.addEventListener("load",h,!1),l.addEventListener("error",d,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}}class SPe extends oa{constructor(e){super(e)}load(e,i,n,r){const o=new Cb;o.colorSpace=Ta;const a=new L_(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let l=0;function h(d){a.load(e[d],function(f){o.images[d]=f,l++,l===6&&(o.needsUpdate=!0,i&&i(o))},void 0,r)}for(let d=0;d<e.length;++d)h(d);return o}}class CPe extends oa{constructor(e){super(e)}load(e,i,n,r){const o=this,a=new Yd,l=new _u(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(o.withCredentials),l.load(e,function(h){let d;try{d=o.parse(h)}catch(f){if(r!==void 0)r(f);else{console.error(f);return}}d.image!==void 0?a.image=d.image:d.data!==void 0&&(a.image.width=d.width,a.image.height=d.height,a.image.data=d.data),a.wrapS=d.wrapS!==void 0?d.wrapS:Pa,a.wrapT=d.wrapT!==void 0?d.wrapT:Pa,a.magFilter=d.magFilter!==void 0?d.magFilter:Bs,a.minFilter=d.minFilter!==void 0?d.minFilter:Bs,a.anisotropy=d.anisotropy!==void 0?d.anisotropy:1,d.colorSpace!==void 0&&(a.colorSpace=d.colorSpace),d.flipY!==void 0&&(a.flipY=d.flipY),d.format!==void 0&&(a.format=d.format),d.type!==void 0&&(a.type=d.type),d.mipmaps!==void 0&&(a.mipmaps=d.mipmaps,a.minFilter=Gl),d.mipmapCount===1&&(a.minFilter=Bs),d.generateMipmaps!==void 0&&(a.generateMipmaps=d.generateMipmaps),a.needsUpdate=!0,i&&i(a,d)},n,r),a}}class CL extends oa{constructor(e){super(e)}load(e,i,n,r){const o=new cs,a=new L_(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(l){o.image=l,o.needsUpdate=!0,i!==void 0&&i(o)},n,r),o}}class wf extends vn{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new ft(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}class KY extends wf{constructor(e,i,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(vn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ft(i)}copy(e,i){return super.copy(e,i),this.groundColor.copy(e.groundColor),this}}const yP=new ri,F5=new ie,z5=new ie;class TL{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Fe(512,512),this.map=null,this.mapPass=null,this.matrix=new ri,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Tb,this._frameExtents=new Fe(1,1),this._viewportCount=1,this._viewports=[new sn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,n=this.matrix;F5.setFromMatrixPosition(e.matrixWorld),i.position.copy(F5),z5.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(z5),i.updateMatrixWorld(),yP.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(yP),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(yP)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class TPe extends TL{constructor(){super(new Rn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const i=this.camera,n=cy*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=e.distance||i.far;(n!==i.fov||r!==i.aspect||o!==i.far)&&(i.fov=n,i.aspect=r,i.far=o,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class JY extends wf{constructor(e,i,n=0,r=Math.PI/3,o=0,a=2){super(e,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(vn.DEFAULT_UP),this.updateMatrix(),this.target=new vn,this.distance=n,this.angle=r,this.penumbra=o,this.decay=a,this.map=null,this.shadow=new TPe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const X5=new ri,Hv=new ie,vP=new ie;class APe extends TL{constructor(){super(new Rn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Fe(4,2),this._viewportCount=6,this._viewports=[new sn(2,1,1,1),new sn(0,1,1,1),new sn(3,1,1,1),new sn(1,1,1,1),new sn(3,0,1,1),new sn(1,0,1,1)],this._cubeDirections=[new ie(1,0,0),new ie(-1,0,0),new ie(0,0,1),new ie(0,0,-1),new ie(0,1,0),new ie(0,-1,0)],this._cubeUps=[new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,0,1),new ie(0,0,-1)]}updateMatrices(e,i=0){const n=this.camera,r=this.matrix,o=e.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),Hv.setFromMatrixPosition(e.matrixWorld),n.position.copy(Hv),vP.copy(n.position),vP.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(vP),n.updateMatrixWorld(),r.makeTranslation(-Hv.x,-Hv.y,-Hv.z),X5.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(X5)}}class ej extends wf{constructor(e,i,n=0,r=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new APe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class EPe extends TL{constructor(){super(new Ql(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class tj extends wf{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(vn.DEFAULT_UP),this.updateMatrix(),this.target=new vn,this.shadow=new EPe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class ij extends wf{constructor(e,i){super(e,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class nj extends wf{constructor(e,i,n=10,r=10){super(e,i),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const i=super.toJSON(e);return i.object.width=this.width,i.object.height=this.height,i}}class sj{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ie)}set(e){for(let i=0;i<9;i++)this.coefficients[i].copy(e[i]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,i){const n=e.x,r=e.y,o=e.z,a=this.coefficients;return i.copy(a[0]).multiplyScalar(.282095),i.addScaledVector(a[1],.488603*r),i.addScaledVector(a[2],.488603*o),i.addScaledVector(a[3],.488603*n),i.addScaledVector(a[4],1.092548*(n*r)),i.addScaledVector(a[5],1.092548*(r*o)),i.addScaledVector(a[6],.315392*(3*o*o-1)),i.addScaledVector(a[7],1.092548*(n*o)),i.addScaledVector(a[8],.546274*(n*n-r*r)),i}getIrradianceAt(e,i){const n=e.x,r=e.y,o=e.z,a=this.coefficients;return i.copy(a[0]).multiplyScalar(.886227),i.addScaledVector(a[1],2*.511664*r),i.addScaledVector(a[2],2*.511664*o),i.addScaledVector(a[3],2*.511664*n),i.addScaledVector(a[4],2*.429043*n*r),i.addScaledVector(a[5],2*.429043*r*o),i.addScaledVector(a[6],.743125*o*o-.247708),i.addScaledVector(a[7],2*.429043*n*o),i.addScaledVector(a[8],.429043*(n*n-r*r)),i}add(e){for(let i=0;i<9;i++)this.coefficients[i].add(e.coefficients[i]);return this}addScaledSH(e,i){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],i);return this}scale(e){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(e);return this}lerp(e,i){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],i);return this}equals(e){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(e.coefficients[i]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,i=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,i+r*3);return this}toArray(e=[],i=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,i+r*3);return e}static getBasisAt(e,i){const n=e.x,r=e.y,o=e.z;i[0]=.282095,i[1]=.488603*r,i[2]=.488603*o,i[3]=.488603*n,i[4]=1.092548*n*r,i[5]=1.092548*r*o,i[6]=.315392*(3*o*o-1),i[7]=1.092548*n*o,i[8]=.546274*(n*n-r*r)}}class rj extends wf{constructor(e=new sj,i=1){super(void 0,i),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const i=super.toJSON(e);return i.object.sh=this.sh.toArray(),i}}class FA extends oa{constructor(e){super(e),this.textures={}}load(e,i,n,r){const o=this,a=new _u(o.manager);a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(e,function(l){try{i(o.parse(JSON.parse(l)))}catch(h){r?r(h):console.error(h),o.manager.itemError(e)}},n,r)}parse(e){const i=this.textures;function n(o){return i[o]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",o),i[o]}const r=FA.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new ft().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const o in e.uniforms){const a=e.uniforms[o];switch(r.uniforms[o]={},a.type){case"t":r.uniforms[o].value=n(a.value);break;case"c":r.uniforms[o].value=new ft().setHex(a.value);break;case"v2":r.uniforms[o].value=new Fe().fromArray(a.value);break;case"v3":r.uniforms[o].value=new ie().fromArray(a.value);break;case"v4":r.uniforms[o].value=new sn().fromArray(a.value);break;case"m3":r.uniforms[o].value=new Ni().fromArray(a.value);break;case"m4":r.uniforms[o].value=new ri().fromArray(a.value);break;default:r.uniforms[o].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const o in e.extensions)r.extensions[o]=e.extensions[o];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),r.normalScale=new Fe().fromArray(o)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Fe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const i={ShadowMaterial:VY,SpriteMaterial:dL,RawShaderMaterial:qx,ShaderMaterial:Ao,PointsMaterial:pL,MeshPhysicalMaterial:$Y,MeshStandardMaterial:_L,MeshPhongMaterial:UY,MeshToonMaterial:FY,MeshNormalMaterial:zY,MeshLambertMaterial:XY,MeshDepthMaterial:hL,MeshDistanceMaterial:uL,MeshBasicMaterial:lc,MeshMatcapMaterial:WY,LineDashedMaterial:HY,LineBasicMaterial:Eo,Material:no};return new i[e]}}class BB{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let i="";for(let n=0,r=e.length;n<r;n++)i+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){const i=e.lastIndexOf("/");return i===-1?"./":e.slice(0,i+1)}static resolveURL(e,i){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}}class oj extends $i{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class aj extends oa{constructor(e){super(e)}load(e,i,n,r){const o=this,a=new _u(o.manager);a.setPath(o.path),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(e,function(l){try{i(o.parse(JSON.parse(l)))}catch(h){r?r(h):console.error(h),o.manager.itemError(e)}},n,r)}parse(e){const i={},n={};function r(y,x){if(i[x]!==void 0)return i[x];const w=y.interleavedBuffers[x],O=o(y,w.buffer),T=u0(w.type,O),C=new Ab(T,w.stride);return C.uuid=w.uuid,i[x]=C,C}function o(y,x){if(n[x]!==void 0)return n[x];const w=y.arrayBuffers[x],O=new Uint32Array(w).buffer;return n[x]=O,O}const a=e.isInstancedBufferGeometry?new oj:new $i,l=e.data.index;if(l!==void 0){const y=u0(l.type,l.array);a.setIndex(new rn(y,1))}const h=e.data.attributes;for(const y in h){const x=h[y];let _;if(x.isInterleavedBufferAttribute){const w=r(e.data,x.data);_=new xu(w,x.itemSize,x.offset,x.normalized)}else{const w=u0(x.type,x.array),O=x.isInstancedBufferAttribute?fy:rn;_=new O(w,x.itemSize,x.normalized)}x.name!==void 0&&(_.name=x.name),x.usage!==void 0&&_.setUsage(x.usage),a.setAttribute(y,_)}const d=e.data.morphAttributes;if(d)for(const y in d){const x=d[y],_=[];for(let w=0,O=x.length;w<O;w++){const T=x[w];let C;if(T.isInterleavedBufferAttribute){const A=r(e.data,T.data);C=new xu(A,T.itemSize,T.offset,T.normalized)}else{const A=u0(T.type,T.array);C=new rn(A,T.itemSize,T.normalized)}T.name!==void 0&&(C.name=T.name),_.push(C)}a.morphAttributes[y]=_}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==void 0)for(let y=0,x=p.length;y!==x;++y){const _=p[y];a.addGroup(_.start,_.count,_.materialIndex)}const g=e.data.boundingSphere;if(g!==void 0){const y=new ie;g.center!==void 0&&y.fromArray(g.center),a.boundingSphere=new Vr(y,g.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class MPe extends oa{constructor(e){super(e)}load(e,i,n,r){const o=this,a=this.path===""?BB.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const l=new _u(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(h){let d=null;try{d=JSON.parse(h)}catch(p){r!==void 0&&r(p),console.error("THREE:ObjectLoader: Can't parse "+e+".",p.message);return}const f=d.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}o.parse(d,i)},n,r)}async loadAsync(e,i){const n=this,r=this.path===""?BB.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const o=new _u(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);const a=await o.loadAsync(e,i),l=JSON.parse(a),h=l.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(l)}parse(e,i){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){i!==void 0&&i(d)}),l=this.parseTextures(e.textures,a),h=this.parseMaterials(e.materials,l),d=this.parseObject(e.object,o,h,l,n),f=this.parseSkeletons(e.skeletons,d);if(this.bindSkeletons(d,f),i!==void 0){let p=!1;for(const g in a)if(a[g].data instanceof HTMLImageElement){p=!0;break}p===!1&&i(d)}return d}async parseAsync(e){const i=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),o=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),h=this.parseObject(e.object,r,l,a,i),d=this.parseSkeletons(e.skeletons,h);return this.bindSkeletons(h,d),h}parseShapes(e){const i={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const o=new em().fromJSON(e[n]);i[o.uuid]=o}return i}parseSkeletons(e,i){const n={},r={};if(i.traverse(function(o){o.isBone&&(r[o.uuid]=o)}),e!==void 0)for(let o=0,a=e.length;o<a;o++){const l=new CA().fromJSON(e[o],r);n[l.uuid]=l}return n}parseGeometries(e,i){const n={};if(e!==void 0){const r=new aj;for(let o=0,a=e.length;o<a;o++){let l;const h=e[o];switch(h.type){case"BufferGeometry":case"InstancedBufferGeometry":l=r.parse(h);break;default:h.type in U5?l=U5[h.type].fromJSON(h,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${h.type}"`)}l.uuid=h.uuid,h.name!==void 0&&(l.name=h.name),h.userData!==void 0&&(l.userData=h.userData),n[h.uuid]=l}}return n}parseMaterials(e,i){const n={},r={};if(e!==void 0){const o=new FA;o.setTextures(i);for(let a=0,l=e.length;a<l;a++){const h=e[a];n[h.uuid]===void 0&&(n[h.uuid]=o.parse(h)),r[h.uuid]=n[h.uuid]}}return r}parseAnimations(e){const i={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],o=D_.parse(r);i[o.uuid]=o}return i}parseImages(e,i){const n=this,r={};let o;function a(h){return n.manager.itemStart(h),o.load(h,function(){n.manager.itemEnd(h)},void 0,function(){n.manager.itemError(h),n.manager.itemEnd(h)})}function l(h){if(typeof h=="string"){const d=h,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;return a(f)}else return h.data?{data:u0(h.type,h.data),width:h.width,height:h.height}:null}if(e!==void 0&&e.length>0){const h=new SL(i);o=new L_(h),o.setCrossOrigin(this.crossOrigin);for(let d=0,f=e.length;d<f;d++){const p=e[d],g=p.url;if(Array.isArray(g)){const y=[];for(let x=0,_=g.length;x<_;x++){const w=g[x],O=l(w);O!==null&&(O instanceof HTMLImageElement?y.push(O):y.push(new Yd(O.data,O.width,O.height)))}r[p.uuid]=new Np(y)}else{const y=l(p.url);r[p.uuid]=new Np(y)}}}return r}async parseImagesAsync(e){const i=this,n={};let r;async function o(a){if(typeof a=="string"){const l=a,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:i.resourcePath+l;return await r.loadAsync(h)}else return a.data?{data:u0(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new L_(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,l=e.length;a<l;a++){const h=e[a],d=h.url;if(Array.isArray(d)){const f=[];for(let p=0,g=d.length;p<g;p++){const y=d[p],x=await o(y);x!==null&&(x instanceof HTMLImageElement?f.push(x):f.push(new Yd(x.data,x.width,x.height)))}n[h.uuid]=new Np(f)}else{const f=await o(h.url);n[h.uuid]=new Np(f)}}}return n}parseTextures(e,i){function n(o,a){return typeof o=="number"?o:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",o),a[o])}const r={};if(e!==void 0)for(let o=0,a=e.length;o<a;o++){const l=e[o];l.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),i[l.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",l.image);const h=i[l.image],d=h.data;let f;Array.isArray(d)?(f=new Cb,d.length===6&&(f.needsUpdate=!0)):(d&&d.data?f=new Yd:f=new cs,d&&(f.needsUpdate=!0)),f.source=h,f.uuid=l.uuid,l.name!==void 0&&(f.name=l.name),l.mapping!==void 0&&(f.mapping=n(l.mapping,kPe)),l.channel!==void 0&&(f.channel=l.channel),l.offset!==void 0&&f.offset.fromArray(l.offset),l.repeat!==void 0&&f.repeat.fromArray(l.repeat),l.center!==void 0&&f.center.fromArray(l.center),l.rotation!==void 0&&(f.rotation=l.rotation),l.wrap!==void 0&&(f.wrapS=n(l.wrap[0],W5),f.wrapT=n(l.wrap[1],W5)),l.format!==void 0&&(f.format=l.format),l.internalFormat!==void 0&&(f.internalFormat=l.internalFormat),l.type!==void 0&&(f.type=l.type),l.colorSpace!==void 0&&(f.colorSpace=l.colorSpace),l.minFilter!==void 0&&(f.minFilter=n(l.minFilter,H5)),l.magFilter!==void 0&&(f.magFilter=n(l.magFilter,H5)),l.anisotropy!==void 0&&(f.anisotropy=l.anisotropy),l.flipY!==void 0&&(f.flipY=l.flipY),l.generateMipmaps!==void 0&&(f.generateMipmaps=l.generateMipmaps),l.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(f.unpackAlignment=l.unpackAlignment),l.compareFunction!==void 0&&(f.compareFunction=l.compareFunction),l.userData!==void 0&&(f.userData=l.userData),r[l.uuid]=f}return r}parseObject(e,i,n,r,o){let a;function l(g){return i[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",g),i[g]}function h(g){if(g!==void 0){if(Array.isArray(g)){const y=[];for(let x=0,_=g.length;x<_;x++){const w=g[x];n[w]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",w),y.push(n[w])}return y}return n[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),n[g]}}function d(g){return r[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",g),r[g]}let f,p;switch(e.type){case"Scene":a=new dy,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new ft(e.background):a.background=d(e.background)),e.environment!==void 0&&(a.environment=d(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new SA(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new OA(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Rn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Ql(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new ij(e.color,e.intensity);break;case"DirectionalLight":a=new tj(e.color,e.intensity);break;case"PointLight":a=new ej(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new nj(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new JY(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new KY(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new rj().fromJSON(e);break;case"SkinnedMesh":f=l(e.geometry),p=h(e.material),a=new OY(f,p),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":f=l(e.geometry),p=h(e.material),a=new Dn(f,p);break;case"InstancedMesh":f=l(e.geometry),p=h(e.material);const g=e.count,y=e.instanceMatrix,x=e.instanceColor;a=new SY(f,p,g),a.instanceMatrix=new fy(new Float32Array(y.array),16),x!==void 0&&(a.instanceColor=new fy(new Float32Array(x.array),x.itemSize));break;case"BatchedMesh":f=l(e.geometry),p=h(e.material),a=new CY(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,p),a.geometry=f,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._visibility=e.visibility,a._active=e.active,a._bounds=e.bounds.map(_=>{const w=new Nr;w.min.fromArray(_.boxMin),w.max.fromArray(_.boxMax);const O=new Vr;return O.radius=_.sphereRadius,O.center.fromArray(_.sphereCenter),{boxInitialized:_.boxInitialized,box:w,sphereInitialized:_.sphereInitialized,sphere:O}}),a._maxGeometryCount=e.maxGeometryCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._geometryCount=e.geometryCount,a._matricesTexture=d(e.matricesTexture.uuid);break;case"LOD":a=new wY;break;case"Line":a=new nf(l(e.geometry),h(e.material));break;case"LineLoop":a=new TY(l(e.geometry),h(e.material));break;case"LineSegments":a=new hh(l(e.geometry),h(e.material));break;case"PointCloud":case"Points":a=new AY(l(e.geometry),h(e.material));break;case"Sprite":a=new bY(h(e.material));break;case"Group":a=new f0;break;case"Bone":a=new fL;break;default:a=new vn}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const g=e.children;for(let y=0;y<g.length;y++)a.add(this.parseObject(g[y],i,n,r,o))}if(e.animations!==void 0){const g=e.animations;for(let y=0;y<g.length;y++){const x=g[y];a.animations.push(o[x])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const g=e.levels;for(let y=0;y<g.length;y++){const x=g[y],_=a.getObjectByProperty("uuid",x.object);_!==void 0&&a.addLevel(_,x.distance,x.hysteresis)}}return a}bindSkeletons(e,i){Object.keys(i).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=i[n.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}}const kPe={UVMapping:gA,CubeReflectionMapping:vu,CubeRefractionMapping:tf,EquirectangularReflectionMapping:__,EquirectangularRefractionMapping:b_,CubeUVReflectionMapping:ky},W5={RepeatWrapping:sy,ClampToEdgeWrapping:Pa,MirroredRepeatWrapping:ry},H5={NearestFilter:ar,NearestMipmapNearestFilter:yA,NearestMipmapLinearFilter:Rp,LinearFilter:Bs,LinearMipmapNearestFilter:$0,LinearMipmapLinearFilter:Gl};class PPe extends oa{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,i,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=Jh.get(e);if(a!==void 0){if(o.manager.itemStart(e),a.then){a.then(d=>{i&&i(d),o.manager.itemEnd(e)}).catch(d=>{r&&r(d)});return}return setTimeout(function(){i&&i(a),o.manager.itemEnd(e)},0),a}const l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader;const h=fetch(e,l).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(d){return Jh.add(e,d),i&&i(d),o.manager.itemEnd(e),d}).catch(function(d){r&&r(d),Jh.remove(e),o.manager.itemError(e),o.manager.itemEnd(e)});Jh.add(e,h),o.manager.itemStart(e)}}let cO;class AL{static getContext(){return cO===void 0&&(cO=new(window.AudioContext||window.webkitAudioContext)),cO}static setContext(e){cO=e}}class IPe extends oa{constructor(e){super(e)}load(e,i,n,r){const o=this,a=new _u(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(h){try{const d=h.slice(0);AL.getContext().decodeAudioData(d,function(p){i(p)}).catch(l)}catch(d){l(d)}},n,r);function l(h){r?r(h):console.error(h),o.manager.itemError(e)}}}const G5=new ri,Q5=new ri,Zf=new ri;class BPe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Rn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Rn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const i=this._cache;if(i.focus!==e.focus||i.fov!==e.fov||i.aspect!==e.aspect*this.aspect||i.near!==e.near||i.far!==e.far||i.zoom!==e.zoom||i.eyeSep!==this.eyeSep){i.focus=e.focus,i.fov=e.fov,i.aspect=e.aspect*this.aspect,i.near=e.near,i.far=e.far,i.zoom=e.zoom,i.eyeSep=this.eyeSep,Zf.copy(e.projectionMatrix);const r=i.eyeSep/2,o=r*i.near/i.focus,a=i.near*Math.tan(Kp*i.fov*.5)/i.zoom;let l,h;Q5.elements[12]=-r,G5.elements[12]=r,l=-a*i.aspect+o,h=a*i.aspect+o,Zf.elements[0]=2*i.near/(h-l),Zf.elements[8]=(h+l)/(h-l),this.cameraL.projectionMatrix.copy(Zf),l=-a*i.aspect-o,h=a*i.aspect-o,Zf.elements[0]=2*i.near/(h-l),Zf.elements[8]=(h+l)/(h-l),this.cameraR.projectionMatrix.copy(Zf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Q5),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(G5)}}class EL{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Y5(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=Y5();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}}function Y5(){return(typeof performance>"u"?Date:performance).now()}const Kf=new ie,j5=new Zr,RPe=new ie,Jf=new ie;class DPe extends vn{constructor(){super(),this.type="AudioListener",this.context=AL.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new EL}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const i=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Kf,j5,RPe),Jf.set(0,0,-1).applyQuaternion(j5),i.positionX){const r=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(Kf.x,r),i.positionY.linearRampToValueAtTime(Kf.y,r),i.positionZ.linearRampToValueAtTime(Kf.z,r),i.forwardX.linearRampToValueAtTime(Jf.x,r),i.forwardY.linearRampToValueAtTime(Jf.y,r),i.forwardZ.linearRampToValueAtTime(Jf.z,r),i.upX.linearRampToValueAtTime(n.x,r),i.upY.linearRampToValueAtTime(n.y,r),i.upZ.linearRampToValueAtTime(n.z,r)}else i.setPosition(Kf.x,Kf.y,Kf.z),i.setOrientation(Jf.x,Jf.y,Jf.z,n.x,n.y,n.z)}}class lj extends vn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const ep=new ie,q5=new Zr,LPe=new ie,tp=new ie;class NPe extends lj{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,i,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(ep,q5,LPe),tp.set(0,0,1).applyQuaternion(q5);const i=this.panner;if(i.positionX){const n=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(ep.x,n),i.positionY.linearRampToValueAtTime(ep.y,n),i.positionZ.linearRampToValueAtTime(ep.z,n),i.orientationX.linearRampToValueAtTime(tp.x,n),i.orientationY.linearRampToValueAtTime(tp.y,n),i.orientationZ.linearRampToValueAtTime(tp.z,n)}else i.setPosition(ep.x,ep.y,ep.z),i.setOrientation(tp.x,tp.y,tp.z)}}class VPe{constructor(e,i=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const i=this.getFrequencyData();for(let n=0;n<i.length;n++)e+=i[n];return e/i.length}}class cj{constructor(e,i,n){this.binding=e,this.valueSize=n;let r,o,a;switch(i){case"quaternion":r=this._slerp,o=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,o=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,i){const n=this.buffer,r=this.valueSize,o=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let l=0;l!==r;++l)n[o+l]=n[l];a=i}else{a+=i;const l=i/a;this._mixBufferRegion(n,o,0,l,r)}this.cumulativeWeight=a}accumulateAdditive(e){const i=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const i=this.valueSize,n=this.buffer,r=e*i+i,o=this.cumulativeWeight,a=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const h=i*this._origIndex;this._mixBufferRegion(n,r,h,1-o,i)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*i,1,i);for(let h=i,d=i+i;h!==d;++h)if(n[h]!==n[h+i]){l.setValue(n,r);break}}saveOriginalState(){const e=this.binding,i=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(i,r);for(let o=n,a=r;o!==a;++o)i[o]=i[r+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,i=e+this.valueSize;for(let n=e;n<i;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[i+n]=this.buffer[e+n]}_select(e,i,n,r,o){if(r>=.5)for(let a=0;a!==o;++a)e[i+a]=e[n+a]}_slerp(e,i,n,r){Zr.slerpFlat(e,i,e,i,e,n,r)}_slerpAdditive(e,i,n,r,o){const a=this._workIndex*o;Zr.multiplyQuaternionsFlat(e,a,e,i,e,n),Zr.slerpFlat(e,i,e,i,e,a,r)}_lerp(e,i,n,r,o){const a=1-r;for(let l=0;l!==o;++l){const h=i+l;e[h]=e[h]*a+e[n+l]*r}}_lerpAdditive(e,i,n,r,o){for(let a=0;a!==o;++a){const l=i+a;e[l]=e[l]+e[n+a]*r}}}const ML="\\[\\]\\.:\\/",$Pe=new RegExp("["+ML+"]","g"),kL="[^"+ML+"]",UPe="[^"+ML.replace("\\.","")+"]",FPe=/((?:WC+[\/:])*)/.source.replace("WC",kL),zPe=/(WCOD+)?/.source.replace("WCOD",UPe),XPe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",kL),WPe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",kL),HPe=new RegExp("^"+FPe+zPe+XPe+WPe+"$"),GPe=["material","materials","bones","map"];class QPe{constructor(e,i,n){const r=n||ji.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,r)}getValue(e,i){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,i)}setValue(e,i){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=n.length;r!==o;++r)n[r].setValue(e,i)}bind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].bind()}unbind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].unbind()}}class ji{constructor(e,i,n){this.path=i,this.parsedPath=n||ji.parseTrackName(i),this.node=ji.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,n){return e&&e.isAnimationObjectGroup?new ji.Composite(e,i,n):new ji(e,i,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace($Pe,"")}static parseTrackName(e){const i=HPe.exec(e);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const o=n.nodeName.substring(r+1);GPe.indexOf(o)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=o)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,i){if(i===void 0||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(i);if(n!==void 0)return n}if(e.children){const n=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const h=n(l.children);if(h)return h}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)e[i++]=n[r]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=e[i++]}_setValue_array_setNeedsUpdate(e,i){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){const n=this.resolvedProperty;for(let r=0,o=n.length;r!==o;++r)n[r]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node;const i=this.parsedPath,n=i.objectName,r=i.propertyName;let o=i.propertyIndex;if(e||(e=ji.findNode(this.rootNode,i.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let d=i.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===d){d=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(d!==void 0){if(e[d]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[d]}}const a=e[r];if(a===void 0){const d=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+r+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(o!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}h=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(h=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ji.Composite=QPe;ji.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ji.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ji.prototype.GetterByBindingType=[ji.prototype._getValue_direct,ji.prototype._getValue_array,ji.prototype._getValue_arrayElement,ji.prototype._getValue_toArray];ji.prototype.SetterByBindingTypeAndVersioning=[[ji.prototype._setValue_direct,ji.prototype._setValue_direct_setNeedsUpdate,ji.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ji.prototype._setValue_array,ji.prototype._setValue_array_setNeedsUpdate,ji.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ji.prototype._setValue_arrayElement,ji.prototype._setValue_arrayElement_setNeedsUpdate,ji.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ji.prototype._setValue_fromArray,ji.prototype._setValue_fromArray_setNeedsUpdate,ji.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class YPe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=La(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const e=this._objects,i=this._indicesByUUID,n=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length;let l,h=e.length,d=this.nCachedObjects_;for(let f=0,p=arguments.length;f!==p;++f){const g=arguments[f],y=g.uuid;let x=i[y];if(x===void 0){x=h++,i[y]=x,e.push(g);for(let _=0,w=a;_!==w;++_)o[_].push(new ji(g,n[_],r[_]))}else if(x<d){l=e[x];const _=--d,w=e[_];i[w.uuid]=x,e[x]=w,i[y]=_,e[_]=g;for(let O=0,T=a;O!==T;++O){const C=o[O],A=C[_];let B=C[x];C[x]=A,B===void 0&&(B=new ji(g,n[O],r[O])),C[_]=B}}else e[x]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d}remove(){const e=this._objects,i=this._indicesByUUID,n=this._bindings,r=n.length;let o=this.nCachedObjects_;for(let a=0,l=arguments.length;a!==l;++a){const h=arguments[a],d=h.uuid,f=i[d];if(f!==void 0&&f>=o){const p=o++,g=e[p];i[g.uuid]=f,e[f]=g,i[d]=p,e[p]=h;for(let y=0,x=r;y!==x;++y){const _=n[y],w=_[p],O=_[f];_[f]=w,_[p]=O}}}this.nCachedObjects_=o}uncache(){const e=this._objects,i=this._indicesByUUID,n=this._bindings,r=n.length;let o=this.nCachedObjects_,a=e.length;for(let l=0,h=arguments.length;l!==h;++l){const d=arguments[l],f=d.uuid,p=i[f];if(p!==void 0)if(delete i[f],p<o){const g=--o,y=e[g],x=--a,_=e[x];i[y.uuid]=p,e[p]=y,i[_.uuid]=g,e[g]=_,e.pop();for(let w=0,O=r;w!==O;++w){const T=n[w],C=T[g],A=T[x];T[p]=C,T[g]=A,T.pop()}}else{const g=--a,y=e[g];g>0&&(i[y.uuid]=p),e[p]=y,e.pop();for(let x=0,_=r;x!==_;++x){const w=n[x];w[p]=w[g],w.pop()}}}this.nCachedObjects_=o}subscribe_(e,i){const n=this._bindingsIndicesByPath;let r=n[e];const o=this._bindings;if(r!==void 0)return o[r];const a=this._paths,l=this._parsedPaths,h=this._objects,d=h.length,f=this.nCachedObjects_,p=new Array(d);r=o.length,n[e]=r,a.push(e),l.push(i),o.push(p);for(let g=f,y=h.length;g!==y;++g){const x=h[g];p[g]=new ji(x,e,i)}return p}unsubscribe_(e){const i=this._bindingsIndicesByPath,n=i[e];if(n!==void 0){const r=this._paths,o=this._parsedPaths,a=this._bindings,l=a.length-1,h=a[l],d=e[l];i[d]=n,a[n]=h,a.pop(),o[n]=o[l],o.pop(),r[n]=r[l],r.pop()}}}class hj{constructor(e,i,n=null,r=i.blendMode){this._mixer=e,this._clip=i,this._localRoot=n,this.blendMode=r;const o=i.tracks,a=o.length,l=new Array(a),h={endingStart:Dp,endingEnd:Dp};for(let d=0;d!==a;++d){const f=o[d].createInterpolant(null);l[d]=f,f.settings=h}this._interpolantSettings=h,this._interpolants=l,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=H9,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,i){return this.loop=e,this.repetitions=i,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,i,n){if(e.fadeOut(i),this.fadeIn(i),n){const r=this._clip.duration,o=e._clip.duration,a=o/r,l=r/o;e.warp(1,a,i),this.warp(l,1,i)}return this}crossFadeTo(e,i,n){return e.crossFadeFrom(this,i,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,i,n){const r=this._mixer,o=r.time,a=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=r._lendControlInterpolant(),this._timeScaleInterpolant=l);const h=l.parameterPositions,d=l.sampleValues;return h[0]=o,h[1]=o+n,d[0]=e/a,d[1]=i/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,i,n,r){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const h=(e-o)*n;h<0||n===0?i=0:(this._startTime=null,i=n*h)}i*=this._updateTimeScale(e);const a=this._updateTime(i),l=this._updateWeight(e);if(l>0){const h=this._interpolants,d=this._propertyBindings;switch(this.blendMode){case iL:for(let f=0,p=h.length;f!==p;++f)h[f].evaluate(a),d[f].accumulateAdditive(l);break;case vA:default:for(let f=0,p=h.length;f!==p;++f)h[f].evaluate(a),d[f].accumulate(r,l)}}}_updateWeight(e){let i=0;if(this.enabled){i=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];i*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(e){let i=0;if(!this.paused){i=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];i*=r,e>n.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i)}}return this._effectiveTimeScale=i,i}_updateTime(e){const i=this._clip.duration,n=this.loop;let r=this.time+e,o=this._loopCount;const a=n===G9;if(e===0)return o===-1?r:a&&(o&1)===1?i-r:r;if(n===W9){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=i)r=i;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=i||r<0){const l=Math.floor(r/i);r-=i*l,o+=Math.abs(l);const h=this.repetitions-o;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?i:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(h===1){const d=e<0;this._setEndings(d,!d,a)}else this._setEndings(!1,!1,a);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=r;if(a&&(o&1)===1)return i-r}return r}_setEndings(e,i,n){const r=this._interpolantSettings;n?(r.endingStart=Lp,r.endingEnd=Lp):(e?r.endingStart=this.zeroSlopeAtStart?Lp:Dp:r.endingStart=w_,i?r.endingEnd=this.zeroSlopeAtEnd?Lp:Dp:r.endingEnd=w_)}_scheduleFading(e,i,n){const r=this._mixer,o=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const l=a.parameterPositions,h=a.sampleValues;return l[0]=o,h[0]=i,l[1]=o+e,h[1]=n,this}}const jPe=new Float32Array(1);class qPe extends ch{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){const n=e._localRoot||this._root,r=e._clip.tracks,o=r.length,a=e._propertyBindings,l=e._interpolants,h=n.uuid,d=this._bindingsByRootAndName;let f=d[h];f===void 0&&(f={},d[h]=f);for(let p=0;p!==o;++p){const g=r[p],y=g.name;let x=f[y];if(x!==void 0)++x.referenceCount,a[p]=x;else{if(x=a[p],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,h,y));continue}const _=i&&i._propertyBindings[p].binding.parsedPath;x=new cj(ji.create(n,y,_),g.ValueTypeName,g.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,h,y),a[p]=x}l[p].resultBuffer=x.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,o=this._actionsByClip[r];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,r,n)}const i=e._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const o=i[n];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const i=e._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const o=i[n];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const i=e._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(e,i,n){const r=this._actions,o=this._actionsByClip;let a=o[i];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[i]=a;else{const l=a.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const i=this._actions,n=i[i.length-1],r=e._cacheIndex;n._cacheIndex=r,i[r]=n,i.pop(),e._cacheIndex=null;const o=e._clip.uuid,a=this._actionsByClip,l=a[o],h=l.knownActions,d=h[h.length-1],f=e._byClipCacheIndex;d._byClipCacheIndex=f,h[f]=d,h.pop(),e._byClipCacheIndex=null;const p=l.actionByRoot,g=(e._localRoot||this._root).uuid;delete p[g],h.length===0&&delete a[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const i=e._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const o=i[n];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const i=this._actions,n=e._cacheIndex,r=this._nActiveActions++,o=i[r];e._cacheIndex=r,i[r]=e,o._cacheIndex=n,i[n]=o}_takeBackAction(e){const i=this._actions,n=e._cacheIndex,r=--this._nActiveActions,o=i[r];e._cacheIndex=r,i[r]=e,o._cacheIndex=n,i[n]=o}_addInactiveBinding(e,i,n){const r=this._bindingsByRootAndName,o=this._bindings;let a=r[i];a===void 0&&(a={},r[i]=a),a[n]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const i=this._bindings,n=e.binding,r=n.rootNode.uuid,o=n.path,a=this._bindingsByRootAndName,l=a[r],h=i[i.length-1],d=e._cacheIndex;h._cacheIndex=d,i[d]=h,i.pop(),delete l[o],Object.keys(l).length===0&&delete a[r]}_lendBinding(e){const i=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,o=i[r];e._cacheIndex=r,i[r]=e,o._cacheIndex=n,i[n]=o}_takeBackBinding(e){const i=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,o=i[r];e._cacheIndex=r,i[r]=e,o._cacheIndex=n,i[n]=o}_lendControlInterpolant(){const e=this._controlInterpolants,i=this._nActiveControlInterpolants++;let n=e[i];return n===void 0&&(n=new wL(new Float32Array(2),new Float32Array(2),1,jPe),n.__cacheIndex=i,e[i]=n),n}_takeBackControlInterpolant(e){const i=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,o=i[r];e.__cacheIndex=r,i[r]=e,o.__cacheIndex=n,i[n]=o}clipAction(e,i,n){const r=i||this._root,o=r.uuid;let a=typeof e=="string"?D_.findByName(r,e):e;const l=a!==null?a.uuid:e,h=this._actionsByClip[l];let d=null;if(n===void 0&&(a!==null?n=a.blendMode:n=vA),h!==void 0){const p=h.actionByRoot[o];if(p!==void 0&&p.blendMode===n)return p;d=h.knownActions[0],a===null&&(a=d._clip)}if(a===null)return null;const f=new hj(this,a,i,n);return this._bindAction(f,d),this._addInactiveAction(f,l,o),f}existingAction(e,i){const n=i||this._root,r=n.uuid,o=typeof e=="string"?D_.findByName(n,e):e,a=o?o.uuid:e,l=this._actionsByClip[a];return l!==void 0&&l.actionByRoot[r]||null}stopAllAction(){const e=this._actions,i=this._nActiveActions;for(let n=i-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const i=this._actions,n=this._nActiveActions,r=this.time+=e,o=Math.sign(e),a=this._accuIndex^=1;for(let d=0;d!==n;++d)i[d]._update(r,e,o,a);const l=this._bindings,h=this._nActiveBindings;for(let d=0;d!==h;++d)l[d].apply(a);return this}setTime(e){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const i=this._actions,n=e.uuid,r=this._actionsByClip,o=r[n];if(o!==void 0){const a=o.knownActions;for(let l=0,h=a.length;l!==h;++l){const d=a[l];this._deactivateAction(d);const f=d._cacheIndex,p=i[i.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,p._cacheIndex=f,i[f]=p,i.pop(),this._removeInactiveBindingsForAction(d)}delete r[n]}}uncacheRoot(e){const i=e.uuid,n=this._actionsByClip;for(const a in n){const l=n[a].actionByRoot,h=l[i];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}const r=this._bindingsByRootAndName,o=r[i];if(o!==void 0)for(const a in o){const l=o[a];l.restoreOriginalState(),this._removeInactiveBinding(l)}}uncacheAction(e,i){const n=this.existingAction(e,i);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class zA{constructor(e){this.value=e}clone(){return new zA(this.value.clone===void 0?this.value:this.value.clone())}}let ZPe=0;class KPe extends ch{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:ZPe++}),this.name="",this.usage=T_,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const i=this.uniforms.indexOf(e);return i!==-1&&this.uniforms.splice(i,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const i=e.uniforms;this.uniforms.length=0;for(let n=0,r=i.length;n<r;n++){const o=Array.isArray(i[n])?i[n]:[i[n]];for(let a=0;a<o.length;a++)this.uniforms.push(o[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class JPe extends Ab{constructor(e,i,n=1){super(e,i),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const i=super.clone(e);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(e){const i=super.toJSON(e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}class e2e{constructor(e,i,n,r,o){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=i,this.itemSize=n,this.elementSize=r,this.count=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,i){return this.type=e,this.elementSize=i,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const Z5=new ri;class PL{constructor(e,i,n=0,r=1/0){this.ray=new km(e,i),this.near=n,this.far=r,this.camera=null,this.layers=new bA,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}setFromXRController(e){return Z5.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Z5),this}intersectObject(e,i=!0,n=[]){return RB(e,this,n,i),n.sort(K5),n}intersectObjects(e,i=!0,n=[]){for(let r=0,o=e.length;r<o;r++)RB(e[r],this,n,i);return n.sort(K5),n}}function K5(s,e){return s.distance-e.distance}function RB(s,e,i,n){if(s.layers.test(e.layers)&&s.raycast(e,i),n===!0){const r=s.children;for(let o=0,a=r.length;o<a;o++)RB(r[o],e,i,!0)}}class DB{constructor(e=1,i=0,n=0){return this.radius=e,this.phi=i,this.theta=n,this}set(e,i,n){return this.radius=e,this.phi=i,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,n){return this.radius=Math.sqrt(e*e+i*i+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ms(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class t2e{constructor(e=1,i=0,n=0){return this.radius=e,this.theta=i,this.y=n,this}set(e,i,n){return this.radius=e,this.theta=i,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=i,this}clone(){return new this.constructor().copy(this)}}const J5=new Fe;class uj{constructor(e=new Fe(1/0,1/0),i=new Fe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=J5.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,J5).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const e6=new ie,hO=new ie;class dj{constructor(e=new ie,i=new ie){this.start=e,this.end=i}set(e,i){return this.start.copy(e),this.end.copy(i),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,i){return this.delta(i).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,i){e6.subVectors(e,this.start),hO.subVectors(this.end,this.start);const n=hO.dot(hO);let o=hO.dot(e6)/n;return i&&(o=Ms(o,0,1)),o}closestPointToPoint(e,i,n){const r=this.closestPointToPointParameter(e,i);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const t6=new ie;class i2e extends vn{constructor(e,i){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=i,this.type="SpotLightHelper";const n=new $i,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,l=1,h=32;a<h;a++,l++){const d=a/h*Math.PI*2,f=l/h*Math.PI*2;r.push(Math.cos(d),Math.sin(d),1,Math.cos(f),Math.sin(f),1)}n.setAttribute("position",new Ut(r,3));const o=new Eo({fog:!1,toneMapped:!1});this.cone=new hh(n,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,i=e*Math.tan(this.light.angle);this.cone.scale.set(i,i,e),t6.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t6),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const ld=new ie,uO=new ri,xP=new ri;class n2e extends hh{constructor(e){const i=fj(e),n=new $i,r=[],o=[],a=new ft(0,0,1),l=new ft(0,1,0);for(let d=0;d<i.length;d++){const f=i[d];f.parent&&f.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),o.push(a.r,a.g,a.b),o.push(l.r,l.g,l.b))}n.setAttribute("position",new Ut(r,3)),n.setAttribute("color",new Ut(o,3));const h=new Eo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,h),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=i,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const i=this.bones,n=this.geometry,r=n.getAttribute("position");xP.copy(this.root.matrixWorld).invert();for(let o=0,a=0;o<i.length;o++){const l=i[o];l.parent&&l.parent.isBone&&(uO.multiplyMatrices(xP,l.matrixWorld),ld.setFromMatrixPosition(uO),r.setXYZ(a,ld.x,ld.y,ld.z),uO.multiplyMatrices(xP,l.parent.matrixWorld),ld.setFromMatrixPosition(uO),r.setXYZ(a+1,ld.x,ld.y,ld.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function fj(s){const e=[];s.isBone===!0&&e.push(s);for(let i=0;i<s.children.length;i++)e.push.apply(e,fj(s.children[i]));return e}class s2e extends Dn{constructor(e,i,n){const r=new kb(i,4,2),o=new lc({wireframe:!0,fog:!1,toneMapped:!1});super(r,o),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const r2e=new ie,i6=new ft,n6=new ft;class o2e extends vn{constructor(e,i,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Mb(i);r.rotateY(Math.PI*.5),this.material=new lc({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const o=r.getAttribute("position"),a=new Float32Array(o.count*3);r.setAttribute("color",new rn(a,3)),this.add(new Dn(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=e.geometry.getAttribute("color");i6.copy(this.light.color),n6.copy(this.light.groundColor);for(let n=0,r=i.count;n<r;n++){const o=n<r/2?i6:n6;i.setXYZ(n,o.r,o.g,o.b)}i.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(r2e.setFromMatrixPosition(this.light.matrixWorld).negate())}}class a2e extends hh{constructor(e=10,i=10,n=4473924,r=8947848){n=new ft(n),r=new ft(r);const o=i/2,a=e/i,l=e/2,h=[],d=[];for(let g=0,y=0,x=-l;g<=i;g++,x+=a){h.push(-l,0,x,l,0,x),h.push(x,0,-l,x,0,l);const _=g===o?n:r;_.toArray(d,y),y+=3,_.toArray(d,y),y+=3,_.toArray(d,y),y+=3,_.toArray(d,y),y+=3}const f=new $i;f.setAttribute("position",new Ut(h,3)),f.setAttribute("color",new Ut(d,3));const p=new Eo({vertexColors:!0,toneMapped:!1});super(f,p),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class l2e extends hh{constructor(e=10,i=16,n=8,r=64,o=4473924,a=8947848){o=new ft(o),a=new ft(a);const l=[],h=[];if(i>1)for(let p=0;p<i;p++){const g=p/i*(Math.PI*2),y=Math.sin(g)*e,x=Math.cos(g)*e;l.push(0,0,0),l.push(y,0,x);const _=p&1?o:a;h.push(_.r,_.g,_.b),h.push(_.r,_.g,_.b)}for(let p=0;p<n;p++){const g=p&1?o:a,y=e-e/n*p;for(let x=0;x<r;x++){let _=x/r*(Math.PI*2),w=Math.sin(_)*y,O=Math.cos(_)*y;l.push(w,0,O),h.push(g.r,g.g,g.b),_=(x+1)/r*(Math.PI*2),w=Math.sin(_)*y,O=Math.cos(_)*y,l.push(w,0,O),h.push(g.r,g.g,g.b)}}const d=new $i;d.setAttribute("position",new Ut(l,3)),d.setAttribute("color",new Ut(h,3));const f=new Eo({vertexColors:!0,toneMapped:!1});super(d,f),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const s6=new ie,dO=new ie,r6=new ie;class c2e extends vn{constructor(e,i,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",i===void 0&&(i=1);let r=new $i;r.setAttribute("position",new Ut([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const o=new Eo({fog:!1,toneMapped:!1});this.lightPlane=new nf(r,o),this.add(this.lightPlane),r=new $i,r.setAttribute("position",new Ut([0,0,0,0,0,1],3)),this.targetLine=new nf(r,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),s6.setFromMatrixPosition(this.light.matrixWorld),dO.setFromMatrixPosition(this.light.target.matrixWorld),r6.subVectors(dO,s6),this.lightPlane.lookAt(dO),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(dO),this.targetLine.scale.z=r6.length()}}const fO=new ie,bs=new Sb;class h2e extends hh{constructor(e){const i=new $i,n=new Eo({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],o=[],a={};l("n1","n2"),l("n2","n4"),l("n4","n3"),l("n3","n1"),l("f1","f2"),l("f2","f4"),l("f4","f3"),l("f3","f1"),l("n1","f1"),l("n2","f2"),l("n3","f3"),l("n4","f4"),l("p","n1"),l("p","n2"),l("p","n3"),l("p","n4"),l("u1","u2"),l("u2","u3"),l("u3","u1"),l("c","t"),l("p","c"),l("cn1","cn2"),l("cn3","cn4"),l("cf1","cf2"),l("cf3","cf4");function l(x,_){h(x),h(_)}function h(x){r.push(0,0,0),o.push(0,0,0),a[x]===void 0&&(a[x]=[]),a[x].push(r.length/3-1)}i.setAttribute("position",new Ut(r,3)),i.setAttribute("color",new Ut(o,3)),super(i,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const d=new ft(16755200),f=new ft(16711680),p=new ft(43775),g=new ft(16777215),y=new ft(3355443);this.setColors(d,f,p,g,y)}setColors(e,i,n,r,o){const l=this.geometry.getAttribute("color");l.setXYZ(0,e.r,e.g,e.b),l.setXYZ(1,e.r,e.g,e.b),l.setXYZ(2,e.r,e.g,e.b),l.setXYZ(3,e.r,e.g,e.b),l.setXYZ(4,e.r,e.g,e.b),l.setXYZ(5,e.r,e.g,e.b),l.setXYZ(6,e.r,e.g,e.b),l.setXYZ(7,e.r,e.g,e.b),l.setXYZ(8,e.r,e.g,e.b),l.setXYZ(9,e.r,e.g,e.b),l.setXYZ(10,e.r,e.g,e.b),l.setXYZ(11,e.r,e.g,e.b),l.setXYZ(12,e.r,e.g,e.b),l.setXYZ(13,e.r,e.g,e.b),l.setXYZ(14,e.r,e.g,e.b),l.setXYZ(15,e.r,e.g,e.b),l.setXYZ(16,e.r,e.g,e.b),l.setXYZ(17,e.r,e.g,e.b),l.setXYZ(18,e.r,e.g,e.b),l.setXYZ(19,e.r,e.g,e.b),l.setXYZ(20,e.r,e.g,e.b),l.setXYZ(21,e.r,e.g,e.b),l.setXYZ(22,e.r,e.g,e.b),l.setXYZ(23,e.r,e.g,e.b),l.setXYZ(24,i.r,i.g,i.b),l.setXYZ(25,i.r,i.g,i.b),l.setXYZ(26,i.r,i.g,i.b),l.setXYZ(27,i.r,i.g,i.b),l.setXYZ(28,i.r,i.g,i.b),l.setXYZ(29,i.r,i.g,i.b),l.setXYZ(30,i.r,i.g,i.b),l.setXYZ(31,i.r,i.g,i.b),l.setXYZ(32,n.r,n.g,n.b),l.setXYZ(33,n.r,n.g,n.b),l.setXYZ(34,n.r,n.g,n.b),l.setXYZ(35,n.r,n.g,n.b),l.setXYZ(36,n.r,n.g,n.b),l.setXYZ(37,n.r,n.g,n.b),l.setXYZ(38,r.r,r.g,r.b),l.setXYZ(39,r.r,r.g,r.b),l.setXYZ(40,o.r,o.g,o.b),l.setXYZ(41,o.r,o.g,o.b),l.setXYZ(42,o.r,o.g,o.b),l.setXYZ(43,o.r,o.g,o.b),l.setXYZ(44,o.r,o.g,o.b),l.setXYZ(45,o.r,o.g,o.b),l.setXYZ(46,o.r,o.g,o.b),l.setXYZ(47,o.r,o.g,o.b),l.setXYZ(48,o.r,o.g,o.b),l.setXYZ(49,o.r,o.g,o.b),l.needsUpdate=!0}update(){const e=this.geometry,i=this.pointMap,n=1,r=1;bs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ks("c",i,e,bs,0,0,-1),ks("t",i,e,bs,0,0,1),ks("n1",i,e,bs,-n,-r,-1),ks("n2",i,e,bs,n,-r,-1),ks("n3",i,e,bs,-n,r,-1),ks("n4",i,e,bs,n,r,-1),ks("f1",i,e,bs,-n,-r,1),ks("f2",i,e,bs,n,-r,1),ks("f3",i,e,bs,-n,r,1),ks("f4",i,e,bs,n,r,1),ks("u1",i,e,bs,n*.7,r*1.1,-1),ks("u2",i,e,bs,-n*.7,r*1.1,-1),ks("u3",i,e,bs,0,r*2,-1),ks("cf1",i,e,bs,-n,0,1),ks("cf2",i,e,bs,n,0,1),ks("cf3",i,e,bs,0,-r,1),ks("cf4",i,e,bs,0,r,1),ks("cn1",i,e,bs,-n,0,-1),ks("cn2",i,e,bs,n,0,-1),ks("cn3",i,e,bs,0,-r,-1),ks("cn4",i,e,bs,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ks(s,e,i,n,r,o,a){fO.set(r,o,a).unproject(n);const l=e[s];if(l!==void 0){const h=i.getAttribute("position");for(let d=0,f=l.length;d<f;d++)h.setXYZ(l[d],fO.x,fO.y,fO.z)}}const pO=new Nr;class u2e extends hh{constructor(e,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),o=new $i;o.setIndex(new rn(n,1)),o.setAttribute("position",new rn(r,3)),super(o,new Eo({color:i,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&pO.setFromObject(this.object),pO.isEmpty())return;const i=pO.min,n=pO.max,r=this.geometry.attributes.position,o=r.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=i.x,o[4]=n.y,o[5]=n.z,o[6]=i.x,o[7]=i.y,o[8]=n.z,o[9]=n.x,o[10]=i.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=i.z,o[15]=i.x,o[16]=n.y,o[17]=i.z,o[18]=i.x,o[19]=i.y,o[20]=i.z,o[21]=n.x,o[22]=i.y,o[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,i){return super.copy(e,i),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class d2e extends hh{constructor(e,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new $i;o.setIndex(new rn(n,1)),o.setAttribute("position",new Ut(r,3)),super(o,new Eo({color:i,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class f2e extends nf{constructor(e,i=1,n=16776960){const r=n,o=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new $i;a.setAttribute("position",new Ut(o,3)),a.computeBoundingSphere(),super(a,new Eo({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=i;const l=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],h=new $i;h.setAttribute("position",new Ut(l,3)),h.computeBoundingSphere(),this.add(new Dn(h,new lc({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const o6=new ie;let mO,_P;class p2e extends vn{constructor(e=new ie(0,0,1),i=new ie(0,0,0),n=1,r=16776960,o=n*.2,a=o*.2){super(),this.type="ArrowHelper",mO===void 0&&(mO=new $i,mO.setAttribute("position",new Ut([0,0,0,0,1,0],3)),_P=new Ry(0,.5,1,5,1),_P.translate(0,-.5,0)),this.position.copy(i),this.line=new nf(mO,new Eo({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Dn(_P,new lc({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,o,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{o6.set(e.z,0,-e.x).normalize();const i=Math.acos(e.y);this.quaternion.setFromAxisAngle(o6,i)}}setLength(e,i=e*.2,n=i*.2){this.line.scale.set(1,Math.max(1e-4,e-i),1),this.line.updateMatrix(),this.cone.scale.set(n,i,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class m2e extends hh{constructor(e=1){const i=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new $i;r.setAttribute("position",new Ut(i,3)),r.setAttribute("color",new Ut(n,3));const o=new Eo({vertexColors:!0,toneMapped:!1});super(r,o),this.type="AxesHelper"}setColors(e,i,n){const r=new ft,o=this.geometry.attributes.color.array;return r.set(e),r.toArray(o,0),r.toArray(o,3),r.set(i),r.toArray(o,6),r.toArray(o,9),r.set(n),r.toArray(o,12),r.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class pj{constructor(){this.type="ShapePath",this.color=new ft,this.subPaths=[],this.currentPath=null}moveTo(e,i){return this.currentPath=new M_,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,i),this}lineTo(e,i){return this.currentPath.lineTo(e,i),this}quadraticCurveTo(e,i,n,r){return this.currentPath.quadraticCurveTo(e,i,n,r),this}bezierCurveTo(e,i,n,r,o,a){return this.currentPath.bezierCurveTo(e,i,n,r,o,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(O){const T=[];for(let C=0,A=O.length;C<A;C++){const B=O[C],I=new em;I.curves=B.curves,T.push(I)}return T}function n(O,T){const C=T.length;let A=!1;for(let B=C-1,I=0;I<C;B=I++){let R=T[B],P=T[I],k=P.x-R.x,E=P.y-R.y;if(Math.abs(E)>Number.EPSILON){if(E<0&&(R=T[I],k=-k,P=T[B],E=-E),O.y<R.y||O.y>P.y)continue;if(O.y===R.y){if(O.x===R.x)return!0}else{const D=E*(O.x-R.x)-k*(O.y-R.y);if(D===0)return!0;if(D<0)continue;A=!A}}else{if(O.y!==R.y)continue;if(P.x<=O.x&&O.x<=R.x||R.x<=O.x&&O.x<=P.x)return!0}}return A}const r=Kc.isClockWise,o=this.subPaths;if(o.length===0)return[];let a,l,h;const d=[];if(o.length===1)return l=o[0],h=new em,h.curves=l.curves,d.push(h),d;let f=!r(o[0].getPoints());f=e?!f:f;const p=[],g=[];let y=[],x=0,_;g[x]=void 0,y[x]=[];for(let O=0,T=o.length;O<T;O++)l=o[O],_=l.getPoints(),a=r(_),a=e?!a:a,a?(!f&&g[x]&&x++,g[x]={s:new em,p:_},g[x].s.curves=l.curves,f&&x++,y[x]=[]):y[x].push({h:l,p:_[0]});if(!g[0])return i(o);if(g.length>1){let O=!1,T=0;for(let C=0,A=g.length;C<A;C++)p[C]=[];for(let C=0,A=g.length;C<A;C++){const B=y[C];for(let I=0;I<B.length;I++){const R=B[I];let P=!0;for(let k=0;k<g.length;k++)n(R.p,g[k].p)&&(C!==k&&T++,P?(P=!1,p[k].push(R)):O=!0);P&&p[C].push(R)}}T>0&&O===!1&&(y=p)}let w;for(let O=0,T=g.length;O<T;O++){h=g[O].s,d.push(h),w=y[O];for(let C=0,A=w.length;C<A;C++)h.holes.push(w[C].h)}return d}}class g2e extends gl{constructor(e=1,i=1,n=1,r={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,i,{...r,count:n}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:My}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=My);const y2e=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:QD,AddEquation:Rd,AddOperation:A9,AdditiveAnimationBlendMode:iL,AdditiveBlending:XC,AgXToneMapping:I9,AlphaFormat:V9,AlwaysCompare:iY,AlwaysDepth:_9,AlwaysStencilFunc:SB,AmbientLight:ij,AnimationAction:hj,AnimationClip:D_,AnimationLoader:wPe,AnimationMixer:qPe,AnimationObjectGroup:YPe,AnimationUtils:vPe,ArcCurve:EY,ArrayCamera:xY,ArrowHelper:p2e,AttachedBindMode:ZI,Audio:lj,AudioAnalyser:VPe,AudioContext:AL,AudioListener:DPe,AudioLoader:IPe,AxesHelper:m2e,BackSide:qr,BasicDepthPacking:Q9,BasicShadowMap:PSe,BatchedMesh:CY,Bone:fL,BooleanKeyframeTrack:Pm,Box2:uj,Box3:Nr,Box3Helper:d2e,BoxGeometry:xf,BoxHelper:u2e,BufferAttribute:rn,BufferGeometry:$i,BufferGeometryLoader:aj,ByteType:D9,Cache:Jh,Camera:Sb,CameraHelper:h2e,CanvasTexture:zke,CapsuleGeometry:EA,CatmullRomCurve3:MY,CineonToneMapping:k9,CircleGeometry:MA,ClampToEdgeWrapping:Pa,Clock:EL,Color:ft,ColorKeyframeTrack:OL,ColorManagement:Mn,CompressedArrayTexture:Uke,CompressedCubeTexture:Fke,CompressedTexture:Jp,CompressedTextureLoader:OPe,ConeGeometry:kA,ConstantAlphaFactor:y9,ConstantColorFactor:m9,CubeCamera:hY,CubeReflectionMapping:vu,CubeRefractionMapping:tf,CubeTexture:Cb,CubeTextureLoader:SPe,CubeUVReflectionMapping:ky,CubicBezierCurve:gL,CubicBezierCurve3:kY,CubicInterpolant:YY,CullFaceBack:YI,CullFaceFront:e9,CullFaceFrontBack:kSe,CullFaceNone:J7,Curve:cc,CurvePath:IY,CustomBlending:t9,CustomToneMapping:P9,CylinderGeometry:Ry,Cylindrical:t2e,Data3DTexture:rL,DataArrayTexture:_A,DataTexture:Yd,DataTextureLoader:CPe,DataUtils:$Ce,DecrementStencilOp:zSe,DecrementWrapStencilOp:WSe,DefaultLoadingManager:ZY,DepthFormat:Zp,DepthStencilFormat:oy,DepthTexture:cL,DetachedBindMode:R9,DirectionalLight:tj,DirectionalLightHelper:c2e,DiscreteInterpolant:jY,DisplayP3ColorSpace:xA,DodecahedronGeometry:PA,DoubleSide:Wo,DstAlphaFactor:h9,DstColorFactor:d9,DynamicCopyUsage:rCe,DynamicDrawUsage:JSe,DynamicReadUsage:iCe,EdgesGeometry:BY,EllipseCurve:TA,EqualCompare:K9,EqualDepth:w9,EqualStencilFunc:YSe,EquirectangularReflectionMapping:__,EquirectangularRefractionMapping:b_,Euler:To,EventDispatcher:ch,ExtrudeGeometry:BA,FileLoader:_u,Float16BufferAttribute:HCe,Float32BufferAttribute:Ut,FloatType:hl,Fog:SA,FogExp2:OA,FramebufferTexture:MB,FrontSide:yu,Frustum:Tb,GLBufferAttribute:e2e,GLSL1:aCe,GLSL3:CB,GreaterCompare:J9,GreaterDepth:S9,GreaterEqualCompare:tY,GreaterEqualDepth:O9,GreaterEqualStencilFunc:KSe,GreaterStencilFunc:qSe,GridHelper:a2e,Group:f0,HalfFloatType:Py,HemisphereLight:KY,HemisphereLightHelper:o2e,IcosahedronGeometry:RA,ImageBitmapLoader:PPe,ImageLoader:L_,ImageUtils:oY,IncrementStencilOp:FSe,IncrementWrapStencilOp:XSe,InstancedBufferAttribute:fy,InstancedBufferGeometry:oj,InstancedInterleavedBuffer:JPe,InstancedMesh:SY,Int16BufferAttribute:XCe,Int32BufferAttribute:WCe,Int8BufferAttribute:UCe,IntType:jD,InterleavedBuffer:Ab,InterleavedBufferAttribute:xu,Interpolant:Pb,InterpolateDiscrete:ay,InterpolateLinear:ly,InterpolateSmooth:HS,InvertStencilOp:HSe,KeepStencilOp:wp,KeyframeTrack:hc,LOD:wY,LatheGeometry:Eb,Layers:bA,LessCompare:Z9,LessDepth:b9,LessEqualCompare:nL,LessEqualDepth:x_,LessEqualStencilFunc:jSe,LessStencilFunc:QSe,Light:wf,LightProbe:rj,Line:nf,Line3:dj,LineBasicMaterial:Eo,LineCurve:yL,LineCurve3:PY,LineDashedMaterial:HY,LineLoop:TY,LineSegments:hh,LinearDisplayP3ColorSpace:wb,LinearFilter:Bs,LinearInterpolant:wL,LinearMipMapLinearFilter:DSe,LinearMipMapNearestFilter:RSe,LinearMipmapLinearFilter:Gl,LinearMipmapNearestFilter:$0,LinearSRGBColorSpace:Mu,LinearToneMapping:E9,LinearTransfer:O_,Loader:oa,LoaderUtils:BB,LoadingManager:SL,LoopOnce:W9,LoopPingPong:G9,LoopRepeat:H9,LuminanceAlphaFormat:F9,LuminanceFormat:U9,MOUSE:bp,Material:no,MaterialLoader:FA,MathUtils:hy,Matrix3:Ni,Matrix4:ri,MaxEquation:r9,Mesh:Dn,MeshBasicMaterial:lc,MeshDepthMaterial:hL,MeshDistanceMaterial:uL,MeshLambertMaterial:XY,MeshMatcapMaterial:WY,MeshNormalMaterial:zY,MeshPhongMaterial:UY,MeshPhysicalMaterial:$Y,MeshStandardMaterial:_L,MeshToonMaterial:FY,MinEquation:s9,MirroredRepeatWrapping:ry,MixOperation:T9,MultiplyBlending:qI,MultiplyOperation:bb,NearestFilter:ar,NearestMipMapLinearFilter:BSe,NearestMipMapNearestFilter:ISe,NearestMipmapLinearFilter:Rp,NearestMipmapNearestFilter:yA,NeutralToneMapping:B9,NeverCompare:q9,NeverDepth:x9,NeverStencilFunc:GSe,NoBlending:lu,NoColorSpace:Qh,NoToneMapping:cu,NormalAnimationBlendMode:vA,NormalBlending:qp,NotEqualCompare:eY,NotEqualDepth:C9,NotEqualStencilFunc:ZSe,NumberKeyframeTrack:B_,Object3D:vn,ObjectLoader:MPe,ObjectSpaceNormalMap:j9,OctahedronGeometry:Mb,OneFactor:a9,OneMinusConstantAlphaFactor:v9,OneMinusConstantColorFactor:g9,OneMinusDstAlphaFactor:u9,OneMinusDstColorFactor:f9,OneMinusSrcAlphaFactor:HC,OneMinusSrcColorFactor:c9,OrthographicCamera:Ql,P3Primaries:C_,PCFShadowMap:HD,PCFSoftShadowMap:GD,PMREMGenerator:TB,Path:M_,PerspectiveCamera:Rn,Plane:Xl,PlaneGeometry:_f,PlaneHelper:f2e,PointLight:ej,PointLightHelper:s2e,Points:AY,PointsMaterial:pL,PolarGridHelper:l2e,PolyhedronGeometry:bf,PositionalAudio:NPe,PropertyBinding:ji,PropertyMixer:cj,QuadraticBezierCurve:AA,QuadraticBezierCurve3:vL,Quaternion:Zr,QuaternionKeyframeTrack:Dy,QuaternionLinearInterpolant:qY,RED_GREEN_RGTC2_Format:wB,RED_RGTC1_Format:X9,REVISION:My,RGBADepthPacking:Y9,RGBAFormat:qo,RGBAIntegerFormat:tL,RGBA_ASTC_10x10_Format:gB,RGBA_ASTC_10x5_Format:fB,RGBA_ASTC_10x6_Format:pB,RGBA_ASTC_10x8_Format:mB,RGBA_ASTC_12x10_Format:yB,RGBA_ASTC_12x12_Format:vB,RGBA_ASTC_4x4_Format:rB,RGBA_ASTC_5x4_Format:oB,RGBA_ASTC_5x5_Format:aB,RGBA_ASTC_6x5_Format:lB,RGBA_ASTC_6x6_Format:cB,RGBA_ASTC_8x5_Format:hB,RGBA_ASTC_8x6_Format:uB,RGBA_ASTC_8x8_Format:dB,RGBA_BPTC_Format:WS,RGBA_ETC2_EAC_Format:sB,RGBA_PVRTC_2BPPV1_Format:tB,RGBA_PVRTC_4BPPV1_Format:eB,RGBA_S3TC_DXT1_Format:FS,RGBA_S3TC_DXT3_Format:zS,RGBA_S3TC_DXT5_Format:XS,RGBFormat:$9,RGB_BPTC_SIGNED_Format:xB,RGB_BPTC_UNSIGNED_Format:_B,RGB_ETC1_Format:iB,RGB_ETC2_Format:nB,RGB_PVRTC_2BPPV1_Format:JI,RGB_PVRTC_4BPPV1_Format:KI,RGB_S3TC_DXT1_Format:US,RGFormat:z9,RGIntegerFormat:eL,RawShaderMaterial:qx,Ray:km,Raycaster:PL,Rec709Primaries:S_,RectAreaLight:nj,RedFormat:KD,RedIntegerFormat:JD,ReinhardToneMapping:M9,RenderTarget:aY,RepeatWrapping:sy,ReplaceStencilOp:USe,ReverseSubtractEquation:n9,RingGeometry:DA,SIGNED_RED_GREEN_RGTC2_Format:OB,SIGNED_RED_RGTC1_Format:bB,SRGBColorSpace:Ta,SRGBTransfer:Hn,Scene:dy,ShaderChunk:Ui,ShaderLib:rl,ShaderMaterial:Ao,ShadowMaterial:VY,Shape:em,ShapeGeometry:LA,ShapePath:pj,ShapeUtils:Kc,ShortType:L9,Skeleton:CA,SkeletonHelper:n2e,SkinnedMesh:OY,Source:Np,Sphere:Vr,SphereGeometry:kb,Spherical:DB,SphericalHarmonics3:sj,SplineCurve:xL,SpotLight:JY,SpotLightHelper:i2e,Sprite:bY,SpriteMaterial:dL,SrcAlphaFactor:WC,SrcAlphaSaturateFactor:p9,SrcColorFactor:l9,StaticCopyUsage:sCe,StaticDrawUsage:T_,StaticReadUsage:tCe,StereoCamera:BPe,StreamCopyUsage:oCe,StreamDrawUsage:eCe,StreamReadUsage:nCe,StringKeyframeTrack:Im,SubtractEquation:i9,SubtractiveBlending:jI,TOUCH:Wh,TangentSpaceNormalMap:vf,TetrahedronGeometry:NA,Texture:cs,TextureLoader:CL,TorusGeometry:VA,TorusKnotGeometry:$A,Triangle:Ho,TriangleFanDrawMode:VSe,TriangleStripDrawMode:NSe,TrianglesDrawMode:LSe,TubeGeometry:UA,UVMapping:gA,Uint16BufferAttribute:oL,Uint32BufferAttribute:aL,Uint8BufferAttribute:FCe,Uint8ClampedBufferAttribute:zCe,Uniform:zA,UniformsGroup:KPe,UniformsLib:ct,UniformsUtils:Ob,UnsignedByteType:sc,UnsignedInt248Type:Iy,UnsignedInt5999Type:N9,UnsignedIntType:mm,UnsignedShort4444Type:qD,UnsignedShort5551Type:ZD,UnsignedShortType:YD,VSMShadowMap:Dc,Vector2:Fe,Vector3:ie,Vector4:sn,VectorKeyframeTrack:R_,VideoTexture:$ke,WebGL3DRenderTarget:MCe,WebGLArrayRenderTarget:ECe,WebGLCoordinateSystem:Qc,WebGLCubeRenderTarget:uY,WebGLMultipleRenderTargets:g2e,WebGLRenderTarget:gl,WebGLRenderer:Qx,WebGLUtils:vY,WebGPUCoordinateSystem:A_,WireframeGeometry:NY,WrapAroundEnding:w_,ZeroCurvatureEnding:Dp,ZeroFactor:o9,ZeroSlopeEnding:Lp,ZeroStencilOp:$Se,createCanvasElement:sY},Symbol.toStringTag,{value:"Module"}));function bu(s){return $T()?(JR(s),!0):!1}function N_(){const s=new Set,e=r=>{s.delete(r)};return{on:r=>{s.add(r);const o=()=>e(r);return bu(o),{off:o}},off:e,trigger:(...r)=>Promise.all(Array.from(s).map(o=>o(...r)))}}function Yn(s){return typeof s=="function"?s():ni(s)}const LB=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const v2e=s=>s!=null,x2e=Object.prototype.toString,_2e=s=>x2e.call(s)==="[object Object]",NB=()=>{};function b2e(s,e){function i(...n){return new Promise((r,o)=>{Promise.resolve(s(()=>e.apply(this,n),{fn:e,thisArg:this,args:n})).then(r).catch(o)})}return i}function w2e(s,e={}){let i,n,r=NB;const o=l=>{clearTimeout(l),r(),r=NB};return l=>{const h=Yn(s),d=Yn(e.maxWait);return i&&o(i),h<=0||d!==void 0&&d<=0?(n&&(o(n),n=null),Promise.resolve(l())):new Promise((f,p)=>{r=e.rejectOnCancel?p:f,d&&!n&&(n=setTimeout(()=>{i&&o(i),n=null,f(l())},d)),i=setTimeout(()=>{n&&o(n),n=null,f(l())},h)})}}function O2e(s,e,i=!1){return e.reduce((n,r)=>(r in s&&(!i||s[r]!==void 0)&&(n[r]=s[r]),n),{})}function S2e(s){return Na()}function C2e(s,e=200,i={}){return b2e(w2e(e,i),s)}function a6(s,e=200,i={}){const n=gt(s.value),r=C2e(()=>{n.value=s.value},e,i);return an(s,()=>r()),n}function T2e(s,e={}){if(!Ys(s))return ub(s);const i=Array.isArray(s.value)?Array.from({length:s.value.length}):{};for(const n in s.value)i[n]=aD(()=>({get(){return s.value[n]},set(r){var o;if((o=Yn(e.replaceRef))!=null?o:!0)if(Array.isArray(s.value)){const l=[...s.value];l[n]=r,s.value=l}else{const l={...s.value,[n]:r};Object.setPrototypeOf(l,Object.getPrototypeOf(s.value)),s.value=l}else s.value[n]=r}}));return i}function IL(s,e=!0,i){S2e()?io(s,i):e?s():Ty(s)}function A2e(s,e=1e3,i={}){const{immediate:n=!0,immediateCallback:r=!1}=i;let o=null;const a=gt(!1);function l(){o&&(clearInterval(o),o=null)}function h(){a.value=!1,l()}function d(){const f=Yn(e);f<=0||(a.value=!0,r&&s(),l(),o=setInterval(s,f))}if(n&&LB&&d(),Ys(e)||typeof e=="function"){const f=an(e,()=>{a.value&&LB&&d()});bu(f)}return bu(h),{isActive:a,pause:h,resume:d}}function Yl(s){var e;const i=Yn(s);return(e=i==null?void 0:i.$el)!=null?e:i}const ku=LB?window:void 0;function V_(...s){let e,i,n,r;if(typeof s[0]=="string"||Array.isArray(s[0])?([i,n,r]=s,e=ku):[e,i,n,r]=s,!e)return NB;Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n]);const o=[],a=()=>{o.forEach(f=>f()),o.length=0},l=(f,p,g,y)=>(f.addEventListener(p,g,y),()=>f.removeEventListener(p,g,y)),h=an(()=>[Yl(e),Yn(r)],([f,p])=>{if(a(),!f)return;const g=_2e(p)?{...p}:p;o.push(...i.flatMap(y=>n.map(x=>l(f,y,x,g))))},{immediate:!0,flush:"post"}),d=()=>{h(),a()};return bu(d),d}function E2e(){const s=gt(!1),e=Na();return e&&io(()=>{s.value=!0},e),s}function XA(s){const e=E2e();return Es(()=>(e.value,!!s()))}function M2e(s,e,i={}){const{window:n=ku,...r}=i;let o;const a=XA(()=>n&&"MutationObserver"in n),l=()=>{o&&(o.disconnect(),o=void 0)},h=Es(()=>{const g=Yn(s),y=(Array.isArray(g)?g:[g]).map(Yl).filter(v2e);return new Set(y)}),d=an(()=>h.value,g=>{l(),a.value&&g.size&&(o=new MutationObserver(e),g.forEach(y=>o.observe(y,r)))},{immediate:!0,flush:"post"}),f=()=>o==null?void 0:o.takeRecords(),p=()=>{l(),d()};return bu(p),{isSupported:a,stop:p,takeRecords:f}}function BL(s,e={}){const{immediate:i=!0,fpsLimit:n=void 0,window:r=ku}=e,o=gt(!1),a=n?1e3/n:null;let l=0,h=null;function d(g){if(!o.value||!r)return;l||(l=g);const y=g-l;if(a&&y<a){h=r.requestAnimationFrame(d);return}l=g,s({delta:y,timestamp:g}),h=r.requestAnimationFrame(d)}function f(){!o.value&&r&&(o.value=!0,l=0,h=r.requestAnimationFrame(d))}function p(){o.value=!1,h!=null&&r&&(r.cancelAnimationFrame(h),h=null)}return i&&f(),bu(p),{isActive:rm(o),pause:p,resume:f}}function k2e(s,e={}){const{window:i=ku}=e,n=XA(()=>i&&"matchMedia"in i&&typeof i.matchMedia=="function");let r;const o=gt(!1),a=d=>{o.value=d.matches},l=()=>{r&&("removeEventListener"in r?r.removeEventListener("change",a):r.removeListener(a))},h=ru(()=>{n.value&&(l(),r=i.matchMedia(Yn(s)),"addEventListener"in r?r.addEventListener("change",a):r.addListener(a),o.value=r.matches)});return bu(()=>{h(),l(),r=void 0}),o}function P2e(s={}){const{window:e=ku}=s,i=gt(1);if(e){let n=function(){i.value=e.devicePixelRatio,r(),o=e.matchMedia(`(resolution: ${i.value}dppx)`),o.addEventListener("change",n,{once:!0})},r=function(){o==null||o.removeEventListener("change",n)},o;n(),bu(r)}return{pixelRatio:i}}function mj(s,e,i={}){const{window:n=ku,...r}=i;let o;const a=XA(()=>n&&"ResizeObserver"in n),l=()=>{o&&(o.disconnect(),o=void 0)},h=Es(()=>Array.isArray(s)?s.map(p=>Yl(p)):[Yl(s)]),d=an(h,p=>{if(l(),a.value&&n){o=new ResizeObserver(e);for(const g of p)g&&o.observe(g,r)}},{immediate:!0,flush:"post"}),f=()=>{l(),d()};return bu(f),{isSupported:a,stop:f}}function I2e(s,e={}){const{reset:i=!0,windowResize:n=!0,windowScroll:r=!0,immediate:o=!0}=e,a=gt(0),l=gt(0),h=gt(0),d=gt(0),f=gt(0),p=gt(0),g=gt(0),y=gt(0);function x(){const _=Yl(s);if(!_){i&&(a.value=0,l.value=0,h.value=0,d.value=0,f.value=0,p.value=0,g.value=0,y.value=0);return}const w=_.getBoundingClientRect();a.value=w.height,l.value=w.bottom,h.value=w.left,d.value=w.right,f.value=w.top,p.value=w.width,g.value=w.x,y.value=w.y}return mj(s,x),an(()=>Yl(s),_=>!_&&x()),M2e(s,x,{attributeFilter:["style","class"]}),r&&V_("scroll",x,{capture:!0,passive:!0}),n&&V_("resize",x,{passive:!0}),IL(()=>{o&&x()}),{height:a,bottom:l,left:h,right:d,top:f,width:p,x:g,y,update:x}}function B2e(s,e={width:0,height:0},i={}){const{window:n=ku,box:r="content-box"}=i,o=Es(()=>{var p,g;return(g=(p=Yl(s))==null?void 0:p.namespaceURI)==null?void 0:g.includes("svg")}),a=gt(e.width),l=gt(e.height),{stop:h}=mj(s,([p])=>{const g=r==="border-box"?p.borderBoxSize:r==="content-box"?p.contentBoxSize:p.devicePixelContentBoxSize;if(n&&o.value){const y=Yl(s);if(y){const x=y.getBoundingClientRect();a.value=x.width,l.value=x.height}}else if(g){const y=Array.isArray(g)?g:[g];a.value=y.reduce((x,{inlineSize:_})=>x+_,0),l.value=y.reduce((x,{blockSize:_})=>x+_,0)}else a.value=p.contentRect.width,l.value=p.contentRect.height},i);IL(()=>{const p=Yl(s);p&&(a.value="offsetWidth"in p?p.offsetWidth:e.width,l.value="offsetHeight"in p?p.offsetHeight:e.height)});const d=an(()=>Yl(s),p=>{a.value=p?e.width:0,l.value=p?e.height:0});function f(){h(),d()}return{width:a,height:l,stop:f}}function R2e(s){var e;const i=gt(0);if(typeof performance>"u")return i;const n=(e=s==null?void 0:s.every)!=null?e:10;let r=performance.now(),o=0;return BL(()=>{if(o+=1,o>=n){const a=performance.now(),l=a-r;i.value=Math.round(1e3/(l/o)),r=a,o=0}}),i}function D2e(s={}){const e=gt(),i=XA(()=>typeof performance<"u"&&"memory"in performance);if(i.value){const{interval:n=1e3}=s;A2e(()=>{e.value=performance.memory},n,{immediate:s.immediate,immediateCallback:s.immediateCallback})}return{isSupported:i,memory:e}}const gj={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},L2e=Object.keys(gj);function N2e(s={}){const{target:e=ku}=s,i=gt(!1),n=gt(s.initialValue||{});Object.assign(n.value,gj,n.value);const r=o=>{i.value=!0,!(s.pointerTypes&&!s.pointerTypes.includes(o.pointerType))&&(n.value=O2e(o,L2e,!1))};if(e){const o={passive:!0};V_(e,["pointerdown","pointermove","pointerup"],r,o),V_(e,"pointerleave",()=>i.value=!1,o)}return{...T2e(n),isInside:i}}function V2e(s={}){const{window:e=ku,initialWidth:i=Number.POSITIVE_INFINITY,initialHeight:n=Number.POSITIVE_INFINITY,listenOrientation:r=!0,includeScrollbar:o=!0}=s,a=gt(i),l=gt(n),h=()=>{e&&(o?(a.value=e.innerWidth,l.value=e.innerHeight):(a.value=e.document.documentElement.clientWidth,l.value=e.document.documentElement.clientHeight))};if(h(),IL(h),V_("resize",h,{passive:!0}),r){const d=k2e("(orientation: portrait)");an(d,()=>h())}return{width:a,height:l}}var $2e=Object.defineProperty,U2e=(s,e,i)=>e in s?$2e(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i,l6=(s,e,i)=>(U2e(s,typeof e!="symbol"?e+"":e,i),i);const F2e="@tresjs/core",z2e="module",X2e="3.9.0",W2e="pnpm@8.15.6",H2e="Declarative ThreeJS using Vue Components",G2e="Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",Q2e="MIT",Y2e=["vue","3d","threejs","three","threejs-vue"],j2e=!1,q2e={".":{types:"./dist/index.d.ts",import:"./dist/tres.js",require:"./dist/tres.umd.cjs"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},Z2e="./dist/tres.js",K2e="./dist/tres.js",J2e="./dist/index.d.ts",eIe=["*.d.ts","dist"],tIe={access:"public"},iIe={dev:"cd playground && npm run dev",build:"vite build",playground:"cd playground && npm run dev",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui",release:"release-it",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts",prepare:"node .husky/install.mjs"},nIe={three:">=0.133",vue:">=3.3"},sIe={"@alvarosabu/utils":"^3.1.1","@vue/devtools-api":"^6.6.1","@vueuse/core":"^10.7.0"},rIe={"@release-it/conventional-changelog":"^8.0.1","@stackblitz/sdk":"^1.9.0","@tresjs/cientos":"3.8.0","@tresjs/eslint-config":"^1.0.0","@tresjs/eslint-config-vue":"^0.2.1","@types/three":"^0.163.0","@typescript-eslint/eslint-plugin":"^7.7.1","@typescript-eslint/parser":"^7.7.1","@vitejs/plugin-vue":"^5.0.4","@vitest/coverage-c8":"^0.33.0","@vitest/ui":"^1.5.0","@vue/test-utils":"^2.4.3",eslint:"^9.1.1","eslint-plugin-vue":"^9.25.0",esno:"^4.0.0",gsap:"^3.12.3",husky:"^9.0.11",jsdom:"^24.0.0",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^1.1.1","release-it":"^17.2.0","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.11.0",three:"^0.163.0",unocss:"^0.59.4",unplugin:"^1.10.1","unplugin-vue-components":"^0.26.0",vite:"^5.2.10","vite-plugin-banner":"^0.7.1","vite-plugin-dts":"3.9.0","vite-plugin-inspect":"^0.8.4","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.1.3",vitest:"^1.5.0",vue:"^3.4.24","vue-demi":"^0.14.6"},oIe={name:F2e,type:z2e,version:X2e,packageManager:W2e,description:H2e,author:G2e,license:Q2e,keywords:Y2e,sideEffects:j2e,exports:q2e,main:Z2e,module:K2e,types:J2e,files:eIe,publishConfig:tIe,scripts:iIe,peerDependencies:nIe,dependencies:sIe,devDependencies:rIe},aIe=({sizes:s,scene:e})=>{const i=gt([]),n=Es(()=>i.value[0]),r=l=>{const h=l instanceof Sb?l:i.value.find(f=>f.uuid===l);if(!h)return;const d=i.value.filter(({uuid:f})=>f!==h.uuid);i.value=[h,...d]},o=(l,h=!1)=>{i.value.some(({uuid:d})=>d===l.uuid)||(h?r(l):i.value.push(l))},a=l=>{i.value=i.value.filter(({uuid:h})=>h!==l.uuid)};return ru(()=>{s.aspectRatio.value&&i.value.forEach(l=>{l instanceof Rn&&(l.aspect=s.aspectRatio.value),(l instanceof Rn||l instanceof Ql)&&l.updateProjectionMatrix()})}),e.userData.tres__registerCamera=o,e.userData.tres__deregisterCamera=a,ra(()=>{i.value=[]}),{camera:n,cameras:i,registerCamera:o,deregisterCamera:a,setCameraActive:r}},yj=N_(),vj=N_(),RL=N_(),Zx=new EL;let QS=0,YS=0;const{pause:lIe,resume:cIe,isActive:hIe}=BL(()=>{yj.trigger({delta:QS,elapsed:YS,clock:Zx}),vj.trigger({delta:QS,elapsed:YS,clock:Zx}),RL.trigger({delta:QS,elapsed:YS,clock:Zx})},{immediate:!1});RL.on(()=>{QS=Zx.getDelta(),YS=Zx.getElapsedTime()});const Ly=()=>({onBeforeLoop:yj.on,onLoop:vj.on,onAfterLoop:RL.on,pause:lIe,resume:cIe,isActive:hIe}),gO="[TresJS   ] ";function DL(){function s(...n){typeof n[0]=="string"?n[0]=gO+n[0]:n.unshift(gO),console.error(...n)}function e(...n){typeof n[0]=="string"?n[0]=gO+n[0]:n.unshift(gO),console.warn(...n)}function i(n,r){}return{logError:s,logWarning:e,logMessage:i}}function uIe(s){return s instanceof ft?s:Array.isArray(s)?new ft(...s):new ft(s)}class dIe extends Dn{constructor(...e){super(...e),l6(this,"type","HightlightMesh"),l6(this,"createTime"),this.createTime=Date.now()}onBeforeRender(){const e=(Date.now()-this.createTime)/1e3,i=1+.07*Math.sin(2.5*e);this.scale.set(i,i,i)}}const xj=(s,e)=>{for(const i of Object.keys(e))e[i]instanceof Object&&Object.assign(e[i],xj(s[i],e[i]));return Object.assign(s||{},e),s},fIe="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",pIe=mIe(fIe);function c6(s){return s&&s.nodeType===1}function yO(s){return s.replace(/-([a-z])/g,(e,i)=>i.toUpperCase())}function mIe(s,e){const i=Object.create(null),n=s.split(",");for(let r=0;r<n.length;r++)i[n[r]]=!0;return r=>!!i[r]}const gIe=(s,e)=>{const i=new Set,n=[];for(const r of s){const o=e(r);i.has(o)||(i.add(o),n.push(r))}return n},h6=(s,e)=>{if(!e)return;const i=Array.isArray(e)?e:e.match(/([^[.\]])+/g);return i==null?void 0:i.reduce((n,r)=>n&&n[r],s)},yIe=(s,e,i)=>{const n=Array.isArray(e)?e:e.match(/([^[.\]])+/g);n&&n.reduce((r,o,a)=>(r[o]===void 0&&(r[o]={}),a===n.length-1&&(r[o]=i),r[o]),s)};function _j(s,e){if(c6(s)&&c6(e)){const r=s.attributes,o=e.attributes;return r.length!==o.length?!1:Array.from(r).every(({name:a,value:l})=>e.getAttribute(a)===l)}if(s===e)return!0;if(s===null||typeof s!="object"||e===null||typeof e!="object")return!1;const i=Object.keys(s),n=Object.keys(e);if(i.length!==n.length)return!1;for(const r of i)if(!n.includes(r)||!_j(s[r],e[r]))return!1;return!0}function vIe(s,e){if(!Array.isArray(s)||!Array.isArray(e)||s.length!==e.length)return!1;for(let i=0;i<s.length;i++)if(!_j(s[i],e[i]))return!1;return!0}const xIe=Array.isArray;function _Ie(s,e,i,n){const r=h=>{if(h.uuid===e)return h;for(const d of h.children){const f=r(d);if(f)return f}},o=r(s);if(!o){console.warn("Object with UUID not found in the scene.");return}let a=o;for(let h=0;h<i.length-1;h++)if(a[i[h]]!==void 0)a=a[i[h]];else{console.warn(`Property path is not valid: ${i.join(".")}`);return}const l=i[i.length-1];a[l]!==void 0?a[l]=n:console.warn(`Property path is not valid: ${i.join(".")}`)}function bIe(s){const e=new lc({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:Wo});return new dIe(s.geometry.clone(),e)}const wIe=Number.parseInt(My.replace("dev","")),vO={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:Ta,toneMapping:QD,toneMappingExposure:3,shadowMap:{enabled:!0,type:GD}}};function OIe({scene:s,canvas:e,options:i,disableRender:n,contextParts:{sizes:r,camera:o}}){const a=Es(()=>({alpha:Yn(i.alpha),depth:Yn(i.depth),canvas:Yl(e),context:Yn(i.context),stencil:Yn(i.stencil),antialias:Yn(i.antialias)===void 0?!0:Yn(i.antialias),precision:Yn(i.precision),powerPreference:Yn(i.powerPreference),premultipliedAlpha:Yn(i.premultipliedAlpha),preserveDrawingBuffer:Yn(i.preserveDrawingBuffer),logarithmicDepthBuffer:Yn(i.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:Yn(i.failIfMajorPerformanceCaveat)})),l=jr(new Qx(a.value));an(a,()=>{l.value.dispose(),l.value=new Qx(a.value)}),ru(()=>{l.value.setSize(r.width.value,r.height.value)});const{pixelRatio:h}=P2e();ru(()=>{l.value.setPixelRatio(h.value)});const{logError:d}=DL(),f=(()=>{const x=new Qx,_={shadowMap:{enabled:x.shadowMap.enabled,type:x.shadowMap.type},toneMapping:x.toneMapping,toneMappingExposure:x.toneMappingExposure,outputColorSpace:x.outputColorSpace};return x.dispose(),_})();ru(()=>{const x=Yn(i.preset);x&&(x in vO||d(`Renderer Preset must be one of these: ${Object.keys(vO).join(", ")}`),xj(l.value,vO[x]));const _=(T,C)=>{const A=Yn(T),B=()=>{if(x)return h6(vO[x],C)};if(A!==void 0)return A;const I=B();return I!==void 0?I:h6(f,C)},w=(T,C)=>yIe(l.value,C,_(T,C));w(i.shadows,"shadowMap.enabled"),w(i.toneMapping,"toneMapping"),w(i.shadowMapType,"shadowMap.type"),wIe<150&&w(!i.useLegacyLights,"physicallyCorrectLights"),w(i.outputColorSpace,"outputColorSpace"),w(i.toneMappingExposure,"toneMappingExposure");const O=_(i.clearColor,"clearColor");O&&l.value.setClearColor(O?uIe(O):new ft(0))});const{pause:p,resume:g,onLoop:y}=Ly();return y(()=>{o.value&&!Yn(n)&&l.value.render(s,o.value)}),g(),ra(()=>{p(),l.value.dispose(),l.value.forceContextLoss()}),{renderer:l}}const u6=s=>typeof s=="function";async function SIe(s,e){const i=new CL(e),n=r=>new Promise((o,a)=>{i.load(r,l=>o(l),()=>null,()=>{a(new Error("[useTextures] - Failed to load texture"))})});if(xIe(s)){const r=await Promise.all(s.map(o=>n(o)));return s.length>1?r:r[0]}else{const{map:r,displacementMap:o,normalMap:a,roughnessMap:l,metalnessMap:h,aoMap:d,alphaMap:f,matcap:p}=s;return{map:r?await n(r):null,displacementMap:o?await n(o):null,normalMap:a?await n(a):null,roughnessMap:l?await n(l):null,metalnessMap:h?await n(h):null,aoMap:d?await n(d):null,alphaMap:f?await n(f):null,matcap:p?await n(p):null}}}const CIe=(s,{renderer:e,camera:i,raycaster:n})=>{const r=Es(()=>e.value.domElement),{x:o,y:a}=N2e({target:r}),{width:l,height:h,top:d,left:f}=I2e(r),p=({x:R,y:P})=>{if(r.value)return{x:(R-f.value)/l.value*2-1,y:-((P-d.value)/h.value)*2+1}},g=({x:R,y:P})=>{if(i.value)return n.value.setFromCamera(new Fe(R,P),i.value),n.value.intersectObjects(s.value,!1)},y=R=>{const P=p({x:(R==null?void 0:R.clientX)??o.value,y:(R==null?void 0:R.clientY)??a.value});return P?g(P)||[]:[]},x=Es(()=>y()),_=N_(),w=N_(),O=(R,P)=>{R.trigger({event:P,intersects:y(P)})},T=R=>{O(w,R)};let C;const A=R=>{var P;C=(P=y(R)[0])==null?void 0:P.object},B=R=>{var P;R instanceof PointerEvent&&C===((P=y(R)[0])==null?void 0:P.object)&&O(_,R)},I=R=>w.trigger({event:R,intersects:[]});return r.value.addEventListener("pointerup",B),r.value.addEventListener("pointerdown",A),r.value.addEventListener("pointermove",T),r.value.addEventListener("pointerleave",I),ra(()=>{r!=null&&r.value&&(r.value.removeEventListener("pointerup",B),r.value.removeEventListener("pointerdown",A),r.value.removeEventListener("pointermove",T),r.value.removeEventListener("pointerleave",I))}),{intersects:x,onClick:R=>_.on(R).off,onPointerMove:R=>w.on(R).off}},TIe=({scene:s,contextParts:e})=>{const i=Tm({click:new Map,pointerMove:new Map,pointerEnter:new Map,pointerLeave:new Map}),n=gt(new Set),r=g=>{n.value.add(g)},o=g=>{n.value.delete(g)},a=g=>{Object.values(i).forEach(y=>y.delete(g)),o(g)},l=g=>{const{onClick:y,onPointerMove:x,onPointerEnter:_,onPointerLeave:w}=g;y&&i.click.set(g,y),x&&i.pointerMove.set(g,x),_&&i.pointerEnter.set(g,_),w&&i.pointerLeave.set(g,w)};s.userData.tres__registerAtPointerEventHandler=l,s.userData.tres__deregisterAtPointerEventHandler=a,s.userData.tres__registerBlockingObjectAtPointerEventHandler=r,s.userData.tres__deregisterBlockingObjectAtPointerEventHandler=o;const h=Es(()=>gIe([...Array.from(n.value),...Object.values(i).map(g=>Array.from(g.keys())).flat()],({uuid:g})=>g)),{onClick:d,onPointerMove:f}=CIe(h,e);d(({intersects:g,event:y})=>{var x;g.length&&((x=i.click.get(g[0].object))==null||x(g[0],y))});let p;return f(({intersects:g,event:y})=>{var x,_,w,O;const T=(x=g==null?void 0:g[0])==null?void 0:x.object,{pointerLeave:C,pointerEnter:A,pointerMove:B}=i;p&&p!==T&&((_=C.get(p))==null||_(p,y)),T&&(p!==T&&((w=A.get(T))==null||w(g[0],y)),(O=B.get(T))==null||O(g[0],y)),p=T||null}),{registerObject:l,deregisterObject:a}};function bj(s){let e=0;return s.traverse(i=>{if(i.isMesh&&i.geometry){const n=i.geometry,r=n.attributes.position.count*3*Float32Array.BYTES_PER_ELEMENT,o=n.index?n.index.count*Uint32Array.BYTES_PER_ELEMENT:0,a=n.attributes.normal?n.attributes.normal.count*3*Float32Array.BYTES_PER_ELEMENT:0,l=n.attributes.uv?n.attributes.uv.count*2*Float32Array.BYTES_PER_ELEMENT:0,h=r+o+a+l;e+=h}}),e}function AIe(s){return(s/1024).toFixed(2)}const VB=gt({}),LL=s=>Object.assign(VB.value,s);function EIe(s,e,i=10){const n=Yn(s)?V2e():B2e(Es(()=>Yn(e).parentElement)),r=rm(a6(n.width,i)),o=rm(a6(n.height,i)),a=Es(()=>r.value/o.value);return{height:o,width:r,aspectRatio:a}}function MIe({scene:s,canvas:e,windowSize:i,disableRender:n,rendererOptions:r}){const o=EIe(i,e),a=jr(s),{camera:l,cameras:h,registerCamera:d,deregisterCamera:f,setCameraActive:p}=aIe({sizes:o,scene:s}),{renderer:g}=OIe({scene:s,canvas:e,options:r,contextParts:{sizes:o,camera:l},disableRender:n}),y={sizes:o,scene:a,camera:l,cameras:rm(h),renderer:g,raycaster:jr(new PL),controls:gt(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},extend:LL,registerCamera:d,setCameraActive:p,deregisterCamera:f};f_("useTres",y);const x=100,_=R2e({every:x}),{isSupported:w,memory:O}=D2e({interval:x}),T=160;let C=performance.now();const A=({timestamp:P})=>{y.scene.value&&(y.perf.memory.allocatedMem=bj(y.scene.value)),P-C>=x&&(C=P,y.perf.fps.accumulator.push(_.value),y.perf.fps.accumulator.length>T&&y.perf.fps.accumulator.shift(),y.perf.fps.value=_.value,w.value&&O.value&&(y.perf.memory.accumulator.push(O.value.usedJSHeapSize/1024/1024),y.perf.memory.accumulator.length>T&&y.perf.memory.accumulator.shift(),y.perf.memory.currentMem=y.perf.memory.accumulator.reduce((k,E)=>k+E,0)/y.perf.memory.accumulator.length))};let B=0;const I=1,{pause:R}=BL(({delta:P})=>{window.__TRES__DEVTOOLS__&&(A({timestamp:performance.now()}),B+=P,B>=I&&(window.__TRES__DEVTOOLS__.cb(y),B=0))},{immediate:!0});return ra(()=>{R()}),y}function NL(){const s=k0("useTres");if(!s)throw new Error("useTresContext must be used together with useTresContextProvider");return s}let ws=null;const{logError:d6}=DL(),bP=["onClick","onPointerMove","onPointerEnter","onPointerLeave"],kIe={createElement(s,e,i,n){var r,o;if(n||(n={}),n.args||(n.args=[]),s==="template"||pIe(s))return null;let a=s.replace("Tres",""),l;if(s==="primitive"){(n==null?void 0:n.object)===void 0&&d6("Tres primitives need a prop 'object'");const h=n.object;a=h.type,l=Object.assign(h,{type:a,attach:n.attach,primitive:!0})}else{const h=VB.value[a];h||d6(`${a} is not defined on the THREE namespace. Use extend to add it to the catalog.`),l=new h(...n.args)}return l.isCamera&&(n!=null&&n.position||l.position.set(3,3,3),n!=null&&n.lookAt||l.lookAt(0,0,0)),(n==null?void 0:n.attach)===void 0&&(l.isMaterial?l.attach="material":l.isBufferGeometry&&(l.attach="geometry")),l.isObject3D&&((r=n==null?void 0:n.material)!=null&&r.isMaterial&&(l.userData.tres__materialViaProp=!0),(o=n==null?void 0:n.geometry)!=null&&o.isBufferGeometry&&(l.userData.tres__geometryViaProp=!0)),l.userData={...l.userData,tres__name:a},l},insert(s,e){var i,n,r,o;e&&e.isScene&&(ws=e);const a=e||ws;if(s!=null&&s.isObject3D){if(s!=null&&s.isCamera){if(!(ws!=null&&ws.userData.tres__registerCamera))throw new Error("could not find tres__registerCamera on scene's userData");(n=ws==null?void 0:(i=ws.userData).tres__registerCamera)==null||n.call(i,s)}if(s&&bP.some(l=>s[l])){if(!(ws!=null&&ws.userData.tres__registerAtPointerEventHandler))throw new Error("could not find tres__registerAtPointerEventHandler on scene's userData");(o=ws==null?void 0:(r=ws.userData).tres__registerAtPointerEventHandler)==null||o.call(r,s)}}s!=null&&s.isObject3D&&a!=null&&a.isObject3D?(a.add(s),s.dispatchEvent({type:"added"})):s!=null&&s.isFog?a.fog=s:typeof(s==null?void 0:s.attach)=="string"&&(s.__previousAttach=s[a==null?void 0:a.attach],a&&(a[s.attach]=s))},remove(s){var e,i;if(s){if(s.isObject3D){const n=s,r=d=>{var f,p;const g=d;d.userData.tres__materialViaProp||((f=g.material)==null||f.dispose(),g.material=void 0),d.userData.tres__geometryViaProp||((p=g.geometry)==null||p.dispose(),g.geometry=void 0)},o=ws==null?void 0:ws.userData.tres__deregisterAtPointerEventHandler,a=ws==null?void 0:ws.userData.tres__deregisterBlockingObjectAtPointerEventHandler,l=d=>{var f,p;if(!a)throw new Error("could not find tres__deregisterBlockingObjectAtPointerEventHandler on scene's userData");if((p=ws==null?void 0:(f=ws.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||p.call(f,d),!o)throw new Error("could not find tres__deregisterAtPointerEventHandler on scene's userData");d&&bP.some(g=>d[g])&&(o==null||o(d))},h=d=>{const f=ws==null?void 0:ws.userData.tres__deregisterCamera;if(!f)throw new Error("could not find tres__deregisterCamera on scene's userData");d.isCamera&&(f==null||f(d))};(e=s.removeFromParent)==null||e.call(s),n.traverse(d=>{r(d),h(d),l==null||l(d)}),r(n),h(n),l==null||l(n)}(i=s.dispose)==null||i.call(s)}},patchProp(s,e,i,n){var r,o,a,l;if(s){let h=s,d=e;if(s.isObject3D&&d==="blocks-pointer-events"){n||n===""?(o=ws==null?void 0:(r=ws.userData).tres__registerBlockingObjectAtPointerEventHandler)==null||o.call(r,s):(l=ws==null?void 0:(a=ws.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||l.call(a,s);return}let f=yO(d),p=h==null?void 0:h[f];if(d==="args"){const y=s,x=i??[],_=n??[],w=s.userData.tres__name||s.type;w&&x.length&&!vIe(x,_)&&(h=Object.assign(y,new VB.value[w](...n)));return}if(h.type==="BufferGeometry"){if(d==="args")return;h.setAttribute(yO(d),new rn(...n));return}if(d.includes("-")&&p===void 0){const y=d.split("-");p=y.reduce((x,_)=>x[yO(_)],h),d=y.pop(),f=d.toLowerCase(),p!=null&&p.set||(h=y.reduce((x,_)=>x[yO(_)],h))}let g=n;if(g===""&&(g=!0),u6(p)){bP.includes(e)||(Array.isArray(g)?s[f](...g):s[f](g));return}!(p!=null&&p.set)&&!u6(p)?h[f]=g:p.constructor===g.constructor&&p!=null&&p.copy?p==null||p.copy(g):Array.isArray(g)?p.set(...g):!p.isColor&&p.setScalar?p.setScalar(g):p.set(g)}},parentNode(s){return(s==null?void 0:s.parent)||null},createText:()=>{},createComment:()=>{},setText:()=>{},setElementText:()=>{},nextSibling:()=>{},querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}},{render:PIe}=vD(kIe);LL(y2e);function IIe(){return wj().__VUE_DEVTOOLS_GLOBAL_HOOK__}function wj(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const BIe=typeof Proxy=="function",RIe="devtools-plugin:setup",DIe="plugin:settings:set";let Gv,$B;function LIe(){var s;return Gv!==void 0||(typeof window<"u"&&window.performance?(Gv=!0,$B=window.performance):typeof globalThis<"u"&&!((s=globalThis.perf_hooks)===null||s===void 0)&&s.performance?(Gv=!0,$B=globalThis.perf_hooks.performance):Gv=!1),Gv}function NIe(){return LIe()?$B.now():Date.now()}class VIe{constructor(e,i){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=i;const n={};if(e.settings)for(const a in e.settings){const l=e.settings[a];n[a]=l.defaultValue}const r=`__vue-devtools-plugin-settings__${e.id}`;let o=Object.assign({},n);try{const a=localStorage.getItem(r),l=JSON.parse(a);Object.assign(o,l)}catch{}this.fallbacks={getSettings(){return o},setSettings(a){try{localStorage.setItem(r,JSON.stringify(a))}catch{}o=a},now(){return NIe()}},i&&i.on(DIe,(a,l)=>{a===this.plugin.id&&this.fallbacks.setSettings(l)}),this.proxiedOn=new Proxy({},{get:(a,l)=>this.target?this.target.on[l]:(...h)=>{this.onQueue.push({method:l,args:h})}}),this.proxiedTarget=new Proxy({},{get:(a,l)=>this.target?this.target[l]:l==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(l)?(...h)=>(this.targetQueue.push({method:l,args:h,resolve:()=>{}}),this.fallbacks[l](...h)):(...h)=>new Promise(d=>{this.targetQueue.push({method:l,args:h,resolve:d})})})}async setRealTarget(e){this.target=e;for(const i of this.onQueue)this.target.on[i.method](...i.args);for(const i of this.targetQueue)i.resolve(await this.target[i.method](...i.args))}}function $Ie(s,e){const i=s,n=wj(),r=IIe(),o=BIe&&i.enableEarlyProxy;if(r&&(n.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!o))r.emit(RIe,s,e);else{const a=o?new VIe(i,r):null;(n.__VUE_DEVTOOLS_PLUGINS__=n.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:i,setupFn:e,proxy:a}),a&&e(a.proxiedTarget)}}function UIe(s,e){const i=`  ${s}`;typeof __VUE_DEVTOOLS_TOAST__=="function"?__VUE_DEVTOOLS_TOAST__(i,e):console.log(i)}const Oj=s=>{const e={id:s.uuid,label:s.type,children:[],tags:[]};s.name!==""&&e.tags.push({label:s.name,textColor:5750629,backgroundColor:15793395});const i=bj(s);return i>0&&e.tags.push({label:`${AIe(i)} KB`,textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),s.type.includes("Light")&&(e.tags.push({label:`${s.intensity}`,textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),e.tags.push({label:`#${s.color.getHexString()}`,textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),s.type.includes("Camera")&&(e.tags.push({label:`${s.fov}`,textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),e.tags.push({label:`x: ${Math.round(s.position.x)} y: ${Math.round(s.position.y)} z: ${Math.round(s.position.z)}`,textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),e};function Sj(s,e){s.children.forEach(i=>{if(i.type==="HightlightMesh")return;const n=Oj(i);e.children.push(n),Sj(i,n)})}const FIe=[],Qv="tres:inspector",zIe=Tm({sceneGraph:null});function XIe(s,e){$Ie({id:"dev.esm.tres",label:"TresJS ",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://tresjs.org",componentStateTypes:FIe,app:s},i=>{typeof i.now!="function"&&UIe("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),i.addInspector({id:Qv,label:"TresJS ",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval(()=>{i.sendInspectorTree(Qv)},1e3),setInterval(()=>{i.notifyComponentUpdate()},5e3),i.on.getInspectorTree(o=>{if(o.inspectorId===Qv){const a=Oj(e.scene.value);Sj(e.scene.value,a),zIe.sceneGraph=a,o.rootNodes=[a]}});let n=null,r=null;i.on.getInspectorState(o=>{if(o.inspectorId===Qv){const[a]=e.scene.value.getObjectsByProperty("uuid",o.nodeId);if(!a)return;if(r&&n&&n.parent&&r.remove(n),a.isMesh){const l=bIe(a);a.add(l),n=l,r=a}o.state={object:[{key:"uuid",editable:!0,value:a.uuid},{key:"name",editable:!0,value:a.name},{key:"type",editable:!0,value:a.type},{key:"position",editable:!0,value:a.position},{key:"rotation",editable:!0,value:a.rotation},{key:"scale",editable:!0,value:a.scale},{key:"geometry",value:a.geometry},{key:"material",value:a.material},{key:"color",editable:!0,value:a.color},{key:"intensity",editable:!0,value:a.intensity},{key:"castShadow",editable:!0,value:a.castShadow},{key:"receiveShadow",editable:!0,value:a.receiveShadow},{key:"frustumCulled",editable:!0,value:a.frustumCulled},{key:"matrixAutoUpdate",editable:!0,value:a.matrixAutoUpdate},{key:"matrixWorldNeedsUpdate",editable:!0,value:a.matrixWorldNeedsUpdate},{key:"matrixWorld",value:a.matrixWorld},{key:"visible",editable:!0,value:a.visible}]}}}),i.on.editInspectorState(o=>{o.inspectorId===Qv&&_Ie(e.scene.value,o.nodeId,o.path,o.state.value)})})}const WIe=["data-scene","data-tres"],VL=fu({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},disableRender:{type:Boolean,default:void 0},context:{},precision:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},logarithmicDepthBuffer:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0}},setup(s,{expose:e}){var i;const n=s,r=mD(),{logWarning:o}=DL(),a=gt(),l=jr(new dy),{resume:h}=Ly(),d=(i=Na())==null?void 0:i.appContext.app,f=_=>fu({setup(){var w;const O=(w=Na())==null?void 0:w.appContext;return O&&(O.app=d),f_("useTres",_),f_("extend",LL),typeof window<"u"&&XIe(O.app,_),()=>vC(Un,null,r!=null&&r.default?r.default():[])}}),p=_=>{const w=f(_);PIe(vC(w),l.value)},g=(_,w=!1)=>{l.value.children=[],w&&(_.renderer.value.dispose(),_.renderer.value.renderLists.dispose(),_.renderer.value.forceContextLoss()),p(_),h()},y=Es(()=>n.disableRender),x=jr(null);return e({context:x,dispose:()=>g(x.value,!0)}),io(()=>{const _=a;x.value=MIe({scene:l.value,canvas:_,windowSize:n.windowSize,disableRender:y,rendererOptions:n}),TIe({scene:l.value,contextParts:x.value});const{registerCamera:w,camera:O,cameras:T,deregisterCamera:C}=x.value;p(x.value);const A=()=>{const B=new Rn(45,window.innerWidth/window.innerHeight,.1,1e3);B.position.set(3,3,3),B.lookAt(0,0,0),w(B);const I=ru(()=>{T.value.length>=2&&(B.removeFromParent(),C(B),I==null||I())})};an(()=>n.camera,(B,I)=>{B&&w(B),I&&(I.removeFromParent(),C(I))},{immediate:!0}),O.value||(o("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),A())}),(_,w)=>(di(),hn("canvas",{ref_key:"canvas",ref:a,"data-scene":l.value.uuid,class:Cy(_.$attrs.class),"data-tres":`tresjs ${ni(oIe).version}`,style:Au({display:"block",width:"100%",height:"100%",position:_.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",..._.$attrs.style})},null,14,WIe))}}),HIe={install(s){s.component("TresCanvas",VL)}};/*! Tweakpane 4.0.3 (c) 2016 cocopon, licensed under the MIT license. */function vs(s){return s==null}function $L(s){return s!==null&&typeof s=="object"}function UB(s){return s!==null&&typeof s=="object"}function GIe(s,e){if(s.length!==e.length)return!1;for(let i=0;i<s.length;i++)if(s[i]!==e[i])return!1;return!0}function ym(s,e){return Array.from(new Set([...Object.keys(s),...Object.keys(e)])).reduce((n,r)=>{const o=s[r],a=e[r];return UB(o)&&UB(a)?Object.assign(Object.assign({},n),{[r]:ym(o,a)}):Object.assign(Object.assign({},n),{[r]:r in e?a:o})},{})}function QIe(s){return $L(s)?"target"in s:!1}const YIe={alreadydisposed:()=>"View has been already disposed",invalidparams:s=>`Invalid parameters for '${s.name}'`,nomatchingcontroller:s=>`No matching controller for '${s.key}'`,nomatchingview:s=>`No matching view for '${JSON.stringify(s.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:s=>`Not compatible with  plugin '${s.id}'`,propertynotfound:s=>`Property '${s.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class Ma{static alreadyDisposed(){return new Ma({type:"alreadydisposed"})}static notBindable(){return new Ma({type:"notbindable"})}static notCompatible(e,i){return new Ma({type:"notcompatible",context:{id:`${e}.${i}`}})}static propertyNotFound(e){return new Ma({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new Ma({type:"shouldneverhappen"})}constructor(e){var i;this.message=(i=YIe[e.type](e.context))!==null&&i!==void 0?i:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class jC{constructor(e,i){this.obj_=e,this.key=i}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,i){const n=this.read();if(!jC.isBindable(n))throw Ma.notBindable();if(!(e in n))throw Ma.propertyNotFound(e);n[e]=i}}class Ua{constructor(){this.observers_={}}on(e,i,n){var r;let o=this.observers_[e];return o||(o=this.observers_[e]=[]),o.push({handler:i,key:(r=n==null?void 0:n.key)!==null&&r!==void 0?r:i}),this}off(e,i){const n=this.observers_[e];return n&&(this.observers_[e]=n.filter(r=>r.key!==i)),this}emit(e,i){const n=this.observers_[e];n&&n.forEach(r=>{r.handler(i)})}}class jIe{constructor(e,i){var n;this.constraint_=i==null?void 0:i.constraint,this.equals_=(n=i==null?void 0:i.equals)!==null&&n!==void 0?n:(r,o)=>r===o,this.emitter=new Ua,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,i){const n=i??{forceEmit:!1,last:!0},r=this.constraint_?this.constraint_.constrain(e):e,o=this.rawValue_;this.equals_(o,r)&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=r,this.emitter.emit("change",{options:n,previousRawValue:o,rawValue:r,sender:this}))}}class qIe{constructor(e){this.emitter=new Ua,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,i){const n=i??{forceEmit:!1,last:!0},r=this.value_;r===e&&!n.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:n,previousRawValue:r,rawValue:this.value_,sender:this}))}}class ZIe{constructor(e){this.emitter=new Ua,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function Sr(s,e){const i=e==null?void 0:e.constraint,n=e==null?void 0:e.equals;return!i&&!n?new qIe(s):new jIe(s,e)}function KIe(s){return[new ZIe(s),(e,i)=>{s.setRawValue(e,i)}]}class wn{constructor(e){this.emitter=new Ua,this.valMap_=e;for(const i in this.valMap_)this.valMap_[i].emitter.on("change",()=>{this.emitter.emit("change",{key:i,sender:this})})}static createCore(e){return Object.keys(e).reduce((n,r)=>Object.assign(n,{[r]:Sr(e[r])}),{})}static fromObject(e){const i=this.createCore(e);return new wn(i)}get(e){return this.valMap_[e].rawValue}set(e,i){this.valMap_[e].rawValue=i}value(e){return this.valMap_[e]}}class WA{constructor(e){this.values=wn.fromObject({max:e.max,min:e.min})}constrain(e){const i=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(e,n),i)}}class JIe{constructor(e){this.values=wn.fromObject({max:e.max,min:e.min})}constrain(e){const i=this.values.get("max"),n=this.values.get("min");let r=e;return vs(n)||(r=Math.max(r,n)),vs(i)||(r=Math.min(r,i)),r}}class eBe{constructor(e,i=0){this.step=e,this.origin=i}constrain(e){const i=this.origin%this.step,n=Math.round((e-i)/this.step);return i+n*this.step}}class tBe{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const iBe={"**":(s,e)=>Math.pow(s,e),"*":(s,e)=>s*e,"/":(s,e)=>s/e,"%":(s,e)=>s%e,"+":(s,e)=>s+e,"-":(s,e)=>s-e,"<<":(s,e)=>s<<e,">>":(s,e)=>s>>e,">>>":(s,e)=>s>>>e,"&":(s,e)=>s&e,"^":(s,e)=>s^e,"|":(s,e)=>s|e};class nBe{constructor(e,i,n){this.left=i,this.operator=e,this.right=n}evaluate(){const e=iBe[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const sBe={"+":s=>s,"-":s=>-s,"~":s=>~s};class rBe{constructor(e,i){this.operator=e,this.expression=i}evaluate(){const e=sBe[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function UL(s){return(e,i)=>{for(let n=0;n<s.length;n++){const r=s[n](e,i);if(r!=="")return r}return""}}function $_(s,e){var i;const n=s.substr(e).match(/^\s+/);return(i=n&&n[0])!==null&&i!==void 0?i:""}function oBe(s,e){const i=s.substr(e,1);return i.match(/^[1-9]$/)?i:""}function U_(s,e){var i;const n=s.substr(e).match(/^[0-9]+/);return(i=n&&n[0])!==null&&i!==void 0?i:""}function aBe(s,e){const i=U_(s,e);if(i!=="")return i;const n=s.substr(e,1);if(e+=1,n!=="-"&&n!=="+")return"";const r=U_(s,e);return r===""?"":n+r}function FL(s,e){const i=s.substr(e,1);if(e+=1,i.toLowerCase()!=="e")return"";const n=aBe(s,e);return n===""?"":i+n}function Cj(s,e){const i=s.substr(e,1);if(i==="0")return i;const n=oBe(s,e);return e+=n.length,n===""?"":n+U_(s,e)}function lBe(s,e){const i=Cj(s,e);if(e+=i.length,i==="")return"";const n=s.substr(e,1);if(e+=n.length,n!==".")return"";const r=U_(s,e);return e+=r.length,i+n+r+FL(s,e)}function cBe(s,e){const i=s.substr(e,1);if(e+=i.length,i!==".")return"";const n=U_(s,e);return e+=n.length,n===""?"":i+n+FL(s,e)}function hBe(s,e){const i=Cj(s,e);return e+=i.length,i===""?"":i+FL(s,e)}const uBe=UL([lBe,cBe,hBe]);function dBe(s,e){var i;const n=s.substr(e).match(/^[01]+/);return(i=n&&n[0])!==null&&i!==void 0?i:""}function fBe(s,e){const i=s.substr(e,2);if(e+=i.length,i.toLowerCase()!=="0b")return"";const n=dBe(s,e);return n===""?"":i+n}function pBe(s,e){var i;const n=s.substr(e).match(/^[0-7]+/);return(i=n&&n[0])!==null&&i!==void 0?i:""}function mBe(s,e){const i=s.substr(e,2);if(e+=i.length,i.toLowerCase()!=="0o")return"";const n=pBe(s,e);return n===""?"":i+n}function gBe(s,e){var i;const n=s.substr(e).match(/^[0-9a-f]+/i);return(i=n&&n[0])!==null&&i!==void 0?i:""}function yBe(s,e){const i=s.substr(e,2);if(e+=i.length,i.toLowerCase()!=="0x")return"";const n=gBe(s,e);return n===""?"":i+n}const vBe=UL([fBe,mBe,yBe]),xBe=UL([vBe,uBe]);function _Be(s,e){const i=xBe(s,e);return e+=i.length,i===""?null:{evaluable:new tBe(i),cursor:e}}function bBe(s,e){const i=s.substr(e,1);if(e+=i.length,i!=="(")return null;const n=Aj(s,e);if(!n)return null;e=n.cursor,e+=$_(s,e).length;const r=s.substr(e,1);return e+=r.length,r!==")"?null:{evaluable:n.evaluable,cursor:e}}function wBe(s,e){var i;return(i=_Be(s,e))!==null&&i!==void 0?i:bBe(s,e)}function Tj(s,e){const i=wBe(s,e);if(i)return i;const n=s.substr(e,1);if(e+=n.length,n!=="+"&&n!=="-"&&n!=="~")return null;const r=Tj(s,e);return r?(e=r.cursor,{cursor:e,evaluable:new rBe(n,r.evaluable)}):null}function OBe(s,e,i){i+=$_(e,i).length;const n=s.filter(r=>e.startsWith(r,i))[0];return n?(i+=n.length,i+=$_(e,i).length,{cursor:i,operator:n}):null}function SBe(s,e){return(i,n)=>{const r=s(i,n);if(!r)return null;n=r.cursor;let o=r.evaluable;for(;;){const a=OBe(e,i,n);if(!a)break;n=a.cursor;const l=s(i,n);if(!l)return null;n=l.cursor,o=new nBe(a.operator,o,l.evaluable)}return o?{cursor:n,evaluable:o}:null}}const CBe=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((s,e)=>SBe(s,e),Tj);function Aj(s,e){return e+=$_(s,e).length,CBe(s,e)}function TBe(s){const e=Aj(s,0);return!e||e.cursor+$_(s,e.cursor).length!==s.length?null:e.evaluable}function sf(s){var e;const i=TBe(s);return(e=i==null?void 0:i.evaluate())!==null&&e!==void 0?e:null}function Ej(s){if(typeof s=="number")return s;if(typeof s=="string"){const e=sf(s);if(!vs(e))return e}return 0}function na(s){return e=>e.toFixed(Math.max(Math.min(s,20),0))}function An(s,e,i,n,r){const o=(s-e)/(i-e);return n+o*(r-n)}function f6(s){return String(s.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function lr(s,e,i){return Math.min(Math.max(s,e),i)}function Mj(s,e){return(s%e+e)%e}function ABe(s,e){return vs(s.step)?Math.max(f6(e),2):f6(s.step)}function kj(s){var e;return(e=s.step)!==null&&e!==void 0?e:1}function EBe(s,e){var i;const n=Math.abs((i=s.step)!==null&&i!==void 0?i:e);return n===0?.1:Math.pow(10,Math.floor(Math.log10(n))-1)}function Pj(s,e){return vs(s.step)?null:new eBe(s.step,e)}function Ij(s){return!vs(s.max)&&!vs(s.min)?new WA({max:s.max,min:s.min}):!vs(s.max)||!vs(s.min)?new JIe({max:s.max,min:s.min}):null}function Bj(s,e){var i,n,r;return{formatter:(i=s.format)!==null&&i!==void 0?i:na(ABe(s,e)),keyScale:(n=s.keyScale)!==null&&n!==void 0?n:kj(s),pointerScale:(r=s.pointerScale)!==null&&r!==void 0?r:EBe(s,e)}}function Rj(s){return{format:s.optional.function,keyScale:s.optional.number,max:s.optional.number,min:s.optional.number,pointerScale:s.optional.number,step:s.optional.number}}function zL(s){return{constraint:s.constraint,textProps:wn.fromObject(Bj(s.params,s.initialValue))}}class XL{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class HA{constructor(e){this.target=e}}class Dj extends HA{constructor(e,i,n){super(e),this.value=i,this.last=n??!0}}class MBe extends HA{constructor(e,i){super(e),this.expanded=i}}class kBe extends HA{constructor(e,i){super(e),this.index=i}}class PBe extends HA{constructor(e,i){super(e),this.native=i}}class WL extends XL{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Ua,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,i){const n=i.bind(this);return this.emitter_.on(e,r=>{n(r)},{key:i}),this}off(e,i){return this.emitter_.off(e,i),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const i=this.controller.value;this.emitter_.emit("change",new Dj(this,i.binding.target.read(),e.options.last))}}function IBe(s,e){const n=Object.keys(e).reduce((r,o)=>{if(r===void 0)return;const a=e[o],l=a(s[o]);return l.succeeded?Object.assign(Object.assign({},r),{[o]:l.value}):void 0},{});return n}function BBe(s,e){return s.reduce((i,n)=>{if(i===void 0)return;const r=e(n);if(!(!r.succeeded||r.value===void 0))return[...i,r.value]},[])}function RBe(s){return s===null?!1:typeof s=="object"}function Ih(s){return e=>i=>{if(!e&&i===void 0)return{succeeded:!1,value:void 0};if(e&&i===void 0)return{succeeded:!0,value:void 0};const n=s(i);return n!==void 0?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function p6(s){return{custom:e=>Ih(e)(s),boolean:Ih(e=>typeof e=="boolean"?e:void 0)(s),number:Ih(e=>typeof e=="number"?e:void 0)(s),string:Ih(e=>typeof e=="string"?e:void 0)(s),function:Ih(e=>typeof e=="function"?e:void 0)(s),constant:e=>Ih(i=>i===e?e:void 0)(s),raw:Ih(e=>e)(s),object:e=>Ih(i=>{if(RBe(i))return IBe(i,e)})(s),array:e=>Ih(i=>{if(Array.isArray(i))return BBe(i,e)})(s)}}const FB={optional:p6(!0),required:p6(!1)};function so(s,e){const i=e(FB),n=FB.required.object(i)(s);return n.succeeded?n.value:void 0}function uh(s,e,i,n){if(e&&!e(s))return!1;const r=so(s,i);return r?n(r):!1}function dh(s,e){var i;return ym((i=s==null?void 0:s())!==null&&i!==void 0?i:{},e)}function jS(s){return"value"in s}function DBe(s){if(!$L(s)||!("binding"in s))return!1;const e=s.binding;return QIe(e)}const Yc="http://www.w3.org/2000/svg";function qC(s){s.offsetHeight}function LBe(s,e){const i=s.style.transition;s.style.transition="none",e(),s.style.transition=i}function HL(s){return s.ontouchstart!==void 0}function NBe(s){const e=s.ownerDocument.defaultView;return e&&"document"in e?s.getContext("2d",{willReadFrequently:!0}):null}const VBe={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function GA(s,e){const i=s.createElementNS(Yc,"svg");return i.innerHTML=VBe[e],i}function Lj(s,e,i){s.insertBefore(e,s.children[i])}function GL(s){s.parentElement&&s.parentElement.removeChild(s)}function Nj(s){for(;s.children.length>0;)s.removeChild(s.children[0])}function $Be(s){for(;s.childNodes.length>0;)s.removeChild(s.childNodes[0])}function Vj(s){return s.relatedTarget?s.relatedTarget:"explicitOriginalTarget"in s?s.explicitOriginalTarget:null}function hu(s,e){s.emitter.on("change",i=>{e(i.rawValue)}),e(s.rawValue)}function sh(s,e,i){hu(s.value(e),i)}const UBe="tp";function On(s){return(i,n)=>[UBe,"-",s,"v",i?`_${i}`:"",n?`-${n}`:""].join("")}const Yv=On("lbl");function FBe(s,e){const i=s.createDocumentFragment();return e.split(`
`).map(r=>s.createTextNode(r)).forEach((r,o)=>{o>0&&i.appendChild(s.createElement("br")),i.appendChild(r)}),i}class zBe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(Yv()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Yv("l")),sh(i.props,"label",o=>{vs(o)?this.element.classList.add(Yv(void 0,"nol")):(this.element.classList.remove(Yv(void 0,"nol")),$Be(n),n.appendChild(FBe(e,o)))}),this.element.appendChild(n),this.labelElement=n;const r=e.createElement("div");r.classList.add(Yv("v")),this.element.appendChild(r),this.valueElement=r}}class XBe{constructor(e,i){this.props=i.props,this.valueController=i.valueController,this.viewProps=i.valueController.viewProps,this.view=new zBe(e,{props:i.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return uh(e,null,i=>({label:i.optional.string}),i=>(this.props.set("label",i.label),!0))}exportProps(){return dh(null,{label:this.props.get("label")})}}function WBe(){return["veryfirst","first","last","verylast"]}const m6=On(""),g6={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class $j{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const i=this.view.element;this.blade.value("positions").emitter.on("change",()=>{WBe().forEach(n=>{i.classList.remove(m6(void 0,g6[n]))}),this.blade.get("positions").forEach(n=>{i.classList.add(m6(void 0,g6[n]))})}),this.viewProps.handleDispose(()=>{GL(i)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return uh(e,null,i=>({disabled:i.required.boolean,hidden:i.required.boolean}),i=>(this.viewProps.importState(i),!0))}exportState(){return dh(null,Object.assign({},this.viewProps.exportState()))}}class HBe extends XL{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,i){const n=i.bind(this);return this.controller.buttonController.emitter.on(e,o=>{n(new PBe(this,o.nativeEvent))}),this}off(e,i){return this.controller.buttonController.emitter.off(e,i),this}}function GBe(s,e,i){i?s.classList.add(e):s.classList.remove(e)}function Ny(s,e){return i=>{GBe(s,e,i)}}function QL(s,e){hu(s,i=>{e.textContent=i??""})}const wP=On("btn");class QBe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(wP()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(wP("b")),i.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const r=e.createElement("div");r.classList.add(wP("t")),QL(i.props.value("title"),r),this.buttonElement.appendChild(r)}}class YBe{constructor(e,i){this.emitter=new Ua,this.onClick_=this.onClick_.bind(this),this.props=i.props,this.viewProps=i.viewProps,this.view=new QBe(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return uh(e,null,i=>({title:i.optional.string}),i=>(this.props.set("title",i.title),!0))}exportProps(){return dh(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}}class y6 extends $j{constructor(e,i){const n=new YBe(e,{props:i.buttonProps,viewProps:i.viewProps}),r=new XBe(e,{blade:i.blade,props:i.labelProps,valueController:n});super({blade:i.blade,view:r.view,viewProps:i.viewProps}),this.buttonController=n,this.labelController=r}importState(e){return uh(e,i=>super.importState(i)&&this.buttonController.importProps(i)&&this.labelController.importProps(i),()=>({}),()=>!0)}exportState(){return dh(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class Uj{constructor(e){const[i,n]=e.split("-"),r=i.split(".");this.major=parseInt(r[0],10),this.minor=parseInt(r[1],10),this.patch=parseInt(r[2],10),this.prerelease=n??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}}const jBe=new Uj("2.0.3");function Mo(s){return Object.assign({core:jBe},s)}Mo({id:"button",type:"blade",accept(s){const e=so(s,i=>({title:i.required.string,view:i.required.constant("button"),label:i.optional.string}));return e?{params:e}:null},controller(s){return new y6(s.document,{blade:s.blade,buttonProps:wn.fromObject({title:s.params.title}),labelProps:wn.fromObject({label:s.params.label}),viewProps:s.viewProps})},api(s){return s.controller instanceof y6?new HBe(s.controller):null}});function qBe(s,e){return s.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function ZBe(s,e){return s.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function KBe(s,e){return s.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function JBe(s){return $L(s)?"refresh"in s&&typeof s.refresh=="function":!1}function eRe(s,e){if(!jC.isBindable(s))throw Ma.notBindable();return new jC(s,e)}class tRe{constructor(e,i){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Ua,this.pool_=i,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,i,n){const r=n??{},o=this.controller_.element.ownerDocument,a=this.pool_.createBinding(o,eRe(e,i),r),l=this.pool_.createBindingApi(a);return this.add(l,r.index)}addFolder(e){return ZBe(this,e)}addButton(e){return qBe(this,e)}addTab(e){return KBe(this,e)}add(e,i){const n=e.controller;return this.controller_.rack.add(n,i),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const i=this.controller_.element.ownerDocument,n=this.pool_.createBlade(i,e),r=this.pool_.createApi(n);return this.add(r,e.index)}on(e,i){const n=i.bind(this);return this.emitter_.on(e,r=>{n(r)},{key:i}),this}off(e,i){return this.emitter_.off(e,i),this}refresh(){this.children.forEach(e=>{JBe(e)&&e.refresh()})}onRackValueChange_(e){const i=e.bladeController,n=this.pool_.createApi(i),r=DBe(i.value)?i.value.binding:null;this.emitter_.emit("change",new Dj(n,r?r.target.read():i.value.rawValue,e.options.last))}}class YL extends XL{constructor(e,i){super(e),this.rackApi_=new tRe(e.rackController,i)}refresh(){this.rackApi_.refresh()}}class jL extends $j{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return uh(e,i=>super.importState(i),i=>({children:i.required.array(i.required.raw)}),i=>this.rackController.rack.children.every((n,r)=>n.importState(i.children[r])))}exportState(){return dh(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}}function zB(s){return"rackController"in s}class iRe{constructor(e){this.emitter=new Ua,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const i of this.allItems())if(e(i))return i;return null}includes(e){return this.cache_.has(e)}add(e,i){if(this.includes(e))throw Ma.shouldNeverHappen();const n=i!==void 0?i:this.items_.length;this.items_.splice(n,0,e),this.cache_.add(e);const r=this.extract_(e);r&&(r.emitter.on("add",this.onSubListAdd_),r.emitter.on("remove",this.onSubListRemove_),r.allItems().forEach(o=>{this.cache_.add(o)})),this.emitter.emit("add",{index:n,item:e,root:this,target:this})}remove(e){const i=this.items_.indexOf(e);if(i<0)return;this.items_.splice(i,1),this.cache_.delete(e);const n=this.extract_(e);n&&(n.allItems().forEach(r=>{this.cache_.delete(r)}),n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:i,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function nRe(s,e){for(let i=0;i<s.length;i++){const n=s[i];if(jS(n)&&n.value===e)return n}return null}function sRe(s){return zB(s)?s.rackController.rack.bcSet_:null}class rRe{constructor(e){var i,n;this.emitter=new Ua,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(i=e.blade)!==null&&i!==void 0?i:null,(n=this.blade_)===null||n===void 0||n.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new iRe(sRe),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,i){var n;(n=e.parent)===null||n===void 0||n.remove(e),e.parent=this,this.bcSet_.add(e,i)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const i=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:i,sender:this}),!i)return;const n=e.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),jS(n))n.value.emitter.on("change",this.onChildValueChange_);else if(zB(n)){const r=n.rackController.rack;if(r){const o=r.emitter;o.on("layout",this.onRackLayout_),o.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const i=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:i,sender:this}),!i)return;const n=e.item;if(jS(n))n.value.emitter.off("change",this.onChildValueChange_);else if(zB(n)){const r=n.rackController.rack;if(r){const o=r.emitter;o.off("layout",this.onRackLayout_),o.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(r=>!r.viewProps.get("hidden")),i=e[0],n=e[e.length-1];this.bcSet_.items.forEach(r=>{const o=[];r===i&&(o.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&o.push("veryfirst")),r===n&&(o.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&o.push("verylast")),r.blade.set("positions",o)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(i=>i.viewProps.get("disposed")).forEach(i=>{this.bcSet_.remove(i)})}onChildValueChange_(e){const i=nRe(this.find(jS),e.sender);if(!i)throw Ma.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:i,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class qL{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const i=new rRe({blade:e.root?void 0:e.blade,viewProps:e.viewProps});i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),this.rack=i,this.viewProps.handleDispose(()=>{for(let n=this.rack.children.length-1;n>=0;n--)this.rack.children[n].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&Lj(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&GL(e.bladeController.view.element)}}function Fj(){return new wn({positions:Sr([],{equals:GIe})})}class Ib extends wn{constructor(e){super(e)}static create(e){const i={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=wn.createCore(i);return new Ib(n)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!vs(e)?`${e}px`:"auto"}bindExpandedClass(e,i){const n=()=>{this.styleExpanded?e.classList.add(i):e.classList.remove(i)};sh(this,"expanded",n),sh(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function oRe(s,e){let i=0;return LBe(e,()=>{s.set("expandedHeight",null),s.set("temporaryExpanded",!0),qC(e),i=e.clientHeight,s.set("temporaryExpanded",null),qC(e)}),i}function v6(s,e){e.style.height=s.styleHeight}function ZL(s,e){s.value("expanded").emitter.on("beforechange",()=>{if(s.set("completed",!1),vs(s.get("expandedHeight"))){const i=oRe(s,e);i>0&&s.set("expandedHeight",i)}s.set("shouldFixHeight",!0),qC(e)}),s.emitter.on("change",()=>{v6(s,e)}),v6(s,e),e.addEventListener("transitionend",i=>{i.propertyName==="height"&&s.cleanUpTransition()})}class aRe extends YL{constructor(e,i){super(e,i),this.emitter_=new Ua,this.controller.foldable.value("expanded").emitter.on("change",n=>{this.emitter_.emit("fold",new MBe(this,n.sender.rawValue))}),this.rackApi_.on("change",n=>{this.emitter_.emit("change",n)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,i,n){return this.rackApi_.addBinding(e,i,n)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,i){return this.rackApi_.add(e,i)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,i){const n=i.bind(this);return this.emitter_.on(e,r=>{n(r)},{key:i}),this}off(e,i){return this.emitter_.off(e,i),this}}const zj=On("cnt");class lRe{constructor(e,i){var n;this.className_=On((n=i.viewName)!==null&&n!==void 0?n:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),zj()),i.viewProps.bindClassModifiers(this.element),this.foldable_=i.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),sh(this.foldable_,"completed",Ny(this.element,this.className_(void 0,"cpl")));const r=e.createElement("button");r.classList.add(this.className_("b")),sh(i.props,"title",d=>{vs(d)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),i.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;const o=e.createElement("div");o.classList.add(this.className_("i")),this.element.appendChild(o);const a=e.createElement("div");a.classList.add(this.className_("t")),QL(i.props.value("title"),a),this.buttonElement.appendChild(a),this.titleElement=a;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const h=e.createElement("div");h.classList.add(this.className_("c")),this.element.appendChild(h),this.containerElement=h}}class x6 extends jL{constructor(e,i){var n;const r=Ib.create((n=i.expanded)!==null&&n!==void 0?n:!0),o=new lRe(e,{foldable:r,props:i.props,viewName:i.root?"rot":void 0,viewProps:i.viewProps});super(Object.assign(Object.assign({},i),{rackController:new qL({blade:i.blade,element:o.containerElement,root:i.root,viewProps:i.viewProps}),view:o})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=i.props,this.foldable=r,ZL(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return uh(e,i=>super.importState(i),i=>({expanded:i.required.boolean,title:i.optional.string}),i=>(this.foldable.set("expanded",i.expanded),this.props.set("title",i.title),!0))}exportState(){return dh(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}Mo({id:"folder",type:"blade",accept(s){const e=so(s,i=>({title:i.required.string,view:i.required.constant("folder"),expanded:i.optional.boolean}));return e?{params:e}:null},controller(s){return new x6(s.document,{blade:s.blade,expanded:s.params.expanded,props:wn.fromObject({title:s.params.title}),viewProps:s.viewProps})},api(s){return s.controller instanceof x6?new aRe(s.controller,s.pool):null}});const cRe=On("");function _6(s,e){return Ny(s,cRe(void 0,e))}class Bb extends wn{constructor(e){var i;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=KIe(Sr(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(i=this.get("parent"))===null||i===void 0||i.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var i,n,r;const o=e??{};return new Bb(wn.createCore({disabled:(i=o.disabled)!==null&&i!==void 0?i:!1,disposed:!1,hidden:(n=o.hidden)!==null&&n!==void 0?n:!1,parent:(r=o.parent)!==null&&r!==void 0?r:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){hu(this.globalDisabled_,_6(e,"disabled")),sh(this,"hidden",_6(e,"hidden"))}bindDisabled(e){hu(this.globalDisabled_,i=>{e.disabled=i})}bindTabIndex(e){hu(this.globalDisabled_,i=>{e.tabIndex=i?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",i=>{i&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var i;const n=e.previousRawValue;n==null||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(i=this.get("parent"))===null||i===void 0||i.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const b6=On("tbp");class hRe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(b6()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(b6("c")),this.element.appendChild(n),this.containerElement=n}}const jv=On("tbi");class uRe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(jv()),i.viewProps.bindClassModifiers(this.element),sh(i.props,"selected",o=>{o?this.element.classList.add(jv(void 0,"sel")):this.element.classList.remove(jv(void 0,"sel"))});const n=e.createElement("button");n.classList.add(jv("b")),i.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const r=e.createElement("div");r.classList.add(jv("t")),QL(i.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r}}class dRe{constructor(e,i){this.emitter=new Ua,this.onClick_=this.onClick_.bind(this),this.props=i.props,this.viewProps=i.viewProps,this.view=new uRe(e,{props:i.props,viewProps:i.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class XB extends jL{constructor(e,i){const n=new hRe(e,{viewProps:i.viewProps});super(Object.assign(Object.assign({},i),{rackController:new qL({blade:i.blade,element:n.containerElement,viewProps:i.viewProps}),view:n})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new dRe(e,{props:i.itemProps,viewProps:Bb.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=i.props,sh(this.props,"selected",r=>{this.itemController.props.set("selected",r),this.viewProps.set("hidden",!r)})}get itemController(){return this.ic_}importState(e){return uh(e,i=>super.importState(i),i=>({selected:i.required.boolean,title:i.required.string}),i=>(this.ic_.props.set("selected",i.selected),this.ic_.props.set("title",i.title),!0))}exportState(){return dh(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class fRe extends YL{constructor(e,i){super(e,i),this.emitter_=new Ua,this.onSelect_=this.onSelect_.bind(this),this.pool_=i,this.rackApi_.on("change",n=>{this.emitter_.emit("change",n)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const i=this.controller.view.element.ownerDocument,n=new XB(i,{blade:Fj(),itemProps:wn.fromObject({selected:!1,title:e.title}),props:wn.fromObject({selected:!1}),viewProps:Bb.create()}),r=this.pool_.createApi(n);return this.rackApi_.add(r,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,i){const n=i.bind(this);return this.emitter_.on(e,r=>{n(r)},{key:i}),this}off(e,i){return this.emitter_.off(e,i),this}onSelect_(e){this.emitter_.emit("select",new kBe(this,e.rawValue))}}class pRe extends YL{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,i){this.rackApi_.add(e,i)}remove(e){this.rackApi_.remove(e)}addBinding(e,i,n){return this.rackApi_.addBinding(e,i,n)}addBlade(e){return this.rackApi_.addBlade(e)}}const w6=-1;class mRe{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=Sr(!0),this.selectedIndex=Sr(w6),this.items_=[]}add(e,i){const n=i??this.items_.length;this.items_.splice(n,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const i=this.items_.indexOf(e);i<0||(this.items_.splice(i,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=w6,this.empty.rawValue=!0;return}const e=this.items_.findIndex(i=>i.rawValue);e<0?(this.items_.forEach((i,n)=>{i.rawValue=n===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((i,n)=>{i.rawValue=n===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const i=this.items_.findIndex(n=>n===e.sender);this.items_.forEach((n,r)=>{n.rawValue=r===i}),this.selectedIndex.rawValue=i}else this.keepSelection_()}}const qv=On("tab");class gRe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(qv(),zj()),i.viewProps.bindClassModifiers(this.element),hu(i.empty,Ny(this.element,qv(void 0,"nop")));const n=e.createElement("div");n.classList.add(qv("t")),this.element.appendChild(n),this.itemsElement=n;const r=e.createElement("div");r.classList.add(qv("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(qv("c")),this.element.appendChild(o),this.contentsElement=o}}class O6 extends jL{constructor(e,i){const n=new mRe,r=new gRe(e,{empty:n.empty,viewProps:i.viewProps});super({blade:i.blade,rackController:new qL({blade:i.blade,element:r.contentsElement,viewProps:i.viewProps}),view:r}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const o=this.rackController.rack;o.emitter.on("add",this.onRackAdd_),o.emitter.on("remove",this.onRackRemove_),this.tab=n}add(e,i){this.rackController.rack.add(e,i)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const i=e.bladeController;Lj(this.view.itemsElement,i.itemController.view.element,e.index),i.itemController.viewProps.set("parent",this.viewProps),this.tab.add(i.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const i=e.bladeController;GL(i.itemController.view.element),i.itemController.viewProps.set("parent",null),this.tab.remove(i.props.value("selected"))}}Mo({id:"tab",type:"blade",accept(s){const e=so(s,i=>({pages:i.required.array(i.required.object({title:i.required.string})),view:i.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(s){const e=new O6(s.document,{blade:s.blade,viewProps:s.viewProps});return s.params.pages.forEach(i=>{const n=new XB(s.document,{blade:Fj(),itemProps:wn.fromObject({selected:!1,title:i.title}),props:wn.fromObject({selected:!1}),viewProps:Bb.create()});e.add(n)}),e},api(s){return s.controller instanceof O6?new fRe(s.controller,s.pool):s.controller instanceof XB?new pRe(s.controller,s.pool):null}});class KL extends WL{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class Rb{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((i,n)=>n.constrain(i),e)}}function ZC(s,e){if(s instanceof e)return s;if(s instanceof Rb){const i=s.constraints.reduce((n,r)=>n||(r instanceof e?r:null),null);if(i)return i}return null}class QA{constructor(e){this.values=wn.fromObject({options:e})}constrain(e){const i=this.values.get("options");return i.length===0||i.filter(r=>r.value===e).length>0?e:i[0].value}}function YA(s){var e;const i=FB;if(Array.isArray(s))return(e=so({items:s},n=>({items:n.required.array(n.required.object({text:n.required.string,value:n.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof s=="object")return i.required.raw(s).value}function Xj(s){if(Array.isArray(s))return s;const e=[];return Object.keys(s).forEach(i=>{e.push({text:i,value:s[i]})}),e}function JL(s){return vs(s)?null:new QA(Xj(s))}const OP=On("lst");class yRe{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.props_=i.props,this.element=e.createElement("div"),this.element.classList.add(OP()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("select");n.classList.add(OP("s")),i.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const r=e.createElement("div");r.classList.add(OP("m")),r.appendChild(GA(e,"dropdown")),this.element.appendChild(r),i.value.emitter.on("change",this.onValueChange_),this.value_=i.value,sh(this.props_,"options",o=>{Nj(this.selectElement),o.forEach(a=>{const l=e.createElement("option");l.textContent=a.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(i=>i.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class py{constructor(e,i){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=i.props,this.value=i.value,this.viewProps=i.viewProps,this.view=new yRe(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const i=e.currentTarget;this.value.rawValue=this.props.get("options")[i.selectedIndex].value}importProps(e){return uh(e,null,i=>({options:i.required.custom(YA)}),i=>(this.props.set("options",Xj(i.options)),!0))}exportProps(){return dh(null,{options:this.props.get("options")})}}const S6=On("pop");class vRe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(S6()),i.viewProps.bindClassModifiers(this.element),hu(i.shows,Ny(this.element,S6(void 0,"v")))}}class Wj{constructor(e,i){this.shows=Sr(!1),this.viewProps=i.viewProps,this.view=new vRe(e,{shows:this.shows,viewProps:this.viewProps})}}const C6=On("txt");let xRe=class{constructor(e,i){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(C6()),i.viewProps.bindClassModifiers(this.element),this.props_=i.props,this.props_.emitter.on("change",this.onChange_);const n=e.createElement("input");n.classList.add(C6("i")),n.type="text",i.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,i.value.emitter.on("change",this.onChange_),this.value_=i.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}};class e3{constructor(e,i){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=i.parser,this.props=i.props,this.value=i.value,this.viewProps=i.viewProps,this.view=new xRe(e,{props:i.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const n=e.currentTarget.value,r=this.parser_(n);vs(r)||(this.value.rawValue=r),this.view.refresh()}}function _Re(s){return String(s)}function Hj(s){return s==="false"?!1:!!s}function T6(s){return _Re(s)}function bRe(s){return e=>s.reduce((i,n)=>i!==null?i:n(e),null)}const wRe=na(0);function KC(s){return wRe(s)+"%"}function Gj(s){return String(s)}function WB(s){return s}function Vy({primary:s,secondary:e,forward:i,backward:n}){let r=!1;function o(a){r||(r=!0,a(),r=!1)}s.emitter.on("change",a=>{o(()=>{e.setRawValue(i(s.rawValue,e.rawValue),a.options)})}),e.emitter.on("change",a=>{o(()=>{s.setRawValue(n(s.rawValue,e.rawValue),a.options)}),o(()=>{e.setRawValue(i(s.rawValue,e.rawValue),a.options)})}),o(()=>{e.setRawValue(i(s.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function Zo(s,e){const i=s*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+i:e.downKey?-i:0}function F_(s){return{altKey:s.altKey,downKey:s.key==="ArrowDown",shiftKey:s.shiftKey,upKey:s.key==="ArrowUp"}}function wu(s){return{altKey:s.altKey,downKey:s.key==="ArrowLeft",shiftKey:s.shiftKey,upKey:s.key==="ArrowRight"}}function ORe(s){return s==="ArrowUp"||s==="ArrowDown"}function Qj(s){return ORe(s)||s==="ArrowLeft"||s==="ArrowRight"}function SP(s,e){var i,n;const r=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:s.pageX-(((i=r&&r.scrollX)!==null&&i!==void 0?i:0)+o.left),y:s.pageY-(((n=r&&r.scrollY)!==null&&n!==void 0?n:0)+o.top)}}class Bm{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Ua,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const i=this.elem_.getBoundingClientRect();return{bounds:{width:i.width,height:i.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var i;e.preventDefault(),(i=e.currentTarget)===null||i===void 0||i.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(SP(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(SP(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const i=this.elem_.ownerDocument;i.removeEventListener("mousemove",this.onDocumentMouseMove_),i.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(SP(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const i=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=i}onTouchMove_(e){const i=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=i}onTouchEnd_(e){var i;const n=(i=e.targetTouches.item(0))!==null&&i!==void 0?i:this.lastTouch_,r=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-r.left,y:n.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const ja=On("txt");class SRe{constructor(e,i){this.onChange_=this.onChange_.bind(this),this.props_=i.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(ja(),ja(void 0,"num")),i.arrayPosition&&this.element.classList.add(ja(void 0,i.arrayPosition)),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(ja("i")),n.type="text",i.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=i.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ja()),this.inputElement.classList.add(ja("i"));const r=e.createElement("div");r.classList.add(ja("k")),this.element.appendChild(r),this.knobElement=r;const o=e.createElementNS(Yc,"svg");o.classList.add(ja("g")),this.knobElement.appendChild(o);const a=e.createElementNS(Yc,"path");a.classList.add(ja("gb")),o.appendChild(a),this.guideBodyElem_=a;const l=e.createElementNS(Yc,"path");l.classList.add(ja("gh")),o.appendChild(l),this.guideHeadElem_=l;const h=e.createElement("div");h.classList.add(On("tt")()),this.knobElement.appendChild(h),this.tooltipElem_=h,i.value.emitter.on("change",this.onChange_),this.value=i.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(ja(void 0,"drg"));return}this.element.classList.add(ja(void 0,"drg"));const i=e.rawValue/this.props_.get("pointerScale"),n=i+(i>0?-1:i<0?1:0),r=lr(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+r},0 L${n},4 L${n+r},8`,`M ${i},-1 L${i},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${i},4`);const o=this.props_.get("formatter");this.tooltipElem_.textContent=o(this.value.rawValue),this.tooltipElem_.style.left=`${i}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class Db{constructor(e,i){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=i.parser,this.props=i.props,this.sliderProps_=(n=i.sliderProps)!==null&&n!==void 0?n:null,this.value=i.value,this.viewProps=i.viewProps,this.dragging_=Sr(null),this.view=new SRe(e,{arrayPosition:i.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const r=new Bm(this.view.knobElement);r.emitter.on("down",this.onPointerDown_),r.emitter.on("move",this.onPointerMove_),r.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var i,n;const r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("min"),o=(n=this.sliderProps_)===null||n===void 0?void 0:n.get("max");let a=e;return r!==void 0&&(a=Math.max(a,r)),o!==void 0&&(a=Math.min(a,o)),a}onInputChange_(e){const n=e.currentTarget.value,r=this.parser_(n);vs(r)||(this.value.rawValue=this.constrainValue_(r)),this.view.refresh()}onInputKeyDown_(e){const i=Zo(this.props.get("keyScale"),F_(e));i!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+i),{forceEmit:!1,last:!1})}onInputKeyUp_(e){Zo(this.props.get("keyScale"),F_(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const i=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+i*this.props.get("pointerScale"))}onPointerMove_(e){const i=this.computeDraggingValue_(e.data);i!==null&&(this.value.setRawValue(i,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const i=this.computeDraggingValue_(e.data);i!==null&&(this.value.setRawValue(i,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const CP=On("sld");class CRe{constructor(e,i){this.onChange_=this.onChange_.bind(this),this.props_=i.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(CP()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(CP("t")),i.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const r=e.createElement("div");r.classList.add(CP("k")),this.trackElement.appendChild(r),this.knobElement=r,i.value.emitter.on("change",this.onChange_),this.value=i.value,this.update_()}update_(){const e=lr(An(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class TRe{constructor(e,i){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.props=i.props,this.view=new CRe(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Bm(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,i){e.point&&this.value.setRawValue(An(lr(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),i)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const i=Zo(this.props.get("keyScale"),wu(e));i!==0&&this.value.setRawValue(this.value.rawValue+i,{forceEmit:!1,last:!1})}onKeyUp_(e){Zo(this.props.get("keyScale"),wu(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const TP=On("sldtxt");class ARe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(TP());const n=e.createElement("div");n.classList.add(TP("s")),this.sliderView_=i.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const r=e.createElement("div");r.classList.add(TP("t")),this.textView_=i.textView,r.appendChild(this.textView_.element),this.element.appendChild(r)}}class A6{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.sliderC_=new TRe(e,{props:i.sliderProps,value:i.value,viewProps:this.viewProps}),this.textC_=new Db(e,{parser:i.parser,props:i.textProps,sliderProps:i.sliderProps,value:i.value,viewProps:i.viewProps}),this.view=new ARe(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return uh(e,null,i=>({max:i.required.number,min:i.required.number}),i=>{const n=this.sliderC_.props;return n.set("max",i.max),n.set("min",i.min),!0})}exportProps(){const e=this.sliderC_.props;return dh(null,{max:e.get("max"),min:e.get("min")})}}function ERe(s){return{sliderProps:new wn({keyScale:s.keyScale,max:s.max,min:s.min}),textProps:new wn({formatter:Sr(s.formatter),keyScale:s.keyScale,pointerScale:Sr(s.pointerScale)})}}const MRe={containerUnitSize:"cnt-usz"};function Yj(s){return`--${MRe[s]}`}function z_(s){return Rj(s)}function Fd(s){if(UB(s))return so(s,z_)}function eu(s,e){if(!s)return;const i=[],n=Pj(s,e);n&&i.push(n);const r=Ij(s);return r&&i.push(r),new Rb(i)}function jj(s){if(s==="inline"||s==="popup")return s}function Lb(s,e){s.write(e)}const xO=On("ckb");class kRe{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(xO()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(xO("l")),this.element.appendChild(n),this.labelElement=n;const r=e.createElement("input");r.classList.add(xO("i")),r.type="checkbox",this.labelElement.appendChild(r),this.inputElement=r,i.viewProps.bindDisabled(this.inputElement);const o=e.createElement("div");o.classList.add(xO("w")),this.labelElement.appendChild(o);const a=GA(e,"check");o.appendChild(a),i.value.emitter.on("change",this.onValueChange_),this.value=i.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class PRe{constructor(e,i){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.view=new kRe(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const i=e.currentTarget;this.value.rawValue=i.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}}function IRe(s){const e=[],i=JL(s.options);return i&&e.push(i),new Rb(e)}Mo({id:"input-bool",type:"input",accept:(s,e)=>{if(typeof s!="boolean")return null;const i=so(e,n=>({options:n.optional.custom(YA),readonly:n.optional.constant(!1)}));return i?{initialValue:s,params:i}:null},binding:{reader:s=>Hj,constraint:s=>IRe(s.params),writer:s=>Lb},controller:s=>{const e=s.document,i=s.value,n=s.constraint,r=n&&ZC(n,QA);return r?new py(e,{props:new wn({options:r.values.value("options")}),value:i,viewProps:s.viewProps}):new PRe(e,{value:i,viewProps:s.viewProps})},api(s){return typeof s.controller.value.rawValue!="boolean"?null:s.controller.valueController instanceof py?new KL(s.controller):null}});const ip=On("col");class BRe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(ip()),i.foldable.bindExpandedClass(this.element,ip(void 0,"expanded")),sh(i.foldable,"completed",Ny(this.element,ip(void 0,"cpl")));const n=e.createElement("div");n.classList.add(ip("h")),this.element.appendChild(n);const r=e.createElement("div");r.classList.add(ip("s")),n.appendChild(r),this.swatchElement=r;const o=e.createElement("div");if(o.classList.add(ip("t")),n.appendChild(o),this.textElement=o,i.pickerLayout==="inline"){const a=e.createElement("div");a.classList.add(ip("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null}}function RRe(s,e,i){const n=lr(s/255,0,1),r=lr(e/255,0,1),o=lr(i/255,0,1),a=Math.max(n,r,o),l=Math.min(n,r,o),h=a-l;let d=0,f=0;const p=(l+a)/2;return h!==0&&(f=h/(1-Math.abs(a+l-1)),n===a?d=(r-o)/h:r===a?d=2+(o-n)/h:d=4+(n-r)/h,d=d/6+(d<0?1:0)),[d*360,f*100,p*100]}function DRe(s,e,i){const n=(s%360+360)%360,r=lr(e/100,0,1),o=lr(i/100,0,1),a=(1-Math.abs(2*o-1))*r,l=a*(1-Math.abs(n/60%2-1)),h=o-a/2;let d,f,p;return n>=0&&n<60?[d,f,p]=[a,l,0]:n>=60&&n<120?[d,f,p]=[l,a,0]:n>=120&&n<180?[d,f,p]=[0,a,l]:n>=180&&n<240?[d,f,p]=[0,l,a]:n>=240&&n<300?[d,f,p]=[l,0,a]:[d,f,p]=[a,0,l],[(d+h)*255,(f+h)*255,(p+h)*255]}function LRe(s,e,i){const n=lr(s/255,0,1),r=lr(e/255,0,1),o=lr(i/255,0,1),a=Math.max(n,r,o),l=Math.min(n,r,o),h=a-l;let d;h===0?d=0:a===n?d=60*(((r-o)/h%6+6)%6):a===r?d=60*((o-n)/h+2):d=60*((n-r)/h+4);const f=a===0?0:h/a,p=a;return[d,f*100,p*100]}function qj(s,e,i){const n=Mj(s,360),r=lr(e/100,0,1),o=lr(i/100,0,1),a=o*r,l=a*(1-Math.abs(n/60%2-1)),h=o-a;let d,f,p;return n>=0&&n<60?[d,f,p]=[a,l,0]:n>=60&&n<120?[d,f,p]=[l,a,0]:n>=120&&n<180?[d,f,p]=[0,a,l]:n>=180&&n<240?[d,f,p]=[0,l,a]:n>=240&&n<300?[d,f,p]=[l,0,a]:[d,f,p]=[a,0,l],[(d+h)*255,(f+h)*255,(p+h)*255]}function NRe(s,e,i){const n=i+e*(100-Math.abs(2*i-100))/200;return[s,n!==0?e*(100-Math.abs(2*i-100))/n:0,i+e*(100-Math.abs(2*i-100))/(2*100)]}function VRe(s,e,i){const n=100-Math.abs(i*(200-e)/100-100);return[s,n!==0?e*i/n:0,i*(200-e)/(2*100)]}function rh(s){return[s[0],s[1],s[2]]}function jA(s,e){return[s[0],s[1],s[2],e]}const $Re={hsl:{hsl:(s,e,i)=>[s,e,i],hsv:NRe,rgb:DRe},hsv:{hsl:VRe,hsv:(s,e,i)=>[s,e,i],rgb:qj},rgb:{hsl:RRe,hsv:LRe,rgb:(s,e,i)=>[s,e,i]}};function my(s,e){return[e==="float"?1:s==="rgb"?255:360,e==="float"?1:s==="rgb"?255:100,e==="float"?1:s==="rgb"?255:100]}function URe(s,e){return s===e?e:Mj(s,e)}function Zj(s,e,i){var n;const r=my(e,i);return[e==="rgb"?lr(s[0],0,r[0]):URe(s[0],r[0]),lr(s[1],0,r[1]),lr(s[2],0,r[2]),lr((n=s[3])!==null&&n!==void 0?n:1,0,1)]}function E6(s,e,i,n){const r=my(e,i),o=my(e,n);return s.map((a,l)=>a/r[l]*o[l])}function Kj(s,e,i){const n=E6(s,e.mode,e.type,"int"),r=$Re[e.mode][i.mode](...n);return E6(r,i.mode,"int",i.type)}class xn{static black(){return new xn([0,0,0],"rgb")}constructor(e,i){this.type="int",this.mode=i,this.comps_=Zj(e,i,this.type)}getComponents(e){return jA(Kj(rh(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const cd=On("colp");class FRe{constructor(e,i){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(cd()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(cd("hsv"));const r=e.createElement("div");r.classList.add(cd("sv")),this.svPaletteView_=i.svPaletteView,r.appendChild(this.svPaletteView_.element),n.appendChild(r);const o=e.createElement("div");o.classList.add(cd("h")),this.hPaletteView_=i.hPaletteView,o.appendChild(this.hPaletteView_.element),n.appendChild(o),this.element.appendChild(n);const a=e.createElement("div");if(a.classList.add(cd("rgb")),this.textsView_=i.textsView,a.appendChild(this.textsView_.element),this.element.appendChild(a),i.alphaViews){this.alphaViews_={palette:i.alphaViews.palette,text:i.alphaViews.text};const l=e.createElement("div");l.classList.add(cd("a"));const h=e.createElement("div");h.classList.add(cd("ap")),h.appendChild(this.alphaViews_.palette.element),l.appendChild(h);const d=e.createElement("div");d.classList.add(cd("at")),d.appendChild(this.alphaViews_.text.element),l.appendChild(d),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(i=>i.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function zRe(s){return s==="int"?"int":s==="float"?"float":void 0}function t3(s){return so(s,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(zRe)}),expanded:e.optional.boolean,picker:e.optional.custom(jj),readonly:e.optional.constant(!1)}))}function vm(s){return s?.1:1}function Jj(s){var e;return(e=s.color)===null||e===void 0?void 0:e.type}class i3{constructor(e,i){this.type="float",this.mode=i,this.comps_=Zj(e,i,this.type)}getComponents(e){return jA(Kj(rh(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const XRe={int:(s,e)=>new xn(s,e),float:(s,e)=>new i3(s,e)};function n3(s,e,i){return XRe[i](s,e)}function WRe(s){return s.type==="float"}function HRe(s){return s.type==="int"}function GRe(s){const e=s.getComponents(),i=my(s.mode,"int");return new xn([Math.round(An(e[0],0,1,0,i[0])),Math.round(An(e[1],0,1,0,i[1])),Math.round(An(e[2],0,1,0,i[2])),e[3]],s.mode)}function QRe(s){const e=s.getComponents(),i=my(s.mode,"int");return new i3([An(e[0],0,i[0],0,1),An(e[1],0,i[1],0,1),An(e[2],0,i[2],0,1),e[3]],s.mode)}function Oo(s,e){if(s.type===e)return s;if(HRe(s)&&e==="float")return QRe(s);if(WRe(s)&&e==="int")return GRe(s);throw Ma.shouldNeverHappen()}function YRe(s,e){return s.alpha===e.alpha&&s.mode===e.mode&&s.notation===e.notation&&s.type===e.type}function ul(s,e){const i=s.match(/^(.+)%$/);return Math.min(i?parseFloat(i[1])*.01*e:parseFloat(s),e)}const jRe={deg:s=>s,grad:s=>s*360/400,rad:s=>s*360/(2*Math.PI),turn:s=>s*360};function eq(s){const e=s.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(s);const i=parseFloat(e[1]),n=e[2];return jRe[n](i)}function tq(s){const e=s.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[ul(e[1],255),ul(e[2],255),ul(e[3],255)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function qRe(s){const e=tq(s);return e?new xn(e,"rgb"):null}function iq(s){const e=s.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[ul(e[1],255),ul(e[2],255),ul(e[3],255),ul(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function ZRe(s){const e=iq(s);return e?new xn(e,"rgb"):null}function nq(s){const e=s.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[eq(e[1]),ul(e[2],100),ul(e[3],100)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function KRe(s){const e=nq(s);return e?new xn(e,"hsl"):null}function sq(s){const e=s.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const i=[eq(e[1]),ul(e[2],100),ul(e[3],100),ul(e[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function JRe(s){const e=sq(s);return e?new xn(e,"hsl"):null}function rq(s){const e=s.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const i=s.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]:null}function eDe(s){const e=rq(s);return e?new xn(e,"rgb"):null}function oq(s){const e=s.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),An(parseInt(e[4]+e[4],16),0,255,0,1)];const i=s.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16),An(parseInt(i[4],16),0,255,0,1)]:null}function tDe(s){const e=oq(s);return e?new xn(e,"rgb"):null}function aq(s){const e=s.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const i=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function iDe(s){return e=>{const i=aq(e);return i?n3(i,"rgb",s):null}}function lq(s){const e=s.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const i=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:i}function nDe(s){return e=>{const i=lq(e);return i?n3(i,"rgb",s):null}}const sDe=[{parser:rq,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:oq,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:tq,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:iq,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:nq,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:sq,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:aq,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:lq,result:{alpha:!0,mode:"rgb",notation:"object"}}];function rDe(s){return sDe.reduce((e,{parser:i,result:n})=>e||(i(s)?n:null),null)}function oDe(s,e="int"){const i=rDe(s);return i?i.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},i),{type:"int"}):i.notation==="func"?Object.assign(Object.assign({},i),{type:e}):null:null}function Nb(s){const e=[eDe,tDe,qRe,ZRe,KRe,JRe];e.push(iDe("int"),nDe("int"));const i=bRe(e);return n=>{const r=i(n);return r?Oo(r,s):null}}function aDe(s){const e=Nb("int");if(typeof s!="string")return xn.black();const i=e(s);return i??xn.black()}function cq(s){const e=lr(Math.floor(s),0,255).toString(16);return e.length===1?`0${e}`:e}function s3(s,e="#"){const i=rh(s.getComponents("rgb")).map(cq).join("");return`${e}${i}`}function r3(s,e="#"){const i=s.getComponents("rgb"),n=[i[0],i[1],i[2],i[3]*255].map(cq).join("");return`${e}${n}`}function hq(s){const e=na(0),i=Oo(s,"int");return`rgb(${rh(i.getComponents("rgb")).map(r=>e(r)).join(", ")})`}function qS(s){const e=na(2),i=na(0);return`rgba(${Oo(s,"int").getComponents("rgb").map((o,a)=>(a===3?e:i)(o)).join(", ")})`}function lDe(s){const e=[na(0),KC,KC],i=Oo(s,"int");return`hsl(${rh(i.getComponents("hsl")).map((r,o)=>e[o](r)).join(", ")})`}function cDe(s){const e=[na(0),KC,KC,na(2)];return`hsla(${Oo(s,"int").getComponents("hsl").map((r,o)=>e[o](r)).join(", ")})`}function uq(s,e){const i=na(e==="float"?2:0),n=["r","g","b"],r=Oo(s,e);return`{${rh(r.getComponents("rgb")).map((a,l)=>`${n[l]}: ${i(a)}`).join(", ")}}`}function hDe(s){return e=>uq(e,s)}function dq(s,e){const i=na(2),n=na(e==="float"?2:0),r=["r","g","b","a"];return`{${Oo(s,e).getComponents("rgb").map((l,h)=>{const d=h===3?i:n;return`${r[h]}: ${d(l)}`}).join(", ")}}`}function uDe(s){return e=>dq(e,s)}const dDe=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:s3},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:r3},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:hq},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:qS},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:lDe},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:cDe},...["int","float"].reduce((s,e)=>[...s,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:hDe(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:uDe(e)}],[])];function fq(s){return dDe.reduce((e,i)=>e||(YRe(i.format,s)?i.stringifier:null),null)}const Zv=On("apl");class fDe{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.value=i.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Zv()),i.viewProps.bindClassModifiers(this.element),i.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(Zv("b")),this.element.appendChild(n);const r=e.createElement("div");r.classList.add(Zv("c")),n.appendChild(r),this.colorElem_=r;const o=e.createElement("div");o.classList.add(Zv("m")),this.element.appendChild(o),this.markerElem_=o;const a=e.createElement("div");a.classList.add(Zv("p")),this.markerElem_.appendChild(a),this.previewElem_=a,this.update_()}update_(){const e=this.value.rawValue,i=e.getComponents("rgb"),n=new xn([i[0],i[1],i[2],0],"rgb"),r=new xn([i[0],i[1],i[2],255],"rgb"),o=["to right",qS(n),qS(r)];this.colorElem_.style.background=`linear-gradient(${o.join(",")})`,this.previewElem_.style.backgroundColor=qS(e);const a=An(i[3],0,1,0,100);this.markerElem_.style.left=`${a}%`}onValueChange_(){this.update_()}}class pDe{constructor(e,i){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.view=new fDe(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Bm(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,i){if(!e.point)return;const n=e.point.x/e.bounds.width,r=this.value.rawValue,[o,a,l]=r.getComponents("hsv");this.value.setRawValue(new xn([o,a,l,n],"hsv"),i)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const i=Zo(vm(!0),wu(e));if(i===0)return;const n=this.value.rawValue,[r,o,a,l]=n.getComponents("hsv");this.value.setRawValue(new xn([r,o,a,l+i],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Zo(vm(!0),wu(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ig=On("coltxt");function mDe(s){const e=s.createElement("select"),i=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(i.reduce((n,r)=>{const o=s.createElement("option");return o.textContent=r.text,o.value=r.value,n.appendChild(o),n},s.createDocumentFragment())),e}class gDe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(Ig()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Ig("m")),this.modeElem_=mDe(e),this.modeElem_.classList.add(Ig("ms")),n.appendChild(this.modeSelectElement),i.viewProps.bindDisabled(this.modeElem_);const r=e.createElement("div");r.classList.add(Ig("mm")),r.appendChild(GA(e,"dropdown")),n.appendChild(r),this.element.appendChild(n);const o=e.createElement("div");o.classList.add(Ig("w")),this.element.appendChild(o),this.inputsElem_=o,this.inputViews_=i.inputViews,this.applyInputViews_(),hu(i.mode,a=>{this.modeElem_.value=a})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){Nj(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(i=>{const n=e.createElement("div");n.classList.add(Ig("c")),n.appendChild(i.element),this.inputsElem_.appendChild(n)})}}function yDe(s){return na(s==="float"?2:0)}function vDe(s,e,i){const n=my(s,e)[i];return new WA({min:0,max:n})}function xDe(s,e,i){return new Db(s,{arrayPosition:i===0?"fst":i===2?"lst":"mid",parser:e.parser,props:wn.fromObject({formatter:yDe(e.colorType),keyScale:vm(!1),pointerScale:e.colorType==="float"?.01:1}),value:Sr(0,{constraint:vDe(e.colorMode,e.colorType,i)}),viewProps:e.viewProps})}function _De(s,e){const i={colorMode:e.colorMode,colorType:e.colorType,parser:sf,viewProps:e.viewProps};return[0,1,2].map(n=>{const r=xDe(s,i,n);return Vy({primary:e.value,secondary:r.value,forward(o){return Oo(o,e.colorType).getComponents(e.colorMode)[n]},backward(o,a){const l=e.colorMode,d=Oo(o,e.colorType).getComponents(l);d[n]=a;const f=n3(jA(rh(d),d[3]),l,e.colorType);return Oo(f,"int")}}),r})}function bDe(s,e){const i=new e3(s,{parser:Nb("int"),props:wn.fromObject({formatter:s3}),value:Sr(xn.black()),viewProps:e.viewProps});return Vy({primary:e.value,secondary:i.value,forward:n=>new xn(rh(n.getComponents()),n.mode),backward:(n,r)=>new xn(jA(rh(r.getComponents(n.mode)),n.getComponents()[3]),n.mode)}),[i]}function wDe(s){return s!=="hex"}class ODe{constructor(e,i){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=i.colorType,this.value=i.value,this.viewProps=i.viewProps,this.colorMode=Sr(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new gDe(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const i=this.colorMode.rawValue;return wDe(i)?_De(e,{colorMode:i,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):bDe(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const i=e.currentTarget;this.colorMode.rawValue=i.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(n=>n.view)}}const AP=On("hpl");class SDe{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.value=i.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(AP()),i.viewProps.bindClassModifiers(this.element),i.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(AP("c")),this.element.appendChild(n);const r=e.createElement("div");r.classList.add(AP("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}update_(){const e=this.value.rawValue,[i]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=hq(new xn([i,100,100],"hsv"));const n=An(i,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}}class CDe{constructor(e,i){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.view=new SDe(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Bm(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,i){if(!e.point)return;const n=An(lr(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),r=this.value.rawValue,[,o,a,l]=r.getComponents("hsv");this.value.setRawValue(new xn([n,o,a,l],"hsv"),i)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const i=Zo(vm(!1),wu(e));if(i===0)return;const n=this.value.rawValue,[r,o,a,l]=n.getComponents("hsv");this.value.setRawValue(new xn([r+i,o,a,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Zo(vm(!1),wu(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const EP=On("svp"),M6=64;class TDe{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),this.value=i.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(EP()),i.viewProps.bindClassModifiers(this.element),i.viewProps.bindTabIndex(this.element);const n=e.createElement("canvas");n.height=M6,n.width=M6,n.classList.add(EP("c")),this.element.appendChild(n),this.canvasElement=n;const r=e.createElement("div");r.classList.add(EP("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}update_(){const e=NBe(this.canvasElement);if(!e)return;const n=this.value.rawValue.getComponents("hsv"),r=this.canvasElement.width,o=this.canvasElement.height,a=e.getImageData(0,0,r,o),l=a.data;for(let f=0;f<o;f++)for(let p=0;p<r;p++){const g=An(p,0,r,0,100),y=An(f,0,o,100,0),x=qj(n[0],g,y),_=(f*r+p)*4;l[_]=x[0],l[_+1]=x[1],l[_+2]=x[2],l[_+3]=255}e.putImageData(a,0,0);const h=An(n[1],0,100,0,100);this.markerElem_.style.left=`${h}%`;const d=An(n[2],0,100,100,0);this.markerElem_.style.top=`${d}%`}onValueChange_(){this.update_()}}class ADe{constructor(e,i){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.view=new TDe(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Bm(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,i){if(!e.point)return;const n=An(e.point.x,0,e.bounds.width,0,100),r=An(e.point.y,0,e.bounds.height,100,0),[o,,,a]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new xn([o,n,r,a],"hsv"),i)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Qj(e.key)&&e.preventDefault();const[i,n,r,o]=this.value.rawValue.getComponents("hsv"),a=vm(!1),l=Zo(a,wu(e)),h=Zo(a,F_(e));l===0&&h===0||this.value.setRawValue(new xn([i,n+l,r+h,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const i=vm(!1),n=Zo(i,wu(e)),r=Zo(i,F_(e));n===0&&r===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class EDe{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.hPaletteC_=new CDe(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new ADe(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=i.supportsAlpha?{palette:new pDe(e,{value:this.value,viewProps:this.viewProps}),text:new Db(e,{parser:sf,props:wn.fromObject({pointerScale:.01,keyScale:.1,formatter:na(2)}),value:Sr(0,{constraint:new WA({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Vy({primary:this.value,secondary:this.alphaIcs_.text.value,forward:n=>n.getComponents()[3],backward:(n,r)=>{const o=n.getComponents();return o[3]=r,new xn(o,n.mode)}}),this.textsC_=new ODe(e,{colorType:i.colorType,value:this.value,viewProps:this.viewProps}),this.view=new FRe(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:i.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const MP=On("colsw");class MDe{constructor(e,i){this.onValueChange_=this.onValueChange_.bind(this),i.value.emitter.on("change",this.onValueChange_),this.value=i.value,this.element=e.createElement("div"),this.element.classList.add(MP()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(MP("sw")),this.element.appendChild(n),this.swatchElem_=n;const r=e.createElement("button");r.classList.add(MP("b")),i.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=r3(e)}onValueChange_(){this.update_()}}class kDe{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.view=new MDe(e,{value:this.value,viewProps:this.viewProps})}}class o3{constructor(e,i){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.foldable_=Ib.create(i.expanded),this.swatchC_=new kDe(e,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new e3(e,{parser:i.parser,props:wn.fromObject({formatter:i.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new BRe(e,{foldable:this.foldable_,pickerLayout:i.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=i.pickerLayout==="popup"?new Wj(e,{viewProps:this.viewProps}):null;const r=new EDe(e,{colorType:i.colorType,supportsAlpha:i.supportsAlpha,value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(r.view.element),Vy({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,a)=>a})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ZL(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const i=this.view.element,n=e.relatedTarget;(!n||!i.contains(n))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const i=this.popC_.view.element,n=Vj(e);n&&i.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!HL(i.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function PDe(s){return rh(s.getComponents("rgb")).reduce((e,i)=>e<<8|Math.floor(i)&255,0)}function IDe(s){return s.getComponents("rgb").reduce((e,i,n)=>{const r=Math.floor(n===3?i*255:i)&255;return e<<8|r},0)>>>0}function BDe(s){return new xn([s>>16&255,s>>8&255,s&255],"rgb")}function RDe(s){return new xn([s>>24&255,s>>16&255,s>>8&255,An(s&255,0,255,0,1)],"rgb")}function DDe(s){return typeof s!="number"?xn.black():BDe(s)}function LDe(s){return typeof s!="number"?xn.black():RDe(s)}function ZS(s,e){return typeof s!="object"||vs(s)?!1:e in s&&typeof s[e]=="number"}function pq(s){return ZS(s,"r")&&ZS(s,"g")&&ZS(s,"b")}function mq(s){return pq(s)&&ZS(s,"a")}function gq(s){return pq(s)}function a3(s,e){if(s.mode!==e.mode||s.type!==e.type)return!1;const i=s.getComponents(),n=e.getComponents();for(let r=0;r<i.length;r++)if(i[r]!==n[r])return!1;return!0}function k6(s){return"a"in s?[s.r,s.g,s.b,s.a]:[s.r,s.g,s.b]}function NDe(s){const e=fq(s);return e?(i,n)=>{Lb(i,e(n))}:null}function VDe(s){const e=s?IDe:PDe;return(i,n)=>{Lb(i,e(n))}}function $De(s,e,i){const r=Oo(e,i).toRgbaObject();s.writeProperty("r",r.r),s.writeProperty("g",r.g),s.writeProperty("b",r.b),s.writeProperty("a",r.a)}function UDe(s,e,i){const r=Oo(e,i).toRgbaObject();s.writeProperty("r",r.r),s.writeProperty("g",r.g),s.writeProperty("b",r.b)}function FDe(s,e){return(i,n)=>{s?$De(i,n,e):UDe(i,n,e)}}function zDe(s){var e;return!!(!((e=s==null?void 0:s.color)===null||e===void 0)&&e.alpha)}function XDe(s){return s?e=>r3(e,"0x"):e=>s3(e,"0x")}function WDe(s){return"color"in s||s.view==="color"}Mo({id:"input-color-number",type:"input",accept:(s,e)=>{if(typeof s!="number"||!WDe(e))return null;const i=t3(e);return i?{initialValue:s,params:Object.assign(Object.assign({},i),{supportsAlpha:zDe(e)})}:null},binding:{reader:s=>s.params.supportsAlpha?LDe:DDe,equals:a3,writer:s=>VDe(s.params.supportsAlpha)},controller:s=>{var e,i;return new o3(s.document,{colorType:"int",expanded:(e=s.params.expanded)!==null&&e!==void 0?e:!1,formatter:XDe(s.params.supportsAlpha),parser:Nb("int"),pickerLayout:(i=s.params.picker)!==null&&i!==void 0?i:"popup",supportsAlpha:s.params.supportsAlpha,value:s.value,viewProps:s.viewProps})}});function HDe(s,e){if(!gq(s))return Oo(xn.black(),e);if(e==="int"){const i=k6(s);return new xn(i,"rgb")}if(e==="float"){const i=k6(s);return new i3(i,"rgb")}return Oo(xn.black(),"int")}function GDe(s){return mq(s)}function QDe(s){return e=>{const i=HDe(e,s);return Oo(i,"int")}}function YDe(s,e){return i=>s?dq(i,e):uq(i,e)}Mo({id:"input-color-object",type:"input",accept:(s,e)=>{var i;if(!gq(s))return null;const n=t3(e);return n?{initialValue:s,params:Object.assign(Object.assign({},n),{colorType:(i=Jj(e))!==null&&i!==void 0?i:"int"})}:null},binding:{reader:s=>QDe(s.params.colorType),equals:a3,writer:s=>FDe(GDe(s.initialValue),s.params.colorType)},controller:s=>{var e,i;const n=mq(s.initialValue);return new o3(s.document,{colorType:s.params.colorType,expanded:(e=s.params.expanded)!==null&&e!==void 0?e:!1,formatter:YDe(n,s.params.colorType),parser:Nb("int"),pickerLayout:(i=s.params.picker)!==null&&i!==void 0?i:"popup",supportsAlpha:n,value:s.value,viewProps:s.viewProps})}});Mo({id:"input-color-string",type:"input",accept:(s,e)=>{if(typeof s!="string"||e.view==="text")return null;const i=oDe(s,Jj(e));if(!i)return null;const n=fq(i);if(!n)return null;const r=t3(e);return r?{initialValue:s,params:Object.assign(Object.assign({},r),{format:i,stringifier:n})}:null},binding:{reader:()=>aDe,equals:a3,writer:s=>{const e=NDe(s.params.format);if(!e)throw Ma.notBindable();return e}},controller:s=>{var e,i;return new o3(s.document,{colorType:s.params.format.type,expanded:(e=s.params.expanded)!==null&&e!==void 0?e:!1,formatter:s.params.stringifier,parser:Nb("int"),pickerLayout:(i=s.params.picker)!==null&&i!==void 0?i:"popup",supportsAlpha:s.params.format.alpha,value:s.value,viewProps:s.viewProps})}});class l3{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const i=this.asm_.toComponents(e).map((n,r)=>{var o,a;return(a=(o=this.components[r])===null||o===void 0?void 0:o.constrain(n))!==null&&a!==void 0?a:n});return this.asm_.fromComponents(i)}}const P6=On("pndtxt");class jDe{constructor(e,i){this.textViews=i.textViews,this.element=e.createElement("div"),this.element.classList.add(P6()),this.textViews.forEach(n=>{const r=e.createElement("div");r.classList.add(P6("a")),r.appendChild(n.element),this.element.appendChild(r)})}}function qDe(s,e,i){return new Db(s,{arrayPosition:i===0?"fst":i===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[i].textProps,value:Sr(0,{constraint:e.axes[i].constraint}),viewProps:e.viewProps})}class c3{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.acs_=i.axes.map((n,r)=>qDe(e,i,r)),this.acs_.forEach((n,r)=>{Vy({primary:this.value,secondary:n.value,forward:o=>i.assembly.toComponents(o)[r],backward:(o,a)=>{const l=i.assembly.toComponents(o);return l[r]=a,i.assembly.fromComponents(l)}})}),this.view=new jDe(e,{textViews:this.acs_.map(n=>n.view)})}get textControllers(){return this.acs_}}class ZDe extends WL{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}function KDe(s,e){const i=[],n=Pj(s,e);n&&i.push(n);const r=Ij(s);r&&i.push(r);const o=JL(s.options);return o&&i.push(o),new Rb(i)}Mo({id:"input-number",type:"input",accept:(s,e)=>{if(typeof s!="number")return null;const i=so(e,n=>Object.assign(Object.assign({},Rj(n)),{options:n.optional.custom(YA),readonly:n.optional.constant(!1)}));return i?{initialValue:s,params:i}:null},binding:{reader:s=>Ej,constraint:s=>KDe(s.params,s.initialValue),writer:s=>Lb},controller:s=>{const e=s.value,i=s.constraint,n=i&&ZC(i,QA);if(n)return new py(s.document,{props:new wn({options:n.values.value("options")}),value:e,viewProps:s.viewProps});const r=Bj(s.params,e.rawValue),o=i&&ZC(i,WA);return o?new A6(s.document,Object.assign(Object.assign({},ERe(Object.assign(Object.assign({},r),{keyScale:Sr(r.keyScale),max:o.values.value("max"),min:o.values.value("min")}))),{parser:sf,value:e,viewProps:s.viewProps})):new Db(s.document,{parser:sf,props:wn.fromObject(r),value:e,viewProps:s.viewProps})},api(s){return typeof s.controller.value.rawValue!="number"?null:s.controller.valueController instanceof A6?new ZDe(s.controller):s.controller.valueController instanceof py?new KL(s.controller):null}});class jd{constructor(e=0,i=0){this.x=e,this.y=i}getComponents(){return[this.x,this.y]}static isObject(e){if(vs(e))return!1;const i=e.x,n=e.y;return!(typeof i!="number"||typeof n!="number")}static equals(e,i){return e.x===i.x&&e.y===i.y}toObject(){return{x:this.x,y:this.y}}}const yq={toComponents:s=>s.getComponents(),fromComponents:s=>new jd(...s)},Bg=On("p2d");class JDe{constructor(e,i){this.element=e.createElement("div"),this.element.classList.add(Bg()),i.viewProps.bindClassModifiers(this.element),hu(i.expanded,Ny(this.element,Bg(void 0,"expanded")));const n=e.createElement("div");n.classList.add(Bg("h")),this.element.appendChild(n);const r=e.createElement("button");r.classList.add(Bg("b")),r.appendChild(GA(e,"p2dpad")),i.viewProps.bindDisabled(r),n.appendChild(r),this.buttonElement=r;const o=e.createElement("div");if(o.classList.add(Bg("t")),n.appendChild(o),this.textElement=o,i.pickerLayout==="inline"){const a=e.createElement("div");a.classList.add(Bg("p")),this.element.appendChild(a),this.pickerElement=a}else this.pickerElement=null}}const hd=On("p2dp");class eLe{constructor(e,i){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=i.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(hd()),i.layout==="popup"&&this.element.classList.add(hd(void 0,"p")),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(hd("p")),i.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const r=e.createElementNS(Yc,"svg");r.classList.add(hd("g")),this.padElement.appendChild(r),this.svgElem_=r;const o=e.createElementNS(Yc,"line");o.classList.add(hd("ax")),o.setAttributeNS(null,"x1","0"),o.setAttributeNS(null,"y1","50%"),o.setAttributeNS(null,"x2","100%"),o.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(o);const a=e.createElementNS(Yc,"line");a.classList.add(hd("ax")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","0"),a.setAttributeNS(null,"x2","50%"),a.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(a);const l=e.createElementNS(Yc,"line");l.classList.add(hd("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const h=e.createElement("div");h.classList.add(hd("m")),this.padElement.appendChild(h),this.markerElem_=h,i.value.emitter.on("change",this.onValueChange_),this.value=i.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,i]=this.value.rawValue.getComponents(),n=this.props_.get("max"),r=An(e,-n,+n,0,100),o=An(i,-n,+n,0,100),a=this.props_.get("invertsY")?100-o:o;this.lineElem_.setAttributeNS(null,"x2",`${r}%`),this.lineElem_.setAttributeNS(null,"y2",`${a}%`),this.markerElem_.style.left=`${r}%`,this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function I6(s,e,i){return[Zo(e[0],wu(s)),Zo(e[1],F_(s))*(i?1:-1)]}class tLe{constructor(e,i){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=i.props,this.value=i.value,this.viewProps=i.viewProps,this.view=new eLe(e,{layout:i.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Bm(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,i){if(!e.point)return;const n=this.props.get("max"),r=An(e.point.x,0,e.bounds.width,-n,+n),o=An(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-n,+n);this.value.setRawValue(new jd(r,o),i)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Qj(e.key)&&e.preventDefault();const[i,n]=I6(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));i===0&&n===0||this.value.setRawValue(new jd(this.value.rawValue.x+i,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[i,n]=I6(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));i===0&&n===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class iLe{constructor(e,i){var n,r;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=i.value,this.viewProps=i.viewProps,this.foldable_=Ib.create(i.expanded),this.popC_=i.pickerLayout==="popup"?new Wj(e,{viewProps:this.viewProps}):null;const o=new tLe(e,{layout:i.pickerLayout,props:new wn({invertsY:Sr(i.invertsY),max:Sr(i.max),xKeyScale:i.axes[0].textProps.value("keyScale"),yKeyScale:i.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});o.view.allFocusableElements.forEach(a=>{a.addEventListener("blur",this.onPopupChildBlur_),a.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=o,this.textC_=new c3(e,{assembly:yq,axes:i.axes,parser:i.parser,value:this.value,viewProps:this.viewProps}),this.view=new JDe(e,{expanded:this.foldable_.value("expanded"),pickerLayout:i.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(n=this.view.buttonElement)===null||n===void 0||n.addEventListener("blur",this.onPadButtonBlur_),(r=this.view.buttonElement)===null||r===void 0||r.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Vy({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:a=>a,backward:(a,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ZL(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const i=this.view.element,n=e.relatedTarget;(!n||!i.contains(n))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const i=this.popC_.view.element,n=Vj(e);n&&i.contains(n)||n&&n===this.view.buttonElement&&!HL(i.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}}function nLe(s){return jd.isObject(s)?new jd(s.x,s.y):new jd}function sLe(s,e){s.writeProperty("x",e.x),s.writeProperty("y",e.y)}function rLe(s,e){return new l3({assembly:yq,components:[eu(Object.assign(Object.assign({},s),s.x),e.x),eu(Object.assign(Object.assign({},s),s.y),e.y)]})}function B6(s,e){var i,n;if(!vs(s.min)||!vs(s.max))return Math.max(Math.abs((i=s.min)!==null&&i!==void 0?i:0),Math.abs((n=s.max)!==null&&n!==void 0?n:0));const r=kj(s);return Math.max(Math.abs(r)*10,Math.abs(e)*10)}function oLe(s,e){var i,n;const r=B6(ym(s,(i=s.x)!==null&&i!==void 0?i:{}),e.x),o=B6(ym(s,(n=s.y)!==null&&n!==void 0?n:{}),e.y);return Math.max(r,o)}function aLe(s){if(!("y"in s))return!1;const e=s.y;return e&&"inverted"in e?!!e.inverted:!1}Mo({id:"input-point2d",type:"input",accept:(s,e)=>{if(!jd.isObject(s))return null;const i=so(e,n=>Object.assign(Object.assign({},z_(n)),{expanded:n.optional.boolean,picker:n.optional.custom(jj),readonly:n.optional.constant(!1),x:n.optional.custom(Fd),y:n.optional.object(Object.assign(Object.assign({},z_(n)),{inverted:n.optional.boolean}))}));return i?{initialValue:s,params:i}:null},binding:{reader:()=>nLe,constraint:s=>rLe(s.params,s.initialValue),equals:jd.equals,writer:()=>sLe},controller:s=>{var e,i;const n=s.document,r=s.value,o=s.constraint,a=[s.params.x,s.params.y];return new iLe(n,{axes:r.rawValue.getComponents().map((l,h)=>{var d;return zL({constraint:o.components[h],initialValue:l,params:ym(s.params,(d=a[h])!==null&&d!==void 0?d:{})})}),expanded:(e=s.params.expanded)!==null&&e!==void 0?e:!1,invertsY:aLe(s.params),max:oLe(s.params,r.rawValue),parser:sf,pickerLayout:(i=s.params.picker)!==null&&i!==void 0?i:"popup",value:r,viewProps:s.viewProps})}});class F0{constructor(e=0,i=0,n=0){this.x=e,this.y=i,this.z=n}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(vs(e))return!1;const i=e.x,n=e.y,r=e.z;return!(typeof i!="number"||typeof n!="number"||typeof r!="number")}static equals(e,i){return e.x===i.x&&e.y===i.y&&e.z===i.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const vq={toComponents:s=>s.getComponents(),fromComponents:s=>new F0(...s)};function lLe(s){return F0.isObject(s)?new F0(s.x,s.y,s.z):new F0}function cLe(s,e){s.writeProperty("x",e.x),s.writeProperty("y",e.y),s.writeProperty("z",e.z)}function hLe(s,e){return new l3({assembly:vq,components:[eu(Object.assign(Object.assign({},s),s.x),e.x),eu(Object.assign(Object.assign({},s),s.y),e.y),eu(Object.assign(Object.assign({},s),s.z),e.z)]})}Mo({id:"input-point3d",type:"input",accept:(s,e)=>{if(!F0.isObject(s))return null;const i=so(e,n=>Object.assign(Object.assign({},z_(n)),{readonly:n.optional.constant(!1),x:n.optional.custom(Fd),y:n.optional.custom(Fd),z:n.optional.custom(Fd)}));return i?{initialValue:s,params:i}:null},binding:{reader:s=>lLe,constraint:s=>hLe(s.params,s.initialValue),equals:F0.equals,writer:s=>cLe},controller:s=>{const e=s.value,i=s.constraint,n=[s.params.x,s.params.y,s.params.z];return new c3(s.document,{assembly:vq,axes:e.rawValue.getComponents().map((r,o)=>{var a;return zL({constraint:i.components[o],initialValue:r,params:ym(s.params,(a=n[o])!==null&&a!==void 0?a:{})})}),parser:sf,value:e,viewProps:s.viewProps})}});class z0{constructor(e=0,i=0,n=0,r=0){this.x=e,this.y=i,this.z=n,this.w=r}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(vs(e))return!1;const i=e.x,n=e.y,r=e.z,o=e.w;return!(typeof i!="number"||typeof n!="number"||typeof r!="number"||typeof o!="number")}static equals(e,i){return e.x===i.x&&e.y===i.y&&e.z===i.z&&e.w===i.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const xq={toComponents:s=>s.getComponents(),fromComponents:s=>new z0(...s)};function uLe(s){return z0.isObject(s)?new z0(s.x,s.y,s.z,s.w):new z0}function dLe(s,e){s.writeProperty("x",e.x),s.writeProperty("y",e.y),s.writeProperty("z",e.z),s.writeProperty("w",e.w)}function fLe(s,e){return new l3({assembly:xq,components:[eu(Object.assign(Object.assign({},s),s.x),e.x),eu(Object.assign(Object.assign({},s),s.y),e.y),eu(Object.assign(Object.assign({},s),s.z),e.z),eu(Object.assign(Object.assign({},s),s.w),e.w)]})}Mo({id:"input-point4d",type:"input",accept:(s,e)=>{if(!z0.isObject(s))return null;const i=so(e,n=>Object.assign(Object.assign({},z_(n)),{readonly:n.optional.constant(!1),w:n.optional.custom(Fd),x:n.optional.custom(Fd),y:n.optional.custom(Fd),z:n.optional.custom(Fd)}));return i?{initialValue:s,params:i}:null},binding:{reader:s=>uLe,constraint:s=>fLe(s.params,s.initialValue),equals:z0.equals,writer:s=>dLe},controller:s=>{const e=s.value,i=s.constraint,n=[s.params.x,s.params.y,s.params.z,s.params.w];return new c3(s.document,{assembly:xq,axes:e.rawValue.getComponents().map((r,o)=>{var a;return zL({constraint:i.components[o],initialValue:r,params:ym(s.params,(a=n[o])!==null&&a!==void 0?a:{})})}),parser:sf,value:e,viewProps:s.viewProps})}});function pLe(s){const e=[],i=JL(s.options);return i&&e.push(i),new Rb(e)}Mo({id:"input-string",type:"input",accept:(s,e)=>{if(typeof s!="string")return null;const i=so(e,n=>({readonly:n.optional.constant(!1),options:n.optional.custom(YA)}));return i?{initialValue:s,params:i}:null},binding:{reader:s=>Gj,constraint:s=>pLe(s.params),writer:s=>Lb},controller:s=>{const e=s.document,i=s.value,n=s.constraint,r=n&&ZC(n,QA);return r?new py(e,{props:new wn({options:r.values.value("options")}),value:i,viewProps:s.viewProps}):new e3(e,{parser:o=>o,props:wn.fromObject({formatter:WB}),value:i,viewProps:s.viewProps})},api(s){return typeof s.controller.value.rawValue!="string"?null:s.controller.valueController instanceof py?new KL(s.controller):null}});const qA={monitor:{defaultInterval:200,defaultRows:3}},R6=On("mll");class mLe{constructor(e,i){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=i.formatter,this.element=e.createElement("div"),this.element.classList.add(R6()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("textarea");n.classList.add(R6("i")),n.style.height=`calc(var(${Yj("containerUnitSize")}) * ${i.rows})`,n.readOnly=!0,i.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,i.value.emitter.on("change",this.onValueUpdate_),this.value=i.value,this.update_()}update_(){const e=this.textareaElem_,i=e.scrollTop===e.scrollHeight-e.clientHeight,n=[];this.value.rawValue.forEach(r=>{r!==void 0&&n.push(this.formatter_(r))}),e.textContent=n.join(`
`),i&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class h3{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.view=new mLe(e,{formatter:i.formatter,rows:i.rows,value:this.value,viewProps:this.viewProps})}}const D6=On("sgl");class gLe{constructor(e,i){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=i.formatter,this.element=e.createElement("div"),this.element.classList.add(D6()),i.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(D6("i")),n.readOnly=!0,n.type="text",i.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,i.value.emitter.on("change",this.onValueUpdate_),this.value=i.value,this.update_()}update_(){const e=this.value.rawValue,i=e[e.length-1];this.inputElement.value=i!==void 0?this.formatter_(i):""}onValueUpdate_(){this.update_()}}class u3{constructor(e,i){this.value=i.value,this.viewProps=i.viewProps,this.view=new gLe(e,{formatter:i.formatter,value:this.value,viewProps:this.viewProps})}}Mo({id:"monitor-bool",type:"monitor",accept:(s,e)=>{if(typeof s!="boolean")return null;const i=so(e,n=>({readonly:n.required.constant(!0),rows:n.optional.number}));return i?{initialValue:s,params:i}:null},binding:{reader:s=>Hj},controller:s=>{var e;return s.value.rawValue.length===1?new u3(s.document,{formatter:T6,value:s.value,viewProps:s.viewProps}):new h3(s.document,{formatter:T6,rows:(e=s.params.rows)!==null&&e!==void 0?e:qA.monitor.defaultRows,value:s.value,viewProps:s.viewProps})}});class yLe extends WL{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const ud=On("grl");class vLe{constructor(e,i){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ud()),i.viewProps.bindClassModifiers(this.element),this.formatter_=i.formatter,this.props_=i.props,this.cursor_=i.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=e.createElementNS(Yc,"svg");n.classList.add(ud("g")),n.style.height=`calc(var(${Yj("containerUnitSize")}) * ${i.rows})`,this.element.appendChild(n),this.svgElem_=n;const r=e.createElementNS(Yc,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;const o=e.createElement("div");o.classList.add(ud("t"),On("tt")()),this.element.appendChild(o),this.tooltipElem_=o,i.value.emitter.on("change",this.onValueUpdate_),this.value=i.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:i}=this.element,n=this.value.rawValue.length-1,r=this.props_.get("min"),o=this.props_.get("max"),a=[];this.value.rawValue.forEach((p,g)=>{if(p===void 0)return;const y=An(g,0,n,0,e),x=An(p,r,o,i,0);a.push([y,x].join(","))}),this.lineElem_.setAttributeNS(null,"points",a.join(" "));const l=this.tooltipElem_,h=this.value.rawValue[this.cursor_.rawValue];if(h===void 0){l.classList.remove(ud("t","a"));return}const d=An(this.cursor_.rawValue,0,n,0,e),f=An(h,r,o,i,0);l.style.left=`${d}px`,l.style.top=`${f}px`,l.textContent=`${this.formatter_(h)}`,l.classList.contains(ud("t","a"))||(l.classList.add(ud("t","a"),ud("t","in")),qC(l),l.classList.remove(ud("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class _q{constructor(e,i){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=i.props,this.value=i.value,this.viewProps=i.viewProps,this.cursor_=Sr(-1),this.view=new vLe(e,{cursor:this.cursor_,formatter:i.formatter,rows:i.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!HL(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const n=new Bm(this.view.element);n.emitter.on("down",this.onGraphPointerDown_),n.emitter.on("move",this.onGraphPointerMove_),n.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return uh(e,null,i=>({max:i.required.number,min:i.required.number}),i=>(this.props.set("max",i.max),this.props.set("min",i.min),!0))}exportProps(){return dh(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:i}=this.view.element;this.cursor_.rawValue=Math.floor(An(e.offsetX,0,i,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(An(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function HB(s){return vs(s.format)?na(2):s.format}function xLe(s){var e;return s.value.rawValue.length===1?new u3(s.document,{formatter:HB(s.params),value:s.value,viewProps:s.viewProps}):new h3(s.document,{formatter:HB(s.params),rows:(e=s.params.rows)!==null&&e!==void 0?e:qA.monitor.defaultRows,value:s.value,viewProps:s.viewProps})}function _Le(s){var e,i,n;return new _q(s.document,{formatter:HB(s.params),rows:(e=s.params.rows)!==null&&e!==void 0?e:qA.monitor.defaultRows,props:wn.fromObject({max:(i=s.params.max)!==null&&i!==void 0?i:100,min:(n=s.params.min)!==null&&n!==void 0?n:0}),value:s.value,viewProps:s.viewProps})}function L6(s){return s.view==="graph"}Mo({id:"monitor-number",type:"monitor",accept:(s,e)=>{if(typeof s!="number")return null;const i=so(e,n=>({format:n.optional.function,max:n.optional.number,min:n.optional.number,readonly:n.required.constant(!0),rows:n.optional.number,view:n.optional.string}));return i?{initialValue:s,params:i}:null},binding:{defaultBufferSize:s=>L6(s)?64:1,reader:s=>Ej},controller:s=>L6(s.params)?_Le(s):xLe(s),api:s=>s.controller.valueController instanceof _q?new yLe(s.controller):null});Mo({id:"monitor-string",type:"monitor",accept:(s,e)=>{if(typeof s!="string")return null;const i=so(e,n=>({multiline:n.optional.boolean,readonly:n.required.constant(!0),rows:n.optional.number}));return i?{initialValue:s,params:i}:null},binding:{reader:s=>Gj},controller:s=>{var e;const i=s.value;return i.rawValue.length>1||s.params.multiline?new h3(s.document,{formatter:WB,rows:(e=s.params.rows)!==null&&e!==void 0?e:qA.monitor.defaultRows,value:i,viewProps:s.viewProps}):new u3(s.document,{formatter:WB,value:i,viewProps:s.viewProps})}});new Uj("4.0.3");const bLe=parseInt(My.replace(/\D+/g,""));var wLe=Object.defineProperty,OLe=(s,e,i)=>e in s?wLe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i,SLe=(s,e,i)=>(OLe(s,e+"",i),i);async function N6(s){const e=await s.arrayBuffer(),i=btoa(String.fromCharCode(...new Uint8Array(e)));return`data:${s.type||""};base64,${i}`}let _O,kP,Rg,bO;function PP(s,e=1/0,i=null){kP||(kP=new _f(2,2,1,1)),Rg||(Rg=new Ao({uniforms:{blitTexture:new zA(s)},vertexShader:`
        varying vec2 vUv;
        void main(){
            vUv = uv;
            gl_Position = vec4(position.xy * 1.0,0.,.999999);
        }
      `,fragmentShader:`
          uniform sampler2D blitTexture; 
          varying vec2 vUv;

          void main(){ 
              gl_FragColor = vec4(vUv.xy, 0, 1);
              
              #ifdef IS_SRGB
              gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );
              #else
              gl_FragColor = texture2D( blitTexture, vUv);
              #endif
          }
      `})),Rg.uniforms.blitTexture.value=s,Rg.defines.IS_SRGB="colorSpace"in s?s.colorSpace==="srgb":s.encoding===3001,Rg.needsUpdate=!0,bO||(bO=new Dn(kP,Rg),bO.frustrumCulled=!1);const n=new Rn,r=new dy;r.add(bO),i||(i=_O=new Qx({antialias:!1})),i.setSize(Math.min(s.image.width,e),Math.min(s.image.height,e)),i.clear(),i.render(r,n);const o=new cs(i.domElement);return o.minFilter=s.minFilter,o.magFilter=s.magFilter,o.wrapS=s.wrapS,o.wrapT=s.wrapT,o.name=s.name,_O&&(_O.dispose(),_O=null),o}const V6={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class bq{constructor(){this.pluginCallbacks=[],this.register(function(e){return new RLe(e)}),this.register(function(e){return new DLe(e)}),this.register(function(e){return new VLe(e)}),this.register(function(e){return new $Le(e)}),this.register(function(e){return new ULe(e)}),this.register(function(e){return new FLe(e)}),this.register(function(e){return new LLe(e)}),this.register(function(e){return new NLe(e)}),this.register(function(e){return new zLe(e)}),this.register(function(e){return new XLe(e)}),this.register(function(e){return new WLe(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,i,n,r){const o=new BLe,a=[];for(let l=0,h=this.pluginCallbacks.length;l<h;l++)a.push(this.pluginCallbacks[l](o));o.setPlugins(a),o.write(e,i,r).catch(n)}parseAsync(e,i){const n=this;return new Promise(function(r,o){n.parse(e,r,o,i)})}}SLe(bq,"Utils",{insertKeyframe:function(s,e){const i=s.getValueSize(),n=new s.TimeBufferType(s.times.length+1),r=new s.ValueBufferType(s.values.length+i),o=s.createInterpolant(new s.ValueBufferType(i));let a;if(s.times.length===0){n[0]=e;for(let l=0;l<i;l++)r[l]=0;a=0}else if(e<s.times[0]){if(Math.abs(s.times[0]-e)<.001)return 0;n[0]=e,n.set(s.times,1),r.set(o.evaluate(e),0),r.set(s.values,i),a=0}else if(e>s.times[s.times.length-1]){if(Math.abs(s.times[s.times.length-1]-e)<.001)return s.times.length-1;n[n.length-1]=e,n.set(s.times,0),r.set(s.values,0),r.set(o.evaluate(e),s.values.length),a=n.length-1}else for(let l=0;l<s.times.length;l++){if(Math.abs(s.times[l]-e)<.001)return l;if(s.times[l]<e&&s.times[l+1]>e){n.set(s.times.slice(0,l+1),0),n[l+1]=e,n.set(s.times.slice(l+1),l+2),r.set(s.values.slice(0,(l+1)*i),0),r.set(o.evaluate(e),(l+1)*i),r.set(s.values.slice((l+1)*i),(l+2)*i),a=l+1;break}}return s.times=n,s.values=r,a},mergeMorphTargetTracks:function(s,e){const i=[],n={},r=s.tracks;for(let o=0;o<r.length;++o){let a=r[o];const l=ji.parseTrackName(a.name),h=ji.findNode(e,l.nodeName);if(l.propertyName!=="morphTargetInfluences"||l.propertyIndex===void 0){i.push(a);continue}if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),a=a.clone(),a.setInterpolation(ly)}const d=h.morphTargetInfluences.length,f=h.morphTargetDictionary[l.propertyIndex];if(f===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);let p;if(n[h.uuid]===void 0){p=a.clone();const y=new p.ValueBufferType(d*p.times.length);for(let x=0;x<p.times.length;x++)y[x*d+f]=p.values[x];p.name=(l.nodeName||"")+".morphTargetInfluences",p.values=y,n[h.uuid]=p,i.push(p);continue}const g=a.createInterpolant(new a.ValueBufferType(1));p=n[h.uuid];for(let y=0;y<p.times.length;y++)p.values[y*d+f]=g.evaluate(p.times[y]);for(let y=0;y<a.times.length;y++){const x=this.insertKeyframe(p,a.times[y]);p.values[x*d+f]=a.values[y]}}return s.tracks=i,s}});const tn={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},IP="KHR_mesh_quantization",Ia={};Ia[ar]=tn.NEAREST;Ia[yA]=tn.NEAREST_MIPMAP_NEAREST;Ia[Rp]=tn.NEAREST_MIPMAP_LINEAR;Ia[Bs]=tn.LINEAR;Ia[$0]=tn.LINEAR_MIPMAP_NEAREST;Ia[Gl]=tn.LINEAR_MIPMAP_LINEAR;Ia[Pa]=tn.CLAMP_TO_EDGE;Ia[sy]=tn.REPEAT;Ia[ry]=tn.MIRRORED_REPEAT;const $6={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},CLe=new ft,U6=12,TLe=1179937895,ALe=2,F6=8,ELe=1313821514,MLe=5130562;function kx(s,e){return s.length===e.length&&s.every(function(i,n){return i===e[n]})}function kLe(s){return new TextEncoder().encode(s).buffer}function PLe(s){return kx(s.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function ILe(s,e,i){const n={min:new Array(s.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(s.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let r=e;r<e+i;r++)for(let o=0;o<s.itemSize;o++){let a;s.itemSize>4?a=s.array[r*s.itemSize+o]:(o===0?a=s.getX(r):o===1?a=s.getY(r):o===2?a=s.getZ(r):o===3&&(a=s.getW(r)),s.normalized===!0&&(a=hy.normalize(a,s.array))),n.min[o]=Math.min(n.min[o],a),n.max[o]=Math.max(n.max[o],a)}return n}function wq(s){return Math.ceil(s/4)*4}function BP(s,e=0){const i=wq(s.byteLength);if(i!==s.byteLength){const n=new Uint8Array(i);if(n.set(new Uint8Array(s)),e!==0)for(let r=s.byteLength;r<i;r++)n[r]=e;return n.buffer}return s}function z6(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function X6(s,e){if(s.toBlob!==void 0)return new Promise(n=>s.toBlob(n,e));let i;return e==="image/jpeg"?i=.92:e==="image/webp"&&(i=.8),s.convertToBlob({type:e,quality:i})}class BLe{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,i,n={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},n),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const r=this,o=r.buffers,a=r.json;n=r.options;const l=r.extensionsUsed,h=r.extensionsRequired,d=new Blob(o,{type:"application/octet-stream"}),f=Object.keys(l),p=Object.keys(h);f.length>0&&(a.extensionsUsed=f),p.length>0&&(a.extensionsRequired=p),a.buffers&&a.buffers.length>0&&(a.buffers[0].byteLength=d.size),n.binary===!0?d.arrayBuffer().then(g=>{const y=BP(g),x=new DataView(new ArrayBuffer(F6));x.setUint32(0,y.byteLength,!0),x.setUint32(4,MLe,!0);const _=BP(kLe(JSON.stringify(a)),32),w=new DataView(new ArrayBuffer(F6));w.setUint32(0,_.byteLength,!0),w.setUint32(4,ELe,!0);const O=new ArrayBuffer(U6),T=new DataView(O);T.setUint32(0,TLe,!0),T.setUint32(4,ALe,!0);const C=U6+w.byteLength+_.byteLength+x.byteLength+y.byteLength;T.setUint32(8,C,!0),new Blob([O,w,_,x,y],{type:"application/octet-stream"}).arrayBuffer().then(i)}):a.buffers&&a.buffers.length>0?N6(d).then(g=>{a.buffers[0].uri=g,i(a)}):i(a)}serializeUserData(e,i){if(Object.keys(e.userData).length===0)return;const n=this.options,r=this.extensionsUsed;try{const o=JSON.parse(JSON.stringify(e.userData));if(n.includeCustomExtensions&&o.gltfExtensions){i.extensions===void 0&&(i.extensions={});for(const a in o.gltfExtensions)i.extensions[a]=o.gltfExtensions[a],r[a]=!0;delete o.gltfExtensions}Object.keys(o).length>0&&(i.extras=o)}catch(o){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+o.message)}}getUID(e,i=!1){if(this.uids.has(e)===!1){const n=new Map;n.set(!0,this.uid++),n.set(!1,this.uid++),this.uids.set(e,n)}return this.uids.get(e).get(i)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const i=new ie;for(let n=0,r=e.count;n<r;n++)if(Math.abs(i.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const i=this.cache;if(i.attributesNormalized.has(e))return i.attributesNormalized.get(e);const n=e.clone(),r=new ie;for(let o=0,a=n.count;o<a;o++)r.fromBufferAttribute(n,o),r.x===0&&r.y===0&&r.z===0?r.setX(1):r.normalize(),n.setXYZ(o,r.x,r.y,r.z);return i.attributesNormalized.set(e,n),n}applyTextureTransform(e,i){let n=!1;const r={};(i.offset.x!==0||i.offset.y!==0)&&(r.offset=i.offset.toArray(),n=!0),i.rotation!==0&&(r.rotation=i.rotation,n=!0),(i.repeat.x!==1||i.repeat.y!==1)&&(r.scale=i.repeat.toArray(),n=!0),n&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,i){if(e===i)return e;function n(g){return("colorSpace"in g?g.colorSpace==="srgb":g.encoding===3001)?function(y){return y<.04045?y*.0773993808:Math.pow(y*.9478672986+.0521327014,2.4)}:function(y){return y}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof Jp&&(e=PP(e)),i instanceof Jp&&(i=PP(i));const r=e?e.image:null,o=i?i.image:null,a=Math.max(r?r.width:0,o?o.width:0),l=Math.max(r?r.height:0,o?o.height:0),h=z6();h.width=a,h.height=l;const d=h.getContext("2d");d.fillStyle="#00ffff",d.fillRect(0,0,a,l);const f=d.getImageData(0,0,a,l);if(r){d.drawImage(r,0,0,a,l);const g=n(e),y=d.getImageData(0,0,a,l).data;for(let x=2;x<y.length;x+=4)f.data[x]=g(y[x]/256)*256}if(o){d.drawImage(o,0,0,a,l);const g=n(i),y=d.getImageData(0,0,a,l).data;for(let x=1;x<y.length;x+=4)f.data[x]=g(y[x]/256)*256}d.putImageData(f,0,0);const p=(e||i).clone();return p.source=new cs(h).source,"colorSpace"in p?p.colorSpace="":p.encoding=3e3,p.channel=(e||i).channel,e&&i&&e.channel!==i.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),p}processBuffer(e){const i=this.json,n=this.buffers;return i.buffers||(i.buffers=[{byteLength:0}]),n.push(e),0}processBufferView(e,i,n,r,o){const a=this.json;a.bufferViews||(a.bufferViews=[]);let l;switch(i){case tn.BYTE:case tn.UNSIGNED_BYTE:l=1;break;case tn.SHORT:case tn.UNSIGNED_SHORT:l=2;break;default:l=4}const h=wq(r*e.itemSize*l),d=new DataView(new ArrayBuffer(h));let f=0;for(let g=n;g<n+r;g++)for(let y=0;y<e.itemSize;y++){let x;e.itemSize>4?x=e.array[g*e.itemSize+y]:(y===0?x=e.getX(g):y===1?x=e.getY(g):y===2?x=e.getZ(g):y===3&&(x=e.getW(g)),e.normalized===!0&&(x=hy.normalize(x,e.array))),i===tn.FLOAT?d.setFloat32(f,x,!0):i===tn.INT?d.setInt32(f,x,!0):i===tn.UNSIGNED_INT?d.setUint32(f,x,!0):i===tn.SHORT?d.setInt16(f,x,!0):i===tn.UNSIGNED_SHORT?d.setUint16(f,x,!0):i===tn.BYTE?d.setInt8(f,x):i===tn.UNSIGNED_BYTE&&d.setUint8(f,x),f+=l}const p={buffer:this.processBuffer(d.buffer),byteOffset:this.byteOffset,byteLength:h};return o!==void 0&&(p.target=o),o===tn.ARRAY_BUFFER&&(p.byteStride=e.itemSize*l),this.byteOffset+=h,a.bufferViews.push(p),{id:a.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const i=this,n=i.json;return n.bufferViews||(n.bufferViews=[]),e.arrayBuffer().then(r=>{const o=BP(r),a={buffer:i.processBuffer(o),byteOffset:i.byteOffset,byteLength:o.byteLength};return i.byteOffset+=o.byteLength,n.bufferViews.push(a)-1})}processAccessor(e,i,n,r){const o=this.json,a={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let l;if(e.array.constructor===Float32Array)l=tn.FLOAT;else if(e.array.constructor===Int32Array)l=tn.INT;else if(e.array.constructor===Uint32Array)l=tn.UNSIGNED_INT;else if(e.array.constructor===Int16Array)l=tn.SHORT;else if(e.array.constructor===Uint16Array)l=tn.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)l=tn.BYTE;else if(e.array.constructor===Uint8Array)l=tn.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(n===void 0&&(n=0),r===void 0&&(r=e.count),r===0)return null;const h=ILe(e,n,r);let d;i!==void 0&&(d=e===i.index?tn.ELEMENT_ARRAY_BUFFER:tn.ARRAY_BUFFER);const f=this.processBufferView(e,l,n,r,d),p={bufferView:f.id,byteOffset:f.byteOffset,componentType:l,count:r,max:h.max,min:h.min,type:a[e.itemSize]};return e.normalized===!0&&(p.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(p)-1}processImage(e,i,n,r="image/png"){if(e!==null){const o=this,a=o.cache,l=o.json,h=o.options,d=o.pending;a.images.has(e)||a.images.set(e,{});const f=a.images.get(e),p=r+":flipY/"+n.toString();if(f[p]!==void 0)return f[p];l.images||(l.images=[]);const g={mimeType:r},y=z6();y.width=Math.min(e.width,h.maxTextureSize),y.height=Math.min(e.height,h.maxTextureSize);const x=y.getContext("2d");if(n===!0&&(x.translate(0,y.height),x.scale(1,-1)),e.data!==void 0){i!==qo&&console.error("GLTFExporter: Only RGBAFormat is supported.",i),(e.width>h.maxTextureSize||e.height>h.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const w=new Uint8ClampedArray(e.height*e.width*4);for(let O=0;O<w.length;O+=4)w[O+0]=e.data[O+0],w[O+1]=e.data[O+1],w[O+2]=e.data[O+2],w[O+3]=e.data[O+3];x.putImageData(new ImageData(w,e.width,e.height),0,0)}else x.drawImage(e,0,0,y.width,y.height);h.binary===!0?d.push(X6(y,r).then(w=>o.processBufferViewImage(w)).then(w=>{g.bufferView=w})):y.toDataURL!==void 0?g.uri=y.toDataURL(r):d.push(X6(y,r).then(N6).then(w=>{g.uri=w}));const _=l.images.push(g)-1;return f[p]=_,_}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const i=this.json;i.samplers||(i.samplers=[]);const n={magFilter:Ia[e.magFilter],minFilter:Ia[e.minFilter],wrapS:Ia[e.wrapS],wrapT:Ia[e.wrapT]};return i.samplers.push(n)-1}processTexture(e){const i=this.options,n=this.cache,r=this.json;if(n.textures.has(e))return n.textures.get(e);r.textures||(r.textures=[]),e instanceof Jp&&(e=PP(e,i.maxTextureSize));let o=e.userData.mimeType;o==="image/webp"&&(o="image/png");const a={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,o)};e.name&&(a.name=e.name),this._invokeAll(function(h){h.writeTexture&&h.writeTexture(e,a)});const l=r.textures.push(a)-1;return n.textures.set(e,l),l}processMaterial(e){const i=this.cache,n=this.json;if(i.materials.has(e))return i.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;n.materials||(n.materials=[]);const r={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const o=e.color.toArray().concat([e.opacity]);if(kx(o,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=o),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=.5,r.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const l=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),h={index:this.processTexture(l),channel:l.channel};this.applyTextureTransform(h,l),r.pbrMetallicRoughness.metallicRoughnessTexture=h}if(e.map){const l={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(l,e.map),r.pbrMetallicRoughness.baseColorTexture=l}if(e.emissive){const l=e.emissive;if(Math.max(l.r,l.g,l.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const h={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(h,e.emissiveMap),r.emissiveTexture=h}}if(e.normalMap){const l={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(l.scale=e.normalScale.x),this.applyTextureTransform(l,e.normalMap),r.normalTexture=l}if(e.aoMap){const l={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(l.strength=e.aoMapIntensity),this.applyTextureTransform(l,e.aoMap),r.occlusionTexture=l}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),e.side===Wo&&(r.doubleSided=!0),e.name!==""&&(r.name=e.name),this.serializeUserData(e,r),this._invokeAll(function(l){l.writeMaterial&&l.writeMaterial(e,r)});const a=n.materials.push(r)-1;return i.materials.set(e,a),a}processMesh(e){const i=this.cache,n=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let C=0,A=e.material.length;C<A;C++)r.push(e.material[C].uuid);else r.push(e.material.uuid);const o=r.join(":");if(i.meshes.has(o))return i.meshes.get(o);const a=e.geometry;let l;e.isLineSegments?l=tn.LINES:e.isLineLoop?l=tn.LINE_LOOP:e.isLine?l=tn.LINE_STRIP:e.isPoints?l=tn.POINTS:l=e.material.wireframe?tn.LINES:tn.TRIANGLES;const h={},d={},f=[],p=[],g={...bLe>=152?{uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3"}:{uv:"TEXCOORD_0",uv2:"TEXCOORD_1"},color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},y=a.getAttribute("normal");y!==void 0&&!this.isNormalizedNormalAttribute(y)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",this.createNormalizedNormalAttribute(y)));let x=null;for(let C in a.attributes){if(C.slice(0,5)==="morph")continue;const A=a.attributes[C];if(C=g[C]||C.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(C)||(C="_"+C),i.attributes.has(this.getUID(A))){d[C]=i.attributes.get(this.getUID(A));continue}x=null;const B=A.array;C==="JOINTS_0"&&!(B instanceof Uint16Array)&&!(B instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),x=new rn(new Uint16Array(B),A.itemSize,A.normalized));const I=this.processAccessor(x||A,a);I!==null&&(C.startsWith("_")||this.detectMeshQuantization(C,A),d[C]=I,i.attributes.set(this.getUID(A),I))}if(y!==void 0&&a.setAttribute("normal",y),Object.keys(d).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const C=[],A=[],B={};if(e.morphTargetDictionary!==void 0)for(const I in e.morphTargetDictionary)B[e.morphTargetDictionary[I]]=I;for(let I=0;I<e.morphTargetInfluences.length;++I){const R={};let P=!1;for(const k in a.morphAttributes){if(k!=="position"&&k!=="normal"){P||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),P=!0);continue}const E=a.morphAttributes[k][I],D=k.toUpperCase(),L=a.attributes[k];if(i.attributes.has(this.getUID(E,!0))){R[D]=i.attributes.get(this.getUID(E,!0));continue}const V=E.clone();if(!a.morphTargetsRelative)for(let F=0,j=E.count;F<j;F++)for(let Q=0;Q<E.itemSize;Q++)Q===0&&V.setX(F,E.getX(F)-L.getX(F)),Q===1&&V.setY(F,E.getY(F)-L.getY(F)),Q===2&&V.setZ(F,E.getZ(F)-L.getZ(F)),Q===3&&V.setW(F,E.getW(F)-L.getW(F));R[D]=this.processAccessor(V,a),i.attributes.set(this.getUID(L,!0),R[D])}p.push(R),C.push(e.morphTargetInfluences[I]),e.morphTargetDictionary!==void 0&&A.push(B[I])}h.weights=C,A.length>0&&(h.extras={},h.extras.targetNames=A)}const _=Array.isArray(e.material);if(_&&a.groups.length===0)return null;const w=_?e.material:[e.material],O=_?a.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let C=0,A=O.length;C<A;C++){const B={mode:l,attributes:d};if(this.serializeUserData(a,B),p.length>0&&(B.targets=p),a.index!==null){let R=this.getUID(a.index);(O[C].start!==void 0||O[C].count!==void 0)&&(R+=":"+O[C].start+":"+O[C].count),i.attributes.has(R)?B.indices=i.attributes.get(R):(B.indices=this.processAccessor(a.index,a,O[C].start,O[C].count),i.attributes.set(R,B.indices)),B.indices===null&&delete B.indices}const I=this.processMaterial(w[O[C].materialIndex]);I!==null&&(B.material=I),f.push(B)}h.primitives=f,n.meshes||(n.meshes=[]),this._invokeAll(function(C){C.writeMesh&&C.writeMesh(e,h)});const T=n.meshes.push(h)-1;return i.meshes.set(o,T),T}detectMeshQuantization(e,i){if(this.extensionsUsed[IP])return;let n;switch(i.array.constructor){case Int8Array:n="byte";break;case Uint8Array:n="unsigned byte";break;case Int16Array:n="short";break;case Uint16Array:n="unsigned short";break;default:return}i.normalized&&(n+=" normalized");const r=e.split("_",1)[0];V6[r]&&V6[r].includes(n)&&(this.extensionsUsed[IP]=!0,this.extensionsRequired[IP]=!0)}processCamera(e){const i=this.json;i.cameras||(i.cameras=[]);const n=e.isOrthographicCamera,r={type:n?"orthographic":"perspective"};return n?r.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:hy.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(r.name=e.type),i.cameras.push(r)-1}processAnimation(e,i){const n=this.json,r=this.nodeMap;n.animations||(n.animations=[]),e=bq.Utils.mergeMorphTargetTracks(e.clone(),i);const o=e.tracks,a=[],l=[];for(let h=0;h<o.length;++h){const d=o[h],f=ji.parseTrackName(d.name);let p=ji.findNode(i,f.nodeName);const g=$6[f.propertyName];if(f.objectName==="bones"&&(p.isSkinnedMesh===!0?p=p.skeleton.getBoneByName(f.objectIndex):p=void 0),!p||!g)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',d.name),null;const y=1;let x=d.values.length/d.times.length;g===$6.morphTargetInfluences&&(x/=p.morphTargetInfluences.length);let _;d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(_="CUBICSPLINE",x/=3):d.getInterpolation()===ay?_="STEP":_="LINEAR",l.push({input:this.processAccessor(new rn(d.times,y)),output:this.processAccessor(new rn(d.values,x)),interpolation:_}),a.push({sampler:l.length-1,target:{node:r.get(p),path:g}})}return n.animations.push({name:e.name||"clip_"+n.animations.length,samplers:l,channels:a}),n.animations.length-1}processSkin(e){const i=this.json,n=this.nodeMap,r=i.nodes[n.get(e)],o=e.skeleton;if(o===void 0)return null;const a=e.skeleton.bones[0];if(a===void 0)return null;const l=[],h=new Float32Array(o.bones.length*16),d=new ri;for(let f=0;f<o.bones.length;++f)l.push(n.get(o.bones[f])),d.copy(o.boneInverses[f]),d.multiply(e.bindMatrix).toArray(h,f*16);return i.skins===void 0&&(i.skins=[]),i.skins.push({inverseBindMatrices:this.processAccessor(new rn(h,16)),joints:l,skeleton:n.get(a)}),r.skin=i.skins.length-1}processNode(e){const i=this.json,n=this.options,r=this.nodeMap;i.nodes||(i.nodes=[]);const o={};if(n.trs){const l=e.quaternion.toArray(),h=e.position.toArray(),d=e.scale.toArray();kx(l,[0,0,0,1])||(o.rotation=l),kx(h,[0,0,0])||(o.translation=h),kx(d,[1,1,1])||(o.scale=d)}else e.matrixAutoUpdate&&e.updateMatrix(),PLe(e.matrix)===!1&&(o.matrix=e.matrix.elements);if(e.name!==""&&(o.name=String(e.name)),this.serializeUserData(e,o),e.isMesh||e.isLine||e.isPoints){const l=this.processMesh(e);l!==null&&(o.mesh=l)}else e.isCamera&&(o.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const l=[];for(let h=0,d=e.children.length;h<d;h++){const f=e.children[h];if(f.visible||n.onlyVisible===!1){const p=this.processNode(f);p!==null&&l.push(p)}}l.length>0&&(o.children=l)}this._invokeAll(function(l){l.writeNode&&l.writeNode(e,o)});const a=i.nodes.push(o)-1;return r.set(e,a),a}processScene(e){const i=this.json,n=this.options;i.scenes||(i.scenes=[],i.scene=0);const r={};e.name!==""&&(r.name=e.name),i.scenes.push(r);const o=[];for(let a=0,l=e.children.length;a<l;a++){const h=e.children[a];if(h.visible||n.onlyVisible===!1){const d=this.processNode(h);d!==null&&o.push(d)}}o.length>0&&(r.nodes=o),this.serializeUserData(e,r)}processObjects(e){const i=new dy;i.name="AuxScene";for(let n=0;n<e.length;n++)i.children.push(e[n]);this.processScene(i)}processInput(e){const i=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(r){r.beforeParse&&r.beforeParse(e)});const n=[];for(let r=0;r<e.length;r++)e[r]instanceof dy?this.processScene(e[r]):n.push(e[r]);n.length>0&&this.processObjects(n);for(let r=0;r<this.skins.length;++r)this.processSkin(this.skins[r]);for(let r=0;r<i.animations.length;++r)this.processAnimation(i.animations[r],e[0]);this._invokeAll(function(r){r.afterParse&&r.afterParse(e)})}_invokeAll(e){for(let i=0,n=this.plugins.length;i<n;i++)e(this.plugins[i])}}class RLe{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,i){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const n=this.writer,r=n.json,o=n.extensionsUsed,a={};e.name&&(a.name=e.name),a.color=e.color.toArray(),a.intensity=e.intensity,e.isDirectionalLight?a.type="directional":e.isPointLight?(a.type="point",e.distance>0&&(a.range=e.distance)):e.isSpotLight&&(a.type="spot",e.distance>0&&(a.range=e.distance),a.spot={},a.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,a.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),o[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},o[this.name]=!0);const l=r.extensions[this.name].lights;l.push(a),i.extensions=i.extensions||{},i.extensions[this.name]={light:l.length-1}}}let DLe=class{constructor(s){this.writer=s,this.name="KHR_materials_unlit"}writeMaterial(s,e){if(!s.isMeshBasicMaterial)return;const i=this.writer.extensionsUsed;e.extensions=e.extensions||{},e.extensions[this.name]={},i[this.name]=!0,e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9}},LLe=class{constructor(s){this.writer=s,this.name="KHR_materials_clearcoat"}writeMaterial(s,e){if(!s.isMeshPhysicalMaterial||s.clearcoat===0)return;const i=this.writer,n=i.extensionsUsed,r={};if(r.clearcoatFactor=s.clearcoat,s.clearcoatMap){const o={index:i.processTexture(s.clearcoatMap),texCoord:s.clearcoatMap.channel};i.applyTextureTransform(o,s.clearcoatMap),r.clearcoatTexture=o}if(r.clearcoatRoughnessFactor=s.clearcoatRoughness,s.clearcoatRoughnessMap){const o={index:i.processTexture(s.clearcoatRoughnessMap),texCoord:s.clearcoatRoughnessMap.channel};i.applyTextureTransform(o,s.clearcoatRoughnessMap),r.clearcoatRoughnessTexture=o}if(s.clearcoatNormalMap){const o={index:i.processTexture(s.clearcoatNormalMap),texCoord:s.clearcoatNormalMap.channel};i.applyTextureTransform(o,s.clearcoatNormalMap),r.clearcoatNormalTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},NLe=class{constructor(s){this.writer=s,this.name="KHR_materials_iridescence"}writeMaterial(s,e){if(!s.isMeshPhysicalMaterial||s.iridescence===0)return;const i=this.writer,n=i.extensionsUsed,r={};if(r.iridescenceFactor=s.iridescence,s.iridescenceMap){const o={index:i.processTexture(s.iridescenceMap),texCoord:s.iridescenceMap.channel};i.applyTextureTransform(o,s.iridescenceMap),r.iridescenceTexture=o}if(r.iridescenceIor=s.iridescenceIOR,r.iridescenceThicknessMinimum=s.iridescenceThicknessRange[0],r.iridescenceThicknessMaximum=s.iridescenceThicknessRange[1],s.iridescenceThicknessMap){const o={index:i.processTexture(s.iridescenceThicknessMap),texCoord:s.iridescenceThicknessMap.channel};i.applyTextureTransform(o,s.iridescenceThicknessMap),r.iridescenceThicknessTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},VLe=class{constructor(s){this.writer=s,this.name="KHR_materials_transmission"}writeMaterial(s,e){if(!s.isMeshPhysicalMaterial||s.transmission===0)return;const i=this.writer,n=i.extensionsUsed,r={};if(r.transmissionFactor=s.transmission,s.transmissionMap){const o={index:i.processTexture(s.transmissionMap),texCoord:s.transmissionMap.channel};i.applyTextureTransform(o,s.transmissionMap),r.transmissionTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},$Le=class{constructor(s){this.writer=s,this.name="KHR_materials_volume"}writeMaterial(s,e){if(!s.isMeshPhysicalMaterial||s.transmission===0)return;const i=this.writer,n=i.extensionsUsed,r={};if(r.thicknessFactor=s.thickness,s.thicknessMap){const o={index:i.processTexture(s.thicknessMap),texCoord:s.thicknessMap.channel};i.applyTextureTransform(o,s.thicknessMap),r.thicknessTexture=o}r.attenuationDistance=s.attenuationDistance,r.attenuationColor=s.attenuationColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},ULe=class{constructor(s){this.writer=s,this.name="KHR_materials_ior"}writeMaterial(s,e){if(!s.isMeshPhysicalMaterial||s.ior===1.5)return;const i=this.writer.extensionsUsed,n={};n.ior=s.ior,e.extensions=e.extensions||{},e.extensions[this.name]=n,i[this.name]=!0}},FLe=class{constructor(s){this.writer=s,this.name="KHR_materials_specular"}writeMaterial(s,e){if(!s.isMeshPhysicalMaterial||s.specularIntensity===1&&s.specularColor.equals(CLe)&&!s.specularIntensityMap&&!s.specularColorTexture)return;const i=this.writer,n=i.extensionsUsed,r={};if(s.specularIntensityMap){const o={index:i.processTexture(s.specularIntensityMap),texCoord:s.specularIntensityMap.channel};i.applyTextureTransform(o,s.specularIntensityMap),r.specularTexture=o}if(s.specularColorMap){const o={index:i.processTexture(s.specularColorMap),texCoord:s.specularColorMap.channel};i.applyTextureTransform(o,s.specularColorMap),r.specularColorTexture=o}r.specularFactor=s.specularIntensity,r.specularColorFactor=s.specularColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},zLe=class{constructor(s){this.writer=s,this.name="KHR_materials_sheen"}writeMaterial(s,e){if(!s.isMeshPhysicalMaterial||s.sheen==0)return;const i=this.writer,n=i.extensionsUsed,r={};if(s.sheenRoughnessMap){const o={index:i.processTexture(s.sheenRoughnessMap),texCoord:s.sheenRoughnessMap.channel};i.applyTextureTransform(o,s.sheenRoughnessMap),r.sheenRoughnessTexture=o}if(s.sheenColorMap){const o={index:i.processTexture(s.sheenColorMap),texCoord:s.sheenColorMap.channel};i.applyTextureTransform(o,s.sheenColorMap),r.sheenColorTexture=o}r.sheenRoughnessFactor=s.sheenRoughness,r.sheenColorFactor=s.sheenColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},XLe=class{constructor(s){this.writer=s,this.name="KHR_materials_anisotropy"}writeMaterial(s,e){if(!s.isMeshPhysicalMaterial||s.anisotropy==0)return;const i=this.writer,n=i.extensionsUsed,r={};if(s.anisotropyMap){const o={index:i.processTexture(s.anisotropyMap)};i.applyTextureTransform(o,s.anisotropyMap),r.anisotropyTexture=o}r.anisotropyStrength=s.anisotropy,r.anisotropyRotation=s.anisotropyRotation,e.extensions=e.extensions||{},e.extensions[this.name]=r,n[this.name]=!0}},WLe=class{constructor(s){this.writer=s,this.name="KHR_materials_emissive_strength"}writeMaterial(s,e){if(!s.isMeshStandardMaterial||s.emissiveIntensity===1)return;const i=this.writer.extensionsUsed,n={};n.emissiveStrength=s.emissiveIntensity,e.extensions=e.extensions||{},e.extensions[this.name]=n,i[this.name]=!0}};var Vb=Uint8Array,Oq=Uint16Array,HLe=Uint32Array,GLe=new Vb([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),QLe=new Vb([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Sq=function(s,e){for(var i=new Oq(31),n=0;n<31;++n)i[n]=e+=1<<s[n-1];for(var r=new HLe(i[30]),n=1;n<30;++n)for(var o=i[n];o<i[n+1];++o)r[o]=o-i[n]<<5|n;return[i,r]},Cq=Sq(GLe,2),YLe=Cq[0],jLe=Cq[1];YLe[28]=258,jLe[258]=28;Sq(QLe,0);var qLe=new Oq(32768);for(var Kn=0;Kn<32768;++Kn){var dd=(Kn&43690)>>>1|(Kn&21845)<<1;dd=(dd&52428)>>>2|(dd&13107)<<2,dd=(dd&61680)>>>4|(dd&3855)<<4,qLe[Kn]=((dd&65280)>>>8|(dd&255)<<8)>>>1}var ZA=new Vb(288);for(var Kn=0;Kn<144;++Kn)ZA[Kn]=8;for(var Kn=144;Kn<256;++Kn)ZA[Kn]=9;for(var Kn=256;Kn<280;++Kn)ZA[Kn]=7;for(var Kn=280;Kn<288;++Kn)ZA[Kn]=8;var ZLe=new Vb(32);for(var Kn=0;Kn<32;++Kn)ZLe[Kn]=5;var KLe=new Vb(0),JLe=typeof TextDecoder<"u"&&new TextDecoder,e3e=0;try{JLe.decode(KLe,{stream:!0}),e3e=1}catch{}new Ho;new ie;new To(0,0,0,"YXZ");new ie;var t3e=Object.defineProperty,i3e=(s,e,i)=>e in s?t3e(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i,xi=(s,e,i)=>(i3e(s,typeof e!="symbol"?e+"":e,i),i);const wO=new km,W6=new Xl,n3e=Math.cos(70*(Math.PI/180)),H6=(s,e)=>(s%e+e)%e;class s3e extends ch{constructor(e,i){super(),xi(this,"object"),xi(this,"domElement"),xi(this,"enabled",!0),xi(this,"target",new ie),xi(this,"minDistance",0),xi(this,"maxDistance",1/0),xi(this,"minZoom",0),xi(this,"maxZoom",1/0),xi(this,"minPolarAngle",0),xi(this,"maxPolarAngle",Math.PI),xi(this,"minAzimuthAngle",-1/0),xi(this,"maxAzimuthAngle",1/0),xi(this,"enableDamping",!1),xi(this,"dampingFactor",.05),xi(this,"enableZoom",!0),xi(this,"zoomSpeed",1),xi(this,"enableRotate",!0),xi(this,"rotateSpeed",1),xi(this,"enablePan",!0),xi(this,"panSpeed",1),xi(this,"screenSpacePanning",!0),xi(this,"keyPanSpeed",7),xi(this,"zoomToCursor",!1),xi(this,"autoRotate",!1),xi(this,"autoRotateSpeed",2),xi(this,"reverseOrbit",!1),xi(this,"reverseHorizontalOrbit",!1),xi(this,"reverseVerticalOrbit",!1),xi(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),xi(this,"mouseButtons",{LEFT:bp.ROTATE,MIDDLE:bp.DOLLY,RIGHT:bp.PAN}),xi(this,"touches",{ONE:Wh.ROTATE,TWO:Wh.DOLLY_PAN}),xi(this,"target0"),xi(this,"position0"),xi(this,"zoom0"),xi(this,"_domElementKeyEvents",null),xi(this,"getPolarAngle"),xi(this,"getAzimuthalAngle"),xi(this,"setPolarAngle"),xi(this,"setAzimuthalAngle"),xi(this,"getDistance"),xi(this,"listenToKeyEvents"),xi(this,"stopListenToKeyEvents"),xi(this,"saveState"),xi(this,"reset"),xi(this,"update"),xi(this,"connect"),xi(this,"dispose"),this.object=e,this.domElement=i,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>f.phi,this.getAzimuthalAngle=()=>f.theta,this.setPolarAngle=_e=>{let $e=H6(_e,2*Math.PI),fe=f.phi;fe<0&&(fe+=2*Math.PI),$e<0&&($e+=2*Math.PI);let Ve=Math.abs($e-fe);2*Math.PI-Ve<Ve&&($e<fe?$e+=2*Math.PI:fe+=2*Math.PI),p.phi=$e-fe,n.update()},this.setAzimuthalAngle=_e=>{let $e=H6(_e,2*Math.PI),fe=f.theta;fe<0&&(fe+=2*Math.PI),$e<0&&($e+=2*Math.PI);let Ve=Math.abs($e-fe);2*Math.PI-Ve<Ve&&($e<fe?$e+=2*Math.PI:fe+=2*Math.PI),p.theta=$e-fe,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=_e=>{_e.addEventListener("keydown",yt),this._domElementKeyEvents=_e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",yt),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),h=l.NONE},this.update=(()=>{const _e=new ie,$e=new ie(0,1,0),fe=new Zr().setFromUnitVectors(e.up,$e),Ve=fe.clone().invert(),Xe=new ie,at=new Zr,pt=2*Math.PI;return function(){const Gi=n.object.position;fe.setFromUnitVectors(e.up,$e),Ve.copy(fe).invert(),_e.copy(Gi).sub(n.target),_e.applyQuaternion(fe),f.setFromVector3(_e),n.autoRotate&&h===l.NONE&&F(L()),n.enableDamping?(f.theta+=p.theta*n.dampingFactor,f.phi+=p.phi*n.dampingFactor):(f.theta+=p.theta,f.phi+=p.phi);let Qi=n.minAzimuthAngle,ln=n.maxAzimuthAngle;isFinite(Qi)&&isFinite(ln)&&(Qi<-Math.PI?Qi+=pt:Qi>Math.PI&&(Qi-=pt),ln<-Math.PI?ln+=pt:ln>Math.PI&&(ln-=pt),Qi<=ln?f.theta=Math.max(Qi,Math.min(ln,f.theta)):f.theta=f.theta>(Qi+ln)/2?Math.max(Qi,f.theta):Math.min(ln,f.theta)),f.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,f.phi)),f.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(y,n.dampingFactor):n.target.add(y),n.zoomToCursor&&k||n.object.isOrthographicCamera?f.radius=Ue(f.radius):f.radius=Ue(f.radius*g),_e.setFromSpherical(f),_e.applyQuaternion(Ve),Gi.copy(n.target).add(_e),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(p.theta*=1-n.dampingFactor,p.phi*=1-n.dampingFactor,y.multiplyScalar(1-n.dampingFactor)):(p.set(0,0,0),y.set(0,0,0));let is=!1;if(n.zoomToCursor&&k){let zi=null;if(n.object instanceof Rn&&n.object.isPerspectiveCamera){const dr=_e.length();zi=Ue(dr*g);const us=dr-zi;n.object.position.addScaledVector(R,us),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const dr=new ie(P.x,P.y,0);dr.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/g)),n.object.updateProjectionMatrix(),is=!0;const us=new ie(P.x,P.y,0);us.unproject(n.object),n.object.position.sub(us).add(dr),n.object.updateMatrixWorld(),zi=_e.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;zi!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(zi).add(n.object.position):(wO.origin.copy(n.object.position),wO.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(wO.direction))<n3e?e.lookAt(n.target):(W6.setFromNormalAndCoplanarPoint(n.object.up,n.target),wO.intersectPlane(W6,n.target))))}else n.object instanceof Ql&&n.object.isOrthographicCamera&&(is=g!==1,is&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/g)),n.object.updateProjectionMatrix()));return g=1,k=!1,is||Xe.distanceToSquared(n.object.position)>d||8*(1-at.dot(n.object.quaternion))>d?(n.dispatchEvent(r),Xe.copy(n.object.position),at.copy(n.object.quaternion),is=!1,!0):!1}})(),this.connect=_e=>{_e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=_e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",ti),n.domElement.addEventListener("pointerdown",ce),n.domElement.addEventListener("pointercancel",Ae),n.domElement.addEventListener("wheel",Qe,{passive:!0})},this.dispose=()=>{var _e,$e,fe,Ve,Xe,at;n.domElement&&(n.domElement.style.touchAction="auto"),(_e=n.domElement)==null||_e.removeEventListener("contextmenu",ti),($e=n.domElement)==null||$e.removeEventListener("pointerdown",ce),(fe=n.domElement)==null||fe.removeEventListener("pointercancel",Ae),(Ve=n.domElement)==null||Ve.removeEventListener("wheel",Qe),(Xe=n.domElement)==null||Xe.ownerDocument.removeEventListener("pointermove",de),(at=n.domElement)==null||at.ownerDocument.removeEventListener("pointerup",Oe),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",yt)};const n=this,r={type:"change"},o={type:"start"},a={type:"end"},l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let h=l.NONE;const d=1e-6,f=new DB,p=new DB;let g=1;const y=new ie,x=new Fe,_=new Fe,w=new Fe,O=new Fe,T=new Fe,C=new Fe,A=new Fe,B=new Fe,I=new Fe,R=new ie,P=new Fe;let k=!1;const E=[],D={};function L(){return 2*Math.PI/60/60*n.autoRotateSpeed}function V(){return Math.pow(.95,n.zoomSpeed)}function F(_e){n.reverseOrbit||n.reverseHorizontalOrbit?p.theta+=_e:p.theta-=_e}function j(_e){n.reverseOrbit||n.reverseVerticalOrbit?p.phi+=_e:p.phi-=_e}const Q=(()=>{const _e=new ie;return function($e,fe){_e.setFromMatrixColumn(fe,0),_e.multiplyScalar(-$e),y.add(_e)}})(),ee=(()=>{const _e=new ie;return function($e,fe){n.screenSpacePanning===!0?_e.setFromMatrixColumn(fe,1):(_e.setFromMatrixColumn(fe,0),_e.crossVectors(n.object.up,_e)),_e.multiplyScalar($e),y.add(_e)}})(),J=(()=>{const _e=new ie;return function($e,fe){const Ve=n.domElement;if(Ve&&n.object instanceof Rn&&n.object.isPerspectiveCamera){const Xe=n.object.position;_e.copy(Xe).sub(n.target);let at=_e.length();at*=Math.tan(n.object.fov/2*Math.PI/180),Q(2*$e*at/Ve.clientHeight,n.object.matrix),ee(2*fe*at/Ve.clientHeight,n.object.matrix)}else Ve&&n.object instanceof Ql&&n.object.isOrthographicCamera?(Q($e*(n.object.right-n.object.left)/n.object.zoom/Ve.clientWidth,n.object.matrix),ee(fe*(n.object.top-n.object.bottom)/n.object.zoom/Ve.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function ue(_e){n.object instanceof Rn&&n.object.isPerspectiveCamera||n.object instanceof Ql&&n.object.isOrthographicCamera?g/=_e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function oe(_e){n.object instanceof Rn&&n.object.isPerspectiveCamera||n.object instanceof Ql&&n.object.isOrthographicCamera?g*=_e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function pe(_e){if(!n.zoomToCursor||!n.domElement)return;k=!0;const $e=n.domElement.getBoundingClientRect(),fe=_e.clientX-$e.left,Ve=_e.clientY-$e.top,Xe=$e.width,at=$e.height;P.x=fe/Xe*2-1,P.y=-(Ve/at)*2+1,R.set(P.x,P.y,1).unproject(n.object).sub(n.object.position).normalize()}function Ue(_e){return Math.max(n.minDistance,Math.min(n.maxDistance,_e))}function tt(_e){x.set(_e.clientX,_e.clientY)}function ve(_e){pe(_e),A.set(_e.clientX,_e.clientY)}function Re(_e){O.set(_e.clientX,_e.clientY)}function Le(_e){_.set(_e.clientX,_e.clientY),w.subVectors(_,x).multiplyScalar(n.rotateSpeed);const $e=n.domElement;$e&&(F(2*Math.PI*w.x/$e.clientHeight),j(2*Math.PI*w.y/$e.clientHeight)),x.copy(_),n.update()}function De(_e){B.set(_e.clientX,_e.clientY),I.subVectors(B,A),I.y>0?ue(V()):I.y<0&&oe(V()),A.copy(B),n.update()}function Se(_e){T.set(_e.clientX,_e.clientY),C.subVectors(T,O).multiplyScalar(n.panSpeed),J(C.x,C.y),O.copy(T),n.update()}function Y(_e){pe(_e),_e.deltaY<0?oe(V()):_e.deltaY>0&&ue(V()),n.update()}function W(_e){let $e=!1;switch(_e.code){case n.keys.UP:J(0,n.keyPanSpeed),$e=!0;break;case n.keys.BOTTOM:J(0,-n.keyPanSpeed),$e=!0;break;case n.keys.LEFT:J(n.keyPanSpeed,0),$e=!0;break;case n.keys.RIGHT:J(-n.keyPanSpeed,0),$e=!0;break}$e&&(_e.preventDefault(),n.update())}function te(){if(E.length==1)x.set(E[0].pageX,E[0].pageY);else{const _e=.5*(E[0].pageX+E[1].pageX),$e=.5*(E[0].pageY+E[1].pageY);x.set(_e,$e)}}function ae(){if(E.length==1)O.set(E[0].pageX,E[0].pageY);else{const _e=.5*(E[0].pageX+E[1].pageX),$e=.5*(E[0].pageY+E[1].pageY);O.set(_e,$e)}}function z(){const _e=E[0].pageX-E[1].pageX,$e=E[0].pageY-E[1].pageY,fe=Math.sqrt(_e*_e+$e*$e);A.set(0,fe)}function q(){n.enableZoom&&z(),n.enablePan&&ae()}function le(){n.enableZoom&&z(),n.enableRotate&&te()}function he(_e){if(E.length==1)_.set(_e.pageX,_e.pageY);else{const fe=Ai(_e),Ve=.5*(_e.pageX+fe.x),Xe=.5*(_e.pageY+fe.y);_.set(Ve,Xe)}w.subVectors(_,x).multiplyScalar(n.rotateSpeed);const $e=n.domElement;$e&&(F(2*Math.PI*w.x/$e.clientHeight),j(2*Math.PI*w.y/$e.clientHeight)),x.copy(_)}function be(_e){if(E.length==1)T.set(_e.pageX,_e.pageY);else{const $e=Ai(_e),fe=.5*(_e.pageX+$e.x),Ve=.5*(_e.pageY+$e.y);T.set(fe,Ve)}C.subVectors(T,O).multiplyScalar(n.panSpeed),J(C.x,C.y),O.copy(T)}function Ee(_e){const $e=Ai(_e),fe=_e.pageX-$e.x,Ve=_e.pageY-$e.y,Xe=Math.sqrt(fe*fe+Ve*Ve);B.set(0,Xe),I.set(0,Math.pow(B.y/A.y,n.zoomSpeed)),ue(I.y),A.copy(B)}function Z(_e){n.enableZoom&&Ee(_e),n.enablePan&&be(_e)}function G(_e){n.enableZoom&&Ee(_e),n.enableRotate&&he(_e)}function ce(_e){var $e,fe;n.enabled!==!1&&(E.length===0&&(($e=n.domElement)==null||$e.ownerDocument.addEventListener("pointermove",de),(fe=n.domElement)==null||fe.ownerDocument.addEventListener("pointerup",Oe)),Ht(_e),_e.pointerType==="touch"?Ke(_e):je(_e))}function de(_e){n.enabled!==!1&&(_e.pointerType==="touch"?ht(_e):Ge(_e))}function Oe(_e){var $e,fe,Ve;Tt(_e),E.length===0&&(($e=n.domElement)==null||$e.releasePointerCapture(_e.pointerId),(fe=n.domElement)==null||fe.ownerDocument.removeEventListener("pointermove",de),(Ve=n.domElement)==null||Ve.ownerDocument.removeEventListener("pointerup",Oe)),n.dispatchEvent(a),h=l.NONE}function Ae(_e){Tt(_e)}function je(_e){let $e;switch(_e.button){case 0:$e=n.mouseButtons.LEFT;break;case 1:$e=n.mouseButtons.MIDDLE;break;case 2:$e=n.mouseButtons.RIGHT;break;default:$e=-1}switch($e){case bp.DOLLY:if(n.enableZoom===!1)return;ve(_e),h=l.DOLLY;break;case bp.ROTATE:if(_e.ctrlKey||_e.metaKey||_e.shiftKey){if(n.enablePan===!1)return;Re(_e),h=l.PAN}else{if(n.enableRotate===!1)return;tt(_e),h=l.ROTATE}break;case bp.PAN:if(_e.ctrlKey||_e.metaKey||_e.shiftKey){if(n.enableRotate===!1)return;tt(_e),h=l.ROTATE}else{if(n.enablePan===!1)return;Re(_e),h=l.PAN}break;default:h=l.NONE}h!==l.NONE&&n.dispatchEvent(o)}function Ge(_e){if(n.enabled!==!1)switch(h){case l.ROTATE:if(n.enableRotate===!1)return;Le(_e);break;case l.DOLLY:if(n.enableZoom===!1)return;De(_e);break;case l.PAN:if(n.enablePan===!1)return;Se(_e);break}}function Qe(_e){n.enabled===!1||n.enableZoom===!1||h!==l.NONE&&h!==l.ROTATE||(n.dispatchEvent(o),Y(_e),n.dispatchEvent(a))}function yt(_e){n.enabled===!1||n.enablePan===!1||W(_e)}function Ke(_e){switch(pi(_e),E.length){case 1:switch(n.touches.ONE){case Wh.ROTATE:if(n.enableRotate===!1)return;te(),h=l.TOUCH_ROTATE;break;case Wh.PAN:if(n.enablePan===!1)return;ae(),h=l.TOUCH_PAN;break;default:h=l.NONE}break;case 2:switch(n.touches.TWO){case Wh.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;q(),h=l.TOUCH_DOLLY_PAN;break;case Wh.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;le(),h=l.TOUCH_DOLLY_ROTATE;break;default:h=l.NONE}break;default:h=l.NONE}h!==l.NONE&&n.dispatchEvent(o)}function ht(_e){switch(pi(_e),h){case l.TOUCH_ROTATE:if(n.enableRotate===!1)return;he(_e),n.update();break;case l.TOUCH_PAN:if(n.enablePan===!1)return;be(_e),n.update();break;case l.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Z(_e),n.update();break;case l.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;G(_e),n.update();break;default:h=l.NONE}}function ti(_e){n.enabled!==!1&&_e.preventDefault()}function Ht(_e){E.push(_e)}function Tt(_e){delete D[_e.pointerId];for(let $e=0;$e<E.length;$e++)if(E[$e].pointerId==_e.pointerId){E.splice($e,1);return}}function pi(_e){let $e=D[_e.pointerId];$e===void 0&&($e=new Fe,D[_e.pointerId]=$e),$e.set(_e.pageX,_e.pageY)}function Ai(_e){const $e=_e.pointerId===E[0].pointerId?E[1]:E[0];return D[$e.pointerId]}i!==void 0&&this.connect(i),this.update()}}new ri;new ie;new To;new ie;var r3e=Object.defineProperty,o3e=(s,e,i)=>e in s?r3e(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i,d3=(s,e,i)=>(o3e(s,typeof e!="symbol"?e+"":e,i),i);class Tq{constructor(e){d3(this,"data"),this.data=e}generateShapes(e,i=100,n){const r=[],o={letterSpacing:0,lineHeight:1,...n},a=a3e(e,i,this.data,o);for(let l=0,h=a.length;l<h;l++)Array.prototype.push.apply(r,a[l].toShapes(!1));return r}}d3(Tq,"isFont");d3(Tq,"type");function a3e(s,e,i,n){const r=Array.from(s),o=e/i.resolution,a=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*o,l=[];let h=0,d=0;for(let f=0;f<r.length;f++){const p=r[f];if(p===`
`)h=0,d-=a*n.lineHeight;else{const g=l3e(p,o,h,d,i);g&&(h+=g.offsetX+n.letterSpacing,l.push(g.path))}}return l}function l3e(s,e,i,n,r){const o=r.glyphs[s]||r.glyphs["?"];if(!o){console.error('THREE.Font: character "'+s+'" does not exists in font family '+r.familyName+".");return}const a=new pj;let l,h,d,f,p,g,y,x;if(o.o){const _=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let w=0,O=_.length;w<O;)switch(_[w++]){case"m":l=parseInt(_[w++])*e+i,h=parseInt(_[w++])*e+n,a.moveTo(l,h);break;case"l":l=parseInt(_[w++])*e+i,h=parseInt(_[w++])*e+n,a.lineTo(l,h);break;case"q":d=parseInt(_[w++])*e+i,f=parseInt(_[w++])*e+n,p=parseInt(_[w++])*e+i,g=parseInt(_[w++])*e+n,a.quadraticCurveTo(p,g,d,f);break;case"b":d=parseInt(_[w++])*e+i,f=parseInt(_[w++])*e+n,p=parseInt(_[w++])*e+i,g=parseInt(_[w++])*e+n,y=parseInt(_[w++])*e+i,x=parseInt(_[w++])*e+n,a.bezierCurveTo(p,g,y,x,d,f);break}}return{offsetX:o.ha*e,path:a}}class X_ extends Dn{constructor(e,i={}){super(e),this.isReflector=!0,this.type="Reflector",this.camera=new Rn;const n=this,r=i.color!==void 0?new ft(i.color):new ft(8355711),o=i.textureWidth||512,a=i.textureHeight||512,l=i.clipBias||0,h=i.shader||X_.ReflectorShader,d=i.multisample!==void 0?i.multisample:4,f=new Xl,p=new ie,g=new ie,y=new ie,x=new ri,_=new ie(0,0,-1),w=new sn,O=new ie,T=new ie,C=new sn,A=new ri,B=this.camera,I=new gl(o,a,{samples:d,type:Py}),R=new Ao({name:h.name!==void 0?h.name:"unspecified",uniforms:Ob.clone(h.uniforms),fragmentShader:h.fragmentShader,vertexShader:h.vertexShader});R.uniforms.tDiffuse.value=I.texture,R.uniforms.color.value=r,R.uniforms.textureMatrix.value=A,this.material=R,this.onBeforeRender=function(P,k,E){if(g.setFromMatrixPosition(n.matrixWorld),y.setFromMatrixPosition(E.matrixWorld),x.extractRotation(n.matrixWorld),p.set(0,0,1),p.applyMatrix4(x),O.subVectors(g,y),O.dot(p)>0)return;O.reflect(p).negate(),O.add(g),x.extractRotation(E.matrixWorld),_.set(0,0,-1),_.applyMatrix4(x),_.add(y),T.subVectors(g,_),T.reflect(p).negate(),T.add(g),B.position.copy(O),B.up.set(0,1,0),B.up.applyMatrix4(x),B.up.reflect(p),B.lookAt(T),B.far=E.far,B.updateMatrixWorld(),B.projectionMatrix.copy(E.projectionMatrix),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(B.projectionMatrix),A.multiply(B.matrixWorldInverse),A.multiply(n.matrixWorld),f.setFromNormalAndCoplanarPoint(p,g),f.applyMatrix4(B.matrixWorldInverse),w.set(f.normal.x,f.normal.y,f.normal.z,f.constant);const D=B.projectionMatrix;C.x=(Math.sign(w.x)+D.elements[8])/D.elements[0],C.y=(Math.sign(w.y)+D.elements[9])/D.elements[5],C.z=-1,C.w=(1+D.elements[10])/D.elements[14],w.multiplyScalar(2/w.dot(C)),D.elements[2]=w.x,D.elements[6]=w.y,D.elements[10]=w.z+1-l,D.elements[14]=w.w,n.visible=!1;const L=P.getRenderTarget(),V=P.xr.enabled,F=P.shadowMap.autoUpdate;P.xr.enabled=!1,P.shadowMap.autoUpdate=!1,P.setRenderTarget(I),P.state.buffers.depth.setMask(!0),P.autoClear===!1&&P.clear(),P.render(k,B),P.xr.enabled=V,P.shadowMap.autoUpdate=F,P.setRenderTarget(L);const j=E.viewport;j!==void 0&&P.state.viewport(j),n.visible=!0},this.getRenderTarget=function(){return I},this.dispose=function(){I.dispose(),n.material.dispose()}}}X_.ReflectorShader={name:"ReflectorShader",uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};const c3e=["args","material-uniforms-color-value"],h3e=Kt("TresPlaneGeometry",{args:[5,5]},null,-1);X_.ReflectorShader;function u3e(s){return $T()?(JR(s),!0):!1}function Aq(s){return typeof s=="function"?s():ni(s)}const d3e=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const f3e=Object.prototype.toString,p3e=s=>f3e.call(s)==="[object Object]",m3e=()=>{};function g3e(s){var e;const i=Aq(s);return(e=i==null?void 0:i.$el)!=null?e:i}const y3e=d3e?window:void 0;function RP(...s){let e,i,n,r;if(typeof s[0]=="string"||Array.isArray(s[0])?([i,n,r]=s,e=y3e):[e,i,n,r]=s,!e)return m3e;Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n]);const o=[],a=()=>{o.forEach(f=>f()),o.length=0},l=(f,p,g,y)=>(f.addEventListener(p,g,y),()=>f.removeEventListener(p,g,y)),h=an(()=>[g3e(e),Aq(r)],([f,p])=>{if(a(),!f)return;const g=p3e(p)?{...p}:p;o.push(...i.flatMap(y=>n.map(x=>l(f,y,x,g))))},{immediate:!0,flush:"post"}),d=()=>{h(),a()};return u3e(d),d}class JC extends Dn{constructor(){super(JC.Geometry,new lc({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const e=new ie,i=new ie,n=new MB(16,16),r=new MB(16,16);let o=sc;const a=JC.Geometry,l=new qx({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),h=new qx({uniforms:{map:{value:n},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),d=new Dn(a,l),f=[],p=Eq.Shader,g=new qx({name:p.name,uniforms:{map:{value:null},occlusionMap:{value:r},color:{value:new ft(16777215)},scale:{value:new Fe},screenPosition:{value:new ie}},vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,blending:XC,transparent:!0,depthWrite:!1}),y=new Dn(a,g);this.addElement=function(T){f.push(T)};const x=new Fe,_=new Fe,w=new uj,O=new sn;this.onBeforeRender=function(T,C,A){T.getCurrentViewport(O);const B=T.getRenderTarget(),I=B!==null?B.texture.type:sc;o!==I&&(n.dispose(),r.dispose(),n.type=r.type=I,o=I);const R=O.w/O.z,P=O.z/2,k=O.w/2;let E=16/O.w;if(x.set(E*R,E),w.min.set(O.x,O.y),w.max.set(O.x+(O.z-16),O.y+(O.w-16)),i.setFromMatrixPosition(this.matrixWorld),i.applyMatrix4(A.matrixWorldInverse),!(i.z>0)&&(e.copy(i).applyMatrix4(A.projectionMatrix),_.x=O.x+e.x*P+P-8,_.y=O.y+e.y*k+k-8,w.containsPoint(_))){T.copyFramebufferToTexture(_,n);let D=l.uniforms;D.scale.value=x,D.screenPosition.value=e,T.renderBufferDirect(A,null,a,l,d,null),T.copyFramebufferToTexture(_,r),D=h.uniforms,D.scale.value=x,D.screenPosition.value=e,T.renderBufferDirect(A,null,a,h,d,null);const L=-e.x*2,V=-e.y*2;for(let F=0,j=f.length;F<j;F++){const Q=f[F],ee=g.uniforms;ee.color.value.copy(Q.color),ee.map.value=Q.texture,ee.screenPosition.value.x=e.x+L*Q.distance,ee.screenPosition.value.y=e.y+V*Q.distance,E=Q.size/O.w;const J=O.w/O.z;ee.scale.value.set(E*J,E),g.uniformsNeedUpdate=!0,T.renderBufferDirect(A,null,a,g,y,null)}}},this.dispose=function(){l.dispose(),h.dispose(),g.dispose(),n.dispose(),r.dispose();for(let T=0,C=f.length;T<C;T++)f[T].texture.dispose()}}}class Eq{constructor(e,i=1,n=0,r=new ft(16777215)){this.texture=e,this.size=i,this.distance=n,this.color=r}}Eq.Shader={name:"LensflareElementShader",uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:`

		precision highp float;

		uniform vec3 screenPosition;
		uniform vec2 scale;

		uniform sampler2D occlusionMap;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vUV = uv;

			vec2 pos = position.xy;

			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );

			vVisibility =        visibility.r / 9.0;
			vVisibility *= 1.0 - visibility.g / 9.0;
			vVisibility *=       visibility.b / 9.0;

			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D map;
		uniform vec3 color;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vec4 texture = texture2D( map, vUV );
			texture.a *= vVisibility;
			gl_FragColor = texture;
			gl_FragColor.rgb *= color;

		}`};JC.Geometry=function(){const s=new $i,e=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),i=new Ab(e,5);return s.setIndex([0,1,2,0,2,3]),s.setAttribute("position",new xu(i,3,0,!1)),s.setAttribute("uv",new xu(i,2,3,!1)),s}();hy.clamp;hy.lerp;const v3e=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","args"],f3=fu({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:Wh.ROTATE,TWO:Wh.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(s,{expose:e,emit:i}){const n=s,r=i,{makeDefault:o,autoRotate:a,autoRotateSpeed:l,enableDamping:h,dampingFactor:d,enablePan:f,keyPanSpeed:p,maxAzimuthAngle:g,minAzimuthAngle:y,maxPolarAngle:x,minPolarAngle:_,minDistance:w,maxDistance:O,minZoom:T,maxZoom:C,enableZoom:A,zoomSpeed:B,enableRotate:I,touches:R,rotateSpeed:P,target:k}=ub(n),{camera:E,renderer:D,extend:L,controls:V}=NL(),F=gt(null);L({OrbitControls:s3e}),an(F,ee=>{j(),ee&&o.value?V.value=ee:V.value=null});function j(){RP(F.value,"change",()=>r("change",F.value)),RP(F.value,"start",()=>r("start",F.value)),RP(F.value,"end",()=>r("end",F.value))}const{onLoop:Q}=Ly();return Q(()=>{F.value&&(h.value||a.value)&&F.value.update()}),ra(()=>{F.value&&F.value.dispose()}),e({value:F}),(ee,J)=>(ee.camera||ni(E))&&(ee.domElement||ni(D))?(di(),hn("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:F,target:ni(k),"auto-rotate":ni(a),"auto-rotate-speed":ni(l),"enable-damping":ni(h),"damping-factor":ni(d),"enable-pan":ni(f),"key-pan-speed":ni(p),keys:ee.keys,"max-azimuth-angle":ni(g),"min-azimuth-angle":ni(y),"max-polar-angle":ni(x),"min-polar-angle":ni(_),"min-distance":ni(w),"max-distance":ni(O),"min-zoom":ni(T),"max-zoom":ni(C),touches:ni(R),"enable-zoom":ni(A),"zoom-speed":ni(B),"enable-rotate":ni(I),"rotate-speed":ni(P),args:[ee.camera||ni(E),ee.domElement||ni(D).domElement]},null,8,v3e)):cm("",!0)}});var DP;/Mac/.test((DP=globalThis==null?void 0:globalThis.navigator)===null||DP===void 0?void 0:DP.platform);var x3e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function OO(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _3e={exports:{}};(function(s,e){(function(i){s.exports=i()})(function(){return function i(n,r,o){function a(d,f){if(!r[d]){if(!n[d]){var p=typeof OO=="function"&&OO;if(!f&&p)return p(d,!0);if(l)return l(d,!0);throw new Error("Cannot find module '"+d+"'")}f=r[d]={exports:{}},n[d][0].call(f.exports,function(g){var y=n[d][1][g];return a(y||g)},f,f.exports,i,n,r,o)}return r[d].exports}for(var l=typeof OO=="function"&&OO,h=0;h<o.length;h++)a(o[h]);return a}({1:[function(i,n,r){(function(o,a,l,h,d,f,p,g,y){var x=i("crypto");function _(I,R){R=T(I,R);var P;return(P=R.algorithm!=="passthrough"?x.createHash(R.algorithm):new B).write===void 0&&(P.write=P.update,P.end=P.update),A(R,P).dispatch(I),P.update||P.end(""),P.digest?P.digest(R.encoding==="buffer"?void 0:R.encoding):(I=P.read(),R.encoding!=="buffer"?I.toString(R.encoding):I)}(r=n.exports=_).sha1=function(I){return _(I)},r.keys=function(I){return _(I,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},r.MD5=function(I){return _(I,{algorithm:"md5",encoding:"hex"})},r.keysMD5=function(I){return _(I,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var w=x.getHashes?x.getHashes().slice():["sha1","md5"],O=(w.push("passthrough"),["buffer","hex","binary","base64"]);function T(I,R){var P={};if(P.algorithm=(R=R||{}).algorithm||"sha1",P.encoding=R.encoding||"hex",P.excludeValues=!!R.excludeValues,P.algorithm=P.algorithm.toLowerCase(),P.encoding=P.encoding.toLowerCase(),P.ignoreUnknown=R.ignoreUnknown===!0,P.respectType=R.respectType!==!1,P.respectFunctionNames=R.respectFunctionNames!==!1,P.respectFunctionProperties=R.respectFunctionProperties!==!1,P.unorderedArrays=R.unorderedArrays===!0,P.unorderedSets=R.unorderedSets!==!1,P.unorderedObjects=R.unorderedObjects!==!1,P.replacer=R.replacer||void 0,P.excludeKeys=R.excludeKeys||void 0,I===void 0)throw new Error("Object argument required.");for(var k=0;k<w.length;++k)w[k].toLowerCase()===P.algorithm.toLowerCase()&&(P.algorithm=w[k]);if(w.indexOf(P.algorithm)===-1)throw new Error('Algorithm "'+P.algorithm+'"  not supported. supported values: '+w.join(", "));if(O.indexOf(P.encoding)===-1&&P.algorithm!=="passthrough")throw new Error('Encoding "'+P.encoding+'"  not supported. supported values: '+O.join(", "));return P}function C(I){if(typeof I=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(I))!=null}function A(I,R,P){P=P||[];function k(E){return R.update?R.update(E,"utf8"):R.write(E,"utf8")}return{dispatch:function(E){return this["_"+((E=I.replacer?I.replacer(E):E)===null?"null":typeof E)](E)},_object:function(E){var D,L=Object.prototype.toString.call(E),V=/\[object (.*)\]/i.exec(L);if(V=(V=V?V[1]:"unknown:["+L+"]").toLowerCase(),0<=(L=P.indexOf(E)))return this.dispatch("[CIRCULAR:"+L+"]");if(P.push(E),l!==void 0&&l.isBuffer&&l.isBuffer(E))return k("buffer:"),k(E);if(V==="object"||V==="function"||V==="asyncfunction")return L=Object.keys(E),I.unorderedObjects&&(L=L.sort()),I.respectType===!1||C(E)||L.splice(0,0,"prototype","__proto__","constructor"),I.excludeKeys&&(L=L.filter(function(F){return!I.excludeKeys(F)})),k("object:"+L.length+":"),D=this,L.forEach(function(F){D.dispatch(F),k(":"),I.excludeValues||D.dispatch(E[F]),k(",")});if(!this["_"+V]){if(I.ignoreUnknown)return k("["+V+"]");throw new Error('Unknown object type "'+V+'"')}this["_"+V](E)},_array:function(E,F){F=F!==void 0?F:I.unorderedArrays!==!1;var L=this;if(k("array:"+E.length+":"),!F||E.length<=1)return E.forEach(function(j){return L.dispatch(j)});var V=[],F=E.map(function(j){var Q=new B,ee=P.slice();return A(I,Q,ee).dispatch(j),V=V.concat(ee.slice(P.length)),Q.read().toString()});return P=P.concat(V),F.sort(),this._array(F,!1)},_date:function(E){return k("date:"+E.toJSON())},_symbol:function(E){return k("symbol:"+E.toString())},_error:function(E){return k("error:"+E.toString())},_boolean:function(E){return k("bool:"+E.toString())},_string:function(E){k("string:"+E.length+":"),k(E.toString())},_function:function(E){k("fn:"),C(E)?this.dispatch("[native]"):this.dispatch(E.toString()),I.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(E.name)),I.respectFunctionProperties&&this._object(E)},_number:function(E){return k("number:"+E.toString())},_xml:function(E){return k("xml:"+E.toString())},_null:function(){return k("Null")},_undefined:function(){return k("Undefined")},_regexp:function(E){return k("regex:"+E.toString())},_uint8array:function(E){return k("uint8array:"),this.dispatch(Array.prototype.slice.call(E))},_uint8clampedarray:function(E){return k("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(E))},_int8array:function(E){return k("int8array:"),this.dispatch(Array.prototype.slice.call(E))},_uint16array:function(E){return k("uint16array:"),this.dispatch(Array.prototype.slice.call(E))},_int16array:function(E){return k("int16array:"),this.dispatch(Array.prototype.slice.call(E))},_uint32array:function(E){return k("uint32array:"),this.dispatch(Array.prototype.slice.call(E))},_int32array:function(E){return k("int32array:"),this.dispatch(Array.prototype.slice.call(E))},_float32array:function(E){return k("float32array:"),this.dispatch(Array.prototype.slice.call(E))},_float64array:function(E){return k("float64array:"),this.dispatch(Array.prototype.slice.call(E))},_arraybuffer:function(E){return k("arraybuffer:"),this.dispatch(new Uint8Array(E))},_url:function(E){return k("url:"+E.toString())},_map:function(E){return k("map:"),E=Array.from(E),this._array(E,I.unorderedSets!==!1)},_set:function(E){return k("set:"),E=Array.from(E),this._array(E,I.unorderedSets!==!1)},_file:function(E){return k("file:"),this.dispatch([E.name,E.size,E.type,E.lastModfied])},_blob:function(){if(I.ignoreUnknown)return k("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return k("domwindow")},_bigint:function(E){return k("bigint:"+E.toString())},_process:function(){return k("process")},_timer:function(){return k("timer")},_pipe:function(){return k("pipe")},_tcp:function(){return k("tcp")},_udp:function(){return k("udp")},_tty:function(){return k("tty")},_statwatcher:function(){return k("statwatcher")},_securecontext:function(){return k("securecontext")},_connection:function(){return k("connection")},_zlib:function(){return k("zlib")},_context:function(){return k("context")},_nodescript:function(){return k("nodescript")},_httpparser:function(){return k("httpparser")},_dataview:function(){return k("dataview")},_signal:function(){return k("signal")},_fsevent:function(){return k("fsevent")},_tlswrap:function(){return k("tlswrap")}}}function B(){return{buf:"",write:function(I){this.buf+=I},end:function(I){this.buf+=I},read:function(){return this.buf}}}r.writeToStream=function(I,R,P){return P===void 0&&(P=R,R={}),A(R=T(I,R),P).dispatch(I)}}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(i,n,r){(function(o,a,l,h,d,f,p,g,y){(function(x){var _=typeof Uint8Array<"u"?Uint8Array:Array,w=43,O=47,T=48,C=97,A=65,B=45,I=95;function R(P){return P=P.charCodeAt(0),P===w||P===B?62:P===O||P===I?63:P<T?-1:P<T+10?P-T+26+26:P<A+26?P-A:P<C+26?P-C+26:void 0}x.toByteArray=function(P){var k,E;if(0<P.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var D=P.length,D=P.charAt(D-2)==="="?2:P.charAt(D-1)==="="?1:0,L=new _(3*P.length/4-D),V=0<D?P.length-4:P.length,F=0;function j(Q){L[F++]=Q}for(k=0;k<V;k+=4,0)j((16711680&(E=R(P.charAt(k))<<18|R(P.charAt(k+1))<<12|R(P.charAt(k+2))<<6|R(P.charAt(k+3))))>>16),j((65280&E)>>8),j(255&E);return D==2?j(255&(E=R(P.charAt(k))<<2|R(P.charAt(k+1))>>4)):D==1&&(j((E=R(P.charAt(k))<<10|R(P.charAt(k+1))<<4|R(P.charAt(k+2))>>2)>>8&255),j(255&E)),L},x.fromByteArray=function(P){var k,E,D,L,V=P.length%3,F="";function j(Q){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Q)}for(k=0,D=P.length-V;k<D;k+=3)E=(P[k]<<16)+(P[k+1]<<8)+P[k+2],F+=j((L=E)>>18&63)+j(L>>12&63)+j(L>>6&63)+j(63&L);switch(V){case 1:F=(F+=j((E=P[P.length-1])>>2))+j(E<<4&63)+"==";break;case 2:F=(F=(F+=j((E=(P[P.length-2]<<8)+P[P.length-1])>>10))+j(E>>4&63))+j(E<<2&63)+"="}return F}})(r===void 0?this.base64js={}:r)}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(i,n,r){(function(o,a,w,h,d,f,p,g,y){var x=i("base64-js"),_=i("ieee754");function w(Y,W,te){if(!(this instanceof w))return new w(Y,W,te);var ae,z,q,le,he=typeof Y;if(W==="base64"&&he=="string")for(Y=(le=Y).trim?le.trim():le.replace(/^\s+|\s+$/g,"");Y.length%4!=0;)Y+="=";if(he=="number")ae=J(Y);else if(he=="string")ae=w.byteLength(Y,W);else{if(he!="object")throw new Error("First argument needs to be a number, array or string.");ae=J(Y.length)}if(w._useTypedArrays?z=w._augment(new Uint8Array(ae)):((z=this).length=ae,z._isBuffer=!0),w._useTypedArrays&&typeof Y.byteLength=="number")z._set(Y);else if(ue(le=Y)||w.isBuffer(le)||le&&typeof le=="object"&&typeof le.length=="number")for(q=0;q<ae;q++)w.isBuffer(Y)?z[q]=Y.readUInt8(q):z[q]=Y[q];else if(he=="string")z.write(Y,0,W);else if(he=="number"&&!w._useTypedArrays&&!te)for(q=0;q<ae;q++)z[q]=0;return z}function O(Y,W,te,ae){return w._charsWritten=tt(function(z){for(var q=[],le=0;le<z.length;le++)q.push(255&z.charCodeAt(le));return q}(W),Y,te,ae)}function T(Y,W,te,ae){return w._charsWritten=tt(function(z){for(var q,le,he=[],be=0;be<z.length;be++)le=z.charCodeAt(be),q=le>>8,le=le%256,he.push(le),he.push(q);return he}(W),Y,te,ae)}function C(Y,W,te){var ae="";te=Math.min(Y.length,te);for(var z=W;z<te;z++)ae+=String.fromCharCode(Y[z]);return ae}function A(Y,W,te,q){q||(Se(typeof te=="boolean","missing or invalid endian"),Se(W!=null,"missing offset"),Se(W+1<Y.length,"Trying to read beyond buffer length"));var z,q=Y.length;if(!(q<=W))return te?(z=Y[W],W+1<q&&(z|=Y[W+1]<<8)):(z=Y[W]<<8,W+1<q&&(z|=Y[W+1])),z}function B(Y,W,te,q){q||(Se(typeof te=="boolean","missing or invalid endian"),Se(W!=null,"missing offset"),Se(W+3<Y.length,"Trying to read beyond buffer length"));var z,q=Y.length;if(!(q<=W))return te?(W+2<q&&(z=Y[W+2]<<16),W+1<q&&(z|=Y[W+1]<<8),z|=Y[W],W+3<q&&(z+=Y[W+3]<<24>>>0)):(W+1<q&&(z=Y[W+1]<<16),W+2<q&&(z|=Y[W+2]<<8),W+3<q&&(z|=Y[W+3]),z+=Y[W]<<24>>>0),z}function I(Y,W,te,ae){if(ae||(Se(typeof te=="boolean","missing or invalid endian"),Se(W!=null,"missing offset"),Se(W+1<Y.length,"Trying to read beyond buffer length")),!(Y.length<=W))return ae=A(Y,W,te,!0),32768&ae?-1*(65535-ae+1):ae}function R(Y,W,te,ae){if(ae||(Se(typeof te=="boolean","missing or invalid endian"),Se(W!=null,"missing offset"),Se(W+3<Y.length,"Trying to read beyond buffer length")),!(Y.length<=W))return ae=B(Y,W,te,!0),2147483648&ae?-1*(4294967295-ae+1):ae}function P(Y,W,te,ae){return ae||(Se(typeof te=="boolean","missing or invalid endian"),Se(W+3<Y.length,"Trying to read beyond buffer length")),_.read(Y,W,te,23,4)}function k(Y,W,te,ae){return ae||(Se(typeof te=="boolean","missing or invalid endian"),Se(W+7<Y.length,"Trying to read beyond buffer length")),_.read(Y,W,te,52,8)}function E(Y,W,te,ae,z){if(z||(Se(W!=null,"missing value"),Se(typeof ae=="boolean","missing or invalid endian"),Se(te!=null,"missing offset"),Se(te+1<Y.length,"trying to write beyond buffer length"),Re(W,65535)),z=Y.length,!(z<=te))for(var q=0,le=Math.min(z-te,2);q<le;q++)Y[te+q]=(W&255<<8*(ae?q:1-q))>>>8*(ae?q:1-q)}function D(Y,W,te,ae,z){if(z||(Se(W!=null,"missing value"),Se(typeof ae=="boolean","missing or invalid endian"),Se(te!=null,"missing offset"),Se(te+3<Y.length,"trying to write beyond buffer length"),Re(W,4294967295)),z=Y.length,!(z<=te))for(var q=0,le=Math.min(z-te,4);q<le;q++)Y[te+q]=W>>>8*(ae?q:3-q)&255}function L(Y,W,te,ae,z){z||(Se(W!=null,"missing value"),Se(typeof ae=="boolean","missing or invalid endian"),Se(te!=null,"missing offset"),Se(te+1<Y.length,"Trying to write beyond buffer length"),Le(W,32767,-32768)),Y.length<=te||E(Y,0<=W?W:65535+W+1,te,ae,z)}function V(Y,W,te,ae,z){z||(Se(W!=null,"missing value"),Se(typeof ae=="boolean","missing or invalid endian"),Se(te!=null,"missing offset"),Se(te+3<Y.length,"Trying to write beyond buffer length"),Le(W,2147483647,-2147483648)),Y.length<=te||D(Y,0<=W?W:4294967295+W+1,te,ae,z)}function F(Y,W,te,ae,z){z||(Se(W!=null,"missing value"),Se(typeof ae=="boolean","missing or invalid endian"),Se(te!=null,"missing offset"),Se(te+3<Y.length,"Trying to write beyond buffer length"),De(W,34028234663852886e22,-34028234663852886e22)),Y.length<=te||_.write(Y,W,te,ae,23,4)}function j(Y,W,te,ae,z){z||(Se(W!=null,"missing value"),Se(typeof ae=="boolean","missing or invalid endian"),Se(te!=null,"missing offset"),Se(te+7<Y.length,"Trying to write beyond buffer length"),De(W,17976931348623157e292,-17976931348623157e292)),Y.length<=te||_.write(Y,W,te,ae,52,8)}r.Buffer=w,r.SlowBuffer=w,r.INSPECT_MAX_BYTES=50,w.poolSize=8192,w._useTypedArrays=function(){try{var Y=new ArrayBuffer(0),W=new Uint8Array(Y);return W.foo=function(){return 42},W.foo()===42&&typeof W.subarray=="function"}catch{return!1}}(),w.isEncoding=function(Y){switch(String(Y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},w.isBuffer=function(Y){return!(Y==null||!Y._isBuffer)},w.byteLength=function(Y,W){var te;switch(Y+="",W||"utf8"){case"hex":te=Y.length/2;break;case"utf8":case"utf-8":te=pe(Y).length;break;case"ascii":case"binary":case"raw":te=Y.length;break;case"base64":te=Ue(Y).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":te=2*Y.length;break;default:throw new Error("Unknown encoding")}return te},w.concat=function(Y,W){if(Se(ue(Y),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),Y.length===0)return new w(0);if(Y.length===1)return Y[0];if(typeof W!="number")for(z=W=0;z<Y.length;z++)W+=Y[z].length;for(var te=new w(W),ae=0,z=0;z<Y.length;z++){var q=Y[z];q.copy(te,ae),ae+=q.length}return te},w.prototype.write=function(Y,W,te,ae){isFinite(W)?isFinite(te)||(ae=te,te=void 0):(be=ae,ae=W,W=te,te=be),W=Number(W)||0;var z,q,le,he,be=this.length-W;switch((!te||be<(te=Number(te)))&&(te=be),ae=String(ae||"utf8").toLowerCase()){case"hex":z=function(Ee,Z,G,ce){G=Number(G)||0;var de=Ee.length-G;(!ce||de<(ce=Number(ce)))&&(ce=de),Se((de=Z.length)%2==0,"Invalid hex string"),de/2<ce&&(ce=de/2);for(var Oe=0;Oe<ce;Oe++){var Ae=parseInt(Z.substr(2*Oe,2),16);Se(!isNaN(Ae),"Invalid hex string"),Ee[G+Oe]=Ae}return w._charsWritten=2*Oe,Oe}(this,Y,W,te);break;case"utf8":case"utf-8":q=this,le=W,he=te,z=w._charsWritten=tt(pe(Y),q,le,he);break;case"ascii":case"binary":z=O(this,Y,W,te);break;case"base64":q=this,le=W,he=te,z=w._charsWritten=tt(Ue(Y),q,le,he);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":z=T(this,Y,W,te);break;default:throw new Error("Unknown encoding")}return z},w.prototype.toString=function(Y,W,te){var ae,z,q,le,he=this;if(Y=String(Y||"utf8").toLowerCase(),W=Number(W)||0,(te=te!==void 0?Number(te):he.length)===W)return"";switch(Y){case"hex":ae=function(be,Ee,Z){var G=be.length;(!Ee||Ee<0)&&(Ee=0),(!Z||Z<0||G<Z)&&(Z=G);for(var ce="",de=Ee;de<Z;de++)ce+=oe(be[de]);return ce}(he,W,te);break;case"utf8":case"utf-8":ae=function(be,Ee,Z){var G="",ce="";Z=Math.min(be.length,Z);for(var de=Ee;de<Z;de++)be[de]<=127?(G+=ve(ce)+String.fromCharCode(be[de]),ce=""):ce+="%"+be[de].toString(16);return G+ve(ce)}(he,W,te);break;case"ascii":case"binary":ae=C(he,W,te);break;case"base64":z=he,le=te,ae=(q=W)===0&&le===z.length?x.fromByteArray(z):x.fromByteArray(z.slice(q,le));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ae=function(be,Ee,Z){for(var G=be.slice(Ee,Z),ce="",de=0;de<G.length;de+=2)ce+=String.fromCharCode(G[de]+256*G[de+1]);return ce}(he,W,te);break;default:throw new Error("Unknown encoding")}return ae},w.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},w.prototype.copy=function(Y,W,te,ae){if(W=W||0,(ae=ae||ae===0?ae:this.length)!==(te=te||0)&&Y.length!==0&&this.length!==0){Se(te<=ae,"sourceEnd < sourceStart"),Se(0<=W&&W<Y.length,"targetStart out of bounds"),Se(0<=te&&te<this.length,"sourceStart out of bounds"),Se(0<=ae&&ae<=this.length,"sourceEnd out of bounds"),ae>this.length&&(ae=this.length);var z=(ae=Y.length-W<ae-te?Y.length-W+te:ae)-te;if(z<100||!w._useTypedArrays)for(var q=0;q<z;q++)Y[q+W]=this[q+te];else Y._set(this.subarray(te,te+z),W)}},w.prototype.slice=function(Y,W){var te=this.length;if(Y=ee(Y,te,0),W=ee(W,te,te),w._useTypedArrays)return w._augment(this.subarray(Y,W));for(var ae=W-Y,z=new w(ae,void 0,!0),q=0;q<ae;q++)z[q]=this[q+Y];return z},w.prototype.get=function(Y){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(Y)},w.prototype.set=function(Y,W){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(Y,W)},w.prototype.readUInt8=function(Y,W){if(W||(Se(Y!=null,"missing offset"),Se(Y<this.length,"Trying to read beyond buffer length")),!(Y>=this.length))return this[Y]},w.prototype.readUInt16LE=function(Y,W){return A(this,Y,!0,W)},w.prototype.readUInt16BE=function(Y,W){return A(this,Y,!1,W)},w.prototype.readUInt32LE=function(Y,W){return B(this,Y,!0,W)},w.prototype.readUInt32BE=function(Y,W){return B(this,Y,!1,W)},w.prototype.readInt8=function(Y,W){if(W||(Se(Y!=null,"missing offset"),Se(Y<this.length,"Trying to read beyond buffer length")),!(Y>=this.length))return 128&this[Y]?-1*(255-this[Y]+1):this[Y]},w.prototype.readInt16LE=function(Y,W){return I(this,Y,!0,W)},w.prototype.readInt16BE=function(Y,W){return I(this,Y,!1,W)},w.prototype.readInt32LE=function(Y,W){return R(this,Y,!0,W)},w.prototype.readInt32BE=function(Y,W){return R(this,Y,!1,W)},w.prototype.readFloatLE=function(Y,W){return P(this,Y,!0,W)},w.prototype.readFloatBE=function(Y,W){return P(this,Y,!1,W)},w.prototype.readDoubleLE=function(Y,W){return k(this,Y,!0,W)},w.prototype.readDoubleBE=function(Y,W){return k(this,Y,!1,W)},w.prototype.writeUInt8=function(Y,W,te){te||(Se(Y!=null,"missing value"),Se(W!=null,"missing offset"),Se(W<this.length,"trying to write beyond buffer length"),Re(Y,255)),W>=this.length||(this[W]=Y)},w.prototype.writeUInt16LE=function(Y,W,te){E(this,Y,W,!0,te)},w.prototype.writeUInt16BE=function(Y,W,te){E(this,Y,W,!1,te)},w.prototype.writeUInt32LE=function(Y,W,te){D(this,Y,W,!0,te)},w.prototype.writeUInt32BE=function(Y,W,te){D(this,Y,W,!1,te)},w.prototype.writeInt8=function(Y,W,te){te||(Se(Y!=null,"missing value"),Se(W!=null,"missing offset"),Se(W<this.length,"Trying to write beyond buffer length"),Le(Y,127,-128)),W>=this.length||(0<=Y?this.writeUInt8(Y,W,te):this.writeUInt8(255+Y+1,W,te))},w.prototype.writeInt16LE=function(Y,W,te){L(this,Y,W,!0,te)},w.prototype.writeInt16BE=function(Y,W,te){L(this,Y,W,!1,te)},w.prototype.writeInt32LE=function(Y,W,te){V(this,Y,W,!0,te)},w.prototype.writeInt32BE=function(Y,W,te){V(this,Y,W,!1,te)},w.prototype.writeFloatLE=function(Y,W,te){F(this,Y,W,!0,te)},w.prototype.writeFloatBE=function(Y,W,te){F(this,Y,W,!1,te)},w.prototype.writeDoubleLE=function(Y,W,te){j(this,Y,W,!0,te)},w.prototype.writeDoubleBE=function(Y,W,te){j(this,Y,W,!1,te)},w.prototype.fill=function(Y,W,te){if(W=W||0,te=te||this.length,Se(typeof(Y=typeof(Y=Y||0)=="string"?Y.charCodeAt(0):Y)=="number"&&!isNaN(Y),"value is not a number"),Se(W<=te,"end < start"),te!==W&&this.length!==0){Se(0<=W&&W<this.length,"start out of bounds"),Se(0<=te&&te<=this.length,"end out of bounds");for(var ae=W;ae<te;ae++)this[ae]=Y}},w.prototype.inspect=function(){for(var Y=[],W=this.length,te=0;te<W;te++)if(Y[te]=oe(this[te]),te===r.INSPECT_MAX_BYTES){Y[te+1]="...";break}return"<Buffer "+Y.join(" ")+">"},w.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(w._useTypedArrays)return new w(this).buffer;for(var Y=new Uint8Array(this.length),W=0,te=Y.length;W<te;W+=1)Y[W]=this[W];return Y.buffer};var Q=w.prototype;function ee(Y,W,te){return typeof Y!="number"?te:W<=(Y=~~Y)?W:0<=Y||0<=(Y+=W)?Y:0}function J(Y){return(Y=~~Math.ceil(+Y))<0?0:Y}function ue(Y){return(Array.isArray||function(W){return Object.prototype.toString.call(W)==="[object Array]"})(Y)}function oe(Y){return Y<16?"0"+Y.toString(16):Y.toString(16)}function pe(Y){for(var W=[],te=0;te<Y.length;te++){var ae=Y.charCodeAt(te);if(ae<=127)W.push(Y.charCodeAt(te));else for(var z=te,q=(55296<=ae&&ae<=57343&&te++,encodeURIComponent(Y.slice(z,te+1)).substr(1).split("%")),le=0;le<q.length;le++)W.push(parseInt(q[le],16))}return W}function Ue(Y){return x.toByteArray(Y)}function tt(Y,W,te,ae){for(var z=0;z<ae&&!(z+te>=W.length||z>=Y.length);z++)W[z+te]=Y[z];return z}function ve(Y){try{return decodeURIComponent(Y)}catch{return""}}function Re(Y,W){Se(typeof Y=="number","cannot write a non-number as a number"),Se(0<=Y,"specified a negative value for writing an unsigned value"),Se(Y<=W,"value is larger than maximum value for type"),Se(Math.floor(Y)===Y,"value has a fractional component")}function Le(Y,W,te){Se(typeof Y=="number","cannot write a non-number as a number"),Se(Y<=W,"value larger than maximum allowed value"),Se(te<=Y,"value smaller than minimum allowed value"),Se(Math.floor(Y)===Y,"value has a fractional component")}function De(Y,W,te){Se(typeof Y=="number","cannot write a non-number as a number"),Se(Y<=W,"value larger than maximum allowed value"),Se(te<=Y,"value smaller than minimum allowed value")}function Se(Y,W){if(!Y)throw new Error(W||"Failed assertion")}w._augment=function(Y){return Y._isBuffer=!0,Y._get=Y.get,Y._set=Y.set,Y.get=Q.get,Y.set=Q.set,Y.write=Q.write,Y.toString=Q.toString,Y.toLocaleString=Q.toString,Y.toJSON=Q.toJSON,Y.copy=Q.copy,Y.slice=Q.slice,Y.readUInt8=Q.readUInt8,Y.readUInt16LE=Q.readUInt16LE,Y.readUInt16BE=Q.readUInt16BE,Y.readUInt32LE=Q.readUInt32LE,Y.readUInt32BE=Q.readUInt32BE,Y.readInt8=Q.readInt8,Y.readInt16LE=Q.readInt16LE,Y.readInt16BE=Q.readInt16BE,Y.readInt32LE=Q.readInt32LE,Y.readInt32BE=Q.readInt32BE,Y.readFloatLE=Q.readFloatLE,Y.readFloatBE=Q.readFloatBE,Y.readDoubleLE=Q.readDoubleLE,Y.readDoubleBE=Q.readDoubleBE,Y.writeUInt8=Q.writeUInt8,Y.writeUInt16LE=Q.writeUInt16LE,Y.writeUInt16BE=Q.writeUInt16BE,Y.writeUInt32LE=Q.writeUInt32LE,Y.writeUInt32BE=Q.writeUInt32BE,Y.writeInt8=Q.writeInt8,Y.writeInt16LE=Q.writeInt16LE,Y.writeInt16BE=Q.writeInt16BE,Y.writeInt32LE=Q.writeInt32LE,Y.writeInt32BE=Q.writeInt32BE,Y.writeFloatLE=Q.writeFloatLE,Y.writeFloatBE=Q.writeFloatBE,Y.writeDoubleLE=Q.writeDoubleLE,Y.writeDoubleBE=Q.writeDoubleBE,Y.fill=Q.fill,Y.inspect=Q.inspect,Y.toArrayBuffer=Q.toArrayBuffer,Y}}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(i,n,r){(function(o,a,x,h,d,f,p,g,y){var x=i("buffer").Buffer,_=4,w=new x(_);w.fill(0),n.exports={hash:function(O,T,C,A){for(var B=T(function(E,D){E.length%_!=0&&(L=E.length+(_-E.length%_),E=x.concat([E,w],L));for(var L,V=[],F=D?E.readInt32BE:E.readInt32LE,j=0;j<E.length;j+=_)V.push(F.call(E,j));return V}(O=x.isBuffer(O)?O:new x(O),A),8*O.length),T=A,I=new x(C),R=T?I.writeInt32BE:I.writeInt32LE,P=0;P<B.length;P++)R.call(I,B[P],4*P,!0);return I}}}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(i,n,r){(function(o,a,x,h,d,f,p,g,y){var x=i("buffer").Buffer,_=i("./sha"),w=i("./sha256"),O=i("./rng"),T={sha1:_,sha256:w,md5:i("./md5")},C=64,A=new x(C);function B(E,D){var L=T[E=E||"sha1"],V=[];return L||I("algorithm:",E,"is not yet supported"),{update:function(F){return x.isBuffer(F)||(F=new x(F)),V.push(F),F.length,this},digest:function(F){var j=x.concat(V),j=D?function(Q,ee,J){x.isBuffer(ee)||(ee=new x(ee)),x.isBuffer(J)||(J=new x(J)),ee.length>C?ee=Q(ee):ee.length<C&&(ee=x.concat([ee,A],C));for(var ue=new x(C),oe=new x(C),pe=0;pe<C;pe++)ue[pe]=54^ee[pe],oe[pe]=92^ee[pe];return J=Q(x.concat([ue,J])),Q(x.concat([oe,J]))}(L,D,j):L(j);return V=null,F?j.toString(F):j}}}function I(){var E=[].slice.call(arguments).join(" ");throw new Error([E,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}A.fill(0),r.createHash=function(E){return B(E)},r.createHmac=B,r.randomBytes=function(E,D){if(!D||!D.call)return new x(O(E));try{D.call(this,void 0,new x(O(E)))}catch(L){D(L)}};var R,P=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],k=function(E){r[E]=function(){I("sorry,",E,"is not implemented yet")}};for(R in P)k(P[R])}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(i,n,r){(function(o,a,l,h,d,f,p,g,y){var x=i("./helpers");function _(I,R){I[R>>5]|=128<<R%32,I[14+(R+64>>>9<<4)]=R;for(var P=1732584193,k=-271733879,E=-1732584194,D=271733878,L=0;L<I.length;L+=16){var V=P,F=k,j=E,Q=D,P=O(P,k,E,D,I[L+0],7,-680876936),D=O(D,P,k,E,I[L+1],12,-389564586),E=O(E,D,P,k,I[L+2],17,606105819),k=O(k,E,D,P,I[L+3],22,-1044525330);P=O(P,k,E,D,I[L+4],7,-176418897),D=O(D,P,k,E,I[L+5],12,1200080426),E=O(E,D,P,k,I[L+6],17,-1473231341),k=O(k,E,D,P,I[L+7],22,-45705983),P=O(P,k,E,D,I[L+8],7,1770035416),D=O(D,P,k,E,I[L+9],12,-1958414417),E=O(E,D,P,k,I[L+10],17,-42063),k=O(k,E,D,P,I[L+11],22,-1990404162),P=O(P,k,E,D,I[L+12],7,1804603682),D=O(D,P,k,E,I[L+13],12,-40341101),E=O(E,D,P,k,I[L+14],17,-1502002290),P=T(P,k=O(k,E,D,P,I[L+15],22,1236535329),E,D,I[L+1],5,-165796510),D=T(D,P,k,E,I[L+6],9,-1069501632),E=T(E,D,P,k,I[L+11],14,643717713),k=T(k,E,D,P,I[L+0],20,-373897302),P=T(P,k,E,D,I[L+5],5,-701558691),D=T(D,P,k,E,I[L+10],9,38016083),E=T(E,D,P,k,I[L+15],14,-660478335),k=T(k,E,D,P,I[L+4],20,-405537848),P=T(P,k,E,D,I[L+9],5,568446438),D=T(D,P,k,E,I[L+14],9,-1019803690),E=T(E,D,P,k,I[L+3],14,-187363961),k=T(k,E,D,P,I[L+8],20,1163531501),P=T(P,k,E,D,I[L+13],5,-1444681467),D=T(D,P,k,E,I[L+2],9,-51403784),E=T(E,D,P,k,I[L+7],14,1735328473),P=C(P,k=T(k,E,D,P,I[L+12],20,-1926607734),E,D,I[L+5],4,-378558),D=C(D,P,k,E,I[L+8],11,-2022574463),E=C(E,D,P,k,I[L+11],16,1839030562),k=C(k,E,D,P,I[L+14],23,-35309556),P=C(P,k,E,D,I[L+1],4,-1530992060),D=C(D,P,k,E,I[L+4],11,1272893353),E=C(E,D,P,k,I[L+7],16,-155497632),k=C(k,E,D,P,I[L+10],23,-1094730640),P=C(P,k,E,D,I[L+13],4,681279174),D=C(D,P,k,E,I[L+0],11,-358537222),E=C(E,D,P,k,I[L+3],16,-722521979),k=C(k,E,D,P,I[L+6],23,76029189),P=C(P,k,E,D,I[L+9],4,-640364487),D=C(D,P,k,E,I[L+12],11,-421815835),E=C(E,D,P,k,I[L+15],16,530742520),P=A(P,k=C(k,E,D,P,I[L+2],23,-995338651),E,D,I[L+0],6,-198630844),D=A(D,P,k,E,I[L+7],10,1126891415),E=A(E,D,P,k,I[L+14],15,-1416354905),k=A(k,E,D,P,I[L+5],21,-57434055),P=A(P,k,E,D,I[L+12],6,1700485571),D=A(D,P,k,E,I[L+3],10,-1894986606),E=A(E,D,P,k,I[L+10],15,-1051523),k=A(k,E,D,P,I[L+1],21,-2054922799),P=A(P,k,E,D,I[L+8],6,1873313359),D=A(D,P,k,E,I[L+15],10,-30611744),E=A(E,D,P,k,I[L+6],15,-1560198380),k=A(k,E,D,P,I[L+13],21,1309151649),P=A(P,k,E,D,I[L+4],6,-145523070),D=A(D,P,k,E,I[L+11],10,-1120210379),E=A(E,D,P,k,I[L+2],15,718787259),k=A(k,E,D,P,I[L+9],21,-343485551),P=B(P,V),k=B(k,F),E=B(E,j),D=B(D,Q)}return Array(P,k,E,D)}function w(I,R,P,k,E,D){return B((R=B(B(R,I),B(k,D)))<<E|R>>>32-E,P)}function O(I,R,P,k,E,D,L){return w(R&P|~R&k,I,R,E,D,L)}function T(I,R,P,k,E,D,L){return w(R&k|P&~k,I,R,E,D,L)}function C(I,R,P,k,E,D,L){return w(R^P^k,I,R,E,D,L)}function A(I,R,P,k,E,D,L){return w(P^(R|~k),I,R,E,D,L)}function B(I,R){var P=(65535&I)+(65535&R);return(I>>16)+(R>>16)+(P>>16)<<16|65535&P}n.exports=function(I){return x.hash(I,_,16)}}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(i,n,r){(function(o,a,l,h,d,f,p,g,y){n.exports=function(x){for(var _,w=new Array(x),O=0;O<x;O++)!(3&O)&&(_=4294967296*Math.random()),w[O]=_>>>((3&O)<<3)&255;return w}}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(i,n,r){(function(o,a,l,h,d,f,p,g,y){var x=i("./helpers");function _(T,C){T[C>>5]|=128<<24-C%32,T[15+(C+64>>9<<4)]=C;for(var A,B,I,R=Array(80),P=1732584193,k=-271733879,E=-1732584194,D=271733878,L=-1009589776,V=0;V<T.length;V+=16){for(var F=P,j=k,Q=E,ee=D,J=L,ue=0;ue<80;ue++){R[ue]=ue<16?T[V+ue]:O(R[ue-3]^R[ue-8]^R[ue-14]^R[ue-16],1);var oe=w(w(O(P,5),(oe=k,B=E,I=D,(A=ue)<20?oe&B|~oe&I:!(A<40)&&A<60?oe&B|oe&I|B&I:oe^B^I)),w(w(L,R[ue]),(A=ue)<20?1518500249:A<40?1859775393:A<60?-1894007588:-899497514)),L=D,D=E,E=O(k,30),k=P,P=oe}P=w(P,F),k=w(k,j),E=w(E,Q),D=w(D,ee),L=w(L,J)}return Array(P,k,E,D,L)}function w(T,C){var A=(65535&T)+(65535&C);return(T>>16)+(C>>16)+(A>>16)<<16|65535&A}function O(T,C){return T<<C|T>>>32-C}n.exports=function(T){return x.hash(T,_,20,!0)}}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(i,n,r){(function(o,a,l,h,d,f,p,g,y){function x(C,A){var B=(65535&C)+(65535&A);return(C>>16)+(A>>16)+(B>>16)<<16|65535&B}function _(C,A){var B,I=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),R=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),P=new Array(64);C[A>>5]|=128<<24-A%32,C[15+(A+64>>9<<4)]=A;for(var k,E,D=0;D<C.length;D+=16){for(var L=R[0],V=R[1],F=R[2],j=R[3],Q=R[4],ee=R[5],J=R[6],ue=R[7],oe=0;oe<64;oe++)P[oe]=oe<16?C[oe+D]:x(x(x((E=P[oe-2],O(E,17)^O(E,19)^T(E,10)),P[oe-7]),(E=P[oe-15],O(E,7)^O(E,18)^T(E,3))),P[oe-16]),B=x(x(x(x(ue,O(E=Q,6)^O(E,11)^O(E,25)),Q&ee^~Q&J),I[oe]),P[oe]),k=x(O(k=L,2)^O(k,13)^O(k,22),L&V^L&F^V&F),ue=J,J=ee,ee=Q,Q=x(j,B),j=F,F=V,V=L,L=x(B,k);R[0]=x(L,R[0]),R[1]=x(V,R[1]),R[2]=x(F,R[2]),R[3]=x(j,R[3]),R[4]=x(Q,R[4]),R[5]=x(ee,R[5]),R[6]=x(J,R[6]),R[7]=x(ue,R[7])}return R}var w=i("./helpers"),O=function(C,A){return C>>>A|C<<32-A},T=function(C,A){return C>>>A};n.exports=function(C){return w.hash(C,_,32,!0)}}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(i,n,r){(function(o,a,l,h,d,f,p,g,y){r.read=function(x,_,w,O,D){var C,A,B=8*D-O-1,I=(1<<B)-1,R=I>>1,P=-7,k=w?D-1:0,E=w?-1:1,D=x[_+k];for(k+=E,C=D&(1<<-P)-1,D>>=-P,P+=B;0<P;C=256*C+x[_+k],k+=E,P-=8);for(A=C&(1<<-P)-1,C>>=-P,P+=O;0<P;A=256*A+x[_+k],k+=E,P-=8);if(C===0)C=1-R;else{if(C===I)return A?NaN:1/0*(D?-1:1);A+=Math.pow(2,O),C-=R}return(D?-1:1)*A*Math.pow(2,C-O)},r.write=function(x,_,w,O,T,L){var A,B,I=8*L-T-1,R=(1<<I)-1,P=R>>1,k=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=O?0:L-1,D=O?1:-1,L=_<0||_===0&&1/_<0?1:0;for(_=Math.abs(_),isNaN(_)||_===1/0?(B=isNaN(_)?1:0,A=R):(A=Math.floor(Math.log(_)/Math.LN2),_*(O=Math.pow(2,-A))<1&&(A--,O*=2),2<=(_+=1<=A+P?k/O:k*Math.pow(2,1-P))*O&&(A++,O/=2),R<=A+P?(B=0,A=R):1<=A+P?(B=(_*O-1)*Math.pow(2,T),A+=P):(B=_*Math.pow(2,P-1)*Math.pow(2,T),A=0));8<=T;x[w+E]=255&B,E+=D,B/=256,T-=8);for(A=A<<T|B,I+=T;0<I;x[w+E]=255&A,E+=D,A/=256,I-=8);x[w+E-D]|=128*L}}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(i,n,r){(function(o,a,l,h,d,f,p,g,y){var x,_,w;function O(){}(o=n.exports={}).nextTick=(_=typeof window<"u"&&window.setImmediate,w=typeof window<"u"&&window.postMessage&&window.addEventListener,_?function(T){return window.setImmediate(T)}:w?(x=[],window.addEventListener("message",function(T){var C=T.source;C!==window&&C!==null||T.data!=="process-tick"||(T.stopPropagation(),0<x.length&&x.shift()())},!0),function(T){x.push(T),window.postMessage("process-tick","*")}):function(T){setTimeout(T,0)}),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=O,o.addListener=O,o.once=O,o.off=O,o.removeListener=O,o.removeAllListeners=O,o.emit=O,o.binding=function(T){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(T){throw new Error("process.chdir is not supported")}}).call(this,i("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(_3e);var b3e=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],GB=b3e;GB=GB.slice().filter(function(s){return!/^(gl\_|texture)/.test(s)});GB.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]);function w3e(s,e){if(typeof s!="object"||s===null)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var n=i.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function O3e(s){var e=w3e(s,"string");return typeof e=="symbol"?e:String(e)}function In(s,e,i){return e=O3e(e),e in s?Object.defineProperty(s,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[e]=i,s}var Oi={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},Ro,Dg;Ro={},In(Ro,"".concat(Oi.normal),{"#include <beginnormal_vertex>":`
    vec3 objectNormal = `.concat(Oi.normal,`;
    #ifdef USE_TANGENT
	    vec3 objectTangent = vec3( tangent.xyz );
    #endif
    `)}),In(Ro,"".concat(Oi.position),{"#include <begin_vertex>":`
    vec3 transformed = `.concat(Oi.position,`;
  `)}),In(Ro,"".concat(Oi.positionRaw),{"#include <begin_vertex>":`
    vec4 csm_internal_positionUnprojected = `.concat(Oi.positionRaw,`;
    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;
    #ifdef USE_INSTANCING
      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;
    #endif
    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;
    vec3 transformed = csm_internal_positionUnprojected.xyz;
  `)}),In(Ro,"".concat(Oi.pointSize),{"gl_PointSize = size;":`
    gl_PointSize = `.concat(Oi.pointSize,`;
    `)}),In(Ro,"".concat(Oi.diffuseColor),{"#include <color_fragment>":`
    #include <color_fragment>
    diffuseColor = `.concat(Oi.diffuseColor,`;
  `)}),In(Ro,"".concat(Oi.fragColor),{"#include <dithering_fragment>":`
    #include <dithering_fragment>
    gl_FragColor  = `.concat(Oi.fragColor,`;
  `)}),In(Ro,"".concat(Oi.emissive),{"vec3 totalEmissiveRadiance = emissive;":`
    vec3 totalEmissiveRadiance = `.concat(Oi.emissive,`;
    `)}),In(Ro,"".concat(Oi.roughness),{"#include <roughnessmap_fragment>":`
    #include <roughnessmap_fragment>
    roughnessFactor = `.concat(Oi.roughness,`;
    `)}),In(Ro,"".concat(Oi.metalness),{"#include <metalnessmap_fragment>":`
    #include <metalnessmap_fragment>
    metalnessFactor = `.concat(Oi.metalness,`;
    `)}),In(Ro,"".concat(Oi.ao),{"#include <aomap_fragment>":`
    #include <aomap_fragment>
    reflectedLight.indirectDiffuse *= 1. - `.concat(Oi.ao,`;
    `)}),In(Ro,"".concat(Oi.bump),{"#include <normal_fragment_maps>":`
    #include <normal_fragment_maps>

    vec3 csm_internal_orthogonal = `.concat(Oi.bump," - (dot(").concat(Oi.bump,`, normal) * normal);
    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;
    normal = normalize(normal - csm_internal_projectedbump);
    `)}),In(Ro,"".concat(Oi.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":`
      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * `.concat(Oi.depthAlpha,` );
    `),"gl_FragColor = packDepthToRGBA( fragCoordZ );":`
      gl_FragColor = packDepthToRGBA( fragCoordZ );
      gl_FragColor.a *= `.concat(Oi.depthAlpha,`;
    `)});Dg={},In(Dg,"".concat(Oi.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = projectionMatrix * modelViewMatrix * vec4( `.concat(Oi.position,`, 1.0 );
  `)}),In(Dg,"".concat(Oi.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = `.concat(Oi.position,`;
  `)}),In(Dg,"".concat(Oi.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(Oi.diffuseColor,`;
  `)}),In(Dg,"".concat(Oi.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(Oi.fragColor,`;
  `)});var Do;Do={},In(Do,"".concat(Oi.position),"*"),In(Do,"".concat(Oi.positionRaw),"*"),In(Do,"".concat(Oi.normal),"*"),In(Do,"".concat(Oi.pointSize),["PointsMaterial"]),In(Do,"".concat(Oi.diffuseColor),"*"),In(Do,"".concat(Oi.fragColor),"*"),In(Do,"".concat(Oi.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),In(Do,"".concat(Oi.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),In(Do,"".concat(Oi.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),In(Do,"".concat(Oi.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),In(Do,"".concat(Oi.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),In(Do,"".concat(Oi.depthAlpha),"*");new Nr;new ie;ct.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Fe(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};rl.line={uniforms:Ob.merge([ct.common,ct.fog,ct.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};new ie;new ie;new sn;new sn;new sn;new ie;new ri;new dj;new ie;new Nr;new Vr;new sn;const S3e={key:0,args:[0,1,64]},C3e={key:1,args:[.5,1,64]},T3e={key:2},A3e=["tone-mapped","map","side","color"];new ft(16777215);class p3 extends Dn{constructor(){const e=p3.SkyShader,i=new Ao({name:e.name,uniforms:Ob.clone(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:qr,depthWrite:!1});super(new xf(1,1,1),i),this.isSky=!0}}p3.SkyShader={name:"SkyShader",uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new ie},up:{value:new ie(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPosition );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};var E3e={exports:{}};(function(s,e){(function(i,n){s.exports=n()})(x3e,function(){var i=function(){function n(y){return a.appendChild(y.dom),y}function r(y){for(var x=0;x<a.children.length;x++)a.children[x].style.display=x===y?"block":"none";o=y}var o=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(y){y.preventDefault(),r(++o%a.children.length)},!1);var l=(performance||Date).now(),h=l,d=0,f=n(new i.Panel("FPS","#0ff","#002")),p=n(new i.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var g=n(new i.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:a,addPanel:n,showPanel:r,begin:function(){l=(performance||Date).now()},end:function(){d++;var y=(performance||Date).now();if(p.update(y-l,200),y>h+1e3&&(f.update(1e3*d/(y-h),100),h=y,d=0,g)){var x=performance.memory;g.update(x.usedJSHeapSize/1048576,x.jsHeapSizeLimit/1048576)}return y},update:function(){l=this.end()},domElement:a,setMode:r}};return i.Panel=function(n,r,o){var a=1/0,l=0,h=Math.round,d=h(window.devicePixelRatio||1),f=80*d,p=48*d,g=3*d,y=2*d,x=3*d,_=15*d,w=74*d,O=30*d,T=document.createElement("canvas");T.width=f,T.height=p,T.style.cssText="width:80px;height:48px";var C=T.getContext("2d");return C.font="bold "+9*d+"px Helvetica,Arial,sans-serif",C.textBaseline="top",C.fillStyle=o,C.fillRect(0,0,f,p),C.fillStyle=r,C.fillText(n,g,y),C.fillRect(x,_,w,O),C.fillStyle=o,C.globalAlpha=.9,C.fillRect(x,_,w,O),{dom:T,update:function(A,B){a=Math.min(a,A),l=Math.max(l,A),C.fillStyle=o,C.globalAlpha=1,C.fillRect(0,0,f,_),C.fillStyle=r,C.fillText(h(A)+" "+n+" ("+h(a)+"-"+h(l)+")",g,y),C.drawImage(T,x+d,_,w-d,O,x,_,w-d,O),C.fillRect(x+w-d,_,d,O),C.fillStyle=o,C.globalAlpha=.9,C.fillRect(x+w-d,_,d,h((1-A/B)*O))}}},i})})(E3e);var M3e=`#include <common>

void main() {
  vec2 center = vec2(0., 1.);
  float rotation = 0.0;

  
  
  float size = 0.03;

  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

  bool isPerspective = isPerspectiveMatrix( projectionMatrix );
  if ( isPerspective ) scale *= - mvPosition.z;

  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
  mvPosition.xy += rotatedPosition;

  gl_Position = projectionMatrix * mvPosition;
}`,k3e=`void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
}`;const $b=new ie(0,0,0),m3=new ie(0,0,0),P3e=new ie(0,0,0);function G6(s,e,i){const n=$b.setFromMatrixPosition(s.matrixWorld);n.project(e);const r=i.width/2,o=i.height/2;return[(Number.isNaN(n.x)?0:n.x)*r+r,-(n.y*o)+o]}function I3e(s,e){const i=$b.setFromMatrixPosition(s.matrixWorld),n=m3.setFromMatrixPosition(e.matrixWorld),r=i.sub(n),o=e.getWorldDirection(P3e);return r.angleTo(o)>Math.PI/2}function B3e(s,e,i,n){const r=$b.setFromMatrixPosition(s.matrixWorld),o=r.clone();o.project(e),i.setFromCamera(new Fe(o.x,o.y),e);const a=i.intersectObjects(n,!0);if(a.length>0){const l=a[0].distance;return r.distanceTo(i.ray.origin)<l}return!0}function R3e(s,e){if(e instanceof Ql)return e.zoom;if(e instanceof Rn){const i=$b.setFromMatrixPosition(s.matrixWorld),n=m3.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,o=i.distanceTo(n);return 1/(2*Math.tan(r/2)*o)}else return 1}function D3e(s,e,i){if(e instanceof Rn||e instanceof Ql){const n=$b.setFromMatrixPosition(s.matrixWorld),r=m3.setFromMatrixPosition(e.matrixWorld),o=n.distanceTo(r),a=(i[1]-i[0])/(e.far-e.near),l=i[1]-a*e.far;return Math.round(a*o+l)}}const QB=s=>Math.abs(s)<1e-10?0:s;function Mq(s,e,i=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=QB(e[r]*s.elements[r])+(r!==15?",":")");return i+n}const L3e=(s=>e=>Mq(e,s))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),N3e=(s=>(e,i)=>Mq(e,s(i),"translate(-50%,-50%)"))(s=>[1/s,1/s,1/s,1,-1/s,-1/s,-1/s,-1,1/s,1/s,1/s,1,1,1,1,1]),V3e=["geometry","material"];new _f;class yn{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,i,n){[e,i]=gy(this,e,i);let r=[];return this.decompose(0,e,r,2),n.length&&n.decompose(0,n.length,r,3),this.decompose(i,this.length,r,1),Wc.from(r,this.length-(i-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,i=this.length){[e,i]=gy(this,e,i);let n=[];return this.decompose(e,i,n,0),Wc.from(n,i-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let i=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),r=new Kx(this),o=new Kx(e);for(let a=i,l=i;;){if(r.next(a),o.next(a),a=0,r.lineBreak!=o.lineBreak||r.done!=o.done||r.value!=o.value)return!1;if(l+=r.value.length,r.done||l>=n)return!0}}iter(e=1){return new Kx(this,e)}iterRange(e,i=this.length){return new kq(this,e,i)}iterLines(e,i){let n;if(e==null)n=this.iter();else{i==null&&(i=this.lines+1);let r=this.line(e).from;n=this.iterRange(r,Math.max(r,i==this.lines+1?this.length:i<=1?0:this.line(i-1).to))}return new Pq(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?yn.empty:e.length<=32?new Ps(e):Wc.from(Ps.split(e,[]))}}class Ps extends yn{constructor(e,i=$3e(e)){super(),this.text=e,this.length=i}get lines(){return this.text.length}get children(){return null}lineInner(e,i,n,r){for(let o=0;;o++){let a=this.text[o],l=r+a.length;if((i?n:l)>=e)return new U3e(r,l,n,a);r=l+1,n++}}decompose(e,i,n,r){let o=e<=0&&i>=this.length?this:new Ps(Q6(this.text,e,i),Math.min(i,this.length)-Math.max(0,e));if(r&1){let a=n.pop(),l=KS(o.text,a.text.slice(),0,o.length);if(l.length<=32)n.push(new Ps(l,a.length+o.length));else{let h=l.length>>1;n.push(new Ps(l.slice(0,h)),new Ps(l.slice(h)))}}else n.push(o)}replace(e,i,n){if(!(n instanceof Ps))return super.replace(e,i,n);[e,i]=gy(this,e,i);let r=KS(this.text,KS(n.text,Q6(this.text,0,e)),i),o=this.length+n.length-(i-e);return r.length<=32?new Ps(r,o):Wc.from(Ps.split(r,[]),o)}sliceString(e,i=this.length,n=`
`){[e,i]=gy(this,e,i);let r="";for(let o=0,a=0;o<=i&&a<this.text.length;a++){let l=this.text[a],h=o+l.length;o>e&&a&&(r+=n),e<h&&i>o&&(r+=l.slice(Math.max(0,e-o),i-o)),o=h+1}return r}flatten(e){for(let i of this.text)e.push(i)}scanIdentical(){return 0}static split(e,i){let n=[],r=-1;for(let o of e)n.push(o),r+=o.length+1,n.length==32&&(i.push(new Ps(n,r)),n=[],r=-1);return r>-1&&i.push(new Ps(n,r)),i}}class Wc extends yn{constructor(e,i){super(),this.children=e,this.length=i,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,i,n,r){for(let o=0;;o++){let a=this.children[o],l=r+a.length,h=n+a.lines-1;if((i?h:l)>=e)return a.lineInner(e,i,n,r);r=l+1,n=h+1}}decompose(e,i,n,r){for(let o=0,a=0;a<=i&&o<this.children.length;o++){let l=this.children[o],h=a+l.length;if(e<=h&&i>=a){let d=r&((a<=e?1:0)|(h>=i?2:0));a>=e&&h<=i&&!d?n.push(l):l.decompose(e-a,i-a,n,d)}a=h+1}}replace(e,i,n){if([e,i]=gy(this,e,i),n.lines<this.lines)for(let r=0,o=0;r<this.children.length;r++){let a=this.children[r],l=o+a.length;if(e>=o&&i<=l){let h=a.replace(e-o,i-o,n),d=this.lines-a.lines+h.lines;if(h.lines<d>>4&&h.lines>d>>6){let f=this.children.slice();return f[r]=h,new Wc(f,this.length-(i-e)+n.length)}return super.replace(o,l,h)}o=l+1}return super.replace(e,i,n)}sliceString(e,i=this.length,n=`
`){[e,i]=gy(this,e,i);let r="";for(let o=0,a=0;o<this.children.length&&a<=i;o++){let l=this.children[o],h=a+l.length;a>e&&o&&(r+=n),e<h&&i>a&&(r+=l.sliceString(e-a,i-a,n)),a=h+1}return r}flatten(e){for(let i of this.children)i.flatten(e)}scanIdentical(e,i){if(!(e instanceof Wc))return 0;let n=0,[r,o,a,l]=i>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=i,o+=i){if(r==a||o==l)return n;let h=this.children[r],d=e.children[o];if(h!=d)return n+h.scanIdentical(d,i);n+=h.length+1}}static from(e,i=e.reduce((n,r)=>n+r.length+1,-1)){let n=0;for(let y of e)n+=y.lines;if(n<32){let y=[];for(let x of e)x.flatten(y);return new Ps(y,i)}let r=Math.max(32,n>>5),o=r<<1,a=r>>1,l=[],h=0,d=-1,f=[];function p(y){let x;if(y.lines>o&&y instanceof Wc)for(let _ of y.children)p(_);else y.lines>a&&(h>a||!h)?(g(),l.push(y)):y instanceof Ps&&h&&(x=f[f.length-1])instanceof Ps&&y.lines+x.lines<=32?(h+=y.lines,d+=y.length+1,f[f.length-1]=new Ps(x.text.concat(y.text),x.length+1+y.length)):(h+y.lines>r&&g(),h+=y.lines,d+=y.length+1,f.push(y))}function g(){h!=0&&(l.push(f.length==1?f[0]:Wc.from(f,d)),d=-1,h=f.length=0)}for(let y of e)p(y);return g(),l.length==1?l[0]:new Wc(l,i)}}yn.empty=new Ps([""],0);function $3e(s){let e=-1;for(let i of s)e+=i.length+1;return e}function KS(s,e,i=0,n=1e9){for(let r=0,o=0,a=!0;o<s.length&&r<=n;o++){let l=s[o],h=r+l.length;h>=i&&(h>n&&(l=l.slice(0,n-r)),r<i&&(l=l.slice(i-r)),a?(e[e.length-1]+=l,a=!1):e.push(l)),r=h+1}return e}function Q6(s,e,i){return KS(s,[""],e,i)}class Kx{constructor(e,i=1){this.dir=i,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[i>0?1:(e instanceof Ps?e.text.length:e.children.length)<<1]}nextInner(e,i){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,r=this.nodes[n],o=this.offsets[n],a=o>>1,l=r instanceof Ps?r.text.length:r.children.length;if(a==(i>0?l:0)){if(n==0)return this.done=!0,this.value="",this;i>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((o&1)==(i>0?0:1)){if(this.offsets[n]+=i,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof Ps){let h=r.text[a+(i<0?-1:0)];if(this.offsets[n]+=i,h.length>Math.max(0,e))return this.value=e==0?h:i>0?h.slice(e):h.slice(0,h.length-e),this;e-=h.length}else{let h=r.children[a+(i<0?-1:0)];e>h.length?(e-=h.length,this.offsets[n]+=i):(i<0&&this.offsets[n]--,this.nodes.push(h),this.offsets.push(i>0?1:(h instanceof Ps?h.text.length:h.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class kq{constructor(e,i,n){this.value="",this.done=!1,this.cursor=new Kx(e,i>n?-1:1),this.pos=i>n?e.length:0,this.from=Math.min(i,n),this.to=Math.max(i,n)}nextInner(e,i){if(i<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,i<0?this.pos-this.to:this.from-this.pos);let n=i<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*i,this.value=r.length<=n?r:i<0?r.slice(r.length-n):r.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Pq{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:i,lineBreak:n,value:r}=this.inner.next(e);return i&&this.afterBreak?(this.value="",this.afterBreak=!1):i?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(yn.prototype[Symbol.iterator]=function(){return this.iter()},Kx.prototype[Symbol.iterator]=kq.prototype[Symbol.iterator]=Pq.prototype[Symbol.iterator]=function(){return this});class U3e{constructor(e,i,n,r){this.from=e,this.to=i,this.number=n,this.text=r}get length(){return this.to-this.from}}function gy(s,e,i){return e=Math.max(0,Math.min(s.length,e)),[e,Math.max(e,Math.min(s.length,i))]}let X0="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(s=>s?parseInt(s,36):1);for(let s=1;s<X0.length;s++)X0[s]+=X0[s-1];function F3e(s){for(let e=1;e<X0.length;e+=2)if(X0[e]>s)return X0[e-1]<=s;return!1}function Y6(s){return s>=127462&&s<=127487}const j6=8205;function Lr(s,e,i=!0,n=!0){return(i?Iq:z3e)(s,e,n)}function Iq(s,e,i){if(e==s.length)return e;e&&Bq(s.charCodeAt(e))&&Rq(s.charCodeAt(e-1))&&e--;let n=kr(s,e);for(e+=al(n);e<s.length;){let r=kr(s,e);if(n==j6||r==j6||i&&F3e(r))e+=al(r),n=r;else if(Y6(r)){let o=0,a=e-2;for(;a>=0&&Y6(kr(s,a));)o++,a-=2;if(o%2==0)break;e+=2}else break}return e}function z3e(s,e,i){for(;e>0;){let n=Iq(s,e-2,i);if(n<e)return n;e--}return 0}function Bq(s){return s>=56320&&s<57344}function Rq(s){return s>=55296&&s<56320}function kr(s,e){let i=s.charCodeAt(e);if(!Rq(i)||e+1==s.length)return i;let n=s.charCodeAt(e+1);return Bq(n)?(i-55296<<10)+(n-56320)+65536:i}function g3(s){return s<=65535?String.fromCharCode(s):(s-=65536,String.fromCharCode((s>>10)+55296,(s&1023)+56320))}function al(s){return s<65536?1:2}const YB=/\r\n?|\n/;var _o=function(s){return s[s.Simple=0]="Simple",s[s.TrackDel=1]="TrackDel",s[s.TrackBefore=2]="TrackBefore",s[s.TrackAfter=3]="TrackAfter",s}(_o||(_o={}));class Jc{constructor(e){this.sections=e}get length(){let e=0;for(let i=0;i<this.sections.length;i+=2)e+=this.sections[i];return e}get newLength(){let e=0;for(let i=0;i<this.sections.length;i+=2){let n=this.sections[i+1];e+=n<0?this.sections[i]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let i=0,n=0,r=0;i<this.sections.length;){let o=this.sections[i++],a=this.sections[i++];a<0?(e(n,r,o),r+=o):r+=a,n+=o}}iterChangedRanges(e,i=!1){jB(this,e,i)}get invertedDesc(){let e=[];for(let i=0;i<this.sections.length;){let n=this.sections[i++],r=this.sections[i++];r<0?e.push(n,r):e.push(r,n)}return new Jc(e)}composeDesc(e){return this.empty?e:e.empty?this:Dq(this,e)}mapDesc(e,i=!1){return e.empty?this:qB(this,e,i)}mapPos(e,i=-1,n=_o.Simple){let r=0,o=0;for(let a=0;a<this.sections.length;){let l=this.sections[a++],h=this.sections[a++],d=r+l;if(h<0){if(d>e)return o+(e-r);o+=l}else{if(n!=_o.Simple&&d>=e&&(n==_o.TrackDel&&r<e&&d>e||n==_o.TrackBefore&&r<e||n==_o.TrackAfter&&d>e))return null;if(d>e||d==e&&i<0&&!l)return e==r||i<0?o:o+h;o+=h}r=d}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return o}touchesRange(e,i=e){for(let n=0,r=0;n<this.sections.length&&r<=i;){let o=this.sections[n++],a=this.sections[n++],l=r+o;if(a>=0&&r<=i&&l>=e)return r<e&&l>i?"cover":!0;r=l}return!1}toString(){let e="";for(let i=0;i<this.sections.length;){let n=this.sections[i++],r=this.sections[i++];e+=(e?" ":"")+n+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(i=>typeof i!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Jc(e)}static create(e){return new Jc(e)}}class sr extends Jc{constructor(e,i){super(e),this.inserted=i}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return jB(this,(i,n,r,o,a)=>e=e.replace(r,r+(n-i),a),!1),e}mapDesc(e,i=!1){return qB(this,e,i,!0)}invert(e){let i=this.sections.slice(),n=[];for(let r=0,o=0;r<i.length;r+=2){let a=i[r],l=i[r+1];if(l>=0){i[r]=l,i[r+1]=a;let h=r>>1;for(;n.length<h;)n.push(yn.empty);n.push(a?e.slice(o,o+a):yn.empty)}o+=a}return new sr(i,n)}compose(e){return this.empty?e:e.empty?this:Dq(this,e,!0)}map(e,i=!1){return e.empty?this:qB(this,e,i,!0)}iterChanges(e,i=!1){jB(this,e,i)}get desc(){return Jc.create(this.sections)}filter(e){let i=[],n=[],r=[],o=new W_(this);e:for(let a=0,l=0;;){let h=a==e.length?1e9:e[a++];for(;l<h||l==h&&o.len==0;){if(o.done)break e;let f=Math.min(o.len,h-l);Gr(r,f,-1);let p=o.ins==-1?-1:o.off==0?o.ins:0;Gr(i,f,p),p>0&&zd(n,i,o.text),o.forward(f),l+=f}let d=e[a++];for(;l<d;){if(o.done)break e;let f=Math.min(o.len,d-l);Gr(i,f,-1),Gr(r,f,o.ins==-1?-1:o.off==0?o.ins:0),o.forward(f),l+=f}}return{changes:new sr(i,n),filtered:Jc.create(r)}}toJSON(){let e=[];for(let i=0;i<this.sections.length;i+=2){let n=this.sections[i],r=this.sections[i+1];r<0?e.push(n):r==0?e.push([n]):e.push([n].concat(this.inserted[i>>1].toJSON()))}return e}static of(e,i,n){let r=[],o=[],a=0,l=null;function h(f=!1){if(!f&&!r.length)return;a<i&&Gr(r,i-a,-1);let p=new sr(r,o);l=l?l.compose(p.map(l)):p,r=[],o=[],a=0}function d(f){if(Array.isArray(f))for(let p of f)d(p);else if(f instanceof sr){if(f.length!=i)throw new RangeError(`Mismatched change set length (got ${f.length}, expected ${i})`);h(),l=l?l.compose(f.map(l)):f}else{let{from:p,to:g=p,insert:y}=f;if(p>g||p<0||g>i)throw new RangeError(`Invalid change range ${p} to ${g} (in doc of length ${i})`);let x=y?typeof y=="string"?yn.of(y.split(n||YB)):y:yn.empty,_=x.length;if(p==g&&_==0)return;p<a&&h(),p>a&&Gr(r,p-a,-1),Gr(r,g-p,_),zd(o,r,x),a=g}}return d(e),h(!l),l}static empty(e){return new sr(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let i=[],n=[];for(let r=0;r<e.length;r++){let o=e[r];if(typeof o=="number")i.push(o,-1);else{if(!Array.isArray(o)||typeof o[0]!="number"||o.some((a,l)=>l&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(o.length==1)i.push(o[0],0);else{for(;n.length<r;)n.push(yn.empty);n[r]=yn.of(o.slice(1)),i.push(o[0],n[r].length)}}}return new sr(i,n)}static createSet(e,i){return new sr(e,i)}}function Gr(s,e,i,n=!1){if(e==0&&i<=0)return;let r=s.length-2;r>=0&&i<=0&&i==s[r+1]?s[r]+=e:e==0&&s[r]==0?s[r+1]+=i:n?(s[r]+=e,s[r+1]+=i):s.push(e,i)}function zd(s,e,i){if(i.length==0)return;let n=e.length-2>>1;if(n<s.length)s[s.length-1]=s[s.length-1].append(i);else{for(;s.length<n;)s.push(yn.empty);s.push(i)}}function jB(s,e,i){let n=s.inserted;for(let r=0,o=0,a=0;a<s.sections.length;){let l=s.sections[a++],h=s.sections[a++];if(h<0)r+=l,o+=l;else{let d=r,f=o,p=yn.empty;for(;d+=l,f+=h,h&&n&&(p=p.append(n[a-2>>1])),!(i||a==s.sections.length||s.sections[a+1]<0);)l=s.sections[a++],h=s.sections[a++];e(r,d,o,f,p),r=d,o=f}}}function qB(s,e,i,n=!1){let r=[],o=n?[]:null,a=new W_(s),l=new W_(e);for(let h=-1;;)if(a.ins==-1&&l.ins==-1){let d=Math.min(a.len,l.len);Gr(r,d,-1),a.forward(d),l.forward(d)}else if(l.ins>=0&&(a.ins<0||h==a.i||a.off==0&&(l.len<a.len||l.len==a.len&&!i))){let d=l.len;for(Gr(r,l.ins,-1);d;){let f=Math.min(a.len,d);a.ins>=0&&h<a.i&&a.len<=f&&(Gr(r,0,a.ins),o&&zd(o,r,a.text),h=a.i),a.forward(f),d-=f}l.next()}else if(a.ins>=0){let d=0,f=a.len;for(;f;)if(l.ins==-1){let p=Math.min(f,l.len);d+=p,f-=p,l.forward(p)}else if(l.ins==0&&l.len<f)f-=l.len,l.next();else break;Gr(r,d,h<a.i?a.ins:0),o&&h<a.i&&zd(o,r,a.text),h=a.i,a.forward(a.len-f)}else{if(a.done&&l.done)return o?sr.createSet(r,o):Jc.create(r);throw new Error("Mismatched change set lengths")}}function Dq(s,e,i=!1){let n=[],r=i?[]:null,o=new W_(s),a=new W_(e);for(let l=!1;;){if(o.done&&a.done)return r?sr.createSet(n,r):Jc.create(n);if(o.ins==0)Gr(n,o.len,0,l),o.next();else if(a.len==0&&!a.done)Gr(n,0,a.ins,l),r&&zd(r,n,a.text),a.next();else{if(o.done||a.done)throw new Error("Mismatched change set lengths");{let h=Math.min(o.len2,a.len),d=n.length;if(o.ins==-1){let f=a.ins==-1?-1:a.off?0:a.ins;Gr(n,h,f,l),r&&f&&zd(r,n,a.text)}else a.ins==-1?(Gr(n,o.off?0:o.len,h,l),r&&zd(r,n,o.textBit(h))):(Gr(n,o.off?0:o.len,a.off?0:a.ins,l),r&&!a.off&&zd(r,n,a.text));l=(o.ins>h||a.ins>=0&&a.len>h)&&(l||n.length>d),o.forward2(h),a.forward(h)}}}}class W_{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length?yn.empty:e[i]}textBit(e){let{inserted:i}=this.set,n=this.i-2>>1;return n>=i.length&&!e?yn.empty:i[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class $p{constructor(e,i,n){this.from=e,this.to=i,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,i=-1){let n,r;return this.empty?n=r=e.mapPos(this.from,i):(n=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),n==this.from&&r==this.to?this:new $p(n,r,this.flags)}extend(e,i=e){if(e<=this.anchor&&i>=this.anchor)return et.range(e,i);let n=Math.abs(e-this.anchor)>Math.abs(i-this.anchor)?e:i;return et.range(this.anchor,n)}eq(e,i=!1){return this.anchor==e.anchor&&this.head==e.head&&(!i||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return et.range(e.anchor,e.head)}static create(e,i,n){return new $p(e,i,n)}}class et{constructor(e,i){this.ranges=e,this.mainIndex=i}map(e,i=-1){return e.empty?this:et.create(this.ranges.map(n=>n.map(e,i)),this.mainIndex)}eq(e,i=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],i))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new et([this.main],0)}addRange(e,i=!0){return et.create([e].concat(this.ranges),i?0:this.mainIndex+1)}replaceRange(e,i=this.mainIndex){let n=this.ranges.slice();return n[i]=e,et.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new et(e.ranges.map(i=>$p.fromJSON(i)),e.main)}static single(e,i=e){return new et([et.range(e,i)],0)}static create(e,i=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,r=0;r<e.length;r++){let o=e[r];if(o.empty?o.from<=n:o.from<n)return et.normalized(e.slice(),i);n=o.to}return new et(e,i)}static cursor(e,i=0,n,r){return $p.create(e,e,(i==0?0:i<0?8:16)|(n==null?7:Math.min(6,n))|(r??16777215)<<6)}static range(e,i,n,r){let o=(n??16777215)<<6|(r==null?7:Math.min(6,r));return i<e?$p.create(i,e,48|o):$p.create(e,i,(i>e?8:0)|o)}static normalized(e,i=0){let n=e[i];e.sort((r,o)=>r.from-o.from),i=e.indexOf(n);for(let r=1;r<e.length;r++){let o=e[r],a=e[r-1];if(o.empty?o.from<=a.to:o.from<a.to){let l=a.from,h=Math.max(o.to,a.to);r<=i&&i--,e.splice(--r,2,o.anchor>o.head?et.range(h,l):et.range(l,h))}}return new et(e,i)}}function Lq(s,e){for(let i of s.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let y3=0;class Pt{constructor(e,i,n,r,o){this.combine=e,this.compareInput=i,this.compare=n,this.isStatic=r,this.id=y3++,this.default=e([]),this.extensions=typeof o=="function"?o(this):o}get reader(){return this}static define(e={}){return new Pt(e.combine||(i=>i),e.compareInput||((i,n)=>i===n),e.compare||(e.combine?(i,n)=>i===n:v3),!!e.static,e.enables)}of(e){return new JS([],this,0,e)}compute(e,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new JS(e,this,1,i)}computeN(e,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new JS(e,this,2,i)}from(e,i){return i||(i=n=>n),this.compute([e],n=>i(n.field(e)))}}function v3(s,e){return s==e||s.length==e.length&&s.every((i,n)=>i===e[n])}class JS{constructor(e,i,n,r){this.dependencies=e,this.facet=i,this.type=n,this.value=r,this.id=y3++}dynamicSlot(e){var i;let n=this.value,r=this.facet.compareInput,o=this.id,a=e[o]>>1,l=this.type==2,h=!1,d=!1,f=[];for(let p of this.dependencies)p=="doc"?h=!0:p=="selection"?d=!0:((i=e[p.id])!==null&&i!==void 0?i:1)&1||f.push(e[p.id]);return{create(p){return p.values[a]=n(p),1},update(p,g){if(h&&g.docChanged||d&&(g.docChanged||g.selection)||ZB(p,f)){let y=n(p);if(l?!q6(y,p.values[a],r):!r(y,p.values[a]))return p.values[a]=y,1}return 0},reconfigure:(p,g)=>{let y,x=g.config.address[o];if(x!=null){let _=tT(g,x);if(this.dependencies.every(w=>w instanceof Pt?g.facet(w)===p.facet(w):w instanceof $r?g.field(w,!1)==p.field(w,!1):!0)||(l?q6(y=n(p),_,r):r(y=n(p),_)))return p.values[a]=_,0}else y=n(p);return p.values[a]=y,1}}}}function q6(s,e,i){if(s.length!=e.length)return!1;for(let n=0;n<s.length;n++)if(!i(s[n],e[n]))return!1;return!0}function ZB(s,e){let i=!1;for(let n of e)Jx(s,n)&1&&(i=!0);return i}function X3e(s,e,i){let n=i.map(h=>s[h.id]),r=i.map(h=>h.type),o=n.filter(h=>!(h&1)),a=s[e.id]>>1;function l(h){let d=[];for(let f=0;f<n.length;f++){let p=tT(h,n[f]);if(r[f]==2)for(let g of p)d.push(g);else d.push(p)}return e.combine(d)}return{create(h){for(let d of n)Jx(h,d);return h.values[a]=l(h),1},update(h,d){if(!ZB(h,o))return 0;let f=l(h);return e.compare(f,h.values[a])?0:(h.values[a]=f,1)},reconfigure(h,d){let f=ZB(h,n),p=d.config.facets[e.id],g=d.facet(e);if(p&&!f&&v3(i,p))return h.values[a]=g,0;let y=l(h);return e.compare(y,g)?(h.values[a]=g,0):(h.values[a]=y,1)}}}const Z6=Pt.define({static:!0});class $r{constructor(e,i,n,r,o){this.id=e,this.createF=i,this.updateF=n,this.compareF=r,this.spec=o,this.provides=void 0}static define(e){let i=new $r(y3++,e.create,e.update,e.compare||((n,r)=>n===r),e);return e.provide&&(i.provides=e.provide(i)),i}create(e){let i=e.facet(Z6).find(n=>n.field==this);return((i==null?void 0:i.create)||this.createF)(e)}slot(e){let i=e[this.id]>>1;return{create:n=>(n.values[i]=this.create(n),1),update:(n,r)=>{let o=n.values[i],a=this.updateF(o,r);return this.compareF(o,a)?0:(n.values[i]=a,1)},reconfigure:(n,r)=>r.config.address[this.id]!=null?(n.values[i]=r.field(this),0):(n.values[i]=this.create(n),1)}}init(e){return[this,Z6.of({field:this,create:e})]}get extension(){return this}}const Ep={lowest:4,low:3,default:2,high:1,highest:0};function Kv(s){return e=>new Nq(e,s)}const Rm={highest:Kv(Ep.highest),high:Kv(Ep.high),default:Kv(Ep.default),low:Kv(Ep.low),lowest:Kv(Ep.lowest)};class Nq{constructor(e,i){this.inner=e,this.prec=i}}class KA{of(e){return new KB(this,e)}reconfigure(e){return KA.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class KB{constructor(e,i){this.compartment=e,this.inner=i}}class eT{constructor(e,i,n,r,o,a){for(this.base=e,this.compartments=i,this.dynamicSlots=n,this.address=r,this.staticValues=o,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let i=this.address[e.id];return i==null?e.default:this.staticValues[i>>1]}static resolve(e,i,n){let r=[],o=Object.create(null),a=new Map;for(let g of W3e(e,i,a))g instanceof $r?r.push(g):(o[g.facet.id]||(o[g.facet.id]=[])).push(g);let l=Object.create(null),h=[],d=[];for(let g of r)l[g.id]=d.length<<1,d.push(y=>g.slot(y));let f=n==null?void 0:n.config.facets;for(let g in o){let y=o[g],x=y[0].facet,_=f&&f[g]||[];if(y.every(w=>w.type==0))if(l[x.id]=h.length<<1|1,v3(_,y))h.push(n.facet(x));else{let w=x.combine(y.map(O=>O.value));h.push(n&&x.compare(w,n.facet(x))?n.facet(x):w)}else{for(let w of y)w.type==0?(l[w.id]=h.length<<1|1,h.push(w.value)):(l[w.id]=d.length<<1,d.push(O=>w.dynamicSlot(O)));l[x.id]=d.length<<1,d.push(w=>X3e(w,x,y))}}let p=d.map(g=>g(l));return new eT(e,a,p,l,h,o)}}function W3e(s,e,i){let n=[[],[],[],[],[]],r=new Map;function o(a,l){let h=r.get(a);if(h!=null){if(h<=l)return;let d=n[h].indexOf(a);d>-1&&n[h].splice(d,1),a instanceof KB&&i.delete(a.compartment)}if(r.set(a,l),Array.isArray(a))for(let d of a)o(d,l);else if(a instanceof KB){if(i.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let d=e.get(a.compartment)||a.inner;i.set(a.compartment,d),o(d,l)}else if(a instanceof Nq)o(a.inner,a.prec);else if(a instanceof $r)n[l].push(a),a.provides&&o(a.provides,l);else if(a instanceof JS)n[l].push(a),a.facet.extensions&&o(a.facet.extensions,Ep.default);else{let d=a.extension;if(!d)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);o(d,l)}}return o(s,Ep.default),n.reduce((a,l)=>a.concat(l))}function Jx(s,e){if(e&1)return 2;let i=e>>1,n=s.status[i];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;s.status[i]=4;let r=s.computeSlot(s,s.config.dynamicSlots[i]);return s.status[i]=2|r}function tT(s,e){return e&1?s.config.staticValues[e>>1]:s.values[e>>1]}const Vq=Pt.define(),JB=Pt.define({combine:s=>s.some(e=>e),static:!0}),$q=Pt.define({combine:s=>s.length?s[0]:void 0,static:!0}),Uq=Pt.define(),Fq=Pt.define(),zq=Pt.define(),Xq=Pt.define({combine:s=>s.length?s[0]:!1});class Pu{constructor(e,i){this.type=e,this.value=i}static define(){return new H3e}}class H3e{of(e){return new Pu(this,e)}}class G3e{constructor(e){this.map=e}of(e){return new Fi(this,e)}}class Fi{constructor(e,i){this.type=e,this.value=i}map(e){let i=this.type.map(this.value,e);return i===void 0?void 0:i==this.value?this:new Fi(this.type,i)}is(e){return this.type==e}static define(e={}){return new G3e(e.map||(i=>i))}static mapEffects(e,i){if(!e.length)return e;let n=[];for(let r of e){let o=r.map(i);o&&n.push(o)}return n}}Fi.reconfigure=Fi.define();Fi.appendConfig=Fi.define();class cr{constructor(e,i,n,r,o,a){this.startState=e,this.changes=i,this.selection=n,this.effects=r,this.annotations=o,this.scrollIntoView=a,this._doc=null,this._state=null,n&&Lq(n,i.newLength),o.some(l=>l.type==cr.time)||(this.annotations=o.concat(cr.time.of(Date.now())))}static create(e,i,n,r,o,a){return new cr(e,i,n,r,o,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let i of this.annotations)if(i.type==e)return i.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let i=this.annotation(cr.userEvent);return!!(i&&(i==e||i.length>e.length&&i.slice(0,e.length)==e&&i[e.length]=="."))}}cr.time=Pu.define();cr.userEvent=Pu.define();cr.addToHistory=Pu.define();cr.remote=Pu.define();function Q3e(s,e){let i=[];for(let n=0,r=0;;){let o,a;if(n<s.length&&(r==e.length||e[r]>=s[n]))o=s[n++],a=s[n++];else if(r<e.length)o=e[r++],a=e[r++];else return i;!i.length||i[i.length-1]<o?i.push(o,a):i[i.length-1]<a&&(i[i.length-1]=a)}}function Wq(s,e,i){var n;let r,o,a;return i?(r=e.changes,o=sr.empty(e.changes.length),a=s.changes.compose(e.changes)):(r=e.changes.map(s.changes),o=s.changes.mapDesc(e.changes,!0),a=s.changes.compose(r)),{changes:a,selection:e.selection?e.selection.map(o):(n=s.selection)===null||n===void 0?void 0:n.map(r),effects:Fi.mapEffects(s.effects,r).concat(Fi.mapEffects(e.effects,o)),annotations:s.annotations.length?s.annotations.concat(e.annotations):e.annotations,scrollIntoView:s.scrollIntoView||e.scrollIntoView}}function eR(s,e,i){let n=e.selection,r=W0(e.annotations);return e.userEvent&&(r=r.concat(cr.userEvent.of(e.userEvent))),{changes:e.changes instanceof sr?e.changes:sr.of(e.changes||[],i,s.facet($q)),selection:n&&(n instanceof et?n:et.single(n.anchor,n.head)),effects:W0(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function Hq(s,e,i){let n=eR(s,e.length?e[0]:{},s.doc.length);e.length&&e[0].filter===!1&&(i=!1);for(let o=1;o<e.length;o++){e[o].filter===!1&&(i=!1);let a=!!e[o].sequential;n=Wq(n,eR(s,e[o],a?n.changes.newLength:s.doc.length),a)}let r=cr.create(s,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return j3e(i?Y3e(r):r)}function Y3e(s){let e=s.startState,i=!0;for(let r of e.facet(Uq)){let o=r(s);if(o===!1){i=!1;break}Array.isArray(o)&&(i=i===!0?o:Q3e(i,o))}if(i!==!0){let r,o;if(i===!1)o=s.changes.invertedDesc,r=sr.empty(e.doc.length);else{let a=s.changes.filter(i);r=a.changes,o=a.filtered.mapDesc(a.changes).invertedDesc}s=cr.create(e,r,s.selection&&s.selection.map(o),Fi.mapEffects(s.effects,o),s.annotations,s.scrollIntoView)}let n=e.facet(Fq);for(let r=n.length-1;r>=0;r--){let o=n[r](s);o instanceof cr?s=o:Array.isArray(o)&&o.length==1&&o[0]instanceof cr?s=o[0]:s=Hq(e,W0(o),!1)}return s}function j3e(s){let e=s.startState,i=e.facet(zq),n=s;for(let r=i.length-1;r>=0;r--){let o=i[r](s);o&&Object.keys(o).length&&(n=Wq(n,eR(e,o,s.changes.newLength),!0))}return n==s?s:cr.create(e,s.changes,s.selection,n.effects,n.annotations,n.scrollIntoView)}const q3e=[];function W0(s){return s==null?q3e:Array.isArray(s)?s:[s]}var ls=function(s){return s[s.Word=0]="Word",s[s.Space=1]="Space",s[s.Other=2]="Other",s}(ls||(ls={}));const Z3e=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let tR;try{tR=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function K3e(s){if(tR)return tR.test(s);for(let e=0;e<s.length;e++){let i=s[e];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||Z3e.test(i)))return!0}return!1}function J3e(s){return e=>{if(!/\S/.test(e))return ls.Space;if(K3e(e))return ls.Word;for(let i=0;i<s.length;i++)if(e.indexOf(s[i])>-1)return ls.Word;return ls.Other}}class gn{constructor(e,i,n,r,o,a){this.config=e,this.doc=i,this.selection=n,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=o,a&&(a._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)Jx(this,l<<1);this.computeSlot=null}field(e,i=!0){let n=this.config.address[e.id];if(n==null){if(i)throw new RangeError("Field is not present in this state");return}return Jx(this,n),tT(this,n)}update(...e){return Hq(this,e,!0)}applyTransaction(e){let i=this.config,{base:n,compartments:r}=i;for(let l of e.effects)l.is(KA.reconfigure)?(i&&(r=new Map,i.compartments.forEach((h,d)=>r.set(d,h)),i=null),r.set(l.value.compartment,l.value.extension)):l.is(Fi.reconfigure)?(i=null,n=l.value):l.is(Fi.appendConfig)&&(i=null,n=W0(n).concat(l.value));let o;i?o=e.startState.values.slice():(i=eT.resolve(n,r,this),o=new gn(i,this.doc,this.selection,i.dynamicSlots.map(()=>null),(h,d)=>d.reconfigure(h,this),null).values);let a=e.startState.facet(JB)?e.newSelection:e.newSelection.asSingle();new gn(i,e.newDoc,a,o,(l,h)=>h.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:e},range:et.cursor(i.from+e.length)}))}changeByRange(e){let i=this.selection,n=e(i.ranges[0]),r=this.changes(n.changes),o=[n.range],a=W0(n.effects);for(let l=1;l<i.ranges.length;l++){let h=e(i.ranges[l]),d=this.changes(h.changes),f=d.map(r);for(let g=0;g<l;g++)o[g]=o[g].map(f);let p=r.mapDesc(d,!0);o.push(h.range.map(p)),r=r.compose(f),a=Fi.mapEffects(a,f).concat(Fi.mapEffects(W0(h.effects),p))}return{changes:r,selection:et.create(o,i.mainIndex),effects:a}}changes(e=[]){return e instanceof sr?e:sr.of(e,this.doc.length,this.facet(gn.lineSeparator))}toText(e){return yn.of(e.split(this.facet(gn.lineSeparator)||YB))}sliceDoc(e=0,i=this.doc.length){return this.doc.sliceString(e,i,this.lineBreak)}facet(e){let i=this.config.address[e.id];return i==null?e.default:(Jx(this,i),tT(this,i))}toJSON(e){let i={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let r=e[n];r instanceof $r&&this.config.address[r.id]!=null&&(i[n]=r.spec.toJSON(this.field(e[n]),this))}return i}static fromJSON(e,i={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(n){for(let o in n)if(Object.prototype.hasOwnProperty.call(e,o)){let a=n[o],l=e[o];r.push(a.init(h=>a.spec.fromJSON(l,h)))}}return gn.create({doc:e.doc,selection:et.fromJSON(e.selection),extensions:i.extensions?r.concat([i.extensions]):r})}static create(e={}){let i=eT.resolve(e.extensions||[],new Map),n=e.doc instanceof yn?e.doc:yn.of((e.doc||"").split(i.staticFacet(gn.lineSeparator)||YB)),r=e.selection?e.selection instanceof et?e.selection:et.single(e.selection.anchor,e.selection.head):et.single(0);return Lq(r,n.length),i.staticFacet(JB)||(r=r.asSingle()),new gn(i,n,r,i.dynamicSlots.map(()=>null),(o,a)=>a.create(o),null)}get tabSize(){return this.facet(gn.tabSize)}get lineBreak(){return this.facet(gn.lineSeparator)||`
`}get readOnly(){return this.facet(Xq)}phrase(e,...i){for(let n of this.facet(gn.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return i.length&&(e=e.replace(/\$(\$|\d*)/g,(n,r)=>{if(r=="$")return"$";let o=+(r||1);return!o||o>i.length?n:i[o-1]})),e}languageDataAt(e,i,n=-1){let r=[];for(let o of this.facet(Vq))for(let a of o(this,i,n))Object.prototype.hasOwnProperty.call(a,e)&&r.push(a[e]);return r}charCategorizer(e){return J3e(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:i,from:n,length:r}=this.doc.lineAt(e),o=this.charCategorizer(e),a=e-n,l=e-n;for(;a>0;){let h=Lr(i,a,!1);if(o(i.slice(h,a))!=ls.Word)break;a=h}for(;l<r;){let h=Lr(i,l);if(o(i.slice(l,h))!=ls.Word)break;l=h}return a==l?null:et.range(a+n,l+n)}}gn.allowMultipleSelections=JB;gn.tabSize=Pt.define({combine:s=>s.length?s[0]:4});gn.lineSeparator=$q;gn.readOnly=Xq;gn.phrases=Pt.define({compare(s,e){let i=Object.keys(s),n=Object.keys(e);return i.length==n.length&&i.every(r=>s[r]==e[r])}});gn.languageData=Vq;gn.changeFilter=Uq;gn.transactionFilter=Fq;gn.transactionExtender=zq;KA.reconfigure=Fi.define();function fh(s,e,i={}){let n={};for(let r of s)for(let o of Object.keys(r)){let a=r[o],l=n[o];if(l===void 0)n[o]=a;else if(!(l===a||a===void 0))if(Object.hasOwnProperty.call(i,o))n[o]=i[o](l,a);else throw new Error("Config merge conflict for field "+o)}for(let r in e)n[r]===void 0&&(n[r]=e[r]);return n}class xm{eq(e){return this==e}range(e,i=e){return iR.create(e,i,this)}}xm.prototype.startSide=xm.prototype.endSide=0;xm.prototype.point=!1;xm.prototype.mapMode=_o.TrackDel;let iR=class Gq{constructor(e,i,n){this.from=e,this.to=i,this.value=n}static create(e,i,n){return new Gq(e,i,n)}};function nR(s,e){return s.from-e.from||s.value.startSide-e.value.startSide}class x3{constructor(e,i,n,r){this.from=e,this.to=i,this.value=n,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,i,n,r=0){let o=n?this.to:this.from;for(let a=r,l=o.length;;){if(a==l)return a;let h=a+l>>1,d=o[h]-e||(n?this.value[h].endSide:this.value[h].startSide)-i;if(h==a)return d>=0?a:l;d>=0?l=h:a=h+1}}between(e,i,n,r){for(let o=this.findIndex(i,-1e9,!0),a=this.findIndex(n,1e9,!1,o);o<a;o++)if(r(this.from[o]+e,this.to[o]+e,this.value[o])===!1)return!1}map(e,i){let n=[],r=[],o=[],a=-1,l=-1;for(let h=0;h<this.value.length;h++){let d=this.value[h],f=this.from[h]+e,p=this.to[h]+e,g,y;if(f==p){let x=i.mapPos(f,d.startSide,d.mapMode);if(x==null||(g=y=x,d.startSide!=d.endSide&&(y=i.mapPos(f,d.endSide),y<g)))continue}else if(g=i.mapPos(f,d.startSide),y=i.mapPos(p,d.endSide),g>y||g==y&&d.startSide>0&&d.endSide<=0)continue;(y-g||d.endSide-d.startSide)<0||(a<0&&(a=g),d.point&&(l=Math.max(l,y-g)),n.push(d),r.push(g-a),o.push(y-a))}return{mapped:n.length?new x3(r,o,n,l):null,pos:a}}}class fn{constructor(e,i,n,r){this.chunkPos=e,this.chunk=i,this.nextLayer=n,this.maxPoint=r}static create(e,i,n,r){return new fn(e,i,n,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let i of this.chunk)e+=i.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:i=[],sort:n=!1,filterFrom:r=0,filterTo:o=this.length}=e,a=e.filter;if(i.length==0&&!a)return this;if(n&&(i=i.slice().sort(nR)),this.isEmpty)return i.length?fn.of(i):this;let l=new Qq(this,null,-1).goto(0),h=0,d=[],f=new rf;for(;l.value||h<i.length;)if(h<i.length&&(l.from-i[h].from||l.startSide-i[h].value.startSide)>=0){let p=i[h++];f.addInner(p.from,p.to,p.value)||d.push(p)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(h==i.length||this.chunkEnd(l.chunkIndex)<i[h].from)&&(!a||r>this.chunkEnd(l.chunkIndex)||o<this.chunkPos[l.chunkIndex])&&f.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!a||r>l.to||o<l.from||a(l.from,l.to,l.value))&&(f.addInner(l.from,l.to,l.value)||d.push(iR.create(l.from,l.to,l.value))),l.next());return f.finishInner(this.nextLayer.isEmpty&&!d.length?fn.empty:this.nextLayer.update({add:d,filter:a,filterFrom:r,filterTo:o}))}map(e){if(e.empty||this.isEmpty)return this;let i=[],n=[],r=-1;for(let a=0;a<this.chunk.length;a++){let l=this.chunkPos[a],h=this.chunk[a],d=e.touchesRange(l,l+h.length);if(d===!1)r=Math.max(r,h.maxPoint),i.push(h),n.push(e.mapPos(l));else if(d===!0){let{mapped:f,pos:p}=h.map(l,e);f&&(r=Math.max(r,f.maxPoint),i.push(f),n.push(p))}}let o=this.nextLayer.map(e);return i.length==0?o:new fn(n,i,o||fn.empty,r)}between(e,i,n){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let o=this.chunkPos[r],a=this.chunk[r];if(i>=o&&e<=o+a.length&&a.between(o,e-o,i-o,n)===!1)return}this.nextLayer.between(e,i,n)}}iter(e=0){return H_.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,i=0){return H_.from(e).goto(i)}static compare(e,i,n,r,o=-1){let a=e.filter(p=>p.maxPoint>0||!p.isEmpty&&p.maxPoint>=o),l=i.filter(p=>p.maxPoint>0||!p.isEmpty&&p.maxPoint>=o),h=K6(a,l,n),d=new Jv(a,h,o),f=new Jv(l,h,o);n.iterGaps((p,g,y)=>J6(d,p,f,g,y,r)),n.empty&&n.length==0&&J6(d,0,f,0,0,r)}static eq(e,i,n=0,r){r==null&&(r=999999999);let o=e.filter(f=>!f.isEmpty&&i.indexOf(f)<0),a=i.filter(f=>!f.isEmpty&&e.indexOf(f)<0);if(o.length!=a.length)return!1;if(!o.length)return!0;let l=K6(o,a),h=new Jv(o,l,0).goto(n),d=new Jv(a,l,0).goto(n);for(;;){if(h.to!=d.to||!sR(h.active,d.active)||h.point&&(!d.point||!h.point.eq(d.point)))return!1;if(h.to>r)return!0;h.next(),d.next()}}static spans(e,i,n,r,o=-1){let a=new Jv(e,null,o).goto(i),l=i,h=a.openStart;for(;;){let d=Math.min(a.to,n);if(a.point){let f=a.activeForPoint(a.to),p=a.pointFrom<i?f.length+1:a.point.startSide<0?f.length:Math.min(f.length,h);r.point(l,d,a.point,f,p,a.pointRank),h=Math.min(a.openEnd(d),f.length)}else d>l&&(r.span(l,d,a.active,h),h=a.openEnd(d));if(a.to>n)return h+(a.point&&a.to>n?1:0);l=a.to,a.next()}}static of(e,i=!1){let n=new rf;for(let r of e instanceof iR?[e]:i?eNe(e):e)n.add(r.from,r.to,r.value);return n.finish()}static join(e){if(!e.length)return fn.empty;let i=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let r=e[n];r!=fn.empty;r=r.nextLayer)i=new fn(r.chunkPos,r.chunk,i,Math.max(r.maxPoint,i.maxPoint));return i}}fn.empty=new fn([],[],null,-1);function eNe(s){if(s.length>1)for(let e=s[0],i=1;i<s.length;i++){let n=s[i];if(nR(e,n)>0)return s.slice().sort(nR);e=n}return s}fn.empty.nextLayer=fn.empty;class rf{finishChunk(e){this.chunks.push(new x3(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,i,n){this.addInner(e,i,n)||(this.nextLayer||(this.nextLayer=new rf)).add(e,i,n)}addInner(e,i,n){let r=e-this.lastTo||n.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(i-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=i,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,i-e)),!0)}addChunk(e,i){if((e-this.lastTo||i.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,i.maxPoint),this.chunks.push(i),this.chunkPos.push(e);let n=i.value.length-1;return this.last=i.value[n],this.lastFrom=i.from[n]+e,this.lastTo=i.to[n]+e,!0}finish(){return this.finishInner(fn.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let i=fn.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,i}}function K6(s,e,i){let n=new Map;for(let o of s)for(let a=0;a<o.chunk.length;a++)o.chunk[a].maxPoint<=0&&n.set(o.chunk[a],o.chunkPos[a]);let r=new Set;for(let o of e)for(let a=0;a<o.chunk.length;a++){let l=n.get(o.chunk[a]);l!=null&&(i?i.mapPos(l):l)==o.chunkPos[a]&&!(i!=null&&i.touchesRange(l,l+o.chunk[a].length))&&r.add(o.chunk[a])}return r}class Qq{constructor(e,i,n,r=0){this.layer=e,this.skip=i,this.minPoint=n,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,i=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,i,!1),this}gotoInner(e,i,n){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],i,!0);(!n||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,i){(this.to-e||this.endSide-i)<0&&this.gotoInner(e,i,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],i=this.layer.chunk[this.chunkIndex],n=e+i.from[this.rangeIndex];if(this.from=n,this.to=e+i.to[this.rangeIndex],this.value=i.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class H_{constructor(e){this.heap=e}static from(e,i=null,n=-1){let r=[];for(let o=0;o<e.length;o++)for(let a=e[o];!a.isEmpty;a=a.nextLayer)a.maxPoint>=n&&r.push(new Qq(a,i,n,o));return r.length==1?r[0]:new H_(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,i=-1e9){for(let n of this.heap)n.goto(e,i);for(let n=this.heap.length>>1;n>=0;n--)LP(this.heap,n);return this.next(),this}forward(e,i){for(let n of this.heap)n.forward(e,i);for(let n=this.heap.length>>1;n>=0;n--)LP(this.heap,n);(this.to-e||this.value.endSide-i)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),LP(this.heap,0)}}}function LP(s,e){for(let i=s[e];;){let n=(e<<1)+1;if(n>=s.length)break;let r=s[n];if(n+1<s.length&&r.compare(s[n+1])>=0&&(r=s[n+1],n++),i.compare(r)<0)break;s[n]=i,s[e]=r,e=n}}class Jv{constructor(e,i,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=H_.from(e,i,n)}goto(e,i=-1e9){return this.cursor.goto(e,i),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=i,this.openStart=-1,this.next(),this}forward(e,i){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-i)<0;)this.removeActive(this.minActive);this.cursor.forward(e,i)}removeActive(e){SO(this.active,e),SO(this.activeTo,e),SO(this.activeRank,e),this.minActive=eX(this.active,this.activeTo)}addActive(e){let i=0,{value:n,to:r,rank:o}=this.cursor;for(;i<this.activeRank.length&&(o-this.activeRank[i]||r-this.activeTo[i])>0;)i++;CO(this.active,i,n),CO(this.activeTo,i,r),CO(this.activeRank,i,o),e&&CO(e,i,this.cursor.from),this.minActive=eX(this.active,this.activeTo)}next(){let e=this.to,i=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),n&&SO(n,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(n),this.cursor.next();else if(i&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let r=n.length-1;r>=0&&n[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let i=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&i.push(this.active[n]);return i.reverse()}openEnd(e){let i=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)i++;return i}}function J6(s,e,i,n,r,o){s.goto(e),i.goto(n);let a=n+r,l=n,h=n-e;for(;;){let d=s.to+h-i.to||s.endSide-i.endSide,f=d<0?s.to+h:i.to,p=Math.min(f,a);if(s.point||i.point?s.point&&i.point&&(s.point==i.point||s.point.eq(i.point))&&sR(s.activeForPoint(s.to),i.activeForPoint(i.to))||o.comparePoint(l,p,s.point,i.point):p>l&&!sR(s.active,i.active)&&o.compareRange(l,p,s.active,i.active),f>a)break;l=f,d<=0&&s.next(),d>=0&&i.next()}}function sR(s,e){if(s.length!=e.length)return!1;for(let i=0;i<s.length;i++)if(s[i]!=e[i]&&!s[i].eq(e[i]))return!1;return!0}function SO(s,e){for(let i=e,n=s.length-1;i<n;i++)s[i]=s[i+1];s.pop()}function CO(s,e,i){for(let n=s.length-1;n>=e;n--)s[n+1]=s[n];s[e]=i}function eX(s,e){let i=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||s[r].endSide-s[i].endSide)<0&&(i=r,n=e[r]);return i}function $y(s,e,i=s.length){let n=0;for(let r=0;r<i;)s.charCodeAt(r)==9?(n+=e-n%e,r++):(n++,r=Lr(s,r));return n}function rR(s,e,i,n){for(let r=0,o=0;;){if(o>=e)return r;if(r==s.length)break;o+=s.charCodeAt(r)==9?i-o%i:1,r=Lr(s,r)}return n===!0?-1:s.length}const oR="",tX=typeof Symbol>"u"?"__"+oR:Symbol.for(oR),aR=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),iX=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class of{constructor(e,i){this.rules=[];let{finish:n}=i||{};function r(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function o(a,l,h,d){let f=[],p=/^@(\w+)\b/.exec(a[0]),g=p&&p[1]=="keyframes";if(p&&l==null)return h.push(a[0]+";");for(let y in l){let x=l[y];if(/&/.test(y))o(y.split(/,\s*/).map(_=>a.map(w=>_.replace(/&/,w))).reduce((_,w)=>_.concat(w)),x,h);else if(x&&typeof x=="object"){if(!p)throw new RangeError("The value of a property ("+y+") should be a primitive value.");o(r(y),x,f,g)}else x!=null&&f.push(y.replace(/_.*/,"").replace(/[A-Z]/g,_=>"-"+_.toLowerCase())+": "+x+";")}(f.length||g)&&h.push((n&&!p&&!d?a.map(n):a).join(", ")+" {"+f.join(" ")+"}")}for(let a in e)o(r(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=iX[tX]||1;return iX[tX]=e+1,oR+e.toString(36)}static mount(e,i,n){let r=e[aR],o=n&&n.nonce;r?o&&r.setNonce(o):r=new tNe(e,o),r.mount(Array.isArray(i)?i:[i],e)}}let nX=new Map;class tNe{constructor(e,i){let n=e.ownerDocument||e,r=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let o=nX.get(n);if(o)return e[aR]=o;this.sheet=new r.CSSStyleSheet,nX.set(n,this)}else this.styleTag=n.createElement("style"),i&&this.styleTag.setAttribute("nonce",i);this.modules=[],e[aR]=this}mount(e,i){let n=this.sheet,r=0,o=0;for(let a=0;a<e.length;a++){let l=e[a],h=this.modules.indexOf(l);if(h<o&&h>-1&&(this.modules.splice(h,1),o--,h=-1),h==-1){if(this.modules.splice(o++,0,l),n)for(let d=0;d<l.rules.length;d++)n.insertRule(l.rules[d],r++)}else{for(;o<h;)r+=this.modules[o++].rules.length;r+=l.rules.length,o++}}if(n)i.adoptedStyleSheets.indexOf(this.sheet)<0&&(i.adoptedStyleSheets=[this.sheet,...i.adoptedStyleSheets]);else{let a="";for(let h=0;h<this.modules.length;h++)a+=this.modules[h].getRules()+`
`;this.styleTag.textContent=a;let l=i.head||i;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var af={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},G_={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},iNe=typeof navigator<"u"&&/Mac/.test(navigator.platform),nNe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Pr=0;Pr<10;Pr++)af[48+Pr]=af[96+Pr]=String(Pr);for(var Pr=1;Pr<=24;Pr++)af[Pr+111]="F"+Pr;for(var Pr=65;Pr<=90;Pr++)af[Pr]=String.fromCharCode(Pr+32),G_[Pr]=String.fromCharCode(Pr);for(var NP in af)G_.hasOwnProperty(NP)||(G_[NP]=af[NP]);function sNe(s){var e=iNe&&s.metaKey&&s.shiftKey&&!s.ctrlKey&&!s.altKey||nNe&&s.shiftKey&&s.key&&s.key.length==1||s.key=="Unidentified",i=!e&&s.key||(s.shiftKey?G_:af)[s.keyCode]||s.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}function Q_(s){let e;return s.nodeType==11?e=s.getSelection?s:s.ownerDocument:e=s,e.getSelection()}function lR(s,e){return e?s==e||s.contains(e.nodeType!=1?e.parentNode:e):!1}function rNe(s){let e=s.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function eC(s,e){if(!e.anchorNode)return!1;try{return lR(s,e.anchorNode)}catch{return!1}}function Y_(s){return s.nodeType==3?bm(s,0,s.nodeValue.length).getClientRects():s.nodeType==1?s.getClientRects():[]}function e_(s,e,i,n){return i?sX(s,e,i,n,-1)||sX(s,e,i,n,1):!1}function _m(s){for(var e=0;;e++)if(s=s.previousSibling,!s)return e}function iT(s){return s.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(s.nodeName)}function sX(s,e,i,n,r){for(;;){if(s==i&&e==n)return!0;if(e==(r<0?0:Ou(s))){if(s.nodeName=="DIV")return!1;let o=s.parentNode;if(!o||o.nodeType!=1)return!1;e=_m(s)+(r<0?0:1),s=o}else if(s.nodeType==1){if(s=s.childNodes[e+(r<0?-1:0)],s.nodeType==1&&s.contentEditable=="false")return!1;e=r<0?Ou(s):0}else return!1}}function Ou(s){return s.nodeType==3?s.nodeValue.length:s.childNodes.length}function JA(s,e){let i=e?s.left:s.right;return{left:i,right:i,top:s.top,bottom:s.bottom}}function oNe(s){let e=s.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:s.innerWidth,top:0,bottom:s.innerHeight}}function Yq(s,e){let i=e.width/s.offsetWidth,n=e.height/s.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-s.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-s.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}function aNe(s,e,i,n,r,o,a,l){let h=s.ownerDocument,d=h.defaultView||window;for(let f=s,p=!1;f&&!p;)if(f.nodeType==1){let g,y=f==h.body,x=1,_=1;if(y)g=oNe(d);else{if(/^(fixed|sticky)$/.test(getComputedStyle(f).position)&&(p=!0),f.scrollHeight<=f.clientHeight&&f.scrollWidth<=f.clientWidth){f=f.assignedSlot||f.parentNode;continue}let T=f.getBoundingClientRect();({scaleX:x,scaleY:_}=Yq(f,T)),g={left:T.left,right:T.left+f.clientWidth*x,top:T.top,bottom:T.top+f.clientHeight*_}}let w=0,O=0;if(r=="nearest")e.top<g.top?(O=-(g.top-e.top+a),i>0&&e.bottom>g.bottom+O&&(O=e.bottom-g.bottom+O+a)):e.bottom>g.bottom&&(O=e.bottom-g.bottom+a,i<0&&e.top-O<g.top&&(O=-(g.top+O-e.top+a)));else{let T=e.bottom-e.top,C=g.bottom-g.top;O=(r=="center"&&T<=C?e.top+T/2-C/2:r=="start"||r=="center"&&i<0?e.top-a:e.bottom-C+a)-g.top}if(n=="nearest"?e.left<g.left?(w=-(g.left-e.left+o),i>0&&e.right>g.right+w&&(w=e.right-g.right+w+o)):e.right>g.right&&(w=e.right-g.right+o,i<0&&e.left<g.left+w&&(w=-(g.left+w-e.left+o))):w=(n=="center"?e.left+(e.right-e.left)/2-(g.right-g.left)/2:n=="start"==l?e.left-o:e.right-(g.right-g.left)+o)-g.left,w||O)if(y)d.scrollBy(w,O);else{let T=0,C=0;if(O){let A=f.scrollTop;f.scrollTop+=O/_,C=(f.scrollTop-A)*_}if(w){let A=f.scrollLeft;f.scrollLeft+=w/x,T=(f.scrollLeft-A)*x}e={left:e.left-T,top:e.top-C,right:e.right-T,bottom:e.bottom-C},T&&Math.abs(T-w)<1&&(n="nearest"),C&&Math.abs(C-O)<1&&(r="nearest")}if(y)break;f=f.assignedSlot||f.parentNode}else if(f.nodeType==11)f=f.host;else break}function lNe(s){let e=s.ownerDocument,i,n;for(let r=s.parentNode;r&&!(r==e.body||i&&n);)if(r.nodeType==1)!n&&r.scrollHeight>r.clientHeight&&(n=r),!i&&r.scrollWidth>r.clientWidth&&(i=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:i,y:n}}class cNe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:i,focusNode:n}=e;this.set(i,Math.min(e.anchorOffset,i?Ou(i):0),n,Math.min(e.focusOffset,n?Ou(n):0))}set(e,i,n,r){this.anchorNode=e,this.anchorOffset=i,this.focusNode=n,this.focusOffset=r}}let Lg=null;function jq(s){if(s.setActive)return s.setActive();if(Lg)return s.focus(Lg);let e=[];for(let i=s;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(s.focus(Lg==null?{get preventScroll(){return Lg={preventScroll:!0},!0}}:void 0),!Lg){Lg=!1;for(let i=0;i<e.length;){let n=e[i++],r=e[i++],o=e[i++];n.scrollTop!=r&&(n.scrollTop=r),n.scrollLeft!=o&&(n.scrollLeft=o)}}}let rX;function bm(s,e,i=e){let n=rX||(rX=document.createRange());return n.setEnd(s,i),n.setStart(s,e),n}function H0(s,e,i,n){let r={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=n);let o=new KeyboardEvent("keydown",r);o.synthetic=!0,s.dispatchEvent(o);let a=new KeyboardEvent("keyup",r);return a.synthetic=!0,s.dispatchEvent(a),o.defaultPrevented||a.defaultPrevented}function hNe(s){for(;s;){if(s&&(s.nodeType==9||s.nodeType==11&&s.host))return s;s=s.assignedSlot||s.parentNode}return null}function qq(s){for(;s.attributes.length;)s.removeAttributeNode(s.attributes[0])}function uNe(s,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,Ou(i));;)if(n){if(i.nodeType!=1)return!1;let r=i.childNodes[n-1];r.contentEditable=="false"?n--:(i=r,n=Ou(i))}else{if(i==s)return!0;n=_m(i),i=i.parentNode}}function Zq(s){return s.scrollTop>Math.max(1,s.scrollHeight-s.clientHeight-4)}function Kq(s,e){for(let i=s,n=e;;){if(i.nodeType==3&&n>0)return{node:i,offset:n};if(i.nodeType==1&&n>0){if(i.contentEditable=="false")return null;i=i.childNodes[n-1],n=Ou(i)}else if(i.parentNode&&!iT(i))n=_m(i),i=i.parentNode;else return null}}function Jq(s,e){for(let i=s,n=e;;){if(i.nodeType==3&&n<i.nodeValue.length)return{node:i,offset:n};if(i.nodeType==1&&n<i.childNodes.length){if(i.contentEditable=="false")return null;i=i.childNodes[n],n=0}else if(i.parentNode&&!iT(i))n=_m(i)+1,i=i.parentNode;else return null}}class Yr{constructor(e,i,n=!0){this.node=e,this.offset=i,this.precise=n}static before(e,i){return new Yr(e.parentNode,_m(e),i)}static after(e,i){return new Yr(e.parentNode,_m(e)+1,i)}}const _3=[];class Fn{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let i=this.posAtStart;for(let n of this.children){if(n==e)return i;i+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,i){if(this.flags&2){let n=this.dom,r=null,o;for(let a of this.children){if(a.flags&7){if(!a.dom&&(o=r?r.nextSibling:n.firstChild)){let l=Fn.get(o);(!l||!l.parent&&l.canReuseDOM(a))&&a.reuseDOM(o)}a.sync(e,i),a.flags&=-8}if(o=r?r.nextSibling:n.firstChild,i&&!i.written&&i.node==n&&o!=a.dom&&(i.written=!0),a.dom.parentNode==n)for(;o&&o!=a.dom;)o=oX(o);else n.insertBefore(a.dom,o);r=a.dom}for(o=r?r.nextSibling:n.firstChild,o&&i&&i.node==n&&(i.written=!0);o;)o=oX(o)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,i),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,i){let n;if(e==this.dom)n=this.dom.childNodes[i];else{let r=Ou(e)==0?0:i==0?-1:1;for(;;){let o=e.parentNode;if(o==this.dom)break;r==0&&o.firstChild!=o.lastChild&&(e==o.firstChild?r=-1:r=1),e=o}r<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!Fn.get(n);)n=n.nextSibling;if(!n)return this.length;for(let r=0,o=0;;r++){let a=this.children[r];if(a.dom==n)return o;o+=a.length+a.breakAfter}}domBoundsAround(e,i,n=0){let r=-1,o=-1,a=-1,l=-1;for(let h=0,d=n,f=n;h<this.children.length;h++){let p=this.children[h],g=d+p.length;if(d<e&&g>i)return p.domBoundsAround(e,i,d);if(g>=e&&r==-1&&(r=h,o=d),d>i&&p.dom.parentNode==this.dom){a=h,l=f;break}f=g,d=g+p.breakAfter}return{from:o,to:l<0?n+this.length:l,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:a<this.children.length&&a>=0?this.children[a].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let i=this.parent;i;i=i.parent){if(e&&(i.flags|=2),i.flags&1)return;i.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let i=e.parent;if(!i)return e;e=i}}replaceChildren(e,i,n=_3){this.markDirty();for(let r=e;r<i;r++){let o=this.children[r];o.parent==this&&n.indexOf(o)<0&&o.destroy()}this.children.splice(e,i-e,...n);for(let r=0;r<n.length;r++)n[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new eZ(this.children,e,this.children.length)}childPos(e,i=1){return this.childCursor().findPos(e,i)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,i,n,r,o,a){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}Fn.prototype.breakAfter=0;function oX(s){let e=s.nextSibling;return s.parentNode.removeChild(s),e}class eZ{constructor(e,i,n){this.children=e,this.pos=i,this.i=n,this.off=0}findPos(e,i=1){for(;;){if(e>this.pos||e==this.pos&&(i>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function tZ(s,e,i,n,r,o,a,l,h){let{children:d}=s,f=d.length?d[e]:null,p=o.length?o[o.length-1]:null,g=p?p.breakAfter:a;if(!(e==n&&f&&!a&&!g&&o.length<2&&f.merge(i,r,o.length?p:null,i==0,l,h))){if(n<d.length){let y=d[n];y&&(r<y.length||y.breakAfter&&(p!=null&&p.breakAfter))?(e==n&&(y=y.split(r),r=0),!g&&p&&y.merge(0,r,p,!0,0,h)?o[o.length-1]=y:((r||y.children.length&&!y.children[0].length)&&y.merge(0,r,null,!1,0,h),o.push(y))):y!=null&&y.breakAfter&&(p?p.breakAfter=1:a=1),n++}for(f&&(f.breakAfter=a,i>0&&(!a&&o.length&&f.merge(i,f.length,o[0],!1,l,0)?f.breakAfter=o.shift().breakAfter:(i<f.length||f.children.length&&f.children[f.children.length-1].length==0)&&f.merge(i,f.length,null,!1,l,0),e++));e<n&&o.length;)if(d[n-1].become(o[o.length-1]))n--,o.pop(),h=o.length?0:l;else if(d[e].become(o[0]))e++,o.shift(),l=o.length?0:h;else break;!o.length&&e&&n<d.length&&!d[e-1].breakAfter&&d[n].merge(0,0,d[e-1],!1,l,h)&&e--,(e<n||o.length)&&s.replaceChildren(e,n,o)}}function iZ(s,e,i,n,r,o){let a=s.childCursor(),{i:l,off:h}=a.findPos(i,1),{i:d,off:f}=a.findPos(e,-1),p=e-i;for(let g of n)p+=g.length;s.length+=p,tZ(s,d,f,l,h,n,0,r,o)}let zo=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},cR=typeof document<"u"?document:{documentElement:{style:{}}};const hR=/Edge\/(\d+)/.exec(zo.userAgent),nZ=/MSIE \d/.test(zo.userAgent),uR=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(zo.userAgent),eE=!!(nZ||uR||hR),aX=!eE&&/gecko\/(\d+)/i.test(zo.userAgent),VP=!eE&&/Chrome\/(\d+)/.exec(zo.userAgent),lX="webkitFontSmoothing"in cR.documentElement.style,sZ=!eE&&/Apple Computer/.test(zo.vendor),cX=sZ&&(/Mobile\/\w+/.test(zo.userAgent)||zo.maxTouchPoints>2);var Bt={mac:cX||/Mac/.test(zo.platform),windows:/Win/.test(zo.platform),linux:/Linux|X11/.test(zo.platform),ie:eE,ie_version:nZ?cR.documentMode||6:uR?+uR[1]:hR?+hR[1]:0,gecko:aX,gecko_version:aX?+(/Firefox\/(\d+)/.exec(zo.userAgent)||[0,0])[1]:0,chrome:!!VP,chrome_version:VP?+VP[1]:0,ios:cX,android:/Android\b/.test(zo.userAgent),webkit:lX,safari:sZ,webkit_version:lX?+(/\bAppleWebKit\/(\d+)/.exec(zo.userAgent)||[0,0])[1]:0,tabSize:cR.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const dNe=256;class rc extends Fn{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,i){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(i&&i.node==this.dom&&(i.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,i,n){return this.flags&8||n&&(!(n instanceof rc)||this.length-(i-e)+n.length>dNe||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(i),this.markDirty(),!0)}split(e){let i=new rc(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),i.flags|=this.flags&8,i}localPosFromDOM(e,i){return e==this.dom?i:i?this.text.length:0}domAtPos(e){return new Yr(this.dom,e)}domBoundsAround(e,i,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,i){return fNe(this.dom,e,i)}}class Su extends Fn{constructor(e,i=[],n=0){super(),this.mark=e,this.children=i,this.length=n;for(let r of i)r.setParent(this)}setAttrs(e){if(qq(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let i in this.mark.attrs)e.setAttribute(i,this.mark.attrs[i]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,i){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,i)}merge(e,i,n,r,o,a){return n&&(!(n instanceof Su&&n.mark.eq(this.mark))||e&&o<=0||i<this.length&&a<=0)?!1:(iZ(this,e,i,n?n.children.slice():[],o-1,a-1),this.markDirty(),!0)}split(e){let i=[],n=0,r=-1,o=0;for(let l of this.children){let h=n+l.length;h>e&&i.push(n<e?l.split(e-n):l),r<0&&n>=e&&(r=o),n=h,o++}let a=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new Su(this.mark,i,a)}domAtPos(e){return rZ(this,e)}coordsAt(e,i){return aZ(this,e,i)}}function fNe(s,e,i){let n=s.nodeValue.length;e>n&&(e=n);let r=e,o=e,a=0;e==0&&i<0||e==n&&i>=0?Bt.chrome||Bt.gecko||(e?(r--,a=1):o<n&&(o++,a=-1)):i<0?r--:o<n&&o++;let l=bm(s,r,o).getClientRects();if(!l.length)return null;let h=l[(a?a<0:i>=0)?0:l.length-1];return Bt.safari&&!a&&h.width==0&&(h=Array.prototype.find.call(l,d=>d.width)||h),a?JA(h,a<0):h||null}class Xd extends Fn{static create(e,i,n){return new Xd(e,i,n)}constructor(e,i,n){super(),this.widget=e,this.length=i,this.side=n,this.prevWidget=null}split(e){let i=Xd.create(this.widget,this.length-e,this.side);return this.length-=e,i}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,i,n,r,o,a){return n&&(!(n instanceof Xd)||!this.widget.compare(n.widget)||e>0&&o<=0||i<this.length&&a<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-i),!0)}become(e){return e instanceof Xd&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return yn.empty;let e=this;for(;e.parent;)e=e.parent;let{view:i}=e,n=i&&i.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):yn.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Yr.before(this.dom):Yr.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,i){let n=this.widget.coordsAt(this.dom,e,i);if(n)return n;let r=this.dom.getClientRects(),o=null;if(!r.length)return null;let a=this.side?this.side<0:e>0;for(let l=a?r.length-1:0;o=r[l],!(e>0?l==0:l==r.length-1||o.top<o.bottom);l+=a?-1:1);return JA(o,!a)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class yy extends Fn{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof yy&&e.side==this.side}split(){return new yy(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Yr.before(this.dom):Yr.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return yn.empty}get isHidden(){return!0}}rc.prototype.children=Xd.prototype.children=yy.prototype.children=_3;function rZ(s,e){let i=s.dom,{children:n}=s,r=0;for(let o=0;r<n.length;r++){let a=n[r],l=o+a.length;if(!(l==o&&a.getSide()<=0)){if(e>o&&e<l&&a.dom.parentNode==i)return a.domAtPos(e-o);if(e<=o)break;o=l}}for(let o=r;o>0;o--){let a=n[o-1];if(a.dom.parentNode==i)return a.domAtPos(a.length)}for(let o=r;o<n.length;o++){let a=n[o];if(a.dom.parentNode==i)return a.domAtPos(0)}return new Yr(i,0)}function oZ(s,e,i){let n,{children:r}=s;i>0&&e instanceof Su&&r.length&&(n=r[r.length-1])instanceof Su&&n.mark.eq(e.mark)?oZ(n,e.children[0],i-1):(r.push(e),e.setParent(s)),s.length+=e.length}function aZ(s,e,i){let n=null,r=-1,o=null,a=-1;function l(d,f){for(let p=0,g=0;p<d.children.length&&g<=f;p++){let y=d.children[p],x=g+y.length;x>=f&&(y.children.length?l(y,f-g):(!o||o.isHidden&&i>0)&&(x>f||g==x&&y.getSide()>0)?(o=y,a=f-g):(g<f||g==x&&y.getSide()<0&&!y.isHidden)&&(n=y,r=f-g)),g=x}}l(s,e);let h=(i<0?n:o)||n||o;return h?h.coordsAt(Math.max(0,h==n?r:a),i):pNe(s)}function pNe(s){let e=s.dom.lastChild;if(!e)return s.dom.getBoundingClientRect();let i=Y_(e);return i[i.length-1]||null}function dR(s,e){for(let i in s)i=="class"&&e.class?e.class+=" "+s.class:i=="style"&&e.style?e.style+=";"+s.style:e[i]=s[i];return e}const hX=Object.create(null);function nT(s,e,i){if(s==e)return!0;s||(s=hX),e||(e=hX);let n=Object.keys(s),r=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=r.length-(i&&r.indexOf(i)>-1?1:0))return!1;for(let o of n)if(o!=i&&(r.indexOf(o)==-1||s[o]!==e[o]))return!1;return!0}function fR(s,e,i){let n=!1;if(e)for(let r in e)i&&r in i||(n=!0,r=="style"?s.style.cssText="":s.removeAttribute(r));if(i)for(let r in i)e&&e[r]==i[r]||(n=!0,r=="style"?s.style.cssText=i[r]:s.setAttribute(r,i[r]));return n}function mNe(s){let e=Object.create(null);for(let i=0;i<s.attributes.length;i++){let n=s.attributes[i];e[n.name]=n.value}return e}class Of{eq(e){return!1}updateDOM(e,i){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,i,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var So=function(s){return s[s.Text=0]="Text",s[s.WidgetBefore=1]="WidgetBefore",s[s.WidgetAfter=2]="WidgetAfter",s[s.WidgetRange=3]="WidgetRange",s}(So||(So={}));class fi extends xm{constructor(e,i,n,r){super(),this.startSide=e,this.endSide=i,this.widget=n,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Ub(e)}static widget(e){let i=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return i+=n&&!e.inlineOrder?i>0?3e8:-4e8:i>0?1e8:-1e8,new lf(e,i,i,n,e.widget||null,!1)}static replace(e){let i=!!e.block,n,r;if(e.isBlockGap)n=-5e8,r=4e8;else{let{start:o,end:a}=lZ(e,i);n=(o?i?-3e8:-1:5e8)-1,r=(a?i?2e8:1:-6e8)+1}return new lf(e,n,r,i,e.widget||null,!0)}static line(e){return new Fb(e)}static set(e,i=!1){return fn.of(e,i)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}fi.none=fn.empty;class Ub extends fi{constructor(e){let{start:i,end:n}=lZ(e);super(i?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var i,n;return this==e||e instanceof Ub&&this.tagName==e.tagName&&(this.class||((i=this.attrs)===null||i===void 0?void 0:i.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&nT(this.attrs,e.attrs,"class")}range(e,i=e){if(e>=i)throw new RangeError("Mark decorations may not be empty");return super.range(e,i)}}Ub.prototype.point=!1;class Fb extends fi{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Fb&&this.spec.class==e.spec.class&&nT(this.spec.attributes,e.spec.attributes)}range(e,i=e){if(i!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,i)}}Fb.prototype.mapMode=_o.TrackBefore;Fb.prototype.point=!0;class lf extends fi{constructor(e,i,n,r,o,a){super(i,n,o,e),this.block=r,this.isReplace=a,this.mapMode=r?i<=0?_o.TrackBefore:_o.TrackAfter:_o.TrackDel}get type(){return this.startSide!=this.endSide?So.WidgetRange:this.startSide<=0?So.WidgetBefore:So.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof lf&&gNe(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,i=e){if(this.isReplace&&(e>i||e==i&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&i!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,i)}}lf.prototype.point=!0;function lZ(s,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=s;return i==null&&(i=s.inclusive),n==null&&(n=s.inclusive),{start:i??e,end:n??e}}function gNe(s,e){return s==e||!!(s&&e&&s.compare(e))}function pR(s,e,i,n=0){let r=i.length-1;r>=0&&i[r]+n>=s?i[r]=Math.max(i[r],e):i.push(s,e)}class Ws extends Fn{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,i,n,r,o,a){if(n){if(!(n instanceof Ws))return!1;this.dom||n.transferDOM(this)}return r&&this.setDeco(n?n.attrs:null),iZ(this,e,i,n?n.children.slice():[],o,a),!0}split(e){let i=new Ws;if(i.breakAfter=this.breakAfter,this.length==0)return i;let{i:n,off:r}=this.childPos(e);r&&(i.append(this.children[n].split(r),0),this.children[n].merge(r,this.children[n].length,null,!1,0,0),n++);for(let o=n;o<this.children.length;o++)i.append(this.children[o],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,i}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){nT(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,i){oZ(this,e,i)}addLineDeco(e){let i=e.spec.attributes,n=e.spec.class;i&&(this.attrs=dR(i,this.attrs||{})),n&&(this.attrs=dR({class:n},this.attrs||{}))}domAtPos(e){return rZ(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,i){var n;this.dom?this.flags&4&&(qq(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(fR(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,i);let r=this.dom.lastChild;for(;r&&Fn.get(r)instanceof Su;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((n=Fn.get(r))===null||n===void 0?void 0:n.isEditable)==!1&&(!Bt.ios||!this.children.some(o=>o instanceof rc))){let o=document.createElement("BR");o.cmIgnore=!0,this.dom.appendChild(o)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,i;for(let n of this.children){if(!(n instanceof rc)||/[^ -~]/.test(n.text))return null;let r=Y_(n.dom);if(r.length!=1)return null;e+=r[0].width,i=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:i}:null}coordsAt(e,i){let n=aZ(this,e,i);if(!this.children.length&&n&&this.parent){let{heightOracle:r}=this.parent.view.viewState,o=n.bottom-n.top;if(Math.abs(o-r.lineHeight)<2&&r.textHeight<o){let a=(o-r.textHeight)/2;return{top:n.top+a,bottom:n.bottom-a,left:n.left,right:n.left}}}return n}become(e){return e instanceof Ws&&this.children.length==0&&e.children.length==0&&nT(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,i){for(let n=0,r=0;n<e.children.length;n++){let o=e.children[n],a=r+o.length;if(a>=i){if(o instanceof Ws)return o;if(a>i)break}r=a+o.breakAfter}return null}}class uu extends Fn{constructor(e,i,n){super(),this.widget=e,this.length=i,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,i,n,r,o,a){return n&&(!(n instanceof uu)||!this.widget.compare(n.widget)||e>0&&o<=0||i<this.length&&a<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-i),!0)}domAtPos(e){return e==0?Yr.before(this.dom):Yr.after(this.dom,e==this.length)}split(e){let i=this.length-e;this.length=e;let n=new uu(this.widget,i,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return _3}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):yn.empty}domBoundsAround(){return null}become(e){return e instanceof uu&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,i){let n=this.widget.coordsAt(this.dom,e,i);return n||(this.widget instanceof mR?null:JA(this.dom.getBoundingClientRect(),this.length?e==0:i<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:i,endSide:n}=this.deco;return i==n?!1:e<0?i<0:n>0}}class mR extends Of{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class t_{constructor(e,i,n,r){this.doc=e,this.pos=i,this.end=n,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=i}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof uu&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ws),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(TO(new yy(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof uu)&&this.getLine()}buildText(e,i,n){for(;e>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:a,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=o,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(i.slice(i.length-n)),this.getLine().append(TO(new rc(this.text.slice(this.textOff,this.textOff+r)),i),n),this.atCursorPos=!0,this.textOff+=r,e-=r,n=0}}span(e,i,n,r){this.buildText(i-e,n,r),this.pos=i,this.openStart<0&&(this.openStart=r)}point(e,i,n,r,o,a){if(this.disallowBlockEffectsFor[a]&&n instanceof lf){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(i>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=i-e;if(n instanceof lf)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new uu(n.widget||vy.block,l,n));else{let h=Xd.create(n.widget||vy.inline,l,l?0:n.startSide),d=this.atCursorPos&&!h.isEditable&&o<=r.length&&(e<i||n.startSide>0),f=!h.isEditable&&(e<i||o>r.length||n.startSide<=0),p=this.getLine();this.pendingBuffer==2&&!d&&!h.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),d&&(p.append(TO(new yy(1),r),o),o=r.length+Math.max(0,o-r.length)),p.append(TO(h,r),o),this.atCursorPos=f,this.pendingBuffer=f?e<i||o>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=i),this.openStart<0&&(this.openStart=o)}static build(e,i,n,r,o){let a=new t_(e,i,n,o);return a.openEnd=fn.spans(r,i,n,a),a.openStart<0&&(a.openStart=a.openEnd),a.finish(a.openEnd),a}}function TO(s,e){for(let i of e)s=new Su(i,[s],s.length);return s}class vy extends Of{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}vy.inline=new vy("span");vy.block=new vy("div");var Jn=function(s){return s[s.LTR=0]="LTR",s[s.RTL=1]="RTL",s}(Jn||(Jn={}));const wm=Jn.LTR,b3=Jn.RTL;function cZ(s){let e=[];for(let i=0;i<s.length;i++)e.push(1<<+s[i]);return e}const yNe=cZ("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),vNe=cZ("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),gR=Object.create(null),bc=[];for(let s of["()","[]","{}"]){let e=s.charCodeAt(0),i=s.charCodeAt(1);gR[e]=i,gR[i]=-e}function hZ(s){return s<=247?yNe[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?vNe[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8204?256:64336<=s&&s<=65023?4:1}const xNe=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Wd{get dir(){return this.level%2?b3:wm}constructor(e,i,n){this.from=e,this.to=i,this.level=n}side(e,i){return this.dir==i==e?this.to:this.from}forward(e,i){return e==(this.dir==i)}static find(e,i,n,r){let o=-1;for(let a=0;a<e.length;a++){let l=e[a];if(l.from<=i&&l.to>=i){if(l.level==n)return a;(o<0||(r!=0?r<0?l.from<i:l.to>i:e[o].level>l.level))&&(o=a)}}if(o<0)throw new RangeError("Index out of range");return o}}function uZ(s,e){if(s.length!=e.length)return!1;for(let i=0;i<s.length;i++){let n=s[i],r=e[i];if(n.from!=r.from||n.to!=r.to||n.direction!=r.direction||!uZ(n.inner,r.inner))return!1}return!0}const $n=[];function _Ne(s,e,i,n,r){for(let o=0;o<=n.length;o++){let a=o?n[o-1].to:e,l=o<n.length?n[o].from:i,h=o?256:r;for(let d=a,f=h,p=h;d<l;d++){let g=hZ(s.charCodeAt(d));g==512?g=f:g==8&&p==4&&(g=16),$n[d]=g==4?2:g,g&7&&(p=g),f=g}for(let d=a,f=h,p=h;d<l;d++){let g=$n[d];if(g==128)d<l-1&&f==$n[d+1]&&f&24?g=$n[d]=f:$n[d]=256;else if(g==64){let y=d+1;for(;y<l&&$n[y]==64;)y++;let x=d&&f==8||y<i&&$n[y]==8?p==1?1:8:256;for(let _=d;_<y;_++)$n[_]=x;d=y-1}else g==8&&p==1&&($n[d]=1);f=g,g&7&&(p=g)}}}function bNe(s,e,i,n,r){let o=r==1?2:1;for(let a=0,l=0,h=0;a<=n.length;a++){let d=a?n[a-1].to:e,f=a<n.length?n[a].from:i;for(let p=d,g,y,x;p<f;p++)if(y=gR[g=s.charCodeAt(p)])if(y<0){for(let _=l-3;_>=0;_-=3)if(bc[_+1]==-y){let w=bc[_+2],O=w&2?r:w&4?w&1?o:r:0;O&&($n[p]=$n[bc[_]]=O),l=_;break}}else{if(bc.length==189)break;bc[l++]=p,bc[l++]=g,bc[l++]=h}else if((x=$n[p])==2||x==1){let _=x==r;h=_?0:1;for(let w=l-3;w>=0;w-=3){let O=bc[w+2];if(O&2)break;if(_)bc[w+2]|=2;else{if(O&4)break;bc[w+2]|=4}}}}}function wNe(s,e,i,n){for(let r=0,o=n;r<=i.length;r++){let a=r?i[r-1].to:s,l=r<i.length?i[r].from:e;for(let h=a;h<l;){let d=$n[h];if(d==256){let f=h+1;for(;;)if(f==l){if(r==i.length)break;f=i[r++].to,l=r<i.length?i[r].from:e}else if($n[f]==256)f++;else break;let p=o==1,g=(f<e?$n[f]:n)==1,y=p==g?p?1:2:n;for(let x=f,_=r,w=_?i[_-1].to:s;x>h;)x==w&&(x=i[--_].from,w=_?i[_-1].to:s),$n[--x]=y;h=f}else o=d,h++}}}function yR(s,e,i,n,r,o,a){let l=n%2?2:1;if(n%2==r%2)for(let h=e,d=0;h<i;){let f=!0,p=!1;if(d==o.length||h<o[d].from){let _=$n[h];_!=l&&(f=!1,p=_==16)}let g=!f&&l==1?[]:null,y=f?n:n+1,x=h;e:for(;;)if(d<o.length&&x==o[d].from){if(p)break e;let _=o[d];if(!f)for(let w=_.to,O=d+1;;){if(w==i)break e;if(O<o.length&&o[O].from==w)w=o[O++].to;else{if($n[w]==l)break e;break}}if(d++,g)g.push(_);else{_.from>h&&a.push(new Wd(h,_.from,y));let w=_.direction==wm!=!(y%2);vR(s,w?n+1:n,r,_.inner,_.from,_.to,a),h=_.to}x=_.to}else{if(x==i||(f?$n[x]!=l:$n[x]==l))break;x++}g?yR(s,h,x,n+1,r,g,a):h<x&&a.push(new Wd(h,x,y)),h=x}else for(let h=i,d=o.length;h>e;){let f=!0,p=!1;if(!d||h>o[d-1].to){let _=$n[h-1];_!=l&&(f=!1,p=_==16)}let g=!f&&l==1?[]:null,y=f?n:n+1,x=h;e:for(;;)if(d&&x==o[d-1].to){if(p)break e;let _=o[--d];if(!f)for(let w=_.from,O=d;;){if(w==e)break e;if(O&&o[O-1].to==w)w=o[--O].from;else{if($n[w-1]==l)break e;break}}if(g)g.push(_);else{_.to<h&&a.push(new Wd(_.to,h,y));let w=_.direction==wm!=!(y%2);vR(s,w?n+1:n,r,_.inner,_.from,_.to,a),h=_.from}x=_.from}else{if(x==e||(f?$n[x-1]!=l:$n[x-1]==l))break;x--}g?yR(s,x,h,n+1,r,g,a):x<h&&a.push(new Wd(x,h,y)),h=x}}function vR(s,e,i,n,r,o,a){let l=e%2?2:1;_Ne(s,r,o,n,l),bNe(s,r,o,n,l),wNe(r,o,n,l),yR(s,r,o,e,i,n,a)}function ONe(s,e,i){if(!s)return[new Wd(0,0,e==b3?1:0)];if(e==wm&&!i.length&&!xNe.test(s))return dZ(s.length);if(i.length)for(;s.length>$n.length;)$n[$n.length]=256;let n=[],r=e==wm?0:1;return vR(s,r,r,i,0,s.length,n),n}function dZ(s){return[new Wd(0,s,0)]}let fZ="";function SNe(s,e,i,n,r){var o;let a=n.head-s.from,l=Wd.find(e,a,(o=n.bidiLevel)!==null&&o!==void 0?o:-1,n.assoc),h=e[l],d=h.side(r,i);if(a==d){let g=l+=r?1:-1;if(g<0||g>=e.length)return null;h=e[l=g],a=h.side(!r,i),d=h.side(r,i)}let f=Lr(s.text,a,h.forward(r,i));(f<h.from||f>h.to)&&(f=d),fZ=s.text.slice(Math.min(a,f),Math.max(a,f));let p=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return p&&f==d&&p.level+(r?0:1)<h.level?et.cursor(p.side(!r,i)+s.from,p.forward(r,i)?1:-1,p.level):et.cursor(f+s.from,h.forward(r,i)?-1:1,h.level)}function CNe(s,e,i){for(let n=e;n<i;n++){let r=hZ(s.charCodeAt(n));if(r==1)return wm;if(r==2||r==4)return b3}return wm}const pZ=Pt.define(),mZ=Pt.define(),gZ=Pt.define(),yZ=Pt.define(),xR=Pt.define(),vZ=Pt.define(),xZ=Pt.define(),w3=Pt.define(),O3=Pt.define(),_Z=Pt.define({combine:s=>s.some(e=>e)}),bZ=Pt.define({combine:s=>s.some(e=>e)}),wZ=Pt.define();class G0{constructor(e,i="nearest",n="nearest",r=5,o=5,a=!1){this.range=e,this.y=i,this.x=n,this.yMargin=r,this.xMargin=o,this.isSnapshot=a}map(e){return e.empty?this:new G0(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new G0(et.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const AO=Fi.define({map:(s,e)=>s.map(e)}),OZ=Fi.define();function Ko(s,e,i){let n=s.facet(yZ);n.length?n[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const Dd=Pt.define({combine:s=>s.length?s[0]:!0});let TNe=0;const Px=Pt.define();class js{constructor(e,i,n,r,o){this.id=e,this.create=i,this.domEventHandlers=n,this.domEventObservers=r,this.extension=o(this)}static define(e,i){const{eventHandlers:n,eventObservers:r,provide:o,decorations:a}=i||{};return new js(TNe++,e,n,r,l=>{let h=[Px.of(l)];return a&&h.push(j_.of(d=>{let f=d.plugin(l);return f?a(f):fi.none})),o&&h.push(o(l)),h})}static fromClass(e,i){return js.define(n=>new e(n),i)}}class $P{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let i=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(i)}catch(n){if(Ko(i.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(i){Ko(e.state,i,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var i;if(!((i=this.value)===null||i===void 0)&&i.destroy)try{this.value.destroy()}catch(n){Ko(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const SZ=Pt.define(),S3=Pt.define(),j_=Pt.define(),CZ=Pt.define(),C3=Pt.define(),TZ=Pt.define();function uX(s,e){let i=s.state.facet(TZ);if(!i.length)return i;let n=i.map(o=>o instanceof Function?o(s):o),r=[];return fn.spans(n,e.from,e.to,{point(){},span(o,a,l,h){let d=o-e.from,f=a-e.from,p=r;for(let g=l.length-1;g>=0;g--,h--){let y=l[g].spec.bidiIsolate,x;if(y==null&&(y=CNe(e.text,d,f)),h>0&&p.length&&(x=p[p.length-1]).to==d&&x.direction==y)x.to=f,p=x.inner;else{let _={from:d,to:f,direction:y,inner:[]};p.push(_),p=_.inner}}}}),r}const AZ=Pt.define();function EZ(s){let e=0,i=0,n=0,r=0;for(let o of s.state.facet(AZ)){let a=o(s);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(i=Math.max(i,a.right)),a.top!=null&&(n=Math.max(n,a.top)),a.bottom!=null&&(r=Math.max(r,a.bottom)))}return{left:e,right:i,top:n,bottom:r}}const Ix=Pt.define();class ml{constructor(e,i,n,r){this.fromA=e,this.toA=i,this.fromB=n,this.toB=r}join(e){return new ml(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let i=e.length,n=this;for(;i>0;i--){let r=e[i-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(i-1,1)}}return e.splice(i,0,n),e}static extendWithRanges(e,i){if(i.length==0)return e;let n=[];for(let r=0,o=0,a=0,l=0;;r++){let h=r==e.length?null:e[r],d=a-l,f=h?h.fromB:1e9;for(;o<i.length&&i[o]<f;){let p=i[o],g=i[o+1],y=Math.max(l,p),x=Math.min(f,g);if(y<=x&&new ml(y+d,x+d,y,x).addToSet(n),g>f)break;o+=2}if(!h)return n;new ml(h.fromA,h.toA,h.fromB,h.toB).addToSet(n),a=h.toA,l=h.toB}}}class sT{constructor(e,i,n){this.view=e,this.state=i,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=sr.empty(this.startState.doc.length);for(let o of n)this.changes=this.changes.compose(o.changes);let r=[];this.changes.iterChangedRanges((o,a,l,h)=>r.push(new ml(o,a,l,h))),this.changedRanges=r}static create(e,i,n){return new sT(e,i,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class dX extends Fn{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=fi.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Ws],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ml(0,0,0,e.state.doc.length)],0,null)}update(e){var i;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:d,toA:f})=>f<this.minWidthFrom||d>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((i=this.domChanged)===null||i===void 0)&&i.newSel?r=this.domChanged.newSel.head:!BNe(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let o=r>-1?ENe(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:d,to:f}=this.hasComposition;n=new ml(d,f,e.changes.mapPos(d,-1),e.changes.mapPos(f,1)).addToSet(n.slice())}this.hasComposition=o?{from:o.range.fromB,to:o.range.toB}:null,(Bt.ie||Bt.chrome)&&!o&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,l=this.updateDeco(),h=PNe(a,l,e.changes);return n=ml.extendWithRanges(n,h),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,o),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,i,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,i,n);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let a=Bt.chrome||Bt.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,a),this.flags&=-8,a&&(a.written||r.selectionRange.focusNode!=a.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(a=>a.flags&=-9);let o=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let a of this.children)a instanceof uu&&a.widget instanceof mR&&o.push(a.dom);r.updateGaps(o)}updateChildren(e,i,n){let r=n?n.range.addToSet(e.slice()):e,o=this.childCursor(i);for(let a=r.length-1;;a--){let l=a>=0?r[a]:null;if(!l)break;let{fromA:h,toA:d,fromB:f,toB:p}=l,g,y,x,_;if(n&&n.range.fromB<p&&n.range.toB>f){let A=t_.build(this.view.state.doc,f,n.range.fromB,this.decorations,this.dynamicDecorationMap),B=t_.build(this.view.state.doc,n.range.toB,p,this.decorations,this.dynamicDecorationMap);y=A.breakAtStart,x=A.openStart,_=B.openEnd;let I=this.compositionView(n);B.breakAtStart?I.breakAfter=1:B.content.length&&I.merge(I.length,I.length,B.content[0],!1,B.openStart,0)&&(I.breakAfter=B.content[0].breakAfter,B.content.shift()),A.content.length&&I.merge(0,0,A.content[A.content.length-1],!0,0,A.openEnd)&&A.content.pop(),g=A.content.concat(I).concat(B.content)}else({content:g,breakAtStart:y,openStart:x,openEnd:_}=t_.build(this.view.state.doc,f,p,this.decorations,this.dynamicDecorationMap));let{i:w,off:O}=o.findPos(d,1),{i:T,off:C}=o.findPos(h,-1);tZ(this,T,C,w,O,g,y,x,_)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let i of e.transactions)for(let n of i.effects)n.is(OZ)&&(this.editContextFormatting=n.value)}compositionView(e){let i=new rc(e.text.nodeValue);i.flags|=8;for(let{deco:r}of e.marks)i=new Su(r,[i],i.length);let n=new Ws;return n.append(i,0),n}fixCompositionDOM(e){let i=(o,a)=>{a.flags|=8|(a.children.some(h=>h.flags&7)?1:0),this.markedForComposition.add(a);let l=Fn.get(o);l&&l!=a&&(l.dom=null),a.setDOM(o)},n=this.childPos(e.range.fromB,1),r=this.children[n.i];i(e.line,r);for(let o=e.marks.length-1;o>=-1;o--)n=r.childPos(n.off,1),r=r.children[n.i],i(o>=0?e.marks[o].node:e.text,r)}updateSelection(e=!1,i=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,r=n==this.dom,o=!r&&eC(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(r||i||o))return;let a=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,h=this.moveToLine(this.domAtPos(l.anchor)),d=l.empty?h:this.moveToLine(this.domAtPos(l.head));if(Bt.gecko&&l.empty&&!this.hasComposition&&ANe(h)){let p=document.createTextNode("");this.view.observer.ignore(()=>h.node.insertBefore(p,h.node.childNodes[h.offset]||null)),h=d=new Yr(p,0),a=!0}let f=this.view.observer.selectionRange;(a||!f.focusNode||(!e_(h.node,h.offset,f.anchorNode,f.anchorOffset)||!e_(d.node,d.offset,f.focusNode,f.focusOffset))&&!this.suppressWidgetCursorChange(f,l))&&(this.view.observer.ignore(()=>{Bt.android&&Bt.chrome&&this.dom.contains(f.focusNode)&&INe(f.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let p=Q_(this.view.root);if(p)if(l.empty){if(Bt.gecko){let g=MNe(h.node,h.offset);if(g&&g!=3){let y=(g==1?Kq:Jq)(h.node,h.offset);y&&(h=new Yr(y.node,y.offset))}}p.collapse(h.node,h.offset),l.bidiLevel!=null&&p.caretBidiLevel!==void 0&&(p.caretBidiLevel=l.bidiLevel)}else if(p.extend){p.collapse(h.node,h.offset);try{p.extend(d.node,d.offset)}catch{}}else{let g=document.createRange();l.anchor>l.head&&([h,d]=[d,h]),g.setEnd(d.node,d.offset),g.setStart(h.node,h.offset),p.removeAllRanges(),p.addRange(g)}o&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(h,d)),this.impreciseAnchor=h.precise?null:new Yr(f.anchorNode,f.anchorOffset),this.impreciseHead=d.precise?null:new Yr(f.focusNode,f.focusOffset)}suppressWidgetCursorChange(e,i){return this.hasComposition&&i.empty&&e_(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==i.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,i=e.state.selection.main,n=Q_(e.root),{anchorNode:r,anchorOffset:o}=e.observer.selectionRange;if(!n||!i.empty||!i.assoc||!n.modify)return;let a=Ws.find(this,i.head);if(!a)return;let l=a.posAtStart;if(i.head==l||i.head==l+a.length)return;let h=this.coordsAt(i.head,-1),d=this.coordsAt(i.head,1);if(!h||!d||h.bottom>d.top)return;let f=this.domAtPos(i.head+i.assoc);n.collapse(f.node,f.offset),n.modify("move",i.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let p=e.observer.selectionRange;e.docView.posFromDOM(p.anchorNode,p.anchorOffset)!=i.from&&n.collapse(r,o)}moveToLine(e){let i=this.dom,n;if(e.node!=i)return e;for(let r=e.offset;!n&&r<i.childNodes.length;r++){let o=Fn.get(i.childNodes[r]);o instanceof Ws&&(n=o.domAtPos(0))}for(let r=e.offset-1;!n&&r>=0;r--){let o=Fn.get(i.childNodes[r]);o instanceof Ws&&(n=o.domAtPos(o.length))}return n?new Yr(n.node,n.offset,!0):e}nearest(e){for(let i=e;i;){let n=Fn.get(i);if(n&&n.rootView==this)return n;i=i.parentNode}return null}posFromDOM(e,i){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,i)+n.posAtStart}domAtPos(e){let{i,off:n}=this.childCursor().findPos(e,-1);for(;i<this.children.length-1;){let r=this.children[i];if(n<r.length||r instanceof Ws)break;i++,n=0}return this.children[i].domAtPos(n)}coordsAt(e,i){let n=null,r=0;for(let o=this.length,a=this.children.length-1;a>=0;a--){let l=this.children[a],h=o-l.breakAfter,d=h-l.length;if(h<e)break;if(d<=e&&(d<e||l.covers(-1))&&(h>e||l.covers(1))&&(!n||l instanceof Ws&&!(n instanceof Ws&&i>=0)))n=l,r=d;else if(n&&d==e&&h==e&&l instanceof uu&&Math.abs(i)<2){if(l.deco.startSide<0)break;a&&(n=null)}o=d}return n?n.coordsAt(e-r,i):null}coordsForChar(e){let{i,off:n}=this.childPos(e,1),r=this.children[i];if(!(r instanceof Ws))return null;for(;r.children.length;){let{i:l,off:h}=r.childPos(n,1);for(;;l++){if(l==r.children.length)return null;if((r=r.children[l]).length)break}n=h}if(!(r instanceof rc))return null;let o=Lr(r.text,n);if(o==n)return null;let a=bm(r.dom,n,o).getClientRects();for(let l=0;l<a.length;l++){let h=a[l];if(l==a.length-1||h.top<h.bottom&&h.left<h.right)return h}return null}measureVisibleLineHeights(e){let i=[],{from:n,to:r}=e,o=this.view.contentDOM.clientWidth,a=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,h=this.view.textDirection==Jn.LTR;for(let d=0,f=0;f<this.children.length;f++){let p=this.children[f],g=d+p.length;if(g>r)break;if(d>=n){let y=p.dom.getBoundingClientRect();if(i.push(y.height),a){let x=p.dom.lastChild,_=x?Y_(x):[];if(_.length){let w=_[_.length-1],O=h?w.right-y.left:y.right-w.left;O>l&&(l=O,this.minWidth=o,this.minWidthFrom=d,this.minWidthTo=g)}}}d=g+p.breakAfter}return i}textDirectionAt(e){let{i}=this.childPos(e,1);return getComputedStyle(this.children[i].dom).direction=="rtl"?Jn.RTL:Jn.LTR}measureTextSize(){for(let o of this.children)if(o instanceof Ws){let a=o.measureTextSize();if(a)return a}let e=document.createElement("div"),i,n,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let o=Y_(e.firstChild)[0];i=e.getBoundingClientRect().height,n=o?o.width/27:7,r=o?o.height:i,e.remove()}),{lineHeight:i,charWidth:n,textHeight:r}}childCursor(e=this.length){let i=this.children.length;return i&&(e-=this.children[--i].length),new eZ(this.children,e,i)}computeBlockGapDeco(){let e=[],i=this.view.viewState;for(let n=0,r=0;;r++){let o=r==i.viewports.length?null:i.viewports[r],a=o?o.from-1:this.length;if(a>n){let l=(i.lineBlockAt(a).bottom-i.lineBlockAt(n).top)/this.view.scaleY;e.push(fi.replace({widget:new mR(l),block:!0,inclusive:!0,isBlockGap:!0}).range(n,a))}if(!o)break;n=o.to+1}return fi.set(e)}updateDeco(){let e=1,i=this.view.state.facet(j_).map(o=>(this.dynamicDecorationMap[e++]=typeof o=="function")?o(this.view):o),n=!1,r=this.view.state.facet(CZ).map((o,a)=>{let l=typeof o=="function";return l&&(n=!0),l?o(this.view):o});for(r.length&&(this.dynamicDecorationMap[e++]=n,i.push(fn.join(r))),this.decorations=[this.editContextFormatting,...i,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let d=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=d.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let d of this.view.state.facet(wZ))try{if(d(this.view,e.range,e))return!0}catch(f){Ko(this.view.state,f,"scroll handler")}let{range:i}=e,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1),r;if(!n)return;!i.empty&&(r=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top),right:Math.max(n.right,r.right),bottom:Math.max(n.bottom,r.bottom)});let o=EZ(this.view),a={left:n.left-o.left,top:n.top-o.top,right:n.right+o.right,bottom:n.bottom+o.bottom},{offsetWidth:l,offsetHeight:h}=this.view.scrollDOM;aNe(this.view.scrollDOM,a,i.head<i.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,h),-h),this.view.textDirection==Jn.LTR)}}function ANe(s){return s.node.nodeType==1&&s.node.firstChild&&(s.offset==0||s.node.childNodes[s.offset-1].contentEditable=="false")&&(s.offset==s.node.childNodes.length||s.node.childNodes[s.offset].contentEditable=="false")}function MZ(s,e){let i=s.observer.selectionRange;if(!i.focusNode)return null;let n=Kq(i.focusNode,i.focusOffset),r=Jq(i.focusNode,i.focusOffset),o=n||r;if(r&&n&&r.node!=n.node){let l=Fn.get(r.node);if(!l||l instanceof rc&&l.text!=r.node.nodeValue)o=r;else if(s.docView.lastCompositionAfterCursor){let h=Fn.get(n.node);!h||h instanceof rc&&h.text!=n.node.nodeValue||(o=r)}}if(s.docView.lastCompositionAfterCursor=o!=n,!o)return null;let a=e-o.offset;return{from:a,to:a+o.node.nodeValue.length,node:o.node}}function ENe(s,e,i){let n=MZ(s,i);if(!n)return null;let{node:r,from:o,to:a}=n,l=r.nodeValue;if(/[\n\r]/.test(l)||s.state.doc.sliceString(n.from,n.to)!=l)return null;let h=e.invertedDesc,d=new ml(h.mapPos(o),h.mapPos(a),o,a),f=[];for(let p=r.parentNode;;p=p.parentNode){let g=Fn.get(p);if(g instanceof Su)f.push({node:p,deco:g.mark});else{if(g instanceof Ws||p.nodeName=="DIV"&&p.parentNode==s.contentDOM)return{range:d,text:r,marks:f,line:p};if(p!=s.contentDOM)f.push({node:p,deco:new Ub({inclusive:!0,attributes:mNe(p),tagName:p.tagName.toLowerCase()})});else return null}}}function MNe(s,e){return s.nodeType!=1?0:(e&&s.childNodes[e-1].contentEditable=="false"?1:0)|(e<s.childNodes.length&&s.childNodes[e].contentEditable=="false"?2:0)}let kNe=class{constructor(){this.changes=[]}compareRange(e,i){pR(e,i,this.changes)}comparePoint(e,i){pR(e,i,this.changes)}};function PNe(s,e,i){let n=new kNe;return fn.compare(s,e,i,n),n.changes}function INe(s,e){for(let i=s;i&&i!=e;i=i.assignedSlot||i.parentNode)if(i.nodeType==1&&i.contentEditable=="false")return!0;return!1}function BNe(s,e){let i=!1;return e&&s.iterChangedRanges((n,r)=>{n<e.to&&r>e.from&&(i=!0)}),i}function RNe(s,e,i=1){let n=s.charCategorizer(e),r=s.doc.lineAt(e),o=e-r.from;if(r.length==0)return et.cursor(e);o==0?i=1:o==r.length&&(i=-1);let a=o,l=o;i<0?a=Lr(r.text,o,!1):l=Lr(r.text,o);let h=n(r.text.slice(a,l));for(;a>0;){let d=Lr(r.text,a,!1);if(n(r.text.slice(d,a))!=h)break;a=d}for(;l<r.length;){let d=Lr(r.text,l);if(n(r.text.slice(l,d))!=h)break;l=d}return et.range(a+r.from,l+r.from)}function DNe(s,e){return e.left>s?e.left-s:Math.max(0,s-e.right)}function LNe(s,e){return e.top>s?e.top-s:Math.max(0,s-e.bottom)}function UP(s,e){return s.top<e.bottom-1&&s.bottom>e.top+1}function fX(s,e){return e<s.top?{top:e,left:s.left,right:s.right,bottom:s.bottom}:s}function pX(s,e){return e>s.bottom?{top:s.top,left:s.left,right:s.right,bottom:e}:s}function _R(s,e,i){let n,r,o,a,l=!1,h,d,f,p;for(let x=s.firstChild;x;x=x.nextSibling){let _=Y_(x);for(let w=0;w<_.length;w++){let O=_[w];r&&UP(r,O)&&(O=fX(pX(O,r.bottom),r.top));let T=DNe(e,O),C=LNe(i,O);if(T==0&&C==0)return x.nodeType==3?mX(x,e,i):_R(x,e,i);if(!n||a>C||a==C&&o>T){n=x,r=O,o=T,a=C;let A=C?i<O.top?-1:1:T?e<O.left?-1:1:0;l=!A||(A>0?w<_.length-1:w>0)}T==0?i>O.bottom&&(!f||f.bottom<O.bottom)?(h=x,f=O):i<O.top&&(!p||p.top>O.top)&&(d=x,p=O):f&&UP(f,O)?f=pX(f,O.bottom):p&&UP(p,O)&&(p=fX(p,O.top))}}if(f&&f.bottom>=i?(n=h,r=f):p&&p.top<=i&&(n=d,r=p),!n)return{node:s,offset:0};let g=Math.max(r.left,Math.min(r.right,e));if(n.nodeType==3)return mX(n,g,i);if(l&&n.contentEditable!="false")return _R(n,g,i);let y=Array.prototype.indexOf.call(s.childNodes,n)+(e>=(r.left+r.right)/2?1:0);return{node:s,offset:y}}function mX(s,e,i){let n=s.nodeValue.length,r=-1,o=1e9,a=0;for(let l=0;l<n;l++){let h=bm(s,l,l+1).getClientRects();for(let d=0;d<h.length;d++){let f=h[d];if(f.top==f.bottom)continue;a||(a=e-f.left);let p=(f.top>i?f.top-i:i-f.bottom)-1;if(f.left-1<=e&&f.right+1>=e&&p<o){let g=e>=(f.left+f.right)/2,y=g;if((Bt.chrome||Bt.gecko)&&bm(s,l).getBoundingClientRect().left==f.right&&(y=!g),p<=0)return{node:s,offset:l+(y?1:0)};r=l+(y?1:0),o=p}}}return{node:s,offset:r>-1?r:a>0?s.nodeValue.length:0}}function kZ(s,e,i,n=-1){var r,o;let a=s.contentDOM.getBoundingClientRect(),l=a.top+s.viewState.paddingTop,h,{docHeight:d}=s.viewState,{x:f,y:p}=e,g=p-l;if(g<0)return 0;if(g>d)return s.state.doc.length;for(let A=s.viewState.heightOracle.textHeight/2,B=!1;h=s.elementAtHeight(g),h.type!=So.Text;)for(;g=n>0?h.bottom+A:h.top-A,!(g>=0&&g<=d);){if(B)return i?null:0;B=!0,n=-n}p=l+g;let y=h.from;if(y<s.viewport.from)return s.viewport.from==0?0:i?null:gX(s,a,h,f,p);if(y>s.viewport.to)return s.viewport.to==s.state.doc.length?s.state.doc.length:i?null:gX(s,a,h,f,p);let x=s.dom.ownerDocument,_=s.root.elementFromPoint?s.root:x,w=_.elementFromPoint(f,p);w&&!s.contentDOM.contains(w)&&(w=null),w||(f=Math.max(a.left+1,Math.min(a.right-1,f)),w=_.elementFromPoint(f,p),w&&!s.contentDOM.contains(w)&&(w=null));let O,T=-1;if(w&&((r=s.docView.nearest(w))===null||r===void 0?void 0:r.isEditable)!=!1){if(x.caretPositionFromPoint){let A=x.caretPositionFromPoint(f,p);A&&({offsetNode:O,offset:T}=A)}else if(x.caretRangeFromPoint){let A=x.caretRangeFromPoint(f,p);A&&({startContainer:O,startOffset:T}=A,(!s.contentDOM.contains(O)||Bt.safari&&NNe(O,T,f)||Bt.chrome&&VNe(O,T,f))&&(O=void 0))}}if(!O||!s.docView.dom.contains(O)){let A=Ws.find(s.docView,y);if(!A)return g>h.top+h.height/2?h.to:h.from;({node:O,offset:T}=_R(A.dom,f,p))}let C=s.docView.nearest(O);if(!C)return null;if(C.isWidget&&((o=C.dom)===null||o===void 0?void 0:o.nodeType)==1){let A=C.dom.getBoundingClientRect();return e.y<A.top||e.y<=A.bottom&&e.x<=(A.left+A.right)/2?C.posAtStart:C.posAtEnd}else return C.localPosFromDOM(O,T)+C.posAtStart}function gX(s,e,i,n,r){let o=Math.round((n-e.left)*s.defaultCharacterWidth);if(s.lineWrapping&&i.height>s.defaultLineHeight*1.5){let l=s.viewState.heightOracle.textHeight,h=Math.floor((r-i.top-(s.defaultLineHeight-l)*.5)/l);o+=h*s.viewState.heightOracle.lineLength}let a=s.state.sliceDoc(i.from,i.to);return i.from+rR(a,o,s.state.tabSize)}function NNe(s,e,i){let n;if(s.nodeType!=3||e!=(n=s.nodeValue.length))return!1;for(let r=s.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return bm(s,n-1,n).getBoundingClientRect().left>i}function VNe(s,e,i){if(e!=0)return!1;for(let r=s;;){let o=r.parentNode;if(!o||o.nodeType!=1||o.firstChild!=r)return!1;if(o.classList.contains("cm-line"))break;r=o}let n=s.nodeType==1?s.getBoundingClientRect():bm(s,0,Math.max(s.nodeValue.length,1)).getBoundingClientRect();return i-n.left>5}function bR(s,e){let i=s.lineBlockAt(e);if(Array.isArray(i.type)){for(let n of i.type)if(n.to>e||n.to==e&&(n.to==i.to||n.type==So.Text))return n}return i}function $Ne(s,e,i,n){let r=bR(s,e.head),o=!n||r.type!=So.Text||!(s.lineWrapping||r.widgetLineBreaks)?null:s.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(o){let a=s.dom.getBoundingClientRect(),l=s.textDirectionAt(r.from),h=s.posAtCoords({x:i==(l==Jn.LTR)?a.right-1:a.left+1,y:(o.top+o.bottom)/2});if(h!=null)return et.cursor(h,i?-1:1)}return et.cursor(i?r.to:r.from,i?-1:1)}function yX(s,e,i,n){let r=s.state.doc.lineAt(e.head),o=s.bidiSpans(r),a=s.textDirectionAt(r.from);for(let l=e,h=null;;){let d=SNe(r,o,a,l,i),f=fZ;if(!d){if(r.number==(i?s.state.doc.lines:1))return l;f=`
`,r=s.state.doc.line(r.number+(i?1:-1)),o=s.bidiSpans(r),d=s.visualLineSide(r,!i)}if(h){if(!h(f))return l}else{if(!n)return d;h=n(f)}l=d}}function UNe(s,e,i){let n=s.state.charCategorizer(e),r=n(i);return o=>{let a=n(o);return r==ls.Space&&(r=a),r==a}}function FNe(s,e,i,n){let r=e.head,o=i?1:-1;if(r==(i?s.state.doc.length:0))return et.cursor(r,e.assoc);let a=e.goalColumn,l,h=s.contentDOM.getBoundingClientRect(),d=s.coordsAtPos(r,e.assoc||-1),f=s.documentTop;if(d)a==null&&(a=d.left-h.left),l=o<0?d.top:d.bottom;else{let y=s.viewState.lineBlockAt(r);a==null&&(a=Math.min(h.right-h.left,s.defaultCharacterWidth*(r-y.from))),l=(o<0?y.top:y.bottom)+f}let p=h.left+a,g=n??s.viewState.heightOracle.textHeight>>1;for(let y=0;;y+=10){let x=l+(g+y)*o,_=kZ(s,{x:p,y:x},!1,o);if(x<h.top||x>h.bottom||(o<0?_<r:_>r)){let w=s.docView.coordsForChar(_),O=!w||x<w.top?-1:1;return et.cursor(_,O,void 0,a)}}}function tC(s,e,i){for(;;){let n=0;for(let r of s)r.between(e-1,e+1,(o,a,l)=>{if(e>o&&e<a){let h=n||i||(e-o<a-e?-1:1);e=h<0?o:a,n=h}});if(!n)return e}}function FP(s,e,i){let n=tC(s.state.facet(C3).map(r=>r(s)),i.from,e.head>i.from?-1:1);return n==i.from?i:et.cursor(n,n<i.from?1:-1)}const Bx="";class zNe{constructor(e,i){this.points=e,this.text="",this.lineSeparator=i.facet(gn.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Bx}readRange(e,i){if(!e)return this;let n=e.parentNode;for(let r=e;;){this.findPointBefore(n,r);let o=this.text.length;this.readNode(r);let a=r.nextSibling;if(a==i)break;let l=Fn.get(r),h=Fn.get(a);(l&&h?l.breakAfter:(l?l.breakAfter:iT(r))||iT(a)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>o)&&this.lineBreak(),r=a}return this.findPointBefore(n,i),this}readTextNode(e){let i=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,i.length));for(let n=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let o=-1,a=1,l;if(this.lineSeparator?(o=i.indexOf(this.lineSeparator,n),a=this.lineSeparator.length):(l=r.exec(i))&&(o=l.index,a=l[0].length),this.append(i.slice(n,o<0?i.length:o)),o<0)break;if(this.lineBreak(),a>1)for(let h of this.points)h.node==e&&h.pos>this.text.length&&(h.pos-=a-1);n=o+a}}readNode(e){if(e.cmIgnore)return;let i=Fn.get(e),n=i&&i.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let r=n.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,i){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==i&&(n.pos=this.text.length)}findPointInside(e,i){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(XNe(e,n.node,n.offset)?i:0))}}function XNe(s,e,i){for(;;){if(!e||i<Ou(e))return!1;if(e==s)return!0;i=_m(e)+1,e=e.parentNode}}class vX{constructor(e,i){this.node=e,this.offset=i,this.pos=-1}}class WNe{constructor(e,i,n,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=i>-1;let{impreciseHead:o,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&i>-1)this.newSel=null;else if(i>-1&&(this.bounds=e.docView.domBoundsAround(i,n,0))){let l=o||a?[]:QNe(e),h=new zNe(l,e.state);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=YNe(l,this.bounds.from)}else{let l=e.observer.selectionRange,h=o&&o.node==l.focusNode&&o.offset==l.focusOffset||!lR(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),d=a&&a.node==l.anchorNode&&a.offset==l.anchorOffset||!lR(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),f=e.viewport;if((Bt.ios||Bt.chrome)&&e.state.selection.main.empty&&h!=d&&(f.from>0||f.to<e.state.doc.length)){let p=Math.min(h,d),g=Math.max(h,d),y=f.from-p,x=f.to-g;(y==0||y==1||p==0)&&(x==0||x==-1||g==e.state.doc.length)&&(h=0,d=e.state.doc.length)}this.newSel=et.single(d,h)}}}function PZ(s,e){let i,{newSel:n}=e,r=s.state.selection.main,o=s.inputState.lastKeyTime>Date.now()-100?s.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:l}=e.bounds,h=r.from,d=null;(o===8||Bt.android&&e.text.length<l-a)&&(h=r.to,d="end");let f=GNe(s.state.doc.sliceString(a,l,Bx),e.text,h-a,d);f&&(Bt.chrome&&o==13&&f.toB==f.from+2&&e.text.slice(f.from,f.toB)==Bx+Bx&&f.toB--,i={from:a+f.from,to:a+f.toA,insert:yn.of(e.text.slice(f.from,f.toB).split(Bx))})}else n&&(!s.hasFocus&&s.state.facet(Dd)||n.main.eq(r))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!r.empty&&n&&n.main.empty?i={from:r.from,to:r.to,insert:s.state.doc.slice(r.from,r.to)}:i&&i.from>=r.from&&i.to<=r.to&&(i.from!=r.from||i.to!=r.to)&&r.to-r.from-(i.to-i.from)<=4?i={from:r.from,to:r.to,insert:s.state.doc.slice(r.from,i.from).append(i.insert).append(s.state.doc.slice(i.to,r.to))}:(Bt.mac||Bt.android)&&i&&i.from==i.to&&i.from==r.head-1&&/^\. ?$/.test(i.insert.toString())&&s.contentDOM.getAttribute("autocorrect")=="off"?(n&&i.insert.length==2&&(n=et.single(n.main.anchor-1,n.main.head-1)),i={from:r.from,to:r.to,insert:yn.of([" "])}):Bt.chrome&&i&&i.from==i.to&&i.from==r.head&&i.insert.toString()==`
 `&&s.lineWrapping&&(n&&(n=et.single(n.main.anchor-1,n.main.head-1)),i={from:r.from,to:r.to,insert:yn.of([" "])}),i)return T3(s,i,n,o);if(n&&!n.main.eq(r)){let a=!1,l="select";return s.inputState.lastSelectionTime>Date.now()-50&&(s.inputState.lastSelectionOrigin=="select"&&(a=!0),l=s.inputState.lastSelectionOrigin),s.dispatch({selection:n,scrollIntoView:a,userEvent:l}),!0}else return!1}function T3(s,e,i,n=-1){if(Bt.ios&&s.inputState.flushIOSKey(e))return!0;let r=s.state.selection.main;if(Bt.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&s.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&H0(s.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&H0(s.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&H0(s.contentDOM,"Delete",46)))return!0;let o=e.insert.toString();s.inputState.composing>=0&&s.inputState.composing++;let a,l=()=>a||(a=HNe(s,e,i));return s.state.facet(vZ).some(h=>h(s,e.from,e.to,o,l))||s.dispatch(l()),!0}function HNe(s,e,i){let n,r=s.state,o=r.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&s.inputState.composing<0){let l=o.from<e.from?r.sliceDoc(o.from,e.from):"",h=o.to>e.to?r.sliceDoc(e.to,o.to):"";n=r.replaceSelection(s.state.toText(l+e.insert.sliceString(0,void 0,s.state.lineBreak)+h))}else{let l=r.changes(e),h=i&&i.main.to<=l.newLength?i.main:void 0;if(r.selection.ranges.length>1&&s.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let d=s.state.sliceDoc(e.from,e.to),f,p=i&&MZ(s,i.main.head);if(p){let x=e.insert.length-(e.to-e.from);f={from:p.from,to:p.to-x}}else f=s.state.doc.lineAt(o.head);let g=o.to-e.to,y=o.to-o.from;n=r.changeByRange(x=>{if(x.from==o.from&&x.to==o.to)return{changes:l,range:h||x.map(l)};let _=x.to-g,w=_-d.length;if(x.to-x.from!=y||s.state.sliceDoc(w,_)!=d||x.to>=f.from&&x.from<=f.to)return{range:x};let O=r.changes({from:w,to:_,insert:e.insert}),T=x.to-o.to;return{changes:O,range:h?et.range(Math.max(0,h.anchor+T),Math.max(0,h.head+T)):x.map(O)}})}else n={changes:l,selection:h&&r.selection.replaceRange(h)}}let a="input.type";return(s.composing||s.inputState.compositionPendingChange&&s.inputState.compositionEndedAt>Date.now()-50)&&(s.inputState.compositionPendingChange=!1,a+=".compose",s.inputState.compositionFirstChange&&(a+=".start",s.inputState.compositionFirstChange=!1)),r.update(n,{userEvent:a,scrollIntoView:!0})}function GNe(s,e,i,n){let r=Math.min(s.length,e.length),o=0;for(;o<r&&s.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==r&&s.length==e.length)return null;let a=s.length,l=e.length;for(;a>0&&l>0&&s.charCodeAt(a-1)==e.charCodeAt(l-1);)a--,l--;if(n=="end"){let h=Math.max(0,o-Math.min(a,l));i-=a+h-o}if(a<o&&s.length<e.length){let h=i<=o&&i>=a?o-i:0;o-=h,l=o+(l-a),a=o}else if(l<o){let h=i<=o&&i>=l?o-i:0;o-=h,a=o+(a-l),l=o}return{from:o,toA:a,toB:l}}function QNe(s){let e=[];if(s.root.activeElement!=s.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:o}=s.observer.selectionRange;return i&&(e.push(new vX(i,n)),(r!=i||o!=n)&&e.push(new vX(r,o))),e}function YNe(s,e){if(s.length==0)return null;let i=s[0].pos,n=s.length==2?s[1].pos:i;return i>-1&&n>-1?et.single(i+e,n+e):null}class jNe{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Bt.safari&&e.contentDOM.addEventListener("input",()=>null),Bt.gecko&&uVe(e.contentDOM.ownerDocument)}handleEvent(e){!nVe(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,i){let n=this.handlers[e];if(n){for(let r of n.observers)r(this.view,i);for(let r of n.handlers){if(i.defaultPrevented)break;if(r(this.view,i)){i.preventDefault();break}}}}ensureHandlers(e){let i=qNe(e),n=this.handlers,r=this.view.contentDOM;for(let o in i)if(o!="scroll"){let a=!i[o].handlers.length,l=n[o];l&&a!=!l.handlers.length&&(r.removeEventListener(o,this.handleEvent),l=null),l||r.addEventListener(o,this.handleEvent,{passive:a})}for(let o in n)o!="scroll"&&!i[o]&&r.removeEventListener(o,this.handleEvent);this.handlers=i}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&BZ.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Bt.android&&Bt.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return Bt.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((i=IZ.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||ZNe.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=i||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let i=this.pendingIOSKey;return!i||i.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,H0(this.view.contentDOM,i.key,i.keyCode,i instanceof KeyboardEvent?i:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Bt.safari&&!Bt.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function xX(s,e){return(i,n)=>{try{return e.call(s,n,i)}catch(r){Ko(i.state,r)}}}function qNe(s){let e=Object.create(null);function i(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of s){let r=n.spec;if(r&&r.domEventHandlers)for(let o in r.domEventHandlers){let a=r.domEventHandlers[o];a&&i(o).handlers.push(xX(n.value,a))}if(r&&r.domEventObservers)for(let o in r.domEventObservers){let a=r.domEventObservers[o];a&&i(o).observers.push(xX(n.value,a))}}for(let n in oc)i(n).handlers.push(oc[n]);for(let n in yl)i(n).observers.push(yl[n]);return e}const IZ=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],ZNe="dthko",BZ=[16,17,18,20,91,92,224,225],EO=6;function MO(s){return Math.max(0,s)*.7+8}function KNe(s,e){return Math.max(Math.abs(s.clientX-e.clientX),Math.abs(s.clientY-e.clientY))}class JNe{constructor(e,i,n,r){this.view=e,this.startEvent=i,this.style=n,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=i,this.scrollParents=lNe(e.contentDOM),this.atoms=e.state.facet(C3).map(a=>a(e));let o=e.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=e.state.facet(gn.allowMultipleSelections)&&eVe(e,i),this.dragging=iVe(e,i)&&LZ(i)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&KNe(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let i=0,n=0,r=0,o=0,a=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:o,bottom:l}=this.scrollParents.y.getBoundingClientRect());let h=EZ(this.view);e.clientX-h.left<=r+EO?i=-MO(r-e.clientX):e.clientX+h.right>=a-EO&&(i=MO(e.clientX-a)),e.clientY-h.top<=o+EO?n=-MO(o-e.clientY):e.clientY+h.bottom>=l-EO&&(n=MO(e.clientY-l)),this.setScrollSpeed(i,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,i){this.scrollSpeed={x:e,y:i},e||i?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:i}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),i&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=i,i=0),(e||i)&&this.view.win.scrollBy(e,i),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let i=null;for(let n=0;n<e.ranges.length;n++){let r=e.ranges[n],o=null;if(r.empty){let a=tC(this.atoms,r.from,0);a!=r.from&&(o=et.cursor(a,-1))}else{let a=tC(this.atoms,r.from,-1),l=tC(this.atoms,r.to,1);(a!=r.from||l!=r.to)&&(o=et.range(r.from==r.anchor?a:l,r.from==r.head?a:l))}o&&(i||(i=e.ranges.slice()),i[n]=o)}return i?et.create(i,e.mainIndex):e}select(e){let{view:i}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(i.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(i=>i.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function eVe(s,e){let i=s.state.facet(pZ);return i.length?i[0](e):Bt.mac?e.metaKey:e.ctrlKey}function tVe(s,e){let i=s.state.facet(mZ);return i.length?i[0](e):Bt.mac?!e.altKey:!e.ctrlKey}function iVe(s,e){let{main:i}=s.state.selection;if(i.empty)return!1;let n=Q_(s.root);if(!n||n.rangeCount==0)return!0;let r=n.getRangeAt(0).getClientRects();for(let o=0;o<r.length;o++){let a=r[o];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function nVe(s,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i=e.target,n;i!=s.contentDOM;i=i.parentNode)if(!i||i.nodeType==11||(n=Fn.get(i))&&n.ignoreEvent(e))return!1;return!0}const oc=Object.create(null),yl=Object.create(null),RZ=Bt.ie&&Bt.ie_version<15||Bt.ios&&Bt.webkit_version<604;function sVe(s){let e=s.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{s.focus(),i.remove(),DZ(s,i.value)},50)}function tE(s,e,i){for(let n of s.facet(e))i=n(i,s);return i}function DZ(s,e){e=tE(s.state,w3,e);let{state:i}=s,n,r=1,o=i.toText(e),a=o.lines==i.selection.ranges.length;if(wR!=null&&i.selection.ranges.every(h=>h.empty)&&wR==o.toString()){let h=-1;n=i.changeByRange(d=>{let f=i.doc.lineAt(d.from);if(f.from==h)return{range:d};h=f.from;let p=i.toText((a?o.line(r++).text:e)+i.lineBreak);return{changes:{from:f.from,insert:p},range:et.cursor(d.from+p.length)}})}else a?n=i.changeByRange(h=>{let d=o.line(r++);return{changes:{from:h.from,to:h.to,insert:d.text},range:et.cursor(h.from+d.length)}}):n=i.replaceSelection(o);s.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}yl.scroll=s=>{s.inputState.lastScrollTop=s.scrollDOM.scrollTop,s.inputState.lastScrollLeft=s.scrollDOM.scrollLeft};oc.keydown=(s,e)=>(s.inputState.setSelectionOrigin("select"),e.keyCode==27&&s.inputState.tabFocusMode!=0&&(s.inputState.tabFocusMode=Date.now()+2e3),!1);yl.touchstart=(s,e)=>{s.inputState.lastTouchTime=Date.now(),s.inputState.setSelectionOrigin("select.pointer")};yl.touchmove=s=>{s.inputState.setSelectionOrigin("select.pointer")};oc.mousedown=(s,e)=>{if(s.observer.flush(),s.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of s.state.facet(gZ))if(i=n(s,e),i)break;if(!i&&e.button==0&&(i=aVe(s,e)),i){let n=!s.hasFocus;s.inputState.startMouseSelection(new JNe(s,e,i,n)),n&&s.observer.ignore(()=>{jq(s.contentDOM);let o=s.root.activeElement;o&&!o.contains(s.contentDOM)&&o.blur()});let r=s.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function _X(s,e,i,n){if(n==1)return et.cursor(e,i);if(n==2)return RNe(s.state,e,i);{let r=Ws.find(s.docView,e),o=s.state.doc.lineAt(r?r.posAtEnd:e),a=r?r.posAtStart:o.from,l=r?r.posAtEnd:o.to;return l<s.state.doc.length&&l==o.to&&l++,et.range(a,l)}}let bX=(s,e,i)=>e>=i.top&&e<=i.bottom&&s>=i.left&&s<=i.right;function rVe(s,e,i,n){let r=Ws.find(s.docView,e);if(!r)return 1;let o=e-r.posAtStart;if(o==0)return 1;if(o==r.length)return-1;let a=r.coordsAt(o,-1);if(a&&bX(i,n,a))return-1;let l=r.coordsAt(o,1);return l&&bX(i,n,l)?1:a&&a.bottom>=n?-1:1}function wX(s,e){let i=s.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:rVe(s,i,e.clientX,e.clientY)}}const oVe=Bt.ie&&Bt.ie_version<=11;let OX=null,SX=0,CX=0;function LZ(s){if(!oVe)return s.detail;let e=OX,i=CX;return OX=s,CX=Date.now(),SX=!e||i>Date.now()-400&&Math.abs(e.clientX-s.clientX)<2&&Math.abs(e.clientY-s.clientY)<2?(SX+1)%3:1}function aVe(s,e){let i=wX(s,e),n=LZ(e),r=s.state.selection;return{update(o){o.docChanged&&(i.pos=o.changes.mapPos(i.pos),r=r.map(o.changes))},get(o,a,l){let h=wX(s,o),d,f=_X(s,h.pos,h.bias,n);if(i.pos!=h.pos&&!a){let p=_X(s,i.pos,i.bias,n),g=Math.min(p.from,f.from),y=Math.max(p.to,f.to);f=g<f.from?et.range(g,y):et.range(y,g)}return a?r.replaceRange(r.main.extend(f.from,f.to)):l&&n==1&&r.ranges.length>1&&(d=lVe(r,h.pos))?d:l?r.addRange(f):et.create([f])}}}function lVe(s,e){for(let i=0;i<s.ranges.length;i++){let{from:n,to:r}=s.ranges[i];if(n<=e&&r>=e)return et.create(s.ranges.slice(0,i).concat(s.ranges.slice(i+1)),s.mainIndex==i?0:s.mainIndex-(s.mainIndex>i?1:0))}return null}oc.dragstart=(s,e)=>{let{selection:{main:i}}=s.state;if(e.target.draggable){let r=s.docView.nearest(e.target);if(r&&r.isWidget){let o=r.posAtStart,a=o+r.length;(o>=i.to||a<=i.from)&&(i=et.range(o,a))}}let{inputState:n}=s;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",tE(s.state,O3,s.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1};oc.dragend=s=>(s.inputState.draggedContent=null,!1);function TX(s,e,i,n){if(i=tE(s.state,w3,i),!i)return;let r=s.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=s.inputState,a=n&&o&&tVe(s,e)?{from:o.from,to:o.to}:null,l={from:r,insert:i},h=s.state.changes(a?[a,l]:l);s.focus(),s.dispatch({changes:h,selection:{anchor:h.mapPos(r,-1),head:h.mapPos(r,1)},userEvent:a?"move.drop":"input.drop"}),s.inputState.draggedContent=null}oc.drop=(s,e)=>{if(!e.dataTransfer)return!1;if(s.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),r=0,o=()=>{++r==i.length&&TX(s,e,n.filter(a=>a!=null).join(s.state.lineBreak),!1)};for(let a=0;a<i.length;a++){let l=new FileReader;l.onerror=o,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(n[a]=l.result),o()},l.readAsText(i[a])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return TX(s,e,n,!0),!0}return!1};oc.paste=(s,e)=>{if(s.state.readOnly)return!0;s.observer.flush();let i=RZ?null:e.clipboardData;return i?(DZ(s,i.getData("text/plain")||i.getData("text/uri-list")),!0):(sVe(s),!1)};function cVe(s,e){let i=s.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),s.focus()},50)}function hVe(s){let e=[],i=[],n=!1;for(let r of s.selection.ranges)r.empty||(e.push(s.sliceDoc(r.from,r.to)),i.push(r));if(!e.length){let r=-1;for(let{from:o}of s.selection.ranges){let a=s.doc.lineAt(o);a.number>r&&(e.push(a.text),i.push({from:a.from,to:Math.min(s.doc.length,a.to+1)})),r=a.number}n=!0}return{text:tE(s,O3,e.join(s.lineBreak)),ranges:i,linewise:n}}let wR=null;oc.copy=oc.cut=(s,e)=>{let{text:i,ranges:n,linewise:r}=hVe(s.state);if(!i&&!r)return!1;wR=r?i:null,e.type=="cut"&&!s.state.readOnly&&s.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=RZ?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(cVe(s,i),!1)};const NZ=Pu.define();function VZ(s,e){let i=[];for(let n of s.facet(xZ)){let r=n(s,e);r&&i.push(r)}return i?s.update({effects:i,annotations:NZ.of(!0)}):null}function $Z(s){setTimeout(()=>{let e=s.hasFocus;if(e!=s.inputState.notifiedFocused){let i=VZ(s.state,e);i?s.dispatch(i):s.update([])}},10)}yl.focus=s=>{s.inputState.lastFocusTime=Date.now(),!s.scrollDOM.scrollTop&&(s.inputState.lastScrollTop||s.inputState.lastScrollLeft)&&(s.scrollDOM.scrollTop=s.inputState.lastScrollTop,s.scrollDOM.scrollLeft=s.inputState.lastScrollLeft),$Z(s)};yl.blur=s=>{s.observer.clearSelectionRange(),$Z(s)};yl.compositionstart=yl.compositionupdate=s=>{s.observer.editContext||(s.inputState.compositionFirstChange==null&&(s.inputState.compositionFirstChange=!0),s.inputState.composing<0&&(s.inputState.composing=0))};yl.compositionend=s=>{s.observer.editContext||(s.inputState.composing=-1,s.inputState.compositionEndedAt=Date.now(),s.inputState.compositionPendingKey=!0,s.inputState.compositionPendingChange=s.observer.pendingRecords().length>0,s.inputState.compositionFirstChange=null,Bt.chrome&&Bt.android?s.observer.flushSoon():s.inputState.compositionPendingChange?Promise.resolve().then(()=>s.observer.flush()):setTimeout(()=>{s.inputState.composing<0&&s.docView.hasComposition&&s.update([])},50))};yl.contextmenu=s=>{s.inputState.lastContextMenu=Date.now()};oc.beforeinput=(s,e)=>{var i,n;if(e.inputType=="insertReplacementText"&&s.observer.editContext){let o=(i=e.dataTransfer)===null||i===void 0?void 0:i.getData("text/plain"),a=e.getTargetRanges();if(o&&a.length){let l=a[0],h=s.posAtDOM(l.startContainer,l.startOffset),d=s.posAtDOM(l.endContainer,l.endOffset);return T3(s,{from:h,to:d,insert:s.state.toText(o)},null),!0}}let r;if(Bt.chrome&&Bt.android&&(r=IZ.find(o=>o.inputType==e.inputType))&&(s.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let o=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>o+10&&s.hasFocus&&(s.contentDOM.blur(),s.focus())},100)}return Bt.ios&&e.inputType=="deleteContentForward"&&s.observer.flushSoon(),Bt.safari&&e.inputType=="insertText"&&s.inputState.composing>=0&&setTimeout(()=>yl.compositionend(s,e),20),!1};const AX=new Set;function uVe(s){AX.has(s)||(AX.add(s),s.addEventListener("copy",()=>{}),s.addEventListener("cut",()=>{}))}const EX=["pre-wrap","normal","pre-line","break-spaces"];let xy=!1;function MX(){xy=!1}class dVe{constructor(e){this.lineWrapping=e,this.doc=yn.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,i){let n=this.doc.lineAt(i).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((i-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return EX.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let i=!1;for(let n=0;n<e.length;n++){let r=e[n];r<0?n++:this.heightSamples[Math.floor(r*10)]||(i=!0,this.heightSamples[Math.floor(r*10)]=!0)}return i}refresh(e,i,n,r,o,a){let l=EX.indexOf(e)>-1,h=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=i,this.charWidth=n,this.textHeight=r,this.lineLength=o,h){this.heightSamples={};for(let d=0;d<a.length;d++){let f=a[d];f<0?d++:this.heightSamples[Math.floor(f*10)]=!0}}return h}}class fVe{constructor(e,i){this.from=e,this.heights=i,this.index=0}get more(){return this.index<this.heights.length}}class Hc{constructor(e,i,n,r,o){this.from=e,this.length=i,this.top=n,this.height=r,this._content=o}get type(){return typeof this._content=="number"?So.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof lf?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let i=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Hc(this.from,this.length+e.length,this.top,this.height+e.height,i)}}var jn=function(s){return s[s.ByPos=0]="ByPos",s[s.ByHeight=1]="ByHeight",s[s.ByPosNoHeight=2]="ByPosNoHeight",s}(jn||(jn={}));const iC=.001;class Co{constructor(e,i,n=2){this.length=e,this.height=i,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>iC&&(xy=!0),this.height=e)}replace(e,i,n){return Co.of(n)}decomposeLeft(e,i){i.push(this)}decomposeRight(e,i){i.push(this)}applyChanges(e,i,n,r){let o=this,a=n.doc;for(let l=r.length-1;l>=0;l--){let{fromA:h,toA:d,fromB:f,toB:p}=r[l],g=o.lineAt(h,jn.ByPosNoHeight,n.setDoc(i),0,0),y=g.to>=d?g:o.lineAt(d,jn.ByPosNoHeight,n,0,0);for(p+=y.to-d,d=y.to;l>0&&g.from<=r[l-1].toA;)h=r[l-1].fromA,f=r[l-1].fromB,l--,h<g.from&&(g=o.lineAt(h,jn.ByPosNoHeight,n,0,0));f+=g.from-h,h=g.from;let x=A3.build(n.setDoc(a),e,f,p);o=rT(o,o.replace(h,d,x))}return o.updateHeight(n,0)}static empty(){return new Ca(0,0)}static of(e){if(e.length==1)return e[0];let i=0,n=e.length,r=0,o=0;for(;;)if(i==n)if(r>o*2){let l=e[i-1];l.break?e.splice(--i,1,l.left,null,l.right):e.splice(--i,1,l.left,l.right),n+=1+l.break,r-=l.size}else if(o>r*2){let l=e[n];l.break?e.splice(n,1,l.left,null,l.right):e.splice(n,1,l.left,l.right),n+=2+l.break,o-=l.size}else break;else if(r<o){let l=e[i++];l&&(r+=l.size)}else{let l=e[--n];l&&(o+=l.size)}let a=0;return e[i-1]==null?(a=1,i--):e[i]==null&&(a=1,n++),new pVe(Co.of(e.slice(0,i)),a,Co.of(e.slice(n)))}}function rT(s,e){return s==e?s:(s.constructor!=e.constructor&&(xy=!0),e)}Co.prototype.size=1;class UZ extends Co{constructor(e,i,n){super(e,i),this.deco=n}blockAt(e,i,n,r){return new Hc(r,this.length,n,this.height,this.deco||0)}lineAt(e,i,n,r,o){return this.blockAt(0,n,r,o)}forEachLine(e,i,n,r,o,a){e<=o+this.length&&i>=o&&a(this.blockAt(0,n,r,o))}updateHeight(e,i=0,n=!1,r){return r&&r.from<=i&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ca extends UZ{constructor(e,i){super(e,i,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,i,n,r){return new Hc(r,this.length,n,this.height,this.breaks)}replace(e,i,n){let r=n[0];return n.length==1&&(r instanceof Ca||r instanceof Mr&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Mr?r=new Ca(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):Co.of(n)}updateHeight(e,i=0,n=!1,r){return r&&r.from<=i&&r.more?this.setHeight(r.heights[r.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Mr extends Co{constructor(e){super(e,0)}heightMetrics(e,i){let n=e.doc.lineAt(i).number,r=e.doc.lineAt(i+this.length).number,o=r-n+1,a,l=0;if(e.lineWrapping){let h=Math.min(this.height,e.lineHeight*o);a=h/o,this.length>o+1&&(l=(this.height-h)/(this.length-o-1))}else a=this.height/o;return{firstLine:n,lastLine:r,perLine:a,perChar:l}}blockAt(e,i,n,r){let{firstLine:o,lastLine:a,perLine:l,perChar:h}=this.heightMetrics(i,r);if(i.lineWrapping){let d=r+(e<i.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),f=i.doc.lineAt(d),p=l+f.length*h,g=Math.max(n,e-p/2);return new Hc(f.from,f.length,g,p,0)}else{let d=Math.max(0,Math.min(a-o,Math.floor((e-n)/l))),{from:f,length:p}=i.doc.line(o+d);return new Hc(f,p,n+l*d,l,0)}}lineAt(e,i,n,r,o){if(i==jn.ByHeight)return this.blockAt(e,n,r,o);if(i==jn.ByPosNoHeight){let{from:y,to:x}=n.doc.lineAt(e);return new Hc(y,x-y,0,0,0)}let{firstLine:a,perLine:l,perChar:h}=this.heightMetrics(n,o),d=n.doc.lineAt(e),f=l+d.length*h,p=d.number-a,g=r+l*p+h*(d.from-o-p);return new Hc(d.from,d.length,Math.max(r,Math.min(g,r+this.height-f)),f,0)}forEachLine(e,i,n,r,o,a){e=Math.max(e,o),i=Math.min(i,o+this.length);let{firstLine:l,perLine:h,perChar:d}=this.heightMetrics(n,o);for(let f=e,p=r;f<=i;){let g=n.doc.lineAt(f);if(f==e){let x=g.number-l;p+=h*x+d*(e-o-x)}let y=h+d*g.length;a(new Hc(g.from,g.length,p,y,0)),p+=y,f=g.to+1}}replace(e,i,n){let r=this.length-i;if(r>0){let o=n[n.length-1];o instanceof Mr?n[n.length-1]=new Mr(o.length+r):n.push(null,new Mr(r-1))}if(e>0){let o=n[0];o instanceof Mr?n[0]=new Mr(e+o.length):n.unshift(new Mr(e-1),null)}return Co.of(n)}decomposeLeft(e,i){i.push(new Mr(e-1),null)}decomposeRight(e,i){i.push(null,new Mr(this.length-e-1))}updateHeight(e,i=0,n=!1,r){let o=i+this.length;if(r&&r.from<=i+this.length&&r.more){let a=[],l=Math.max(i,r.from),h=-1;for(r.from>i&&a.push(new Mr(r.from-i-1).updateHeight(e,i));l<=o&&r.more;){let f=e.doc.lineAt(l).length;a.length&&a.push(null);let p=r.heights[r.index++];h==-1?h=p:Math.abs(p-h)>=iC&&(h=-2);let g=new Ca(f,p);g.outdated=!1,a.push(g),l+=f+1}l<=o&&a.push(null,new Mr(o-l).updateHeight(e,l));let d=Co.of(a);return(h<0||Math.abs(d.height-this.height)>=iC||Math.abs(h-this.heightMetrics(e,i).perLine)>=iC)&&(xy=!0),rT(this,d)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(i,i+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class pVe extends Co{constructor(e,i,n){super(e.length+i+n.length,e.height+n.height,i|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,i,n,r){let o=n+this.left.height;return e<o?this.left.blockAt(e,i,n,r):this.right.blockAt(e,i,o,r+this.left.length+this.break)}lineAt(e,i,n,r,o){let a=r+this.left.height,l=o+this.left.length+this.break,h=i==jn.ByHeight?e<a:e<l,d=h?this.left.lineAt(e,i,n,r,o):this.right.lineAt(e,i,n,a,l);if(this.break||(h?d.to<l:d.from>l))return d;let f=i==jn.ByPosNoHeight?jn.ByPosNoHeight:jn.ByPos;return h?d.join(this.right.lineAt(l,f,n,a,l)):this.left.lineAt(l,f,n,r,o).join(d)}forEachLine(e,i,n,r,o,a){let l=r+this.left.height,h=o+this.left.length+this.break;if(this.break)e<h&&this.left.forEachLine(e,i,n,r,o,a),i>=h&&this.right.forEachLine(e,i,n,l,h,a);else{let d=this.lineAt(h,jn.ByPos,n,r,o);e<d.from&&this.left.forEachLine(e,d.from-1,n,r,o,a),d.to>=e&&d.from<=i&&a(d),i>d.to&&this.right.forEachLine(d.to+1,i,n,l,h,a)}}replace(e,i,n){let r=this.left.length+this.break;if(i<r)return this.balanced(this.left.replace(e,i,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,i-r,n));let o=[];e>0&&this.decomposeLeft(e,o);let a=o.length;for(let l of n)o.push(l);if(e>0&&kX(o,a-1),i<this.length){let l=o.length;this.decomposeRight(i,o),kX(o,l)}return Co.of(o)}decomposeLeft(e,i){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,i);i.push(this.left),this.break&&(n++,e>=n&&i.push(null)),e>n&&this.right.decomposeLeft(e-n,i)}decomposeRight(e,i){let n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,i);e<n&&this.left.decomposeRight(e,i),this.break&&e<r&&i.push(null),i.push(this.right)}balanced(e,i){return e.size>2*i.size||i.size>2*e.size?Co.of(this.break?[e,null,i]:[e,i]):(this.left=rT(this.left,e),this.right=rT(this.right,i),this.setHeight(e.height+i.height),this.outdated=e.outdated||i.outdated,this.size=e.size+i.size,this.length=e.length+this.break+i.length,this)}updateHeight(e,i=0,n=!1,r){let{left:o,right:a}=this,l=i+o.length+this.break,h=null;return r&&r.from<=i+o.length&&r.more?h=o=o.updateHeight(e,i,n,r):o.updateHeight(e,i,n),r&&r.from<=l+a.length&&r.more?h=a=a.updateHeight(e,l,n,r):a.updateHeight(e,l,n),h?this.balanced(o,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function kX(s,e){let i,n;s[e]==null&&(i=s[e-1])instanceof Mr&&(n=s[e+1])instanceof Mr&&s.splice(e-1,3,new Mr(i.length+1+n.length))}const mVe=5;class A3{constructor(e,i){this.pos=e,this.oracle=i,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,i){if(this.lineStart>-1){let n=Math.min(i,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Ca?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Ca(n-this.pos,-1)),this.writtenTo=n,i>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=i}point(e,i,n){if(e<i||n.heightRelevant){let r=n.widget?n.widget.estimatedHeight:0,o=n.widget?n.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let a=i-e;n.block?this.addBlock(new UZ(a,r,n)):(a||o||r>=mVe)&&this.addLineDeco(r,o,a)}else i>e&&this.span(e,i);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:i}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=i,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ca(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,i){let n=new Mr(i-e);return this.oracle.doc.lineAt(e).to==i&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ca)return e;let i=new Ca(0,-1);return this.nodes.push(i),i}addBlock(e){this.enterLine();let i=e.deco;i&&i.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,i&&i.endSide>0&&(this.covering=e)}addLineDeco(e,i,n){let r=this.ensureLine();r.length+=n,r.collapsed+=n,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=i,this.writtenTo=this.pos=this.pos+n}finish(e){let i=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(i instanceof Ca)&&!this.isCovered?this.nodes.push(new Ca(0,-1)):(this.writtenTo<this.pos||i==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let r of this.nodes)r instanceof Ca&&r.updateHeight(this.oracle,n),n+=r?r.length:1;return this.nodes}static build(e,i,n,r){let o=new A3(n,e);return fn.spans(i,n,r,o,0),o.finish(n)}}function gVe(s,e,i){let n=new yVe;return fn.compare(s,e,i,n,0),n.changes}class yVe{constructor(){this.changes=[]}compareRange(){}comparePoint(e,i,n,r){(e<i||n&&n.heightRelevant||r&&r.heightRelevant)&&pR(e,i,this.changes,5)}}function vVe(s,e){let i=s.getBoundingClientRect(),n=s.ownerDocument,r=n.defaultView||window,o=Math.max(0,i.left),a=Math.min(r.innerWidth,i.right),l=Math.max(0,i.top),h=Math.min(r.innerHeight,i.bottom);for(let d=s.parentNode;d&&d!=n.body;)if(d.nodeType==1){let f=d,p=window.getComputedStyle(f);if((f.scrollHeight>f.clientHeight||f.scrollWidth>f.clientWidth)&&p.overflow!="visible"){let g=f.getBoundingClientRect();o=Math.max(o,g.left),a=Math.min(a,g.right),l=Math.max(l,g.top),h=Math.min(d==s.parentNode?r.innerHeight:h,g.bottom)}d=p.position=="absolute"||p.position=="fixed"?f.offsetParent:f.parentNode}else if(d.nodeType==11)d=d.host;else break;return{left:o-i.left,right:Math.max(o,a)-i.left,top:l-(i.top+e),bottom:Math.max(l,h)-(i.top+e)}}function xVe(s,e){let i=s.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class zP{constructor(e,i,n){this.from=e,this.to=i,this.size=n}static same(e,i){if(e.length!=i.length)return!1;for(let n=0;n<e.length;n++){let r=e[n],o=i[n];if(r.from!=o.from||r.to!=o.to||r.size!=o.size)return!1}return!0}draw(e,i){return fi.replace({widget:new _Ve(this.size*(i?e.scaleY:e.scaleX),i)}).range(this.from,this.to)}}class _Ve extends Of{constructor(e,i){super(),this.size=e,this.vertical=i}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class PX{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=IX,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Jn.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let i=e.facet(S3).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new dVe(i),this.stateDeco=e.facet(j_).filter(n=>typeof n!="function"),this.heightMap=Co.empty().applyChanges(this.stateDeco,yn.empty,this.heightOracle.setDoc(e.doc),[new ml(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=fi.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:i}=this.state.selection;for(let n=0;n<=1;n++){let r=n?i.head:i.anchor;if(!e.some(({from:o,to:a})=>r>=o&&r<=a)){let{from:o,to:a}=this.lineBlockAt(r);e.push(new kO(o,a))}}return this.viewports=e.sort((n,r)=>n.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?IX:new E3(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Rx(e,this.scaler))})}update(e,i=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(j_).filter(f=>typeof f!="function");let r=e.changedRanges,o=ml.extendWithRanges(r,gVe(n,this.stateDeco,e?e.changes:sr.empty(this.state.doc.length))),a=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);MX(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),o),(this.heightMap.height!=a||xy)&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let h=o.length?this.mapViewport(this.viewport,e.changes):this.viewport;(i&&(i.range.head<h.from||i.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,i));let d=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,e.flags|=this.updateForViewport(),(d||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),i&&(this.scrollTarget=i),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(bZ)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let i=e.contentDOM,n=window.getComputedStyle(i),r=this.heightOracle,o=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Jn.RTL:Jn.LTR;let a=this.heightOracle.mustRefreshForWrapping(o),l=i.getBoundingClientRect(),h=a||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let d=0,f=0;if(l.width&&l.height){let{scaleX:A,scaleY:B}=Yq(i,l);(A>.005&&Math.abs(this.scaleX-A)>.005||B>.005&&Math.abs(this.scaleY-B)>.005)&&(this.scaleX=A,this.scaleY=B,d|=8,a=h=!0)}let p=(parseInt(n.paddingTop)||0)*this.scaleY,g=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=p||this.paddingBottom!=g)&&(this.paddingTop=p,this.paddingBottom=g,d|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,d|=8);let y=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=y&&(this.scrollAnchorHeight=-1,this.scrollTop=y),this.scrolledToBottom=Zq(e.scrollDOM);let x=(this.printing?xVe:vVe)(i,this.paddingTop),_=x.top-this.pixelViewport.top,w=x.bottom-this.pixelViewport.bottom;this.pixelViewport=x;let O=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(O!=this.inView&&(this.inView=O,O&&(h=!0)),!this.inView&&!this.scrollTarget)return 0;let T=l.width;if((this.contentDOMWidth!=T||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,d|=8),h){let A=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(A)&&(a=!0),a||r.lineWrapping&&Math.abs(T-this.contentDOMWidth)>r.charWidth){let{lineHeight:B,charWidth:I,textHeight:R}=e.docView.measureTextSize();a=B>0&&r.refresh(o,B,I,R,T/I,A),a&&(e.docView.minWidth=0,d|=8)}_>0&&w>0?f=Math.max(_,w):_<0&&w<0&&(f=Math.min(_,w)),MX();for(let B of this.viewports){let I=B.from==this.viewport.from?A:e.docView.measureVisibleLineHeights(B);this.heightMap=(a?Co.empty().applyChanges(this.stateDeco,yn.empty,this.heightOracle,[new ml(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,a,new fVe(B.from,I))}xy&&(d|=2)}let C=!this.viewportIsAppropriate(this.viewport,f)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return C&&(d&2&&(d|=this.updateScaler()),this.viewport=this.getViewport(f,this.scrollTarget),d|=this.updateForViewport()),(d&2||C)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),d|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),d}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,i){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,o=this.heightOracle,{visibleTop:a,visibleBottom:l}=this,h=new kO(r.lineAt(a-n*1e3,jn.ByHeight,o,0,0).from,r.lineAt(l+(1-n)*1e3,jn.ByHeight,o,0,0).to);if(i){let{head:d}=i.range;if(d<h.from||d>h.to){let f=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),p=r.lineAt(d,jn.ByPos,o,0,0),g;i.y=="center"?g=(p.top+p.bottom)/2-f/2:i.y=="start"||i.y=="nearest"&&d<h.from?g=p.top:g=p.bottom-f,h=new kO(r.lineAt(g-1e3/2,jn.ByHeight,o,0,0).from,r.lineAt(g+f+1e3/2,jn.ByHeight,o,0,0).to)}}return h}mapViewport(e,i){let n=i.mapPos(e.from,-1),r=i.mapPos(e.to,1);return new kO(this.heightMap.lineAt(n,jn.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,jn.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:i},n=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,jn.ByPos,this.heightOracle,0,0),{bottom:o}=this.heightMap.lineAt(i,jn.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:l}=this;return(e==0||r<=a-Math.max(10,Math.min(-n,250)))&&(i==this.state.doc.length||o>=l+Math.max(10,Math.min(n,250)))&&r>a-2*1e3&&o<l+2*1e3}mapLineGaps(e,i){if(!e.length||i.empty)return e;let n=[];for(let r of e)i.touchesRange(r.from,r.to)||n.push(new zP(i.mapPos(r.from),i.mapPos(r.to),r.size));return n}ensureLineGaps(e,i){let n=this.heightOracle.lineWrapping,r=n?1e4:2e3,o=r>>1,a=r<<1;if(this.defaultTextDirection!=Jn.LTR&&!n)return[];let l=[],h=(f,p,g,y)=>{if(p-f<o)return;let x=this.state.selection.main,_=[x.from];x.empty||_.push(x.to);for(let O of _)if(O>f&&O<p){h(f,O-10,g,y),h(O+10,p,g,y);return}let w=wVe(e,O=>O.from>=g.from&&O.to<=g.to&&Math.abs(O.from-f)<o&&Math.abs(O.to-p)<o&&!_.some(T=>O.from<T&&O.to>T));if(!w){if(p<g.to&&i&&n&&i.visibleRanges.some(O=>O.from<=p&&O.to>=p)){let O=i.moveToLineBoundary(et.cursor(p),!1,!0).head;O>f&&(p=O)}w=new zP(f,p,this.gapSize(g,f,p,y))}l.push(w)},d=f=>{if(f.length<a||f.type!=So.Text)return;let p=bVe(f.from,f.to,this.stateDeco);if(p.total<a)return;let g=this.scrollTarget?this.scrollTarget.range.head:null,y,x;if(n){let _=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,w,O;if(g!=null){let T=IO(p,g),C=((this.visibleBottom-this.visibleTop)/2+_)/f.height;w=T-C,O=T+C}else w=(this.visibleTop-f.top-_)/f.height,O=(this.visibleBottom-f.top+_)/f.height;y=PO(p,w),x=PO(p,O)}else{let _=p.total*this.heightOracle.charWidth,w=r*this.heightOracle.charWidth,O,T;if(g!=null){let C=IO(p,g),A=((this.pixelViewport.right-this.pixelViewport.left)/2+w)/_;O=C-A,T=C+A}else O=(this.pixelViewport.left-w)/_,T=(this.pixelViewport.right+w)/_;y=PO(p,O),x=PO(p,T)}y>f.from&&h(f.from,y,f,p),x<f.to&&h(x,f.to,f,p)};for(let f of this.viewportLines)Array.isArray(f.type)?f.type.forEach(d):d(f);return l}gapSize(e,i,n,r){let o=IO(r,n)-IO(r,i);return this.heightOracle.lineWrapping?e.height*o:r.total*this.heightOracle.charWidth*o}updateLineGaps(e){zP.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=fi.set(e.map(i=>i.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];fn.spans(e,this.viewport.from,this.viewport.to,{span(r,o){i.push({from:r,to:o})},point(){}},20);let n=i.length!=this.visibleRanges.length||this.visibleRanges.some((r,o)=>r.from!=i[o].from||r.to!=i[o].to);return this.visibleRanges=i,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(i=>i.from<=e&&i.to>=e)||Rx(this.heightMap.lineAt(e,jn.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(i=>i.top<=e&&i.bottom>=e)||Rx(this.heightMap.lineAt(this.scaler.fromDOM(e),jn.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let i=this.lineBlockAtHeight(e+8);return i.from>=this.viewport.from||this.viewportLines[0].top-e>200?i:this.viewportLines[0]}elementAtHeight(e){return Rx(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class kO{constructor(e,i){this.from=e,this.to=i}}function bVe(s,e,i){let n=[],r=s,o=0;return fn.spans(i,s,e,{span(){},point(a,l){a>r&&(n.push({from:r,to:a}),o+=a-r),r=l}},20),r<e&&(n.push({from:r,to:e}),o+=e-r),{total:o,ranges:n}}function PO({total:s,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(s*i);for(let r=0;;r++){let{from:o,to:a}=e[r],l=a-o;if(n<=l)return o+n;n-=l}}function IO(s,e){let i=0;for(let{from:n,to:r}of s.ranges){if(e<=r){i+=e-n;break}i+=r-n}return i/s.total}function wVe(s,e){for(let i of s)if(e(i))return i}const IX={toDOM(s){return s},fromDOM(s){return s},scale:1,eq(s){return s==this}};class E3{constructor(e,i,n){let r=0,o=0,a=0;this.viewports=n.map(({from:l,to:h})=>{let d=i.lineAt(l,jn.ByPos,e,0,0).top,f=i.lineAt(h,jn.ByPos,e,0,0).bottom;return r+=f-d,{from:l,to:h,top:d,bottom:f,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(i.height-r);for(let l of this.viewports)l.domTop=a+(l.top-o)*this.scale,a=l.domBottom=l.domTop+(l.bottom-l.top),o=l.bottom}toDOM(e){for(let i=0,n=0,r=0;;i++){let o=i<this.viewports.length?this.viewports[i]:null;if(!o||e<o.top)return r+(e-n)*this.scale;if(e<=o.bottom)return o.domTop+(e-o.top);n=o.bottom,r=o.domBottom}}fromDOM(e){for(let i=0,n=0,r=0;;i++){let o=i<this.viewports.length?this.viewports[i]:null;if(!o||e<o.domTop)return n+(e-r)/this.scale;if(e<=o.domBottom)return o.top+(e-o.domTop);n=o.bottom,r=o.domBottom}}eq(e){return e instanceof E3?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((i,n)=>i.from==e.viewports[n].from&&i.to==e.viewports[n].to):!1}}function Rx(s,e){if(e.scale==1)return s;let i=e.toDOM(s.top),n=e.toDOM(s.bottom);return new Hc(s.from,s.length,i,n-i,Array.isArray(s._content)?s._content.map(r=>Rx(r,e)):s._content)}const BO=Pt.define({combine:s=>s.join(" ")}),OR=Pt.define({combine:s=>s.indexOf(!0)>-1}),SR=of.newName(),FZ=of.newName(),zZ=of.newName(),XZ={"&light":"."+FZ,"&dark":"."+zZ};function CR(s,e,i){return new of(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,r=>{if(r=="&")return s;if(!i||!i[r])throw new RangeError(`Unsupported selector: ${r}`);return i[r]}):s+" "+n}})}const OVe=CR("."+SR,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},XZ),SVe={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},XP=Bt.ie&&Bt.ie_version<=11;class CVe{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new cNe,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(i=>{for(let n of i)this.queue.push(n);(Bt.ie&&Bt.ie_version<=11||Bt.ios&&e.composing)&&i.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(Bt.chrome&&Bt.chrome_version<126)&&(this.editContext=new AVe(e),e.state.facet(Dd)&&(e.contentDOM.editContext=this.editContext.editContext)),XP&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var i;((i=this.view.docView)===null||i===void 0?void 0:i.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(i=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),i.length>0&&i[i.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(i=>{i.length>0&&i[i.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((i,n)=>i!=e[n]))){this.gapIntersection.disconnect();for(let i of e)this.gapIntersection.observe(i);this.gaps=e}}onSelectionChange(e){let i=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,r=this.selectionRange;if(n.state.facet(Dd)?n.root.activeElement!=this.dom:!eC(n.dom,r))return;let o=r.anchorNode&&n.docView.nearest(r.anchorNode);if(o&&o.ignoreEvent(e)){i||(this.selectionChanged=!1);return}(Bt.ie&&Bt.ie_version<=11||Bt.android&&Bt.chrome)&&!n.state.selection.main.empty&&r.focusNode&&e_(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,i=Q_(e.root);if(!i)return!1;let n=Bt.safari&&e.root.nodeType==11&&rNe(this.dom.ownerDocument)==this.dom&&TVe(this.view,i)||i;if(!n||this.selectionRange.eq(n))return!1;let r=eC(this.dom,n);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&uNe(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,i){this.selectionRange.set(e.node,e.offset,i.node,i.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,i=null;for(let n=this.dom;n;)if(n.nodeType==1)!i&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:i||(i=this.scrollTargets.slice(0,e)),i&&i.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!i&&(i=this.scrollTargets.slice(0,e)),i){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=i)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,SVe),XP&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),XP&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,i){var n;if(!this.delayedAndroidKey){let r=()=>{let o=this.delayedAndroidKey;o&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=o.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&o.force&&H0(this.dom,o.key,o.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:i,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let i=-1,n=-1,r=!1;for(let o of e){let a=this.readMutation(o);a&&(a.typeOver&&(r=!0),i==-1?{from:i,to:n}=a:(i=Math.min(a.from,i),n=Math.max(a.to,n)))}return{from:i,to:n,typeOver:r}}readChange(){let{from:e,to:i,typeOver:n}=this.processRecords(),r=this.selectionChanged&&eC(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let o=new WNe(this.view,e,i,n);return this.view.docView.domChanged={newSel:o.newSel?o.newSel.main:null},o}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let i=this.readChange();if(!i)return this.view.requestMeasure(),!1;let n=this.view.state,r=PZ(this.view,i);return this.view.state==n&&(i.domChanged||i.newSel&&!i.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let i=this.view.docView.nearest(e.target);if(!i||i.ignoreMutation(e))return null;if(i.markDirty(e.type=="attributes"),e.type=="attributes"&&(i.flags|=4),e.type=="childList"){let n=BX(i,e.previousSibling||e.target.previousSibling,-1),r=BX(i,e.nextSibling||e.target.nextSibling,1);return{from:n?i.posAfter(n):i.posAtStart,to:r?i.posBefore(r):i.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:i.posAtStart,to:i.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Dd)!=e.state.facet(Dd)&&(e.view.contentDOM.editContext=e.state.facet(Dd)?this.editContext.editContext:null))}destroy(){var e,i,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(i=this.gapIntersection)===null||i===void 0||i.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function BX(s,e,i){for(;e;){let n=Fn.get(e);if(n&&n.parent==s)return n;let r=e.parentNode;e=r!=s.dom?r:i>0?e.nextSibling:e.previousSibling}return null}function RX(s,e){let i=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset,a=s.docView.domAtPos(s.state.selection.main.anchor);return e_(a.node,a.offset,r,o)&&([i,n,r,o]=[r,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:o}}function TVe(s,e){if(e.getComposedRanges){let r=e.getComposedRanges(s.root)[0];if(r)return RX(s,r)}let i=null;function n(r){r.preventDefault(),r.stopImmediatePropagation(),i=r.getTargetRanges()[0]}return s.contentDOM.addEventListener("beforeinput",n,!0),s.dom.ownerDocument.execCommand("indent"),s.contentDOM.removeEventListener("beforeinput",n,!0),i?RX(s,i):null}class AVe{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.resetRange(e.state);let i=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let{anchor:r}=e.state.selection.main,o={from:this.toEditorPos(n.updateRangeStart),to:this.toEditorPos(n.updateRangeEnd),insert:yn.of(n.text.split(`
`))};o.from==this.from&&r<this.from?o.from=r:o.to==this.to&&r>this.to&&(o.to=r),!(o.from==o.to&&!o.insert.length)&&(this.pendingContextChange=o,e.state.readOnly||T3(e,o,et.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd))),this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)))},this.handlers.characterboundsupdate=n=>{let r=[],o=null;for(let a=this.toEditorPos(n.rangeStart),l=this.toEditorPos(n.rangeEnd);a<l;a++){let h=e.coordsForChar(a);o=h&&new DOMRect(h.left,h.top,h.right-h.left,h.bottom-h.top)||o||new DOMRect,r.push(o)}i.updateCharacterBounds(n.rangeStart,r)},this.handlers.textformatupdate=n=>{let r=[];for(let o of n.getTextFormats()){let a=o.underlineStyle,l=o.underlineThickness;if(a!="None"&&l!="None"){let h=`text-decoration: underline ${a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;r.push(fi.mark({attributes:{style:h}}).range(this.toEditorPos(o.rangeStart),this.toEditorPos(o.rangeEnd)))}}e.dispatch({effects:OZ.of(fi.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{e.inputState.composing=-1,e.inputState.compositionFirstChange=null};for(let n in this.handlers)i.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let r=Q_(n.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let i=0,n=!1,r=this.pendingContextChange;return e.changes.iterChanges((o,a,l,h,d)=>{if(n)return;let f=d.length-(a-o);if(r&&a>=r.to)if(r.from==o&&r.to==a&&r.insert.eq(d)){r=this.pendingContextChange=null,i+=f,this.to+=f;return}else r=null,this.revertPending(e.state);if(o+=i,a+=i,a<=this.from)this.from+=f,this.to+=f;else if(o<this.to){if(o<this.from||a>this.to||this.to-this.from+d.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(o),this.toContextPos(a),d.toString()),this.to+=f}i+=f}),r&&!n&&this.revertPending(e.state),!n}update(e){let i=this.pendingContextChange;!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.resetRange(e.state),this.editContext.updateText(0,this.editContext.text.length,e.state.doc.sliceString(this.from,this.to)),this.setSelection(e.state)):(e.docChanged||e.selectionSet||i)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:i}=e.selection.main;this.from=Math.max(0,i-1e4),this.to=Math.min(e.doc.length,i+1e4)}revertPending(e){let i=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(i.from),this.toContextPos(i.from+i.insert.length),e.doc.sliceString(i.from,i.to))}setSelection(e){let{main:i}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,i.anchor))),r=this.toContextPos(i.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(n,r)}rangeIsValid(e){let{head:i}=e.selection.main;return!(this.from>0&&i-this.from<500||this.to<e.doc.length&&this.to-i<500||this.to-this.from>1e4*3)}toEditorPos(e){return e+this.from}toContextPos(e){return e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Ot{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var i;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(r=>r.forEach(o=>n(o,this)))||(r=>this.update(r)),this.dispatch=this.dispatch.bind(this),this._root=e.root||hNe(e.parent)||document,this.viewState=new PX(e.state||gn.create(e)),e.scrollTo&&e.scrollTo.is(AO)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Px).map(r=>new $P(r));for(let r of this.plugins)r.update(this);this.observer=new CVe(this),this.inputState=new jNe(this),this.inputState.ensureHandlers(this.plugins),this.docView=new dX(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((i=document.fonts)===null||i===void 0)&&i.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let i=e.length==1&&e[0]instanceof cr?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(i,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let i=!1,n=!1,r,o=this.state;for(let g of e){if(g.startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=g.state}if(this.destroyed){this.viewState.state=o;return}let a=this.hasFocus,l=0,h=null;e.some(g=>g.annotation(NZ))?(this.inputState.notifiedFocused=a,l=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,h=VZ(o,a),h||(l=1));let d=this.observer.delayedAndroidKey,f=null;if(d?(this.observer.clearDelayedAndroidKey(),f=this.observer.readChange(),(f&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(f=null)):this.observer.clear(),o.facet(gn.phrases)!=this.state.facet(gn.phrases))return this.setState(o);r=sT.create(this,o,e),r.flags|=l;let p=this.viewState.scrollTarget;try{this.updateState=2;for(let g of e){if(p&&(p=p.map(g.changes)),g.scrollIntoView){let{main:y}=g.state.selection;p=new G0(y.empty?y:et.cursor(y.head,y.head>y.anchor?-1:1))}for(let y of g.effects)y.is(AO)&&(p=y.value.clip(this.state))}this.viewState.update(r,p),this.bidiCache=oT.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),i=this.docView.update(r),this.state.facet(Ix)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(i,e.some(g=>g.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(BO)!=r.state.facet(BO)&&(this.viewState.mustMeasureContent=!0),(i||n||p||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!r.empty)for(let g of this.state.facet(xR))try{g(r)}catch(y){Ko(this.state,y,"update listener")}(h||f)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),f&&!PZ(this,f)&&d.force&&H0(this.contentDOM,d.key,d.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let i=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new PX(e),this.plugins=e.facet(Px).map(n=>new $P(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new dX(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}updatePlugins(e){let i=e.startState.facet(Px),n=e.state.facet(Px);if(i!=n){let r=[];for(let o of n){let a=i.indexOf(o);if(a<0)r.push(new $P(o));else{let l=this.plugins[a];l.mustUpdate=e,r.push(l)}}for(let o of this.plugins)o.mustUpdate!=e&&o.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);i!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let i=e.value;if(i&&i.docViewUpdate)try{i.docViewUpdate(this)}catch(n){Ko(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let i=null,n=this.scrollDOM,r=n.scrollTop*this.scaleY,{scrollAnchorPos:o,scrollAnchorHeight:a}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(a<0)if(Zq(n))o=-1,a=this.viewState.heightMap.height;else{let y=this.viewState.scrollAnchorAt(r);o=y.from,a=y.top}this.updateState=1;let h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let d=[];h&4||([this.measureRequests,d]=[d,this.measureRequests]);let f=d.map(y=>{try{return y.read(this)}catch(x){return Ko(this.state,x),DX}}),p=sT.create(this,this.state,[]),g=!1;p.flags|=h,i?i.flags|=h:i=p,this.updateState=2,p.empty||(this.updatePlugins(p),this.inputState.update(p),this.updateAttrs(),g=this.docView.update(p),g&&this.docViewUpdate());for(let y=0;y<d.length;y++)if(f[y]!=DX)try{let x=d[y];x.write&&x.write(f[y],this)}catch(x){Ko(this.state,x)}if(g&&this.docView.updateSelection(!0),!p.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let x=(o<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(o).top)-a;if(x>1||x<-1){r=r+x,n.scrollTop=r/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(i&&!i.empty)for(let l of this.state.facet(xR))l(i)}get themeClasses(){return SR+" "+(this.state.facet(OR)?zZ:FZ)+" "+this.state.facet(BO)}updateAttrs(){let e=LX(this,SZ,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),i={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Dd)?"true":"false",class:"cm-content",style:`${Bt.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(i["aria-readonly"]="true"),LX(this,S3,i);let n=this.observer.ignore(()=>{let r=fR(this.contentDOM,this.contentAttrs,i),o=fR(this.dom,this.editorAttrs,e);return r||o});return this.editorAttrs=e,this.contentAttrs=i,n}showAnnouncements(e){let i=!0;for(let n of e)for(let r of n.effects)if(r.is(Ot.announce)){i&&(this.announceDOM.textContent=""),i=!1;let o=this.announceDOM.appendChild(document.createElement("div"));o.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(Ix);let e=this.state.facet(Ot.cspNonce);of.mount(this.root,this.styleModules.concat(OVe).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===e.key){this.measureRequests[i]=e;return}}this.measureRequests.push(e)}}plugin(e){let i=this.pluginMap.get(e);return(i===void 0||i&&i.spec!=e)&&this.pluginMap.set(e,i=this.plugins.find(n=>n.spec==e)||null),i&&i.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,i,n){return FP(this,e,yX(this,e,i,n))}moveByGroup(e,i){return FP(this,e,yX(this,e,i,n=>UNe(this,e.head,n)))}visualLineSide(e,i){let n=this.bidiSpans(e),r=this.textDirectionAt(e.from),o=n[i?n.length-1:0];return et.cursor(o.side(i,r)+e.from,o.forward(!i,r)?1:-1)}moveToLineBoundary(e,i,n=!0){return $Ne(this,e,i,n)}moveVertically(e,i,n){return FP(this,e,FNe(this,e,i,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,i=0){return this.docView.posFromDOM(e,i)}posAtCoords(e,i=!0){return this.readMeasured(),kZ(this,e,i)}coordsAtPos(e,i=1){this.readMeasured();let n=this.docView.coordsAt(e,i);if(!n||n.left==n.right)return n;let r=this.state.doc.lineAt(e),o=this.bidiSpans(r),a=o[Wd.find(o,e-r.from,-1,i)];return JA(n,a.dir==Jn.LTR==i>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(_Z)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>EVe)return dZ(e.length);let i=this.textDirectionAt(e.from),n;for(let o of this.bidiCache)if(o.from==e.from&&o.dir==i&&(o.fresh||uZ(o.isolates,n=uX(this,e))))return o.order;n||(n=uX(this,e));let r=ONe(e.text,i,n);return this.bidiCache.push(new oT(e.from,e.to,i,n,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Bt.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{jq(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,i={}){return AO.of(new G0(typeof e=="number"?et.cursor(e):e,i.y,i.x,i.yMargin,i.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:i}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return AO.of(new G0(et.cursor(n.from),"start","start",n.top-e,i,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return js.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return js.define(()=>({}),{eventObservers:e})}static theme(e,i){let n=of.newName(),r=[BO.of(n),Ix.of(CR(`.${n}`,e))];return i&&i.dark&&r.push(OR.of(!0)),r}static baseTheme(e){return Rm.lowest(Ix.of(CR("."+SR,e,XZ)))}static findFromDOM(e){var i;let n=e.querySelector(".cm-content"),r=n&&Fn.get(n)||Fn.get(e);return((i=r==null?void 0:r.rootView)===null||i===void 0?void 0:i.view)||null}}Ot.styleModule=Ix;Ot.inputHandler=vZ;Ot.clipboardInputFilter=w3;Ot.clipboardOutputFilter=O3;Ot.scrollHandler=wZ;Ot.focusChangeEffect=xZ;Ot.perLineTextDirection=_Z;Ot.exceptionSink=yZ;Ot.updateListener=xR;Ot.editable=Dd;Ot.mouseSelectionStyle=gZ;Ot.dragMovesSelection=mZ;Ot.clickAddsSelectionRange=pZ;Ot.decorations=j_;Ot.outerDecorations=CZ;Ot.atomicRanges=C3;Ot.bidiIsolatedRanges=TZ;Ot.scrollMargins=AZ;Ot.darkTheme=OR;Ot.cspNonce=Pt.define({combine:s=>s.length?s[0]:""});Ot.contentAttributes=S3;Ot.editorAttributes=SZ;Ot.lineWrapping=Ot.contentAttributes.of({class:"cm-lineWrapping"});Ot.announce=Fi.define();const EVe=4096,DX={};class oT{constructor(e,i,n,r,o,a){this.from=e,this.to=i,this.dir=n,this.isolates=r,this.fresh=o,this.order=a}static update(e,i){if(i.empty&&!e.some(o=>o.fresh))return e;let n=[],r=e.length?e[e.length-1].dir:Jn.LTR;for(let o=Math.max(0,e.length-10);o<e.length;o++){let a=e[o];a.dir==r&&!i.touchesRange(a.from,a.to)&&n.push(new oT(i.mapPos(a.from,1),i.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return n}}function LX(s,e,i){for(let n=s.state.facet(e),r=n.length-1;r>=0;r--){let o=n[r],a=typeof o=="function"?o(s):o;a&&dR(a,i)}return i}const MVe=Bt.mac?"mac":Bt.windows?"win":Bt.linux?"linux":"key";function kVe(s,e){const i=s.split(/-(?!$)/);let n=i[i.length-1];n=="Space"&&(n=" ");let r,o,a,l;for(let h=0;h<i.length-1;++h){const d=i[h];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))o=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))e=="mac"?l=!0:o=!0;else throw new Error("Unrecognized modifier name: "+d)}return r&&(n="Alt-"+n),o&&(n="Ctrl-"+n),l&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function RO(s,e,i){return e.altKey&&(s="Alt-"+s),e.ctrlKey&&(s="Ctrl-"+s),e.metaKey&&(s="Meta-"+s),i!==!1&&e.shiftKey&&(s="Shift-"+s),s}const PVe=Rm.default(Ot.domEventHandlers({keydown(s,e){return HZ(WZ(e.state),s,e,"editor")}})),M3=Pt.define({enables:PVe}),NX=new WeakMap;function WZ(s){let e=s.facet(M3),i=NX.get(e);return i||NX.set(e,i=RVe(e.reduce((n,r)=>n.concat(r),[]))),i}function IVe(s,e,i){return HZ(WZ(s.state),e,s,i)}let Ld=null;const BVe=4e3;function RVe(s,e=MVe){let i=Object.create(null),n=Object.create(null),r=(a,l)=>{let h=n[a];if(h==null)n[a]=l;else if(h!=l)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},o=(a,l,h,d,f)=>{var p,g;let y=i[a]||(i[a]=Object.create(null)),x=l.split(/ (?!$)/).map(O=>kVe(O,e));for(let O=1;O<x.length;O++){let T=x.slice(0,O).join(" ");r(T,!0),y[T]||(y[T]={preventDefault:!0,stopPropagation:!1,run:[C=>{let A=Ld={view:C,prefix:T,scope:a};return setTimeout(()=>{Ld==A&&(Ld=null)},BVe),!0}]})}let _=x.join(" ");r(_,!1);let w=y[_]||(y[_]={preventDefault:!1,stopPropagation:!1,run:((g=(p=y._any)===null||p===void 0?void 0:p.run)===null||g===void 0?void 0:g.slice())||[]});h&&w.run.push(h),d&&(w.preventDefault=!0),f&&(w.stopPropagation=!0)};for(let a of s){let l=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let d of l){let f=i[d]||(i[d]=Object.create(null));f._any||(f._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:p}=a;for(let g in f)f[g].run.push(y=>p(y,TR))}let h=a[e]||a.key;if(h)for(let d of l)o(d,h,a.run,a.preventDefault,a.stopPropagation),a.shift&&o(d,"Shift-"+h,a.shift,a.preventDefault,a.stopPropagation)}return i}let TR=null;function HZ(s,e,i,n){TR=e;let r=sNe(e),o=kr(r,0),a=al(o)==r.length&&r!=" ",l="",h=!1,d=!1,f=!1;Ld&&Ld.view==i&&Ld.scope==n&&(l=Ld.prefix+" ",BZ.indexOf(e.keyCode)<0&&(d=!0,Ld=null));let p=new Set,g=w=>{if(w){for(let O of w.run)if(!p.has(O)&&(p.add(O),O(i)))return w.stopPropagation&&(f=!0),!0;w.preventDefault&&(w.stopPropagation&&(f=!0),d=!0)}return!1},y=s[n],x,_;return y&&(g(y[l+RO(r,e,!a)])?h=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Bt.windows&&e.ctrlKey&&e.altKey)&&(x=af[e.keyCode])&&x!=r?(g(y[l+RO(x,e,!0)])||e.shiftKey&&(_=G_[e.keyCode])!=r&&_!=x&&g(y[l+RO(_,e,!1)]))&&(h=!0):a&&e.shiftKey&&g(y[l+RO(r,e,!0)])&&(h=!0),!h&&g(y._any)&&(h=!0)),d&&(h=!0),h&&f&&e.stopPropagation(),TR=null,h}class zb{constructor(e,i,n,r,o){this.className=e,this.left=i,this.top=n,this.width=r,this.height=o}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,i){return i.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,i,n){if(n.empty){let r=e.coordsAtPos(n.head,n.assoc||1);if(!r)return[];let o=GZ(e);return[new zb(i,r.left-o.left,r.top-o.top,null,r.bottom-r.top)]}else return DVe(e,i,n)}}function GZ(s){let e=s.scrollDOM.getBoundingClientRect();return{left:(s.textDirection==Jn.LTR?e.left:e.right-s.scrollDOM.clientWidth*s.scaleX)-s.scrollDOM.scrollLeft*s.scaleX,top:e.top-s.scrollDOM.scrollTop*s.scaleY}}function VX(s,e,i,n){let r=s.coordsAtPos(e,i*2);if(!r)return n;let o=s.dom.getBoundingClientRect(),a=(r.top+r.bottom)/2,l=s.posAtCoords({x:o.left+1,y:a}),h=s.posAtCoords({x:o.right-1,y:a});return l==null||h==null?n:{from:Math.max(n.from,Math.min(l,h)),to:Math.min(n.to,Math.max(l,h))}}function DVe(s,e,i){if(i.to<=s.viewport.from||i.from>=s.viewport.to)return[];let n=Math.max(i.from,s.viewport.from),r=Math.min(i.to,s.viewport.to),o=s.textDirection==Jn.LTR,a=s.contentDOM,l=a.getBoundingClientRect(),h=GZ(s),d=a.querySelector(".cm-line"),f=d&&window.getComputedStyle(d),p=l.left+(f?parseInt(f.paddingLeft)+Math.min(0,parseInt(f.textIndent)):0),g=l.right-(f?parseInt(f.paddingRight):0),y=bR(s,n),x=bR(s,r),_=y.type==So.Text?y:null,w=x.type==So.Text?x:null;if(_&&(s.lineWrapping||y.widgetLineBreaks)&&(_=VX(s,n,1,_)),w&&(s.lineWrapping||x.widgetLineBreaks)&&(w=VX(s,r,-1,w)),_&&w&&_.from==w.from&&_.to==w.to)return T(C(i.from,i.to,_));{let B=_?C(i.from,null,_):A(y,!1),I=w?C(null,i.to,w):A(x,!0),R=[];return(_||y).to<(w||x).from-(_&&w?1:0)||y.widgetLineBreaks>1&&B.bottom+s.defaultLineHeight/2<I.top?R.push(O(p,B.bottom,g,I.top)):B.bottom<I.top&&s.elementAtHeight((B.bottom+I.top)/2).type==So.Text&&(B.bottom=I.top=(B.bottom+I.top)/2),T(B).concat(R).concat(T(I))}function O(B,I,R,P){return new zb(e,B-h.left,I-h.top-.01,R-B,P-I+.01)}function T({top:B,bottom:I,horizontal:R}){let P=[];for(let k=0;k<R.length;k+=2)P.push(O(R[k],B,R[k+1],I));return P}function C(B,I,R){let P=1e9,k=-1e9,E=[];function D(F,j,Q,ee,J){let ue=s.coordsAtPos(F,F==R.to?-2:2),oe=s.coordsAtPos(Q,Q==R.from?2:-2);!ue||!oe||(P=Math.min(ue.top,oe.top,P),k=Math.max(ue.bottom,oe.bottom,k),J==Jn.LTR?E.push(o&&j?p:ue.left,o&&ee?g:oe.right):E.push(!o&&ee?p:oe.left,!o&&j?g:ue.right))}let L=B??R.from,V=I??R.to;for(let F of s.visibleRanges)if(F.to>L&&F.from<V)for(let j=Math.max(F.from,L),Q=Math.min(F.to,V);;){let ee=s.state.doc.lineAt(j);for(let J of s.bidiSpans(ee)){let ue=J.from+ee.from,oe=J.to+ee.from;if(ue>=Q)break;oe>j&&D(Math.max(ue,j),B==null&&ue<=L,Math.min(oe,Q),I==null&&oe>=V,J.dir)}if(j=ee.to+1,j>=Q)break}return E.length==0&&D(L,B==null,V,I==null,s.textDirection),{top:P,bottom:k,horizontal:E}}function A(B,I){let R=l.top+(I?B.top:B.bottom);return{top:R,bottom:R,horizontal:[]}}}function LVe(s,e){return s.constructor==e.constructor&&s.eq(e)}class NVe{constructor(e,i){this.view=e,this.layer=i,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),i.above&&this.dom.classList.add("cm-layer-above"),i.class&&this.dom.classList.add(i.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),i.mount&&i.mount(this.dom,e)}update(e){e.startState.facet(nC)!=e.state.facet(nC)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let i=0,n=e.facet(nC);for(;i<n.length&&n[i]!=this.layer;)i++;this.dom.style.zIndex=String((this.layer.above?150:-1)-i)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:i}=this.view;(e!=this.scaleX||i!=this.scaleY)&&(this.scaleX=e,this.scaleY=i,this.dom.style.transform=`scale(${1/e}, ${1/i})`)}draw(e){if(e.length!=this.drawn.length||e.some((i,n)=>!LVe(i,this.drawn[n]))){let i=this.dom.firstChild,n=0;for(let r of e)r.update&&i&&r.constructor&&this.drawn[n].constructor&&r.update(i,this.drawn[n])?(i=i.nextSibling,n++):this.dom.insertBefore(r.draw(),i);for(;i;){let r=i.nextSibling;i.remove(),i=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const nC=Pt.define();function QZ(s){return[js.define(e=>new NVe(e,s)),nC.of(s)]}const YZ=!Bt.ios,q_=Pt.define({combine(s){return fh(s,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,i)=>Math.min(e,i),drawRangeCursor:(e,i)=>e||i})}});function VVe(s={}){return[q_.of(s),$Ve,UVe,FVe,bZ.of(!0)]}function jZ(s){return s.startState.facet(q_)!=s.state.facet(q_)}const $Ve=QZ({above:!0,markers(s){let{state:e}=s,i=e.facet(q_),n=[];for(let r of e.selection.ranges){let o=r==e.selection.main;if(r.empty?!o||YZ:i.drawRangeCursor){let a=o?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=r.empty?r:et.cursor(r.head,r.head>r.anchor?-1:1);for(let h of zb.forRange(s,a,l))n.push(h)}}return n},update(s,e){s.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let i=jZ(s);return i&&$X(s.state,e),s.docChanged||s.selectionSet||i},mount(s,e){$X(e.state,s)},class:"cm-cursorLayer"});function $X(s,e){e.style.animationDuration=s.facet(q_).cursorBlinkRate+"ms"}const UVe=QZ({above:!1,markers(s){return s.state.selection.ranges.map(e=>e.empty?[]:zb.forRange(s,"cm-selectionBackground",e)).reduce((e,i)=>e.concat(i))},update(s,e){return s.docChanged||s.selectionSet||s.viewportChanged||jZ(s)},class:"cm-selectionLayer"}),AR={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};YZ&&(AR[".cm-line"].caretColor=AR[".cm-content"].caretColor="transparent !important");const FVe=Rm.highest(Ot.theme(AR)),qZ=Fi.define({map(s,e){return s==null?null:e.mapPos(s)}}),Dx=$r.define({create(){return null},update(s,e){return s!=null&&(s=e.changes.mapPos(s)),e.effects.reduce((i,n)=>n.is(qZ)?n.value:i,s)}}),zVe=js.fromClass(class{constructor(s){this.view=s,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(s){var e;let i=s.state.field(Dx);i==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(s.startState.field(Dx)!=i||s.docChanged||s.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:s}=this,e=s.state.field(Dx),i=e!=null&&s.coordsAtPos(e);if(!i)return null;let n=s.scrollDOM.getBoundingClientRect();return{left:i.left-n.left+s.scrollDOM.scrollLeft*s.scaleX,top:i.top-n.top+s.scrollDOM.scrollTop*s.scaleY,height:i.bottom-i.top}}drawCursor(s){if(this.cursor){let{scaleX:e,scaleY:i}=this.view;s?(this.cursor.style.left=s.left/e+"px",this.cursor.style.top=s.top/i+"px",this.cursor.style.height=s.height/i+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(s){this.view.state.field(Dx)!=s&&this.view.dispatch({effects:qZ.of(s)})}},{eventObservers:{dragover(s){this.setDropPos(this.view.posAtCoords({x:s.clientX,y:s.clientY}))},dragleave(s){(s.target==this.view.contentDOM||!this.view.contentDOM.contains(s.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function XVe(){return[Dx,zVe]}function UX(s,e,i,n,r){e.lastIndex=0;for(let o=s.iterRange(i,n),a=i,l;!o.next().done;a+=o.value.length)if(!o.lineBreak)for(;l=e.exec(o.value);)r(a+l.index,l)}function WVe(s,e){let i=s.visibleRanges;if(i.length==1&&i[0].from==s.viewport.from&&i[0].to==s.viewport.to)return i;let n=[];for(let{from:r,to:o}of i)r=Math.max(s.state.doc.lineAt(r).from,r-e),o=Math.min(s.state.doc.lineAt(o).to,o+e),n.length&&n[n.length-1].to>=r?n[n.length-1].to=o:n.push({from:r,to:o});return n}class HVe{constructor(e){const{regexp:i,decoration:n,decorate:r,boundary:o,maxLength:a=1e3}=e;if(!i.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=i,r)this.addMatch=(l,h,d,f)=>r(f,d,d+l[0].length,l,h);else if(typeof n=="function")this.addMatch=(l,h,d,f)=>{let p=n(l,h,d);p&&f(d,d+l[0].length,p)};else if(n)this.addMatch=(l,h,d,f)=>f(d,d+l[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=o,this.maxLength=a}createDeco(e){let i=new rf,n=i.add.bind(i);for(let{from:r,to:o}of WVe(e,this.maxLength))UX(e.state.doc,this.regexp,r,o,(a,l)=>this.addMatch(l,e,a,n));return i.finish()}updateDeco(e,i){let n=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((o,a,l,h)=>{h>e.view.viewport.from&&l<e.view.viewport.to&&(n=Math.min(l,n),r=Math.max(h,r))}),e.viewportChanged||r-n>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,i.map(e.changes),n,r):i}updateRange(e,i,n,r){for(let o of e.visibleRanges){let a=Math.max(o.from,n),l=Math.min(o.to,r);if(l>a){let h=e.state.doc.lineAt(a),d=h.to<l?e.state.doc.lineAt(l):h,f=Math.max(o.from,h.from),p=Math.min(o.to,d.to);if(this.boundary){for(;a>h.from;a--)if(this.boundary.test(h.text[a-1-h.from])){f=a;break}for(;l<d.to;l++)if(this.boundary.test(d.text[l-d.from])){p=l;break}}let g=[],y,x=(_,w,O)=>g.push(O.range(_,w));if(h==d)for(this.regexp.lastIndex=f-h.from;(y=this.regexp.exec(h.text))&&y.index<p-h.from;)this.addMatch(y,e,y.index+h.from,x);else UX(e.state.doc,this.regexp,f,p,(_,w)=>this.addMatch(w,e,_,x));i=i.update({filterFrom:f,filterTo:p,filter:(_,w)=>_<f||w>p,add:g})}}return i}}const ER=/x/.unicode!=null?"gu":"g",GVe=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,ER),QVe={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let WP=null;function YVe(){var s;if(WP==null&&typeof document<"u"&&document.body){let e=document.body.style;WP=((s=e.tabSize)!==null&&s!==void 0?s:e.MozTabSize)!=null}return WP||!1}const sC=Pt.define({combine(s){let e=fh(s,{render:null,specialChars:GVe,addSpecialChars:null});return(e.replaceTabs=!YVe())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,ER)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,ER)),e}});function jVe(s={}){return[sC.of(s),qVe()]}let FX=null;function qVe(){return FX||(FX=js.fromClass(class{constructor(s){this.view=s,this.decorations=fi.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(s.state.facet(sC)),this.decorations=this.decorator.createDeco(s)}makeDecorator(s){return new HVe({regexp:s.specialChars,decoration:(e,i,n)=>{let{doc:r}=i.state,o=kr(e[0],0);if(o==9){let a=r.lineAt(n),l=i.state.tabSize,h=$y(a.text,l,n-a.from);return fi.replace({widget:new e$e((l-h%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[o]||(this.decorationCache[o]=fi.replace({widget:new JVe(s,o)}))},boundary:s.replaceTabs?void 0:/[^]/})}update(s){let e=s.state.facet(sC);s.startState.facet(sC)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(s.view)):this.decorations=this.decorator.updateDeco(s,this.decorations)}},{decorations:s=>s.decorations}))}const ZVe="";function KVe(s){return s>=32?ZVe:s==10?"":String.fromCharCode(9216+s)}class JVe extends Of{constructor(e,i){super(),this.options=e,this.code=i}eq(e){return e.code==this.code}toDOM(e){let i=KVe(this.code),n=e.state.phrase("Control character")+" "+(QVe[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,n,i);if(r)return r;let o=document.createElement("span");return o.textContent=i,o.title=n,o.setAttribute("aria-label",n),o.className="cm-specialChar",o}ignoreEvent(){return!1}}class e$e extends Of{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function t$e(){return n$e}const i$e=fi.line({class:"cm-activeLine"}),n$e=js.fromClass(class{constructor(s){this.decorations=this.getDeco(s)}update(s){(s.docChanged||s.selectionSet)&&(this.decorations=this.getDeco(s.view))}getDeco(s){let e=-1,i=[];for(let n of s.state.selection.ranges){let r=s.lineBlockAt(n.head);r.from>e&&(i.push(i$e.range(r.from)),e=r.from)}return fi.set(i)}},{decorations:s=>s.decorations}),MR=2e3;function s$e(s,e,i){let n=Math.min(e.line,i.line),r=Math.max(e.line,i.line),o=[];if(e.off>MR||i.off>MR||e.col<0||i.col<0){let a=Math.min(e.off,i.off),l=Math.max(e.off,i.off);for(let h=n;h<=r;h++){let d=s.doc.line(h);d.length<=l&&o.push(et.range(d.from+a,d.to+l))}}else{let a=Math.min(e.col,i.col),l=Math.max(e.col,i.col);for(let h=n;h<=r;h++){let d=s.doc.line(h),f=rR(d.text,a,s.tabSize,!0);if(f<0)o.push(et.cursor(d.to));else{let p=rR(d.text,l,s.tabSize);o.push(et.range(d.from+f,d.from+p))}}}return o}function r$e(s,e){let i=s.coordsAtPos(s.viewport.from);return i?Math.round(Math.abs((i.left-e)/s.defaultCharacterWidth)):-1}function zX(s,e){let i=s.posAtCoords({x:e.clientX,y:e.clientY},!1),n=s.state.doc.lineAt(i),r=i-n.from,o=r>MR?-1:r==n.length?r$e(s,e.clientX):$y(n.text,s.state.tabSize,i-n.from);return{line:n.number,col:o,off:r}}function o$e(s,e){let i=zX(s,e),n=s.state.selection;return i?{update(r){if(r.docChanged){let o=r.changes.mapPos(r.startState.doc.line(i.line).from),a=r.state.doc.lineAt(o);i={line:a.number,col:i.col,off:Math.min(i.off,a.length)},n=n.map(r.changes)}},get(r,o,a){let l=zX(s,r);if(!l)return n;let h=s$e(s.state,i,l);return h.length?a?et.create(h.concat(n.ranges)):et.create(h):n}}:null}function a$e(s){let e=i=>i.altKey&&i.button==0;return Ot.mouseSelectionStyle.of((i,n)=>e(n)?o$e(i,n):null)}const l$e={Alt:[18,s=>!!s.altKey],Control:[17,s=>!!s.ctrlKey],Shift:[16,s=>!!s.shiftKey],Meta:[91,s=>!!s.metaKey]},c$e={style:"cursor: crosshair"};function h$e(s={}){let[e,i]=l$e[s.key||"Alt"],n=js.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==e||i(r))},keyup(r){(r.keyCode==e||!i(r))&&this.set(!1)},mousemove(r){this.set(i(r))}}});return[n,Ot.contentAttributes.of(r=>{var o;return!((o=r.plugin(n))===null||o===void 0)&&o.isDown?c$e:null})]}const ex="-10000px";class ZZ{constructor(e,i,n,r){this.facet=i,this.createTooltipView=n,this.removeTooltipView=r,this.input=e.state.facet(i),this.tooltips=this.input.filter(a=>a);let o=null;this.tooltipViews=this.tooltips.map(a=>o=n(a,o))}update(e,i){var n;let r=e.state.facet(this.facet),o=r.filter(h=>h);if(r===this.input){for(let h of this.tooltipViews)h.update&&h.update(e);return!1}let a=[],l=i?[]:null;for(let h=0;h<o.length;h++){let d=o[h],f=-1;if(d){for(let p=0;p<this.tooltips.length;p++){let g=this.tooltips[p];g&&g.create==d.create&&(f=p)}if(f<0)a[h]=this.createTooltipView(d,h?a[h-1]:null),l&&(l[h]=!!d.above);else{let p=a[h]=this.tooltipViews[f];l&&(l[h]=i[f]),p.update&&p.update(e)}}}for(let h of this.tooltipViews)a.indexOf(h)<0&&(this.removeTooltipView(h),(n=h.destroy)===null||n===void 0||n.call(h));return i&&(l.forEach((h,d)=>i[d]=h),i.length=l.length),this.input=r,this.tooltips=o,this.tooltipViews=a,!0}}function u$e(s){let{win:e}=s;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const HP=Pt.define({combine:s=>{var e,i,n;return{position:Bt.ios?"absolute":((e=s.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((i=s.find(r=>r.parent))===null||i===void 0?void 0:i.parent)||null,tooltipSpace:((n=s.find(r=>r.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||u$e}}}),XX=new WeakMap,k3=js.fromClass(class{constructor(s){this.view=s,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=s.state.facet(HP);this.position=e.position,this.parent=e.parent,this.classes=s.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new ZZ(s,P3,(i,n)=>this.createTooltip(i,n),i=>{this.resizeObserver&&this.resizeObserver.unobserve(i.dom),i.dom.remove()}),this.above=this.manager.tooltips.map(i=>!!i.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(i=>{Date.now()>this.lastTransaction-50&&i.length>0&&i[i.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),s.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let s of this.manager.tooltipViews)this.intersectionObserver.observe(s.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(s){s.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(s,this.above);e&&this.observeIntersection();let i=e||s.geometryChanged,n=s.state.facet(HP);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;i=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(s,e){let i=s.create(this.view),n=e?e.dom:null;if(i.dom.classList.add("cm-tooltip"),s.arrow&&!i.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",i.dom.appendChild(r)}return i.dom.style.position=this.position,i.dom.style.top=ex,i.dom.style.left="0px",this.container.insertBefore(i.dom,n),i.mount&&i.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(i.dom),i}destroy(){var s,e,i;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(s=n.destroy)===null||s===void 0||s.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(i=this.intersectionObserver)===null||i===void 0||i.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let s=this.view.dom.getBoundingClientRect(),e=1,i=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(Bt.gecko)n=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==ex&&r.style.left=="0px"){let o=r.getBoundingClientRect();n=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(n||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(e=r.width/this.parent.offsetWidth,i=r.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:i}=this.view.viewState);return{editor:s,parent:this.parent?this.container.getBoundingClientRect():s,pos:this.manager.tooltips.map((r,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(HP).tooltipSpace(this.view),scaleX:e,scaleY:i,makeAbsolute:n}}writeMeasure(s){var e;if(s.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{editor:i,space:n,scaleX:r,scaleY:o}=s,a=[];for(let l=0;l<this.manager.tooltips.length;l++){let h=this.manager.tooltips[l],d=this.manager.tooltipViews[l],{dom:f}=d,p=s.pos[l],g=s.size[l];if(!p||p.bottom<=Math.max(i.top,n.top)||p.top>=Math.min(i.bottom,n.bottom)||p.right<Math.max(i.left,n.left)-.1||p.left>Math.min(i.right,n.right)+.1){f.style.top=ex;continue}let y=h.arrow?d.dom.querySelector(".cm-tooltip-arrow"):null,x=y?7:0,_=g.right-g.left,w=(e=XX.get(d))!==null&&e!==void 0?e:g.bottom-g.top,O=d.offset||f$e,T=this.view.textDirection==Jn.LTR,C=g.width>n.right-n.left?T?n.left:n.right-g.width:T?Math.max(n.left,Math.min(p.left-(y?14:0)+O.x,n.right-_)):Math.min(Math.max(n.left,p.left-_+(y?14:0)-O.x),n.right-_),A=this.above[l];!h.strictSide&&(A?p.top-(g.bottom-g.top)-O.y<n.top:p.bottom+(g.bottom-g.top)+O.y>n.bottom)&&A==n.bottom-p.bottom>p.top-n.top&&(A=this.above[l]=!A);let B=(A?p.top-n.top:n.bottom-p.bottom)-x;if(B<w&&d.resize!==!1){if(B<this.view.defaultLineHeight){f.style.top=ex;continue}XX.set(d,w),f.style.height=(w=B)/o+"px"}else f.style.height&&(f.style.height="");let I=A?p.top-w-x-O.y:p.bottom+x+O.y,R=C+_;if(d.overlap!==!0)for(let P of a)P.left<R&&P.right>C&&P.top<I+w&&P.bottom>I&&(I=A?P.top-w-2-x:P.bottom+x+2);if(this.position=="absolute"?(f.style.top=(I-s.parent.top)/o+"px",f.style.left=(C-s.parent.left)/r+"px"):(f.style.top=I/o+"px",f.style.left=C/r+"px"),y){let P=p.left+(T?O.x:-O.x)-(C+14-7);y.style.left=P/r+"px"}d.overlap!==!0&&a.push({left:C,top:I,right:R,bottom:I+w}),f.classList.toggle("cm-tooltip-above",A),f.classList.toggle("cm-tooltip-below",!A),d.positioned&&d.positioned(s.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let s of this.manager.tooltipViews)s.dom.style.top=ex}},{eventObservers:{scroll(){this.maybeMeasure()}}}),d$e=Ot.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),f$e={x:0,y:0},P3=Pt.define({enables:[k3,d$e]}),aT=Pt.define({combine:s=>s.reduce((e,i)=>e.concat(i),[])});class iE{static create(e){return new iE(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new ZZ(e,aT,(i,n)=>this.createHostedView(i,n),i=>i.dom.remove())}createHostedView(e,i){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,i?i.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let i of this.manager.tooltipViews)i.mount&&i.mount(e);this.mounted=!0}positioned(e){for(let i of this.manager.tooltipViews)i.positioned&&i.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let i of this.manager.tooltipViews)(e=i.destroy)===null||e===void 0||e.call(i)}passProp(e){let i;for(let n of this.manager.tooltipViews){let r=n[e];if(r!==void 0){if(i===void 0)i=r;else if(i!==r)return}}return i}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const p$e=P3.compute([aT],s=>{let e=s.facet(aT);return e.length===0?null:{pos:Math.min(...e.map(i=>i.pos)),end:Math.max(...e.map(i=>{var n;return(n=i.end)!==null&&n!==void 0?n:i.pos})),create:iE.create,above:e[0].above,arrow:e.some(i=>i.arrow)}});class m$e{constructor(e,i,n,r,o){this.view=e,this.source=i,this.field=n,this.setHover=r,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:i}=this,n=e.docView.nearest(i.target);if(!n)return;let r,o=1;if(n instanceof Xd)r=n.posAtStart;else{if(r=e.posAtCoords(i),r==null)return;let l=e.coordsAtPos(r);if(!l||i.y<l.top||i.y>l.bottom||i.x<l.left-e.defaultCharacterWidth||i.x>l.right+e.defaultCharacterWidth)return;let h=e.bidiSpans(e.state.doc.lineAt(r)).find(f=>f.from<=r&&f.to>=r),d=h&&h.dir==Jn.RTL?-1:1;o=i.x<l.left?-d:d}let a=this.source(e,r,o);if(a!=null&&a.then){let l=this.pending={pos:r};a.then(h=>{this.pending==l&&(this.pending=null,h&&!(Array.isArray(h)&&!h.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(h)?h:[h])}))},h=>Ko(e.state,h,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(k3),i=e?e.manager.tooltips.findIndex(n=>n.create==iE.create):-1;return i>-1?e.manager.tooltipViews[i]:null}mousemove(e){var i,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:o}=this;if(r.length&&o&&!g$e(o.dom,e)||this.pending){let{pos:a}=r[0]||this.pending,l=(n=(i=r[0])===null||i===void 0?void 0:i.end)!==null&&n!==void 0?n:a;(a==l?this.view.posAtCoords(this.lastMove)!=a:!y$e(this.view,a,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:i}=this;if(i.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let i=n=>{e.removeEventListener("mouseleave",i),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",i)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const DO=4;function g$e(s,e){let{left:i,right:n,top:r,bottom:o}=s.getBoundingClientRect(),a;if(a=s.querySelector(".cm-tooltip-arrow")){let l=a.getBoundingClientRect();r=Math.min(l.top,r),o=Math.max(l.bottom,o)}return e.clientX>=i-DO&&e.clientX<=n+DO&&e.clientY>=r-DO&&e.clientY<=o+DO}function y$e(s,e,i,n,r,o){let a=s.scrollDOM.getBoundingClientRect(),l=s.documentTop+s.documentPadding.top+s.contentHeight;if(a.left>n||a.right<n||a.top>r||Math.min(a.bottom,l)<r)return!1;let h=s.posAtCoords({x:n,y:r},!1);return h>=e&&h<=i}function v$e(s,e={}){let i=Fi.define(),n=$r.define({create(){return[]},update(r,o){if(r.length&&(e.hideOnChange&&(o.docChanged||o.selection)?r=[]:e.hideOn&&(r=r.filter(a=>!e.hideOn(o,a))),o.docChanged)){let a=[];for(let l of r){let h=o.changes.mapPos(l.pos,-1,_o.TrackDel);if(h!=null){let d=Object.assign(Object.create(null),l);d.pos=h,d.end!=null&&(d.end=o.changes.mapPos(d.end)),a.push(d)}}r=a}for(let a of o.effects)a.is(i)&&(r=a.value),a.is(x$e)&&(r=[]);return r},provide:r=>aT.from(r)});return{active:n,extension:[n,js.define(r=>new m$e(r,s,n,i,e.hoverTime||300)),p$e]}}function KZ(s,e){let i=s.plugin(k3);if(!i)return null;let n=i.manager.tooltips.indexOf(e);return n<0?null:i.manager.tooltipViews[n]}const x$e=Fi.define(),WX=Pt.define({combine(s){let e,i;for(let n of s)e=e||n.topContainer,i=i||n.bottomContainer;return{topContainer:e,bottomContainer:i}}});function Z_(s,e){let i=s.plugin(JZ),n=i?i.specs.indexOf(e):-1;return n>-1?i.panels[n]:null}const JZ=js.fromClass(class{constructor(s){this.input=s.state.facet(K_),this.specs=this.input.filter(i=>i),this.panels=this.specs.map(i=>i(s));let e=s.state.facet(WX);this.top=new LO(s,!0,e.topContainer),this.bottom=new LO(s,!1,e.bottomContainer),this.top.sync(this.panels.filter(i=>i.top)),this.bottom.sync(this.panels.filter(i=>!i.top));for(let i of this.panels)i.dom.classList.add("cm-panel"),i.mount&&i.mount()}update(s){let e=s.state.facet(WX);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new LO(s.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new LO(s.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=s.state.facet(K_);if(i!=this.input){let n=i.filter(h=>h),r=[],o=[],a=[],l=[];for(let h of n){let d=this.specs.indexOf(h),f;d<0?(f=h(s.view),l.push(f)):(f=this.panels[d],f.update&&f.update(s)),r.push(f),(f.top?o:a).push(f)}this.specs=n,this.panels=r,this.top.sync(o),this.bottom.sync(a);for(let h of l)h.dom.classList.add("cm-panel"),h.mount&&h.mount()}else for(let n of this.panels)n.update&&n.update(s)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:s=>Ot.scrollMargins.of(e=>{let i=e.plugin(s);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}})});class LO{constructor(e,i,n){this.view=e,this.top=i,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let i of this.panels)i.destroy&&e.indexOf(i)<0&&i.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let i=this.container||this.view.dom;i.insertBefore(this.dom,this.top?i.firstChild:null)}let e=this.dom.firstChild;for(let i of this.panels)if(i.dom.parentNode==this.dom){for(;e!=i.dom;)e=HX(e);e=e.nextSibling}else this.dom.insertBefore(i.dom,e);for(;e;)e=HX(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function HX(s){let e=s.nextSibling;return s.remove(),e}const K_=Pt.define({enables:JZ});class Cu extends xm{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Cu.prototype.elementClass="";Cu.prototype.toDOM=void 0;Cu.prototype.mapMode=_o.TrackBefore;Cu.prototype.startSide=Cu.prototype.endSide=-1;Cu.prototype.point=!0;const rC=Pt.define(),_$e=Pt.define(),b$e={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>fn.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},i_=Pt.define();function w$e(s){return[eK(),i_.of(Object.assign(Object.assign({},b$e),s))]}const GX=Pt.define({combine:s=>s.some(e=>e)});function eK(s){return[O$e]}const O$e=js.fromClass(class{constructor(s){this.view=s,this.prevViewport=s.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=s.state.facet(i_).map(e=>new YX(s,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!s.state.facet(GX),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),s.scrollDOM.insertBefore(this.dom,s.contentDOM)}update(s){if(this.updateGutters(s)){let e=this.prevViewport,i=s.view.viewport,n=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(n<(i.to-i.from)*.8)}s.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(GX)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=s.view.viewport}syncGutters(s){let e=this.dom.nextSibling;s&&this.dom.remove();let i=fn.iter(this.view.state.facet(rC),this.view.viewport.from),n=[],r=this.gutters.map(o=>new S$e(o,this.view.viewport,-this.view.documentPadding.top));for(let o of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(o.type)){let a=!0;for(let l of o.type)if(l.type==So.Text&&a){kR(i,n,l.from);for(let h of r)h.line(this.view,l,n);a=!1}else if(l.widget)for(let h of r)h.widget(this.view,l)}else if(o.type==So.Text){kR(i,n,o.from);for(let a of r)a.line(this.view,o,n)}else if(o.widget)for(let a of r)a.widget(this.view,o);for(let o of r)o.finish();s&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(s){let e=s.startState.facet(i_),i=s.state.facet(i_),n=s.docChanged||s.heightChanged||s.viewportChanged||!fn.eq(s.startState.facet(rC),s.state.facet(rC),s.view.viewport.from,s.view.viewport.to);if(e==i)for(let r of this.gutters)r.update(s)&&(n=!0);else{n=!0;let r=[];for(let o of i){let a=e.indexOf(o);a<0?r.push(new YX(this.view,o)):(this.gutters[a].update(s),r.push(this.gutters[a]))}for(let o of this.gutters)o.dom.remove(),r.indexOf(o)<0&&o.destroy();for(let o of r)this.dom.appendChild(o.dom);this.gutters=r}return n}destroy(){for(let s of this.gutters)s.destroy();this.dom.remove()}},{provide:s=>Ot.scrollMargins.of(e=>{let i=e.plugin(s);return!i||i.gutters.length==0||!i.fixed?null:e.textDirection==Jn.LTR?{left:i.dom.offsetWidth*e.scaleX}:{right:i.dom.offsetWidth*e.scaleX}})});function QX(s){return Array.isArray(s)?s:[s]}function kR(s,e,i){for(;s.value&&s.from<=i;)s.from==i&&e.push(s.value),s.next()}class S$e{constructor(e,i,n){this.gutter=e,this.height=n,this.i=0,this.cursor=fn.iter(e.markers,i.from)}addElement(e,i,n){let{gutter:r}=this,o=(i.top-this.height)/e.scaleY,a=i.height/e.scaleY;if(this.i==r.elements.length){let l=new tK(e,a,o,n);r.elements.push(l),r.dom.appendChild(l.dom)}else r.elements[this.i].update(e,a,o,n);this.height=i.bottom,this.i++}line(e,i,n){let r=[];kR(this.cursor,r,i.from),n.length&&(r=r.concat(n));let o=this.gutter.config.lineMarker(e,i,r);o&&r.unshift(o);let a=this.gutter;r.length==0&&!a.config.renderEmptyElements||this.addElement(e,i,r)}widget(e,i){let n=this.gutter.config.widgetMarker(e,i.widget,i),r=n?[n]:null;for(let o of e.state.facet(_$e)){let a=o(e,i.widget,i);a&&(r||(r=[])).push(a)}r&&this.addElement(e,i,r)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let i=e.elements.pop();e.dom.removeChild(i.dom),i.destroy()}}}class YX{constructor(e,i){this.view=e,this.config=i,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in i.domEventHandlers)this.dom.addEventListener(n,r=>{let o=r.target,a;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let h=o.getBoundingClientRect();a=(h.top+h.bottom)/2}else a=r.clientY;let l=e.lineBlockAtHeight(a-e.documentTop);i.domEventHandlers[n](e,l,r)&&r.preventDefault()});this.markers=QX(i.markers(e)),i.initialSpacer&&(this.spacer=new tK(e,0,0,[i.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let i=this.markers;if(this.markers=QX(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let n=e.view.viewport;return!fn.eq(this.markers,i,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class tK{constructor(e,i,n,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,i,n,r)}update(e,i,n,r){this.height!=i&&(this.height=i,this.dom.style.height=i+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),C$e(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,i){let n="cm-gutterElement",r=this.dom.firstChild;for(let o=0,a=0;;){let l=a,h=o<i.length?i[o++]:null,d=!1;if(h){let f=h.elementClass;f&&(n+=" "+f);for(let p=a;p<this.markers.length;p++)if(this.markers[p].compare(h)){l=p,d=!0;break}}else l=this.markers.length;for(;a<l;){let f=this.markers[a++];if(f.toDOM){f.destroy(r);let p=r.nextSibling;r.remove(),r=p}}if(!h)break;h.toDOM&&(d?r=r.nextSibling:this.dom.insertBefore(h.toDOM(e),r)),d&&a++}this.dom.className=n,this.markers=i}destroy(){this.setMarkers(null,[])}}function C$e(s,e){if(s.length!=e.length)return!1;for(let i=0;i<s.length;i++)if(!s[i].compare(e[i]))return!1;return!0}const T$e=Pt.define(),A$e=Pt.define(),m0=Pt.define({combine(s){return fh(s,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,i){let n=Object.assign({},e);for(let r in i){let o=n[r],a=i[r];n[r]=o?(l,h,d)=>o(l,h,d)||a(l,h,d):a}return n}})}});class GP extends Cu{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function QP(s,e){return s.state.facet(m0).formatNumber(e,s.state)}const E$e=i_.compute([m0],s=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(T$e)},lineMarker(e,i,n){return n.some(r=>r.toDOM)?null:new GP(QP(e,e.state.doc.lineAt(i.from).number))},widgetMarker:(e,i,n)=>{for(let r of e.state.facet(A$e)){let o=r(e,i,n);if(o)return o}return null},lineMarkerChange:e=>e.startState.facet(m0)!=e.state.facet(m0),initialSpacer(e){return new GP(QP(e,jX(e.state.doc.lines)))},updateSpacer(e,i){let n=QP(i.view,jX(i.view.state.doc.lines));return n==e.number?e:new GP(n)},domEventHandlers:s.facet(m0).domEventHandlers}));function M$e(s={}){return[m0.of(s),eK(),E$e]}function jX(s){let e=9;for(;e<s;)e=e*10+9;return e}const k$e=new class extends Cu{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},P$e=rC.compute(["selection"],s=>{let e=[],i=-1;for(let n of s.selection.ranges){let r=s.doc.lineAt(n.head).from;r>i&&(i=r,e.push(k$e.range(r)))}return fn.of(e)});function I$e(){return P$e}const iK=1024;let B$e=0;class YP{constructor(e,i){this.from=e,this.to=i}}class Hi{constructor(e={}){this.id=B$e++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=sa.match(e)),i=>{let n=e(i);return n===void 0?null:[this,n]}}}Hi.closedBy=new Hi({deserialize:s=>s.split(" ")});Hi.openedBy=new Hi({deserialize:s=>s.split(" ")});Hi.group=new Hi({deserialize:s=>s.split(" ")});Hi.isolate=new Hi({deserialize:s=>{if(s&&s!="rtl"&&s!="ltr"&&s!="auto")throw new RangeError("Invalid value for isolate: "+s);return s||"auto"}});Hi.contextHash=new Hi({perNode:!0});Hi.lookAhead=new Hi({perNode:!0});Hi.mounted=new Hi({perNode:!0});class lT{constructor(e,i,n){this.tree=e,this.overlay=i,this.parser=n}static get(e){return e&&e.props&&e.props[Hi.mounted.id]}}const R$e=Object.create(null);class sa{constructor(e,i,n,r=0){this.name=e,this.props=i,this.id=n,this.flags=r}static define(e){let i=e.props&&e.props.length?Object.create(null):R$e,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new sa(e.name||"",i,e.id,n);if(e.props){for(let o of e.props)if(Array.isArray(o)||(o=o(r)),o){if(o[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");i[o[0].id]=o[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let i=this.prop(Hi.group);return i?i.indexOf(e)>-1:!1}return this.id==e}static match(e){let i=Object.create(null);for(let n in e)for(let r of n.split(" "))i[r]=e[n];return n=>{for(let r=n.prop(Hi.group),o=-1;o<(r?r.length:0);o++){let a=i[o<0?n.name:r[o]];if(a)return a}}}}sa.none=new sa("",Object.create(null),0,8);class I3{constructor(e){this.types=e;for(let i=0;i<e.length;i++)if(e[i].id!=i)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let i=[];for(let n of this.types){let r=null;for(let o of e){let a=o(n);a&&(r||(r=Object.assign({},n.props)),r[a[0].id]=a[1])}i.push(r?new sa(n.name,r,n.id,n.flags):n)}return new I3(i)}}const NO=new WeakMap,qX=new WeakMap;var _r;(function(s){s[s.ExcludeBuffers=1]="ExcludeBuffers",s[s.IncludeAnonymous=2]="IncludeAnonymous",s[s.IgnoreMounts=4]="IgnoreMounts",s[s.IgnoreOverlays=8]="IgnoreOverlays"})(_r||(_r={}));class Qs{constructor(e,i,n,r,o){if(this.type=e,this.children=i,this.positions=n,this.length=r,this.props=null,o&&o.length){this.props=Object.create(null);for(let[a,l]of o)this.props[typeof a=="number"?a:a.id]=l}}toString(){let e=lT.get(this);if(e&&!e.overlay)return e.tree.toString();let i="";for(let n of this.children){let r=n.toString();r&&(i&&(i+=","),i+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(i.length?"("+i+")":""):i}cursor(e=0){return new IR(this.topNode,e)}cursorAt(e,i=0,n=0){let r=NO.get(this)||this.topNode,o=new IR(r);return o.moveTo(e,i),NO.set(this,o._tree),o}get topNode(){return new hf(this,0,0,null)}resolve(e,i=0){let n=J_(NO.get(this)||this.topNode,e,i,!1);return NO.set(this,n),n}resolveInner(e,i=0){let n=J_(qX.get(this)||this.topNode,e,i,!0);return qX.set(this,n),n}resolveStack(e,i=0){return N$e(this,e,i)}iterate(e){let{enter:i,leave:n,from:r=0,to:o=this.length}=e,a=e.mode||0,l=(a&_r.IncludeAnonymous)>0;for(let h=this.cursor(a|_r.IncludeAnonymous);;){let d=!1;if(h.from<=o&&h.to>=r&&(!l&&h.type.isAnonymous||i(h)!==!1)){if(h.firstChild())continue;d=!0}for(;d&&n&&(l||!h.type.isAnonymous)&&n(h),!h.nextSibling();){if(!h.parent())return;d=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let i in this.props)e.push([+i,this.props[i]]);return e}balance(e={}){return this.children.length<=8?this:D3(sa.none,this.children,this.positions,0,this.children.length,0,this.length,(i,n,r)=>new Qs(this.type,i,n,r,this.propValues),e.makeTree||((i,n,r)=>new Qs(sa.none,i,n,r)))}static build(e){return V$e(e)}}Qs.empty=new Qs(sa.none,[],[],0);class B3{constructor(e,i){this.buffer=e,this.index=i}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new B3(this.buffer,this.index)}}class cf{constructor(e,i,n){this.buffer=e,this.length=i,this.set=n}get type(){return sa.none}toString(){let e=[];for(let i=0;i<this.buffer.length;)e.push(this.childString(i)),i=this.buffer[i+3];return e.join(",")}childString(e){let i=this.buffer[e],n=this.buffer[e+3],r=this.set.types[i],o=r.name;if(/\W/.test(o)&&!r.isError&&(o=JSON.stringify(o)),e+=4,n==e)return o;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return o+"("+a.join(",")+")"}findChild(e,i,n,r,o){let{buffer:a}=this,l=-1;for(let h=e;h!=i&&!(nK(o,r,a[h+1],a[h+2])&&(l=h,n>0));h=a[h+3]);return l}slice(e,i,n){let r=this.buffer,o=new Uint16Array(i-e),a=0;for(let l=e,h=0;l<i;){o[h++]=r[l++],o[h++]=r[l++]-n;let d=o[h++]=r[l++]-n;o[h++]=r[l++]-e,a=Math.max(a,d)}return new cf(o,a,this.set)}}function nK(s,e,i,n){switch(s){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function J_(s,e,i,n){for(var r;s.from==s.to||(i<1?s.from>=e:s.from>e)||(i>-1?s.to<=e:s.to<e);){let a=!n&&s instanceof hf&&s.index<0?null:s.parent;if(!a)return s;s=a}let o=n?0:_r.IgnoreOverlays;if(n)for(let a=s,l=a.parent;l;a=l,l=a.parent)a instanceof hf&&a.index<0&&((r=l.enter(e,i,o))===null||r===void 0?void 0:r.from)!=a.from&&(s=l);for(;;){let a=s.enter(e,i,o);if(!a)return s;s=a}}class sK{cursor(e=0){return new IR(this,e)}getChild(e,i=null,n=null){let r=ZX(this,e,i,n);return r.length?r[0]:null}getChildren(e,i=null,n=null){return ZX(this,e,i,n)}resolve(e,i=0){return J_(this,e,i,!1)}resolveInner(e,i=0){return J_(this,e,i,!0)}matchContext(e){return PR(this,e)}enterUnfinishedNodesBefore(e){let i=this.childBefore(e),n=this;for(;i;){let r=i.lastChild;if(!r||r.to!=i.to)break;r.type.isError&&r.from==r.to?(n=i,i=r.prevSibling):i=r}return n}get node(){return this}get next(){return this.parent}}let hf=class oC extends sK{constructor(e,i,n,r){super(),this._tree=e,this.from=i,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,i,n,r,o=0){for(let a=this;;){for(let{children:l,positions:h}=a._tree,d=i>0?l.length:-1;e!=d;e+=i){let f=l[e],p=h[e]+a.from;if(nK(r,n,p,p+f.length)){if(f instanceof cf){if(o&_r.ExcludeBuffers)continue;let g=f.findChild(0,f.buffer.length,i,n-p,r);if(g>-1)return new Hd(new D$e(a,f,e,p),null,g)}else if(o&_r.IncludeAnonymous||!f.type.isAnonymous||R3(f)){let g;if(!(o&_r.IgnoreMounts)&&(g=lT.get(f))&&!g.overlay)return new oC(g.tree,p,e,a);let y=new oC(f,p,e,a);return o&_r.IncludeAnonymous||!y.type.isAnonymous?y:y.nextChild(i<0?f.children.length-1:0,i,n,r)}}}if(o&_r.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+i:e=i<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,i,n=0){let r;if(!(n&_r.IgnoreOverlays)&&(r=lT.get(this._tree))&&r.overlay){let o=e-this.from;for(let{from:a,to:l}of r.overlay)if((i>0?a<=o:a<o)&&(i<0?l>=o:l>o))return new oC(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,i,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function ZX(s,e,i,n){let r=s.cursor(),o=[];if(!r.firstChild())return o;if(i!=null){for(let a=!1;!a;)if(a=r.type.is(i),!r.nextSibling())return o}for(;;){if(n!=null&&r.type.is(n))return o;if(r.type.is(e)&&o.push(r.node),!r.nextSibling())return n==null?o:[]}}function PR(s,e,i=e.length-1){for(let n=s.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class D$e{constructor(e,i,n,r){this.parent=e,this.buffer=i,this.index=n,this.start=r}}class Hd extends sK{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,i,n){super(),this.context=e,this._parent=i,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,i,n){let{buffer:r}=this.context,o=r.findChild(this.index+4,r.buffer[this.index+3],e,i-this.context.start,n);return o<0?null:new Hd(this.context,this,o)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,i,n=0){if(n&_r.ExcludeBuffers)return null;let{buffer:r}=this.context,o=r.findChild(this.index+4,r.buffer[this.index+3],i>0?1:-1,e-this.context.start,i);return o<0?null:new Hd(this.context,this,o)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,i=e.buffer[this.index+3];return i<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Hd(this.context,this._parent,i):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,i=this._parent?this._parent.index+4:0;return this.index==i?this.externalSibling(-1):new Hd(this.context,this._parent,e.findChild(i,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],i=[],{buffer:n}=this.context,r=this.index+4,o=n.buffer[this.index+3];if(o>r){let a=n.buffer[this.index+1];e.push(n.slice(r,o,a)),i.push(0)}return new Qs(this.type,e,i,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function rK(s){if(!s.length)return null;let e=0,i=s[0];for(let o=1;o<s.length;o++){let a=s[o];(a.from>i.from||a.to<i.to)&&(i=a,e=o)}let n=i instanceof hf&&i.index<0?null:i.parent,r=s.slice();return n?r[e]=n:r.splice(e,1),new L$e(r,i)}class L$e{constructor(e,i){this.heads=e,this.node=i}get next(){return rK(this.heads)}}function N$e(s,e,i){let n=s.resolveInner(e,i),r=null;for(let o=n instanceof hf?n:n.context.parent;o;o=o.parent)if(o.index<0){let a=o.parent;(r||(r=[n])).push(a.resolve(e,i)),o=a}else{let a=lT.get(o.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let l=new hf(a.tree,a.overlay[0].from+o.from,-1,o);(r||(r=[n])).push(J_(l,e,i,!1))}}return r?rK(r):n}class IR{get name(){return this.type.name}constructor(e,i=0){if(this.mode=i,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof hf)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,i){this.index=e;let{start:n,buffer:r}=this.buffer;return this.type=i||r.set.types[r.buffer[e]],this.from=n+r.buffer[e+1],this.to=n+r.buffer[e+2],!0}yield(e){return e?e instanceof hf?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,i,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,i,n,this.mode));let{buffer:r}=this.buffer,o=r.findChild(this.index+4,r.buffer[this.index+3],e,i-this.buffer.start,n);return o<0?!1:(this.stack.push(this.index),this.yieldBuf(o))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,i,n=this.mode){return this.buffer?n&_r.ExcludeBuffers?!1:this.enterChild(1,e,i):this.yield(this._tree.enter(e,i,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&_r.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&_r.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:i}=this.buffer,n=this.stack.length-1;if(e<0){let r=n<0?0:this.stack[n]+4;if(this.index!=r)return this.yieldBuf(i.findChild(r,this.index,-1,0,4))}else{let r=i.buffer[this.index+3];if(r<(n<0?i.buffer.length:i.buffer[this.stack[n]+3]))return this.yieldBuf(r)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let i,n,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let o=0;o<this.index;o++)if(r.buffer.buffer[o+3]<this.index)return!1;({index:i,parent:n}=r)}else({index:i,_parent:n}=this._tree);for(;n;{index:i,_parent:n}=n)if(i>-1)for(let o=i+e,a=e<0?-1:n._tree.children.length;o!=a;o+=e){let l=n._tree.children[o];if(this.mode&_r.IncludeAnonymous||l instanceof cf||!l.type.isAnonymous||R3(l))return!1}return!0}move(e,i){if(i&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,i=0){for(;(this.from==this.to||(i<1?this.from>=e:this.from>e)||(i>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,i););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,i=null,n=0;if(e&&e.context==this.buffer)e:for(let r=this.index,o=this.stack.length;o>=0;){for(let a=e;a;a=a._parent)if(a.index==r){if(r==this.index)return a;i=a,n=o+1;break e}r=this.stack[--o]}for(let r=n;r<this.stack.length;r++)i=new Hd(this.buffer,i,this.stack[r]);return this.bufferNode=new Hd(this.buffer,i,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,i){for(let n=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;r&&i&&i(this),r=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,r=!0}}}matchContext(e){if(!this.buffer)return PR(this.node,e);let{buffer:i}=this.buffer,{types:n}=i.set;for(let r=e.length-1,o=this.stack.length-1;r>=0;o--){if(o<0)return PR(this.node,e,r);let a=n[i.buffer[this.stack[o]]];if(!a.isAnonymous){if(e[r]&&e[r]!=a.name)return!1;r--}}return!0}}function R3(s){return s.children.some(e=>e instanceof cf||!e.type.isAnonymous||R3(e))}function V$e(s){var e;let{buffer:i,nodeSet:n,maxBufferLength:r=iK,reused:o=[],minRepeatType:a=n.types.length}=s,l=Array.isArray(i)?new B3(i,i.length):i,h=n.types,d=0,f=0;function p(B,I,R,P,k,E){let{id:D,start:L,end:V,size:F}=l,j=f;for(;F<0;)if(l.next(),F==-1){let oe=o[D];R.push(oe),P.push(L-B);return}else if(F==-3){d=D;return}else if(F==-4){f=D;return}else throw new RangeError(`Unrecognized record size: ${F}`);let Q=h[D],ee,J,ue=L-B;if(V-L<=r&&(J=w(l.pos-I,k))){let oe=new Uint16Array(J.size-J.skip),pe=l.pos-J.size,Ue=oe.length;for(;l.pos>pe;)Ue=O(J.start,oe,Ue);ee=new cf(oe,V-J.start,n),ue=J.start-B}else{let oe=l.pos-F;l.next();let pe=[],Ue=[],tt=D>=a?D:-1,ve=0,Re=V;for(;l.pos>oe;)tt>=0&&l.id==tt&&l.size>=0?(l.end<=Re-r&&(x(pe,Ue,L,ve,l.end,Re,tt,j),ve=pe.length,Re=l.end),l.next()):E>2500?g(L,oe,pe,Ue):p(L,oe,pe,Ue,tt,E+1);if(tt>=0&&ve>0&&ve<pe.length&&x(pe,Ue,L,ve,L,Re,tt,j),pe.reverse(),Ue.reverse(),tt>-1&&ve>0){let Le=y(Q);ee=D3(Q,pe,Ue,0,pe.length,0,V-L,Le,Le)}else ee=_(Q,pe,Ue,V-L,j-V)}R.push(ee),P.push(ue)}function g(B,I,R,P){let k=[],E=0,D=-1;for(;l.pos>I;){let{id:L,start:V,end:F,size:j}=l;if(j>4)l.next();else{if(D>-1&&V<D)break;D<0&&(D=F-r),k.push(L,V,F),E++,l.next()}}if(E){let L=new Uint16Array(E*4),V=k[k.length-2];for(let F=k.length-3,j=0;F>=0;F-=3)L[j++]=k[F],L[j++]=k[F+1]-V,L[j++]=k[F+2]-V,L[j++]=j;R.push(new cf(L,k[2]-V,n)),P.push(V-B)}}function y(B){return(I,R,P)=>{let k=0,E=I.length-1,D,L;if(E>=0&&(D=I[E])instanceof Qs){if(!E&&D.type==B&&D.length==P)return D;(L=D.prop(Hi.lookAhead))&&(k=R[E]+D.length+L)}return _(B,I,R,P,k)}}function x(B,I,R,P,k,E,D,L){let V=[],F=[];for(;B.length>P;)V.push(B.pop()),F.push(I.pop()+R-k);B.push(_(n.types[D],V,F,E-k,L-E)),I.push(k-R)}function _(B,I,R,P,k=0,E){if(d){let D=[Hi.contextHash,d];E=E?[D].concat(E):[D]}if(k>25){let D=[Hi.lookAhead,k];E=E?[D].concat(E):[D]}return new Qs(B,I,R,P,E)}function w(B,I){let R=l.fork(),P=0,k=0,E=0,D=R.end-r,L={size:0,start:0,skip:0};e:for(let V=R.pos-B;R.pos>V;){let F=R.size;if(R.id==I&&F>=0){L.size=P,L.start=k,L.skip=E,E+=4,P+=4,R.next();continue}let j=R.pos-F;if(F<0||j<V||R.start<D)break;let Q=R.id>=a?4:0,ee=R.start;for(R.next();R.pos>j;){if(R.size<0)if(R.size==-3)Q+=4;else break e;else R.id>=a&&(Q+=4);R.next()}k=ee,P+=F,E+=Q}return(I<0||P==B)&&(L.size=P,L.start=k,L.skip=E),L.size>4?L:void 0}function O(B,I,R){let{id:P,start:k,end:E,size:D}=l;if(l.next(),D>=0&&P<a){let L=R;if(D>4){let V=l.pos-(D-4);for(;l.pos>V;)R=O(B,I,R)}I[--R]=L,I[--R]=E-B,I[--R]=k-B,I[--R]=P}else D==-3?d=P:D==-4&&(f=P);return R}let T=[],C=[];for(;l.pos>0;)p(s.start||0,s.bufferStart||0,T,C,-1,0);let A=(e=s.length)!==null&&e!==void 0?e:T.length?C[0]+T[0].length:0;return new Qs(h[s.topID],T.reverse(),C.reverse(),A)}const KX=new WeakMap;function aC(s,e){if(!s.isAnonymous||e instanceof cf||e.type!=s)return 1;let i=KX.get(e);if(i==null){i=1;for(let n of e.children){if(n.type!=s||!(n instanceof Qs)){i=1;break}i+=aC(s,n)}KX.set(e,i)}return i}function D3(s,e,i,n,r,o,a,l,h){let d=0;for(let x=n;x<r;x++)d+=aC(s,e[x]);let f=Math.ceil(d*1.5/8),p=[],g=[];function y(x,_,w,O,T){for(let C=w;C<O;){let A=C,B=_[C],I=aC(s,x[C]);for(C++;C<O;C++){let R=aC(s,x[C]);if(I+R>=f)break;I+=R}if(C==A+1){if(I>f){let R=x[A];y(R.children,R.positions,0,R.children.length,_[A]+T);continue}p.push(x[A])}else{let R=_[C-1]+x[C-1].length-B;p.push(D3(s,x,_,A,C,B,R,null,h))}g.push(B+T-o)}}return y(e,i,n,r,0),(l||h)(p,g,a)}class tm{constructor(e,i,n,r,o=!1,a=!1){this.from=e,this.to=i,this.tree=n,this.offset=r,this.open=(o?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,i=[],n=!1){let r=[new tm(0,e.length,e,0,!1,n)];for(let o of i)o.to>e.length&&r.push(o);return r}static applyChanges(e,i,n=128){if(!i.length)return e;let r=[],o=1,a=e.length?e[0]:null;for(let l=0,h=0,d=0;;l++){let f=l<i.length?i[l]:null,p=f?f.fromA:1e9;if(p-h>=n)for(;a&&a.from<p;){let g=a;if(h>=g.from||p<=g.to||d){let y=Math.max(g.from,h)-d,x=Math.min(g.to,p)-d;g=y>=x?null:new tm(y,x,g.tree,g.offset+d,l>0,!!f)}if(g&&r.push(g),a.to>p)break;a=o<e.length?e[o++]:null}if(!f)break;h=f.toA,d=f.toA-f.toB}return r}}class oK{startParse(e,i,n){return typeof e=="string"&&(e=new $$e(e)),n=n?n.length?n.map(r=>new YP(r.from,r.to)):[new YP(0,0)]:[new YP(0,e.length)],this.createParse(e,i||[],n)}parse(e,i,n){let r=this.startParse(e,i,n);for(;;){let o=r.advance();if(o)return o}}}class $$e{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,i){return this.string.slice(e,i)}}new Hi({perNode:!0});let U$e=0;class ol{constructor(e,i,n,r){this.name=e,this.set=i,this.base=n,this.modified=r,this.id=U$e++}toString(){let{name:e}=this;for(let i of this.modified)i.name&&(e=`${i.name}(${e})`);return e}static define(e,i){let n=typeof e=="string"?e:"?";if(e instanceof ol&&(i=e),i!=null&&i.base)throw new Error("Can not derive from a modified tag");let r=new ol(n,[],null,[]);if(r.set.push(r),i)for(let o of i.set)r.set.push(o);return r}static defineModifier(e){let i=new cT(e);return n=>n.modified.indexOf(i)>-1?n:cT.get(n.base||n,n.modified.concat(i).sort((r,o)=>r.id-o.id))}}let F$e=0;class cT{constructor(e){this.name=e,this.instances=[],this.id=F$e++}static get(e,i){if(!i.length)return e;let n=i[0].instances.find(l=>l.base==e&&z$e(i,l.modified));if(n)return n;let r=[],o=new ol(e.name,r,e,i);for(let l of i)l.instances.push(o);let a=X$e(i);for(let l of e.set)if(!l.modified.length)for(let h of a)r.push(cT.get(l,h));return o}}function z$e(s,e){return s.length==e.length&&s.every((i,n)=>i==e[n])}function X$e(s){let e=[[]];for(let i=0;i<s.length;i++)for(let n=0,r=e.length;n<r;n++)e.push(e[n].concat(s[i]));return e.sort((i,n)=>n.length-i.length)}function aK(s){let e=Object.create(null);for(let i in s){let n=s[i];Array.isArray(n)||(n=[n]);for(let r of i.split(" "))if(r){let o=[],a=2,l=r;for(let p=0;;){if(l=="..."&&p>0&&p+3==r.length){a=1;break}let g=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!g)throw new RangeError("Invalid path: "+r);if(o.push(g[0]=="*"?"":g[0][0]=='"'?JSON.parse(g[0]):g[0]),p+=g[0].length,p==r.length)break;let y=r[p++];if(p==r.length&&y=="!"){a=0;break}if(y!="/")throw new RangeError("Invalid path: "+r);l=r.slice(p)}let h=o.length-1,d=o[h];if(!d)throw new RangeError("Invalid path: "+r);let f=new hT(n,a,h>0?o.slice(0,h):null);e[d]=f.sort(e[d])}}return lK.add(e)}const lK=new Hi;class hT{constructor(e,i,n,r){this.tags=e,this.mode=i,this.context=n,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}hT.empty=new hT([],2,null);function cK(s,e){let i=Object.create(null);for(let o of s)if(!Array.isArray(o.tag))i[o.tag.id]=o.class;else for(let a of o.tag)i[a.id]=o.class;let{scope:n,all:r=null}=e||{};return{style:o=>{let a=r;for(let l of o)for(let h of l.set){let d=i[h.id];if(d){a=a?a+" "+d:d;break}}return a},scope:n}}function W$e(s,e){let i=null;for(let n of s){let r=n.style(e);r&&(i=i?i+" "+r:r)}return i}function H$e(s,e,i,n=0,r=s.length){let o=new G$e(n,Array.isArray(e)?e:[e],i);o.highlightRange(s.cursor(),n,r,"",o.highlighters),o.flush(r)}class G$e{constructor(e,i,n){this.at=e,this.highlighters=i,this.span=n,this.class=""}startSpan(e,i){i!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=i)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,i,n,r,o){let{type:a,from:l,to:h}=e;if(l>=n||h<=i)return;a.isTop&&(o=this.highlighters.filter(y=>!y.scope||y.scope(a)));let d=r,f=Q$e(e)||hT.empty,p=W$e(o,f.tags);if(p&&(d&&(d+=" "),d+=p,f.mode==1&&(r+=(r?" ":"")+p)),this.startSpan(Math.max(i,l),d),f.opaque)return;let g=e.tree&&e.tree.prop(Hi.mounted);if(g&&g.overlay){let y=e.node.enter(g.overlay[0].from+l,1),x=this.highlighters.filter(w=>!w.scope||w.scope(g.tree.type)),_=e.firstChild();for(let w=0,O=l;;w++){let T=w<g.overlay.length?g.overlay[w]:null,C=T?T.from+l:h,A=Math.max(i,O),B=Math.min(n,C);if(A<B&&_)for(;e.from<B&&(this.highlightRange(e,A,B,r,o),this.startSpan(Math.min(B,e.to),d),!(e.to>=C||!e.nextSibling())););if(!T||C>n)break;O=T.to+l,O>i&&(this.highlightRange(y.cursor(),Math.max(i,T.from+l),Math.min(n,O),"",x),this.startSpan(Math.min(n,O),d))}_&&e.parent()}else if(e.firstChild()){g&&(r="");do if(!(e.to<=i)){if(e.from>=n)break;this.highlightRange(e,i,n,r,o),this.startSpan(Math.min(n,e.to),d)}while(e.nextSibling());e.parent()}}}function Q$e(s){let e=s.type.prop(lK);for(;e&&e.context&&!s.matchContext(e.context);)e=e.next;return e||null}const dt=ol.define,VO=dt(),kd=dt(),JX=dt(kd),eW=dt(kd),Pd=dt(),$O=dt(Pd),jP=dt(Pd),Rc=dt(),np=dt(Rc),wc=dt(),Oc=dt(),BR=dt(),tx=dt(BR),UO=dt(),We={comment:VO,lineComment:dt(VO),blockComment:dt(VO),docComment:dt(VO),name:kd,variableName:dt(kd),typeName:JX,tagName:dt(JX),propertyName:eW,attributeName:dt(eW),className:dt(kd),labelName:dt(kd),namespace:dt(kd),macroName:dt(kd),literal:Pd,string:$O,docString:dt($O),character:dt($O),attributeValue:dt($O),number:jP,integer:dt(jP),float:dt(jP),bool:dt(Pd),regexp:dt(Pd),escape:dt(Pd),color:dt(Pd),url:dt(Pd),keyword:wc,self:dt(wc),null:dt(wc),atom:dt(wc),unit:dt(wc),modifier:dt(wc),operatorKeyword:dt(wc),controlKeyword:dt(wc),definitionKeyword:dt(wc),moduleKeyword:dt(wc),operator:Oc,derefOperator:dt(Oc),arithmeticOperator:dt(Oc),logicOperator:dt(Oc),bitwiseOperator:dt(Oc),compareOperator:dt(Oc),updateOperator:dt(Oc),definitionOperator:dt(Oc),typeOperator:dt(Oc),controlOperator:dt(Oc),punctuation:BR,separator:dt(BR),bracket:tx,angleBracket:dt(tx),squareBracket:dt(tx),paren:dt(tx),brace:dt(tx),content:Rc,heading:np,heading1:dt(np),heading2:dt(np),heading3:dt(np),heading4:dt(np),heading5:dt(np),heading6:dt(np),contentSeparator:dt(Rc),list:dt(Rc),quote:dt(Rc),emphasis:dt(Rc),strong:dt(Rc),link:dt(Rc),monospace:dt(Rc),strikethrough:dt(Rc),inserted:dt(),deleted:dt(),changed:dt(),invalid:dt(),meta:UO,documentMeta:dt(UO),annotation:dt(UO),processingInstruction:dt(UO),definition:ol.defineModifier("definition"),constant:ol.defineModifier("constant"),function:ol.defineModifier("function"),standard:ol.defineModifier("standard"),local:ol.defineModifier("local"),special:ol.defineModifier("special")};for(let s in We){let e=We[s];e instanceof ol&&(e.name=s)}cK([{tag:We.link,class:"tok-link"},{tag:We.heading,class:"tok-heading"},{tag:We.emphasis,class:"tok-emphasis"},{tag:We.strong,class:"tok-strong"},{tag:We.keyword,class:"tok-keyword"},{tag:We.atom,class:"tok-atom"},{tag:We.bool,class:"tok-bool"},{tag:We.url,class:"tok-url"},{tag:We.labelName,class:"tok-labelName"},{tag:We.inserted,class:"tok-inserted"},{tag:We.deleted,class:"tok-deleted"},{tag:We.literal,class:"tok-literal"},{tag:We.string,class:"tok-string"},{tag:We.number,class:"tok-number"},{tag:[We.regexp,We.escape,We.special(We.string)],class:"tok-string2"},{tag:We.variableName,class:"tok-variableName"},{tag:We.local(We.variableName),class:"tok-variableName tok-local"},{tag:We.definition(We.variableName),class:"tok-variableName tok-definition"},{tag:We.special(We.variableName),class:"tok-variableName2"},{tag:We.definition(We.propertyName),class:"tok-propertyName tok-definition"},{tag:We.typeName,class:"tok-typeName"},{tag:We.namespace,class:"tok-namespace"},{tag:We.className,class:"tok-className"},{tag:We.macroName,class:"tok-macroName"},{tag:We.propertyName,class:"tok-propertyName"},{tag:We.operator,class:"tok-operator"},{tag:We.comment,class:"tok-comment"},{tag:We.meta,class:"tok-meta"},{tag:We.invalid,class:"tok-invalid"},{tag:We.punctuation,class:"tok-punctuation"}]);var qP;const g0=new Hi;function Y$e(s){return Pt.define({combine:s?e=>e.concat(s):void 0})}const j$e=new Hi;class jl{constructor(e,i,n=[],r=""){this.data=e,this.name=r,gn.prototype.hasOwnProperty("tree")||Object.defineProperty(gn.prototype,"tree",{get(){return eo(this)}}),this.parser=i,this.extension=[uf.of(this),gn.languageData.of((o,a,l)=>{let h=tW(o,a,l),d=h.type.prop(g0);if(!d)return[];let f=o.facet(d),p=h.type.prop(j$e);if(p){let g=h.resolve(a-h.from,l);for(let y of p)if(y.test(g,o)){let x=o.facet(y.facet);return y.type=="replace"?x:x.concat(f)}}return f})].concat(n)}isActiveAt(e,i,n=-1){return tW(e,i,n).type.prop(g0)==this.data}findRegions(e){let i=e.facet(uf);if((i==null?void 0:i.data)==this.data)return[{from:0,to:e.doc.length}];if(!i||!i.allowsNesting)return[];let n=[],r=(o,a)=>{if(o.prop(g0)==this.data){n.push({from:a,to:a+o.length});return}let l=o.prop(Hi.mounted);if(l){if(l.tree.prop(g0)==this.data){if(l.overlay)for(let h of l.overlay)n.push({from:h.from+a,to:h.to+a});else n.push({from:a,to:a+o.length});return}else if(l.overlay){let h=n.length;if(r(l.tree,l.overlay[0].from+a),n.length>h)return}}for(let h=0;h<o.children.length;h++){let d=o.children[h];d instanceof Qs&&r(d,o.positions[h]+a)}};return r(eo(e),0),n}get allowsNesting(){return!0}}jl.setState=Fi.define();function tW(s,e,i){let n=s.facet(uf),r=eo(s).topNode;if(!n||n.allowsNesting)for(let o=r;o;o=o.enter(e,i,_r.ExcludeBuffers))o.type.isTop&&(r=o);return r}class uT extends jl{constructor(e,i,n){super(e,i,[],n),this.parser=i}static define(e){let i=Y$e(e.languageData);return new uT(i,e.parser.configure({props:[g0.add(n=>n.isTop?i:void 0)]}),e.name)}configure(e,i){return new uT(this.data,this.parser.configure(e),i||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function eo(s){let e=s.field(jl.state,!1);return e?e.tree:Qs.empty}class q$e{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,i){let n=this.cursorPos-this.string.length;return e<n||i>=this.cursorPos?this.doc.sliceString(e,i):this.string.slice(e-n,i-n)}}let ix=null;class dT{constructor(e,i,n=[],r,o,a,l,h){this.parser=e,this.state=i,this.fragments=n,this.tree=r,this.treeLen=o,this.viewport=a,this.skipped=l,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(e,i,n){return new dT(e,i,[],Qs.empty,0,n,[],null)}startParse(){return this.parser.startParse(new q$e(this.state.doc),this.fragments)}work(e,i){return i!=null&&i>=this.state.doc.length&&(i=void 0),this.tree!=Qs.empty&&this.isDone(i??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),i!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>i)&&i<this.state.doc.length&&this.parse.stopAt(i);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(tm.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(i??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,i;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(i=this.parse.advance()););}),this.treeLen=e,this.tree=i,this.fragments=this.withoutTempSkipped(tm.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let i=ix;ix=this;try{return e()}finally{ix=i}}withoutTempSkipped(e){for(let i;i=this.tempSkipped.pop();)e=iW(e,i.from,i.to);return e}changes(e,i){let{fragments:n,tree:r,treeLen:o,viewport:a,skipped:l}=this;if(this.takeTree(),!e.empty){let h=[];if(e.iterChangedRanges((d,f,p,g)=>h.push({fromA:d,toA:f,fromB:p,toB:g})),n=tm.applyChanges(n,h),r=Qs.empty,o=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){l=[];for(let d of this.skipped){let f=e.mapPos(d.from,1),p=e.mapPos(d.to,-1);f<p&&l.push({from:f,to:p})}}}return new dT(this.parser,i,n,r,o,a,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let i=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:r,to:o}=this.skipped[n];r<e.to&&o>e.from&&(this.fragments=iW(this.fragments,r,o),this.skipped.splice(n--,1))}return this.skipped.length>=i?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,i){this.skipped.push({from:e,to:i})}static getSkippingParser(e){return new class extends oK{createParse(i,n,r){let o=r[0].from,a=r[r.length-1].to;return{parsedPos:o,advance(){let h=ix;if(h){for(let d of r)h.tempSkipped.push(d);e&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,e]):e)}return this.parsedPos=a,new Qs(sa.none,[],[],a-o)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let i=this.fragments;return this.treeLen>=e&&i.length&&i[0].from==0&&i[0].to>=e}static get(){return ix}}function iW(s,e,i){return tm.applyChanges(s,[{fromA:e,toA:i,fromB:e,toB:i}])}class _y{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let i=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),i.viewport.to);return i.work(20,n)||i.takeTree(),new _y(i)}static init(e){let i=Math.min(3e3,e.doc.length),n=dT.create(e.facet(uf).parser,e,{from:0,to:i});return n.work(20,i)||n.takeTree(),new _y(n)}}jl.state=$r.define({create:_y.init,update(s,e){for(let i of e.effects)if(i.is(jl.setState))return i.value;return e.startState.facet(uf)!=e.state.facet(uf)?_y.init(e.state):s.apply(e)}});let hK=s=>{let e=setTimeout(()=>s(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(hK=s=>{let e=-1,i=setTimeout(()=>{e=requestIdleCallback(s,{timeout:400})},100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const ZP=typeof navigator<"u"&&(!((qP=navigator.scheduling)===null||qP===void 0)&&qP.isInputPending)?()=>navigator.scheduling.isInputPending():null,Z$e=js.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let i=this.view.state.field(jl.state).context;(i.updateViewport(e.view.viewport)||this.view.viewport.to>i.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(i)}scheduleWork(){if(this.working)return;let{state:e}=this.view,i=e.field(jl.state);(i.tree!=i.context.tree||!i.context.isDone(e.doc.length))&&(this.working=hK(this.work))}work(e){this.working=null;let i=Date.now();if(this.chunkEnd<i&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=i+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:r}}=this.view,o=n.field(jl.state);if(o.tree==o.context.tree&&o.context.isDone(r+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!ZP?Math.max(25,e.timeRemaining()-5):1e9),l=o.context.treeLen<r&&n.doc.length>r+1e3,h=o.context.work(()=>ZP&&ZP()||Date.now()>a,r+(l?0:1e5));this.chunkBudget-=Date.now()-i,(h||this.chunkBudget<=0)&&(o.context.takeTree(),this.view.dispatch({effects:jl.setState.of(new _y(o.context))})),this.chunkBudget>0&&!(h&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(o.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(i=>Ko(this.view.state,i)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),uf=Pt.define({combine(s){return s.length?s[0]:null},enables:s=>[jl.state,Z$e,Ot.contentAttributes.compute([s],e=>{let i=e.facet(s);return i&&i.name?{"data-language":i.name}:{}})]});class K$e{constructor(e,i=[]){this.language=e,this.support=i,this.extension=[e,i]}}const J$e=Pt.define(),L3=Pt.define({combine:s=>{if(!s.length)return"  ";let e=s[0];if(!e||/\S/.test(e)||Array.from(e).some(i=>i!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(s[0]));return e}});function fT(s){let e=s.facet(L3);return e.charCodeAt(0)==9?s.tabSize*e.length:e.length}function eb(s,e){let i="",n=s.tabSize,r=s.facet(L3)[0];if(r=="	"){for(;e>=n;)i+="	",e-=n;r=" "}for(let o=0;o<e;o++)i+=r;return i}function N3(s,e){s instanceof gn&&(s=new nE(s));for(let n of s.state.facet(J$e)){let r=n(s,e);if(r!==void 0)return r}let i=eo(s.state);return i.length>=e?eUe(s,i,e):null}class nE{constructor(e,i={}){this.state=e,this.options=i,this.unit=fT(e)}lineAt(e,i=1){let n=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:o}=this.options;return r!=null&&r>=n.from&&r<=n.to?o&&r==e?{text:"",from:e}:(i<0?r<e:r<=e)?{text:n.text.slice(r-n.from),from:r}:{text:n.text.slice(0,r-n.from),from:n.from}:n}textAfterPos(e,i=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:r}=this.lineAt(e,i);return n.slice(e-r,Math.min(n.length,e+100-r))}column(e,i=1){let{text:n,from:r}=this.lineAt(e,i),o=this.countColumn(n,e-r),a=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return a>-1&&(o+=a-this.countColumn(n,n.search(/\S|$/))),o}countColumn(e,i=e.length){return $y(e,this.state.tabSize,i)}lineIndent(e,i=1){let{text:n,from:r}=this.lineAt(e,i),o=this.options.overrideIndentation;if(o){let a=o(r);if(a>-1)return a}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const uK=new Hi;function eUe(s,e,i){let n=e.resolveStack(i),r=n.node.enterUnfinishedNodesBefore(i);if(r!=n.node){let o=[];for(let a=r;a!=n.node;a=a.parent)o.push(a);for(let a=o.length-1;a>=0;a--)n={node:o[a],next:n}}return dK(n,s,i)}function dK(s,e,i){for(let n=s;n;n=n.next){let r=iUe(n.node);if(r)return r(V3.create(e,i,n))}return 0}function tUe(s){return s.pos==s.options.simulateBreak&&s.options.simulateDoubleBreak}function iUe(s){let e=s.type.prop(uK);if(e)return e;let i=s.firstChild,n;if(i&&(n=i.type.prop(Hi.closedBy))){let r=s.lastChild,o=r&&n.indexOf(r.name)>-1;return a=>fK(a,!0,1,void 0,o&&!tUe(a)?r.from:void 0)}return s.parent==null?nUe:null}function nUe(){return 0}class V3 extends nE{constructor(e,i,n){super(e.state,e.options),this.base=e,this.pos=i,this.context=n}get node(){return this.context.node}static create(e,i,n){return new V3(e,i,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let i=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(i.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(sUe(n,e))break;i=this.state.doc.lineAt(n.from)}return this.lineIndent(i.from)}continue(){return dK(this.context.next,this.base,this.pos)}}function sUe(s,e){for(let i=e;i;i=i.parent)if(s==i)return!0;return!1}function rUe(s){let e=s.node,i=e.childAfter(e.from),n=e.lastChild;if(!i)return null;let r=s.options.simulateBreak,o=s.state.doc.lineAt(i.from),a=r==null||r<=o.from?o.to:Math.min(o.to,r);for(let l=i.to;;){let h=e.childAfter(l);if(!h||h==n)return null;if(!h.type.isSkipped)return h.from<a?i:null;l=h.to}}function oUe({closing:s,align:e=!0,units:i=1}){return n=>fK(n,e,i,s)}function fK(s,e,i,n,r){let o=s.textAfter,a=o.match(/^\s*/)[0].length,l=n&&o.slice(a,a+n.length)==n||r==s.pos+a,h=e?rUe(s):null;return h?l?s.column(h.from):s.column(h.to):s.baseIndent+(l?0:s.unit*i)}const aUe=s=>s.baseIndent;function KP({except:s,units:e=1}={}){return i=>{let n=s&&s.test(i.textAfter);return i.baseIndent+(n?0:e*i.unit)}}const lUe=200;function cUe(){return gn.transactionFilter.of(s=>{if(!s.docChanged||!s.isUserEvent("input.type")&&!s.isUserEvent("input.complete"))return s;let e=s.startState.languageDataAt("indentOnInput",s.startState.selection.main.head);if(!e.length)return s;let i=s.newDoc,{head:n}=s.newSelection.main,r=i.lineAt(n);if(n>r.from+lUe)return s;let o=i.sliceString(r.from,n);if(!e.some(d=>d.test(o)))return s;let{state:a}=s,l=-1,h=[];for(let{head:d}of a.selection.ranges){let f=a.doc.lineAt(d);if(f.from==l)continue;l=f.from;let p=N3(a,f.from);if(p==null)continue;let g=/^\s*/.exec(f.text)[0],y=eb(a,p);g!=y&&h.push({from:f.from,to:f.from+g.length,insert:y})}return h.length?[s,{changes:h,sequential:!0}]:s})}const hUe=Pt.define(),pK=new Hi;function uUe(s){let e=s.firstChild,i=s.lastChild;return e&&e.to<i.from?{from:e.to,to:i.type.isError?s.to:i.from}:null}function dUe(s,e,i){let n=eo(s);if(n.length<i)return null;let r=n.resolveStack(i,1),o=null;for(let a=r;a;a=a.next){let l=a.node;if(l.to<=i||l.from>i)continue;if(o&&l.from<e)break;let h=l.type.prop(pK);if(h&&(l.to<n.length-50||n.length==s.doc.length||!fUe(l))){let d=h(l,s);d&&d.from<=i&&d.from>=e&&d.to>i&&(o=d)}}return o}function fUe(s){let e=s.lastChild;return e&&e.to==s.to&&e.type.isError}function pT(s,e,i){for(let n of s.facet(hUe)){let r=n(s,e,i);if(r)return r}return dUe(s,e,i)}function mK(s,e){let i=e.mapPos(s.from,1),n=e.mapPos(s.to,-1);return i>=n?void 0:{from:i,to:n}}const sE=Fi.define({map:mK}),Xb=Fi.define({map:mK});function gK(s){let e=[];for(let{head:i}of s.state.selection.ranges)e.some(n=>n.from<=i&&n.to>=i)||e.push(s.lineBlockAt(i));return e}const Om=$r.define({create(){return fi.none},update(s,e){s=s.map(e.changes);for(let i of e.effects)if(i.is(sE)&&!pUe(s,i.value.from,i.value.to)){let{preparePlaceholder:n}=e.state.facet(xK),r=n?fi.replace({widget:new bUe(n(e.state,i.value))}):nW;s=s.update({add:[r.range(i.value.from,i.value.to)]})}else i.is(Xb)&&(s=s.update({filter:(n,r)=>i.value.from!=n||i.value.to!=r,filterFrom:i.value.from,filterTo:i.value.to}));if(e.selection){let i=!1,{head:n}=e.selection.main;s.between(n,n,(r,o)=>{r<n&&o>n&&(i=!0)}),i&&(s=s.update({filterFrom:n,filterTo:n,filter:(r,o)=>o<=n||r>=n}))}return s},provide:s=>Ot.decorations.from(s),toJSON(s,e){let i=[];return s.between(0,e.doc.length,(n,r)=>{i.push(n,r)}),i},fromJSON(s){if(!Array.isArray(s)||s.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let i=0;i<s.length;){let n=s[i++],r=s[i++];if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(nW.range(n,r))}return fi.set(e,!0)}});function mT(s,e,i){var n;let r=null;return(n=s.field(Om,!1))===null||n===void 0||n.between(e,i,(o,a)=>{(!r||r.from>o)&&(r={from:o,to:a})}),r}function pUe(s,e,i){let n=!1;return s.between(e,e,(r,o)=>{r==e&&o==i&&(n=!0)}),n}function yK(s,e){return s.field(Om,!1)?e:e.concat(Fi.appendConfig.of(_K()))}const mUe=s=>{for(let e of gK(s)){let i=pT(s.state,e.from,e.to);if(i)return s.dispatch({effects:yK(s.state,[sE.of(i),vK(s,i)])}),!0}return!1},gUe=s=>{if(!s.state.field(Om,!1))return!1;let e=[];for(let i of gK(s)){let n=mT(s.state,i.from,i.to);n&&e.push(Xb.of(n),vK(s,n,!1))}return e.length&&s.dispatch({effects:e}),e.length>0};function vK(s,e,i=!0){let n=s.state.doc.lineAt(e.from).number,r=s.state.doc.lineAt(e.to).number;return Ot.announce.of(`${s.state.phrase(i?"Folded lines":"Unfolded lines")} ${n} ${s.state.phrase("to")} ${r}.`)}const yUe=s=>{let{state:e}=s,i=[];for(let n=0;n<e.doc.length;){let r=s.lineBlockAt(n),o=pT(e,r.from,r.to);o&&i.push(sE.of(o)),n=(o?s.lineBlockAt(o.to):r).to+1}return i.length&&s.dispatch({effects:yK(s.state,i)}),!!i.length},vUe=s=>{let e=s.state.field(Om,!1);if(!e||!e.size)return!1;let i=[];return e.between(0,s.state.doc.length,(n,r)=>{i.push(Xb.of({from:n,to:r}))}),s.dispatch({effects:i}),!0},xUe=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:mUe},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:gUe},{key:"Ctrl-Alt-[",run:yUe},{key:"Ctrl-Alt-]",run:vUe}],_Ue={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},xK=Pt.define({combine(s){return fh(s,_Ue)}});function _K(s){return[Om,SUe]}function bK(s,e){let{state:i}=s,n=i.facet(xK),r=a=>{let l=s.lineBlockAt(s.posAtDOM(a.target)),h=mT(s.state,l.from,l.to);h&&s.dispatch({effects:Xb.of(h)}),a.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(s,r,e);let o=document.createElement("span");return o.textContent=n.placeholderText,o.setAttribute("aria-label",i.phrase("folded code")),o.title=i.phrase("unfold"),o.className="cm-foldPlaceholder",o.onclick=r,o}const nW=fi.replace({widget:new class extends Of{toDOM(s){return bK(s,null)}}});class bUe extends Of{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return bK(e,this.value)}}const wUe={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class JP extends Cu{constructor(e,i){super(),this.config=e,this.open=i}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let i=document.createElement("span");return i.textContent=this.open?this.config.openText:this.config.closedText,i.title=e.state.phrase(this.open?"Fold line":"Unfold line"),i}}function OUe(s={}){let e=Object.assign(Object.assign({},wUe),s),i=new JP(e,!0),n=new JP(e,!1),r=js.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(uf)!=a.state.facet(uf)||a.startState.field(Om,!1)!=a.state.field(Om,!1)||eo(a.startState)!=eo(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let l=new rf;for(let h of a.viewportLineBlocks){let d=mT(a.state,h.from,h.to)?n:pT(a.state,h.from,h.to)?i:null;d&&l.add(h.from,h.from,d)}return l.finish()}}),{domEventHandlers:o}=e;return[r,w$e({class:"cm-foldGutter",markers(a){var l;return((l=a.plugin(r))===null||l===void 0?void 0:l.markers)||fn.empty},initialSpacer(){return new JP(e,!1)},domEventHandlers:Object.assign(Object.assign({},o),{click:(a,l,h)=>{if(o.click&&o.click(a,l,h))return!0;let d=mT(a.state,l.from,l.to);if(d)return a.dispatch({effects:Xb.of(d)}),!0;let f=pT(a.state,l.from,l.to);return f?(a.dispatch({effects:sE.of(f)}),!0):!1}})}),_K()]}const SUe=Ot.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class rE{constructor(e,i){this.specs=e;let n;function r(l){let h=of.newName();return(n||(n=Object.create(null)))["."+h]=l,h}const o=typeof i.all=="string"?i.all:i.all?r(i.all):void 0,a=i.scope;this.scope=a instanceof jl?l=>l.prop(g0)==a.data:a?l=>l==a:void 0,this.style=cK(e.map(l=>({tag:l.tag,class:l.class||r(Object.assign({},l,{tag:null}))})),{all:o}).style,this.module=n?new of(n):null,this.themeType=i.themeType}static define(e,i){return new rE(e,i||{})}}const RR=Pt.define(),wK=Pt.define({combine(s){return s.length?[s[0]]:null}});function e2(s){let e=s.facet(RR);return e.length?e:s.facet(wK)}function CUe(s,e){let i=[AUe],n;return s instanceof rE&&(s.module&&i.push(Ot.styleModule.of(s.module)),n=s.themeType),e!=null&&e.fallback?i.push(wK.of(s)):n?i.push(RR.computeN([Ot.darkTheme],r=>r.facet(Ot.darkTheme)==(n=="dark")?[s]:[])):i.push(RR.of(s)),i}class TUe{constructor(e){this.markCache=Object.create(null),this.tree=eo(e.state),this.decorations=this.buildDeco(e,e2(e.state)),this.decoratedTo=e.viewport.to}update(e){let i=eo(e.state),n=e2(e.state),r=n!=e2(e.startState),{viewport:o}=e.view,a=e.changes.mapPos(this.decoratedTo,1);i.length<o.to&&!r&&i.type==this.tree.type&&a>=o.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(i!=this.tree||e.viewportChanged||r)&&(this.tree=i,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=o.to)}buildDeco(e,i){if(!i||!this.tree.length)return fi.none;let n=new rf;for(let{from:r,to:o}of e.visibleRanges)H$e(this.tree,i,(a,l,h)=>{n.add(a,l,this.markCache[h]||(this.markCache[h]=fi.mark({class:h})))},r,o);return n.finish()}}const AUe=Rm.high(js.fromClass(TUe,{decorations:s=>s.decorations})),EUe=rE.define([{tag:We.meta,color:"#404740"},{tag:We.link,textDecoration:"underline"},{tag:We.heading,textDecoration:"underline",fontWeight:"bold"},{tag:We.emphasis,fontStyle:"italic"},{tag:We.strong,fontWeight:"bold"},{tag:We.strikethrough,textDecoration:"line-through"},{tag:We.keyword,color:"#708"},{tag:[We.atom,We.bool,We.url,We.contentSeparator,We.labelName],color:"#219"},{tag:[We.literal,We.inserted],color:"#164"},{tag:[We.string,We.deleted],color:"#a11"},{tag:[We.regexp,We.escape,We.special(We.string)],color:"#e40"},{tag:We.definition(We.variableName),color:"#00f"},{tag:We.local(We.variableName),color:"#30a"},{tag:[We.typeName,We.namespace],color:"#085"},{tag:We.className,color:"#167"},{tag:[We.special(We.variableName),We.macroName],color:"#256"},{tag:We.definition(We.propertyName),color:"#00c"},{tag:We.comment,color:"#940"},{tag:We.invalid,color:"#f00"}]),MUe=Ot.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),OK=1e4,SK="()[]{}",CK=Pt.define({combine(s){return fh(s,{afterCursor:!0,brackets:SK,maxScanDistance:OK,renderMatch:IUe})}}),kUe=fi.mark({class:"cm-matchingBracket"}),PUe=fi.mark({class:"cm-nonmatchingBracket"});function IUe(s){let e=[],i=s.matched?kUe:PUe;return e.push(i.range(s.start.from,s.start.to)),s.end&&e.push(i.range(s.end.from,s.end.to)),e}const BUe=$r.define({create(){return fi.none},update(s,e){if(!e.docChanged&&!e.selection)return s;let i=[],n=e.state.facet(CK);for(let r of e.state.selection.ranges){if(!r.empty)continue;let o=jc(e.state,r.head,-1,n)||r.head>0&&jc(e.state,r.head-1,1,n)||n.afterCursor&&(jc(e.state,r.head,1,n)||r.head<e.state.doc.length&&jc(e.state,r.head+1,-1,n));o&&(i=i.concat(n.renderMatch(o,e.state)))}return fi.set(i,!0)},provide:s=>Ot.decorations.from(s)}),RUe=[BUe,MUe];function DUe(s={}){return[CK.of(s),RUe]}const LUe=new Hi;function DR(s,e,i){let n=s.prop(e<0?Hi.openedBy:Hi.closedBy);if(n)return n;if(s.name.length==1){let r=i.indexOf(s.name);if(r>-1&&r%2==(e<0?1:0))return[i[r+e]]}return null}function LR(s){let e=s.type.prop(LUe);return e?e(s.node):s}function jc(s,e,i,n={}){let r=n.maxScanDistance||OK,o=n.brackets||SK,a=eo(s),l=a.resolveInner(e,i);for(let h=l;h;h=h.parent){let d=DR(h.type,i,o);if(d&&h.from<h.to){let f=LR(h);if(f&&(i>0?e>=f.from&&e<f.to:e>f.from&&e<=f.to))return NUe(s,e,i,h,f,d,o)}}return VUe(s,e,i,a,l.type,r,o)}function NUe(s,e,i,n,r,o,a){let l=n.parent,h={from:r.from,to:r.to},d=0,f=l==null?void 0:l.cursor();if(f&&(i<0?f.childBefore(n.from):f.childAfter(n.to)))do if(i<0?f.to<=n.from:f.from>=n.to){if(d==0&&o.indexOf(f.type.name)>-1&&f.from<f.to){let p=LR(f);return{start:h,end:p?{from:p.from,to:p.to}:void 0,matched:!0}}else if(DR(f.type,i,a))d++;else if(DR(f.type,-i,a)){if(d==0){let p=LR(f);return{start:h,end:p&&p.from<p.to?{from:p.from,to:p.to}:void 0,matched:!1}}d--}}while(i<0?f.prevSibling():f.nextSibling());return{start:h,matched:!1}}function VUe(s,e,i,n,r,o,a){let l=i<0?s.sliceDoc(e-1,e):s.sliceDoc(e,e+1),h=a.indexOf(l);if(h<0||h%2==0!=i>0)return null;let d={from:i<0?e-1:e,to:i>0?e+1:e},f=s.doc.iterRange(e,i>0?s.doc.length:0),p=0;for(let g=0;!f.next().done&&g<=o;){let y=f.value;i<0&&(g+=y.length);let x=e+g*i;for(let _=i>0?0:y.length-1,w=i>0?y.length:-1;_!=w;_+=i){let O=a.indexOf(y[_]);if(!(O<0||n.resolveInner(x+_,1).type!=r))if(O%2==0==i>0)p++;else{if(p==1)return{start:d,end:{from:x+_,to:x+_+1},matched:O>>1==h>>1};p--}}i>0&&(g+=y.length)}return f.done?{start:d,matched:!1}:null}const $Ue=Object.create(null),sW=[sa.none],rW=[],oW=Object.create(null),UUe=Object.create(null);for(let[s,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])UUe[s]=FUe($Ue,e);function t2(s,e){rW.indexOf(s)>-1||(rW.push(s),console.warn(e))}function FUe(s,e){let i=[];for(let l of e.split(" ")){let h=[];for(let d of l.split(".")){let f=s[d]||We[d];f?typeof f=="function"?h.length?h=h.map(f):t2(d,`Modifier ${d} used at start of tag`):h.length?t2(d,`Tag ${d} used as modifier`):h=Array.isArray(f)?f:[f]:t2(d,`Unknown highlighting tag ${d}`)}for(let d of h)i.push(d)}if(!i.length)return 0;let n=e.replace(/ /g,"_"),r=n+" "+i.map(l=>l.id),o=oW[r];if(o)return o.id;let a=oW[r]=sa.define({id:sW.length,name:n,props:[aK({[n]:i})]});return sW.push(a),a.id}Jn.RTL,Jn.LTR;const zUe=s=>{let{state:e}=s,i=e.doc.lineAt(e.selection.main.from),n=U3(s.state,i.from);return n.line?XUe(s):n.block?HUe(s):!1};function $3(s,e){return({state:i,dispatch:n})=>{if(i.readOnly)return!1;let r=s(e,i);return r?(n(i.update(r)),!0):!1}}const XUe=$3(YUe,0),WUe=$3(TK,0),HUe=$3((s,e)=>TK(s,e,QUe(e)),0);function U3(s,e){let i=s.languageDataAt("commentTokens",e);return i.length?i[0]:{}}const nx=50;function GUe(s,{open:e,close:i},n,r){let o=s.sliceDoc(n-nx,n),a=s.sliceDoc(r,r+nx),l=/\s*$/.exec(o)[0].length,h=/^\s*/.exec(a)[0].length,d=o.length-l;if(o.slice(d-e.length,d)==e&&a.slice(h,h+i.length)==i)return{open:{pos:n-l,margin:l&&1},close:{pos:r+h,margin:h&&1}};let f,p;r-n<=2*nx?f=p=s.sliceDoc(n,r):(f=s.sliceDoc(n,n+nx),p=s.sliceDoc(r-nx,r));let g=/^\s*/.exec(f)[0].length,y=/\s*$/.exec(p)[0].length,x=p.length-y-i.length;return f.slice(g,g+e.length)==e&&p.slice(x,x+i.length)==i?{open:{pos:n+g+e.length,margin:/\s/.test(f.charAt(g+e.length))?1:0},close:{pos:r-y-i.length,margin:/\s/.test(p.charAt(x-1))?1:0}}:null}function QUe(s){let e=[];for(let i of s.selection.ranges){let n=s.doc.lineAt(i.from),r=i.to<=n.to?n:s.doc.lineAt(i.to),o=e.length-1;o>=0&&e[o].to>n.from?e[o].to=r.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:r.to})}return e}function TK(s,e,i=e.selection.ranges){let n=i.map(o=>U3(e,o.from).block);if(!n.every(o=>o))return null;let r=i.map((o,a)=>GUe(e,n[a],o.from,o.to));if(s!=2&&!r.every(o=>o))return{changes:e.changes(i.map((o,a)=>r[a]?[]:[{from:o.from,insert:n[a].open+" "},{from:o.to,insert:" "+n[a].close}]))};if(s!=1&&r.some(o=>o)){let o=[];for(let a=0,l;a<r.length;a++)if(l=r[a]){let h=n[a],{open:d,close:f}=l;o.push({from:d.pos-h.open.length,to:d.pos+d.margin},{from:f.pos-f.margin,to:f.pos+h.close.length})}return{changes:o}}return null}function YUe(s,e,i=e.selection.ranges){let n=[],r=-1;for(let{from:o,to:a}of i){let l=n.length,h=1e9,d=U3(e,o).line;if(d){for(let f=o;f<=a;){let p=e.doc.lineAt(f);if(p.from>r&&(o==a||a>p.from)){r=p.from;let g=/^\s*/.exec(p.text)[0].length,y=g==p.length,x=p.text.slice(g,g+d.length)==d?g:-1;g<p.text.length&&g<h&&(h=g),n.push({line:p,comment:x,token:d,indent:g,empty:y,single:!1})}f=p.to+1}if(h<1e9)for(let f=l;f<n.length;f++)n[f].indent<n[f].line.text.length&&(n[f].indent=h);n.length==l+1&&(n[l].single=!0)}}if(s!=2&&n.some(o=>o.comment<0&&(!o.empty||o.single))){let o=[];for(let{line:l,token:h,indent:d,empty:f,single:p}of n)(p||!f)&&o.push({from:l.from+d,insert:h+" "});let a=e.changes(o);return{changes:a,selection:e.selection.map(a,1)}}else if(s!=1&&n.some(o=>o.comment>=0)){let o=[];for(let{line:a,comment:l,token:h}of n)if(l>=0){let d=a.from+l,f=d+h.length;a.text[f-a.from]==" "&&f++,o.push({from:d,to:f})}return{changes:o}}return null}const NR=Pu.define(),jUe=Pu.define(),qUe=Pt.define(),AK=Pt.define({combine(s){return fh(s,{minDepth:100,newGroupDelay:500,joinToEvent:(e,i)=>i},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,i)=>(n,r)=>e(n,r)||i(n,r)})}}),EK=$r.define({create(){return qc.empty},update(s,e){let i=e.state.facet(AK),n=e.annotation(NR);if(n){let h=Jo.fromTransaction(e,n.selection),d=n.side,f=d==0?s.undone:s.done;return h?f=gT(f,f.length,i.minDepth,h):f=PK(f,e.startState.selection),new qc(d==0?n.rest:f,d==0?f:n.rest)}let r=e.annotation(jUe);if((r=="full"||r=="before")&&(s=s.isolate()),e.annotation(cr.addToHistory)===!1)return e.changes.empty?s:s.addMapping(e.changes.desc);let o=Jo.fromTransaction(e),a=e.annotation(cr.time),l=e.annotation(cr.userEvent);return o?s=s.addChanges(o,a,l,i,e):e.selection&&(s=s.addSelection(e.startState.selection,a,l,i.newGroupDelay)),(r=="full"||r=="after")&&(s=s.isolate()),s},toJSON(s){return{done:s.done.map(e=>e.toJSON()),undone:s.undone.map(e=>e.toJSON())}},fromJSON(s){return new qc(s.done.map(Jo.fromJSON),s.undone.map(Jo.fromJSON))}});function ZUe(s={}){return[EK,AK.of(s),Ot.domEventHandlers({beforeinput(e,i){let n=e.inputType=="historyUndo"?MK:e.inputType=="historyRedo"?VR:null;return n?(e.preventDefault(),n(i)):!1}})]}function oE(s,e){return function({state:i,dispatch:n}){if(!e&&i.readOnly)return!1;let r=i.field(EK,!1);if(!r)return!1;let o=r.pop(s,i,e);return o?(n(o),!0):!1}}const MK=oE(0,!1),VR=oE(1,!1),KUe=oE(0,!0),JUe=oE(1,!0);class Jo{constructor(e,i,n,r,o){this.changes=e,this.effects=i,this.mapped=n,this.startSelection=r,this.selectionsAfter=o}setSelAfter(e){return new Jo(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,i,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(i=this.mapped)===null||i===void 0?void 0:i.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new Jo(e.changes&&sr.fromJSON(e.changes),[],e.mapped&&Jc.fromJSON(e.mapped),e.startSelection&&et.fromJSON(e.startSelection),e.selectionsAfter.map(et.fromJSON))}static fromTransaction(e,i){let n=dl;for(let r of e.startState.facet(qUe)){let o=r(e);o.length&&(n=n.concat(o))}return!n.length&&e.changes.empty?null:new Jo(e.changes.invert(e.startState.doc),n,void 0,i||e.startState.selection,dl)}static selection(e){return new Jo(void 0,dl,void 0,void 0,e)}}function gT(s,e,i,n){let r=e+1>i+20?e-i-1:0,o=s.slice(r,e);return o.push(n),o}function eFe(s,e){let i=[],n=!1;return s.iterChangedRanges((r,o)=>i.push(r,o)),e.iterChangedRanges((r,o,a,l)=>{for(let h=0;h<i.length;){let d=i[h++],f=i[h++];l>=d&&a<=f&&(n=!0)}}),n}function tFe(s,e){return s.ranges.length==e.ranges.length&&s.ranges.filter((i,n)=>i.empty!=e.ranges[n].empty).length===0}function kK(s,e){return s.length?e.length?s.concat(e):s:e}const dl=[],iFe=200;function PK(s,e){if(s.length){let i=s[s.length-1],n=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-iFe));return n.length&&n[n.length-1].eq(e)?s:(n.push(e),gT(s,s.length-1,1e9,i.setSelAfter(n)))}else return[Jo.selection([e])]}function nFe(s){let e=s[s.length-1],i=s.slice();return i[s.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),i}function i2(s,e){if(!s.length)return s;let i=s.length,n=dl;for(;i;){let r=sFe(s[i-1],e,n);if(r.changes&&!r.changes.empty||r.effects.length){let o=s.slice(0,i);return o[i-1]=r,o}else e=r.mapped,i--,n=r.selectionsAfter}return n.length?[Jo.selection(n)]:dl}function sFe(s,e,i){let n=kK(s.selectionsAfter.length?s.selectionsAfter.map(l=>l.map(e)):dl,i);if(!s.changes)return Jo.selection(n);let r=s.changes.map(e),o=e.mapDesc(s.changes,!0),a=s.mapped?s.mapped.composeDesc(o):o;return new Jo(r,Fi.mapEffects(s.effects,e),a,s.startSelection.map(o),n)}const rFe=/^(input\.type|delete)($|\.)/;class qc{constructor(e,i,n=0,r=void 0){this.done=e,this.undone=i,this.prevTime=n,this.prevUserEvent=r}isolate(){return this.prevTime?new qc(this.done,this.undone):this}addChanges(e,i,n,r,o){let a=this.done,l=a[a.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!n||rFe.test(n))&&(!l.selectionsAfter.length&&i-this.prevTime<r.newGroupDelay&&r.joinToEvent(o,eFe(l.changes,e.changes))||n=="input.type.compose")?a=gT(a,a.length-1,r.minDepth,new Jo(e.changes.compose(l.changes),kK(Fi.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,dl)):a=gT(a,a.length,r.minDepth,e),new qc(a,dl,i,n)}addSelection(e,i,n,r){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:dl;return o.length>0&&i-this.prevTime<r&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&tFe(o[o.length-1],e)?this:new qc(PK(this.done,e),this.undone,i,n)}addMapping(e){return new qc(i2(this.done,e),i2(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,i,n){let r=e==0?this.done:this.undone;if(r.length==0)return null;let o=r[r.length-1],a=o.selectionsAfter[0]||i.selection;if(n&&o.selectionsAfter.length)return i.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:NR.of({side:e,rest:nFe(r),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let l=r.length==1?dl:r.slice(0,r.length-1);return o.mapped&&(l=i2(l,o.mapped)),i.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:NR.of({side:e,rest:l,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}qc.empty=new qc(dl,dl);const oFe=[{key:"Mod-z",run:MK,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:VR,preventDefault:!0},{linux:"Ctrl-Shift-z",run:VR,preventDefault:!0},{key:"Mod-u",run:KUe,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:JUe,preventDefault:!0}];function Uy(s,e){return et.create(s.ranges.map(e),s.mainIndex)}function ph(s,e){return s.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function uc({state:s,dispatch:e},i){let n=Uy(s.selection,i);return n.eq(s.selection,!0)?!1:(e(ph(s,n)),!0)}function aE(s,e){return et.cursor(e?s.to:s.from)}function IK(s,e){return uc(s,i=>i.empty?s.moveByChar(i,e):aE(i,e))}function ro(s){return s.textDirectionAt(s.state.selection.main.head)==Jn.LTR}const BK=s=>IK(s,!ro(s)),RK=s=>IK(s,ro(s));function DK(s,e){return uc(s,i=>i.empty?s.moveByGroup(i,e):aE(i,e))}const aFe=s=>DK(s,!ro(s)),lFe=s=>DK(s,ro(s));function cFe(s,e,i){if(e.type.prop(i))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(s.sliceDoc(e.from,e.to)))||e.firstChild}function lE(s,e,i){let n=eo(s).resolveInner(e.head),r=i?Hi.closedBy:Hi.openedBy;for(let h=e.head;;){let d=i?n.childAfter(h):n.childBefore(h);if(!d)break;cFe(s,d,r)?n=d:h=i?d.to:d.from}let o=n.type.prop(r),a,l;return o&&(a=i?jc(s,n.from,1):jc(s,n.to,-1))&&a.matched?l=i?a.end.to:a.end.from:l=i?n.to:n.from,et.cursor(l,i?-1:1)}const hFe=s=>uc(s,e=>lE(s.state,e,!ro(s))),uFe=s=>uc(s,e=>lE(s.state,e,ro(s)));function LK(s,e){return uc(s,i=>{if(!i.empty)return aE(i,e);let n=s.moveVertically(i,e);return n.head!=i.head?n:s.moveToLineBoundary(i,e)})}const NK=s=>LK(s,!1),VK=s=>LK(s,!0);function $K(s){let e=s.scrollDOM.clientHeight<s.scrollDOM.scrollHeight-2,i=0,n=0,r;if(e){for(let o of s.state.facet(Ot.scrollMargins)){let a=o(s);a!=null&&a.top&&(i=Math.max(a==null?void 0:a.top,i)),a!=null&&a.bottom&&(n=Math.max(a==null?void 0:a.bottom,n))}r=s.scrollDOM.clientHeight-i-n}else r=(s.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:i,marginBottom:n,selfScroll:e,height:Math.max(s.defaultLineHeight,r-5)}}function UK(s,e){let i=$K(s),{state:n}=s,r=Uy(n.selection,a=>a.empty?s.moveVertically(a,e,i.height):aE(a,e));if(r.eq(n.selection))return!1;let o;if(i.selfScroll){let a=s.coordsAtPos(n.selection.main.head),l=s.scrollDOM.getBoundingClientRect(),h=l.top+i.marginTop,d=l.bottom-i.marginBottom;a&&a.top>h&&a.bottom<d&&(o=Ot.scrollIntoView(r.main.head,{y:"start",yMargin:a.top-h}))}return s.dispatch(ph(n,r),{effects:o}),!0}const aW=s=>UK(s,!1),$R=s=>UK(s,!0);function Sf(s,e,i){let n=s.lineBlockAt(e.head),r=s.moveToLineBoundary(e,i);if(r.head==e.head&&r.head!=(i?n.to:n.from)&&(r=s.moveToLineBoundary(e,i,!1)),!i&&r.head==n.from&&n.length){let o=/^\s*/.exec(s.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;o&&e.head!=n.from+o&&(r=et.cursor(n.from+o))}return r}const dFe=s=>uc(s,e=>Sf(s,e,!0)),fFe=s=>uc(s,e=>Sf(s,e,!1)),pFe=s=>uc(s,e=>Sf(s,e,!ro(s))),mFe=s=>uc(s,e=>Sf(s,e,ro(s))),gFe=s=>uc(s,e=>et.cursor(s.lineBlockAt(e.head).from,1)),yFe=s=>uc(s,e=>et.cursor(s.lineBlockAt(e.head).to,-1));function vFe(s,e,i){let n=!1,r=Uy(s.selection,o=>{let a=jc(s,o.head,-1)||jc(s,o.head,1)||o.head>0&&jc(s,o.head-1,1)||o.head<s.doc.length&&jc(s,o.head+1,-1);if(!a||!a.end)return o;n=!0;let l=a.start.from==o.head?a.end.to:a.end.from;return et.cursor(l)});return n?(e(ph(s,r)),!0):!1}const xFe=({state:s,dispatch:e})=>vFe(s,e);function vl(s,e){let i=Uy(s.state.selection,n=>{let r=e(n);return et.range(n.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return i.eq(s.state.selection)?!1:(s.dispatch(ph(s.state,i)),!0)}function FK(s,e){return vl(s,i=>s.moveByChar(i,e))}const zK=s=>FK(s,!ro(s)),XK=s=>FK(s,ro(s));function WK(s,e){return vl(s,i=>s.moveByGroup(i,e))}const _Fe=s=>WK(s,!ro(s)),bFe=s=>WK(s,ro(s)),wFe=s=>vl(s,e=>lE(s.state,e,!ro(s))),OFe=s=>vl(s,e=>lE(s.state,e,ro(s)));function HK(s,e){return vl(s,i=>s.moveVertically(i,e))}const GK=s=>HK(s,!1),QK=s=>HK(s,!0);function YK(s,e){return vl(s,i=>s.moveVertically(i,e,$K(s).height))}const lW=s=>YK(s,!1),cW=s=>YK(s,!0),SFe=s=>vl(s,e=>Sf(s,e,!0)),CFe=s=>vl(s,e=>Sf(s,e,!1)),TFe=s=>vl(s,e=>Sf(s,e,!ro(s))),AFe=s=>vl(s,e=>Sf(s,e,ro(s))),EFe=s=>vl(s,e=>et.cursor(s.lineBlockAt(e.head).from)),MFe=s=>vl(s,e=>et.cursor(s.lineBlockAt(e.head).to)),hW=({state:s,dispatch:e})=>(e(ph(s,{anchor:0})),!0),uW=({state:s,dispatch:e})=>(e(ph(s,{anchor:s.doc.length})),!0),dW=({state:s,dispatch:e})=>(e(ph(s,{anchor:s.selection.main.anchor,head:0})),!0),fW=({state:s,dispatch:e})=>(e(ph(s,{anchor:s.selection.main.anchor,head:s.doc.length})),!0),kFe=({state:s,dispatch:e})=>(e(s.update({selection:{anchor:0,head:s.doc.length},userEvent:"select"})),!0),PFe=({state:s,dispatch:e})=>{let i=cE(s).map(({from:n,to:r})=>et.range(n,Math.min(r+1,s.doc.length)));return e(s.update({selection:et.create(i),userEvent:"select"})),!0},IFe=({state:s,dispatch:e})=>{let i=Uy(s.selection,n=>{var r;let o=eo(s).resolveStack(n.from,1);for(let a=o;a;a=a.next){let{node:l}=a;if((l.from<n.from&&l.to>=n.to||l.to>n.to&&l.from<=n.from)&&(!((r=l.parent)===null||r===void 0)&&r.parent))return et.range(l.to,l.from)}return n});return e(ph(s,i)),!0},BFe=({state:s,dispatch:e})=>{let i=s.selection,n=null;return i.ranges.length>1?n=et.create([i.main]):i.main.empty||(n=et.create([et.cursor(i.main.head)])),n?(e(ph(s,n)),!0):!1};function Wb(s,e){if(s.state.readOnly)return!1;let i="delete.selection",{state:n}=s,r=n.changeByRange(o=>{let{from:a,to:l}=o;if(a==l){let h=e(o);h<a?(i="delete.backward",h=FO(s,h,!1)):h>a&&(i="delete.forward",h=FO(s,h,!0)),a=Math.min(a,h),l=Math.max(l,h)}else a=FO(s,a,!1),l=FO(s,l,!0);return a==l?{range:o}:{changes:{from:a,to:l},range:et.cursor(a,a<o.head?-1:1)}});return r.changes.empty?!1:(s.dispatch(n.update(r,{scrollIntoView:!0,userEvent:i,effects:i=="delete.selection"?Ot.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function FO(s,e,i){if(s instanceof Ot)for(let n of s.state.facet(Ot.atomicRanges).map(r=>r(s)))n.between(e,e,(r,o)=>{r<e&&o>e&&(e=i?o:r)});return e}const jK=(s,e,i)=>Wb(s,n=>{let r=n.from,{state:o}=s,a=o.doc.lineAt(r),l,h;if(i&&!e&&r>a.from&&r<a.from+200&&!/[^ \t]/.test(l=a.text.slice(0,r-a.from))){if(l[l.length-1]=="	")return r-1;let d=$y(l,o.tabSize),f=d%fT(o)||fT(o);for(let p=0;p<f&&l[l.length-1-p]==" ";p++)r--;h=r}else h=Lr(a.text,r-a.from,e,e)+a.from,h==r&&a.number!=(e?o.doc.lines:1)?h+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(h-a.from,r-a.from))&&(h=Lr(a.text,h-a.from,!1,!1)+a.from);return h}),UR=s=>jK(s,!1,!0),qK=s=>jK(s,!0,!1),ZK=(s,e)=>Wb(s,i=>{let n=i.head,{state:r}=s,o=r.doc.lineAt(n),a=r.charCategorizer(n);for(let l=null;;){if(n==(e?o.to:o.from)){n==i.head&&o.number!=(e?r.doc.lines:1)&&(n+=e?1:-1);break}let h=Lr(o.text,n-o.from,e)+o.from,d=o.text.slice(Math.min(n,h)-o.from,Math.max(n,h)-o.from),f=a(d);if(l!=null&&f!=l)break;(d!=" "||n!=i.head)&&(l=f),n=h}return n}),KK=s=>ZK(s,!1),RFe=s=>ZK(s,!0),DFe=s=>Wb(s,e=>{let i=s.lineBlockAt(e.head).to;return e.head<i?i:Math.min(s.state.doc.length,e.head+1)}),LFe=s=>Wb(s,e=>{let i=s.moveToLineBoundary(e,!1).head;return e.head>i?i:Math.max(0,e.head-1)}),NFe=s=>Wb(s,e=>{let i=s.moveToLineBoundary(e,!0).head;return e.head<i?i:Math.min(s.state.doc.length,e.head+1)}),VFe=({state:s,dispatch:e})=>{if(s.readOnly)return!1;let i=s.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:yn.of(["",""])},range:et.cursor(n.from)}));return e(s.update(i,{scrollIntoView:!0,userEvent:"input"})),!0},$Fe=({state:s,dispatch:e})=>{if(s.readOnly)return!1;let i=s.changeByRange(n=>{if(!n.empty||n.from==0||n.from==s.doc.length)return{range:n};let r=n.from,o=s.doc.lineAt(r),a=r==o.from?r-1:Lr(o.text,r-o.from,!1)+o.from,l=r==o.to?r+1:Lr(o.text,r-o.from,!0)+o.from;return{changes:{from:a,to:l,insert:s.doc.slice(r,l).append(s.doc.slice(a,r))},range:et.cursor(l)}});return i.changes.empty?!1:(e(s.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function cE(s){let e=[],i=-1;for(let n of s.selection.ranges){let r=s.doc.lineAt(n.from),o=s.doc.lineAt(n.to);if(!n.empty&&n.to==o.from&&(o=s.doc.lineAt(n.to-1)),i>=r.number){let a=e[e.length-1];a.to=o.to,a.ranges.push(n)}else e.push({from:r.from,to:o.to,ranges:[n]});i=o.number+1}return e}function JK(s,e,i){if(s.readOnly)return!1;let n=[],r=[];for(let o of cE(s)){if(i?o.to==s.doc.length:o.from==0)continue;let a=s.doc.lineAt(i?o.to+1:o.from-1),l=a.length+1;if(i){n.push({from:o.to,to:a.to},{from:o.from,insert:a.text+s.lineBreak});for(let h of o.ranges)r.push(et.range(Math.min(s.doc.length,h.anchor+l),Math.min(s.doc.length,h.head+l)))}else{n.push({from:a.from,to:o.from},{from:o.to,insert:s.lineBreak+a.text});for(let h of o.ranges)r.push(et.range(h.anchor-l,h.head-l))}}return n.length?(e(s.update({changes:n,scrollIntoView:!0,selection:et.create(r,s.selection.mainIndex),userEvent:"move.line"})),!0):!1}const UFe=({state:s,dispatch:e})=>JK(s,e,!1),FFe=({state:s,dispatch:e})=>JK(s,e,!0);function eJ(s,e,i){if(s.readOnly)return!1;let n=[];for(let r of cE(s))i?n.push({from:r.from,insert:s.doc.slice(r.from,r.to)+s.lineBreak}):n.push({from:r.to,insert:s.lineBreak+s.doc.slice(r.from,r.to)});return e(s.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const zFe=({state:s,dispatch:e})=>eJ(s,e,!1),XFe=({state:s,dispatch:e})=>eJ(s,e,!0),WFe=s=>{if(s.state.readOnly)return!1;let{state:e}=s,i=e.changes(cE(e).map(({from:r,to:o})=>(r>0?r--:o<e.doc.length&&o++,{from:r,to:o}))),n=Uy(e.selection,r=>{let o;if(s.lineWrapping){let a=s.lineBlockAt(r.head),l=s.coordsAtPos(r.head,r.assoc||1);l&&(o=a.bottom+s.documentTop-l.bottom+s.defaultLineHeight/2)}return s.moveVertically(r,!0,o)}).map(i);return s.dispatch({changes:i,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function HFe(s,e){if(/\(\)|\[\]|\{\}/.test(s.sliceDoc(e-1,e+1)))return{from:e,to:e};let i=eo(s).resolveInner(e),n=i.childBefore(e),r=i.childAfter(e),o;return n&&r&&n.to<=e&&r.from>=e&&(o=n.type.prop(Hi.closedBy))&&o.indexOf(r.name)>-1&&s.doc.lineAt(n.to).from==s.doc.lineAt(r.from).from&&!/\S/.test(s.sliceDoc(n.to,r.from))?{from:n.to,to:r.from}:null}const GFe=tJ(!1),QFe=tJ(!0);function tJ(s){return({state:e,dispatch:i})=>{if(e.readOnly)return!1;let n=e.changeByRange(r=>{let{from:o,to:a}=r,l=e.doc.lineAt(o),h=!s&&o==a&&HFe(e,o);s&&(o=a=(a<=l.to?l:e.doc.lineAt(a)).to);let d=new nE(e,{simulateBreak:o,simulateDoubleBreak:!!h}),f=N3(d,o);for(f==null&&(f=$y(/^\s*/.exec(e.doc.lineAt(o).text)[0],e.tabSize));a<l.to&&/\s/.test(l.text[a-l.from]);)a++;h?{from:o,to:a}=h:o>l.from&&o<l.from+100&&!/\S/.test(l.text.slice(0,o))&&(o=l.from);let p=["",eb(e,f)];return h&&p.push(eb(e,d.lineIndent(l.from,-1))),{changes:{from:o,to:a,insert:yn.of(p)},range:et.cursor(o+1+p[1].length)}});return i(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function F3(s,e){let i=-1;return s.changeByRange(n=>{let r=[];for(let a=n.from;a<=n.to;){let l=s.doc.lineAt(a);l.number>i&&(n.empty||n.to>l.from)&&(e(l,r,n),i=l.number),a=l.to+1}let o=s.changes(r);return{changes:r,range:et.range(o.mapPos(n.anchor,1),o.mapPos(n.head,1))}})}const YFe=({state:s,dispatch:e})=>{if(s.readOnly)return!1;let i=Object.create(null),n=new nE(s,{overrideIndentation:o=>{let a=i[o];return a??-1}}),r=F3(s,(o,a,l)=>{let h=N3(n,o.from);if(h==null)return;/\S/.test(o.text)||(h=0);let d=/^\s*/.exec(o.text)[0],f=eb(s,h);(d!=f||l.from<o.from+d.length)&&(i[o.from]=h,a.push({from:o.from,to:o.from+d.length,insert:f}))});return r.changes.empty||e(s.update(r,{userEvent:"indent"})),!0},jFe=({state:s,dispatch:e})=>s.readOnly?!1:(e(s.update(F3(s,(i,n)=>{n.push({from:i.from,insert:s.facet(L3)})}),{userEvent:"input.indent"})),!0),qFe=({state:s,dispatch:e})=>s.readOnly?!1:(e(s.update(F3(s,(i,n)=>{let r=/^\s*/.exec(i.text)[0];if(!r)return;let o=$y(r,s.tabSize),a=0,l=eb(s,Math.max(0,o-fT(s)));for(;a<r.length&&a<l.length&&r.charCodeAt(a)==l.charCodeAt(a);)a++;n.push({from:i.from+a,to:i.from+r.length,insert:l.slice(a)})}),{userEvent:"delete.dedent"})),!0),ZFe=s=>(s.setTabFocusMode(),!0),KFe=[{key:"Ctrl-b",run:BK,shift:zK,preventDefault:!0},{key:"Ctrl-f",run:RK,shift:XK},{key:"Ctrl-p",run:NK,shift:GK},{key:"Ctrl-n",run:VK,shift:QK},{key:"Ctrl-a",run:gFe,shift:EFe},{key:"Ctrl-e",run:yFe,shift:MFe},{key:"Ctrl-d",run:qK},{key:"Ctrl-h",run:UR},{key:"Ctrl-k",run:DFe},{key:"Ctrl-Alt-h",run:KK},{key:"Ctrl-o",run:VFe},{key:"Ctrl-t",run:$Fe},{key:"Ctrl-v",run:$R}],JFe=[{key:"ArrowLeft",run:BK,shift:zK,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:aFe,shift:_Fe,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:pFe,shift:TFe,preventDefault:!0},{key:"ArrowRight",run:RK,shift:XK,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:lFe,shift:bFe,preventDefault:!0},{mac:"Cmd-ArrowRight",run:mFe,shift:AFe,preventDefault:!0},{key:"ArrowUp",run:NK,shift:GK,preventDefault:!0},{mac:"Cmd-ArrowUp",run:hW,shift:dW},{mac:"Ctrl-ArrowUp",run:aW,shift:lW},{key:"ArrowDown",run:VK,shift:QK,preventDefault:!0},{mac:"Cmd-ArrowDown",run:uW,shift:fW},{mac:"Ctrl-ArrowDown",run:$R,shift:cW},{key:"PageUp",run:aW,shift:lW},{key:"PageDown",run:$R,shift:cW},{key:"Home",run:fFe,shift:CFe,preventDefault:!0},{key:"Mod-Home",run:hW,shift:dW},{key:"End",run:dFe,shift:SFe,preventDefault:!0},{key:"Mod-End",run:uW,shift:fW},{key:"Enter",run:GFe},{key:"Mod-a",run:kFe},{key:"Backspace",run:UR,shift:UR},{key:"Delete",run:qK},{key:"Mod-Backspace",mac:"Alt-Backspace",run:KK},{key:"Mod-Delete",mac:"Alt-Delete",run:RFe},{mac:"Mod-Backspace",run:LFe},{mac:"Mod-Delete",run:NFe}].concat(KFe.map(s=>({mac:s.key,run:s.run,shift:s.shift}))),eze=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:hFe,shift:wFe},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:uFe,shift:OFe},{key:"Alt-ArrowUp",run:UFe},{key:"Shift-Alt-ArrowUp",run:zFe},{key:"Alt-ArrowDown",run:FFe},{key:"Shift-Alt-ArrowDown",run:XFe},{key:"Escape",run:BFe},{key:"Mod-Enter",run:QFe},{key:"Alt-l",mac:"Ctrl-l",run:PFe},{key:"Mod-i",run:IFe,preventDefault:!0},{key:"Mod-[",run:qFe},{key:"Mod-]",run:jFe},{key:"Mod-Alt-\\",run:YFe},{key:"Shift-Mod-k",run:WFe},{key:"Shift-Mod-\\",run:xFe},{key:"Mod-/",run:zUe},{key:"Alt-A",run:WUe},{key:"Ctrl-m",mac:"Shift-Alt-m",run:ZFe}].concat(JFe);function Gn(){var s=arguments[0];typeof s=="string"&&(s=document.createElement(s));var e=1,i=arguments[1];if(i&&typeof i=="object"&&i.nodeType==null&&!Array.isArray(i)){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=i[n];typeof r=="string"?s.setAttribute(n,r):r!=null&&(s[n]=r)}e++}for(;e<arguments.length;e++)iJ(s,arguments[e]);return s}function iJ(s,e){if(typeof e=="string")s.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)s.appendChild(e);else if(Array.isArray(e))for(var i=0;i<e.length;i++)iJ(s,e[i]);else throw new RangeError("Unsupported child node: "+e)}const pW=typeof String.prototype.normalize=="function"?s=>s.normalize("NFKD"):s=>s;class by{constructor(e,i,n=0,r=e.length,o,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,r),this.bufferStart=n,this.normalize=o?l=>o(pW(l)):pW,this.query=this.normalize(i)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return kr(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let i=g3(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=al(e);let r=this.normalize(i);for(let o=0,a=n;;o++){let l=r.charCodeAt(o),h=this.match(l,a,this.bufferPos+this.bufferStart);if(o==r.length-1){if(h)return this.value=h,this;break}a==n&&o<i.length&&i.charCodeAt(o)==l&&a++}}}match(e,i,n){let r=null;for(let o=0;o<this.matches.length;o+=2){let a=this.matches[o],l=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?r={from:this.matches[o+1],to:n}:(this.matches[o]++,l=!0)),l||(this.matches.splice(o,2),o-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:i,to:n}:this.matches.push(1,i)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(by.prototype[Symbol.iterator]=function(){return this});const nJ={from:-1,to:-1,match:/.*/.exec("")},z3="gm"+(/x/.unicode==null?"":"u");class sJ{constructor(e,i,n,r=0,o=e.length){if(this.text=e,this.to=o,this.curLine="",this.done=!1,this.value=nJ,/\\[sWDnr]|\n|\r|\[\^/.test(i))return new rJ(e,i,n,r,o);this.re=new RegExp(i,z3+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=e.iter();let a=e.lineAt(r);this.curLineStart=a.from,this.matchPos=yT(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let i=this.matchPos<=this.to&&this.re.exec(this.curLine);if(i){let n=this.curLineStart+i.index,r=n+i[0].length;if(this.matchPos=yT(this.text,r+(n==r?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<r||n>this.value.to)&&(!this.test||this.test(n,r,i)))return this.value={from:n,to:r,match:i},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const n2=new WeakMap;class Q0{constructor(e,i){this.from=e,this.text=i}get to(){return this.from+this.text.length}static get(e,i,n){let r=n2.get(e);if(!r||r.from>=n||r.to<=i){let l=new Q0(i,e.sliceString(i,n));return n2.set(e,l),l}if(r.from==i&&r.to==n)return r;let{text:o,from:a}=r;return a>i&&(o=e.sliceString(i,a)+o,a=i),r.to<n&&(o+=e.sliceString(r.to,n)),n2.set(e,new Q0(a,o)),new Q0(i,o.slice(i-a,n-a))}}class rJ{constructor(e,i,n,r,o){this.text=e,this.to=o,this.done=!1,this.value=nJ,this.matchPos=yT(e,r),this.re=new RegExp(i,z3+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=Q0.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,i=this.re.exec(this.flat.text);if(i&&!i[0]&&i.index==e&&(this.re.lastIndex=e+1,i=this.re.exec(this.flat.text)),i){let n=this.flat.from+i.index,r=n+i[0].length;if((this.flat.to>=this.to||i.index+i[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,r,i)))return this.value={from:n,to:r,match:i},this.matchPos=yT(this.text,r+(n==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Q0.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(sJ.prototype[Symbol.iterator]=rJ.prototype[Symbol.iterator]=function(){return this});function tze(s){try{return new RegExp(s,z3),!0}catch{return!1}}function yT(s,e){if(e>=s.length)return e;let i=s.lineAt(e),n;for(;e<i.to&&(n=i.text.charCodeAt(e-i.from))>=56320&&n<57344;)e++;return e}function FR(s){let e=String(s.state.doc.lineAt(s.state.selection.main.head).number),i=Gn("input",{class:"cm-textfield",name:"line",value:e}),n=Gn("form",{class:"cm-gotoLine",onkeydown:o=>{o.keyCode==27?(o.preventDefault(),s.dispatch({effects:vT.of(!1)}),s.focus()):o.keyCode==13&&(o.preventDefault(),r())},onsubmit:o=>{o.preventDefault(),r()}},Gn("label",s.state.phrase("Go to line"),": ",i)," ",Gn("button",{class:"cm-button",type:"submit"},s.state.phrase("go")));function r(){let o=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(i.value);if(!o)return;let{state:a}=s,l=a.doc.lineAt(a.selection.main.head),[,h,d,f,p]=o,g=f?+f.slice(1):0,y=d?+d:l.number;if(d&&p){let w=y/100;h&&(w=w*(h=="-"?-1:1)+l.number/a.doc.lines),y=Math.round(a.doc.lines*w)}else d&&h&&(y=y*(h=="-"?-1:1)+l.number);let x=a.doc.line(Math.max(1,Math.min(a.doc.lines,y))),_=et.cursor(x.from+Math.max(0,Math.min(g,x.length)));s.dispatch({effects:[vT.of(!1),Ot.scrollIntoView(_.from,{y:"center"})],selection:_}),s.focus()}return{dom:n}}const vT=Fi.define(),mW=$r.define({create(){return!0},update(s,e){for(let i of e.effects)i.is(vT)&&(s=i.value);return s},provide:s=>K_.from(s,e=>e?FR:null)}),ize=s=>{let e=Z_(s,FR);if(!e){let i=[vT.of(!0)];s.state.field(mW,!1)==null&&i.push(Fi.appendConfig.of([mW,nze])),s.dispatch({effects:i}),e=Z_(s,FR)}return e&&e.dom.querySelector("input").select(),!0},nze=Ot.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),sze={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},rze=Pt.define({combine(s){return fh(s,sze,{highlightWordAroundCursor:(e,i)=>e||i,minSelectionLength:Math.min,maxMatches:Math.min})}});function oze(s){return[uze,hze]}const aze=fi.mark({class:"cm-selectionMatch"}),lze=fi.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function gW(s,e,i,n){return(i==0||s(e.sliceDoc(i-1,i))!=ls.Word)&&(n==e.doc.length||s(e.sliceDoc(n,n+1))!=ls.Word)}function cze(s,e,i,n){return s(e.sliceDoc(i,i+1))==ls.Word&&s(e.sliceDoc(n-1,n))==ls.Word}const hze=js.fromClass(class{constructor(s){this.decorations=this.getDeco(s)}update(s){(s.selectionSet||s.docChanged||s.viewportChanged)&&(this.decorations=this.getDeco(s.view))}getDeco(s){let e=s.state.facet(rze),{state:i}=s,n=i.selection;if(n.ranges.length>1)return fi.none;let r=n.main,o,a=null;if(r.empty){if(!e.highlightWordAroundCursor)return fi.none;let h=i.wordAt(r.head);if(!h)return fi.none;a=i.charCategorizer(r.head),o=i.sliceDoc(h.from,h.to)}else{let h=r.to-r.from;if(h<e.minSelectionLength||h>200)return fi.none;if(e.wholeWords){if(o=i.sliceDoc(r.from,r.to),a=i.charCategorizer(r.head),!(gW(a,i,r.from,r.to)&&cze(a,i,r.from,r.to)))return fi.none}else if(o=i.sliceDoc(r.from,r.to),!o)return fi.none}let l=[];for(let h of s.visibleRanges){let d=new by(i.doc,o,h.from,h.to);for(;!d.next().done;){let{from:f,to:p}=d.value;if((!a||gW(a,i,f,p))&&(r.empty&&f<=r.from&&p>=r.to?l.push(lze.range(f,p)):(f>=r.to||p<=r.from)&&l.push(aze.range(f,p)),l.length>e.maxMatches))return fi.none}}return fi.set(l)}},{decorations:s=>s.decorations}),uze=Ot.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),dze=({state:s,dispatch:e})=>{let{selection:i}=s,n=et.create(i.ranges.map(r=>s.wordAt(r.head)||et.cursor(r.head)),i.mainIndex);return n.eq(i)?!1:(e(s.update({selection:n})),!0)};function fze(s,e){let{main:i,ranges:n}=s.selection,r=s.wordAt(i.head),o=r&&r.from==i.from&&r.to==i.to;for(let a=!1,l=new by(s.doc,e,n[n.length-1].to);;)if(l.next(),l.done){if(a)return null;l=new by(s.doc,e,0,Math.max(0,n[n.length-1].from-1)),a=!0}else{if(a&&n.some(h=>h.from==l.value.from))continue;if(o){let h=s.wordAt(l.value.from);if(!h||h.from!=l.value.from||h.to!=l.value.to)continue}return l.value}}const pze=({state:s,dispatch:e})=>{let{ranges:i}=s.selection;if(i.some(o=>o.from===o.to))return dze({state:s,dispatch:e});let n=s.sliceDoc(i[0].from,i[0].to);if(s.selection.ranges.some(o=>s.sliceDoc(o.from,o.to)!=n))return!1;let r=fze(s,n);return r?(e(s.update({selection:s.selection.addRange(et.range(r.from,r.to),!1),effects:Ot.scrollIntoView(r.to)})),!0):!1},Fy=Pt.define({combine(s){return fh(s,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Tze(e),scrollToMatch:e=>Ot.scrollIntoView(e)})}});class oJ{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||tze(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(i,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new vze(this):new gze(this)}getCursor(e,i=0,n){let r=e.doc?e:gn.create({doc:e});return n==null&&(n=r.doc.length),this.regexp?a0(this,r,i,n):o0(this,r,i,n)}}class aJ{constructor(e){this.spec=e}}function o0(s,e,i,n){return new by(e.doc,s.unquoted,i,n,s.caseSensitive?void 0:r=>r.toLowerCase(),s.wholeWord?mze(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function mze(s,e){return(i,n,r,o)=>((o>i||o+r.length<n)&&(o=Math.max(0,i-2),r=s.sliceString(o,Math.min(s.length,n+2))),(e(xT(r,i-o))!=ls.Word||e(_T(r,i-o))!=ls.Word)&&(e(_T(r,n-o))!=ls.Word||e(xT(r,n-o))!=ls.Word))}class gze extends aJ{constructor(e){super(e)}nextMatch(e,i,n){let r=o0(this.spec,e,n,e.doc.length).nextOverlapping();return r.done&&(r=o0(this.spec,e,0,i).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,i,n){for(let r=n;;){let o=Math.max(i,r-1e4-this.spec.unquoted.length),a=o0(this.spec,e,o,r),l=null;for(;!a.nextOverlapping().done;)l=a.value;if(l)return l;if(o==i)return null;r-=1e4}}prevMatch(e,i,n){return this.prevMatchInRange(e,0,i)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,i){let n=o0(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=i)return null;r.push(n.value)}return r}highlight(e,i,n,r){let o=o0(this.spec,e,Math.max(0,i-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!o.next().done;)r(o.value.from,o.value.to)}}function a0(s,e,i,n){return new sJ(e.doc,s.search,{ignoreCase:!s.caseSensitive,test:s.wholeWord?yze(e.charCategorizer(e.selection.main.head)):void 0},i,n)}function xT(s,e){return s.slice(Lr(s,e,!1),e)}function _T(s,e){return s.slice(e,Lr(s,e))}function yze(s){return(e,i,n)=>!n[0].length||(s(xT(n.input,n.index))!=ls.Word||s(_T(n.input,n.index))!=ls.Word)&&(s(_T(n.input,n.index+n[0].length))!=ls.Word||s(xT(n.input,n.index+n[0].length))!=ls.Word)}class vze extends aJ{nextMatch(e,i,n){let r=a0(this.spec,e,n,e.doc.length).next();return r.done&&(r=a0(this.spec,e,0,i).next()),r.done?null:r.value}prevMatchInRange(e,i,n){for(let r=1;;r++){let o=Math.max(i,n-r*1e4),a=a0(this.spec,e,o,n),l=null;for(;!a.next().done;)l=a.value;if(l&&(o==i||l.from>o+10))return l;if(o==i)return null}}prevMatch(e,i,n){return this.prevMatchInRange(e,0,i)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(i,n)=>n=="$"?"$":n=="&"?e.match[0]:n!="0"&&+n<e.match.length?e.match[n]:i)}matchAll(e,i){let n=a0(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=i)return null;r.push(n.value)}return r}highlight(e,i,n,r){let o=a0(this.spec,e,Math.max(0,i-250),Math.min(n+250,e.doc.length));for(;!o.next().done;)r(o.value.from,o.value.to)}}const tb=Fi.define(),X3=Fi.define(),qd=$r.define({create(s){return new s2(zR(s).create(),null)},update(s,e){for(let i of e.effects)i.is(tb)?s=new s2(i.value.create(),s.panel):i.is(X3)&&(s=new s2(s.query,i.value?W3:null));return s},provide:s=>K_.from(s,e=>e.panel)});class s2{constructor(e,i){this.query=e,this.panel=i}}const xze=fi.mark({class:"cm-searchMatch"}),_ze=fi.mark({class:"cm-searchMatch cm-searchMatch-selected"}),bze=js.fromClass(class{constructor(s){this.view=s,this.decorations=this.highlight(s.state.field(qd))}update(s){let e=s.state.field(qd);(e!=s.startState.field(qd)||s.docChanged||s.selectionSet||s.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:s,panel:e}){if(!e||!s.spec.valid)return fi.none;let{view:i}=this,n=new rf;for(let r=0,o=i.visibleRanges,a=o.length;r<a;r++){let{from:l,to:h}=o[r];for(;r<a-1&&h>o[r+1].from-2*250;)h=o[++r].to;s.highlight(i.state,l,h,(d,f)=>{let p=i.state.selection.ranges.some(g=>g.from==d&&g.to==f);n.add(d,f,p?_ze:xze)})}return n.finish()}},{decorations:s=>s.decorations});function Hb(s){return e=>{let i=e.state.field(qd,!1);return i&&i.query.spec.valid?s(e,i):hJ(e)}}const bT=Hb((s,{query:e})=>{let{to:i}=s.state.selection.main,n=e.nextMatch(s.state,i,i);if(!n)return!1;let r=et.single(n.from,n.to),o=s.state.facet(Fy);return s.dispatch({selection:r,effects:[H3(s,n),o.scrollToMatch(r.main,s)],userEvent:"select.search"}),cJ(s),!0}),wT=Hb((s,{query:e})=>{let{state:i}=s,{from:n}=i.selection.main,r=e.prevMatch(i,n,n);if(!r)return!1;let o=et.single(r.from,r.to),a=s.state.facet(Fy);return s.dispatch({selection:o,effects:[H3(s,r),a.scrollToMatch(o.main,s)],userEvent:"select.search"}),cJ(s),!0}),wze=Hb((s,{query:e})=>{let i=e.matchAll(s.state,1e3);return!i||!i.length?!1:(s.dispatch({selection:et.create(i.map(n=>et.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),Oze=({state:s,dispatch:e})=>{let i=s.selection;if(i.ranges.length>1||i.main.empty)return!1;let{from:n,to:r}=i.main,o=[],a=0;for(let l=new by(s.doc,s.sliceDoc(n,r));!l.next().done;){if(o.length>1e3)return!1;l.value.from==n&&(a=o.length),o.push(et.range(l.value.from,l.value.to))}return e(s.update({selection:et.create(o,a),userEvent:"select.search.matches"})),!0},yW=Hb((s,{query:e})=>{let{state:i}=s,{from:n,to:r}=i.selection.main;if(i.readOnly)return!1;let o=e.nextMatch(i,n,n);if(!o)return!1;let a=[],l,h,d=[];if(o.from==n&&o.to==r&&(h=i.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:h}),o=e.nextMatch(i,o.from,o.to),d.push(Ot.announce.of(i.phrase("replaced match on line $",i.doc.lineAt(n).number)+"."))),o){let f=a.length==0||a[0].from>=o.to?0:o.to-o.from-h.length;l=et.single(o.from-f,o.to-f),d.push(H3(s,o)),d.push(i.facet(Fy).scrollToMatch(l.main,s))}return s.dispatch({changes:a,selection:l,effects:d,userEvent:"input.replace"}),!0}),Sze=Hb((s,{query:e})=>{if(s.state.readOnly)return!1;let i=e.matchAll(s.state,1e9).map(r=>{let{from:o,to:a}=r;return{from:o,to:a,insert:e.getReplacement(r)}});if(!i.length)return!1;let n=s.state.phrase("replaced $ matches",i.length)+".";return s.dispatch({changes:i,effects:Ot.announce.of(n),userEvent:"input.replace.all"}),!0});function W3(s){return s.state.facet(Fy).createPanel(s)}function zR(s,e){var i,n,r,o,a;let l=s.selection.main,h=l.empty||l.to>l.from+100?"":s.sliceDoc(l.from,l.to);if(e&&!h)return e;let d=s.facet(Fy);return new oJ({search:((i=e==null?void 0:e.literal)!==null&&i!==void 0?i:d.literal)?h:h.replace(/\n/g,"\\n"),caseSensitive:(n=e==null?void 0:e.caseSensitive)!==null&&n!==void 0?n:d.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:d.literal,regexp:(o=e==null?void 0:e.regexp)!==null&&o!==void 0?o:d.regexp,wholeWord:(a=e==null?void 0:e.wholeWord)!==null&&a!==void 0?a:d.wholeWord})}function lJ(s){let e=Z_(s,W3);return e&&e.dom.querySelector("[main-field]")}function cJ(s){let e=lJ(s);e&&e==s.root.activeElement&&e.select()}const hJ=s=>{let e=s.state.field(qd,!1);if(e&&e.panel){let i=lJ(s);if(i&&i!=s.root.activeElement){let n=zR(s.state,e.query.spec);n.valid&&s.dispatch({effects:tb.of(n)}),i.focus(),i.select()}}else s.dispatch({effects:[X3.of(!0),e?tb.of(zR(s.state,e.query.spec)):Fi.appendConfig.of(Eze)]});return!0},uJ=s=>{let e=s.state.field(qd,!1);if(!e||!e.panel)return!1;let i=Z_(s,W3);return i&&i.dom.contains(s.root.activeElement)&&s.focus(),s.dispatch({effects:X3.of(!1)}),!0},Cze=[{key:"Mod-f",run:hJ,scope:"editor search-panel"},{key:"F3",run:bT,shift:wT,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:bT,shift:wT,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:uJ,scope:"editor search-panel"},{key:"Mod-Shift-l",run:Oze},{key:"Mod-Alt-g",run:ize},{key:"Mod-d",run:pze,preventDefault:!0}];class Tze{constructor(e){this.view=e;let i=this.query=e.state.field(qd).query.spec;this.commit=this.commit.bind(this),this.searchField=Gn("input",{value:i.search,placeholder:ya(e,"Find"),"aria-label":ya(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Gn("input",{value:i.replace,placeholder:ya(e,"Replace"),"aria-label":ya(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Gn("input",{type:"checkbox",name:"case",form:"",checked:i.caseSensitive,onchange:this.commit}),this.reField=Gn("input",{type:"checkbox",name:"re",form:"",checked:i.regexp,onchange:this.commit}),this.wordField=Gn("input",{type:"checkbox",name:"word",form:"",checked:i.wholeWord,onchange:this.commit});function n(r,o,a){return Gn("button",{class:"cm-button",name:r,onclick:o,type:"button"},a)}this.dom=Gn("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,n("next",()=>bT(e),[ya(e,"next")]),n("prev",()=>wT(e),[ya(e,"previous")]),n("select",()=>wze(e),[ya(e,"all")]),Gn("label",null,[this.caseField,ya(e,"match case")]),Gn("label",null,[this.reField,ya(e,"regexp")]),Gn("label",null,[this.wordField,ya(e,"by word")]),...e.state.readOnly?[]:[Gn("br"),this.replaceField,n("replace",()=>yW(e),[ya(e,"replace")]),n("replaceAll",()=>Sze(e),[ya(e,"replace all")])],Gn("button",{name:"close",onclick:()=>uJ(e),"aria-label":ya(e,"close"),type:"button"},[""])])}commit(){let e=new oJ({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:tb.of(e)}))}keydown(e){IVe(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?wT:bT)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),yW(this.view))}update(e){for(let i of e.transactions)for(let n of i.effects)n.is(tb)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Fy).top}}function ya(s,e){return s.state.phrase(e)}const zO=30,XO=/[\s\.,:;?!]/;function H3(s,{from:e,to:i}){let n=s.state.doc.lineAt(e),r=s.state.doc.lineAt(i).to,o=Math.max(n.from,e-zO),a=Math.min(r,i+zO),l=s.state.sliceDoc(o,a);if(o!=n.from){for(let h=0;h<zO;h++)if(!XO.test(l[h+1])&&XO.test(l[h])){l=l.slice(h);break}}if(a!=r){for(let h=l.length-1;h>l.length-zO;h--)if(!XO.test(l[h-1])&&XO.test(l[h])){l=l.slice(0,h);break}}return Ot.announce.of(`${s.state.phrase("current match")}. ${l} ${s.state.phrase("on line")} ${n.number}.`)}const Aze=Ot.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Eze=[qd,Rm.low(bze),Aze];class dJ{constructor(e,i,n,r){this.state=e,this.pos=i,this.explicit=n,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let i=eo(this.state).resolveInner(this.pos,-1);for(;i&&e.indexOf(i.name)<0;)i=i.parent;return i?{from:i.from,to:this.pos,text:this.state.sliceDoc(i.from,this.pos),type:i.type}:null}matchBefore(e){let i=this.state.doc.lineAt(this.pos),n=Math.max(i.from,this.pos-250),r=i.text.slice(n-i.from,this.pos-i.from),o=r.search(fJ(e,!1));return o<0?null:{from:n+o,to:this.pos,text:r.slice(o)}}get aborted(){return this.abortListeners==null}addEventListener(e,i,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(i),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function vW(s){let e=Object.keys(s).join(""),i=/\w/.test(e);return i&&(e=e.replace(/\w/g,"")),`[${i?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Mze(s){let e=Object.create(null),i=Object.create(null);for(let{label:r}of s){e[r[0]]=!0;for(let o=1;o<r.length;o++)i[r[o]]=!0}let n=vW(e)+vW(i)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function kze(s){let e=s.map(r=>typeof r=="string"?{label:r}:r),[i,n]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:Mze(e);return r=>{let o=r.matchBefore(n);return o||r.explicit?{from:o?o.from:r.pos,options:e,validFor:i}:null}}class xW{constructor(e,i,n,r){this.completion=e,this.source=i,this.match=n,this.score=r}}function Zd(s){return s.selection.main.from}function fJ(s,e){var i;let{source:n}=s,r=e&&n[0]!="^",o=n[n.length-1]!="$";return!r&&!o?s:new RegExp(`${r?"^":""}(?:${n})${o?"$":""}`,(i=s.flags)!==null&&i!==void 0?i:s.ignoreCase?"i":"")}const pJ=Pu.define();function Pze(s,e,i,n){let{main:r}=s.selection,o=i-r.from,a=n-r.from;return Object.assign(Object.assign({},s.changeByRange(l=>l!=r&&i!=n&&s.sliceDoc(l.from+o,l.from+a)!=s.sliceDoc(i,n)?{range:l}:{changes:{from:l.from+o,to:n==r.from?l.to:l.from+a,insert:e},range:et.cursor(l.from+o+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const _W=new WeakMap;function Ize(s){if(!Array.isArray(s))return s;let e=_W.get(s);return e||_W.set(s,e=kze(s)),e}const OT=Fi.define(),ib=Fi.define();class Bze{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let i=0;i<e.length;){let n=kr(e,i),r=al(n);this.chars.push(n);let o=e.slice(i,i+r),a=o.toUpperCase();this.folded.push(kr(a==o?o.toLowerCase():a,0)),i+=r}this.astral=e.length!=this.chars.length}ret(e,i){return this.score=e,this.matched=i,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:i,folded:n,any:r,precise:o,byWord:a}=this;if(i.length==1){let T=kr(e,0),C=al(T),A=C==e.length?0:-100;if(T!=i[0])if(T==n[0])A+=-200;else return null;return this.ret(A,[0,C])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let h=i.length,d=0;if(l<0){for(let T=0,C=Math.min(e.length,200);T<C&&d<h;){let A=kr(e,T);(A==i[d]||A==n[d])&&(r[d++]=T),T+=al(A)}if(d<h)return null}let f=0,p=0,g=!1,y=0,x=-1,_=-1,w=/[a-z]/.test(e),O=!0;for(let T=0,C=Math.min(e.length,200),A=0;T<C&&p<h;){let B=kr(e,T);l<0&&(f<h&&B==i[f]&&(o[f++]=T),y<h&&(B==i[y]||B==n[y]?(y==0&&(x=T),_=T+1,y++):y=0));let I,R=B<255?B>=48&&B<=57||B>=97&&B<=122?2:B>=65&&B<=90?1:0:(I=g3(B))!=I.toLowerCase()?1:I!=I.toUpperCase()?2:0;(!T||R==1&&w||A==0&&R!=0)&&(i[p]==B||n[p]==B&&(g=!0)?a[p++]=T:a.length&&(O=!1)),A=R,T+=al(B)}return p==h&&a[0]==0&&O?this.result(-100+(g?-200:0),a,e):y==h&&x==0?this.ret(-200-e.length+(_==e.length?0:-100),[0,_]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):y==h?this.ret(-900-e.length,[x,_]):p==h?this.result(-100+(g?-200:0)+-700+(O?0:-1100),a,e):i.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,i,n){let r=[],o=0;for(let a of i){let l=a+(this.astral?al(kr(n,a)):1);o&&r[o-1]==a?r[o-1]=l:(r[o++]=a,r[o++]=l)}return this.ret(e-n.length,r)}}class Rze{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let i=e.slice(0,this.pattern.length),n=i==this.pattern?0:i.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,i.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const Rr=Pt.define({combine(s){return fh(s,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Dze,filterStrict:!1,compareCompletions:(e,i)=>e.label.localeCompare(i.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,i)=>e&&i,closeOnBlur:(e,i)=>e&&i,icons:(e,i)=>e&&i,tooltipClass:(e,i)=>n=>bW(e(n),i(n)),optionClass:(e,i)=>n=>bW(e(n),i(n)),addToOptions:(e,i)=>e.concat(i),filterStrict:(e,i)=>e||i})}});function bW(s,e){return s?e?s+" "+e:s:e}function Dze(s,e,i,n,r,o){let a=s.textDirection==Jn.RTL,l=a,h=!1,d="top",f,p,g=e.left-r.left,y=r.right-e.right,x=n.right-n.left,_=n.bottom-n.top;if(l&&g<Math.min(x,y)?l=!1:!l&&y<Math.min(x,g)&&(l=!0),x<=(l?g:y))f=Math.max(r.top,Math.min(i.top,r.bottom-_))-e.top,p=Math.min(400,l?g:y);else{h=!0,p=Math.min(400,(a?e.right:r.right-e.left)-30);let T=r.bottom-e.bottom;T>=_||T>e.top?f=i.bottom-e.top:(d="bottom",f=e.bottom-i.top)}let w=(e.bottom-e.top)/o.offsetHeight,O=(e.right-e.left)/o.offsetWidth;return{style:`${d}: ${f/w}px; max-width: ${p/O}px`,class:"cm-completionInfo-"+(h?a?"left-narrow":"right-narrow":l?"left":"right")}}function Lze(s){let e=s.addToOptions.slice();return s.icons&&e.push({render(i){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),i.type&&n.classList.add(...i.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(i,n,r,o){let a=document.createElement("span");a.className="cm-completionLabel";let l=i.displayLabel||i.label,h=0;for(let d=0;d<o.length;){let f=o[d++],p=o[d++];f>h&&a.appendChild(document.createTextNode(l.slice(h,f)));let g=a.appendChild(document.createElement("span"));g.appendChild(document.createTextNode(l.slice(f,p))),g.className="cm-completionMatchedText",h=p}return h<l.length&&a.appendChild(document.createTextNode(l.slice(h))),a},position:50},{render(i){if(!i.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=i.detail,n},position:80}),e.sort((i,n)=>i.position-n.position).map(i=>i.render)}function r2(s,e,i){if(s<=i)return{from:0,to:s};if(e<0&&(e=0),e<=s>>1){let r=Math.floor(e/i);return{from:r*i,to:(r+1)*i}}let n=Math.floor((s-e)/i);return{from:s-(n+1)*i,to:s-n*i}}class Nze{constructor(e,i,n){this.view=e,this.stateField=i,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:h=>this.placeInfo(h),key:this},this.space=null,this.currentClass="";let r=e.state.field(i),{options:o,selected:a}=r.open,l=e.state.facet(Rr);this.optionContent=Lze(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=r2(o.length,a,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",h=>{let{options:d}=e.state.field(i).open;for(let f=h.target,p;f&&f!=this.dom;f=f.parentNode)if(f.nodeName=="LI"&&(p=/-(\d+)$/.exec(f.id))&&+p[1]<d.length){this.applyCompletion(e,d[+p[1]]),h.preventDefault();return}}),this.dom.addEventListener("focusout",h=>{let d=e.state.field(this.stateField,!1);d&&d.tooltip&&e.state.facet(Rr).closeOnBlur&&h.relatedTarget!=e.contentDOM&&e.dispatch({effects:ib.of(null)})}),this.showOptions(o,r.id)}mount(){this.updateSel()}showOptions(e,i){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,i,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var i;let n=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=r){let{options:o,selected:a,disabled:l}=n.open;(!r.open||r.open.options!=o)&&(this.range=r2(o.length,a,e.state.facet(Rr).maxRenderedOptions),this.showOptions(o,n.id)),this.updateSel(),l!=((i=r.open)===null||i===void 0?void 0:i.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let i=this.tooltipClass(e);if(i!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of i.split(" "))n&&this.dom.classList.add(n);this.currentClass=i}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),i=e.open;if((i.selected>-1&&i.selected<this.range.from||i.selected>=this.range.to)&&(this.range=r2(i.options.length,i.selected,this.view.state.facet(Rr).maxRenderedOptions),this.showOptions(i.options,e.id)),this.updateSelectedOption(i.selected)){this.destroyInfo();let{completion:n}=i.options[i.selected],{info:r}=n;if(!r)return;let o=typeof r=="string"?document.createTextNode(r):r(n);if(!o)return;"then"in o?o.then(a=>{a&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(a,n)}).catch(a=>Ko(this.view.state,a,"completion info")):this.addInfoPane(o,n)}}addInfoPane(e,i){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:o}=e;n.appendChild(r),this.infoDestroy=o||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let i=null;for(let n=this.list.firstChild,r=this.range.from;n;n=n.nextSibling,r++)n.nodeName!="LI"||!n.id?r--:r==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),i=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return i&&$ze(this.list,i),i}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let i=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),o=this.space;if(!o){let a=this.dom.ownerDocument.defaultView||window;o={left:0,top:0,right:a.innerWidth,bottom:a.innerHeight}}return r.top>Math.min(o.bottom,i.bottom)-10||r.bottom<Math.max(o.top,i.top)+10?null:this.view.state.facet(Rr).positionInfo(this.view,i,r,n,o,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,i,n){const r=document.createElement("ul");r.id=i,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let o=null;for(let a=n.from;a<n.to;a++){let{completion:l,match:h}=e[a],{section:d}=l;if(d){let g=typeof d=="string"?d:d.name;if(g!=o&&(a>n.from||n.from==0))if(o=g,typeof d!="string"&&d.header)r.appendChild(d.header(d));else{let y=r.appendChild(document.createElement("completion-section"));y.textContent=g}}const f=r.appendChild(document.createElement("li"));f.id=i+"-"+a,f.setAttribute("role","option");let p=this.optionClass(l);p&&(f.className=p);for(let g of this.optionContent){let y=g(l,this.view.state,this.view,h);y&&f.appendChild(y)}}return n.from&&r.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Vze(s,e){return i=>new Nze(i,s,e)}function $ze(s,e){let i=s.getBoundingClientRect(),n=e.getBoundingClientRect(),r=i.height/s.offsetHeight;n.top<i.top?s.scrollTop-=(i.top-n.top)/r:n.bottom>i.bottom&&(s.scrollTop+=(n.bottom-i.bottom)/r)}function wW(s){return(s.boost||0)*100+(s.apply?10:0)+(s.info?5:0)+(s.type?1:0)}function Uze(s,e){let i=[],n=null,r=d=>{i.push(d);let{section:f}=d.completion;if(f){n||(n=[]);let p=typeof f=="string"?f:f.name;n.some(g=>g.name==p)||n.push(typeof f=="string"?{name:p}:f)}},o=e.facet(Rr);for(let d of s)if(d.hasResult()){let f=d.result.getMatch;if(d.result.filter===!1)for(let p of d.result.options)r(new xW(p,d.source,f?f(p):[],1e9-i.length));else{let p=e.sliceDoc(d.from,d.to),g,y=o.filterStrict?new Rze(p):new Bze(p);for(let x of d.result.options)if(g=y.match(x.label)){let _=x.displayLabel?f?f(x,g.matched):[]:g.matched;r(new xW(x,d.source,_,g.score+(x.boost||0)))}}}if(n){let d=Object.create(null),f=0,p=(g,y)=>{var x,_;return((x=g.rank)!==null&&x!==void 0?x:1e9)-((_=y.rank)!==null&&_!==void 0?_:1e9)||(g.name<y.name?-1:1)};for(let g of n.sort(p))f-=1e5,d[g.name]=f;for(let g of i){let{section:y}=g.completion;y&&(g.score+=d[typeof y=="string"?y:y.name])}}let a=[],l=null,h=o.compareCompletions;for(let d of i.sort((f,p)=>p.score-f.score||h(f.completion,p.completion))){let f=d.completion;!l||l.label!=f.label||l.detail!=f.detail||l.type!=null&&f.type!=null&&l.type!=f.type||l.apply!=f.apply||l.boost!=f.boost?a.push(d):wW(d.completion)>wW(l)&&(a[a.length-1]=d),l=d.completion}return a}class y0{constructor(e,i,n,r,o,a){this.options=e,this.attrs=i,this.tooltip=n,this.timestamp=r,this.selected=o,this.disabled=a}setSelected(e,i){return e==this.selected||e>=this.options.length?this:new y0(this.options,OW(i,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,i,n,r,o){let a=Uze(e,i);if(!a.length)return r&&e.some(h=>h.state==1)?new y0(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let l=i.facet(Rr).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let h=r.options[r.selected].completion;for(let d=0;d<a.length;d++)if(a[d].completion==h){l=d;break}}return new y0(a,OW(n,l),{pos:e.reduce((h,d)=>d.hasResult()?Math.min(h,d.from):h,1e8),create:Gze,above:o.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new y0(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class ST{constructor(e,i,n){this.active=e,this.id=i,this.open=n}static start(){return new ST(Wze,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:i}=e,n=i.facet(Rr),o=(n.override||i.languageDataAt("autocomplete",Zd(i)).map(Ize)).map(l=>(this.active.find(d=>d.source==l)||new ka(l,this.active.some(d=>d.state!=0)?1:0)).update(e,n));o.length==this.active.length&&o.every((l,h)=>l==this.active[h])&&(o=this.active);let a=this.open;a&&e.docChanged&&(a=a.map(e.changes)),e.selection||o.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!Fze(o,this.active)?a=y0.build(o,i,this.id,a,n):a&&a.disabled&&!o.some(l=>l.state==1)&&(a=null),!a&&o.every(l=>l.state!=1)&&o.some(l=>l.hasResult())&&(o=o.map(l=>l.hasResult()?new ka(l.source,0):l));for(let l of e.effects)l.is(yJ)&&(a=a&&a.setSelected(l.value,this.id));return o==this.active&&a==this.open?this:new ST(o,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?zze:Xze}}function Fze(s,e){if(s==e)return!0;for(let i=0,n=0;;){for(;i<s.length&&!s[i].hasResult;)i++;for(;n<e.length&&!e[n].hasResult;)n++;let r=i==s.length,o=n==e.length;if(r||o)return r==o;if(s[i++].result!=e[n++].result)return!1}}const zze={"aria-autocomplete":"list"},Xze={};function OW(s,e){let i={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":s};return e>-1&&(i["aria-activedescendant"]=s+"-"+e),i}const Wze=[];function mJ(s,e){if(s.isUserEvent("input.complete")){let n=s.annotation(pJ);if(n&&e.activateOnCompletion(n))return 12}let i=s.isUserEvent("input.type");return i&&e.activateOnTyping?5:i?1:s.isUserEvent("delete.backward")?2:s.selection?8:s.docChanged?16:0}class ka{constructor(e,i,n=-1){this.source=e,this.state=i,this.explicitPos=n}hasResult(){return!1}update(e,i){let n=mJ(e,i),r=this;(n&8||n&16&&this.touches(e))&&(r=new ka(r.source,0)),n&4&&r.state==0&&(r=new ka(this.source,1)),r=r.updateFor(e,n);for(let o of e.effects)if(o.is(OT))r=new ka(r.source,1,o.value?Zd(e.state):-1);else if(o.is(ib))r=new ka(r.source,0);else if(o.is(gJ))for(let a of o.value)a.source==r.source&&(r=a);return r}updateFor(e,i){return this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new ka(this.source,this.state,e.mapPos(this.explicitPos))}touches(e){return e.changes.touchesRange(Zd(e.state))}}class Y0 extends ka{constructor(e,i,n,r,o){super(e,2,i),this.result=n,this.from=r,this.to=o}hasResult(){return!0}updateFor(e,i){var n;if(!(i&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let o=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),l=Zd(e.state);if((this.explicitPos<0?l<=o:l<this.from)||l>a||!r||i&2&&Zd(e.startState)==this.from)return new ka(this.source,i&4?1:0);let h=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return Hze(r.validFor,e.state,o,a)?new Y0(this.source,h,r,o,a):r.update&&(r=r.update(r,o,a,new dJ(e.state,l,h>=0)))?new Y0(this.source,h,r,r.from,(n=r.to)!==null&&n!==void 0?n:Zd(e.state)):new ka(this.source,1,h)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Y0(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ka(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Hze(s,e,i,n){if(!s)return!1;let r=e.sliceDoc(i,n);return typeof s=="function"?s(r,i,n,e):fJ(s,!0).test(r)}const gJ=Fi.define({map(s,e){return s.map(i=>i.map(e))}}),yJ=Fi.define(),Xo=$r.define({create(){return ST.start()},update(s,e){return s.update(e)},provide:s=>[P3.from(s,e=>e.tooltip),Ot.contentAttributes.from(s,e=>e.attrs)]});function G3(s,e){const i=e.completion.apply||e.completion.label;let n=s.state.field(Xo).active.find(r=>r.source==e.source);return n instanceof Y0?(typeof i=="string"?s.dispatch(Object.assign(Object.assign({},Pze(s.state,i,n.from,n.to)),{annotations:pJ.of(e.completion)})):i(s,e.completion,n.from,n.to),!0):!1}const Gze=Vze(Xo,G3);function WO(s,e="option"){return i=>{let n=i.state.field(Xo,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<i.state.facet(Rr).interactionDelay)return!1;let r=1,o;e=="page"&&(o=KZ(i,n.open.tooltip))&&(r=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:a}=n.open.options,l=n.open.selected>-1?n.open.selected+r*(s?1:-1):s?0:a-1;return l<0?l=e=="page"?0:a-1:l>=a&&(l=e=="page"?a-1:0),i.dispatch({effects:yJ.of(l)}),!0}}const Qze=s=>{let e=s.state.field(Xo,!1);return s.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<s.state.facet(Rr).interactionDelay?!1:G3(s,e.open.options[e.open.selected])},Yze=s=>s.state.field(Xo,!1)?(s.dispatch({effects:OT.of(!0)}),!0):!1,jze=s=>{let e=s.state.field(Xo,!1);return!e||!e.active.some(i=>i.state!=0)?!1:(s.dispatch({effects:ib.of(null)}),!0)};class qze{constructor(e,i){this.active=e,this.context=i,this.time=Date.now(),this.updates=[],this.done=void 0}}const Zze=50,Kze=1e3,Jze=js.fromClass(class{constructor(s){this.view=s,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of s.state.field(Xo).active)e.state==1&&this.startQuery(e)}update(s){let e=s.state.field(Xo),i=s.state.facet(Rr);if(!s.selectionSet&&!s.docChanged&&s.startState.field(Xo)==e)return;let n=s.transactions.some(o=>{let a=mJ(o,i);return a&8||(o.selection||o.docChanged)&&!(a&3)});for(let o=0;o<this.running.length;o++){let a=this.running[o];if(n||a.context.abortOnDocChange&&s.docChanged||a.updates.length+s.transactions.length>Zze&&Date.now()-a.time>Kze){for(let l of a.context.abortListeners)try{l()}catch(h){Ko(this.view.state,h)}a.context.abortListeners=null,this.running.splice(o--,1)}else a.updates.push(...s.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),s.transactions.some(o=>o.effects.some(a=>a.is(OT)))&&(this.pendingStart=!0);let r=this.pendingStart?50:i.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(o=>o.state==1&&!this.running.some(a=>a.active.source==o.source))?setTimeout(()=>this.startUpdate(),r):-1,this.composing!=0)for(let o of s.transactions)o.isUserEvent("input.type")?this.composing=2:this.composing==2&&o.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:s}=this.view,e=s.field(Xo);for(let i of e.active)i.state==1&&!this.running.some(n=>n.active.source==i.source)&&this.startQuery(i)}startQuery(s){let{state:e}=this.view,i=Zd(e),n=new dJ(e,i,s.explicitPos==i,this.view),r=new qze(s,n);this.running.push(r),Promise.resolve(s.source(n)).then(o=>{r.context.aborted||(r.done=o||null,this.scheduleAccept())},o=>{this.view.dispatch({effects:ib.of(null)}),Ko(this.view.state,o)})}scheduleAccept(){this.running.every(s=>s.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Rr).updateSyncTime))}accept(){var s;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],i=this.view.state.facet(Rr);for(let n=0;n<this.running.length;n++){let r=this.running[n];if(r.done===void 0)continue;if(this.running.splice(n--,1),r.done){let a=new Y0(r.active.source,r.active.explicitPos,r.done,r.done.from,(s=r.done.to)!==null&&s!==void 0?s:Zd(r.updates.length?r.updates[0].startState:this.view.state));for(let l of r.updates)a=a.update(l,i);if(a.hasResult()){e.push(a);continue}}let o=this.view.state.field(Xo).active.find(a=>a.source==r.active.source);if(o&&o.state==1)if(r.done==null){let a=new ka(r.active.source,0);for(let l of r.updates)a=a.update(l,i);a.state!=1&&e.push(a)}else this.startQuery(o)}e.length&&this.view.dispatch({effects:gJ.of(e)})}},{eventHandlers:{blur(s){let e=this.view.state.field(Xo,!1);if(e&&e.tooltip&&this.view.state.facet(Rr).closeOnBlur){let i=e.open&&KZ(this.view,e.open.tooltip);(!i||!i.dom.contains(s.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:ib.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:OT.of(!1)}),20),this.composing=0}}}),e4e=typeof navigator=="object"&&/Win/.test(navigator.platform),t4e=Rm.highest(Ot.domEventHandlers({keydown(s,e){let i=e.state.field(Xo,!1);if(!i||!i.open||i.open.disabled||i.open.selected<0||s.key.length>1||s.ctrlKey&&!(e4e&&s.altKey)||s.metaKey)return!1;let n=i.open.options[i.open.selected],r=i.active.find(a=>a.source==n.source),o=n.completion.commitCharacters||r.result.commitCharacters;return o&&o.indexOf(s.key)>-1&&G3(e,n),!1}})),i4e=Ot.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),nb={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Up=Fi.define({map(s,e){let i=e.mapPos(s,-1,_o.TrackAfter);return i??void 0}}),Q3=new class extends xm{};Q3.startSide=1;Q3.endSide=-1;const vJ=$r.define({create(){return fn.empty},update(s,e){if(s=s.map(e.changes),e.selection){let i=e.state.doc.lineAt(e.selection.main.head);s=s.update({filter:n=>n>=i.from&&n<=i.to})}for(let i of e.effects)i.is(Up)&&(s=s.update({add:[Q3.range(i.value,i.value+1)]}));return s}});function n4e(){return[r4e,vJ]}const o2="()[]{}<>";function xJ(s){for(let e=0;e<o2.length;e+=2)if(o2.charCodeAt(e)==s)return o2.charAt(e+1);return g3(s<128?s:s+1)}function _J(s,e){return s.languageDataAt("closeBrackets",e)[0]||nb}const s4e=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),r4e=Ot.inputHandler.of((s,e,i,n)=>{if((s4e?s.composing:s.compositionStarted)||s.state.readOnly)return!1;let r=s.state.selection.main;if(n.length>2||n.length==2&&al(kr(n,0))==1||e!=r.from||i!=r.to)return!1;let o=l4e(s.state,n);return o?(s.dispatch(o),!0):!1}),o4e=({state:s,dispatch:e})=>{if(s.readOnly)return!1;let n=_J(s,s.selection.main.head).brackets||nb.brackets,r=null,o=s.changeByRange(a=>{if(a.empty){let l=c4e(s.doc,a.head);for(let h of n)if(h==l&&hE(s.doc,a.head)==xJ(kr(h,0)))return{changes:{from:a.head-h.length,to:a.head+h.length},range:et.cursor(a.head-h.length)}}return{range:r=a}});return r||e(s.update(o,{scrollIntoView:!0,userEvent:"delete.backward"})),!r},a4e=[{key:"Backspace",run:o4e}];function l4e(s,e){let i=_J(s,s.selection.main.head),n=i.brackets||nb.brackets;for(let r of n){let o=xJ(kr(r,0));if(e==r)return o==r?d4e(s,r,n.indexOf(r+r+r)>-1,i):h4e(s,r,o,i.before||nb.before);if(e==o&&bJ(s,s.selection.main.from))return u4e(s,r,o)}return null}function bJ(s,e){let i=!1;return s.field(vJ).between(0,s.doc.length,n=>{n==e&&(i=!0)}),i}function hE(s,e){let i=s.sliceString(e,e+2);return i.slice(0,al(kr(i,0)))}function c4e(s,e){let i=s.sliceString(e-2,e);return al(kr(i,0))==i.length?i:i.slice(1)}function h4e(s,e,i,n){let r=null,o=s.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:i,from:a.to}],effects:Up.of(a.to+e.length),range:et.range(a.anchor+e.length,a.head+e.length)};let l=hE(s.doc,a.head);return!l||/\s/.test(l)||n.indexOf(l)>-1?{changes:{insert:e+i,from:a.head},effects:Up.of(a.head+e.length),range:et.cursor(a.head+e.length)}:{range:r=a}});return r?null:s.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function u4e(s,e,i){let n=null,r=s.changeByRange(o=>o.empty&&hE(s.doc,o.head)==i?{changes:{from:o.head,to:o.head+i.length,insert:i},range:et.cursor(o.head+i.length)}:n={range:o});return n?null:s.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function d4e(s,e,i,n){let r=n.stringPrefixes||nb.stringPrefixes,o=null,a=s.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:Up.of(l.to+e.length),range:et.range(l.anchor+e.length,l.head+e.length)};let h=l.head,d=hE(s.doc,h),f;if(d==e){if(SW(s,h))return{changes:{insert:e+e,from:h},effects:Up.of(h+e.length),range:et.cursor(h+e.length)};if(bJ(s,h)){let g=i&&s.sliceDoc(h,h+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:h,to:h+g.length,insert:g},range:et.cursor(h+g.length)}}}else{if(i&&s.sliceDoc(h-2*e.length,h)==e+e&&(f=CW(s,h-2*e.length,r))>-1&&SW(s,f))return{changes:{insert:e+e+e+e,from:h},effects:Up.of(h+e.length),range:et.cursor(h+e.length)};if(s.charCategorizer(h)(d)!=ls.Word&&CW(s,h,r)>-1&&!f4e(s,h,e,r))return{changes:{insert:e+e,from:h},effects:Up.of(h+e.length),range:et.cursor(h+e.length)}}return{range:o=l}});return o?null:s.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function SW(s,e){let i=eo(s).resolveInner(e+1);return i.parent&&i.from==e}function f4e(s,e,i,n){let r=eo(s).resolveInner(e,-1),o=n.reduce((a,l)=>Math.max(a,l.length),0);for(let a=0;a<5;a++){let l=s.sliceDoc(r.from,Math.min(r.to,r.from+i.length+o)),h=l.indexOf(i);if(!h||h>-1&&n.indexOf(l.slice(0,h))>-1){let f=r.firstChild;for(;f&&f.from==r.from&&f.to-f.from>i.length+h;){if(s.sliceDoc(f.to-i.length,f.to)==i)return!1;f=f.firstChild}return!0}let d=r.to==e&&r.parent;if(!d)break;r=d}return!1}function CW(s,e,i){let n=s.charCategorizer(e);if(n(s.sliceDoc(e-1,e))!=ls.Word)return e;for(let r of i){let o=e-r.length;if(s.sliceDoc(o,e)==r&&n(s.sliceDoc(o-1,o))!=ls.Word)return o}return-1}function p4e(s={}){return[t4e,Xo,Rr.of(s),Jze,m4e,i4e]}const wJ=[{key:"Ctrl-Space",run:Yze},{key:"Escape",run:jze},{key:"ArrowDown",run:WO(!0)},{key:"ArrowUp",run:WO(!1)},{key:"PageDown",run:WO(!0,"page")},{key:"PageUp",run:WO(!1,"page")},{key:"Enter",run:Qze}],m4e=Rm.highest(M3.computeN([Rr],s=>s.facet(Rr).defaultKeymap?[wJ]:[]));class g4e{constructor(e,i,n){this.from=e,this.to=i,this.diagnostic=n}}class Mp{constructor(e,i,n){this.diagnostics=e,this.panel=i,this.selected=n}static init(e,i,n){let r=e,o=n.facet(sb).markerFilter;o&&(r=o(r,n));let a=fi.set(r.map(l=>l.from==l.to||l.from==l.to-1&&n.doc.lineAt(l.from).to==l.from?fi.widget({widget:new C4e(l),diagnostic:l}).range(l.from):fi.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l}).range(l.from,l.to)),!0);return new Mp(a,i,wy(a))}}function wy(s,e=null,i=0){let n=null;return s.between(i,1e9,(r,o,{spec:a})=>{if(!(e&&a.diagnostic!=e))return n=new g4e(r,o,a.diagnostic),!1}),n}function y4e(s,e){let i=e.pos,n=e.end||i,r=s.state.facet(sb).hideOn(s,i,n);if(r!=null)return r;let o=s.startState.doc.lineAt(e.pos);return!!(s.effects.some(a=>a.is(OJ))||s.changes.touchesRange(o.from,Math.max(o.to,n)))}function v4e(s,e){return s.field(Ba,!1)?e:e.concat(Fi.appendConfig.of(E4e))}const OJ=Fi.define(),Y3=Fi.define(),SJ=Fi.define(),Ba=$r.define({create(){return new Mp(fi.none,null,null)},update(s,e){if(e.docChanged&&s.diagnostics.size){let i=s.diagnostics.map(e.changes),n=null,r=s.panel;if(s.selected){let o=e.changes.mapPos(s.selected.from,1);n=wy(i,s.selected.diagnostic,o)||wy(i,null,o)}!i.size&&r&&e.state.facet(sb).autoPanel&&(r=null),s=new Mp(i,r,n)}for(let i of e.effects)if(i.is(OJ)){let n=e.state.facet(sb).autoPanel?i.value.length?rb.open:null:s.panel;s=Mp.init(i.value,n,e.state)}else i.is(Y3)?s=new Mp(s.diagnostics,i.value?rb.open:null,s.selected):i.is(SJ)&&(s=new Mp(s.diagnostics,s.panel,i.value));return s},provide:s=>[K_.from(s,e=>e.panel),Ot.decorations.from(s,e=>e.diagnostics)]}),x4e=fi.mark({class:"cm-lintRange cm-lintRange-active"});function _4e(s,e,i){let{diagnostics:n}=s.state.field(Ba),r=[],o=2e8,a=0;n.between(e-(i<0?1:0),e+(i>0?1:0),(h,d,{spec:f})=>{e>=h&&e<=d&&(h==d||(e>h||i>0)&&(e<d||i<0))&&(r.push(f.diagnostic),o=Math.min(h,o),a=Math.max(d,a))});let l=s.state.facet(sb).tooltipFilter;return l&&(r=l(r,s.state)),r.length?{pos:o,end:a,above:s.state.doc.lineAt(o).to<a,create(){return{dom:b4e(s,r)}}}:null}function b4e(s,e){return Gn("ul",{class:"cm-tooltip-lint"},e.map(i=>TJ(s,i,!1)))}const w4e=s=>{let e=s.state.field(Ba,!1);(!e||!e.panel)&&s.dispatch({effects:v4e(s.state,[Y3.of(!0)])});let i=Z_(s,rb.open);return i&&i.dom.querySelector(".cm-panel-lint ul").focus(),!0},TW=s=>{let e=s.state.field(Ba,!1);return!e||!e.panel?!1:(s.dispatch({effects:Y3.of(!1)}),!0)},O4e=s=>{let e=s.state.field(Ba,!1);if(!e)return!1;let i=s.state.selection.main,n=e.diagnostics.iter(i.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==i.from&&n.to==i.to)?!1:(s.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},S4e=[{key:"Mod-Shift-m",run:w4e,preventDefault:!0},{key:"F8",run:O4e}],sb=Pt.define({combine(s){return Object.assign({sources:s.map(e=>e.source).filter(e=>e!=null)},fh(s.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,i)=>e?i?n=>e(n)||i(n):e:i}))}});function CJ(s){let e=[];if(s)e:for(let{name:i}of s){for(let n=0;n<i.length;n++){let r=i[n];if(/[a-zA-Z]/.test(r)&&!e.some(o=>o.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function TJ(s,e,i){var n;let r=i?CJ(e.actions):[];return Gn("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Gn("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(s):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((o,a)=>{let l=!1,h=g=>{if(g.preventDefault(),l)return;l=!0;let y=wy(s.state.field(Ba).diagnostics,e);y&&o.apply(s,y.from,y.to)},{name:d}=o,f=r[a]?d.indexOf(r[a]):-1,p=f<0?d:[d.slice(0,f),Gn("u",d.slice(f,f+1)),d.slice(f+1)];return Gn("button",{type:"button",class:"cm-diagnosticAction",onclick:h,onmousedown:h,"aria-label":` Action: ${d}${f<0?"":` (access key "${r[a]})"`}.`},p)}),e.source&&Gn("div",{class:"cm-diagnosticSource"},e.source))}class C4e extends Of{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return Gn("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class AW{constructor(e,i){this.diagnostic=i,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=TJ(e,i,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class rb{constructor(e){this.view=e,this.items=[];let i=r=>{if(r.keyCode==27)TW(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:o}=this.items[this.selectedIndex],a=CJ(o.actions);for(let l=0;l<a.length;l++)if(a[l].toUpperCase().charCodeAt(0)==r.keyCode){let h=wy(this.view.state.field(Ba).diagnostics,o);h&&o.actions[l].apply(e,h.from,h.to)}}else return;r.preventDefault()},n=r=>{for(let o=0;o<this.items.length;o++)this.items[o].dom.contains(r.target)&&this.moveSelection(o)};this.list=Gn("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:i,onclick:n}),this.dom=Gn("div",{class:"cm-panel-lint"},this.list,Gn("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>TW(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(Ba).selected;if(!e)return-1;for(let i=0;i<this.items.length;i++)if(this.items[i].diagnostic==e.diagnostic)return i;return-1}update(){let{diagnostics:e,selected:i}=this.view.state.field(Ba),n=0,r=!1,o=null;for(e.between(0,this.view.state.doc.length,(a,l,{spec:h})=>{let d=-1,f;for(let p=n;p<this.items.length;p++)if(this.items[p].diagnostic==h.diagnostic){d=p;break}d<0?(f=new AW(this.view,h.diagnostic),this.items.splice(n,0,f),r=!0):(f=this.items[d],d>n&&(this.items.splice(n,d-n),r=!0)),i&&f.diagnostic==i.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),o=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),n++});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new AW(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:a,panel:l})=>{let h=l.height/this.list.offsetHeight;a.top<l.top?this.list.scrollTop-=(l.top-a.top)/h:a.bottom>l.bottom&&(this.list.scrollTop+=(a.bottom-l.bottom)/h)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function i(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)i();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)i()}moveSelection(e){if(this.selectedIndex<0)return;let i=this.view.state.field(Ba),n=wy(i.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:SJ.of(n)})}static open(e){return new rb(e)}}function T4e(s,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(s)}</svg>')`}function HO(s){return T4e(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${s}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const A4e=Ot.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:HO("#d11")},".cm-lintRange-warning":{backgroundImage:HO("orange")},".cm-lintRange-info":{backgroundImage:HO("#999")},".cm-lintRange-hint":{backgroundImage:HO("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),E4e=[Ba,Ot.decorations.compute([Ba],s=>{let{selected:e,panel:i}=s.field(Ba);return!e||!i||e.from==e.to?fi.none:fi.set([x4e.range(e.from,e.to)])}),v$e(_4e,{hideOn:y4e}),A4e],CT=[M$e(),I$e(),jVe(),ZUe(),OUe(),VVe(),XVe(),gn.allowMultipleSelections.of(!0),cUe(),CUe(EUe,{fallback:!0}),DUe(),n4e(),p4e(),a$e(),h$e(),t$e(),oze(),M3.of([...a4e,...eze,...Cze,...oFe,...xUe,...wJ,...S4e])];var EW={};class TT{constructor(e,i,n,r,o,a,l,h,d,f=0,p){this.p=e,this.stack=i,this.state=n,this.reducePos=r,this.pos=o,this.score=a,this.buffer=l,this.bufferBase=h,this.curContext=d,this.lookAhead=f,this.parent=p}toString(){return`[${this.stack.filter((e,i)=>i%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,i,n=0){let r=e.parser.context;return new TT(e,[],i,n,n,0,[],0,r?new MW(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,i){this.stack.push(this.state,i,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var i;let n=e>>19,r=e&65535,{parser:o}=this.p,a=this.reducePos<this.pos-25;a&&this.setLookAhead(this.pos);let l=o.dynamicPrecedence(r);if(l&&(this.score+=l),n==0){this.pushState(o.getGoto(this.state,r,!0),this.reducePos),r<o.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(r,this.reducePos);return}let h=this.stack.length-(n-1)*3-(e&262144?6:0),d=h?this.stack[h-2]:this.p.ranges[0].from,f=this.reducePos-d;f>=2e3&&!(!((i=this.p.parser.nodeSet.types[r])===null||i===void 0)&&i.isAnonymous)&&(d==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=f):this.p.lastBigReductionSize<f&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=d,this.p.lastBigReductionSize=f));let p=h?this.stack[h-1]:0,g=this.bufferBase+this.buffer.length-p;if(r<o.minRepeatTerm||e&131072){let y=o.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,d,y,g+4,!0)}if(e&262144)this.state=this.stack[h];else{let y=this.stack[h-3];this.state=o.getGoto(y,r,!0)}for(;this.stack.length>h;)this.stack.pop();this.reduceContext(r,d)}storeNode(e,i,n,r=4,o=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,l=this.buffer.length;if(l==0&&a.parent&&(l=a.bufferBase-a.parent.bufferBase,a=a.parent),l>0&&a.buffer[l-4]==0&&a.buffer[l-1]>-1){if(i==n)return;if(a.buffer[l-2]>=i){a.buffer[l-2]=n;return}}}if(!o||this.pos==n)this.buffer.push(e,i,n,r);else{let a=this.buffer.length;if(a>0&&this.buffer[a-4]!=0){let l=!1;for(let h=a;h>0&&this.buffer[h-2]>n;h-=4)if(this.buffer[h-1]>=0){l=!0;break}if(l)for(;a>0&&this.buffer[a-2]>n;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,r>4&&(r-=4)}this.buffer[a]=e,this.buffer[a+1]=i,this.buffer[a+2]=n,this.buffer[a+3]=r}}shift(e,i,n,r){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=r,this.shiftContext(i,n),i<=this.p.parser.maxNode&&this.buffer.push(i,n,r,4);else{let o=e,{parser:a}=this.p;(r>this.pos||i<=a.maxNode)&&(this.pos=r,a.stateFlag(o,1)||(this.reducePos=r)),this.pushState(o,n),this.shiftContext(i,n),i<=a.maxNode&&this.buffer.push(i,n,r,4)}}apply(e,i,n,r){e&65536?this.reduce(e):this.shift(e,i,n,r)}useNode(e,i){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(i,r),this.buffer.push(n,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,i=e.buffer.length;for(;i>0&&e.buffer[i-2]>e.reducePos;)i-=4;let n=e.buffer.slice(i),r=e.bufferBase+i;for(;e&&r==e.bufferBase;)e=e.parent;return new TT(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,i){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,i,4),this.storeNode(0,this.pos,i,n?8:4),this.pos=this.reducePos=i,this.score-=190}canShift(e){for(let i=new M4e(this);;){let n=this.p.parser.stateSlot(i.state,4)||this.p.parser.hasAction(i.state,e);if(n==0)return!1;if(!(n&65536))return!0;i.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let i=this.p.parser.nextStates(this.state);if(i.length>8||this.stack.length>=120){let r=[];for(let o=0,a;o<i.length;o+=2)(a=i[o+1])!=this.state&&this.p.parser.hasAction(a,e)&&r.push(i[o],a);if(this.stack.length<120)for(let o=0;r.length<8&&o<i.length;o+=2){let a=i[o+1];r.some((l,h)=>h&1&&l==a)||r.push(i[o],a)}i=r}let n=[];for(let r=0;r<i.length&&n.length<4;r+=2){let o=i[r+1];if(o==this.state)continue;let a=this.split();a.pushState(o,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(i[r],this.pos),a.reducePos=this.pos,a.score-=200,n.push(a)}return n}forceReduce(){let{parser:e}=this.p,i=e.stateSlot(this.state,5);if(!(i&65536))return!1;if(!e.validAction(this.state,i)){let n=i>>19,r=i&65535,o=this.stack.length-n*3;if(o<0||e.getGoto(this.stack[o],r,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;i=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(i),!0}findForcedReduction(){let{parser:e}=this.p,i=[],n=(r,o)=>{if(!i.includes(r))return i.push(r),e.allActions(r,a=>{if(!(a&393216))if(a&65536){let l=(a>>19)-o;if(l>1){let h=a&65535,d=this.stack.length-l*3;if(d>=0&&e.getGoto(this.stack[d],h,!1)>=0)return l<<19|65536|h}}else{let l=n(a,o+1);if(l!=null)return l}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let i=0;i<this.stack.length;i+=3)if(this.stack[i]!=e.stack[i])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,i){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(i)))}reduceContext(e,i){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(i)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let i=new MW(this.curContext.tracker,e);i.hash!=this.curContext.hash&&this.emitContext(),this.curContext=i}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class MW{constructor(e,i){this.tracker=e,this.context=i,this.hash=e.strict?e.hash(i):0}}class M4e{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let i=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],i,!0);this.state=r}}class AT{constructor(e,i,n){this.stack=e,this.pos=i,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,i=e.bufferBase+e.buffer.length){return new AT(e,i,i-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new AT(this.stack,this.pos,this.index)}}function GO(s,e=Uint16Array){if(typeof s!="string")return s;let i=null;for(let n=0,r=0;n<s.length;){let o=0;for(;;){let a=s.charCodeAt(n++),l=!1;if(a==126){o=65535;break}a>=92&&a--,a>=34&&a--;let h=a-32;if(h>=46&&(h-=46,l=!0),o+=h,l)break;o*=46}i?i[r++]=o:i=new e(o)}return i}class lC{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const kW=new lC;class k4e{constructor(e,i){this.input=e,this.ranges=i,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=kW,this.rangeIndex=0,this.pos=this.chunkPos=i[0].from,this.range=i[0],this.end=i[i.length-1].to,this.readNext()}resolveOffset(e,i){let n=this.range,r=this.rangeIndex,o=this.pos+e;for(;o<n.from;){if(!r)return null;let a=this.ranges[--r];o-=n.from-a.to,n=a}for(;i<0?o>n.to:o>=n.to;){if(r==this.ranges.length-1)return null;let a=this.ranges[++r];o+=a.from-n.to,n=a}return o}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let i of this.ranges)if(i.to>e)return Math.max(e,i.from);return this.end}peek(e){let i=this.chunkOff+e,n,r;if(i>=0&&i<this.chunk.length)n=this.pos+e,r=this.chunk.charCodeAt(i);else{let o=this.resolveOffset(e,1);if(o==null)return-1;if(n=o,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let a=this.rangeIndex,l=this.range;for(;l.to<=n;)l=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>l.to&&(this.chunk2=this.chunk2.slice(0,l.to-n)),r=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),r}acceptToken(e,i=0){let n=i?this.resolveOffset(i,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,i){this.token.value=e,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:i}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=i,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),i=this.pos+e.length;this.chunk=i>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,i){if(i?(this.token=i,i.start=e,i.lookAhead=e+1,i.value=i.extended=-1):this.token=kW,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,i){if(e>=this.chunkPos&&i<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,i-this.chunkPos);if(e>=this.chunk2Pos&&i<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,i-this.chunk2Pos);if(e>=this.range.from&&i<=this.range.to)return this.input.read(e,i);let n="";for(let r of this.ranges){if(r.from>=i)break;r.to>e&&(n+=this.input.read(Math.max(r.from,e),Math.min(r.to,i)))}return n}}class j0{constructor(e,i){this.data=e,this.id=i}token(e,i){let{parser:n}=i.p;P4e(this.data,e,i,this.id,n.data,n.tokenPrecTable)}}j0.prototype.contextual=j0.prototype.fallback=j0.prototype.extend=!1;j0.prototype.fallback=j0.prototype.extend=!1;class AJ{constructor(e,i={}){this.token=e,this.contextual=!!i.contextual,this.fallback=!!i.fallback,this.extend=!!i.extend}}function P4e(s,e,i,n,r,o){let a=0,l=1<<n,{dialect:h}=i.p.parser;e:for(;l&s[a];){let d=s[a+1];for(let y=a+3;y<d;y+=2)if((s[y+1]&l)>0){let x=s[y];if(h.allows(x)&&(e.token.value==-1||e.token.value==x||I4e(x,e.token.value,r,o))){e.acceptToken(x);break}}let f=e.next,p=0,g=s[a+2];if(e.next<0&&g>p&&s[d+g*3-3]==65535){a=s[d+g*3-1];continue e}for(;p<g;){let y=p+g>>1,x=d+y+(y<<1),_=s[x],w=s[x+1]||65536;if(f<_)g=y;else if(f>=w)p=y+1;else{a=s[x+2],e.advance();continue e}}break}}function PW(s,e,i){for(let n=e,r;(r=s[n])!=65535;n++)if(r==i)return n-e;return-1}function I4e(s,e,i,n){let r=PW(i,n,e);return r<0||PW(i,n,s)<r}const va=typeof process<"u"&&EW&&/\bparse\b/.test(EW.LOG);let a2=null;function IW(s,e,i){let n=s.cursor(_r.IncludeAnonymous);for(n.moveTo(e);;)if(!(i<0?n.childBefore(e):n.childAfter(e)))for(;;){if((i<0?n.to<e:n.from>e)&&!n.type.isError)return i<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(s.length,Math.max(n.from+1,e+25));if(i<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return i<0?0:s.length}}class B4e{constructor(e,i){this.fragments=e,this.nodeSet=i,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?IW(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?IW(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let i=this.trees.length-1;if(i<0)return this.nextFragment(),null;let n=this.trees[i],r=this.index[i];if(r==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let o=n.children[r],a=this.start[i]+n.positions[r];if(a>e)return this.nextStart=a,null;if(o instanceof Qs){if(a==e){if(a<this.safeFrom)return null;let l=a+o.length;if(l<=this.safeTo){let h=o.prop(Hi.lookAhead);if(!h||l+h<this.fragment.to)return o}}this.index[i]++,a+o.length>=Math.max(this.safeFrom,e)&&(this.trees.push(o),this.start.push(a),this.index.push(0))}else this.index[i]++,this.nextStart=a+o.length}}}class R4e{constructor(e,i){this.stream=i,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new lC)}getActions(e){let i=0,n=null,{parser:r}=e.p,{tokenizers:o}=r,a=r.stateSlot(e.state,3),l=e.curContext?e.curContext.hash:0,h=0;for(let d=0;d<o.length;d++){if(!(1<<d&a))continue;let f=o[d],p=this.tokens[d];if(!(n&&!f.fallback)&&((f.contextual||p.start!=e.pos||p.mask!=a||p.context!=l)&&(this.updateCachedToken(p,f,e),p.mask=a,p.context=l),p.lookAhead>p.end+25&&(h=Math.max(p.lookAhead,h)),p.value!=0)){let g=i;if(p.extended>-1&&(i=this.addActions(e,p.extended,p.end,i)),i=this.addActions(e,p.value,p.end,i),!f.extend&&(n=p,i>g))break}}for(;this.actions.length>i;)this.actions.pop();return h&&e.setLookAhead(h),!n&&e.pos==this.stream.end&&(n=new lC,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,i=this.addActions(e,n.value,n.end,i)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let i=new lC,{pos:n,p:r}=e;return i.start=n,i.end=Math.min(n+1,r.stream.end),i.value=n==r.stream.end?r.parser.eofTerm:0,i}updateCachedToken(e,i,n){let r=this.stream.clipPos(n.pos);if(i.token(this.stream.reset(r,e),n),e.value>-1){let{parser:o}=n.p;for(let a=0;a<o.specialized.length;a++)if(o.specialized[a]==e.value){let l=o.specializers[a](this.stream.read(e.start,e.end),n);if(l>=0&&n.p.parser.dialect.allows(l>>1)){l&1?e.extended=l>>1:e.value=l>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1)}putAction(e,i,n,r){for(let o=0;o<r;o+=3)if(this.actions[o]==e)return r;return this.actions[r++]=e,this.actions[r++]=i,this.actions[r++]=n,r}addActions(e,i,n,r){let{state:o}=e,{parser:a}=e.p,{data:l}=a;for(let h=0;h<2;h++)for(let d=a.stateSlot(o,h?2:1);;d+=3){if(l[d]==65535)if(l[d+1]==1)d=Hh(l,d+2);else{r==0&&l[d+1]==2&&(r=this.putAction(Hh(l,d+2),i,n,r));break}l[d]==i&&(r=this.putAction(Hh(l,d+1),i,n,r))}return r}}class D4e{constructor(e,i,n,r){this.parser=e,this.input=i,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new k4e(i,r),this.tokens=new R4e(e,this.stream),this.topTerm=e.top[1];let{from:o}=r[0];this.stacks=[TT.start(this,e.top[0],o)],this.fragments=n.length&&this.stream.end-o>e.bufferLength*4?new B4e(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,i=this.minStackPos,n=this.stacks=[],r,o;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let l=e[a];for(;;){if(this.tokens.mainToken=null,l.pos>i)n.push(l);else{if(this.advanceStack(l,n,e))continue;{r||(r=[],o=[]),r.push(l);let h=this.tokens.getMainToken(l);o.push(h.value,h.end)}}break}}if(!n.length){let a=r&&N4e(r);if(a)return va&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw va&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+i);this.recovering||(this.recovering=5)}if(this.recovering&&r){let a=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,o,n);if(a)return va&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(n.length>a)for(n.sort((l,h)=>h.score-l.score);n.length>a;)n.pop();n.some(l=>l.reducePos>i)&&this.recovering--}else if(n.length>1){e:for(let a=0;a<n.length-1;a++){let l=n[a];for(let h=a+1;h<n.length;h++){let d=n[h];if(l.sameState(d)||l.buffer.length>500&&d.buffer.length>500)if((l.score-d.score||l.buffer.length-d.buffer.length)>0)n.splice(h--,1);else{n.splice(a--,1);continue e}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let a=1;a<n.length;a++)n[a].pos<this.minStackPos&&(this.minStackPos=n[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,i,n){let r=e.pos,{parser:o}=this,a=va?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let d=e.curContext&&e.curContext.tracker.strict,f=d?e.curContext.hash:0;for(let p=this.fragments.nodeAt(r);p;){let g=this.parser.nodeSet.types[p.type.id]==p.type?o.getGoto(e.state,p.type.id):-1;if(g>-1&&p.length&&(!d||(p.prop(Hi.contextHash)||0)==f))return e.useNode(p,g),va&&console.log(a+this.stackID(e)+` (via reuse of ${o.getName(p.type.id)})`),!0;if(!(p instanceof Qs)||p.children.length==0||p.positions[0]>0)break;let y=p.children[0];if(y instanceof Qs&&p.positions[0]==0)p=y;else break}}let l=o.stateSlot(e.state,4);if(l>0)return e.reduce(l),va&&console.log(a+this.stackID(e)+` (via always-reduce ${o.getName(l&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let h=this.tokens.getActions(e);for(let d=0;d<h.length;){let f=h[d++],p=h[d++],g=h[d++],y=d==h.length||!n,x=y?e:e.split(),_=this.tokens.mainToken;if(x.apply(f,p,_?_.start:x.pos,g),va&&console.log(a+this.stackID(x)+` (via ${f&65536?`reduce of ${o.getName(f&65535)}`:"shift"} for ${o.getName(p)} @ ${r}${x==e?"":", split"})`),y)return!0;x.pos>r?i.push(x):n.push(x)}return!1}advanceFully(e,i){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return BW(e,i),!0}}runRecovery(e,i,n){let r=null,o=!1;for(let a=0;a<e.length;a++){let l=e[a],h=i[a<<1],d=i[(a<<1)+1],f=va?this.stackID(l)+" -> ":"";if(l.deadEnd&&(o||(o=!0,l.restart(),va&&console.log(f+this.stackID(l)+" (restarted)"),this.advanceFully(l,n))))continue;let p=l.split(),g=f;for(let y=0;p.forceReduce()&&y<10&&(va&&console.log(g+this.stackID(p)+" (via force-reduce)"),!this.advanceFully(p,n));y++)va&&(g=this.stackID(p)+" -> ");for(let y of l.recoverByInsert(h))va&&console.log(f+this.stackID(y)+" (via recover-insert)"),this.advanceFully(y,n);this.stream.end>l.pos?(d==l.pos&&(d++,h=0),l.recoverByDelete(h,d),va&&console.log(f+this.stackID(l)+` (via recover-delete ${this.parser.getName(h)})`),BW(l,n)):(!r||r.score<l.score)&&(r=l)}return r}stackToTree(e){return e.close(),Qs.build({buffer:AT.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let i=(a2||(a2=new WeakMap)).get(e);return i||a2.set(e,i=String.fromCodePoint(this.nextStackID++)),i+e}}function BW(s,e){for(let i=0;i<e.length;i++){let n=e[i];if(n.pos==s.pos&&n.sameState(s)){e[i].score<s.score&&(e[i]=s);return}}e.push(s)}class L4e{constructor(e,i,n){this.source=e,this.flags=i,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}}class ET extends oK{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let i=e.nodeNames.split(" ");this.minRepeatTerm=i.length;for(let l=0;l<e.repeatNodeCount;l++)i.push("");let n=Object.keys(e.topRules).map(l=>e.topRules[l][1]),r=[];for(let l=0;l<i.length;l++)r.push([]);function o(l,h,d){r[l].push([h,h.deserialize(String(d))])}if(e.nodeProps)for(let l of e.nodeProps){let h=l[0];typeof h=="string"&&(h=Hi[h]);for(let d=1;d<l.length;){let f=l[d++];if(f>=0)o(f,h,l[d++]);else{let p=l[d+-f];for(let g=-f;g>0;g--)o(l[d++],h,p);d++}}}this.nodeSet=new I3(i.map((l,h)=>sa.define({name:h>=this.minRepeatTerm?void 0:l,id:h,props:r[h],top:n.indexOf(h)>-1,error:h==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(h)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=iK;let a=GO(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let l=0;l<this.specializerSpecs.length;l++)this.specialized[l]=this.specializerSpecs[l].term;this.specializers=this.specializerSpecs.map(RW),this.states=GO(e.states,Uint32Array),this.data=GO(e.stateData),this.goto=GO(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(l=>typeof l=="number"?new j0(a,l):l),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,i,n){let r=new D4e(this,e,i,n);for(let o of this.wrappers)r=o(r,e,i,n);return r}getGoto(e,i,n=!1){let r=this.goto;if(i>=r[0])return-1;for(let o=r[i+1];;){let a=r[o++],l=a&1,h=r[o++];if(l&&n)return h;for(let d=o+(a>>1);o<d;o++)if(r[o]==e)return h;if(l)return-1}}hasAction(e,i){let n=this.data;for(let r=0;r<2;r++)for(let o=this.stateSlot(e,r?2:1),a;;o+=3){if((a=n[o])==65535)if(n[o+1]==1)a=n[o=Hh(n,o+2)];else{if(n[o+1]==2)return Hh(n,o+2);break}if(a==i||a==0)return Hh(n,o+1)}return 0}stateSlot(e,i){return this.states[e*6+i]}stateFlag(e,i){return(this.stateSlot(e,0)&i)>0}validAction(e,i){return!!this.allActions(e,n=>n==i?!0:null)}allActions(e,i){let n=this.stateSlot(e,4),r=n?i(n):void 0;for(let o=this.stateSlot(e,1);r==null;o+=3){if(this.data[o]==65535)if(this.data[o+1]==1)o=Hh(this.data,o+2);else break;r=i(Hh(this.data,o+1))}return r}nextStates(e){let i=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=Hh(this.data,n+2);else break;if(!(this.data[n+2]&1)){let r=this.data[n+1];i.some((o,a)=>a&1&&o==r)||i.push(this.data[n],r)}}return i}configure(e){let i=Object.assign(Object.create(ET.prototype),this);if(e.props&&(i.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);i.top=n}return e.tokenizers&&(i.tokenizers=this.tokenizers.map(n=>{let r=e.tokenizers.find(o=>o.from==n);return r?r.to:n})),e.specializers&&(i.specializers=this.specializers.slice(),i.specializerSpecs=this.specializerSpecs.map((n,r)=>{let o=e.specializers.find(l=>l.from==n.external);if(!o)return n;let a=Object.assign(Object.assign({},n),{external:o.to});return i.specializers[r]=RW(a),a})),e.contextTracker&&(i.context=e.contextTracker),e.dialect&&(i.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(i.strict=e.strict),e.wrap&&(i.wrappers=i.wrappers.concat(e.wrap)),e.bufferLength!=null&&(i.bufferLength=e.bufferLength),i}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let i=this.dynamicPrecedences;return i==null?0:i[e]||0}parseDialect(e){let i=Object.keys(this.dialects),n=i.map(()=>!1);if(e)for(let o of e.split(" ")){let a=i.indexOf(o);a>=0&&(n[a]=!0)}let r=null;for(let o=0;o<i.length;o++)if(!n[o])for(let a=this.dialects[i[o]],l;(l=this.data[a++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[l]=1;return new L4e(e,n,r)}static deserialize(e){return new ET(e)}}function Hh(s,e){return s[e]|s[e+1]<<16}function N4e(s){let e=null;for(let i of s){let n=i.p.stoppedAt;(i.pos==i.p.stream.end||n!=null&&i.pos>n)&&i.p.parser.stateFlag(i.state,2)&&(!e||e.score<i.score)&&(e=i)}return e}function RW(s){if(s.external){let e=s.extend?1:0;return(i,n)=>s.external(i,n)<<1|e}return s.get}const DW=1,V4e=2,$4e=3,U4e=82,F4e=76,z4e=117,X4e=85,W4e=97,H4e=122,G4e=65,Q4e=90,Y4e=95,XR=48,LW=34,j4e=40,NW=41,q4e=32,VW=62,Z4e=new AJ(s=>{if(s.next==F4e||s.next==X4e?s.advance():s.next==z4e&&(s.advance(),s.next==XR+8&&s.advance()),s.next!=U4e||(s.advance(),s.next!=LW))return;s.advance();let e="";for(;s.next!=j4e;){if(s.next==q4e||s.next<=13||s.next==NW)return;e+=String.fromCharCode(s.next),s.advance()}for(s.advance();;){if(s.next<0)return s.acceptToken(DW);if(s.next==NW){let i=!0;for(let n=0;i&&n<e.length;n++)s.peek(n+1)!=e.charCodeAt(n)&&(i=!1);if(i&&s.peek(e.length+1)==LW)return s.acceptToken(DW,2+e.length)}s.advance()}}),K4e=new AJ(s=>{if(s.next==VW)s.peek(1)==VW&&s.acceptToken(V4e,1);else{let e=!1,i=0;for(;;i++){if(s.next>=G4e&&s.next<=Q4e)e=!0;else{if(s.next>=W4e&&s.next<=H4e)return;if(s.next!=Y4e&&!(s.next>=XR&&s.next<=XR+9))break}s.advance()}e&&i>1&&s.acceptToken($4e)}},{extend:!0}),J4e=aK({"typedef struct union enum class typename decltype auto template operator friend noexcept namespace using requires concept import export module __attribute__ __declspec __based":We.definitionKeyword,"extern MsCallModifier MsPointerModifier extern static register thread_local inline const volatile restrict _Atomic mutable constexpr constinit consteval virtual explicit VirtualSpecifier Access":We.modifier,"if else switch for while do case default return break continue goto throw try catch":We.controlKeyword,"co_return co_yield co_await":We.controlKeyword,"new sizeof delete static_assert":We.operatorKeyword,"NULL nullptr":We.null,this:We.self,"True False":We.bool,"TypeSize PrimitiveType":We.standard(We.typeName),TypeIdentifier:We.typeName,FieldIdentifier:We.propertyName,"CallExpression/FieldExpression/FieldIdentifier":We.function(We.propertyName),"ModuleName/Identifier":We.namespace,PartitionName:We.labelName,StatementIdentifier:We.labelName,"Identifier DestructorName":We.variableName,"CallExpression/Identifier":We.function(We.variableName),"CallExpression/ScopedIdentifier/Identifier":We.function(We.variableName),"FunctionDeclarator/Identifier FunctionDeclarator/DestructorName":We.function(We.definition(We.variableName)),NamespaceIdentifier:We.namespace,OperatorName:We.operator,ArithOp:We.arithmeticOperator,LogicOp:We.logicOperator,BitOp:We.bitwiseOperator,CompareOp:We.compareOperator,AssignOp:We.definitionOperator,UpdateOp:We.updateOperator,LineComment:We.lineComment,BlockComment:We.blockComment,Number:We.number,String:We.string,"RawString SystemLibString":We.special(We.string),CharLiteral:We.character,EscapeSequence:We.escape,"UserDefinedLiteral/Identifier":We.literal,PreProcArg:We.meta,"PreprocDirectiveName #include #ifdef #ifndef #if #define #else #endif #elif":We.processingInstruction,MacroName:We.special(We.name),"( )":We.paren,"[ ]":We.squareBracket,"{ }":We.brace,"< >":We.angleBracket,". ->":We.derefOperator,", ;":We.separator}),e5e={__proto__:null,bool:34,char:34,int:34,float:34,double:34,void:34,size_t:34,ssize_t:34,intptr_t:34,uintptr_t:34,charptr_t:34,int8_t:34,int16_t:34,int32_t:34,int64_t:34,uint8_t:34,uint16_t:34,uint32_t:34,uint64_t:34,char8_t:34,char16_t:34,char32_t:34,char64_t:34,const:68,volatile:70,restrict:72,_Atomic:74,mutable:76,constexpr:78,constinit:80,consteval:82,struct:86,__declspec:90,final:148,override:148,public:152,private:152,protected:152,virtual:154,extern:160,static:162,register:164,inline:166,thread_local:168,__attribute__:172,__based:178,__restrict:180,__uptr:180,__sptr:180,_unaligned:180,__unaligned:180,noexcept:194,requires:198,TRUE:784,true:784,FALSE:786,false:786,typename:218,class:220,template:234,throw:248,__cdecl:256,__clrcall:256,__stdcall:256,__fastcall:256,__thiscall:256,__vectorcall:256,try:260,catch:264,export:282,import:286,case:296,default:298,if:308,else:314,switch:318,do:322,while:324,for:330,return:334,break:338,continue:342,goto:346,co_return:350,co_yield:354,using:362,typedef:366,namespace:380,new:398,delete:400,co_await:402,concept:406,enum:410,static_assert:414,friend:422,union:424,explicit:430,operator:444,module:456,signed:518,unsigned:518,long:518,short:518,decltype:528,auto:530,sizeof:566,NULL:572,nullptr:586,this:588},t5e={__proto__:null,"<":131},i5e={__proto__:null,">":135},n5e={__proto__:null,operator:388,new:576,delete:582},s5e=ET.deserialize({version:14,states:"$:|Q!QQVOOP'gOUOOO(XOWO'#CdO,RQUO'#CgO,]QUO'#FjO-sQbO'#CwO.UQUO'#CwO0TQUO'#KZO0[QUO'#CvO0gOpO'#DvO0oQ!dO'#D]OOQR'#JO'#JOO5XQVO'#GUO5fQUO'#JVOOQQ'#JV'#JVO8zQUO'#KmO<eQUO'#KmO>{QVO'#E^O?]QUO'#E^OOQQ'#Ed'#EdOOQQ'#Ee'#EeO?bQVO'#EfO@XQVO'#EiOBUQUO'#FPOBvQUO'#FhOOQR'#Fj'#FjOB{QUO'#FjOOQR'#LQ'#LQOOQR'#LP'#LPOETQVO'#KQOFxQUO'#LVOGVQUO'#KqOGkQUO'#LVOH]QUO'#LXOOQR'#HU'#HUOOQR'#HV'#HVOOQR'#HW'#HWOOQR'#K|'#K|OOQR'#J_'#J_Q!QQVOOOHkQVO'#FOOIWQUO'#EhOI_QUOOOKZQVO'#HgOKkQUO'#HgONVQUO'#KqONaQUO'#KqOOQQ'#Kq'#KqO!!_QUO'#KqOOQQ'#Jq'#JqO!!lQUO'#HxOOQQ'#KZ'#KZO!&^QUO'#KZO!&zQUO'#KQO!(zQVO'#I]O!(zQVO'#I`OCQQUO'#KQOOQQ'#Ip'#IpOOQQ'#KQ'#KQO!,}QUO'#KZOOQR'#KY'#KYO!-UQUO'#DYO!/mQUO'#KnOOQQ'#Kn'#KnO!/tQUO'#KnO!/{QUO'#ETO!0QQUO'#EWO!0VQUO'#FRO8zQUO'#FPO!QQVO'#F^O!0[Q#vO'#F`O!0gQUO'#FkO!0oQUO'#FpO!0tQVO'#FrO!0oQUO'#FuO!3sQUO'#FvO!3xQVO'#FxO!4SQUO'#FzO!4XQUO'#F|O!4^QUO'#GOO!4cQVO'#GQO!(zQVO'#GSO!4jQUO'#GpO!4xQUO'#GYO!(zQVO'#FeO!6VQUO'#FeO!6[QVO'#G`O!6cQUO'#GaO!6nQUO'#GnO!6sQUO'#GrO!6xQUO'#GzO!7jQ&lO'#HiO!:mQUO'#GuO!:}QUO'#HXO!;YQUO'#HZO!;bQUO'#DWO!;bQUO'#HuO!;bQUO'#HvO!;yQUO'#HwO!<[QUO'#H|O!=PQUO'#H}O!>uQVO'#IbO!(zQVO'#IdO!?PQUO'#IgO!?WQVO'#IjP!@}{,UO'#CbP!6n{,UO'#CbP!AY{7[O'#CbP!6n{,UO'#CbP!A_{,UO'#CbP!AjOSO'#IzPOOO)CEn)CEnOOOO'#I|'#I|O!AtOWO,59OOOQR,59O,59OO!(zQVO,59UOOQQ,59W,59WO!(zQVO,5;ROOQR,5<U,5<UO!BPQUO,59YO!(zQVO,5>qOOQR'#IX'#IXOOQR'#IY'#IYOOQR'#IZ'#IZOOQR'#I['#I[O!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!DOQVO,5>zOOQQ,5?W,5?WO!EqQVO'#ChO!IjQUO'#CyOOQQ,59c,59cOOQQ,59b,59bOOQQ,5<},5<}O!IwQ&lO,5=mO!?PQUO,5?RO!LkQVO,5?UO!LrQbO,59cO!L}QVO'#FYOOQQ,5?P,5?PO!M_QVO,59VO!MfO`O,5:bO!MkQbO'#D^O!M|QbO'#K^O!N[QbO,59wO!NdQbO'#CwO!NuQUO'#CwO!NzQUO'#KZO# UQUO'#CvOOQR-E<|-E<|O# aQUO,5AoO# hQVO'#EfO@XQVO'#EiOBUQUO,5;kOOQR,5<p,5<pO#$aQUO'#KQO#$hQUO'#KQO!(zQVO'#IUO8zQUO,5;kO#${Q&lO'#HiO#(SQUO'#CsO#*wQbO'#CwO#*|QUO'#CvO#.jQUO'#KZOOQQ-E=T-E=TO#0}QUO,5AXO#1XQUO'#KZO#1cQUO,5AXOOQR,5Ao,5AoOOQQ,5>l,5>lO#3gQUO'#CgO#4]QUO,5>pO#6OQUO'#IeOOQR'#I}'#I}O#6WQUO,5:xO#6tQUO,5:xO#7eQUO,5:xO#8YQUO'#CtO!0QQUO'#ClOOQQ'#JW'#JWO#6tQUO,5:xO#8bQUO,5;QO!4xQUO'#C}O#9kQUO,5;QO#9pQUO,5>QO#:|QUO'#C}O#;dQUO,5>{O#;iQUO'#KwO#<rQUO,5;TO#<zQVO,5;TO#=UQUO,5;TOOQQ,5;T,5;TO#>}QUO'#L[O#?UQUO,5>UO#?ZQbO'#CwO#?fQUO'#GcO#?kQUO'#E^O#@[QUO,5;kO#@sQUO'#K}O#@{QUO,5;rOKkQUO'#HfOBUQUO'#HgO#AQQUO'#KqO!6nQUO'#HjO#AxQUO'#CtO!0tQVO,5<SOOQQ'#Cg'#CgOOQR'#Jh'#JhO#A}QVO,5=`OOQQ,5?Z,5?ZO#DWQbO'#CwO#DcQUO'#GcOOQQ'#Ji'#JiOOQQ-E=g-E=gOGVQUO,5AqOGkQUO,5AqO#DhQUO,5AsO#DsQUO'#G|OOQR,5Aq,5AqO#DhQUO,5AqO#EOQUO'#HOO#EWQUO,5AsOOQR,5As,5AsOOQR,5At,5AtO#EfQVO,5AtOOQR-E=]-E=]O#G`QVO,5;jOOQR,5;j,5;jO#IaQUO'#EjO#JfQUO'#EwO#K]QVO'#ExO#MoQUO'#EvO#MwQUO'#EyO#NvQUO'#EzOOQQ'#Kz'#KzO$ mQUO,5;SO$!sQUO'#EvOOQQ,5;S,5;SO$#pQUO,5;SO$%cQUO,5:yO$'|QVO,5>PO$(WQUO'#E[O$(eQUO,5>ROOQQ,5>S,5>SO$,RQVO'#C{OOQQ-E=o-E=oOOQQ,5>d,5>dOOQQ,59`,59`O$,]QUO,5>wO$.]QUO,5>zO!6nQUO,59tO$.pQUO,5;qO$.}QUO,5<{O!0QQUO,5:oOOQQ,5:r,5:rO$/YQUO,5;mO$/_QUO'#KmOBUQUO,5;kOOQR,5;x,5;xO$0OQUO'#FbO$0^QUO'#FbO$0cQUO,5;zO$3|QVO'#FmO!0tQVO,5<VO!0oQUO,5<VO!0VQUO,5<[O$4TQVO'#GUO$7PQUO,5<^O!0tQVO,5<aO$:gQVO,5<bO$:tQUO,5<dOOQR,5<d,5<dO$;}QUO,5<dOOQR,5<f,5<fOOQR,5<h,5<hOOQQ'#Fi'#FiO$<SQUO,5<jO$<XQUO,5<lOOQR,5<l,5<lO$=_QUO,5<nO$>eQUO,5<rO$>pQUO,5=[O$>uQUO,5=[O!4xQUO,5<tO$>}QUO,5<tO$?cQUO,5<PO$@iQVO,5<PO$BzQUO,5<zOOQR,5<z,5<zOOQR,5<{,5<{O$>uQUO,5<{O$DQQUO,5<{O$D]QUO,5=YO!(zQVO,5=^O!(zQVO,5=fO#NeQUO,5=mOOQQ,5>T,5>TO$FbQUO,5>TO$FlQUO,5>TO$FqQUO,5>TO$FvQUO,5>TO!6nQUO,5>TO$HtQUO'#KZO$H{QUO,5=oO$IWQUO,5=aOKkQUO,5=oO$JQQUO,5=sOOQR,5=s,5=sO$JYQUO,5=sO$LeQVO'#H[OOQQ,5=u,5=uO!;]QUO,5=uO%#`QUO'#KjO%#gQUO'#K[O%#{QUO'#KjO%$VQUO'#DyO%$hQUO'#D|O%'eQUO'#K[OOQQ'#K['#K[O%)WQUO'#K[O%#gQUO'#K[O%)]QUO'#K[OOQQ,59r,59rOOQQ,5>a,5>aOOQQ,5>b,5>bO%)eQUO'#HzO%)mQUO,5>cOOQQ,5>c,5>cO%-XQUO,5>cO%-dQUO,5>hO%1OQVO,5>iO%1VQUO,5>|O# hQVO'#EfO%4]QUO,5>|OOQQ,5>|,5>|O%4|QUO,5?OO%7QQUO,5?RO!<[QUO,5?RO%8|QUO,5?UO%<iQVO,5?UP!A_{,UO,58|P%<p{,UO,58|P%=O{7[O,58|P%=U{,UO,58|PO{O'#Ju'#JuP%=Z{,UO'#LcPOOO'#Lc'#LcP%=a{,UO'#LcPOOO,58|,58|POOO,5?f,5?fP%=fOSO,5?fOOOO-E<z-E<zOOQR1G.j1G.jO%=mQUO1G.pO%>sQUO1G0mOOQQ1G0m1G0mO%@PQUO'#CoO%B`QbO'#CwO%BkQUO'#CrO%BpQUO'#CrO%BuQUO1G.tO#AxQUO'#CqOOQQ1G.t1G.tO%DxQUO1G4]O%FOQUO1G4^O%GqQUO1G4^O%IdQUO1G4^O%KVQUO1G4^O%LxQUO1G4^O%NkQUO1G4^O&!^QUO1G4^O&$PQUO1G4^O&%rQUO1G4^O&'eQUO1G4^O&)WQUO1G4^O&*yQUO'#KPO&,SQUO'#KPO&,[QUO,59SOOQQ,5=P,5=PO&.dQUO,5=PO&.nQUO,5=PO&.sQUO,5=PO&.xQUO,5=PO!6nQUO,5=PO#NeQUO1G3XO&/SQUO1G4mO!<[QUO1G4mO&1OQUO1G4pO&2qQVO1G4pOOQQ1G.}1G.}OOQQ1G.|1G.|OOQQ1G2i1G2iO!IwQ&lO1G3XO&2xQUO'#LOO@XQVO'#EiO&4RQUO'#F]OOQQ'#Ja'#JaO&4WQUO'#FZO&4cQUO'#LOO&4kQUO,5;tO&4pQUO1G.qOOQQ1G.q1G.qOOQR1G/|1G/|O&6cQ!dO'#JPO&6hQbO,59xO&8yQ!eO'#D`O&9QQ!dO'#JRO&9VQbO,5@xO&9VQbO,5@xOOQR1G/c1G/cO&9bQbO1G/cO&9gQ&lO'#GeO&:eQbO,59cOOQR1G7Z1G7ZO#@[QUO1G1VO&:pQUO1G1^OBUQUO1G1VO&=RQUO'#CyO#*wQbO,59cO&@tQUO1G6sOOQR-E<{-E<{O&BWQUO1G0dO#6WQUO1G0dOOQQ-E=U-E=UO#6tQUO1G0dOOQQ1G0l1G0lO&B{QUO,59iOOQQ1G3l1G3lO&CcQUO,59iO&CyQUO,59iO!M_QVO1G4gO!(zQVO'#JYO&DeQUO,5AcOOQQ1G0o1G0oO!(zQVO1G0oO!6nQUO'#JnO&DmQUO,5AvOOQQ1G3p1G3pOOQR1G1V1G1VO&HjQVO'#FOO!M_QVO,5;sOOQQ,5;s,5;sOBUQUO'#JcO&JfQUO,5AiO&JnQVO'#E[OOQR1G1^1G1^O&M]QUO'#L[OOQR1G1n1G1nOOQR-E=f-E=fOOQR1G7]1G7]O#DhQUO1G7]OGVQUO1G7]O#DhQUO1G7_OOQR1G7_1G7_O&MeQUO'#G}O&MmQUO'#LWOOQQ,5=h,5=hO&M{QUO,5=jO&NQQUO,5=kOOQR1G7`1G7`O#EfQVO1G7`O&NVQUO1G7`O' ]QVO,5=kOOQR1G1U1G1UO$.vQUO'#E]O'!RQUO'#E]OOQQ'#Ky'#KyO'!lQUO'#KxO'!wQUO,5;UO'#PQUO'#ElO'#dQUO'#ElO'#wQUO'#EtOOQQ'#J['#J[O'#|QUO,5;cO'$sQUO,5;cO'%nQUO,5;dO'&tQVO,5;dOOQQ,5;d,5;dO''OQVO,5;dO'&tQVO,5;dO''VQUO,5;bO'(SQUO,5;eO'(_QUO'#KpO'(gQUO,5:vO'(lQUO,5;fOOQQ1G0n1G0nOOQQ'#J]'#J]O''VQUO,5;bO!4xQUO'#E}OOQQ,5;b,5;bO')gQUO'#E`O'+aQUO'#E{OHrQUO1G0nO'+fQUO'#EbOOQQ'#JX'#JXO'-OQUO'#KrOOQQ'#Kr'#KrO'-xQUO1G0eO'.pQUO1G3kO'/vQVO1G3kOOQQ1G3k1G3kO'0QQVO1G3kO'0XQUO'#L_O'1eQUO'#KXO'1sQUO'#KWO'2OQUO,59gO'2WQUO1G/`O'2]QUO'#FPOOQR1G1]1G1]OOQR1G2g1G2gO$>uQUO1G2gO'2gQUO1G2gO'2rQUO1G0ZOOQR'#J`'#J`O'2wQVO1G1XO'8pQUO'#FTO'8uQUO1G1VO!6nQUO'#JdO'9TQUO,5;|O$0^QUO,5;|OOQQ'#Fc'#FcOOQQ,5;|,5;|O'9cQUO1G1fOOQR1G1f1G1fO'9kQUO,5<XO$.vQUO'#FWOBUQUO'#FWO'9rQUO,5<XO!(zQVO,5<XO'9zQUO,5<XO':PQVO1G1qO!0tQVO1G1qOOQR1G1v1G1vO'?oQUO1G1xOOQR1G1{1G1{O'?tQUO1G1|OBUQUO1G2]O'@}QVO1G1|O'CcQUO1G1|O'ChQUO'#GWO8zQUO1G2]OOQR1G2O1G2OOOQR1G2U1G2UOOQR1G2W1G2WOOQR1G2Y1G2YO'CmQUO1G2^O!4xQUO1G2^OOQR1G2v1G2vO'CuQUO1G2vO$>}QUO1G2`OOQQ'#Cu'#CuO'CzQUO'#G[O'DuQUO'#G[O'DzQUO'#LRO'EYQUO'#G_OOQQ'#LS'#LSO'EhQUO1G2`O'EmQVO1G1kO'HOQVO'#GUOBUQUO'#FWOOQR'#Je'#JeO'EmQVO1G1kO'HYQUO'#FvOOQR1G2f1G2fO'H_QUO1G2gO'HdQUO'#JgO'2gQUO1G2gO!(zQVO1G2tO'HlQUO1G2xO'IuQUO1G3QO'J{QUO1G3XOOQQ1G3o1G3oO'KaQUO1G3oOOQR1G3Z1G3ZO'KfQUO'#KZO'2]QUO'#LTOGkQUO'#LVOOQR'#Gy'#GyO#DhQUO'#LXOOQR'#HQ'#HQO'KpQUO'#GvO'#wQUO'#GuOOQR1G2{1G2{O'LmQUO1G2{O'MdQUO1G3ZO'MoQUO1G3_O'MtQUO1G3_OOQR1G3_1G3_O'M|QUO'#H]OOQR'#H]'#H]O( VQUO'#H]O!(zQVO'#H`O!(zQVO'#H_OOQR'#LZ'#LZO( [QUO'#LZOOQR'#Jk'#JkO( aQVO,5=vOOQQ,5=v,5=vO( hQUO'#H^O( pQUO'#HZOOQQ1G3a1G3aO( zQUO,5@vOOQQ,5@v,5@vO%)WQUO,5@vO%)]QUO,5@vO%$VQUO,5:eO(%iQUO'#KkO(%wQUO'#KkOOQQ,5:e,5:eOOQQ'#JS'#JSO(&SQUO'#D}O(&^QUO'#KqOGkQUO'#LVO('YQUO'#D}OOQQ'#Hp'#HpOOQQ'#Hr'#HrOOQQ'#Hs'#HsOOQQ'#Kl'#KlOOQQ'#JU'#JUO('dQUO,5:hOOQQ,5:h,5:hO((aQUO'#LVO((nQUO'#HtO()UQUO,5@vO()]QUO'#H{O()hQUO'#L^O()pQUO,5>fO()uQUO'#L]OOQQ1G3}1G3}O(-lQUO1G3}O(-sQUO1G3}O(-zQUO1G4TO(/QQUO1G4TO(/VQUO,5A|O!6nQUO1G4hO!(zQVO'#IiOOQQ1G4m1G4mO(/[QUO1G4mO(1_QVO1G4pPOOO1G.h1G.hP!A_{,UO1G.hP(3_QUO'#LeP(3j{,UO1G.hP(3o{7[O1G.hPO{O-E=s-E=sPOOO,5A},5A}P(3w{,UO,5A}POOO1G5Q1G5QO!(zQVO7+$[O(3|QUO'#CyOOQQ,59^,59^O(4XQbO,59cO(4dQbO,59^OOQQ,59],59]OOQQ7+)w7+)wO!M_QVO'#JtO(4oQUO,5@kOOQQ1G.n1G.nOOQQ1G2k1G2kO(4wQUO1G2kO(4|QUO7+(sOOQQ7+*X7+*XO(7bQUO7+*XO(7iQUO7+*XO(1_QVO7+*[O#NeQUO7+(sO(7vQVO'#JbO(8ZQUO,5AjO(8cQUO,5;vOOQQ'#Co'#CoOOQQ,5;w,5;wO!(zQVO'#F[OOQQ-E=_-E=_O!M_QVO,5;uOOQQ1G1`1G1`OOQQ,5?k,5?kOOQQ-E<}-E<}OOQR'#Dg'#DgOOQR'#Di'#DiOOQR'#Dl'#DlO(9lQ!eO'#K_O(9sQMkO'#K_O(9zQ!eO'#K_OOQR'#K_'#K_OOQR'#JQ'#JQO(:RQ!eO,59zOOQQ,59z,59zO(:YQbO,5?mOOQQ-E=P-E=PO(:hQbO1G6dOOQR7+$}7+$}OOQR7+&q7+&qOOQR7+&x7+&xO'8uQUO7+&qO(:sQUO7+&OO#6WQUO7+&OO(;hQUO1G/TO(<OQUO1G/TO(<jQUO7+*ROOQQ7+*V7+*VO(>]QUO,5?tOOQQ-E=W-E=WO(?fQUO7+&ZOOQQ,5@Y,5@YOOQQ-E=l-E=lO(?kQUO'#LOO@XQVO'#EiO(@wQUO1G1_OOQQ1G1_1G1_O(BQQUO,5?}OOQQ,5?},5?}OOQQ-E=a-E=aO(BfQUO'#KpOOQR7+,w7+,wO#DhQUO7+,wOOQR7+,y7+,yO(BsQUO,5=iO#DsQUO'#JjO(CUQUO,5ArOOQR1G3U1G3UOOQR1G3V1G3VO(CdQUO7+,zOOQR7+,z7+,zO(E[QUO,5:wO(FyQUO'#EwO!(zQVO,5;VO(GlQUO,5:wO(GvQUO'#EpO(HXQUO'#EzOOQQ,5;Z,5;ZO#K]QVO'#ExO(HoQUO,5:wO(HvQUO'#EyO#GgQUO'#JZO(J`QUO,5AdOOQQ1G0p1G0pO(JkQUO,5;WO!<[QUO,5;^O(KUQUO,5;_O(KdQUO,5;WO(MvQUO,5;`OOQQ-E=Y-E=YO(NOQUO1G0}OOQQ1G1O1G1OO(NyQUO1G1OO)!PQVO1G1OO)!WQVO1G1OO)!bQUO1G0|OOQQ1G0|1G0|OOQQ1G1P1G1PO)#_QUO'#JoO)#iQUO,5A[OOQQ1G0b1G0bOOQQ-E=Z-E=ZO)#qQUO,5;iO!<[QUO,5;iO)$nQVO,5:zO)$uQUO,5;gO$ mQUO7+&YOOQQ7+&Y7+&YO!(zQVO'#EfO)$|QUO,5:|OOQQ'#Ks'#KsOOQQ-E=V-E=VOOQQ,5A^,5A^OOQQ'#Jl'#JlO)(qQUO7+&PPOQQ7+&P7+&POOQQ7+)V7+)VO))iQUO7+)VO)*oQVO7+)VOOQQ,5>m,5>mO$)YQVO'#JsO)*vQUO,5@rOOQQ1G/R1G/ROOQQ7+$z7+$zO)+RQUO7+(RO)+WQUO7+(ROOQR7+(R7+(RO$>uQUO7+(ROOQQ7+%u7+%uOOQR-E=^-E=^O!0VQUO,5;oOOQQ,5@O,5@OOOQQ-E=b-E=bO$0^QUO1G1hOOQQ1G1h1G1hOOQR7+'Q7+'QOOQR1G1s1G1sOBUQUO,5;rO)+tQUO,5<YO)+{QUO1G1sO)-UQUO1G1sO!0tQVO7+']O)-ZQVO7+']O)2yQUO7+'dO)3OQVO7+'hO)5dQUO7+'wO)5nQUO7+'hO)6tQVO7+'hOKkQUO7+'wO$>hQUO,5<rO!4xQUO7+'xO)6{QUO7+'xOOQR7+(b7+(bO)7QQUO7+'zO)7VQUO,5<vO'CzQUO,5<vO)7}QUO,5<vO'CzQUO,5<vOOQQ,5<w,5<wO)8`QVO,5<xO'EYQUO'#JfO)8jQUO,5AmO)8rQUO,5<yOOQR7+'z7+'zO)8}QVO7+'VO)5gQUO'#K}OOQR-E=c-E=cO);`QVO,5<bOOQQ,5@R,5@RO!6nQUO,5@ROOQQ-E=e-E=eO)=wQUO7+(`O)>}QUO7+(dO)?SQVO7+(dOOQQ7+(l7+(lOOQQ7+)Z7+)ZO)?[QUO'#KjO)?fQUO'#KjOOQR,5=b,5=bO)?sQUO,5=bO!;bQUO,5=bO!;bQUO,5=bO!;bQUO,5=bOOQR7+(g7+(gOOQR7+(u7+(uOOQR7+(y7+(yOOQR,5=w,5=wO)?xQUO,5=zO)AOQUO,5=yOOQR,5Au,5AuOOQR-E=i-E=iOOQQ1G3b1G3bO)BUQUO,5=xO)BZQVO'#EfOOQQ1G6b1G6bO%)WQUO1G6bO%)]QUO1G6bOOQQ1G0P1G0POOQQ-E=Q-E=QO)DrQUO,5AVO(%iQUO'#JTO)D}QUO,5AVO)D}QUO,5AVO)EVQUO,5:iO8zQUO,5:iOOQQ,5>],5>]O)EaQUO,5AqO)EhQUO'#EVO)FrQUO'#EVO)G]QUO,5:iO)GgQUO'#HlO)GgQUO'#HmOOQQ'#Ko'#KoO)HUQUO'#KoO!(zQVO'#HnOOQQ,5:i,5:iO)HvQUO,5:iO!M_QVO,5:iOOQQ-E=S-E=SOOQQ1G0S1G0SOOQQ,5>`,5>`O)H{QUO1G6bO!(zQVO,5>gO)LjQUO'#JrO)LuQUO,5AxOOQQ1G4Q1G4QO)L}QUO,5AwOOQQ,5Aw,5AwOOQQ7+)i7+)iO*!lQUO7+)iOOQQ7+)o7+)oO*'kQVO1G7hO*)mQUO7+*SO*)rQUO,5?TO**xQUO7+*[POOO7+$S7+$SP*,kQUO'#LfP*,sQUO,5BPP*,x{,UO7+$SPOOO1G7i1G7iO*,}QUO<<GvOOQQ1G.x1G.xOOQQ'#IT'#ITO*.pQUO,5@`OOQQ,5@`,5@`OOQQ-E=r-E=rOOQQ7+(V7+(VOOQQ<<Ms<<MsO*/yQUO<<MsO*1|QUO<<MvO*3oQUO<<L_O*4TQUO,5?|OOQQ,5?|,5?|OOQQ-E=`-E=`OOQQ1G1b1G1bO*5^QUO,5;vO*6dQUO1G1aOOQQ1G1a1G1aOOQR,5@y,5@yO*7mQ!eO,5@yO*7tQMkO,5@yO*7{Q!eO,5@yOOQR-E=O-E=OOOQQ1G/f1G/fO*8SQ!eO'#DwOOQQ1G5X1G5XOOQR<<J]<<J]O*8ZQUO<<IjO*9OQUO7+$oOOQQ<<Iu<<IuO(7vQVO,5;ROOQR<=!c<=!cOOQQ1G3T1G3TOOQQ,5@U,5@UOOQQ-E=h-E=hOOQR<=!f<=!fO*9{QUO1G0cO*:SQUO'#EzO*:dQUO1G0cO*:kQUO'#I}O*<RQUO1G0qO!(zQVO1G0qOOQQ,5;[,5;[OOQQ,5;],5;]OOQQ,5?u,5?uOOQQ-E=X-E=XO!<[QUO1G0xO*=bQUO1G0xOOQQ1G0y1G0yO*=sQUO'#ElOOQQ1G0z1G0zOOQQ7+&j7+&jO*>XQUO7+&jO*?_QVO7+&jOOQQ7+&h7+&hOOQQ,5@Z,5@ZOOQQ-E=m-E=mO*@ZQUO1G1TO*@eQUO1G1TO*AOQUO1G0fOOQQ1G0f1G0fO*BUQUO'#K{O*B^QUO1G1ROOQQ<<It<<ItOOQQ'#Hb'#HbO'+fQUO,5={OOQQ'#Hd'#HdO'+fQUO,5=}OOQQ-E=j-E=jPOQQ<<Ik<<IkPOQQ-E=k-E=kOOQQ<<Lq<<LqO*BcQUO'#LaO*CoQUO'#L`OOQQ,5@_,5@_OOQQ-E=q-E=qOOQR<<Km<<KmO$>uQUO<<KmO*C}QUO<<KmOOQR1G1Z1G1ZOOQQ7+'S7+'SO!M_QVO1G1tO*DSQUO1G1tOOQR7+'_7+'_OOQR<<Jw<<JwO!0tQVO<<JwOOQR<<KO<<KOO*D_QUO<<KSO*EeQVO<<KSOKkQUO<<KcO!M_QVO<<KcO*ElQUO<<KSO!0tQVO<<KSO*FuQUO<<KSO*FzQUO<<KcO*GVQUO<<KdOOQR<<Kd<<KdOOQR<<Kf<<KfO*G[QUO1G2bO)7VQUO1G2bO'CzQUO1G2bO*GmQUO1G2dO*HsQVO1G2dOOQQ1G2d1G2dO*H}QVO1G2dO*IUQUO,5@QOOQQ-E=d-E=dOOQQ1G2e1G2eO*IdQUO1G1|O*JmQVO1G1|O*JtQUO1G1|OOQQ1G5m1G5mOOQR<<Kz<<KzOOQR<<LO<<LOO*JyQVO<<LOO*KUQUO<<LOOOQR1G2|1G2|O*KZQUO1G2|O*KbQUO1G3eOOQR1G3d1G3dOOQQ7++|7++|O%)WQUO7++|O*KmQUO1G6qO*KmQUO1G6qO(%iQUO,5?oO*KuQUO,5?oOOQQ-E=R-E=RO*LQQUO1G0TOOQQ1G0T1G0TO*L[QUO1G0TO!M_QVO1G0TO*LaQUO1G0TOOQQ1G3w1G3wO*LkQUO,5:qO)EhQUO,5:qO*MXQUO,5:qO)EhQUO,5:qO$#uQUO,5:uO*MvQVO,5>VO)GgQUO'#JpO*NQQUO1G0TO*NcQVO1G0TOOQQ1G3u1G3uO*NjQUO,5>WO*NuQUO,5>XO+ dQUO,5>YO+!jQUO1G0TO%)]QUO7++|O+#pQUO1G4ROOQQ,5@^,5@^OOQQ-E=p-E=pOOQQ<<MT<<MTOOQQ<<Mn<<MnO+$yQUO1G4oP+&|QUO'#JvP+'UQUO,5BQPO{O1G7k1G7kPOOO<<Gn<<GnOOQQANC_ANC_OOQR1G6e1G6eO+'^Q!eO,5:cOOQQ,5:c,5:cO+'eQUO1G0mO+(qQUO7+&]O+*QQUO7+&dO+*cQUO,5;WOOQQ<<JU<<JUO+*qQUO7+&oOOQQ7+&Q7+&QO!4xQUO'#J^O++lQUO,5AgOOQQ7+&m7+&mOOQQ1G3g1G3gO++tQUO1G3iOOQQ,5>n,5>nO+/iQUOANAXOOQRANAXANAXO+/nQUO7+'`OOQRAN@cAN@cO+0zQVOAN@nO+1RQUOAN@nO!0tQVOAN@nO+2[QUOAN@nO+2aQUOAN@}O+2lQUOAN@}O+3rQUOAN@}OOQRAN@nAN@nO!M_QVOAN@}OOQRANAOANAOO+3wQUO7+'|O)7VQUO7+'|OOQQ7+(O7+(OO+4YQUO7+(OO+5`QVO7+(OO+5gQVO7+'hO+5nQUOANAjOOQR7+(h7+(hOOQR7+)P7+)PO+5sQUO7+)PO+5xQUO7+)POOQQ<= h<= hO+6QQUO7+,]O+6YQUO1G5ZOOQQ1G5Z1G5ZO+6eQUO7+%oOOQQ7+%o7+%oO+6vQUO7+%oO*NcQVO7+%oOOQQ7+)a7+)aO+6{QUO7+%oO+8RQUO7+%oO!M_QVO7+%oO+8]QUO1G0]O*LkQUO1G0]O)EhQUO1G0]OOQQ1G0a1G0aO+8zQUO1G3qO+:QQVO1G3qOOQQ1G3q1G3qO+:[QVO1G3qO+:cQUO,5@[OOQQ-E=n-E=nOOQQ1G3r1G3rO%)WQUO<= hOOQQ7+*Z7+*ZPOQQ,5@b,5@bPOQQ-E=t-E=tOOQQ1G/}1G/}OOQQ,5?x,5?xOOQQ-E=[-E=[OOQRG26sG26sO+:zQUOG26YO!0tQVOG26YO+<TQUOG26YOOQRG26YG26YO!M_QVOG26iO!0tQVOG26iO+<YQUOG26iO+=`QUOG26iO+=eQUO<<KhOOQQ<<Kj<<KjOOQRG27UG27UOOQR<<Lk<<LkO+=vQUO<<LkOOQQ7+*u7+*uOOQQ<<IZ<<IZO+={QUO<<IZO!M_QVO<<IZO+>QQUO<<IZO+?WQUO<<IZO*NcQVO<<IZOOQQ<<L{<<L{O+?iQUO7+%wO*LkQUO7+%wOOQQ7+)]7+)]O+@WQUO7+)]O+A^QVO7+)]OOQQANESANESO!0tQVOLD+tOOQRLD+tLD+tO+AeQUOLD,TO+BkQUOLD,TOOQRLD,TLD,TO!0tQVOLD,TOOQRANBVANBVOOQQAN>uAN>uO+BpQUOAN>uO+CvQUOAN>uO!M_QVOAN>uO+C{QUO<<IcOOQQ<<Lw<<LwOOQR!$( `!$( `O!0tQVO!$( oOOQR!$( o!$( oOOQQG24aG24aO+DjQUOG24aO+EpQUOG24aOOQR!)9EZ!)9EZOOQQLD){LD){O+EuQUO'#CgO(dQUO'#CgO+IrQUO'#CyO+LcQUO'#CyO!E{QUO'#CyO+M[QUO'#CyO+MoQUO'#CyO,#bQUO'#CyO,#rQUO'#CyO,$PQUO'#CyO,$[QbO,59cO,$gQbO,59cO,$rQbO,59cO,$}QbO'#CwO,%`QbO'#CwO,%qQbO'#CwO,&SQUO'#CgO,(gQUO'#CgO,(tQUO'#CgO,+iQUO'#CgO,.lQUO'#CgO,.|QUO'#CgO,2uQUO'#CgO,2|QUO'#CgO,3|QUO'#CgO,6VQUO,5:xO#?kQUO,5:xO#?kQUO,5:xO#=ZQUO'#L[O,6sQbO'#CwO,7OQbO'#CwO,7ZQbO'#CwO,7fQbO'#CwO#6tQUO'#E^O,7qQUO'#E^O,9OQUO'#HgO,9pQbO'#CwO,9{QbO'#CwO,:WQUO'#CvO,:]QUO'#CvO,:bQUO'#CoO,:pQbO,59cO,:{QbO,59cO,;WQbO,59cO,;cQbO,59cO,;nQbO,59cO,;yQbO,59cO,<UQbO,59cO,6VQUO1G0dO,<aQUO1G0dO#?kQUO1G0dO,7qQUO1G0dO,>nQUO'#KZO,?OQUO'#CyO,?^QbO,59cO,6VQUO7+&OO,<aQUO7+&OO,?iQUO'#EwO,@[QUO'#EzO,@{QUO'#E^O,AQQUO'#GcO,AVQUO'#CvO,A[QUO'#CwO,AaQUO'#CwO,AfQUO'#CvO,AkQUO'#GcO,ApQUO'#KZO,B^QUO'#KZO,BhQUO'#CvO,BsQUO'#CvO,COQUO'#CvO,<aQUO,5:xO,7qQUO,5:xO,7qQUO,5:xO,CZQUO'#KZO,CnQbO'#CwO,CyQUO'#CrO,DOQUO'#E^",stateData:",Dt~O(nOSSOSTOSRPQVPQ'ePQ'gPQ'hPQ'iPQ'jPQ'kPQ'lPQ'mPQ~O*ZOS~OPmO]eOa!]Od!POlTOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!TxO!VfO!X!XO!Y!WO!i!YO!opO!r!`O!s!aO!t!aO!u!bO!v!aO!x!cO!{!dO#V#QO#a#VO#b#TO#i#OO#p!xO#t!fO#v!eO$R!gO$T!hO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO${!tO$}!uO%U!yO%_#ZO%`#[O%a#YO%c!zO%e#UO%g!{O%l#SO%o!|O%v!}O%|#PO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(rRO)PYO)SaO)U|O)V{O)WiO)X!ZO)YXO)hcO)idO~OR#bOV#]O'e#^O'g#_O'h#`O'i#`O'j#aO'k#aO'l#_O'm#_O~OX#dO(p#dO(q#fO~O]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!TiX!VZX!ViX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX(uZX(v$]X(wZX(xZX)SZX)SiX)TZX)UZX)UiX)VZX)ViX)WZX)XZX)jZX~O)WiX!UZX~P(dO]#}O!V#lO!X#{O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO(w#kO(x#kO)S#mO)T#oO)U#nO)V#pO)W#jO)X#|O~Od$RO%Y$SO'[$TO'_$UO(y$OO~Ol$VO~O!T$WO](}Xd(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)W(}X~Ol$VO~P.ZOl$VO!g$YO)j$YO~OX$ZO)Z$ZO~O!R$[O)X)QP)])QP~OPmO]$eOa!]Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!TxO!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~Ol$_O#t$lO(rRO~P0zO](]Xa'yXd(]Xl'yXl(]Xr'yXr(]Xs'yXs(]Xt'yXt(]Xu'yXu(]Xv'yXv(]Xw'yXw(]Xx'yXx(]Xy'yXy(]X{'yX}'yX!V(]X!o(]X!r'yX!r(]X!s'yX!s(]X!t'yX!t(]X!u'yX!u(]X!v'yX!v(]X!x'yX!x(]X!{(]X#a'yX#b'yX%e'yX%l'yX%o(]X%v(]X&m'yX&r'yX&s'yX(r'yX(r(]X)S(]X)U(]X)V(]X~Oa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO&r#WO&s$wO])aXd)aXl)aX!V)aX!{)aX%v)aX(r)aX)S)aX)U)aX)V)aX~O)W$vO~P:nOPmO]eOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!VfO!X!XO!Y!WO!i!YO!{!dO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)SaO)U|O)V{O)X!ZO)YXO)hcO)idO~Oa%QOl:zO!|%RO(r$xO~P<lO)S%SO~Oa!]Ol$_O{#RO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r:}O~P<lOPmO]$eOa%QOl:zO!V$fO!W%_O!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V%]O)X!ZO)YXO)hcO)idO)j%[O~O]%hOd!POl%bO!V%kO!{!dO%v$mO(r;OO)S%dO)U%iO)V%iO~O(v%mO~O)W#jO~O(r%nO](tX!V(tX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!g(tX)j(tX!O(tX!W(tX(v(tX!U(tXQ(tX!d(tX~OP%oO(oQO~PCQO]%hOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V%kO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO!{!dO%o!|O%v!}O)S;`O)U|O)V|O~Ol%rO!o%wO(r$xO~PE_O!TxO#v!eO(v%yO)j%|O])eX!V)eX~O]%hOd!POl%rO!V%kO!{!dO%v!}O(r$xO)S;`O)U|O)V|O~O!TxO#v!eO)W&PO)j&QO~O!U&TO~P!QO]&YO!TxO!V&WO)S&VO)U&ZO)V&ZO~Op&UO~PHrO]&cO!V&bO~OPmO]eOd!PO!VfO!X!XO!Y!WO!i!YO!{!dO#V#QO%_#ZO%`#[O%a#YO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)SaO)U|O)V{O)X!ZO)YXO)hcO)idO~Oa%QOl:zO%v$mO(r$xO~PIgO]%hOd!POl;[O!V%kO!{!dO%v$mO(r$xO)S;`O)U|O)V|O~Op&fO](tX])eX!V(tX!V)eX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!O(tX!O)eX!U(tX~O!g$YO)j$YO~PL]O!g(tX)j(tX~PL]O](tX!V(tX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!g(tX)j(tX!O(tX!U(tX~O])eX!V)eX!O)eX~PNkOa&hO&m!RO]&lXd&lXl&lXr&lXs&lXt&lXu&lXv&lXw&lXx&lXy&lX}&lX!V&lX!r&lX!s&lX!t&lX!u&lX!v&lX!x&lX!{&lX%v&lX&r&lX&s&lX(r&lX)S&lX)U&lX)V&lX)W&lX!O&lX!T&lX!X&lX!Y&lX![&lX!^&lX!_&lX!a&lX!b&lX!c&lX!e&lX!f&lX!h&lX(u&lX(w&lX(x&lX)T&lX)X&lX!g&lX)j&lX!W&lXQ&lX!d&lX(v&lX!U&lX#v&lX~Op&fOl(}X!O(}XQ(}X!d(}X!h(}X)X(}X)j(}X~P.ZO!g$YO)j$YO](tX!V(tX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!O(tX!W(tX(v(tX!U(tXQ(tX!d(tX~OPmO]$eOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O](}Xd(}Xl(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)W(}X!O(}XQ(}X!d(}X!h(}X)X(}X)j(}X~O]#}O~P!*qO]&lO~O])bXa)bXd)bXl)bXr)bXs)bXt)bXu)bXv)bXw)bXx)bXy)bX{)bX})bX!V)bX!o)bX!r)bX!s)bX!t)bX!u)bX!v)bX!x)bX!{)bX#a)bX#b)bX%e)bX%l)bX%o)bX%v)bX&m)bX&r)bX&s)bX(r)bX)S)bX)U)bX)V)bX~O(oQO~P!-ZO%U&nO~P!-ZO]&oO~O]#}O~O!TxO~O$W&wO(r%nO(v&vO~O]&xOw&zO~O]&xO~OPmO]$eOa%QOl:zO!TxO!V$fO!X!XO!Y!WO!i!YO#V#QO#p!xO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:mO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~O]'PO~O!T$WO)W'RO~P!(zO)W'TO~O)W'UO~O(r'VO~O)W'YO~P!(zOl;^O%U'^O%e'^O(r;PO~Oa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO~O(v'bO~O)W'dO~P!(zO!TxO(r%nO)j'fO~O(r%nO~O]'iO~O]'jOd%nXl%nX!V%nX!{%nX%v%nX(r%nX)S%nX)U%nX)V%nX~O]'nO!V'oO!X'lO!g'lO%Z'lO%['lO%]'lO%^'lO%_'pO%`'pO%a'lO(x'mO)j'lO)x'qO~P8zO]%hOa!TOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V%kO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO!{!dO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO)S;`O)U|O)V|O~Ol;_Op&UO%v$mO(r;QO~P!8jO(r%nO(v'vO)W'wO~O]&cO!T'yO~Ol$oO}!_O!T(QO!l(VO(r$nO(v(PO)PYO~Ol$oO{(^O!T(ZO#b(^O(r$nO~Oa!TOl$oO{#RO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO~O](`O~OPmOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)YXO)hcO)idO~O](bO)X(cO~P!=UO]#}O~P!<[OPmO]$eOa%QOl:zO!V(iO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~OY(jO(oQO(r%nO~O'f(mO~OS(qOT(nO*W(pO~O]#}O(n(tO~Q'nXX#dO(p#dO(q(vO~Od)QOl({O&r#WO(r(zO~O!Y'Sa!['Sa!^'Sa!_'Sa!a'Sa!b'Sa!c'Sa!e'Sa!f'Sa!h'Sa(u'Sa)S'Sa)T'Sa)U'Sa)V'Sa)W'Sa)X'Sa!g'Sa)j'Sa!O'Sa!W'Sa(v'Sa!U'SaQ'Sa!d'Sa~OPmOa%QOl:zO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)YXO)hcO)idO]'Sa!V'Sa!X'Sa(w'Sa(x'Sa~P!B_O!T$WO!O(sP~P!(zO]nX]%WXdnXlmXpnXp%WXrnXsnXtnXunXvnXwnXxnXynX}nX!TnX!VnX!V%WX!X%WX!Y%WX![%WX!^%WX!_%WX!a%WX!b%WX!c%WX!e%WX!f%WX!gmX!h%WX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX(u%WX(w%WX(x%WX)SnX)S%WX)T%WX)UnX)U%WX)VnX)V%WX)W%WX)X%WX)jmX!O%WX~O)WnX!OnX!U%WX~P!E{O])dO!V)eO!X)bO!g)bO%Z)bO%[)bO%])bO%^)bO%_)fO%`)fO%a)bO(x)cO)j)bO)x)gO~P8zOPmO]$eOa%QOl:zO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O!V)lO~P!JwOd)oO%Y)pO(y$OO~O!T$WO!V)rO(w)sO!U)rP~P!JwO!T$WO~P!(zO)[)zO~Ol){O]!QX!h!QX)X!QX)]!QX~O])}O!h*OO)X)QX)])QX~O)X*SO)]*RO~Od$RO%Y*TO'[$TO'_$UO(y$OO~Ol*UO~Ol*UO!O(}X~P.ZOl*UO!g$YO)j$YO~O)W*VO~P:nOPmO]$eOa!]Ol$_Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)S$kO)V$kO)X!ZO)YXO)hcO)idO~Op&fO~P!&zOp&fO!W(tX(v(tXQ(tX!d(tX~PNkO]'nO!V'oO!X'lO!g'lO%Z'lO%['lO%]'lO%^'lO%_'pO%`'pO%a'lO(x'mO)j'lO)x'qO~O]iXdiXlgXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX!TiX!hiX)XiX)jiX!OiX~O!liX(viX)WiX!XiX!YiX![iX!^iX!_iX!aiX!biX!ciX!eiX!fiX(uiX(wiX(xiX)TiX!giX!WiXQiX!diX!UiX#viX#TiX#ViX#piXaiX{iX!oiX#aiX#biX#iiX#tiX${iX%ciX%eiX%kiX%liX%oiX&miX)PiX~P#%yO(y*ZO~Ol*[O~O](}Xd(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)W(}X!T(}X!X(}X!Y(}X![(}X!^(}X!_(}X!a(}X!b(}X!c(}X!e(}X!f(}X!h(}X(u(}X(w(}X(x(}X)T(}X)X(}X!g(}X)j(}X!O(}X!W(}XQ(}X!d(}X(v(}X!U(}X#v(}X~Ol*[O~P#+ROr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO])aad)aal)aa!V)aa!{)aa%v)aa(r)aa)S)aa)U)aa)V)aaQ)aa!d)aa!h)aa)X)aa)j)aa!O)aa!T)aa(v)aa)W)aa~O&r#WO&s$wO~P#.qOp&fOl(}X~P#+RO&r)aa~P#.qO]ZXlgXpZXpiX!TiX!VZX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX(uZX(wZX(xZX)SZX)TZX)UZX)VZX)WZX)XZX)jZX!OZX~O!WZX(vZX!UZXQZX!dZX~P#1jO]#}O!V#lO!X#{O(w#kO(x#kO~O!Y&xa![&xa!^&xa!_&xa!a&xa!b&xa!c&xa!e&xa!f&xa!g&xa!h&xa(u&xa)S&xa)T&xa)U&xa)V&xa)W&xa)X&xa)j&xa!O&xa!W&xa(v&xa!U&xaQ&xa!d&xa~P#3zOl;hO!T$WO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~PKkOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!|%RO~PKkO]&cO!V&bO!O#Qa!T#Qa!h#Qa#v#Qa)W#Qa)j#QaQ#Qa!d#Qa(v#Qa~Op&fO!T$WO~O!O*cO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O*cO~O]&cO!O*eO!V&bO~O]&YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V&WO&r#WO&s$wO)S&VO)U&ZO)V&ZO~O!OqXQqX!dqX!hqX)XqX)WqX~P#9{O!O*hO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h*iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!W)kX~P#3zO!W*kO!h*lO~O!W*kO!h*lO~P!(zO!W*kO~Op&fO!g$YO!h*mO)j$YO](tX!V(tX!W(tX!W*OX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)X(tX~O!h(tX~P#=ZO!W*oO~Od$RO%Y*TO(y:rO~Ol;kO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!|%RO~PBUO]*vO!T*qO!V&bO!h*tO#v!eO)j*rO)W)qX~O!h*tO)W)qX~O)W*wO~Op&fO])eX!T)eX!V)eX!h)eX#v)eX)W)eX)j)eX!O)eXQ)eX!d)eX(v)eX~Op&fO~OP%oO(oQO]%ha!V%ha!X%ha!Y%ha![%ha!^%ha!_%ha!a%ha!b%ha!c%ha!e%ha!f%ha!h%ha(r%ha(u%ha(w%ha(x%ha)S%ha)T%ha)U%ha)V%ha)W%ha)X%ha!g%ha)j%ha!O%ha!W%ha(v%ha!U%haQ%ha!d%ha~Od$RO%Y$SO(y:oO~Ol:wO~O!TxO#v!eO)j%|O~Ol<[O&r#WO(r;gO~O$Z+TO%`+UO~O!TxO#v!eO)W+VO)j+WO~OPmO]$eOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO$Z+TO%_#ZO%`+YO%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O!U+ZO~P!QOa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#a+aO#b+bO#i+cO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO)PYO~OQ)lP!d)lP~P#GgO]&YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V&WO)S&VO)U&ZO)V&ZO~O!O#kX!T#kX#v#kX)W#kX)j#kXQ#kX!d#kX!h#kX)X#kX!x#kX(v#kX~P#IkOPmO]$eOa%QOl:zOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V$fO!W+iO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S+jO)V$kO)X!ZO)YXO)hcO)idO~O]&cO!V+kO~O]&YO!V&WO)PYO)S&VO)U&ZO)V&ZO)X+nO!O)dP~P8zO]&YO!V&WO)S&VO)U&ZO)V&ZO~O!O#nX!T#nX#v#nX)W#nX)j#nXQ#nX!d#nX!h#nX)X#nX!x#nX(v#nX~P#NeO!TxO])nX!V)nX~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O#T+vO#p+wO(x+tO)U+rO)V+rO~O]#jX!T#jX!V#jX!O#jX#v#jX)W#jX)j#jXQ#jX!d#jX!h#jX)X#jX!x#jX(v#jX~P$ xO#V+yO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!l+zO#T+vO#V+yO#p+wO(x+tO)U+zO)V+zO])fP!T)fP!V)fP#v)fP(v)fP)j)fP!O)fP!h)fP)W)fP~O!x)fPQ)fP!d)fP~P$#uOPmO]$eOa%QOl:zOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)V$kO)X!ZO)YXO)hcO)idO~O!W,QO)S,RO~P$%pO)PYO)X+nO!O)dP~P8zO]&cO!V&bO!O&Za!T&Za!h&Za#v&Za)W&Za)j&ZaQ&Za!d&Za(v&Za~OPmO]$eOa!]Ol:|Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r;RO)S$kO)V$kO)X!ZO)YXO)hcO)idO~OQ(zP!d(zP~P$)YO]#}O!V#lO(w#kO(x#kO!X'Pa!Y'Pa!['Pa!^'Pa!_'Pa!a'Pa!b'Pa!c'Pa!e'Pa!f'Pa!h'Pa(u'Pa)S'Pa)T'Pa)U'Pa)V'Pa)W'Pa)X'Pa!g'Pa)j'Pa!O'Pa!W'Pa(v'Pa!U'PaQ'Pa!d'Pa~O]#}O!V#lO!X#{O(w#kO(x#kO~P!B_O!TxO#t!fO)PYO~P8zO!TxO(r%nO)j,[O~O#x,aO~OQ)aX!d)aX!h)aX)X)aX)j)aX!O)aX!T)aX(v)aX)W)aX~P:nO(v,eO(w,cO)P$UX)W$UX~O(r,fO~O)PYO)W,iO~OPmO]$eOa!]Ol:{Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~O(r;SO~P$0kOPmO]$eOa%QOl:zO!TxO!V$fO!X!XO!Y!WO!i!YO#V#QO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:mO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~O$h,sO~OPmO]$eOa!]Ol:{Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO$}!uO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O${,yO(r:}O)W,wO~P$7UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W,{O)X#|O~P#3zO)W,{O~O)W,|O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W,}O)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W-OO)X#|O~P#3zOp&fO)PYO)j-QO~O)W-RO~Ol;^O(r;PO~O]-YO!{!dO&r#WO&s$wO(r-UO)S-VO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO(v-]O)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!TxO$`!iO$e!jO$g!kO$h!lO$k-bO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO$}!uO(r:nOd$Xa!o$Xa!{$Xa#i$Xa#p$Xa#t$Xa#v$Xa$R$Xa$T$Xa$Y$Xa$Z$Xa${$Xa%U$Xa%c$Xa%g$Xa%o$Xa%|$Xa(k$Xa)U$Xa!U$Xa$c$Xa~P$0kO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W-cO)X#|O~P#3zOl-eO!TxO)j,[O~O)j-gO~O]&]a!X&]a!Y&]a![&]a!^&]a!_&]a!a&]a!b&]a!c&]a!e&]a!f&]a!h&]a(u&]a(w&]a(x&]a)T&]a)U&]a)V&]a)W&]a)X&]a!g&]a)j&]a!O&]a!W&]a!T&]a#v&]a(v&]a!U&]aQ&]a!d&]a~O)S-kO!V&]a~P$DbO!O-kO~O!W-kO~O!V-lO)S&]a~P$DbO](}Xd(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X~Ol;mO~P$GQO]&cO!V&bO)W-mO~Ol;cO!o-pO#V+yO#i-uO#t!fO${,yO%c!zO%k-tO%o!|O%v!}O(r;TO)PYO~P!8jO!n-yO(r,fO~O)PYO)W-{O~OPmO]$eOa%QOl:zO!T.QO!V$fO!X!XO!Y!WO!i!YO#V.XO#a.WO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO(x.PO)S$kO)V$kO)W-}O)X!ZO)YXO)hcO)idO~O!U.VO~P$JbO])^Xd)^Xr)^Xs)^Xt)^Xu)^Xv)^Xw)^Xx)^Xy)^X})^X!T)^X!V)^X!l)^X!r)^X!s)^X!t)^X!u)^X!v)^X!x)^X!{)^X%v)^X&r)^X&s)^X(r)^X(v)^X)S)^X)U)^X)V)^X)W)^X!O)^X!h)^X)X)^X!X)^X!Y)^X![)^X!^)^X!_)^X!a)^X!b)^X!c)^X!e)^X!f)^X(u)^X(w)^X(x)^X)T)^X!g)^X)j)^X!W)^XQ)^X!d)^X#T)^X#V)^X#p)^X#v)^Xa)^X{)^X!o)^X#a)^X#b)^X#i)^X#t)^X${)^X%c)^X%e)^X%k)^X%l)^X%o)^X&m)^X)P)^X!U)^X~Ol*[O~P$LlOl$oO!T(QO!l.^O(r$nO(v(PO)PYO~Op&fOl)^X~P$LlOl$oO!n.cO!o.cO(r$nO)PYO~Ol;dO!U.nO!n.pO!o.oO#i-uO${!tO$}!uO%g!{O%k-tO%o!|O%v!}O(r;VO)PYO~P!8jO!T(QO!l.^O(v(PO])OXd)OXl)OXr)OXs)OXt)OXu)OXv)OXw)OXx)OXy)OX})OX!V)OX!r)OX!s)OX!t)OX!u)OX!v)OX!x)OX!{)OX%v)OX&r)OX&s)OX(r)OX)S)OX)U)OX)V)OX~O)W)OX!O)OX!X)OX!Y)OX![)OX!^)OX!_)OX!a)OX!b)OX!c)OX!e)OX!f)OX!h)OX(u)OX(w)OX(x)OX)T)OX)X)OX!g)OX)j)OX!W)OXQ)OX!d)OX!U)OX#v)OX~P%%eO!T(QO~O!T(QO(v(PO~O(r%nO!U*QP~O!T(ZO(v.uO]&kad&kal&kar&kas&kat&kau&kav&kaw&kax&kay&ka}&ka!V&ka!r&ka!s&ka!t&ka!u&ka!v&ka!x&ka!{&ka%v&ka&r&ka&s&ka(r&ka)S&ka)U&ka)V&ka)W&ka!O&ka!X&ka!Y&ka![&ka!^&ka!_&ka!a&ka!b&ka!c&ka!e&ka!f&ka!h&ka(u&ka(w&ka(x&ka)T&ka)X&ka!g&ka)j&ka!W&kaQ&ka!d&ka!U&ka#v&ka~Ol$oO!T(ZO(r$nO~O&r#WO&s$wO]&pad&pal&par&pas&pat&pau&pav&paw&pax&pay&pa}&pa!V&pa!r&pa!s&pa!t&pa!u&pa!v&pa!x&pa!{&pa%v&pa(r&pa)S&pa)U&pa)V&pa)W&pa!O&pa!T&pa!X&pa!Y&pa![&pa!^&pa!_&pa!a&pa!b&pa!c&pa!e&pa!f&pa!h&pa(u&pa(w&pa(x&pa)T&pa)X&pa!g&pa)j&pa!W&paQ&pa!d&pa(v&pa!U&pa#v&pa~O&s.zO~P!(zO!Y#qO![#rO!f#zO)S#mO!^'Ua!_'Ua!a'Ua!b'Ua!c'Ua!e'Ua!h'Ua(u'Ua)T'Ua)U'Ua)V'Ua)W'Ua)X'Ua!g'Ua)j'Ua!O'Ua!W'Ua(v'Ua!U'UaQ'Ua!d'Ua~P#3zO!V'dX!X'dX!Y'dX!['dX!^'dX!_'dX!a'dX!b'dX!c'dX!e'dX!f'dX!h'dX(u'dX(w'dX(x'dX)S'dX)T'dX)U'dX)V'dX)X'dX!O'dX~O].|O)W'dX!g'dX)j'dX!W'dX(v'dX!U'dXQ'dX!d'dX~P%2xO!Y#qO![#rO!f#zO)S#mO!^'Wa!_'Wa!a'Wa!b'Wa!c'Wa!e'Wa!h'Wa(u'Wa)T'Wa)U'Wa)V'Wa)W'Wa)X'Wa!g'Wa)j'Wa!O'Wa!W'Wa(v'Wa!U'WaQ'Wa!d'Wa~P#3zO]#}O!T$WO!V.}O&r#WO&s$wO~O!X'Za!Y'Za!['Za!^'Za!_'Za!a'Za!b'Za!c'Za!e'Za!f'Za!h'Za(u'Za(w'Za(x'Za)S'Za)T'Za)U'Za)V'Za)W'Za)X'Za!g'Za)j'Za!O'Za!W'Za(v'Za!U'ZaQ'Za!d'Za~P%6oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^a)W'^a!g'^a)j'^a!O'^a!W'^a(v'^a!U'^aQ'^a!d'^a~P#3zOPmO]$eOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V%]O)X!ZO)YXO)hcO)idO)j%[O~O!W/QO~P%:oOS(qOT(nO]#}O*W(pO~O]/TO'f/UO*W/RO~OS/YOT(nO*W/XO~O]#}O~Q'na!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO(v/[O)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O)W#Zi!O#Zi~P#3zO]cXlgXpcXpiX!VcX!XcX!YcX![cX!^cX!_cX!acX!bcX!ccX!ecX!fcX!gcX!hcX(ucX(wcX(xcX)ScX)TcX)UcX)VcX)WcX)XcX)jcX!OcX!WcX(vcX!TcX#vcX!UcXQcX!dcX~Od/^O%Y*TO(y/]O~Ol/_O~Ol/`O~Op&fO]bi!Vbi!Xbi!Ybi![bi!^bi!_bi!abi!bbi!cbi!ebi!fbi!gbi!hbi(ubi(wbi(xbi)Sbi)Tbi)Ubi)Vbi)Wbi)Xbi)jbi!Obi!Wbi(vbi!UbiQbi!dbi~O!W/bO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO![#rO)S#mO!Y&zi!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!f&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y&zi![&zi!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!f&zi!h&zi(u&zi)S&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)V#pO!h&zi(u&zi)T&zi)U&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)U#nO)V#pO!h&zi(u&zi)T&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)V#pO!^&zi!h&zi(u&zi)T&zi)U&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)V#pO!^&zi!_&zi!h&zi(u&zi)T&zi)U&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO!^&zi!_&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!b#yO!c#yO!e#yO!f#zO)S#mO!^&zi!_&zi!a&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!f#zO)S#mO!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO)S#mO!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!f&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)T#oO)U#nO)V#pO!h&zi(u&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h/cO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!O(sX~P#3zO!h/cO!O(sX~O!O/eO~O]%Xap%Xa!X%Xa!Y%Xa![%Xa!^%Xa!_%Xa!a%Xa!b%Xa!c%Xa!e%Xa!f%Xa!h%Xa(u%Xa(w%Xa(x%Xa)T%Xa)U%Xa)V%Xa)W%Xa)X%Xa!g%Xa)j%Xa!O%Xa!W%Xa!T%Xa#v%Xa(v%Xa!U%XaQ%Xa!d%Xa~O)S/fO!V%Xa~P&,aO!O/fO~O!W/fO~O!V/gO)S%Xa~P&,aO!X'Zi!Y'Zi!['Zi!^'Zi!_'Zi!a'Zi!b'Zi!c'Zi!e'Zi!f'Zi!h'Zi(u'Zi(w'Zi(x'Zi)S'Zi)T'Zi)U'Zi)V'Zi)W'Zi)X'Zi!g'Zi)j'Zi!O'Zi!W'Zi(v'Zi!U'ZiQ'Zi!d'Zi~P%6oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^i)W'^i!g'^i)j'^i!O'^i!W'^i(v'^i!U'^iQ'^i!d'^i~P#3zO!W/lO~P%:oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h/nO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U)rX~P#3zO(r/qO~O!V/sO(w)sO)j/uO~O!h/nO!U)rX~O!U/vO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)T#oO)U#nO)V#pO)X#|O!h_i(u_i)W_i!g_i)j_i!O_i!W_i(v_i!U_iQ_i!d_i~P#3zO!R/wO~Ol){O]!Qa!h!Qa)X!Qa)]!Qa~OP0PO]0OOl0PO!R0PO!T/|O!V/}O!X0PO!Y0PO![0PO!^0PO!_0PO!a0PO!b0PO!c0PO!e0PO!f0PO!g0PO!h0PO!i0PO(oQO(v0PO(w0PO(x0PO)S/yO)T/zO)U/zO)V/{O)W0PO)X0PO)YXO~O!O0SO~P&6yO!R$[O~O!h*OO)X)Qa)])Qa~O)]0WO~O])dO!V)eO!X)bO!g)bO%Z)bO%[)bO%])bO%^)bO%_)fO%`)fO%a)bO(x)cO)j)bO)x)gO~Od)oO%Y*TO(y$OO~O)W0YO~O]nXdnXlmXpnXrnXsnXtnXunXvnXwnXxnXynX}nX!VnX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX)SnX)UnX)VnX!TnX!hnX)XnX!OnXQnX!dnX~O!lnX(vnX)WnX!XnX!YnX![nX!^nX!_nX!anX!bnX!cnX!enX!fnX(unX(wnX(xnX)TnX!gnX)jnX!WnX!UnX#vnX#TnX#VnX#pnXanX{nX!onX#anX#bnX#inX#tnX${nX%cnX%enX%knX%lnX%onX&mnX)PnX~P&:uOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO~O])aid)ail)ai!V)ai!{)ai%v)ai(r)ai)S)ai)U)ai)V)aiQ)ai!d)ai!h)ai)X)ai)j)ai!O)ai!T)ai&r)ai(v)ai)W)ai~P&?sO]&cO!V&bO!O#Qi!T#Qi!h#Qi#v#Qi)W#Qi)j#QiQ#Qi!d#Qi(v#Qi~O!OqaQqa!dqa!hqa)Xqa)Wqa~P#9{O!OqaQqa!dqa!hqa)Xqa)Wqa~P#IkO]&cO!V+kO!OqaQqa!dqa!hqa)Xqa)Wqa~O!h*iO!W)ka~O!h*mO!W*Oa~OPmOa!]Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!X!XO!Y!WO!i!YO!s!aO!t!aO!v!aO!x!cO#V#QO#a#VO#b#TO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%e#UO%l#SO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)WiO)X!ZO)YXO)hcO)idO~O]eOd!POlTO!T*qO!U&TO!V0hO!opO!r!`O!u!bO!{!dO#i#OO#p!xO#t!fO$R!gO$T!hO${!tO$}!uO%U!yO%c!zO%g!{O%o!|O%v!}O%|#PO(rRO(w)sO)SaO)U|O)V{O~P&DuO!h*tO)W)qa~OPmO]$eOa!]Ol:|O{#RO!T$WO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r;UO)PYO)S$kO)V$kO)X0nO)YXO)hcO)idO!O(sP!O)dP~P&?sO!h*mO!W*OX~O]#}O!T$WO~O!h0sO!T)zX#v)zX)j)zX~O)W0uO~O)W0vO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W0xO)X#|O~P#3zO)W0vO~P!?WO]1SOd!POl%bO!V1QO!{!dO%v$mO(r$xO)S0zO)X0}O~O)U1OO)V1OO)j0{OQ#PX!d#PX!h#PX!O#PX~P' dO!h1TOQ)lX!d)lX~OQ1VO!d1VO~O)X1YO)j1XOQ#`X!d#`X!h#`X~P!<[O)X1YO)j1XOQ#`X!d#`X!h#`X~P!;bOp&UO~O!O#ka!T#ka#v#ka)W#ka)j#kaQ#ka!d#ka!h#ka)X#ka!x#ka(v#ka~P#IkO]&cO!V+kO!O#ka!T#ka#v#ka)W#ka)j#kaQ#ka!d#ka!h#ka)X#ka!x#ka(v#ka~O!W1_O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W1_O)S1aO~P$%pO!W1_O~P!(zO]#ja!T#ja!V#ja!O#ja#v#ja)W#ja)j#jaQ#ja!d#ja!h#ja)X#ja!x#ja(v#ja~P$ xO]&cO!O1eO!V+kO~O!h1fO!O)dX~O!O1hO~O]&cO!V+kO!O#na!T#na#v#na)W#na)j#naQ#na!d#na!h#na)X#na!x#na(v#na~O]1lOr#SXs#SXt#SXu#SXv#SXw#SXx#SXy#SX!T#SX!V#SX#T#SX#p#SX(x#SX)U#SX)V#SX!l#SX!x#SX#V#SX#v#SX(v#SX)j#SX!O#SX!h#SX)W#SXQ#SX!d#SX)X#SX~O]1mO~O]1pOl$oO!V$fO#V#QO(r$nO)hcO)idO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!l+zO#T+vO#V+yO#p+wO(x+tO)U+zO)V+zO~O])fX!T)fX!V)fX!x)fX#v)fX(v)fX)j)fX!O)fX!h)fX)W)fXQ)fX!d)fX~P'+}O!x!cO]#Ri!T#Ri!V#Ri#v#Ri(v#Ri)j#Ri!O#Ri!h#Ri)W#RiQ#Ri!d#Ri~O!W1xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W1xO)S1zO~P$%pO!W1xO~P!(zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ*RX!d*RX!h*RX~P#3zO)X1{OQ({X!d({X!h({X~O!h1|OQ(zX!d(zX~OQ2OO!d2OO~O!O2PO~O#t$lO)PYO~P8zOl-eO!TxO)j2TO~O!O2UO~O#x,aOP#ui]#uia#uid#uil#uir#uis#uit#uiu#uiv#uiw#uix#uiy#ui{#ui}#ui!T#ui!V#ui!X#ui!Y#ui!i#ui!o#ui!r#ui!s#ui!t#ui!u#ui!v#ui!x#ui!{#ui#V#ui#a#ui#b#ui#i#ui#p#ui#t#ui#v#ui$R#ui$T#ui$Y#ui$Z#ui$`#ui$e#ui$g#ui$h#ui$k#ui$m#ui$o#ui$q#ui$s#ui$u#ui$w#ui${#ui$}#ui%U#ui%_#ui%`#ui%a#ui%c#ui%e#ui%g#ui%l#ui%o#ui%v#ui%|#ui&m#ui&r#ui&s#ui'Q#ui'R#ui'V#ui'Y#ui'a#ui'b#ui(k#ui(o#ui(r#ui)P#ui)S#ui)U#ui)V#ui)W#ui)X#ui)Y#ui)h#ui)i#ui!U#ui$c#ui!n#ui%k#ui~O]&cO~O]&cO!TxO!V&bO#v!eO~O(v2ZO(w,cO)P$Ua)W$Ua~O)PYO)W2]O~O!O2^O~P,]O!O2^O)W#jO~O!O2^O~O$c2cOP$_i]$_ia$_id$_il$_ir$_is$_it$_iu$_iv$_iw$_ix$_iy$_i{$_i}$_i!T$_i!V$_i!X$_i!Y$_i!i$_i!o$_i!r$_i!s$_i!t$_i!u$_i!v$_i!x$_i!{$_i#V$_i#a$_i#b$_i#i$_i#p$_i#t$_i#v$_i$R$_i$T$_i$Y$_i$Z$_i$`$_i$e$_i$g$_i$h$_i$k$_i$m$_i$o$_i$q$_i$s$_i$u$_i$w$_i${$_i$}$_i%U$_i%_$_i%`$_i%a$_i%c$_i%e$_i%g$_i%l$_i%o$_i%v$_i%|$_i&m$_i&r$_i&s$_i'Q$_i'R$_i'V$_i'Y$_i'a$_i'b$_i(k$_i(o$_i(r$_i)P$_i)S$_i)U$_i)V$_i)W$_i)X$_i)Y$_i)h$_i)i$_i!U$_i~O]1pO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W2fO)X#|O~P#3zOPmO]$eOa!]Ol:{O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)S$kO)V$kO)W2iO)X!ZO)YXO)hcO)idO~P&?sO)W2fO~O(r-UO~O)PYO)j2lO~O)W2nO~O]-YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO!|%RO(r-UO)S-VO~O)S2sO~O]&cO!V2uO!h2vO)W)uX~O]-YO!{!dO(r-UO)S-VO~O)W2yO~O!TxO$`!iO$e!jO$g!kO$h!lO$k-bO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO$}!uO(r:nOd$Xi!o$Xi!{$Xi#i$Xi#p$Xi#t$Xi#v$Xi$R$Xi$T$Xi$Y$Xi$Z$Xi${$Xi%U$Xi%c$Xi%g$Xi%o$Xi%|$Xi(k$Xi)U$Xi!U$Xi$c$Xi~P$0kOl:{O(r:nO~P0zO]2}O~O)W2SO~O!u3PO(r%nO~O!O3SO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h3TO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O3UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO]&cO!V+kO!T%ui#v%ui)W%ui)j%ui~O!W3VO~Ol:yO)W(}X~P$GQOa!TOl$oO{3]O#a#VO#b3[O#t!fO%e#UO%l3^O&m!RO&r#WO&s!TO(r$nO)PYO~P&?sOl;cO!o-pO#i-uO#t!fO${,yO%c!zO%k-tO%o!|O%v!}O(r;TO)PYO~P!8jO]&cO!V&bO)W3`O~O)W3aO~O)PYO)W3aO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W3bO)X#|O~P#3zO)W3bO~O)W3eO~O!U3gO~P$JbOl$oO(r$nO~O]3iO!T'yO~P'+iO!T(QO!l3lO(v(PO])Oad)Oal)Oar)Oas)Oat)Oau)Oav)Oaw)Oax)Oay)Oa})Oa!V)Oa!r)Oa!s)Oa!t)Oa!u)Oa!v)Oa!x)Oa!{)Oa%v)Oa&r)Oa&s)Oa(r)Oa)S)Oa)U)Oa)V)Oa)W)Oa!O)Oa!X)Oa!Y)Oa![)Oa!^)Oa!_)Oa!a)Oa!b)Oa!c)Oa!e)Oa!f)Oa!h)Oa(u)Oa(w)Oa(x)Oa)T)Oa)X)Oa!g)Oa)j)Oa!W)OaQ)Oa!d)Oa!U)Oa#v)Oa~Ol$oO!n.cO!o.cO(r$nO~O!h3pO)X3rO!T)_X~O!o3tO)PYO~P8zO)W3uO~PGVO]3zOl({O!T$WO!{!dO%v$mO&r#WO(r(zO(v4OO)S3wO)U3{O)V3{O~O)W4PO)j4RO~P(&eOl;dO!U4TO!n.pO!o.oO#i-uO${!tO$}!uO%g!{O%k-tO%o!|O%v!}O(r;VO)PYO~P!8jOl;dO%v!}O(r;VO~P!8jO(v4UO~Ol$oO!T(QO(r$nO(v(PO)PYO~O!l3lO~P((sO)j4WO!U&oX!h&oX~O!h4XO!U*QX~O!U4ZO~Oa4]Ol$oO&m!RO(r$nO~O!T(ZO]&kid&kil&kir&kis&kit&kiu&kiv&kiw&kix&kiy&ki}&ki!V&ki!r&ki!s&ki!t&ki!u&ki!v&ki!x&ki!{&ki%v&ki&r&ki&s&ki(r&ki)S&ki)U&ki)V&ki)W&ki!O&ki!X&ki!Y&ki![&ki!^&ki!_&ki!a&ki!b&ki!c&ki!e&ki!f&ki!h&ki(u&ki(w&ki(x&ki)T&ki)X&ki!g&ki)j&ki!W&kiQ&ki!d&ki!U&ki#v&ki~O(v&ki~P(*TO(v.uO~P(*TO!O4`O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O4`O~O!O4aO~O]#}O!T$WO!V'Zi!X'Zi!Y'Zi!['Zi!^'Zi!_'Zi!a'Zi!b'Zi!c'Zi!e'Zi!f'Zi!h'Zi(u'Zi(w'Zi(x'Zi)S'Zi)T'Zi)U'Zi)V'Zi)W'Zi)X'Zi!g'Zi)j'Zi!O'Zi!W'Zi(v'Zi!U'ZiQ'Zi!d'Zi~OPmOa%QOl:zO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)X!ZO)YXO)hcO)idO]#]ap#]a!T#]a!V#]a)S#]a)U#]a)V#]a~O(r%nO)X4fO!O*YP~O*W4eO~O'f4hO*W4eO~O*W4iO~OlmXpnXp&wX~Od4kO%Y*TO(y/]O~Od4kO%Y*TO(y4lO~O!h/cO!O(sa~O!W4pO~O]&cO!V+kO!T%uq#v%uq)W%uq)j%uq~O]#}O!T$WO!X'Zq!Y'Zq!['Zq!^'Zq!_'Zq!a'Zq!b'Zq!c'Zq!e'Zq!f'Zq!h'Zq(u'Zq(w'Zq(x'Zq)S'Zq)T'Zq)U'Zq)V'Zq)W'Zq)X'Zq!g'Zq)j'Zq!O'Zq!W'Zq(v'Zq!U'ZqQ'Zq!d'Zq~O!V'Zq~P(5bO!V.}O&r#WO&s$wO~P(5bO!T$WO!V)rO(w)sO!U(UX!h(UX~P!JwO!h/nO!U)ra~O!W4xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h*iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!U4|O~P&6yO!W4|O~P&6yO!O4|O~P&6yO!O5RO~P&6yO]5SO!h'ua)X'ua)]'ua~O!h*OO)X)Qi)])Qi~O]&cO!V&bO!O#Qq!T#Qq!h#Qq#v#Qq)W#Qq)j#QqQ#Qq!d#Qq(v#Qq~O!OqiQqi!dqi!hqi)Xqi)Wqi~P#IkO]&cO!V+kO!OqiQqi!dqi!hqi)Xqi)Wqi~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'Tq)W'Tq!g'Tq)j'Tq!O'Tq!W'Tq(v'Tq!U'TqQ'Tq!d'Tq~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!W'|a!h'|a~P#3zO!W5XO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h5YO(u#gO)S#mO)T#oO)U#nO)V#pO)W#jO)X#|O!U)rX~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h#{i)W#{i~P#3zO]*vO!T$WO!V&bO)j*rO!h(Va)W(Va~O!h1fO]'dX!O)dX~P%2xO)X5[O!T%qa!h%qa#v%qa)j%qa~O!h0sO!T)za#v)za)j)za~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W5_O)X#|O~P#3zO]1SOd!POl;[O!V1QO!{!dO%v$mO(r$xO)S;xO)U5aO)V5aO~OQ#Pa!d#Pa!h#Pa!O#Pa~P(DjO]1SOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V1QO!{!dO!|%RO%v$mO(r$xOQ#kX!d#kX!h#kX!O#kX~Ol%bO)S0zO)U;yO)V;yO~P(ElO]&cOQ#Pa!d#Pa!h#Pa!O#Pa~O!V&bO)j5eO~P(GZO(r%nOQ#dX!d#dX!h#dX!O#dX~O)U;yO)V;yOQ#nX!d#nX!h#nX!O#nX~P' dO!V+kO~P(GZO]1SOa!TOd!POl;]O{#RO!V1QO!{!dO#a#VO#b#TO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO(r;QO)PYO)S;xO)U5aO)V5aO)X+nO!O)dP~P&?sO!h1TOQ)la!d)la~Op&fO)j5jOQ#`al(}X!d#`a!h#`a)X(}X~P$GQO(r-UOQ#ga!d#ga!h#ga~Op&fO)j5jOQ#`a])^Xd)^Xl)^Xr)^Xs)^Xt)^Xu)^Xv)^Xw)^Xx)^Xy)^X})^X!T)^X!V)^X!d#`a!h#`a!l)^X!r)^X!s)^X!t)^X!u)^X!v)^X!x)^X!{)^X%v)^X&r)^X&s)^X(r)^X(v)^X)S)^X)U)^X)V)^X)X)^X~O#a5mO#b5mO~O]&cO!V+kO!O#ki!T#ki#v#ki)W#ki)j#kiQ#ki!d#ki!h#ki)X#ki!x#ki(v#ki~O!W5oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W5oO~P!(zO!W5oO)S5qO~P$%pO]#ji!T#ji!V#ji!O#ji#v#ji)W#ji)j#jiQ#ji!d#ji!h#ji)X#ji!x#ji(v#ji~P$ xO)PYO)X5sO~P8zO!h1fO!O)da~O&r#WO&s$wO!T#qa!x#qa#v#qa(v#qa)j#qa!O#qa!h#qa)W#qaQ#qa!d#qa)X#qa~P#NeO!O5xO~P!(zO!O)oP~P!4xO)T6OO)U5|O]#Ua!T#Ua!V#Ua)S#Ua)V#Uar#Uas#Uat#Uau#Uav#Uaw#Uax#Uay#Ua!l#Ua!x#Ua#T#Ua#V#Ua#p#Ua#v#Ua(v#Ua(x#Ua)j#Uaa#Uad#Ual#Ua{#Ua}#Ua!o#Ua!r#Ua!s#Ua!t#Ua!u#Ua!v#Ua!{#Ua#a#Ua#b#Ua#i#Ua#t#Ua${#Ua%c#Ua%e#Ua%k#Ua%l#Ua%o#Ua%v#Ua&m#Ua&r#Ua&s#Ua(r#Ua)P#Ua)W#Ua!O#Ua!h#UaQ#Ua!d#Ua~O!x!cO]#Rq!T#Rq!V#Rq#v#Rq(v#Rq)j#Rq!O#Rq!h#Rq)W#RqQ#Rq!d#Rq~O!W6TO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W6TO~P!(zO!h1|OQ(za!d(za~O)W6YO~Ol-eO!TxO)j6ZO~O]*vO!T$WO!V&bO!h*tO)W)qX~O)j6_O~P)+cO!O6aO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O6aO~O$c6cOP$_q]$_qa$_qd$_ql$_qr$_qs$_qt$_qu$_qv$_qw$_qx$_qy$_q{$_q}$_q!T$_q!V$_q!X$_q!Y$_q!i$_q!o$_q!r$_q!s$_q!t$_q!u$_q!v$_q!x$_q!{$_q#V$_q#a$_q#b$_q#i$_q#p$_q#t$_q#v$_q$R$_q$T$_q$Y$_q$Z$_q$`$_q$e$_q$g$_q$h$_q$k$_q$m$_q$o$_q$q$_q$s$_q$u$_q$w$_q${$_q$}$_q%U$_q%_$_q%`$_q%a$_q%c$_q%e$_q%g$_q%l$_q%o$_q%v$_q%|$_q&m$_q&r$_q&s$_q'Q$_q'R$_q'V$_q'Y$_q'a$_q'b$_q(k$_q(o$_q(r$_q)P$_q)S$_q)U$_q)V$_q)W$_q)X$_q)Y$_q)h$_q)i$_q!U$_q~O)W6dO~OPmO]$eOa!]Ol:{O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)S$kO)V$kO)W6fO)X!ZO)YXO)hcO)idO~P&?sO(v6hO)j*rO~P)+cO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W6fO)X#|O~P#3zO!O6jO~P!(zO)W6nO~O)W6oO~O]-YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO(r-UO)S-VO~O]&cO!V2uO!h%Oa)W%Oa!O%Oa~O!W6uO)S6vO~P$%pO!h2vO)W)ua~O]&cO!O6yO!V2uO~O!TxO$`!iO$e!jO$g!kO$h!lO$k-bO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO$}!uO(r:nOd$Xq!o$Xq!{$Xq#i$Xq#p$Xq#t$Xq#v$Xq$R$Xq$T$Xq$Y$Xq$Z$Xq${$Xq%U$Xq%c$Xq%g$Xq%o$Xq%|$Xq(k$Xq)U$Xq!U$Xq$c$Xq~P$0kOPmO]$eOa!]Ol:{O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)PYO)S$kO)V$kO)W6{O)X!ZO)YXO)hcO)idO~P&?sO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W7OO)X#|O~P#3zO)W7PO~OP7QO(oQO~Ol*[O)W)^X~P$GQOp&fOl(}X)W)^X~P$GQO)W7SO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O)W&Sa~P#3zO!U7UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO)W7VO~OPmO]$eOa!]Ol:|O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r;UO)PYO)S$kO)V$kO)X0nO)YXO)hcO)idO!O)dP~P&?sO!h3pO)X7ZO!T)_a~O!h3pO!T)_a~O)W7`O)j7bO~P(&eO)W7dO~PGVO]3zOl({Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO!|%RO%v$mO&r#WO(r(zO)S3wO)U3{O)V3{O~O)S7hO~O]&cO!T*qO!V7jO!h7kO#v!eO(v4OO~O)W7`O)j7mO~P)FwO]3zOl({O!{!dO%v$mO&r#WO(r(zO)S3wO)U3{O)V3{O~Op&fO])cX!T)cX!V)cX!h)cX#v)cX(v)cX)W)cX)j)cX!O)cX~O)W7`O~O!T(QO!l7sO(v(PO])Oid)Oil)Oir)Ois)Oit)Oiu)Oiv)Oiw)Oix)Oiy)Oi})Oi!V)Oi!r)Oi!s)Oi!t)Oi!u)Oi!v)Oi!x)Oi!{)Oi%v)Oi&r)Oi&s)Oi(r)Oi)S)Oi)U)Oi)V)Oi)W)Oi!O)Oi!X)Oi!Y)Oi![)Oi!^)Oi!_)Oi!a)Oi!b)Oi!c)Oi!e)Oi!f)Oi!h)Oi(u)Oi(w)Oi(x)Oi)T)Oi)X)Oi!g)Oi)j)Oi!W)OiQ)Oi!d)Oi!U)Oi#v)Oi~O(r%nO!U(fX!h(fX~O!h4XO!U*Qa~Op&fO]*Pad*Pal*Par*Pas*Pat*Pau*Pav*Paw*Pax*Pay*Pa}*Pa!T*Pa!V*Pa!r*Pa!s*Pa!t*Pa!u*Pa!v*Pa!x*Pa!{*Pa%v*Pa&r*Pa&s*Pa(r*Pa)S*Pa)U*Pa)V*Pa)W*Pa!O*Pa!X*Pa!Y*Pa![*Pa!^*Pa!_*Pa!a*Pa!b*Pa!c*Pa!e*Pa!f*Pa!h*Pa(u*Pa(w*Pa(x*Pa)T*Pa)X*Pa!g*Pa)j*Pa!W*PaQ*Pa!d*Pa(v*Pa!U*Pa#v*Pa~O!T(ZO]&kqd&kql&kqr&kqs&kqt&kqu&kqv&kqw&kqx&kqy&kq}&kq!V&kq!r&kq!s&kq!t&kq!u&kq!v&kq!x&kq!{&kq%v&kq&r&kq&s&kq(r&kq)S&kq)U&kq)V&kq)W&kq!O&kq!X&kq!Y&kq![&kq!^&kq!_&kq!a&kq!b&kq!c&kq!e&kq!f&kq!h&kq(u&kq(w&kq(x&kq)T&kq)X&kq!g&kq)j&kq!W&kqQ&kq!d&kq(v&kq!U&kq#v&kq~OPmOa%QOl:zO!T$WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)YXO)hcO)idO~O]*Ui!V*Ui!X*Ui!Y*Ui![*Ui!^*Ui!_*Ui!a*Ui!b*Ui!c*Ui!e*Ui!f*Ui!h*Ui(u*Ui(w*Ui(x*Ui)S*Ui)T*Ui)U*Ui)V*Ui)W*Ui)X*Ui!g*Ui)j*Ui!O*Ui!W*Ui(v*Ui!U*UiQ*Ui!d*Ui~P*&WO!O7xO~O!W7yO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^q)W'^q!g'^q)j'^q!O'^q!W'^q(v'^q!U'^qQ'^q!d'^q~P#3zO!h7zO!O*YX~O!O7|O~O*W7}O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h^y)W^y!g^y)j^y!O^y!W^y(v^y!U^yQ^y!d^y~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!O(ha!h(ha~P#3zO]#}O!T$WO!V'Zy!X'Zy!Y'Zy!['Zy!^'Zy!_'Zy!a'Zy!b'Zy!c'Zy!e'Zy!f'Zy!h'Zy(u'Zy(w'Zy(x'Zy)S'Zy)T'Zy)U'Zy)V'Zy)W'Zy)X'Zy!g'Zy)j'Zy!O'Zy!W'Zy(v'Zy!U'ZyQ'Zy!d'Zy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^y)W'^y!g'^y)j'^y!O'^y!W'^y(v'^y!U'^yQ'^y!d'^y~P#3zO]&cO!V+kO!T%uy#v%uy)W%uy)j%uy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U(Ua!h(Ua~P#3zO!W4xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U#}i!h#}i~P#3zO!U8PO~P&6yO!W8PO~P&6yO!O8PO~P&6yO!O8RO~P&6yO]&cO!V&bO!O#Qy!T#Qy!h#Qy#v#Qy)W#Qy)j#QyQ#Qy!d#Qy(v#Qy~O]&cO!V+kO!OqqQqq!dqq!hqq)Xqq)Wqq~O]&cOQ#Pi!d#Pi!h#Pi!O#Pi~O!V+kO~P*9jOQ#nX!d#nX!h#nX!O#nX~P(DjO!V&bO~P*9jOQ(OX](OXd'qXl'qXr(OXs(OXt(OXu(OXv(OXw(OXx(OXy(OX!V(OX!d(OX!h(OX!{'qX%v'qX(r'qX)S(OX)U(OX)V(OX!O(OX~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ#_i!d#_i!h#_i!O#_i~P#3zO&r#WO&s$wOQ#fi!d#fi!h#fi~O(r-UO)X1YO)j1XOQ#`X!d#`X!h#`X~O!W8WO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W8WO~P!(zO!T#qi!x#qi#v#qi(v#qi)j#qi!O#qi!h#qi)W#qiQ#qi!d#qi)X#qi~O]&cO!V+kO~P*?fO]&YO!V&WO&r#WO&s$wO)S&VO)U&ZO)V&ZO~P*?fO!O8YO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!h8ZO!O)oX~O!O8]O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ*TX!d*TX!h*TX~P#3zO)X8`OQ*SX!d*SX!h*SX~O)W8bO~O!O$bi!h#{a)W#{a~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W8eO)X#|O~P#3zO!O8gO~P!(zO!O8gO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O8gO~O]&cO!V&bO(v8mO~O)W8nO~O]&cO!V2uO!h%Oi)W%Oi!O%Oi~O!W8qO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W8qO)S8sO~P$%pO!W8qO~P!(zO]&cO!V2uO!h(Ya)W(Ya~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W8tO)X#|O~P#3zO)W2iO~P!(zO)W8tO~OP%oO!O8uO(oQO~O!O8uO~O)W8vO~P%%eO#T8yO(x.PO)W8wO~O!h3pO!T)_i~O)X8}O!T'wa!h'wa~O)W9PO)j9RO~P)FwO)W9PO~O)W9PO)j9VO~P(&eOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~P)GgO]&cO!V7jO!T!ya!h!ya#v!ya(v!ya)W!ya)j!ya!O!ya~O!W9^O)S9_O~P$%pO!T$WO!h7kO(v4OO)W9PO)j9VO~O!T$WO~P#EfO]&cO!O9bO!V7jO~O]&cO!V7jO!T&aa!h&aa#v&aa(v&aa)W&aa)j&aa!O&aa~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O)W&ba~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W9PO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U&oi!h&oi~P#3zO!V.}O]']i!T']i!X']i!Y']i![']i!^']i!_']i!a']i!b']i!c']i!e']i!f']i!h']i(u']i(w']i(x']i)S']i)T']i)U']i)V']i)W']i)X']i!g']i)j']i!O']i!W']i(v']i!U']iQ']i!d']i~O(r%nO)X9eO~O!h7zO!O*Ya~O!O9gO~P&6yO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U(Ua)W#Zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ#_q!d#_q!h#_q!O#_q~P#3zO&r#WO&s$wOQ#fq!d#fq!h#fq~O)j5jOQ#`a!d#`a!h#`a~O]&cO!V+kO!T#qq!x#qq#v#qq(v#qq)j#qq!O#qq!h#qq)W#qqQ#qq!d#qq)X#qq~O!h8ZO!O)oa~O)U5|O]&Vi!T&Vi!V&Vi)S&Vi)T&Vi)V&Vir&Vis&Vit&Viu&Viv&Viw&Vix&Viy&Vi!l&Vi!x&Vi#T&Vi#V&Vi#p&Vi#v&Vi(v&Vi(x&Vi)j&Via&Vid&Vil&Vi{&Vi}&Vi!o&Vi!r&Vi!s&Vi!t&Vi!u&Vi!v&Vi!{&Vi#a&Vi#b&Vi#i&Vi#t&Vi${&Vi%c&Vi%e&Vi%k&Vi%l&Vi%o&Vi%v&Vi&m&Vi&r&Vi&s&Vi(r&Vi)P&Vi)W&Vi!O&Vi!h&ViQ&Vi!d&Vi~O)W9jO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!O$bq!h#{i)W#{i~P#3zO!O9lO~P!(zO!O9lO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O9lO~O]&cO!V&bO(v9oO~O!O9pO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O9pO~O]&cO!V2uO!h%Oq)W%Oq!O%Oq~O!W9tO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W9tO~P!(zO)W6fO~P!(zO)W9uO~O)W9vO~O(x.PO)W9vO~O!h3pO!T)_q~O)X9xO!T'wi!h'wi~O!T$WO!h7kO(v4OO)W9yO)j9{O~O)W9yO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W9yO)X#|O~P#3zO)W9yO)j:OO~P)FwO]&cO!V7jO!T!yi!h!yi#v!yi(v!yi)W!yi)j!yi!O!yi~O!W:SO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W:SO)S:UO~P$%pO!W:SO~P!(zO]&cO!V7jO!T(da!h(da(v(da)W(da)j(da~O!O:WO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O:WO~O!O:]O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O:]O~O]&cO!V2uO!h%Oy)W%Oy!O%Oy~O)W:^O~O)W:_O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W:_O)X#|O~P#3zO!T$WO!h7kO(v4OO)W:_O)j:bO~O]&cO!V7jO!T!yq!h!yq#v!yq(v!yq)W!yq)j!yq!O!yq~O!W:dO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W:dO~P!(zO!O:fO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O:fO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W:hO)X#|O~P#3zO)W:hO~O]&cO!V7jO!T!yy!h!yy#v!yy(v!yy)W!yy)j!yy!O!yy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W:lO)X#|O~P#3zO)W:lO~O]ZXlgXpZXpiX!TiX!VZX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX(uZX(v$]X(wZX(xZX)SZX)TZX)UZX)VZX)WZX)XZX)jZX~O]%WXlmXpnXp%WX!TnX!V%WX!X%WX!Y%WX![%WX!^%WX!_%WX!a%WX!b%WX!c%WX!e%WX!f%WX!gmX!h%WX(u%WX(w%WX(x%WX)S%WX)T%WX)U%WX)V%WX)X%WX)jmX!O%WXQ%WX!d%WX~O)W%WX!W%WX(v%WX!U%WX~P+GrO]nX]%WXdnXlmXpnXp%WXrnXsnXtnXunXvnXwnXxnXynX}nX!VnX!V%WX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX)SnX)UnX)VnX!OnX!O%WX!hnX)XnX~O)WnX)jnX~P+JSO]%WXlmXpnXp%WX!V%WX!h%WXQ%WX!d%WX!O%WX~O!T%WX#v%WX)W%WX)j%WX(v%WX~P+LmOQnXQ%WX!TnX!X%WX!Y%WX![%WX!^%WX!_%WX!a%WX!b%WX!c%WX!dnX!d%WX!e%WX!f%WX!gmX!h%WX(u%WX(w%WX(x%WX)S%WX)T%WX)U%WX)V%WX)X%WX)jmX~P+JSO]nX]%WXlmXpnXp%WXrnXsnXtnXunXvnXwnXxnXynX}nX!V%WX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX)SnX)UnX)VnX~O!TnX(vnX)WnX)jnX~P, eOdnX!VnX)W%WX~P, eOlmXpnX)W%WX~Od)oO%Y)pO(y:oO~Od)oO%Y)pO(y:tO~Od)oO%Y)pO(y:pO~Od$RO%Y*TO'[$TO'_$UO(y:oO~Od$RO%Y*TO'[$TO'_$UO(y:qO~Od$RO%Y*TO'[$TO'_$UO(y:sO~O]iXriXsiXtiXuiXviXwiXxiXyiX!OiX!ViX&riX&siX)SiX)UiX)ViXdiX}iX!riX!siX!tiX!uiX!viX!xiX!{iX%viX(riX~P#1jO]ZXlgXpZXpiX!VZX!hZX)WZX)jZX~O!TZX#vZX(vZX~P,'{OlgXpiX)PiX)WZX)jiX~O]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!VZX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX!OZX!OiX!hiX)XiX)jiX~O)WZX~P,)VO]ZX]iXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX!TiX!VZX!ViX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX!hiX&riX&siX(uZX(wZX(xZX)SZX)SiX)TZX)UZX)UiX)VZX)ViX)XZX)XiX)jZX~OQZXQiX!dZX!diX~P,+pO]iXdiXriXsiXtiXuiXviXwiXxiXyiX}iX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX~P#1jO]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!VZX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX~O)WiX~P,0rOdiX}iX!OZX!OiX!riX!siX!tiX!uiX!viX!xiX!{iX%viX(riX)jiX~P,+pO]ZX]iXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!TiX!VZX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX(viX)SiX)UiX)ViX)WiX)jiX~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~PBUOd$RO%Y*TO(y:oO~Od$RO%Y*TO(y:pO~Od$RO%Y*TO(y:vO~Od$RO%Y*TO(y:uO~O]%hOd!POl%bOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V%kO!{!dO!|%RO%v$mO(r$xO)S;aO)U;bO)V;bO~O]%hOd!POl%bO!V%kO!{!dO%v$mO(r$xO)S;aO)U;bO)V;bO~Od$RO%Y$SO(y:pO~Od$RO%Y$SO(y:tO~Ol:yO~Ol:xO~O]cXlgXpiX!TcX~Od)oO%Y*TO(y:oO~Od)oO%Y*TO(y:pO~Od)oO%Y*TO(y:qO~Od)oO%Y*TO(y:rO~Od)oO%Y*TO(y:sO~Od)oO%Y*TO(y:uO~Od)oO%Y*TO(y:vO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~P,9OO](}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)j(}X~Ol:xO!T(}X(v(}X)W(}X~P,<}O]&wXlmXpnX!T&wX~Od4kO%Y*TO(y;tO~Ol;[O)S;xO)U5aO)V5aO~P(ElOd!POl%bO!{!dO%v$mO(r$xO~O]1SO!V1QO)S0zO)U;yO)V;yOQ#nX!d#nX!h#nX!O#nX~P,?yO)S;YO~Ol;hO~Ol;iO~Ol;jO~Ol;lO~Ol;mO~Ol;nO~Ol;lO!T$WOQ(}X!d(}X!h(}X)X(}X!O(}X)j(}X~P$GQOl;jO!T$WO~P$GQOl;hO!g$YO)j$YO~Ol;jO!g$YO)j$YO~Ol;lO!g$YO)j$YO~Ol;iO!O(}X!h(}X)X(}X)j(}X~P$GQOd/^O%Y*TO(y;tO~Ol;uO~O)S<YO~OV'e'h'i'g(o)Y!R(rST%Z!Y!['jd%[!i'R!f]'f*Z'k(w!^!_'l'm'l~",goto:"%5]*ZPPPPPP*[P*_PP.T4iP7j7j:tP:t>OP>i>{?aFXMX!&]!,sP!3m!4b!5VP!5qPPPPPPPP!6[P!7tPP!9V!:oP!:uPPPPPP!:xP!:xPP!:xPPPPPPPPP!;U!>lP!>oPP!?]!@QPPPPP!@UP>l!AgPP>l!Cn!Eo!E}!Gd!ITP!I`P!Io!Io!MP#!`##v#'S#*^!Eo#*hPP!Eo#*o#*u#*h#*h#*xP#*|#+k#+k#+k#+k!ITP#,U#,g#.|P#/bP#0}P#1R#1Z#2O#2Z#4i#4q#4q#1RP#1RP#4x#5OP#5YPP#5u#6d#7U#5uP#7v#8SP#5uP#5uPP#5u#5uP#5uP#5uP#5uP#5uP#5uP#5uP#8V#5Y#8sP#9YP#9o#9o#9o#9o#9|#1RP#:d#?`#?}PPPPPPPP#@uP#ATP#ATP#Aa#Dn#9OPP#@}#EQP#Ee#Ep#Ev#Ev#@}#FlP#1R#1R#1R#1R#1RP!Io#GW#G_#G_#G_#Gc!Ly#Gm!Ly#Gq!E}!E}!E}#Gt#L^!E}>l>l>l$#V!@Q!@Q!@Q!@Q!@Q!@Q!6[!6[!6[$#jP$%V$%e!6[$%kPP!6[$'y$'|#@l$(P:t7j$+V$-Q$.q$0a7jPP7j$2T7jP7j7jP7jP$5Z7jP7jPP7j$5gPPPPPPPPP*[P$8o$8u$;^$=d$=j$>Q$>[$>g$>v$>|$@[$AZ$Ab$Ai$Ao$Aw$BR$BX$Bd$Bj$Bs$B{$CW$C^$Ch$Cn$Cx$DP$D`$Df$DlP$Dr$Dz$ER$Ea$F}$GT$GZ$Gb$GkPPPPPPPP$Gq$GuPPPPP$Nw$'y$Nz%$S%&[P%&i%&lPPPPPPPPPP%&x%'{%(R%(V%)|%+Z%+|%,T%.d%.jPPP%.t%/P%/S%/Y%0a%0d%0n%0x%0|%2Q%2s%2y#@uP%3d%3t%3w%4X%4e%4i%4o%4u$'y$'|$'|%4x%4{P%5V%5YR#cP'`mO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fU%om%p7QQ&m!`Q(j#]d0P)}/|/}0O0R4}5O5P5S8QR7Q3Tb}Oaewx{!g&S*q&v$i[!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0{1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fS%`f0h#d%jgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YS%qm!YS&u!h#PQ']!tQ'g!yQ'h!zQ(j#`Q(k#]Q(l#^Q*x%kQ,W&lQ,]&nQ-S'^Q-d'fQ-k'qS.r(Z4XQ/f)gQ0e*mQ2Q,[Q2X,cQ3O-eQ4b.|Q4f/TQ5f0}Q6[2TQ6}3PQ8a6ZQ9e7zR;Z1Q$|#hS!]$y%Q%T%Z&j&k'Q'X'Z'a'c(a(e(h(w(x)R)S)T)U)V)W)X)Y)Z)[)])^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:iQ&p!dQ(g#ZQ(s#bQ)j$T[*s%e*W0k2`2g2{Q,^&oQ/O(fQ/S(kQ/Z(tS/i)i/PQ0r+QS4q/j/kR8O4r'a![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f'a!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ)O#kS+Q%y0sQ/r)sk3}.g3s3w3z3{7c7e7f7h7k9X9Y:RQ)Q#kk3|.g3s3w3z3{7c7e7f7h7k9X9Y:Rl)P#k.g3s3w3z3{7c7e7f7h7k9X9Y:RT+Q%y0s[UOwx!g&S*qW$`[e$e(b#l$p_!f!u!}#R#S#T#U#V#Z$S$T$l%U&U&Y&c&m'_'}(P(U(^(g)j)p+[+a+b+t+y,X,k,z-Q-o-t.W.X._.`.d.q.u1T1X1f1k1m2l3[3]3^3p3t5j5}6P7[8Z![%cg$g%d%i&s*Y*t+],l,v-_0z1O2_;W;X;Y;a;b;o;p;q;r;v;w;y<W<X<YY%snp%w-p.fl(|#k.g3s3w3z3{7c7e7f7h7k9X9Y:RS;e't-wU;f(Q.m.o&|;{af{|!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k$|$}%S%]%h%m&Q&W&b&y&|'O'i'j'u'y(`(i)l)r*`*b*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0]0h0y0{1Q1a1b1l1p1z2c2i2j2u4O4R4W4a5Y5a5e5q6_6c6f6g6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f;`;xQ;|1Sd;}&x'P'b,w-]-^-a2f2z2}W<O&f*v1|3iQ<P#O[<Q!t'^'f,[2T6ZT<]%y0s[VOwx!g&S*qW$a[e$e(bQ$p.u!j$q_!f!u!}#V#Z$S$T$l%U&U&Y&c&m'_(g)j)p+[+a+t,X,k,z-Q-o.d1T1X1f1k1m2l3t5j8Z&^$zaf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f![%cg$g%d%i&s*Y*t+],l,v-_0z1O2_;W;X;Y;a;b;o;p;q;r;v;w;y<W<X<YY%snp%w-p.fQ'r#O|'|#R#S#T#U'}(P(U(^+b+y.W.X._.`.q3[3]3^3p5}6P7[l(|#k.g3s3w3z3{7c7e7f7h7k9X9Y:RS-n't-wQ3W-tU;s(Q.m.on;{|$|$}%S%h'u*`*b0]0y2j5a6g;`;x[<Q!t'^'f,[2T6ZW<R&f*v1|3id<S&x'P'b,w-]-^-a2f2z2}Q<Z1ST<]%y0s!Q!UO[ewx!g$e&S&f&x'P'b(b*q*v,w-]-^-a1|2f2z2}3i!v$t_!f!u!}#O#V#Z$S$T$l%U&U&Y&c&m'_'t(Q(g)j)p+[+t,X,k,z-Q-o-w.d.m.o1S1T1X1f1k1m2l3t5j8Z&^%Paf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f$Q%lgnp|#k$g$|$}%S%d%h%i%w%y&s'^'f'u*Y*`*b*t+],[,l,v-_-p.f.g0]0s0y0z1O2T2_2j3s3w3z3{5a6Z6g7c7e7f7h7k9X9Y:R;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YQ'[!tz(O#R#S#T#U'}(P(U(^+y.W.X._.`.q3[3]3^3p5}6P7[f-Z'`-T-V-Y2p2q2s2v6q6r8pQ1W+aQ1Z+bQ2k,yQ3X-tQ4[.uQ5l1YR8V5m!Q!UO[ewx!g$e&S&f&x'P'b(b*q*v,w-]-^-a1|2f2z2}3i!x$t_!f!u!}#O#V#Z$S$T$l%U&U&Y&c&m'_'t(Q(g)j)p+[+a+t,X,k,z-Q-o-w.d.m.o1S1T1X1f1k1m2l3t5j8Z&^%Paf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f$S%lgnp|!t#k$g$|$}%S%d%h%i%w%y&s'^'f'u*Y*`*b*t+],[,l,v-_-p.f.g0]0s0y0z1O2T2_2j3s3w3z3{5a6Z6g7c7e7f7h7k9X9Y:R;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Y|(O#R#S#T#U'}(P(U(^+b+y.W.X._.`.q3[3]3^3p5}6P7[Q3X-tR4[.u[WOwx!g&S*qW$b[e$e(b#l$p_!f!u!}#R#S#T#U#V#Z$S$T$l%U&U&Y&c&m'_'}(P(U(^(g)j)p+[+a+b+t+y,X,k,z-Q-o-t.W.X._.`.d.q.u1T1X1f1k1m2l3[3]3^3p3t5j5}6P7[8Z![%cg$g%d%i&s*Y*t+],l,v-_0z1O2_;W;X;Y;a;b;o;p;q;r;v;w;y<W<X<YY%snp%w-p.fl(|#k.g3s3w3z3{7c7e7f7h7k9X9Y:RS;e't-wU;f(Q.m.on;{|$|$}%S%h'u*`*b0]0y2j5a6g;`;xQ;|1SQ<P#O[<Q!t'^'f,[2T6Z&^<Taf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fd<U&x'P'b,w-]-^-a2f2z2}W<V&f*v1|3iT<]%y0sp$PT$_$o%b%r({:z:{:|;[;];^;_;c;d<[o)m$V*U*[/_:w:x:y;h;i;j;k;l;m;n;up$QT$_$o%b%r({:z:{:|;[;];^;_;c;d<[o)n$V*U*[/_:w:x:y;h;i;j;k;l;m;n;u^&e}!O$i$j%`%j;Zd&i!U$t%P%l'[(O1W1Z3X4[V/a)O)P3}S%Ye$eQ,T&fQ.{(bQ2m-QQ5y1mQ6V1|Q6m2lR9h8Z#}!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o1S1T1X1f1k1m1|2f2l2z2}3i3t5j8Z#[^O[_`wx!f!g!}#O$S$d$l$s$u&S&U&Y&c&m&r&x'P'b't(Q)p*]*q*v+[,X,k,w,z-]-^-a-o-t-w.d.m.o1S1T1f2f2z2}3i3t_(U#R#S#T+b3[3]3^#}ZO[wx!g!k#R#S#T%m&S&U&Y&c&m&w&x&y&|'O'P'['b't'x'}(P(Q(U*q*v+[+b,X,h,k,q-P-]-^-a-o-t-w-z._.d.m.q1S1T1f2c2k2z2}3[3]3^3i6c6j8g9l9p:W:]:fQ$]YR0T*OR*Q$]e0P)}/|/}0O0R4}5O5P5S8Q'`!YO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fe0P)}/|/}0O0R4}5O5P5S8QR5T0T^(T#R#S#T+b3[3]3^Y.]'}(R(U(V7TU3k.Z.^.qS7X3l4VR9c7s^(S#R#S#T+b3[3]3^[.['}(R(T(U(V7TW3j.Z.].^.qU7W3k3l4VS8z7X7sR:V9cT.k(Q.md]Owx!g&S't(Q*q-w.m!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)p*]*v+[,X,k,w,z-]-^-a-o-t.d.o1S1T1f2f2z2}3i3tQ%tnT1u+}1v!jbOaenpwx{|!g#O$|$}%S%h%w&S't'u(Q*`*b*q-p-w.f.m.o0]0y1S2j5a6g;`;xf-W'`-T-V-Y2p2q2s2v6q6r8pj3x.g3s3w3z3{7c7e7f7h7k9X9Y:Rr;zg$g%d%i&s*Y*t,l,v-_2_;W;X;Y;o;q;vi<^+]0z1O;a;b;p;r;w;y<W<X<Y!O&^y%X&V&Y&Z'k)h*d*f+]+e+x/m0^0y0z1O1S1j5a5v;x;yz&az%O%W%e&d's*W*_,b-x0Z0[0k0|2`2g2{5V5b6l8iS'{#Q.Xn+l&X*g+f+m+p-j/h0_1R1^4t5W5`5u8XQ2W,a^2t-X2r2x6p6w8o9se7i3y7_7g7o7p9U9W9`:Q:cS+^&U1TY+n&Y&c*v1S3iR5s1f#w!POaegnpwx{|!g#O$g$|$}%S%d%h%i%w&S&s't'u(Q*Y*`*b*q*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Y`oOwx!g&S't*q-w#U!Paeg{|#O$g$|$}%S%d%h%i&s'u*Y*`*b*t+],l,v-_0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YU%vnp-pQ*}%wS.e(Q.mT3v.f.oW+r&^+l+s1cV+z&a+{7iQ+x&`U+z&a+{7iQ-w'tT.S'y.U'`![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fX1r+y.X5}6P'W!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fW1r+y.X5}6PR2e,s!WjO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fY%Ve$e(b1p3iQ'S!nS(y#i5YQ,m&xQ,x'PS.O'y.UQ2b,nQ6k2iQ6|2}Q8h6fR9m8e'W![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fX1r+y.X5}6P'ayO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k+y,P,R,n,q,w-]-^-a-g.P.Q.U.X.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q5}6P6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ&`yS't#O-uR1[+cS+^&U1TR5n1[Q1P+]R5g1OR1P+]T+^&U1Tz&[%X&V&Y&Z'k)h*d*f+]+e/m0^0y0z1O1S1j5a5v;x;yQ&]yR1n+x!P&[y%X&V&Y&Z'k)h*d*f+]+e+x/m0^0y0z1O1S1j5a5v;x;yQ+u&^S+|&a7iS1d+l+sQ1t+{R5r1c!WkO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fS%zo.eS&Oq-rQ&_yQ&q!eQ'e!yQ*p%eU*{%v%{3vS+P%x%}Q+q&]Q,Y&mS,Z&n'gQ,r&{S0X*W,bS0o*|*}Q0q+OQ1o+xS2S,]-fQ5U0ZQ5Z0pQ5{1nQ6Y2RQ6]2WQ7n3yQ9S7_R:P9U[uOwx!g&S*qQ,Y&mQ-v'tQ3Y-tR3_-wxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fU$h[&|-^S%zo.eS&Oq-rQ*p%eU*{%v%{3vS+P%x%}S0X*W,bS0o*|*}Q0q+OQ5U0ZQ5Z0pQ7n3yQ9S7_R:P9UT,_&q,`]uOwx!g&S*q[uOwx!g&S*qQ,Y&mQ,n&xQ,w'PW-`'b-]-a2zQ-v'tQ3Y-tQ3_-wR6{2}[%fg$g,l,v-_2_R0l*t^$XV!U$a$z%P<R<SQ'S!nS)`#}*vS)v$W*qQ)y$YY*s%e*W0k2g2{Q/O(fS/i)i/PS0a*h4aS0j*r6_Q0r+QQ4Q.gQ4n/cS4q/j/kS4v/n5YQ4{/uQ6`2`U7a3s3y4RQ8O4rQ8k6hY9Q7_7b7c7l7mQ9r8mW9z9O9R9U9VQ:Z9oU:a9{9}:OR:j:bS)v$W*qT4v/n5YZ)t$W)u*q/n5YQ&w!hR'x#PS,g&v'vQ2[,eR6^2ZxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fV$h[&|-^!XkO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:f!WhO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fR'W!q!WkO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fR,n&xQ&y!iQ&{!jQ'O!lR,q&zR,o&xxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fX-`'b-]-a2z[uOwx!g&S*qQ,z'PQ-v'tS.k(Q.mR3_-w[uOwx!g&S*qQ,z'PW-`'b-]-a2zT.k(Q.mg-Z'`-T-V-Y2p2q2s2v6q6r8pylOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fb!OOaewx{!g&S*q&|$j[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f#d%jgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YQ']!tQ-S'^Q-d'fQ2Q,[Q6[2TR8a6Zj$RT$_%b%r:z:{:|;[;];^;_;c;di)o$V*U:w:x:y;h;i;j;k;l;m;nj$RT$_%b%r:z:{:|;[;];^;_;c;dh)o$V*U:w:x:y;h;i;j;k;l;m;nS/^({<[V4k/_/`;u[uOwx!g&S*qQ-v'tR3_-w[uOwx!g&S*qT.k(Q.m'`!YO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fR7R3T[uOwx!g&S*qQ-v'tS.k(Q.mR3_-w[pOwx!g&S*qQ%wnS-p't-wT.f(Q.mS%{o.eS*|%v3vR0p*}Q+R%yR5]0sS%zo.eS&Oq-rU*{%v%{3vS+P%x%}S0o*|*}Q0q+OQ5Z0pQ7n3yQ9S7_R:P9U`qOwx!g&S(Q*q.mS%xn-pU%}p.f.oQ+O%wT-r't-wS'z#Q.XR.Y'{T.R'y.US.S'y.UQ8x7UR9w8yT5}1q8_R6P1q#d!Pgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Yb!QOaewx{!g&S*q&}![[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f#d!Pgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Yb!QOaewx{!g&S*q&|![[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fk3|.g3s3w3z3{7c7e7f7h7k9X9Y:RQ4Q.gS7a3s3yU9Q7_7c7lS9z9O9UR:a9}#|!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o1S1T1X1f1k1m1|2f2l2z2}3i3t5j8ZR4].uQ(]#US.v([(^S4^.w.xR7w4_Q.s(ZR7u4X#|!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o1S1T1X1f1k1m1|2f2l2z2}3i3t5j8Zp$w`$d$s%X&r'`(_(f)i*d-T/k1j5k5v8Uq(}#k%y.g0s3s3w3z3{7c7e7f7h7k9X9Y:RR,U&fR6W1|'X!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f$q#rS%T%Z'Q'X'Z'a'c(a(e(h(w(x)R)S)U)V)W)X)Y)Z)[)])^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i$]#sS%T%Z'Q'X'Z'a'c(h(w(x)R)V)^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i$Z#tS%T%Z'Q'X'Z'a'c(h(w(x)R)^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i$c#wS%T%Z'Q'X'Z'a'c(h(w(x)R)U)V)W)X)^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i'X![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ/P(fQ/j)iQ4r/kR9d7y']![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ#eQR(u#eU$|a;`;xb%Ue$e&f(b-Q1m1|2l8ZQ'_!u!Q*^$|%U'_*`*f+h,P0]0^1b2p6q6t7e8p9X9]:R;W;o;p;v;w<WS*`$}%SQ*f%XS+h&W1QQ,P&bQ0]*bQ0^*dQ1b+kQ2p-VS6q2q2sQ6t2uQ7e3wQ8p6rS9X7f7hQ9]7jQ:R9YQ;W%dS;o;X;YS;p<X<YQ;v;qQ;w;rT<W0z;a[[Owx!g&S*ql$c[&|'}+[,X,h,k-P-^-o-z._.d.ql&|!k%m&y'O,q2c6c6j8g9l9p:W:]:f^'}#R#S#T+b3[3]3^`+[&U&Y&c*v1S1T1f3iS,X&m-tQ,h&wU,k&x'P2}S-P'[2kW-^'b-]-a2zS-o't-wQ-z'xQ._(PS.d(Q.mR.q(UQ)|$[R/x)|Q0R)}Q4}/|Q5O/}Q5P0OY5Q0R4}5O5P8QR8Q5SQ*P$]S0U*P0VR0V*QS.`(P._S3n.`7[R7[3pQ3q.aS7Y3o3rU7^3q7Y8{R8{7ZQ.m(QR4S.m!|_O[wx!f!g!}#O$S$l&S&U&Y&c&m&x'P'b't(Q)p*q*v+[,X,k,w,z-]-^-a-o-t-w.d.m.o1S1T1f2f2z2}3i3tU$r_$u*]U$u`$d&rR*]$sU$}a;`;xd*a$}*b2q6r7f9Y;X;q;r<XQ*b%SQ2q-VQ6r2sQ7f3wQ9Y7hQ;X%dQ;q;YQ;r<YT<X0z;aS+{&a7iR1s+{S*j%Z/pR0c*jQ1U+_R5i1UU+e&V0z;xR1]+eQ+s&^Q1c+lT1i+s1cQ8[5yR9i8[QwOS&Rw&ST&Sx*qQ,`&qR2V,`W)u$W*q/n5YR/t)uU/o)q)v0gR4w/o[*u%e%f*W2`2g2{R0m*uQ,d&uR2Y,dQ-a'bQ2z-]T2|-a2zQ2w-XR6x2wQ-f'gQ2R,]T3Q-f2RS%pm7QR*z%pdnOwx!g&S't(Q*q-w.mR%unQ0t+RR5^0tQ.U'yR3f.UQ1v+}R6Q1vU*n%`*x;ZR0f*nS1g+n0nR5t1gQ7l3yQ9O7_U9a7l9O9}R9}9U$O!SO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o.u1S1T1X1f1k1m1|2f2l2z2}3i3t5j8ZR&g!SQ4Y.sR7v4YQ1},UR6X1}S/d)_)`R4o/dW(o#a(j(k/SR/W(oQ7{4fR9f7{T)a#}*v!USO[wx!g!k%m&S&y&|'O'b,q-]-^-a2c2z6c6j8g9l9p:W:]:fj$ya{$k%]+j,R1a1z5q6v8s9_:UY%Te$e(b1p3iY%Zf$f(i)l*lQ&j!WQ&k!XQ'Q!nQ'X!rQ'Z!sQ'a!vQ'c!xQ(a#XQ(e#YS(h#[+YQ(w#gQ(x#iQ)R#lQ)S#qQ)T#rQ)U#sQ)V#tQ)W#uQ)X#vQ)Y#wQ)Z#xQ)[#yQ)]#zQ)^#{S)_#}*vQ)k$UQ)q$WQ)x$YQ+X&QS+g&W1QQ,O&bQ,S&fQ,j&xQ,u'PQ-h'iQ-i'jS-|'y.UQ.y(`S/p)r0hS0`*h4aQ0b*iQ0g*qQ0i*rQ0w+WS1`+h+kQ1y,PQ2a,nS2h,w6{Q3R-gQ3c.PQ3d.QQ4c.}Q4d/QQ4j/[Q4m/cQ4s/lQ4u/nQ4y/sQ4z/uQ5d0{Q5p1bQ5w1lQ6U1|S6e2f8tQ6i2iQ6s2uQ6z2}Q7q4OQ7r4RQ7t4WQ8S5YQ8T5eQ8c6_Q8f6fQ8j6hQ8r6tS9T7b7mQ9[7jQ9k8eQ9q8mS9|9R9VQ:T9]Q:Y9oS:`9{:OR:i:bR,V&fd]Owx!g&S't(Q*q-w.m!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)p*]*v+[,X,k,w,z-]-^-a-o-t.d.o1S1T1f2f2z2}3i3t#r${ae!u$e$|$}%S%U%X%d&W&b&f'_(b*`*b*d*f+h+k,P-Q-V0]0^1Q1b1m1|2l2p2q2s2u3w6q6r6t7e7f7h7j8Z8p9X9Y9]:R;W;X;Y;`;a;o;p;q;r;v;w<W<X<YQ%tnS+d&V+eW+r&^+l+s1cU+z&a+{7iQ1k+tT5c0z;x``Owx!g&S't*q-wS$d[-oQ$s_b%Xe$e&f(b-Q1m1|2l8Z!h&r!f!}#O$S$l&U&Y&c&m&x'P'b(Q)p*v+[,X,k,w,z-]-^-a-t.d.m.o1S1T1f2f2z2}3i3tQ'`!uS(_#V+aQ(f#ZS)i$T(gQ*d%UQ-T'_Q/k)jQ1j+tQ5k1XQ5v1kR8U5jS(W#R3]S(X#S3^V(Y#T+b3[R$^Ye0Q)}/|/}0O0R4}5O5P5S8QW(R#R#S#T+bQ([#US.Z'}(US.a(P._Q.x(^W1r+y.X5}6PQ3Z-tQ3h.WQ3o.`Q4V.qU7T3[3]3^Q7]3pR8|7[Q.b(PR3m._T.l(Q.mdgOwx!g&S&m't*q-t-wU$g[,X-oQ&s!fQ'k!}Q'u#OQ)h$SQ*Y$l`+]&U&Y&c*v1S1T1f3iQ,l&xQ,v'PY-_'b-]-a2z2}S.g(Q.mQ/m)pQ0y+[S2_,k-^S2j,w,zS3s.d.oQ6g2fR7c3td]Owx!g&S't(Q*q-w.m!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)p*]*v+[,X,k,w,z-]-^-a-o-t.d.o1S1T1f2f2z2}3i3tR%tnQ3y.gQ7_3sQ7g3wQ7o3zQ7p3{Q9U7cU9W7e7f7hQ9`7kS:Q9X9YR:c:RZ+o&Y&c*v1S3ipzOnpwx!g%w&S't(Q*q-p-w.f.m.o[%Oa%d0z;`;a;xU%We%h1SQ%eg^&d{|%i1O5a;b;yQ's#OQ*W$gb*_$|$}%S;W;X;Y<W<X<YQ,b&sQ-x'uQ0Z*Y[0[*`*b;o;p;q;rQ0k*tQ0|+]Q2`,lQ2g,vS2{-_2_U5V0];v;wQ5b0yQ6l2jR8i6gQ+}&aR9Z7iS1q+y.XQ8^5}R8_6P[%^f$f(i)l)r0hR0d*lR+`&UQ+_&UR5h1TS&Xy+xQ*g%XU+f&V0z;xS+m&Y1SW+p&Z1O5a;yQ-j'kQ/h)hS0_*d*fQ1R+]Q1^+eQ4t/mQ5W0^Q5`0yQ5u1jR8X5vR5z1mYvOwx&S*qR&t!gW%gg,l,v-_T*X$g2_T)w$W*q[uOwx!g&S*qQ&}!kQ*y%mQ,p&yQ,t'OQ2d,qQ6b2cQ8d6cQ8l6jQ9n8gQ:X9lQ:[9pQ:e:WQ:g:]R:k:fxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fU$h[&|-^X-`'b-]-a2zQ-['`R2o-TS-X'`-TQ2r-VQ2x-YU6p2p2q2sQ6w2vS8o6q6rR9s8p[rOwx!g&S*qS-q't-wT.h(Q.mR+S%y[sOwx!g&S*qS-s't-wT.i(Q.m[tOwx!g&S*qT.j(Q.mT.T'y.UX%af%k0h1QQ.w([R4_.xR.t(ZR(d#XQ(r#aS/R(j(kR4e/SR/V(lR4g/T",nodeNames:" RawString > MacroName LineComment BlockComment PreprocDirective #include String EscapeSequence SystemLibString Identifier ArgumentList ( ConditionalExpression AssignmentExpression CallExpression PrimitiveType FieldExpression FieldIdentifier DestructorName TemplateMethod ScopedFieldIdentifier NamespaceIdentifier TemplateType TypeIdentifier ScopedTypeIdentifier ScopedNamespaceIdentifier :: NamespaceIdentifier TypeIdentifier TemplateArgumentList < TypeDescriptor const volatile restrict _Atomic mutable constexpr constinit consteval StructSpecifier struct MsDeclspecModifier __declspec ) Attribute AttributeName Identifier AttributeArgs { } [ ] UpdateOp ArithOp ArithOp ArithOp LogicOp BitOp BitOp BitOp CompareOp CompareOp CompareOp > CompareOp BitOp UpdateOp , Number CharLiteral AttributeArgs VirtualSpecifier BaseClassClause Access virtual FieldDeclarationList FieldDeclaration extern static register inline thread_local AttributeSpecifier __attribute__ PointerDeclarator MsBasedModifier __based MsPointerModifier FunctionDeclarator ParameterList ParameterDeclaration PointerDeclarator FunctionDeclarator Noexcept noexcept RequiresClause requires True False ParenthesizedExpression CommaExpression LambdaExpression LambdaCaptureSpecifier TemplateParameterList OptionalParameterDeclaration TypeParameterDeclaration typename class VariadicParameterDeclaration VariadicDeclarator ReferenceDeclarator OptionalTypeParameterDeclaration VariadicTypeParameterDeclaration TemplateTemplateParameterDeclaration template AbstractFunctionDeclarator AbstractPointerDeclarator AbstractArrayDeclarator AbstractParenthesizedDeclarator AbstractReferenceDeclarator ThrowSpecifier throw TrailingReturnType CompoundStatement FunctionDefinition MsCallModifier TryStatement try CatchClause catch LinkageSpecification Declaration InitDeclarator InitializerList InitializerPair SubscriptDesignator FieldDesignator ExportDeclaration export ImportDeclaration import ModuleName PartitionName HeaderName CaseStatement case default LabeledStatement StatementIdentifier ExpressionStatement IfStatement if ConditionClause Declaration else SwitchStatement switch DoStatement do while WhileStatement ForStatement for ReturnStatement return BreakStatement break ContinueStatement continue GotoStatement goto CoReturnStatement co_return CoYieldStatement co_yield AttributeStatement ForRangeLoop AliasDeclaration using TypeDefinition typedef PointerDeclarator FunctionDeclarator ArrayDeclarator ParenthesizedDeclarator ThrowStatement NamespaceDefinition namespace ScopedIdentifier Identifier OperatorName operator ArithOp BitOp CompareOp LogicOp new delete co_await ConceptDefinition concept UsingDeclaration enum StaticAssertDeclaration static_assert ConcatenatedString TemplateDeclaration FriendDeclaration friend union FunctionDefinition ExplicitFunctionSpecifier explicit FieldInitializerList FieldInitializer DefaultMethodClause DeleteMethodClause FunctionDefinition OperatorCast operator TemplateInstantiation FunctionDefinition FunctionDefinition Declaration ModuleDeclaration module RequiresExpression RequirementList SimpleRequirement TypeRequirement CompoundRequirement ReturnTypeRequirement ConstraintConjuction LogicOp ConstraintDisjunction LogicOp ArrayDeclarator ParenthesizedDeclarator ReferenceDeclarator TemplateFunction OperatorName StructuredBindingDeclarator ArrayDeclarator ParenthesizedDeclarator ReferenceDeclarator BitfieldClause FunctionDefinition FunctionDefinition Declaration FunctionDefinition Declaration AccessSpecifier UnionSpecifier ClassSpecifier EnumSpecifier SizedTypeSpecifier TypeSize EnumeratorList Enumerator DependentType Decltype decltype auto PlaceholderTypeSpecifier ParameterPackExpansion ParameterPackExpansion FieldIdentifier PointerExpression SubscriptExpression BinaryExpression ArithOp LogicOp LogicOp BitOp UnaryExpression LogicOp BitOp UpdateExpression CastExpression SizeofExpression sizeof CoAwaitExpression CompoundLiteralExpression NULL NewExpression new NewDeclarator DeleteExpression delete ParameterPackExpansion nullptr this UserDefinedLiteral ParamPack #define PreprocArg #if #ifdef #ifndef #else #endif #elif PreprocDirectiveName Macro Program",maxTerm:425,nodeProps:[["group",-35,1,8,11,14,15,16,18,71,72,100,101,102,104,191,208,229,242,243,270,271,272,277,280,281,282,284,285,286,287,290,292,293,294,295,296,"Expression",-13,17,24,25,26,42,255,256,257,258,262,263,265,266,"Type",-19,126,129,147,150,152,153,158,160,163,164,166,168,170,172,174,176,178,179,188,"Statement"],["isolate",-4,4,5,8,10,""]],propSources:[J4e],skippedNodes:[0,3,4,5,6,7,10,297,298,299,300,301,302,303,304,305,306,347,348],repeatNodeCount:41,tokenData:"&*r7ZR!UOX$eXY({YZ.gZ]$e]^+P^p$epq({qr.}rs0}st2ktu$euv!7dvw!9bwx!;exy!<Yyz!=Tz{!>O{|!?R|}!AV}!O!BQ!O!P!DX!P!Q#+y!Q!R#Az!R![$(x![!]$Ag!]!^$Cc!^!_$D^!_!`%1W!`!a%2X!a!b%5_!b!c$e!c!n%6Y!n!o%7q!o!w%6Y!w!x%7q!x!}%6Y!}#O%:n#O#P%<g#P#Q%Kz#Q#R%Ms#R#S%6Y#S#T$e#T#i%6Y#i#j%Nv#j#o%6Y#o#p&!e#p#q&#`#q#r&%f#r#s&&a#s;'S$e;'S;=`(u<%lO$e&t$nY)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e&r%eW)ZW'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^&j&SU'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j&kX'f&jOY%}YZ%}Z]%}]^'W^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j']V'f&jOY%}YZ%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j'uP;=`<%l%}&r'{P;=`<%l%^&l(VW(pQ'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O&l(rP;=`<%l(O&t(xP;=`<%l$e7Z)Y`)ZW(pQ(n.o'f&j*Z)`OX$eXY({YZ*[Z]$e]^+P^p$epq({qr$ers%^sw$ewx(Ox#O$e#O#P,^#P;'S$e;'S;=`(u<%lO$e.o*aT(n.oXY*[YZ*[]^*[pq*[#O#P*p.o*sQYZ*[]^*y.o*|PYZ*[4e+[`)ZW(pQ(n.o'f&jOX$eXY+PYZ*[Z]$e]^+P^p$epq+Pqr$ers%^sw$ewx(Ox#O$e#O#P,^#P;'S$e;'S;=`(u<%lO$e4Z,cX'f&jOY%}YZ-OZ]%}]^-{^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}4Z-V[(n.o'f&jOX%}XY-OYZ*[Z]%}]^-O^p%}pq-Oq#O%}#O#P,^#P;'S%};'S;=`'r<%lO%}4Z.QV'f&jOY%}YZ-OZ#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}7P.nT*W)`(n.oXY*[YZ*[]^*[pq*[#O#P*p3o/[[%^!b'QP)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`0Q!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o0_Y%]!b!a,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e6e1YY)ZW(qQ(o/]'f&jOY%^Zr%^rs1xsw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^(U2RW)x!b)ZW'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^4e2tf)ZW(pQ'f&jOX$eXY2kZp$epq2kqr$ers%^sw$ewx(Ox!c$e!c!}4Y!}#O$e#O#P&f#P#T$e#T#W4Y#W#X5m#X#Y>u#Y#]4Y#]#^NZ#^#o4Y#o;'S$e;'S;=`(u<%lO$e4e4eb)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e5xd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y7W#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e7cd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z8q#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e8|d)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^:[#^#o4Y#o;'S$e;'S;=`(u<%lO$e4e:gd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#b4Y#b#c;u#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e<Qd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y=`#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e=mb)ZW(pQ'e.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e?Qf)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#`4Y#`#a@f#a#b4Y#b#cHV#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e@qf)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^BV#^#g4Y#g#hEV#h#o4Y#o;'S$e;'S;=`(u<%lO$e4eBbd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#ZCp#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4eC}b)ZW(pQ'f&j'l.o'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eEbd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#YFp#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4eF}b)ZW(pQ'j.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eHbd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#XIp#X#o4Y#o;'S$e;'S;=`(u<%lO$e4eI{d)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^KZ#^#o4Y#o;'S$e;'S;=`(u<%lO$e4eKfd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#ZLt#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4eMRb)ZW(pQ'f&j'k.o'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eNff)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z! z#Z#b4Y#b#c!.[#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e!!Xf)ZW(pQ'g.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!#m#X#b4Y#b#c!(W#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e!#xd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!%W#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!%cd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z!&q#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e!'Ob)ZW(pQ'h.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e!(cd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!)q#X#o4Y#o;'S$e;'S;=`(u<%lO$e4e!)|d)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!+[#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!+gd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z!,u#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e!-Sb)ZW(pQ'i.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e!.gd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#V4Y#V#W!/u#W#o4Y#o;'S$e;'S;=`(u<%lO$e4e!0Qd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#`4Y#`#a!1`#a#o4Y#o;'S$e;'S;=`(u<%lO$e4e!1kd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#i4Y#i#j!2y#j#o4Y#o;'S$e;'S;=`(u<%lO$e4e!3Ud)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!4d#X#o4Y#o;'S$e;'S;=`(u<%lO$e4e!4od)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!5}#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!6[b)ZW(pQV.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e3o!7q[)ZW(pQ%Z!b![,g'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!8rY!g-y)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!9o])V,g)ZW(pQ%[!b'f&jOY$eZr$ers%^sv$evw!:hwx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!:uY)U,g%^!b)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2X!;pW)[S(pQ)Y,g'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O6i!<eY)ZW(pQ]6_'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e'V!=`Y!Oa)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!>][)S,g)ZW(pQ%Z!b'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!?`^)ZW(pQ%Z!b!Y,g'f&jOY$eZr$ers%^sw$ewx(Ox{$e{|!@[|!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!@gY)ZW!X-y(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!AbY!h,k)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!B__)ZW(pQ%Z!b!Y,g'f&jOY$eZr$ers%^sw$ewx(Ox}$e}!O!@[!O!_$e!_!`!8g!`!a!C^!a#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!CiY(x-y)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!Dd^)ZW(pQ'f&j(w,gOY$eZr$ers%^sw$ewx(Ox!O$e!O!P!E`!P!Q$e!Q![!GY![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!Ei[)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P!F_!P#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!FjY)X,k)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]!Gen)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx!Icx!Q$e!Q![!GY![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2T!IjY(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![!JY![#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O2T!Jcn(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx!Icx!Q(O!Q![!JY![!g(O!g!h!La!h!i##`!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#X(O#X#Y!La#Y#Z##`#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T!Ljl(pQ!i,g'f&jOY(OZr(Ors%}s{(O{|!Nb|}(O}!O!Nb!O!Q(O!Q![# e![!c(O!c!h# e!h!i# e!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#Y# e#Y#Z# e#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T!Ni^(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![# e![!c(O!c!i# e!i#O(O#O#P&f#P#T(O#T#Z# e#Z;'S(O;'S;=`(o<%lO(O2T# nj(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx!Nbx!Q(O!Q![# e![!c(O!c!h# e!h!i# e!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#Y# e#Y#Z# e#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T##id(pQ!i,g'f&jOY(OZr(Ors%}s!h(O!h!i##`!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#Y(O#Y#Z##`#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]#%Sn)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx(Ox{$e{|#'Q|}$e}!O#'Q!O!Q$e!Q![#(]![!c$e!c!h#(]!h!i#(]!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#Y#(]#Y#Z#(]#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]#'Z`)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![#(]![!c$e!c!i#(]!i#O$e#O#P&f#P#T$e#T#Z#(]#Z;'S$e;'S;=`(u<%lO$e2]#(hj)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx!Nbx!Q$e!Q![#(]![!c$e!c!h#(]!h!i#(]!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#Y#(]#Y#Z#(]#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]#*ef)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx(Ox!h$e!h!i#*Y!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#Y$e#Y#Z#*Y#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e7Z#,W`)ZW(pQ%Z!b![,g'f&jOY$eZr$ers%^sw$ewx(Oxz$ez{#-Y{!P$e!P!Q#:s!Q!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z#-c])ZW(pQ'f&jOY#-YYZ#.[Zr#-Yrs#/csw#-Ywx#5wxz#-Yz{#8j{#O#-Y#O#P#2`#P;'S#-Y;'S;=`#:m<%lO#-Y1e#._TOz#.[z{#.n{;'S#.[;'S;=`#/]<%lO#.[1e#.qVOz#.[z{#.n{!P#.[!P!Q#/W!Q;'S#.[;'S;=`#/]<%lO#.[1e#/]OT1e1e#/`P;=`<%l#.[7X#/jZ)ZW'f&jOY#/cYZ#.[Zw#/cwx#0]xz#/cz{#4O{#O#/c#O#P#2`#P;'S#/c;'S;=`#5q<%lO#/c7P#0bX'f&jOY#0]YZ#.[Zz#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#1SZ'f&jOY#0]YZ#.[Zz#0]z{#0}{!P#0]!P!Q#1u!Q#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#1|UT1e'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}7P#2eZ'f&jOY#0]YZ#0]Z]#0]]^#3W^z#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#3]X'f&jOY#0]YZ#0]Zz#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#3{P;=`<%l#0]7X#4V])ZW'f&jOY#/cYZ#.[Zw#/cwx#0]xz#/cz{#4O{!P#/c!P!Q#5O!Q#O#/c#O#P#2`#P;'S#/c;'S;=`#5q<%lO#/c7X#5XW)ZWT1e'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^7X#5tP;=`<%l#/c7R#6OZ(pQ'f&jOY#5wYZ#.[Zr#5wrs#0]sz#5wz{#6q{#O#5w#O#P#2`#P;'S#5w;'S;=`#8d<%lO#5w7R#6x](pQ'f&jOY#5wYZ#.[Zr#5wrs#0]sz#5wz{#6q{!P#5w!P!Q#7q!Q#O#5w#O#P#2`#P;'S#5w;'S;=`#8d<%lO#5w7R#7zW(pQT1e'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O7R#8gP;=`<%l#5w7Z#8s_)ZW(pQ'f&jOY#-YYZ#.[Zr#-Yrs#/csw#-Ywx#5wxz#-Yz{#8j{!P#-Y!P!Q#9r!Q#O#-Y#O#P#2`#P;'S#-Y;'S;=`#:m<%lO#-Y7Z#9}Y)ZW(pQT1e'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z#:pP;=`<%l#-Y7Z#;OY)ZW(pQS1e'f&jOY#:sZr#:srs#;nsw#:swx#@{x#O#:s#O#P#<z#P;'S#:s;'S;=`#At<%lO#:s7X#;wW)ZWS1e'f&jOY#;nZw#;nwx#<ax#O#;n#O#P#<z#P;'S#;n;'S;=`#@u<%lO#;n7P#<hUS1e'f&jOY#<aZ#O#<a#O#P#<z#P;'S#<a;'S;=`#>[<%lO#<a7P#=RXS1e'f&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P;'S#<a;'S;=`#>[<%lO#<a7P#=uVS1e'f&jOY#<aYZ%}Z#O#<a#O#P#<z#P;'S#<a;'S;=`#>[<%lO#<a7P#>_P;=`<%l#<a7P#>i]S1e'f&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P#b#<a#b#c#<a#c#f#<a#f#g#?b#g;'S#<a;'S;=`#>[<%lO#<a7P#?iUS1e'f&jOY#<aZ#O#<a#O#P#?{#P;'S#<a;'S;=`#>[<%lO#<a7P#@SZS1e'f&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P#b#<a#b#c#<a#c;'S#<a;'S;=`#>[<%lO#<a7X#@xP;=`<%l#;n7R#AUW(pQS1e'f&jOY#@{Zr#@{rs#<as#O#@{#O#P#<z#P;'S#@{;'S;=`#An<%lO#@{7R#AqP;=`<%l#@{7Z#AwP;=`<%l#:s2]#BVt)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#U$e#U#V$+X#V#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$=`#m;'S$e;'S;=`(u<%lO$e2T#DnY(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![#E^![#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O2T#Egp(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx#Dgx!O(O!O!P#Gk!P!Q(O!Q![#E^![!g(O!g!h!La!h!i##`!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#X(O#X#Y!La#Y#Z##`#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#Gtn(pQ!i,g'f&jOY(OZr(Ors%}s!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#I{p(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx#LPx!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#LW^(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![#Ir![!c(O!c!i#Ir!i#O(O#O#P&f#P#T(O#T#Z#Ir#Z;'S(O;'S;=`(o<%lO(O2T#M]t(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx#LPx{(O{|!Nb|}(O}!O!Nb!O!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]$ xp)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$$Xp)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#LPx!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$&ht)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#LPx{$e{|#'Q|}$e}!O#'Q!O!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$)Tp)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$+b_)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P$,a!P!Q$e!Q!R$-`!R![$(x![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$,j[)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![!GY![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$-kt)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#U$e#U#V$/{#V#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$0z#m;'S$e;'S;=`(u<%lO$e2]$0U[)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$(x![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$1T`)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$2V![!c$e!c!i$2V!i#O$e#O#P&f#P#T$e#T#Z$2V#Z;'S$e;'S;=`(u<%lO$e2]$2br)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx$4lx!O$e!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2T$4s^(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![$5o![!c(O!c!i$5o!i#O(O#O#P&f#P#T(O#T#Z$5o#Z;'S(O;'S;=`(o<%lO(O2T$5xr(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx$4lx!O(O!O!P#Gk!P!Q(O!Q![$5o![!c(O!c!g$5o!g!h$8S!h!i$5o!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X$5o#X#Y$8S#Y#Z$5o#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T$8]u(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx$4lx{(O{|!Nb|}(O}!O!Nb!O!P#Gk!P!Q(O!Q![$5o![!c(O!c!g$5o!g!h$8S!h!i$5o!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X$5o#X#Y$8S#Y#Z$5o#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]$:{u)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx$4lx{$e{|#'Q|}$e}!O#'Q!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$=ic)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P$,a!P!Q$e!Q!R$>t!R![$2V![!c$e!c!i$2V!i#O$e#O#P&f#P#T$e#T#Z$2V#Z;'S$e;'S;=`(u<%lO$e2]$?Pv)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx$4lx!O$e!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#U$2V#U#V$2V#V#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$0z#m;'S$e;'S;=`(u<%lO$e4e$Ar[(v-X)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox![$e![!]$Bh!]#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3s$BsYl-})ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$CnY)W,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7V$Dk_p,g%]!b)ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!^$Ej!^!_%+w!_!`%.U!`!a%0]!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej*[$Es])ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ejp$FoTO!`$Fl!`!a$GO!a;'S$Fl;'S;=`$GT<%lO$Flp$GTO$Wpp$GWP;=`<%l$Fl*Y$GbZ)ZW'f&jOY$GZYZ$FlZw$GZwx$HTx!`$GZ!`!a%(U!a#O$GZ#O#P$Ib#P;'S$GZ;'S;=`%(y<%lO$GZ*Q$HYX'f&jOY$HTYZ$FlZ!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT*Q$IOU$WpY#t'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}*Q$Ig['f&jOY$HTYZ$HTZ]$HT]^$J]^!`$HT!`!a$NO!a#O$HT#O#P%&n#P;'S$HT;'S;=`%'f;=`<%l%$z<%lO$HT*Q$JbX'f&jOY$HTYZ$J}Z!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT'[$KSX'f&jOY$J}YZ$FlZ!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$KvU$Wp'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}'[$L_Z'f&jOY$J}YZ$J}Z]$J}]^$MQ^!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$MVX'f&jOY$J}YZ$J}Z!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$MuP;=`<%l$J}*Q$M{P;=`<%l$HT*Q$NVW$Wp'f&jOY$NoZ!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`$NtW'f&jOY$NoZ!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`% eUY#t'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%})`% |Y'f&jOY$NoYZ$NoZ]$No]^%!l^#O$No#O#P%#d#P;'S$No;'S;=`%$[;=`<%l%$z<%lO$No)`%!qX'f&jOY$NoYZ%}Z!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`%#aP;=`<%l$No)`%#iZ'f&jOY$NoYZ%}Z]$No]^%!l^!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`%$_XOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l$No<%lO%$z#t%$}WOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h<%lO%$z#t%%lOY#t#t%%oRO;'S%$z;'S;=`%%x;=`O%$z#t%%{XOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l%$z<%lO%$z#t%&kP;=`<%l%$z*Q%&sZ'f&jOY$HTYZ$J}Z]$HT]^$J]^!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT*Q%'iXOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l$HT<%lO%$z*Y%(aW$WpY#t)ZW'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^*Y%(|P;=`<%l$GZ*S%)WZ(pQ'f&jOY%)PYZ$FlZr%)Prs$HTs!`%)P!`!a%)y!a#O%)P#O#P$Ib#P;'S%)P;'S;=`%*n<%lO%)P*S%*UW$WpY#t(pQ'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O*S%*qP;=`<%l%)P*[%+RY$WpY#t)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e*[%+tP;=`<%l$Ej7V%,U^)ZW(pQ%[!b!f,g'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!_$Ej!_!`%-Q!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%-]]!g-y)ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%.c]%]!b!b,g)ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%/[!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%/mY%]!b!b,g$WpY#t)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e)j%0hYY#t)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%1c[)j!c)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`0Q!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%2f]%]!b)ZW(pQ!d,g'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`%3_!`!a%4[!a#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%3lY%]!b!b,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%4i[)ZW(pQ%[!b!f,g'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e&u%5jY(uP)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z%6ib)ZW(yS(pQ!R,f(r%y'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e7Z%8Qb)ZW(yS(pQ!R,f(r%y'f&jOY$eZr$ers%9Ysw$ewx%9{x!Q$e!Q![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e5P%9cW)ZW(o/]'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^2T%:UW(pQ)Y,g'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O3o%:yZ!V-y)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!}$e!}#O%;l#O#P&f#P;'S$e;'S;=`(u<%lO$e&u%;wY)PP)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e4e%<la'f&jOY%=qYZ%>[Z]%=q]^%?Z^!Q%=q!Q![%?w![!w%=q!w!x%AX!x#O%=q#O#P%H_#P#i%=q#i#j%Ds#j#l%=q#l#m%IR#m;'S%=q;'S;=`%Kt<%lO%=q&t%=xUXY'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}4e%>e[XY(n.o'f&jOX%}XY-OYZ*[Z]%}]^-O^p%}pq-Oq#O%}#O#P,^#P;'S%};'S;=`'r<%lO%}4e%?bVXY'f&jOY%}YZ-OZ#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%@OWXY'f&jOY%}Z!Q%}!Q![%@h![#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%@oWXY'f&jOY%}Z!Q%}!Q![%=q![#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%A^['f&jOY%}Z!Q%}!Q![%BS![!c%}!c!i%BS!i#O%}#O#P&f#P#T%}#T#Z%BS#Z;'S%};'S;=`'r<%lO%}&t%BX['f&jOY%}Z!Q%}!Q![%B}![!c%}!c!i%B}!i#O%}#O#P&f#P#T%}#T#Z%B}#Z;'S%};'S;=`'r<%lO%}&t%CS['f&jOY%}Z!Q%}!Q![%Cx![!c%}!c!i%Cx!i#O%}#O#P&f#P#T%}#T#Z%Cx#Z;'S%};'S;=`'r<%lO%}&t%C}['f&jOY%}Z!Q%}!Q![%Ds![!c%}!c!i%Ds!i#O%}#O#P&f#P#T%}#T#Z%Ds#Z;'S%};'S;=`'r<%lO%}&t%Dx['f&jOY%}Z!Q%}!Q![%En![!c%}!c!i%En!i#O%}#O#P&f#P#T%}#T#Z%En#Z;'S%};'S;=`'r<%lO%}&t%Es['f&jOY%}Z!Q%}!Q![%Fi![!c%}!c!i%Fi!i#O%}#O#P&f#P#T%}#T#Z%Fi#Z;'S%};'S;=`'r<%lO%}&t%Fn['f&jOY%}Z!Q%}!Q![%Gd![!c%}!c!i%Gd!i#O%}#O#P&f#P#T%}#T#Z%Gd#Z;'S%};'S;=`'r<%lO%}&t%Gi['f&jOY%}Z!Q%}!Q![%=q![!c%}!c!i%=q!i#O%}#O#P&f#P#T%}#T#Z%=q#Z;'S%};'S;=`'r<%lO%}&t%HfXXY'f&jOY%}YZ%}Z]%}]^'W^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%IW['f&jOY%}Z!Q%}!Q![%I|![!c%}!c!i%I|!i#O%}#O#P&f#P#T%}#T#Z%I|#Z;'S%};'S;=`'r<%lO%}&t%JR['f&jOY%}Z!Q%}!Q![%Jw![!c%}!c!i%Jw!i#O%}#O#P&f#P#T%}#T#Z%Jw#Z;'S%};'S;=`'r<%lO%}&t%KO[XY'f&jOY%}Z!Q%}!Q![%Jw![!c%}!c!i%Jw!i#O%}#O#P&f#P#T%}#T#Z%Jw#Z;'S%};'S;=`'r<%lO%}&t%KwP;=`<%l%=q2a%LVZ!W,V)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P#Q%Lx#Q;'S$e;'S;=`(u<%lO$e'Y%MTY)]d)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%NQ[)ZW(pQ%[!b'f&j!_,gOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z& Vd)ZW(yS(pQ!R,f(r%y'f&jOY$eZr$ers%9Ysw$ewx%9{x!Q$e!Q!Y%6Y!Y!Z%7q!Z![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e2]&!pY!T,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o&#m^)ZW(pQ%[!b'f&j!^,gOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P#p$e#p#q&$i#q;'S$e;'S;=`(u<%lO$e3o&$vY)T,g%^!b)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e'V&%qY!Ua)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e(]&&nc)ZW(pQ%[!b'RP'f&jOX$eXY&'yZp$epq&'yqr$ers%^sw$ewx(Ox!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e&y&(Sc)ZW(pQ'f&jOX$eXY&'yZp$epq&'yqr$ers%^sw$ewx(Ox!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e&y&)jb)ZW(pQdT'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![&)_![!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e",tokenizers:[Z4e,K4e,0,1,2,3,4,5,6,7,8,9],topRules:{Program:[0,307]},dynamicPrecedences:{87:1,94:1,119:1,184:1,187:-10,240:-10,241:1,244:-1,246:-10,247:1,262:-1,267:2,268:2,306:-10,365:3,417:1,418:3,419:1,420:1},specialized:[{term:356,get:s=>e5e[s]||-1},{term:32,get:s=>t5e[s]||-1},{term:66,get:s=>i5e[s]||-1},{term:363,get:s=>n5e[s]||-1}],tokenPrec:24891}),r5e=uT.define({name:"cpp",parser:s5e.configure({props:[uK.add({IfStatement:KP({except:/^\s*({|else\b)/}),TryStatement:KP({except:/^\s*({|catch)\b/}),LabeledStatement:aUe,CaseStatement:s=>s.baseIndent+s.unit,BlockComment:()=>null,CompoundStatement:oUe({closing:"}"}),Statement:KP({except:/^{/})}),pK.add({"DeclarationList CompoundStatement EnumeratorList FieldDeclarationList InitializerList":uUe,BlockComment(s){return{from:s.from+2,to:s.to-2}}})]}),languageData:{commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\})$/,closeBrackets:{stringPrefixes:["L","u","U","u8","LR","UR","uR","u8R","R"]}}});function MT(){return new K$e(r5e)}const j3=s=>(GT("data-v-c96e8edb"),s=s(),QT(),s),o5e=j3(()=>Kt("TresPerspectiveCamera",{position:[0,0,5]},null,-1)),a5e=j3(()=>Kt("TresAxesHelper",{args:[2]},null,-1)),l5e=j3(()=>Kt("TresBoxGeometry",{args:[2,2,2]},null,-1)),$W=`
varying vec2 UV;
void main() {
    UV = uv;
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( position, 1.0 );
}
`,UW=`
void main() {
  gl_FragColor = vec4(0.5, 0.5, 0.5, 1.0);
}
`,c5e={__name:"ShaderFragBase",setup(s){const{onLoop:e}=Ly(),i=[{name:"",children:[{name:"1",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = st.x;
    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"2",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = 1.0-st.x-st.y; //
    c = abs(c);
    gl_FragColor = vec4(c, c, c, 1.0);
}

                `},{name:"3",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = st.x*st.x*st.x-st.y; //
    c = abs(c);
    gl_FragColor = vec4(c, c, c, 1.0);
}

                `},{name:"4",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = (st.x-0.5)*2.0;
    c = abs(c);
    gl_FragColor = vec4(0.0, c, 0.0, 1.0);
}
`},{name:"5",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = 1.0-distance(st, vec2(0.5))*1.0;
    gl_FragColor = vec4(0.0, c, c, 1.0);
}
`}]},{name:"",children:[{name:"1",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    
    float c = distance(st, vec2(0.5))*2.0;
    c = smoothstep(0.8, 0.9, c);
    
    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"2",frag:`

uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    
    float c = st.x*st.x*st.x-st.y;
    c = abs(c);
    c = smoothstep(0.005, 0.015, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}

`},{name:"()",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    
    float c = st.x*st.y;
    vec3 color = mix(vec3(1.0, 0.0, 0.0), vec3(0.0, 1.0, 0.0), c);
    
    gl_FragColor = vec4(color, 1.0);
}
`}]},{name:"",children:[{name:"1",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st *= 3.0;

    vec2 c = floor(st)*0.5;
    
    gl_FragColor = vec4(c, 0.0, 1.0);
}

`},{name:"2",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st *= 3.0;

    vec2 c = fract(st);
    
    gl_FragColor = vec4(c, 0.0, 1.0);
}

`},{name:"3",frag:`

uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st *= 3.0;

    vec2 center = 0.5+floor(st);
    float c = distance(st, center)*2.0;
    
    gl_FragColor = vec4(c, c, c, 1.0);
}
`}]},{name:"",children:[{name:"",frag:`
uniform vec2 u_resolution;
uniform float u_time;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st.x -= fract(u_time*0.2)*2.0-1.0;

    float c = distance(st, vec2(0.5))*2.0;
    c = step(0.5, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"",frag:`
uniform vec2 u_resolution;
uniform float u_time;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st -= 0.5;
    st /= sin(u_time);

    float c = distance(st, vec2(0.0))*2.0;
    c = step(1.0, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"",frag:`
uniform vec2 u_resolution;
uniform float u_time;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st -= 0.5;
    float theta = mod(u_time, 6.28);
    st = mat2(cos(theta), sin(theta), -sin(theta), cos(theta)) * st; //Z

    float c = st.x;
    c = abs(c);
    c = step(0.05, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}
`}]}],n={u_time:{value:0},u_resolution:{value:{x:800,y:600}}};e(({elapsed:g})=>{n.u_time.value=g}),gt(!0);const r=jr(null),o=jr(null),a=gt(null);let l=null;const h=gt(null);let d=null;io(()=>{const g=Ot.updateListener.of(x=>{if(x.docChanged){let _=r.value;if(!_)return;_.vertexShader=x.state.doc.toString(),_.needsUpdate=!0}});l=new Ot({doc:"",extensions:[CT,MT(),g],parent:a.value});const y=Ot.updateListener.of(x=>{if(x.docChanged){let _=r.value;if(!_)return;_.fragmentShader=x.state.doc.toString(),_.needsUpdate=!0}});d=new Ot({doc:"",extensions:[CT,MT(),y],parent:h.value}),n.u_resolution.value.x=o.value.clientWidth,n.u_resolution.value.y=o.value.clientHeight}),an(r,()=>{p(0,0)});function f(g){return g.trim()}function p(g,y){let _=i[g].children[y],w=_.vert?_.vert:$W,O=_.frag?_.frag:UW;w=f(w),O=f(O);let T=l,C=T.state.update({changes:{from:0,to:T.state.doc.length,insert:w}});T.dispatch(C),T=d,C=T.state.update({changes:{from:0,to:T.state.doc.length,insert:O}}),T.dispatch(C)}return(g,y)=>{const x=Bn("Button"),_=Bn("Card"),w=Bn("Col"),O=Bn("Divider"),T=Bn("Row");return di(),Ir(T,null,{default:Zt(()=>[vt(w,{span:4},{default:Zt(()=>[(di(),hn(Un,null,th(i,(C,A)=>vt(_,null,{title:Zt(()=>[Kt("h3",null,ea(C.name),1)]),default:Zt(()=>[(di(!0),hn(Un,null,th(C.children,(B,I)=>(di(),Ir(x,{onClick:R=>p(A,I)},{default:Zt(()=>[As(ea(B.name),1)]),_:2},1032,["onClick"]))),256))]),_:2},1024)),64))]),_:1}),vt(w,{span:10},{default:Zt(()=>[Kt("div",{ref_key:"tresCanvasParentRef",ref:o,class:"tresCanvasBorder"},[vt(ni(VL),{"clear-color":"#FDF5E6"},{default:Zt(()=>[o5e,a5e,Kt("TresMesh",null,[l5e,Kt("TresShaderMaterial",{ref_key:"materialRef",ref:r,uniforms:n,vertexShader:$W,fragmentShader:UW},null,512)]),vt(ni(f3))]),_:1})],512)]),_:1}),vt(w,{span:10},{default:Zt(()=>[vt(O,{orientation:"left"},{default:Zt(()=>[As("")]),_:1}),Kt("div",{ref_key:"codeContainerV",ref:a},null,512),vt(O,{orientation:"left"},{default:Zt(()=>[As("")]),_:1}),Kt("div",{ref_key:"codeContainerF",ref:h},null,512)]),_:1})]),_:1})}}},h5e=eA(c5e,[["__scopeId","data-v-c96e8edb"]]),q3=s=>(GT("data-v-53185512"),s=s(),QT(),s),u5e=q3(()=>Kt("TresPerspectiveCamera",{position:[0,0,5]},null,-1)),d5e=q3(()=>Kt("TresAxesHelper",{args:[2]},null,-1)),f5e=q3(()=>Kt("TresBoxGeometry",{args:[2,3.6,2]},null,-1)),FW=`
varying vec2 UV;
void main() {
    UV = uv;
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( position, 1.0 );
}
`,zW=`
void main() {
  gl_FragColor = vec4(0.5, 0.5, 0.5, 1.0);
}
`,p5e={__name:"ShaderImageBase",setup(s){const{onLoop:e}=Ly(),i=[{name:"",children:[{name:"",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
void main() {
    vec4 color = texture2D(u_tex0, UV);
    gl_FragColor = color;
}
`},{name:"",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
uniform float u_time;
void main() {
    vec4 color = texture2D(u_tex0, UV);
    float scale = abs(sin(u_time));
    scale *= 1.5;
    color.rgb *= scale;
    gl_FragColor = color;
}
`},{name:"",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
uniform float u_time;
void main() {
    vec4 color = texture2D(u_tex0, UV);
    float gray = color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
    gl_FragColor = vec4(gray, gray, gray, color.a);
}
`},{name:"",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
uniform float u_time;

void main() {
    vec4 self = texture2D(u_tex0, UV);

    if(self.a>0.5){
        gl_FragColor = self;
        return;
    }

    float outlineW = abs(sin(u_time))*0.01;
    // outlineW = 0.01;

    int strokeCount = 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x-outlineW, UV.y)).a>0.0 ? 1 : 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x+outlineW, UV.y)).a>0.0 ? 1 : 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x, UV.y-outlineW)).a>0.0 ? 1 : 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x, UV.y+outlineW)).a>0.0 ? 1 : 0;

    if (strokeCount>0){
        self.rgb = vec3(1.0, 0.0, 1.0);
        self.a = 1.0;
    }

    gl_FragColor = self;
}
`}]}],n={u_time:{value:0},u_resolution:{value:{x:800,y:600}},u_tex0:{value:null}};e(({elapsed:g})=>{n.u_time.value=g}),gt(!0);const r=jr(null),o=jr(null),a=gt(null);let l=null;const h=gt(null);let d=null;io(()=>{const g=Ot.updateListener.of(x=>{if(x.docChanged){let _=r.value;if(!_)return;_.vertexShader=x.state.doc.toString(),_.needsUpdate=!0}});l=new Ot({doc:"",extensions:[CT,MT(),g],parent:a.value});const y=Ot.updateListener.of(x=>{if(x.docChanged){let _=r.value;if(!_)return;_.fragmentShader=x.state.doc.toString(),_.needsUpdate=!0}});d=new Ot({doc:"",extensions:[CT,MT(),y],parent:h.value}),n.u_resolution.value.x=o.value.clientWidth,n.u_resolution.value.y=o.value.clientHeight,SIe({map:"img/img1.png"}).then(x=>{n.u_tex0.value=x.map})}),an(r,()=>{p(0,0)});function f(g){return g.trim()}function p(g,y){let _=i[g].children[y],w=_.vert?_.vert:FW,O=_.frag?_.frag:zW;w=f(w),O=f(O);let T=l,C=T.state.update({changes:{from:0,to:T.state.doc.length,insert:w}});T.dispatch(C),T=d,C=T.state.update({changes:{from:0,to:T.state.doc.length,insert:O}}),T.dispatch(C)}return(g,y)=>{const x=Bn("Button"),_=Bn("Card"),w=Bn("Col"),O=Bn("Divider"),T=Bn("Row");return di(),Ir(T,null,{default:Zt(()=>[vt(w,{span:4},{default:Zt(()=>[(di(),hn(Un,null,th(i,(C,A)=>vt(_,null,{title:Zt(()=>[Kt("h3",null,ea(C.name),1)]),default:Zt(()=>[(di(!0),hn(Un,null,th(C.children,(B,I)=>(di(),Ir(x,{onClick:R=>p(A,I)},{default:Zt(()=>[As(ea(B.name),1)]),_:2},1032,["onClick"]))),256))]),_:2},1024)),64))]),_:1}),vt(w,{span:10},{default:Zt(()=>[Kt("div",{ref_key:"tresCanvasParentRef",ref:o,class:"tresCanvasBorder"},[vt(ni(VL),{"clear-color":"#FDF5E6"},{default:Zt(()=>[u5e,d5e,Kt("TresMesh",null,[f5e,Kt("TresShaderMaterial",{ref_key:"materialRef",ref:r,uniforms:n,vertexShader:FW,fragmentShader:zW},null,512)]),vt(ni(f3))]),_:1})],512)]),_:1}),vt(w,{span:10},{default:Zt(()=>[vt(O,{orientation:"left"},{default:Zt(()=>[As("")]),_:1}),Kt("div",{ref_key:"codeContainerV",ref:a},null,512),vt(O,{orientation:"left"},{default:Zt(()=>[As("")]),_:1}),Kt("div",{ref_key:"codeContainerF",ref:h},null,512)]),_:1})]),_:1})}}},m5e=eA(p5e,[["__scopeId","data-v-53185512"]]),g5e=["src"],l2={__name:"ShowVideo",props:{link:String,width:Number,height:Number},setup(s){const e=s,i=gt(null);return io(()=>{var n=e.width?`${n}px`:"100%",r=e.height?`${r}px`:"100vh";i.value={width:n,height:r}}),(n,r)=>(di(),hn("video",{src:e.link,style:Au(i.value),controls:"",autoplay:"",loop:""},null,12,g5e))}};var eh=Object.freeze({Linear:Object.freeze({None:function(s){return s},In:function(s){return s},Out:function(s){return s},InOut:function(s){return s}}),Quadratic:Object.freeze({In:function(s){return s*s},Out:function(s){return s*(2-s)},InOut:function(s){return(s*=2)<1?.5*s*s:-.5*(--s*(s-2)-1)}}),Cubic:Object.freeze({In:function(s){return s*s*s},Out:function(s){return--s*s*s+1},InOut:function(s){return(s*=2)<1?.5*s*s*s:.5*((s-=2)*s*s+2)}}),Quartic:Object.freeze({In:function(s){return s*s*s*s},Out:function(s){return 1- --s*s*s*s},InOut:function(s){return(s*=2)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2)}}),Quintic:Object.freeze({In:function(s){return s*s*s*s*s},Out:function(s){return--s*s*s*s*s+1},InOut:function(s){return(s*=2)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2)}}),Sinusoidal:Object.freeze({In:function(s){return 1-Math.sin((1-s)*Math.PI/2)},Out:function(s){return Math.sin(s*Math.PI/2)},InOut:function(s){return .5*(1-Math.sin(Math.PI*(.5-s)))}}),Exponential:Object.freeze({In:function(s){return s===0?0:Math.pow(1024,s-1)},Out:function(s){return s===1?1:1-Math.pow(2,-10*s)},InOut:function(s){return s===0?0:s===1?1:(s*=2)<1?.5*Math.pow(1024,s-1):.5*(-Math.pow(2,-10*(s-1))+2)}}),Circular:Object.freeze({In:function(s){return 1-Math.sqrt(1-s*s)},Out:function(s){return Math.sqrt(1- --s*s)},InOut:function(s){return(s*=2)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1)}}),Elastic:Object.freeze({In:function(s){return s===0?0:s===1?1:-Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI)},Out:function(s){return s===0?0:s===1?1:Math.pow(2,-10*s)*Math.sin((s-.1)*5*Math.PI)+1},InOut:function(s){return s===0?0:s===1?1:(s*=2,s<1?-.5*Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI):.5*Math.pow(2,-10*(s-1))*Math.sin((s-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(s){var e=1.70158;return s===1?1:s*s*((e+1)*s-e)},Out:function(s){var e=1.70158;return s===0?0:--s*s*((e+1)*s+e)+1},InOut:function(s){var e=2.5949095;return(s*=2)<1?.5*(s*s*((e+1)*s-e)):.5*((s-=2)*s*((e+1)*s+e)+2)}}),Bounce:Object.freeze({In:function(s){return 1-eh.Bounce.Out(1-s)},Out:function(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},InOut:function(s){return s<.5?eh.Bounce.In(s*2)*.5:eh.Bounce.Out(s*2-1)*.5+.5}}),generatePow:function(s){return s===void 0&&(s=4),s=s<Number.EPSILON?Number.EPSILON:s,s=s>1e4?1e4:s,{In:function(e){return Math.pow(e,s)},Out:function(e){return 1-Math.pow(1-e,s)},InOut:function(e){return e<.5?Math.pow(e*2,s)/2:(1-Math.pow(2-e*2,s))/2+.5}}}}),v0=function(){return performance.now()},EJ=function(){function s(){this._tweens={},this._tweensAddedDuringUpdate={}}return s.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(i){return e._tweens[i]})},s.prototype.removeAll=function(){this._tweens={}},s.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},s.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},s.prototype.update=function(e,i){e===void 0&&(e=v0()),i===void 0&&(i=!1);var n=Object.keys(this._tweens);if(n.length===0)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var o=this._tweens[n[r]],a=!i;o&&o.update(e,a)===!1&&!i&&delete this._tweens[n[r]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},s}(),Fp={Linear:function(s,e){var i=s.length-1,n=i*e,r=Math.floor(n),o=Fp.Utils.Linear;return e<0?o(s[0],s[1],n):e>1?o(s[i],s[i-1],i-n):o(s[r],s[r+1>i?i:r+1],n-r)},Bezier:function(s,e){for(var i=0,n=s.length-1,r=Math.pow,o=Fp.Utils.Bernstein,a=0;a<=n;a++)i+=r(1-e,n-a)*r(e,a)*s[a]*o(n,a);return i},CatmullRom:function(s,e){var i=s.length-1,n=i*e,r=Math.floor(n),o=Fp.Utils.CatmullRom;return s[0]===s[i]?(e<0&&(r=Math.floor(n=i*(1+e))),o(s[(r-1+i)%i],s[r],s[(r+1)%i],s[(r+2)%i],n-r)):e<0?s[0]-(o(s[0],s[0],s[1],s[1],-n)-s[0]):e>1?s[i]-(o(s[i],s[i],s[i-1],s[i-1],n-i)-s[i]):o(s[r?r-1:0],s[r],s[i<r+1?i:r+1],s[i<r+2?i:r+2],n-r)},Utils:{Linear:function(s,e,i){return(e-s)*i+s},Bernstein:function(s,e){var i=Fp.Utils.Factorial;return i(s)/i(e)/i(s-e)},Factorial:function(){var s=[1];return function(e){var i=1;if(s[e])return s[e];for(var n=e;n>1;n--)i*=n;return s[e]=i,i}}(),CatmullRom:function(s,e,i,n,r){var o=(i-s)*.5,a=(n-e)*.5,l=r*r,h=r*l;return(2*e-2*i+o+a)*h+(-3*e+3*i-2*o-a)*l+o*r+e}}},Z3=function(){function s(){}return s.nextId=function(){return s._nextId++},s._nextId=0,s}(),WR=new EJ,ob=function(){function s(e,i){i===void 0&&(i=WR),this._object=e,this._group=i,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=eh.Linear.None,this._interpolationFunction=Fp.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Z3.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return s.prototype.getId=function(){return this._id},s.prototype.isPlaying=function(){return this._isPlaying},s.prototype.isPaused=function(){return this._isPaused},s.prototype.getDuration=function(){return this._duration},s.prototype.to=function(e,i){if(i===void 0&&(i=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=i<0?0:i,this},s.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},s.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},s.prototype.start=function(e,i){if(e===void 0&&(e=v0()),i===void 0&&(i=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var n in this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||i){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var o in this._valuesEnd)r[o]=this._valuesEnd[o];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,i)}return this},s.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},s.prototype._setupProperties=function(e,i,n,r,o){for(var a in n){var l=e[a],h=Array.isArray(l),d=h?"array":typeof l,f=!h&&Array.isArray(n[a]);if(!(d==="undefined"||d==="function")){if(f){var p=n[a];if(p.length===0)continue;for(var g=[l],y=0,x=p.length;y<x;y+=1){var _=this._handleRelativeValue(l,p[y]);if(isNaN(_)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}g.push(_)}f&&(n[a]=g)}if((d==="object"||h)&&l&&!f){i[a]=h?[]:{};var w=l;for(var O in w)i[a][O]=w[O];r[a]=h?[]:{};var p=n[a];if(!this._isDynamic){var T={};for(var O in p)T[O]=p[O];n[a]=p=T}this._setupProperties(w,i[a],p,r[a],o)}else(typeof i[a]>"u"||o)&&(i[a]=l),h||(i[a]*=1),f?r[a]=n[a].slice().reverse():r[a]=i[a]||0}}},s.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},s.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},s.prototype.pause=function(e){return e===void 0&&(e=v0()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},s.prototype.resume=function(e){return e===void 0&&(e=v0()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},s.prototype.stopChainedTweens=function(){for(var e=0,i=this._chainedTweens.length;e<i;e++)this._chainedTweens[e].stop();return this},s.prototype.group=function(e){return e===void 0&&(e=WR),this._group=e,this},s.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},s.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},s.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},s.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},s.prototype.easing=function(e){return e===void 0&&(e=eh.Linear.None),this._easingFunction=e,this},s.prototype.interpolation=function(e){return e===void 0&&(e=Fp.Linear),this._interpolationFunction=e,this},s.prototype.chain=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return this._chainedTweens=e,this},s.prototype.onStart=function(e){return this._onStartCallback=e,this},s.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},s.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},s.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},s.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},s.prototype.onStop=function(e){return this._onStopCallback=e,this},s.prototype.update=function(e,i){var n;if(e===void 0&&(e=v0()),i===void 0&&(i=!0),this._isPaused)return!0;var r=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>r)return!1;i&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,a=this._duration+((n=this._repeatDelayTime)!==null&&n!==void 0?n:this._delayTime),l=this._duration+this._repeat*a,h=this._calculateElapsedPortion(o,a,l),d=this._easingFunction(h),f=this._calculateCompletionStatus(o,a);if(f==="repeat"&&this._processRepetition(o,a),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,d),f==="about-to-repeat"&&this._processRepetition(o,a),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),f==="repeat"||f==="about-to-repeat")this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1;else if(f==="completed"){this._isPlaying=!1,this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,g=this._chainedTweens.length;p<g;p++)this._chainedTweens[p].start(this._startTime+this._duration,!1)}return f!=="completed"},s.prototype._calculateElapsedPortion=function(e,i,n){if(this._duration===0||e>n)return 1;var r=e%i,o=Math.min(r/this._duration,1);return o===0&&e!==0&&e%this._duration===0?1:o},s.prototype._calculateCompletionStatus=function(e,i){return this._duration!==0&&e<this._duration?"playing":this._repeat<=0?"completed":e===this._duration?"about-to-repeat":"repeat"},s.prototype._processRepetition=function(e,i){var n=Math.min(Math.trunc((e-this._duration)/i)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=n);for(var r in this._valuesStartRepeat){var o=this._valuesEnd[r];!this._yoyo&&typeof o=="string"&&(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(o)),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r]}this._yoyo&&(this._reversed=!this._reversed),this._startTime+=i*n},s.prototype._updateProperties=function(e,i,n,r){for(var o in n)if(i[o]!==void 0){var a=i[o]||0,l=n[o],h=Array.isArray(e[o]),d=Array.isArray(l),f=!h&&d;f?e[o]=this._interpolationFunction(l,r):typeof l=="object"&&l?this._updateProperties(e[o],a,l,r):(l=this._handleRelativeValue(a,l),typeof l=="number"&&(e[o]=a+(l-a)*r))}},s.prototype._handleRelativeValue=function(e,i){return typeof i!="string"?i:i.charAt(0)==="+"||i.charAt(0)==="-"?e+parseFloat(i):parseFloat(i)},s.prototype._swapEndStartRepeatValues=function(e){var i=this._valuesStartRepeat[e],n=this._valuesEnd[e];typeof n=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(n):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=i},s}(),y5e="23.1.2",v5e=Z3.nextId,oh=WR,x5e=oh.getAll.bind(oh),_5e=oh.removeAll.bind(oh),b5e=oh.add.bind(oh),w5e=oh.remove.bind(oh),MJ=oh.update.bind(oh),Cs={Easing:eh,Group:EJ,Interpolation:Fp,now:v0,Sequence:Z3,nextId:v5e,Tween:ob,VERSION:y5e,getAll:x5e,removeAll:_5e,add:b5e,remove:w5e,update:MJ};const O5e={class:"game-container"},S5e={__name:"BallGame",setup(s){const e=["ballgame/player_run.png","ballgame/player_win.png","ballgame/player_fail.png","ballgame/bomb.png","ballgame/hankey.png","ballgame/star_small.png"],i=[{name:"",targetScore:5,path:{type:"line",start:{x:.1,y:.7},end:{x:.9,y:.7},width:.06},obstacles:{interval:2e3,types:["hankey","hankey","bomb"]},playerSpeed:.012},{name:"",targetScore:8,path:{type:"arc",center:{x:.5,y:.7},radiusX:.4,radiusY:.15,startAngle:0,endAngle:Math.PI,width:.06},obstacles:{interval:1800,types:["hankey","hankey","hankey","bomb"]},playerSpeed:.014},{name:"",targetScore:10,path:{type:"sin",start:{x:.1,y:.7},end:{x:.9,y:.7},amplitude:.04,frequency:2,width:.06},obstacles:{interval:1600,types:["hankey","hankey","bomb","bomb"]},playerSpeed:.016},{name:"",targetScore:10,path:{type:"circle",center:{x:.5,y:.7},radius:.4,width:.06},obstacles:{interval:1400,types:["hankey","bomb"]},playerSpeed:.01},{name:"",targetScore:10,path:{type:"wave",start:{x:.1,y:.7},end:{x:.9,y:.7},amplitude:.12,frequency:2,width:.06},obstacles:{interval:1200,types:["hankey","bomb"]},playerSpeed:.03}];class n{constructor(p,g,y){this.pixi=p,this.path=g,this.speed=y,this.sprite=null,this.currentPosition=0,this.direction=1,this.isMoving=!1,this.init()}init(){this.sprite=new rr(this.pixi.gameApp.textures["ballgame/player_run.png"]),this.sprite.anchor.set(.5),this.pixi.stage.addChild(this.sprite),this.updatePosition()}updatePosition(){const p=this.getPathPosition(this.currentPosition);this.sprite.x=p.x,this.sprite.y=p.y,this.direction<0?this.sprite.scale.x=-1:this.sprite.scale.x=1}getPathPosition(p){const g=this.pixi.screen.width,y=this.pixi.screen.height;switch(this.path.type){case"line":return{x:this.path.start.x*g+(this.path.end.x*g-this.path.start.x*g)*p,y:this.path.start.y*y+(this.path.end.y*y-this.path.start.y*y)*p};case"arc":const x=this.path.startAngle+(this.path.endAngle-this.path.startAngle)*p;return{x:this.path.center.x*g+Math.cos(x)*this.path.radiusX*g,y:this.path.center.y*y+Math.sin(x)*this.path.radiusY*y};case"sin":const _=this.path.start.x*g+(this.path.end.x*g-this.path.start.x*g)*p,w=Math.sin(p*this.path.frequency*Math.PI*2)*this.path.amplitude*y;return{x:_,y:this.path.start.y*y+w};case"wave":const O=this.path.start.x*g,T=this.path.end.x*g,C=this.path.start.y*y,A=this.path.amplitude*y,B=this.path.frequency,I=T-O,R=I/B,P=O+p*I,k=(P-O)%R/R,E=C+A,D=C-A,L=1-k,V=k,F=L*L*L*C+3*L*L*V*E+3*L*V*V*D+V*V*V*C;return{x:P,y:F};case"circle":const j=p*Math.PI*2,Q=this.path.radius*Math.min(g,y);return{x:this.path.center.x*g+Math.cos(j)*Q,y:this.path.center.y*y+Math.sin(j)*Q};case"polyline":const ee=this.path.points.length-1,J=Math.floor(p*ee),ue=p*ee%1,oe=Math.min(J,ee-1),pe=this.path.points[oe],Ue=this.path.points[oe+1];return{x:pe.x*g+(Ue.x*g-pe.x*g)*ue,y:pe.y*y+(Ue.y*y-pe.y*y)*ue}}}update(){this.isMoving&&(this.currentPosition+=this.speed*this.direction,this.currentPosition>=1?(this.currentPosition=1,this.direction=-1):this.currentPosition<=0&&(this.currentPosition=0,this.direction=1),this.updatePosition())}reverse(){this.direction*=-1}start(){this.isMoving=!0}getBounds(){const p=this.sprite.getBounds(),g=.9,y=p.x+p.width/2,x=p.y+p.height/2,_=p.width*g,w=p.height*g;return{x:y-_/2,y:x-w/2,width:_,height:w}}}class r{constructor(p,g,y,x){this.pixi=p,this.type=g,this.sprite=null,this.x=y,this.y=x,this.speed=8,this.init()}init(){const p=this.type==="bomb"?"ballgame/bomb.png":"ballgame/hankey.png";this.sprite=new rr(this.pixi.gameApp.textures[p]),this.sprite.anchor.set(.5),this.sprite.x=this.x,this.sprite.y=this.y,this.pixi.stage.addChild(this.sprite)}update(){this.sprite.y+=this.speed}isOutOfScreen(){return this.sprite.y>this.pixi.screen.height+100}getBounds(){const p=this.sprite.getBounds(),g=.9,y=p.x+p.width/2,x=p.y+p.height/2,_=p.width*g,w=p.height*g;return{x:y-_/2,y:x-w/2,width:_,height:w}}destroy(){this.sprite&&this.sprite.parent&&this.sprite.parent.removeChild(this.sprite)}}class o{constructor(){this.pixi=null,this.currentLevel=0,this.score=0,this.gameState="waiting",this.player=null,this.obstacles=[],this.pathGraphics=null,this.scoreText=null,this.levelText=null,this.instructionText=null,this.obstacleTimer=0,this.lastObstacleTime=0,this.audioContext=null,this.sounds={},this.textures={},this.resourcesLoaded=!1,this.starContainer=null,this.baseFontStyle={fontFamily:"Verdana, Geneva, sans-serif",fontWeight:"bold",strokeThickness:5}}async init(){this.pixi=XD(d.value),this.pixi.gameApp=this,this.pixi.stage.eventMode="static",this.pixi.stage.hitArea=this.pixi.screen,this.pixi.stage.on("pointerdown",this.handleClick.bind(this)),this.starContainer=new Qt,this.pixi.stage.addChildAt(this.starContainer,0),this.initAudio(),this.pixi.ticker.add(this.gameLoop,this)}setTextures(p){this.textures=p,this.resourcesLoaded=!0,this.createBackground(),this.initUI(),this.initGame()}createBackground(){for(let p=0;p<30;p++){const g=new rr(this.textures["ballgame/star_small.png"]);g.anchor.set(.5),g.x=Math.random()*this.pixi.screen.width,g.y=Math.random()*this.pixi.screen.height,g.scale.set(Math.random()*.5+.5),g.alpha=Math.random()*.4+.2,this.starContainer.addChild(g)}}initAudio(){this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.loadSound("ballgame/ball_click.mp3","click"),this.loadSound("ballgame/ball_bomb.mp3","bomb"),this.loadSound("ballgame/ball_collect.mp3","collect")}async loadSound(p,g){try{const x=await(await fetch(p)).arrayBuffer(),_=await this.audioContext.decodeAudioData(x);this.sounds[g]=_}catch(y){console.log(":",y)}}playSound(p){if(this.sounds[p]&&this.audioContext.state==="running"){const g=this.audioContext.createBufferSource();g.buffer=this.sounds[p],g.connect(this.audioContext.destination),g.start()}}initUI(){this.titleText=new Xi("",{...this.baseFontStyle,fontSize:64,fill:14540262,dropShadow:!0,dropShadowColor:16777215,dropShadowBlur:4,dropShadowDistance:2}),this.titleText.anchor.set(0,.5),this.titleText.x=this.pixi.screen.width*.05,this.titleText.y=this.pixi.screen.height*.04,this.pixi.stage.addChild(this.titleText),this.levelText=new Xi("",{...this.baseFontStyle,fontSize:48,fill:11591910,dropShadow:!0,dropShadowColor:16777215,dropShadowBlur:2,dropShadowDistance:1}),this.levelText.anchor.set(0,.5),this.levelText.x=this.pixi.screen.width*.05,this.levelText.y=this.pixi.screen.height*.08,this.pixi.stage.addChild(this.levelText),this.scoreText=new Xi("0/5",{...this.baseFontStyle,fontSize:56,fill:11591910,dropShadow:!0,dropShadowColor:16777215,dropShadowBlur:2,dropShadowDistance:1}),this.scoreText.anchor.set(1,.5),this.scoreText.x=this.pixi.screen.width*.95,this.scoreText.y=this.pixi.screen.height*.04,this.pixi.stage.addChild(this.scoreText),this.instructionText=new Xi("",{...this.baseFontStyle,fontSize:60,fill:11591910}),this.instructionText.anchor.set(.5),this.instructionText.x=this.pixi.screen.width*.5,this.instructionText.y=this.pixi.screen.height*.35,this.pixi.stage.addChild(this.instructionText),this.helpText=new Xi(`
`,{...this.baseFontStyle,fontSize:50,fill:11591910,align:"center"}),this.helpText.anchor.set(.5),this.helpText.x=this.pixi.screen.width*.5,this.helpText.y=this.pixi.screen.height*.45,this.pixi.stage.addChild(this.helpText)}initGame(){this.loadLevel(this.currentLevel),this.updateUI()}loadLevel(p){this.cleanupLevel();const g=i[p];this.levelText.text=`${g.name}`,this.drawPath(g.path),this.player=new n(this.pixi,g.path,g.playerSpeed),this.score=0,this.gameState="waiting",this.obstacles=[],this.obstacleTimer=0,this.lastObstacleTime=0,this.updateUI()}drawPath(p){this.pathGraphics&&this.pixi.stage.removeChild(this.pathGraphics),this.pathGraphics=new ki;const g=this.pixi.screen.width,y=this.pixi.screen.height,x=p.width*g;switch(this.pathGraphics.lineStyle(x,6710886,.5),p.type){case"line":this.drawRoundedLine(p.start.x*g,p.start.y*y,p.end.x*g,p.end.y*y,x/2);break;case"arc":const _=100;for(let k=0;k<=_;k++){const E=k/_,D=p.startAngle+(p.endAngle-p.startAngle)*E,L=p.center.x*g+Math.cos(D)*p.radiusX*g,V=p.center.y*y+Math.sin(D)*p.radiusY*y;k===0?this.pathGraphics.moveTo(L,V):this.pathGraphics.lineTo(L,V)}break;case"sin":const w=200;for(let k=0;k<=w;k++){const E=k/w,D=p.start.x*g+(p.end.x*g-p.start.x*g)*E,L=Math.sin(E*p.frequency*Math.PI*2)*p.amplitude*y,V=p.start.y*y+L;k===0?this.pathGraphics.moveTo(D,V):this.pathGraphics.lineTo(D,V)}break;case"wave":const O=p.start.x*g,T=p.end.x*g,C=p.start.y*y,A=p.amplitude*y,B=p.frequency,R=(T-O)/B;this.pathGraphics.moveTo(O,C);for(let k=0;k<B;k++){const E=O+k*R,D=O+(k+1)*R,L=E+R*.25,V=C+A,F=E+R*.75,j=C-A;this.pathGraphics.bezierCurveTo(L,V,F,j,D,C)}break;case"circle":const P=100;for(let k=0;k<=P;k++){const D=k/P*Math.PI*2,L=p.radius*Math.min(g,y),V=p.center.x*g+Math.cos(D)*L,F=p.center.y*y+Math.sin(D)*L;k===0?this.pathGraphics.moveTo(V,F):this.pathGraphics.lineTo(V,F)}break;case"polyline":this.pathGraphics.moveTo(p.points[0].x*g,p.points[0].y*y);for(let k=1;k<p.points.length;k++)this.pathGraphics.lineTo(p.points[k].x*g,p.points[k].y*y);break}this.pixi.stage.addChild(this.pathGraphics)}drawRoundedLine(p,g,y,x,_){const w=y-p,O=x-g,T=Math.sqrt(w*w+O*O);if(T===0)return;const C=w/T,A=O/T;this.pathGraphics.moveTo(p+C*_,g+A*_),this.pathGraphics.lineTo(y-C*_,x-A*_)}getWavePosition(p,g){const y=this.pixi.screen.width,x=this.pixi.screen.height,_=p.start.x*y+(p.end.x*y-p.start.x*y)*g,w=Math.sin(g*p.frequency*Math.PI*2)*p.amplitude*x;return{x:_,y:p.start.y*x+w}}cleanupLevel(){this.obstacles.forEach(p=>p.destroy()),this.obstacles=[],this.player&&this.player.sprite&&this.pixi.stage.removeChild(this.player.sprite),this.pathGraphics&&this.pixi.stage.removeChild(this.pathGraphics)}updateUI(){const p=i[this.currentLevel];this.scoreText.text=`${this.score}/${p.targetScore}`,this.gameState==="waiting"?(this.instructionText.text="",this.instructionText.visible=!1,this.helpText.visible=!0):this.gameState==="playing"?(this.instructionText.visible=!1,this.helpText.visible=!1):this.gameState==="gameover"?(this.instructionText.text="",this.instructionText.visible=!0,this.helpText.visible=!1):this.gameState==="win"&&(this.instructionText.text="",this.instructionText.visible=!0,this.helpText.visible=!1)}startGame(){this.gameState==="waiting"?(this.gameState="playing",this.player.start(),this.playSound("click"),this.updateUI()):this.gameState==="gameover"?this.loadLevel(this.currentLevel):this.gameState==="win"&&(this.currentLevel++,this.currentLevel>=i.length&&(this.currentLevel=0),this.loadLevel(this.currentLevel))}reversePlayer(){this.gameState==="playing"&&this.player&&(this.player.reverse(),this.playSound("click"))}spawnObstacle(){const p=i[this.currentLevel],g=p.obstacles.types[Math.floor(Math.random()*p.obstacles.types.length)],y=Math.random()*this.pixi.screen.width*.8+this.pixi.screen.width*.1,x=new r(this.pixi,g,y,-50);this.obstacles.push(x)}checkCollisions(){if(!this.player)return;const p=this.player.getBounds();for(let g=this.obstacles.length-1;g>=0;g--){const y=this.obstacles[g],x=y.getBounds();if(this.isColliding(p,x)){if(y.type==="bomb")this.score=0,this.playSound("bomb"),this.gameState="gameover",this.updateUI(),this.createExplosion(y.sprite.x,y.sprite.y),this.showFailScreen();else if(y.type==="hankey"){this.score++,this.playSound("collect"),this.createHankeyFlyEffect(y.sprite.x,y.sprite.y);const _=i[this.currentLevel];this.score>=_.targetScore&&(this.gameState="win",this.updateUI(),this.showWinScreen())}y.destroy(),this.obstacles.splice(g,1)}}}createExplosion(p,g){const y=new ki;y.beginFill(16711680,.8),y.drawCircle(0,0,50),y.endFill(),y.x=p,y.y=g,y.alpha=1,y.scale.set(1),this.pixi.stage.addChild(y);const x={scale:1,alpha:1};new Cs.Tween(x).to({scale:2,alpha:0},800).easing(Cs.Easing.Quadratic.Out).onUpdate(()=>{y.alpha=x.alpha,y.scale.set(x.scale)}).onComplete(()=>{this.pixi.stage.removeChild(y)}).start()}createHankeyFlyEffect(p,g){const y=new rr(this.textures["ballgame/hankey.png"]);y.anchor.set(.5),y.x=p,y.y=g,y.scale.set(1),this.pixi.stage.addChild(y);const x=this.scoreText.x-this.scoreText.width/2,_=this.scoreText.y,w={x:p,y:g,scale:1};new Cs.Tween(w).to({x,y:_,scale:.5},600).easing(Cs.Easing.Quadratic.InOut).onUpdate(()=>{y.x=w.x,y.y=w.y,y.scale.set(w.scale)}).onComplete(()=>{this.pixi.stage.removeChild(y),this.updateUI()}).start()}showFailScreen(){const p=new rr(this.textures["ballgame/player_fail.png"]);p.anchor.set(.5),p.x=this.pixi.screen.width*.5,p.y=this.pixi.screen.height*.5,p.alpha=0,this.pixi.stage.addChild(p);const g={alpha:0};new Cs.Tween(g).to({alpha:1},500).easing(Cs.Easing.Quadratic.Out).onUpdate(()=>{p.alpha=g.alpha}).chain(new Cs.Tween(g).to({alpha:0},500).delay(1e3).easing(Cs.Easing.Quadratic.In).onUpdate(()=>{p.alpha=g.alpha}).onComplete(()=>{this.pixi.stage.removeChild(p)})).start()}showWinScreen(){const p=new rr(this.textures["ballgame/player_win.png"]);p.anchor.set(.5),p.x=this.pixi.screen.width*.5,p.y=this.pixi.screen.height*.5,p.alpha=0,p.scale.set(1),this.pixi.stage.addChild(p);for(let y=0;y<20;y++){const x=new ki;x.beginFill(16776960,.8),x.drawCircle(0,0,5),x.endFill(),x.x=this.pixi.screen.width*.5,x.y=this.pixi.screen.height*.5,x.alpha=0,this.pixi.stage.addChild(x);const _=Math.PI*2*y/20,w=100+Math.random()*50,O=this.pixi.screen.width*.5+Math.cos(_)*w,T=this.pixi.screen.height*.5+Math.sin(_)*w,C={x:x.x,y:x.y,alpha:0};new Cs.Tween(C).to({alpha:1},300).delay(y*100).easing(Cs.Easing.Quadratic.Out).onUpdate(()=>{x.alpha=C.alpha}).chain(new Cs.Tween(C).to({x:O,y:T,alpha:0},1500).easing(Cs.Easing.Quadratic.In).onUpdate(()=>{x.x=C.x,x.y=C.y,x.alpha=C.alpha}).onComplete(()=>{this.pixi.stage.removeChild(x)})).start()}const g={alpha:0,scale:1.2};p.scale.set(g.scale),new Cs.Tween(g).to({alpha:1,scale:1.2},800).easing(Cs.Easing.Back.Out).onUpdate(()=>{p.alpha=g.alpha,p.scale.set(g.scale)}).chain(new Cs.Tween(g).to({scale:1},300).easing(Cs.Easing.Quadratic.Out).onUpdate(()=>{p.scale.set(g.scale)}).chain(new Cs.Tween(g).to({alpha:0},500).delay(2e3).easing(Cs.Easing.Quadratic.In).onUpdate(()=>{p.alpha=g.alpha}).onComplete(()=>{this.pixi.stage.removeChild(p)}))).start()}isColliding(p,g){return p.x<g.x+g.width&&p.x+p.width>g.x&&p.y<g.y+g.height&&p.y+p.height>g.y}gameLoop(){const p=Date.now();if(Cs.update(),this.gameState==="playing"){this.player&&this.player.update();const g=i[this.currentLevel];p-this.lastObstacleTime>g.obstacles.interval&&(this.spawnObstacle(),this.lastObstacleTime=p);for(let y=this.obstacles.length-1;y>=0;y--){const x=this.obstacles[y];x.update(),x.isOutOfScreen()&&(x.destroy(),this.obstacles.splice(y,1))}this.checkCollisions()}}handleClick(p){const g={x:p.global.x,y:p.global.y};this.createSpreadCircle(g),this.gameState==="waiting"||this.gameState==="gameover"||this.gameState==="win"?this.startGame():this.gameState==="playing"&&this.reversePlayer()}createSpreadCircle(p){const g=new ki,y=6737151;g.beginFill(y,1),g.drawCircle(0,0,10),g.endFill(),g.x=p.x,g.y=p.y,g.alpha=1,g.radius=10,this.pixi.stage.addChild(g),new Cs.Tween({radius:10,alpha:1}).to({radius:80,alpha:0},500).onUpdate(x=>{g.clear(),g.beginFill(y,x.alpha),g.drawCircle(0,0,x.radius),g.endFill()}).onComplete(()=>{g.parent&&g.parent.removeChild(g),g.destroy()}).start()}destroy(){this.pixi&&(this.pixi.destroy(!0),this.pixi=null)}}const a=f=>{console.log(`: ${f.progress}% (${f.loaded}/${f.total})`)},l=async f=>{console.log("");const p={designWidth:1080,designHeight:1920};mA(d.value,p),h=new o,await h.init(),h.setTextures(f)};let h=null;const d=gt(null);return ra(()=>{h&&h.destroy()}),(f,p)=>(di(),hn("div",O5e,[Kt("canvas",{ref_key:"pixiContainer",ref:d},null,512),vt(zD,{textureUrls:e,onLoaded:l,onProgress:a})]))}},C5e=Kt("TresPerspectiveCamera",{position:[0,20,0],rotation:[0,0,0]},null,-1),T5e=Kt("TresAmbientLight",{intensity:1},null,-1),A5e=Kt("TresAxesHelper",null,null,-1),E5e=Kt("TresGridHelper",null,null,-1),M5e={__name:"ThreeHello",setup(s){const e=jr(null);return an(e,()=>{}),(i,n)=>{const r=Bn("TresCanvas");return di(),hn("div",null,[vt(r,{ref_key:"canvasRef",ref:e,"clear-color":"#e0eee8","window-size":""},{default:Zt(()=>[C5e,T5e,A5e,E5e,vt(ni(f3))]),_:1},512)])}}},k5e=Kt("TresAmbientLight",{intensity:1},null,-1),P5e=Kt("TresAxesHelper",null,null,-1),I5e=["position"],B5e=Kt("TresSphereGeometry",{args:[.4,8,8]},null,-1),R5e=Kt("TresMeshBasicMaterial",{color:"red",transparent:!0,opacity:.1},null,-1),D5e=[B5e,R5e],L5e={__name:"CurveRope",setup(s){const e=jr(null),i=jr(null),n=jr(null);let o=new CL().load("img/rope3.png");var a=new lc({map:o});const l=jr(null);let h=-1,d=new PL,f=Tm([new ie(0,-8,0),new ie(0,2,0),new ie(0,8,0)]);function p(){const _=new AA(...f),w=_.getLength();console.log("curveLength",w);const O=30;var T=[],C=[];for(let P=0;P<O;P++){let k=P/O,E=_.getPointAt(k),D=_.getTangentAt(k),L=new Fe(-D.y,D.x).normalize(),V=(P+1)/O,F=_.getPointAt(V),j=_.getTangentAt(V),Q=new Fe(-j.y,j.x).normalize(),ee=[E.clone().add(L.clone().multiplyScalar(.4)),E.clone().sub(L.clone().multiplyScalar(.4)),F.clone().add(Q.clone().multiplyScalar(.4)),F.clone().sub(Q.clone().multiplyScalar(.4))];T.push(ee[0]),T.push(ee[1]),T.push(ee[2]),T.push(ee[1]),T.push(ee[3]),T.push(ee[2]);let J=0,ue=1;console.log(`ratio1=${k.toFixed(2)}`,`uv1=${J.toFixed(2)}`,`uv2=${ue.toFixed(2)}`),C.push(new Fe(0,J)),C.push(new Fe(1,J)),C.push(new Fe(0,ue)),C.push(new Fe(1,J)),C.push(new Fe(1,ue)),C.push(new Fe(0,ue))}const A=new Float32Array(T.length*3);for(let P=0;P<T.length;P++)A[P*3]=T[P].x,A[P*3+1]=T[P].y,A[P*3+2]=0;const B=new Float32Array(C.length*2);for(let P=0;P<C.length;P++)B[P*2]=C[P].x,B[P*2+1]=C[P].y;var I=new $i;for(I.setAttribute("position",new rn(A,3)),I.setAttribute("uv",new rn(B,2));i.value.children.length>0;)i.value.remove(i.value.children[0]);var R;{var R=new Dn(I,a);i.value.add(R)}}an(i,()=>{p()});function g(_){if(h>=0){let w={x:0,y:0};w.x=_.clientX/window.innerWidth*2-1,w.y=-(_.clientY/window.innerHeight)*2+1,d.setFromCamera(w,n.value);let O=new Xl(new ie(0,0,1),0),T=new ie;d.ray.intersectPlane(O,T)&&(f[h]=T),p()}}function y(_){let w={x:_.clientX/window.innerWidth*2-1,y:-(_.clientY/window.innerHeight)*2+1};d.setFromCamera(w,n.value);const O=d.intersectObjects(l.value.children);if(O.length>0){const T=O[0].object;h=l.value.children.indexOf(T)}else h=-1}function x(_){h=-1}return(_,w)=>{const O=Bn("TresCanvas");return di(),hn("div",{onMousemove:g,onMousedown:y,onMouseup:x},[vt(O,{ref_key:"canvasRef",ref:e,"clear-color":"#f9f7f7","window-size":""},{default:Zt(()=>[Kt("TresPerspectiveCamera",{ref_key:"cameraRef",ref:n,position:[0,0,20],rotation:[0,0,0]},null,512),k5e,P5e,Kt("TresGroup",{ref_key:"curveRef",ref:i},null,512),Kt("TresGroup",{ref_key:"controlPointsRef",ref:l},[(di(!0),hn(Un,null,th(ni(f),(T,C)=>(di(),hn("TresMesh",{key:C,position:T},D5e,8,I5e))),128))],512)]),_:1},512)],32)}}},{abs:sx,cos:Bh,sin:Ng,acos:N5e,atan2:rx,sqrt:fd,pow:el}=Math;function ox(s){return s<0?-el(-s,1/3):el(s,1/3)}const kJ=Math.PI,QO=2*kJ,pd=kJ/2,V5e=1e-6,c2=Number.MAX_SAFE_INTEGER||9007199254740991,h2=Number.MIN_SAFE_INTEGER||-9007199254740991,$5e={x:0,y:0,z:0},ot={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(s,e){const i=e(s);let n=i.x*i.x+i.y*i.y;return typeof i.z<"u"&&(n+=i.z*i.z),fd(n)},compute:function(s,e,i){if(s===0)return e[0].t=0,e[0];const n=e.length-1;if(s===1)return e[n].t=1,e[n];const r=1-s;let o=e;if(n===0)return e[0].t=s,e[0];if(n===1){const l={x:r*o[0].x+s*o[1].x,y:r*o[0].y+s*o[1].y,t:s};return i&&(l.z=r*o[0].z+s*o[1].z),l}if(n<4){let l=r*r,h=s*s,d,f,p,g=0;n===2?(o=[o[0],o[1],o[2],$5e],d=l,f=r*s*2,p=h):n===3&&(d=l*r,f=l*s*3,p=r*h*3,g=s*h);const y={x:d*o[0].x+f*o[1].x+p*o[2].x+g*o[3].x,y:d*o[0].y+f*o[1].y+p*o[2].y+g*o[3].y,t:s};return i&&(y.z=d*o[0].z+f*o[1].z+p*o[2].z+g*o[3].z),y}const a=JSON.parse(JSON.stringify(e));for(;a.length>1;){for(let l=0;l<a.length-1;l++)a[l]={x:a[l].x+(a[l+1].x-a[l].x)*s,y:a[l].y+(a[l+1].y-a[l].y)*s},typeof a[l].z<"u"&&(a[l].z=a[l].z+(a[l+1].z-a[l].z)*s);a.splice(a.length-1,1)}return a[0].t=s,a[0]},computeWithRatios:function(s,e,i,n){const r=1-s,o=i,a=e;let l=o[0],h=o[1],d=o[2],f=o[3],p;if(l*=r,h*=s,a.length===2)return p=l+h,{x:(l*a[0].x+h*a[1].x)/p,y:(l*a[0].y+h*a[1].y)/p,z:n?(l*a[0].z+h*a[1].z)/p:!1,t:s};if(l*=r,h*=2*r,d*=s*s,a.length===3)return p=l+h+d,{x:(l*a[0].x+h*a[1].x+d*a[2].x)/p,y:(l*a[0].y+h*a[1].y+d*a[2].y)/p,z:n?(l*a[0].z+h*a[1].z+d*a[2].z)/p:!1,t:s};if(l*=r,h*=1.5*r,d*=3*r,f*=s*s*s,a.length===4)return p=l+h+d+f,{x:(l*a[0].x+h*a[1].x+d*a[2].x+f*a[3].x)/p,y:(l*a[0].y+h*a[1].y+d*a[2].y+f*a[3].y)/p,z:n?(l*a[0].z+h*a[1].z+d*a[2].z+f*a[3].z)/p:!1,t:s}},derive:function(s,e){const i=[];for(let n=s,r=n.length,o=r-1;r>1;r--,o--){const a=[];for(let l=0,h;l<o;l++)h={x:o*(n[l+1].x-n[l].x),y:o*(n[l+1].y-n[l].y)},e&&(h.z=o*(n[l+1].z-n[l].z)),a.push(h);i.push(a),n=a}return i},between:function(s,e,i){return e<=s&&s<=i||ot.approximately(s,e)||ot.approximately(s,i)},approximately:function(s,e,i){return sx(s-e)<=(i||V5e)},length:function(s){const i=ot.Tvalues.length;let n=0;for(let r=0,o;r<i;r++)o=.5*ot.Tvalues[r]+.5,n+=ot.Cvalues[r]*ot.arcfn(o,s);return .5*n},map:function(s,e,i,n,r){const o=i-e,a=r-n,l=s-e,h=l/o;return n+a*h},lerp:function(s,e,i){const n={x:e.x+s*(i.x-e.x),y:e.y+s*(i.y-e.y)};return e.z!==void 0&&i.z!==void 0&&(n.z=e.z+s*(i.z-e.z)),n},pointToString:function(s){let e=s.x+"/"+s.y;return typeof s.z<"u"&&(e+="/"+s.z),e},pointsToString:function(s){return"["+s.map(ot.pointToString).join(", ")+"]"},copy:function(s){return JSON.parse(JSON.stringify(s))},angle:function(s,e,i){const n=e.x-s.x,r=e.y-s.y,o=i.x-s.x,a=i.y-s.y,l=n*a-r*o,h=n*o+r*a;return rx(l,h)},round:function(s,e){const i=""+s,n=i.indexOf(".");return parseFloat(i.substring(0,n+1+e))},dist:function(s,e){const i=s.x-e.x,n=s.y-e.y;return fd(i*i+n*n)},closest:function(s,e){let i=el(2,63),n,r;return s.forEach(function(o,a){r=ot.dist(e,o),r<i&&(i=r,n=a)}),{mdist:i,mpos:n}},abcratio:function(s,e){if(e!==2&&e!==3)return!1;if(typeof s>"u")s=.5;else if(s===0||s===1)return s;const i=el(s,e)+el(1-s,e),n=i-1;return sx(n/i)},projectionratio:function(s,e){if(e!==2&&e!==3)return!1;if(typeof s>"u")s=.5;else if(s===0||s===1)return s;const i=el(1-s,e),n=el(s,e)+i;return i/n},lli8:function(s,e,i,n,r,o,a,l){const h=(s*n-e*i)*(r-a)-(s-i)*(r*l-o*a),d=(s*n-e*i)*(o-l)-(e-n)*(r*l-o*a),f=(s-i)*(o-l)-(e-n)*(r-a);return f==0?!1:{x:h/f,y:d/f}},lli4:function(s,e,i,n){const r=s.x,o=s.y,a=e.x,l=e.y,h=i.x,d=i.y,f=n.x,p=n.y;return ot.lli8(r,o,a,l,h,d,f,p)},lli:function(s,e){return ot.lli4(s,s.c,e,e.c)},makeline:function(s,e){return new Wn(s.x,s.y,(s.x+e.x)/2,(s.y+e.y)/2,e.x,e.y)},findbbox:function(s){let e=c2,i=c2,n=h2,r=h2;return s.forEach(function(o){const a=o.bbox();e>a.x.min&&(e=a.x.min),i>a.y.min&&(i=a.y.min),n<a.x.max&&(n=a.x.max),r<a.y.max&&(r=a.y.max)}),{x:{min:e,mid:(e+n)/2,max:n,size:n-e},y:{min:i,mid:(i+r)/2,max:r,size:r-i}}},shapeintersections:function(s,e,i,n,r){if(!ot.bboxoverlap(e,n))return[];const o=[],a=[s.startcap,s.forward,s.back,s.endcap],l=[i.startcap,i.forward,i.back,i.endcap];return a.forEach(function(h){h.virtual||l.forEach(function(d){if(d.virtual)return;const f=h.intersects(d,r);f.length>0&&(f.c1=h,f.c2=d,f.s1=s,f.s2=i,o.push(f))})}),o},makeshape:function(s,e,i){const n=e.points.length,r=s.points.length,o=ot.makeline(e.points[n-1],s.points[0]),a=ot.makeline(s.points[r-1],e.points[0]),l={startcap:o,forward:s,back:e,endcap:a,bbox:ot.findbbox([o,s,e,a])};return l.intersections=function(h){return ot.shapeintersections(l,l.bbox,h,h.bbox,i)},l},getminmax:function(s,e,i){if(!i)return{min:0,max:0};let n=c2,r=h2,o,a;i.indexOf(0)===-1&&(i=[0].concat(i)),i.indexOf(1)===-1&&i.push(1);for(let l=0,h=i.length;l<h;l++)o=i[l],a=s.get(o),a[e]<n&&(n=a[e]),a[e]>r&&(r=a[e]);return{min:n,mid:(n+r)/2,max:r,size:r-n}},align:function(s,e){const i=e.p1.x,n=e.p1.y,r=-rx(e.p2.y-n,e.p2.x-i),o=function(a){return{x:(a.x-i)*Bh(r)-(a.y-n)*Ng(r),y:(a.x-i)*Ng(r)+(a.y-n)*Bh(r)}};return s.map(o)},roots:function(s,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const i=s.length-1,n=ot.align(s,e),r=function(R){return 0<=R&&R<=1};if(i===2){const R=n[0].y,P=n[1].y,k=n[2].y,E=R-2*P+k;if(E!==0){const D=-fd(P*P-R*k),L=-R+P,V=-(D+L)/E,F=-(-D+L)/E;return[V,F].filter(r)}else if(P!==k&&E===0)return[(2*P-k)/(2*P-2*k)].filter(r);return[]}const o=n[0].y,a=n[1].y,l=n[2].y,h=n[3].y;let d=-o+3*a-3*l+h,f=3*o-6*a+3*l,p=-3*o+3*a,g=o;if(ot.approximately(d,0)){if(ot.approximately(f,0))return ot.approximately(p,0)?[]:[-g/p].filter(r);const R=fd(p*p-4*f*g),P=2*f;return[(R-p)/P,(-p-R)/P].filter(r)}f/=d,p/=d,g/=d;const y=(3*p-f*f)/3,x=y/3,_=(2*f*f*f-9*f*p+27*g)/27,w=_/2,O=w*w+x*x*x;let T,C,A,B,I;if(O<0){const R=-y/3,P=R*R*R,k=fd(P),E=-_/(2*k),D=E<-1?-1:E>1?1:E,L=N5e(D),V=ox(k),F=2*V;return A=F*Bh(L/3)-f/3,B=F*Bh((L+QO)/3)-f/3,I=F*Bh((L+2*QO)/3)-f/3,[A,B,I].filter(r)}else{if(O===0)return T=w<0?ox(-w):-ox(w),A=2*T-f/3,B=-T-f/3,[A,B].filter(r);{const R=fd(O);return T=ox(-w+R),C=ox(w+R),[T-C-f/3].filter(r)}}},droots:function(s){if(s.length===3){const e=s[0],i=s[1],n=s[2],r=e-2*i+n;if(r!==0){const o=-fd(i*i-e*n),a=-e+i,l=-(o+a)/r,h=-(-o+a)/r;return[l,h]}else if(i!==n&&r===0)return[(2*i-n)/(2*(i-n))];return[]}if(s.length===2){const e=s[0],i=s[1];return e!==i?[e/(e-i)]:[]}return[]},curvature:function(s,e,i,n,r){let o,a,l,h,d=0,f=0;const p=ot.compute(s,e),g=ot.compute(s,i),y=p.x*p.x+p.y*p.y;if(n?(o=fd(el(p.y*g.z-g.y*p.z,2)+el(p.z*g.x-g.z*p.x,2)+el(p.x*g.y-g.x*p.y,2)),a=el(y+p.z*p.z,3/2)):(o=p.x*g.y-p.y*g.x,a=el(y,3/2)),o===0||a===0)return{k:0,r:0};if(d=o/a,f=a/o,!r){const x=ot.curvature(s-.001,e,i,n,!0).k,_=ot.curvature(s+.001,e,i,n,!0).k;h=(_-d+(d-x))/2,l=(sx(_-d)+sx(d-x))/2}return{k:d,r:f,dk:h,adk:l}},inflections:function(s){if(s.length<4)return[];const e=ot.align(s,{p1:s[0],p2:s.slice(-1)[0]}),i=e[2].x*e[1].y,n=e[3].x*e[1].y,r=e[1].x*e[2].y,o=e[3].x*e[2].y,a=18*(-3*i+2*n+3*r-o),l=18*(3*i-n-3*r),h=18*(r-i);if(ot.approximately(a,0)){if(!ot.approximately(l,0)){let g=-h/l;if(0<=g&&g<=1)return[g]}return[]}const d=2*a;if(ot.approximately(d,0))return[];const f=l*l-4*a*h;if(f<0)return[];const p=Math.sqrt(f);return[(p-l)/d,-(l+p)/d].filter(function(g){return 0<=g&&g<=1})},bboxoverlap:function(s,e){const i=["x","y"],n=i.length;for(let r=0,o,a,l,h;r<n;r++)if(o=i[r],a=s[o].mid,l=e[o].mid,h=(s[o].size+e[o].size)/2,sx(a-l)>=h)return!1;return!0},expandbox:function(s,e){e.x.min<s.x.min&&(s.x.min=e.x.min),e.y.min<s.y.min&&(s.y.min=e.y.min),e.z&&e.z.min<s.z.min&&(s.z.min=e.z.min),e.x.max>s.x.max&&(s.x.max=e.x.max),e.y.max>s.y.max&&(s.y.max=e.y.max),e.z&&e.z.max>s.z.max&&(s.z.max=e.z.max),s.x.mid=(s.x.min+s.x.max)/2,s.y.mid=(s.y.min+s.y.max)/2,s.z&&(s.z.mid=(s.z.min+s.z.max)/2),s.x.size=s.x.max-s.x.min,s.y.size=s.y.max-s.y.min,s.z&&(s.z.size=s.z.max-s.z.min)},pairiteration:function(s,e,i){const n=s.bbox(),r=e.bbox(),o=1e5,a=i||.5;if(n.x.size+n.y.size<a&&r.x.size+r.y.size<a)return[(o*(s._t1+s._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];let l=s.split(.5),h=e.split(.5),d=[{left:l.left,right:h.left},{left:l.left,right:h.right},{left:l.right,right:h.right},{left:l.right,right:h.left}];d=d.filter(function(p){return ot.bboxoverlap(p.left.bbox(),p.right.bbox())});let f=[];return d.length===0||(d.forEach(function(p){f=f.concat(ot.pairiteration(p.left,p.right,a))}),f=f.filter(function(p,g){return f.indexOf(p)===g})),f},getccenter:function(s,e,i){const n=e.x-s.x,r=e.y-s.y,o=i.x-e.x,a=i.y-e.y,l=n*Bh(pd)-r*Ng(pd),h=n*Ng(pd)+r*Bh(pd),d=o*Bh(pd)-a*Ng(pd),f=o*Ng(pd)+a*Bh(pd),p=(s.x+e.x)/2,g=(s.y+e.y)/2,y=(e.x+i.x)/2,x=(e.y+i.y)/2,_=p+l,w=g+h,O=y+d,T=x+f,C=ot.lli8(p,g,_,w,y,x,O,T),A=ot.dist(C,s);let B=rx(s.y-C.y,s.x-C.x),I=rx(e.y-C.y,e.x-C.x),R=rx(i.y-C.y,i.x-C.x),P;return B<R?((B>I||I>R)&&(B+=QO),B>R&&(P=R,R=B,B=P)):R<I&&I<B?(P=R,R=B,B=P):R+=QO,C.s=B,C.e=R,C.r=A,C},numberSort:function(s,e){return s-e}};class n_{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return ot.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,i){return e+i})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var i=e[0].bbox(),n=1;n<e.length;n++)ot.expandbox(i,e[n].bbox());return i}offset(e){const i=[];return this.curves.forEach(function(n){i.push(...n.offset(e))}),new n_(i)}}const{abs:ax,min:XW,max:WW,cos:U5e,sin:F5e,acos:z5e,sqrt:lx}=Math,X5e=Math.PI;class Wn{constructor(e){let i=e&&e.forEach?e:Array.from(arguments).slice(),n=!1;if(typeof i[0]=="object"){n=i.length;const y=[];i.forEach(function(x){["x","y","z"].forEach(function(_){typeof x[_]<"u"&&y.push(x[_])})}),i=y}let r=!1;const o=i.length;if(n){if(n>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");r=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const a=this._3d=!r&&(o===9||o===12)||e&&e[0]&&typeof e[0].z<"u",l=this.points=[];for(let y=0,x=a?3:2;y<o;y+=x){var h={x:i[y],y:i[y+1]};a&&(h.z=i[y+2]),l.push(h)}const d=this.order=l.length-1,f=this.dims=["x","y"];a&&f.push("z"),this.dimlen=f.length;const p=ot.align(l,{p1:l[0],p2:l[d]}),g=ot.dist(l[0],l[d]);this._linear=p.reduce((y,x)=>y+ax(x.y),0)<g/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,i,n,r){if(typeof r>"u"&&(r=.5),r===0)return new Wn(i,i,n);if(r===1)return new Wn(e,i,i);const o=Wn.getABC(2,e,i,n,r);return new Wn(e,o.A,n)}static cubicFromPoints(e,i,n,r,o){typeof r>"u"&&(r=.5);const a=Wn.getABC(3,e,i,n,r);typeof o>"u"&&(o=ot.dist(i,a.C));const l=o*(1-r)/r,h=ot.dist(e,n),d=(n.x-e.x)/h,f=(n.y-e.y)/h,p=o*d,g=o*f,y=l*d,x=l*f,_={x:i.x-p,y:i.y-g},w={x:i.x+y,y:i.y+x},O=a.A,T={x:O.x+(_.x-O.x)/(1-r),y:O.y+(_.y-O.y)/(1-r)},C={x:O.x+(w.x-O.x)/r,y:O.y+(w.y-O.y)/r},A={x:e.x+(T.x-e.x)/r,y:e.y+(T.y-e.y)/r},B={x:n.x+(C.x-n.x)/(1-r),y:n.y+(C.y-n.y)/(1-r)};return new Wn(e,A,B,n)}static getUtils(){return ot}getUtils(){return Wn.getUtils()}static get PolyBezier(){return n_}valueOf(){return this.toString()}toString(){return ot.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,i=e[0].x,n=e[0].y,r=["M",i,n,this.order===2?"Q":"C"];for(let o=1,a=e.length;o<a;o++)r.push(e[o].x),r.push(e[o].y);return r.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,i){return""+i+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=ot.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,i=ot.angle(e[0],e[this.order],e[1]);this.clockwise=i>0}length(){return ot.length(this.derivative.bind(this))}static getABC(e=2,i,n,r,o=.5){const a=ot.projectionratio(o,e),l=1-a,h={x:a*i.x+l*r.x,y:a*i.y+l*r.y},d=ot.abcratio(o,e);return{A:{x:n.x+(n.x-h.x)/d,y:n.y+(n.y-h.y)/d},B:n,C:h,S:i,E:r}}getABC(e,i){i=i||this.get(e);let n=this.points[0],r=this.points[this.order];return Wn.getABC(this.order,n,i,r,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let i=0,n,r;i<e;i++)r=i/(e-1),n=this.compute(r),n.t=r,this._lut.push(n);return this._lut}on(e,i){i=i||5;const n=this.getLUT(),r=[];for(let o=0,a,l=0;o<n.length;o++)a=n[o],ot.dist(a,e)<i&&(r.push(a),l+=o/n.length);return r.length?t/=r.length:!1}project(e){const i=this.getLUT(),n=i.length-1,r=ot.closest(i,e),o=r.mpos,a=(o-1)/n,l=(o+1)/n,h=.1/n;let d=r.mdist,f=a,p=f,g;d+=1;for(let y;f<l+h;f+=h)g=this.compute(f),y=ot.dist(e,g),y<d&&(d=y,p=f);return p=p<0?0:p>1?1:p,g=this.compute(p),g.t=p,g.d=d,g}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?ot.computeWithRatios(e,this.points,this.ratios,this._3d):ot.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,i=[e[0]],n=e.length;for(let r=1,o,a;r<n;r++)o=e[r],a=e[r-1],i[r]={x:(n-r)/n*o.x+r/n*a.x,y:(n-r)/n*o.y+r/n*a.y};return i[n]=e[n-1],new Wn(i)}derivative(e){return ot.compute(e,this.dpoints[0],this._3d)}dderivative(e){return ot.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new Wn(ot.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return ot.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return ot.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const i=this.derivative(e),n=lx(i.x*i.x+i.y*i.y);return{t:e,x:-i.y/n,y:i.x/n}}__normal3(e){const i=this.derivative(e),n=this.derivative(e+.01),r=lx(i.x*i.x+i.y*i.y+i.z*i.z),o=lx(n.x*n.x+n.y*n.y+n.z*n.z);i.x/=r,i.y/=r,i.z/=r,n.x/=o,n.y/=o,n.z/=o;const a={x:n.y*i.z-n.z*i.y,y:n.z*i.x-n.x*i.z,z:n.x*i.y-n.y*i.x},l=lx(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=l,a.y/=l,a.z/=l;const h=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{t:e,x:h[0]*i.x+h[1]*i.y+h[2]*i.z,y:h[3]*i.x+h[4]*i.y+h[5]*i.z,z:h[6]*i.x+h[7]*i.y+h[8]*i.z}}hull(e){let i=this.points,n=[],r=[],o=0;for(r[o++]=i[0],r[o++]=i[1],r[o++]=i[2],this.order===3&&(r[o++]=i[3]);i.length>1;){n=[];for(let a=0,l,h=i.length-1;a<h;a++)l=ot.lerp(e,i[a],i[a+1]),r[o++]=l,n.push(l);i=n}return r}split(e,i){if(e===0&&i)return this.split(i).left;if(i===1)return this.split(e).right;const n=this.hull(e),r={left:this.order===2?new Wn([n[0],n[3],n[5]]):new Wn([n[0],n[4],n[7],n[9]]),right:this.order===2?new Wn([n[5],n[4],n[2]]):new Wn([n[9],n[8],n[6],n[3]]),span:n};return r.left._t1=ot.map(0,0,1,this._t1,this._t2),r.left._t2=ot.map(e,0,1,this._t1,this._t2),r.right._t1=ot.map(e,0,1,this._t1,this._t2),r.right._t2=ot.map(1,0,1,this._t1,this._t2),i?(i=ot.map(i,e,1,0,1),r.right.split(i).left):r}extrema(){const e={};let i=[];return this.dims.forEach((function(n){let r=function(a){return a[n]},o=this.dpoints[0].map(r);e[n]=ot.droots(o),this.order===3&&(o=this.dpoints[1].map(r),e[n]=e[n].concat(ot.droots(o))),e[n]=e[n].filter(function(a){return a>=0&&a<=1}),i=i.concat(e[n].sort(ot.numberSort))}).bind(this)),e.values=i.sort(ot.numberSort).filter(function(n,r){return i.indexOf(n)===r}),e}bbox(){const e=this.extrema(),i={};return this.dims.forEach((function(n){i[n]=ot.getminmax(this,n,e[n])}).bind(this)),i}overlaps(e){const i=this.bbox(),n=e.bbox();return ot.bboxoverlap(i,n)}offset(e,i){if(typeof i<"u"){const n=this.get(e),r=this.normal(e),o={c:n,n:r,x:n.x+r.x*i,y:n.y+r.y*i};return this._3d&&(o.z=n.z+r.z*i),o}if(this._linear){const n=this.normal(0),r=this.points.map(function(o){const a={x:o.x+e*n.x,y:o.y+e*n.y};return o.z&&n.z&&(a.z=o.z+e*n.z),a});return[new Wn(r)]}return this.reduce().map(function(n){return n._linear?n.offset(e)[0]:n.scale(e)})}simple(){if(this.order===3){const r=ot.angle(this.points[0],this.points[3],this.points[1]),o=ot.angle(this.points[0],this.points[3],this.points[2]);if(r>0&&o<0||r<0&&o>0)return!1}const e=this.normal(0),i=this.normal(1);let n=e.x*i.x+e.y*i.y;return this._3d&&(n+=e.z*i.z),ax(z5e(n))<X5e/3}reduce(){let e,i=0,n=0,r=.01,o,a=[],l=[],h=this.extrema().values;for(h.indexOf(0)===-1&&(h=[0].concat(h)),h.indexOf(1)===-1&&h.push(1),i=h[0],e=1;e<h.length;e++)n=h[e],o=this.split(i,n),o._t1=i,o._t2=n,a.push(o),i=n;return a.forEach(function(d){for(i=0,n=0;n<=1;)for(n=i+r;n<=1+r;n+=r)if(o=d.split(i,n),!o.simple()){if(n-=r,ax(i-n)<r)return[];o=d.split(i,n),o._t1=ot.map(i,0,1,d._t1,d._t2),o._t2=ot.map(n,0,1,d._t1,d._t2),l.push(o),i=n;break}i<1&&(o=d.split(i,1),o._t1=ot.map(i,0,1,d._t1,d._t2),o._t2=d._t2,l.push(o))}),l}translate(e,i,n){n=typeof n=="number"?n:i;const r=this.order;let o=this.points.map((a,l)=>(1-l/r)*i+l/r*n);return new Wn(this.points.map((a,l)=>({x:a.x+e.x*o[l],y:a.y+e.y*o[l]})))}scale(e){const i=this.order;let n=!1;if(typeof e=="function"&&(n=e),n&&i===2)return this.raise().scale(n);const r=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),n?n(0):e,n?n(1):e);const a=n?n(0):e,l=n?n(1):e,h=[this.offset(0,10),this.offset(1,10)],d=[],f=ot.lli4(h[0],h[0].c,h[1],h[1].c);if(!f)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(p){const g=d[p*i]=ot.copy(o[p*i]);g.x+=(p?l:a)*h[p].n.x,g.y+=(p?l:a)*h[p].n.y}),n?([0,1].forEach(function(p){if(!(i===2&&p)){var g=o[p+1],y={x:g.x-f.x,y:g.y-f.y},x=n?n((p+1)/i):e;n&&!r&&(x=-x);var _=lx(y.x*y.x+y.y*y.y);y.x/=_,y.y/=_,d[p+1]={x:g.x+x*y.x,y:g.y+x*y.y}}}),new Wn(d)):([0,1].forEach(p=>{if(i===2&&p)return;const g=d[p*i],y=this.derivative(p),x={x:g.x+y.x,y:g.y+y.y};d[p+1]=ot.lli4(g,x,f,o[p+1])}),new Wn(d))}outline(e,i,n,r){if(i=i===void 0?e:i,this._linear){const B=this.normal(0),I=this.points[0],R=this.points[this.points.length-1];let P,k,E;n===void 0&&(n=e,r=i),P={x:I.x+B.x*e,y:I.y+B.y*e},E={x:R.x+B.x*n,y:R.y+B.y*n},k={x:(P.x+E.x)/2,y:(P.y+E.y)/2};const D=[P,k,E];P={x:I.x-B.x*i,y:I.y-B.y*i},E={x:R.x-B.x*r,y:R.y-B.y*r},k={x:(P.x+E.x)/2,y:(P.y+E.y)/2};const L=[E,k,P],V=ot.makeline(L[2],D[0]),F=ot.makeline(D[2],L[0]),j=[V,new Wn(D),F,new Wn(L)];return new n_(j)}const o=this.reduce(),a=o.length,l=[];let h=[],d,f=0,p=this.length();const g=typeof n<"u"&&typeof r<"u";function y(B,I,R,P,k){return function(E){const D=P/R,L=(P+k)/R,V=I-B;return ot.map(E,0,1,B+D*V,B+L*V)}}o.forEach(function(B){const I=B.length();g?(l.push(B.scale(y(e,n,p,f,I))),h.push(B.scale(y(-i,-r,p,f,I)))):(l.push(B.scale(e)),h.push(B.scale(-i))),f+=I}),h=h.map(function(B){return d=B.points,d[3]?B.points=[d[3],d[2],d[1],d[0]]:B.points=[d[2],d[1],d[0]],B}).reverse();const x=l[0].points[0],_=l[a-1].points[l[a-1].points.length-1],w=h[a-1].points[h[a-1].points.length-1],O=h[0].points[0],T=ot.makeline(w,x),C=ot.makeline(_,O),A=[T].concat(l).concat([C]).concat(h);return new n_(A)}outlineshapes(e,i,n){i=i||e;const r=this.outline(e,i).curves,o=[];for(let a=1,l=r.length;a<l/2;a++){const h=ot.makeshape(r[a],r[l-a],n);h.startcap.virtual=a>1,h.endcap.virtual=a<l/2-1,o.push(h)}return o}intersects(e,i){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof Wn&&(e=e.reduce()),this.curveintersects(this.reduce(),e,i)):this.selfintersects(i)}lineIntersects(e){const i=XW(e.p1.x,e.p2.x),n=XW(e.p1.y,e.p2.y),r=WW(e.p1.x,e.p2.x),o=WW(e.p1.y,e.p2.y);return ot.roots(this.points,e).filter(a=>{var l=this.get(a);return ot.between(l.x,i,r)&&ot.between(l.y,n,o)})}selfintersects(e){const i=this.reduce(),n=i.length-2,r=[];for(let o=0,a,l,h;o<n;o++)l=i.slice(o,o+1),h=i.slice(o+2),a=this.curveintersects(l,h,e),r.push(...a);return r}curveintersects(e,i,n){const r=[];e.forEach(function(a){i.forEach(function(l){a.overlaps(l)&&r.push({left:a,right:l})})});let o=[];return r.forEach(function(a){const l=ot.pairiteration(a.left,a.right,n);l.length>0&&(o=o.concat(l))}),o}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,i,n,r){const o=(r-n)/4,a=this.get(n+o),l=this.get(r-o),h=ot.dist(e,i),d=ot.dist(e,a),f=ot.dist(e,l);return ax(d-h)+ax(f-h)}_iterate(e,i){let n=0,r=1,o;do{o=0,r=1;let a=this.get(n),l,h,d,f,p=!1,g=!1,y,x=r,_=1;do if(g=p,f=d,x=(n+r)/2,l=this.get(x),h=this.get(r),d=ot.getccenter(a,l,h),d.interval={start:n,end:r},p=this._error(d,a,n,r)<=e,y=g&&!p,y||(_=r),p){if(r>=1){if(d.interval.end=_=1,f=d,r>1){let O={x:d.x+d.r*U5e(d.e),y:d.y+d.r*F5e(d.e)};d.e+=ot.angle({x:d.x,y:d.y},O,this.get(1))}break}r=r+(r-n)/2}else r=x;while(!y&&o++<100);if(o>=100)break;f=f||d,i.push(f),n=_}while(r<1);return i}}const W5e=Kt("p",{style:{width:"100px"}},"",-1),H5e=Kt("p",{style:{width:"100px"}},"",-1),G5e=`
attribute vec2 aPosition;
attribute vec3 aColor;
attribute vec2 aUV;

varying vec3 vColor;
varying vec2 vUV;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;

void main() {

    mat3 mvp = projectionMatrix * translationMatrix;
    gl_Position = vec4((mvp * vec3(aPosition, 1.0)).xy, 0.0, 1.0);

    vColor = aColor;
    vUV = aUV;
}
`,Q5e=`
varying vec3 vColor;
varying vec2 vUV;

uniform sampler2D uTexture;

void main() {
    gl_FragColor = texture2D(uTexture, vUV) * vec4(vColor, 1.0);
}
`,Y5e={__name:"CurveRopePixi",async setup(s){let e,i;const n=gt(null);let r=null,o=-1,a=null,l=null,h=null;const d=gt([{value:0,label:"1"},{value:1,label:"2"},{value:2,label:"3"}]),f=gt(2),p=gt(["t","",""]),g=gt(""),y=gt(!1);an(y,()=>{I()});const x=gt(30);an(x,()=>{I()});const _=[([e,i]=TS(()=>Bp.load("./img/rope1.png")),e=await e,i(),e),([e,i]=TS(()=>Bp.load("./img/rope2.png")),e=await e,i(),e),([e,i]=TS(()=>Bp.load("./img/rope3.png")),e=await e,i(),e)];function w(){return a.children.map(E=>new si(E.x,E.y))}function O(E){_[f.value];let D=[],L=[],V=[];const F=new Wn(...E),j=F.getLUT(x.value);for(let Q=0;Q<j.length&&Q!=j.length-1;Q++){const ee=j[Q];F.derivative(ee.t);const J=F.normal(ee.t);J.x*=20,J.y*=20;const ue=j[Q+1];F.derivative(ue.t);const oe=F.normal(ue.t);oe.x*=20,oe.y*=20;let pe=[new si(ee.x+J.x,ee.y+J.y),new si(ee.x-J.x,ee.y-J.y),new si(ue.x-oe.x,ue.y-oe.y),new si(ue.x+oe.x,ue.y+oe.y)];D.push(pe[0].x,pe[0].y),D.push(pe[1].x,pe[1].y),D.push(pe[2].x,pe[2].y),D.push(pe[0].x,pe[0].y),D.push(pe[2].x,pe[2].y),D.push(pe[3].x,pe[3].y),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),V.push(0,0),V.push(1,0),V.push(1,1),V.push(0,0),V.push(1,1),V.push(0,1)}return C(D,L,V)}function T(E){_[f.value];let D=[],L=[],V=[];const F=new Wn(...E),j=F.length(),Q=x.value;let ee=F.getLUT(300),J=j/Q,ue=0,oe=0;for(let pe=1;pe<=Q;pe++){let Ue=J*pe;for(let tt=oe+1;tt<ee.length;tt++){let ve=ee[tt-1],Re=ee[tt];const Le=Re.x-ve.x,De=Re.y-ve.y;if(ue+=Math.sqrt(Le*Le+De*De),ue>=Ue||tt==ee.length-1){const Se=ee[oe],Y=F.normal(Se.t);Y.x*=20,Y.y*=20;const W=Re,te=F.normal(W.t);te.x*=20,te.y*=20;let ae=[new si(Se.x+Y.x,Se.y+Y.y),new si(Se.x-Y.x,Se.y-Y.y),new si(W.x-te.x,W.y-te.y),new si(W.x+te.x,W.y+te.y)];oe=tt,D.push(ae[0].x,ae[0].y),D.push(ae[1].x,ae[1].y),D.push(ae[2].x,ae[2].y),D.push(ae[0].x,ae[0].y),D.push(ae[2].x,ae[2].y),D.push(ae[3].x,ae[3].y),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),V.push(0,0),V.push(1,0),V.push(1,1),V.push(0,0),V.push(1,1),V.push(0,1);break}}}return C(D,L,V)}function C(E,D,L){const F={uTexture:_[f.value]},j=new mu().addAttribute("aPosition",E,2).addAttribute("aColor",D,3).addAttribute("aUV",L,2),Q=Jl.from(G5e,Q5e,F);return l=new zI(j,Q),l}function A(E){let D=0;for(let L=0;L<E.length;L++){const V=E[L];D+=V.length()}return D}function B(E){_[f.value];let D=[],L=[],V=[];const F=new Wn(...E),j=F.offset(20),Q=F.offset(-20),ee=[F,j,Q],J=[F.length(),A(j),A(Q)],ue=x.value,oe=[J[0]/ue,J[1]/ue,J[2]/ue],pe=new Map;function Ue(Le,De){let Se=pe.get(Le);if(Se||(Se=Le.getLUT(),pe[Le]=Se),De==0)return Se[0];let Y=0;for(let W=1;W<Se.length;W++){const te=Se[W].x-Se[W-1].x,ae=Se[W].y-Se[W-1].y,z=Math.sqrt(te*te+ae*ae);if(Y+=z,Y>=De||W==Se.length-1)return Se[W]}}function tt(Le,De){const Se=ee[Le],Y=Se.map(z=>z.length());let W=Se.length-1;for(let z=0;z<Y.length-1;z++)if(De<=Y[z]){W=z;break}else De-=Y[z];let te=Se[W];return Ue(te,De)}let ve=tt(1,0),Re=tt(2,0);for(let Le=1;Le<=ue;Le++){let De=Le*oe[1],Se=Le*oe[2];const Y=ve,W=Re,te=tt(1,De),ae=tt(2,Se);let z=[new si(W.x,W.y),new si(Y.x,Y.y),new si(te.x,te.y),new si(ae.x,ae.y)];ve=te,Re=ae,D.push(z[0].x,z[0].y),D.push(z[1].x,z[1].y),D.push(z[2].x,z[2].y),D.push(z[0].x,z[0].y),D.push(z[2].x,z[2].y),D.push(z[3].x,z[3].y),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),L.push(1,1,1),V.push(0,0),V.push(1,0),V.push(1,1),V.push(0,0),V.push(1,1),V.push(0,1)}return C(D,L,V)}function I(){let E=w();if(l&&(r.stage.removeChild(l),l=null),g.value=="t"?l=O(E):g.value==""?l=T(E):g.value==""&&(l=B(E)),l&&(l.eventMode="none",r.stage.addChild(l)),h&&(r.stage.removeChild(h),h=null),h=new Qt,r.stage.addChild(h),h&&y.value){const D=new ki,L=l.geometry.buffers[0].data;for(let V=0;V<L.length/12;V++){const F=V*12,j=[new si(L[F+0],L[F+1]),new si(L[F+2],L[F+3]),new si(L[F+4],L[F+5]),new si(L[F+10],L[F+11])];D.lineStyle(1,11141120),D.moveTo(j[0].x,j[0].y),D.lineTo(j[1].x,j[1].y),D.lineTo(j[2].x,j[2].y),D.lineTo(j[3].x,j[3].y),D.lineTo(j[0].x,j[0].y)}h.addChild(D)}for(let D=0;D<E.length;D++){let L=a.children[D];L.clear(),L.beginFill(44469,1),L.drawCircle(0,0,L.hitArea.radius),L.endFill(),D===o&&(L.lineStyle(3,3751494,1),L.drawCircle(0,0,L.hitArea.radius))}}function R(E){const D=E.data.global;for(let L=0;L<a.children.length;L++){const V=a.children[L];let F=V.toLocal(D);if(F.x*F.x+F.y*F.y<V.hitArea.radius*V.hitArea.radius){o=L;break}}I()}function P(E){o=-1,I()}function k(E){if(o>=0){const{x:D,y:L}=E.data.global;let V=a.toLocal({x:D,y:L});a.children[o].position.set(V.x,V.y),I()}}return an(g,()=>{I()}),an(f,()=>{I()}),io(async()=>{r=new uA({background:"#eeeeee",resizeTo:n.value}),n.value.appendChild(r.view);const E={x:r.screen.width/2,y:r.screen.height/2};r.stage.eventMode="static",r.stage.hitArea=r.screen,r.stage.on("pointerupoutside",P),r.stage.on("pointerdown",R),r.stage.on("pointerup",P),r.stage.on("pointermove",k);{a=new Qt,r.stage.addChild(a);for(let L=0;L<4;L++){let V=new ki;a.addChild(V),V.hitArea=new RD(0,0,30)}let D=a.children.slice(a.children.length-4);D[0].position.set(E.x,E.y+300),D[1].position.set(E.x-300,E.y-100),D[2].position.set(E.x+300,E.y+100),D[3].position.set(E.x,E.y-300),I()}document.addEventListener("keydown",D=>{D.key>=1&&D.key<=9&&_[D.key-1]&&(f.value=D.key-1,I())})}),(E,D)=>{const L=Bn("Option"),V=Bn("Select"),F=Bn("ListItem"),j=Bn("Checkbox"),Q=Bn("InputNumber"),ee=Bn("List"),J=Bn("Col"),ue=Bn("Row");return di(),Ir(ue,null,{default:Zt(()=>[vt(J,{span:4},{default:Zt(()=>[vt(ee,{style:{"padding-left":"20px"}},{default:Zt(()=>[vt(F,null,{default:Zt(()=>[W5e,vt(V,{modelValue:g.value,"onUpdate:modelValue":D[0]||(D[0]=oe=>g.value=oe)},{default:Zt(()=>[(di(!0),hn(Un,null,th(p.value,oe=>(di(),Ir(L,{value:oe,key:oe},{default:Zt(()=>[As(ea(oe),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),vt(F,null,{default:Zt(()=>[H5e,vt(V,{modelValue:f.value,"onUpdate:modelValue":D[1]||(D[1]=oe=>f.value=oe)},{default:Zt(()=>[(di(!0),hn(Un,null,th(d.value,oe=>(di(),Ir(L,{value:oe.value,key:oe.value},{default:Zt(()=>[As(ea(oe.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),vt(F,null,{default:Zt(()=>[vt(j,{modelValue:y.value,"onUpdate:modelValue":D[2]||(D[2]=oe=>y.value=oe)},{default:Zt(()=>[As("")]),_:1},8,["modelValue"])]),_:1}),vt(F,null,{default:Zt(()=>[As("  "),vt(Q,{modelValue:x.value,"onUpdate:modelValue":D[3]||(D[3]=oe=>x.value=oe),min:1,max:100,step:10,"controls-outside":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),vt(J,{span:20},{default:Zt(()=>[Kt("div",{ref_key:"rootRef",ref:n,style:{width:"100%",height:"98vh"}},null,512)]),_:1})]),_:1})}}},tu={BgLayer:0,LooseCube:1,EnermySnake:2,PlayerSnake:3};var iu;let Rs=(iu=class{constructor(){cn(this,"pixi",null);cn(this,"gameContainer",null);cn(this,"uiContainer",null);cn(this,"ticker",null);cn(this,"radius",1920/2);cn(this,"gameState",null);cn(this,"chineseFunnyNames",["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]);cn(this,"rankList",[]);cn(this,"playerRank",{name:"YOU",value:0});cn(this,"layerContainers",[null,null,null,null]);cn(this,"_inited",!1)}randomName(){return this.chineseFunnyNames[Math.floor(Math.random()*this.chineseFunnyNames.length)]}updateRankList(e,i){const n=this.rankList.findIndex(r=>r.name===e);n!==-1?this.rankList[n].value=i:this.rankList.push({name:e,value:i}),this.rankList.sort((r,o)=>o.value-r.value),this.rankList=this.rankList.slice(0,5)}static get instance(){return iu._instance||(iu._instance=new iu),iu._instance}init(e){this._inited||(this.pixi=XD(e),this.ticker=this.pixi.ticker,this.gameContainer=new Qt,this.layerContainers=[new Qt,new Qt,new Qt,new Qt],this.layerContainers.forEach(i=>this.gameContainer.addChild(i)),this.pixi.stage.addChild(this.gameContainer),this.gameContainer.position.set(this.pixi.screen.width/2,this.pixi.screen.height/2),this.uiContainer=new Qt,this.pixi.stage.addChild(this.uiContainer),this.uiContainer.position.set(this.pixi.screen.width/2,this.pixi.screen.height/2),this.ticker.add(this.update,this),this._inited=!0)}update(e){MJ()}get bgCircle(){return this.layerContainers[tu.BgLayer].children[0]}get playerSnake(){return this.layerContainers[tu.PlayerSnake].children[0]}get enemySnakes(){return this.layerContainers[tu.EnermySnake].children}get looseCubes(){return this.layerContainers[tu.LooseCube].children}destroy(){this._inited&&(this.ticker&&this.ticker.stop(),this.pixi&&this.pixi.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.gameContainer=null,this.uiContainer=null,this.layerContainers=[null,null,null,null],this.pixi=null,this.ticker=null,this._inited=!1)}getLayerContainer(e){return this.layerContainers[e]}clearAllGameObjects(){this.layerContainers.slice(1).forEach(e=>{e&&e.removeChildren()})}addGameObject(e,i){this.layerContainers[i]&&(this.layerContainers[i].addChild(e),e.onAdd&&e.onAdd())}removeGameObject(e){this.layerContainers.forEach(i=>{e.parent===i&&(i.removeChild(e),e.onDestroy&&e.onDestroy())})}setObjectLayer(e,i){this.removeGameObject(e),this.addGameObject(e,i)}addUI(e){this.uiContainer&&(this.uiContainer.addChild(e),e.onAdd&&e.onAdd())}removeUI(e){this.uiContainer&&e.parent===this.uiContainer&&(this.uiContainer.removeChild(e),e.onDestroy&&e.onDestroy())}clearUI(){this.uiContainer&&this.uiContainer.removeChildren()}},cn(iu,"_instance"),iu);class j5e extends Qt{constructor(){super(),this.graphics=new ki,this.addChild(this.graphics),this.stars=[]}init(){const e=Rs.instance;this.radius=e.radius,this.lineWidth=5,this.lineColor=13421772,this.graphics.clear(),this.graphics.lineStyle(this.lineWidth,this.lineColor),this.graphics.drawCircle(0,0,this.radius),this.x=0,this.y=0,this._createStars()}_createStars(){for(const o of this.stars)this.removeChild(o);this.stars=[];const e=Rs.instance,i=e.pixi.screen.width,n=e.pixi.screen.height,r=80;for(let o=0;o<r;o++)this._createStar(i,n)}_createStar(e,i){const n=Math.random()*this.radius-this.radius/2,r=Math.random()*this.radius-this.radius/2,o=Math.random()*.4+.4,a=Math.random()*.25+.05,l=rr.from("game2048/star_small.png");l.x=n,l.y=r,l.anchor.set(.5),l.scale.set(o),l.alpha=a,l._baseAlpha=a,l._maxTwinkle=Math.floor(Math.random()*7)+4,l._twinkleCount=0,l._twinkleTime=Math.random()*Math.PI*2,l._twinkleSpeed=Math.random()*.001+1e-4,l._lastSin=Math.sin(l._twinkleTime),l.alpha=l._baseAlpha,this.addChildAt(l,0),this.stars.push(l)}_updateStars(e){const i=Rs.instance,n=i.pixi.screen.width,r=i.pixi.screen.height;for(let o=this.stars.length-1;o>=0;o--){const a=this.stars[o];a._twinkleTime+=a._twinkleSpeed*e;const l=Math.sin(a._twinkleTime);if(a.alpha=a._baseAlpha*Math.abs(l),a._lastSin<0&&l>=0&&(a._twinkleCount++,a._twinkleCount>=a._maxTwinkle)){this.removeChild(a),this.stars.splice(o,1),this._createStar(n,r);continue}a._lastSin=l}}}var Gb=function(e,i,n,r,o){var a=r-e,l=o-i;return a*a+l*l<=n*n},q5e=function(e,i,n,r,o,a){var l=e-r,h=o-i,d=n+a;return l*l+h*h<=d*d},uE=function(e,i,n,r,o,a,l){var h=[o-e,a-i],d=[n-e,r-i],f=u2(d,d),p=u2(h,d),g=p/f;g=g<0?0:g,g=g>1?1:g;var y=[d[0]*g+e-o,d[1]*g+i-a],x=u2(y,y);return x<=l*l};function u2(s,e){return s[0]*e[0]+s[1]*e[1]}var Z5e=uE,K5e=function(e,i,n,r,o,a,l){return Z5e(r,o,a,l,e,i,n)},K3=function(e,i,n,r,o,a,l){var h=n/2,d=r/2,f=Math.abs(o-(e+n/2)),p=Math.abs(a-(i+r/2));if(f>h+l||p>d+l)return!1;if(f<=h||p<=d)return!0;var g=f-h,y=p-d;return g*g+y*y<=l*l},J5e=K3,e6e=function(e,i,n,r,o,a,l){return J5e(r,o,a,l,e,i,n)};function d2(s,e,i,n){return Math.sqrt(Math.pow(s-i,2)+Math.pow(e-n,2))}var J3=function(e,i,n,r,o,a,l){return l=l||1,Math.abs(d2(e,i,n,r)-(d2(e,i,o,a)+d2(n,r,o,a)))<=l};const t6e=J3;var Qb=function(e,i,n,r){var o=e.length,a=!1,l,h;for(l=0,h=o-2;l<o;l+=2)e[l+1]>n!=e[h+1]>n&&i<(e[h]-e[l])*(n-e[l+1])/(e[h+1]-e[l+1])+e[l]&&(a=!a),h=l;if(a)return!0;for(l=0;l<o;l+=2){var d=e[l],f=e[l+1],p,g;if(l===o-2?(p=e[0],g=e[1]):(p=e[l+2],g=e[l+3]),t6e(d,f,p,g,i,n,r))return!0}return!1},i6e=Qb,HW=uE,PJ=function(e,i,n,r,o){if(i6e(e,i,n,o))return!0;for(var a=e.length,l=0;l<a-2;l+=2)if(HW(e[l],e[l+1],e[l+2],e[l+3],i,n,r))return!0;return HW(e[0],e[1],e[a-2],e[a-1],i,n,r)},n6e=PJ,s6e=function(e,i,n,r,o){return n6e(r,e,i,n,o)},IJ=10,kT,PT,eN;function BJ(){kT=[],PT=[];for(var s=0;s<=IJ;s++){var e=4<<s;kT[s]=.5/Math.cos(4*Math.acos(0)/e),PT[s]=.5/(Math.cos(2*Math.acos(0)/e)*Math.cos(2*Math.acos(0)/e))}eN=!0}function RJ(s,e,i,n,r,o,a){for(var l=1;l<=IJ;l++){var h=(i+r)*kT[l],d=(n+o)*kT[l],f=s-h,p=e-d;if(f*f+p*p<=a)return!0;var g=r-h,y=o-d;if(f*g+p*y>=0&&f*g+p*y<=g*g+y*y&&(p*g-f*y>=0||a*(g*g+y*y)>=(p*g-f*y)*(p*g-f*y)))return!0;var x=i-h,_=n-d;if(f*x+p*_>=0&&f*x+p*_<=x*x+_*_&&(p*x-f*_<=0||a*(x*x+_*_)>=(p*x-f*_)*(p*x-f*_)))return!0;var w=(i+h)*PT[l],O=(n+d)*PT[l];if((w-s)*(w-s)+(O-e)*(O-e)<a){r=h,o=d;continue}var T=h-w+h,C=d-O+d;if((T-s)*(T-s)+(C-e)*(C-e)<a){i=h,n=d;continue}var A=w-h,B=O-d;if(p*A-f*B<=0||a*(A*A+B*B)>(p*A-f*B)*(p*A-f*B)){if(f*A+p*B>0){if(Math.abs(f*A+p*B)<=A*A+B*B||(s-w)*(i-w)+(e-O)*(n-O)>=0){r=h,o=d;continue}}else if(-(f*A+p*B)<=A*A+B*B||(s-T)*(r-T)+(e-C)*(o-C)>=0){i=h,n=d;continue}}return!1}return!1}function r6e(s,e,i,n,r,o,a,l){eN||BJ();var h=Math.abs(r-s)*l,d=Math.abs(o-e)*a;i*=l,n*=a;var f=a*l;return h*h+(n-d)*(n-d)<=f*f||(i-h)*(i-h)+d*d<=f*f||h*n+d*i<=i*n||(h*n+d*i-i*n)*(h*n+d*i-i*n)<=f*f*(i*i+n*n)&&h*i-d*n>=-n*n&&h*i-d*n<=i*i?!0:(h-i)*(h-i)+(d-n)*(d-n)<=f*f||h<=i&&d-f<=n||d<=n&&h-f<=i?RJ(h,d,i,0,0,n,f*f):!1}function o6e(s,e,i,n,r,o,a){eN||BJ();var l=Math.abs(r-s),h=Math.abs(o-e);return l*l+(n-h)*(n-h)<=a*a||(i-l)*(i-l)+h*h<=a*a||l*n+h*i<=i*n||(l*n+h*i-i*n)*(l*n+h*i-i*n)<=a*a*(i*i+n*n)&&l*i-h*n>=-n*n&&l*i-h*n<=i*i?!0:(l-i)*(l-i)+(h-n)*(h-n)<=a*a||l<=i&&h-a<=n||h<=n&&l-a<=i?RJ(l,h,i,0,0,n,a*a):!1}var DJ={ellipseCircle:o6e,ellipseEllipse:r6e},a6e=DJ,LJ=function(e,i,n,r,o,a,l){return a6e.ellipseCircle(e,i,n,r,o,a,l)},l6e=LJ,c6e=function(e,i,n,r,o,a,l){return l6e(r,o,a,l,e,i,n)},md=Gb,h6e=K3,NJ=function(e,i,n,r,o,a,l,h){h=h||1;var d=0;if(d+=md(e,i,n,r,o)?1:0,d+=md(e,i,n,r+a,o)?1:0,d+=md(e,i,n,r,o+l)?1:0,d+=md(e,i,n,r+a,o+l)?1:0,d===0)return h6e(r,o,a,l,e,i,n);if(d>=1&&d<=3)return!0;if(d===4)return!md(e,i,n-h,r,o)||!md(e,i,n-h,r+a,o)||!md(e,i,n-h,r,o+l)||!md(e,i,n-h,r+a,o+l)},u6e=uE,GW=Gb,VJ=function(e,i,n,r,o,a,l,h){return h=h||1,u6e(r,o,a,l,e,i,n)&&!(GW(e,i,n-h,r,o)&&GW(e,i,n-h,a,l))},QW=Gb,$J=function(e,i,n,r,o,a){return a=a||1,QW(e,i,n,r,o)&&!QW(e,i,n-a,r,o)},UJ=function(e,i,n,r,o,a,l,h){var d=n-e,f=r-i,p=l-o,g=h-a,y=(-f*(e-o)+d*(i-a))/(-p*f+d*g),x=(p*(i-a)-g*(e-o))/(-p*f+d*g);return y>=0&&y<=1&&x>=0&&x<=1},d6e=Qb,f6e=UJ,tN=function(e,i,n,r,o,a){var l=o.length;if(d6e(o,e,i,a))return!0;for(var h=0;h<l;h+=2){var d=(h+2)%l;if(f6e(e,i,n,r,o[h],o[h+1],o[d],o[d+1]))return!0}return!1},p6e=tN,m6e=function(e,i,n,r,o,a){return p6e(i,n,r,o,e,a)},iN=function(e,i){for(var n=e,r=i,o=[n,r],a,l,h,d,f,p,g=0;g<o.length;g++)for(var y=o[g],x=0;x<y.length;x+=2){var _=(x+2)%y.length,w={x:y[_+1]-y[x+1],y:y[x]-y[_]};for(a=l=null,p=0;p<n.length;p+=2)h=w.x*n[p]+w.y*n[p+1],(a===null||h<a)&&(a=h),(l===null||h>l)&&(l=h);for(d=f=null,p=0;p<r.length;p+=2)h=w.x*r[p]+w.y*r[p+1],(d===null||h<d)&&(d=h),(f===null||h>f)&&(f=h);if(l<d||f<a)return!1}return!0},g6e=iN,FJ=function(e,i,n,r,o){var a=[i,n,i+r,n,i+r,n+o,i,n+o];return g6e(e,a)},nN=function(e,i,n,r,o,a,l,h){o-=e,l-=e,a-=i,h-=i;var d=Math.pow(l-o,2)/n/n+Math.pow(h-a,2)/r/r,f=2*o*(l-o)/n/n+2*a*(h-a)/r/r,p=o*o/n/n+a*a/r/r-1,g=f*f-4*d*p;if(g===0){var y=-f/2/d;return y>=0&&y<=1}else if(g>0){var x=Math.sqrt(g),_=(-f+x)/2/d,w=(-f-x)/2/d;return _>=0&&_<=1||w>=0&&w<=1}else return!1},y6e=nN,zJ=function(e,i,n,r,o,a,l,h){return y6e(o,a,l,h,e,i,n,r)},v6e=Qb,YW=zJ,XJ=function(e,i,n,r,o){if(v6e(e,i,n))return!0;for(var a=e.length,l=0;l<a-2;l+=2)if(YW(e[l],e[l+1],e[l+2],e[l+3],i,n,r,o))return!0;return YW(e[0],e[1],e[a-2],e[a-1],i,n,r,o)},dE=function(e,i,n,r,o,a){return o>=e&&o<=e+n&&a>=i&&a<=i+r},x6e=function(e,i,n,r,o,a,l,h){return e<o+l&&e+n>o&&i<a+h&&i+r>a},_6e=function(e,i,n,r,o){const a=Math.atan2(r-i,n-e)-Math.PI/2,l=o/2,h=Math.cos(a)*l,d=Math.sin(a)*l;return[e-h,i-d,n-h,r-d,n+h,r+d,e+h,i+d]};const YO=_6e,b6e=iN,jW=tN,w6e=UJ;var WJ=function(e,i,n,r,o,a,l,h,d,f){return d||f?O6e(e,i,n,r,o,a,l,h,d,f):w6e(e,i,n,r,o,a,l,h)};function O6e(s,e,i,n,r,o,a,l,h,d){if(h&&d)return b6e(YO(s,e,i,n,h),YO(r,o,a,l,d));if(h)return jW(r,o,a,l,YO(s,e,i,n,h));if(d)return jW(s,e,i,n,YO(r,o,a,l,h))}var qW=dE,jO=WJ,HJ=function(e,i,n,r,o,a,l,h){return qW(o,a,l,h,e,i)||qW(o,a,l,h,n,r)?!0:jO(e,i,n,r,o,a,o+l,a)||jO(e,i,n,r,o+l,a,o+l,a+h)||jO(e,i,n,r,o,a+h,o+l,a+h)||jO(e,i,n,r,o,a,o,a+h)},S6e=HJ,C6e=function(e,i,n,r,o,a,l,h){return S6e(o,a,l,h,e,i,n,r)},T6e=FJ,A6e=function(e,i,n,r,o){return T6e(o,e,i,n,r)},qO=nN,E6e=dE,GJ=function(e,i,n,r,o,a,l,h){return E6e(o,a,l,h,e,i)||qO(e,i,n,r,o,a,o+l,a)||qO(e,i,n,r,o,a+h,o+l,a+h)||qO(e,i,n,r,o,a,o,a+h)||qO(e,i,n,r,o+l,a,o+l,a+h)},M6e=GJ,k6e=function(e,i,n,r,o,a,l,h){return M6e(o,a,l,h,e,i,n,r)},P6e=NJ,I6e=function(e,i,n,r,o,a,l,h){return P6e(o,a,l,e,i,n,r,h)},B6e=dE,R6e=function(e,i,n,r,o,a){return B6e(n,r,o,a,e,i)},D6e=Qb,L6e=function(e,i,n,r){return D6e(n,e,i,r)},N6e=Gb,V6e=function(e,i,n,r,o){return N6e(n,r,o,e,i)},$6e=J3,U6e=function(e,i,n,r,o,a){return $6e(n,r,o,a,e,i)},QJ=function(e,i,n,r,o,a){var l=Math.pow(o-e,2)/(n*n),h=Math.pow(a-i,2)/(r*r);return l+h<=1},F6e=QJ,z6e=function(e,i,n,r,o,a){return F6e(n,r,o,a,e,i)},X6e=$J,W6e=function(e,i,n,r,o,a){return X6e(e,i,n,r,o,a)},H6e=VJ,G6e=function(e,i,n,r,o,a,l,h){return H6e(o,a,l,e,i,n,r,h)},Q6e=DJ,Y6e=function(e,i,n,r,o,a,l,h){return Q6e.ellipseEllipse(e,i,n,r,o,a,l,h)},j6e=XJ,q6e=function(e,i,n,r,o){return j6e(o,e,i,n,r)},Z6e={circlePoint:Gb,circleCircle:q5e,circleLine:K5e,circleBox:e6e,circlePolygon:s6e,circleEllipse:c6e,circleOutlineBox:NJ,circleOutlineLine:VJ,circleOutlinePoint:$J,polygonPoint:Qb,polygonLine:m6e,polygonPolygon:iN,polygonBox:FJ,polygonCircle:PJ,polygonEllipse:XJ,boxPoint:dE,boxBox:x6e,boxLine:C6e,boxPolygon:A6e,boxCircle:K3,boxEllipse:k6e,boxCircleOutline:I6e,pointBox:R6e,pointPolygon:L6e,pointCircle:V6e,pointLine:U6e,pointEllipse:z6e,pointCircleOutline:W6e,lineLine:WJ,lineBox:HJ,linePolygon:tN,lineCircle:uE,linePoint:J3,lineEllipse:zJ,lineCircleOutline:G6e,ellipsePoint:QJ,ellipseLine:nN,ellipseBox:GJ,ellipseCircle:LJ,ellipseEllipse:Y6e,ellipsePolygon:q6e};const zl=class zl extends Qt{static getColorByValue(e){const i=Math.max(0,Math.min(zl.COLOR_LIST.length-1,Math.log2(e)-1));return zl.COLOR_LIST[i]}static getLightColorByValue(e,i=.5){const n=zl.getColorByValue(e),r=n>>16&255,o=n>>8&255,a=n&255,l=Math.round(r+(255-r)*i),h=Math.round(o+(255-o)*i),d=Math.round(a+(255-a)*i);return l<<16|h<<8|d}constructor(e,i=0,n=0){super(),this.currentValue=e,this.speedRatio=1,this.snake=null,this.x=i,this.y=n,this.debugMode=!1,this.debugGraphics=null,this.selfAnchorX=1;const r=Wi.from("game2048/ship_E.png");r?this.shipSprite=new rr(r):(console.error("Ship_E texture not found. Make sure it is loaded."),this.shipSprite=new ki().beginFill(16711680).drawRect(-15,-15,30,30).endFill()),this.shipSprite.anchor.set(this.selfAnchorX,.5),this.addChild(this.shipSprite),this.shipSprite.tint=zl.getLightColorByValue(this.currentValue),this.valueText=new Xi(this.currentValue.toString(),{fontFamily:"Arial Black, Arial, Montserrat, Impact, sans-serif",fontSize:28,fontWeight:"bold",fill:zl.getColorByValue(this.currentValue),align:"center",stroke:2236962,strokeThickness:6,dropShadow:!0,dropShadowColor:0,dropShadowBlur:4,dropShadowDistance:0}),this.valueText.anchor.set(.5),this.shipSprite.addChild(this.valueText),this.updateScaleByValue(this.currentValue),this.setValue(this.currentValue),this.rotation=0,this.setSnake(null)}setSnake(e){this.snake=e,e?(this.shipSprite.tint=zl.getLightColorByValue(this.currentValue),this.valueText.style.fill=zl.getColorByValue(this.currentValue)):(this.shipSprite.tint=13421772,this.valueText.style.fill=13421772)}updateScaleByValue(e){let i=1;e>=2&&(i=1+.1*(Math.log2(e)-1)),this.shipSprite.scale.set(i)}setValue(e){this.currentValue=e,this.valueText.text=e.toString();const i=zl.getColorByValue(e);this.valueText.style.fill=i,this.updateScaleByValue(e),this.valueText.x=-25}getRealCenter(){return{x:(.5-this.selfAnchorX)*this.shipSprite.width,y:0}}get value(){return this.currentValue}getSize(){return this.shipSprite.width}getCollision(){const e=this.getSize(),{x:i,y:n}=this.getRealCenter(),r=this.toGlobal(new si(i,n));return{centerX:r.x,centerY:r.y,radius:e/2}}updateDebugGraphics(){this.debugGraphics||(this.debugGraphics=new ki,this.addChild(this.debugGraphics)),this.debugGraphics.clear();const e=this.getCollision(),i=this.toLocal(new si(e.centerX,e.centerY)),n=e.radius/this.shipSprite.scale.x;this.debugGraphics.lineStyle(2,16711680),this.debugGraphics.drawCircle(i.x,i.y,n),this.debugGraphics.beginFill(65280),this.debugGraphics.drawCircle(i.x,i.y,5),this.debugGraphics.endFill(),this.debugGraphics.beginFill(0),this.debugGraphics.drawCircle(0,0,5),this.debugGraphics.endFill()}clearDebugGraphics(){this.debugGraphics&&this.debugGraphics.clear()}toggleDebug(){this.debugMode=!this.debugMode,this.debugMode?this.updateDebugGraphics():this.clearDebugGraphics()}};cn(zl,"COLOR_LIST",[13421772,10079487,6737049,16764006,16750950,16737894,13395711,6724095,3394764,6750105,16777062,16777215]);let IT=zl;function f2(s,e){const i=Math.PI*2,n=(e-s)%i;return 2*n%i-n}function Vg(s){return s=s%(Math.PI*2),s>Math.PI&&(s-=Math.PI*2),s<-Math.PI&&(s+=Math.PI*2),s}class YJ extends Qt{constructor(){super(),this.cubes=[],this.setBaseSpeed(3),this.speedRatio=1,this.pendingMerge=null,this.targetDirectionX=1,this.targetDirectionY=0,this.debugMode=!1,this.debugGraphics=null}setBaseSpeed(e){this.baseSpeed=e}onAdd(){Rs.instance.ticker.add(this.update,this)}onDestroy(){Rs.instance.ticker.remove(this.update,this)}get head(){return this.cubes[0]}setPosition(e,i){this.head.x=e,this.head.y=i}computeIdealCubePose(e,i){const n=i.getSize(),o=(e.getSize()+n)/4,a=e.x-Math.cos(e.rotation)*o,l=e.y-Math.sin(e.rotation)*o;a-e.x,l-e.y;let h=e.rotation;return{x:a,y:l,rotation:h}}setName(e){this.name=e,this.updateName()}updateName(){this.head&&(this.nameTxt||(this.nameTxt=new Xi(this.name||"",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:20,fill:16777062,stroke:2236962,strokeThickness:5,align:"center"}),this.nameTxt.anchor.set(.5,1),this.head.addChild(this.nameTxt),this.nameTxt.x=0,this.nameTxt.y=0,this.nameTxt.rotation=Math.PI/2,this.nameTxt.visible=!!this.name),this.nameTxt.text=this.name||"")}addCubes(e){e.forEach(i=>{this.addCube(i)})}addCube(e){let i=0,n=0,r=0,o=this.cubes.length;for(;o>0&&this.cubes[o-1].currentValue<e;)o--;const a=new IT(e,0,0);if(this.cubes.length>0){let l=o>0?this.cubes[o-1]:null,h=this.cubes[o]||null;if(l){const d=this.computeIdealCubePose(l,a);i=d.x,n=d.y,r=d.rotation}else h&&(i=h.x+Math.cos(h.rotation)*((h.getSize()+a.getSize())/4),n=h.y+Math.sin(h.rotation)*((h.getSize()+a.getSize())/4),r=h.rotation+Math.PI)}return a.x=i,a.y=n,a.rotation=r,a.setSnake(this),this.cubes.splice(o,0,a),this.addChild(a),this.updateCubeZOrder(),this.onHeadValueChanged(),this.updateName(),a}onHeadValueChanged(){}update(e){if(this.updateNormalMovement(e),this.pendingMerge)this.updateMergeAnimation(e);else if(this.mergeCooldown&&this.mergeCooldown>0){const i=e&&e.deltaMS?e.deltaMS:16;this.mergeCooldown-=i,this.mergeCooldown<0&&(this.mergeCooldown=0)}else this.mergeCubesIfPossible()}updateHeadDirectionStrategy(e){}get finalSpeed(){return this.baseSpeed*this.speedRatio}setHeadDirection(e,i){const n=Math.sqrt(e*e+i*i);n>1e-5?(this.targetDirectionX=e/n,this.targetDirectionY=i/n):(this.targetDirectionX=1,this.targetDirectionY=0)}updateHeadMovement(e){const i=this.head;(typeof this.targetDirectionX!="number"||typeof this.targetDirectionY!="number")&&(this.targetDirectionX=1,this.targetDirectionY=0);const n=Math.atan2(this.targetDirectionY,this.targetDirectionX),r=Vg(i.rotation),o=f2(r,n),a=.1;if(i.rotation+=o*a*e,i.rotation=Vg(i.rotation),i.x+=Math.cos(i.rotation)*this.finalSpeed*e,i.y+=Math.sin(i.rotation)*this.finalSpeed*e,this.gameApp&&typeof this.gameApp.radius=="number"){const l=this.gameApp.radius;if(Math.sqrt(i.x*i.x+i.y*i.y)>l){const d=Math.atan2(i.y,i.x);i.x=Math.cos(d)*l,i.y=Math.sin(d)*l}}}updateNormalMovement(e){const i=e&&e.deltaTime?e.deltaTime:1;this.updateHeadDirectionStrategy(e),this.updateHeadMovement(i);let n=-1;this.pendingMerge&&this.pendingMerge.cubeB&&(n=this.cubes.indexOf(this.pendingMerge.cubeB)),this.updateSnakeLogic(i,n)}mergeCubesIfPossible(){if(!this.pendingMerge&&!(this.cubes.length<2))for(let e=0;e<this.cubes.length-1;e++){const i=this.cubes[e],n=this.cubes[e+1];if(i.currentValue===n.currentValue){this.pendingMerge={i:e,cubeA:i,cubeB:n,animTime:0,phase:1,hasMerged:!1};break}}}triggerMergeAnimation(e,i){i.speedRatio=2}updateMergeAnimation(e){const i=this.pendingMerge;if(!i||!i.cubeA||!i.cubeB){this.pendingMerge=null;return}const n=200,r=e&&e.deltaMS?e.deltaMS:16;i.animTime+=r,i._startX===void 0&&(i._startX=i.cubeB.x,i._startY=i.cubeB.y);const o=Math.min(i.animTime/n,1);if(i.cubeB.x=i._startX+(i.cubeA.x-i._startX)*o,i.cubeB.y=i._startY+(i.cubeA.y-i._startY)*o,i.cubeB.alpha=1-o,o>=1){i.cubeB&&i.cubeB.parent&&this.removeChild(i.cubeB);const a=this.cubes.indexOf(i.cubeB);a!==-1&&this.cubes.splice(a,1),i.cubeA.setValue(i.cubeA.currentValue*2),this.cubes.indexOf(i.cubeA)===0&&this.onHeadValueChanged(),this.pendingMerge=null,this.mergeCooldown=200}}updateSnakeLogic(e,i=-1){if(!(this.cubes.length<2)){this.debugMode&&this.debugGraphics.clear();for(let n=1;n<this.cubes.length;n++){if(n===i)continue;const r=this.cubes[n],o=this.cubes[n-1],l=o.getSize()*.7,h=o.x-Math.cos(o.rotation)*l,d=o.y-Math.sin(o.rotation)*l;this.debugMode&&(this.drawTargetPoint(h,d,16711680),this.drawLine(r.x,r.y,h,d,65280),this.drawLine(o.x,o.y,h,d,255));const f=this.finalSpeed*r.speedRatio*3;{const p=h-r.x,g=d-r.y,y=Math.sqrt(p*p+g*g);if(y>3){const x=Math.min(f*e,y);r.x+=p/y*x,r.y+=g/y*x;const _=Math.atan2(g,p),T=f2(Vg(r.rotation),_)*.1,C=Vg(r.rotation+T);r.rotation=C}else{r.x=h,r.y=d;const x=o.rotation,O=f2(Vg(r.rotation),x)*.1,T=Vg(r.rotation+O);r.rotation=T}}}}}updateCubeZOrder(){for(let e=0;e<this.cubes.length;e++)this.setChildIndex(this.cubes[e],this.cubes.length-1-e)}splitAt(e){const i=Rs.instance,n=this.cubes.splice(e);for(const r of n)r.setSnake(null),i.addGameObject(r,tu.LooseCube);e===0&&i.removeGameObject(this)}toggleDebug(){this.debugMode=!this.debugMode,this.debugMode?this.initDebugGraphics():this.clearDebugGraphics()}initDebugGraphics(){this.debugGraphics||(this.debugGraphics=new ki,this.addChild(this.debugGraphics))}clearDebugGraphics(){this.debugGraphics&&this.debugGraphics.clear()}drawTargetPoint(e,i,n=16711680){!this.debugMode||!this.debugGraphics||(this.debugGraphics.beginFill(n),this.debugGraphics.drawCircle(e,i,5),this.debugGraphics.endFill())}drawLine(e,i,n,r,o=65280){!this.debugMode||!this.debugGraphics||(this.debugGraphics.lineStyle(2,o),this.debugGraphics.moveTo(e,i),this.debugGraphics.lineTo(n,r))}}class K6e extends YJ{constructor(){super(),this.gameApp=Rs.instance,this.speedRatio=1,this.targetDirectionX=0,this.targetDirectionY=0,this.lastMouseX=-1,this.lastMouseY=-1,this.setName("YOU"),this.isMousePressed=!1}onAdd(){super.onAdd()}onDestroy(){super.onDestroy()}handleMouseDown(e){e.button===0&&(this.isMousePressed=!0,this.speedRatio=3)}handleMouseUp(e){e.button===0&&(this.isMousePressed=!1,this.speedRatio=1)}updateHeadDirectionStrategy(){const e=this.head,i=this.gameApp.pixi.renderer.events.pointer.global,n=this.gameApp.gameContainer.toLocal(i),r=this.gameApp.gameContainer.toLocal(e.getGlobalPosition(new si,!1)),o=1;if(Math.abs(n.x-this.lastMouseX)>o||Math.abs(n.y-this.lastMouseY)>o||this.lastMouseX===-1){const a=n.x-r.x,l=n.y-r.y,h=Math.sqrt(a*a+l*l);h>.01&&this.setHeadDirection(a/h,l/h),this.lastMouseX=n.x,this.lastMouseY=n.y}}onHeadValueChanged(){Rs.instance.playerRank.value=this.head.value}}class J6e extends YJ{constructor(){super(),this.state="wander",this.stateTimer=0,this.stateInterval=8e3,this.wanderTarget={x:0,y:0},this.setRandomWanderTarget(),this.setName(Rs.instance.randomName())}get playerSnakeInstance(){return Rs.instance.playerSnake}setRandomWanderTarget(){const n=Rs.instance.radius-30,r=Math.random()*Math.PI*2,o=Math.random()*n;this.wanderTarget.x=Math.cos(r)*o,this.wanderTarget.y=Math.sin(r)*o}onHeadValueChanged(){Rs.instance.updateRankList(this.name,this.head.value)}updateHeadDirectionStrategy(e){var n,r;if(this.stateTimer+=(e==null?void 0:e.deltaMS)||16,this.stateTimer>=this.stateInterval){this.stateTimer=0;const o=(n=this.playerSnakeInstance)==null?void 0:n.head;this.state==="wander"?o&&this.head.value>o.value?this.state="chase":(this.state="wander",this.setRandomWanderTarget()):(this.state="wander",this.setRandomWanderTarget())}const i=(r=this.playerSnakeInstance)==null?void 0:r.head;if(this.state==="chase"&&i&&this.head.value>i.value)this.setHeadDirection(i.x-this.head.x,i.y-this.head.y);else{this.setHeadDirection(this.wanderTarget.x-this.head.x,this.wanderTarget.y-this.head.y);const o=this.wanderTarget.x-this.head.x,a=this.wanderTarget.y-this.head.y;Math.sqrt(o*o+a*a)<30&&this.setRandomWanderTarget()}}}function ZW(){const s=Rs.instance,e=[s.playerSnake,...s.enemySnakes];for(const i of e){if(!i||!i.head)continue;const n=i.head,r=eXe(i);for(const o of r){const a=n.getCollision(),l=o.getCollision();if(Z6e.circleCircle(a.centerX,a.centerY,a.radius,l.centerX,l.centerY,l.radius)){if(o.snake){const d=o.snake,f=d?d.cubes.indexOf(o):-1;d&&f!==-1&&(n.currentValue>o.currentValue?d.splitAt(f):n.currentValue<o.currentValue?i.splitAt(0):i===s.playerSnake?d.splitAt(f):i.splitAt(0))}else if(n.currentValue>=o.currentValue){i.addCube(o.currentValue),s.removeGameObject(o);break}break}}}}function eXe(s){const e=Rs.instance,i=[];for(const n of e.looseCubes)i.push(n);for(const n of e.enemySnakes)if(n!==s)for(let r=0;r<n.cubes.length;r++)i.push(n.cubes[r]);return i}function jJ(s){return new Promise(e=>{s.scale.set(0),new ob(s.scale).to({x:1,y:1},280).easing(eh.Back.Out).onComplete(()=>e()).start()})}function qJ(s){return new Promise(e=>{new ob(s.scale).to({x:0,y:0},180).easing(eh.Back.In).onComplete(()=>e()).start()})}function tXe(s){return new Promise(e=>{s.scale.set(1),new ob(s.scale).to({x:1.2,y:1.2},50).easing(eh.Back.Out).chain(new ob(s.scale).to({x:1,y:1},50).easing(eh.Bounce.Out).onComplete(()=>e())).start()})}class iXe extends Qt{constructor({onRestart:e=null}={}){super(),this.eventMode="static",this.onRestart=e,this.rankList=Rs.instance.rankList,this.root=new Qt,this.root.scale.set(.5),this.addChild(this.root),this.createMask(),this.createCard(),this.createTitle(),this.createRankList(),this.createRestartButton(),this.setupAnimations()}createMask(){const e=new ki;e.beginFill(0,.6);const i=Rs.instance.pixi.screen.width,n=Rs.instance.pixi.screen.height;e.drawRect(-i/2,-n/2,i,n),e.endFill(),this.root.addChild(e)}createCard(){const e=this.rankList.length,i=520,n=120,r=64,o=64,a=108,l=56,h=e>0?e*r:r,d=64,f=o+a+32+l+32+h+d+n+o,p=Math.max(i,f),g=840,y=new ki;y.beginFill(16777215,.98),y.drawRoundedRect(-g/2,-p/2,g,p,64),y.endFill(),y.x=0,y.y=0,this.root.addChild(y),this.content=new Qt,this.content.x=0,this.content.y=-p/2,this.root.addChild(this.content),this.cardHeight=p,this.cardInnerPadding=o,this.titleHeight=a,this.rankTitleHeight=l,this.rowHeight=r,this.btnHeightVal=n,this.rankToBtnGap=d}createTitle(){const e=new Xi("GAME OVER",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:96,fill:2236962,align:"center"});e.anchor.set(.5,0),e.x=0,e.y=this.cardInnerPadding,this.content.addChild(e);const i=new Xi("",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:48,fill:6710886,align:"center"});i.anchor.set(.5,0),i.x=0,i.y=e.y+this.titleHeight+32,this.content.addChild(i),this.rankTitle=i}createRankList(){let e=this.rankList.slice();const i=Rs.instance.playerRank;!e.some(l=>l.name===i.name)&&i.value>0&&e.push({name:i.name,value:i.value}),e.sort((l,h)=>h.value-l.value);const r=-180,o=0,a=180;e.forEach((l,h)=>{const d=l.name===i.name,f=new Xi(`${h+1}`,{fontFamily:"Arial Black, Arial, sans-serif",fontSize:44,fill:d?16737792:3355443,align:"center"});f.anchor.set(.5,0),f.x=r,f.y=this.rankTitle.y+this.rankTitleHeight+32+h*this.rowHeight,this.content.addChild(f);const p=new Xi(l.name,{fontFamily:"Arial Black, Arial, sans-serif",fontSize:44,fill:d?16737792:3355443,align:"center"});p.anchor.set(.5,0),p.x=o,p.y=this.rankTitle.y+this.rankTitleHeight+32+h*this.rowHeight,this.content.addChild(p);const g=new Xi(`${l.value}`,{fontFamily:"Arial Black, Arial, sans-serif",fontSize:44,fill:d?16737792:3355443,align:"center"});g.anchor.set(.5,0),g.x=a,g.y=this.rankTitle.y+this.rankTitleHeight+32+h*this.rowHeight,this.content.addChild(g)})}createRestartButton(){const i=this.rankList.length>0?this.rankList.length*this.rowHeight:this.rowHeight,n=this.rankTitle.y+this.rankTitleHeight+32+i+this.rankToBtnGap,r=new ki;r.beginFill(2985200,1),r.drawRoundedRect(-360/2,-this.btnHeightVal/2,360,this.btnHeightVal,36),r.endFill(),r.x=0,r.y=n+this.btnHeightVal/2,this.content.addChild(r);const o=new Xi("",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:56,fill:16777215,align:"center"});o.anchor.set(.5),o.x=0,o.y=0,r.addChild(o),zC(r,async()=>{await qJ(this),typeof this.onRestart=="function"&&this.onRestart(),this.removeFromParent()})}setupAnimations(){jJ(this)}}class nXe extends Qt{constructor({onStart:e=null}={}){super(),this.eventMode="static",this.onStart=e,this.counter=2,this.maxCounter=128,this.root=new Qt,this.root.scale.set(.5),this.addChild(this.root),this.createCard(),this.createTitle(),this.createCounterButton(),this.createStartButton(),jJ(this)}createCard(){const n=new ki;n.beginFill(16185078,.98),n.drawRoundedRect(-800/2,-800/2,800,800,32),n.endFill(),n.x=0,n.y=0,this.root.addChild(n),this.cardHeight=800}createTitle(){const e=new Xi("2048 ",{fontFamily:"Arial",fontSize:120,fontWeight:"bold",fill:16777215,align:"center",dropShadow:!0,dropShadowColor:"#333",dropShadowBlur:8,dropShadowDistance:4});e.anchor.set(.5,0),e.x=0,e.y=-this.cardHeight/2+60,this.root.addChild(e)}createCounterButton(){const n=new ki;n.beginFill(16769126,1),n.drawRoundedRect(-240/2,-100/2,240,100,24),n.endFill(),n.x=-80,n.y=0,n.eventMode="static",n.cursor="pointer",n.hitArea=new Pi(-240/2-20,-100/2-20,280,140),this.root.addChild(n);const r=new Xi("",{fontFamily:"Arial",fontSize:40,fill:3355443,fontWeight:"bold",align:"center"});r.anchor.set(.5,.5),r.x=0,r.y=0,n.addChild(r),this.counterText=new Xi(this.counter.toString(),{fontFamily:"Arial",fontSize:48,fill:16769126,fontWeight:"bold",align:"center",dropShadow:!0,dropShadowColor:"#000",dropShadowBlur:6,dropShadowDistance:2}),this.counterText.anchor.set(.5,.5),this.counterText.x=n.x+240/2+40,this.counterText.y=n.y,this.root.addChild(this.counterText),zC(n,()=>{this.counter<this.maxCounter&&(this.counter*=2,this.counterText.text=this.counter.toString(),tXe(this.counterText))})}createStartButton(){const n=new ki;n.beginFill(16735838,1),n.drawRoundedRect(-420/2,0,420,120,40),n.endFill(),n.x=0,n.y=this.cardHeight/2-120-60,n.eventMode="static",n.cursor="pointer",this.root.addChild(n);const r=new Xi("",{fontFamily:"Arial",fontSize:64,fill:16777215,fontWeight:"bold",align:"center"});r.anchor.set(.5,.5),r.x=0,r.y=120/2,n.addChild(r),zC(n,async()=>{await qJ(this),this.removeFromParent(),this.onStart&&this.onStart(this.counter)})}}class sXe extends Qt{constructor(){super(),this.progress=0,this.isActive=!1,this.timer=null,this.playerSnake=null,this.initUI(),this.init(),this.checkPlayerSnake()}init(){this.startTimer()}initUI(){this.labelText=new Xi("",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:32,fill:16777215,stroke:0,strokeThickness:4,align:"left"}),this.labelText.anchor.set(0,.5),this.labelText.x=0,this.labelText.y=0,this.addChild(this.labelText),this.progressBarBg=new ki,this.progressBarBg.beginFill(3355443),this.progressBarBg.drawRoundedRect(0,0,300,30,15),this.progressBarBg.endFill(),this.progressBarBg.x=this.labelText.width+15,this.progressBarBg.y=-15,this.addChild(this.progressBarBg),this.progressBarFill=new ki,this.progressBarFill.beginFill(65280),this.progressBarFill.drawRoundedRect(0,0,0,30,15),this.progressBarFill.endFill(),this.progressBarFill.x=this.labelText.width+15,this.progressBarFill.y=-15,this.addChild(this.progressBarFill),this.progressBarBorder=new ki,this.progressBarBorder.lineStyle(3,16777215),this.progressBarBorder.drawRoundedRect(0,0,300,30,15),this.progressBarBorder.x=this.labelText.width+15,this.progressBarBorder.y=-15,this.addChild(this.progressBarBorder)}updateProgressBar(){this.progressBarFill.clear(),this.isActive?(this.progressBarFill.beginFill(65280),this.labelText.text=""):(this.progressBarFill.beginFill(35071),this.labelText.text="");const e=this.progress/100*300;this.progressBarFill.drawRoundedRect(0,0,e,30,15),this.progressBarFill.endFill(),this.updateProgressBarPosition()}updateProgressBarPosition(){const e=this.labelText.width+15;this.progressBarBg.x=e,this.progressBarFill.x=e,this.progressBarBorder.x=e}getSize(){return{width:(this.labelText?this.labelText.width:0)+15+300,height:30}}checkPlayerSnake(){const e=setInterval(()=>{const i=Rs.instance;i&&i.playerSnake&&i.playerSnake!==this.playerSnake&&(this.playerSnake=i.playerSnake)},1e3);this.checkInterval=e}startTimer(){this.timer=setInterval(()=>{const e=Rs.instance;!e||e.gameState!=="playing"||(this.isActive?(this.progress-=2,this.updateProgressBar(),this.progress<=0&&this.deactivateSpeedBoost()):(this.progress+=1,this.updateProgressBar(),this.progress>=100&&this.activateSpeedBoost()))},100)}activateSpeedBoost(){this.isActive=!0,this.progress=100,this.playerSnake&&(this.playerSnake.speedRatio=2),this.updateProgressBar()}deactivateSpeedBoost(){this.playerSnake&&(this.playerSnake.speedRatio=1),this.isActive=!1,this.progress=0,this.updateProgressBar()}destroy(){this.timer&&(clearInterval(this.timer),this.timer=null),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),super.destroy()}}const rXe={class:"game-container"},oXe={__name:"Game2048",setup(s){const e=gt(null),i=Rs.instance;let n=[],r=null;const o=["game2048/star_small.png","game2048/ship_E.png"],a=async A=>{console.log(""),mA(e.value,{designWidth:540,designHeight:960,isFullScreen:!0}),i.init(e.value),_(),l("init")};ra(()=>{p(),i.destroy()});function l(A,B=2){i.gameState!==A&&(i.gameState=A,A==="init"?h():A==="playing"?f(B):A==="fail"&&setTimeout(y,500))}function h(){i.addUI(new nXe({onStart:d}))}function d(A){l("playing",A)}function f(A=2){p(),w(A),T(),n.push(setInterval(T,5e3)),O(),n.push(setInterval(O,5e3)),r=new sXe,r.x=-r.getSize().width/2,r.y=i.pixi.screen.height/2-100,i.addUI(r),i.pixi.ticker.add(ZW),i.pixi.ticker.add(g),i.pixi.ticker.add(x),window.addEventListener("keydown",C)}function p(){window.removeEventListener("keydown",C);for(const A of n)clearInterval(A);n=[],r&&(r.destroy(),r=null),i.pixi.ticker.remove(ZW),i.pixi.ticker.remove(g),i.pixi.ticker.remove(x),i.clearAllGameObjects(),i.clearUI()}function g(){(!i.playerSnake||!i.playerSnake.cubes||i.playerSnake.cubes.length===0)&&l("fail")}function y(){i.addUI(new iXe({onRestart:()=>{p(),l("init")}}))}function x(A){if(i.playerSnake&&i.playerSnake.head){const B=i.playerSnake.head,I=i.gameContainer,R=i.pixi.screen.width/2,P=i.pixi.screen.height/2,k=B.x,E=B.y;I.position.set(R-k,P-E)}}function _(){const A=new j5e;A.init(),i.addGameObject(A,tu.BgLayer)}function w(A=2){i.playerSnake&&(i.gameContainer.removeChild(i.playerSnake),typeof i.playerSnake.destroy=="function"&&i.playerSnake.destroy());const B=new K6e;B.addCube(A),i.addGameObject(B,tu.PlayerSnake)}function O(){var B,I,R,P,k,E;if(i.enemySnakes.length<5){const L=(((I=(B=i.playerSnake)==null?void 0:B.head)==null?void 0:I.value)||2)*2,V=new J6e;V.addCubes([L]);let F=((P=(R=i.playerSnake)==null?void 0:R.head)==null?void 0:P.x)||0,j=((E=(k=i.playerSnake)==null?void 0:k.head)==null?void 0:E.y)||0,Q=0,ee=0;const J=i.radius*.6;for(let ue=0;ue<10;ue++){Q=Math.random()*(i.radius*2)-i.radius,ee=Math.random()*(i.radius*2)-i.radius;const oe=Q-F,pe=ee-j;if(Math.sqrt(oe*oe+pe*pe)>=J)break}V.setPosition(Q,ee),i.addGameObject(V,tu.EnermySnake)}}function T(){for(;i.looseCubes.length<10;){const B=Math.random()<.8?2:4,I=new IT(B),R=i.radius*.5,P=Math.sqrt(Math.random()*(i.radius*i.radius-R*R)+R*R),k=Math.random()*Math.PI*2;I.x=Math.cos(k)*P,I.y=Math.sin(k)*P,I.rotation=Math.random()*Math.PI*2,i.addGameObject(I,tu.LooseCube)}}function C(A){if(A.key==="f"){i.playerSnake.addCube(2);return}}return(A,B)=>(di(),hn("div",rXe,[Kt("canvas",{ref_key:"pixiContainer",ref:e},null,512),vt(zD,{textureUrls:o,onLoaded:a})]))}};var HR={exports:{}};const aXe=eQ(nye);(function(s,e){(function(i,n){n(e,aXe)})(ou,function(i,n){const r=typeof window<"u",o=function(){return r&&document.addEventListener?function(c,u,m,S=!1){c&&u&&m&&c.addEventListener(u,m,S)}:function(c,u,m){c&&u&&m&&c.attachEvent("on"+u,m)}}(),a=function(){return r&&document.removeEventListener?function(c,u,m,S=!1){c&&u&&c.removeEventListener(u,m,S)}:function(c,u,m){c&&u&&c.detachEvent("on"+u,m)}}();var l=(c,u)=>{const m=c.__vccOpts||c;for(const[S,b]of u)m[S]=b;return m};const h="ivu-affix";function d(c,u){const m=u?"pageYOffset":"pageXOffset",S=u?"scrollTop":"scrollLeft";let b=c[m];return r&&typeof b!="number"&&(b=window.document.documentElement[S]),b}function f(c){if(!r)return;const u=c.getBoundingClientRect(),m=d(window,!0),S=d(window),b=window.document.body,v=b.clientTop||0,M=b.clientLeft||0;return{top:u.top+m-v,left:u.left+S-M}}const p={name:"Affix",emits:["on-change"],props:{offsetTop:{type:Number,default:0},offsetBottom:{type:Number},useCapture:{type:Boolean,default:!1}},data(){return{affix:!1,styles:{},slot:!1,slotStyle:{}}},computed:{offsetType(){let c="top";return this.offsetBottom>=0&&(c="bottom"),c},classes(){return[{[`${h}`]:this.affix}]}},mounted(){o(window,"scroll",this.handleScroll,this.useCapture),o(window,"resize",this.handleScroll,this.useCapture),n.nextTick(()=>{this.handleScroll()})},beforeUnmount(){a(window,"scroll",this.handleScroll,this.useCapture),a(window,"resize",this.handleScroll,this.useCapture)},methods:{handleScroll(){if(!r)return;const c=this.affix,u=d(window,!0),m=f(this.$el),S=window.innerHeight,b=this.$el.getElementsByTagName("div")[0].offsetHeight;m.top-this.offsetTop<u&&this.offsetType=="top"&&!c?(this.affix=!0,this.slotStyle={width:this.$refs.point.clientWidth+"px",height:this.$refs.point.clientHeight+"px"},this.slot=!0,this.styles={top:`${this.offsetTop}px`,left:`${m.left}px`,width:`${this.$el.offsetWidth}px`},this.$emit("on-change",!0)):m.top-this.offsetTop>u&&this.offsetType=="top"&&c&&(this.slot=!1,this.slotStyle={},this.affix=!1,this.styles=null,this.$emit("on-change",!1)),m.top+this.offsetBottom+b>u+S&&this.offsetType=="bottom"&&!c?(this.affix=!0,this.styles={bottom:`${this.offsetBottom}px`,left:`${m.left}px`,width:`${this.$el.offsetWidth}px`},this.$emit("on-change",!0)):m.top+this.offsetBottom+b<u+S&&this.offsetType=="bottom"&&c&&(this.affix=!1,this.styles=null,this.$emit("on-change",!1))}}};function g(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",null,[n.createElementVNode("div",{ref:"point",class:n.normalizeClass(v.classes),style:n.normalizeStyle(b.styles)},[n.renderSlot(c.$slots,"default")],6),n.withDirectives(n.createElementVNode("div",{style:n.normalizeStyle(b.slotStyle)},null,4),[[n.vShow,b.slot]])])}var y=l(p,[["render",g]]);const x="ivu-icon",_={name:"Icon",props:{type:{type:String,default:""},size:[Number,String],color:String,custom:{type:String,default:""}},computed:{classes(){return[`${x}`,{[`${x}-${this.type}`]:this.type!=="",[`${this.custom}`]:this.custom!==""}]},styles(){let c={};return this.size&&(c["font-size"]=`${this.size}px`),this.color&&(c.color=this.color),c}}};function w(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("i",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.styles)},null,6)}var O=l(_,[["render",w]]);function T(c,u){for(let m=0;m<u.length;m++)if(c===u[m])return!0;return!1}let C;function A(c){if(r&&C===void 0){const u=document.createElement("div");u.style.width="100%",u.style.height="200px";const m=document.createElement("div"),S=m.style;S.position="absolute",S.top=0,S.left=0,S.pointerEvents="none",S.visibility="hidden",S.width="200px",S.height="150px",S.overflow="hidden",m.appendChild(u),document.body.appendChild(m);const b=u.offsetWidth;m.style.overflow="scroll";let v=u.offsetWidth;b===v&&(v=m.clientWidth),document.body.removeChild(m),C=b-v}return C}const B=r&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)||!1,I=/([\:\-\_]+(.))/g,R=/^moz([A-Z])/;function P(c){return c.replace(I,function(u,m,S,b){return b?S.toUpperCase():S}).replace(R,"Moz$1")}function k(c,u){if(r){if(!c||!u)return null;u=P(u),u==="float"&&(u="cssFloat");try{const m=document.defaultView.getComputedStyle(c,"");return c.style[u]||m?m[u]:null}catch{return c.style[u]}}}function E(c){return c.toString()[0].toUpperCase()+c.toString().slice(1)}function D(c){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(c)]}function L(c){const u=D(c);let m;if(u==="array")m=[];else if(u==="object")m={};else return c;if(u==="array")for(let S=0;S<c.length;S++)m.push(L(c[S]));else if(u==="object")for(let S in c)m[S]=L(c[S]);return m}function V(c,u=0,m,S=500,b){if(!r)return;window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(X){return window.setTimeout(X,1e3/60)});const v=Math.abs(u-m),M=Math.ceil(v/S*50);function N(X,U,H){if(X===U){b&&b();return}let re=X+H>U?U:X+H;X>U&&(re=X-H<U?U:X-H),c===window?window.scrollTo(re,re):c.scrollTop=re,window.requestAnimationFrame(()=>N(re,U,H))}N(u,m,M)}function F(c,u,m){typeof u=="string"?m=[u]:m=u;let S=c.$parent,b=S.$options.name;for(;S&&(!b||m.indexOf(b)<0);)S=S.$parent,S&&(b=S.$options.name);return S}function j(c,u){let m=[];const S=c.$parent;return S?(S.$options.name===u&&m.push(S),m.concat(j(S,u))):[]}const Q=function(c){return(c||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")};function ee(c,u){if(!c||!u)return!1;if(u.indexOf(" ")!==-1)throw new Error("className should not contain space.");return c.classList?c.classList.contains(u):(" "+c.className+" ").indexOf(" "+u+" ")>-1}function J(c,u){if(!c)return;let m=c.className;const S=(u||"").split(" ");for(let b=0,v=S.length;b<v;b++){const M=S[b];!M||(c.classList?c.classList.add(M):ee(c,M)||(m+=" "+M))}c.classList||(c.className=m)}function ue(c,u){if(!c||!u)return;const m=u.split(" ");let S=" "+c.className+" ";for(let b=0,v=m.length;b<v;b++){const M=m[b];!M||(c.classList?c.classList.remove(M):ee(c,M)&&(S=S.replace(" "+M+" "," ")))}c.classList||(c.className=Q(S))}const oe={xs:"480px",sm:"576px",md:"768px",lg:"992px",xl:"1200px",xxl:"1600px"};function pe(){if(!r)return;const c=u=>({media:u,matches:!1,on(){},off(){}});window.matchMedia=window.matchMedia||c}const Ue=/#([^#]+)$/;async function tt(c,u="unnamed"){if(!r)return Promise.reject();try{const m=await(await fetch(c)).blob();if(!m)return Promise.reject();const S=URL.createObjectURL(m),b=document.createElement("a");return b.setAttribute("href",S),b.setAttribute("download",u),b.click(),URL.revokeObjectURL(S),Promise.resolve()}catch(m){return Promise.reject(m)}}const ve="ivu-alert",Re={name:"Alert",components:{Icon:O},props:{type:{validator(c){return T(c,["success","info","warning","error"])},default:"info"},closable:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!1},banner:{type:Boolean,default:!1},fade:{type:Boolean,default:!0}},data(){return{closed:!1,desc:!1}},computed:{wrapClasses(){return[`${ve}`,`${ve}-${this.type}`,{[`${ve}-with-icon`]:this.showIcon,[`${ve}-with-desc`]:this.desc,[`${ve}-with-banner`]:this.banner}]},messageClasses(){return`${ve}-message`},descClasses(){return`${ve}-desc`},closeClasses(){return`${ve}-close`},iconClasses(){return`${ve}-icon`},iconType(){let c="";switch(this.type){case"success":c="ios-checkmark-circle";break;case"info":c="ios-information-circle";break;case"warning":c="ios-alert";break;case"error":c="ios-close-circle";break}return this.desc&&(c+="-outline"),c}},methods:{close(c){this.closed=!0,this.$emit("on-close",c)}},mounted(){this.desc=this.$slots.desc!==void 0}};function Le(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createBlock(n.Transition,{name:m.fade?"fade":""},{default:n.withCtx(()=>[b.closed?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.wrapClasses)},[m.showIcon?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(v.iconClasses)},[n.renderSlot(c.$slots,"icon",{},()=>[n.createVNode(M,{type:v.iconType},null,8,["type"])])],2)):n.createCommentVNode("",!0),n.createElementVNode("span",{class:n.normalizeClass(v.messageClasses)},[n.renderSlot(c.$slots,"default")],2),n.createElementVNode("span",{class:n.normalizeClass(v.descClasses)},[n.renderSlot(c.$slots,"desc")],2),m.closable?(n.openBlock(),n.createElementBlock("a",{key:1,class:n.normalizeClass(v.closeClasses),onClick:u[0]||(u[0]=(...N)=>v.close&&v.close(...N))},[n.renderSlot(c.$slots,"close",{},()=>[n.createVNode(M,{type:"ios-close"})])],2)):n.createCommentVNode("",!0)],2))]),_:3},8,["name"])}var De=l(Re,[["render",Le]]);const Se={name:"Anchor",provide(){return{AnchorInstance:this}},emits:["on-change","on-select"],props:{affix:{type:Boolean,default:!0},offsetTop:{type:Number,default:0},offsetBottom:Number,bounds:{type:Number,default:5},container:null,showInk:{type:Boolean,default:!1},scrollOffset:{type:Number,default:0}},data(){return{prefix:"ivu-anchor",isAffixed:!1,inkTop:0,animating:!1,currentLink:"",currentId:"",scrollContainer:null,scrollElement:null,wrapperTop:0,upperFirstTitle:!0,links:[]}},computed:{wrapperComponent(){return this.affix?"Affix":"div"},wrapperStyle(){return{maxHeight:this.offsetTop?`calc(100vh - ${this.offsetTop}px)`:"100vh"}},containerIsWindow(){return this.scrollContainer===window},titlesOffsetArr(){const c=this.links.map(m=>m.link.href).map(m=>m.split("#")[1]);let u=[];return r&&c.forEach(m=>{const S=document.getElementById(m);S&&u.push({link:`#${m}`,offset:S.offsetTop-this.scrollElement.offsetTop})}),u}},methods:{handleAffixStateChange(c){this.isAffixed=this.affix&&c},handleScroll(c){if(this.upperFirstTitle=!!this.titlesOffsetArr[0]&&c.target.scrollTop<this.titlesOffsetArr[0].offset,this.animating)return;const u=r?document.documentElement.scrollTop||document.body.scrollTop||c.target.scrollTop:0;this.getCurrentScrollAtTitleId(u)},handleHashChange(){if(!r)return;const c=window.location.href,u=Ue.exec(c);!u||(this.currentLink=u[0],this.currentId=u[1])},handleScrollTo(){if(!r)return;const c=document.getElementById(this.currentId),u=document.querySelector(`a[data-href="${this.currentLink}"]`);let m=this.scrollOffset;if(u&&(m=parseFloat(u.getAttribute("data-scroll-offset"))),!c)return;const S=c.offsetTop-this.wrapperTop-m;this.animating=!0,V(this.scrollContainer,this.scrollElement.scrollTop,S,600,()=>{this.animating=!1}),this.handleSetInkTop()},handleSetInkTop(){if(!r)return;const c=document.querySelector(`a[data-href="${this.currentLink}"]`);if(!c)return;const u=c.offsetTop,m=u<0?this.offsetTop:u;this.inkTop=m},getCurrentScrollAtTitleId(c){let u=-1,m=this.titlesOffsetArr.length,S={link:"#",offset:0};for(c+=this.bounds;++u<m;){let b=this.titlesOffsetArr[u],v=this.titlesOffsetArr[u+1];if(c>=b.offset&&c<(v&&v.offset||1/0)){S=this.titlesOffsetArr[u];break}}this.currentLink=S.link,this.handleSetInkTop()},getContainer(){!r||(this.scrollContainer=this.container?typeof this.container=="string"?document.querySelector(this.container):this.container:window,this.scrollElement=this.container?this.scrollContainer:document.documentElement||document.body)},removeListener(){a(this.scrollContainer,"scroll",this.handleScroll),a(window,"hashchange",this.handleHashChange)},init(){this.handleHashChange(),n.nextTick(()=>{this.removeListener(),this.getContainer(),this.wrapperTop=this.containerIsWindow?0:this.scrollElement.offsetTop,this.handleScrollTo(),this.handleSetInkTop(),this.titlesOffsetArr[0]&&(this.upperFirstTitle=this.scrollElement.scrollTop<this.titlesOffsetArr[0].offset),o(this.scrollContainer,"scroll",this.handleScroll),o(window,"hashchange",this.handleHashChange)})},addLink(c,u){this.links.push({id:c,link:u})},removeLink(c){const u=this.links.findIndex(m=>m.id===c);this.links.splice(u,1)}},watch:{$route(){this.currentLink="",this.currentId="",this.handleHashChange(),n.nextTick(()=>{this.handleScrollTo()})},container(){this.init()},currentLink(c,u){this.$emit("on-change",c,u)}},mounted(){this.init()},beforeUnmount(){this.removeListener()}};function Y(c,u,m,S,b,v){return n.openBlock(),n.createBlock(n.resolveDynamicComponent(v.wrapperComponent),{"offset-top":m.offsetTop,"offset-bottom":m.offsetBottom,onOnChange:v.handleAffixStateChange},{default:n.withCtx(()=>[n.createElementVNode("div",{class:n.normalizeClass(`${b.prefix}-wrapper`),style:n.normalizeStyle(v.wrapperStyle)},[n.createElementVNode("div",{class:n.normalizeClass(`${b.prefix}`)},[n.createElementVNode("div",{class:n.normalizeClass(`${b.prefix}-ink`)},[n.withDirectives(n.createElementVNode("span",{class:n.normalizeClass(`${b.prefix}-ink-ball`),style:n.normalizeStyle({top:`${b.inkTop}px`})},null,6),[[n.vShow,m.showInk]])],2),n.renderSlot(c.$slots,"default")],2)],6)]),_:3},40,["offset-top","offset-bottom","onOnChange"])}var W=l(Se,[["render",Y]]);function te(c=32){const u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",m=u.length;let S="";for(let b=0;b<c;b++)S+=u.charAt(Math.floor(Math.random()*m));return S}const ae={name:"AnchorLink",inject:["AnchorInstance"],props:{href:String,title:String,scrollOffset:{type:Number,default(){return n.inject("AnchorInstance").scrollOffset}}},data(){return{prefix:"ivu-anchor-link",id:te(6)}},computed:{anchorLinkClasses(){return[this.prefix,this.AnchorInstance.currentLink===this.href?`${this.prefix}-active`:""]},linkTitleClasses(){return[`${this.prefix}-title`]}},methods:{goAnchor(){this.currentLink=this.href,this.AnchorInstance.handleHashChange(),this.AnchorInstance.handleScrollTo(),this.AnchorInstance.$emit("on-select",this.href),this.$router?this.$router.push(this.href,()=>{}):r&&(window.location.href=this.href)}},mounted(){this.AnchorInstance.addLink(this.id,this),n.nextTick(()=>{this.AnchorInstance.init()})},beforeUnmount(){this.AnchorInstance.removeLink(this.id)}},z=["href","data-scroll-offset","data-href","title"];function q(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.anchorLinkClasses)},[n.createElementVNode("a",{class:n.normalizeClass(v.linkTitleClasses),href:m.href,"data-scroll-offset":m.scrollOffset,"data-href":m.href,onClick:u[0]||(u[0]=n.withModifiers((...M)=>v.goAnchor&&v.goAnchor(...M),["prevent"])),title:m.title},n.toDisplayString(m.title),11,z),n.renderSlot(c.$slots,"default")],2)}var le=l(ae,[["render",q]]),he={props:{to:{type:[Object,String]},replace:{type:Boolean,default:!1},target:{type:String,validator(c){return T(c,["_blank","_self","_parent","_top"])},default:"_self"},append:{type:Boolean,required:!1,default:!1}},computed:{linkUrl(){if(typeof this.to!="string")return null;if(this.to.includes("//"))return this.to;const c=this.$router;if(c){const u=this.$route,m=c.resolve(this.to,u,this.append);return m?m.href:this.to}return this.to}},methods:{handleOpenTo(){if(!r)return;const c=this.$router;let u=this.to;if(c){const m=this.$route,S=c.resolve(this.to,m,this.append);u=S?S.href:this.to}typeof this.to!="string"&&window.open(u)},handleClick(c=!1){const u=this.$router;!r||(c?this.handleOpenTo():u?typeof this.to=="string"&&this.to.includes("//")?window.location.href=this.to:this.replace?this.$router.replace(this.to,()=>{}):this.$router.push(this.to,()=>{}):window.location.href=this.to)},handleCheckClick(c,u=!1){if(this.to){if(this.target==="_blank")return this.handleOpenTo(),!1;c.preventDefault(),this.handleClick(u)}}}};function be(c,u){let m=!1;return u.forEach(S=>{c.includes(S)&&(m=!0)}),m}const Ee={name:"Auth",mixins:[he],emits:["click"],props:{authority:{type:[String,Array,Function,Boolean],default:!0},access:{type:[String,Array]},prevent:{type:Boolean,default:!1},message:{type:String,default:""},customTip:{type:Boolean,default:!1},display:{type:String}},computed:{isPermission(){let c;if(typeof this.authority=="boolean")c=this.authority;else if(this.authority instanceof Function)c=this.authority();else{const u=typeof this.authority=="string"?[this.authority]:this.authority,m=typeof this.access=="string"?[this.access]:this.access;c=be(u,m)}return c},options(){let c={};return this.display&&(c.display=this.display),{class:{"ivu-auth":!0,"ivu-auth-permission":this.isPermission,"ivu-auth-no-math":!this.isPermission,"ivu-auth-redirect":!this.isPermission&&this.to,"ivu-auth-prevent":this.prevent},style:c}}},render(){return this.isPermission?n.h("div",this.options,this.$slots.default()):this.to?n.h("div",this.options):this.prevent?n.h("div",Object.assign({},this.options,{onClick:this.handlePreventClick}),[n.h("div",{class:"ivu-auth-prevent-no-match"},this.$slots.default())]):n.h("div",this.options,this.$slots.noMatch())},methods:{handlePreventClick(c){this.isPermission||(this.customTip||this.$Message.info({content:this.message,duration:3}),this.$emit("click",c))}},created(){!this.isPermission&&this.to&&this.handleClick(!1)}};var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ou<"u"?ou:typeof self<"u"?self:{};function G(c){throw new Error('Could not dynamically require "'+c+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ce={exports:{}};/**!
* @fileOverview Kickass library to create and place poppers near their reference elements.
* @version 1.16.1
* @license
* Copyright (c) 2016 Federico Zivolo and contributors
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/(function(c,u){(function(m,S){c.exports=S()})(Z,function(){var m=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",S=function(){for(var K=["Edge","Trident","Firefox"],ge=0;ge<K.length;ge+=1)if(m&&navigator.userAgent.indexOf(K[ge])>=0)return 1;return 0}();function b(K){var ge=!1;return function(){ge||(ge=!0,window.Promise.resolve().then(function(){ge=!1,K()}))}}function v(K){var ge=!1;return function(){ge||(ge=!0,setTimeout(function(){ge=!1,K()},S))}}var M=m&&window.Promise,N=M?b:v;function X(K){var ge={};return K&&ge.toString.call(K)==="[object Function]"}function U(K,ge){if(K.nodeType!==1)return[];var we=K.ownerDocument.defaultView,Me=we.getComputedStyle(K,null);return ge?Me[ge]:Me}function H(K){return K.nodeName==="HTML"?K:K.parentNode||K.host}function re(K){if(!K)return document.body;switch(K.nodeName){case"HTML":case"BODY":return K.ownerDocument.body;case"#document":return K.body}var ge=U(K),we=ge.overflow,Me=ge.overflowX,Je=ge.overflowY;return/(auto|scroll|overlay)/.test(we+Je+Me)?K:re(H(K))}function xe(K){return K&&K.referenceNode?K.referenceNode:K}var ye=m&&!!(window.MSInputMethodContext&&document.documentMode),me=m&&/MSIE 10/.test(navigator.userAgent);function ne(K){return K===11?ye:K===10?me:ye||me}function Te(K){if(!K)return document.documentElement;for(var ge=ne(10)?document.body:null,we=K.offsetParent||null;we===ge&&K.nextElementSibling;)we=(K=K.nextElementSibling).offsetParent;var Me=we&&we.nodeName;return!Me||Me==="BODY"||Me==="HTML"?K?K.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(we.nodeName)!==-1&&U(we,"position")==="static"?Te(we):we}function Xt(K){var ge=K.nodeName;return ge==="BODY"?!1:ge==="HTML"||Te(K.firstElementChild)===K}function _t(K){return K.parentNode!==null?_t(K.parentNode):K}function At(K,ge){if(!K||!K.nodeType||!ge||!ge.nodeType)return document.documentElement;var we=K.compareDocumentPosition(ge)&Node.DOCUMENT_POSITION_FOLLOWING,Me=we?K:ge,Je=we?ge:K,Ze=document.createRange();Ze.setStart(Me,0),Ze.setEnd(Je,0);var nt=Ze.commonAncestorContainer;if(K!==nt&&ge!==nt||Me.contains(Je))return Xt(nt)?nt:Te(nt);var lt=_t(K);return lt.host?At(lt.host,ge):At(K,_t(ge).host)}function He(K){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",we=ge==="top"?"scrollTop":"scrollLeft",Me=K.nodeName;if(Me==="BODY"||Me==="HTML"){var Je=K.ownerDocument.documentElement,Ze=K.ownerDocument.scrollingElement||Je;return Ze[we]}return K[we]}function ke(K,ge){var we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Me=He(ge,"top"),Je=He(ge,"left"),Ze=we?-1:1;return K.top+=Me*Ze,K.bottom+=Me*Ze,K.left+=Je*Ze,K.right+=Je*Ze,K}function it(K,ge){var we=ge==="x"?"Left":"Top",Me=we==="Left"?"Right":"Bottom";return parseFloat(K["border"+we+"Width"])+parseFloat(K["border"+Me+"Width"])}function qe(K,ge,we,Me){return Math.max(ge["offset"+K],ge["scroll"+K],we["client"+K],we["offset"+K],we["scroll"+K],ne(10)?parseInt(we["offset"+K])+parseInt(Me["margin"+(K==="Height"?"Top":"Left")])+parseInt(Me["margin"+(K==="Height"?"Bottom":"Right")]):0)}function Jt(K){var ge=K.body,we=K.documentElement,Me=ne(10)&&getComputedStyle(we);return{height:qe("Height",ge,we,Me),width:qe("Width",ge,we,Me)}}var ei=function(K,ge){if(!(K instanceof ge))throw new TypeError("Cannot call a class as a function")},Rt=function(){function K(ge,we){for(var Me=0;Me<we.length;Me++){var Je=we[Me];Je.enumerable=Je.enumerable||!1,Je.configurable=!0,"value"in Je&&(Je.writable=!0),Object.defineProperty(ge,Je.key,Je)}}return function(ge,we,Me){return we&&K(ge.prototype,we),Me&&K(ge,Me),ge}}(),Et=function(K,ge,we){return ge in K?Object.defineProperty(K,ge,{value:we,enumerable:!0,configurable:!0,writable:!0}):K[ge]=we,K},Nt=Object.assign||function(K){for(var ge=1;ge<arguments.length;ge++){var we=arguments[ge];for(var Me in we)Object.prototype.hasOwnProperty.call(we,Me)&&(K[Me]=we[Me])}return K};function ai(K){return Nt({},K,{right:K.left+K.width,bottom:K.top+K.height})}function Dt(K){var ge={};try{if(ne(10)){ge=K.getBoundingClientRect();var we=He(K,"top"),Me=He(K,"left");ge.top+=we,ge.left+=Me,ge.bottom+=we,ge.right+=Me}else ge=K.getBoundingClientRect()}catch{}var Je={left:ge.left,top:ge.top,width:ge.right-ge.left,height:ge.bottom-ge.top},Ze=K.nodeName==="HTML"?Jt(K.ownerDocument):{},nt=Ze.width||K.clientWidth||Je.width,lt=Ze.height||K.clientHeight||Je.height,St=K.offsetWidth-nt,ii=K.offsetHeight-lt;if(St||ii){var ci=U(K);St-=it(ci,"x"),ii-=it(ci,"y"),Je.width-=St,Je.height-=ii}return ai(Je)}function bt(K,ge){var we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Me=ne(10),Je=ge.nodeName==="HTML",Ze=Dt(K),nt=Dt(ge),lt=re(K),St=U(ge),ii=parseFloat(St.borderTopWidth),ci=parseFloat(St.borderLeftWidth);we&&Je&&(nt.top=Math.max(nt.top,0),nt.left=Math.max(nt.left,0));var Yt=ai({top:Ze.top-nt.top-ii,left:Ze.left-nt.left-ci,width:Ze.width,height:Ze.height});if(Yt.marginTop=0,Yt.marginLeft=0,!Me&&Je){var hi=parseFloat(St.marginTop),Ki=parseFloat(St.marginLeft);Yt.top-=ii-hi,Yt.bottom-=ii-hi,Yt.left-=ci-Ki,Yt.right-=ci-Ki,Yt.marginTop=hi,Yt.marginLeft=Ki}return(Me&&!we?ge.contains(lt):ge===lt&&lt.nodeName!=="BODY")&&(Yt=ke(Yt,ge)),Yt}function ut(K){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,we=K.ownerDocument.documentElement,Me=bt(K,we),Je=Math.max(we.clientWidth,window.innerWidth||0),Ze=Math.max(we.clientHeight,window.innerHeight||0),nt=ge?0:He(we),lt=ge?0:He(we,"left"),St={top:nt-Me.top+Me.marginTop,left:lt-Me.left+Me.marginLeft,width:Je,height:Ze};return ai(St)}function Vt(K){var ge=K.nodeName;if(ge==="BODY"||ge==="HTML")return!1;if(U(K,"position")==="fixed")return!0;var we=H(K);return we?Vt(we):!1}function Ct(K){if(!K||!K.parentElement||ne())return document.documentElement;for(var ge=K.parentElement;ge&&U(ge,"transform")==="none";)ge=ge.parentElement;return ge||document.documentElement}function vi(K,ge,we,Me){var Je=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,Ze={top:0,left:0},nt=Je?Ct(K):At(K,xe(ge));if(Me==="viewport")Ze=ut(nt,Je);else{var lt=void 0;Me==="scrollParent"?(lt=re(H(ge)),lt.nodeName==="BODY"&&(lt=K.ownerDocument.documentElement)):Me==="window"?lt=K.ownerDocument.documentElement:lt=Me;var St=bt(lt,nt,Je);if(lt.nodeName==="HTML"&&!Vt(nt)){var ii=Jt(K.ownerDocument),ci=ii.height,Yt=ii.width;Ze.top+=St.top-St.marginTop,Ze.bottom=ci+St.top,Ze.left+=St.left-St.marginLeft,Ze.right=Yt+St.left}else Ze=St}we=we||0;var hi=typeof we=="number";return Ze.left+=hi?we:we.left||0,Ze.top+=hi?we:we.top||0,Ze.right-=hi?we:we.right||0,Ze.bottom-=hi?we:we.bottom||0,Ze}function Ci(K){var ge=K.width,we=K.height;return ge*we}function _n(K,ge,we,Me,Je){var Ze=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(K.indexOf("auto")===-1)return K;var nt=vi(we,Me,Ze,Je),lt={top:{width:nt.width,height:ge.top-nt.top},right:{width:nt.right-ge.right,height:nt.height},bottom:{width:nt.width,height:nt.bottom-ge.bottom},left:{width:ge.left-nt.left,height:nt.height}},St=Object.keys(lt).map(function(hi){return Nt({key:hi},lt[hi],{area:Ci(lt[hi])})}).sort(function(hi,Ki){return Ki.area-hi.area}),ii=St.filter(function(hi){var Ki=hi.width,Ji=hi.height;return Ki>=we.clientWidth&&Ji>=we.clientHeight}),ci=ii.length>0?ii[0].key:St[0].key,Yt=K.split("-")[1];return ci+(Yt?"-"+Yt:"")}function Nn(K,ge,we){var Me=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,Je=Me?Ct(ge):At(ge,xe(we));return bt(we,Je,Me)}function ss(K){var ge=K.ownerDocument.defaultView,we=ge.getComputedStyle(K),Me=parseFloat(we.marginTop||0)+parseFloat(we.marginBottom||0),Je=parseFloat(we.marginLeft||0)+parseFloat(we.marginRight||0),Ze={width:K.offsetWidth+Je,height:K.offsetHeight+Me};return Ze}function fs(K){var ge={left:"right",right:"left",bottom:"top",top:"bottom"};return K.replace(/left|right|bottom|top/g,function(we){return ge[we]})}function Cr(K,ge,we){we=we.split("-")[0];var Me=ss(K),Je={width:Me.width,height:Me.height},Ze=["right","left"].indexOf(we)!==-1,nt=Ze?"top":"left",lt=Ze?"left":"top",St=Ze?"height":"width",ii=Ze?"width":"height";return Je[nt]=ge[nt]+ge[St]/2-Me[St]/2,we===lt?Je[lt]=ge[lt]-Me[ii]:Je[lt]=ge[fs(lt)],Je}function Io(K,ge){return Array.prototype.find?K.find(ge):K.filter(ge)[0]}function Sl(K,ge,we){if(Array.prototype.findIndex)return K.findIndex(function(Je){return Je[ge]===we});var Me=Io(K,function(Je){return Je[ge]===we});return K.indexOf(Me)}function Cl(K,ge,we){var Me=we===void 0?K:K.slice(0,Sl(K,"name",we));return Me.forEach(function(Je){Je.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var Ze=Je.function||Je.fn;Je.enabled&&X(Ze)&&(ge.offsets.popper=ai(ge.offsets.popper),ge.offsets.reference=ai(ge.offsets.reference),ge=Ze(ge,Je))}),ge}function It(){if(!this.state.isDestroyed){var K={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};K.offsets.reference=Nn(this.state,this.popper,this.reference,this.options.positionFixed),K.placement=_n(this.options.placement,K.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),K.originalPlacement=K.placement,K.positionFixed=this.options.positionFixed,K.offsets.popper=Cr(this.popper,K.offsets.reference,K.placement),K.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",K=Cl(this.modifiers,K),this.state.isCreated?this.options.onUpdate(K):(this.state.isCreated=!0,this.options.onCreate(K))}}function gi(K,ge){return K.some(function(we){var Me=we.name,Je=we.enabled;return Je&&Me===ge})}function Zi(K){for(var ge=[!1,"ms","Webkit","Moz","O"],we=K.charAt(0).toUpperCase()+K.slice(1),Me=0;Me<ge.length;Me++){var Je=ge[Me],Ze=Je?""+Je+we:K;if(typeof document.body.style[Ze]<"u")return Ze}return null}function mr(){return this.state.isDestroyed=!0,gi(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[Zi("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function fo(K){var ge=K.ownerDocument;return ge?ge.defaultView:window}function wh(K,ge,we,Me){var Je=K.nodeName==="BODY",Ze=Je?K.ownerDocument.defaultView:K;Ze.addEventListener(ge,we,{passive:!0}),Je||wh(re(Ze.parentNode),ge,we,Me),Me.push(Ze)}function ju(K,ge,we,Me){we.updateBound=Me,fo(K).addEventListener("resize",we.updateBound,{passive:!0});var Je=re(K);return wh(Je,"scroll",we.updateBound,we.scrollParents),we.scrollElement=Je,we.eventsEnabled=!0,we}function po(){this.state.eventsEnabled||(this.state=ju(this.reference,this.options,this.state,this.scheduleUpdate))}function Cn(K,ge){return fo(K).removeEventListener("resize",ge.updateBound),ge.scrollParents.forEach(function(we){we.removeEventListener("scroll",ge.updateBound)}),ge.updateBound=null,ge.scrollParents=[],ge.scrollElement=null,ge.eventsEnabled=!1,ge}function Bo(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=Cn(this.reference,this.state))}function Tl(K){return K!==""&&!isNaN(parseFloat(K))&&isFinite(K)}function pa(K,ge){Object.keys(ge).forEach(function(we){var Me="";["width","height","top","right","bottom","left"].indexOf(we)!==-1&&Tl(ge[we])&&(Me="px"),K.style[we]=ge[we]+Me})}function Al(K,ge){Object.keys(ge).forEach(function(we){var Me=ge[we];Me!==!1?K.setAttribute(we,ge[we]):K.removeAttribute(we)})}function ig(K){return pa(K.instance.popper,K.styles),Al(K.instance.popper,K.attributes),K.arrowElement&&Object.keys(K.arrowStyles).length&&pa(K.arrowElement,K.arrowStyles),K}function Nw(K,ge,we,Me,Je){var Ze=Nn(Je,ge,K,we.positionFixed),nt=_n(we.placement,Ze,ge,K,we.modifiers.flip.boundariesElement,we.modifiers.flip.padding);return ge.setAttribute("x-placement",nt),pa(ge,{position:we.positionFixed?"fixed":"absolute"}),we}function ng(K,ge){var we=K.offsets,Me=we.popper,Je=we.reference,Ze=Math.round,nt=Math.floor,lt=function(xc){return xc},St=Ze(Je.width),ii=Ze(Me.width),ci=["left","right"].indexOf(K.placement)!==-1,Yt=K.placement.indexOf("-")!==-1,hi=St%2===ii%2,Ki=St%2===1&&ii%2===1,Ji=ge?ci||Yt||hi?Ze:nt:lt,Ks=ge?Ze:lt;return{left:Ji(Ki&&!Yt&&ge?Me.left-1:Me.left),top:Ks(Me.top),bottom:Ks(Me.bottom),right:Ji(Me.right)}}var Vw=m&&/Firefox/i.test(navigator.userAgent);function $w(K,ge){var we=ge.x,Me=ge.y,Je=K.offsets.popper,Ze=Io(K.instance.modifiers,function($f){return $f.name==="applyStyle"}).gpuAcceleration;Ze!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var nt=Ze!==void 0?Ze:ge.gpuAcceleration,lt=Te(K.instance.popper),St=Dt(lt),ii={position:Je.position},ci=ng(K,window.devicePixelRatio<2||!Vw),Yt=we==="bottom"?"top":"bottom",hi=Me==="right"?"left":"right",Ki=Zi("transform"),Ji=void 0,Ks=void 0;if(Yt==="bottom"?lt.nodeName==="HTML"?Ks=-lt.clientHeight+ci.bottom:Ks=-St.height+ci.bottom:Ks=ci.top,hi==="right"?lt.nodeName==="HTML"?Ji=-lt.clientWidth+ci.right:Ji=-St.width+ci.right:Ji=ci.left,nt&&Ki)ii[Ki]="translate3d("+Ji+"px, "+Ks+"px, 0)",ii[Yt]=0,ii[hi]=0,ii.willChange="transform";else{var xc=Yt==="bottom"?-1:1,sg=hi==="right"?-1:1;ii[Yt]=Ks*xc,ii[hi]=Ji*sg,ii.willChange=Yt+", "+hi}var Ga={"x-placement":K.placement};return K.attributes=Nt({},Ga,K.attributes),K.styles=Nt({},ii,K.styles),K.arrowStyles=Nt({},K.offsets.arrow,K.arrowStyles),K}function Sv(K,ge,we){var Me=Io(K,function(lt){var St=lt.name;return St===ge}),Je=!!Me&&K.some(function(lt){return lt.name===we&&lt.enabled&&lt.order<Me.order});if(!Je){var Ze="`"+ge+"`",nt="`"+we+"`";console.warn(nt+" modifier is required by "+Ze+" modifier in order to work, be sure to include it before "+Ze+"!")}return Je}function Ls(K,ge){var we;if(!Sv(K.instance.modifiers,"arrow","keepTogether"))return K;var Me=ge.element;if(typeof Me=="string"){if(Me=K.instance.popper.querySelector(Me),!Me)return K}else if(!K.instance.popper.contains(Me))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),K;var Je=K.placement.split("-")[0],Ze=K.offsets,nt=Ze.popper,lt=Ze.reference,St=["left","right"].indexOf(Je)!==-1,ii=St?"height":"width",ci=St?"Top":"Left",Yt=ci.toLowerCase(),hi=St?"left":"top",Ki=St?"bottom":"right",Ji=ss(Me)[ii];lt[Ki]-Ji<nt[Yt]&&(K.offsets.popper[Yt]-=nt[Yt]-(lt[Ki]-Ji)),lt[Yt]+Ji>nt[Ki]&&(K.offsets.popper[Yt]+=lt[Yt]+Ji-nt[Ki]),K.offsets.popper=ai(K.offsets.popper);var Ks=lt[Yt]+lt[ii]/2-Ji/2,xc=U(K.instance.popper),sg=parseFloat(xc["margin"+ci]),Ga=parseFloat(xc["border"+ci+"Width"]),$f=Ks-K.offsets.popper[Yt]-sg-Ga;return $f=Math.max(Math.min(nt[ii]-Ji,$f),0),K.arrowElement=Me,K.offsets.arrow=(we={},Et(we,Yt,Math.round($f)),Et(we,hi,""),we),K}function El(K){return K==="end"?"start":K==="start"?"end":K}var Oh=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Ml=Oh.slice(3);function Uw(K){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,we=Ml.indexOf(K),Me=Ml.slice(we+1).concat(Ml.slice(0,we));return ge?Me.reverse():Me}var qu={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function AM(K,ge){if(gi(K.instance.modifiers,"inner")||K.flipped&&K.placement===K.originalPlacement)return K;var we=vi(K.instance.popper,K.instance.reference,ge.padding,ge.boundariesElement,K.positionFixed),Me=K.placement.split("-")[0],Je=fs(Me),Ze=K.placement.split("-")[1]||"",nt=[];switch(ge.behavior){case qu.FLIP:nt=[Me,Je];break;case qu.CLOCKWISE:nt=Uw(Me);break;case qu.COUNTERCLOCKWISE:nt=Uw(Me,!0);break;default:nt=ge.behavior}return nt.forEach(function(lt,St){if(Me!==lt||nt.length===St+1)return K;Me=K.placement.split("-")[0],Je=fs(Me);var ii=K.offsets.popper,ci=K.offsets.reference,Yt=Math.floor,hi=Me==="left"&&Yt(ii.right)>Yt(ci.left)||Me==="right"&&Yt(ii.left)<Yt(ci.right)||Me==="top"&&Yt(ii.bottom)>Yt(ci.top)||Me==="bottom"&&Yt(ii.top)<Yt(ci.bottom),Ki=Yt(ii.left)<Yt(we.left),Ji=Yt(ii.right)>Yt(we.right),Ks=Yt(ii.top)<Yt(we.top),xc=Yt(ii.bottom)>Yt(we.bottom),sg=Me==="left"&&Ki||Me==="right"&&Ji||Me==="top"&&Ks||Me==="bottom"&&xc,Ga=["top","bottom"].indexOf(Me)!==-1,$f=!!ge.flipVariations&&(Ga&&Ze==="start"&&Ki||Ga&&Ze==="end"&&Ji||!Ga&&Ze==="start"&&Ks||!Ga&&Ze==="end"&&xc),$pe=!!ge.flipVariationsByContent&&(Ga&&Ze==="start"&&Ji||Ga&&Ze==="end"&&Ki||!Ga&&Ze==="start"&&xc||!Ga&&Ze==="end"&&Ks),KU=$f||$pe;(hi||sg||KU)&&(K.flipped=!0,(hi||sg)&&(Me=nt[St+1]),KU&&(Ze=El(Ze)),K.placement=Me+(Ze?"-"+Ze:""),K.offsets.popper=Nt({},K.offsets.popper,Cr(K.instance.popper,K.offsets.reference,K.placement)),K=Cl(K.instance.modifiers,K,"flip"))}),K}function Cv(K){var ge=K.offsets,we=ge.popper,Me=ge.reference,Je=K.placement.split("-")[0],Ze=Math.floor,nt=["top","bottom"].indexOf(Je)!==-1,lt=nt?"right":"bottom",St=nt?"left":"top",ii=nt?"width":"height";return we[lt]<Ze(Me[St])&&(K.offsets.popper[St]=Ze(Me[St])-we[ii]),we[St]>Ze(Me[lt])&&(K.offsets.popper[St]=Ze(Me[lt])),K}function EM(K,ge,we,Me){var Je=K.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),Ze=+Je[1],nt=Je[2];if(!Ze)return K;if(nt.indexOf("%")===0){var lt=void 0;switch(nt){case"%p":lt=we;break;case"%":case"%r":default:lt=Me}var St=ai(lt);return St[ge]/100*Ze}else if(nt==="vh"||nt==="vw"){var ii=void 0;return nt==="vh"?ii=Math.max(document.documentElement.clientHeight,window.innerHeight||0):ii=Math.max(document.documentElement.clientWidth,window.innerWidth||0),ii/100*Ze}else return Ze}function Ppe(K,ge,we,Me){var Je=[0,0],Ze=["right","left"].indexOf(Me)!==-1,nt=K.split(/(\+|\-)/).map(function(ci){return ci.trim()}),lt=nt.indexOf(Io(nt,function(ci){return ci.search(/,|\s/)!==-1}));nt[lt]&&nt[lt].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var St=/\s*,\s*|\s+/,ii=lt!==-1?[nt.slice(0,lt).concat([nt[lt].split(St)[0]]),[nt[lt].split(St)[1]].concat(nt.slice(lt+1))]:[nt];return ii=ii.map(function(ci,Yt){var hi=(Yt===1?!Ze:Ze)?"height":"width",Ki=!1;return ci.reduce(function(Ji,Ks){return Ji[Ji.length-1]===""&&["+","-"].indexOf(Ks)!==-1?(Ji[Ji.length-1]=Ks,Ki=!0,Ji):Ki?(Ji[Ji.length-1]+=Ks,Ki=!1,Ji):Ji.concat(Ks)},[]).map(function(Ji){return EM(Ji,hi,ge,we)})}),ii.forEach(function(ci,Yt){ci.forEach(function(hi,Ki){Tl(hi)&&(Je[Yt]+=hi*(ci[Ki-1]==="-"?-1:1))})}),Je}function Ipe(K,ge){var we=ge.offset,Me=K.placement,Je=K.offsets,Ze=Je.popper,nt=Je.reference,lt=Me.split("-")[0],St=void 0;return Tl(+we)?St=[+we,0]:St=Ppe(we,Ze,nt,lt),lt==="left"?(Ze.top+=St[0],Ze.left-=St[1]):lt==="right"?(Ze.top+=St[0],Ze.left+=St[1]):lt==="top"?(Ze.left+=St[0],Ze.top-=St[1]):lt==="bottom"&&(Ze.left+=St[0],Ze.top+=St[1]),K.popper=Ze,K}function Bpe(K,ge){var we=ge.boundariesElement||Te(K.instance.popper);K.instance.reference===we&&(we=Te(we));var Me=Zi("transform"),Je=K.instance.popper.style,Ze=Je.top,nt=Je.left,lt=Je[Me];Je.top="",Je.left="",Je[Me]="";var St=vi(K.instance.popper,K.instance.reference,ge.padding,we,K.positionFixed);Je.top=Ze,Je.left=nt,Je[Me]=lt,ge.boundaries=St;var ii=ge.priority,ci=K.offsets.popper,Yt={primary:function(hi){var Ki=ci[hi];return ci[hi]<St[hi]&&!ge.escapeWithReference&&(Ki=Math.max(ci[hi],St[hi])),Et({},hi,Ki)},secondary:function(hi){var Ki=hi==="right"?"left":"top",Ji=ci[Ki];return ci[hi]>St[hi]&&!ge.escapeWithReference&&(Ji=Math.min(ci[Ki],St[hi]-(hi==="right"?ci.width:ci.height))),Et({},Ki,Ji)}};return ii.forEach(function(hi){var Ki=["left","top"].indexOf(hi)!==-1?"primary":"secondary";ci=Nt({},ci,Yt[Ki](hi))}),K.offsets.popper=ci,K}function Rpe(K){var ge=K.placement,we=ge.split("-")[0],Me=ge.split("-")[1];if(Me){var Je=K.offsets,Ze=Je.reference,nt=Je.popper,lt=["bottom","top"].indexOf(we)!==-1,St=lt?"left":"top",ii=lt?"width":"height",ci={start:Et({},St,Ze[St]),end:Et({},St,Ze[St]+Ze[ii]-nt[ii])};K.offsets.popper=Nt({},nt,ci[Me])}return K}function Dpe(K){if(!Sv(K.instance.modifiers,"hide","preventOverflow"))return K;var ge=K.offsets.reference,we=Io(K.instance.modifiers,function(Me){return Me.name==="preventOverflow"}).boundaries;if(ge.bottom<we.top||ge.left>we.right||ge.top>we.bottom||ge.right<we.left){if(K.hide===!0)return K;K.hide=!0,K.attributes["x-out-of-boundaries"]=""}else{if(K.hide===!1)return K;K.hide=!1,K.attributes["x-out-of-boundaries"]=!1}return K}function Lpe(K){var ge=K.placement,we=ge.split("-")[0],Me=K.offsets,Je=Me.popper,Ze=Me.reference,nt=["left","right"].indexOf(we)!==-1,lt=["top","left"].indexOf(we)===-1;return Je[nt?"left":"top"]=Ze[we]-(lt?Je[nt?"width":"height"]:0),K.placement=fs(ge),K.offsets.popper=ai(Je),K}var Npe={shift:{order:100,enabled:!0,fn:Rpe},offset:{order:200,enabled:!0,fn:Ipe,offset:0},preventOverflow:{order:300,enabled:!0,fn:Bpe,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:Cv},arrow:{order:500,enabled:!0,fn:Ls,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:AM,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:Lpe},hide:{order:800,enabled:!0,fn:Dpe},computeStyle:{order:850,enabled:!0,fn:$w,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:ig,onLoad:Nw,gpuAcceleration:void 0}},Vpe={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:Npe},Fw=function(){function K(ge,we){var Me=this,Je=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ei(this,K),this.scheduleUpdate=function(){return requestAnimationFrame(Me.update)},this.update=N(this.update.bind(this)),this.options=Nt({},K.Defaults,Je),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=ge&&ge.jquery?ge[0]:ge,this.popper=we&&we.jquery?we[0]:we,this.options.modifiers={},Object.keys(Nt({},K.Defaults.modifiers,Je.modifiers)).forEach(function(nt){Me.options.modifiers[nt]=Nt({},K.Defaults.modifiers[nt]||{},Je.modifiers?Je.modifiers[nt]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(nt){return Nt({name:nt},Me.options.modifiers[nt])}).sort(function(nt,lt){return nt.order-lt.order}),this.modifiers.forEach(function(nt){nt.enabled&&X(nt.onLoad)&&nt.onLoad(Me.reference,Me.popper,Me.options,nt,Me.state)}),this.update();var Ze=this.options.eventsEnabled;Ze&&this.enableEventListeners(),this.state.eventsEnabled=Ze}return Rt(K,[{key:"update",value:function(){return It.call(this)}},{key:"destroy",value:function(){return mr.call(this)}},{key:"enableEventListeners",value:function(){return po.call(this)}},{key:"disableEventListeners",value:function(){return Bo.call(this)}}]),K}();return Fw.Utils=(typeof window<"u"?window:Z).PopperUtils,Fw.placements=Oh,Fw.Defaults=Vpe,Fw})})(ce);var de=ce.exports;let Oe=0,Ae=0;function je(){Oe++}function Ge(){Ae++}const Qe={name:"Drop",emits:["mouseenter","mouseleave","click"],props:{placement:{type:String,default:"bottom-start"},className:{type:String},transfer:{type:Boolean},eventsEnabled:{type:Boolean,default:!1},visible:{type:Boolean},classes:{type:Object,default:()=>{}},styles:{type:Object,default:()=>{}},transitionName:{type:String,default:"transition-drop"},boundariesElement:{default:"window"}},data(){return{popper:null,width:"",popperStatus:!1,tIndex:this.handleGetIndex()}},computed:{mergedStyle(){let c={};return this.width&&(c.minWidth=`${this.width}px`),this.transfer&&(c["z-index"]=1060+this.tIndex),Object.assign({},this.styles,c)},mergedClass(){return Object.assign({},this.classes,{[this.className]:this.className})}},methods:{update(){n.nextTick(()=>{this.popper?(this.popper.update(),this.popperStatus=!0):this.popper=new de(this.$parent.$refs.reference,this.$refs.drop,{eventsEnabled:this.eventsEnabled,placement:this.placement,modifiers:{computeStyle:{gpuAcceleration:!1},preventOverflow:{boundariesElement:this.boundariesElement}},onCreate:()=>{this.resetTransformOrigin(),n.nextTick(this.popper.update())},onUpdate:()=>{this.resetTransformOrigin()}}),this.$parent.$options.name==="iSelect"&&(this.width=parseInt(k(this.$parent.$el,"width"))),this.tIndex=this.handleGetIndex()})},destroy(){this.popper&&setTimeout(()=>{this.popper&&!this.popperStatus&&(this.popper.popper.style.display="none",this.popper.destroy(),this.popper=null),this.popperStatus=!1},300)},resetTransformOrigin(){if(!this.popper)return;let c=this.popper.popper.getAttribute("x-placement"),u=c.split("-")[0],m=c.split("-")[1];c==="left"||c==="right"||(this.popper.popper.style.transformOrigin=u==="bottom"||u!=="top"&&m==="start"?"center top":"center bottom")},handleGetIndex(){return je(),Oe},handleMouseenter(c){this.$emit("mouseenter",c)},handleMouseleave(c){this.$emit("mouseleave",c)},handleOnUpdatePopper(){this.update()},handleOnDestroyPopper(){this.destroy()},handleClick(c){this.$emit("click",c)}},beforeUnmount(){this.popper&&(this.popper.destroy(),this.popper=null)}};function yt(c,u,m,S,b,v){return n.openBlock(),n.createBlock(n.Teleport,{to:"body",disabled:!m.transfer},[n.createVNode(n.Transition,{name:m.transitionName},{default:n.withCtx(()=>[n.withDirectives(n.createElementVNode("div",n.mergeProps({class:["ivu-select-dropdown",v.mergedClass],ref:"drop",style:v.mergedStyle},c.$attrs,{onMouseenter:u[0]||(u[0]=(...M)=>v.handleMouseenter&&v.handleMouseenter(...M)),onMouseleave:u[1]||(u[1]=(...M)=>v.handleMouseleave&&v.handleMouseleave(...M)),onClick:u[2]||(u[2]=n.withModifiers((...M)=>v.handleClick&&v.handleClick(...M),["stop"]))}),[n.renderSlot(c.$slots,"default")],16),[[n.vShow,m.visible]])]),_:3},8,["name"])],8,["disabled"])}var Ke=l(Qe,[["render",yt]]);function ht(c){r&&typeof window.viewuiplus<"u"&&("langs"in viewuiplus||(viewuiplus.langs={}),viewuiplus.langs[c.i.locale]=c)}const ti={i:{locale:"zh-CN",select:{placeholder:"",noMatch:"",loading:""},table:{noDataText:"",noFilteredDataText:"",confirmFilter:"",resetFilter:"",clearFilter:"",sumText:""},datepicker:{selectDate:"",selectTime:"",startTime:"",endTime:"",clear:"",ok:"",datePanelLabel:"[yyyy] [m]",month:"",month1:"1 ",month2:"2 ",month3:"3 ",month4:"4 ",month5:"5 ",month6:"6 ",month7:"7 ",month8:"8 ",month9:"9 ",month10:"10 ",month11:"11 ",month12:"12 ",year:"",weekStartDay:"0",weeks:{sun:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:""},months:{m1:"1",m2:"2",m3:"3",m4:"4",m5:"5",m6:"6",m7:"7",m8:"8",m9:"9",m10:"10",m11:"11",m12:"12"}},transfer:{titles:{source:"",target:""},filterPlaceholder:"",notFoundText:""},modal:{okText:"",cancelText:""},poptip:{okText:"",cancelText:""},page:{prev:"",next:"",total:"",item:"",items:"",prev5:" 5 ",next5:" 5 ",page:"/",goto:"",p:""},rate:{star:"",stars:""},time:{before:"",after:"",just:"",seconds:"",minutes:"",hours:"",days:""},tree:{emptyText:""},image:{zoomIn:"",zoomOut:"",rotateLeft:"",rotateRight:"",fail:"",preview:""}}};ht(ti);var Ht=function(c){return Tt(c)&&!pi(c)};function Tt(c){return!!c&&typeof c=="object"}function pi(c){var u=Object.prototype.toString.call(c);return u==="[object RegExp]"||u==="[object Date]"||$e(c)}var Ai=typeof Symbol=="function"&&Symbol.for,_e=Ai?Symbol.for("react.element"):60103;function $e(c){return c.$$typeof===_e}function fe(c){return Array.isArray(c)?[]:{}}function Ve(c,u){return u.clone!==!1&&u.isMergeableObject(c)?pt(fe(c),c,u):c}function Xe(c,u,m){return c.concat(u).map(function(S){return Ve(S,m)})}function at(c,u,m){var S={};return m.isMergeableObject(c)&&Object.keys(c).forEach(function(b){S[b]=Ve(c[b],m)}),Object.keys(u).forEach(function(b){!m.isMergeableObject(u[b])||!c[b]?S[b]=Ve(u[b],m):S[b]=pt(c[b],u[b],m)}),S}function pt(c,u,m){m=m||{},m.arrayMerge=m.arrayMerge||Xe,m.isMergeableObject=m.isMergeableObject||Ht;var S=Array.isArray(u),b=Array.isArray(c),v=S===b;return v?S?m.arrayMerge(c,u,m):at(c,u,m):Ve(u,m)}pt.all=function(c,u){if(!Array.isArray(c))throw new Error("first argument should be an array");return c.reduce(function(m,S){return pt(m,S,u)},{})};var Gi=pt;const Qi=/(%|)\{([0-9a-zA-Z_]+)\}/g;function ln(){function c(m,S){return Object.prototype.hasOwnProperty.call(m,S)}function u(m,...S){return S.length===1&&typeof S[0]=="object"&&(S=S[0]),(!S||!S.hasOwnProperty)&&(S={}),m===void 0?"":m.replace(Qi,(b,v,M,N)=>{let X;return m[N-1]==="{"&&m[N+b.length]==="}"?M:(X=c(S,M)?S[M]:null,X??"")})}return u}const is=ln();let zi=ti;const dr={zh:ti};let us=null,zy={},qs=null,jb=function(){if(Reflect.has(this,"$t"))return this.$t(...arguments);if(qs&&qs.global)return qs.global.t(...arguments);if(qs&&qs.locale){if(!zy[qs.locale]||us!=qs.locale){zy[qs.locale]=!0;let c=qs.getLocaleMessage(qs.locale)||{},u={};Gi(u,dr[qs.locale],c),zi=u,qs.setLocaleMessage(qs.locale,u),us=qs.locale}return qs.hlang(...arguments)}};const Cf=function(c,u){let m=jb.apply(this,arguments);if(m!=null)return m;const S=c.split(".");let b=zi;for(let v=0,M=S.length;v<M;v++){const N=S[v];if(m=b[N],v===M-1)return is(m,u);if(!m)return"";b=m}return""};var Iu={use:function(c){zi=c||zi},t:Cf,i18n:function(c){qs=c}},Sn={methods:{t(...c){return Cf.apply(this,c)}}},xl={data(){return{globalConfig:{}}},created(){const c=n.getCurrentInstance();this.globalConfig=c.appContext.config.globalProperties.$VIEWUI}};const Bu="ivu-select",fE={name:"iSelectHead",mixins:[Sn,xl],components:{Icon:O},emits:["on-input-focus","on-input-blur","on-keydown","on-enter","on-clear","on-query-change"],inject:["SelectInstance"],props:{disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},remote:{type:Boolean,default:!1},initialLabel:{type:[String,Number,Array]},values:{type:Array,default:()=>[]},clearable:{type:[Function,Boolean],default:!1},inputElementId:{type:String},placeholder:{type:String},queryProp:{type:String,default:""},prefix:{type:String},maxTagCount:{type:Number},maxTagPlaceholder:{type:Function},allowCreate:{type:Boolean},showCreateItem:{type:Boolean}},data(){return{prefixCls:Bu,query:"",inputLength:20,remoteInitialLabel:this.initialLabel,preventRemoteCall:!1}},computed:{singleDisplayClasses(){const{filterable:c,multiple:u,showPlaceholder:m}=this;return[{[Bu+"-head-with-prefix"]:this.showPrefix,[Bu+"-placeholder"]:m&&!c,[Bu+"-selected-value"]:!m&&!u&&!c}]},singleDisplayValue(){return this.multiple&&this.values.length>0||this.filterable?"":`${this.selectedSingle}`||this.localePlaceholder},showPlaceholder(){let c=!1;if(this.multiple)!this.values.length>0&&(c=!0);else{const u=this.values[0];(typeof u>"u"||String(u).trim()==="")&&(c=!this.remoteInitialLabel)}return c},resetSelect(){return!this.showPlaceholder&&this.clearable},inputStyle(){let c={};return this.multiple&&(this.showPlaceholder?c.width="100%":c.width=`${this.inputLength}px`),c},localePlaceholder(){return this.placeholder===void 0?this.t("i.select.placeholder"):this.placeholder},selectedSingle(){const c=this.values[0];return c?c.label:this.remoteInitialLabel||""},selectedMultiple(){return(this.multiple?this.values:[]).filter((c,u)=>this.maxTagCount===void 0||u<this.maxTagCount)},headCls(){return{[`${Bu}-head-flex`]:this.filterable&&this.showPrefix}},arrowType(){const c=this.globalConfig;let u="ios-arrow-down";return c&&(c.select.customArrow?u="":c.select.arrow&&(u=c.select.arrow)),u},customArrowType(){const c=this.globalConfig;let u="";return c&&c.select.customArrow&&(u=c.select.customArrow),u},showPrefix(){const c=this.$slots.prefix&&this.$slots.prefix();let u=!1;return c&&(u=c[0].children.length>0),u||this.prefix},arrowSize(){const c=this.globalConfig;let u="";return c&&c.select.arrowSize&&(u=c.select.arrowSize),u}},methods:{onInputFocus(){this.$emit("on-input-focus")},onInputBlur(){this.showCreateItem||(this.values.length||(this.query=""),this.$emit("on-input-blur"))},removeTag(c){if(this.disabled)return!1;this.SelectInstance.handleOnSelectSelected(c)},resetInputState(){this.inputLength=this.$refs.input.value.length*12+20,this.$emit("on-keydown")},handleInputDelete(c){const u=c.target.value;this.multiple&&this.selectedMultiple.length&&this.query===""&&u===""&&this.removeTag(this.selectedMultiple[this.selectedMultiple.length-1])},handleInputEnter(c){this.$emit("on-enter"),this.showCreateItem&&c.stopPropagation()},onHeaderClick(c){this.filterable&&c.target===this.$el&&this.$refs.input.focus()},onClear(){this.$emit("on-clear")}},watch:{values([c]){if(this.filterable){if(this.preventRemoteCall=!0,this.multiple){this.query="",this.preventRemoteCall=!1;return}typeof c>"u"||c===""||c===null?this.query="":this.query=c.label,n.nextTick(()=>this.preventRemoteCall=!1)}},query(c){if(this.preventRemoteCall){this.preventRemoteCall=!1;return}this.$emit("on-query-change",c)},queryProp(c){c!==this.query&&(this.query=c)}}},pE={key:1,class:"ivu-tag ivu-tag-checked"},mE={class:"ivu-tag-text ivu-select-max-tag"},se=["id","disabled","placeholder"];function Ce(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("div",{onClick:u[6]||(u[6]=(...N)=>v.onHeaderClick&&v.onHeaderClick(...N)),class:n.normalizeClass(v.headCls)},[v.showPrefix?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass([b.prefixCls+"-prefix"])},[n.renderSlot(c.$slots,"prefix",{},()=>[m.prefix?(n.openBlock(),n.createBlock(M,{key:0,type:m.prefix},null,8,["type"])):n.createCommentVNode("",!0)])],2)):n.createCommentVNode("",!0),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.selectedMultiple,(N,X)=>(n.openBlock(),n.createElementBlock("div",{class:"ivu-tag ivu-tag-checked",key:X},[n.createElementVNode("span",{class:n.normalizeClass(["ivu-tag-text",{"ivu-select-multiple-tag-hidden":N.disabled}])},n.toDisplayString(N.tag!==void 0?N.tag:N.label),3),N.disabled?n.createCommentVNode("",!0):(n.openBlock(),n.createBlock(M,{key:0,type:"ios-close",onClick:n.withModifiers(U=>v.removeTag(N),["stop"])},null,8,["onClick"]))]))),128)),m.maxTagCount!==void 0&&m.values.length>m.maxTagCount?(n.openBlock(),n.createElementBlock("div",pE,[n.createElementVNode("span",mE,[m.maxTagPlaceholder?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createTextVNode(n.toDisplayString(m.maxTagPlaceholder(m.values.length-m.maxTagCount)),1)],64)):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createTextVNode("+ "+n.toDisplayString(m.values.length-m.maxTagCount)+"...",1)],64))])])):n.createCommentVNode("",!0),n.withDirectives(n.createElementVNode("span",{class:n.normalizeClass(v.singleDisplayClasses)},n.toDisplayString(v.singleDisplayValue),3),[[n.vShow,v.singleDisplayValue]]),m.filterable?n.withDirectives((n.openBlock(),n.createElementBlock("input",{key:2,id:m.inputElementId,type:"text","onUpdate:modelValue":u[0]||(u[0]=N=>b.query=N),disabled:m.disabled,class:n.normalizeClass([b.prefixCls+"-input"]),placeholder:v.showPlaceholder?v.localePlaceholder:"",style:n.normalizeStyle(v.inputStyle),autocomplete:"off",spellcheck:"false",onKeydown:[u[1]||(u[1]=(...N)=>v.resetInputState&&v.resetInputState(...N)),u[2]||(u[2]=n.withKeys((...N)=>v.handleInputDelete&&v.handleInputDelete(...N),["delete"])),u[3]||(u[3]=n.withKeys((...N)=>v.handleInputEnter&&v.handleInputEnter(...N),["enter"]))],onFocus:u[4]||(u[4]=(...N)=>v.onInputFocus&&v.onInputFocus(...N)),onBlur:u[5]||(u[5]=(...N)=>v.onInputBlur&&v.onInputBlur(...N)),ref:"input"},null,46,se)),[[n.vModelText,b.query]]):n.createCommentVNode("",!0),v.resetSelect?(n.openBlock(),n.createBlock(M,{key:3,type:"ios-close-circle",class:n.normalizeClass([b.prefixCls+"-arrow"]),onClick:n.withModifiers(v.onClear,["stop"])},null,8,["class","onClick"])):n.createCommentVNode("",!0),!v.resetSelect&&!m.remote?(n.openBlock(),n.createBlock(M,{key:4,type:v.arrowType,custom:v.customArrowType,size:v.arrowSize,class:n.normalizeClass([b.prefixCls+"-arrow"])},null,8,["type","custom","size","class"])):n.createCommentVNode("",!0)],2)}var Ne=l(fE,[["render",Ce]]);const Be="click",Ie=Object.create(null),mt=Object.create(null),Ft=[Ie,mt],Gt=function(c,u,m){const{target:S}=m,b=function(M){const{el:N}=M;if(N!==S&&!N.contains(S)){const{binding:X}=M;X.modifiers.stop&&m.stopPropagation(),X.modifiers.prevent&&m.preventDefault(),X.value.call(c,m)}},v=function(M){return u[M].forEach(b)};Object.keys(u).forEach(v)},li=function(c){Gt(this,Ie,c)},Si=function(c){Gt(this,mt,c)},Ii=function(c){return c?li:Si},Di=Object.defineProperties({},{$_captureInstances:{value:Ie},$_nonCaptureInstances:{value:mt},$_onCaptureEvent:{value:li},$_onNonCaptureEvent:{value:Si},beforeMount:{value:function(c,u){if(typeof u.value!="function")throw new TypeError("Binding value must be a function.");let m;const S=u.modifiers;S.click?m="click":S.mousedown?m="mousedown":S.touchstart?m="touchstart":m=Be;const b=u.arg,v={...u,modifiers:{capture:!1,prevent:!1,stop:!1,...u.modifiers}},M=b?Ie:mt;Array.isArray(M[m])||(M[m]=[]),M[m].push({el:c,binding:v})===1&&typeof document=="object"&&document&&document.addEventListener(m,Ii(b),b)}},unmounted:{value:function(c){const u=function(S){return S.el!==c},m=function(S){const b=Object.keys(S);if(b.length){const v=S===Ie,M=function(N){const X=S[N].filter(u);X.length?S[N]=X:(typeof document=="object"&&document&&document.removeEventListener(N,Ii(v),v),delete S[N])};b.forEach(M)}};Ft.forEach(m)}},version:{enumerable:!0,value:"3.7.1"}});var Li={inject:{FormInstance:{default:""},FormItemInstance:{default:null}},computed:{itemDisabled(){let c=this.disabled;return!c&&this.FormInstance&&(c=this.FormInstance.disabled),c?!0:null}},methods:{handleFormItemChange(c,u){this.FormItemInstance&&(c==="blur"?this.FormItemInstance.formBlur(u):c==="change"&&this.FormItemInstance.formChange(u))}}};const Pn="ivu-select",ao=(c,u,m)=>{const S=JSON.stringify(c),b=JSON.stringify(u),v=JSON.stringify(m.map(M=>M.value));return S!==b||S!==v||v!==b},za=300,mn={name:"iSelect",mixins:[Sn,Li],components:{Drop:Ke,SelectHead:Ne,Icon:O},directives:{clickOutside:Di},emits:["on-set-default-options","on-clear","on-clickoutside","on-select","on-create","on-change","on-query-change","on-open-change","update:modelValue"],provide(){return{SelectInstance:this}},props:{modelValue:{type:[String,Number,Array],default:""},label:{type:[String,Number,Array],default:""},defaultLabel:{type:[String,Number,Array],default:""},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placeholder:{type:String},filterable:{type:Boolean,default:!1},filterMethod:{type:Function},remoteMethod:{type:Function},loading:{type:Boolean,default:!1},loadingText:{type:String},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},labelInValue:{type:Boolean,default:!1},notFoundText:{type:String},placement:{validator(c){return T(c,["top","bottom","top-start","bottom-start","top-end","bottom-end"])},default:"bottom-start"},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},autoComplete:{type:Boolean,default:!1},name:{type:String},elementId:{type:String},transferClassName:{type:String},prefix:{type:String},maxTagCount:{type:Number},maxTagPlaceholder:{type:Function},allowCreate:{type:Boolean,default:!1},capture:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},filterByLabel:{type:Boolean,default:!1},eventsEnabled:{type:Boolean,default:!1},hideNotFound:{type:Boolean,default:!1}},mounted(){if(!this.remote&&this.slotOptions.length>0&&(this.values=this.getInitialValue().map(c=>typeof c!="number"&&!c?null:this.getOptionData(c)).filter(Boolean)),this.checkUpdateStatus(),this.remote&&this.modelValue&&this.defaultLabel){if(!this.multiple)this.query=this.defaultLabel,this.modelValue&&this.defaultLabel&&this.values.push({label:this.defaultLabel,value:this.modelValue});else if(this.multiple&&this.defaultLabel instanceof Array&&this.modelValue.length===this.defaultLabel.length){const c=this.modelValue.map((u,m)=>({value:u,label:this.defaultLabel[m]}));setTimeout(()=>{this.values=c})}}},data(){return{prefixCls:Pn,values:[],dropDownWidth:0,visible:!1,focusIndex:-1,isFocused:!1,query:"",initialLabel:this.label,hasMouseHoverHead:!1,slotOptions:[],caretPosition:-1,lastRemoteQuery:"",unchangedQuery:!0,hasExpectedValue:!1,isTyping:!1,preventRemoteCall:!1,filterQueryChange:!1,slotOptionsMap:new Map,isLocking:!1}},computed:{classes(){return[`${Pn}`,{[`${Pn}-visible`]:this.visible,[`${Pn}-disabled`]:this.itemDisabled,[`${Pn}-multiple`]:this.multiple,[`${Pn}-single`]:!this.multiple,[`${Pn}-${this.size}`]:!!this.size}]},dropdownCls(){return{[Pn+"-dropdown-transfer"]:this.transfer,[Pn+"-multiple"]:this.multiple&&this.transfer,"ivu-auto-complete":this.autoComplete,[this.transferClassName]:this.transferClassName}},selectionCls(){return{[`${Pn}-selection`]:!this.autoComplete,[`${Pn}-selection-focused`]:this.isFocused}},localeNotFoundText(){return typeof this.notFoundText>"u"?this.t("i.select.noMatch"):this.notFoundText},localeLoadingText(){return typeof this.loadingText>"u"?this.t("i.select.loading"):this.loadingText},showCreateItem(){let c=!1;const{allowCreate:u,query:m,slotOptions:S}=this;return u&&m!==""&&(c=!0,(S||[]).find(b=>b.proxy&&b.proxy.showLabel===m)&&(c=!1)),c},transitionName(){return this.placement==="bottom"?"slide-up":"slide-down"},dropVisible(){let c=!0;const u=this.slotOptions.length===0;return!this.loading&&this.remote&&this.query===""&&u&&(c=!1),this.autoComplete&&u&&(c=!1),this.visible&&c},showNotFoundLabel(){const{loading:c,remote:u,slotOptions:m,hideNotFound:S}=this,b=m||[],v=b.find(M=>M.proxy.isShow);return(b.length===0||!v)&&(!u||u&&!c)&&!S},publicValue(){return this.multiple?this.values.map(c=>c.value):(this.values[0]||{}).value},canBeCleared(){const c=this.hasMouseHoverHead,u=!this.multiple&&!this.itemDisabled&&this.clearable;return c&&u&&this.reset},selectTabindex(){return this.itemDisabled||this.filterable?-1:0},remote(){return typeof this.remoteMethod=="function"}},methods:{setQuery(c){if(c){this.onQueryChange(c);return}c===null&&(this.onQueryChange(""),this.values=[],this.lastRemoteQuery="")},clearSingleSelect(){this.multiple||this.$emit("update:modelValue",""),this.$emit("on-clear"),this.hideMenu(),this.clearable&&this.reset()},getOptionData(c){const u=this.slotOptions.find(({props:b})=>b.value===c);if(!u)return null;const{optionLabel:m,disabled:S}=u.proxy||{};return{value:c,label:m,disabled:S}},getInitialValue(){const{multiple:c,remote:u,modelValue:m}=this;let S=Array.isArray(m)?m:[m];if(!c&&(typeof S[0]>"u"||String(S[0]).trim()===""&&!Number.isFinite(S[0]))&&(S=[]),u&&!c&&m){const b=this.getOptionData(m);this.query=b?b.label:String(m)}return S.filter(b=>!!b||b===0)},validateOption({children:c,elm:u,propsData:m}){const S=m.value,b=m.label||"",v=u&&u.textContent||(c||[]).reduce((X,U)=>{const H=U.elm?U.elm.textContent:U.text;return`${X} ${H}`},"")||"",M=this.filterByLabel?[b].toString():[S,b,v].toString(),N=this.query.toLowerCase().trim();return M.toLowerCase().includes(N)},toggleMenu(c,u){if(this.itemDisabled)return!1;this.visible=typeof u<"u"?u:!this.visible,this.visible&&(this.dropDownWidth=this.$el.getBoundingClientRect().width,this.$refs.dropdown.handleOnUpdatePopper())},hideMenu(){this.toggleMenu(null,!1),this.isTyping=!1,setTimeout(()=>this.unchangedQuery=!0,za)},onClickOutside(c){if(this.visible){if(c.type==="mousedown"){c.preventDefault();return}if(this.transfer){const u=this.$refs.dropdown.$refs.drop;if(u===c.target||u.contains(c.target))return}if(this.filterable){const u=this.$el.querySelector('input[type="text"]');this.caretPosition=u.selectionStart,n.nextTick(()=>{const m=this.caretPosition===-1?u.value.length:this.caretPosition;u.setSelectionRange(m,m)})}this.autoComplete||c.stopPropagation(),c.preventDefault(),this.hideMenu(),this.isFocused=!0,this.$emit("on-clickoutside",c)}else this.caretPosition=-1,this.isFocused=!1},reset(){this.query="",this.focusIndex=-1,this.unchangedQuery=!0,this.values=[],this.filterQueryChange=!1},handleKeydown(c){const u=c.key||c.code,m=c.keyCode||c.which;if(!(u==="Backspace"||m===8))if(this.visible){if(c.preventDefault(),u==="Tab"&&c.stopPropagation(),u==="Escape"&&(c.stopPropagation(),this.hideMenu()),u==="ArrowUp"&&this.navigateOptions(-1),u==="ArrowDown"&&this.navigateOptions(1),u==="Enter"){if(this.focusIndex===-1)return this.hideMenu();const S=this.slotOptions[this.focusIndex];if(S){const b=this.getOptionData(S.props.value);this.onOptionClick(b)}else this.hideMenu()}}else["ArrowUp","ArrowDown"].includes(c.key)&&this.toggleMenu(null,!0)},navigateOptions(c){const u=this.slotOptions,m=u.length-1;if(m<0)return;let S=this.focusIndex+c;S<0&&(S=m),S>m&&(S=0);let b,v=null;if(c>0){b=-1;for(let M=0;M<u.length;M++){const{proxy:N}=u[M];if(!N.disabled&&(b=M),N.isShow&&v===null)v=M;else if(!N.isShow){b=M;continue}if(b>=S)break}}else{b=u.length;for(let M=m;M>=0;M--){const{proxy:N}=u[M];if(!N.disabled&&(b=M),N.isShow&&v===null)v=M;else if(!N.isShow){b=M;continue}if(b<=S)break}}S=u[b].proxy.isShow?b:v,this.focusIndex=S},onOptionClick(c){if(this.multiple?(this.remote?this.lastRemoteQuery=this.lastRemoteQuery||this.query:this.lastRemoteQuery="",this.values.find(({value:u})=>u===c.value)?this.values=this.values.filter(({value:u})=>u!==c.value):this.values=this.values.concat(c),this.isFocused=!0):(this.query=String(c.label).trim(),this.values=[c],this.lastRemoteQuery="",this.hideMenu()),this.focusIndex=this.slotOptions.findIndex(u=>u?u.props.value===c.value:!1),this.filterable){const u=this.$el.querySelector('input[type="text"]');this.autoComplete||n.nextTick(()=>u.focus())}this.$emit("on-select",c),this.$refs.dropdown.handleOnUpdatePopper(),setTimeout(()=>{this.filterQueryChange=!1},za)},onQueryChange(c){if(this.isTyping=!0,c.length>0&&c!==this.query)if(r&&this.autoComplete){let u=document.hasFocus&&document.hasFocus()&&document.activeElement===this.$el.querySelector("input");this.visible=u}else this.visible=!0;this.query=c,this.unchangedQuery=this.visible,this.filterQueryChange=!0},toggleHeaderFocus({type:c}){this.itemDisabled||(this.isFocused=c==="focus")},checkUpdateStatus(){this.getInitialValue().length>0&&this.slotOptions.length===0&&(this.hasExpectedValue=!0)},handleCreateItem(){if(this.allowCreate&&this.query!==""&&this.showCreateItem){const c=this.query;this.$emit("on-create",c),this.query="";const u={value:c,label:c,tag:void 0};this.$refs.dropdown.handleOnUpdatePopper(),setTimeout(()=>{this.onOptionClick(u)})}},handleOnSelectSelected(c){this.onOptionClick(c)},focus(){this.filterable&&(this.$refs.selectHead.$refs.input.focus(),this.toggleMenu())},lazyUpdateValue(c){const{getInitialValue:u,isLocking:m,defaultLabel:S,remote:b,modelValue:v,values:M}=this,N=!!(S&&S.length);(v&&v.length||M.length||N)&&b&&c||m||(this.isLocking=!0,n.nextTick(()=>{this.values=u().map(this.getOptionData).filter(Boolean),this.isLocking=!1}))}},watch:{modelValue(c){const{publicValue:u,values:m}=this;this.checkUpdateStatus(),c===""?(this.values=[],this.query=""):ao(c,u,m)&&(this.lazyUpdateValue(),this.multiple||this.handleFormItemChange("change",this.publicValue))},values(c,u){const m=JSON.stringify(c),S=JSON.stringify(u);let b=this.publicValue;if(m!==S&&b!==this.modelValue){let v=this.publicValue;this.labelInValue&&(this.multiple?v=this.values:v=this.values[0]),(Array.isArray(b)&&!b.length&&this.modelValue===null||b===void 0&&this.modelValue===null)&&(b=null),this.$emit("update:modelValue",b),this.$emit("on-change",v),this.handleFormItemChange("change",v)}},query(c){this.focusIndex=-1,this.$emit("on-query-change",c);const{remoteMethod:u,lastRemoteQuery:m}=this,S=u&&c!==""&&(c!==m||!m)&&!this.preventRemoteCall;if(this.preventRemoteCall=!1,S){const b=this.remoteMethod(c);this.initialLabel="",b&&b.then&&b.then(v=>{v&&(this.options=v)})}this.visible&&this.$refs.dropdown.handleOnUpdatePopper(),c!==""&&this.remote&&(this.lastRemoteQuery=c)},isFocused(c){(this.filterable?this.$el.querySelector('input[type="text"]'):this.$el)[this.isFocused?"focus":"blur"]();const[u]=this.values;if(u&&this.filterable&&!this.multiple&&!c){const m=String(u.label||u.value).trim();m&&this.query!==m&&(this.preventRemoteCall=!0,this.query=m)}},focusIndex(c){if(!(c<0||this.autoComplete)&&this.slotOptions[c]){const u=this.slotOptions[c].proxy.$el,m=this.$refs.dropdown.$refs.drop;let S=u.getBoundingClientRect().bottom-m.getBoundingClientRect().bottom,b=u.getBoundingClientRect().top-m.getBoundingClientRect().top;S>0&&(m.scrollTop+=S),b<0&&(m.scrollTop+=b)}},dropVisible(c){c?this.$refs.dropdown.handleOnUpdatePopper():this.$refs.dropdown.handleOnDestroyPopper()},visible(c){this.$emit("on-open-change",c)}}},Ei=["tabindex"],Tf=["name","value"];function zn(c,u,m,S,b,v){const M=n.resolveComponent("select-head"),N=n.resolveComponent("Icon"),X=n.resolveComponent("Drop"),U=n.resolveDirective("click-outside");return n.withDirectives((n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.createElementVNode("div",{ref:"reference",class:n.normalizeClass(v.selectionCls),tabindex:v.selectTabindex,onBlur:u[2]||(u[2]=(...H)=>v.toggleHeaderFocus&&v.toggleHeaderFocus(...H)),onFocus:u[3]||(u[3]=(...H)=>v.toggleHeaderFocus&&v.toggleHeaderFocus(...H)),onClick:u[4]||(u[4]=(...H)=>v.toggleMenu&&v.toggleMenu(...H)),onKeydown:[u[5]||(u[5]=n.withKeys((...H)=>v.handleKeydown&&v.handleKeydown(...H),["esc"])),u[6]||(u[6]=n.withKeys((...H)=>v.handleKeydown&&v.handleKeydown(...H),["enter"])),u[7]||(u[7]=n.withKeys(n.withModifiers((...H)=>v.handleKeydown&&v.handleKeydown(...H),["prevent"]),["up"])),u[8]||(u[8]=n.withKeys(n.withModifiers((...H)=>v.handleKeydown&&v.handleKeydown(...H),["prevent"]),["down"])),u[9]||(u[9]=n.withKeys((...H)=>v.handleKeydown&&v.handleKeydown(...H),["tab"])),u[10]||(u[10]=n.withKeys((...H)=>v.handleKeydown&&v.handleKeydown(...H),["delete"]))],onMouseenter:u[11]||(u[11]=H=>b.hasMouseHoverHead=!0),onMouseleave:u[12]||(u[12]=H=>b.hasMouseHoverHead=!1)},[n.renderSlot(c.$slots,"input",{},()=>[n.createElementVNode("input",{type:"hidden",name:m.name,value:v.publicValue},null,8,Tf),n.createVNode(M,{ref:"selectHead",filterable:m.filterable,multiple:m.multiple,values:b.values,clearable:v.canBeCleared,prefix:m.prefix,disabled:c.itemDisabled,remote:v.remote,"input-element-id":m.elementId,"initial-label":b.initialLabel,placeholder:m.placeholder,"query-prop":b.query,"max-tag-count":m.maxTagCount,"max-tag-placeholder":m.maxTagPlaceholder,"allow-create":m.allowCreate,"show-create-item":v.showCreateItem,onOnQueryChange:v.onQueryChange,onOnInputFocus:u[0]||(u[0]=H=>b.isFocused=!0),onOnInputBlur:u[1]||(u[1]=H=>b.isFocused=!1),onOnClear:v.clearSingleSelect,onOnEnter:v.handleCreateItem},{prefix:n.withCtx(()=>[n.renderSlot(c.$slots,"prefix")]),_:3},8,["filterable","multiple","values","clearable","prefix","disabled","remote","input-element-id","initial-label","placeholder","query-prop","max-tag-count","max-tag-placeholder","allow-create","show-create-item","onOnQueryChange","onOnClear","onOnEnter"])])],42,Ei),n.createVNode(X,{ref:"dropdown",classes:v.dropdownCls,visible:v.dropVisible,placement:m.placement,eventsEnabled:m.eventsEnabled,transfer:m.transfer,"transition-name":"transition-drop"},{default:n.withCtx(()=>[n.withDirectives(n.createElementVNode("ul",{class:n.normalizeClass([b.prefixCls+"-not-found"])},[n.createElementVNode("li",null,n.toDisplayString(v.localeNotFoundText),1)],2),[[n.vShow,v.showNotFoundLabel&&!m.allowCreate]]),!v.remote||v.remote&&!m.loading?(n.openBlock(),n.createElementBlock("ul",{key:0,class:n.normalizeClass(b.prefixCls+"-dropdown-list")},[v.showCreateItem?(n.openBlock(),n.createElementBlock("li",{key:0,class:n.normalizeClass(b.prefixCls+"-item"),onClick:u[13]||(u[13]=(...H)=>v.handleCreateItem&&v.handleCreateItem(...H))},[n.createTextVNode(n.toDisplayString(b.query)+" ",1),n.createVNode(N,{type:"md-return-left",class:n.normalizeClass(b.prefixCls+"-item-enter")},null,8,["class"])],2)):n.createCommentVNode("",!0),n.renderSlot(c.$slots,"default")],2)):(n.openBlock(),n.createElementBlock("ul",{key:1,class:n.normalizeClass(b.prefixCls+"-dropdown-list")},[v.showCreateItem?(n.openBlock(),n.createElementBlock("li",{key:0,class:n.normalizeClass(b.prefixCls+"-item"),onClick:u[14]||(u[14]=(...H)=>v.handleCreateItem&&v.handleCreateItem(...H))},[n.createTextVNode(n.toDisplayString(b.query)+" ",1),n.createVNode(N,{type:"md-return-left",class:n.normalizeClass(b.prefixCls+"-item-enter")},null,8,["class"])],2)):n.createCommentVNode("",!0)],2)),n.withDirectives(n.createElementVNode("ul",{class:n.normalizeClass([b.prefixCls+"-loading"])},n.toDisplayString(v.localeLoadingText),3),[[n.vShow,m.loading]])]),_:3},8,["classes","visible","placement","eventsEnabled","transfer"])],2)),[[U,v.onClickOutside,m.capture],[U,v.onClickOutside,m.capture,{mousedown:!0}],[U,v.onClickOutside,m.capture,{touchstart:!0}]])}var lo=l(mn,[["render",zn]]);const Af="ivu-select-item",Ef={name:"iOption",componentName:"select-item",mixins:[Li],emits:["on-select-selected"],inject:{SelectInstance:{default:null},OptionGroupInstance:{default:null}},props:{value:{type:[String,Number],required:!0},label:{type:[String,Number]},disabled:{type:Boolean,default:!1},tag:{type:[String,Number]}},data(){return{searchLabel:"",autoComplete:!1,id:te(6),instance:null}},computed:{classes(){return[`${Af}`,{[`${Af}-disabled`]:this.itemDisabled,[`${Af}-selected`]:this.selected&&!this.autoComplete,[`${Af}-focus`]:this.isFocused}]},showLabel(){return this.label?this.label:this.value},optionLabel(){return this.label||this.$el&&this.$el.textContent},isFocused(){const c=this.SelectInstance;let u=c.slotOptions||[];const m=c.focusIndex,S=c.$slots.default;if(this.autoComplete&&S){u=[];let v=S();for(;v.length>0;){const M=v.shift();M.type&&typeof M.type=="object"&&M.type.name==="iOption"?u.push(M):Array.isArray(M.children)&&(v=v.concat(M.children))}}const b=u[m];return b&&b.props&&b.props.value===this.value},isShow(){const c=this.SelectInstance,u=c.filterable,m=c.query.toLowerCase().trim(),S=c.filterByLabel,b=c.slotOptionsMap,{props:v}=b.get(this.value)||{props:{}},M=this.label||this.$el&&this.$el.textContent;let N=(M||v.value||"").toLowerCase();S&&(N=(M||"").toLowerCase());const X=N.includes(m);return!u||u&&(X||!c.filterQueryChange)||D(c.remoteMethod)==="function"},selected(){return(this.SelectInstance.values||[]).find(c=>c.value===this.value)}},methods:{select(){if(this.itemDisabled)return!1;this.SelectInstance.handleOnSelectSelected({value:this.value,label:this.optionLabel,tag:this.tag})},addOption(){const c=this.SelectInstance,u=this.OptionGroupInstance,{id:m,value:S,instance:b}=this;if(u&&u.optionList.push({...b,id:m,tag:"option"}),c){c.slotOptions.push({...b,id:m,tag:"option"}),c.slotOptionsMap.set(S,b);const{modelValue:v}=c;(v&&v.length||D(v)==="number")&&c.lazyUpdateValue(!0)}},removeOption(){const c=this.OptionGroupInstance,u=this.SelectInstance,{id:m,value:S}=this;if(c){const b=c.optionList.findIndex(v=>v.id===m);b!==-1&&c.optionList.splice(b,1)}if(u){const b=this.SelectInstance,v=b.slotOptions.findIndex(M=>M.id===m);v!==-1&&b.slotOptions.splice(v,1),b.slotOptionsMap.has(S)&&b.slotOptionsMap.delete(S)}}},created(){this.instance=n.getCurrentInstance()},mounted(){this.addOption();const c=F(this,"iSelect");c&&(this.autoComplete=c.autoComplete)},beforeUnmount(){n.nextTick(()=>{this.removeOption(),this.instance=null})}};function Xy(c,u,m,S,b,v){return n.withDirectives((n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(v.classes),onClick:u[0]||(u[0]=n.withModifiers((...M)=>v.select&&v.select(...M),["stop"])),onMousedown:u[1]||(u[1]=n.withModifiers(()=>{},["prevent"]))},[n.renderSlot(c.$slots,"default",{},()=>[n.createTextVNode(n.toDisplayString(v.showLabel),1)])],34)),[[n.vShow,v.isShow]])}var ds=l(Ef,[["render",Xy]]);const dc=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important
`,Wy=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];let Ur={},ko;function gE(c,u=!1){if(!r)return;const m=c.getAttribute("id")||c.getAttribute("data-reactid")||c.getAttribute("name");if(u&&Ur[m])return Ur[m];const S=window.getComputedStyle(c),b=S.getPropertyValue("box-sizing")||S.getPropertyValue("-moz-box-sizing")||S.getPropertyValue("-webkit-box-sizing"),v=parseFloat(S.getPropertyValue("padding-bottom"))+parseFloat(S.getPropertyValue("padding-top")),M=parseFloat(S.getPropertyValue("border-bottom-width"))+parseFloat(S.getPropertyValue("border-top-width")),N={sizingStyle:Wy.map(X=>`${X}:${S.getPropertyValue(X)}`).join(";"),paddingSize:v,borderSize:M,boxSizing:b};return u&&m&&(Ur[m]=N),N}function qb(c,u=null,m=null,S=!1){r&&!ko&&(ko=document.createElement("textarea"),document.body.appendChild(ko)),c.getAttribute("wrap")?ko.setAttribute("wrap",c.getAttribute("wrap")):ko.removeAttribute("wrap");let{paddingSize:b,borderSize:v,boxSizing:M,sizingStyle:N}=gE(c,S);ko.setAttribute("style",`${N};${dc}`),ko.value=c.value||c.placeholder||"";let X=Number.MIN_SAFE_INTEGER,U=Number.MAX_SAFE_INTEGER,H=ko.scrollHeight,re;if(M==="border-box"?H=H+v:M==="content-box"&&(H=H-b),u!==null||m!==null){ko.value=" ";let xe=ko.scrollHeight-b;u!==null&&(X=xe*u,M==="border-box"&&(X=X+b+v),H=Math.max(X,H)),m!==null&&(U=xe*m,M==="border-box"&&(U=U+b+v),re=H>U?"":"hidden",H=Math.min(U,H))}return m||(re="hidden"),{height:`${H}px`,minHeight:`${X}px`,maxHeight:`${U}px`,overflowY:re}}const Ds="ivu-input",vee={name:"Input",mixins:[Li],emits:["on-enter","on-search","on-keydown","on-keypress","on-keyup","on-click","on-focus","on-blur","on-change","on-input-change","on-clear","update:modelValue"],props:{type:{validator(c){return T(c,["text","textarea","password","url","email","date","number","tel"])},default:"text"},modelValue:{type:[String,Number],default:""},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},placeholder:{type:String,default:""},maxlength:{type:[String,Number]},disabled:{type:Boolean,default:!1},icon:String,autosize:{type:[Boolean,Object],default:!1},rows:{type:Number,default:2},readonly:{type:Boolean,default:!1},name:{type:String},number:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},spellcheck:{type:Boolean,default:!1},autocomplete:{type:String,default:"off"},clearable:{type:Boolean,default:!1},elementId:{type:String},wrap:{validator(c){return T(c,["hard","soft"])},default:"soft"},prefix:{type:String,default:""},suffix:{type:String,default:""},search:{type:Boolean,default:!1},enterButton:{type:[Boolean,String],default:!1},showWordLimit:{type:Boolean,default:!1},password:{type:Boolean,default:!1},border:{type:Boolean,default:!0}},data(){return{currentValue:this.modelValue,prefixCls:Ds,slotReady:!1,textareaStyles:{},isOnComposition:!1,showPassword:!1,clearableIconOffset:0}},computed:{currentType(){let c=this.type;return c==="password"&&this.password&&this.showPassword&&(c="text"),c},prepend(){let c=!1;return this.type!=="textarea"&&(c=this.$slots.prepend!==void 0),c},append(){let c=!1;return this.type!=="textarea"&&(c=this.$slots.append!==void 0),c},showPrefix(){let c=!1;return this.type!=="textarea"&&(c=this.prefix!==""||this.$slots.prefix!==void 0),c},showSuffix(){let c=!1;return this.type!=="textarea"&&(c=this.suffix!==""||this.$slots.suffix!==void 0),c},wrapClasses(){return[`${Ds}-wrapper`,{[`${Ds}-wrapper-${this.size}`]:!!this.size,[`${Ds}-type-${this.type}`]:this.type,[`${Ds}-group`]:this.prepend||this.append||this.search&&this.enterButton,[`${Ds}-group-${this.size}`]:(this.prepend||this.append||this.search&&this.enterButton)&&!!this.size,[`${Ds}-group-with-prepend`]:this.prepend,[`${Ds}-group-with-append`]:this.append||this.search&&this.enterButton,[`${Ds}-hide-icon`]:this.append,[`${Ds}-with-search`]:this.search&&this.enterButton,[`${Ds}-wrapper-disabled`]:this.itemDisabled}]},inputClasses(){return[`${Ds}`,{[`${Ds}-${this.size}`]:!!this.size,[`${Ds}-disabled`]:this.itemDisabled,[`${Ds}-no-border`]:!this.border,[`${Ds}-with-prefix`]:this.showPrefix,[`${Ds}-with-suffix`]:this.showSuffix||this.search&&this.enterButton===!1}]},textareaClasses(){return[`${Ds}`,{[`${Ds}-disabled`]:this.itemDisabled,[`${Ds}-no-border`]:!this.border}]},upperLimit(){return this.maxlength},textLength(){return typeof this.modelValue=="number"?String(this.modelValue).length:(this.modelValue||"").length},clearableStyles(){const c={};let u=this.clearableIconOffset;return u&&(c.transform=`translateX(-${u}px)`),c}},methods:{handleEnter(c){this.$emit("on-enter",c),this.search&&this.$emit("on-search",this.currentValue)},handleKeydown(c){this.$emit("on-keydown",c)},handleKeypress(c){this.$emit("on-keypress",c)},handleKeyup(c){this.$emit("on-keyup",c)},handleIconClick(c){this.$emit("on-click",c)},handleFocus(c){this.$emit("on-focus",c)},handleBlur(c){this.$emit("on-blur",c),F(this,["DatePicker","TimePicker","Cascader","Search"])||this.handleFormItemChange("blur",this.currentValue)},handleComposition(c){c.type==="compositionstart"&&(this.isOnComposition=!0),c.type==="compositionend"&&(this.isOnComposition=!1,this.handleInput(c))},handleInput(c){if(this.isOnComposition)return;let u=c.target.value;this.number&&u!==""&&(u=Number.isNaN(Number(u))?u:Number(u)),this.$emit("update:modelValue",u),this.setCurrentValue(u),this.$emit("on-change",c)},handleChange(c){this.$emit("on-input-change",c)},setCurrentValue(c){c!==this.currentValue&&(n.nextTick(()=>{this.resizeTextarea()}),this.currentValue=c,F(this,["DatePicker","TimePicker","Cascader","Search"])||this.handleFormItemChange("change",c))},resizeTextarea(){const c=this.autosize;if(!c||this.type!=="textarea")return!1;const u=c.minRows,m=c.maxRows;this.textareaStyles=qb(this.$refs.textarea,u,m)},focus(c){const u=this.type==="textarea"?this.$refs.textarea:this.$refs.input;u.focus(c);const{cursor:m}=c||{};if(m){const S=u.value.length;switch(m){case"start":u.setSelectionRange(0,0);break;case"end":u.setSelectionRange(S,S);break;default:u.setSelectionRange(0,S)}}},blur(){this.type==="textarea"?this.$refs.textarea.blur():this.$refs.input.blur()},handleClear(){const c={target:{value:""}};this.$emit("update:modelValue",""),this.setCurrentValue(""),this.$emit("on-change",c),this.$emit("on-clear")},handleSearch(){if(this.itemDisabled)return!1;this.$refs.input.focus(),this.$emit("on-search",this.currentValue)},handleToggleShowPassword(){if(this.itemDisabled)return!1;this.showPassword=!this.showPassword,this.focus();const c=this.currentValue.length;setTimeout(()=>{this.$refs.input.setSelectionRange(c,c)},0)},handleCalcIconOffset(){const c=this.$el.querySelectorAll(".ivu-input-group-append")[0];c?this.clearableIconOffset=c.offsetWidth:this.clearableIconOffset=0}},watch:{modelValue(c){this.setCurrentValue(c)},type(){n.nextTick(this.handleCalcIconOffset)}},mounted(){this.slotReady=!0,this.resizeTextarea(),this.handleCalcIconOffset()},updated(){n.nextTick(this.handleCalcIconOffset)}},xee={key:4,class:"ivu-input-suffix"},_ee={key:5,class:"ivu-input-word-count"},bee={key:0,class:"ivu-icon ivu-icon-ios-eye-outline"},wee={key:1,class:"ivu-icon ivu-icon-ios-eye-off-outline"},Oee=["id","autocomplete","spellcheck","type","placeholder","disabled","maxlength","readonly","name","value","number","autofocus"],See={key:0,class:"ivu-icon ivu-icon-ios-search"},Cee={key:9,class:"ivu-input-prefix"},Tee=["id","wrap","autocomplete","spellcheck","placeholder","disabled","rows","maxlength","readonly","name","value","autofocus"],Aee={key:0,class:"ivu-input-word-count"};function Eee(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses)},[m.type!=="textarea"?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[v.prepend?n.withDirectives((n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-group-prepend"])},[n.renderSlot(c.$slots,"prepend")],2)),[[n.vShow,b.slotReady]]):n.createCommentVNode("",!0),m.clearable&&b.currentValue&&!c.itemDisabled?(n.openBlock(),n.createElementBlock("i",{key:1,class:n.normalizeClass(["ivu-icon",["ivu-icon-ios-close-circle",b.prefixCls+"-icon",b.prefixCls+"-icon-clear",b.prefixCls+"-icon-normal"]]),onClick:u[0]||(u[0]=(...M)=>v.handleClear&&v.handleClear(...M)),style:n.normalizeStyle(v.clearableStyles)},null,6)):m.icon?(n.openBlock(),n.createElementBlock("i",{key:2,class:n.normalizeClass(["ivu-icon",["ivu-icon-"+m.icon,b.prefixCls+"-icon",b.prefixCls+"-icon-normal"]]),onClick:u[1]||(u[1]=(...M)=>v.handleIconClick&&v.handleIconClick(...M))},null,2)):m.search&&m.enterButton===!1?(n.openBlock(),n.createElementBlock("i",{key:3,class:n.normalizeClass(["ivu-icon ivu-icon-ios-search",[b.prefixCls+"-icon",b.prefixCls+"-icon-normal",b.prefixCls+"-search-icon"]]),onClick:u[2]||(u[2]=(...M)=>v.handleSearch&&v.handleSearch(...M))},null,2)):v.showSuffix?(n.openBlock(),n.createElementBlock("span",xee,[n.renderSlot(c.$slots,"suffix",{},()=>[m.suffix?(n.openBlock(),n.createElementBlock("i",{key:0,class:n.normalizeClass(["ivu-icon",["ivu-icon-"+m.suffix]])},null,2)):n.createCommentVNode("",!0)])])):m.showWordLimit?(n.openBlock(),n.createElementBlock("span",_ee,n.toDisplayString(v.textLength)+"/"+n.toDisplayString(v.upperLimit),1)):m.password?(n.openBlock(),n.createElementBlock("span",{key:6,class:"ivu-input-suffix",onClick:u[3]||(u[3]=(...M)=>v.handleToggleShowPassword&&v.handleToggleShowPassword(...M))},[b.showPassword?(n.openBlock(),n.createElementBlock("i",bee)):(n.openBlock(),n.createElementBlock("i",wee))])):n.createCommentVNode("",!0),n.createVNode(n.Transition,{name:"fade"},{default:n.withCtx(()=>[m.icon?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("i",{key:0,class:n.normalizeClass(["ivu-icon ivu-icon-ios-loading ivu-load-loop",[b.prefixCls+"-icon",b.prefixCls+"-icon-validate"]])},null,2))]),_:1}),n.createElementVNode("input",{id:m.elementId,autocomplete:m.autocomplete,spellcheck:m.spellcheck,ref:"input",type:v.currentType,class:n.normalizeClass(v.inputClasses),placeholder:m.placeholder,disabled:c.itemDisabled,maxlength:m.maxlength,readonly:m.readonly,name:m.name,value:b.currentValue,number:m.number,autofocus:m.autofocus,onKeyup:[u[4]||(u[4]=n.withKeys((...M)=>v.handleEnter&&v.handleEnter(...M),["enter"])),u[5]||(u[5]=(...M)=>v.handleKeyup&&v.handleKeyup(...M))],onKeypress:u[6]||(u[6]=(...M)=>v.handleKeypress&&v.handleKeypress(...M)),onKeydown:u[7]||(u[7]=(...M)=>v.handleKeydown&&v.handleKeydown(...M)),onFocus:u[8]||(u[8]=(...M)=>v.handleFocus&&v.handleFocus(...M)),onBlur:u[9]||(u[9]=(...M)=>v.handleBlur&&v.handleBlur(...M)),onCompositionstart:u[10]||(u[10]=(...M)=>v.handleComposition&&v.handleComposition(...M)),onCompositionupdate:u[11]||(u[11]=(...M)=>v.handleComposition&&v.handleComposition(...M)),onCompositionend:u[12]||(u[12]=(...M)=>v.handleComposition&&v.handleComposition(...M)),onInput:u[13]||(u[13]=(...M)=>v.handleInput&&v.handleInput(...M)),onChange:u[14]||(u[14]=(...M)=>v.handleChange&&v.handleChange(...M))},null,42,Oee),v.append?n.withDirectives((n.openBlock(),n.createElementBlock("div",{key:7,class:n.normalizeClass([b.prefixCls+"-group-append"])},[n.renderSlot(c.$slots,"append")],2)),[[n.vShow,b.slotReady]]):m.search&&m.enterButton?(n.openBlock(),n.createElementBlock("div",{key:8,class:n.normalizeClass([b.prefixCls+"-group-append",b.prefixCls+"-search"]),onClick:u[15]||(u[15]=(...M)=>v.handleSearch&&v.handleSearch(...M))},[m.enterButton===!0?(n.openBlock(),n.createElementBlock("i",See)):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createTextVNode(n.toDisplayString(m.enterButton),1)],64))],2)):v.showPrefix?(n.openBlock(),n.createElementBlock("span",Cee,[n.renderSlot(c.$slots,"prefix",{},()=>[m.prefix?(n.openBlock(),n.createElementBlock("i",{key:0,class:n.normalizeClass(["ivu-icon",["ivu-icon-"+m.prefix]])},null,2)):n.createCommentVNode("",!0)])])):n.createCommentVNode("",!0)],64)):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createElementVNode("textarea",{id:m.elementId,wrap:m.wrap,autocomplete:m.autocomplete,spellcheck:m.spellcheck,ref:"textarea",class:n.normalizeClass(v.textareaClasses),style:n.normalizeStyle(b.textareaStyles),placeholder:m.placeholder,disabled:c.itemDisabled,rows:m.rows,maxlength:m.maxlength,readonly:m.readonly,name:m.name,value:b.currentValue,autofocus:m.autofocus,onKeyup:[u[16]||(u[16]=n.withKeys((...M)=>v.handleEnter&&v.handleEnter(...M),["enter"])),u[17]||(u[17]=(...M)=>v.handleKeyup&&v.handleKeyup(...M))],onKeypress:u[18]||(u[18]=(...M)=>v.handleKeypress&&v.handleKeypress(...M)),onKeydown:u[19]||(u[19]=(...M)=>v.handleKeydown&&v.handleKeydown(...M)),onFocus:u[20]||(u[20]=(...M)=>v.handleFocus&&v.handleFocus(...M)),onBlur:u[21]||(u[21]=(...M)=>v.handleBlur&&v.handleBlur(...M)),onCompositionstart:u[22]||(u[22]=(...M)=>v.handleComposition&&v.handleComposition(...M)),onCompositionupdate:u[23]||(u[23]=(...M)=>v.handleComposition&&v.handleComposition(...M)),onCompositionend:u[24]||(u[24]=(...M)=>v.handleComposition&&v.handleComposition(...M)),onInput:u[25]||(u[25]=(...M)=>v.handleInput&&v.handleInput(...M))},`
            `,46,Tee),m.showWordLimit?(n.openBlock(),n.createElementBlock("span",Aee,n.toDisplayString(v.textLength)+"/"+n.toDisplayString(v.upperLimit),1)):n.createCommentVNode("",!0)],64))],2)}var Xa=l(vee,[["render",Eee]]);const Mee={name:"AutoComplete",mixins:[Li],components:{iSelect:lo,iOption:ds,iInput:Xa},emits:["update:modelValue","on-change","on-search","on-select","on-focus","on-blur","on-clear"],props:{modelValue:{type:[String,Number],default:""},label:{type:[String,Number],default:""},data:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placeholder:{type:String},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},icon:{type:String},filterMethod:{type:[Function,Boolean],default:!1},placement:{validator(c){return T(c,["top","bottom","top-start","bottom-start","top-end","bottom-end"])},default:"bottom-start"},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},transferClassName:{type:String},capture:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},eventsEnabled:{type:Boolean,default:!1}},data(){return{currentValue:this.modelValue,disableEmitChange:!1}},computed:{inputIcon(){let c="";return this.clearable&&this.currentValue&&!this.disabled?c="ios-close-circle":this.icon&&(c=this.icon),c},filteredData(){return this.filterMethod?this.data.filter(c=>this.filterMethod(this.currentValue,c)):this.data}},watch:{modelValue(c){this.currentValue!==c&&(this.disableEmitChange=!0),this.currentValue=c},currentValue(c){if(this.$refs.select.setQuery(c),this.$emit("update:modelValue",c),this.disableEmitChange){this.disableEmitChange=!1;return}this.$emit("on-change",c),this.handleFormItemChange("change",c)}},methods:{remoteMethod(c){this.$emit("on-search",c)},handleSelect(c){const u=c.value;u!=null&&(this.currentValue=u,this.$refs.input.blur(),this.$emit("on-select",u))},handleFocus(c){this.$emit("on-focus",c)},handleBlur(c){this.$emit("on-blur",c)},handleClear(){!this.clearable||(this.currentValue="",this.$refs.select.reset(),this.$emit("on-clear"))},handleClickOutside(){n.nextTick(()=>{this.$refs.input.blur()})}}};function kee(c,u,m,S,b,v){const M=n.resolveComponent("i-input"),N=n.resolveComponent("i-option"),X=n.resolveComponent("i-select");return n.openBlock(),n.createBlock(X,{ref:"select",class:"ivu-auto-complete",label:m.label,disabled:c.itemDisabled,clearable:m.clearable,placeholder:m.placeholder,size:m.size,placement:m.placement,"model-value":b.currentValue,"transfer-class-name":m.transferClassName,filterable:"",remote:"","auto-complete":"","remote-method":v.remoteMethod,onOnSelect:v.handleSelect,onOnClickoutside:v.handleClickOutside,transfer:m.transfer,capture:m.capture,eventsEnabled:m.eventsEnabled},{input:n.withCtx(()=>[n.renderSlot(c.$slots,"input",{},()=>[n.createVNode(M,{"element-id":m.elementId,ref:"input",modelValue:b.currentValue,"onUpdate:modelValue":u[0]||(u[0]=U=>b.currentValue=U),name:m.name,placeholder:m.placeholder,disabled:c.itemDisabled,size:m.size,icon:v.inputIcon,onOnClick:v.handleClear,onOnFocus:v.handleFocus,onOnBlur:v.handleBlur},null,8,["element-id","modelValue","name","placeholder","disabled","size","icon","onOnClick","onOnFocus","onOnBlur"])])]),default:n.withCtx(()=>[n.renderSlot(c.$slots,"default",{},()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.filteredData,U=>(n.openBlock(),n.createBlock(N,{value:U,key:U},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(U),1)]),_:2},1032,["value"]))),128))])]),_:3},8,["label","disabled","clearable","placeholder","size","placement","model-value","transfer-class-name","remote-method","onOnSelect","onOnClickoutside","transfer","capture","eventsEnabled"])}var fN=l(Mee,[["render",kee]]);const $m="ivu-avatar",pN=["small","large","default"],Pee={name:"Avatar",components:{Icon:O},emits:["on-error"],props:{shape:{validator(c){return T(c,["circle","square"])},default:"circle"},size:{type:[String,Number],default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},src:{type:String},icon:{type:String},customIcon:{type:String,default:""}},data(){return{prefixCls:$m,scale:1,childrenWidth:0,isSlotShow:!1,slotTemp:null}},computed:{classes(){return[`${$m}`,`${$m}-${this.shape}`,{[`${$m}-image`]:!!this.src,[`${$m}-icon`]:!!this.icon||!!this.customIcon,[`${$m}-${this.size}`]:T(this.size,pN)}]},styles(){let c={};return this.size&&!T(this.size,pN)&&(c.width=`${this.size}px`,c.height=`${this.size}px`,c.lineHeight=`${this.size}px`,c.fontSize=`${this.size/2}px`),c},childrenStyle(){let c={};return this.isSlotShow&&(c={msTransform:`scale(${this.scale})`,WebkitTransform:`scale(${this.scale})`,transform:`scale(${this.scale})`,position:"absolute",display:"inline-block",left:`calc(50% - ${Math.round(this.childrenWidth/2)}px)`}),c}},watch:{size(c,u){c!==u&&this.setScale()}},methods:{setScale(){if(this.isSlotShow=!this.src&&!this.icon,this.$refs.children){this.childrenWidth=this.$refs.children.offsetWidth;const c=this.$el.getBoundingClientRect().width;c-8<this.childrenWidth?this.scale=(c-8)/this.childrenWidth:this.scale=1}},handleError(c){this.$emit("on-error",c)}},beforeCreate(){this.slotTemp=this.$slots.default?this.$slots.default():null},mounted(){this.setScale()},updated(){const c=this.$slots.default?this.$slots.default():null;c&&c!==this.slotTemp&&this.setScale()}},Iee=["src"];function Bee(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("span",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.styles)},[m.src?(n.openBlock(),n.createElementBlock("img",{key:0,src:m.src,onError:u[0]||(u[0]=(...N)=>v.handleError&&v.handleError(...N))},null,40,Iee)):m.icon||m.customIcon?(n.openBlock(),n.createBlock(M,{key:1,type:m.icon,custom:m.customIcon},null,8,["type","custom"])):(n.openBlock(),n.createElementBlock("span",{key:2,ref:"children",class:n.normalizeClass([b.prefixCls+"-string"]),style:n.normalizeStyle(v.childrenStyle)},[n.renderSlot(c.$slots,"default")],6))],6)}var Hy=l(Pee,[["render",Bee]]),mN={emits:["on-popper-show","on-popper-hide","created","update:modelValue"],props:{eventsEnabled:{type:Boolean,default:!1},placement:{type:String,default:"bottom"},boundariesPadding:{type:Number,default:5},reference:Object,popper:Object,offset:{default:0},modelValue:{type:Boolean,default:!1},transition:String,options:{type:Object,default(){return{modifiers:{computeStyle:{gpuAcceleration:!1},preventOverflow:{boundariesElement:"window"}}}}}},data(){return{visible:this.modelValue}},watch:{modelValue:{immediate:!0,handler(c){this.visible=c,this.$emit("update:modelValue",c)}},visible(c){c?(this.handleIndexIncrease&&this.handleIndexIncrease(),this.updatePopper(),this.$emit("on-popper-show")):this.$emit("on-popper-hide"),this.$emit("update:modelValue",c)}},methods:{createPopper(){if(!/^(top|bottom|left|right)(-start|-end)?$/g.test(this.placement))return;const c=this.options,u=this.popper||this.$refs.popper,m=this.reference||this.$refs.reference;!u||!m||(this.popperJS&&this.popperJS.hasOwnProperty("destroy")&&this.popperJS.destroy(),c.eventsEnabled=this.eventsEnabled,c.placement=this.placement,c.modifiers.offset||(c.modifiers.offset={}),c.modifiers.offset.offset=this.offset,c.onCreate=()=>{n.nextTick(this.updatePopper),this.$emit("created",this)},this.popperJS=new de(m,u,c))},updatePopper(){this.popperJS?this.popperJS.update():this.createPopper()},doDestroy(){this.visible||(this.popperJS.destroy(),this.popperJS=null)}},updated(){n.nextTick(()=>this.updatePopper())},beforeUnmount(){this.popperJS&&this.popperJS.destroy()}};const Um="ivu-tooltip",Ree={name:"Tooltip",mixins:[mN],props:{placement:{validator(c){return T(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},content:{type:[String,Number],default:""},delay:{type:Number,default:100},disabled:{type:Boolean,default:!1},controlled:{type:Boolean,default:!1},always:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},theme:{validator(c){return T(c,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number]},transferClassName:{type:String}},data(){return{prefixCls:Um,tIndex:this.handleGetIndex()}},computed:{innerStyles(){const c={};return this.maxWidth&&(c["max-width"]=`${this.maxWidth}px`),c},innerClasses(){return[`${Um}-inner`,{[`${Um}-inner-with-width`]:!!this.maxWidth}]},dropStyles(){let c={};return this.transfer&&(c["z-index"]=1060+this.tIndex),c},dropdownCls(){return[`${Um}-popper`,`${Um}-${this.theme}`,{[Um+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}]}},watch:{content(){this.updatePopper()}},methods:{handleShowPopper(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.visible=!0},this.delay),this.tIndex=this.handleGetIndex()},handleClosePopper(){this.timeout&&(clearTimeout(this.timeout),this.controlled||(this.timeout=setTimeout(()=>{this.visible=!1},100)))},handleGetIndex(){return je(),Oe}},mounted(){this.always&&this.updatePopper()}};function Dee(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([b.prefixCls]),onMouseenter:u[2]||(u[2]=(...M)=>v.handleShowPopper&&v.handleShowPopper(...M)),onMouseleave:u[3]||(u[3]=(...M)=>v.handleClosePopper&&v.handleClosePopper(...M))},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-rel"]),ref:"reference"},[n.renderSlot(c.$slots,"default")],2),(n.openBlock(),n.createBlock(n.Teleport,{to:"body",disabled:!m.transfer},[n.createVNode(n.Transition,{name:"fade"},{default:n.withCtx(()=>[n.withDirectives(n.createElementVNode("div",{ref:"popper",class:n.normalizeClass(v.dropdownCls),style:n.normalizeStyle(v.dropStyles),onMouseenter:u[0]||(u[0]=(...M)=>v.handleShowPopper&&v.handleShowPopper(...M)),onMouseleave:u[1]||(u[1]=(...M)=>v.handleClosePopper&&v.handleClosePopper(...M))},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content"])},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-arrow"])},null,2),n.createElementVNode("div",{class:n.normalizeClass(v.innerClasses),style:n.normalizeStyle(v.innerStyles)},[n.renderSlot(c.$slots,"content",{},()=>[n.createTextVNode(n.toDisplayString(m.content),1)])],6)],2)],38),[[n.vShow,!m.disabled&&(c.visible||m.always)]])]),_:3})],8,["disabled"]))],34)}var mh=l(Ree,[["render",Dee]]);const Lee={name:"AvatarList",components:{Avatar:Hy,Tooltip:mh},props:{list:{type:Array,default(){return[]}},shape:{validator(c){return T(c,["circle","square"])},default:"circle"},size:{validator(c){return T(c,["small","large","default"])},default:"default"},excessStyle:{type:Object,default(){return{}}},max:{type:Number},tooltip:{type:Boolean,default:!0},placement:{validator(c){return T(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"top"},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}}},computed:{currentList(){const c=this.list.length,u=this.max;return c<=u?[...this.list]:[...this.list].slice(0,u)}}},Nee={key:0,class:"ivu-avatar-list-item ivu-avatar-list-item-excess"},Vee={key:1,class:"ivu-avatar-list-item ivu-avatar-list-item-excess"};function $ee(c,u,m,S,b,v){const M=n.resolveComponent("Avatar"),N=n.resolveComponent("Tooltip");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["ivu-avatar-list","ivu-avatar-list-"+m.size])},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.currentList,(X,U)=>(n.openBlock(),n.createElementBlock("div",{class:"ivu-avatar-list-item",key:U},[m.tooltip&&X.tip?(n.openBlock(),n.createBlock(N,{key:0,content:X.tip,placement:m.placement,transfer:m.transfer},{default:n.withCtx(()=>[n.createVNode(M,{src:X.src,size:m.size,shape:m.shape},null,8,["src","size","shape"])]),_:2},1032,["content","placement","transfer"])):(n.openBlock(),n.createBlock(M,{key:1,src:X.src,size:m.size,shape:m.shape},null,8,["src","size","shape"]))]))),128)),c.$slots.extra?(n.openBlock(),n.createElementBlock("div",Nee,[n.createVNode(M,{size:m.size,shape:m.shape,style:n.normalizeStyle(m.excessStyle)},{default:n.withCtx(()=>[n.renderSlot(c.$slots,"extra")]),_:3},8,["size","shape","style"])])):m.list.length>m.max?(n.openBlock(),n.createElementBlock("div",Vee,[n.createVNode(M,{size:m.size,shape:m.shape,style:n.normalizeStyle(m.excessStyle)},{default:n.withCtx(()=>[n.renderSlot(c.$slots,"excess",{},()=>[n.createTextVNode("+"+n.toDisplayString(m.list.length-m.max),1)])]),_:3},8,["size","shape","style"])])):n.createCommentVNode("",!0)],2)}var gN=l(Lee,[["render",$ee]]);const yE="ivu-back-top",Uee={name:"BackTop",emits:["on-click"],props:{height:{type:Number,default:400},bottom:{type:Number,default:30},right:{type:Number,default:30},duration:{type:Number,default:1e3}},data(){return{backTop:!1}},mounted(){o(window,"scroll",this.handleScroll),o(window,"resize",this.handleScroll)},beforeUnmount(){a(window,"scroll",this.handleScroll),a(window,"resize",this.handleScroll)},computed:{classes(){return[`${yE}`,{[`${yE}-show`]:this.backTop}]},styles(){return{bottom:`${this.bottom}px`,right:`${this.right}px`}},innerClasses(){return`${yE}-inner`}},methods:{handleScroll(){!r||(this.backTop=window.pageYOffset>=this.height)},back(){if(!r)return;const c=document.documentElement.scrollTop||document.body.scrollTop;V(window,c,0,this.duration),this.$emit("on-click")}}},Fee=[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-up"},null,-1)];function zee(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.styles),onClick:u[0]||(u[0]=(...M)=>v.back&&v.back(...M))},[n.renderSlot(c.$slots,"default",{},()=>[n.createElementVNode("div",{class:n.normalizeClass(v.innerClasses)},Fee,2)])],6)}var yN=l(Uee,[["render",zee]]);const vN=["blue","green","red","yellow","pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],fc="ivu-badge",Xee={name:"Badge",props:{count:Number,dot:{type:Boolean,default:!1},overflowCount:{type:[Number,String],default:99},className:String,showZero:{type:Boolean,default:!1},text:{type:String,default:""},status:{validator(c){return T(c,["success","processing","default","error","warning"])}},type:{validator(c){return T(c,["success","primary","normal","error","warning","info"])}},offset:{type:Array},color:{type:String}},computed:{classes(){return`${fc}`},dotClasses(){return`${fc}-dot`},countClasses(){return[`${fc}-count`,{[`${this.className}`]:!!this.className,[`${fc}-count-alone`]:this.alone,[`${fc}-count-${this.type}`]:!!this.type}]},customCountClasses(){return[`${fc}-count`,`${fc}-count-custom`,{[`${this.className}`]:!!this.className}]},statusClasses(){return[`${fc}-status-dot`,{[`${fc}-status-${this.status}`]:!!this.status,[`${fc}-status-${this.color}`]:!!this.color&&T(this.color,vN)}]},statusStyles(){return T(this.color,vN)?{}:{backgroundColor:this.color}},styles(){const c={};return this.offset&&this.offset.length===2&&(c["margin-top"]=`${this.offset[0]}px`,c["margin-right"]=`${this.offset[1]}px`),c},finalCount(){return this.text!==""?this.text:parseInt(this.count)>=parseInt(this.overflowCount)?`${this.overflowCount}+`:this.count},badge(){let c=!1;return this.count&&(c=parseInt(this.count)!==0),this.dot&&(c=!0,this.count!==null&&parseInt(this.count)===0&&(c=!1)),this.text!==""&&(c=!0),c||this.showZero},hasCount(){return!!(this.count||this.text!==""||this.showZero&&parseInt(this.count)===0)},alone(){return this.$slots.default===void 0}}},Wee={class:"ivu-badge-status-text"};function Hee(c,u,m,S,b,v){return m.dot?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(v.classes),ref:"badge"},[n.renderSlot(c.$slots,"default"),n.withDirectives(n.createElementVNode("sup",{class:n.normalizeClass(v.dotClasses),style:n.normalizeStyle(v.styles)},null,6),[[n.vShow,v.badge]])],2)):m.status||m.color?(n.openBlock(),n.createElementBlock("span",{key:1,class:n.normalizeClass([v.classes,"ivu-badge-status"]),ref:"badge"},[n.createElementVNode("span",{class:n.normalizeClass(v.statusClasses),style:n.normalizeStyle(v.statusStyles)},null,6),n.createElementVNode("span",Wee,[n.renderSlot(c.$slots,"text",{},()=>[n.createTextVNode(n.toDisplayString(m.text),1)])])],2)):(n.openBlock(),n.createElementBlock("span",{key:2,class:n.normalizeClass(v.classes),ref:"badge"},[n.renderSlot(c.$slots,"default"),c.$slots.count?(n.openBlock(),n.createElementBlock("sup",{key:0,style:n.normalizeStyle(v.styles),class:n.normalizeClass(v.customCountClasses)},[n.renderSlot(c.$slots,"count")],6)):v.hasCount?n.withDirectives((n.openBlock(),n.createElementBlock("sup",{key:1,style:n.normalizeStyle(v.styles),class:n.normalizeClass(v.countClasses)},[n.renderSlot(c.$slots,"text",{},()=>[n.createTextVNode(n.toDisplayString(v.finalCount),1)])],6)),[[n.vShow,v.badge]]):n.createCommentVNode("",!0)],2))}var Zb=l(Xee,[["render",Hee]]);const Gee={name:"Breadcrumb",provide(){return{BreadcrumbInstance:this}},props:{separator:{type:String,default:"/"}}},Qee={class:"ivu-breadcrumb"};function Yee(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",Qee,[n.renderSlot(c.$slots,"default")])}var vE=l(Gee,[["render",Yee]]);const xN="ivu-breadcrumb-item",jee={name:"BreadcrumbItem",mixins:[he],inject:["BreadcrumbInstance"],props:{},data(){return{showSeparator:!1}},computed:{linkClasses(){return`${xN}-link`},separatorClasses(){return`${xN}-separator`},separator(){return this.BreadcrumbInstance.separator}},mounted(){this.showSeparator=this.$slots.separator!==void 0}},qee=["href","target"],Zee=["innerHTML"];function Kee(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("span",null,[c.to?(n.openBlock(),n.createElementBlock("a",{key:0,href:c.linkUrl,target:c.target,class:n.normalizeClass(v.linkClasses),onClick:[u[0]||(u[0]=n.withModifiers(M=>c.handleCheckClick(M,!1),["exact"])),u[1]||(u[1]=n.withModifiers(M=>c.handleCheckClick(M,!0),["ctrl"])),u[2]||(u[2]=n.withModifiers(M=>c.handleCheckClick(M,!0),["meta"]))]},[n.renderSlot(c.$slots,"default")],10,qee)):(n.openBlock(),n.createElementBlock("span",{key:1,class:n.normalizeClass(v.linkClasses)},[n.renderSlot(c.$slots,"default")],2)),b.showSeparator?(n.openBlock(),n.createElementBlock("span",{key:3,class:n.normalizeClass(v.separatorClasses)},[n.renderSlot(c.$slots,"separator")],2)):(n.openBlock(),n.createElementBlock("span",{key:2,class:n.normalizeClass(v.separatorClasses),innerHTML:v.separator},null,10,Zee))])}var xE=l(jee,[["render",Kee]]);const Ru="ivu-btn",co={name:"Button",mixins:[he,Li],components:{Icon:O},emits:["click"],props:{type:{validator(c){return T(c,["default","primary","dashed","text","info","success","warning","error"])},default:"default"},shape:{validator(c){return T(c,["circle","circle-outline"])}},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},loading:Boolean,disabled:Boolean,htmlType:{default:"button",validator(c){return T(c,["button","submit","reset"])}},icon:{type:String,default:""},customIcon:{type:String,default:""},long:{type:Boolean,default:!1},ghost:{type:Boolean,default:!1}},computed:{showSlot(){return!!this.$slots.default},classes(){return[`${Ru}`,`${Ru}-${this.type}`,{[`${Ru}-long`]:this.long,[`${Ru}-${this.shape}`]:!!this.shape,[`${Ru}-${this.size}`]:this.size!=="default",[`${Ru}-loading`]:this.loading!=null&&this.loading,[`${Ru}-icon-only`]:!this.showSlot&&(!!this.icon||!!this.customIcon||this.loading),[`${Ru}-ghost`]:this.ghost}]},isHrefPattern(){const{to:c}=this;return!!c},tagName(){const{isHrefPattern:c}=this;return c?"a":"button"},tagProps(){const{isHrefPattern:c}=this;if(c){const{linkUrl:u,target:m}=this;return{href:u,target:m}}else{const{htmlType:u}=this;return{type:u}}}},methods:{handleClickLink(c){this.$emit("click",c);const u=c.ctrlKey||c.metaKey;this.handleCheckClick(c,u)}},render(){let c;this.tagName==="button"?c="button":this.tagName==="a"&&(c="a");let u=[];return this.loading&&u.push(n.h(O,{class:"ivu-load-loop",type:"ios-loading"})),(this.icon||this.customIcon)&&!this.loading&&u.push(n.h(O,{type:this.icon,custom:this.customIcon})),this.$slots.default&&u.push(n.h("span",{ref:"slot"},this.$slots.default())),n.h(c,{class:this.classes,disabled:this.itemDisabled,onClick:this.handleClickLink,...this.tagProps},u)}},Kb="ivu-btn-group",Jee={name:"ButtonGroup",props:{size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},shape:{validator(c){return T(c,["circle","circle-outline"])}},vertical:{type:Boolean,default:!1}},computed:{classes(){return[`${Kb}`,{[`${Kb}-${this.size}`]:!!this.size,[`${Kb}-${this.shape}`]:!!this.shape,[`${Kb}-vertical`]:this.vertical}]}}};function ete(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.renderSlot(c.$slots,"default")],2)}var _E=l(Jee,[["render",ete]]);const Gy="ivu-radio-group";let tte=0;const ite=Date.now(),nte={name:"RadioGroup",mixins:[Li],emits:["update:modelValue","on-change"],provide(){return{RadioGroupInstance:this}},props:{modelValue:{type:[String,Number],default:""},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},type:{validator(c){return T(c,["button"])}},vertical:{type:Boolean,default:!1},name:{type:String,default:()=>`ivuRadioGroup_${ite}_${tte++}`},buttonStyle:{validator(c){return T(c,["default","solid"])},default:"default"}},data(){return{currentValue:this.modelValue,children:[]}},computed:{classes(){return[`${Gy}`,{[`${Gy}-${this.size}`]:!!this.size,[`ivu-radio-${this.size}`]:!!this.size,[`${Gy}-${this.type}`]:!!this.type,[`${Gy}-button-${this.buttonStyle}`]:this.type==="button"&&this.buttonStyle!=="default",[`${Gy}-vertical`]:this.vertical}]}},methods:{change(c){this.currentValue=c.value,this.$emit("update:modelValue",c.value),this.$emit("on-change",c.value),this.handleFormItemChange("change",c.value)}},watch:{modelValue(){this.currentValue!==this.modelValue&&(this.currentValue=this.modelValue)}}},ste=["name"];function rte(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),name:m.name},[n.renderSlot(c.$slots,"default")],10,ste)}var Jb=l(nte,[["render",rte]]);const aa="ivu-radio",ote={name:"Radio",mixins:[Li],emits:["update:modelValue","on-change"],inject:{RadioGroupInstance:{default:null}},props:{modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},label:{type:[String,Number]},disabled:{type:Boolean,default:!1},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},name:{type:String},border:{type:Boolean,default:!1}},data(){return{groupName:this.name,parent:this.RadioGroupInstance,focusWrapper:!1,focusInner:!1}},computed:{wrapClasses(){return[`${aa}-wrapper`,{[`${aa}-group-item`]:this.group,[`${aa}-wrapper-checked`]:this.currentValue,[`${aa}-wrapper-disabled`]:this.itemDisabled,[`${aa}-${this.size}`]:!!this.size,[`${aa}-focus`]:this.focusWrapper,[`${aa}-border`]:this.border}]},radioClasses(){return[`${aa}`,{[`${aa}-checked`]:this.currentValue,[`${aa}-disabled`]:this.itemDisabled}]},innerClasses(){return[`${aa}-inner`,{[`${aa}-focus`]:this.focusInner}]},inputClasses(){return`${aa}-input`},currentValue(){return this.RadioGroupInstance?this.RadioGroupInstance.currentValue===this.label:this.modelValue===this.trueValue},group(){return!!this.RadioGroupInstance}},mounted(){this.parent&&(this.name&&this.name!==this.parent.name?console.warn&&console.warn("[View UI] Name does not match Radio Group name."):this.groupName=this.parent.name)},methods:{change(c){if(this.itemDisabled)return!1;const u=c.target.checked?this.trueValue:this.falseValue;this.$emit("update:modelValue",u),this.group?this.label!==void 0&&this.parent.change({value:this.label,checked:this.modelValue}):(this.$emit("on-change",u),this.handleFormItemChange("change",u))},onBlur(){this.focusWrapper=!1,this.focusInner=!1},onFocus(){this.group&&this.parent.type==="button"?this.focusWrapper=!0:this.focusInner=!0}},watch:{modelValue(c){if(!(c===this.trueValue||c===this.falseValue))throw"Value should be trueValue or falseValue."}}},ate=["disabled","checked","name"];function lte(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("label",{class:n.normalizeClass(v.wrapClasses)},[n.createElementVNode("span",{class:n.normalizeClass(v.radioClasses)},[n.createElementVNode("span",{class:n.normalizeClass(v.innerClasses)},null,2),n.createElementVNode("input",{type:"radio",class:n.normalizeClass(v.inputClasses),disabled:c.itemDisabled,checked:v.currentValue,name:b.groupName,onChange:u[0]||(u[0]=(...M)=>v.change&&v.change(...M)),onFocus:u[1]||(u[1]=(...M)=>v.onFocus&&v.onFocus(...M)),onBlur:u[2]||(u[2]=(...M)=>v.onBlur&&v.onBlur(...M))},null,42,ate)],2),n.renderSlot(c.$slots,"default",{},()=>[n.createTextVNode(n.toDisplayString(m.label),1)])],2)}var ew=l(ote,[["render",lte]]),_N={exports:{}};(function(c,u){(function(m,S){c.exports=S()})(Z,function(){var m=1e3,S=6e4,b=36e5,v="millisecond",M="second",N="minute",X="hour",U="day",H="week",re="month",xe="quarter",ye="year",me="date",ne="Invalid Date",Te=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Xt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_t={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Dt){var bt=["th","st","nd","rd"],ut=Dt%100;return"["+Dt+(bt[(ut-20)%10]||bt[ut]||bt[0])+"]"}},At=function(Dt,bt,ut){var Vt=String(Dt);return!Vt||Vt.length>=bt?Dt:""+Array(bt+1-Vt.length).join(ut)+Dt},He={s:At,z:function(Dt){var bt=-Dt.utcOffset(),ut=Math.abs(bt),Vt=Math.floor(ut/60),Ct=ut%60;return(bt<=0?"+":"-")+At(Vt,2,"0")+":"+At(Ct,2,"0")},m:function Dt(bt,ut){if(bt.date()<ut.date())return-Dt(ut,bt);var Vt=12*(ut.year()-bt.year())+(ut.month()-bt.month()),Ct=bt.clone().add(Vt,re),vi=ut-Ct<0,Ci=bt.clone().add(Vt+(vi?-1:1),re);return+(-(Vt+(ut-Ct)/(vi?Ct-Ci:Ci-Ct))||0)},a:function(Dt){return Dt<0?Math.ceil(Dt)||0:Math.floor(Dt)},p:function(Dt){return{M:re,y:ye,w:H,d:U,D:me,h:X,m:N,s:M,ms:v,Q:xe}[Dt]||String(Dt||"").toLowerCase().replace(/s$/,"")},u:function(Dt){return Dt===void 0}},ke="en",it={};it[ke]=_t;var qe="$isDayjsObject",Jt=function(Dt){return Dt instanceof Nt||!(!Dt||!Dt[qe])},ei=function Dt(bt,ut,Vt){var Ct;if(!bt)return ke;if(typeof bt=="string"){var vi=bt.toLowerCase();it[vi]&&(Ct=vi),ut&&(it[vi]=ut,Ct=vi);var Ci=bt.split("-");if(!Ct&&Ci.length>1)return Dt(Ci[0])}else{var _n=bt.name;it[_n]=bt,Ct=_n}return!Vt&&Ct&&(ke=Ct),Ct||!Vt&&ke},Rt=function(Dt,bt){if(Jt(Dt))return Dt.clone();var ut=typeof bt=="object"?bt:{};return ut.date=Dt,ut.args=arguments,new Nt(ut)},Et=He;Et.l=ei,Et.i=Jt,Et.w=function(Dt,bt){return Rt(Dt,{locale:bt.$L,utc:bt.$u,x:bt.$x,$offset:bt.$offset})};var Nt=function(){function Dt(ut){this.$L=ei(ut.locale,null,!0),this.parse(ut),this.$x=this.$x||ut.x||{},this[qe]=!0}var bt=Dt.prototype;return bt.parse=function(ut){this.$d=function(Vt){var Ct=Vt.date,vi=Vt.utc;if(Ct===null)return new Date(NaN);if(Et.u(Ct))return new Date;if(Ct instanceof Date)return new Date(Ct);if(typeof Ct=="string"&&!/Z$/i.test(Ct)){var Ci=Ct.match(Te);if(Ci){var _n=Ci[2]-1||0,Nn=(Ci[7]||"0").substring(0,3);return vi?new Date(Date.UTC(Ci[1],_n,Ci[3]||1,Ci[4]||0,Ci[5]||0,Ci[6]||0,Nn)):new Date(Ci[1],_n,Ci[3]||1,Ci[4]||0,Ci[5]||0,Ci[6]||0,Nn)}}return new Date(Ct)}(ut),this.init()},bt.init=function(){var ut=this.$d;this.$y=ut.getFullYear(),this.$M=ut.getMonth(),this.$D=ut.getDate(),this.$W=ut.getDay(),this.$H=ut.getHours(),this.$m=ut.getMinutes(),this.$s=ut.getSeconds(),this.$ms=ut.getMilliseconds()},bt.$utils=function(){return Et},bt.isValid=function(){return this.$d.toString()!==ne},bt.isSame=function(ut,Vt){var Ct=Rt(ut);return this.startOf(Vt)<=Ct&&Ct<=this.endOf(Vt)},bt.isAfter=function(ut,Vt){return Rt(ut)<this.startOf(Vt)},bt.isBefore=function(ut,Vt){return this.endOf(Vt)<Rt(ut)},bt.$g=function(ut,Vt,Ct){return Et.u(ut)?this[Vt]:this.set(Ct,ut)},bt.unix=function(){return Math.floor(this.valueOf()/1e3)},bt.valueOf=function(){return this.$d.getTime()},bt.startOf=function(ut,Vt){var Ct=this,vi=!!Et.u(Vt)||Vt,Ci=Et.p(ut),_n=function(It,gi){var Zi=Et.w(Ct.$u?Date.UTC(Ct.$y,gi,It):new Date(Ct.$y,gi,It),Ct);return vi?Zi:Zi.endOf(U)},Nn=function(It,gi){return Et.w(Ct.toDate()[It].apply(Ct.toDate("s"),(vi?[0,0,0,0]:[23,59,59,999]).slice(gi)),Ct)},ss=this.$W,fs=this.$M,Cr=this.$D,Io="set"+(this.$u?"UTC":"");switch(Ci){case ye:return vi?_n(1,0):_n(31,11);case re:return vi?_n(1,fs):_n(0,fs+1);case H:var Sl=this.$locale().weekStart||0,Cl=(ss<Sl?ss+7:ss)-Sl;return _n(vi?Cr-Cl:Cr+(6-Cl),fs);case U:case me:return Nn(Io+"Hours",0);case X:return Nn(Io+"Minutes",1);case N:return Nn(Io+"Seconds",2);case M:return Nn(Io+"Milliseconds",3);default:return this.clone()}},bt.endOf=function(ut){return this.startOf(ut,!1)},bt.$set=function(ut,Vt){var Ct,vi=Et.p(ut),Ci="set"+(this.$u?"UTC":""),_n=(Ct={},Ct[U]=Ci+"Date",Ct[me]=Ci+"Date",Ct[re]=Ci+"Month",Ct[ye]=Ci+"FullYear",Ct[X]=Ci+"Hours",Ct[N]=Ci+"Minutes",Ct[M]=Ci+"Seconds",Ct[v]=Ci+"Milliseconds",Ct)[vi],Nn=vi===U?this.$D+(Vt-this.$W):Vt;if(vi===re||vi===ye){var ss=this.clone().set(me,1);ss.$d[_n](Nn),ss.init(),this.$d=ss.set(me,Math.min(this.$D,ss.daysInMonth())).$d}else _n&&this.$d[_n](Nn);return this.init(),this},bt.set=function(ut,Vt){return this.clone().$set(ut,Vt)},bt.get=function(ut){return this[Et.p(ut)]()},bt.add=function(ut,Vt){var Ct,vi=this;ut=Number(ut);var Ci=Et.p(Vt),_n=function(fs){var Cr=Rt(vi);return Et.w(Cr.date(Cr.date()+Math.round(fs*ut)),vi)};if(Ci===re)return this.set(re,this.$M+ut);if(Ci===ye)return this.set(ye,this.$y+ut);if(Ci===U)return _n(1);if(Ci===H)return _n(7);var Nn=(Ct={},Ct[N]=S,Ct[X]=b,Ct[M]=m,Ct)[Ci]||1,ss=this.$d.getTime()+ut*Nn;return Et.w(ss,this)},bt.subtract=function(ut,Vt){return this.add(-1*ut,Vt)},bt.format=function(ut){var Vt=this,Ct=this.$locale();if(!this.isValid())return Ct.invalidDate||ne;var vi=ut||"YYYY-MM-DDTHH:mm:ssZ",Ci=Et.z(this),_n=this.$H,Nn=this.$m,ss=this.$M,fs=Ct.weekdays,Cr=Ct.months,Io=Ct.meridiem,Sl=function(gi,Zi,mr,fo){return gi&&(gi[Zi]||gi(Vt,vi))||mr[Zi].slice(0,fo)},Cl=function(gi){return Et.s(_n%12||12,gi,"0")},It=Io||function(gi,Zi,mr){var fo=gi<12?"AM":"PM";return mr?fo.toLowerCase():fo};return vi.replace(Xt,function(gi,Zi){return Zi||function(mr){switch(mr){case"YY":return String(Vt.$y).slice(-2);case"YYYY":return Et.s(Vt.$y,4,"0");case"M":return ss+1;case"MM":return Et.s(ss+1,2,"0");case"MMM":return Sl(Ct.monthsShort,ss,Cr,3);case"MMMM":return Sl(Cr,ss);case"D":return Vt.$D;case"DD":return Et.s(Vt.$D,2,"0");case"d":return String(Vt.$W);case"dd":return Sl(Ct.weekdaysMin,Vt.$W,fs,2);case"ddd":return Sl(Ct.weekdaysShort,Vt.$W,fs,3);case"dddd":return fs[Vt.$W];case"H":return String(_n);case"HH":return Et.s(_n,2,"0");case"h":return Cl(1);case"hh":return Cl(2);case"a":return It(_n,Nn,!0);case"A":return It(_n,Nn,!1);case"m":return String(Nn);case"mm":return Et.s(Nn,2,"0");case"s":return String(Vt.$s);case"ss":return Et.s(Vt.$s,2,"0");case"SSS":return Et.s(Vt.$ms,3,"0");case"Z":return Ci}return null}(gi)||Ci.replace(":","")})},bt.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},bt.diff=function(ut,Vt,Ct){var vi,Ci=this,_n=Et.p(Vt),Nn=Rt(ut),ss=(Nn.utcOffset()-this.utcOffset())*S,fs=this-Nn,Cr=function(){return Et.m(Ci,Nn)};switch(_n){case ye:vi=Cr()/12;break;case re:vi=Cr();break;case xe:vi=Cr()/3;break;case H:vi=(fs-ss)/6048e5;break;case U:vi=(fs-ss)/864e5;break;case X:vi=fs/b;break;case N:vi=fs/S;break;case M:vi=fs/m;break;default:vi=fs}return Ct?vi:Et.a(vi)},bt.daysInMonth=function(){return this.endOf(re).$D},bt.$locale=function(){return it[this.$L]},bt.locale=function(ut,Vt){if(!ut)return this.$L;var Ct=this.clone(),vi=ei(ut,Vt,!0);return vi&&(Ct.$L=vi),Ct},bt.clone=function(){return Et.w(this.$d,this)},bt.toDate=function(){return new Date(this.valueOf())},bt.toJSON=function(){return this.isValid()?this.toISOString():null},bt.toISOString=function(){return this.$d.toISOString()},bt.toString=function(){return this.$d.toUTCString()},Dt}(),ai=Nt.prototype;return Rt.prototype=ai,[["$ms",v],["$s",M],["$m",N],["$H",X],["$W",U],["$M",re],["$y",ye],["$D",me]].forEach(function(Dt){ai[Dt[1]]=function(bt){return this.$g(bt,Dt[0],Dt[1])}}),Rt.extend=function(Dt,bt){return Dt.$i||(Dt(bt,Nt,Rt),Dt.$i=!0),Rt},Rt.locale=ei,Rt.isDayjs=Jt,Rt.unix=function(Dt){return Rt(1e3*Dt)},Rt.en=it[ke],Rt.Ls=it,Rt.p={},Rt})})(_N);var la=_N.exports,bN=1/0,wN=9007199254740991,cte=17976931348623157e292,ON=NaN,hte="[object Function]",ute="[object GeneratorFunction]",dte="[object Symbol]",fte=/^\s+|\s+$/g,pte=/^[-+]0x[0-9a-f]+$/i,mte=/^0b[01]+$/i,gte=/^0o[0-7]+$/i,yte=/^(?:0|[1-9]\d*)$/,vte=parseInt,xte=Object.prototype,SN=xte.toString,_te=Math.ceil,bte=Math.max;function wte(c,u,m){var S=-1,b=c.length;u<0&&(u=-u>b?0:b+u),m=m>b?b:m,m<0&&(m+=b),b=u>m?0:m-u>>>0,u>>>=0;for(var v=Array(b);++S<b;)v[S]=c[S+u];return v}function Ote(c,u){return u=u??wN,!!u&&(typeof c=="number"||yte.test(c))&&c>-1&&c%1==0&&c<u}function Ste(c,u,m){if(!tw(m))return!1;var S=typeof u;return(S=="number"?Ate(m)&&Ote(u,m.length):S=="string"&&u in m)?Tte(m[u],c):!1}function Cte(c,u,m){(m?Ste(c,u,m):u===void 0)?u=1:u=bte(Bte(u),0);var S=c?c.length:0;if(!S||u<1)return[];for(var b=0,v=0,M=Array(_te(S/u));b<S;)M[v++]=wte(c,b,b+=u);return M}function Tte(c,u){return c===u||c!==c&&u!==u}function Ate(c){return c!=null&&Mte(c.length)&&!Ete(c)}function Ete(c){var u=tw(c)?SN.call(c):"";return u==hte||u==ute}function Mte(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=wN}function tw(c){var u=typeof c;return!!c&&(u=="object"||u=="function")}function kte(c){return!!c&&typeof c=="object"}function Pte(c){return typeof c=="symbol"||kte(c)&&SN.call(c)==dte}function Ite(c){if(!c)return c===0?c:0;if(c=Rte(c),c===bN||c===-bN){var u=c<0?-1:1;return u*cte}return c===c?c:0}function Bte(c){var u=Ite(c),m=u%1;return u===u?m?u-m:u:0}function Rte(c){if(typeof c=="number")return c;if(Pte(c))return ON;if(tw(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=tw(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=c.replace(fte,"");var m=mte.test(c);return m||gte.test(c)?vte(c.slice(2),m?2:8):pte.test(c)?ON:+c}var CN=Cte,TN={emits:["on-cell-click","on-cell-contextmenu"],methods:{handleCellClick(c){this.CalendarInstance.$emit("on-cell-click",c)},handleCellContextmenu(c){this.CalendarInstance.$emit("on-cell-contextmenu",c)}}};const Dte={name:"CalendarMonth",mixins:[TN],inject:["CalendarInstance"],props:{date:Object},data(){return{firstDayOfWeek:this.CalendarInstance.firstDayOfWeek,weekDays:this.CalendarInstance.locale.weekDays}},computed:{finalWeekDays(){return this.weekDays.slice(this.firstDayOfWeek).concat(this.weekDays.slice(0,this.firstDayOfWeek))},days(){let c=[];const u=la(this.date.format("YYYY-MM-01")),m=u.day(),S=this.firstDayOfWeek,b=S<=m?m-S:7-(S-m);for(let X=0;X<b;X++){const U=u.subtract(b-X,"day"),H={text:U.format("YYYY-MM-DD"),date:U.format("D"),type:"prev"};c.push(H)}const v=u.daysInMonth();for(let X=0;X<v;X++){const U=u.add(X,"day"),H={text:U.format("YYYY-MM-DD"),date:U.format("D"),type:"current"};c.push(H)}const M=42-c.length,N=u.add(1,"month");for(let X=0;X<M;X++){const U=N.add(X,"day"),H={text:U.format("YYYY-MM-DD"),date:U.format("D"),type:"next"};c.push(H)}return c},chunkDays(){return CN(this.days,7)},dayStyles(){let c={};return this.CalendarInstance.cellHeight!==100&&(c.height=`${this.CalendarInstance.cellHeight}px`),c},currentDate(){return this.date.format("YYYY-MM-DD")}},methods:{handleClickDate(c){this.CalendarInstance.handleChangeDate(la(c))}}},Lte={class:"ivu-calendar-table",cellspacing:"0",cellpadding:"0"},Nte=["onClick","onContextmenu"],Vte=["onClick"],$te={class:"ivu-calendar-table-day-title"},Ute={class:"ivu-calendar-table-day-slot"};function Fte(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("table",Lte,[n.createElementVNode("thead",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.finalWeekDays,M=>(n.openBlock(),n.createElementBlock("th",{key:M},n.toDisplayString(M),1))),128))]),n.createElementVNode("tbody",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.chunkDays,(M,N)=>(n.openBlock(),n.createElementBlock("tr",{key:N},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(M,X=>(n.openBlock(),n.createElementBlock("td",{key:X.text,onClick:U=>c.handleCellClick(X),onContextmenu:n.withModifiers(U=>c.handleCellContextmenu(X),["prevent"])},[n.createElementVNode("div",{class:n.normalizeClass(["ivu-calendar-table-day",{"ivu-calendar-table-day-other":X.type!=="current","ivu-calendar-table-day-current":X.text===v.currentDate}]),style:n.normalizeStyle(v.dayStyles),onClick:U=>v.handleClickDate(X.text)},[n.createElementVNode("div",$te,n.toDisplayString(X.date),1),n.createElementVNode("div",Ute,[n.renderSlot(c.$slots,"month",{date:new Date(X.date),data:{type:X.type+"-month",day:X.text,selected:X.text===v.currentDate}})])],14,Vte)],40,Nte))),128))]))),128))])])}var zte=l(Dte,[["render",Fte]]);const Xte={name:"CalendarYear",mixins:[TN],inject:["CalendarInstance"],props:{date:Object},data(){return{}},computed:{months(){let c=[];const u=la(this.date.format("YYYY-01-01"));for(let m=0;m<12;m++){const S=u.add(m,"month");c.push({text:S.format("YYYY-MM"),month:this.CalendarInstance.locale.months[m],type:"current"})}return c},chunkMonths(){return CN(this.months,3)},dayStyles(){let c={};return this.CalendarInstance.cellHeight!==100&&(c.height=`${this.CalendarInstance.cellHeight}px`),c},currentMonth(){return this.date.format("YYYY-MM")}},methods:{handleClickDate(c){this.CalendarInstance.handleChangeDate(la(c))}}},Wte={class:"ivu-calendar-table ivu-calendar-table-year",cellspacing:"0",cellpadding:"0"},Hte=["onClick","onContextmenu"],Gte=["onClick"],Qte={class:"ivu-calendar-table-day-title"},Yte={class:"ivu-calendar-table-day-slot"};function jte(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("table",Wte,[n.createElementVNode("tbody",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.chunkMonths,(M,N)=>(n.openBlock(),n.createElementBlock("tr",{key:N},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(M,X=>(n.openBlock(),n.createElementBlock("td",{key:X.text,onClick:U=>c.handleCellClick(X),onContextmenu:n.withModifiers(U=>c.handleCellContextmenu(X),["prevent"])},[n.createElementVNode("div",{class:n.normalizeClass(["ivu-calendar-table-day",{"ivu-calendar-table-day-current":X.text===v.currentMonth}]),style:n.normalizeStyle(v.dayStyles),onClick:U=>v.handleClickDate(X.text)},[n.createElementVNode("div",Qte,n.toDisplayString(X.month),1),n.createElementVNode("div",Yte,[n.renderSlot(c.$slots,"year",{month:new Date(X.month),data:{type:X.type+"-year",month:X.text,selected:X.text===v.currentMonth}})])],14,Gte)],40,Hte))),128))]))),128))])])}var qte=l(Xte,[["render",jte]]);const Zte={name:"Calendar",components:{CalendarMonth:zte,CalendarYear:qte,ButtonGroup:_E,Button:co,RadioGroup:Jb,Radio:ew,Icon:O},emits:["on-type-change","on-prev","on-next","on-today","on-change","update:modelValue","on-cell-click","on-cell-contextmenu"],provide(){return{CalendarInstance:this}},props:{modelValue:{type:[Date,String,Number]},type:{validator(c){return T(c,["month","year"])},default:"month"},cellHeight:{type:Number,default:100},showHeader:{type:Boolean,default:!0},headerType:{validator(c){return T(c,["simple","full"])},default:"simple"},firstDayOfWeek:{validator(c){return T(c,[1,2,3,4,5,6,7])},default:1},hideType:{type:Boolean,default:!1},locale:{type:Object,default(){return{today:"",type:{month:"",year:""},weekDays:["","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"]}}}},data(){const c=this.modelValue?this.modelValue:new Date;return{currentValue:la(c),mode:this.type}},watch:{modelValue(c){const u=c||new Date;this.currentValue=la(u)},type(c){this.mode=c}},computed:{headerTitle(){if(this.mode==="month")return this.currentValue.format("YYYY  M ");if(this.mode==="year")return this.currentValue.format("YYYY ")}},methods:{handleChangeType(c){this.$emit("on-type-change",c)},handlePrev(){const c=this.currentValue.format("YYYY-MM-01");let u;this.mode==="month"?u=la(c).subtract(1,"month"):this.mode==="year"&&(u=la(c).subtract(1,"year")),this.handleChangeDate(u),this.$emit("on-prev")},handleNext(){const c=this.currentValue.format("YYYY-MM-01");let u;this.mode==="month"?u=la(c).add(1,"month"):this.mode==="year"&&(u=la(c).add(1,"year")),this.handleChangeDate(u),this.$emit("on-next")},handleToday(){const c=la(new Date),u=c.format("YYYY-MM-DD"),m=this.currentValue.format("YYYY-MM-DD");u!==m&&this.handleChangeDate(c),this.$emit("on-today")},handleChangeDate(c){this.currentValue=c;const u=new Date(c.format("YYYY-MM-DD"));this.$emit("update:modelValue",u),this.$emit("on-change",u)}}},Kte={class:"ivu-calendar"},Jte={key:0,class:"ivu-calendar-header"},eie={class:"ivu-calendar-header-title"},tie={class:"ivu-calendar-header-action"},iie={class:"ivu-calendar-body"};function nie(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("Button"),X=n.resolveComponent("ButtonGroup"),U=n.resolveComponent("Radio"),H=n.resolveComponent("RadioGroup"),re=n.resolveComponent("CalendarMonth"),xe=n.resolveComponent("CalendarYear");return n.openBlock(),n.createElementBlock("div",Kte,[m.showHeader?(n.openBlock(),n.createElementBlock("div",Jte,[n.renderSlot(c.$slots,"header",{},()=>[n.createElementVNode("div",eie,[n.renderSlot(c.$slots,"headerTitle",{},()=>[n.createTextVNode(n.toDisplayString(v.headerTitle),1)])]),n.createElementVNode("div",tie,[m.headerType==="simple"?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createVNode(X,null,{default:n.withCtx(()=>[n.createVNode(N,{onClick:v.handlePrev},{default:n.withCtx(()=>[n.createVNode(M,{type:"ios-arrow-back"})]),_:1},8,["onClick"]),n.createVNode(N,{onClick:v.handleToday},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(m.locale.today),1)]),_:1},8,["onClick"]),n.createVNode(N,{onClick:v.handleNext},{default:n.withCtx(()=>[n.createVNode(M,{type:"ios-arrow-forward"})]),_:1},8,["onClick"])]),_:1}),m.hideType?n.createCommentVNode("",!0):(n.openBlock(),n.createBlock(H,{key:0,modelValue:b.mode,"onUpdate:modelValue":u[0]||(u[0]=ye=>b.mode=ye),type:"button",class:"ivu-ml",onOnChange:v.handleChangeType},{default:n.withCtx(()=>[n.createVNode(U,{label:"month"},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(m.locale.type.month),1)]),_:1}),n.createVNode(U,{label:"year"},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(m.locale.type.year),1)]),_:1})]),_:1},8,["modelValue","onOnChange"]))],64)):m.headerType==="full"?(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[],64)):n.createCommentVNode("",!0)])])])):n.createCommentVNode("",!0),n.createElementVNode("div",iie,[b.mode==="month"?(n.openBlock(),n.createBlock(re,{key:0,date:b.currentValue},{month:n.withCtx(({date:ye,data:me})=>[n.renderSlot(c.$slots,"month",{date:ye,data:me})]),_:3},8,["date"])):b.mode==="year"?(n.openBlock(),n.createBlock(xe,{key:1,date:b.currentValue},{year:n.withCtx(({month:ye,data:me})=>[n.renderSlot(c.$slots,"year",{month:ye,data:me})]),_:3},8,["date"])):n.createCommentVNode("",!0)])])}var AN=l(Zte,[["render",nie]]);const gh="ivu-col";function sie(c){return typeof c=="number"?`${c} ${c} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(c)?`0 0 ${c}`:c}const rie={name:"iCol",inject:["RowInstance"],props:{span:[Number,String],order:[Number,String],offset:[Number,String],push:[Number,String],pull:[Number,String],className:String,xs:[Number,Object],sm:[Number,Object],md:[Number,Object],lg:[Number,Object],xl:[Number,Object],xxl:[Number,Object],flex:{type:[Number,String],default:""}},computed:{gutter(){return this.RowInstance.gutter},classes(){let c=[`${gh}`,{[`${gh}-span-${this.span}`]:this.span,[`${gh}-order-${this.order}`]:this.order,[`${gh}-offset-${this.offset}`]:this.offset,[`${gh}-push-${this.push}`]:this.push,[`${gh}-pull-${this.pull}`]:this.pull,[`${this.className}`]:!!this.className}];return["xs","sm","md","lg","xl","xxl"].forEach(u=>{if(typeof this[u]=="number")c.push(`${gh}-span-${u}-${this[u]}`);else if(typeof this[u]=="object"){let m=this[u];Object.keys(m).forEach(S=>{c.push(S!=="span"?`${gh}-${u}-${S}-${m[S]}`:`${gh}-span-${u}-${m[S]}`)})}}),c},styles(){let c={};return this.gutter!==0&&(c={paddingLeft:this.gutter/2+"px",paddingRight:this.gutter/2+"px"}),this.flex&&(c.flex=sie(this.flex)),c}}};function oie(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.styles)},[n.renderSlot(c.$slots,"default")],6)}var pc=l(rie,[["render",oie]]);const Mf="ivu-row",aie={name:"Row",provide(){return{RowInstance:this}},props:{type:{validator(c){return T(c,["flex"])}},align:{validator(c){return T(c,["top","middle","bottom"])}},justify:{validator(c){return T(c,["start","end","center","space-around","space-between"])}},gutter:{type:Number,default:0},className:String,wrap:{type:Boolean,default:!0}},computed:{classes(){return[`${Mf}`,{[`${Mf}-${this.type}`]:!!this.type,[`${Mf}-${this.type}-${this.align}`]:!!this.align&&this.type,[`${Mf}-${this.type}-${this.justify}`]:!!this.justify&&this.type,[`${Mf}-${this.align}`]:!!this.align,[`${Mf}-${this.justify}`]:!!this.justify,[`${this.className}`]:!!this.className,[`${Mf}-no-wrap`]:!this.wrap}]},styles(){let c={};return this.gutter!==0&&(c={marginLeft:this.gutter/-2+"px",marginRight:this.gutter/-2+"px"}),c}}};function lie(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.styles)},[n.renderSlot(c.$slots,"default")],6)}var Du=l(aie,[["render",lie]]);function kf(){return kf=Object.assign||function(c){for(var u=1;u<arguments.length;u++){var m=arguments[u];for(var S in m)Object.prototype.hasOwnProperty.call(m,S)&&(c[S]=m[S])}return c},kf.apply(this,arguments)}function cie(c,u){c.prototype=Object.create(u.prototype),c.prototype.constructor=c,Qy(c,u)}function bE(c){return bE=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)},bE(c)}function Qy(c,u){return Qy=Object.setPrototypeOf||function(m,S){return m.__proto__=S,m},Qy(c,u)}function hie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iw(c,u,m){return hie()?iw=Reflect.construct:iw=function(S,b,v){var M=[null];M.push.apply(M,b);var N=Function.bind.apply(S,M),X=new N;return v&&Qy(X,v.prototype),X},iw.apply(null,arguments)}function uie(c){return Function.toString.call(c).indexOf("[native code]")!==-1}function wE(c){var u=typeof Map=="function"?new Map:void 0;return wE=function(m){if(m===null||!uie(m))return m;if(typeof m!="function")throw new TypeError("Super expression must either be null or a function");if(typeof u<"u"){if(u.has(m))return u.get(m);u.set(m,S)}function S(){return iw(m,arguments,bE(this).constructor)}return S.prototype=Object.create(m.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),Qy(S,m)},wE(c)}var die=/%[sdj%]/g,fie=function(){};function OE(c){if(!c||!c.length)return null;var u={};return c.forEach(function(m){var S=m.field;u[S]=u[S]||[],u[S].push(m)}),u}function ca(){for(var c=arguments.length,u=new Array(c),m=0;m<c;m++)u[m]=arguments[m];var S=1,b=u[0],v=u.length;if(typeof b=="function")return b.apply(null,u.slice(1));if(typeof b=="string"){var M=String(b).replace(die,function(N){if(N==="%%")return"%";if(S>=v)return N;switch(N){case"%s":return String(u[S++]);case"%d":return Number(u[S++]);case"%j":try{return JSON.stringify(u[S++])}catch{return"[Circular]"}break;default:return N}});return M}return b}function pie(c){return c==="string"||c==="url"||c==="hex"||c==="email"||c==="date"||c==="pattern"}function Zs(c,u){return!!(c==null||u==="array"&&Array.isArray(c)&&!c.length||pie(u)&&typeof c=="string"&&!c)}function mie(c,u,m){var S=[],b=0,v=c.length;function M(N){S.push.apply(S,N),b++,b===v&&m(S)}c.forEach(function(N){u(N,M)})}function EN(c,u,m){var S=0,b=c.length;function v(M){if(M&&M.length){m(M);return}var N=S;S=S+1,N<b?u(c[N],v):m([])}v([])}function gie(c){var u=[];return Object.keys(c).forEach(function(m){u.push.apply(u,c[m])}),u}var MN=function(c){cie(u,c);function u(m,S){var b;return b=c.call(this,"Async Validation Error")||this,b.errors=m,b.fields=S,b}return u}(wE(Error));function yie(c,u,m,S){if(u.first){var b=new Promise(function(re,xe){var ye=function(ne){return S(ne),ne.length?xe(new MN(ne,OE(ne))):re()},me=gie(c);EN(me,m,ye)});return b.catch(function(re){return re}),b}var v=u.firstFields||[];v===!0&&(v=Object.keys(c));var M=Object.keys(c),N=M.length,X=0,U=[],H=new Promise(function(re,xe){var ye=function(me){if(U.push.apply(U,me),X++,X===N)return S(U),U.length?xe(new MN(U,OE(U))):re()};M.length||(S(U),re()),M.forEach(function(me){var ne=c[me];v.indexOf(me)!==-1?EN(ne,m,ye):mie(ne,m,ye)})});return H.catch(function(re){return re}),H}function kN(c){return function(u){return u&&u.message?(u.field=u.field||c.fullField,u):{message:typeof u=="function"?u():u,field:u.field||c.fullField}}}function PN(c,u){if(u){for(var m in u)if(u.hasOwnProperty(m)){var S=u[m];typeof S=="object"&&typeof c[m]=="object"?c[m]=kf({},c[m],S):c[m]=S}}return c}function IN(c,u,m,S,b,v){c.required&&(!m.hasOwnProperty(c.field)||Zs(u,v||c.type))&&S.push(ca(b.messages.required,c.fullField))}function vie(c,u,m,S,b){(/^\s+$/.test(u)||u==="")&&S.push(ca(b.messages.whitespace,c.fullField))}var SE={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},Yy={integer:function(c){return Yy.number(c)&&parseInt(c,10)===c},float:function(c){return Yy.number(c)&&!Yy.integer(c)},array:function(c){return Array.isArray(c)},regexp:function(c){if(c instanceof RegExp)return!0;try{return!!new RegExp(c)}catch{return!1}},date:function(c){return typeof c.getTime=="function"&&typeof c.getMonth=="function"&&typeof c.getYear=="function"&&!isNaN(c.getTime())},number:function(c){return isNaN(c)?!1:typeof c=="number"},object:function(c){return typeof c=="object"&&!Yy.array(c)},method:function(c){return typeof c=="function"},email:function(c){return typeof c=="string"&&!!c.match(SE.email)&&c.length<255},url:function(c){return typeof c=="string"&&!!c.match(SE.url)},hex:function(c){return typeof c=="string"&&!!c.match(SE.hex)}};function xie(c,u,m,S,b){if(c.required&&u===void 0){IN(c,u,m,S,b);return}var v=["integer","float","array","regexp","object","method","email","number","date","url","hex"],M=c.type;v.indexOf(M)>-1?Yy[M](u)||S.push(ca(b.messages.types[M],c.fullField,c.type)):M&&typeof u!==c.type&&S.push(ca(b.messages.types[M],c.fullField,c.type))}function _ie(c,u,m,S,b){var v=typeof c.len=="number",M=typeof c.min=="number",N=typeof c.max=="number",X=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,U=u,H=null,re=typeof u=="number",xe=typeof u=="string",ye=Array.isArray(u);if(re?H="number":xe?H="string":ye&&(H="array"),!H)return!1;ye&&(U=u.length),xe&&(U=u.replace(X,"_").length),v?U!==c.len&&S.push(ca(b.messages[H].len,c.fullField,c.len)):M&&!N&&U<c.min?S.push(ca(b.messages[H].min,c.fullField,c.min)):N&&!M&&U>c.max?S.push(ca(b.messages[H].max,c.fullField,c.max)):M&&N&&(U<c.min||U>c.max)&&S.push(ca(b.messages[H].range,c.fullField,c.min,c.max))}var Fm="enum";function bie(c,u,m,S,b){c[Fm]=Array.isArray(c[Fm])?c[Fm]:[],c[Fm].indexOf(u)===-1&&S.push(ca(b.messages[Fm],c.fullField,c[Fm].join(", ")))}function wie(c,u,m,S,b){if(c.pattern){if(c.pattern instanceof RegExp)c.pattern.lastIndex=0,c.pattern.test(u)||S.push(ca(b.messages.pattern.mismatch,c.fullField,u,c.pattern));else if(typeof c.pattern=="string"){var v=new RegExp(c.pattern);v.test(u)||S.push(ca(b.messages.pattern.mismatch,c.fullField,u,c.pattern))}}}var qi={required:IN,whitespace:vie,type:xie,range:_ie,enum:bie,pattern:wie};function Oie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u,"string")&&!c.required)return m();qi.required(c,u,S,v,b,"string"),Zs(u,"string")||(qi.type(c,u,S,v,b),qi.range(c,u,S,v,b),qi.pattern(c,u,S,v,b),c.whitespace===!0&&qi.whitespace(c,u,S,v,b))}m(v)}function Sie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u)&&!c.required)return m();qi.required(c,u,S,v,b),u!==void 0&&qi.type(c,u,S,v,b)}m(v)}function Cie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(u===""&&(u=void 0),Zs(u)&&!c.required)return m();qi.required(c,u,S,v,b),u!==void 0&&(qi.type(c,u,S,v,b),qi.range(c,u,S,v,b))}m(v)}function Tie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u)&&!c.required)return m();qi.required(c,u,S,v,b),u!==void 0&&qi.type(c,u,S,v,b)}m(v)}function Aie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u)&&!c.required)return m();qi.required(c,u,S,v,b),Zs(u)||qi.type(c,u,S,v,b)}m(v)}function Eie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u)&&!c.required)return m();qi.required(c,u,S,v,b),u!==void 0&&(qi.type(c,u,S,v,b),qi.range(c,u,S,v,b))}m(v)}function Mie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u)&&!c.required)return m();qi.required(c,u,S,v,b),u!==void 0&&(qi.type(c,u,S,v,b),qi.range(c,u,S,v,b))}m(v)}function kie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(u==null&&!c.required)return m();qi.required(c,u,S,v,b,"array"),u!=null&&(qi.type(c,u,S,v,b),qi.range(c,u,S,v,b))}m(v)}function Pie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u)&&!c.required)return m();qi.required(c,u,S,v,b),u!==void 0&&qi.type(c,u,S,v,b)}m(v)}var Iie="enum";function Bie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u)&&!c.required)return m();qi.required(c,u,S,v,b),u!==void 0&&qi[Iie](c,u,S,v,b)}m(v)}function Rie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u,"string")&&!c.required)return m();qi.required(c,u,S,v,b),Zs(u,"string")||qi.pattern(c,u,S,v,b)}m(v)}function Die(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u,"date")&&!c.required)return m();if(qi.required(c,u,S,v,b),!Zs(u,"date")){var N;u instanceof Date?N=u:N=new Date(u),qi.type(c,N,S,v,b),N&&qi.range(c,N.getTime(),S,v,b)}}m(v)}function Lie(c,u,m,S,b){var v=[],M=Array.isArray(u)?"array":typeof u;qi.required(c,u,S,v,b,M),m(v)}function CE(c,u,m,S,b){var v=c.type,M=[],N=c.required||!c.required&&S.hasOwnProperty(c.field);if(N){if(Zs(u,v)&&!c.required)return m();qi.required(c,u,S,M,b,v),Zs(u,v)||qi.type(c,u,S,M,b)}m(M)}function Nie(c,u,m,S,b){var v=[],M=c.required||!c.required&&S.hasOwnProperty(c.field);if(M){if(Zs(u)&&!c.required)return m();qi.required(c,u,S,v,b)}m(v)}var jy={string:Oie,method:Sie,number:Cie,boolean:Tie,regexp:Aie,integer:Eie,float:Mie,array:kie,object:Pie,enum:Bie,pattern:Rie,date:Die,url:CE,hex:CE,email:CE,required:Lie,any:Nie};function TE(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var c=JSON.parse(JSON.stringify(this));return c.clone=this.clone,c}}}var AE=TE();function Lu(c){this.rules=null,this._messages=AE,this.define(c)}Lu.prototype={messages:function(c){return c&&(this._messages=PN(TE(),c)),this._messages},define:function(c){if(!c)throw new Error("Cannot configure a schema with no rules");if(typeof c!="object"||Array.isArray(c))throw new Error("Rules must be an object");this.rules={};var u,m;for(u in c)c.hasOwnProperty(u)&&(m=c[u],this.rules[u]=Array.isArray(m)?m:[m])},validate:function(c,u,m){var S=this;u===void 0&&(u={}),m===void 0&&(m=function(){});var b=c,v=u,M=m;if(typeof v=="function"&&(M=v,v={}),!this.rules||Object.keys(this.rules).length===0)return M&&M(),Promise.resolve();function N(me){var ne,Te=[],Xt={};function _t(At){if(Array.isArray(At)){var He;Te=(He=Te).concat.apply(He,At)}else Te.push(At)}for(ne=0;ne<me.length;ne++)_t(me[ne]);Te.length?Xt=OE(Te):(Te=null,Xt=null),M(Te,Xt)}if(v.messages){var X=this.messages();X===AE&&(X=TE()),PN(X,v.messages),v.messages=X}else v.messages=this.messages();var U,H,re={},xe=v.keys||Object.keys(this.rules);xe.forEach(function(me){U=S.rules[me],H=b[me],U.forEach(function(ne){var Te=ne;typeof Te.transform=="function"&&(b===c&&(b=kf({},b)),H=b[me]=Te.transform(H)),typeof Te=="function"?Te={validator:Te}:Te=kf({},Te),Te.validator=S.getValidationMethod(Te),Te.field=me,Te.fullField=Te.fullField||me,Te.type=S.getType(Te),Te.validator&&(re[me]=re[me]||[],re[me].push({rule:Te,value:H,source:b,field:me}))})});var ye={};return yie(re,v,function(me,ne){var Te=me.rule,Xt=(Te.type==="object"||Te.type==="array")&&(typeof Te.fields=="object"||typeof Te.defaultField=="object");Xt=Xt&&(Te.required||!Te.required&&me.value),Te.field=me.field;function _t(ke,it){return kf({},it,{fullField:Te.fullField+"."+ke})}function At(ke){ke===void 0&&(ke=[]);var it=ke;if(Array.isArray(it)||(it=[it]),!v.suppressWarning&&it.length&&Lu.warning("async-validator:",it),it.length&&Te.message!==void 0&&(it=[].concat(Te.message)),it=it.map(kN(Te)),v.first&&it.length)return ye[Te.field]=1,ne(it);if(!Xt)ne(it);else{if(Te.required&&!me.value)return Te.message!==void 0?it=[].concat(Te.message).map(kN(Te)):v.error&&(it=[v.error(Te,ca(v.messages.required,Te.field))]),ne(it);var qe={};if(Te.defaultField)for(var Jt in me.value)me.value.hasOwnProperty(Jt)&&(qe[Jt]=Te.defaultField);qe=kf({},qe,me.rule.fields);for(var ei in qe)if(qe.hasOwnProperty(ei)){var Rt=Array.isArray(qe[ei])?qe[ei]:[qe[ei]];qe[ei]=Rt.map(_t.bind(null,ei))}var Et=new Lu(qe);Et.messages(v.messages),me.rule.options&&(me.rule.options.messages=v.messages,me.rule.options.error=v.error),Et.validate(me.value,me.rule.options||v,function(Nt){var ai=[];it&&it.length&&ai.push.apply(ai,it),Nt&&Nt.length&&ai.push.apply(ai,Nt),ne(ai.length?ai:null)})}}var He;Te.asyncValidator?He=Te.asyncValidator(Te,me.value,At,me.source,v):Te.validator&&(He=Te.validator(Te,me.value,At,me.source,v),He===!0?At():He===!1?At(Te.message||Te.field+" fails"):He instanceof Array?At(He):He instanceof Error&&At(He.message)),He&&He.then&&He.then(function(){return At()},function(ke){return At(ke)})},function(me){N(me)})},getType:function(c){if(c.type===void 0&&c.pattern instanceof RegExp&&(c.type="pattern"),typeof c.validator!="function"&&c.type&&!jy.hasOwnProperty(c.type))throw new Error(ca("Unknown rule type %s",c.type));return c.type||"string"},getValidationMethod:function(c){if(typeof c.validator=="function")return c.validator;var u=Object.keys(c),m=u.indexOf("message");return m!==-1&&u.splice(m,1),u.length===1&&u[0]==="required"?jy.required:jy[this.getType(c)]||!1}},Lu.register=function(c,u){if(typeof u!="function")throw new Error("Cannot register a validator by type, validator is not a function");jy[c]=u},Lu.warning=fie,Lu.messages=AE,Lu.validators=jy;const qy="ivu-form-item";function BN(c,u){let m=c;u=u.replace(/\[(\w+)\]/g,".$1"),u=u.replace(/^\./,"");let S=u.split("."),b=0;for(let v=S.length;b<v-1;++b){let M=S[b];if(M in m)m=m[M];else throw new Error("[View UI warn]: please transfer a valid prop path to form item!")}return{o:m,k:S[b],v:m[S[b]]}}const Vie={name:"FormItem",inject:["FormInstance"],provide(){return{FormItemInstance:this}},props:{label:{type:String,default:""},labelWidth:{type:Number},prop:{type:String},required:{type:Boolean,default:!1},rules:{type:[Object,Array]},error:{type:String},validateStatus:{type:Boolean},showMessage:{type:Boolean,default:!0},labelFor:{type:String}},data(){return{prefixCls:qy,isRequired:!1,validateState:"",validateMessage:"",validateDisabled:!1,validator:{}}},watch:{error:{handler(c){this.validateMessage=c,this.validateState=c?"error":""},immediate:!0},validateStatus(c){this.validateState=c},rules(){this.setRules()},required(c,u){this.isRequired=c,u&&!c&&this.resetField()}},computed:{classes(){return[`${qy}`,{[`${qy}-required`]:this.required||this.isRequired,[`${qy}-error`]:this.validateState==="error",[`${qy}-validating`]:this.validateState==="validating"}]},fieldValue(){const c=this.FormInstance.model;if(!c||!this.prop)return;let u=this.prop;return u.indexOf(":")!==-1&&(u=u.replace(/:/,".")),BN(c,u).v},labelStyles(){let c={};const u=this.labelWidth===0||this.labelWidth?this.labelWidth:this.FormInstance.labelWidth;return(u||u===0)&&(c.width=`${u}px`),c},contentStyles(){let c={};const u=this.labelWidth===0||this.labelWidth?this.labelWidth:this.FormInstance.labelWidth;return(u||u===0)&&(c.marginLeft=`${u}px`),c}},methods:{setRules(){let c=this.getRules();c.length&&this.required||(c.length?c.every(u=>{this.isRequired=u.required}):this.required&&(this.isRequired=this.required))},getRules(){let c=this.FormInstance.rules;const u=this.rules;return c=c?c[this.prop]:[],[].concat(u||c||[])},getFilteredRule(c){return this.getRules().filter(u=>!u.trigger||u.trigger.indexOf(c)!==-1)},validate(c,u=function(){}){let m=this.getFilteredRule(c);if(!m||m.length===0)if(this.required)m=[{required:!0}];else return u(),!0;this.validateState="validating";let S={};S[this.prop]=m;const b=new Lu(S);let v={};v[this.prop]=this.fieldValue,b.validate(v,{firstFields:!0},M=>{this.validateState=M?"error":"success",this.validateMessage=M?M[0].message:"",u(this.validateMessage),this.FormInstance&&this.FormInstance.$emit("on-validate",this.prop,!M,this.validateMessage||null)}),this.validateDisabled=!1},resetField(){this.validateState="",this.validateMessage="";let c=this.FormInstance.model,u=this.fieldValue,m=this.prop;m.indexOf(":")!==-1&&(m=m.replace(/:/,"."));let S=BN(c,m);Array.isArray(u)&&this.initialValue!==null?(this.validateDisabled=!0,S.o[S.k]=[].concat(this.initialValue)):(this.validateDisabled=!0,S.o[S.k]=this.initialValue)},onFieldBlur(){this.validate("blur")},onFieldChange(){if(this.validateDisabled){this.validateDisabled=!1;return}this.validate("change")},formBlur(){this.onFieldBlur()},formChange(){this.onFieldChange()}},mounted(){this.prop&&(this.FormInstance.addField(this),Object.defineProperty(this,"initialValue",{value:this.fieldValue}),this.setRules())},beforeUnmount(){this.FormInstance.removeField(this)}},$ie=["for"];function Uie(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[m.label||c.$slots.label?(n.openBlock(),n.createElementBlock("label",{key:0,class:n.normalizeClass([b.prefixCls+"-label"]),for:m.labelFor,style:n.normalizeStyle(v.labelStyles)},[n.renderSlot(c.$slots,"label",{},()=>[n.createTextVNode(n.toDisplayString(m.label)+n.toDisplayString(v.FormInstance.colon),1)])],14,$ie)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content"]),style:n.normalizeStyle(v.contentStyles)},[n.renderSlot(c.$slots,"default"),n.createVNode(n.Transition,{name:"fade"},{default:n.withCtx(()=>[b.validateState==="error"&&m.showMessage&&v.FormInstance.showMessage?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-error-tip"])},n.toDisplayString(b.validateMessage),3)):n.createCommentVNode("",!0)]),_:1})],6)],2)}var nw=l(Vie,[["render",Uie]]),EE={UserName:"",Password:"",Email:"",Mobile:"",Captcha:""},Zy={inject:["LoginInstance"],emits:["on-change"],props:{rules:{type:[Object,Array],default(){const c=n.getCurrentInstance().type.name;return[{required:!0,message:EE[c],trigger:"change"}]}},value:{type:String},name:{type:String,required:!0},enterToSubmit:{type:Boolean,default:!1}},data(){return{prop:""}},methods:{handleChange(c){this.LoginInstance.formValidate[this.prop]=c,this.$emit("on-change",c)},handleEnter(){this.enterToSubmit&&this.LoginInstance.handleSubmit()},handleSetValue(){const c=this.$props;c.value&&(this.LoginInstance.formValidate[this.prop]=c.value)},handleGetProps(){let c=this.$props.name;const u={prefix:this.prefix,placeholder:this.placeholder,type:this.type,size:"large",modelValue:this.LoginInstance.formValidate[this.prop]};return c&&(u.name=c),Object.assign(u,this.$attrs)}},render(){const c=this.handleGetProps(),u=n.h(Xa,{...c,"onUpdate:modelValue":this.handleChange,"onOn-enter":this.handleEnter}),m=n.h(nw,{prop:this.prop,rules:this.rules},()=>[u]);return n.h("div",{class:this.className},[m])},created(){const c=this.name,u=Object.assign({},this.LoginInstance.formValidate);u[c]="",this.LoginInstance.formValidate=u,this.prop=c,this.handleSetValue()}};const RN={name:"Captcha",mixins:[Zy],emits:["on-get-captcha"],props:{field:{type:[String,Array]},countDown:{type:Number,default:60},text:{type:String},unitText:{type:String,default:""},beforeClick:Function},data(){return{className:"ivu-login-captcha",prefix:"ios-keypad-outline",placeholder:"",type:"text",buttonDisabled:!1,limitCountDown:0}},methods:{handleClickCaptcha(){if(this.field){const c=typeof this.field=="string"?[this.field]:this.field;this.LoginInstance.handleValidate(c,u=>{u&&this.handleBeforeGetCaptcha()})}else this.handleBeforeGetCaptcha()},handleBeforeGetCaptcha(){if(!this.beforeClick)return this.handleGetCaptcha();const c=this.beforeClick();c&&c.then?c.then(()=>{this.handleGetCaptcha()}):this.handleGetCaptcha()},handleGetCaptcha(){this.countDown>0&&(this.buttonDisabled=!0,this.limitCountDown=this.countDown,this.handleCountDown()),this.$emit("on-get-captcha",this.LoginInstance.formValidate[this.prop],JSON.parse(JSON.stringify(this.LoginInstance.formValidate)))},handleCountDown(){this.timer=setTimeout(()=>{this.limitCountDown--,this.limitCountDown===0?(this.buttonDisabled=!1,clearTimeout(this.timer)):this.handleCountDown()},1e3)}},render(){const c=this.$attrs,u=this.handleGetProps(),m={size:"large",type:"default",long:!0,disabled:this.buttonDisabled};"size"in c&&(m.size=c.size),"button-type"in c&&(m.type=c["button-type"]);let S;this.$slots.text?S=this.$slots.text:this.limitCountDown!==0?S=()=>`${this.limitCountDown} ${this.unitText}`:this.text?S=()=>this.text:S=()=>"";const b=n.h(co,{...m,onClick:this.handleClickCaptcha},S),v=n.h(Xa,{...u,"onUpdate:modelValue":this.handleChange,"onOn-enter":this.handleEnter}),M=n.h(pc,{span:16},()=>[v]),N=n.h(pc,{span:8},()=>[b]),X=n.h(Du,{gutter:8},()=>[M,N]),U=n.h(nw,{prop:this.prop,rules:this.rules},()=>[X]);return n.h("div",{class:this.className},[U])},beforeUnmount(){this.timer&&clearTimeout(this.timer)}},Pf="ivu-card",DN=16,Fie={name:"Card",mixins:[he],components:{Icon:O},props:{bordered:{type:Boolean,default:!0},disHover:{type:Boolean,default:!1},shadow:{type:Boolean,default:!1},padding:{type:Number,default:DN},title:{type:String},icon:{type:String}},data(){return{showHead:!0,showExtra:!0}},computed:{classes(){return[`${Pf}`,{[`${Pf}-bordered`]:this.bordered&&!this.shadow,[`${Pf}-dis-hover`]:this.disHover||this.shadow,[`${Pf}-shadow`]:this.shadow}]},headClasses(){return`${Pf}-head`},extraClasses(){return`${Pf}-extra`},bodyClasses(){return`${Pf}-body`},bodyStyles(){return this.padding!==DN?{padding:`${this.padding}px`}:""},isHrefPattern(){const{to:c}=this;return!!c},tagName(){const{isHrefPattern:c}=this;return c?"a":"div"},tagProps(){const{isHrefPattern:c}=this;if(c){const{linkUrl:u,target:m}=this;return{href:u,target:m}}else return{}}},methods:{handleClickLink(c){if(!this.isHrefPattern)return;const u=c.ctrlKey||c.metaKey;this.handleCheckClick(c,u)}},mounted(){this.showHead=this.title||this.$slots.title!==void 0,this.showExtra=this.$slots.extra!==void 0}},zie={key:0};function Xie(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createBlock(n.resolveDynamicComponent(v.tagName),n.mergeProps({class:v.classes},v.tagProps,{onClick:v.handleClickLink}),{default:n.withCtx(()=>[b.showHead?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.headClasses)},[n.renderSlot(c.$slots,"title",{},()=>[m.title?(n.openBlock(),n.createElementBlock("p",zie,[m.icon?(n.openBlock(),n.createBlock(M,{key:0,type:m.icon},null,8,["type"])):n.createCommentVNode("",!0),n.createElementVNode("span",null,n.toDisplayString(m.title),1)])):n.createCommentVNode("",!0)])],2)):n.createCommentVNode("",!0),b.showExtra?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass(v.extraClasses)},[n.renderSlot(c.$slots,"extra")],2)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass(v.bodyClasses),style:n.normalizeStyle(v.bodyStyles)},[n.renderSlot(c.$slots,"default")],6)]),_:3},16,["class","onClick"])}var LN=l(Fie,[["render",Xie]]);const zm="ivu-carousel",Wie={name:"Carousel",provide(){return{CarouselInstance:this}},components:{Icon:O},emits:["on-change","on-click","update:modelValue"],props:{arrow:{type:String,default:"hover",validator(c){return T(c,["hover","always","never"])}},autoplay:{type:Boolean,default:!1},autoplaySpeed:{type:Number,default:2e3},loop:{type:Boolean,default:!1},easing:{type:String,default:"ease"},dots:{type:String,default:"inside",validator(c){return T(c,["inside","outside","none"])}},radiusDot:{type:Boolean,default:!1},trigger:{type:String,default:"click",validator(c){return T(c,["click","hover"])}},modelValue:{type:Number,default:0},height:{type:[String,Number],default:"auto",validator(c){return c==="auto"||Object.prototype.toString.call(c)==="[object Number]"}}},data(){return{prefixCls:zm,listWidth:0,trackWidth:0,trackOffset:0,trackCopyOffset:0,showCopyTrack:!1,slides:[],slideInstances:[],timer:null,ready:!1,currentIndex:this.modelValue,trackIndex:this.modelValue,copyTrackIndex:this.modelValue,hideTrackPos:-1,carouselItemList:[]}},computed:{classes(){return[`${zm}`]},trackStyles(){const c=this.trackIndex===-1?"hidden":"visible";return{width:`${this.trackWidth}px`,transform:`translate3d(${-this.trackOffset}px, 0px, 0px)`,transition:`transform 500ms ${this.easing}`,visibility:c}},copyTrackStyles(){return{width:`${this.trackWidth}px`,transform:`translate3d(${-this.trackCopyOffset}px, 0px, 0px)`,transition:`transform 500ms ${this.easing}`,position:"absolute"}},arrowClasses(){return[`${zm}-arrow`,`${zm}-arrow-${this.arrow}`]},dotsClasses(){return[`${zm}-dots`,`${zm}-dots-${this.dots}`]}},methods:{findChild(c){this.carouselItemList.length&&this.carouselItemList.forEach(u=>{c(u.carouselItem)})},initCopyTrackDom(){n.nextTick(()=>{this.$refs.copyTrack.innerHTML=this.$refs.originTrack.innerHTML})},updateSlides(c){let u=[],m=1;this.findChild(S=>{u.push({$el:S.$el}),S.index=m++,c&&this.slideInstances.push(S)}),this.slides=u,this.updatePos()},updatePos(){this.findChild(c=>{c.width=this.listWidth,c.height=typeof this.height=="number"?`${this.height}px`:this.height}),this.trackWidth=(this.slides.length||0)*this.listWidth},slotChange(){n.nextTick(()=>{this.slides=[],this.slideInstances=[],this.updateSlides(!0,!0),this.updatePos(),this.updateOffset()})},handleResize(){this.listWidth=parseInt(k(this.$el,"width")),this.updatePos(),this.updateOffset()},updateTrackPos(c){this.showCopyTrack?this.trackIndex=c:this.copyTrackIndex=c},updateTrackIndex(c){this.showCopyTrack?this.copyTrackIndex=c:this.trackIndex=c,this.currentIndex=c},add(c){let u=this.slides.length;this.loop&&(c>0?this.hideTrackPos=-1:this.hideTrackPos=u,this.updateTrackPos(this.hideTrackPos));const m=this.showCopyTrack?this.copyTrackIndex:this.trackIndex;let S=m+c;for(;S<0;)S+=u;(c>0&&S===u||c<0&&S===u-1)&&this.loop?(this.showCopyTrack=!this.showCopyTrack,this.trackIndex+=c,this.copyTrackIndex+=c):(this.loop||(S=S%this.slides.length),this.updateTrackIndex(S)),this.currentIndex=S===this.slides.length?0:S,this.$emit("on-change",m,this.currentIndex),this.$emit("update:modelValue",this.currentIndex)},arrowEvent(c){this.setAutoplay(),this.add(c)},dotsEvent(c,u){let m=this.showCopyTrack?this.copyTrackIndex:this.trackIndex;const S=this.currentIndex;c===this.trigger&&m!==u&&(this.updateTrackIndex(u),this.$emit("on-change",S,this.currentIndex),this.$emit("update:modelValue",u),this.setAutoplay())},setAutoplay(){!r||(window.clearInterval(this.timer),this.autoplay&&(this.timer=window.setInterval(()=>{this.add(1)},this.autoplaySpeed)))},updateOffset(){n.nextTick(()=>{let c=this.copyTrackIndex>0?-1:1;this.trackOffset=this.trackIndex*this.listWidth,this.trackCopyOffset=this.copyTrackIndex*this.listWidth+c})},handleClick(c){this.$emit("on-click",this[c])}},watch:{autoplay(){this.setAutoplay()},autoplaySpeed(){this.setAutoplay()},trackIndex(){this.updateOffset()},copyTrackIndex(){this.updateOffset()},height(){this.updatePos()},modelValue(c){this.updateTrackIndex(c),this.setAutoplay()}},mounted(){this.updateSlides(!0),this.handleResize(),this.setAutoplay(),o(window,"resize",this.handleResize)},beforeUnmount(){a(window,"resize",this.handleResize)}},Hie=["onClick","onMouseover"];function Gie(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.createElementVNode("button",{type:"button",class:n.normalizeClass([v.arrowClasses,"left"]),onClick:u[0]||(u[0]=N=>v.arrowEvent(-1))},[n.createVNode(M,{type:"ios-arrow-back"})],2),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-list"])},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-track",b.showCopyTrack?"":"higher"]),style:n.normalizeStyle(v.trackStyles),ref:"originTrack",onClick:u[1]||(u[1]=N=>v.handleClick("currentIndex"))},[n.renderSlot(c.$slots,"default")],6),m.loop?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-track",b.showCopyTrack?"higher":""]),style:n.normalizeStyle(v.copyTrackStyles),ref:"copyTrack",onClick:u[2]||(u[2]=N=>v.handleClick("copyTrackIndex"))},null,6)):n.createCommentVNode("",!0)],2),n.createElementVNode("button",{type:"button",class:n.normalizeClass([v.arrowClasses,"right"]),onClick:u[3]||(u[3]=N=>v.arrowEvent(1))},[n.createVNode(M,{type:"ios-arrow-forward"})],2),n.createElementVNode("ul",{class:n.normalizeClass(v.dotsClasses)},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(b.slides.length,N=>(n.openBlock(),n.createElementBlock("li",{key:N,class:n.normalizeClass([N-1===b.currentIndex?b.prefixCls+"-active":""]),onClick:X=>v.dotsEvent("click",N-1),onMouseover:X=>v.dotsEvent("hover",N-1)},[n.createElementVNode("button",{type:"button",class:n.normalizeClass([m.radiusDot?"radius":""])},null,2)],42,Hie))),128))],2)],2)}var NN=l(Wie,[["render",Gie]]);const Qie="ivu-carousel-item",Yie={componentName:"carousel-item",name:"CarouselItem",inject:["CarouselInstance"],data(){return{prefixCls:Qie,width:0,height:"auto",left:0,id:te(6)}},computed:{styles(){return{width:`${this.width}px`,height:`${this.height}`,left:`${this.left}px`}}},watch:{width(c){c&&this.CarouselInstance.loop&&n.nextTick(()=>{this.CarouselInstance.initCopyTrackDom()})},height(c){c&&this.CarouselInstance.loop&&n.nextTick(()=>{this.CarouselInstance.initCopyTrackDom()})}},methods:{addInstance(){const c=this.CarouselInstance;c.carouselItemList||(c.carouselItemList=[]),c.carouselItemList.push({id:this.id,carouselItem:this})},removeInstance(){const c=this.CarouselInstance;if(!c.carouselItemList)return;const u=c.carouselItemList.findIndex(m=>m.id===this.id);c.carouselItemList.splice(u,1)}},mounted(){this.addInstance(),this.CarouselInstance.slotChange()},beforeUnmount(){this.removeInstance(),this.CarouselInstance.slotChange()}};function jie(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(b.prefixCls),style:n.normalizeStyle(v.styles)},[n.renderSlot(c.$slots,"default")],6)}var VN=l(Yie,[["render",jie]]);const qie={name:"Casitem",components:{Icon:O},mixins:[xl],props:{data:Object,prefixCls:String,tmpItem:Object},computed:{classes(){return[`${this.prefixCls}-menu-item`,{[`${this.prefixCls}-menu-item-active`]:this.tmpItem.value===this.data.value,[`${this.prefixCls}-menu-item-disabled`]:this.data.disabled}]},showArrow(){return this.data.children&&this.data.children.length||"loading"in this.data&&!this.data.loading},showLoading(){return"loading"in this.data&&this.data.loading},arrowType(){const c=this.globalConfig;let u="ios-arrow-forward";return c&&(c.cascader.customItemArrow?u="":c.cascader.itemArrow&&(u=c.cascader.itemArrow)),u},customArrowType(){const c=this.globalConfig;let u="";return c&&c.cascader.customItemArrow&&(u=c.cascader.customItemArrow),u},arrowSize(){const c=this.globalConfig;let u="";return c&&c.cascader.itemArrowSize&&(u=c.cascader.itemArrowSize),u}}},Zie={key:1,class:"ivu-icon ivu-icon-ios-loading ivu-load-loop ivu-cascader-menu-item-loading"};function Kie(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(v.classes)},[n.createTextVNode(n.toDisplayString(m.data.label)+" ",1),v.showArrow?(n.openBlock(),n.createBlock(M,{key:0,type:v.arrowType,custom:v.customArrowType,size:v.arrowSize},null,8,["type","custom","size"])):n.createCommentVNode("",!0),v.showLoading?(n.openBlock(),n.createElementBlock("i",Zie)):n.createCommentVNode("",!0)],2)}var Jie=l(qie,[["render",Kie]]);let ene=1;const tne={name:"Caspanel",components:{Casitem:Jie},inject:["CascaderInstance"],provide(){return{CaspanelInstance:this}},props:{data:{type:Array,default(){return[]}},disabled:Boolean,changeOnSelect:Boolean,trigger:String,prefixCls:String},data(){return{tmpItem:{},result:[],sublist:[],id:te(6),childCaspanelList:[]}},watch:{data(){this.sublist=[]}},methods:{handleClickItem(c){this.trigger!=="click"&&c.children&&c.children.length||this.handleTriggerItem(c,!1,!0)},handleHoverItem(c){this.trigger!=="hover"||!c.children||!c.children.length||this.handleTriggerItem(c,!1,!0)},handleTriggerItem(c,u=!1,m=!1){if(c.disabled)return;const S=F(this,"Cascader");if(c.loading!==void 0&&!c.children.length&&S&&S.loadData){S.loadData(c,()=>{m&&(S.isLoadedChildren=!0),c.children.length&&this.handleTriggerItem(c)});return}const b=this.getBaseItem(c);(this.changeOnSelect||b.label!==this.tmpItem.label||b.value!==this.tmpItem.value||b.label===this.tmpItem.label&&b.value===this.tmpItem.value)&&(this.tmpItem=b,this.emitUpdate([b])),c.children&&c.children.length?(this.sublist=c.children,this.CascaderInstance.handleOnResultChange({lastValue:!1,changeOnSelect:this.changeOnSelect,fromInit:u}),this.changeOnSelect&&this.childCaspanelList.length&&this.childCaspanelList[0].caspanel.handleOnClear(!0)):(this.sublist=[],this.CascaderInstance.handleOnResultChange({lastValue:!0,changeOnSelect:this.changeOnSelect,fromInit:u})),S&&S.$refs.drop.update()},updateResult(c){this.result=[this.tmpItem].concat(c),this.emitUpdate(this.result)},getBaseItem(c){let u=Object.assign({},c);return u.children&&delete u.children,u},emitUpdate(c){this.$parent.$options.name==="Caspanel"?this.$parent.updateResult(c):this.CascaderInstance.updateResult(c)},getKey(){return ene++},handleOnFindSelected(c){let u=[...c.value];for(let m=0;m<u.length;m++)for(let S=0;S<this.data.length;S++)if(u[m]===this.data[S].value)return this.handleTriggerItem(this.data[S],!0),u.splice(0,1),n.nextTick(()=>{this.childCaspanelList.length&&this.childCaspanelList[0].caspanel.handleOnFindSelected({value:u})}),!1},handleOnClear(c=!1){this.sublist=[],this.tmpItem={},c&&this.childCaspanelList.length&&this.childCaspanelList[0].caspanel.handleOnClear(!0)},addCaspanel(){const c=this.CascaderInstance;c.caspanelList||(c.caspanelList=[]),c.caspanelList.push({id:this.id,caspanel:this});const u=F(this,"Caspanel");u&&(u.childCaspanelList||(u.childCaspanelList=[]),u.childCaspanelList.push({id:this.id,caspanel:this}))},removeCaspanel(){const c=this.CascaderInstance;if(c.caspanelList&&c.caspanelList.length){const m=c.caspanelList.findIndex(S=>S.id===this.id);c.caspanelList.splice(m,1)}const u=F(this,"Caspanel");if(u&&u.childCaspanelList&&u.childCaspanelList.length){const m=u.childCaspanelList.findIndex(S=>S.id===this.id);u.childCaspanelList.splice(m,1)}}},mounted(){this.addCaspanel()},beforeUnmount(){this.removeCaspanel()}};function ine(c,u,m,S,b,v){const M=n.resolveComponent("Casitem"),N=n.resolveComponent("Caspanel",!0);return n.openBlock(),n.createElementBlock("span",null,[m.data&&m.data.length?(n.openBlock(),n.createElementBlock("ul",{key:0,class:n.normalizeClass([m.prefixCls+"-menu"])},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.data,(X,U)=>(n.openBlock(),n.createBlock(M,{key:U,"prefix-cls":m.prefixCls,data:X,"tmp-item":b.tmpItem,onClick:n.withModifiers(H=>v.handleClickItem(X),["stop"]),onMouseenter:n.withModifiers(H=>v.handleHoverItem(X),["stop"])},null,8,["prefix-cls","data","tmp-item","onClick","onMouseenter"]))),128))],2)):n.createCommentVNode("",!0),b.sublist&&b.sublist.length?(n.openBlock(),n.createBlock(N,{key:1,"prefix-cls":m.prefixCls,data:b.sublist,disabled:m.disabled,trigger:m.trigger,"change-on-select":m.changeOnSelect},null,8,["prefix-cls","data","disabled","trigger","change-on-select"])):n.createCommentVNode("",!0)])}var nne=l(tne,[["render",ine]]),ME={beforeMount(c,u,m){function S(b){if(c.contains(b.target))return!1;u.value(b)}c.__vueClickOutside__=S,r&&document.addEventListener("click",S)},unmounted(c,u){r&&document.removeEventListener("click",c.__vueClickOutside__),delete c.__vueClickOutside__}};const Nu="ivu-cascader",sne="ivu-select",rne={name:"Cascader",mixins:[Sn,Li,xl],components:{iInput:Xa,Drop:Ke,Icon:O,Caspanel:nne},directives:{clickOutside:ME},emits:["on-change","on-visible-change","update:modelValue"],provide(){return{CascaderInstance:this}},props:{data:{type:Array,default(){return[]}},modelValue:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},placeholder:{type:String},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},trigger:{validator(c){return T(c,["click","hover"])},default:"click"},changeOnSelect:{type:Boolean,default:!1},renderFormat:{type:Function,default(c){return c.join(" / ")}},loadData:{type:Function},filterable:{type:Boolean,default:!1},notFoundText:{type:String},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},capture:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},transferClassName:{type:String},eventsEnabled:{type:Boolean,default:!1}},data(){return{prefixCls:Nu,selectPrefixCls:sne,visible:!1,selected:[],tmpSelected:[],updatingValue:!1,currentValue:this.modelValue||[],query:"",validDataStr:"",isLoadedChildren:!1,isValueNull:!1,caspanelList:[]}},computed:{classes(){return[`${Nu}`,{[`${Nu}-show-clear`]:this.showCloseIcon,[`${Nu}-size-${this.size}`]:!!this.size,[`${Nu}-visible`]:this.visible,[`${Nu}-disabled`]:this.itemDisabled,[`${Nu}-not-found`]:this.filterable&&this.query!==""&&!this.querySelections.length}]},showCloseIcon(){return this.currentValue&&this.currentValue.length&&this.clearable&&!this.itemDisabled},displayRender(){let c=[];for(let u=0;u<this.selected.length;u++)c.push(this.selected[u].label);return this.renderFormat(c,this.selected)},displayInputRender(){return this.filterable?"":this.displayRender},localePlaceholder(){return this.placeholder===void 0?this.t("i.select.placeholder"):this.placeholder},inputPlaceholder(){return this.filterable&&this.currentValue.length?null:this.localePlaceholder},localeNotFoundText(){return this.notFoundText===void 0?this.t("i.select.noMatch"):this.notFoundText},querySelections(){let c=[];function u(m,S,b){const v=L(m);for(let M=0;M<v.length;M++){let N=v[M];N.__label=S?S+" / "+N.label:N.label,N.__value=b?b+","+N.value:N.value,N.children&&N.children.length?(u(N.children,N.__label,N.__value),delete N.__label,delete N.__value):c.push({label:N.__label,value:N.__value,display:N.__label,item:N,disabled:!!N.disabled})}}return u(this.data),c=c.filter(m=>m.label?m.label.indexOf(this.query)>-1:!1).map(m=>(m.display=m.display.replace(new RegExp(this.query,"g"),`<span>${this.query}</span>`),m)),c},arrowType(){const c=this.globalConfig;let u="ios-arrow-down";return c&&(c.cascader.customArrow?u="":c.cascader.arrow&&(u=c.cascader.arrow)),u},customArrowType(){const c=this.globalConfig;let u="";return c&&c.cascader.customArrow&&(u=c.cascader.customArrow),u},arrowSize(){const c=this.globalConfig;let u="";return c&&c.cascader.arrowSize&&(u=c.cascader.arrowSize),u},dropdownCls(){return{[Nu+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}}},methods:{clearSelect(){if(this.itemDisabled)return!1;const c=JSON.stringify(this.currentValue);this.currentValue=this.selected=this.tmpSelected=[],this.handleClose(),this.emitValue(this.currentValue,c),this.caspanelList.forEach(u=>{u.caspanel.handleOnClear()})},handleClose(){this.visible=!1},toggleOpen(){if(this.itemDisabled)return!1;this.visible?this.filterable||this.handleClose():this.onFocus()},onFocus(){this.visible=!0,this.currentValue.length||this.caspanelList.forEach(c=>{c.caspanel.handleOnClear()})},updateResult(c){this.tmpSelected=c},updateSelected(c=!1,u=!1){(!this.changeOnSelect||c||u)&&this.caspanelList.forEach(m=>{m.caspanel.handleOnFindSelected({value:this.currentValue})})},emitValue(c,u){JSON.stringify(c)!==u&&(this.$emit("on-change",this.currentValue,JSON.parse(JSON.stringify(this.selected))),n.nextTick(()=>{this.handleFormItemChange("change",{value:this.currentValue,selected:JSON.parse(JSON.stringify(this.selected))})}))},handleInput(c){this.query=c.target.value},handleSelectItem(c){const u=this.querySelections[c];if(u.item.disabled)return!1;this.query="",this.$refs.input.currentValue="";const m=JSON.stringify(this.currentValue);this.currentValue=u.value.split(","),setTimeout(()=>{this.emitValue(this.currentValue,m),this.handleClose()},0)},handleFocus(){this.$refs.input.focus()},getValidData(c){const u=L(c);function m(S){const b=Object.assign({},S);return"loading"in b&&delete b.loading,"__value"in b&&delete b.__value,"__label"in b&&delete b.__label,"children"in b&&b.children.length&&(b.children=b.children.map(v=>m(v))),b}return u.map(S=>m(S))},handleOnResultChange(c){const u=c.lastValue,m=c.changeOnSelect,S=c.fromInit;if(u||m){const b=JSON.stringify(this.currentValue);this.selected=this.tmpSelected;let v=[];this.selected.forEach(M=>{v.push(M.value)}),S||(this.updatingValue=!0,this.currentValue=v,this.emitValue(this.currentValue,b))}u&&!S&&this.handleClose()}},created(){this.validDataStr=JSON.stringify(this.getValidData(this.data))},mounted(){this.updateSelected(!0)},watch:{visible(c){c?(this.currentValue.length&&this.updateSelected(),this.transfer&&this.$refs.drop.update(),this.$refs.drop.handleOnUpdatePopper()):(this.filterable&&(this.query="",this.$refs.input.currentValue=""),this.transfer&&this.$refs.drop.destroy(),this.$refs.drop.handleOnDestroyPopper()),this.$emit("on-visible-change",c)},modelValue(c){c===null&&(this.isValueNull=!0),this.currentValue=c||[],(c===null||!c.length)&&(this.selected=[])},currentValue(){if(this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",this.currentValue),this.updatingValue){this.updatingValue=!1;return}this.updateSelected(!0)},data:{deep:!0,handler(){const c=JSON.stringify(this.getValidData(this.data));c!==this.validDataStr&&(this.validDataStr=c,this.isLoadedChildren||n.nextTick(()=>this.updateSelected(!1,this.changeOnSelect)),this.isLoadedChildren=!1)}}}},one=["name","value"],ane=["onClick","innerHTML"];function lne(c,u,m,S,b,v){const M=n.resolveComponent("i-input"),N=n.resolveComponent("Icon"),X=n.resolveComponent("Caspanel"),U=n.resolveComponent("Drop"),H=n.resolveDirective("click-outside");return n.withDirectives((n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-rel"]),onClick:u[1]||(u[1]=(...re)=>v.toggleOpen&&v.toggleOpen(...re)),ref:"reference"},[n.createElementVNode("input",{type:"hidden",name:m.name,value:b.currentValue},null,8,one),n.renderSlot(c.$slots,"default",{},()=>[n.createVNode(M,{"element-id":m.elementId,ref:"input",readonly:!m.filterable,disabled:c.itemDisabled,modelValue:v.displayInputRender,onOnChange:v.handleInput,size:m.size,placeholder:v.inputPlaceholder},null,8,["element-id","readonly","disabled","modelValue","onOnChange","size","placeholder"]),n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-label"]),onClick:u[0]||(u[0]=(...re)=>v.handleFocus&&v.handleFocus(...re))},n.toDisplayString(v.displayRender),3),[[n.vShow,m.filterable&&b.query===""]]),n.withDirectives(n.createVNode(N,{type:"ios-close-circle",class:n.normalizeClass([b.prefixCls+"-arrow"]),onClick:n.withModifiers(v.clearSelect,["stop"])},null,8,["class","onClick"]),[[n.vShow,v.showCloseIcon]]),n.createVNode(N,{type:v.arrowType,custom:v.customArrowType,size:v.arrowSize,class:n.normalizeClass([b.prefixCls+"-arrow"])},null,8,["type","custom","size","class"])])],2),n.createVNode(U,{ref:"drop",visible:b.visible,classes:v.dropdownCls,eventsEnabled:m.eventsEnabled,"transition-name":"transition-drop",transfer:m.transfer},{default:n.withCtx(()=>[n.createElementVNode("div",null,[n.withDirectives(n.createVNode(X,{ref:"caspanel","prefix-cls":b.prefixCls,data:m.data,disabled:c.itemDisabled,"change-on-select":m.changeOnSelect,trigger:m.trigger},null,8,["prefix-cls","data","disabled","change-on-select","trigger"]),[[n.vShow,!m.filterable||m.filterable&&b.query===""]]),n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-dropdown"])},[n.createElementVNode("ul",{class:n.normalizeClass([b.selectPrefixCls+"-dropdown-list"])},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.querySelections,(re,xe)=>(n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass([b.selectPrefixCls+"-item",{[b.selectPrefixCls+"-item-disabled"]:re.disabled}]),key:xe,onClick:ye=>v.handleSelectItem(xe),innerHTML:re.display},null,10,ane))),128))],2)],2),[[n.vShow,m.filterable&&b.query!==""&&v.querySelections.length]]),n.withDirectives(n.createElementVNode("ul",{class:n.normalizeClass([b.prefixCls+"-not-found-tip"])},[n.createElementVNode("li",null,n.toDisplayString(v.localeNotFoundText),1)],2),[[n.vShow,m.filterable&&b.query!==""&&!v.querySelections.length||!m.data.length]])])]),_:1},8,["visible","classes","eventsEnabled","transfer"])],2)),[[H,v.handleClose]])}var $N=l(rne,[["render",lne]]);const cne={name:"CellItem",props:{title:{type:String,default:""},label:{type:String,default:""},extra:{type:String,default:""}}},hne={class:"ivu-cell-item"},une={class:"ivu-cell-icon"},dne={class:"ivu-cell-main"},fne={class:"ivu-cell-title"},pne={class:"ivu-cell-label"},mne={class:"ivu-cell-footer"},gne={class:"ivu-cell-extra"};function yne(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",hne,[n.createElementVNode("div",une,[n.renderSlot(c.$slots,"icon")]),n.createElementVNode("div",dne,[n.createElementVNode("div",fne,[n.renderSlot(c.$slots,"default",{},()=>[n.createTextVNode(n.toDisplayString(m.title),1)])]),n.createElementVNode("div",pne,[n.renderSlot(c.$slots,"label",{},()=>[n.createTextVNode(n.toDisplayString(m.label),1)])])]),n.createElementVNode("div",mne,[n.createElementVNode("span",gne,[n.renderSlot(c.$slots,"extra",{},()=>[n.createTextVNode(n.toDisplayString(m.extra),1)])])])])}var vne=l(cne,[["render",yne]]);const Ky="ivu-cell",xne={name:"Cell",inject:["CellGroupInstance"],mixins:[he,xl],components:{CellItem:vne,Icon:O},props:{name:{type:[String,Number]},title:{type:String,default:""},label:{type:String,default:""},extra:{type:String,default:""},disabled:{type:Boolean,default:!1},selected:{type:Boolean,default:!1}},data(){return{prefixCls:Ky}},computed:{classes(){return[`${Ky}`,{[`${Ky}-disabled`]:this.disabled,[`${Ky}-selected`]:this.selected,[`${Ky}-with-link`]:this.to}]},arrowType(){const c=this.globalConfig;let u="ios-arrow-forward";return c&&(c.cell.customArrow?u="":c.cell.arrow&&(u=c.cell.arrow)),u},customArrowType(){const c=this.globalConfig;let u="";return c&&c.cell.customArrow&&(u=c.cell.customArrow),u},arrowSize(){const c=this.globalConfig;let u="";return c&&c.cell.arrowSize&&(u=c.cell.arrowSize),u}},methods:{handleClickItem(c,u){this.CellGroupInstance.handleClick(this.name),this.handleCheckClick(c,u)}}},_ne=["href","target"],bne={key:2,class:"ivu-cell-arrow"};function wne(c,u,m,S,b,v){const M=n.resolveComponent("CellItem"),N=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[c.to?(n.openBlock(),n.createElementBlock("a",{key:0,href:c.linkUrl,target:c.target,class:"ivu-cell-link",onClick:[u[0]||(u[0]=n.withModifiers(X=>v.handleClickItem(X,!1),["exact"])),u[1]||(u[1]=n.withModifiers(X=>v.handleClickItem(X,!0),["ctrl"])),u[2]||(u[2]=n.withModifiers(X=>v.handleClickItem(X,!0),["meta"]))]},[n.createVNode(M,{title:m.title,label:m.label,extra:m.extra},{icon:n.withCtx(()=>[n.renderSlot(c.$slots,"icon")]),default:n.withCtx(()=>[n.renderSlot(c.$slots,"default")]),extra:n.withCtx(()=>[n.renderSlot(c.$slots,"extra")]),label:n.withCtx(()=>[n.renderSlot(c.$slots,"label")]),_:3},8,["title","label","extra"])],8,_ne)):(n.openBlock(),n.createElementBlock("div",{key:1,class:"ivu-cell-link",onClick:u[3]||(u[3]=(...X)=>v.handleClickItem&&v.handleClickItem(...X))},[n.createVNode(M,{title:m.title,label:m.label,extra:m.extra},{icon:n.withCtx(()=>[n.renderSlot(c.$slots,"icon")]),default:n.withCtx(()=>[n.renderSlot(c.$slots,"default")]),extra:n.withCtx(()=>[n.renderSlot(c.$slots,"extra")]),label:n.withCtx(()=>[n.renderSlot(c.$slots,"label")]),_:3},8,["title","label","extra"])])),c.to?(n.openBlock(),n.createElementBlock("div",bne,[n.renderSlot(c.$slots,"arrow",{},()=>[n.createVNode(N,{type:v.arrowType,custom:v.customArrowType,size:v.arrowSize},null,8,["type","custom","size"])])])):n.createCommentVNode("",!0)],2)}var UN=l(xne,[["render",wne]]);const One={name:"CellGroup",emits:["on-click"],provide(){return{CellGroupInstance:this}},methods:{handleClick(c){this.$emit("on-click",c)}}},Sne={class:"ivu-cell-group"};function Cne(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",Sne,[n.renderSlot(c.$slots,"default")])}var FN=l(One,[["render",Cne]]);const ha="ivu-checkbox",Tne={name:"Checkbox",mixins:[Li],emits:["update:modelValue","on-change"],inject:{CheckboxGroupInstance:{default:null}},props:{disabled:{type:Boolean,default:!1},modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},label:{type:[String,Number,Boolean]},indeterminate:{type:Boolean,default:!1},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},name:{type:String},border:{type:Boolean,default:!1}},data(){return{showSlot:!0,focusInner:!1,model:[]}},computed:{wrapClasses(){return[`${ha}-wrapper`,{[`${ha}-group-item`]:this.group,[`${ha}-wrapper-checked`]:this.currentValue,[`${ha}-wrapper-disabled`]:this.itemDisabled,[`${ha}-${this.size}`]:!!this.size,[`${ha}-border`]:this.border}]},checkboxClasses(){return[`${ha}`,{[`${ha}-checked`]:this.currentValue,[`${ha}-disabled`]:this.itemDisabled,[`${ha}-indeterminate`]:this.indeterminate}]},innerClasses(){return[`${ha}-inner`,{[`${ha}-focus`]:this.focusInner}]},inputClasses(){return`${ha}-input`},currentValue(){return this.CheckboxGroupInstance?this.CheckboxGroupInstance.modelValue.indexOf(this.label)>=0:this.modelValue===this.trueValue},group(){return!!this.CheckboxGroupInstance}},mounted(){this.CheckboxGroupInstance||(this.showSlot=this.$slots.default!==void 0)},methods:{change(c){if(this.itemDisabled)return!1;const u=c.target.checked?this.trueValue:this.falseValue;this.$emit("update:modelValue",u),this.group?this.CheckboxGroupInstance.change(this.model):(this.$emit("on-change",u),this.handleFormItemChange("change",u))},onBlur(){this.focusInner=!1},onFocus(){this.focusInner=!0}},watch:{modelValue(c){if(!(c===this.trueValue||c===this.falseValue))throw"Value should be trueValue or falseValue."},"CheckboxGroupInstance.modelValue":{handler(c){this.model=c||[]},immediate:!0}}},Ane=["disabled","value","name"],Ene=["disabled","checked","name"],Mne={key:0,class:"ivu-checkbox-label-text"};function kne(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("label",{class:n.normalizeClass(v.wrapClasses)},[n.createElementVNode("span",{class:n.normalizeClass(v.checkboxClasses)},[n.createElementVNode("span",{class:n.normalizeClass(v.innerClasses)},null,2),v.group?n.withDirectives((n.openBlock(),n.createElementBlock("input",{key:0,type:"checkbox",class:n.normalizeClass(v.inputClasses),disabled:c.itemDisabled,value:m.label,"onUpdate:modelValue":u[0]||(u[0]=M=>b.model=M),name:m.name,onChange:u[1]||(u[1]=(...M)=>v.change&&v.change(...M)),onFocus:u[2]||(u[2]=(...M)=>v.onFocus&&v.onFocus(...M)),onBlur:u[3]||(u[3]=(...M)=>v.onBlur&&v.onBlur(...M))},null,42,Ane)),[[n.vModelCheckbox,b.model]]):(n.openBlock(),n.createElementBlock("input",{key:1,type:"checkbox",class:n.normalizeClass(v.inputClasses),disabled:c.itemDisabled,checked:v.currentValue,name:m.name,onChange:u[4]||(u[4]=(...M)=>v.change&&v.change(...M)),onFocus:u[5]||(u[5]=(...M)=>v.onFocus&&v.onFocus(...M)),onBlur:u[6]||(u[6]=(...M)=>v.onBlur&&v.onBlur(...M))},null,42,Ene))],2),b.showSlot?(n.openBlock(),n.createElementBlock("span",Mne,[n.renderSlot(c.$slots,"default",{},()=>[n.createTextVNode(n.toDisplayString(m.label),1)])])):n.createCommentVNode("",!0)],2)}var Xm=l(Tne,[["render",kne]]);const Pne="ivu-checkbox-group",Ine={name:"CheckboxGroup",mixins:[Li],emits:["update:modelValue","on-change"],provide(){return{CheckboxGroupInstance:this}},props:{modelValue:{type:Array,default(){return[]}},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}}},data(){return{currentValue:this.modelValue||[],children:[]}},computed:{classes(){return[`${Pne}`,{[`ivu-checkbox-${this.size}`]:!!this.size}]}},methods:{change(c){this.currentValue=c,this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c)}}};function Bne(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.renderSlot(c.$slots,"default")],2)}var kE=l(Ine,[["render",Bne]]);const zN="ivu-chart-circle",Rne={name:"iCircle",props:{percent:{type:Number,default:0},size:{type:Number,default:120},strokeWidth:{type:Number,default:6},strokeColor:{type:[String,Array],default:"#2d8cf0"},strokeLinecap:{validator(c){return T(c,["square","round"])},default:"round"},trailWidth:{type:Number,default:5},trailColor:{type:String,default:"#eaeef2"},dashboard:{type:Boolean,default:!1}},data(){return{id:`ivu-chart-circle-${te(3)}`}},computed:{circleSize(){return{width:`${this.size}px`,height:`${this.size}px`}},computedStrokeWidth(){return this.percent===0&&this.dashboard?0:this.strokeWidth},radius(){return 50-this.strokeWidth/2},pathString(){return this.dashboard?`M 50,50 m 0,${this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,-${2*this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,${2*this.radius}`:`M 50,50 m 0,-${this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,${2*this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,-${2*this.radius}`},len(){return Math.PI*2*this.radius},trailStyle(){let c={};return this.dashboard&&(c={"stroke-dasharray":`${this.len-75}px ${this.len}px`,"stroke-dashoffset":`-${75/2}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s"}),c},pathStyle(){let c={};return this.dashboard?c={"stroke-dasharray":`${this.percent/100*(this.len-75)}px ${this.len}px`,"stroke-dashoffset":`-${75/2}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .6s ease 0s, stroke .6s, stroke-width .06s ease .6s"}:c={"stroke-dasharray":`${this.len}px ${this.len}px`,"stroke-dashoffset":`${(100-this.percent)/100*this.len}px`,transition:"stroke-dashoffset 0.6s ease 0s, stroke 0.6s ease"},c},wrapClasses(){return`${zN}`},innerClasses(){return`${zN}-inner`},strokeValue(){let c=this.strokeColor;return typeof this.strokeColor!="string"&&(c=`url(#${this.id})`),c},showDefs(){return typeof this.strokeColor!="string"}}},Dne={viewBox:"0 0 100 100"},Lne={key:0},Nne=["id"],Vne=["stop-color"],$ne=["stop-color"],Une=["d","stroke","stroke-width","stroke-linecap"],Fne=["d","stroke-linecap","stroke","stroke-width"];function zne(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{style:n.normalizeStyle(v.circleSize),class:n.normalizeClass(v.wrapClasses)},[(n.openBlock(),n.createElementBlock("svg",Dne,[v.showDefs?(n.openBlock(),n.createElementBlock("defs",Lne,[n.createElementVNode("linearGradient",{id:b.id,x1:"100%",y1:"0%",x2:"0%",y2:"0%"},[n.createElementVNode("stop",{offset:"0%","stop-color":m.strokeColor[0]},null,8,Vne),n.createElementVNode("stop",{offset:"100%","stop-color":m.strokeColor[1]},null,8,$ne)],8,Nne)])):n.createCommentVNode("",!0),n.createElementVNode("path",{d:v.pathString,stroke:m.trailColor,"stroke-width":m.trailWidth,"fill-opacity":0,style:n.normalizeStyle(v.trailStyle),"stroke-linecap":m.strokeLinecap},null,12,Une),n.createElementVNode("path",{d:v.pathString,"stroke-linecap":m.strokeLinecap,stroke:v.strokeValue,"stroke-width":v.computedStrokeWidth,"fill-opacity":"0",style:n.normalizeStyle(v.pathStyle)},null,12,Fne)])),n.createElementVNode("div",{class:n.normalizeClass(v.innerClasses)},[n.renderSlot(c.$slots,"default")],2)],6)}var sw=l(Rne,[["render",zne]]);const rw="ivu-dropdown",Xne={name:"Dropdown",directives:{clickOutside:ME},components:{Drop:Ke},emits:["on-visible-change","on-clickoutside","on-click","on-hover-click","on-haschild-click"],props:{trigger:{validator(c){return T(c,["click","hover","custom","contextMenu"])},default:"hover"},placement:{validator(c){return T(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},visible:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},transferClassName:{type:String},stopPropagation:{type:Boolean,default:!1},capture:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},eventsEnabled:{type:Boolean,default:!1},boundariesElement:{default:"window"}},computed:{transition(){return["bottom-start","bottom","bottom-end"].indexOf(this.placement)>-1?"slide-up":"fade"},dropdownCls(){return{[rw+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}},relClasses(){return[`${rw}-rel`,{[`${rw}-rel-user-select-none`]:this.trigger==="contextMenu"}]}},data(){return{prefixCls:rw,currentVisible:this.visible,timeout:null}},watch:{visible(c){this.currentVisible=c},currentVisible(c){c?this.$refs.drop.update():this.$refs.drop.destroy(),this.$emit("on-visible-change",c)}},methods:{handleClick(){if(this.trigger==="custom"||this.trigger!=="click")return!1;this.hasParent()||(this.currentVisible=!this.currentVisible)},handleRightClick(){if(this.trigger==="custom"||this.trigger!=="contextMenu")return!1;this.currentVisible=!this.currentVisible},handleMouseenter(){if(this.trigger==="custom"||this.trigger!=="hover")return!1;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.currentVisible=!0},250)},handleMouseleave(){if(this.trigger==="custom"||this.trigger!=="hover")return!1;this.timeout&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.currentVisible=!1},150))},onClickoutside(c){this.handleClose(),this.handleRightClose(),this.currentVisible&&this.$emit("on-clickoutside",c)},handleClose(){if(this.trigger==="custom"||this.trigger!=="click")return!1;this.currentVisible=!1},handleRightClose(){if(this.trigger==="custom"||this.trigger!=="contextMenu")return!1;this.currentVisible=!1},hasParent(){return F(this,"Dropdown")||!1},handleHaschildClick(){n.nextTick(()=>{if(this.trigger==="custom")return!1;this.currentVisible=!0});const c=this.hasParent();c&&c.handleHaschildClick()},handleItemClick(c){if(this.stopPropagation)return;const u=this.hasParent();u?u.handleItemClick(c):this.$emit("on-click",c)},handleHoverClick(){const c=this.hasParent();c?(n.nextTick(()=>{if(this.trigger==="custom")return!1;this.currentVisible=!1}),c.handleHoverClick()):n.nextTick(()=>{if(this.trigger==="custom")return!1;this.currentVisible=!1})}}};function Wne(c,u,m,S,b,v){const M=n.resolveComponent("Drop"),N=n.resolveDirective("click-outside");return n.withDirectives((n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([b.prefixCls]),onMouseenter:u[2]||(u[2]=(...X)=>v.handleMouseenter&&v.handleMouseenter(...X)),onMouseleave:u[3]||(u[3]=(...X)=>v.handleMouseleave&&v.handleMouseleave(...X))},[n.createElementVNode("div",{class:n.normalizeClass(v.relClasses),ref:"reference",onClick:u[0]||(u[0]=(...X)=>v.handleClick&&v.handleClick(...X)),onContextmenu:u[1]||(u[1]=n.withModifiers((...X)=>v.handleRightClick&&v.handleRightClick(...X),["prevent"]))},[n.renderSlot(c.$slots,"default")],34),n.createVNode(M,{ref:"drop",visible:b.currentVisible,classes:v.dropdownCls,placement:m.placement,eventsEnabled:m.eventsEnabled,boundariesElement:m.boundariesElement,transfer:m.transfer,"transition-name":"transition-drop",onMouseenter:v.handleMouseenter,onMouseleave:v.handleMouseleave},{default:n.withCtx(()=>[n.renderSlot(c.$slots,"list")]),_:3},8,["visible","classes","placement","eventsEnabled","boundariesElement","transfer","onMouseenter","onMouseleave"])],34)),[[N,v.onClickoutside]])}var If=l(Xne,[["render",Wne]]);const Hne={name:"DropdownMenu"},Gne={class:"ivu-dropdown-menu"};function Qne(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("ul",Gne,[n.renderSlot(c.$slots,"default")])}var Bf=l(Hne,[["render",Qne]]);const Wa="ivu-tag",yh=["default","primary","success","warning","error","blue","green","red","yellow","pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],Yne=["pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],jne={name:"Tag",components:{Icon:O},emits:["on-change","on-close"],props:{closable:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},checked:{type:Boolean,default:!0},color:{type:String,default:"default"},type:{validator(c){return T(c,["border","dot"])}},name:{type:[String,Number]},size:{validator(c){return T(c,["default","medium","large"])},default:"default"}},data(){return{isChecked:this.checked}},computed:{classes(){return[`${Wa}`,`${Wa}-size-${this.size}`,{[`${Wa}-${this.color}`]:!!this.color&&T(this.color,yh),[`${Wa}-${this.type}`]:!!this.type,[`${Wa}-closable`]:this.closable,[`${Wa}-checked`]:this.isChecked,[`${Wa}-checkable`]:this.checkable}]},wraperStyles(){return T(this.color,yh)?{}:{background:this.isChecked?this.defaultTypeColor:"transparent",borderWidth:"1px",borderStyle:"solid",borderColor:this.type!=="dot"&&this.type!=="border"&&this.isChecked?this.borderColor:this.lineColor,color:this.lineColor}},textClasses(){return[`${Wa}-text`,this.type==="border"&&T(this.color,yh)?`${Wa}-color-${this.color}`:"",this.type!=="dot"&&this.type!=="border"&&this.color!=="default"&&this.isChecked&&Yne.indexOf(this.color)<0?`${Wa}-color-white`:""]},dotClasses(){return`${Wa}-dot-inner`},iconClass(){return this.type==="dot"?"":this.type==="border"?T(this.color,yh)?`${Wa}-color-${this.color}`:"":this.color!==void 0?this.color==="default"?"":"rgb(255, 255, 255)":""},showDot(){return!!this.type&&this.type==="dot"},lineColor(){return this.type==="dot"?"":this.type==="border"?this.color!==void 0?T(this.color,yh)?"":this.color:"":this.color!==void 0?this.color==="default"?"":"rgb(255, 255, 255)":""},borderColor(){return this.color!==void 0?this.color==="default"?"":this.color:""},dotColor(){return this.color!==void 0?T(this.color,yh)?"":this.color:""},textColorStyle(){return T(this.color,yh)?{}:this.type!=="dot"&&this.type!=="border"?this.isChecked?{color:this.lineColor}:{}:{color:this.lineColor}},bgColorStyle(){return T(this.color,yh)?{}:{background:this.dotColor}},defaultTypeColor(){return this.type!=="dot"&&this.type!=="border"&&this.color!==void 0?T(this.color,yh)?"":this.color:""}},methods:{close(c){this.name===void 0?this.$emit("on-close",c):this.$emit("on-close",c,this.name)},check(){if(!this.checkable)return;const c=!this.isChecked;this.isChecked=c,this.name===void 0?this.$emit("on-change",c):this.$emit("on-change",c,this.name)}},watch:{checked(c){this.isChecked=c}}};function qne(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),onClick:u[0]||(u[0]=n.withModifiers((...N)=>v.check&&v.check(...N),["stop"])),style:n.normalizeStyle(v.wraperStyles)},[v.showDot?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(v.dotClasses),style:n.normalizeStyle(v.bgColorStyle)},null,6)):n.createCommentVNode("",!0),n.createElementVNode("span",{class:n.normalizeClass(v.textClasses),style:n.normalizeStyle(v.textColorStyle)},[n.renderSlot(c.$slots,"default")],6),m.closable?(n.openBlock(),n.createBlock(M,{key:1,class:n.normalizeClass(v.iconClass),color:v.lineColor,type:"ios-close",onClick:n.withModifiers(v.close,["stop"])},null,8,["class","color","onClick"])):n.createCommentVNode("",!0)],6)}var Wm=l(jne,[["render",qne]]),XN={11e4:{l:"Z1",n:"",c:"110000",p:"86"},12e4:{l:"Z1",n:"",c:"120000",p:"86"},13e4:{l:"H",n:"",c:"130000",p:"86"},14e4:{l:"S",n:"",c:"140000",p:"86"},15e4:{l:"N",n:"",c:"150000",p:"86"},21e4:{l:"L",n:"",c:"210000",p:"86"},22e4:{l:"J",n:"",c:"220000",p:"86"},23e4:{l:"H",n:"",c:"230000",p:"86"},31e4:{l:"Z1",n:"",c:"310000",p:"86"},32e4:{l:"J",n:"",c:"320000",p:"86"},33e4:{l:"Z",n:"",c:"330000",p:"86"},34e4:{l:"A",n:"",c:"340000",p:"86"},35e4:{l:"F",n:"",c:"350000",p:"86"},36e4:{l:"J",n:"",c:"360000",p:"86"},37e4:{l:"S",n:"",c:"370000",p:"86"},41e4:{l:"H",n:"",c:"410000",p:"86"},42e4:{l:"H",n:"",c:"420000",p:"86"},43e4:{l:"H",n:"",c:"430000",p:"86"},44e4:{l:"G",n:"",c:"440000",p:"86"},45e4:{l:"G",n:"",c:"450000",p:"86"},46e4:{l:"H",n:"",c:"460000",p:"86"},5e5:{l:"Z1",n:"",c:"500000",p:"86"},51e4:{l:"S",n:"",c:"510000",p:"86"},52e4:{l:"G",n:"",c:"520000",p:"86"},53e4:{l:"Y",n:"",c:"530000",p:"86"},54e4:{l:"X",n:"",c:"540000",p:"86"},61e4:{l:"S",n:"",c:"610000",p:"86"},62e4:{l:"G",n:"",c:"620000",p:"86"},63e4:{l:"Q",n:"",c:"630000",p:"86"},64e4:{l:"N",n:"",c:"640000",p:"86"},65e4:{l:"X",n:"",c:"650000",p:"86"},71e4:{l:"T",n:"",c:"710000",p:"86"},81e4:{l:"Z2",n:"",c:"810000",p:"86"},82e4:{l:"Z2",n:"",c:"820000",p:"86"}},Hm={11e4:{l:"B",n:"",c:"110000",p:"86"},12e4:{l:"T",n:"",c:"120000",p:"86"},130100:{l:"S",n:"",c:"130100",p:"130000"},130200:{l:"T",n:"",c:"130200",p:"130000"},130300:{l:"Q",n:"",c:"130300",p:"130000"},130400:{l:"H",n:"",c:"130400",p:"130000"},130500:{l:"X",n:"",c:"130500",p:"130000"},130600:{l:"B",n:"",c:"130600",p:"130000"},130700:{l:"Z",n:"",c:"130700",p:"130000"},130800:{l:"C",n:"",c:"130800",p:"130000"},130900:{l:"C",n:"",c:"130900",p:"130000"},131e3:{l:"L",n:"",c:"131000",p:"130000"},131100:{l:"H",n:"",c:"131100",p:"130000"},139001:{l:"D",n:"",c:"139001",p:"130000"},139002:{l:"X",n:"",c:"139002",p:"130000"},140100:{l:"T",n:"",c:"140100",p:"140000"},140200:{l:"D",n:"",c:"140200",p:"140000"},140300:{l:"Y",n:"",c:"140300",p:"140000"},140400:{l:"C",n:"",c:"140400",p:"140000"},140500:{l:"J",n:"",c:"140500",p:"140000"},140600:{l:"S",n:"",c:"140600",p:"140000"},140700:{l:"J",n:"",c:"140700",p:"140000"},140800:{l:"Y",n:"",c:"140800",p:"140000"},140900:{l:"X",n:"",c:"140900",p:"140000"},141e3:{l:"L",n:"",c:"141000",p:"140000"},141100:{l:"L",n:"",c:"141100",p:"140000"},150100:{l:"H",n:"",c:"150100",p:"150000"},150200:{l:"B",n:"",c:"150200",p:"150000"},150300:{l:"W",n:"",c:"150300",p:"150000"},150400:{l:"C",n:"",c:"150400",p:"150000"},150500:{l:"T",n:"",c:"150500",p:"150000"},150600:{l:"E",n:"",c:"150600",p:"150000"},150700:{l:"H",n:"",c:"150700",p:"150000"},150800:{l:"B",n:"",c:"150800",p:"150000"},150900:{l:"W",n:"",c:"150900",p:"150000"},152200:{l:"X",n:"",c:"152200",p:"150000"},152500:{l:"X",n:"",c:"152500",p:"150000"},152900:{l:"A",n:"",c:"152900",p:"150000"},210100:{l:"S",n:"",c:"210100",p:"210000"},210200:{l:"D",n:"",c:"210200",p:"210000"},210300:{l:"A",n:"",c:"210300",p:"210000"},210400:{l:"F",n:"",c:"210400",p:"210000"},210500:{l:"B",n:"",c:"210500",p:"210000"},210600:{l:"D",n:"",c:"210600",p:"210000"},210700:{l:"J",n:"",c:"210700",p:"210000"},210800:{l:"Y",n:"",c:"210800",p:"210000"},210900:{l:"F",n:"",c:"210900",p:"210000"},211e3:{l:"L",n:"",c:"211000",p:"210000"},211100:{l:"P",n:"",c:"211100",p:"210000"},211200:{l:"T",n:"",c:"211200",p:"210000"},211300:{l:"C",n:"",c:"211300",p:"210000"},211400:{l:"H",n:"",c:"211400",p:"210000"},220100:{l:"C",n:"",c:"220100",p:"220000"},220200:{l:"J",n:"",c:"220200",p:"220000"},220300:{l:"S",n:"",c:"220300",p:"220000"},220400:{l:"L",n:"",c:"220400",p:"220000"},220500:{l:"T",n:"",c:"220500",p:"220000"},220600:{l:"B",n:"",c:"220600",p:"220000"},220700:{l:"S",n:"",c:"220700",p:"220000"},220800:{l:"B",n:"",c:"220800",p:"220000"},222400:{l:"Y",n:"",c:"222400",p:"220000"},230100:{l:"H",n:"",c:"230100",p:"230000"},230200:{l:"Q",n:"",c:"230200",p:"230000"},230300:{l:"J",n:"",c:"230300",p:"230000"},230400:{l:"H",n:"",c:"230400",p:"230000"},230500:{l:"S",n:"",c:"230500",p:"230000"},230600:{l:"D",n:"",c:"230600",p:"230000"},230700:{l:"Y",n:"",c:"230700",p:"230000"},230800:{l:"J",n:"",c:"230800",p:"230000"},230900:{l:"Q",n:"",c:"230900",p:"230000"},231e3:{l:"M",n:"",c:"231000",p:"230000"},231100:{l:"H",n:"",c:"231100",p:"230000"},231200:{l:"S",n:"",c:"231200",p:"230000"},232700:{l:"D",n:"",c:"232700",p:"230000"},31e4:{l:"S",n:"",c:"310000",p:"86"},320100:{l:"N",n:"",c:"320100",p:"320000"},320200:{l:"W",n:"",c:"320200",p:"320000"},320300:{l:"X",n:"",c:"320300",p:"320000"},320400:{l:"C",n:"",c:"320400",p:"320000"},320500:{l:"S",n:"",c:"320500",p:"320000"},320600:{l:"N",n:"",c:"320600",p:"320000"},320700:{l:"L",n:"",c:"320700",p:"320000"},320800:{l:"H",n:"",c:"320800",p:"320000"},320900:{l:"Y",n:"",c:"320900",p:"320000"},321e3:{l:"Y",n:"",c:"321000",p:"320000"},321100:{l:"Z",n:"",c:"321100",p:"320000"},321200:{l:"T",n:"",c:"321200",p:"320000"},321300:{l:"X",n:"",c:"321300",p:"320000"},330100:{l:"H",n:"",c:"330100",p:"330000"},330200:{l:"N",n:"",c:"330200",p:"330000"},330300:{l:"W",n:"",c:"330300",p:"330000"},330400:{l:"J",n:"",c:"330400",p:"330000"},330500:{l:"H",n:"",c:"330500",p:"330000"},330600:{l:"S",n:"",c:"330600",p:"330000"},330700:{l:"J",n:"",c:"330700",p:"330000"},330800:{l:"Q",n:"",c:"330800",p:"330000"},330900:{l:"Z",n:"",c:"330900",p:"330000"},331e3:{l:"T",n:"",c:"331000",p:"330000"},331100:{l:"L",n:"",c:"331100",p:"330000"},340100:{l:"H",n:"",c:"340100",p:"340000"},340200:{l:"W",n:"",c:"340200",p:"340000"},340300:{l:"B",n:"",c:"340300",p:"340000"},340400:{l:"H",n:"",c:"340400",p:"340000"},340500:{l:"M",n:"",c:"340500",p:"340000"},340600:{l:"H",n:"",c:"340600",p:"340000"},340700:{l:"T",n:"",c:"340700",p:"340000"},340800:{l:"A",n:"",c:"340800",p:"340000"},341e3:{l:"H",n:"",c:"341000",p:"340000"},341100:{l:"C",n:"",c:"341100",p:"340000"},341200:{l:"F",n:"",c:"341200",p:"340000"},341300:{l:"X",n:"",c:"341300",p:"340000"},341500:{l:"L",n:"",c:"341500",p:"340000"},341600:{l:"B",n:"",c:"341600",p:"340000"},341700:{l:"C",n:"",c:"341700",p:"340000"},341800:{l:"X",n:"",c:"341800",p:"340000"},350100:{l:"F",n:"",c:"350100",p:"350000"},350200:{l:"S",n:"",c:"350200",p:"350000"},350300:{l:"P",n:"",c:"350300",p:"350000"},350400:{l:"S",n:"",c:"350400",p:"350000"},350500:{l:"Q",n:"",c:"350500",p:"350000"},350600:{l:"Z",n:"",c:"350600",p:"350000"},350700:{l:"N",n:"",c:"350700",p:"350000"},350800:{l:"L",n:"",c:"350800",p:"350000"},350900:{l:"N",n:"",c:"350900",p:"350000"},360100:{l:"N",n:"",c:"360100",p:"360000"},360200:{l:"J",n:"",c:"360200",p:"360000"},360300:{l:"P",n:"",c:"360300",p:"360000"},360400:{l:"J",n:"",c:"360400",p:"360000"},360500:{l:"X",n:"",c:"360500",p:"360000"},360600:{l:"Y",n:"",c:"360600",p:"360000"},360700:{l:"G",n:"",c:"360700",p:"360000"},360800:{l:"J",n:"",c:"360800",p:"360000"},360900:{l:"Y",n:"",c:"360900",p:"360000"},361e3:{l:"F",n:"",c:"361000",p:"360000"},361100:{l:"S",n:"",c:"361100",p:"360000"},370100:{l:"J",n:"",c:"370100",p:"370000"},370200:{l:"Q",n:"",c:"370200",p:"370000"},370300:{l:"Z",n:"",c:"370300",p:"370000"},370400:{l:"Z",n:"",c:"370400",p:"370000"},370500:{l:"D",n:"",c:"370500",p:"370000"},370600:{l:"Y",n:"",c:"370600",p:"370000"},370700:{l:"W",n:"",c:"370700",p:"370000"},370800:{l:"J",n:"",c:"370800",p:"370000"},370900:{l:"T",n:"",c:"370900",p:"370000"},371e3:{l:"W",n:"",c:"371000",p:"370000"},371100:{l:"R",n:"",c:"371100",p:"370000"},371200:{l:"L",n:"",c:"371200",p:"370000"},371300:{l:"L",n:"",c:"371300",p:"370000"},371400:{l:"D",n:"",c:"371400",p:"370000"},371500:{l:"L",n:"",c:"371500",p:"370000"},371600:{l:"B",n:"",c:"371600",p:"370000"},371700:{l:"H",n:"",c:"371700",p:"370000"},410100:{l:"Z",n:"",c:"410100",p:"410000"},410200:{l:"K",n:"",c:"410200",p:"410000"},410300:{l:"L",n:"",c:"410300",p:"410000"},410400:{l:"P",n:"",c:"410400",p:"410000"},410500:{l:"A",n:"",c:"410500",p:"410000"},410600:{l:"H",n:"",c:"410600",p:"410000"},410700:{l:"X",n:"",c:"410700",p:"410000"},410800:{l:"J",n:"",c:"410800",p:"410000"},410900:{l:"P",n:"",c:"410900",p:"410000"},411e3:{l:"X",n:"",c:"411000",p:"410000"},411100:{l:"L",n:"",c:"411100",p:"410000"},411200:{l:"S",n:"",c:"411200",p:"410000"},411300:{l:"N",n:"",c:"411300",p:"410000"},411400:{l:"S",n:"",c:"411400",p:"410000"},411500:{l:"X",n:"",c:"411500",p:"410000"},411600:{l:"Z",n:"",c:"411600",p:"410000"},411700:{l:"Z",n:"",c:"411700",p:"410000"},419001:{l:"J",n:"",c:"419001",p:"410000"},420100:{l:"W",n:"",c:"420100",p:"420000"},420200:{l:"H",n:"",c:"420200",p:"420000"},420300:{l:"S",n:"",c:"420300",p:"420000"},420500:{l:"Y",n:"",c:"420500",p:"420000"},420600:{l:"X",n:"",c:"420600",p:"420000"},420700:{l:"E",n:"",c:"420700",p:"420000"},420800:{l:"J",n:"",c:"420800",p:"420000"},420900:{l:"X",n:"",c:"420900",p:"420000"},421e3:{l:"J",n:"",c:"421000",p:"420000"},421100:{l:"H",n:"",c:"421100",p:"420000"},421200:{l:"X",n:"",c:"421200",p:"420000"},421300:{l:"S",n:"",c:"421300",p:"420000"},422800:{l:"E",n:"",c:"422800",p:"420000"},429004:{l:"X",n:"",c:"429004",p:"420000"},429005:{l:"Q",n:"",c:"429005",p:"420000"},429006:{l:"T",n:"",c:"429006",p:"420000"},429021:{l:"S",n:"",c:"429021",p:"420000"},430100:{l:"C",n:"",c:"430100",p:"430000"},430200:{l:"Z",n:"",c:"430200",p:"430000"},430300:{l:"X",n:"",c:"430300",p:"430000"},430400:{l:"H",n:"",c:"430400",p:"430000"},430500:{l:"S",n:"",c:"430500",p:"430000"},430600:{l:"Y",n:"",c:"430600",p:"430000"},430700:{l:"C",n:"",c:"430700",p:"430000"},430800:{l:"Z",n:"",c:"430800",p:"430000"},430900:{l:"Y",n:"",c:"430900",p:"430000"},431e3:{l:"C",n:"",c:"431000",p:"430000"},431100:{l:"Y",n:"",c:"431100",p:"430000"},431200:{l:"H",n:"",c:"431200",p:"430000"},431300:{l:"L",n:"",c:"431300",p:"430000"},433100:{l:"X",n:"",c:"433100",p:"430000"},440100:{l:"G",n:"",c:"440100",p:"440000"},440200:{l:"S",n:"",c:"440200",p:"440000"},440300:{l:"S",n:"",c:"440300",p:"440000"},440400:{l:"Z",n:"",c:"440400",p:"440000"},440500:{l:"S",n:"",c:"440500",p:"440000"},440600:{l:"F",n:"",c:"440600",p:"440000"},440700:{l:"J",n:"",c:"440700",p:"440000"},440800:{l:"Z",n:"",c:"440800",p:"440000"},440900:{l:"M",n:"",c:"440900",p:"440000"},441200:{l:"Z",n:"",c:"441200",p:"440000"},441300:{l:"H",n:"",c:"441300",p:"440000"},441400:{l:"M",n:"",c:"441400",p:"440000"},441500:{l:"S",n:"",c:"441500",p:"440000"},441600:{l:"H",n:"",c:"441600",p:"440000"},441700:{l:"Y",n:"",c:"441700",p:"440000"},441800:{l:"Q",n:"",c:"441800",p:"440000"},441900:{l:"D",n:"",c:"441900",p:"440000"},442e3:{l:"Z",n:"",c:"442000",p:"440000"},445100:{l:"C",n:"",c:"445100",p:"440000"},445200:{l:"J",n:"",c:"445200",p:"440000"},445300:{l:"Y",n:"",c:"445300",p:"440000"},450100:{l:"N",n:"",c:"450100",p:"450000"},450200:{l:"L",n:"",c:"450200",p:"450000"},450300:{l:"G",n:"",c:"450300",p:"450000"},450400:{l:"W",n:"",c:"450400",p:"450000"},450500:{l:"B",n:"",c:"450500",p:"450000"},450600:{l:"F",n:"",c:"450600",p:"450000"},450700:{l:"Q",n:"",c:"450700",p:"450000"},450800:{l:"G",n:"",c:"450800",p:"450000"},450900:{l:"Y",n:"",c:"450900",p:"450000"},451e3:{l:"B",n:"",c:"451000",p:"450000"},451100:{l:"H",n:"",c:"451100",p:"450000"},451200:{l:"H",n:"",c:"451200",p:"450000"},451300:{l:"L",n:"",c:"451300",p:"450000"},451400:{l:"C",n:"",c:"451400",p:"450000"},460100:{l:"H",n:"",c:"460100",p:"460000"},460200:{l:"S",n:"",c:"460200",p:"460000"},460300:{l:"S",n:"",c:"460300",p:"460000"},460400:{l:"D",n:"",c:"460400",p:"460000"},469001:{l:"W",n:"",c:"469001",p:"460000"},469002:{l:"Q",n:"",c:"469002",p:"460000"},469005:{l:"W",n:"",c:"469005",p:"460000"},469006:{l:"W",n:"",c:"469006",p:"460000"},469007:{l:"D",n:"",c:"469007",p:"460000"},469021:{l:"D",n:"",c:"469021",p:"460000"},469022:{l:"T",n:"",c:"469022",p:"460000"},469023:{l:"C",n:"",c:"469023",p:"460000"},469024:{l:"L",n:"",c:"469024",p:"460000"},469025:{l:"B",n:"",c:"469025",p:"460000"},469026:{l:"C",n:"",c:"469026",p:"460000"},469027:{l:"L",n:"",c:"469027",p:"460000"},469028:{l:"L",n:"",c:"469028",p:"460000"},469029:{l:"B",n:"",c:"469029",p:"460000"},469030:{l:"Q",n:"",c:"469030",p:"460000"},5e5:{l:"C",n:"",c:"500000",p:"86"},510100:{l:"C",n:"",c:"510100",p:"510000"},510300:{l:"Z",n:"",c:"510300",p:"510000"},510400:{l:"P",n:"",c:"510400",p:"510000"},510500:{l:"L",n:"",c:"510500",p:"510000"},510600:{l:"D",n:"",c:"510600",p:"510000"},510700:{l:"M",n:"",c:"510700",p:"510000"},510800:{l:"G",n:"",c:"510800",p:"510000"},510900:{l:"S",n:"",c:"510900",p:"510000"},511e3:{l:"N",n:"",c:"511000",p:"510000"},511100:{l:"L",n:"",c:"511100",p:"510000"},511300:{l:"N",n:"",c:"511300",p:"510000"},511400:{l:"M",n:"",c:"511400",p:"510000"},511500:{l:"Y",n:"",c:"511500",p:"510000"},511600:{l:"G",n:"",c:"511600",p:"510000"},511700:{l:"D",n:"",c:"511700",p:"510000"},511800:{l:"Y",n:"",c:"511800",p:"510000"},511900:{l:"B",n:"",c:"511900",p:"510000"},512e3:{l:"Z",n:"",c:"512000",p:"510000"},513200:{l:"A",n:"",c:"513200",p:"510000"},513300:{l:"G",n:"",c:"513300",p:"510000"},513400:{l:"L",n:"",c:"513400",p:"510000"},520100:{l:"G",n:"",c:"520100",p:"520000"},520200:{l:"L",n:"",c:"520200",p:"520000"},520300:{l:"Z",n:"",c:"520300",p:"520000"},520400:{l:"A",n:"",c:"520400",p:"520000"},520500:{l:"B",n:"",c:"520500",p:"520000"},520600:{l:"T",n:"",c:"520600",p:"520000"},522300:{l:"Q",n:"",c:"522300",p:"520000"},522600:{l:"Q",n:"",c:"522600",p:"520000"},522700:{l:"Q",n:"",c:"522700",p:"520000"},530100:{l:"K",n:"",c:"530100",p:"530000"},530300:{l:"Q",n:"",c:"530300",p:"530000"},530400:{l:"Y",n:"",c:"530400",p:"530000"},530500:{l:"B",n:"",c:"530500",p:"530000"},530600:{l:"Z",n:"",c:"530600",p:"530000"},530700:{l:"L",n:"",c:"530700",p:"530000"},530800:{l:"P",n:"",c:"530800",p:"530000"},530900:{l:"L",n:"",c:"530900",p:"530000"},532300:{l:"C",n:"",c:"532300",p:"530000"},532500:{l:"H",n:"",c:"532500",p:"530000"},532600:{l:"W",n:"",c:"532600",p:"530000"},532800:{l:"X",n:"",c:"532800",p:"530000"},532900:{l:"D",n:"",c:"532900",p:"530000"},533100:{l:"D",n:"",c:"533100",p:"530000"},533300:{l:"N",n:"",c:"533300",p:"530000"},533400:{l:"D",n:"",c:"533400",p:"530000"},540100:{l:"L",n:"",c:"540100",p:"540000"},540200:{l:"R",n:"",c:"540200",p:"540000"},540300:{l:"C",n:"",c:"540300",p:"540000"},540400:{l:"L",n:"",c:"540400",p:"540000"},540500:{l:"S",n:"",c:"540500",p:"540000"},542400:{l:"N",n:"",c:"542400",p:"540000"},542500:{l:"A",n:"",c:"542500",p:"540000"},610100:{l:"X",n:"",c:"610100",p:"610000"},610200:{l:"T",n:"",c:"610200",p:"610000"},610300:{l:"B",n:"",c:"610300",p:"610000"},610400:{l:"X",n:"",c:"610400",p:"610000"},610500:{l:"W",n:"",c:"610500",p:"610000"},610600:{l:"Y",n:"",c:"610600",p:"610000"},610700:{l:"H",n:"",c:"610700",p:"610000"},610800:{l:"Y",n:"",c:"610800",p:"610000"},610900:{l:"A",n:"",c:"610900",p:"610000"},611e3:{l:"S",n:"",c:"611000",p:"610000"},620100:{l:"L",n:"",c:"620100",p:"620000"},620200:{l:"J",n:"",c:"620200",p:"620000"},620300:{l:"J",n:"",c:"620300",p:"620000"},620400:{l:"B",n:"",c:"620400",p:"620000"},620500:{l:"T",n:"",c:"620500",p:"620000"},620600:{l:"W",n:"",c:"620600",p:"620000"},620700:{l:"Z",n:"",c:"620700",p:"620000"},620800:{l:"P",n:"",c:"620800",p:"620000"},620900:{l:"J",n:"",c:"620900",p:"620000"},621e3:{l:"Q",n:"",c:"621000",p:"620000"},621100:{l:"D",n:"",c:"621100",p:"620000"},621200:{l:"L",n:"",c:"621200",p:"620000"},622900:{l:"L",n:"",c:"622900",p:"620000"},623e3:{l:"G",n:"",c:"623000",p:"620000"},630100:{l:"X",n:"",c:"630100",p:"630000"},630200:{l:"H",n:"",c:"630200",p:"630000"},632200:{l:"H",n:"",c:"632200",p:"630000"},632300:{l:"H",n:"",c:"632300",p:"630000"},632500:{l:"H",n:"",c:"632500",p:"630000"},632600:{l:"G",n:"",c:"632600",p:"630000"},632700:{l:"Y",n:"",c:"632700",p:"630000"},632800:{l:"H",n:"",c:"632800",p:"630000"},640100:{l:"Y",n:"",c:"640100",p:"640000"},640200:{l:"S",n:"",c:"640200",p:"640000"},640300:{l:"W",n:"",c:"640300",p:"640000"},640400:{l:"G",n:"",c:"640400",p:"640000"},640500:{l:"Z",n:"",c:"640500",p:"640000"},650100:{l:"W",n:"",c:"650100",p:"650000"},650200:{l:"K",n:"",c:"650200",p:"650000"},650400:{l:"T",n:"",c:"650400",p:"650000"},650500:{l:"H",n:"",c:"650500",p:"650000"},652300:{l:"C",n:"",c:"652300",p:"650000"},652700:{l:"B",n:"",c:"652700",p:"650000"},652800:{l:"B",n:"",c:"652800",p:"650000"},652900:{l:"A",n:"",c:"652900",p:"650000"},653e3:{l:"K",n:"",c:"653000",p:"650000"},653100:{l:"K",n:"",c:"653100",p:"650000"},653200:{l:"H",n:"",c:"653200",p:"650000"},654e3:{l:"Y",n:"",c:"654000",p:"650000"},654200:{l:"T",n:"",c:"654200",p:"650000"},654300:{l:"A",n:"",c:"654300",p:"650000"},659001:{l:"S",n:"",c:"659001",p:"650000"},659002:{l:"A",n:"",c:"659002",p:"650000"},659003:{l:"T",n:"",c:"659003",p:"650000"},659004:{l:"W",n:"",c:"659004",p:"650000"},659006:{l:"T",n:"",c:"659006",p:"650000"},710101:{l:"J",n:"",c:"710101",p:"710000"},710102:{l:"L",n:"",c:"710102",p:"710000"},710103:{l:"M",n:"",c:"710103",p:"710000"},710104:{l:"N",n:"",c:"710104",p:"710000"},710105:{l:"P",n:"",c:"710105",p:"710000"},710106:{l:"P",n:"",c:"710106",p:"710000"},710107:{l:"T",n:"",c:"710107",p:"710000"},710108:{l:"T",n:"",c:"710108",p:"710000"},710109:{l:"T",n:"",c:"710109",p:"710000"},710110:{l:"T",n:"",c:"710110",p:"710000"},710111:{l:"T",n:"",c:"710111",p:"710000"},710112:{l:"Y",n:"",c:"710112",p:"710000"},710113:{l:"X",n:"",c:"710113",p:"710000"},710114:{l:"Z",n:"",c:"710114",p:"710000"},710115:{l:"J",n:"",c:"710115",p:"710000"},710116:{l:"X",n:"",c:"710116",p:"710000"},710117:{l:"H",n:"",c:"710117",p:"710000"},710118:{l:"Y",n:"",c:"710118",p:"710000"},710119:{l:"G",n:"",c:"710119",p:"710000"},710120:{l:"J",n:"",c:"710120",p:"710000"},81e4:{l:"X",n:"",c:"810000",p:"86"},82e4:{l:"A",n:"",c:"820000",p:"86"}};function Jy(c){return c.replace("","").replace("","").replace("","")}function Zne(){const c=L(Hm),u=[];for(let m in c){const S=c[m];S.n=Jy(S.n),u.push(S)}return u}function WN(c,u){if(!u)return"";const m=c.find(S=>S.n===u);return m?m.c:(console.error("[View UI warn]: City name error."),"")}function Kne(c,u){return c.find(m=>m.c===u).n}const Jne={name:"City",mixins:[Li],components:{Dropdown:If,DropdownMenu:Bf,Select:lo,Option:ds,Tag:Wm,Icon:O,RadioGroup:Jb,Radio:ew},emits:["on-change","update:modelValue"],props:{modelValue:{type:String},useName:{type:Boolean,default:!1},cities:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showSuffix:{type:Boolean,default:!1},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},placeholder:{type:String,default:""},searchPlaceholder:{type:String,default:""},transferClassName:{type:String}},data(){const c=Zne();return{currentValue:this.useName?WN(c,this.modelValue):this.modelValue,visible:!1,provinceList:[],cityListByProvince:[],cityListByLetter:{},allCities:c,listType:"province",queryCity:""}},watch:{modelValue(c){const u=this.useName?WN(this.allCities,c):c;this.currentValue=u}},computed:{showCloseIcon(){return this.currentValue&&this.clearable&&!this.itemDisabled},classes(){return[{"ivu-city-show-clear":this.showCloseIcon,[`ivu-city-size-${this.size}`]:!!this.size,"ivu-city-visible":this.visible,"ivu-city-disabled":this.itemDisabled}]},transferClasses(){let c="ivu-city-transfer";return this.transferClassName&&(c+=` ${this.transferClassName}`),c},relCities(){const c=[];return this.cities.length&&this.cities.forEach(u=>{const m=Hm[u];m.n=Jy(m.n),c.push(m)}),c},codeToName(){if(!this.currentValue)return this.placeholder;const c=Hm[this.currentValue].n;return this.showSuffix?c:Jy(c)}},methods:{handleSelect(c){c&&(this.handleChangeValue(c),n.nextTick(()=>{this.queryCity=""}))},handleChangeValue(c){this.currentValue=c,this.visible=!1;const u=this.useName?Kne(this.allCities,c):c;this.$emit("update:modelValue",u),this.$emit("on-change",Hm[c]),this.handleFormItemChange("change",c)},handleClickLetter(c){let u=c;u===""?u="Z1":u===""&&(u="Z2");const m=`.ivu-city-${u}`,S=this.$refs.list,b=S.querySelectorAll(m)[0].offsetTop,v=S.offsetTop;S.scrollTop=b-v},clearSelect(){if(this.itemDisabled)return!1},handleToggleOpen(){if(this.itemDisabled)return!1;this.visible=!this.visible},handleVisibleChange(c){this.visible=c},handleClickOutside(c){this.$refs.city.contains(c.target)||(this.visible=!1)},handleGetProvinceByLetter(){const c={A:{n:"A",p:[],c:[]},F:{n:"F",p:[],c:[]},G:{n:"G",p:[],c:[]},H:{n:"H",p:[],c:[]},J:{n:"J",p:[],c:[]},L:{n:"L",p:[],c:[]},N:{n:"N",p:[],c:[]},Q:{n:"Q",p:[],c:[]},S:{n:"S",p:[],c:[]},T:{n:"T",p:[],c:[]},X:{n:"X",p:[],c:[]},Y:{n:"Y",p:[],c:[]},Z:{n:"Z",p:[],c:[]},Z1:{n:"",p:[],c:[]},Z2:{n:"",p:[],c:[]}};for(let u in XN){const m=XN[u];c[m.l].p.push(m)}this.provinceList=c},handleGetCityByProvince(){const c=L(this.provinceList),u=[],m=L(Hm),S=[{p:{n:"",p:"86",l:"Z1"},c:[]},{p:{n:"",p:"86",l:"Z2"},c:[]}];for(let b in c){const v=c[b];for(let M=0;M<v.p.length;M++){const N=v.p[M],X=N.c,U={p:N,c:[]};for(let H in m){const re=m[H];re.n=Jy(re.n),X===re.p&&U.c.push(re)}b==="Z1"?S[0].c.push(m[X]):b==="Z2"?S[1].c.push(m[X]):u.push(U)}}this.cityListByProvince=u.concat(S)},handleGetCityByLetter(){const c=L(Hm),u={A:[],B:[],C:[],D:[],E:[],F:[],G:[],H:[],J:[],K:[],L:[],M:[],N:[],P:[],Q:[],R:[],S:[],T:[],W:[],X:[],Y:[],Z:[]};for(let m in c){const S=c[m];S.n=Jy(S.n),u[S.l].push(S)}this.cityListByLetter=u}},created(){this.handleGetProvinceByLetter(),this.handleGetCityByProvince(),this.handleGetCityByLetter()}},ese=["name","value"],tse={class:"ivu-city-drop"},ise={key:0,class:"ivu-city-drop-cities"},nse=["onClick"],sse={class:"ivu-city-drop-menu"},rse={class:"ivu-city-drop-type"},ose={class:"ivu-city-drop-search"},ase={key:1,class:"ivu-city-drop-list"},lse={class:"ivu-city-drop-list-letter"},cse={class:"ivu-city-drop-list-main",ref:"list"},hse=["onClick"],use={key:2,class:"ivu-city-drop-list"},dse={class:"ivu-city-drop-list-letter"},fse={class:"ivu-city-drop-list-main ivu-city-drop-list-main-city",ref:"list"},pse=["onClick"];function mse(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("Radio"),X=n.resolveComponent("RadioGroup"),U=n.resolveComponent("Option"),H=n.resolveComponent("Select"),re=n.resolveComponent("Tag"),xe=n.resolveComponent("DropdownMenu"),ye=n.resolveComponent("Dropdown");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["ivu-city",v.classes]),ref:"city"},[n.createVNode(ye,{trigger:"custom",visible:b.visible,transfer:m.transfer,placement:"bottom-start","transfer-class-name":v.transferClasses,onOnVisibleChange:v.handleVisibleChange,onOnClickoutside:v.handleClickOutside},{list:n.withCtx(()=>[n.createVNode(xe,{onClick:u[3]||(u[3]=n.withModifiers(()=>{},["stop"]))},{default:n.withCtx(()=>[n.createElementVNode("div",tse,[m.cities.length?(n.openBlock(),n.createElementBlock("div",ise,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.relCities,me=>(n.openBlock(),n.createElementBlock("span",{key:me.n,onClick:ne=>v.handleChangeValue(me.c)},n.toDisplayString(me.n),9,nse))),128))])):n.createCommentVNode("",!0),n.createElementVNode("div",sse,[n.createElementVNode("div",rse,[n.createVNode(X,{modelValue:b.listType,"onUpdate:modelValue":u[1]||(u[1]=me=>b.listType=me),type:"button",size:"small"},{default:n.withCtx(()=>[n.createVNode(N,{label:"province"},{default:n.withCtx(()=>[n.createTextVNode("")]),_:1}),n.createVNode(N,{label:"city"},{default:n.withCtx(()=>[n.createTextVNode("")]),_:1})]),_:1},8,["modelValue"])]),n.createElementVNode("div",ose,[n.createVNode(H,{modelValue:b.queryCity,"onUpdate:modelValue":u[2]||(u[2]=me=>b.queryCity=me),filterable:"",size:"small",transfer:"",placeholder:m.searchPlaceholder,onOnChange:v.handleSelect},{default:n.withCtx(()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(b.allCities,me=>(n.openBlock(),n.createBlock(U,{value:me.c,key:me.c},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(me.n),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","placeholder","onOnChange"])])]),b.listType==="province"?(n.openBlock(),n.createElementBlock("div",ase,[n.createElementVNode("div",lse,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(b.provinceList,me=>(n.openBlock(),n.createBlock(re,{onClick:ne=>v.handleClickLetter(me.n),type:"border",fade:!1,key:me.n},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(me.n),1)]),_:2},1032,["onClick"]))),128))]),n.createElementVNode("div",cse,[n.createElementVNode("dl",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(b.cityListByProvince,me=>(n.openBlock(),n.createElementBlock(n.Fragment,{key:me.p.n},[n.createElementVNode("dt",{class:n.normalizeClass("ivu-city-"+me.p.l)},n.toDisplayString(me.p.n)+"",3),n.createElementVNode("dd",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(me.c,ne=>(n.openBlock(),n.createElementBlock("li",{key:ne.n,onClick:Te=>v.handleChangeValue(ne.c)},n.toDisplayString(ne.n),9,hse))),128))])],64))),128))])],512)])):n.createCommentVNode("",!0),b.listType==="city"?(n.openBlock(),n.createElementBlock("div",use,[n.createElementVNode("div",dse,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(b.cityListByLetter,(me,ne)=>(n.openBlock(),n.createBlock(re,{onClick:Te=>v.handleClickLetter(ne),type:"border",fade:!1,key:ne},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(ne),1)]),_:2},1032,["onClick"]))),128))]),n.createElementVNode("div",fse,[n.createElementVNode("dl",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(b.cityListByLetter,(me,ne)=>(n.openBlock(),n.createElementBlock(n.Fragment,{key:ne},[n.createElementVNode("dt",{class:n.normalizeClass("ivu-city-"+ne)},n.toDisplayString(ne)+"",3),n.createElementVNode("dd",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(me,Te=>(n.openBlock(),n.createElementBlock("li",{key:Te.n,onClick:Xt=>v.handleChangeValue(Te.c)},n.toDisplayString(Te.n),9,pse))),128))])],64))),128))])],512)])):n.createCommentVNode("",!0)])]),_:1})]),default:n.withCtx(()=>[n.createElementVNode("div",{class:"ivu-city-rel",onClick:u[0]||(u[0]=n.withModifiers((...me)=>v.handleToggleOpen&&v.handleToggleOpen(...me),["prevent","stop"]))},[n.createElementVNode("input",{type:"hidden",name:m.name,value:b.currentValue},null,8,ese),n.renderSlot(c.$slots,"default",{},()=>[n.createElementVNode("span",null,n.toDisplayString(v.codeToName),1),n.withDirectives(n.createVNode(M,{type:"ios-close-circle",class:"ivu-city-arrow",onClick:n.withModifiers(v.clearSelect,["stop"])},null,8,["onClick"]),[[n.vShow,v.showCloseIcon]]),n.createVNode(M,{type:"ios-arrow-down",class:"ivu-city-arrow"})])])]),_:3},8,["visible","transfer","transfer-class-name","onOnVisibleChange","onOnClickoutside"])],2)}var HN=l(Jne,[["render",mse]]);const GN="ivu-collapse",gse={name:"Collapse",emits:["on-change","update:modelValue"],provide(){return{CollapseInstance:this}},props:{accordion:{type:Boolean,default:!1},modelValue:{type:[Array,String]},simple:{type:Boolean,default:!1}},data(){return{currentValue:this.modelValue,panelCount:0}},computed:{classes(){return[`${GN}`,{[`${GN}-simple`]:this.simple}]}},methods:{getActiveKey(){let c=this.currentValue||[];const u=this.accordion;Array.isArray(c)||(c=[c]),u&&c.length>1&&(c=[c[0]]);for(let m=0;m<c.length;m++)c[m]=c[m].toString();return c},toggle(c){const u=c.name.toString();let m=[];if(this.accordion)c.isActive||m.push(u);else{let S=this.getActiveKey();const b=S.indexOf(u);c.isActive?b>-1&&S.splice(b,1):b<0&&S.push(u),m=S}this.currentValue=m,this.$emit("update:modelValue",m),this.$emit("on-change",m)}},watch:{modelValue(c){this.currentValue=c}}};function yse(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.renderSlot(c.$slots,"default")],2)}var QN=l(gse,[["render",yse]]);function ow(c){return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},ow(c)}var vse=/^\s+/,xse=/\s+$/;function zt(c,u){if(c=c||"",u=u||{},c instanceof zt)return c;if(!(this instanceof zt))return new zt(c,u);var m=_se(c);this._originalInput=c,this._r=m.r,this._g=m.g,this._b=m.b,this._a=m.a,this._roundA=Math.round(100*this._a)/100,this._format=u.format||m.format,this._gradientType=u.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=m.ok}zt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var c=this.toRgb();return(c.r*299+c.g*587+c.b*114)/1e3},getLuminance:function(){var c=this.toRgb(),u,m,S,b,v,M;return u=c.r/255,m=c.g/255,S=c.b/255,u<=.03928?b=u/12.92:b=Math.pow((u+.055)/1.055,2.4),m<=.03928?v=m/12.92:v=Math.pow((m+.055)/1.055,2.4),S<=.03928?M=S/12.92:M=Math.pow((S+.055)/1.055,2.4),.2126*b+.7152*v+.0722*M},setAlpha:function(c){return this._a=JN(c),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var c=jN(this._r,this._g,this._b);return{h:c.h*360,s:c.s,v:c.v,a:this._a}},toHsvString:function(){var c=jN(this._r,this._g,this._b),u=Math.round(c.h*360),m=Math.round(c.s*100),S=Math.round(c.v*100);return this._a==1?"hsv("+u+", "+m+"%, "+S+"%)":"hsva("+u+", "+m+"%, "+S+"%, "+this._roundA+")"},toHsl:function(){var c=YN(this._r,this._g,this._b);return{h:c.h*360,s:c.s,l:c.l,a:this._a}},toHslString:function(){var c=YN(this._r,this._g,this._b),u=Math.round(c.h*360),m=Math.round(c.s*100),S=Math.round(c.l*100);return this._a==1?"hsl("+u+", "+m+"%, "+S+"%)":"hsla("+u+", "+m+"%, "+S+"%, "+this._roundA+")"},toHex:function(c){return qN(this._r,this._g,this._b,c)},toHexString:function(c){return"#"+this.toHex(c)},toHex8:function(c){return Sse(this._r,this._g,this._b,this._a,c)},toHex8String:function(c){return"#"+this.toHex8(c)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ns(this._r,255)*100)+"%",g:Math.round(ns(this._g,255)*100)+"%",b:Math.round(ns(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ns(this._r,255)*100)+"%, "+Math.round(ns(this._g,255)*100)+"%, "+Math.round(ns(this._b,255)*100)+"%)":"rgba("+Math.round(ns(this._r,255)*100)+"%, "+Math.round(ns(this._g,255)*100)+"%, "+Math.round(ns(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:Lse[qN(this._r,this._g,this._b,!0)]||!1},toFilter:function(c){var u="#"+ZN(this._r,this._g,this._b,this._a),m=u,S=this._gradientType?"GradientType = 1, ":"";if(c){var b=zt(c);m="#"+ZN(b._r,b._g,b._b,b._a)}return"progid:DXImageTransform.Microsoft.gradient("+S+"startColorstr="+u+",endColorstr="+m+")"},toString:function(c){var u=!!c;c=c||this._format;var m=!1,S=this._a<1&&this._a>=0,b=!u&&S&&(c==="hex"||c==="hex6"||c==="hex3"||c==="hex4"||c==="hex8"||c==="name");return b?c==="name"&&this._a===0?this.toName():this.toRgbString():(c==="rgb"&&(m=this.toRgbString()),c==="prgb"&&(m=this.toPercentageRgbString()),(c==="hex"||c==="hex6")&&(m=this.toHexString()),c==="hex3"&&(m=this.toHexString(!0)),c==="hex4"&&(m=this.toHex8String(!0)),c==="hex8"&&(m=this.toHex8String()),c==="name"&&(m=this.toName()),c==="hsl"&&(m=this.toHslString()),c==="hsv"&&(m=this.toHsvString()),m||this.toHexString())},clone:function(){return zt(this.toString())},_applyModification:function(c,u){var m=c.apply(null,[this].concat([].slice.call(u)));return this._r=m._r,this._g=m._g,this._b=m._b,this.setAlpha(m._a),this},lighten:function(){return this._applyModification(Ese,arguments)},brighten:function(){return this._applyModification(Mse,arguments)},darken:function(){return this._applyModification(kse,arguments)},desaturate:function(){return this._applyModification(Cse,arguments)},saturate:function(){return this._applyModification(Tse,arguments)},greyscale:function(){return this._applyModification(Ase,arguments)},spin:function(){return this._applyModification(Pse,arguments)},_applyCombination:function(c,u){return c.apply(null,[this].concat([].slice.call(u)))},analogous:function(){return this._applyCombination(Rse,arguments)},complement:function(){return this._applyCombination(Ise,arguments)},monochromatic:function(){return this._applyCombination(Dse,arguments)},splitcomplement:function(){return this._applyCombination(Bse,arguments)},triad:function(){return this._applyCombination(KN,[3])},tetrad:function(){return this._applyCombination(KN,[4])}},zt.fromRatio=function(c,u){if(ow(c)=="object"){var m={};for(var S in c)c.hasOwnProperty(S)&&(S==="a"?m[S]=c[S]:m[S]=ev(c[S]));c=m}return zt(c,u)};function _se(c){var u={r:0,g:0,b:0},m=1,S=null,b=null,v=null,M=!1,N=!1;return typeof c=="string"&&(c=Use(c)),ow(c)=="object"&&(vh(c.r)&&vh(c.g)&&vh(c.b)?(u=bse(c.r,c.g,c.b),M=!0,N=String(c.r).substr(-1)==="%"?"prgb":"rgb"):vh(c.h)&&vh(c.s)&&vh(c.v)?(S=ev(c.s),b=ev(c.v),u=Ose(c.h,S,b),M=!0,N="hsv"):vh(c.h)&&vh(c.s)&&vh(c.l)&&(S=ev(c.s),v=ev(c.l),u=wse(c.h,S,v),M=!0,N="hsl"),c.hasOwnProperty("a")&&(m=c.a)),m=JN(m),{ok:M,format:c.format||N,r:Math.min(255,Math.max(u.r,0)),g:Math.min(255,Math.max(u.g,0)),b:Math.min(255,Math.max(u.b,0)),a:m}}function bse(c,u,m){return{r:ns(c,255)*255,g:ns(u,255)*255,b:ns(m,255)*255}}function YN(c,u,m){c=ns(c,255),u=ns(u,255),m=ns(m,255);var S=Math.max(c,u,m),b=Math.min(c,u,m),v,M,N=(S+b)/2;if(S==b)v=M=0;else{var X=S-b;switch(M=N>.5?X/(2-S-b):X/(S+b),S){case c:v=(u-m)/X+(u<m?6:0);break;case u:v=(m-c)/X+2;break;case m:v=(c-u)/X+4;break}v/=6}return{h:v,s:M,l:N}}function wse(c,u,m){var S,b,v;c=ns(c,360),u=ns(u,100),m=ns(m,100);function M(U,H,re){return re<0&&(re+=1),re>1&&(re-=1),re<1/6?U+(H-U)*6*re:re<1/2?H:re<2/3?U+(H-U)*(2/3-re)*6:U}if(u===0)S=b=v=m;else{var N=m<.5?m*(1+u):m+u-m*u,X=2*m-N;S=M(X,N,c+1/3),b=M(X,N,c),v=M(X,N,c-1/3)}return{r:S*255,g:b*255,b:v*255}}function jN(c,u,m){c=ns(c,255),u=ns(u,255),m=ns(m,255);var S=Math.max(c,u,m),b=Math.min(c,u,m),v,M,N=S,X=S-b;if(M=S===0?0:X/S,S==b)v=0;else{switch(S){case c:v=(u-m)/X+(u<m?6:0);break;case u:v=(m-c)/X+2;break;case m:v=(c-u)/X+4;break}v/=6}return{h:v,s:M,v:N}}function Ose(c,u,m){c=ns(c,360)*6,u=ns(u,100),m=ns(m,100);var S=Math.floor(c),b=c-S,v=m*(1-u),M=m*(1-b*u),N=m*(1-(1-b)*u),X=S%6,U=[m,M,v,v,N,m][X],H=[N,m,m,M,v,v][X],re=[v,v,N,m,m,M][X];return{r:U*255,g:H*255,b:re*255}}function qN(c,u,m,S){var b=[_l(Math.round(c).toString(16)),_l(Math.round(u).toString(16)),_l(Math.round(m).toString(16))];return S&&b[0].charAt(0)==b[0].charAt(1)&&b[1].charAt(0)==b[1].charAt(1)&&b[2].charAt(0)==b[2].charAt(1)?b[0].charAt(0)+b[1].charAt(0)+b[2].charAt(0):b.join("")}function Sse(c,u,m,S,b){var v=[_l(Math.round(c).toString(16)),_l(Math.round(u).toString(16)),_l(Math.round(m).toString(16)),_l(eV(S))];return b&&v[0].charAt(0)==v[0].charAt(1)&&v[1].charAt(0)==v[1].charAt(1)&&v[2].charAt(0)==v[2].charAt(1)&&v[3].charAt(0)==v[3].charAt(1)?v[0].charAt(0)+v[1].charAt(0)+v[2].charAt(0)+v[3].charAt(0):v.join("")}function ZN(c,u,m,S){var b=[_l(eV(S)),_l(Math.round(c).toString(16)),_l(Math.round(u).toString(16)),_l(Math.round(m).toString(16))];return b.join("")}zt.equals=function(c,u){return!c||!u?!1:zt(c).toRgbString()==zt(u).toRgbString()},zt.random=function(){return zt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function Cse(c,u){u=u===0?0:u||10;var m=zt(c).toHsl();return m.s-=u/100,m.s=aw(m.s),zt(m)}function Tse(c,u){u=u===0?0:u||10;var m=zt(c).toHsl();return m.s+=u/100,m.s=aw(m.s),zt(m)}function Ase(c){return zt(c).desaturate(100)}function Ese(c,u){u=u===0?0:u||10;var m=zt(c).toHsl();return m.l+=u/100,m.l=aw(m.l),zt(m)}function Mse(c,u){u=u===0?0:u||10;var m=zt(c).toRgb();return m.r=Math.max(0,Math.min(255,m.r-Math.round(255*-(u/100)))),m.g=Math.max(0,Math.min(255,m.g-Math.round(255*-(u/100)))),m.b=Math.max(0,Math.min(255,m.b-Math.round(255*-(u/100)))),zt(m)}function kse(c,u){u=u===0?0:u||10;var m=zt(c).toHsl();return m.l-=u/100,m.l=aw(m.l),zt(m)}function Pse(c,u){var m=zt(c).toHsl(),S=(m.h+u)%360;return m.h=S<0?360+S:S,zt(m)}function Ise(c){var u=zt(c).toHsl();return u.h=(u.h+180)%360,zt(u)}function KN(c,u){if(isNaN(u)||u<=0)throw new Error("Argument to polyad must be a positive number");for(var m=zt(c).toHsl(),S=[zt(c)],b=360/u,v=1;v<u;v++)S.push(zt({h:(m.h+v*b)%360,s:m.s,l:m.l}));return S}function Bse(c){var u=zt(c).toHsl(),m=u.h;return[zt(c),zt({h:(m+72)%360,s:u.s,l:u.l}),zt({h:(m+216)%360,s:u.s,l:u.l})]}function Rse(c,u,m){u=u||6,m=m||30;var S=zt(c).toHsl(),b=360/m,v=[zt(c)];for(S.h=(S.h-(b*u>>1)+720)%360;--u;)S.h=(S.h+b)%360,v.push(zt(S));return v}function Dse(c,u){u=u||6;for(var m=zt(c).toHsv(),S=m.h,b=m.s,v=m.v,M=[],N=1/u;u--;)M.push(zt({h:S,s:b,v})),v=(v+N)%1;return M}zt.mix=function(c,u,m){m=m===0?0:m||50;var S=zt(c).toRgb(),b=zt(u).toRgb(),v=m/100,M={r:(b.r-S.r)*v+S.r,g:(b.g-S.g)*v+S.g,b:(b.b-S.b)*v+S.b,a:(b.a-S.a)*v+S.a};return zt(M)},zt.readability=function(c,u){var m=zt(c),S=zt(u);return(Math.max(m.getLuminance(),S.getLuminance())+.05)/(Math.min(m.getLuminance(),S.getLuminance())+.05)},zt.isReadable=function(c,u,m){var S=zt.readability(c,u),b,v;switch(v=!1,b=Fse(m),b.level+b.size){case"AAsmall":case"AAAlarge":v=S>=4.5;break;case"AAlarge":v=S>=3;break;case"AAAsmall":v=S>=7;break}return v},zt.mostReadable=function(c,u,m){var S=null,b=0,v,M,N,X;m=m||{},M=m.includeFallbackColors,N=m.level,X=m.size;for(var U=0;U<u.length;U++)v=zt.readability(c,u[U]),v>b&&(b=v,S=zt(u[U]));return zt.isReadable(c,S,{level:N,size:X})||!M?S:(m.includeFallbackColors=!1,zt.mostReadable(c,["#fff","#000"],m))};var PE=zt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Lse=zt.hexNames=Nse(PE);function Nse(c){var u={};for(var m in c)c.hasOwnProperty(m)&&(u[c[m]]=m);return u}function JN(c){return c=parseFloat(c),(isNaN(c)||c<0||c>1)&&(c=1),c}function ns(c,u){Vse(c)&&(c="100%");var m=$se(c);return c=Math.min(u,Math.max(0,parseFloat(c))),m&&(c=parseInt(c*u,10)/100),Math.abs(c-u)<1e-6?1:c%u/parseFloat(u)}function aw(c){return Math.min(1,Math.max(0,c))}function ua(c){return parseInt(c,16)}function Vse(c){return typeof c=="string"&&c.indexOf(".")!=-1&&parseFloat(c)===1}function $se(c){return typeof c=="string"&&c.indexOf("%")!=-1}function _l(c){return c.length==1?"0"+c:""+c}function ev(c){return c<=1&&(c=c*100+"%"),c}function eV(c){return Math.round(parseFloat(c)*255).toString(16)}function tV(c){return ua(c)/255}var bl=function(){var c="[-\\+]?\\d+%?",u="[-\\+]?\\d*\\.\\d+%?",m="(?:"+u+")|(?:"+c+")",S="[\\s|\\(]+("+m+")[,|\\s]+("+m+")[,|\\s]+("+m+")\\s*\\)?",b="[\\s|\\(]+("+m+")[,|\\s]+("+m+")[,|\\s]+("+m+")[,|\\s]+("+m+")\\s*\\)?";return{CSS_UNIT:new RegExp(m),rgb:new RegExp("rgb"+S),rgba:new RegExp("rgba"+b),hsl:new RegExp("hsl"+S),hsla:new RegExp("hsla"+b),hsv:new RegExp("hsv"+S),hsva:new RegExp("hsva"+b),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function vh(c){return!!bl.CSS_UNIT.exec(c)}function Use(c){c=c.replace(vse,"").replace(xse,"").toLowerCase();var u=!1;if(PE[c])c=PE[c],u=!0;else if(c=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var m;return(m=bl.rgb.exec(c))?{r:m[1],g:m[2],b:m[3]}:(m=bl.rgba.exec(c))?{r:m[1],g:m[2],b:m[3],a:m[4]}:(m=bl.hsl.exec(c))?{h:m[1],s:m[2],l:m[3]}:(m=bl.hsla.exec(c))?{h:m[1],s:m[2],l:m[3],a:m[4]}:(m=bl.hsv.exec(c))?{h:m[1],s:m[2],v:m[3]}:(m=bl.hsva.exec(c))?{h:m[1],s:m[2],v:m[3],a:m[4]}:(m=bl.hex8.exec(c))?{r:ua(m[1]),g:ua(m[2]),b:ua(m[3]),a:tV(m[4]),format:u?"name":"hex8"}:(m=bl.hex6.exec(c))?{r:ua(m[1]),g:ua(m[2]),b:ua(m[3]),format:u?"name":"hex"}:(m=bl.hex4.exec(c))?{r:ua(m[1]+""+m[1]),g:ua(m[2]+""+m[2]),b:ua(m[3]+""+m[3]),a:tV(m[4]+""+m[4]),format:u?"name":"hex8"}:(m=bl.hex3.exec(c))?{r:ua(m[1]+""+m[1]),g:ua(m[2]+""+m[2]),b:ua(m[3]+""+m[3]),format:u?"name":"hex"}:!1}function Fse(c){var u,m;return c=c||{level:"AA",size:"small"},u=(c.level||"AA").toUpperCase(),m=(c.size||"small").toLowerCase(),u!=="AA"&&u!=="AAA"&&(u="AA"),m!=="small"&&m!=="large"&&(m="small"),{level:u,size:m}}var iV={inject:["ColorPickerInstance"],methods:{handleEscape(c){this.ColorPickerInstance.handleOnEscapeKeydown(c)}}},tv={data(){return{prefixCls:"ivu-color-picker",inputPrefixCls:"ivu-input",iconPrefixCls:"ivu-icon",transferPrefixCls:"ivu-transfer"}}};function IE(c,u){const m=zt(c),{_a:S}=m;return S==null&&m.setAlpha(u||1),m}function zse(c,u){const m=u&&u.a;if(u){if(u.hsl)return IE(u.hsl,m);if(u.hex&&u.hex.length>0)return IE(u.hex,m)}return IE(u,m)}function iv(c,u){const m=c===""?"#2d8cf0":c,S=zse(c,m),b=S.toHsl(),v=S.toHsv();return b.s===0&&(b.h=m.h||m.hsl&&m.hsl.h||u||0,v.h=b.h),v.v<.0164&&(v.h=m.h||m.hsv&&m.hsv.h||0,v.s=m.s||m.hsv&&m.hsv.s||0),b.l<.01&&(b.h=m.h||m.hsl&&m.hsl.h||0,b.s=m.s||m.hsl&&m.hsl.s||0),{hsl:b,hex:S.toHexString().toUpperCase(),rgba:S.toRgb(),hsv:v,oldHue:m.h||u||b.h,source:m.source,a:m.a||S.getAlpha()}}function wl(c,u,m){return c<u?u:c>m?m:c}function nV(c,u,m){return T(c,u)?m:0}function sV(c,u){return c.touches?c.touches[0][u]:0}function nv(c){const{r:u,g:m,b:S,a:b}=c;return`rgba(${[u,m,S,b].join(",")})`}const Xse={name:"RecommendedColors",mixins:[iV,tv],emits:["picker-color","change"],props:{list:{type:Array,default:void 0}},data(){const c=Math.ceil(this.list.length/12),u=1;return{left:-u,right:u,up:-u,down:u,powerKey:"shiftKey",grid:{x:1,y:1},rows:c,columns:12}},computed:{hideClass(){return`${this.prefixCls}-hide`},linearIndex(){return this.getLinearIndex(this.grid)},currentCircle(){return this.$refs[`color-circle-${this.linearIndex}`][0]}},methods:{getLinearIndex(c){return this.columns*(c.y-1)+c.x-1},getMaxLimit(c){return c==="x"?this.columns:this.rows},handleArrow(c,u,m){c.preventDefault(),c.stopPropagation(),this.blurColor();const S={...this.grid};c[this.powerKey]?m<0?S[u]=1:S[u]=this.getMaxLimit(u):S[u]+=m;const b=this.getLinearIndex(S);b>=0&&b<this.list.length&&(this.grid[u]=wl(S[u],1,this.getMaxLimit(u))),this.focusColor()},blurColor(){this.currentCircle.classList.add(this.hideClass)},focusColor(){this.currentCircle.classList.remove(this.hideClass)},handleEnter(c){this.handleClick(c,this.currentCircle)},handleClick(c,u){c.preventDefault(),c.stopPropagation(),this.$refs.reference.focus();const m=u||c.target,S=m.dataset.colorId||m.parentElement.dataset.colorId;if(S){this.blurColor();const b=Number(S)+1;this.grid.x=b%this.columns||this.columns,this.grid.y=Math.ceil(b/this.columns),this.focusColor(),this.$emit("picker-color",this.list[S]),this.$emit("change",{hex:this.list[S],source:"hex"})}},lineBreak(c,u){if(!u)return!1;const m=u+1;return m<c.length&&m%this.columns===0}}},Wse=["data-color-id"],Hse={key:0};function Gse(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{ref:"reference",tabindex:"0",onClick:u[0]||(u[0]=(...M)=>v.handleClick&&v.handleClick(...M)),onKeydown:[u[1]||(u[1]=n.withKeys((...M)=>c.handleEscape&&c.handleEscape(...M),["esc"])),u[2]||(u[2]=n.withKeys((...M)=>v.handleEnter&&v.handleEnter(...M),["enter"])),u[3]||(u[3]=n.withKeys(M=>v.handleArrow(M,"x",b.left),["left"])),u[4]||(u[4]=n.withKeys(M=>v.handleArrow(M,"x",b.right),["right"])),u[5]||(u[5]=n.withKeys(M=>v.handleArrow(M,"y",b.up),["up"])),u[6]||(u[6]=n.withKeys(M=>v.handleArrow(M,"y",b.down),["down"]))],onBlur:u[7]||(u[7]=(...M)=>v.blurColor&&v.blurColor(...M)),onFocus:u[8]||(u[8]=(...M)=>v.focusColor&&v.focusColor(...M))},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.list,(M,N)=>(n.openBlock(),n.createElementBlock(n.Fragment,{key:M+":"+N},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-picker-colors-wrapper"])},[n.createElementVNode("div",{"data-color-id":N},[n.createElementVNode("div",{style:n.normalizeStyle({background:M}),class:n.normalizeClass([c.prefixCls+"-picker-colors-wrapper-color"])},null,6),n.createElementVNode("div",{ref_for:!0,ref:"color-circle-"+N,class:n.normalizeClass([c.prefixCls+"-picker-colors-wrapper-circle",v.hideClass])},null,2)],8,Wse)],2),v.lineBreak(m.list,N)?(n.openBlock(),n.createElementBlock("br",Hse)):n.createCommentVNode("",!0)],64))),128))],544)}var Qse=l(Xse,[["render",Gse]]),sv={mixins:[iV],props:{focused:{type:Boolean,default:!1},value:{type:Object,default:void 0}},created(){this.focused&&setTimeout(()=>this.$el.focus(),1)},beforeUnmount(){this.unbindEventListeners()},methods:{handleLeft(c){this.handleSlide(c,this.left,"left")},handleRight(c){this.handleSlide(c,this.right,"right")},handleUp(c){this.handleSlide(c,this.up,"up")},handleDown(c){this.handleSlide(c,this.down,"down")},handleMouseDown(c){this.ColorPickerInstance.handleOnDragging(!0),this.handleChange(c,!0),o(window,"mousemove",this.handleChange),o(window,"mouseup",this.handleMouseUp)},handleMouseUp(){this.unbindEventListeners()},unbindEventListeners(){a(window,"mousemove",this.handleChange),a(window,"mouseup",this.handleMouseUp),setTimeout(()=>this.ColorPickerInstance.handleOnDragging(!1),1)},getLeft(c){if(!r)return;const{container:u}=this.$refs,m=u.getBoundingClientRect().left+window.pageXOffset;return(c.pageX||sV(c,"PageX"))-m},getTop(c){if(!r)return;const{container:u}=this.$refs,m=u.getBoundingClientRect().top+window.pageYOffset;return(c.pageY||sV(c,"PageY"))-m}}};const Yse={name:"Saturation",mixins:[sv,tv],emits:["change"],data(){return{left:-.01,right:.01,up:.01,down:-.01,multiplier:10,powerKey:"shiftKey"}},computed:{bgColorStyle(){return{background:`hsl(${this.value.hsv.h}, 100%, 50%)`}},pointerStyle(){return{top:`${-(this.value.hsv.v*100)+1+100}%`,left:`${this.value.hsv.s*100}%`}}},methods:{change(c,u,m,S){this.$emit("change",{h:c,s:u,v:m,a:S,source:"hsva"})},handleSlide(c,u,m){c.preventDefault(),c.stopPropagation();const S=c[this.powerKey]?u*this.multiplier:u,{h:b,s:v,v:M,a:N}=this.value.hsv,X=wl(v+nV(m,["left","right"],S),0,1),U=wl(M+nV(m,["up","down"],S),0,1);this.change(b,X,U,N)},handleChange(c){c.preventDefault(),c.stopPropagation();const{clientWidth:u,clientHeight:m}=this.$refs.container,S=wl(this.getLeft(c),0,u),b=wl(this.getTop(c),0,m),v=S/u,M=wl(1-b/m,0,1);this.change(this.value.hsv.h,v,M,this.value.hsv.a)},handleMouseDown(c){sv.methods.handleMouseDown.call(this,c),o(window,"mouseup",this.handleChange)},unbindEventListeners(c){sv.methods.unbindEventListeners.call(this,c),a(window,"mouseup",this.handleChange)}}};function jse(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([c.prefixCls+"-saturation-wrapper"]),tabindex:"0",onKeydown:[u[1]||(u[1]=n.withKeys((...M)=>c.handleEscape&&c.handleEscape(...M),["esc"])),u[3]||(u[3]=n.withKeys((...M)=>c.handleLeft&&c.handleLeft(...M),["left"])),u[4]||(u[4]=n.withKeys((...M)=>c.handleRight&&c.handleRight(...M),["right"])),u[5]||(u[5]=n.withKeys((...M)=>c.handleUp&&c.handleUp(...M),["up"])),u[6]||(u[6]=n.withKeys((...M)=>c.handleDown&&c.handleDown(...M),["down"]))],onClick:u[2]||(u[2]=M=>c.$el.focus())},[n.createElementVNode("div",{ref:"container",style:n.normalizeStyle(v.bgColorStyle),class:n.normalizeClass([c.prefixCls+"-saturation"]),onMousedown:u[0]||(u[0]=(...M)=>v.handleMouseDown&&v.handleMouseDown(...M))},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-saturation--white"])},null,2),n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-saturation--black"])},null,2),n.createElementVNode("div",{style:n.normalizeStyle(v.pointerStyle),class:n.normalizeClass([c.prefixCls+"-saturation-pointer"])},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-saturation-circle"])},null,2)],6)],38)],34)}var qse=l(Yse,[["render",jse]]);const Zse={name:"Hue",mixins:[sv,tv],emits:["change"],data(){const c=.06944444444444445,u=20*c;return{left:-c,right:c,up:u,down:-u,powerKey:"shiftKey",percent:wl(this.value.hsl.h*100/360,0,100)}},watch:{value(){this.percent=wl(this.value.hsl.h*100/360,0,100)}},methods:{change(c){this.percent=wl(c,0,100);const{h:u,s:m,l:S,a:b}=this.value.hsl,v=wl(c/100*360,0,360);u!==v&&this.$emit("change",{h:v,s:m,l:S,a:b,source:"hsl"})},handleSlide(c,u){if(c.preventDefault(),c.stopPropagation(),c[this.powerKey]){this.change(u<0?0:100);return}this.change(this.percent+u)},handleChange(c){c.preventDefault(),c.stopPropagation();const u=this.getLeft(c);if(u<0){this.change(0);return}const{clientWidth:m}=this.$refs.container;if(u>m){this.change(100);return}this.change(u*100/m)}}};function Kse(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([c.prefixCls+"-hue"]),tabindex:"0",onClick:u[3]||(u[3]=M=>c.$el.focus()),onKeydown:[u[4]||(u[4]=n.withKeys((...M)=>c.handleEscape&&c.handleEscape(...M),["esc"])),u[5]||(u[5]=n.withKeys((...M)=>c.handleLeft&&c.handleLeft(...M),["left"])),u[6]||(u[6]=n.withKeys((...M)=>c.handleRight&&c.handleRight(...M),["right"])),u[7]||(u[7]=n.withKeys((...M)=>c.handleUp&&c.handleUp(...M),["up"])),u[8]||(u[8]=n.withKeys((...M)=>c.handleDown&&c.handleDown(...M),["down"]))]},[n.createElementVNode("div",{ref:"container",class:n.normalizeClass([c.prefixCls+"-hue-container"]),onMousedown:u[0]||(u[0]=(...M)=>c.handleMouseDown&&c.handleMouseDown(...M)),onTouchmove:u[1]||(u[1]=(...M)=>v.handleChange&&v.handleChange(...M)),onTouchstart:u[2]||(u[2]=(...M)=>v.handleChange&&v.handleChange(...M))},[n.createElementVNode("div",{style:n.normalizeStyle({top:0,left:`${b.percent}%`}),class:n.normalizeClass([c.prefixCls+"-hue-pointer"])},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-hue-picker"])},null,2)],6)],34)],34)}var Jse=l(Zse,[["render",Kse]]);const ere={name:"Alpha",mixins:[sv,tv],emits:["change"],data(){return{left:-1,right:1,up:10,down:-10,powerKey:"shiftKey"}},computed:{gradientStyle(){const{r:c,g:u,b:m}=this.value.rgba,S=nv({r:c,g:u,b:m,a:0}),b=nv({r:c,g:u,b:m,a:1});return{background:`linear-gradient(to right, ${S} 0%, ${b} 100%)`}}},methods:{change(c){const{h:u,s:m,l:S}=this.value.hsl,{a:b}=this.value;b!==c&&this.$emit("change",{h:u,s:m,l:S,a:c,source:"rgba"})},handleSlide(c,u){c.preventDefault(),c.stopPropagation(),this.change(wl(c[this.powerKey]?u:Math.round(this.value.hsl.a*100+u)/100,0,1))},handleChange(c){c.preventDefault(),c.stopPropagation();const u=this.getLeft(c);if(u<0){this.change(0);return}const{clientWidth:m}=this.$refs.container;if(u>m){this.change(1);return}this.change(Math.round(u*100/m)/100)}}};function tre(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([c.prefixCls+"-alpha"]),tabindex:"0",onClick:u[3]||(u[3]=M=>c.$el.focus()),onKeydown:[u[4]||(u[4]=n.withKeys((...M)=>c.handleEscape&&c.handleEscape(...M),["esc"])),u[5]||(u[5]=n.withKeys((...M)=>c.handleLeft&&c.handleLeft(...M),["left"])),u[6]||(u[6]=n.withKeys((...M)=>c.handleRight&&c.handleRight(...M),["right"])),u[7]||(u[7]=n.withKeys((...M)=>c.handleUp&&c.handleUp(...M),["up"])),u[8]||(u[8]=n.withKeys((...M)=>c.handleDown&&c.handleDown(...M),["down"]))]},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-alpha-checkboard-wrap"])},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-alpha-checkerboard"])},null,2)],2),n.createElementVNode("div",{style:n.normalizeStyle(v.gradientStyle),class:n.normalizeClass([c.prefixCls+"-alpha-gradient"])},null,6),n.createElementVNode("div",{ref:"container",class:n.normalizeClass([c.prefixCls+"-alpha-container"]),onMousedown:u[0]||(u[0]=(...M)=>c.handleMouseDown&&c.handleMouseDown(...M)),onTouchmove:u[1]||(u[1]=(...M)=>v.handleChange&&v.handleChange(...M)),onTouchstart:u[2]||(u[2]=(...M)=>v.handleChange&&v.handleChange(...M))},[n.createElementVNode("div",{style:n.normalizeStyle({top:0,left:`${c.value.a*100}%`}),class:n.normalizeClass([c.prefixCls+"-alpha-pointer"])},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-alpha-picker"])},null,2)],6)],34)],34)}var ire=l(ere,[["render",tre]]);const nre={name:"ColorPicker",components:{Drop:Ke,RecommendColors:Qse,Saturation:qse,Hue:Jse,Alpha:ire,iInput:Xa,iButton:co,Icon:O},directives:{clickOutside:Di},mixins:[Sn,tv,Li,xl],emits:["on-active-change","on-open-change","on-change","on-pick-success","on-pick-clear","update:modelValue"],provide(){return{ColorPickerInstance:this}},props:{modelValue:{type:String,default:void 0},hue:{type:Boolean,default:!0},alpha:{type:Boolean,default:!1},recommend:{type:Boolean,default:!1},format:{type:String,validator(c){return T(c,["hsl","hsv","hex","rgb"])},default:void 0},colors:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},hideDropDown:{type:Boolean,default:!1},placement:{type:String,validator(c){return T(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String,default:void 0},editable:{type:Boolean,default:!0},capture:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},transferClassName:{type:String},eventsEnabled:{type:Boolean,default:!1}},data(){return{val:iv(this.modelValue||""),currentValue:this.modelValue||"",dragging:!1,visible:!1,recommendedColor:["#2d8cf0","#19be6b","#ff9900","#ed4014","#00b5ff","#19c919","#f9e31c","#ea1a1a","#9b1dea","#00c2b1","#ac7a33","#1d35ea","#8bc34a","#f16b62","#ea4ca3","#0d94aa","#febd79","#5d4037","#00bcd4","#f06292","#cddc39","#607d8b","#000000","#ffffff"]}},computed:{arrowClasses(){return[`${this.inputPrefixCls}-icon`,`${this.inputPrefixCls}-icon-normal`]},transition(){return T(this.placement,["bottom-start","bottom","bottom-end"])?"slide-up":"fade"},saturationColors:{get(){return this.val},set(c){this.val=c,this.$emit("on-active-change",this.formatColor)}},classes(){return[`${this.prefixCls}`,{[`${this.prefixCls}-transfer`]:this.transfer}]},wrapClasses(){return[`${this.prefixCls}-rel`,`${this.prefixCls}-${this.size}`,`${this.inputPrefixCls}-wrapper`,`${this.inputPrefixCls}-wrapper-${this.size}`,{[`${this.prefixCls}-disabled`]:this.itemDisabled}]},inputClasses(){return[`${this.prefixCls}-input`,`${this.inputPrefixCls}`,`${this.inputPrefixCls}-${this.size}`,{[`${this.prefixCls}-focused`]:this.visible,[`${this.prefixCls}-disabled`]:this.itemDisabled}]},dropClasses(){return{[`${this.transferPrefixCls}-no-max-height`]:!0,[`${this.prefixCls}-transfer`]:this.transfer,[`${this.prefixCls}-hide-drop`]:this.hideDropDown,[this.transferClassName]:this.transferClassName}},displayedColorStyle(){return{backgroundColor:nv(this.visible?this.saturationColors.rgba:zt(this.modelValue).toRgb())}},formatColor(){const{format:c,saturationColors:u}=this;if(c){if(c==="hsl")return zt(u.hsl).toHslString();if(c==="hsv")return zt(u.hsv).toHsvString();if(c==="hex")return u.hex;if(c==="rgb")return nv(u.rgba)}else if(this.alpha)return nv(u.rgba);return u.hex},confirmColorClasses(){return[`${this.prefixCls}-confirm-color`,{[`${this.prefixCls}-confirm-color-editable`]:this.editable}]},arrowType(){const c=this.globalConfig;let u="ios-arrow-down";return c&&(c.colorPicker.customArrow?u="":c.colorPicker.arrow&&(u=c.colorPicker.arrow)),u},customArrowType(){const c=this.globalConfig;let u="";return c&&c.colorPicker.customArrow&&(u=c.colorPicker.customArrow),u},arrowSize(){const c=this.globalConfig;let u="";return c&&c.colorPicker.arrowSize&&(u=c.colorPicker.arrowSize),u}},watch:{modelValue(c){this.val=iv(c||"")},visible(c){this.val=iv(this.modelValue||""),this.$refs.drop[c?"update":"destroy"](),this.$emit("on-open-change",!!c)}},methods:{setDragging(c){this.dragging=c},handleClose(c){if(this.visible){if(this.dragging||c.type==="mousedown"){this.$refs.editColorInput&&c.target!==this.$refs.editColorInput.$el.querySelector("input")&&c.preventDefault();return}if(this.transfer){const u=this.$refs.drop.$refs.drop;if(u===c.target||u.contains(c.target))return}this.closer(c);return}this.visible=!1},toggleVisible(){this.itemDisabled||(this.visible=!this.visible,this.$refs.input.focus())},childChange(c){this.colorChange(c)},colorChange(c,u){this.oldHue=this.saturationColors.hsl.h,this.saturationColors=iv(c,u||this.oldHue)},closer(c){c&&(c.preventDefault(),c.stopPropagation()),this.visible=!1,this.$refs.input.focus()},handleButtons(c,u){this.currentValue=u,this.$emit("update:modelValue",u),this.$emit("on-change",u),this.handleFormItemChange("change",u),this.closer(c)},handleSuccess(c){this.handleButtons(c,this.formatColor),this.$emit("on-pick-success")},handleClear(c){this.handleButtons(c,""),this.$emit("on-pick-clear")},handleSelectColor(c){this.val=iv(c),this.$emit("on-active-change",this.formatColor)},handleEditColor(c){const u=c.target.value;this.handleSelectColor(u)},handleFirstTab(c){c.shiftKey&&(c.preventDefault(),c.stopPropagation(),this.$refs.ok.$el.focus())},handleLastTab(c){c.shiftKey||(c.preventDefault(),c.stopPropagation(),this.$refs.saturation.$el.focus())},onTab(c){this.visible&&c.preventDefault()},onEscape(c){this.visible&&this.closer(c)},onArrow(c){this.visible||(c.preventDefault(),c.stopPropagation(),this.visible=!0)},handleOnEscapeKeydown(c){this.closer(c)},handleOnDragging(c){this.setDragging(c)}}},sre=["name","value"],rre=["tabindex"];function ore(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("Saturation"),X=n.resolveComponent("Hue"),U=n.resolveComponent("Alpha"),H=n.resolveComponent("recommend-colors"),re=n.resolveComponent("i-input"),xe=n.resolveComponent("i-button"),ye=n.resolveComponent("Drop"),me=n.resolveDirective("click-outside");return n.withDirectives((n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.createElementVNode("div",{ref:"reference",class:n.normalizeClass(v.wrapClasses),onClick:u[4]||(u[4]=(...ne)=>v.toggleVisible&&v.toggleVisible(...ne))},[n.createElementVNode("input",{name:m.name,value:b.currentValue,type:"hidden"},null,8,sre),n.createVNode(M,{type:v.arrowType,custom:v.customArrowType,size:v.arrowSize,class:n.normalizeClass(v.arrowClasses)},null,8,["type","custom","size","class"]),n.createElementVNode("div",{ref:"input",tabindex:c.itemDisabled?void 0:0,class:n.normalizeClass(v.inputClasses),onKeydown:[u[0]||(u[0]=n.withKeys((...ne)=>v.onTab&&v.onTab(...ne),["tab"])),u[1]||(u[1]=n.withKeys((...ne)=>v.onEscape&&v.onEscape(...ne),["esc"])),u[2]||(u[2]=n.withKeys((...ne)=>v.onArrow&&v.onArrow(...ne),["up"])),u[3]||(u[3]=n.withKeys((...ne)=>v.onArrow&&v.onArrow(...ne),["down"]))]},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-color"])},[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-color-empty"])},[n.createElementVNode("i",{class:n.normalizeClass([c.iconPrefixCls,c.iconPrefixCls+"-ios-close"])},null,2)],2),[[n.vShow,m.modelValue===""&&!b.visible]]),n.withDirectives(n.createElementVNode("div",{style:n.normalizeStyle(v.displayedColorStyle)},null,4),[[n.vShow,m.modelValue||b.visible]])],2)],42,rre)],2),n.createVNode(ye,{ref:"drop",visible:b.visible,placement:m.placement,transfer:m.transfer,classes:v.dropClasses,eventsEnabled:m.eventsEnabled,"transition-name":"transition-drop"},{default:n.withCtx(()=>[n.createVNode(n.Transition,{name:"fade"},{default:n.withCtx(()=>[b.visible?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([c.prefixCls+"-picker"])},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-picker-wrapper"])},[n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-picker-panel"])},[n.createVNode(N,{ref:"saturation",value:v.saturationColors,focused:b.visible,onChange:v.childChange,onKeydown:n.withKeys(v.handleFirstTab,["tab"])},null,8,["value","focused","onChange","onKeydown"])],2),m.hue?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([c.prefixCls+"-picker-hue-slider"])},[n.createVNode(X,{value:v.saturationColors,onChange:v.childChange},null,8,["value","onChange"])],2)):n.createCommentVNode("",!0),m.alpha?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass([c.prefixCls+"-picker-alpha-slider"])},[n.createVNode(U,{value:v.saturationColors,onChange:v.childChange},null,8,["value","onChange"])],2)):n.createCommentVNode("",!0),m.colors.length?(n.openBlock(),n.createBlock(H,{key:2,list:m.colors,class:n.normalizeClass([c.prefixCls+"-picker-colors"]),onPickerColor:v.handleSelectColor},null,8,["list","class","onPickerColor"])):n.createCommentVNode("",!0),!m.colors.length&&m.recommend?(n.openBlock(),n.createBlock(H,{key:3,list:b.recommendedColor,class:n.normalizeClass([c.prefixCls+"-picker-colors"]),onPickerColor:v.handleSelectColor},null,8,["list","class","onPickerColor"])):n.createCommentVNode("",!0)],2),n.createElementVNode("div",{class:n.normalizeClass([c.prefixCls+"-confirm"])},[n.createElementVNode("span",{class:n.normalizeClass(v.confirmColorClasses)},[m.editable?(n.openBlock(),n.createBlock(re,{key:0,ref:"editColorInput",modelValue:v.formatColor,size:"small",onOnEnter:v.handleEditColor,onOnBlur:v.handleEditColor},null,8,["modelValue","onOnEnter","onOnBlur"])):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createTextVNode(n.toDisplayString(v.formatColor),1)],64))],2),n.createVNode(xe,{class:n.normalizeClass([c.prefixCls+"-confirm-btn-cancel"]),ref:"clear",tabindex:0,size:"small",onClick:v.handleClear,onKeydown:[n.withKeys(v.handleClear,["enter"]),n.withKeys(v.closer,["esc"])]},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(c.t("i.datepicker.clear")),1)]),_:1},8,["class","onClick","onKeydown"]),n.createVNode(xe,{ref:"ok",tabindex:0,size:"small",type:"primary",onClick:v.handleSuccess,onKeydown:[n.withKeys(v.handleLastTab,["tab"]),n.withKeys(v.handleSuccess,["enter"]),n.withKeys(v.closer,["esc"])]},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(c.t("i.datepicker.ok")),1)]),_:1},8,["onClick","onKeydown"])],2)],2)):n.createCommentVNode("",!0)]),_:1})]),_:1},8,["visible","placement","transfer","classes","eventsEnabled"])],2)),[[me,v.handleClose,m.capture]])}var rV=l(nre,[["render",ore]]);const are="ivu-layout",lre={name:"Content",computed:{wrapClasses(){return`${are}-content`}}};function cre(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses)},[n.renderSlot(c.$slots,"default")],2)}var BE=l(lre,[["render",cre]]);function hre(c){var u;if(c.nodeName==="SELECT")c.focus(),u=c.value;else if(c.nodeName==="INPUT"||c.nodeName==="TEXTAREA"){var m=c.hasAttribute("readonly");m||c.setAttribute("readonly",""),c.select(),c.setSelectionRange(0,c.value.length),m||c.removeAttribute("readonly"),u=c.value}else{c.hasAttribute("contenteditable")&&c.focus();var S=window.getSelection(),b=document.createRange();b.selectNodeContents(c),S.removeAllRanges(),S.addRange(b),u=S.toString()}return u}var ure=hre,oV={name:"RenderCell",props:{render:Function},render(){return this.render(n.h)}};const dre={components:{RenderCell:oV},props:{prefixCls:{type:String,default:""},duration:{type:Number,default:1.5},type:{type:String},content:{type:String,default:""},withIcon:Boolean,render:{type:Function},hasTitle:Boolean,styles:{type:Object,default:function(){return{right:"50%"}}},closable:{type:Boolean,default:!1},className:{type:String},name:{type:String,required:!0},onClose:{type:Function},transitionName:{type:String},background:{type:Boolean,default:!1},msgType:{type:String}},data(){return{withDesc:!1}},computed:{baseClass(){return`${this.prefixCls}-notice`},renderFunc(){return this.render||function(){}},classes(){return[this.baseClass,{[`${this.className}`]:!!this.className,[`${this.baseClass}-closable`]:this.closable,[`${this.baseClass}-with-desc`]:this.withDesc,[`${this.baseClass}-with-background`]:this.background}]},contentClasses(){return[`${this.baseClass}-content`,this.render!==void 0?`${this.baseClass}-content-with-render`:""]},messageContentClasses(){return[`${this.baseClass}-content`,{[`${this.baseClass}-content-${this.msgType}`]:this.msgType,[`${this.baseClass}-content-background`]:this.background}]},contentWithIcon(){return[this.withIcon?`${this.prefixCls}-content-with-icon`:"",!this.hasTitle&&this.withIcon?`${this.prefixCls}-content-with-render-notitle`:""]},messageClasses(){return[`${this.baseClass}-content`,this.render!==void 0?`${this.baseClass}-content-with-render`:""]}},methods:{clearCloseTimer(){this.closeTimer&&(clearTimeout(this.closeTimer),this.closeTimer=null)},close(){this.clearCloseTimer(),this.onClose(),this.$parent.$parent.close(this.name)},handleEnter(c){this.type==="message"&&(c.style.height=c.scrollHeight+"px")},handleLeave(c){this.type==="message"&&r&&document.getElementsByClassName("ivu-message-notice").length!==1&&(c.style.height=0,c.style.paddingTop=0,c.style.paddingBottom=0)}},mounted(){if(this.handleEnter(this.$el),this.clearCloseTimer(),this.duration!==0&&(this.closeTimer=setTimeout(()=>{this.close()},this.duration*1e3)),this.prefixCls==="ivu-notice"){let c=this.$refs.content.querySelectorAll(`.${this.prefixCls}-desc`)[0];this.withDesc=this.render?!0:c?c.innerHTML!=="":!1}},beforeUnmount(){this.handleLeave(this.$el),this.clearCloseTimer()}},fre=["innerHTML"],pre=[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-close"},null,-1)],mre=["innerHTML"],gre=[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-close"},null,-1)];function yre(c,u,m,S,b,v){const M=n.resolveComponent("render-cell");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(m.styles)},[m.type==="notice"?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createElementVNode("div",{class:n.normalizeClass(v.contentClasses),ref:"content",innerHTML:m.content},null,10,fre),n.createElementVNode("div",{class:n.normalizeClass(v.contentWithIcon)},[n.createVNode(M,{render:v.renderFunc},null,8,["render"])],2),m.closable?(n.openBlock(),n.createElementBlock("a",{key:0,class:n.normalizeClass([v.baseClass+"-close"]),onClick:u[0]||(u[0]=(...N)=>v.close&&v.close(...N))},pre,2)):n.createCommentVNode("",!0)],64)):n.createCommentVNode("",!0),m.type==="message"?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass(v.messageContentClasses),ref:"content"},[n.createElementVNode("div",{class:n.normalizeClass([v.baseClass+"-content-text"]),innerHTML:m.content},null,10,mre),n.createElementVNode("div",{class:n.normalizeClass([v.baseClass+"-content-text"])},[n.createVNode(M,{render:v.renderFunc},null,8,["render"])],2),m.closable?(n.openBlock(),n.createElementBlock("a",{key:0,class:n.normalizeClass([v.baseClass+"-close"]),onClick:u[1]||(u[1]=(...N)=>v.close&&v.close(...N))},gre,2)):n.createCommentVNode("",!0)],2)):n.createCommentVNode("",!0)],6)}var vre=l(dre,[["render",yre]]);const xre="ivu-notification";let _re=0;const bre=Date.now();function wre(){return"ivuNotification_"+bre+"_"+_re++}const Ore={components:{Notice:vre},props:{prefixCls:{type:String,default:xre},styles:{type:Object,default:function(){return{top:"65px",left:"50%"}}},content:{type:String},className:{type:String},transitionName:{type:String}},data(){return{notices:[],tIndex:this.handleGetIndex()}},computed:{classes(){return[`${this.prefixCls}`,{[`${this.className}`]:!!this.className}]},wrapStyles(){let c=Object.assign({},this.styles);return c["z-index"]=1010+this.tIndex,c}},methods:{add(c){const u=c.name||wre();let m=Object.assign({styles:{right:"50%"},content:"",duration:1.5,closable:!1,name:u},c);this.notices.push(m),this.tIndex=this.handleGetIndex()},close(c){const u=this.notices;for(let m=0;m<u.length;m++)if(u[m].name===c){this.notices.splice(m,1);break}},closeAll(){this.notices=[]},handleGetIndex(){return je(),Oe}}};function Sre(c,u,m,S,b,v){const M=n.resolveComponent("Notice");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.wrapStyles)},[n.createVNode(n.TransitionGroup,{name:m.transitionName,appear:""},{default:n.withCtx(()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(b.notices,N=>(n.openBlock(),n.createBlock(M,{key:N.name,"prefix-cls":m.prefixCls,styles:N.styles,type:N.type,content:N.content,duration:N.duration,render:N.render,"has-title":N.hasTitle,withIcon:N.withIcon,closable:N.closable,name:N.name,"transition-name":N.transitionName,background:N.background,"msg-type":N.msgType,"on-close":N.onClose},null,8,["prefix-cls","styles","type","content","duration","render","has-title","withIcon","closable","name","transition-name","background","msg-type","on-close"]))),128))]),_:1},8,["name"])],6)}var lw=l(Ore,[["render",Sre]]);lw.newInstance=c=>{if(!r)return;const u=c||{};let m=null;const S=n.createApp({render(){return n.h(lw,Object.assign({ref:"notification"},u))},created(){m=n.getCurrentInstance()}}),b=document.createElement("div");document.body.appendChild(b),S.mount(b);const v=m.refs.notification;return{notice(M){v.add(M)},remove(M){v.close(M)},component:v,destroy(M){v.closeAll(),r&&setTimeout(function(){document.body.removeChild(document.getElementsByClassName(M)[0])},500)}}};const RE="ivu-message",aV="ivu-icon",lV="ivu_message_key_",Gm={top:24,duration:1.5,background:!1};let cw,cV=1;const Cre={info:"ios-information-circle",success:"ios-checkmark-circle",warning:"ios-alert",error:"ios-close-circle",loading:"ios-loading"},hV="move-up";function uV(){return cw=cw||lw.newInstance({prefixCls:RE,styles:{top:`${Gm.top}px`},transitionName:hV}),cw}function Tre(c="",u=Gm.duration,m,S=function(){},b=!1,v=function(){},M=Gm.background){const N=Cre[m],X=m==="loading"?" ivu-load-loop":"";let U=uV();return U.notice({name:`${lV}${cV}`,duration:u,styles:{},transitionName:hV,content:`
            <div class="${RE}-custom-content ${RE}-${m}">
                <i class="${aV} ${aV}-${N} ${X}"></i>
                <span>${c}</span>
            </div>
        `,render:v,onClose:S,closable:b,type:"message",msgType:m,background:M}),function(){let H=cV++;return function(){U.remove(`${lV}${H}`)}}()}var rv={name:"Message",info(c){return this.message("info",c)},success(c){return this.message("success",c)},warning(c){return this.message("warning",c)},error(c){return this.message("error",c)},loading(c){return this.message("loading",c)},message(c,u){return typeof u=="string"&&(u={content:u}),Tre(u.content,u.duration,c,u.onClose,u.closable,u.render,u.background)},config(c){(c.top||c.top===0)&&(Gm.top=c.top),(c.duration||c.duration===0)&&(Gm.duration=c.duration),c.background&&(Gm.background=c.background)},destroy(){let c=uV();cw=null,c.destroy("ivu-message")}};const Are="",Ere="";function hw({text:c="",successTip:u=Are,errorTip:m=Ere,success:S,error:b,showTip:v=!0}){if(!r)return;const M=document.documentElement.getAttribute("dir")==="rtl",N=document.createElement("textarea");N.style.fontSize="12pt",N.style.border="0",N.style.padding="0",N.style.margin="0",N.style.position="absolute",N.style[M?"right":"left"]="-9999px";let X=window.pageYOffset||document.documentElement.scrollTop;N.style.top=`${X}px`,N.setAttribute("readonly",""),N.value=c,document.body.appendChild(N),ure(N);let U;try{U=document.execCommand("copy"),v&&rv.success({content:u}),document.body.removeChild(N),S&&S.call()}catch{U=!1,v&&rv.error({content:m}),document.body.removeChild(N),b&&b.call()}}function DE(c){return c*1<10?`0${c}`:c}const Mre={name:"CountDown",emits:["on-end"],props:{format:{type:Function},target:{type:[Date,Number]},interval:{type:Number,default:1e3}},data(){return{lastTime:""}},methods:{initTime(){let c=0,u=0;try{Object.prototype.toString.call(this.target)==="[object Date]"?u=this.target.getTime():u=new Date(this.target).getTime()}catch(m){throw new Error("invalid target prop",m)}return c=u-new Date().getTime(),c<0?0:c},tick(){let{lastTime:c}=this;this.timer=setTimeout(()=>{c<this.interval?(clearTimeout(this.timer),this.lastTime=0,this.$emit("on-end")):(c-=this.interval,this.lastTime=c,this.tick())},this.interval)},defaultFormat(c){const u=Math.floor(c/36e5),m=Math.floor((c-u*36e5)/6e4),S=Math.floor((c-u*36e5-m*6e4)/1e3);return`${DE(u)}:${DE(m)}:${DE(S)}`}},computed:{result(){const{format:c=this.defaultFormat}=this;return c(this.lastTime)}},watch:{target(){this.timer&&clearTimeout(this.timer),this.lastTime=this.initTime(),this.tick()}},created(){this.lastTime=this.initTime()},mounted(){this.tick()},beforeUnmount(){this.timer&&clearTimeout(this.timer)}};function kre(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("span",null,n.toDisplayString(v.result),1)}var dV=l(Mre,[["render",kre]]),LE={exports:{}};(function(c,u){(function(m,S){c.exports=S(G,u,c)})(Z,function(m,S,b){var v=function(M,N,X,U,H,re){function xe(He){var ke,it,qe,Jt,ei,Rt,Et=He<0;if(He=Math.abs(He).toFixed(ne.decimals),He+="",ke=He.split("."),it=ke[0],qe=ke.length>1?ne.options.decimal+ke[1]:"",ne.options.useGrouping){for(Jt="",ei=0,Rt=it.length;ei<Rt;++ei)ei!==0&&ei%3===0&&(Jt=ne.options.separator+Jt),Jt=it[Rt-ei-1]+Jt;it=Jt}return ne.options.numerals.length&&(it=it.replace(/[0-9]/g,function(Nt){return ne.options.numerals[+Nt]}),qe=qe.replace(/[0-9]/g,function(Nt){return ne.options.numerals[+Nt]})),(Et?"-":"")+ne.options.prefix+it+qe+ne.options.suffix}function ye(He,ke,it,qe){return it*(-Math.pow(2,-10*He/qe)+1)*1024/1023+ke}function me(He){return typeof He=="number"&&!isNaN(He)}var ne=this;if(ne.version=function(){return"1.9.3"},ne.options={useEasing:!0,useGrouping:!0,separator:",",decimal:".",easingFn:ye,formattingFn:xe,prefix:"",suffix:"",numerals:[]},re&&typeof re=="object")for(var Te in ne.options)re.hasOwnProperty(Te)&&re[Te]!==null&&(ne.options[Te]=re[Te]);ne.options.separator===""?ne.options.useGrouping=!1:ne.options.separator=""+ne.options.separator;for(var Xt=0,_t=["webkit","moz","ms","o"],At=0;At<_t.length&&!window.requestAnimationFrame;++At)window.requestAnimationFrame=window[_t[At]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[_t[At]+"CancelAnimationFrame"]||window[_t[At]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(He,ke){var it=new Date().getTime(),qe=Math.max(0,16-(it-Xt)),Jt=window.setTimeout(function(){He(it+qe)},qe);return Xt=it+qe,Jt}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(He){clearTimeout(He)}),ne.initialize=function(){return!!ne.initialized||(ne.error="",ne.d=typeof M=="string"?document.getElementById(M):M,ne.d?(ne.startVal=Number(N),ne.endVal=Number(X),me(ne.startVal)&&me(ne.endVal)?(ne.decimals=Math.max(0,U||0),ne.dec=Math.pow(10,ne.decimals),ne.duration=1e3*Number(H)||2e3,ne.countDown=ne.startVal>ne.endVal,ne.frameVal=ne.startVal,ne.initialized=!0,!0):(ne.error="[CountUp] startVal ("+N+") or endVal ("+X+") is not a number",!1)):(ne.error="[CountUp] target is null or undefined",!1))},ne.printValue=function(He){var ke=ne.options.formattingFn(He);ne.d.tagName==="INPUT"?this.d.value=ke:ne.d.tagName==="text"||ne.d.tagName==="tspan"?this.d.textContent=ke:this.d.innerHTML=ke},ne.count=function(He){ne.startTime||(ne.startTime=He),ne.timestamp=He;var ke=He-ne.startTime;ne.remaining=ne.duration-ke,ne.options.useEasing?ne.countDown?ne.frameVal=ne.startVal-ne.options.easingFn(ke,0,ne.startVal-ne.endVal,ne.duration):ne.frameVal=ne.options.easingFn(ke,ne.startVal,ne.endVal-ne.startVal,ne.duration):ne.countDown?ne.frameVal=ne.startVal-(ne.startVal-ne.endVal)*(ke/ne.duration):ne.frameVal=ne.startVal+(ne.endVal-ne.startVal)*(ke/ne.duration),ne.countDown?ne.frameVal=ne.frameVal<ne.endVal?ne.endVal:ne.frameVal:ne.frameVal=ne.frameVal>ne.endVal?ne.endVal:ne.frameVal,ne.frameVal=Math.round(ne.frameVal*ne.dec)/ne.dec,ne.printValue(ne.frameVal),ke<ne.duration?ne.rAF=requestAnimationFrame(ne.count):ne.callback&&ne.callback()},ne.start=function(He){ne.initialize()&&(ne.callback=He,ne.rAF=requestAnimationFrame(ne.count))},ne.pauseResume=function(){ne.paused?(ne.paused=!1,delete ne.startTime,ne.duration=ne.remaining,ne.startVal=ne.frameVal,requestAnimationFrame(ne.count)):(ne.paused=!0,cancelAnimationFrame(ne.rAF))},ne.reset=function(){ne.paused=!1,delete ne.startTime,ne.initialized=!1,ne.initialize()&&(cancelAnimationFrame(ne.rAF),ne.printValue(ne.startVal))},ne.update=function(He){if(ne.initialize()){if(He=Number(He),!me(He))return void(ne.error="[CountUp] update() - new endVal is not a number: "+He);ne.error="",He!==ne.frameVal&&(cancelAnimationFrame(ne.rAF),ne.paused=!1,delete ne.startTime,ne.startVal=ne.frameVal,ne.endVal=He,ne.countDown=ne.startVal>ne.endVal,ne.rAF=requestAnimationFrame(ne.count))}},ne.initialize()&&ne.printValue(ne.startVal)};return v})})(LE,LE.exports);var Pre=LE.exports;const Ire={name:"CountUp",props:{start:{type:Number,required:!1,default:0},end:{type:Number,required:!0},decimals:{type:Number,required:!1,default:0},duration:{type:Number,required:!1,default:2},options:{type:Object,required:!1,default(){return{}}},callback:{type:Function,required:!1,default:()=>{}}},data(){return{CountUp:null}},watch:{end(c){this.CountUp&&this.CountUp.update&&this.CountUp.update(c)}},mounted(){this.init()},methods:{init(){this.CountUp||(this.CountUp=new Pre(this.$el,this.start,this.end,this.decimals,this.duration,this.options),this.CountUp.start(()=>{this.callback(this.CountUp)}))},destroy(){this.CountUp=null}},beforeUnmounted(){this.destroy()},start(c){this.CountUp&&this.CountUp.start&&this.CountUp.start(()=>{c&&c(this.CountUp)})},pauseResume(){this.CountUp&&this.CountUp.pauseResume&&this.CountUp.pauseResume()},reset(){this.CountUp&&this.CountUp.reset&&this.CountUp.reset()},update(c){this.CountUp&&this.CountUp.update&&this.CountUp.update(c)}},Bre={class:"ivu-count-up"};function Rre(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("span",Bre)}var fV=l(Ire,[["render",Rre]]),Ol={},pV=/d{1,4}|M{1,4}|yy(?:yy)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,Rf=/\d\d?/,Dre=/\d{3}/,Lre=/\d{4}/,uw=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,mV=function(){};function gV(c,u){for(var m=[],S=0,b=c.length;S<b;S++)m.push(c[S].substr(0,u));return m}function yV(c){return function(u,m,S){var b=S[c].indexOf(m.charAt(0).toUpperCase()+m.substr(1).toLowerCase());~b&&(u.month=b)}}function mc(c,u){for(c=String(c),u=u||2;c.length<u;)c="0"+c;return c}var vV=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],xV=["January","February","March","April","May","June","July","August","September","October","November","December"],Nre=gV(xV,3),Vre=gV(vV,3);Ol.i18n={dayNamesShort:Vre,dayNames:vV,monthNamesShort:Nre,monthNames:xV,amPm:["am","pm"],DoFn:function(c){return c+["th","st","nd","rd"][c%10>3?0:(c-c%10!==10)*c%10]}};var _V={D:function(c){return c.getDay()},DD:function(c){return mc(c.getDay())},Do:function(c,u){return u.DoFn(c.getDate())},d:function(c){return c.getDate()},dd:function(c){return mc(c.getDate())},ddd:function(c,u){return u.dayNamesShort[c.getDay()]},dddd:function(c,u){return u.dayNames[c.getDay()]},M:function(c){return c.getMonth()+1},MM:function(c){return mc(c.getMonth()+1)},MMM:function(c,u){return u.monthNamesShort[c.getMonth()]},MMMM:function(c,u){return u.monthNames[c.getMonth()]},yy:function(c){return String(c.getFullYear()).substr(2)},yyyy:function(c){return c.getFullYear()},h:function(c){return c.getHours()%12||12},hh:function(c){return mc(c.getHours()%12||12)},H:function(c){return c.getHours()},HH:function(c){return mc(c.getHours())},m:function(c){return c.getMinutes()},mm:function(c){return mc(c.getMinutes())},s:function(c){return c.getSeconds()},ss:function(c){return mc(c.getSeconds())},S:function(c){return Math.round(c.getMilliseconds()/100)},SS:function(c){return mc(Math.round(c.getMilliseconds()/10),2)},SSS:function(c){return mc(c.getMilliseconds(),3)},a:function(c,u){return c.getHours()<12?u.amPm[0]:u.amPm[1]},A:function(c,u){return c.getHours()<12?u.amPm[0].toUpperCase():u.amPm[1].toUpperCase()},ZZ:function(c){var u=c.getTimezoneOffset();return(u>0?"-":"+")+mc(Math.floor(Math.abs(u)/60)*100+Math.abs(u)%60,4)}},_s={d:[Rf,function(c,u){c.day=u}],M:[Rf,function(c,u){c.month=u-1}],yy:[Rf,function(c,u){var m=new Date,S=+(""+m.getFullYear()).substr(0,2);c.year=""+(u>68?S-1:S)+u}],h:[Rf,function(c,u){c.hour=u}],m:[Rf,function(c,u){c.minute=u}],s:[Rf,function(c,u){c.second=u}],yyyy:[Lre,function(c,u){c.year=u}],S:[/\d/,function(c,u){c.millisecond=u*100}],SS:[/\d{2}/,function(c,u){c.millisecond=u*10}],SSS:[Dre,function(c,u){c.millisecond=u}],D:[Rf,mV],ddd:[uw,mV],MMM:[uw,yV("monthNamesShort")],MMMM:[uw,yV("monthNames")],a:[uw,function(c,u,m){var S=u.toLowerCase();S===m.amPm[0]?c.isPm=!1:S===m.amPm[1]&&(c.isPm=!0)}],ZZ:[/[\+\-]\d\d:?\d\d/,function(c,u){var m=(u+"").match(/([\+\-]|\d\d)/gi),S;m&&(S=+(m[1]*60)+parseInt(m[2],10),c.timezoneOffset=m[0]==="+"?S:-S)}]};_s.DD=_s.DD,_s.dddd=_s.ddd,_s.Do=_s.dd=_s.d,_s.mm=_s.m,_s.hh=_s.H=_s.HH=_s.h,_s.MM=_s.M,_s.ss=_s.s,_s.A=_s.a,Ol.masks={default:"ddd MMM dd yyyy HH:mm:ss",shortDate:"M/D/yy",mediumDate:"MMM d, yyyy",longDate:"MMMM d, yyyy",fullDate:"dddd, MMMM d, yyyy",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},Ol.format=function(c,u,m){var S=m||Ol.i18n;if(typeof c=="number"&&(c=new Date(c)),Object.prototype.toString.call(c)!=="[object Date]"||isNaN(c.getTime()))throw new Error("Invalid Date in fecha.format");return u=Ol.masks[u]||u||Ol.masks.default,u.replace(pV,function(b){return b in _V?_V[b](c,S):b.slice(1,b.length-1)})},Ol.parse=function(c,u,m){var S=m||Ol.i18n;if(typeof u!="string")throw new Error("Invalid format in fecha.parse");if(u=Ol.masks[u]||u,c.length>1e3)return!1;var b=!0,v={};if(u.replace(pV,function(X){if(_s[X]){var U=_s[X],H=c.search(U[0]);~H?c.replace(U[0],function(re){return U[1](v,re,S),c=c.substr(H+re.length),re}):b=!1}return _s[X]?"":X.slice(1,X.length-1)}),!b)return!1;var M=new Date;v.isPm===!0&&v.hour!=null&&+v.hour!=12?v.hour=+v.hour+12:v.isPm===!1&&+v.hour==12&&(v.hour=0);var N;return v.timezoneOffset!=null?(v.minute=+(v.minute||0)-+v.timezoneOffset,N=new Date(Date.UTC(v.year||M.getFullYear(),v.month||0,v.day||1,v.hour||0,v.minute||0,v.second||0,v.millisecond||0))):N=new Date(v.year||M.getFullYear(),v.month||0,v.day||1,v.hour||0,v.minute||0,v.second||0,v.millisecond||0),N};const NE=function(c){let u=new Date(c);return isNaN(u.getTime())&&typeof c=="string"&&(u=c.split("-").map(Number),u[1]+=1,u=new Date(...u)),isNaN(u.getTime())?null:u},ho=function(c){const u=new Date(c);return u.setHours(0,0,0,0),u.getTime()},$re=(c,u,m)=>{if(!u||!m)return!1;const[S,b]=[u,m].sort();return c>=S&&c<=b},ov=function(c,u){return c=NE(c),c?Ol.format(c,u||"yyyy-MM-dd"):""},dw=function(c,u){return Ol.parse(c,u||"yyyy-MM-dd")},bV=function(c,u){return new Date(c,u+1,0).getDate()},wV=function(c,u){const m=new Date(c),S=m.getMonth()+u,b=bV(m.getFullYear(),S);return b<m.getDate()&&m.setDate(b),m.setMonth(S),m},gc=function(){const c=new Date;return c.setHours(0),c.setMinutes(0),c.setSeconds(0),c},VE=function(){const c={yyyy:m=>m.getFullYear(),m:m=>m.getMonth()+1,mm:m=>("0"+(m.getMonth()+1)).slice(-2),mmm:(m,S)=>m.toLocaleDateString(S,{month:"long"}).slice(0,3),Mmm:(m,S)=>{const b=m.toLocaleDateString(S,{month:"long"});return(b[0].toUpperCase()+b.slice(1).toLowerCase()).slice(0,3)},mmmm:(m,S)=>m.toLocaleDateString(S,{month:"long"}),Mmmm:(m,S)=>{const b=m.toLocaleDateString(S,{month:"long"});return b[0].toUpperCase()+b.slice(1).toLowerCase()}},u=new RegExp(["yyyy","Mmmm","mmmm","Mmm","mmm","mm","m"].join("|"),"g");return function(m,S,b){const v=/(\[[^\]]+\])([^\[\]]+)(\[[^\]]+\])/,M=S.match(v).slice(1),N=M[1],X=[M[0],M[2]].map(U=>({label:U.replace(/\[[^\]]+\]/,H=>H.slice(1,-1).replace(u,re=>c[re](b,m))),type:U.indexOf("yy")!=-1?"year":"month"}));return{separator:N,labels:X}}}(),OV={date:"yyyy-MM-dd",month:"yyyy-MM",year:"yyyy",datetime:"yyyy-MM-dd HH:mm:ss",time:"HH:mm:ss",timerange:"HH:mm:ss",daterange:"yyyy-MM-dd",datetimerange:"yyyy-MM-dd HH:mm:ss"},av=function(c,u){return ov(c,u)},lv=function(c,u){return dw(c,u)},$E=function(c,u,m){if(Array.isArray(c)&&c.length===2){const S=c[0],b=c[1];if(S&&b)return ov(S,u)+m+ov(b,u)}else if(!Array.isArray(c)&&c instanceof Date)return ov(c,u);return""},UE=function(c,u,m){const S=Array.isArray(c)?c:c.split(m);if(S.length===2){const b=S[0],v=S[1];return[b instanceof Date?b:dw(b,u),v instanceof Date?v:dw(v,u)]}return[]},Qm={default:{formatter(c){return c?""+c:""},parser(c){return c===void 0||c===""?null:c}},date:{formatter:av,parser:lv},datetime:{formatter:av,parser:lv},daterange:{formatter:$E,parser:UE},datetimerange:{formatter:$E,parser:UE},timerange:{formatter:$E,parser:UE},time:{formatter:av,parser:lv},month:{formatter:av,parser:lv},year:{formatter:av,parser:lv},multiple:{formatter:(c,u)=>c.filter(Boolean).map(m=>ov(m,u)).join(","),parser:(c,u)=>(typeof c=="string"?c.split(","):c).map(m=>m instanceof Date?m:(typeof m=="string"?m=m.trim():typeof m!="number"&&!m&&(m=""),dw(m,u)))},number:{formatter(c){return c?""+c:""},parser(c){let u=Number(c);return isNaN(c)?null:u}}},fw="ivu-date-picker",Ure="ivu-picker",Fre=c=>c.reduce((u,m)=>u&&!m||typeof m=="string"&&m.trim()==="",!0),zre={40:"up",39:"right",38:"down",37:"left"},Ym=(c,u,m)=>{if(c==="left")return u*-1;if(c==="right")return u*1;if(c==="up")return m*1;if(c==="down")return m*-1},Xre=c=>{const u="ivu-date-picker-btn-pulse";c.classList.add(u),setTimeout(()=>c.classList.remove(u),200)},FE=c=>c?[c.getHours(),c.getMinutes(),c.getSeconds()]:[0,0,0],Wre={mixins:[Li,xl],components:{iInput:Xa,Drop:Ke,Icon:O},directives:{clickOutside:Di},emits:["on-clickoutside","on-clear","on-change","on-ok","on-open-change","update:modelValue"],provide(){return{PickerInstance:this}},props:{format:{type:String},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},confirm:{type:Boolean,default:!1},open:{type:Boolean,default:null},multiple:{type:Boolean,default:!1},timePickerOptions:{type:Object,default:()=>({})},splitPanels:{type:Boolean,default:!1},showWeekNumbers:{type:Boolean,default:!1},startDate:{type:Date},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},placeholder:{type:String,default:""},placement:{validator(c){return T(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom-start"},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},steps:{type:Array,default:()=>[]},modelValue:{type:[Date,String,Array]},options:{type:Object,default:()=>({})},separator:{type:String,default:" - "},capture:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!0}},transferClassName:{type:String},eventsEnabled:{type:Boolean,default:!1}},data(){const c=this.type.includes("range"),u=c?[null,null]:[null],m=Fre((c?this.modelValue:[this.modelValue])||[])?u:this.parseDate(this.modelValue),S=m.map(FE);return{prefixCls:fw,showClose:!1,visible:!1,internalValue:m,disableClickOutSide:!1,disableCloseUnderTransfer:!1,selectionMode:this.onSelectionModeChange(this.type),forceInputRerender:1,isFocused:!1,focusedDate:m[0]||this.startDate||new Date,focusedTime:{column:0,picker:0,time:S,active:!1},internalFocus:!1,isValueNull:!1,timeSpinnerList:[],panelTableList:[]}},computed:{wrapperClasses(){return[fw,{[fw+"-focused"]:this.isFocused}]},publicVModelValue(){if(this.multiple)return this.internalValue.slice();{const c=this.type.includes("range");let u=this.internalValue.map(m=>m instanceof Date?new Date(m):m||"");return this.type.match(/^time/)&&(u=u.map(this.formatDate)),c||this.multiple?u:u[0]}},publicStringValue(){const{formatDate:c,publicVModelValue:u,type:m}=this;return m.match(/^time/)?u:this.multiple?c(u):Array.isArray(u)?u.map(c):c(u)},opened(){return this.open===null?this.visible:this.open},transition(){return this.placement.match(/^bottom/)?"slide-up":"slide-down"},visualValue(){return this.formatDate(this.internalValue)},isConfirm(){return this.confirm||this.type==="datetime"||this.type==="datetimerange"||this.multiple},arrowType(){const c=this.globalConfig;let u="";if(this.type==="time"||this.type==="timerange")u="ios-time-outline",c&&(c.timePicker.customIcon?u="":c.timePicker.icon&&(u=c.timePicker.icon));else{const m=this.globalConfig;u="ios-calendar-outline",m&&(m.datePicker.customIcon?u="":m.datePicker.icon&&(u=m.datePicker.icon))}return this.showClose&&(u="ios-close-circle"),u},customArrowType(){const c=this.globalConfig;let u="";return this.showClose||(this.type==="time"||this.type==="timerange"?c&&c.timePicker.customIcon&&(u=c.timePicker.customIcon):c&&c.datePicker.customIcon&&(u=c.datePicker.customIcon)),u},arrowSize(){const c=this.globalConfig;let u="";return this.showClose||(this.type==="time"||this.type==="timerange"?c&&c.timePicker.iconSize&&(u=c.timePicker.iconSize):c&&c.datePicker.iconSize&&(u=c.datePicker.iconSize)),u},dropdownCls(){return{[fw+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}}},methods:{onSelectionModeChange(c){return c.match(/^date/)&&(c="date"),this.selectionMode=T(c,["year","month","date","time"])&&c,this.selectionMode},handleTransferClick(){this.transfer&&(this.disableCloseUnderTransfer=!0)},handleClose(c){if(this.disableCloseUnderTransfer)return this.disableCloseUnderTransfer=!1,!1;if(c&&c.type==="mousedown"&&this.visible){c.preventDefault(),c.stopPropagation();return}if(this.visible){const u=this.$refs.pickerPanel&&this.$refs.pickerPanel.$el;if(c&&u&&u.contains(c.target))return;this.visible=!1,c&&c.preventDefault(),c&&c.stopPropagation(),this.$emit("on-clickoutside",c);return}this.isFocused=!1,this.disableClickOutSide=!1},handleFocus(c){this.readonly||(this.isFocused=!0,!(c&&c.type==="focus")&&(this.itemDisabled||(this.visible=!0)))},handleBlur(c){if(this.internalFocus){this.internalFocus=!1;return}if(this.visible){c.preventDefault();return}this.isFocused=!1,this.onSelectionModeChange(this.type),this.internalValue=this.internalValue.slice(),this.reset(),this.$refs.pickerPanel.onToggleVisibility(!1)},handleKeydown(c){const u=c.keyCode;if(u===9)if(this.visible)if(c.stopPropagation(),c.preventDefault(),this.isConfirm){const S=`.${Ure}-confirm > *`,b=this.$refs.drop.$el.querySelectorAll(S);this.internalFocus=!0,[...b][c.shiftKey?"pop":"shift"]().focus()}else this.handleClose();else this.focused=!1;const m=[37,38,39,40];if(!this.visible&&m.includes(u)){this.visible=!0;return}if(u===27&&this.visible&&(c.stopPropagation(),this.handleClose()),u===13){const S=this.timeSpinnerList.map(b=>b.timeSpinner);if(S.length>0){const b=S[0].showSeconds?3:2,v=Math.floor(this.focusedTime.column/b),M=this.focusedTime.time[v];S[v].chooseValue(M);return}if(this.type.match(/range/))this.$refs.pickerPanel.handleRangePick(this.focusedDate,"date");else{const b=this.panelTableList.map(M=>M.panelTable),v=M=>{const N=["year","month","date"].indexOf(this.type)+1;return[M.getFullYear(),M.getMonth(),M.getDate()].slice(0,N).join("-")};b.find(({cells:M})=>M.find(({date:N,disabled:X})=>v(N)===v(this.focusedDate)&&!X))&&this.onPick(this.focusedDate,!1,"date")}}!m.includes(u)||(this.focusedTime.active&&c.preventDefault(),this.navigateDatePanel(zre[u],c.shiftKey))},reset(){this.$refs.pickerPanel.reset&&this.$refs.pickerPanel.reset()},navigateTimePanel(c){this.focusedTime.active=!0;const u=c.match(/left|right/),m=c.match(/up|down/),S=this.timeSpinnerList.map(U=>U.timeSpinner),b=(S[0].showSeconds?3:2)*S.length,v=(U=>(U+(u?c==="left"?-1:1:0)+b)%b)(this.focusedTime.column),M=b/S.length,N=Math.floor(v/M),X=v%M;if(u){const U=this.internalValue.map(FE);this.focusedTime={...this.focusedTime,column:v,time:U},S.forEach((H,re)=>{re===N?H.updateFocusedTime(X,U[N]):H.updateFocusedTime(-1,H.focusedTime)})}if(m){const U=c==="up"?1:-1,H=["hours","minutes","seconds"],re=S[N][`${H[X]}List`],xe=(re.findIndex(({text:ne})=>this.focusedTime.time[N][X]===ne)+U+re.length)%re.length,ye=re[xe].text,me=this.focusedTime.time.map((ne,Te)=>(Te!==N||(ne[X]=ye),ne));this.focusedTime={...this.focusedTime,time:me},S.forEach((ne,Te)=>{Te===N?ne.updateFocusedTime(X,me[Te]):ne.updateFocusedTime(-1,ne.focusedTime)})}},navigateDatePanel(c,u){const m=this.timeSpinnerList.map(v=>v.timeSpinner);if(m.length>0){this.navigateTimePanel(c,u,m);return}if(u){this.type==="year"?this.focusedDate=new Date(this.focusedDate.getFullYear()+Ym(c,0,10),this.focusedDate.getMonth(),this.focusedDate.getDate()):this.focusedDate=new Date(this.focusedDate.getFullYear()+Ym(c,0,1),this.focusedDate.getMonth()+Ym(c,1,0),this.focusedDate.getDate());const v=c.match(/left|down/)?"prev":"next",M=c.match(/up|down/)?"-double":"",N=this.$refs.drop.$el.querySelector(`.ivu-date-picker-${v}-btn-arrow${M}`);N&&Xre(N);return}const S=this.focusedDate||this.internalValue&&this.internalValue[0]||new Date,b=new Date(S);if(this.type.match(/^date/)){const v=bV(S.getFullYear(),S.getMonth()),M=S.getDate(),N=b.getDate()+Ym(c,1,7);N<1?c.match(/left|right/)?(b.setMonth(b.getMonth()+1),b.setDate(N)):b.setDate(M+Math.floor((v-M)/7)*7):N>v?c.match(/left|right/)?(b.setMonth(b.getMonth()-1),b.setDate(N)):b.setDate(M%7):b.setDate(N)}this.type.match(/^month/)&&b.setMonth(b.getMonth()+Ym(c,1,3)),this.type.match(/^year/)&&b.setFullYear(b.getFullYear()+Ym(c,1,3)),this.focusedDate=b},handleInputChange(c){const u=this.type.includes("range")||this.multiple,m=this.visualValue,S=c.target.value,b=this.parseDate(S),v=this.options&&typeof this.options.disabledDate=="function"&&this.options.disabledDate,M=u?b:b[0],N=v&&v(M),X=b.reduce((U,H)=>U&&H instanceof Date,!0);S!==m&&!N&&X?(this.emitChange(this.type),this.internalValue=b):this.forceInputRerender++},handleInputMouseenter(){this.readonly||this.itemDisabled||this.visualValue&&this.clearable&&(this.showClose=!0)},handleInputMouseleave(){this.showClose=!1},handleIconClick(c){this.showClose?(c&&c.stopPropagation(),this.handleClear()):this.itemDisabled||this.handleFocus()},handleClear(){this.visible=!1,this.internalValue=this.internalValue.map(()=>null),this.$emit("on-clear"),this.handleFormItemChange("change",""),this.emitChange(this.type),this.reset(),setTimeout(()=>this.onSelectionModeChange(this.type),500)},emitChange(c){n.nextTick(()=>{this.$emit("on-change",this.publicStringValue,c),this.handleFormItemChange("change",this.publicStringValue)})},parseDate(c){const u=this.type.includes("range"),m=this.type,S=(Qm[m]||Qm.default).parser,b=this.format||OV[m],v=Qm.multiple.parser;if(c&&m==="time"&&!(c instanceof Date))c=S(c,b,this.separator);else if(this.multiple&&c)c=v(c,b,this.separator);else if(u)if(!c)c=[null,null];else if(typeof c=="string")c=S(c,b,this.separator);else if(m==="timerange")c=S(c,b,this.separator).map(M=>M||"");else{const[M,N]=c;M instanceof Date&&N instanceof Date?c=c.map(X=>new Date(X)):typeof M=="string"&&typeof N=="string"?c=S(c.join(this.separator),b,this.separator):(!M||!N)&&(c=[null,null])}else typeof c=="string"&&m.indexOf("time")!==0&&(c=S(c,b)||null);return u||this.multiple?c||[]:[c]},formatDate(c){const u=OV[this.type];if(this.multiple){const m=Qm.multiple.formatter;return m(c,this.format||u,this.separator)}else{const{formatter:m}=Qm[this.type]||Qm.default;return m(c,this.format||u,this.separator)}},onPick(c,u=!1,m){if(this.multiple){const S=c.getTime(),b=this.internalValue.findIndex(M=>M&&M.getTime()===S),v=[...this.internalValue,c].filter(Boolean).map(M=>M.getTime()).filter((M,N,X)=>X.indexOf(M)===N&&N!==b);this.internalValue=v.map(M=>new Date(M))}else c=this.parseDate(c),this.internalValue=Array.isArray(c)?c:[c];this.internalValue[0]&&(this.focusedDate=this.internalValue[0]),this.focusedTime={...this.focusedTime,time:this.internalValue.map(FE)},this.isConfirm||this.onSelectionModeChange(this.type),this.isConfirm||(this.visible=!!u),this.emitChange(m)},onPickSuccess(){this.visible=!1,this.$emit("on-ok"),this.focus(),this.reset()},focus(){this.$refs.input&&this.$refs.input.focus()},updatePopper(){this.$refs.drop.update()},handleOnFocusInput(){this.focus()},handleOnUpdatePopper(){this.updatePopper()}},watch:{visible(c){c===!1&&this.$refs.drop.destroy(),c&&this.$refs.drop.update(),this.$emit("on-open-change",c)},modelValue(c){c===null&&(this.isValueNull=!0),this.internalValue=this.parseDate(c)},open(c){this.visible=c===!0},type(c){this.onSelectionModeChange(c)},publicVModelValue(c,u){const m=JSON.stringify(c),S=JSON.stringify(u);(m!==S||typeof c!=typeof u)&&(this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",c))}},mounted(){this.open!==null&&(this.visible=this.open)}};function Hre(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("i-input"),X=n.resolveComponent("Drop"),U=n.resolveDirective("click-outside");return n.withDirectives((n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapperClasses)},[n.createElementVNode("div",{ref:"reference",class:n.normalizeClass([b.prefixCls+"-rel"])},[n.renderSlot(c.$slots,"default",{},()=>[(n.openBlock(),n.createBlock(N,{key:b.forceInputRerender,"element-id":m.elementId,class:n.normalizeClass([b.prefixCls+"-editor"]),readonly:!m.editable||m.readonly,disabled:c.itemDisabled,size:m.size,placeholder:m.placeholder,"model-value":v.visualValue,name:m.name,ref:"input",onOnInputChange:v.handleInputChange,onOnFocus:v.handleFocus,onOnBlur:v.handleBlur,onClick:v.handleFocus,onKeydown:v.handleKeydown,onMouseenter:v.handleInputMouseenter,onMouseleave:v.handleInputMouseleave},{suffix:n.withCtx(()=>[n.createVNode(M,{onClick:v.handleIconClick,type:v.arrowType,custom:v.customArrowType,size:v.arrowSize},null,8,["onClick","type","custom","size"])]),_:1},8,["element-id","class","readonly","disabled","size","placeholder","model-value","name","onOnInputChange","onOnFocus","onOnBlur","onClick","onKeydown","onMouseenter","onMouseleave"]))])],2),n.createVNode(X,{ref:"drop",visible:v.opened,classes:v.dropdownCls,placement:m.placement,eventsEnabled:m.eventsEnabled,transfer:m.transfer,"transition-name":"transition-drop",onClick:v.handleTransferClick},{default:n.withCtx(()=>[n.createElementVNode("div",null,[(n.openBlock(),n.createBlock(n.resolveDynamicComponent(c.panel),n.mergeProps({ref:"pickerPanel",visible:b.visible,showTime:c.type==="datetime"||c.type==="datetimerange",confirm:v.isConfirm,selectionMode:b.selectionMode,steps:m.steps,format:m.format,"model-value":b.internalValue,"start-date":m.startDate,"split-panels":m.splitPanels,"show-week-numbers":m.showWeekNumbers,"picker-type":c.type,multiple:m.multiple,"focused-date":b.focusedDate,"time-picker-options":m.timePickerOptions},c.ownPickerProps,{onOnPick:v.onPick,onOnPickClear:v.handleClear,onOnPickSuccess:v.onPickSuccess,onOnPickClick:u[0]||(u[0]=H=>b.disableClickOutSide=!0),onOnSelectionModeChange:v.onSelectionModeChange}),null,16,["visible","showTime","confirm","selectionMode","steps","format","model-value","start-date","split-panels","show-week-numbers","picker-type","multiple","focused-date","time-picker-options","onOnPick","onOnPickClear","onOnPickSuccess","onOnSelectionModeChange"]))])]),_:1},8,["visible","classes","placement","eventsEnabled","transfer","onClick"])],2)),[[U,v.handleClose,m.capture,{mousedown:!0}],[U,v.handleClose,m.capture,{touchstart:!0}],[U,v.handleClose,m.capture]])}var SV=l(Wre,[["render",Hre]]),CV=1e3*60*60*24;function TV(c,u){return new Date(c,u+1,0).getDate()}function AV(c,u,m){return u===0&&m>50?c-1:u===11&&m<10?c+1:c}function EV(c,u,m,S){u>11&&(u=0,c++);var b=new Date(c,u,m);S&&b.setDate(b.getDate()+4-(b.getDay()||7));var v=S?b.getFullYear():c,M=new Date(v,0,1),N=1+Math.round((b-M)/CV);S||(N+=M.getDay());var X=Math.ceil(N/7);if(!S){var U=new Date(c,u,m),H=new Date(c+1,0,1),re=H.getDay();U.getTime()>=H.getTime()-CV*re&&(X=1)}return X}function Gre(c,u,m){for(var S=this.lang||"en",b=this.onlyDays,v=typeof this.weekStart>"u"?1:this.weekStart,M=v===1,N=[],X=new Date(c,u,1),U=X.getDay()||(M?7:0),H=v-U,re=EV(c,u,1,M),xe=TV(c,u),ye=TV(c,u-1),me,ne,Te,Xt=AV(c,u,re),_t={month:u,year:c,daysInMonth:xe},At=0;At<7;At++){Te=H;for(var He=0;He<8;He++){At>0&&He>0&&H++,H>xe||H<1?(ne=H>xe?H-xe:ye+H,me=H>xe?u+1:u-1):(ne=H,me=u);var ke=function(){return He===0?"weekLabel":At===0?"dayLabel":H<1?"prevMonth":H>xe?"nextMonth":"monthDay"}(),it=Te!==H&&At>0,qe={desc:it?ne:re,week:re,type:ke,format:M?"ISO 8601":"US",date:it?new Date(Date.UTC(c,me,ne)):!1,year:Xt,index:N.length};m&&(typeof m=="function"?qe=m.call(_t,qe,S):m.forEach(function(Jt){qe=Jt.call(_t,qe,S)})),b&&it?N.push(qe):b||N.push(qe)}At>0&&(re=EV(c,me,ne+1,M)),Xt=AV(c,u,re)}return _t.cells=N,_t}var Qre=function(c){return Gre.bind(c)},Yre={weekPlaceholder:"",columnNames:{en:{0:"w",1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday",7:"sunday"},sv:{0:"v",1:"mndag",2:"tisdag",3:"onsdag",4:"torsdag",5:"fredag",6:"lrdag",7:"sndag"},pt:{0:"s",1:"segunda",2:"tera",3:"quarta",4:"quinta",5:"sexta",6:"sbado",7:"domingo"}},monthNames:{en:["January","February","March","April","May","June","July","August","September","October","November","December"],sv:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],pt:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"]},classes:{dayLabel:"day-of-week",weekLabel:"week-number",prevMonth:"inactive",nextMonth:"inactive",monthDay:"day-in-month"}},yc=Yre;function jre(c){return c==null?!1:c.constructor===Array||c.constructor===Object}function MV(c,u){for(var m in c)u[m]?jre(c[m])&&MV(c[m],u[m]):u[m]=c[m]}function kV(c,u){var m=[yc.classes[c.type]];return c.class?c.class=(typeof c.class=="string"?[c.class]:c.class).concat(m):c.class=m,c.type.indexOf("Label")>0&&(c.index==0&&yc.weekPlaceholder?c.desc=yc.weekPlaceholder:c.index<8?c.desc=yc.columnNames[u][c.index]:c.index%8==0&&(c.desc=c.week)),c.date&&(c.monthName=yc.monthNames[u][c.date.getMonth()]),this.monthName||(this.monthName=yc.monthNames[u][this.month]),this.labels||(this.labels={monthNames:yc.monthNames[u],columnNames:yc.columnNames[u],classes:yc.classes}),c}kV.setLabels=function(c){MV(c,yc)};var qre=kV,Zre={Generator:Qre,addLabels:qre},zE={name:"PanelTable",emits:["on-pick","on-pick-click","on-change-range"],inject:["PickerInstance"],props:{tableDate:{type:Date,required:!0},disabledDate:{type:Function},selectionMode:{type:String,required:!0},modelValue:{type:Array,required:!0},rangeState:{type:Object,default:()=>({from:null,to:null,selecting:!1})},focusedDate:{type:Date,required:!0}},data(){return{id:te(6)}},computed:{dates(){const{selectionMode:c,modelValue:u,rangeState:m}=this;return c==="range"&&m.selecting?[m.from]:u}},methods:{handleClick(c,u){if(u.stopPropagation(),c.disabled||c.type==="weekLabel")return;const m=new Date(ho(c.date));this.$emit("on-pick",m),this.$emit("on-pick-click")},handleMouseMove(c){if(!this.rangeState.selecting||c.disabled)return;const u=c.date;this.$emit("on-change-range",u)},addPanelTable(){const c=this.PickerInstance;c.panelTableList||(c.panelTableList=[]),c.panelTableList.push({id:this.id,panelTable:this})},removePanelTable(){const c=this.PickerInstance;if(c.panelTableList&&c.panelTableList.length){const u=c.panelTableList.findIndex(m=>m.id===this.id);c.panelTableList.splice(u,1)}}},mounted(){this.addPanelTable()},beforeUnmount(){this.removePanelTable()}},Qn="ivu-date-picker-cells";const Kre={mixins:[Sn,zE],props:{showWeekNumbers:{type:Boolean,default:!1}},computed:{classes(){return[`${Qn}`,{[`${Qn}-show-week-numbers`]:this.showWeekNumbers}]},calendar(){const c=Number(this.t("i.datepicker.weekStartDay"));return new Zre.Generator({onlyDays:!this.showWeekNumbers,weekStart:c})},headerDays(){const c=Number(this.t("i.datepicker.weekStartDay")),u=["sun","mon","tue","wed","thu","fri","sat"].map(S=>this.t("i.datepicker.weeks."+S)),m=u.splice(c,7-c).concat(u.splice(0,c));return this.showWeekNumbers?[""].concat(m):m},cells(){const c=this.tableDate.getFullYear(),u=this.tableDate.getMonth(),m=ho(new Date),S=this.dates.filter(Boolean).map(ho),[b,v]=this.dates.map(ho),M=this.rangeState.from&&ho(this.rangeState.from),N=this.rangeState.to&&ho(this.rangeState.to),X=this.selectionMode==="range",U=typeof this.disabledDate=="function"&&this.disabledDate;return this.calendar(c,u,H=>{H.date instanceof Date&&H.date.setTime(H.date.getTime()+H.date.getTimezoneOffset()*6e4+480*60*1e3);const re=H.date&&ho(H.date),xe=H.date&&u===H.date.getMonth();return{...H,type:re===m?"today":H.type,selected:xe&&S.includes(re),disabled:H.date&&U&&U(new Date(re)),range:xe&&X&&$re(re,M,N),start:xe&&X&&re===b,end:xe&&X&&re===v}}).cells.slice(this.showWeekNumbers?8:0)}},methods:{getCellCls(c){return[`${Qn}-cell`,{[`${Qn}-cell-selected`]:c.selected||c.start||c.end,[`${Qn}-cell-disabled`]:c.disabled,[`${Qn}-cell-today`]:c.type==="today",[`${Qn}-cell-prev-month`]:c.type==="prevMonth",[`${Qn}-cell-next-month`]:c.type==="nextMonth",[`${Qn}-cell-week-label`]:c.type==="weekLabel",[`${Qn}-cell-range`]:c.range&&!c.start&&!c.end,[`${Qn}-focused`]:ho(c.date)===ho(this.focusedDate)}]}}},Jre={class:"ivu-date-picker-cells-header"},eoe=["onClick","onMouseenter"];function toe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.createElementVNode("div",Jre,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.headerDays,M=>(n.openBlock(),n.createElementBlock("span",{key:M},n.toDisplayString(M),1))),128))]),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.cells,(M,N)=>(n.openBlock(),n.createElementBlock("span",{key:String(M.date)+N,class:n.normalizeClass(v.getCellCls(M)),onClick:X=>c.handleClick(M,X),onMouseenter:X=>c.handleMouseMove(M)},[n.createElementVNode("em",null,n.toDisplayString(M.desc),1)],42,eoe))),128))],2)}var PV=l(Kre,[["render",toe]]);const ioe={mixins:[zE],props:{},computed:{classes(){return[`${Qn}`,`${Qn}-year`]},startYear(){return Math.floor(this.tableDate.getFullYear()/10)*10},cells(){let c=[];const u={text:"",selected:!1,disabled:!1},m=this.dates.filter(Boolean).map(b=>ho(new Date(b.getFullYear(),0,1))),S=ho(new Date(this.focusedDate.getFullYear(),0,1));for(let b=0;b<10;b++){const v=L(u);v.date=new Date(this.startYear+b,0,1),v.disabled=typeof this.disabledDate=="function"&&this.disabledDate(v.date)&&this.selectionMode==="year";const M=ho(v.date);v.selected=m.includes(M),v.focused=M===S,c.push(v)}return c}},methods:{getCellCls(c){return[`${Qn}-cell`,{[`${Qn}-cell-selected`]:c.selected,[`${Qn}-cell-disabled`]:c.disabled,[`${Qn}-cell-focused`]:c.focused,[`${Qn}-cell-range`]:c.range&&!c.start&&!c.end}]}}},noe=["onClick","onMouseenter"];function soe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.cells,M=>(n.openBlock(),n.createElementBlock("span",{class:n.normalizeClass(v.getCellCls(M)),key:M.date,onClick:N=>c.handleClick(M,N),onMouseenter:N=>c.handleMouseMove(M)},[n.createElementVNode("em",null,n.toDisplayString(M.date.getFullYear()),1)],42,noe))),128))],2)}var IV=l(ioe,[["render",soe]]);const roe={mixins:[Sn,zE],props:{},computed:{classes(){return[`${Qn}`,`${Qn}-month`]},cells(){let c=[];const u={text:"",selected:!1,disabled:!1},m=this.tableDate.getFullYear(),S=this.dates.filter(Boolean).map(v=>ho(new Date(v.getFullYear(),v.getMonth(),1))),b=ho(new Date(this.focusedDate.getFullYear(),this.focusedDate.getMonth(),1));for(let v=0;v<12;v++){const M=L(u);M.date=new Date(m,v,1),M.text=this.tCell(v+1);const N=ho(M.date);M.disabled=typeof this.disabledDate=="function"&&this.disabledDate(M.date)&&this.selectionMode==="month",M.selected=S.includes(N),M.focused=N===b,c.push(M)}return c}},methods:{getCellCls(c){return[`${Qn}-cell`,{[`${Qn}-cell-selected`]:c.selected,[`${Qn}-cell-disabled`]:c.disabled,[`${Qn}-cell-focused`]:c.focused,[`${Qn}-cell-range`]:c.range&&!c.start&&!c.end}]},tCell(c){return this.t(`i.datepicker.months.m${c}`)}}},ooe=["onClick","onMouseenter"];function aoe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.cells,M=>(n.openBlock(),n.createElementBlock("span",{class:n.normalizeClass(v.getCellCls(M)),key:M.text,onClick:N=>c.handleClick(M,N),onMouseenter:N=>c.handleMouseMove(M)},[n.createElementVNode("em",null,n.toDisplayString(M.text),1)],42,ooe))),128))],2)}var BV=l(roe,[["render",aoe]]),pw={props:{disabledHours:{type:Array,default(){return[]}},disabledMinutes:{type:Array,default(){return[]}},disabledSeconds:{type:Array,default(){return[]}},hideDisabledOptions:{type:Boolean,default:!1}}};const Df="ivu-time-picker-cells",XE=["hours","minutes","seconds"],loe={name:"TimeSpinner",mixins:[pw],emits:["on-change","on-pick-click"],inject:["PickerInstance"],props:{hours:{type:[Number,String],default:NaN},minutes:{type:[Number,String],default:NaN},seconds:{type:[Number,String],default:NaN},showSeconds:{type:Boolean,default:!0},steps:{type:Array,default:()=>[]}},data(){return{spinerSteps:[1,1,1].map((c,u)=>Math.abs(this.steps[u])||c),prefixCls:Df,compiled:!1,focusedColumn:-1,focusedTime:[0,0,0],id:te(6)}},computed:{classes(){return[`${Df}`,{[`${Df}-with-seconds`]:this.showSeconds}]},hoursList(){let c=[];const u=this.spinerSteps[0],m=this.focusedColumn===0&&this.focusedTime[0],S={text:0,selected:!1,disabled:!1,hide:!1};for(let b=0;b<24;b+=u){const v=L(S);v.text=b,v.focused=b===m,this.disabledHours.length&&this.disabledHours.indexOf(b)>-1&&(v.disabled=!0,this.hideDisabledOptions&&(v.hide=!0)),this.hours===b&&(v.selected=!0),c.push(v)}return c},minutesList(){let c=[];const u=this.spinerSteps[1],m=this.focusedColumn===1&&this.focusedTime[1],S={text:0,selected:!1,disabled:!1,hide:!1};for(let b=0;b<60;b+=u){const v=L(S);v.text=b,v.focused=b===m,this.disabledMinutes.length&&this.disabledMinutes.indexOf(b)>-1&&(v.disabled=!0,this.hideDisabledOptions&&(v.hide=!0)),this.minutes===b&&(v.selected=!0),c.push(v)}return c},secondsList(){let c=[];const u=this.spinerSteps[2],m=this.focusedColumn===2&&this.focusedTime[2],S={text:0,selected:!1,disabled:!1,hide:!1};for(let b=0;b<60;b+=u){const v=L(S);v.text=b,v.focused=b===m,this.disabledSeconds.length&&this.disabledSeconds.indexOf(b)>-1&&(v.disabled=!0,this.hideDisabledOptions&&(v.hide=!0)),this.seconds===b&&(v.selected=!0),c.push(v)}return c}},methods:{getCellCls(c){return[`${Df}-cell`,{[`${Df}-cell-selected`]:c.selected,[`${Df}-cell-focused`]:c.focused,[`${Df}-cell-disabled`]:c.disabled}]},chooseValue(c){const u=XE.reduce((m,S,b)=>{const v=c[b];return this[S]===v?m:{...m,[S]:v}},{});Object.keys(u).length>0&&this.emitChange(u)},handleClick(c,u){if(u.disabled)return;const m={[c]:u.text};this.emitChange(m)},emitChange(c){this.$emit("on-change",c),this.$emit("on-pick-click")},scroll(c,u){const m=this.$refs[c].scrollTop,S=24*this.getScrollIndex(c,u);V(this.$refs[c],m,S,500)},getScrollIndex(c,u){const m=E(c),S=this[`disabled${m}`];if(S.length&&this.hideDisabledOptions){let b=0;S.forEach(v=>v<=u?b++:""),u-=b}return u},updateScroll(){n.nextTick(()=>{XE.forEach(c=>{this.$refs[c].scrollTop=24*this[`${c}List`].findIndex(u=>u.text==this[c])})})},formatTime(c){return c<10?"0"+c:c},updateFocusedTime(c,u){this.focusedColumn=c,this.focusedTime=u.slice()},addTimeSpinner(){const c=this.PickerInstance;c.timeSpinnerList||(c.timeSpinnerList=[]),c.timeSpinnerList.push({id:this.id,timeSpinner:this})},removeTimeSpinner(){const c=this.PickerInstance;if(c.timeSpinnerList&&c.timeSpinnerList.length){const u=c.timeSpinnerList.findIndex(m=>m.id===this.id);c.timeSpinnerList.splice(u,1)}}},watch:{hours(c){!this.compiled||this.scroll("hours",this.hoursList.findIndex(u=>u.text==c))},minutes(c){!this.compiled||this.scroll("minutes",this.minutesList.findIndex(u=>u.text==c))},seconds(c){!this.compiled||this.scroll("seconds",this.secondsList.findIndex(u=>u.text==c))},focusedTime(c,u){XE.forEach((m,S)=>{if(c[S]===u[S]||typeof c[S]>"u")return;const b=this[`${m}List`].findIndex(v=>v.text===c[S]);this.scroll(m,b)})}},mounted(){this.addTimeSpinner(),n.nextTick(()=>this.compiled=!0)},beforeUnmount(){this.removeTimeSpinner()}},coe=["onClick"],hoe=["onClick"],uoe=["onClick"];function doe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-list"]),ref:"hours"},[n.createElementVNode("ul",{class:n.normalizeClass([b.prefixCls+"-ul"])},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.hoursList,M=>n.withDirectives((n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(v.getCellCls(M)),key:M.text,onClick:N=>v.handleClick("hours",M)},n.toDisplayString(v.formatTime(M.text)),11,coe)),[[n.vShow,!M.hide]])),128))],2)],2),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-list"]),ref:"minutes"},[n.createElementVNode("ul",{class:n.normalizeClass([b.prefixCls+"-ul"])},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.minutesList,M=>n.withDirectives((n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(v.getCellCls(M)),key:M.text,onClick:N=>v.handleClick("minutes",M)},n.toDisplayString(v.formatTime(M.text)),11,hoe)),[[n.vShow,!M.hide]])),128))],2)],2),n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-list"]),ref:"seconds"},[n.createElementVNode("ul",{class:n.normalizeClass([b.prefixCls+"-ul"])},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.secondsList,M=>n.withDirectives((n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(v.getCellCls(M)),key:M.text,onClick:N=>v.handleClick("seconds",M)},n.toDisplayString(v.formatTime(M.text)),11,uoe)),[[n.vShow,!M.hide]])),128))],2)],2),[[n.vShow,m.showSeconds]])],2)}var RV=l(loe,[["render",doe]]);const DV="ivu-picker",foe={mixins:[Sn],components:{iButton:co},emits:["on-pick-clear","on-pick-success","on-pick-toggle-time"],inject:["PickerInstance"],props:{showTime:{type:Boolean,default:!1},isTime:{type:Boolean,default:!1},timeDisabled:{type:Boolean,default:!1}},data(){return{prefixCls:DV}},computed:{timeClasses(){return`${DV}-confirm-time`},labels(){const c=["time","clear","ok"],u=[this.isTime?"selectDate":"selectTime","clear","ok"];return c.reduce((m,S,b)=>(m[S]=this.t("i.datepicker."+u[b]),m),{})}},methods:{handleClear(){this.$emit("on-pick-clear")},handleSuccess(){this.$emit("on-pick-success")},handleToggleTime(){this.timeDisabled||(this.$emit("on-pick-toggle-time"),this.PickerInstance.handleOnFocusInput(),this.PickerInstance.handleOnUpdatePopper())},handleTab(c){const u=[...this.$el.children][c.shiftKey?"shift":"pop"]();r&&document.activeElement===u&&(c.preventDefault(),c.stopPropagation(),this.PickerInstance.handleOnFocusInput())}}};function poe(c,u,m,S,b,v){const M=n.resolveComponent("i-button");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([b.prefixCls+"-confirm"]),onKeydownCapture:u[0]||(u[0]=n.withKeys((...N)=>v.handleTab&&v.handleTab(...N),["tab"]))},[m.showTime?(n.openBlock(),n.createBlock(M,{key:0,class:n.normalizeClass(v.timeClasses),size:"small",type:"text",disabled:m.timeDisabled,onClick:v.handleToggleTime},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(v.labels.time),1)]),_:1},8,["class","disabled","onClick"])):n.createCommentVNode("",!0),n.createVNode(M,{size:"small",class:"ivu-picker-confirm-btn-cancel",onClick:v.handleClear,onKeydown:n.withKeys(v.handleClear,["enter"])},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(v.labels.clear),1)]),_:1},8,["onClick","onKeydown"]),n.createVNode(M,{size:"small",type:"primary",onClick:v.handleSuccess,onKeydown:n.withKeys(v.handleSuccess,["enter"])},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(v.labels.ok),1)]),_:1},8,["onClick","onKeydown"])],34)}var mw=l(foe,[["render",poe]]);const moe="ivu-picker-panel",LV="ivu-date-picker";var gw={emits:["on-pick-clear","on-pick-success","on-pick-click","on-pick"],props:{confirm:{type:Boolean,default:!1}},methods:{iconBtnCls(c,u=""){return[`${moe}-icon-btn`,`${LV}-${c}-btn`,`${LV}-${c}-btn-arrow${u}`]},handleShortcutClick(c){c.value&&this.$emit("on-pick",c.value()),c.onClick&&c.onClick(this)},handlePickClear(){this.resetView(),this.$emit("on-pick-clear")},handlePickSuccess(){this.resetView(),this.$emit("on-pick-success")},handlePickClick(){this.$emit("on-pick-click")},resetView(){setTimeout(()=>this.currentView=this.selectionMode,500)},handleClear(){this.dates=this.dates.map(()=>null),this.rangeState={},this.$emit("on-pick",this.dates),this.handleConfirm()},handleConfirm(c,u){this.$emit("on-pick",this.dates,c,u||this.type)},onToggleVisibility(c){const{timeSpinner:u,timeSpinnerEnd:m}=this.$refs;c&&u&&u.updateScroll(),c&&m&&m.updateScroll()}}};const goe="ivu-picker-panel",yoe="ivu-time-picker",voe=c=>c[0].toUpperCase()+c.slice(1),xoe=(c,u,m,S)=>{const b=new Date(c.getTime());return b.setHours(u),b.setMinutes(m),b.setSeconds(S),b},_oe=(c,u,m)=>m.indexOf(c)===u,NV=()=>!1,boe={name:"TimePickerPanel",mixins:[gw,Sn,pw],components:{TimeSpinner:RV,Confirm:mw},emits:["on-pick"],props:{disabledDate:{type:Function,default:NV},steps:{type:Array,default:()=>[]},format:{type:String,default:"HH:mm:ss"},modelValue:{type:Array,required:!0}},data(){return{prefixCls:goe,timePrefixCls:yoe,date:this.modelValue[0]||gc(),showDate:!1}},computed:{showSeconds(){return!!(this.format||"").match(/ss/)},visibleDate(){const c=this.date,u=c.getMonth()+1,m=this.t("i.datepicker.year"),S=this.t(`i.datepicker.month${u}`);return`${c.getFullYear()}${m} ${S}`},timeSlots(){return this.modelValue[0]?["getHours","getMinutes","getSeconds"].map(c=>this.date[c]()):[]},disabledHMS(){const c=["disabledHours","disabledMinutes","disabledSeconds"];if(this.disabledDate===NV||!this.modelValue[0])return c.reduce((u,m)=>(u[m]=this[m],u),{});{const u=[24,60,60],m=["Hours","Minutes","Seconds"].map(S=>this[`disabled${S}`]).map((S,b)=>{const v=u[b],M=S;for(let N=0;N<v;N+=this.steps[b]||1){const X=this.timeSlots.map((H,re)=>re===b?N:H),U=xoe(this.date,...X);this.disabledDate(U,!0)&&M.push(N)}return M.filter(_oe)});return c.reduce((S,b,v)=>(S[b]=m[v],S),{})}}},watch:{modelValue(c){let u=c[0]||gc();u=new Date(u),this.date=u}},methods:{handleChange(c,u=!0){const m=new Date(this.date);Object.keys(c).forEach(S=>m[`set${voe(S)}`](c[S])),u&&this.$emit("on-pick",m,"time")}},mounted(){this.$parent&&this.$parent.$options.name==="DatePicker"&&(this.showDate=!0)}};function woe(c,u,m,S,b,v){const M=n.resolveComponent("time-spinner"),N=n.resolveComponent("Confirm");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([b.prefixCls+"-body-wrapper"]),onMousedown:u[0]||(u[0]=n.withModifiers(()=>{},["prevent"]))},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body"])},[b.showDate?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.timePrefixCls+"-header"])},n.toDisplayString(v.visibleDate),3)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content"])},[n.createVNode(M,{ref:"timeSpinner","show-seconds":v.showSeconds,steps:m.steps,hours:v.timeSlots[0],minutes:v.timeSlots[1],seconds:v.timeSlots[2],"disabled-hours":v.disabledHMS.disabledHours,"disabled-minutes":v.disabledHMS.disabledMinutes,"disabled-seconds":v.disabledHMS.disabledSeconds,"hide-disabled-options":c.hideDisabledOptions,onOnChange:v.handleChange,onOnPickClick:c.handlePickClick},null,8,["show-seconds","steps","hours","minutes","seconds","disabled-hours","disabled-minutes","disabled-seconds","hide-disabled-options","onOnChange","onOnPickClick"])],2),c.confirm?(n.openBlock(),n.createBlock(N,{key:1,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess},null,8,["onOnPickClear","onOnPickSuccess"])):n.createCommentVNode("",!0)],2)],34)}var VV=l(boe,[["render",woe]]);const Ooe={props:{datePanelLabel:Object,currentView:String,datePrefixCls:String}};function Soe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("span",null,[m.datePanelLabel?n.withDirectives((n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass([m.datePrefixCls+"-header-label"]),onClick:u[0]||(u[0]=(...M)=>m.datePanelLabel.labels[0].handler&&m.datePanelLabel.labels[0].handler(...M))},n.toDisplayString(m.datePanelLabel.labels[0].label),3)),[[n.vShow,m.datePanelLabel.labels[0].type==="year"||m.currentView==="date"]]):n.createCommentVNode("",!0),m.datePanelLabel&&m.currentView==="date"?(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createTextVNode(n.toDisplayString(m.datePanelLabel.separator),1)],64)):n.createCommentVNode("",!0),m.datePanelLabel?n.withDirectives((n.openBlock(),n.createElementBlock("span",{key:2,class:n.normalizeClass([m.datePrefixCls+"-header-label"]),onClick:u[1]||(u[1]=(...M)=>m.datePanelLabel.labels[1].handler&&m.datePanelLabel.labels[1].handler(...M))},n.toDisplayString(m.datePanelLabel.labels[1].label),3)),[[n.vShow,m.datePanelLabel.labels[1].type==="year"||m.currentView==="date"]]):n.createCommentVNode("",!0)])}var $V=l(Ooe,[["render",Soe]]),UV={props:{showTime:{type:Boolean,default:!1},format:{type:String,default:"yyyy-MM-dd"},selectionMode:{type:String,validator(c){return T(c,["year","month","date","time"])},default:"date"},shortcuts:{type:Array,default:()=>[]},disabledDate:{type:Function,default:()=>!1},modelValue:{type:Array,default:()=>[gc(),gc()]},timePickerOptions:{default:()=>({}),type:Object},showWeekNumbers:{type:Boolean,default:!1},startDate:{type:Date},pickerType:{type:String,require:!0},focusedDate:{type:Date,required:!0}},computed:{isTime(){return this.currentView==="time"}},methods:{handleToggleTime(){this.currentView=this.currentView==="time"?"date":"time"}}};const WE="ivu-picker-panel",Coe="ivu-date-picker",Toe={name:"DatePickerPanel",mixins:[gw,Sn,UV],components:{Icon:O,DateTable:PV,YearTable:IV,MonthTable:BV,TimePicker:VV,Confirm:mw,datePanelLabel:$V},emits:["on-selection-mode-change","on-pick"],props:{multiple:{type:Boolean,default:!1}},data(){const{selectionMode:c,modelValue:u}=this,m=u.slice().sort();return{prefixCls:WE,datePrefixCls:Coe,currentView:c||"date",pickerTable:this.getTableType(c),dates:m,panelDate:this.startDate||m[0]||new Date}},computed:{classes(){return[`${WE}-body-wrapper`,{[`${WE}-with-sidebar`]:this.shortcuts.length}]},panelPickerHandlers(){return this.pickerTable===`${this.currentView}-table`?this.handlePick:this.handlePreSelection},datePanelLabel(){const c=this.t("i.locale"),u=this.t("i.datepicker.datePanelLabel"),m=this.panelDate,{labels:S,separator:b}=VE(c,u,m),v=M=>()=>this.pickerTable=this.getTableType(M);return{separator:b,labels:S.map(M=>(M.handler=v(M.type),M))}},timeDisabled(){return!this.dates[0]}},watch:{modelValue(c){this.dates=c;const u=this.multiple?this.dates[this.dates.length-1]:this.startDate||this.dates[0];this.panelDate=u||new Date},currentView(c){this.$emit("on-selection-mode-change",c),this.currentView==="time"&&n.nextTick(()=>{this.$refs.timePicker.$refs.timeSpinner.updateScroll()})},selectionMode(c){this.currentView=c,this.pickerTable=this.getTableType(c)},focusedDate(c){const u=c.getFullYear()!==this.panelDate.getFullYear(),m=u||c.getMonth()!==this.panelDate.getMonth();(u||m)&&(this.multiple||(this.panelDate=c))}},methods:{reset(){this.currentView=this.selectionMode,this.pickerTable=this.getTableType(this.currentView)},changeYear(c){this.selectionMode==="year"||this.pickerTable==="year-table"?this.panelDate=new Date(this.panelDate.getFullYear()+c*10,0,1):this.panelDate=wV(this.panelDate,c*12)},getTableType(c){return c.match(/^time/)?"time-picker":`${c}-table`},changeMonth(c){this.panelDate=wV(this.panelDate,c)},handlePreSelection(c){this.panelDate=c,this.pickerTable==="year-table"?this.pickerTable="month-table":this.pickerTable=this.getTableType(this.currentView)},handlePick(c,u){const{selectionMode:m,panelDate:S}=this;m==="year"?c=new Date(c.getFullYear(),0,1):m==="month"?c=new Date(S.getFullYear(),c.getMonth(),1):c=new Date(c),this.dates=[c],this.$emit("on-pick",c,!1,u||m)}}},Aoe=["onClick"];function Eoe(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("date-panel-label"),X=n.resolveComponent("time-picker"),U=n.resolveComponent("Confirm");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),onMousedown:u[4]||(u[4]=n.withModifiers(()=>{},["prevent"]))},[c.shortcuts.length?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-sidebar"])},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(c.shortcuts,H=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([b.prefixCls+"-shortcut"]),key:H.text,onClick:re=>c.handleShortcutClick(H)},n.toDisplayString(H.text),11,Aoe))),128))],2)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body"])},[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.datePrefixCls+"-header"])},[n.createElementVNode("span",{class:n.normalizeClass(c.iconBtnCls("prev","-double")),onClick:u[0]||(u[0]=H=>v.changeYear(-1))},[n.createVNode(M,{type:"ios-arrow-back"})],2),b.pickerTable==="date-table"?n.withDirectives((n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(c.iconBtnCls("prev")),onClick:u[1]||(u[1]=H=>v.changeMonth(-1))},[n.createVNode(M,{type:"ios-arrow-back"})],2)),[[n.vShow,b.currentView==="date"]]):n.createCommentVNode("",!0),n.createVNode(N,{"date-panel-label":v.datePanelLabel,"current-view":b.pickerTable.split("-").shift(),"date-prefix-cls":b.datePrefixCls},null,8,["date-panel-label","current-view","date-prefix-cls"]),n.createElementVNode("span",{class:n.normalizeClass(c.iconBtnCls("next","-double")),onClick:u[2]||(u[2]=H=>v.changeYear(1))},[n.createVNode(M,{type:"ios-arrow-forward"})],2),b.pickerTable==="date-table"?n.withDirectives((n.openBlock(),n.createElementBlock("span",{key:1,class:n.normalizeClass(c.iconBtnCls("next")),onClick:u[3]||(u[3]=H=>v.changeMonth(1))},[n.createVNode(M,{type:"ios-arrow-forward"})],2)),[[n.vShow,b.currentView==="date"]]):n.createCommentVNode("",!0)],2),[[n.vShow,b.currentView!=="time"]]),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content"])},[b.currentView!=="time"?(n.openBlock(),n.createBlock(n.resolveDynamicComponent(b.pickerTable),{key:0,ref:"pickerTable","table-date":b.panelDate,"show-week-numbers":c.showWeekNumbers,"model-value":b.dates,"selection-mode":c.selectionMode,"disabled-date":c.disabledDate,"focused-date":c.focusedDate,onOnPick:v.panelPickerHandlers,onOnPickClick:c.handlePickClick},null,40,["table-date","show-week-numbers","model-value","selection-mode","disabled-date","focused-date","onOnPick","onOnPickClick"])):n.createCommentVNode("",!0)],2),n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content"])},[b.currentView==="time"?(n.openBlock(),n.createBlock(X,n.mergeProps({key:0,ref:"timePicker","model-value":b.dates,format:c.format,"time-disabled":v.timeDisabled,"disabled-date":c.disabledDate,"focused-date":c.focusedDate},c.timePickerOptions,{onOnPick:v.handlePick,onOnPickClick:c.handlePickClick,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess,onOnPickToggleTime:c.handleToggleTime}),null,16,["model-value","format","time-disabled","disabled-date","focused-date","onOnPick","onOnPickClick","onOnPickClear","onOnPickSuccess","onOnPickToggleTime"])):n.createCommentVNode("",!0)],2),[[n.vShow,c.isTime]]),c.confirm?(n.openBlock(),n.createBlock(U,{key:0,"show-time":c.showTime,"is-time":c.isTime,onOnPickToggleTime:c.handleToggleTime,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess},null,8,["show-time","is-time","onOnPickToggleTime","onOnPickClear","onOnPickSuccess"])):n.createCommentVNode("",!0)],2)],34)}var Moe=l(Toe,[["render",Eoe]]);const FV="ivu-picker-panel",HE="ivu-time-picker",zV=c=>c[0].toUpperCase()+c.slice(1),koe={name:"RangeTimePickerPanel",mixins:[gw,Sn,pw],components:{TimeSpinner:RV,Confirm:mw},emits:["on-pick"],props:{steps:{type:Array,default:()=>[]},format:{type:String,default:"HH:mm:ss"},modelValue:{type:Array,required:!0}},data(){const[c,u]=this.modelValue.slice();return{prefixCls:FV,timePrefixCls:HE,showDate:!1,dateStart:c||gc(),dateEnd:u||gc()}},computed:{classes(){return[`${FV}-body-wrapper`,`${HE}-with-range`,{[`${HE}-with-seconds`]:this.showSeconds}]},showSeconds(){return!!(this.format||"").match(/ss/)},leftDatePanelLabel(){return this.panelLabelConfig(this.date)},rightDatePanelLabel(){return this.panelLabelConfig(this.dateEnd)}},watch:{modelValue(c){const[u,m]=c.slice();this.dateStart=u||gc(),this.dateEnd=m||gc()}},methods:{panelLabelConfig(c){const u=this.t("i.locale"),m=this.t("i.datepicker.datePanelLabel"),{labels:S,separator:b}=VE(u,m,c||gc());return[S[0].label,b,S[1].label].join("")},handleChange(c,u,m=!0){const S=new Date(this.dateStart);let b=new Date(this.dateEnd);Object.keys(c).forEach(v=>{S[`set${zV(v)}`](c[v])}),Object.keys(u).forEach(v=>{b[`set${zV(v)}`](u[v])}),b<S&&(b=S),m&&this.$emit("on-pick",[S,b],"time")},handleStartChange(c){this.handleChange(c,{})},handleEndChange(c){this.handleChange({},c)},updateScroll(){this.$refs.timeSpinner.updateScroll(),this.$refs.timeSpinnerEnd.updateScroll()}},mounted(){this.$parent&&this.$parent.$options.name==="DatePicker"&&(this.showDate=!0)}};function Poe(c,u,m,S,b,v){const M=n.resolveComponent("time-spinner"),N=n.resolveComponent("Confirm");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),onMousedown:u[0]||(u[0]=n.withModifiers(()=>{},["prevent"]))},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body"])},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content",b.prefixCls+"-content-left"])},[n.createElementVNode("div",{class:n.normalizeClass([b.timePrefixCls+"-header"])},[b.showDate?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createTextVNode(n.toDisplayString(v.leftDatePanelLabel),1)],64)):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createTextVNode(n.toDisplayString(c.t("i.datepicker.startTime")),1)],64))],2),n.createVNode(M,{ref:"timeSpinner",steps:m.steps,"show-seconds":v.showSeconds,hours:m.modelValue[0]&&b.dateStart.getHours(),minutes:m.modelValue[0]&&b.dateStart.getMinutes(),seconds:m.modelValue[0]&&b.dateStart.getSeconds(),"disabled-hours":c.disabledHours,"disabled-minutes":c.disabledMinutes,"disabled-seconds":c.disabledSeconds,"hide-disabled-options":c.hideDisabledOptions,onOnChange:v.handleStartChange,onOnPickClick:c.handlePickClick},null,8,["steps","show-seconds","hours","minutes","seconds","disabled-hours","disabled-minutes","disabled-seconds","hide-disabled-options","onOnChange","onOnPickClick"])],2),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content",b.prefixCls+"-content-right"])},[n.createElementVNode("div",{class:n.normalizeClass([b.timePrefixCls+"-header"])},[b.showDate?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createTextVNode(n.toDisplayString(v.rightDatePanelLabel),1)],64)):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createTextVNode(n.toDisplayString(c.t("i.datepicker.endTime")),1)],64))],2),n.createVNode(M,{ref:"timeSpinnerEnd",steps:m.steps,"show-seconds":v.showSeconds,hours:m.modelValue[1]&&b.dateEnd.getHours(),minutes:m.modelValue[1]&&b.dateEnd.getMinutes(),seconds:m.modelValue[1]&&b.dateEnd.getSeconds(),"disabled-hours":c.disabledHours,"disabled-minutes":c.disabledMinutes,"disabled-seconds":c.disabledSeconds,"hide-disabled-options":c.hideDisabledOptions,onOnChange:v.handleEndChange,onOnPickClick:c.handlePickClick},null,8,["steps","show-seconds","hours","minutes","seconds","disabled-hours","disabled-minutes","disabled-seconds","hide-disabled-options","onOnChange","onOnPickClick"])],2),c.confirm?(n.openBlock(),n.createBlock(N,{key:0,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess},null,8,["onOnPickClear","onOnPickSuccess"])):n.createCommentVNode("",!0)],2)],34)}var XV=l(koe,[["render",Poe]]);const jm="ivu-picker-panel",GE="ivu-date-picker",WV=(c,u)=>!c||!u?0:c.getTime()-u.getTime(),Ioe={name:"RangeDatePickerPanel",mixins:[gw,Sn,UV],components:{Icon:O,DateTable:PV,YearTable:IV,MonthTable:BV,TimePicker:XV,Confirm:mw,datePanelLabel:$V},props:{splitPanels:{type:Boolean,default:!1}},data(){const[c,u]=this.modelValue.map(S=>S||gc()),m=this.startDate?this.startDate:c;return{prefixCls:jm,datePrefixCls:GE,dates:this.modelValue,rangeState:{from:this.modelValue[0],to:this.modelValue[1],selecting:c&&!u},currentView:this.selectionMode||"range",leftPickerTable:`${this.selectionMode}-table`,rightPickerTable:`${this.selectionMode}-table`,leftPanelDate:m,rightPanelDate:new Date(m.getFullYear(),m.getMonth()+1,1)}},computed:{classes(){return[`${jm}-body-wrapper`,`${GE}-with-range`,{[`${jm}-with-sidebar`]:this.shortcuts.length,[`${GE}-with-week-numbers`]:this.showWeekNumbers}]},panelBodyClasses(){return[jm+"-body",{[jm+"-body-time"]:this.showTime,[jm+"-body-date"]:!this.showTime}]},leftDatePanelLabel(){return this.panelLabelConfig("left")},rightDatePanelLabel(){return this.panelLabelConfig("right")},leftDatePanelView(){return this.leftPickerTable.split("-").shift()},rightDatePanelView(){return this.rightPickerTable.split("-").shift()},timeDisabled(){return!(this.dates[0]&&this.dates[1])},preSelecting(){const c=`${this.currentView}-table`;return{left:this.leftPickerTable!==c,right:this.rightPickerTable!==c}},panelPickerHandlers(){return{left:this.preSelecting.left?this.handlePreSelection.bind(this,"left"):this.handleRangePick,right:this.preSelecting.right?this.handlePreSelection.bind(this,"right"):this.handleRangePick}}},watch:{modelValue(c){const u=c[0]?NE(c[0]):null,m=c[1]?NE(c[1]):null;this.dates=[u,m].sort(WV),this.rangeState={from:this.dates[0],to:this.dates[1],selecting:!1},this.setPanelDates(this.startDate||this.dates[0]||new Date)},currentView(c){const u=this.leftPanelDate.getMonth(),m=this.rightPanelDate.getMonth(),S=this.leftPanelDate.getFullYear()===this.rightPanelDate.getFullYear();c==="date"&&S&&u===m&&this.changePanelDate("right","Month",1),c==="month"&&S&&this.changePanelDate("right","FullYear",1),c==="year"&&S&&this.changePanelDate("right","FullYear",10)},selectionMode(c){this.currentView=c||"range"},focusedDate(c){this.setPanelDates(c||new Date)}},methods:{reset(){this.currentView=this.selectionMode,this.leftPickerTable=`${this.currentView}-table`,this.rightPickerTable=`${this.currentView}-table`},setPanelDates(c){this.leftPanelDate=c;const u=new Date(c.getFullYear(),c.getMonth()+1,1),m=this.dates[1]?this.dates[1].getTime():this.dates[1];this.rightPanelDate=this.splitPanels?new Date(Math.max(m,u.getTime())):u},panelLabelConfig(c){const u=this.t("i.locale"),m=this.t("i.datepicker.datePanelLabel"),S=N=>{const X=N=="month"?this.showMonthPicker:this.showYearPicker;return()=>X(c)},b=this[`${c}PanelDate`],{labels:v,separator:M}=VE(u,m,b);return{separator:M,labels:v.map(N=>(N.handler=S(N.type),N))}},prevYear(c){const u=this.currentView==="year"?-10:-1;this.changePanelDate(c,"FullYear",u)},nextYear(c){const u=this.currentView==="year"?10:1;this.changePanelDate(c,"FullYear",u)},prevMonth(c){this.changePanelDate(c,"Month",-1)},nextMonth(c){this.changePanelDate(c,"Month",1)},changePanelDate(c,u,m,S=!0){const b=new Date(this[`${c}PanelDate`]);if(u==="FullYear"?b[`set${u}`](b[`get${u}`]()+m):b[`set${u}`](b[`get${u}`]()+m,1),this[`${c}PanelDate`]=b,!!S)if(this.splitPanels){const v=c==="left"?"right":"left";c==="left"&&this.leftPanelDate>=this.rightPanelDate&&this.changePanelDate(v,u,1),c==="right"&&this.rightPanelDate<=this.leftPanelDate&&this.changePanelDate(v,u,-1)}else{const v=c==="left"?"right":"left",M=this[`${v}PanelDate`],N=new Date(M);if(u==="Month"){const X=new Date(N.getFullYear(),N.getMonth()+m+1,0).getDate();N.setDate(Math.min(X,N.getDate()))}N[`set${u}`](N[`get${u}`]()+m),this[`${v}PanelDate`]=N}},showYearPicker(c){this[`${c}PickerTable`]="year-table"},showMonthPicker(c){this[`${c}PickerTable`]="month-table"},handlePreSelection(c,u){if(this[`${c}PanelDate`]=u,this[`${c}PickerTable`]==="year-table"?this[`${c}PickerTable`]="month-table":this[`${c}PickerTable`]=`${this.currentView}-table`,!this.splitPanels){const m=c==="left"?"right":"left";this[`${m}PanelDate`]=u;const S=m==="left"?-1:1;this.changePanelDate(m,"Month",S,!1)}},handleRangePick(c,u){if(this.rangeState.selecting||this.currentView==="time"){if(this.currentView==="time")this.dates=c;else{const[m,S]=[this.rangeState.from,c].sort(WV);this.dates=[m,S],this.rangeState={from:m,to:S,selecting:!1}}this.handleConfirm(!1,u||"date")}else this.rangeState={from:c,to:null,selecting:!0}},handleChangeRange(c){this.rangeState.to=c}}},Boe=["onClick"];function Roe(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("date-panel-label"),X=n.resolveComponent("time-picker"),U=n.resolveComponent("Confirm");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),onMousedown:u[8]||(u[8]=n.withModifiers(()=>{},["prevent"]))},[c.shortcuts.length?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-sidebar"])},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(c.shortcuts,H=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([b.prefixCls+"-shortcut"]),key:H.text,onClick:re=>c.handleShortcutClick(H)},n.toDisplayString(H.text),11,Boe))),128))],2)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass(v.panelBodyClasses)},[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content",b.prefixCls+"-content-left"])},[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.datePrefixCls+"-header"])},[n.createElementVNode("span",{class:n.normalizeClass(c.iconBtnCls("prev","-double")),onClick:u[0]||(u[0]=H=>v.prevYear("left"))},[n.createVNode(M,{type:"ios-arrow-back"})],2),b.leftPickerTable==="date-table"?n.withDirectives((n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(c.iconBtnCls("prev")),onClick:u[1]||(u[1]=H=>v.prevMonth("left"))},[n.createVNode(M,{type:"ios-arrow-back"})],2)),[[n.vShow,b.currentView==="date"]]):n.createCommentVNode("",!0),n.createVNode(N,{"date-panel-label":v.leftDatePanelLabel,"current-view":v.leftDatePanelView,"date-prefix-cls":b.datePrefixCls},null,8,["date-panel-label","current-view","date-prefix-cls"]),m.splitPanels||b.leftPickerTable!=="date-table"?(n.openBlock(),n.createElementBlock("span",{key:1,class:n.normalizeClass(c.iconBtnCls("next","-double")),onClick:u[2]||(u[2]=H=>v.nextYear("left"))},[n.createVNode(M,{type:"ios-arrow-forward"})],2)):n.createCommentVNode("",!0),m.splitPanels&&b.leftPickerTable==="date-table"?n.withDirectives((n.openBlock(),n.createElementBlock("span",{key:2,class:n.normalizeClass(c.iconBtnCls("next")),onClick:u[3]||(u[3]=H=>v.nextMonth("left"))},[n.createVNode(M,{type:"ios-arrow-forward"})],2)),[[n.vShow,b.currentView==="date"]]):n.createCommentVNode("",!0)],2),[[n.vShow,b.currentView!=="time"]]),b.currentView!=="time"?(n.openBlock(),n.createBlock(n.resolveDynamicComponent(b.leftPickerTable),{key:0,ref:"leftYearTable","table-date":b.leftPanelDate,"selection-mode":"range","disabled-date":c.disabledDate,"range-state":b.rangeState,"show-week-numbers":c.showWeekNumbers,"model-value":v.preSelecting.left?[b.dates[0]]:b.dates,"focused-date":c.focusedDate,onOnChangeRange:v.handleChangeRange,onOnPick:v.panelPickerHandlers.left,onOnPickClick:c.handlePickClick},null,40,["table-date","disabled-date","range-state","show-week-numbers","model-value","focused-date","onOnChangeRange","onOnPick","onOnPickClick"])):n.createCommentVNode("",!0)],2),[[n.vShow,!c.isTime]]),n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content",b.prefixCls+"-content-right"])},[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.datePrefixCls+"-header"])},[m.splitPanels||b.rightPickerTable!=="date-table"?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(c.iconBtnCls("prev","-double")),onClick:u[4]||(u[4]=H=>v.prevYear("right"))},[n.createVNode(M,{type:"ios-arrow-back"})],2)):n.createCommentVNode("",!0),m.splitPanels&&b.rightPickerTable==="date-table"?n.withDirectives((n.openBlock(),n.createElementBlock("span",{key:1,class:n.normalizeClass(c.iconBtnCls("prev")),onClick:u[5]||(u[5]=H=>v.prevMonth("right"))},[n.createVNode(M,{type:"ios-arrow-back"})],2)),[[n.vShow,b.currentView==="date"]]):n.createCommentVNode("",!0),n.createVNode(N,{"date-panel-label":v.rightDatePanelLabel,"current-view":v.rightDatePanelView,"date-prefix-cls":b.datePrefixCls},null,8,["date-panel-label","current-view","date-prefix-cls"]),n.createElementVNode("span",{class:n.normalizeClass(c.iconBtnCls("next","-double")),onClick:u[6]||(u[6]=H=>v.nextYear("right"))},[n.createVNode(M,{type:"ios-arrow-forward"})],2),b.rightPickerTable==="date-table"?n.withDirectives((n.openBlock(),n.createElementBlock("span",{key:2,class:n.normalizeClass(c.iconBtnCls("next")),onClick:u[7]||(u[7]=H=>v.nextMonth("right"))},[n.createVNode(M,{type:"ios-arrow-forward"})],2)),[[n.vShow,b.currentView==="date"]]):n.createCommentVNode("",!0)],2),[[n.vShow,b.currentView!=="time"]]),b.currentView!=="time"?(n.openBlock(),n.createBlock(n.resolveDynamicComponent(b.rightPickerTable),{key:0,ref:"rightYearTable","table-date":b.rightPanelDate,"selection-mode":"range","range-state":b.rangeState,"disabled-date":c.disabledDate,"show-week-numbers":c.showWeekNumbers,"model-value":v.preSelecting.right?[b.dates[b.dates.length-1]]:b.dates,"focused-date":c.focusedDate,onOnChangeRange:v.handleChangeRange,onOnPick:v.panelPickerHandlers.right,onOnPickClick:c.handlePickClick},null,40,["table-date","range-state","disabled-date","show-week-numbers","model-value","focused-date","onOnChangeRange","onOnPick","onOnPickClick"])):n.createCommentVNode("",!0)],2),[[n.vShow,!c.isTime]]),n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content"])},[b.currentView==="time"?(n.openBlock(),n.createBlock(X,n.mergeProps({key:0,ref:"timePicker","model-value":b.dates,format:c.format,"time-disabled":v.timeDisabled},c.timePickerOptions,{onOnPick:v.handleRangePick,onOnPickClick:c.handlePickClick,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess,onOnPickToggleTime:c.handleToggleTime}),null,16,["model-value","format","time-disabled","onOnPick","onOnPickClick","onOnPickClear","onOnPickSuccess","onOnPickToggleTime"])):n.createCommentVNode("",!0)],2),[[n.vShow,c.isTime]]),c.confirm?(n.openBlock(),n.createBlock(U,{key:0,"show-time":c.showTime,"is-time":c.isTime,"time-disabled":v.timeDisabled,onOnPickToggleTime:c.handleToggleTime,onOnPickClear:c.handlePickClear,onOnPickSuccess:c.handlePickSuccess},null,8,["show-time","is-time","time-disabled","onOnPickToggleTime","onOnPickClear","onOnPickSuccess"])):n.createCommentVNode("",!0)],2)],34)}var Doe=l(Ioe,[["render",Roe]]),HV={name:"CalendarPicker",mixins:[SV],props:{type:{validator(c){return T(c,["year","month","date","daterange","datetime","datetimerange"])},default:"date"}},components:{DatePickerPanel:Moe,RangeDatePickerPanel:Doe},computed:{panel(){return this.type==="daterange"||this.type==="datetimerange"?"RangeDatePickerPanel":"DatePickerPanel"},ownPickerProps(){return this.options}}},Loe={1:{xs:24},2:{xs:24,sm:12},3:{xs:24,sm:12,md:8},4:{xs:24,sm:12,md:6}};const GV={name:"Description",inject:["DescriptionListInstance"],props:{term:{type:String}},computed:{styles(){let c={};return this.DescriptionListInstance.gutter!==0&&(c={paddingLeft:this.DescriptionListInstance.gutter/2+"px",paddingRight:this.DescriptionListInstance.gutter/2+"px"}),c}},render(){let c;(this.term||this.$slots.term)&&(this.$slots.term?c=n.h("div",{class:"ivu-description-term"},this.$slots.term()):c=n.h("div",{class:"ivu-description-term"},this.term));const u=n.h("div",{class:"ivu-description-detail"},this.$slots.default()),m=c?[c,u]:[u];return n.h(pc,{...Loe[this.DescriptionListInstance.col],style:this.styles},()=>m)}},Noe={name:"DescriptionList",components:{Row:Du},provide(){return{DescriptionListInstance:this}},props:{layout:{validator(c){return T(c,["horizontal","vertical"])},default:"horizontal"},title:{type:String},gutter:{type:Number,default:32},col:{validator(c){return T(c,[1,2,3,4])},default:3}}},Voe={key:0,class:"ivu-description-list-title"};function $oe(c,u,m,S,b,v){const M=n.resolveComponent("Row");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["ivu-description-list",{"ivu-description-list-vertical":m.layout==="vertical"}])},[m.title||c.$slots.title?(n.openBlock(),n.createElementBlock("div",Voe,[n.renderSlot(c.$slots,"title",{},()=>[n.createTextVNode(n.toDisplayString(m.title),1)])])):n.createCommentVNode("",!0),n.createVNode(M,{gutter:m.gutter},{default:n.withCtx(()=>[n.renderSlot(c.$slots,"default")]),_:3},8,["gutter"])],2)}var QV=l(Noe,[["render",$oe]]);const Vu="ivu-divider",Uoe={name:"Divider",props:{type:{type:String,default:"horizontal",validator(c){return T(c,["horizontal","vertical"])}},orientation:{type:String,default:"center",validator(c){return T(c,["left","right","center"])}},dashed:{type:Boolean,default:!1},size:{validator(c){return T(c,["small","default"])},default:"default"},plain:{type:Boolean,default:!1}},computed:{hasSlot(){return!!this.$slots.default},classes(){return[`${Vu}`,`${Vu}-${this.type}`,`${Vu}-${this.size}`,{[`${Vu}-with-text`]:this.hasSlot&&this.orientation==="center",[`${Vu}-with-text-${this.orientation}`]:this.hasSlot,[`${Vu}-dashed`]:!!this.dashed,[`${Vu}-plain`]:this.plain}]},slotClasses(){return[`${Vu}-inner-text`]}}};function Foe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[v.hasSlot?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(v.slotClasses)},[n.renderSlot(c.$slots,"default")],2)):n.createCommentVNode("",!0)],2)}var yw=l(Uoe,[["render",Foe]]),QE={props:{lockScroll:{type:Boolean,default:!0}},methods:{checkScrollBar(){if(!r)return;let c=window.innerWidth;if(!c){const u=document.documentElement.getBoundingClientRect();c=u.right-Math.abs(u.left)}this.bodyIsOverflowing=document.body.clientWidth<c,this.bodyIsOverflowing&&(this.scrollBarWidth=A())},checkMaskInVisible(){let c=r?document.getElementsByClassName("ivu-modal-mask")||[]:[];return Array.from(c).every(u=>u.style.display==="none"||u.classList.contains("fade-leave-to"))},setScrollBar(){r&&this.bodyIsOverflowing&&this.scrollBarWidth!==void 0&&(document.body.style.paddingRight=`${this.scrollBarWidth}px`)},resetScrollBar(){r&&(document.body.style.paddingRight="")},addScrollEffect(){!this.lockScroll||(this.checkScrollBar(),this.setScrollBar(),r&&(document.body.style.overflow="hidden"))},removeScrollEffect(){!this.lockScroll||r&&this.checkMaskInVisible()&&(document.body.style.overflow="",this.resetScrollBar())}}};const uo="ivu-drawer",zoe={name:"Drawer",mixins:[QE],components:{Icon:O},emits:["on-close","on-resize-width","on-visible-change","update:modelValue","on-drag"],provide(){return{DrawerInstance:this}},props:{modelValue:{type:Boolean,default:!1},title:{type:String},width:{type:[Number,String],default:256},height:{type:[Number,String],default:256},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},mask:{type:Boolean,default:!0},maskStyle:{type:Object},styles:{type:Object},scrollable:{type:Boolean,default:!1},placement:{validator(c){return T(c,["left","right","top","bottom"])},default:"right"},zIndex:{type:Number,default:1e3},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!0:c.$VIEWUI.transfer}},className:{type:String},inner:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},beforeClose:Function},data(){return{prefixCls:uo,visible:this.modelValue,wrapShow:!1,showHead:!0,canMove:!1,dragWidth:this.width,dragHeight:this.height,wrapperWidth:this.width,wrapperHeight:this.height,wrapperLeft:0,minWidth:256,minHeight:256,id:te(6),tableList:[],sliderList:[]}},computed:{wrapClasses(){return[`${uo}-wrap`,{[`${uo}-hidden`]:!this.wrapShow,[`${this.className}`]:!!this.className,[`${uo}-no-mask`]:!this.mask,[`${uo}-wrap-inner`]:this.inner,[`${uo}-wrap-dragging`]:this.canMove}]},wrapStyles(){return{zIndex:this.zIndex}},mainStyles(){let c={};if(this.placement==="left"||this.placement==="right"){const u=parseInt(this.dragWidth),m={width:u<=100?`${u}%`:`${u}px`};Object.assign(c,m)}else{const u=parseInt(this.dragHeight),m={height:u<=100?`${u}%`:`${u}px`};Object.assign(c,m)}return c},contentClasses(){return[`${uo}-content`,{[`${uo}-content-no-mask`]:!this.mask}]},classes(){return[`${uo}`,`${uo}-${this.placement}`,{[`${uo}-no-header`]:!this.showHead,[`${uo}-inner`]:this.inner}]},maskClasses(){return[`${uo}-mask`,{[`${uo}-mask-inner`]:this.inner}]},transitionName(){return this.placement==="left"||this.placement==="right"?`move-${this.placement}`:this.placement==="top"?"move-up":"move-down"}},methods:{close(){if(!this.beforeClose)return this.handleClose();const c=this.beforeClose();c&&c.then?c.then(()=>{this.handleClose()}):this.handleClose()},handleClose(){this.visible=!1,this.$emit("update:modelValue",!1),this.$emit("on-close")},handleMask(){this.maskClosable&&this.mask&&this.close()},handleWrapClick(c){const u=c.target.getAttribute("class");u&&u.indexOf(`${uo}-wrap`)>-1&&this.handleMask()},handleMousemove(c){if(!this.canMove||!this.draggable)return;this.handleSetWrapperWidth();const u=c.pageX-this.wrapperLeft;let m=this.placement==="right"?this.wrapperWidth-u:u;m=Math.max(m,parseFloat(this.minWidth)),c.atMin=m===parseFloat(this.minWidth),m<=100&&(m=m/this.wrapperWidth*100),this.dragWidth=m,this.$emit("on-resize-width",parseInt(this.dragWidth)),this.$emit("on-drag","dragging",parseInt(this.dragWidth))},handleSetWrapperWidth(){const{width:c,left:u}=this.$refs.drawer.getBoundingClientRect();this.wrapperWidth=c,this.wrapperLeft=u},handleMouseup(){!this.draggable||(this.canMove=!1,this.$emit("on-drag","end"))},handleTriggerMousedown(){this.canMove=!0,window.getSelection().removeAllRanges(),this.$emit("on-drag","start")},addDrawer(){const c=this.$root;c.drawerList||(c.drawerList=[]),c.drawerList.push({id:this.id,drawer:this})},removeDrawer(){const c=this.$root;if(!c.drawerList)return;const u=c.drawerList.findIndex(m=>m.id===this.id);c.drawerList.splice(u,1)}},mounted(){this.visible&&(this.wrapShow=!0);let c=!0;this.$slots.header===void 0&&!this.title&&(c=!1),this.showHead=c,this.addDrawer(),o(document,"mousemove",this.handleMousemove),o(document,"mouseup",this.handleMouseup),this.handleSetWrapperWidth()},beforeUnmount(){this.removeDrawer(),a(document,"mousemove",this.handleMousemove),a(document,"mouseup",this.handleMouseup),this.removeScrollEffect()},watch:{modelValue(c){this.visible=c},visible(c){c===!1?this.timer=setTimeout(()=>{this.wrapShow=!1,this.$root.drawerList.map(u=>u.drawer).filter(u=>u.id!==this.id).some(u=>u.visible&&!u.scrollable)||this.removeScrollEffect()},300):(this.timer&&clearTimeout(this.timer),this.wrapShow=!0,this.scrollable||this.addScrollEffect()),this.tableList.forEach(u=>{u.table.handleOnVisibleChange(c)}),this.sliderList.forEach(u=>{u.slider.handleOnVisibleChange(c)}),this.$emit("on-visible-change",c)},scrollable(c){c?this.removeScrollEffect():this.addScrollEffect()},title(c){this.$slots.header===void 0&&(this.showHead=!!c)},width(c){this.dragWidth=c},height(c){this.dragHeight=c}}},Xoe={ref:"drawer"},Woe=n.createElementVNode("div",{class:"ivu-drawer-drag-move-trigger"},[n.createElementVNode("div",{class:"ivu-drawer-drag-move-trigger-point"},[n.createElementVNode("i"),n.createElementVNode("i"),n.createElementVNode("i"),n.createElementVNode("i"),n.createElementVNode("i")])],-1);function Hoe(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createBlock(n.Teleport,{to:"body",disabled:!m.transfer},[n.createElementVNode("div",Xoe,[n.createVNode(n.Transition,{name:"fade"},{default:n.withCtx(()=>[m.mask?n.withDirectives((n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.maskClasses),style:n.normalizeStyle(m.maskStyle),onClick:u[0]||(u[0]=(...N)=>v.handleMask&&v.handleMask(...N))},null,6)),[[n.vShow,b.visible]]):n.createCommentVNode("",!0)]),_:1}),n.createElementVNode("div",{class:n.normalizeClass(v.wrapClasses),style:n.normalizeStyle(v.wrapStyles),onClick:u[3]||(u[3]=(...N)=>v.handleWrapClick&&v.handleWrapClick(...N))},[n.createVNode(n.Transition,{name:v.transitionName},{default:n.withCtx(()=>[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.mainStyles)},[n.createElementVNode("div",{class:n.normalizeClass(v.contentClasses),ref:"content"},[m.closable?(n.openBlock(),n.createElementBlock("a",{key:0,class:"ivu-drawer-close",onClick:u[1]||(u[1]=(...N)=>v.close&&v.close(...N))},[n.renderSlot(c.$slots,"close",{},()=>[n.createVNode(M,{type:"ios-close"})])])):n.createCommentVNode("",!0),b.showHead?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass([b.prefixCls+"-header"])},[n.renderSlot(c.$slots,"header",{},()=>[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-header-inner"])},n.toDisplayString(m.title),3)])],2)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body"]),style:n.normalizeStyle(m.styles)},[n.renderSlot(c.$slots,"default")],6)],2),m.draggable&&(m.placement==="left"||m.placement==="right")?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(["ivu-drawer-drag","ivu-drawer-drag-"+m.placement]),onMousedown:u[2]||(u[2]=(...N)=>v.handleTriggerMousedown&&v.handleTriggerMousedown(...N))},[n.renderSlot(c.$slots,"trigger",{},()=>[Woe])],34)):n.createCommentVNode("",!0)],6),[[n.vShow,b.visible]])]),_:3},8,["name"])],6)],512)],8,["disabled"])}var YV=l(zoe,[["render",Hoe]]);const vw="ivu-dropdown-item",Goe={name:"DropdownItem",props:{name:{type:[String,Number]},disabled:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},divided:{type:Boolean,default:!1}},computed:{classes(){return[`${vw}`,{[`${vw}-disabled`]:this.disabled,[`${vw}-selected`]:this.selected,[`${vw}-divided`]:this.divided}]}},methods:{handleClick(){if(this.disabled)return;const c=F(this,"Dropdown");this.$parent&&this.$parent.$options.name==="Dropdown"?this.$parent.handleHaschildClick():c&&c.$options.name==="Dropdown"&&c.handleHoverClick(),c.handleItemClick(this.name)}}};function Qoe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(v.classes),onClick:u[0]||(u[0]=(...M)=>v.handleClick&&v.handleClick(...M))},[n.renderSlot(c.$slots,"default")],2)}var jV=l(Goe,[["render",Qoe]]);const Yoe=(c="")=>c.split("").reduce((u,m)=>{const S=m.charCodeAt(0);return S>=0&&S<=128?u+1:u+2},0),joe=(c="",u)=>{let m=0;return c.split("").reduce((S,b)=>{const v=b.charCodeAt(0);return v>=0&&v<=128?m+=1:m+=2,m<=u?S+b:S},"")},qoe={name:"Ellipsis",components:{Tooltip:mh},emits:["on-show","on-hide"],props:{text:{type:String},height:{type:Number},lines:{type:Number},length:{type:Number},fullWidthRecognition:{type:Boolean,default:!1},autoResize:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},tooltip:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},theme:{validator(c){return T(c,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number],default:250},placement:{validator(c){return T(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"}},data(){return{oversize:!1,computedReady:!1,computedText:""}},watch:{disabled(){this.init()},text(){this.init()},height(){this.init()}},mounted(){this.init()},methods:{init(){this.disabled||(this.computeText(),this.limitShow())},computeText(){this.oversize=!1,this.computedReady=!1,n.nextTick(()=>{let c=this.$refs.text,u=this.$el,m=this.$refs.more,S=1e3,b=this.text,v=this.height;if(!v&&this.lines&&(v=parseInt(k(u,"lineHeight"),10)*this.lines),c){if(this.length)(this.fullWidthRecognition?Yoe(b):b.length)>this.length&&(this.oversize=!0,m.style.display="inline-block",b=this.fullWidthRecognition?joe(b,this.length):b.slice(0,this.length));else if(u.offsetHeight>v)for(this.oversize=!0,m.style.display="inline-block";u.offsetHeight>v&&S>0;)u.offsetHeight>v*3?c.innerText=b=b.substring(0,Math.floor(b.length/2)):c.innerText=b=b.substring(0,b.length-1),S--}this.computedText=b})},limitShow(){this.computedReady=!0,n.nextTick(()=>{let c=this.$refs.text,u=this.$el;c&&(c.innerText=this.computedText,u.offsetHeight>this.height?this.$emit("on-hide"):this.$emit("on-show"))})}}},Zoe={class:"ivu-ellipsis"},Koe={class:"ivu-ellipsis-more",ref:"more"},Joe={class:"ivu-ellipsis-more",ref:"more"},eae={key:1,class:"ivu-ellipsis-hidden"},tae={class:"ivu-ellipsis-more",ref:"more"};function iae(c,u,m,S,b,v){const M=n.resolveComponent("Tooltip");return n.openBlock(),n.createElementBlock("div",Zoe,[n.renderSlot(c.$slots,"prefix",{class:"ivu-ellipsis-prefix"}),b.computedReady?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[m.tooltip?(n.openBlock(),n.createBlock(M,{key:0,content:m.text,theme:m.theme,"max-width":m.maxWidth,placement:m.placement,transfer:m.transfer},{default:n.withCtx(()=>[n.createElementVNode("span",{class:"ivu-ellipsis-text",ref:"text"},n.toDisplayString(m.text),513),n.withDirectives(n.createElementVNode("span",Koe,[n.renderSlot(c.$slots,"more",{},()=>[n.createTextVNode("...")])],512),[[n.vShow,b.oversize]]),n.renderSlot(c.$slots,"suffix",{class:"ivu-ellipsis-suffix"})]),_:3},8,["content","theme","max-width","placement","transfer"])):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createElementVNode("span",{class:"ivu-ellipsis-text",ref:"text"},n.toDisplayString(m.text),513),n.withDirectives(n.createElementVNode("span",Joe,[n.renderSlot(c.$slots,"more",{},()=>[n.createTextVNode("...")])],512),[[n.vShow,b.oversize]]),n.renderSlot(c.$slots,"suffix",{class:"ivu-ellipsis-suffix"})],64))],64)):(n.openBlock(),n.createElementBlock("div",eae,[n.createElementVNode("span",{class:"ivu-ellipsis-text",ref:"text"},n.toDisplayString(m.text),513),n.withDirectives(n.createElementVNode("span",tae,[n.renderSlot(c.$slots,"more",{},()=>[n.createTextVNode("...")])],512),[[n.vShow,b.oversize]]),n.renderSlot(c.$slots,"suffix",{class:"ivu-ellipsis-suffix"})]))])}var qV=l(qoe,[["render",iae]]);const ZV={name:"Email",mixins:[Zy],data(){return{className:"ivu-login-mail",prefix:"ios-mail-outline",placeholder:"",type:"email"}},props:{rules:{type:[Object,Array],default(){return[{required:!0,message:EE.Email,trigger:"change"},{type:"email",message:"",trigger:"change"}]}}}};var xw={403:{img:"https://file.iviewui.com/iview-pro/icon-403.svg",imgColor:"https://file.iviewui.com/iview-pro/icon-403-color.svg",title:"403",desc:""},404:{img:"https://file.iviewui.com/iview-pro/icon-404.svg",imgColor:"https://file.iviewui.com/iview-pro/icon-404-color.svg",title:"404",desc:""},500:{img:"https://file.iviewui.com/iview-pro/icon-500.svg",imgColor:"https://file.iviewui.com/iview-pro/icon-500-color.svg",title:"500",desc:""}};const nae={name:"Exception",components:{Button:co},props:{type:{validator(c){return T(c,["403","404","500",403,404,500])},default:"404"},title:{type:String},desc:{type:String},img:{type:String},imgColor:{type:Boolean,default:!1},backText:{type:String,default:""},redirect:{type:String,default:"/"}},computed:{imgPath(){return this.img?this.img:this.imgColor?xw[this.type].imgColor:xw[this.type].img},titleText(){return this.title?this.title:xw[this.type].title},descText(){return this.desc?this.desc:xw[this.type].desc}}},sae={class:"ivu-exception"},rae={class:"ivu-exception-img"},oae={class:"ivu-exception-content"},aae={class:"ivu-exception-content-desc"},lae={class:"ivu-exception-content-actions"};function cae(c,u,m,S,b,v){const M=n.resolveComponent("Button");return n.openBlock(),n.createElementBlock("div",sae,[n.createElementVNode("div",rae,[n.createElementVNode("div",{class:"ivu-exception-img-element",style:n.normalizeStyle({"background-image":"url("+v.imgPath+")"})},null,4)]),n.createElementVNode("div",oae,[n.createElementVNode("h1",null,[n.renderSlot(c.$slots,"title",{},()=>[n.createTextVNode(n.toDisplayString(v.titleText),1)])]),n.createElementVNode("div",aae,[n.renderSlot(c.$slots,"desc",{},()=>[n.createTextVNode(n.toDisplayString(v.descText),1)])]),n.createElementVNode("div",lae,[n.renderSlot(c.$slots,"actions",{},()=>[n.createVNode(M,{to:m.redirect,type:"primary",size:"large"},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(m.backText),1)]),_:1},8,["to"])])])])])}var KV=l(nae,[["render",cae]]);const hae="ivu-layout",uae={name:"Footer",computed:{wrapClasses(){return`${hae}-footer`}}};function dae(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses)},[n.renderSlot(c.$slots,"default")],2)}var YE=l(uae,[["render",dae]]);const fae={name:"FooterToolbar",props:{extra:{type:String}}},pae={class:"ivu-footer-toolbar"},mae={key:0,class:"ivu-footer-toolbar-left"},gae={class:"ivu-footer-toolbar-right"};function yae(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",pae,[m.extra||c.$slots.extra?(n.openBlock(),n.createElementBlock("div",mae,[n.renderSlot(c.$slots,"extra",{},()=>[n.createTextVNode(n.toDisplayString(m.extra),1)])])):n.createCommentVNode("",!0),n.createElementVNode("div",gae,[n.renderSlot(c.$slots,"default")])])}var JV=l(fae,[["render",yae]]);const _w="ivu-form",vae={name:"iForm",emits:["on-validate"],provide(){return{FormInstance:this}},props:{model:{type:Object},rules:{type:Object},labelWidth:{type:Number},labelPosition:{validator(c){return T(c,["left","right","top"])},default:"right"},inline:{type:Boolean,default:!1},showMessage:{type:Boolean,default:!0},autocomplete:{validator(c){return T(c,["on","off"])},default:"off"},hideRequiredMark:{type:Boolean,default:!1},labelColon:{type:[Boolean,String],default:!1},disabled:{type:Boolean,default:!1}},data(){return{fields:[]}},computed:{classes(){return[`${_w}`,`${_w}-label-${this.labelPosition}`,{[`${_w}-inline`]:this.inline,[`${_w}-hide-required-mark`]:this.hideRequiredMark}]},colon(){let c="";return this.labelColon&&(c=typeof this.labelColon=="boolean"?":":this.labelColon),c}},methods:{resetFields(){this.fields.forEach(c=>{c.resetField()})},validate(c){return new Promise(u=>{let m=!0,S=0;this.fields.length===0&&(u(m),typeof c=="function"&&c(m)),this.fields.forEach(b=>{b.validate("",v=>{v&&(m=!1),++S===this.fields.length&&(u(m),typeof c=="function"&&c(m))})})})},validateField(c,u){const m=this.fields.filter(S=>S.prop===c)[0];if(!m)throw new Error("[View UI warn]: must call validateField with valid prop string!");m.validate("",u)},addField(c){c&&this.fields.push(c)},removeField(c){c.prop&&this.fields.splice(this.fields.indexOf(c),1)}},watch:{rules(){this.validate()}}},xae=["autocomplete"];function _ae(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("form",{class:n.normalizeClass(v.classes),autocomplete:m.autocomplete},[n.renderSlot(c.$slots,"default")],10,xae)}var bw=l(vae,[["render",_ae]]);const bae={name:"GlobalFooter",components:{Icon:O},props:{links:{type:Array,default(){return[]}},copyright:{type:String}}},wae={class:"ivu-global-footer"},Oae={key:0,class:"ivu-global-footer-links"},Sae=["href","target","title"],Cae={key:1,class:"ivu-global-footer-copyright"};function Tae(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("footer",wae,[m.links.length||c.$slots.links?(n.openBlock(),n.createElementBlock("div",Oae,[n.renderSlot(c.$slots,"links",{},()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.links,N=>(n.openBlock(),n.createElementBlock("a",{href:N.href,target:N.blankTarget?"_blank":"_self",key:N.key,title:N.title},[N.icon?(n.openBlock(),n.createBlock(M,{key:0,type:N.icon},null,8,["type"])):N.customIcon?(n.openBlock(),n.createBlock(M,{key:1,custom:N.customIcon},null,8,["custom"])):n.createCommentVNode("",!0),n.createTextVNode(" "+n.toDisplayString(N.title),1)],8,Sae))),128))])])):n.createCommentVNode("",!0),m.copyright||c.$slots.copyright?(n.openBlock(),n.createElementBlock("div",Cae,[n.renderSlot(c.$slots,"copyright",{},()=>[n.createTextVNode(n.toDisplayString(m.copyright),1)])])):n.createCommentVNode("",!0)])}var e$=l(bae,[["render",Tae]]),jE={exports:{}},Aae=jE.exports={};Aae.forEach=function(c,u){for(var m=0;m<c.length;m++){var S=u(c[m]);if(S)return S}};var Eae=function(c){var u=c.stateHandler.getState;function m(M){var N=u(M);return N&&!!N.isDetectable}function S(M){u(M).isDetectable=!0}function b(M){return!!u(M).busy}function v(M,N){u(M).busy=!!N}return{isDetectable:m,markAsDetectable:S,isBusy:b,markBusy:v}},Mae=function(c){var u={};function m(M){var N=c.get(M);return N===void 0?[]:u[N]||[]}function S(M,N){var X=c.get(M);u[X]||(u[X]=[]),u[X].push(N)}function b(M,N){for(var X=m(M),U=0,H=X.length;U<H;++U)if(X[U]===N){X.splice(U,1);break}}function v(M){var N=m(M);!N||(N.length=0)}return{get:m,add:S,removeListener:b,removeAllListeners:v}},kae=function(){var c=1;function u(){return c++}return{generate:u}},Pae=function(c){var u=c.idGenerator,m=c.stateHandler.getState;function S(v){var M=m(v);return M&&M.id!==void 0?M.id:null}function b(v){var M=m(v);if(!M)throw new Error("setId required the element to have a resize detection state.");var N=u.generate();return M.id=N,N}return{get:S,set:b}},Iae=function(c){function u(){}var m={log:u,warn:u,error:u};if(!c&&window.console){var S=function(b,v){b[v]=function(){var M=console[v];if(M.apply)M.apply(console,arguments);else for(var N=0;N<arguments.length;N++)M(arguments[N])}};S(m,"log"),S(m,"warn"),S(m,"error")}return m},qE={exports:{}},t$=qE.exports={};t$.isIE=function(c){function u(){var S=navigator.userAgent.toLowerCase();return S.indexOf("msie")!==-1||S.indexOf("trident")!==-1||S.indexOf(" edge/")!==-1}if(!u())return!1;if(!c)return!0;var m=function(){var S,b=3,v=document.createElement("div"),M=v.getElementsByTagName("i");do v.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->";while(M[0]);return b>4?b:S}();return c===m},t$.isLegacyOpera=function(){return!!window.opera};var i$={exports:{}},Bae=i$.exports={};Bae.getOption=Rae;function Rae(c,u,m){var S=c[u];return S==null&&m!==void 0?m:S}var n$=i$.exports,Dae=function(c){c=c||{};var u=c.reporter,m=n$.getOption(c,"async",!0),S=n$.getOption(c,"auto",!0);S&&!m&&(u&&u.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),m=!0);var b=s$(),v,M=!1;function N(ye,me){!M&&S&&m&&b.size()===0&&H(),b.add(ye,me)}function X(){for(M=!0;b.size();){var ye=b;b=s$(),ye.process()}M=!1}function U(ye){M||(ye===void 0&&(ye=m),v&&(re(v),v=null),ye?H():X())}function H(){v=xe(X)}function re(ye){var me=clearTimeout;return me(ye)}function xe(ye){var me=function(ne){return setTimeout(ne,0)};return me(ye)}return{add:N,force:U}};function s$(){var c={},u=0,m=0,S=0;function b(N,X){X||(X=N,N=0),N>m?m=N:N<S&&(S=N),c[N]||(c[N]=[]),c[N].push(X),u++}function v(){for(var N=S;N<=m;N++)for(var X=c[N],U=0;U<X.length;U++){var H=X[U];H()}}function M(){return u}return{add:b,process:v,size:M}}var ZE="_erd";function Lae(c){return c[ZE]={},r$(c)}function r$(c){return c[ZE]}function Nae(c){delete c[ZE]}var Vae={initState:Lae,getState:r$,cleanState:Nae},cv=qE.exports,$ae=function(c){c=c||{};var u=c.reporter,m=c.batchProcessor,S=c.stateHandler.getState;if(!u)throw new Error("Missing required dependency: reporter.");function b(U,H){function re(){H(U)}if(cv.isIE(8))S(U).object={proxy:re},U.attachEvent("onresize",re);else{var xe=N(U);if(!xe)throw new Error("Element is not detectable by this strategy.");xe.contentDocument.defaultView.addEventListener("resize",re)}}function v(U){var H=c.important?" !important; ":"; ";return(U.join(H)+H).trim()}function M(U,H,re){re||(re=H,H=U,U=null),U=U||{},U.debug;function xe(ye,me){var ne=v(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),Te=!1,Xt=window.getComputedStyle(ye),_t=ye.offsetWidth,At=ye.offsetHeight;S(ye).startSize={width:_t,height:At};function He(){function ke(){if(Xt.position==="static"){ye.style.setProperty("position","relative",U.important?"important":"");var Jt=function(ei,Rt,Et,Nt){function ai(bt){return bt.replace(/[^-\d\.]/g,"")}var Dt=Et[Nt];Dt!=="auto"&&ai(Dt)!=="0"&&(ei.warn("An element that is positioned static has style."+Nt+"="+Dt+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Nt+" will be set to 0. Element: ",Rt),Rt.style.setProperty(Nt,"0",U.important?"important":""))};Jt(u,ye,Xt,"top"),Jt(u,ye,Xt,"right"),Jt(u,ye,Xt,"bottom"),Jt(u,ye,Xt,"left")}}function it(){Te||ke();function Jt(Rt,Et){if(!Rt.contentDocument){var Nt=S(Rt);Nt.checkForObjectDocumentTimeoutId&&window.clearTimeout(Nt.checkForObjectDocumentTimeoutId),Nt.checkForObjectDocumentTimeoutId=setTimeout(function(){Nt.checkForObjectDocumentTimeoutId=0,Jt(Rt,Et)},100);return}Et(Rt.contentDocument)}var ei=this;Jt(ei,function(Rt){me(ye)})}Xt.position!==""&&(ke(),Te=!0);var qe=document.createElement("object");qe.style.cssText=ne,qe.tabIndex=-1,qe.type="text/html",qe.setAttribute("aria-hidden","true"),qe.onload=it,cv.isIE()||(qe.data="about:blank"),S(ye)&&(ye.appendChild(qe),S(ye).object=qe,cv.isIE()&&(qe.data="about:blank"))}m?m.add(He):He()}cv.isIE(8)?re(H):xe(H,re)}function N(U){return S(U).object}function X(U){if(S(U)){var H=N(U);!H||(cv.isIE(8)?U.detachEvent("onresize",H.proxy):U.removeChild(H),S(U).checkForObjectDocumentTimeoutId&&window.clearTimeout(S(U).checkForObjectDocumentTimeoutId),delete S(U).object)}}return{makeDetectable:M,addListener:b,uninstall:X}},Uae=jE.exports.forEach,Fae=function(c){c=c||{};var u=c.reporter,m=c.batchProcessor,S=c.stateHandler.getState;c.stateHandler.hasState;var b=c.idHandler;if(!m)throw new Error("Missing required dependency: batchProcessor");if(!u)throw new Error("Missing required dependency: reporter.");var v=H(),M="erd_scroll_detection_scrollbar_style",N="erd_scroll_detection_container";function X(He){re(He,M,N)}X(window.document);function U(He){var ke=c.important?" !important; ":"; ";return(He.join(ke)+ke).trim()}function H(){var He=500,ke=500,it=document.createElement("div");it.style.cssText=U(["position: absolute","width: "+He*2+"px","height: "+ke*2+"px","visibility: hidden","margin: 0","padding: 0"]);var qe=document.createElement("div");qe.style.cssText=U(["position: absolute","width: "+He+"px","height: "+ke+"px","overflow: scroll","visibility: none","top: "+-He*3+"px","left: "+-ke*3+"px","visibility: hidden","margin: 0","padding: 0"]),qe.appendChild(it),document.body.insertBefore(qe,document.body.firstChild);var Jt=He-qe.clientWidth,ei=ke-qe.clientHeight;return document.body.removeChild(qe),{width:Jt,height:ei}}function re(He,ke,it){function qe(Et,Nt){Nt=Nt||function(Dt){He.head.appendChild(Dt)};var ai=He.createElement("style");return ai.innerHTML=Et,ai.id=ke,Nt(ai),ai}if(!He.getElementById(ke)){var Jt=it+"_animation",ei=it+"_animation_active",Rt=`/* Created by the element-resize-detector library. */
`;Rt+="."+it+" > div::-webkit-scrollbar { "+U(["display: none"])+` }

`,Rt+="."+ei+" { "+U(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+Jt,"animation-name: "+Jt])+` }
`,Rt+="@-webkit-keyframes "+Jt+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,Rt+="@keyframes "+Jt+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",qe(Rt)}}function xe(He){He.className+=" "+N+"_animation_active"}function ye(He,ke,it){if(He.addEventListener)He.addEventListener(ke,it);else if(He.attachEvent)He.attachEvent("on"+ke,it);else return u.error("[scroll] Don't know how to add event listeners.")}function me(He,ke,it){if(He.removeEventListener)He.removeEventListener(ke,it);else if(He.detachEvent)He.detachEvent("on"+ke,it);else return u.error("[scroll] Don't know how to remove event listeners.")}function ne(He){return S(He).container.childNodes[0].childNodes[0].childNodes[0]}function Te(He){return S(He).container.childNodes[0].childNodes[0].childNodes[1]}function Xt(He,ke){var it=S(He).listeners;if(!it.push)throw new Error("Cannot add listener to an element that is not detectable.");S(He).listeners.push(ke)}function _t(He,ke,it){it||(it=ke,ke=He,He=null),He=He||{};function qe(){if(He.debug){var It=Array.prototype.slice.call(arguments);if(It.unshift(b.get(ke),"Scroll: "),u.log.apply)u.log.apply(null,It);else for(var gi=0;gi<It.length;gi++)u.log(It[gi])}}function Jt(It){function gi(Zi){var mr=Zi.getRootNode&&Zi.getRootNode().contains(Zi);return Zi===Zi.ownerDocument.body||Zi.ownerDocument.body.contains(Zi)||mr}return!gi(It)||window.getComputedStyle(It)===null}function ei(It){var gi=S(It).container.childNodes[0],Zi=window.getComputedStyle(gi);return!Zi.width||Zi.width.indexOf("px")===-1}function Rt(){var It=window.getComputedStyle(ke),gi={};return gi.position=It.position,gi.width=ke.offsetWidth,gi.height=ke.offsetHeight,gi.top=It.top,gi.right=It.right,gi.bottom=It.bottom,gi.left=It.left,gi.widthCSS=It.width,gi.heightCSS=It.height,gi}function Et(){var It=Rt();S(ke).startSize={width:It.width,height:It.height},qe("Element start size",S(ke).startSize)}function Nt(){S(ke).listeners=[]}function ai(){if(qe("storeStyle invoked."),!S(ke)){qe("Aborting because element has been uninstalled");return}var It=Rt();S(ke).style=It}function Dt(It,gi,Zi){S(It).lastWidth=gi,S(It).lastHeight=Zi}function bt(It){return ne(It).childNodes[0]}function ut(){return 2*v.width+1}function Vt(){return 2*v.height+1}function Ct(It){return It+10+ut()}function vi(It){return It+10+Vt()}function Ci(It){return It*2+ut()}function _n(It){return It*2+Vt()}function Nn(It,gi,Zi){var mr=ne(It),fo=Te(It),wh=Ct(gi),ju=vi(Zi),po=Ci(gi),Cn=_n(Zi);mr.scrollLeft=wh,mr.scrollTop=ju,fo.scrollLeft=po,fo.scrollTop=Cn}function ss(){var It=S(ke).container;if(!It){It=document.createElement("div"),It.className=N,It.style.cssText=U(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),S(ke).container=It,xe(It),ke.appendChild(It);var gi=function(){S(ke).onRendered&&S(ke).onRendered()};ye(It,"animationstart",gi),S(ke).onAnimationStart=gi}return It}function fs(){function It(){var Ls=S(ke).style;if(Ls.position==="static"){ke.style.setProperty("position","relative",He.important?"important":"");var El=function(Oh,Ml,Uw,qu){function AM(EM){return EM.replace(/[^-\d\.]/g,"")}var Cv=Uw[qu];Cv!=="auto"&&AM(Cv)!=="0"&&(Oh.warn("An element that is positioned static has style."+qu+"="+Cv+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+qu+" will be set to 0. Element: ",Ml),Ml.style[qu]=0)};El(u,ke,Ls,"top"),El(u,ke,Ls,"right"),El(u,ke,Ls,"bottom"),El(u,ke,Ls,"left")}}function gi(Ls,El,Oh,Ml){return Ls=Ls?Ls+"px":"0",El=El?El+"px":"0",Oh=Oh?Oh+"px":"0",Ml=Ml?Ml+"px":"0",["left: "+Ls,"top: "+El,"right: "+Ml,"bottom: "+Oh]}if(qe("Injecting elements"),!S(ke)){qe("Aborting because element has been uninstalled");return}It();var Zi=S(ke).container;Zi||(Zi=ss());var mr=v.width,fo=v.height,wh=U(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),ju=U(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(gi(-(1+mr),-(1+fo),-fo,-mr))),po=U(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Cn=U(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Bo=U(["position: absolute","left: 0","top: 0"]),Tl=U(["position: absolute","width: 200%","height: 200%"]),pa=document.createElement("div"),Al=document.createElement("div"),ig=document.createElement("div"),Nw=document.createElement("div"),ng=document.createElement("div"),Vw=document.createElement("div");pa.dir="ltr",pa.style.cssText=wh,pa.className=N,Al.className=N,Al.style.cssText=ju,ig.style.cssText=po,Nw.style.cssText=Bo,ng.style.cssText=Cn,Vw.style.cssText=Tl,ig.appendChild(Nw),ng.appendChild(Vw),Al.appendChild(ig),Al.appendChild(ng),pa.appendChild(Al),Zi.appendChild(pa);function $w(){var Ls=S(ke);Ls&&Ls.onExpand?Ls.onExpand():qe("Aborting expand scroll handler: element has been uninstalled")}function Sv(){var Ls=S(ke);Ls&&Ls.onShrink?Ls.onShrink():qe("Aborting shrink scroll handler: element has been uninstalled")}ye(ig,"scroll",$w),ye(ng,"scroll",Sv),S(ke).onExpandScroll=$w,S(ke).onShrinkScroll=Sv}function Cr(){function It(po,Cn,Bo){var Tl=bt(po),pa=Ct(Cn),Al=vi(Bo);Tl.style.setProperty("width",pa+"px",He.important?"important":""),Tl.style.setProperty("height",Al+"px",He.important?"important":"")}function gi(po){var Cn=ke.offsetWidth,Bo=ke.offsetHeight,Tl=Cn!==S(ke).lastWidth||Bo!==S(ke).lastHeight;qe("Storing current size",Cn,Bo),Dt(ke,Cn,Bo),m.add(0,function(){if(Tl){if(!S(ke)){qe("Aborting because element has been uninstalled");return}if(!Zi()){qe("Aborting because element container has not been initialized");return}if(He.debug){var pa=ke.offsetWidth,Al=ke.offsetHeight;(pa!==Cn||Al!==Bo)&&u.warn(b.get(ke),"Scroll: Size changed before updating detector elements.")}It(ke,Cn,Bo)}}),m.add(1,function(){if(!S(ke)){qe("Aborting because element has been uninstalled");return}if(!Zi()){qe("Aborting because element container has not been initialized");return}Nn(ke,Cn,Bo)}),Tl&&po&&m.add(2,function(){if(!S(ke)){qe("Aborting because element has been uninstalled");return}if(!Zi()){qe("Aborting because element container has not been initialized");return}po()})}function Zi(){return!!S(ke).container}function mr(){function po(){return S(ke).lastNotifiedWidth===void 0}qe("notifyListenersIfNeeded invoked");var Cn=S(ke);if(po()&&Cn.lastWidth===Cn.startSize.width&&Cn.lastHeight===Cn.startSize.height)return qe("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(Cn.lastWidth===Cn.lastNotifiedWidth&&Cn.lastHeight===Cn.lastNotifiedHeight)return qe("Not notifying: Size already notified");qe("Current size not notified, notifying..."),Cn.lastNotifiedWidth=Cn.lastWidth,Cn.lastNotifiedHeight=Cn.lastHeight,Uae(S(ke).listeners,function(Bo){Bo(ke)})}function fo(){if(qe("startanimation triggered."),ei(ke)){qe("Ignoring since element is still unrendered...");return}qe("Element rendered.");var po=ne(ke),Cn=Te(ke);(po.scrollLeft===0||po.scrollTop===0||Cn.scrollLeft===0||Cn.scrollTop===0)&&(qe("Scrollbars out of sync. Updating detector elements..."),gi(mr))}function wh(){if(qe("Scroll detected."),ei(ke)){qe("Scroll event fired while unrendered. Ignoring...");return}gi(mr)}if(qe("registerListenersAndPositionElements invoked."),!S(ke)){qe("Aborting because element has been uninstalled");return}S(ke).onRendered=fo,S(ke).onExpand=wh,S(ke).onShrink=wh;var ju=S(ke).style;It(ke,ju.width,ju.height)}function Io(){if(qe("finalizeDomMutation invoked."),!S(ke)){qe("Aborting because element has been uninstalled");return}var It=S(ke).style;Dt(ke,It.width,It.height),Nn(ke,It.width,It.height)}function Sl(){it(ke)}function Cl(){qe("Installing..."),Nt(),Et(),m.add(0,ai),m.add(1,fs),m.add(2,Cr),m.add(3,Io),m.add(4,Sl)}qe("Making detectable..."),Jt(ke)?(qe("Element is detached"),ss(),qe("Waiting until element is attached..."),S(ke).onRendered=function(){qe("Element is now attached"),Cl()}):Cl()}function At(He){var ke=S(He);!ke||(ke.onExpandScroll&&me(ne(He),"scroll",ke.onExpandScroll),ke.onShrinkScroll&&me(Te(He),"scroll",ke.onShrinkScroll),ke.onAnimationStart&&me(ke.container,"animationstart",ke.onAnimationStart),ke.container&&He.removeChild(ke.container))}return{makeDetectable:_t,addListener:Xt,uninstall:At,initDocument:X}},hv=jE.exports.forEach,zae=Eae,Xae=Mae,Wae=kae,Hae=Pae,Gae=Iae,o$=qE.exports,Qae=Dae,$u=Vae,Yae=$ae,jae=Fae;function a$(c){return Array.isArray(c)||c.length!==void 0}function l$(c){if(Array.isArray(c))return c;var u=[];return hv(c,function(m){u.push(m)}),u}function c$(c){return c&&c.nodeType===1}var qm=function(c){c=c||{};var u;if(c.idHandler)u={get:function(_t){return c.idHandler.get(_t,!0)},set:c.idHandler.set};else{var m=Wae(),S=Hae({idGenerator:m,stateHandler:$u});u=S}var b=c.reporter;if(!b){var v=b===!1;b=Gae(v)}var M=Uu(c,"batchProcessor",Qae({reporter:b})),N={};N.callOnAdd=!!Uu(c,"callOnAdd",!0),N.debug=!!Uu(c,"debug",!1);var X=Xae(u),U=zae({stateHandler:$u}),H,re=Uu(c,"strategy","object"),xe=Uu(c,"important",!1),ye={reporter:b,batchProcessor:M,stateHandler:$u,idHandler:u,important:xe};if(re==="scroll"&&(o$.isLegacyOpera()?(b.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),re="object"):o$.isIE(9)&&(b.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),re="object")),re==="scroll")H=jae(ye);else if(re==="object")H=Yae(ye);else throw new Error("Invalid strategy name: "+re);var me={};function ne(_t,At,He){function ke(Et){var Nt=X.get(Et);hv(Nt,function(ai){ai(Et)})}function it(Et,Nt,ai){X.add(Nt,ai),Et&&ai(Nt)}if(He||(He=At,At=_t,_t={}),!At)throw new Error("At least one element required.");if(!He)throw new Error("Listener required.");if(c$(At))At=[At];else if(a$(At))At=l$(At);else return b.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var qe=0,Jt=Uu(_t,"callOnAdd",N.callOnAdd),ei=Uu(_t,"onReady",function(){}),Rt=Uu(_t,"debug",N.debug);hv(At,function(Et){$u.getState(Et)||($u.initState(Et),u.set(Et));var Nt=u.get(Et);if(Rt&&b.log("Attaching listener to element",Nt,Et),!U.isDetectable(Et)){if(Rt&&b.log(Nt,"Not detectable."),U.isBusy(Et)){Rt&&b.log(Nt,"System busy making it detectable"),it(Jt,Et,He),me[Nt]=me[Nt]||[],me[Nt].push(function(){qe++,qe===At.length&&ei()});return}return Rt&&b.log(Nt,"Making detectable..."),U.markBusy(Et,!0),H.makeDetectable({debug:Rt,important:xe},Et,function(ai){if(Rt&&b.log(Nt,"onElementDetectable"),$u.getState(ai)){U.markAsDetectable(ai),U.markBusy(ai,!1),H.addListener(ai,ke),it(Jt,ai,He);var Dt=$u.getState(ai);if(Dt&&Dt.startSize){var bt=ai.offsetWidth,ut=ai.offsetHeight;(Dt.startSize.width!==bt||Dt.startSize.height!==ut)&&ke(ai)}me[Nt]&&hv(me[Nt],function(Vt){Vt()})}else Rt&&b.log(Nt,"Element uninstalled before being detectable.");delete me[Nt],qe++,qe===At.length&&ei()})}Rt&&b.log(Nt,"Already detecable, adding listener."),it(Jt,Et,He),qe++}),qe===At.length&&ei()}function Te(_t){if(!_t)return b.error("At least one element is required.");if(c$(_t))_t=[_t];else if(a$(_t))_t=l$(_t);else return b.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");hv(_t,function(At){X.removeAllListeners(At),H.uninstall(At),$u.cleanState(At)})}function Xt(_t){H.initDocument&&H.initDocument(_t)}return{listenTo:ne,removeListener:X.removeListener,removeAllListeners:X.removeAllListeners,uninstall:Te,initDocument:Xt}};function Uu(c,u,m){var S=c[u];return S==null&&m!==void 0?m:S}var h$="Expected a function",u$=NaN,qae="[object Symbol]",Zae=/^\s+|\s+$/g,Kae=/^[-+]0x[0-9a-f]+$/i,Jae=/^0b[01]+$/i,ele=/^0o[0-7]+$/i,tle=parseInt,ile=typeof Z=="object"&&Z&&Z.Object===Object&&Z,nle=typeof self=="object"&&self&&self.Object===Object&&self,sle=ile||nle||Function("return this")(),rle=Object.prototype,ole=rle.toString,ale=Math.max,lle=Math.min,KE=function(){return sle.Date.now()};function cle(c,u,m){var S,b,v,M,N,X,U=0,H=!1,re=!1,xe=!0;if(typeof c!="function")throw new TypeError(h$);u=d$(u)||0,ww(m)&&(H=!!m.leading,re="maxWait"in m,v=re?ale(d$(m.maxWait)||0,u):v,xe="trailing"in m?!!m.trailing:xe);function ye(it){var qe=S,Jt=b;return S=b=void 0,U=it,M=c.apply(Jt,qe),M}function me(it){return U=it,N=setTimeout(Xt,u),H?ye(it):M}function ne(it){var qe=it-X,Jt=it-U,ei=u-qe;return re?lle(ei,v-Jt):ei}function Te(it){var qe=it-X,Jt=it-U;return X===void 0||qe>=u||qe<0||re&&Jt>=v}function Xt(){var it=KE();if(Te(it))return _t(it);N=setTimeout(Xt,ne(it))}function _t(it){return N=void 0,xe&&S?ye(it):(S=b=void 0,M)}function At(){N!==void 0&&clearTimeout(N),U=0,S=X=b=N=void 0}function He(){return N===void 0?M:_t(KE())}function ke(){var it=KE(),qe=Te(it);if(S=arguments,b=this,X=it,qe){if(N===void 0)return me(X);if(re)return N=setTimeout(Xt,u),ye(X)}return N===void 0&&(N=setTimeout(Xt,u)),M}return ke.cancel=At,ke.flush=He,ke}function hle(c,u,m){var S=!0,b=!0;if(typeof c!="function")throw new TypeError(h$);return ww(m)&&(S="leading"in m?!!m.leading:S,b="trailing"in m?!!m.trailing:b),cle(c,u,{leading:S,maxWait:u,trailing:b})}function ww(c){var u=typeof c;return!!c&&(u=="object"||u=="function")}function ule(c){return!!c&&typeof c=="object"}function dle(c){return typeof c=="symbol"||ule(c)&&ole.call(c)==qae}function d$(c){if(typeof c=="number")return c;if(dle(c))return u$;if(ww(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=ww(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=c.replace(Zae,"");var m=Jae.test(c);return m||ele.test(c)?tle(c.slice(2),m?2:8):Kae.test(c)?u$:+c}var Ow=hle;const fle={name:"Grid",provide(){return{GridInstance:this}},props:{col:{type:Number,default:3},square:{type:Boolean,default:!1},padding:{type:String,default:"24px"},center:{type:Boolean,default:!1},border:{type:Boolean,default:!0},hover:{type:Boolean,default:!1}},data(){return{resizeCount:0,handleResize:()=>{}}},computed:{classes(){return{"ivu-grid-center":this.center,"ivu-grid-border":this.border,"ivu-grid-hover":this.hover}}},methods:{onResize(){this.resizeCount++}},mounted(){this.handleResize=Ow(this.onResize,150,{leading:!1}),this.observer=qm(),this.observer.listenTo(this.$refs.grid,this.handleResize)},beforeUnmount(){this.observer.removeListener(this.$refs.grid,this.handleResize)}};function ple(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["ivu-grid",v.classes]),ref:"grid"},[n.renderSlot(c.$slots,"default")],2)}var f$=l(fle,[["render",ple]]);const mle={name:"GridItem",inject:["GridInstance"],data(){return{height:0}},computed:{col(){return this.GridInstance.col},square(){return this.GridInstance.square},styles(){const c={width:`${100/this.col}%`};return this.height&&this.square&&(c.height=`${this.height}px`),c},mainStyles(){return{padding:this.GridInstance.padding}}},watch:{col(){n.nextTick(()=>{this.handleChangeHeight()})},square(){this.handleChangeHeight()},"GridInstance.resizeCount"(){this.handleChangeHeight()}},methods:{handleChangeHeight(){if(this.square){const c=this.$refs.col;this.height=parseFloat(k(c,"width"))}}},mounted(){this.handleChangeHeight()}};function gle(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:"ivu-grid-item",style:n.normalizeStyle(v.styles),ref:"col"},[n.createElementVNode("div",{class:"ivu-grid-item-main",style:n.normalizeStyle(v.mainStyles)},[n.renderSlot(c.$slots,"default")],4)],4)}var p$=l(mle,[["render",gle]]);const yle="ivu-layout",vle={name:"Header",computed:{wrapClasses(){return`${yle}-header`}}};function xle(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses)},[n.renderSlot(c.$slots,"default")],2)}var JE=l(vle,[["render",xle]]);const jt={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent(c){const{keyCode:u}=c;if(c.altKey&&!c.ctrlKey||c.metaKey||u>=jt.F1&&u<=jt.F12)return!1;switch(u){case jt.ALT:case jt.CAPS_LOCK:case jt.CONTEXT_MENU:case jt.CTRL:case jt.DOWN:case jt.END:case jt.ESC:case jt.HOME:case jt.INSERT:case jt.LEFT:case jt.MAC_FF_META:case jt.META:case jt.NUMLOCK:case jt.NUM_CENTER:case jt.PAGE_DOWN:case jt.PAGE_UP:case jt.PAUSE:case jt.PRINT_SCREEN:case jt.RIGHT:case jt.SHIFT:case jt.UP:case jt.WIN_KEY:case jt.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey(c){if(c>=jt.ZERO&&c<=jt.NINE||c>=jt.NUM_ZERO&&c<=jt.NUM_MULTIPLY||c>=jt.A&&c<=jt.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&c===0)return!0;switch(c){case jt.SPACE:case jt.QUESTION_MARK:case jt.NUM_PLUS:case jt.NUM_MINUS:case jt.NUM_PERIOD:case jt.NUM_DIVISION:case jt.SEMICOLON:case jt.DASH:case jt.EQUALS:case jt.COMMA:case jt.PERIOD:case jt.SLASH:case jt.APOSTROPHE:case jt.SINGLE_QUOTE:case jt.OPEN_SQUARE_BRACKET:case jt.BACKSLASH:case jt.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Fu="ivu-spin",_le={name:"Spin",mixins:[QE],props:{size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},fix:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},data(){return{showText:!1,visible:!1}},computed:{classes(){return[`${Fu}`,{[`${Fu}-${this.size}`]:!!this.size,[`${Fu}-fix`]:this.fix,[`${Fu}-show-text`]:this.showText,[`${Fu}-fullscreen`]:this.fullscreen}]},mainClasses(){return`${Fu}-main`},dotClasses(){return`${Fu}-dot`},textClasses(){return`${Fu}-text`},fullscreenVisible(){return this.fullscreen?this.visible:!0}},watch:{visible(c){c?this.addScrollEffect():this.removeScrollEffect()}},mounted(){this.showText=!!this.$slots.default&&this.$slots.default().some(c=>c.children&&c.children.length)}};function ble(c,u,m,S,b,v){return n.openBlock(),n.createBlock(n.Transition,{name:"fade"},{default:n.withCtx(()=>[v.fullscreenVisible&&m.show?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.classes)},[n.createElementVNode("div",{class:n.normalizeClass(v.mainClasses)},[n.createElementVNode("span",{class:n.normalizeClass(v.dotClasses)},null,2),n.createElementVNode("div",{class:n.normalizeClass(v.textClasses)},[n.renderSlot(c.$slots,"default")],2)],2)],2)):n.createCommentVNode("",!0)]),_:3})}var da=l(_le,[["render",ble]]);const wle={name:"ImagePreview",mixins:[Sn],components:{Icon:O,Spin:da,Row:Du,Col:pc},inheritAttrs:!1,emits:["update:modelValue","on-close","on-switch"],props:{modelValue:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},maskClosable:{type:Boolean,default:!0},previewList:{type:Array,default(){return[]}},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},toolbar:{type:Array,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||!c.$VIEWUI.image||c.$VIEWUI.image.toolbar===""?["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"]:c.$VIEWUI.image.toolbar}}},data(){return{currentIndex:0,scale:1,degree:0,translate:{x:0,y:0},startX:0,startY:0,transition:!0,original:!1,prevOverflow:"",status:"loading",zIndex:1e3,maskIndex:this.getMaskIndex(),downloading:!1}},computed:{imgClasses(){return["ivu-image-preview-image",{"ivu-image-preview-grabbing":!this.transition,"ivu-image-preview-hidden":this.status==="failed","ivu-image-preview-transition":this.transition,"ivu-image-preview-limit":!this.original}]},imageStyle(){let c=this.translate.x/this.scale,u=this.translate.y/this.scale;const m=this.degree%360;return[90,-270].includes(m)&&([c,u]=[u,-c]),[180,-180].includes(m)&&([c,u]=[-c,-u]),[270,-90].includes(m)&&([c,u]=[-u,c]),{transform:`
                        scale(${this.scale})
                        rotate(${this.degree}deg)
                        translate(${c}px, ${u}px)
                    `}},maskStyle(){return{zIndex:this.maskIndex+this.zIndex}},leftClasses(){return["ivu-image-preview-arrow-left",{"ivu-image-preview-arrow-disabled":this.hasLeftSwitchEnd}]},rightClasses(){return["ivu-image-preview-arrow-right",{"ivu-image-preview-arrow-disabled":this.hasRightSwitchEnd}]},hasRightSwitchEnd(){const{currentIndex:c,infinite:u,previewList:m}=this,S=m.length;return u?!1:c>=S-1},hasLeftSwitchEnd(){const{currentIndex:c,infinite:u}=this;return u?!1:c===0},currentSrc(){return this.previewList[this.currentIndex]},failLang(){return this.t("i.image.fail")}},methods:{resetStyle(){this.scale=1,this.degree=0,this.translate.x=0,this.translate.y=0},handleClose(){this.$emit("update:modelValue",!1),this.$emit("on-close")},handleClickMask(){!this.maskClosable||this.handleClose()},handleSwitch(c){c?this.currentIndex+1===this.previewList.length?this.infinite&&(this.resetStyle(),this.currentIndex=0):(this.resetStyle(),this.currentIndex+=1):this.currentIndex===0?this.infinite&&(this.resetStyle(),this.currentIndex=this.previewList.length-1):(this.resetStyle(),this.currentIndex-=1),this.$emit("on-switch",{currentIndex:this.currentIndex})},handleOperation(c){c==="zoomIn"&&this.scale<6&&(this.scale+=.25),c==="zoomOut"&&this.scale>.25&&(this.scale-=.25),c==="rotateLeft"&&(this.degree-=90),c==="rotateRight"&&(this.degree+=90),c==="original"&&(this.original=!this.original,this.transition=!1,this.resetStyle(),setTimeout(()=>{this.transition=!0},0)),c==="download"&&(this.downloading=!0,tt(this.previewList[this.currentIndex]).then(()=>{this.downloading=!1}).catch(()=>{this.downloading=!1}))},handleKeydown(c){if(!this.modelValue)return;const{keyCode:u}=c;u===jt.LEFT&&this.handleSwitch(!1),u===jt.RIGHT&&this.handleSwitch(!0),u===jt.UP&&this.handleOperation("zoomIn"),u===jt.DOWN&&this.handleOperation("zoomOut"),u===jt.SPACE&&(c.preventDefault(),this.original=!this.original)},handleKeyup(c){if(!this.modelValue)return;const{keyCode:u}=c;u===jt.ESC&&this.handleClose()},handleWheel(c){if(!this.modelValue)return;const{deltaY:u}=c;this.handleOperation(u<0?"zoomIn":"zoomOut")},handleMousedown(c){const{pageX:u,pageY:m,which:S}=c;S===1&&(this.startX=u,this.startY=m,this.transition=!1,o(document,"mousemove",this.handleMousemove),o(document,"mouseup",this.handleMouseup))},handleMousemove:Ow(function(c){c.stopPropagation();const{pageX:u,pageY:m}=c;this.translate.x+=u-this.startX,this.translate.y+=m-this.startY,this.startX=u,this.startY=m}),handleMouseup(){this.transition=!0,a(document,"mousemove",this.handleMousemove),a(document,"mouseup",this.handleMouseup)},getBodyOverflow(){return r?document.body.style.overflow:""},setBodyOverflow(c){!r||(document.body.style.overflow=c)},handleImageLoad(){this.status="loaded"},handleImageError(){this.status="failed"},getMaskIndex(){return je(),Oe}},watch:{modelValue(c){c?(this.currentIndex=this.initialIndex,this.resetStyle(),this.original=!1,this.prevOverflow=this.getBodyOverflow(),this.setBodyOverflow("hidden"),this.maskIndex=this.getMaskIndex()):this.setBodyOverflow(this.prevOverflow)},currentIndex(){this.status="loading"}},mounted(){o(document,"keydown",this.handleKeydown),o(document,"keyup",this.handleKeyup),o(document,"wheel",this.handleWheel)},beforeUnmount(){a(document,"keydown",this.handleKeydown),a(document,"keyup",this.handleKeyup),a(document,"wheel",this.handleWheel)}},Ole={key:1,class:"ivu-image-preview-fail"},Sle=["src"],Cle=[n.createElementVNode("path",{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z","p-id":"7198",fill:"#ffffff"},null,-1),n.createElementVNode("path",{d:"M921 867L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z","p-id":"7199",fill:"#ffffff"},null,-1)],Tle=[n.createElementVNode("path",{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z","p-id":"7413",fill:"#ffffff"},null,-1),n.createElementVNode("path",{d:"M921 867L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z","p-id":"7414",fill:"#ffffff"},null,-1)],Ale=[n.createElementVNode("path",{d:"M358.058667 128H156.970667A28.970667 28.970667 0 0 0 128 157.013333v202.837334c0 7.978667 6.528 14.506667 14.506667 14.506666h43.434666a14.506667 14.506667 0 0 0 14.506667-14.506666V200.448h157.610667a14.506667 14.506667 0 0 0 14.506666-14.506667V142.506667a14.506667 14.506667 0 0 0-14.506666-14.506667zM881.493333 649.642667h-43.434666a14.506667 14.506667 0 0 0-14.506667 14.506666v159.402667h-157.610667a14.506667 14.506667 0 0 0-14.506666 14.506667v43.434666c0 7.978667 6.570667 14.506667 14.506666 14.506667h201.088c16 0 28.970667-12.928 28.970667-29.013333v-202.837334a14.506667 14.506667 0 0 0-14.506667-14.506666zM358.058667 823.552H200.448v-159.402667a14.506667 14.506667 0 0 0-14.506667-14.506666H142.506667a14.506667 14.506667 0 0 0-14.506667 14.506666v202.88c0 16 12.970667 28.970667 29.013333 28.970667h201.045334a14.506667 14.506667 0 0 0 14.506666-14.506667v-43.434666a14.506667 14.506667 0 0 0-14.506666-14.506667zM866.986667 128h-201.088a14.506667 14.506667 0 0 0-14.506667 14.506667v43.434666c0 7.978667 6.570667 14.506667 14.506667 14.506667h157.610666v159.402667c0 7.978667 6.528 14.506667 14.506667 14.506666h43.434667a14.506667 14.506667 0 0 0 14.506666-14.506666V156.970667A28.928 28.928 0 0 0 866.986667 128z","p-id":"26673",fill:"#ffffff"},null,-1)],Ele=[n.createElementVNode("path",{d:"M864 128H160c-19.2 0-32 12.8-32 32v704c0 19.2 12.8 32 32 32h704c19.2 0 32-12.8 32-32V160c0-19.2-12.8-32-32-32z m-32 704H192V192h640v640z","p-id":"1977",fill:"#ffffff"},null,-1),n.createElementVNode("path",{d:"M320 384v288c0 19.2 12.8 32 32 32s32-12.8 32-32V352c0-19.2-12.8-32-32-32h-32c-19.2 0-32 12.8-32 32s12.8 32 32 32zM640 384v288c0 19.2 12.8 32 32 32s32-12.8 32-32V352c0-19.2-12.8-32-32-32h-32c-19.2 0-32 12.8-32 32s12.8 32 32 32z","p-id":"1978",fill:"#ffffff"},null,-1),n.createElementVNode("path",{d:"M512 384m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z","p-id":"1979",fill:"#ffffff"},null,-1),n.createElementVNode("path",{d:"M512 640m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z","p-id":"1980",fill:"#ffffff"},null,-1)],Mle=[n.createElementVNode("path",{d:"M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32z m-44 402H188V494h440v326z m191.3-491.5c-78.8-100.7-196-153.6-314.6-154.2l-0.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7 0.4 12.6-6.1v-63.9c12.9 0.1 25.9 0.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8 11 40.7 14 82.7 8.9 124.8-0.7 5.4-1.4 10.8-2.4 16.1h74.9c14.8-103.6-11.3-213-81-302.3z","p-id":"13309",fill:"#ffffff"},null,-1)],kle=[n.createElementVNode("path",{d:"M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-0.4-12.6 6.1l-0.2 64c-118.6 0.5-235.8 53.4-314.6 154.2-69.6 89.2-95.7 198.6-81.1 302.4h74.9c-0.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8zM880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32z m-44 402H396V494h440v326z","p-id":"13522",fill:"#ffffff"},null,-1)],Ple=[n.createElementVNode("path",{d:"M505.7 621c3.2 4.1 9.4 4.1 12.6 0l112-141.7c4.1-5.2 0.4-12.9-6.3-12.9h-72.1V120c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v346.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z","p-id":"8826",fill:"#ffffff"},null,-1),n.createElementVNode("path",{d:"M903 516h-64c-4.4 0-8 3.6-8 8v300c0 4.4-3.6 8-8 8H199c-4.4 0-8-3.6-8-8V524c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v372c0 8.8 7.2 16 16 16h768c8.8 0 16-7.2 16-16V524c0-4.4-3.6-8-8-8z","p-id":"8827",fill:"#ffffff"},null,-1)],Ile={class:"ivu-image-preview-operations-item ivu-image-preview-operations-wait ivu-anim-loop",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7816",width:"200",height:"200"},Ble=[n.createElementVNode("path",{d:"M512 64c247.2 0 448 200.8 448 448h-64c0-212-172-384-384-384V64z m0 832c-212 0-384-172-384-384H64c0 247.2 200.8 448 448 448v-64z","p-id":"7817",fill:"#ffffff"},null,-1)];function Rle(c,u,m,S,b,v){const M=n.resolveComponent("Spin"),N=n.resolveComponent("Col"),X=n.resolveComponent("Row"),U=n.resolveComponent("Icon");return n.openBlock(),n.createBlock(n.Teleport,{to:"body",disabled:!m.transfer},[n.createVNode(n.Transition,{name:"fade"},{default:n.withCtx(()=>[m.modelValue?(n.openBlock(),n.createElementBlock("div",{key:0,class:"ivu-image-preview-mask",style:n.normalizeStyle(v.maskStyle)},null,4)):n.createCommentVNode("",!0)]),_:1}),n.createVNode(n.Transition,{name:"fade"},{default:n.withCtx(()=>[m.modelValue?(n.openBlock(),n.createElementBlock("div",{key:0,class:"ivu-image-preview-wrap",style:n.normalizeStyle(v.maskStyle)},[n.createElementVNode("div",n.mergeProps({class:"ivu-image-preview"},c.$attrs,{onClick:u[14]||(u[14]=n.withModifiers((...H)=>v.handleClickMask&&v.handleClickMask(...H),["stop"]))}),[b.status==="loading"?(n.openBlock(),n.createBlock(M,{key:0,size:"large",class:"ivu-image-preview-loading"})):b.status==="failed"?(n.openBlock(),n.createElementBlock("div",Ole,[n.createElementVNode("span",null,n.toDisplayString(v.failLang),1)])):n.createCommentVNode("",!0),(n.openBlock(),n.createElementBlock("img",{class:n.normalizeClass(v.imgClasses),style:n.normalizeStyle(v.imageStyle),src:v.currentSrc,key:b.currentIndex.toString(),onClick:u[0]||(u[0]=n.withModifiers(()=>{},["stop"])),onMousedown:u[1]||(u[1]=n.withModifiers((...H)=>v.handleMousedown&&v.handleMousedown(...H),["stop","prevent"])),onLoad:u[2]||(u[2]=(...H)=>v.handleImageLoad&&v.handleImageLoad(...H)),onError:u[3]||(u[3]=(...H)=>v.handleImageError&&v.handleImageError(...H))},null,46,Sle)),m.toolbar&&m.toolbar.length>0?(n.openBlock(),n.createBlock(X,{key:2,"class-name":"ivu-image-preview-operations",wrap:!1,onClick:u[11]||(u[11]=n.withModifiers(()=>{},["stop"]))},{default:n.withCtx(()=>[m.toolbar.indexOf("zoomIn")>-1?(n.openBlock(),n.createBlock(N,{key:0,flex:"1",order:m.toolbar.indexOf("zoomIn")+1},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:u[4]||(u[4]=n.withModifiers(H=>v.handleOperation("zoomIn"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7197",width:"200",height:"200"},Cle))]),_:1},8,["order"])):n.createCommentVNode("",!0),m.toolbar.indexOf("zoomOut")>-1?(n.openBlock(),n.createBlock(N,{key:1,flex:"1",order:m.toolbar.indexOf("zoomOut")+1},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:u[5]||(u[5]=n.withModifiers(H=>v.handleOperation("zoomOut"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7412",width:"200",height:"200"},Tle))]),_:1},8,["order"])):n.createCommentVNode("",!0),m.toolbar.indexOf("original")>-1?(n.openBlock(),n.createBlock(N,{key:2,flex:"1",order:m.toolbar.indexOf("original")+1},{default:n.withCtx(()=>[n.withDirectives((n.openBlock(),n.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:u[6]||(u[6]=n.withModifiers(H=>v.handleOperation("original"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"26672",width:"200",height:"200"},Ale,512)),[[n.vShow,!this.original]]),n.withDirectives((n.openBlock(),n.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:u[7]||(u[7]=n.withModifiers(H=>v.handleOperation("original"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1976",width:"200",height:"200"},Ele,512)),[[n.vShow,this.original]])]),_:1},8,["order"])):n.createCommentVNode("",!0),m.toolbar.indexOf("rotateLeft")>-1?(n.openBlock(),n.createBlock(N,{key:3,flex:"1",order:m.toolbar.indexOf("rotateLeft")+1},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:u[8]||(u[8]=n.withModifiers(H=>v.handleOperation("rotateLeft"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13308",width:"200",height:"200"},Mle))]),_:1},8,["order"])):n.createCommentVNode("",!0),m.toolbar.indexOf("rotateRight")>-1?(n.openBlock(),n.createBlock(N,{key:4,flex:"1",order:m.toolbar.indexOf("rotateRight")+1},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:u[9]||(u[9]=n.withModifiers(H=>v.handleOperation("rotateRight"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13521",width:"200",height:"200"},kle))]),_:1},8,["order"])):n.createCommentVNode("",!0),m.toolbar.indexOf("download")>-1?(n.openBlock(),n.createBlock(N,{key:5,flex:"1",order:m.toolbar.indexOf("download")+1},{default:n.withCtx(()=>[n.withDirectives((n.openBlock(),n.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:u[10]||(u[10]=n.withModifiers(H=>v.handleOperation("download"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8825",width:"200",height:"200"},Ple,512)),[[n.vShow,!b.downloading]]),n.withDirectives((n.openBlock(),n.createElementBlock("svg",Ile,Ble,512)),[[n.vShow,b.downloading]])]),_:1},8,["order"])):n.createCommentVNode("",!0)]),_:1})):n.createCommentVNode("",!0),m.previewList.length>1?(n.openBlock(),n.createBlock(U,{key:3,class:n.normalizeClass(v.leftClasses),type:"ios-arrow-back",onClick:u[12]||(u[12]=n.withModifiers(H=>v.handleSwitch(!1),["stop"]))},null,8,["class"])):n.createCommentVNode("",!0),m.previewList.length>1?(n.openBlock(),n.createBlock(U,{key:4,class:n.normalizeClass(v.rightClasses),type:"ios-arrow-forward",onClick:u[13]||(u[13]=n.withModifiers(H=>v.handleSwitch(!0),["stop"]))},null,8,["class"])):n.createCommentVNode("",!0),n.createVNode(U,{class:"ivu-image-preview-arrow-close",type:"md-close",onClick:n.withModifiers(v.handleClose,["stop"])},null,8,["onClick"])],16)],4)):n.createCommentVNode("",!0)]),_:1})],8,["disabled"])}var zu=l(wle,[["render",Rle]]);const Dle=c=>typeof HTMLElement=="object"&&c instanceof HTMLElement,Lle={name:"Image",mixins:[Sn],components:{ImagePreview:zu},emits:["on-load","on-error","on-switch","on-close","on-click"],props:{src:{type:String,default:""},alt:{type:String,default:""},preview:{type:Boolean,default:!1},referrerPolicy:{type:String,default:""},width:{type:[String,Number],default:""},height:{type:[String,Number],default:""},fit:{type:String,default:""},lazy:{type:Boolean,default:!1},scrollContainer:{type:[String],default:""},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},maskClosable:{type:Boolean,default:!0},previewList:{type:Array},infinite:{type:Boolean,default:!0},initialIndex:{type:Number,default:0},previewTip:{type:Boolean,default:!0},toolbar:{type:Array,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||!c.$VIEWUI.image||c.$VIEWUI.image.toolbar===""?["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"]:c.$VIEWUI.image.toolbar}}},data(){return{loadingImage:!1,loading:!1,imageError:!1,scrollElement:null,observer:null,imagePreviewModal:!1}},watch:{src(){this.loadImage()}},computed:{innerClasses(){return["ivu-image-inner",{"ivu-image-cursor":this.preview}]},imgClasses(){return["ivu-image-img",{"ivu-image-img-hidden":this.loading||this.imageError}]},fitStyle(){const c=["fill","contain","cover","none","scale-down"],{fit:u}=this;return c.includes(u)?`object-fit:${u};`:""},imageStyles(){return{width:typeof this.width=="number"?`${this.width}px`:this.width,height:typeof this.height=="number"?`${this.height}px`:this.height}},loadingLang(){return this.t("i.select.loading")},failLang(){return this.t("i.image.fail")},previewLang(){return this.t("i.image.preview")},loadingType(){return this.lazy?"lazy":"eager"}},mounted(){r&&this.handleImageEvent()},methods:{handleLazy(){const c=this.$refs.image;(this.observer=new IntersectionObserver(this.handlerObserveImage,{root:this.scrollElement,rootMargin:"0px",threshold:0})).observe(c)},handlerObserveImage(c){for(let u of c)u.isIntersecting&&(this.offObserver(),this.loadImage())},addLazyImageListener(){const{scrollContainer:c}=this;this.scrollElement=null,Dle(c)?this.scrollElement=c:c&&typeof c=="string"&&(this.scrollElement=document.querySelector(c)),this.handleLazy()},handleImageLoad(){this.loading=!1,this.imageError=!1,this.$emit("on-load")},handleImageError(){this.loading=!1,this.imageError=!0,this.loadingImage=!1,this.$emit("on-error")},loadImage(){this.loading=!0,this.imageError=!1,this.loadingImage=!0},handleImageEvent(){const{lazy:c}=this;c?this.addLazyImageListener():this.loadImage()},offObserver(){const{observer:c}=this;c&&c.disconnect()},handlePreview(){const{preview:c,initialIndex:u}=this;c&&(this.imagePreviewModal=!0,this.$emit("on-click",{initialIndex:u}))},handleClose(){this.$emit("on-close")},handleSwitch(c){this.$emit("on-switch",c)}},beforeUnmount(){this.offObserver()}},Nle={key:0,class:"ivu-image-placeholder"},Vle={key:1,class:"ivu-image-error"},$le=["alt","src","loading","referrerPolicy"],Ule={class:"ivu-image-mark"};function Fle(c,u,m,S,b,v){const M=n.resolveComponent("ImagePreview");return n.openBlock(),n.createElementBlock("div",{class:"ivu-image",ref:"image",style:n.normalizeStyle(v.imageStyles)},[b.loading?(n.openBlock(),n.createElementBlock("div",Nle,[n.renderSlot(c.$slots,"placeholder",{},()=>[n.createElementVNode("span",null,n.toDisplayString(v.loadingLang),1)])])):b.imageError?(n.openBlock(),n.createElementBlock("div",Vle,[n.renderSlot(c.$slots,"error",{},()=>[n.createElementVNode("span",null,n.toDisplayString(v.failLang),1)])])):n.createCommentVNode("",!0),b.loadingImage?(n.openBlock(),n.createElementBlock("div",{key:2,class:n.normalizeClass(v.innerClasses),onClick:u[2]||(u[2]=(...N)=>v.handlePreview&&v.handlePreview(...N))},[n.createElementVNode("img",{class:n.normalizeClass(v.imgClasses),style:n.normalizeStyle([v.fitStyle]),alt:m.alt,src:m.src,loading:v.loadingType,referrerPolicy:m.referrerPolicy,onLoad:u[0]||(u[0]=(...N)=>v.handleImageLoad&&v.handleImageLoad(...N)),onError:u[1]||(u[1]=(...N)=>v.handleImageError&&v.handleImageError(...N))},null,46,$le),m.preview&&m.previewTip?n.renderSlot(c.$slots,"preview",{key:0},()=>[n.createElementVNode("div",Ule,[n.createElementVNode("span",null,n.toDisplayString(v.previewLang),1)])]):n.createCommentVNode("",!0)],2)):n.createCommentVNode("",!0),m.preview?(n.openBlock(),n.createBlock(M,{key:3,modelValue:b.imagePreviewModal,"onUpdate:modelValue":u[3]||(u[3]=N=>b.imagePreviewModal=N),"preview-list":m.previewList,"initial-index":m.initialIndex,infinite:m.infinite,"mask-closable":m.maskClosable,transfer:m.transfer,toolbar:m.toolbar,onOnClose:v.handleClose,onOnSwitch:v.handleSwitch},null,8,["modelValue","preview-list","initial-index","infinite","mask-closable","transfer","toolbar","onOnClose","onOnSwitch"])):n.createCommentVNode("",!0)],4)}var m$=l(Lle,[["render",Fle]]);zu.newInstance=c=>{if(!r)return;const u=c||{};let m=null;const S=n.createApp({data(){return Object.assign({},u,{visible:!1,previewList:[],initialIndex:0,toolbar:["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"],infinite:!0,maskClosable:!0,transfer:!0})},render(){return n.h(zu,Object.assign({},u,{ref:"imagePreview",modelValue:this.visible,previewList:this.previewList,initialIndex:this.initialIndex,toolbar:this.toolbar,infinite:this.infinite,maskClosable:this.maskClosable,transfer:this.transfer,"onOn-close":this.close}))},methods:{close(){this.visible=!1,setTimeout(()=>{this.destroy(),this.onRemove()},300)},destroy(){S.unmount(),document.body.removeChild(b)},onRemove(){}},created(){m=n.getCurrentInstance()}}),b=document.createElement("div");document.body.appendChild(b),S.mount(b);const v=m.refs.imagePreview;return{show(M){Object.keys(M).forEach(N=>{v.$parent[N]=M[N]}),v.$parent.visible=!0},component:v}};let Sw;function zle(){return Sw=Sw||zu.newInstance(),Sw}zu.show=function(c={}){const u=zle();c.onRemove=function(){Sw=null},u.show(c)};const Fr="ivu-input-number",Cw="ivu-icon";function Tw(c,u){let m,S,b;try{m=c.toString().split(".")[1].length}catch{m=0}try{S=u.toString().split(".")[1].length}catch{S=0}return b=Math.pow(10,Math.max(m,S)),(Math.round(c*b)+Math.round(u*b))/b}const Xle={name:"InputNumber",mixins:[Li],emits:["on-change","on-focus","on-blur","update:modelValue"],props:{max:{type:Number,default:1/0},min:{type:Number,default:-1/0},step:{type:Number,default:1},activeChange:{type:Boolean,default:!0},modelValue:{type:Number,default:1},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},name:{type:String},precision:{type:Number},elementId:{type:String},formatter:{type:Function},parser:{type:Function},placeholder:{type:String,default:""},controlsOutside:{type:Boolean,default:!1}},data(){return{focused:!1,upDisabled:!1,downDisabled:!1,currentValue:this.modelValue}},computed:{wrapClasses(){return[`${Fr}`,{[`${Fr}-${this.size}`]:!!this.size,[`${Fr}-disabled`]:this.itemDisabled,[`${Fr}-focused`]:this.focused,[`${Fr}-controls-outside`]:this.controlsOutside}]},handlerClasses(){return`${Fr}-handler-wrap`},upClasses(){return[`${Fr}-handler`,`${Fr}-handler-up`,{[`${Fr}-handler-up-disabled`]:this.upDisabled}]},innerUpClasses(){return`${Fr}-handler-up-inner ${Cw} ${Cw}-ios-arrow-up`},downClasses(){return[`${Fr}-handler`,`${Fr}-handler-down`,{[`${Fr}-handler-down-disabled`]:this.downDisabled}]},innerDownClasses(){return`${Fr}-handler-down-inner ${Cw} ${Cw}-ios-arrow-down`},inputWrapClasses(){return`${Fr}-input-wrap`},inputClasses(){return`${Fr}-input`},precisionValue(){return this.currentValue?this.precision?this.currentValue.toFixed(this.precision):this.currentValue:this.currentValue},formatterValue(){return this.formatter&&this.precisionValue!==null?this.formatter(this.precisionValue):this.precisionValue}},methods:{preventDefault(c){c.preventDefault()},up(c){const u=Number(c.target.value);if(this.upDisabled&&isNaN(u))return!1;this.changeStep("up",c)},down(c){const u=Number(c.target.value);if(this.downDisabled&&isNaN(u))return!1;this.changeStep("down",c)},changeStep(c,u){if(this.itemDisabled||this.readonly)return!1;const m=Number(u.target.value);let S=Number(this.currentValue);const b=Number(this.step);if(isNaN(S))return!1;if(!isNaN(m)){if(c==="up")if(Tw(m,b)<=this.max)S=m;else return!1;else if(c==="down")if(Tw(m,-b)>=this.min)S=m;else return!1}c==="up"?S=Tw(S,b):c==="down"&&(S=Tw(S,-b)),this.setValue(S)},setValue(c){c&&!isNaN(this.precision)&&(c=Number(Number(c).toFixed(this.precision)));const{min:u,max:m}=this;c!==null&&(c>m?c=m:c<u&&(c=u)),n.nextTick(()=>{this.currentValue=c,this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c)})},focus(c){this.focused=!0,this.$emit("on-focus",c)},blur(){this.focused=!1,this.$emit("on-blur"),F(this,["DatePicker","TimePicker","Cascader","Search"])||this.handleFormItemChange("blur",this.currentValue)},keyDown(c){c.keyCode===38?(c.preventDefault(),this.up(c)):c.keyCode===40&&(c.preventDefault(),this.down(c))},change(c){if(c.type==="change"&&this.activeChange||c.type==="input"&&!this.activeChange)return;let u=c.target.value.trim();if(this.parser&&(u=this.parser(u)),u.length===0){this.setValue(null);return}c.type==="input"&&u.match(/^\-?\.?$|\.$/)||(u=Number(u),isNaN(u)?c.target.value=this.currentValue:(this.currentValue=u,this.setValue(u)))},changeVal(c){if(c=Number(c),isNaN(c))this.upDisabled=!0,this.downDisabled=!0;else{const u=this.step;this.upDisabled=c+u>this.max,this.downDisabled=c-u<this.min}}},mounted(){this.changeVal(this.currentValue)},watch:{modelValue(c){this.currentValue=c},currentValue(c){this.changeVal(c)},min(){this.changeVal(this.currentValue)},max(){this.changeVal(this.currentValue)}}},Wle=[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-remove"},null,-1)],Hle=[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-add"},null,-1)],Gle=["id","disabled","autofocus","readonly","name","value","placeholder"];function Qle(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses)},[m.controlsOutside?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.handlerClasses)},[n.createElementVNode("a",{onClick:u[1]||(u[1]=(...M)=>v.up&&v.up(...M)),class:n.normalizeClass(v.upClasses)},[n.createElementVNode("span",{class:n.normalizeClass(v.innerUpClasses),onClick:u[0]||(u[0]=(...M)=>v.preventDefault&&v.preventDefault(...M))},null,2)],2),n.createElementVNode("a",{onClick:u[3]||(u[3]=(...M)=>v.down&&v.down(...M)),class:n.normalizeClass(v.downClasses)},[n.createElementVNode("span",{class:n.normalizeClass(v.innerDownClasses),onClick:u[2]||(u[2]=(...M)=>v.preventDefault&&v.preventDefault(...M))},null,2)],2)],2)),m.controlsOutside?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass(["ivu-input-number-controls-outside-btn ivu-input-number-controls-outside-down",{"ivu-input-number-controls-outside-btn-disabled":b.downDisabled}]),onClick:u[4]||(u[4]=(...M)=>v.down&&v.down(...M))},Wle,2)):n.createCommentVNode("",!0),m.controlsOutside?(n.openBlock(),n.createElementBlock("div",{key:2,class:n.normalizeClass(["ivu-input-number-controls-outside-btn ivu-input-number-controls-outside-up",{"ivu-input-number-controls-outside-btn-disabled":b.upDisabled}]),onClick:u[5]||(u[5]=(...M)=>v.up&&v.up(...M))},Hle,2)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass(v.inputWrapClasses)},[n.createElementVNode("input",{id:m.elementId,class:n.normalizeClass(v.inputClasses),disabled:c.itemDisabled,autocomplete:"off",spellcheck:"false",autofocus:m.autofocus,onFocus:u[6]||(u[6]=(...M)=>v.focus&&v.focus(...M)),onBlur:u[7]||(u[7]=(...M)=>v.blur&&v.blur(...M)),onKeydown:u[8]||(u[8]=n.withModifiers((...M)=>v.keyDown&&v.keyDown(...M),["stop"])),onInput:u[9]||(u[9]=(...M)=>v.change&&v.change(...M)),onMouseup:u[10]||(u[10]=(...M)=>v.preventDefault&&v.preventDefault(...M)),onChange:u[11]||(u[11]=(...M)=>v.change&&v.change(...M)),readonly:m.readonly||!m.editable,name:m.name,value:v.formatterValue,placeholder:m.placeholder},null,42,Gle)],2)],2)}var eM=l(Xle,[["render",Qle]]);const g$="ivu-layout",Yle={name:"Layout",data(){return{hasSider:!1}},computed:{wrapClasses(){return[`${g$}`,{[`${g$}-has-sider`]:this.hasSider}]}},methods:{findSider(){return this.$slots.default().some(c=>c.type.name==="Sider")}},mounted(){this.hasSider=this.findSider()}};function jle(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses)},[n.renderSlot(c.$slots,"default")],2)}var y$=l(Yle,[["render",jle]]);const v$={tooltips:["",""],showTip:!1,successTip:"",errorTip:""},x$={tooltip:"",editing:!1,maxlength:"",autosize:!0,triggerType:"icon"},_$={rows:1,tooltip:!1,suffix:!1,expandable:!1,symbol:""};var uv={emits:["update:modelValue"],mixins:[he],props:{type:{validator(c){return T(c,["secondary","success","warning","danger",""])},default:""},copyable:{type:Boolean,default:!1},copyText:{type:String,default:""},copyConfig:{type:Object,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.typography.copyConfig===""?v$:c.$VIEWUI.typography.copyConfig}},editable:{type:Boolean,default:!1},editConfig:{type:Object,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.typography.editConfig===""?x$:c.$VIEWUI.typography.editConfig}},ellipsis:{type:Boolean,default:!1},ellipsisConfig:{type:Object,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.typography.ellipsisConfig===""?_$:c.$VIEWUI.typography.ellipsisConfig}},disabled:{type:Boolean,default:!1},code:{type:Boolean,default:!1},delete:{type:Boolean,default:!1},keyboard:{type:Boolean,default:!1},mark:{type:Boolean,default:!1},strong:{type:Boolean,default:!1},underline:{type:Boolean,default:!1},italic:{type:Boolean,default:!1},modelValue:{type:String,default:""},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},theme:{validator(c){return T(c,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number],default:250},placement:{validator(c){return T(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"top"}},computed:{isHrefPattern(){const{to:c}=this;return!!c},linkProps(){if(this.isHrefPattern){const{linkUrl:c,target:u}=this;return{href:c,target:u}}else return{}},mergedCopyConfig(){return Object.assign({},v$,this.copyConfig)},mergedEditConfig(){return Object.assign({},x$,this.editConfig)},mergedEllipsisConfig(){return Object.assign({},_$,this.ellipsisConfig)}},methods:{commonSlots(){const c={};return this.$slots.default&&(c.default=()=>this.$slots.default()),this.$slots.copyIcon&&(c.copyIcon=u=>this.$slots.copyIcon(u)),this.$slots.editIcon&&(c.editIcon=u=>this.$slots.editIcon(u)),this.$slots.enterIcon&&(c.enterIcon=u=>this.$slots.enterIcon(u)),c},commonEvents(){return{"onUpdate:modelValue":this.handleOnUpdateModelValue}},handleOnUpdateModelValue(c){this.$emit("update:modelValue",c)}}};const Aw={name:"TypographyBase",mixins:[uv],emits:["on-copy-success","on-copy-error","on-edit-start","on-edit-end","on-edit-change","on-edit-cancel"],props:{component:{type:String,default:"div"},level:{type:Number,default:0}},data(){return{currentContent:this.modelValue,copied:!1,copyTimeout:null,editing:!1,editContent:"",lastKeyCode:"",isEditESC:!1,ellipsisText:"",ellipsisContent:"",isEllipsis:!1,ellipsisExpanded:!1,observer:null}},created(){this.editing=this.mergedEditConfig.editing||!1,this.editing&&(this.editContent=this.currentContent?this.currentContent:this.handleGetContent())},watch:{modelValue(c){this.currentContent=c},editing(c){c||n.nextTick(()=>{this.handleRemoveObserver(),this.handleCreateObserver()})},isEllipsis(){n.nextTick(()=>{this.handleRemoveObserver(),this.handleCreateObserver()})},ellipsis:{handler(c){c?n.nextTick(()=>{this.handleUpdateEllipsisStatus(),this.handleCreateObserver()}):this.handleRemoveObserver()},immediate:!0}},computed:{classes(){return["ivu-typography",{[`ivu-typography-${this.type}`]:this.type,"ivu-typography-disabled":this.disabled,"ivu-typography-ellipsis-line-clamp":this.ellipsis&&!this.ellipsisExpanded,"ivu-typography-ellipsis-single-line":this.ellipsis&&!this.ellipsisExpanded&&this.mergedEllipsisConfig.rows===1}]}},methods:{wrapperDecorations(){let c=this.currentContent?this.currentContent:this.$slots.default?this.$slots.default():"";function u(m,S){!m||(c=n.h(S,c))}return u(this.strong,"strong"),u(this.underline,"u"),u(this.delete,"del"),u(this.code,"code"),u(this.mark,"mark"),u(this.keyboard,"kbd"),u(this.italic,"i"),c},handleClickContent(c){if(!this.isHrefPattern&&this.component!=="a"){const u=this.mergedEditConfig.triggerType;this.editable&&(u==="text"||u==="both")&&this.handleEdit()}else{const u=c.ctrlKey||c.metaKey;this.handleCheckClick(c,u)}},handleGetContent(){const c=document.createElement("div");document.body.appendChild(c);let u=null,m=null,S="";const b=this.wrapperDecorations();return u=n.createApp({render(){return n.h("div",{ref:"text",style:{display:"none"}},b)},created(){m=n.getCurrentInstance()}}),u.mount(c),S=m.refs.text.innerText,u.unmount(),document.body.removeChild(c),S},handleCopy(){let c="";this.copyText?c=this.copyText:this.currentContent?c=this.currentContent:this.$slots.default&&(c=this.handleGetContent()),hw({text:this.copyText?this.copyText:c,showTip:this.mergedCopyConfig.showTip,successTip:this.mergedCopyConfig.successTip,errorTip:this.mergedCopyConfig.errorTip,success:()=>{this.$emit("on-copy-success"),this.copied=!0,this.copyTimeout&&clearTimeout(this.copyTimeout),this.copyTimeout=setTimeout(()=>{this.copied=!1},3e3)},error:()=>{this.$emit("on-copy-error")}})},handleEdit(){this.editContent=this.currentContent?this.currentContent:this.handleGetContent(),n.nextTick(()=>{this.editing=!0,this.$emit("on-edit-start"),n.nextTick(()=>{this.$refs.edit.focus({cursor:"end"})})})},handleEditBlur(){if(this.isEditESC){this.isEditESC=!1;return}this.handleEditSave(),this.$emit("on-edit-end",this.editContent)},handleEditChange(c){const u=c.target.value;this.editContent=u,this.$emit("on-edit-change",u)},handleEditSave(){this.$emit("update:modelValue",this.editContent),this.editing=!1},handleEditKeydown(c){const{keyCode:u}=c;u===jt.ENTER&&c.preventDefault(),this.lastKeyCode=u},handleEditKeyup(c){const{keyCode:u,ctrlKey:m,altKey:S,metaKey:b,shiftKey:v}=c;this.lastKeyCode===u&&!m&&!S&&!b&&!v&&(u===jt.ENTER?(this.handleEditSave(),this.$emit("on-edit-end",this.editContent)):u===jt.ESC&&(this.isEditESC=!0,this.$emit("on-edit-cancel"),this.editing=!1))},handleUpdateEllipsisStatus(){if(this.ellipsis&&!this.ellipsisExpanded){const c=this.$refs.typography;this.isEllipsis=c.scrollHeight>c.clientHeight}else this.isEllipsis=!1},handleCreateObserver(){this.ellipsis&&!this.ellipsisExpanded&&(this.observer=qm(),this.observer.listenTo(this.$refs.typography,this.handleUpdateEllipsisStatus))},handleRemoveObserver(){this.observer&&(this.observer.removeListener(this.$refs.typography,this.handleUpdateEllipsisStatus),this.observer=null)}},render(){let c=[];const u=this.wrapperDecorations();if(c.push(u),this.editable){const m=this.mergedEditConfig.triggerType;if(m==="icon"||m==="both"){const S=this.$slots.editIcon?this.$slots.editIcon():n.h(O,{type:"md-create"}),b=n.h("div",{class:"ivu-typography-edit",onClick:this.handleEdit},S);if(this.mergedEditConfig.tooltip){const v=n.h(mh,{content:this.mergedEditConfig.tooltip,placement:"top"},()=>b);c.push(v)}else c.push(b)}}if(this.copyable){const m=this.$slots.copyIcon?this.$slots.copyIcon({copied:this.copied}):n.h(O,{type:this.copied?"md-checkmark":"md-copy"}),S=n.h("div",{class:["ivu-typography-copy",{"ivu-typography-copy-success":this.copied}],onClick:this.handleCopy},m);if(this.mergedCopyConfig.tooltips instanceof Array&&this.mergedCopyConfig.tooltips.length===2){const b=n.h(mh,{content:this.copied?this.mergedCopyConfig.tooltips[1]:this.mergedCopyConfig.tooltips[0],placement:"top"},()=>S);c.push(b)}else c.push(S)}if(this.editing){const m=n.h(Xa,{ref:"edit",modelValue:this.editContent,type:"textarea",autosize:this.mergedEditConfig.autosize,maxlength:this.mergedEditConfig.maxlength,"onOn-blur":this.handleEditBlur,"onOn-keydown":this.handleEditKeydown,"onOn-keyup":this.handleEditKeyup,"onOn-change":this.handleEditChange}),S=this.$slots.enterIcon?this.$slots.enterIcon():n.h(O,{type:"md-return-left"}),b=n.h("span",{class:"ivu-typography-edit-content-confirm"},S);return n.h("div",{class:["ivu-typography","ivu-typography-edit-content",{[`ivu-typography-h${this.level}`]:this.level,"ivu-typography-div":!this.level}]},[m,b])}else{const m={};this.ellipsis&&!this.ellipsisExpanded&&(m["-webkit-line-clamp"]=this.mergedEllipsisConfig.rows);const b=n.h(this.component,{ref:"typography",class:this.classes,...this.linkProps,style:m,onClick:this.handleClickContent},[c,null]);return this.ellipsis&&!this.ellipsisExpanded&&this.isEllipsis&&this.mergedEllipsisConfig.tooltip?n.h(mh,{content:this.mergedEllipsisConfig.tooltip===!0?this.handleGetContent():this.mergedEllipsisConfig.tooltip,placement:this.placement,transfer:this.transfer,theme:this.theme,maxWidth:this.maxWidth},()=>b):b}},beforeUnmount(){this.handleRemoveObserver()}},b$={name:"Link",mixins:[uv],render(){return n.h(Aw,{...this.$props,component:"a",...this.commonEvents()},this.commonSlots())}};function w$(){return je(),Oe}let O$=w$();da.newInstance=c=>{if(!r)return;const u=c||{};let m=null;const S=n.createApp({data(){return Object.assign({},u,{})},render(){let M="";return this.render?M=n.h(da,{fix:!0,fullscreen:!0,ref:"spin"},[this.render(n.h)]):M=n.h(da,{size:"large",fix:!0,fullscreen:!0,ref:"spin"}),n.h("div",{class:"ivu-spin-fullscreen ivu-spin-fullscreen-wrapper",style:{"z-index":2010+O$}},[M])},created(){m=n.getCurrentInstance()}}),b=document.createElement("div");document.body.appendChild(b),S.mount(b);const v=m.refs.spin;return{show(){n.nextTick(()=>{m.refs.spin.visible=!0,O$=w$()})},remove(M){v.visible=!1,setTimeout(function(){S.unmount(),document.body.removeChild(b),M()},500)},component:v}};let dv;function S$(c=void 0){return dv=dv||da.newInstance({render:c}),dv}function qle(c){const u="render"in c?c.render:void 0;S$(u).show(c)}da.show=function(c={}){return qle(c)},da.hide=function(){if(!dv)return!1;S$().remove(()=>{dv=null})};const fv="ivu-list",Zle={name:"List",provide(){return{ListInstance:this}},components:{Spin:da},props:{border:{type:Boolean,default:!1},itemLayout:{validator(c){return T(c,["horizontal","vertical"])},default:"horizontal"},header:{type:String,default:""},footer:{type:String,default:""},loading:{type:Boolean,default:!1},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},split:{type:Boolean,default:!0}},data(){return{}},computed:{classes(){return[`${fv}`,`${fv}-${this.size}`,`${fv}-${this.itemLayout}`,{[`${fv}-bordered`]:this.border,[`${fv}-split`]:this.split}]}},methods:{}},Kle={key:0,class:"ivu-list-header"},Jle={class:"ivu-list-container"},ece={class:"ivu-list-items"},tce={key:2,class:"ivu-list-footer"};function ice(c,u,m,S,b,v){const M=n.resolveComponent("Spin");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[m.header||c.$slots.header?(n.openBlock(),n.createElementBlock("div",Kle,[n.renderSlot(c.$slots,"header",{},()=>[n.createTextVNode(n.toDisplayString(m.header),1)])])):n.createCommentVNode("",!0),n.createElementVNode("div",Jle,[n.createElementVNode("ul",ece,[n.renderSlot(c.$slots,"default")])]),m.loading?(n.openBlock(),n.createBlock(M,{key:1,fix:"",size:"large"},{default:n.withCtx(()=>[n.renderSlot(c.$slots,"spin")]),_:3})):n.createCommentVNode("",!0),m.footer||c.$slots.footer?(n.openBlock(),n.createElementBlock("div",tce,[n.renderSlot(c.$slots,"footer",{},()=>[n.createTextVNode(n.toDisplayString(m.footer),1)])])):n.createCommentVNode("",!0)],2)}var C$=l(Zle,[["render",ice]]);const nce={name:"ListItem",inject:["ListInstance"],props:{},computed:{itemLayout(){return this.ListInstance.itemLayout},isItemContainsTextNode(){let c;return this.$slots.default().forEach(u=>{typeof u=="string"&&(c=!0)}),c},isFlexMode(){const c=this.$slots.extra;return this.itemLayout==="vertical"?!!c:!this.isItemContainsTextNode},classes(){return[{"ivu-list-item-no-flex":!this.isFlexMode}]}}},sce={class:"ivu-list-item-main"},rce={key:0,class:"ivu-list-item-action"},oce={class:"ivu-list-item-extra"},ace={key:0,class:"ivu-list-item-action"},lce={class:"ivu-list-item-extra"};function cce(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(["ivu-list-item",v.classes])},[v.itemLayout==="vertical"&&c.$slots.extra?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createElementVNode("div",sce,[n.renderSlot(c.$slots,"default"),c.$slots.action?(n.openBlock(),n.createElementBlock("ul",rce,[n.renderSlot(c.$slots,"action")])):n.createCommentVNode("",!0)]),n.createElementVNode("div",oce,[n.renderSlot(c.$slots,"extra")])],64)):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.renderSlot(c.$slots,"default"),c.$slots.action?(n.openBlock(),n.createElementBlock("ul",ace,[n.renderSlot(c.$slots,"action")])):n.createCommentVNode("",!0),n.createElementVNode("div",lce,[n.renderSlot(c.$slots,"extra")])],64))],2)}var T$=l(nce,[["render",cce]]);const hce={name:"ListItemMeta",components:{Avatar:Hy},props:{avatar:{type:String,default:""},title:{type:String,default:""},description:{type:String,default:""}}},uce={class:"ivu-list-item-meta"},dce={key:0,class:"ivu-list-item-meta-avatar"},fce={class:"ivu-list-item-meta-content"},pce={key:0,class:"ivu-list-item-meta-title"},mce={key:1,class:"ivu-list-item-meta-description"};function gce(c,u,m,S,b,v){const M=n.resolveComponent("Avatar");return n.openBlock(),n.createElementBlock("div",uce,[m.avatar||c.$slots.avatar?(n.openBlock(),n.createElementBlock("div",dce,[n.renderSlot(c.$slots,"avatar",{},()=>[n.createVNode(M,{src:m.avatar},null,8,["src"])])])):n.createCommentVNode("",!0),n.createElementVNode("div",fce,[m.title||c.$slots.title?(n.openBlock(),n.createElementBlock("div",pce,[n.renderSlot(c.$slots,"title",{},()=>[n.createTextVNode(n.toDisplayString(m.title),1)])])):n.createCommentVNode("",!0),m.description||c.$slots.description?(n.openBlock(),n.createElementBlock("div",mce,[n.renderSlot(c.$slots,"description",{},()=>[n.createTextVNode(n.toDisplayString(m.description),1)])])):n.createCommentVNode("",!0)])])}var A$=l(hce,[["render",gce]]);const Ew="ivu-loading-bar",yce={name:"LoadingBar",props:{color:{type:String,default:"primary"},failedColor:{type:String,default:"error"},height:{type:Number,default:2}},data(){return{percent:0,status:"success",show:!1}},computed:{classes(){return`${Ew}`},innerClasses(){return[`${Ew}-inner`,{[`${Ew}-inner-color-primary`]:this.color==="primary"&&this.status==="success",[`${Ew}-inner-failed-color-error`]:this.failedColor==="error"&&this.status==="error"}]},outerStyles(){return{height:`${this.height}px`}},styles(){let c={width:`${this.percent}%`,height:`${this.height}px`};return this.color!=="primary"&&this.status==="success"&&(c.backgroundColor=this.color),this.failedColor!=="error"&&this.status==="error"&&(c.backgroundColor=this.failedColor),c}}};function vce(c,u,m,S,b,v){return n.openBlock(),n.createBlock(n.Transition,{name:"fade"},{default:n.withCtx(()=>[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.outerStyles)},[n.createElementVNode("div",{class:n.normalizeClass(v.innerClasses),style:n.normalizeStyle(v.styles)},null,6)],6),[[n.vShow,b.show]])]),_:1})}var tM=l(yce,[["render",vce]]);tM.newInstance=c=>{if(!r)return;const u=c||{};let m=null;const S=n.createApp({data(){return u},render(){return n.h(tM,Object.assign({ref:"loadingBar"},u))},created(){m=n.getCurrentInstance()}}),b=document.createElement("div");document.body.appendChild(b),S.mount(b);const v=m.refs.loadingBar;return{update(M){"percent"in M&&(v.percent=M.percent),M.status&&(v.status=M.status),"show"in M&&(v.show=M.show)},component:v,destroy(){S.unmount(),document.body.removeChild(b)}}};let Mw,E$="primary",M$=800,k$="error",P$=2,pv;function I$(){return Mw=Mw||tM.newInstance({color:E$,failedColor:k$,height:P$}),Mw}function Lf(c){I$().update(c)}function B$(){setTimeout(()=>{Lf({show:!1}),setTimeout(()=>{Lf({percent:0})},200)},M$)}function mv(){pv&&(clearInterval(pv),pv=null)}var iM={start(){if(pv)return;let c=0;Lf({percent:c,status:"success",show:!0}),pv=setInterval(()=>{c+=Math.floor(Math.random()*3+1),c>95&&mv(),Lf({percent:c,status:"success",show:!0})},200)},update(c){mv(),Lf({percent:c,status:"success",show:!0})},finish(){mv(),Lf({percent:100,status:"success",show:!0}),B$()},error(){mv(),Lf({percent:100,status:"error",show:!0}),B$()},config(c){c.color&&(E$=c.color),c.duration&&(M$=c.duration),c.failedColor&&(k$=c.failedColor),c.height&&(P$=c.height)},destroy(){mv();let c=I$();Mw=null,c.destroy()}};const xce={name:"Login",components:{Form:bw},emits:["on-submit"],provide(){return{LoginInstance:this}},props:{},data(){return{formValidate:{}}},methods:{handleSubmit(){this.$refs.form.validate(c=>{this.$emit("on-submit",c,JSON.parse(JSON.stringify(this.formValidate)))})},handleValidate(c,u){let m=!0;c.forEach(S=>{this.$refs.form.validateField(S,b=>{b&&(m=!1)})}),u(m)}}},_ce={class:"ivu-login"};function bce(c,u,m,S,b,v){const M=n.resolveComponent("Form");return n.openBlock(),n.createElementBlock("div",_ce,[n.createVNode(M,{ref:"form",model:b.formValidate,onSubmit:u[0]||(u[0]=n.withModifiers(()=>{},["prevent"]))},{default:n.withCtx(()=>[n.renderSlot(c.$slots,"default")]),_:3},8,["model"])])}var R$=l(xce,[["render",bce]]);const nM="ivu-menu",wce={name:"Menu",emits:["on-select","on-open-change"],provide(){return{MenuInstance:this}},props:{mode:{validator(c){return T(c,["horizontal","vertical"])},default:"vertical"},theme:{validator(c){return T(c,["light","dark","primary"])},default:"light"},activeName:{type:[String,Number]},openNames:{type:Array,default(){return[]}},accordion:{type:Boolean,default:!1},width:{type:String,default:"240px"}},data(){return{currentActiveName:this.activeName,openedNames:[],submenuList:[],menuItemList:[],ready:!1}},computed:{classes(){let c=this.theme;return this.mode==="vertical"&&this.theme==="primary"&&(c="light"),[`${nM}`,`${nM}-${c}`,{[`${nM}-${this.mode}`]:this.mode}]},styles(){let c={};return this.mode==="vertical"&&(c.width=this.width),c}},methods:{updateActiveName(){this.currentActiveName===void 0&&(this.currentActiveName=-1),this.submenuList.map(c=>c.submenu).forEach(c=>{c.handleUpdateActiveName(!1)}),this.menuItemList.map(c=>c.menuitem).forEach(c=>{c.handleUpdateActiveName(this.currentActiveName)})},updateOpenKeys(c){const u=[...this.openedNames].indexOf(c),m=this.submenuList.map(b=>b.submenu);if(this.accordion&&m.forEach(b=>{b.opened=!1}),u>=0){let b=null;m.forEach(v=>{v.name===c&&(b=v,v.opened=!1)}),j(b,"Submenu").forEach(v=>{v.opened=!0}),b.childSubmenuList.map(v=>v.submenu).forEach(v=>{v.opened=!1})}else if(this.accordion){let b=null;m.forEach(v=>{v.name===c&&(b=v,v.opened=!0)}),j(b,"Submenu").forEach(v=>{v.opened=!0})}else this.submenuList.map(b=>b.submenu).forEach(b=>{b.name===c&&(b.opened=!0)});let S=m.filter(b=>b.opened).map(b=>b.name);this.openedNames=[...S],this.$emit("on-open-change",S)},updateOpened(){const c=(this.submenuList||[]).map(u=>u.submenu);c.length&&c.forEach(u=>{this.openedNames.indexOf(u.name)>-1?u.opened=!0:u.opened=!1})},handleEmitSelectEvent(c){this.$emit("on-select",c)},handleMenuItemSelect(c){this.currentActiveName=c,this.$emit("on-select",c)}},mounted(){this.openedNames=[...this.openNames],this.updateOpened(),n.nextTick(()=>{this.updateActiveName(),this.ready=!0})},watch:{openNames(c){this.openedNames=c},activeName(c){this.currentActiveName=c},currentActiveName(){this.updateActiveName()}}};function Oce(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("ul",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.styles)},[n.renderSlot(c.$slots,"default")],6)}var sM=l(wce,[["render",Oce]]),rM={inject:{MenuInstance:{default:null},SubmenuInstance:{default:null}},data(){return{menu:this.MenuInstance}},computed:{hasParentSubmenu(){return!!this.SubmenuInstance},parentSubmenuNum(){return j(this,"Submenu").length},mode(){return this.MenuInstance.mode}}};const Sce="ivu-menu",Cce={name:"MenuGroup",mixins:[rM],props:{title:{type:String,default:""}},data(){return{prefixCls:Sce}},computed:{groupStyle(){return this.hasParentSubmenu&&this.mode!=="horizontal"?{paddingLeft:43+(this.parentSubmenuNum-1)*28+"px"}:{}}}};function Tce(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass([b.prefixCls+"-item-group"])},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-item-group-title"]),style:n.normalizeStyle(v.groupStyle)},n.toDisplayString(m.title),7),n.createElementVNode("ul",null,[n.renderSlot(c.$slots,"default")])],2)}var D$=l(Cce,[["render",Tce]]);const kw="ivu-menu",Ace={name:"MenuItem",mixins:[rM,he],props:{name:{type:[String,Number],required:!0},disabled:{type:Boolean,default:!1}},data(){return{active:!1,id:te(6)}},computed:{classes(){return[`${kw}-item`,{[`${kw}-item-active`]:this.active,[`${kw}-item-selected`]:this.active,[`${kw}-item-disabled`]:this.disabled}]},itemStyle(){return this.hasParentSubmenu&&this.mode!=="horizontal"?{paddingLeft:43+(this.parentSubmenuNum-1)*24+"px"}:{}}},methods:{handleClickItem(c,u=!1){if(!this.disabled)if(u||this.target==="_blank"){this.handleCheckClick(c,u);let m=F(this,"Menu");m&&m.handleEmitSelectEvent(this.name)}else F(this,"Submenu")?this.SubmenuInstance.handleMenuItemSelect(this.name):this.MenuInstance.handleMenuItemSelect(this.name),this.handleCheckClick(c,u)},handleUpdateActiveName(c){this.name===c?(this.active=!0,this.SubmenuInstance&&this.SubmenuInstance.handleUpdateActiveName(c)):this.active=!1},addMenuItem(){const c=this.MenuInstance;c.menuItemList||(c.menuItemList=[]),c.menuItemList.push({id:this.id,menuitem:this})},removeMenuItem(){const c=this.MenuInstance;if(c.menuItemList&&c.menuItemList.length){const u=c.menuItemList.findIndex(m=>m.id===this.id);c.menuItemList.splice(u,1)}}},mounted(){this.addMenuItem()},beforeUnmount(){this.removeMenuItem()}},Ece=["href","target"];function Mce(c,u,m,S,b,v){return c.to?(n.openBlock(),n.createElementBlock("a",{key:0,href:c.linkUrl,target:c.target,class:n.normalizeClass(v.classes),onClick:[u[0]||(u[0]=n.withModifiers(M=>v.handleClickItem(M,!1),["exact"])),u[1]||(u[1]=n.withModifiers(M=>v.handleClickItem(M,!0),["ctrl"])),u[2]||(u[2]=n.withModifiers(M=>v.handleClickItem(M,!0),["meta"]))],style:n.normalizeStyle(v.itemStyle)},[n.renderSlot(c.$slots,"default")],14,Ece)):(n.openBlock(),n.createElementBlock("li",{key:1,class:n.normalizeClass(v.classes),onClick:u[3]||(u[3]=n.withModifiers((...M)=>v.handleClickItem&&v.handleClickItem(...M),["stop"])),style:n.normalizeStyle(v.itemStyle)},[n.renderSlot(c.$slots,"default")],6))}var L$=l(Ace,[["render",Mce]]);const N$={name:"Mobile",mixins:[Zy],data(){return{className:"ivu-login-mobile",prefix:"ios-phone-portrait",placeholder:"",type:"text"}},props:{rules:{type:[Object,Array],default(){return[{required:!0,message:EE.Mobile,trigger:"change"},{pattern:/^1\d{10}$/,message:"",trigger:"change"}]}}}},Po="ivu-modal",V$={x:null,y:null,dragX:null,dragY:null,dragging:!1,rect:null},kce={inheritAttrs:!1,name:"Modal",mixins:[Sn,QE],components:{Icon:O,iButton:co},emits:["on-cancel","on-ok","on-hidden","on-visible-change","update:modelValue"],provide(){return{ModalInstance:this}},props:{modelValue:{type:Boolean,default:!1},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.modal.maskClosable===""?!0:c.$VIEWUI.modal.maskClosable}},title:{type:String},width:{type:[Number,String],default:520},okText:{type:String},cancelText:{type:String},loading:{type:Boolean,default:!1},styles:{type:Object,default(){return{}}},className:{type:String},footerHide:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},transitionNames:{type:Array,default(){return["ease","fade"]}},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!0:c.$VIEWUI.transfer}},fullscreen:{type:Boolean,default:!1},mask:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},sticky:{type:Boolean,default:!1},stickyDistance:{type:Number,default:10},resetDragPosition:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},beforeClose:Function,render:Function},data(){return{prefixCls:Po,wrapShow:!1,showHead:!0,buttonLoading:!1,visible:this.modelValue,dragData:L(V$),modalIndex:this.handleGetModalIndex(),isMouseTriggerIn:!1,id:te(6),tableList:[],sliderList:[]}},computed:{wrapClasses(){return[`${Po}-wrap`,{[`${Po}-hidden`]:!this.wrapShow,[`${this.className}`]:!!this.className,[`${Po}-no-mask`]:!this.showMask}]},wrapStyles(){return{zIndex:this.modalIndex+this.zIndex}},maskClasses(){return`${Po}-mask`},classes(){return[`${Po}`,{[`${Po}-fullscreen`]:this.fullscreen,[`${Po}-fullscreen-no-header`]:this.fullscreen&&!this.showHead,[`${Po}-fullscreen-no-footer`]:this.fullscreen&&this.footerHide}]},contentClasses(){return[`${Po}-content`,{[`${Po}-content-no-mask`]:!this.showMask,[`${Po}-content-drag`]:this.draggable&&!this.fullscreen,[`${Po}-content-dragging`]:this.draggable&&this.dragData.dragging}]},mainStyles(){let c={};const u=parseInt(this.width),m=this.dragData.x!==null?{top:0}:{width:u<=100?`${u}%`:`${u}px`},S=this.styles?this.styles:{};return Object.assign(c,m,S),c},contentStyles(){let c={};if(this.draggable&&!this.fullscreen){const u=this.styles.top?parseFloat(this.styles.top):0,m=this.styles.left?parseFloat(this.styles.left):0;this.dragData.x!==null&&(c.left=`${this.dragData.x-m}px`),this.dragData.y!==null&&(c.top=`${this.dragData.y}px`),this.dragData.y!==null&&(c.top=`${this.dragData.y-u}px`);const S=parseInt(this.width),b={width:S<=100?`${S}%`:`${S}px`};Object.assign(c,b)}return c},localeOkText(){return this.okText===void 0?this.t("i.modal.okText"):this.okText},localeCancelText(){return this.cancelText===void 0?this.t("i.modal.cancelText"):this.cancelText},showMask(){return this.mask}},methods:{close(){if(!this.beforeClose)return this.handleClose();const c=this.beforeClose();c&&c.then?c.then(()=>{this.handleClose()}):this.handleClose()},handleClose(){this.visible=!1,this.$emit("update:modelValue",!1),this.$emit("on-cancel")},handleMask(){this.maskClosable&&this.showMask&&this.close()},handleWrapClick(c){if(this.isMouseTriggerIn){this.isMouseTriggerIn=!1;return}const u=c.target.getAttribute("class");u&&u.indexOf(`${Po}-wrap`)>-1&&this.handleMask()},handleMousedown(){this.isMouseTriggerIn=!0},cancel(){this.close()},ok(){this.loading?this.buttonLoading=!0:(this.visible=!1,this.$emit("update:modelValue",!1)),this.$emit("on-ok")},EscClose(c){if(this.visible&&this.closable&&c.keyCode===27){const u=this.$root.modalList.map(m=>m.modal).filter(m=>m.$data.visible&&m.$props.closable).sort((m,S)=>m.$data.modalIndex<S.$data.modalIndex?1:-1)[0];setTimeout(()=>{u.close()},0)}},animationFinish(){this.$emit("on-hidden")},handleMoveStart(c){if(!this.draggable||this.fullscreen)return!1;const u=this.$refs.content.getBoundingClientRect();this.dragData.rect=u,this.dragData.x=u.x||u.left,this.dragData.y=u.y||u.top;const m={x:c.clientX,y:c.clientY};this.dragData.dragX=m.x,this.dragData.dragY=m.y,this.dragData.dragging=!0,o(window,"mousemove",this.handleMoveMove),o(window,"mouseup",this.handleMoveEnd)},handleMoveMove(c){if(!this.dragData.dragging||this.fullscreen)return!1;const u={x:c.clientX,y:c.clientY},m={x:u.x-this.dragData.dragX,y:u.y-this.dragData.dragY};if(r&&this.sticky){const S=document.documentElement.clientWidth,b=document.documentElement.clientHeight;this.dragData.x+m.x<=this.stickyDistance&&m.x<0?this.dragData.x=0:this.dragData.x+this.dragData.rect.width-S>-this.stickyDistance&&m.x>0?this.dragData.x=S-this.dragData.rect.width:this.dragData.x+=m.x,this.dragData.y+m.y<=this.stickyDistance&&m.y<0?this.dragData.y=0:this.dragData.y+this.dragData.rect.height-b>-this.stickyDistance&&m.y>0?this.dragData.y=b-this.dragData.rect.height:this.dragData.y+=m.y}else this.dragData.x+=m.x,this.dragData.y+=m.y;this.dragData.dragX=u.x,this.dragData.dragY=u.y},handleMoveEnd(){this.dragData.dragging=!1,a(window,"mousemove",this.handleMoveMove),a(window,"mouseup",this.handleMoveEnd)},handleGetModalIndex(){return je(),Oe},handleClickModal(){if(this.draggable){if(Ae!==this.lastVisibleIndex){this.lastVisibleIndex=Ae;return}this.modalIndex=this.handleGetModalIndex()}},addModal(){const c=this.$root;c.modalList||(c.modalList=[]),c.modalList.push({id:this.id,modal:this})},removeModal(){const c=this.$root;if(!c.modalList)return;const u=c.modalList.findIndex(m=>m.id===this.id);c.modalList.splice(u,1)}},watch:{modelValue(c){this.visible=c},visible(c){c===!1?(this.buttonLoading=!1,this.timer=setTimeout(()=>{this.wrapShow=!1,this.removeScrollEffect()},300)):(this.lastVisible!==c&&(this.modalIndex=this.handleGetModalIndex(),Ge()),this.timer&&clearTimeout(this.timer),this.wrapShow=!0,this.scrollable||this.addScrollEffect()),this.tableList.forEach(u=>{u.table.handleOnVisibleChange(c)}),this.sliderList.forEach(u=>{u.slider.handleOnVisibleChange(c)}),this.$emit("on-visible-change",c),this.lastVisible=c,this.lastVisibleIndex=Ae,c&&this.resetDragPosition&&(this.dragData=L(V$))},loading(c){c||(this.buttonLoading=!1)},scrollable(c){c?this.removeScrollEffect():this.addScrollEffect()},title(c){this.$slots.header===void 0&&(this.showHead=!!c)}},mounted(){this.visible&&(this.wrapShow=!0);let c=!0;this.$slots.header===void 0&&!this.title&&(c=!1),this.showHead=c,this.addModal(),r&&document.addEventListener("keydown",this.EscClose)},beforeUnmount(){this.removeModal(),r&&document.removeEventListener("keydown",this.EscClose),this.removeScrollEffect()}};function Pce(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("i-button");return n.openBlock(),n.createBlock(n.Teleport,{to:"body",disabled:!m.transfer},[n.createVNode(n.Transition,{name:m.transitionNames[1]},{default:n.withCtx(()=>[v.showMask?n.withDirectives((n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.maskClasses),style:n.normalizeStyle(v.wrapStyles),onClick:u[0]||(u[0]=(...X)=>v.handleMask&&v.handleMask(...X))},null,6)),[[n.vShow,b.visible]]):n.createCommentVNode("",!0)]),_:1},8,["name"]),n.createElementVNode("div",{class:n.normalizeClass(v.wrapClasses),style:n.normalizeStyle(v.wrapStyles),onClick:u[5]||(u[5]=(...X)=>v.handleWrapClick&&v.handleWrapClick(...X))},[n.createVNode(n.Transition,{name:m.transitionNames[0],onAfterLeave:v.animationFinish},{default:n.withCtx(()=>[n.withDirectives(n.createElementVNode("div",n.mergeProps(c.$attrs,{class:v.classes,style:v.mainStyles,onMousedown:u[4]||(u[4]=(...X)=>v.handleMousedown&&v.handleMousedown(...X))}),[n.createElementVNode("div",{class:n.normalizeClass(v.contentClasses),ref:"content",style:n.normalizeStyle(v.contentStyles),onClick:u[3]||(u[3]=(...X)=>v.handleClickModal&&v.handleClickModal(...X))},[m.closable?(n.openBlock(),n.createElementBlock("a",{key:0,class:n.normalizeClass([b.prefixCls+"-close"]),onClick:u[1]||(u[1]=(...X)=>v.close&&v.close(...X))},[n.renderSlot(c.$slots,"close",{},()=>[n.createVNode(M,{type:"ios-close"})])],2)):n.createCommentVNode("",!0),b.showHead?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass([b.prefixCls+"-header"]),onMousedown:u[2]||(u[2]=(...X)=>v.handleMoveStart&&v.handleMoveStart(...X))},[n.renderSlot(c.$slots,"header",{},()=>[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-header-inner"])},n.toDisplayString(m.title),3)])],34)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body"])},[n.renderSlot(c.$slots,"default")],2),m.footerHide?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",{key:2,class:n.normalizeClass([b.prefixCls+"-footer"])},[n.renderSlot(c.$slots,"footer",{},()=>[n.createVNode(N,{type:"text",onClick:v.cancel},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(v.localeCancelText),1)]),_:1},8,["onClick"]),n.createVNode(N,{type:"primary",loading:b.buttonLoading,onClick:v.ok},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(v.localeOkText),1)]),_:1},8,["loading","onClick"])])],2))],6)],16),[[n.vShow,b.visible]])]),_:3},8,["name","onAfterLeave"])],6)],8,["disabled"])}var Ha=l(kce,[["render",Pce]]);const xh="ivu-modal-confirm";Ha.newInstance=c=>{if(!r)return;const u=c||{},m=document.createElement("div");document.body.appendChild(m);let S=null;const b=n.createApp({mixins:[Sn],data(){return Object.assign({},u,{visible:!1,width:416,title:"",body:"",iconType:"",iconName:"",okText:void 0,cancelText:void 0,showCancel:!1,loading:!1,buttonLoading:!1,scrollable:!1,closable:!1,closing:!1})},render(){let M=[];this.showCancel&&M.push(n.h(co,{type:"text",onClick:this.cancel},()=>this.localeCancelText)),M.push(n.h(co,{type:"primary",loading:this.buttonLoading,onClick:this.ok},()=>this.localeOkText));let N;this.render?N=n.h("div",{class:`${xh}-body ${xh}-body-render`},[this.render(n.h)]):N=n.h("div",{class:`${xh}-body`},[n.h("div",{innerHTML:this.body})]);let X;return this.title&&(X=n.h("div",{class:`${xh}-head`},[n.h("div",{class:this.iconTypeCls},[n.h("i",{class:this.iconNameCls})]),n.h("div",{class:`${xh}-head-title`,innerHTML:this.title})])),n.h(Ha,Object.assign({},u,{width:this.width,scrollable:this.scrollable,closable:this.closable,ref:"modal"},{modelValue:this.visible,"onUpdate:modelValue":U=>this.visible=U,"onOn-cancel":this.cancel}),()=>n.h("div",{class:xh},[X,N,n.h("div",{class:`${xh}-footer`},M)]))},computed:{iconTypeCls(){return[`${xh}-head-icon`,`${xh}-head-icon-${this.iconType}`]},iconNameCls(){return["ivu-icon",`ivu-icon-${this.iconName}`]},localeOkText(){return this.okText?this.okText:this.t("i.modal.okText")},localeCancelText(){return this.cancelText?this.cancelText:this.t("i.modal.cancelText")}},methods:{cancel(){this.closing||(this.$refs.modal.visible=!1,this.buttonLoading=!1,this.onCancel(),this.remove())},ok(){this.closing||(this.loading?this.buttonLoading=!0:(this.$refs.modal.visible=!1,this.remove()),this.onOk())},remove(){this.closing=!0,setTimeout(()=>{this.closing=!1,this.destroy()},300)},destroy(){b.unmount(),document.body.removeChild(m),this.onRemove()},onOk(){},onCancel(){},onRemove(){}},created(){S=n.getCurrentInstance()}});b.mount(m);const v=S.refs.modal;return{show(M){switch(v.$parent.showCancel=M.showCancel,v.$parent.iconType=M.icon,M.icon){case"info":v.$parent.iconName="ios-information-circle";break;case"success":v.$parent.iconName="ios-checkmark-circle";break;case"warning":v.$parent.iconName="ios-alert";break;case"error":v.$parent.iconName="ios-close-circle";break;case"confirm":v.$parent.iconName="ios-help-circle";break}"width"in M&&(v.$parent.width=M.width),"closable"in M&&(v.$parent.closable=M.closable),"title"in M&&(v.$parent.title=M.title),"content"in M&&(v.$parent.body=M.content),"okText"in M&&(v.$parent.okText=M.okText),"cancelText"in M&&(v.$parent.cancelText=M.cancelText),"onCancel"in M&&(v.$parent.onCancel=M.onCancel),"onOk"in M&&(v.$parent.onOk=M.onOk),"loading"in M&&(v.$parent.loading=M.loading),"scrollable"in M&&(v.$parent.scrollable=M.scrollable),v.$parent.onRemove=M.onRemove,v.visible=!0},remove(){v.visible=!1,v.$parent.buttonLoading=!1,v.$parent.remove()},component:v}};let gv;function $$(c=void 0,u=!0){return gv=gv||Ha.newInstance({closable:!1,maskClosable:!1,footerHide:!0,render:c,lockScroll:u}),gv}function yv(c){const u="render"in c?c.render:void 0,m="lockScroll"in c?c.lockScroll:!0;let S=$$(u,m);c.onRemove=function(){gv=null},S.show(c)}Ha.info=function(c={}){return c.icon="info",c.showCancel=!1,yv(c)},Ha.success=function(c={}){return c.icon="success",c.showCancel=!1,yv(c)},Ha.warning=function(c={}){return c.icon="warning",c.showCancel=!1,yv(c)},Ha.error=function(c={}){return c.icon="error",c.showCancel=!1,yv(c)},Ha.confirm=function(c={}){return c.icon="confirm",c.showCancel=!0,yv(c)},Ha.remove=function(){if(!gv)return!1;$$().remove()};const fa="ivu-notice",U$="ivu-icon",Ice="ivu_notice_key_";let F$=24,z$=4.5,Zm,X$=1;const Bce={info:"ios-information-circle",success:"ios-checkmark-circle",warning:"ios-alert",error:"ios-close-circle"},W$="move-notice";function H$(){return Zm=Zm||lw.newInstance({prefixCls:fa,styles:{top:`${F$}px`,right:0},transitionName:W$}),Zm}function vv(c,u){const m=u.title||"",S=u.desc||"",b=u.name||`${Ice}${X$}`,v=u.onClose||function(){},M=u.render,N=u.duration===0?0:u.duration||z$;X$++;let X=H$(),U,H;const re=u.render&&!m?"":S||u.render?` ${fa}-with-desc`:"";if(c==="normal")H=!1,U=`
            <div class="${fa}-custom-content ${fa}-with-normal ${re}">
                <div class="${fa}-title">${m}</div>
                <div class="${fa}-desc">${S}</div>
            </div>
        `;else{const xe=Bce[c],ye=re===""?"":"-outline";H=!0,U=`
            <div class="${fa}-custom-content ${fa}-with-icon ${fa}-with-${c} ${re}">
                <span class="${fa}-icon ${fa}-icon-${c}">
                    <i class="${U$} ${U$}-${xe}${ye}"></i>
                </span>
                <div class="${fa}-title">${m}</div>
                <div class="${fa}-desc">${S}</div>
            </div>
        `}X.notice({name:b.toString(),duration:N,styles:{},transitionName:W$,content:U,withIcon:H,render:M,hasTitle:!!m,onClose:v,closable:!0,type:"notice"})}var oM={open(c){return vv("normal",c)},info(c){return vv("info",c)},success(c){return vv("success",c)},warning(c){return vv("warning",c)},error(c){return vv("error",c)},config(c){c.top&&(F$=c.top),(c.duration||c.duration===0)&&(z$=c.duration)},close(c){if(c)c=c.toString(),Zm&&Zm.remove(c);else return!1},destroy(){let c=H$();Zm=null,c.destroy("ivu-notice")}};const fr="ivu-tabs",aM=300,G$=(c,u,m,S)=>{const b=(c.findIndex(M=>M.name===u)+m+c.length)%c.length,v=c[b];return v.disabled?G$(c,v.name,m):v},Q$=(c,u)=>{try{c.focus()}catch{}if(r&&document.activeElement==c&&c!==u)return!0;const m=c.children;for(let S of m)if(Q$(S,u))return!0;return!1},Rce={name:"Tabs",mixins:[xl],emits:["on-click","on-dblclick","on-contextmenu","on-tab-remove","on-drag-drop","update:modelValue"],components:{Icon:O,Render:oV,Dropdown:If,DropdownMenu:Bf},provide(){return{TabsInstance:this}},props:{modelValue:{type:[String,Number]},type:{validator(c){return T(c,["line","card"])},default:"line"},size:{validator(c){return T(c,["small","default"])},default:"default"},animated:{type:Boolean,default:!0},captureFocus:{type:Boolean,default:!1},closable:{type:Boolean,default:!1},beforeRemove:Function,name:{type:String},draggable:{type:Boolean,default:!1},autoCloseContextmenu:{type:Boolean,default:!0}},data(){return{prefixCls:fr,navList:[],barWidth:0,barOffset:0,activeKey:this.modelValue,focusedKey:this.modelValue,showSlot:!1,navStyle:{transform:""},scrollable:!1,transitioning:!1,contextMenuVisible:!1,contextMenuStyles:{top:0,left:0},paneList:[],tableList:[]}},computed:{classes(){return[`${fr}`,{[`${fr}-card`]:this.type==="card",[`${fr}-mini`]:this.size==="small"&&this.type==="line",[`${fr}-no-animation`]:!this.animated}]},contentClasses(){return[`${fr}-content`,{[`${fr}-content-animated`]:this.animated}]},barClasses(){return[`${fr}-ink-bar`,{[`${fr}-ink-bar-animated`]:this.animated}]},contentStyle(){const c=this.getTabIndex(this.activeKey),u=c===0?"0%":`-${c}00%`;let m={};return c>-1&&(m={transform:`translateX(${u}) translateZ(0px)`}),m},barStyle(){let c={visibility:"hidden",width:`${this.barWidth}px`};return this.type==="line"&&(c.visibility="visible"),this.animated?c.transform=`translate3d(${this.barOffset}px, 0px, 0px)`:c.left=`${this.barOffset}px`,c},arrowType(){const c=this.globalConfig;let u="ios-close";return c&&(c.tabs.customCloseIcon?u="":c.tabs.closeIcon&&(u=c.tabs.closeIcon)),u},customArrowType(){const c=this.globalConfig;let u="";return c&&c.tabs.customCloseIcon&&(u=c.tabs.customCloseIcon),u},arrowSize(){const c=this.globalConfig;let u="";return c&&c.tabs.closeIconSize&&(u=c.tabs.closeIconSize),u}},methods:{getTabs(){const c=this.paneList.map(m=>m.pane),u=[];return c.forEach(m=>{m.tab&&this.name?m.tab===this.name&&u.push(m):u.push(m)}),u.sort((m,S)=>{if(m.index&&S.index)return m.index>S.index?1:-1}),u},updateNav(){this.navList=[],this.getTabs().forEach((c,u)=>{this.navList.push({labelType:typeof c.label,label:c.label,icon:c.icon||"",name:c.currentName||u,disabled:c.disabled,closable:c.closable,contextMenu:c.contextMenu}),c.currentName||(c.currentName=u),u===0&&(this.activeKey||(this.activeKey=c.currentName||u))}),this.updateStatus(),this.updateBar()},updateBar(){n.nextTick(()=>{const c=this.getTabIndex(this.activeKey);if(!this.$refs.nav)return;const u=this.$refs.nav.querySelectorAll(`.${fr}-tab`),m=u[c];if(this.barWidth=m?parseFloat(m.offsetWidth):0,c>0){let S=0;const b=this.size==="small"?0:16;for(let v=0;v<c;v++)S+=parseFloat(u[v].offsetWidth)+b;this.barOffset=S}else this.barOffset=0;this.updateNavScroll()})},updateStatus(){this.getTabs().forEach(c=>c.show=c.currentName===this.activeKey||this.animated)},tabCls(c){return[`${fr}-tab`,{[`${fr}-tab-disabled`]:c.disabled,[`${fr}-tab-active`]:c.name===this.activeKey,[`${fr}-tab-focused`]:c.name===this.focusedKey}]},handleChange(c){if(this.transitioning)return;this.transitioning=!0,setTimeout(()=>this.transitioning=!1,aM);const u=this.navList[c];!u||u.disabled||(this.activeKey=u.name,this.$emit("update:modelValue",u.name),this.$emit("on-click",u.name))},handleDblclick(c){const u=this.navList[c];!u||u.disabled||this.$emit("on-dblclick",u.name)},handleContextmenu(c,u){this.contextMenuVisible&&this.handleClickContextMenuOutside(),n.nextTick(()=>{const m=this.navList[c];if(!m||m.disabled||!m.contextMenu)return;u.preventDefault();const S=this.$refs.tabsWrap.getBoundingClientRect(),b={left:`${u.clientX-S.left}px`,top:`${u.clientY-S.top}px`};this.contextMenuStyles=b,this.contextMenuVisible=!0,this.$emit("on-contextmenu",m,u,b)})},handleClickContextMenuOutside(){this.contextMenuVisible=!1},handlePreventSelect(c,u){const m=this.navList[c];!m||m.disabled||!m.contextMenu||u.preventDefault()},handleTabKeyNavigation(c){if(c.keyCode!==37&&c.keyCode!==39)return;const u=c.keyCode===39?1:-1,m=G$(this.navList,this.focusedKey,u);this.focusedKey=m.name},handleTabKeyboardSelect(c=!1){if(c)return;const u=this.focusedKey||0,m=this.getTabIndex(u);this.handleChange(m)},handleRemove(c){if(!this.beforeRemove)return this.handleRemoveTab(c);const u=this.beforeRemove(c);u&&u.then?u.then(()=>{this.handleRemoveTab(c)}):this.handleRemoveTab(c)},handleRemoveTab(c){const u=this.getTabs(),m=u[c];if(m.currentName===this.activeKey){const S=this.getTabs();let b=-1;if(S.length){const v=u.filter((N,X)=>!N.disabled&&X<c),M=u.filter((N,X)=>!N.disabled&&X>c);M.length?b=M[0].currentName:v.length?b=v[v.length-1].currentName:b=S[0].currentName}this.activeKey=b,this.$emit("update:modelValue",b)}this.$emit("on-tab-remove",m.currentName),this.updateNav()},showClose(c){return this.type==="card"?c.closable!==null?c.closable:this.closable:!1},scrollPrev(){const c=this.$refs.navScroll.offsetWidth,u=this.getCurrentScrollOffset();if(!u)return;let m=u>c?u-c:0;this.setOffset(m)},scrollNext(){const c=this.$refs.nav.offsetWidth,u=this.$refs.navScroll.offsetWidth,m=this.getCurrentScrollOffset();if(c-m<=u)return;let S=c-m>u*2?m+u:c-u;this.setOffset(S)},getCurrentScrollOffset(){const{navStyle:c}=this;return c.transform?Number(c.transform.match(/translateX\(-(\d+(\.\d+)*)px\)/)[1]):0},getTabIndex(c){return this.navList.findIndex(u=>u.name===c)},setOffset(c){this.navStyle.transform=`translateX(-${c}px)`},scrollToActiveTab(){if(!this.scrollable)return;const c=this.$refs.nav,u=this.$el.querySelector(`.${fr}-tab-active`);if(!u)return;const m=this.$refs.navScroll,S=u.getBoundingClientRect(),b=m.getBoundingClientRect(),v=c.getBoundingClientRect(),M=this.getCurrentScrollOffset();let N=M;v.right<b.right&&(N=c.offsetWidth-b.width),S.left<b.left?N=M-(b.left-S.left):S.right>b.right&&(N=M+S.right-b.right),M!==N&&this.setOffset(Math.max(N,0))},updateNavScroll(){const c=this.$refs.nav.offsetWidth,u=this.$refs.navScroll.offsetWidth,m=this.getCurrentScrollOffset();u<c?(this.scrollable=!0,c-m<u&&this.setOffset(c-u)):(this.scrollable=!1,m>0&&this.setOffset(0))},handleScroll(c){c.preventDefault(),c.stopPropagation();const u=c.type;let m=0;(u==="DOMMouseScroll"||u==="mousewheel")&&(m=c.wheelDelta?c.wheelDelta:-(c.detail||0)*40),m>0?this.scrollPrev():this.scrollNext()},handleResize(){this.updateNavScroll()},isInsideHiddenElement(){if(!r)return;let c=this.$el.parentNode;for(;c&&c!==document.body;){if(c.style&&c.style.display==="none")return c;c=c.parentNode}return!1},updateVisibility(c){[...this.$refs.panes.querySelectorAll(`.${fr}-tabpane`)].forEach((u,m)=>{c===m?([...u.children].filter(S=>S.classList.contains(`${fr}-tabpane`)).forEach(S=>S.style.visibility="visible"),this.captureFocus&&setTimeout(()=>Q$(u,u),aM)):setTimeout(()=>{[...u.children].filter(S=>S.classList.contains(`${fr}-tabpane`)).forEach(S=>S.style.visibility="hidden")},aM)})},handleDrag(c,u){const m=this.navList[c];m&&u.dataTransfer.setData("tab-name",m.name)},handleDrop(c,u){const m=this.navList[c];if(m){const S=u.dataTransfer.getData("tab-name");u.preventDefault();let b=this.navList.map(N=>N.name);const v=parseInt(b.findIndex(N=>N===S)),M=parseInt(b.findIndex(N=>N===m.name));b.splice(M,1,...b.splice(v,1,b[M])),this.$emit("on-drag-drop",S,m.name,v,M,b)}},closeContextMenu(){this.handleClickContextMenuOutside()},handleClickDropdownItem(){this.autoCloseContextmenu&&this.closeContextMenu()}},watch:{modelValue(c){this.activeKey=c,this.focusedKey=c},activeKey(c){this.focusedKey=c,this.updateBar(),this.updateStatus(),this.tableList.forEach(m=>{m.table.handleOnVisibleChange(!0)}),n.nextTick(()=>{this.scrollToActiveTab()});const u=Math.max(this.getTabIndex(this.focusedKey),0);this.updateVisibility(u)}},mounted(){this.showSlot=this.$slots.extra!==void 0,this.observer=qm(),this.observer.listenTo(this.$refs.navWrap,this.handleResize);const c=this.isInsideHiddenElement();c&&(this.mutationObserver=new B(()=>{c.style.display!=="none"&&(this.updateBar(),this.mutationObserver.disconnect())}),this.mutationObserver.observe(c,{attributes:!0,childList:!0,characterData:!0,attributeFilter:["style"]})),this.handleTabKeyboardSelect(!0),this.updateVisibility(this.getTabIndex(this.activeKey))},beforeUnmount(){this.observer.removeListener(this.$refs.navWrap,this.handleResize),this.mutationObserver&&this.mutationObserver.disconnect()}},Dce=["onClick","onDblclick","onContextmenu","onSelectstart","draggable","onDragstart","onDrop"];function Lce(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("Render"),X=n.resolveComponent("DropdownMenu"),U=n.resolveComponent("Dropdown");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),ref:"tabsWrap"},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-bar"])},[b.showSlot?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-nav-right"])},[n.renderSlot(c.$slots,"extra")],2)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-nav-container"]),tabindex:"0",ref:"navContainer",onKeydown:[u[5]||(u[5]=(...H)=>v.handleTabKeyNavigation&&v.handleTabKeyNavigation(...H)),u[6]||(u[6]=n.withKeys(n.withModifiers(H=>v.handleTabKeyboardSelect(!1),["prevent"]),["space"]))]},[n.createElementVNode("div",{ref:"navWrap",class:n.normalizeClass([b.prefixCls+"-nav-wrap",b.scrollable?b.prefixCls+"-nav-scrollable":""])},[n.createElementVNode("span",{class:n.normalizeClass([b.prefixCls+"-nav-prev",b.scrollable?"":b.prefixCls+"-nav-scroll-disabled"]),onClick:u[0]||(u[0]=(...H)=>v.scrollPrev&&v.scrollPrev(...H))},[n.createVNode(M,{type:"ios-arrow-back"})],2),n.createElementVNode("span",{class:n.normalizeClass([b.prefixCls+"-nav-next",b.scrollable?"":b.prefixCls+"-nav-scroll-disabled"]),onClick:u[1]||(u[1]=(...H)=>v.scrollNext&&v.scrollNext(...H))},[n.createVNode(M,{type:"ios-arrow-forward"})],2),n.createElementVNode("div",{ref:"navScroll",class:n.normalizeClass([b.prefixCls+"-nav-scroll"]),"on:DOMMouseScroll":u[3]||(u[3]=(...H)=>v.handleScroll&&v.handleScroll(...H)),onMousewheel:u[4]||(u[4]=(...H)=>v.handleScroll&&v.handleScroll(...H))},[n.createElementVNode("div",{ref:"nav",class:n.normalizeClass([b.prefixCls+"-nav"]),style:n.normalizeStyle(b.navStyle)},[n.createElementVNode("div",{class:n.normalizeClass(v.barClasses),style:n.normalizeStyle(v.barStyle)},null,6),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(b.navList,(H,re)=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.tabCls(H)),key:re,onClick:xe=>v.handleChange(re),onDblclick:xe=>v.handleDblclick(re),onContextmenu:n.withModifiers(xe=>v.handleContextmenu(re,xe),["stop"]),onSelectstart:n.withModifiers(xe=>v.handlePreventSelect(re,xe),["stop"]),draggable:m.draggable,onDragstart:xe=>v.handleDrag(re,xe),onDrop:xe=>v.handleDrop(re,xe),onDragover:u[2]||(u[2]=n.withModifiers(()=>{},["prevent"]))},[H.icon!==""?(n.openBlock(),n.createBlock(M,{key:0,type:H.icon},null,8,["type"])):n.createCommentVNode("",!0),H.labelType==="function"?(n.openBlock(),n.createBlock(N,{key:1,render:H.label},null,8,["render"])):(n.openBlock(),n.createElementBlock(n.Fragment,{key:2},[n.createTextVNode(n.toDisplayString(H.label),1)],64)),v.showClose(H)?(n.openBlock(),n.createBlock(M,{key:3,class:n.normalizeClass([b.prefixCls+"-close"]),type:v.arrowType,custom:v.customArrowType,size:v.arrowSize,onClick:n.withModifiers(xe=>v.handleRemove(re),["stop"])},null,8,["class","type","custom","size","onClick"])):n.createCommentVNode("",!0)],42,Dce))),128))],6)],34)],2)],34)],2),n.createElementVNode("div",{class:n.normalizeClass(v.contentClasses),style:n.normalizeStyle(v.contentStyle),ref:"panes"},[n.renderSlot(c.$slots,"default")],6),n.createElementVNode("div",{class:"ivu-tabs-context-menu",style:n.normalizeStyle(b.contextMenuStyles)},[n.createVNode(U,{trigger:"custom",visible:b.contextMenuVisible,transfer:"",onOnClick:v.handleClickDropdownItem,onOnClickoutside:v.handleClickContextMenuOutside},{list:n.withCtx(()=>[n.createVNode(X,null,{default:n.withCtx(()=>[n.renderSlot(c.$slots,"contextMenu")]),_:3})]),_:3},8,["visible","onOnClick","onOnClickoutside"])],4)],2)}var Pw=l(Rce,[["render",Lce]]);const Nce={name:"Notification",components:{Dropdown:If,DropdownMenu:Bf,Badge:Zb,Tabs:Pw},emits:["on-visible-change","on-item-click","on-clear","on-load-more","on-tab-change"],provide(){return{NotificationInstance:this}},props:{count:{type:Number},autoCount:{type:Boolean,default:!1},countType:{validator(c){return T(c,["text","badge"])},default:"text"},icon:{type:String,default:"md-notifications-outline"},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},placement:{validator(c){return T(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},badgeProps:{type:Object,default(){return{}}},clearClose:{type:Boolean,default:!1},locale:{type:Object,default(){return{loadedAll:"",loading:"...",loadMore:"",clear:""}}},tab:{type:String},wide:{type:Boolean,default:!1},transferClassName:{type:String}},data(){return{visible:!1,countAll:0,tabList:[]}},computed:{finalCount(){return this.autoCount?this.countAll:this.count},transferClasses(){let c="ivu-notifications-transfer";return this.transferClassName&&(c+=` ${this.transferClassName}`),c}},watch:{visible(c){this.$emit("on-visible-change",c)}},methods:{handleVisibleChange(c){this.visible=c},handleClickOutside(c){this.$refs.notice.contains(c.target)||(this.visible=!1)},handleToggleOpen(){this.visible=!this.visible},handleGetCountAll(){if(this.autoCount){const c=this.tabList.map(m=>m.tab);let u=0;c.forEach(m=>{m.count&&(u+=m.count)}),this.countAll=u}},handleItemClick(c,u){this.$emit("on-item-click",c,u)},handleClear(c){this.$emit("on-clear",c),this.clearClose&&this.handleClose()},handleLoadMore(c){this.$emit("on-load-more",c)},handleClose(){this.visible=!1},handleTabChange(c){const u=this.tabList.map(S=>S.tab);let m={};u.forEach(S=>{S.$refs.tab.currentName===c&&(m=S.handleGetTabBaseInfo())}),this.$emit("on-tab-change",m)}}},Vce={class:"ivu-notifications",ref:"notice"},$ce={class:"ivu-notifications-tabs"},Uce={key:0,class:"ivu-notifications-extra"};function Fce(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("Badge"),X=n.resolveComponent("Tabs"),U=n.resolveComponent("DropdownMenu"),H=n.resolveComponent("Dropdown");return n.openBlock(),n.createElementBlock("div",Vce,[n.createVNode(H,{trigger:"custom",visible:b.visible,transfer:m.transfer,placement:m.placement,"transfer-class-name":v.transferClasses,onOnVisibleChange:v.handleVisibleChange,onOnClickoutside:v.handleClickOutside},{list:n.withCtx(()=>[c.$slots.default?(n.openBlock(),n.createBlock(U,{key:0,onClick:u[1]||(u[1]=n.withModifiers(()=>{},["stop"]))},{default:n.withCtx(()=>[n.createElementVNode("div",{class:n.normalizeClass(["ivu-notifications-list",{"ivu-notifications-list-wide":m.wide}])},[n.createElementVNode("div",$ce,[n.createVNode(X,{animated:!1,"model-value":m.tab,onOnClick:v.handleTabChange},{default:n.withCtx(()=>[n.renderSlot(c.$slots,"default")]),_:3},8,["model-value","onOnClick"])])],2),c.$slots.extra?(n.openBlock(),n.createElementBlock("div",Uce,[n.renderSlot(c.$slots,"extra")])):n.createCommentVNode("",!0)]),_:3})):n.createCommentVNode("",!0)]),default:n.withCtx(()=>[n.createElementVNode("div",{class:"ivu-notifications-rel",onClick:u[0]||(u[0]=n.withModifiers((...re)=>v.handleToggleOpen&&v.handleToggleOpen(...re),["prevent","stop"]))},[n.createVNode(N,n.mergeProps({count:v.finalCount},m.badgeProps),{default:n.withCtx(()=>[n.renderSlot(c.$slots,"icon",{},()=>[n.createVNode(M,{type:m.icon,size:"24"},null,8,["type"])])]),_:3},16,["count"])])]),_:3},8,["visible","transfer","placement","transfer-class-name","onOnVisibleChange","onOnClickoutside"])],512)}var Y$=l(Nce,[["render",Fce]]);const zce=(c,u)=>c<=u,xv=c=>c<10?"0"+c:c,j$=(c,u)=>{const m=new Date(c),S=m.getFullYear(),b=xv(m.getMonth()+1),v=xv(m.getDate()),M=xv(m.getHours()),N=xv(m.getMinutes()),X=xv(m.getSeconds());let U="";return u==="year"?U=S+"-"+b+"-"+v+" "+M+":"+N+":"+X:U=b+"-"+v+" "+M+":"+N,U},Xce=(c,u)=>{const m=new Date().getTime(),S=zce(c,m);let b=m-c;S||(b=-b);let v="",M=S?u("i.time.before")||"":u("i.time.after")||"";return b<1e3?v=u("i.time.just")||"":b<6e4?v=parseInt(b/1e3)+(u("i.time.seconds")||"")+M:b>=6e4&&b<36e5?v=Math.floor(b/6e4)+(u("i.time.minutes")||"")+M:b>=36e5&&b<864e5?v=Math.floor(b/36e5)+(u("i.time.hours")||"")+M:b>=864e5&&b<262386e4?v=Math.floor(b/864e5)+(u("i.time.days")||"")+M:b>=262386e4&&b<=3156786e4&&S?v=j$(c):v=j$(c,"year"),v};function Wce(c,u){return Xce(c,u)}const q$="ivu-time",Hce={name:"Time",mixins:[Sn],props:{time:{type:[Number,Date,String],required:!0},type:{type:String,validator(c){return T(c,["relative","date","datetime"])},default:"relative"},hash:{type:String,default:""},interval:{type:Number,default:60}},data(){return{date:""}},computed:{classes(){return[`${q$}`,{[`${q$}-with-hash`]:this.hash}]}},watch:{time(){this.setTime()}},methods:{handleClick(){r&&this.hash!==""&&(window.location.hash=this.hash)},setTime(){const c=typeof this.time;let u;if(c==="number"){const m=this.time.toString().length>10?this.time:this.time*1e3;u=new Date(m).getTime()}else c==="object"?u=this.time.getTime():c==="string"&&(u=la(this.time).valueOf());if(this.type==="relative")this.date=Wce(u,this.t);else{const m=new Date(this.time),S=m.getFullYear(),b=m.getMonth()+1<10?"0"+(m.getMonth()+1):m.getMonth()+1,v=m.getDate()<10?"0"+m.getDate():m.getDate(),M=m.getHours()<10?"0"+m.getHours():m.getHours(),N=m.getMinutes()<10?"0"+m.getMinutes():m.getMinutes(),X=m.getSeconds()<10?"0"+m.getSeconds():m.getSeconds();this.type==="datetime"?this.date=`${S}-${b}-${v} ${M}:${N}:${X}`:this.type==="date"&&(this.date=`${S}-${b}-${v}`)}}},mounted(){this.setTime(),this.interval!==0&&(this.timer=setInterval(()=>{this.setTime()},1e3*this.interval))},beforeUnmount(){this.timer&&clearInterval(this.timer)}};function Gce(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("span",{class:n.normalizeClass(v.classes),onClick:u[0]||(u[0]=(...M)=>v.handleClick&&v.handleClick(...M))},n.toDisplayString(b.date),3)}var Iw=l(Hce,[["render",Gce]]);const Qce={name:"NotificationItem",inject:["NotificationTabInstance","NotificationInstance"],components:{Row:Du,Col:pc,Avatar:Hy,Tag:Wm,Time:Iw},emits:["on-item-click"],props:{rowProps:{type:Object,default(){return{type:"flex",justify:"center",align:"middle"}}},read:{type:[Boolean,Number],default:!1},icon:{type:String},customIcon:{type:String},iconColor:{type:String},iconSize:{validator(c){return T(c,["small","default","large"])},default:"default"},avatar:{type:String},avatarShape:{validator(c){return T(c,["circle","square"])},default:"circle"},title:{type:String},content:{type:String},time:{type:[Number,Date,String]},timeProps:{type:Object,default(){return{}}},tag:{type:String},tagProps:{type:Object,default(){return{}}},clickClose:{type:Boolean,default:!1}},data(){return{id:te(6)}},computed:{classes(){return{"ivu-notifications-item-unread":this.read===!1||this.read===0}},contentSpan(){return this.icon||this.customIcon||this.avatar||this.$slots.avatar?20:24},iconStyle(){let c={};return this.iconColor&&(c={"background-color":this.iconColor}),c}},methods:{handleClick(){this.$emit("on-item-click",this.$attrs),this.NotificationTabInstance.handleItemClick(this.$attrs),this.clickClose&&this.NotificationInstance.handleClose()},addItem(){this.NotificationTabInstance.itemList.push({id:this.id,item:this})},removeItem(){const c=this.NotificationTabInstance,u=c.itemList.findIndex(m=>m.id===this.id);c.itemList.splice(u,1)}},mounted(){this.addItem(),this.NotificationTabInstance.handleGetItems()},unmounted(){this.NotificationTabInstance.handleGetItems()},beforeUnmount(){this.removeItem()}},Yce={class:"ivu-notifications-item-title"},jce={key:0},qce={key:0,class:"ivu-notifications-item-tag"},Zce={key:0,class:"ivu-notifications-item-desc"},Kce={key:1,class:"ivu-notifications-item-time"};function Jce(c,u,m,S,b,v){const M=n.resolveComponent("Avatar"),N=n.resolveComponent("Col"),X=n.resolveComponent("Tag"),U=n.resolveComponent("Time"),H=n.resolveComponent("Row");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["ivu-notifications-item",v.classes]),onClick:u[0]||(u[0]=(...re)=>v.handleClick&&v.handleClick(...re))},[n.renderSlot(c.$slots,"default",{},()=>[n.createVNode(H,n.normalizeProps(n.guardReactiveProps(m.rowProps)),{default:n.withCtx(()=>[m.icon||m.customIcon||m.avatar||c.$slots.avatar?(n.openBlock(),n.createBlock(N,{key:0,span:"4",class:"ivu-notifications-item-icon"},{default:n.withCtx(()=>[n.renderSlot(c.$slots,"avatar",{},()=>[m.icon?(n.openBlock(),n.createBlock(M,{key:0,icon:m.icon,shape:m.avatarShape,size:m.iconSize,style:n.normalizeStyle(v.iconStyle)},null,8,["icon","shape","size","style"])):m.customIcon?(n.openBlock(),n.createBlock(M,{key:1,"custom-icon":m.customIcon,shape:m.avatarShape,size:m.iconSize,style:n.normalizeStyle(v.iconStyle)},null,8,["custom-icon","shape","size","style"])):m.avatar?(n.openBlock(),n.createBlock(M,{key:2,src:m.avatar,shape:m.avatarShape,size:m.iconSize,style:n.normalizeStyle(v.iconStyle)},null,8,["src","shape","size","style"])):n.createCommentVNode("",!0)])]),_:3})):n.createCommentVNode("",!0),n.createVNode(N,{span:v.contentSpan,class:"ivu-notifications-item-content"},{default:n.withCtx(()=>[n.createElementVNode("div",Yce,[m.title||c.$slots.title?(n.openBlock(),n.createElementBlock("h4",jce,[n.renderSlot(c.$slots,"title",{},()=>[n.createTextVNode(n.toDisplayString(m.title),1)]),m.tag?(n.openBlock(),n.createElementBlock("div",qce,[n.createVNode(X,n.normalizeProps(n.guardReactiveProps(m.tagProps)),{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(m.tag),1)]),_:1},16)])):n.createCommentVNode("",!0)])):n.createCommentVNode("",!0)]),m.content||c.$slots.content?(n.openBlock(),n.createElementBlock("div",Zce,[n.renderSlot(c.$slots,"content",{},()=>[n.createTextVNode(n.toDisplayString(m.content),1)])])):n.createCommentVNode("",!0),m.time||c.$slots.time?(n.openBlock(),n.createElementBlock("div",Kce,[n.renderSlot(c.$slots,"time",{},()=>[n.createVNode(U,n.mergeProps({time:m.time},m.timeProps),null,16,["time"])])])):n.createCommentVNode("",!0)]),_:3},8,["span"])]),_:3},16)])],2)}var Z$=l(Qce,[["render",Jce]]);const ehe="ivu-tabs-tabpane",the={name:"TabPane",inject:["TabsInstance"],props:{name:{type:String},label:{type:[String,Function],default:""},icon:{type:String},disabled:{type:Boolean,default:!1},closable:{type:Boolean,default:null},tab:{type:String},index:{type:Number},contextMenu:{type:Boolean,default:!1}},data(){return{prefixCls:ehe,show:!0,currentName:this.name,id:te(6)}},computed:{contentStyle(){return{visibility:this.TabsInstance.activeKey!==this.currentName?"hidden":"visible"}}},methods:{updateNav(){this.TabsInstance.updateNav()},addPane(){const c=this.TabsInstance;c.paneList||(c.paneList=[]),c.paneList.push({id:this.id,pane:this})},removePane(){const c=this.TabsInstance;if(c.paneList&&c.paneList.length){const u=c.paneList.findIndex(m=>m.id===this.id);c.paneList.splice(u,1)}}},watch:{name(c){this.currentName=c,this.updateNav()},label(c){typeof c!="function"&&this.updateNav()},icon(){this.updateNav()},disabled(){this.updateNav()}},mounted(){this.addPane(),this.updateNav()},beforeUnmount(){this.removePane(),this.updateNav()}};function ihe(c,u,m,S,b,v){return n.withDirectives((n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(b.prefixCls),style:n.normalizeStyle(v.contentStyle)},[n.renderSlot(c.$slots,"default")],6)),[[n.vShow,b.show]])}var Bw=l(the,[["render",ihe]]);const nhe={name:"NotificationTab",inject:["NotificationInstance"],components:{TabPane:Bw,Icon:O},provide(){return{NotificationTabInstance:this}},props:{count:{type:Number},title:{type:String,required:!0},name:{type:String},emptyText:{type:String,default:""},emptyImage:{type:String,default:"https://file.iviewui.com/iview-pro/icon-no-message.svg"},loadedAll:{type:Boolean,default:!0},showLoadedAll:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},scrollToLoad:{type:Boolean,default:!0},showClear:{type:Boolean,default:!0},showClearIcon:{type:Boolean,default:!0}},data(){return{customLabel:c=>c("div",[c("span",this.title),c(Zb,{count:this.count})]),itemCount:0,itemList:[],id:te(6)}},computed:{currentTitle(){const c=this.NotificationInstance.countType;if(c==="text"){const u=this.count?`(${this.count})`:"";return`${this.title} ${u}`}else if(c==="badge")return this.customLabel}},watch:{count:{handler(){this.NotificationInstance.handleGetCountAll()},immediate:!0}},methods:{handleGetTabBaseInfo(){return{name:this.name,title:this.title}},handleGetItems(){const c=this.itemList.map(u=>u.item);this.itemCount=c.length},handleItemClick(c){this.NotificationInstance.handleItemClick(this.handleGetTabBaseInfo(),c)},handleClear(){this.NotificationInstance.handleClear(this.handleGetTabBaseInfo())},handleLoadMore(){this.NotificationInstance.handleLoadMore(this.handleGetTabBaseInfo())},handleScroll(){if(!this.scrollToLoad)return;const c=this.$refs.scroll,u=c.scrollHeight-c.clientHeight-c.scrollTop;!this.loading&&u===0&&this.handleLoadMore()},addTab(){this.NotificationInstance.tabList.push({id:this.id,tab:this})},removeTab(){const c=this.NotificationInstance,u=c.tabList.findIndex(m=>m.id===this.id);c.tabList.splice(u,1)}},mounted(){this.addTab()},beforeUnmount(){this.removeTab()}},she={class:"ivu-notifications-container-list"},rhe={key:0,class:"ivu-notifications-tab-empty"},ohe=["src"],ahe={class:"ivu-notifications-tab-empty-text"},lhe={class:"ivu-notifications-tab-loading"},che={key:0,class:"ivu-notifications-tab-loading-item ivu-notifications-tab-loading-show"},hhe={key:2,class:"ivu-notifications-tab-loading-item ivu-notifications-tab-loading-all"};function uhe(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("TabPane");return n.openBlock(),n.createBlock(N,{label:v.currentTitle,name:m.name,ref:"tab",class:"ivu-notifications-tab"},{default:n.withCtx(()=>[n.createElementVNode("div",{class:"ivu-notifications-container",onScroll:u[1]||(u[1]=(...X)=>v.handleScroll&&v.handleScroll(...X)),ref:"scroll"},[n.renderSlot(c.$slots,"top"),n.createElementVNode("div",she,[n.renderSlot(c.$slots,"default")]),!m.loading&&b.itemCount===0?(n.openBlock(),n.createElementBlock("div",rhe,[n.renderSlot(c.$slots,"empty",{},()=>[m.emptyImage?(n.openBlock(),n.createElementBlock("img",{key:0,class:"ivu-notifications-tab-empty-img",src:m.emptyImage},null,8,ohe)):n.createCommentVNode("",!0),n.createElementVNode("div",ahe,n.toDisplayString(m.emptyText),1)])])):n.createCommentVNode("",!0),n.createElementVNode("div",lhe,[m.loading?(n.openBlock(),n.createElementBlock("div",che,[n.renderSlot(c.$slots,"loading",{},()=>[n.createVNode(M,{type:"ios-loading",class:"ivu-load-loop"}),n.createTextVNode(" "+n.toDisplayString(v.NotificationInstance.locale.loading),1)])])):m.loadedAll?m.showLoadedAll&&m.loadedAll?(n.openBlock(),n.createElementBlock("div",hhe,[n.renderSlot(c.$slots,"loaded-all",{},()=>[n.createTextVNode(n.toDisplayString(v.NotificationInstance.locale.loadedAll),1)])])):n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",{key:1,class:"ivu-notifications-tab-loading-item ivu-notifications-tab-loading-more",onClick:u[0]||(u[0]=(...X)=>v.handleLoadMore&&v.handleLoadMore(...X))},[n.renderSlot(c.$slots,"load-more",{},()=>[n.createTextVNode(n.toDisplayString(v.NotificationInstance.locale.loadMore),1)])]))])],544),m.showClear&&b.itemCount!==0?(n.openBlock(),n.createElementBlock("div",{key:0,class:"ivu-notifications-tab-clear",onClick:u[2]||(u[2]=(...X)=>v.handleClear&&v.handleClear(...X))},[n.renderSlot(c.$slots,"clear",{},()=>[m.showClearIcon?(n.openBlock(),n.createBlock(M,{key:0,type:"md-done-all"})):n.createCommentVNode("",!0),n.createElementVNode("span",null,n.toDisplayString(v.NotificationInstance.locale.clear)+n.toDisplayString(m.title),1)])])):n.createCommentVNode("",!0)]),_:3},8,["label","name"])}var K$=l(nhe,[["render",uhe]]);const dhe={name:"Trend",components:{Icon:O},props:{flag:{validator(c){return T(c,["up","down"])}},colorful:{type:Boolean,default:!0},reverseColor:{type:Boolean,default:!1},textColor:{type:Boolean,default:!1},showTitle:{type:[Boolean,String],default:!1}},computed:{classes(){return[{"ivu-trend-up":this.flag==="up","ivu-trend-down":this.flag==="down","ivu-trend-reverse-color":this.reverseColor,"ivu-trend-colorful":this.colorful,"ivu-trend-text-color":this.textColor}]},flagType(){return this.flag==="up"?"md-arrow-dropup":this.flag==="down"?"md-arrow-dropdown":""}}},fhe={class:"ivu-trend-text"};function phe(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["ivu-trend",v.classes])},[n.createElementVNode("span",fhe,[n.renderSlot(c.$slots,"default")]),n.createVNode(M,{type:v.flagType,class:"ivu-trend-flag"},null,8,["type"])],2)}var lM=l(dhe,[["render",phe]]);const mhe={name:"NumberInfo",components:{Trend:lM},props:{title:{type:String},subTitle:{type:String},total:{type:[String,Number]},subTotal:{type:[String,Number]},status:{validator(c){return T(c,["up","down"])}},gap:{type:[String,Number],default:8}},computed:{valueStyle(){return{"margin-top":this.gap+"px"}}}},ghe={class:"ivu-number-info"},yhe={key:0,class:"ivu-number-info-title"},vhe={key:1,class:"ivu-number-info-subTitle"},xhe={class:"ivu-number-info-total"},_he={key:0,class:"ivu-number-info-subTotal"};function bhe(c,u,m,S,b,v){const M=n.resolveComponent("Trend");return n.openBlock(),n.createElementBlock("div",ghe,[m.title||c.$slots.title?(n.openBlock(),n.createElementBlock("div",yhe,[n.renderSlot(c.$slots,"title",{},()=>[n.createTextVNode(n.toDisplayString(m.title),1)])])):n.createCommentVNode("",!0),m.subTitle||c.$slots.subTitle?(n.openBlock(),n.createElementBlock("div",vhe,[n.renderSlot(c.$slots,"subTitle",{},()=>[n.createTextVNode(n.toDisplayString(m.subTitle),1)])])):n.createCommentVNode("",!0),n.createElementVNode("div",{class:"ivu-number-info-value",style:n.normalizeStyle(v.valueStyle)},[n.createElementVNode("span",xhe,[n.renderSlot(c.$slots,"total",{},()=>[n.createTextVNode(n.toDisplayString(m.total),1)])]),m.subTotal||c.$slots.subTotal?(n.openBlock(),n.createElementBlock("span",_he,[n.renderSlot(c.$slots,"subTotal",{},()=>[n.createVNode(M,{flag:m.status},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(m.subTotal),1)]),_:1},8,["flag"])])])):n.createCommentVNode("",!0)],4)])}var J$=l(mhe,[["render",bhe]]),eU={exports:{}};/*! @preserve
* numeral.js
* version : 2.0.6
* author : Adam Draper
* license : MIT
* http://adamwdraper.github.com/Numeral-js/
*/(function(c){(function(u,m){c.exports?c.exports=m():u.numeral=m()})(Z,function(){var u,m,S="2.0.6",b={},v={},M={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},N={currentLocale:M.currentLocale,zeroFormat:M.zeroFormat,nullFormat:M.nullFormat,defaultFormat:M.defaultFormat,scalePercentBy100:M.scalePercentBy100};function X(U,H){this._input=U,this._value=H}return u=function(U){var H,re,xe,ye;if(u.isNumeral(U))H=U.value();else if(U===0||typeof U>"u")H=0;else if(U===null||m.isNaN(U))H=null;else if(typeof U=="string")if(N.zeroFormat&&U===N.zeroFormat)H=0;else if(N.nullFormat&&U===N.nullFormat||!U.replace(/[^0-9]+/g,"").length)H=null;else{for(re in b)if(ye=typeof b[re].regexps.unformat=="function"?b[re].regexps.unformat():b[re].regexps.unformat,ye&&U.match(ye)){xe=b[re].unformat;break}xe=xe||u._.stringToNumber,H=xe(U)}else H=Number(U)||null;return new X(U,H)},u.version=S,u.isNumeral=function(U){return U instanceof X},u._=m={numberToFormat:function(U,H,re){var xe=v[u.options.currentLocale],ye=!1,me=!1,ne=0,Te="",Xt=1e12,_t=1e9,At=1e6,He=1e3,ke="",it=!1,qe,Jt,ei,Rt,Et,Nt,ai;if(U=U||0,Jt=Math.abs(U),u._.includes(H,"(")?(ye=!0,H=H.replace(/[\(|\)]/g,"")):(u._.includes(H,"+")||u._.includes(H,"-"))&&(Et=u._.includes(H,"+")?H.indexOf("+"):U<0?H.indexOf("-"):-1,H=H.replace(/[\+|\-]/g,"")),u._.includes(H,"a")&&(qe=H.match(/a(k|m|b|t)?/),qe=qe?qe[1]:!1,u._.includes(H," a")&&(Te=" "),H=H.replace(new RegExp(Te+"a[kmbt]?"),""),Jt>=Xt&&!qe||qe==="t"?(Te+=xe.abbreviations.trillion,U=U/Xt):Jt<Xt&&Jt>=_t&&!qe||qe==="b"?(Te+=xe.abbreviations.billion,U=U/_t):Jt<_t&&Jt>=At&&!qe||qe==="m"?(Te+=xe.abbreviations.million,U=U/At):(Jt<At&&Jt>=He&&!qe||qe==="k")&&(Te+=xe.abbreviations.thousand,U=U/He)),u._.includes(H,"[.]")&&(me=!0,H=H.replace("[.]",".")),ei=U.toString().split(".")[0],Rt=H.split(".")[1],Nt=H.indexOf(","),ne=(H.split(".")[0].split(",")[0].match(/0/g)||[]).length,Rt?(u._.includes(Rt,"[")?(Rt=Rt.replace("]",""),Rt=Rt.split("["),ke=u._.toFixed(U,Rt[0].length+Rt[1].length,re,Rt[1].length)):ke=u._.toFixed(U,Rt.length,re),ei=ke.split(".")[0],u._.includes(ke,".")?ke=xe.delimiters.decimal+ke.split(".")[1]:ke="",me&&Number(ke.slice(1))===0&&(ke="")):ei=u._.toFixed(U,0,re),Te&&!qe&&Number(ei)>=1e3&&Te!==xe.abbreviations.trillion)switch(ei=String(Number(ei)/1e3),Te){case xe.abbreviations.thousand:Te=xe.abbreviations.million;break;case xe.abbreviations.million:Te=xe.abbreviations.billion;break;case xe.abbreviations.billion:Te=xe.abbreviations.trillion;break}if(u._.includes(ei,"-")&&(ei=ei.slice(1),it=!0),ei.length<ne)for(var Dt=ne-ei.length;Dt>0;Dt--)ei="0"+ei;return Nt>-1&&(ei=ei.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+xe.delimiters.thousands)),H.indexOf(".")===0&&(ei=""),ai=ei+ke+(Te||""),ye?ai=(ye&&it?"(":"")+ai+(ye&&it?")":""):Et>=0?ai=Et===0?(it?"-":"+")+ai:ai+(it?"-":"+"):it&&(ai="-"+ai),ai},stringToNumber:function(U){var H=v[N.currentLocale],re=U,xe={thousand:3,million:6,billion:9,trillion:12},ye,me,ne;if(N.zeroFormat&&U===N.zeroFormat)me=0;else if(N.nullFormat&&U===N.nullFormat||!U.replace(/[^0-9]+/g,"").length)me=null;else{me=1,H.delimiters.decimal!=="."&&(U=U.replace(/\./g,"").replace(H.delimiters.decimal,"."));for(ye in xe)if(ne=new RegExp("[^a-zA-Z]"+H.abbreviations[ye]+"(?:\\)|(\\"+H.currency.symbol+")?(?:\\))?)?$"),re.match(ne)){me*=Math.pow(10,xe[ye]);break}me*=(U.split("-").length+Math.min(U.split("(").length-1,U.split(")").length-1))%2?1:-1,U=U.replace(/[^0-9\.]+/g,""),me*=Number(U)}return me},isNaN:function(U){return typeof U=="number"&&isNaN(U)},includes:function(U,H){return U.indexOf(H)!==-1},insert:function(U,H,re){return U.slice(0,re)+H+U.slice(re)},reduce:function(U,H){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof H!="function")throw new TypeError(H+" is not a function");var re=Object(U),xe=re.length>>>0,ye=0,me;if(arguments.length===3)me=arguments[2];else{for(;ye<xe&&!(ye in re);)ye++;if(ye>=xe)throw new TypeError("Reduce of empty array with no initial value");me=re[ye++]}for(;ye<xe;ye++)ye in re&&(me=H(me,re[ye],ye,re));return me},multiplier:function(U){var H=U.toString().split(".");return H.length<2?1:Math.pow(10,H[1].length)},correctionFactor:function(){var U=Array.prototype.slice.call(arguments);return U.reduce(function(H,re){var xe=m.multiplier(re);return H>xe?H:xe},1)},toFixed:function(U,H,re,xe){var ye=U.toString().split("."),me=H-(xe||0),ne,Te,Xt,_t;return ye.length===2?ne=Math.min(Math.max(ye[1].length,me),H):ne=me,Xt=Math.pow(10,ne),_t=(re(U+"e+"+ne)/Xt).toFixed(ne),xe>H-ne&&(Te=new RegExp("\\.?0{1,"+(xe-(H-ne))+"}$"),_t=_t.replace(Te,"")),_t}},u.options=N,u.formats=b,u.locales=v,u.locale=function(U){return U&&(N.currentLocale=U.toLowerCase()),N.currentLocale},u.localeData=function(U){if(!U)return v[N.currentLocale];if(U=U.toLowerCase(),!v[U])throw new Error("Unknown locale : "+U);return v[U]},u.reset=function(){for(var U in M)N[U]=M[U]},u.zeroFormat=function(U){N.zeroFormat=typeof U=="string"?U:null},u.nullFormat=function(U){N.nullFormat=typeof U=="string"?U:null},u.defaultFormat=function(U){N.defaultFormat=typeof U=="string"?U:"0.0"},u.register=function(U,H,re){if(H=H.toLowerCase(),this[U+"s"][H])throw new TypeError(H+" "+U+" already registered.");return this[U+"s"][H]=re,re},u.validate=function(U,H){var re,xe,ye,me,ne,Te,Xt,_t;if(typeof U!="string"&&(U+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",U)),U=U.trim(),U.match(/^\d+$/))return!0;if(U==="")return!1;try{Xt=u.localeData(H)}catch{Xt=u.localeData(u.locale())}return ye=Xt.currency.symbol,ne=Xt.abbreviations,re=Xt.delimiters.decimal,Xt.delimiters.thousands==="."?xe="\\.":xe=Xt.delimiters.thousands,_t=U.match(/^[^\d]+/),_t!==null&&(U=U.substr(1),_t[0]!==ye)||(_t=U.match(/[^\d]+$/),_t!==null&&(U=U.slice(0,-1),_t[0]!==ne.thousand&&_t[0]!==ne.million&&_t[0]!==ne.billion&&_t[0]!==ne.trillion))?!1:(Te=new RegExp(xe+"{2}"),U.match(/[^\d.,]/g)?!1:(me=U.split(re),me.length>2?!1:me.length<2?!!me[0].match(/^\d+.*\d$/)&&!me[0].match(Te):me[0].length===1?!!me[0].match(/^\d+$/)&&!me[0].match(Te)&&!!me[1].match(/^\d+$/):!!me[0].match(/^\d+.*\d$/)&&!me[0].match(Te)&&!!me[1].match(/^\d+$/)))},u.fn=X.prototype={clone:function(){return u(this)},format:function(U,H){var re=this._value,xe=U||N.defaultFormat,ye,me,ne;if(H=H||Math.round,re===0&&N.zeroFormat!==null)me=N.zeroFormat;else if(re===null&&N.nullFormat!==null)me=N.nullFormat;else{for(ye in b)if(xe.match(b[ye].regexps.format)){ne=b[ye].format;break}ne=ne||u._.numberToFormat,me=ne(re,xe,H)}return me},value:function(){return this._value},input:function(){return this._input},set:function(U){return this._value=Number(U),this},add:function(U){var H=m.correctionFactor.call(null,this._value,U);function re(xe,ye,me,ne){return xe+Math.round(H*ye)}return this._value=m.reduce([this._value,U],re,0)/H,this},subtract:function(U){var H=m.correctionFactor.call(null,this._value,U);function re(xe,ye,me,ne){return xe-Math.round(H*ye)}return this._value=m.reduce([U],re,Math.round(this._value*H))/H,this},multiply:function(U){function H(re,xe,ye,me){var ne=m.correctionFactor(re,xe);return Math.round(re*ne)*Math.round(xe*ne)/Math.round(ne*ne)}return this._value=m.reduce([this._value,U],H,1),this},divide:function(U){function H(re,xe,ye,me){var ne=m.correctionFactor(re,xe);return Math.round(re*ne)/Math.round(xe*ne)}return this._value=m.reduce([this._value,U],H),this},difference:function(U){return Math.abs(u(this._value).subtract(U).value())}},u.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(U){var H=U%10;return~~(U%100/10)===1?"th":H===1?"st":H===2?"nd":H===3?"rd":"th"},currency:{symbol:"$"}}),function(){u.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(U,H,re){var xe=u._.includes(H," BPS")?" ":"",ye;return U=U*1e4,H=H.replace(/\s?BPS/,""),ye=u._.numberToFormat(U,H,re),u._.includes(ye,")")?(ye=ye.split(""),ye.splice(-1,0,xe+"BPS"),ye=ye.join("")):ye=ye+xe+"BPS",ye},unformat:function(U){return+(u._.stringToNumber(U)*1e-4).toFixed(15)}})}(),function(){var U={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},H={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},re=U.suffixes.concat(H.suffixes.filter(function(ye){return U.suffixes.indexOf(ye)<0})),xe=re.join("|");xe="("+xe.replace("B","B(?!PS)")+")",u.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(xe)},format:function(ye,me,ne){var Te,Xt=u._.includes(me,"ib")?H:U,_t=u._.includes(me," b")||u._.includes(me," ib")?" ":"",At,He,ke;for(me=me.replace(/\s?i?b/,""),At=0;At<=Xt.suffixes.length;At++)if(He=Math.pow(Xt.base,At),ke=Math.pow(Xt.base,At+1),ye===null||ye===0||ye>=He&&ye<ke){_t+=Xt.suffixes[At],He>0&&(ye=ye/He);break}return Te=u._.numberToFormat(ye,me,ne),Te+_t},unformat:function(ye){var me=u._.stringToNumber(ye),ne,Te;if(me){for(ne=U.suffixes.length-1;ne>=0;ne--){if(u._.includes(ye,U.suffixes[ne])){Te=Math.pow(U.base,ne);break}if(u._.includes(ye,H.suffixes[ne])){Te=Math.pow(H.base,ne);break}}me*=Te||1}return me}})}(),function(){u.register("format","currency",{regexps:{format:/(\$)/},format:function(U,H,re){var xe=u.locales[u.options.currentLocale],ye={before:H.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:H.match(/([\+|\-|\)|\s|\$]*)$/)[0]},me,ne,Te;for(H=H.replace(/\s?\$\s?/,""),me=u._.numberToFormat(U,H,re),U>=0?(ye.before=ye.before.replace(/[\-\(]/,""),ye.after=ye.after.replace(/[\-\)]/,"")):U<0&&!u._.includes(ye.before,"-")&&!u._.includes(ye.before,"(")&&(ye.before="-"+ye.before),Te=0;Te<ye.before.length;Te++)switch(ne=ye.before[Te],ne){case"$":me=u._.insert(me,xe.currency.symbol,Te);break;case" ":me=u._.insert(me," ",Te+xe.currency.symbol.length-1);break}for(Te=ye.after.length-1;Te>=0;Te--)switch(ne=ye.after[Te],ne){case"$":me=Te===ye.after.length-1?me+xe.currency.symbol:u._.insert(me,xe.currency.symbol,-(ye.after.length-(1+Te)));break;case" ":me=Te===ye.after.length-1?me+" ":u._.insert(me," ",-(ye.after.length-(1+Te)+xe.currency.symbol.length-1));break}return me}})}(),function(){u.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(U,H,re){var xe,ye=typeof U=="number"&&!u._.isNaN(U)?U.toExponential():"0e+0",me=ye.split("e");return H=H.replace(/e[\+|\-]{1}0/,""),xe=u._.numberToFormat(Number(me[0]),H,re),xe+"e"+me[1]},unformat:function(U){var H=u._.includes(U,"e+")?U.split("e+"):U.split("e-"),re=Number(H[0]),xe=Number(H[1]);xe=u._.includes(U,"e-")?xe*=-1:xe;function ye(me,ne,Te,Xt){var _t=u._.correctionFactor(me,ne),At=me*_t*(ne*_t)/(_t*_t);return At}return u._.reduce([re,Math.pow(10,xe)],ye,1)}})}(),function(){u.register("format","ordinal",{regexps:{format:/(o)/},format:function(U,H,re){var xe=u.locales[u.options.currentLocale],ye,me=u._.includes(H," o")?" ":"";return H=H.replace(/\s?o/,""),me+=xe.ordinal(U),ye=u._.numberToFormat(U,H,re),ye+me}})}(),function(){u.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(U,H,re){var xe=u._.includes(H," %")?" ":"",ye;return u.options.scalePercentBy100&&(U=U*100),H=H.replace(/\s?\%/,""),ye=u._.numberToFormat(U,H,re),u._.includes(ye,")")?(ye=ye.split(""),ye.splice(-1,0,xe+"%"),ye=ye.join("")):ye=ye+xe+"%",ye},unformat:function(U){var H=u._.stringToNumber(U);return u.options.scalePercentBy100?H*.01:H}})}(),function(){u.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(U,H,re){var xe=Math.floor(U/60/60),ye=Math.floor((U-xe*60*60)/60),me=Math.round(U-xe*60*60-ye*60);return xe+":"+(ye<10?"0"+ye:ye)+":"+(me<10?"0"+me:me)},unformat:function(U){var H=U.split(":"),re=0;return H.length===3?(re=re+Number(H[0])*60*60,re=re+Number(H[1])*60,re=re+Number(H[2])):H.length===2&&(re=re+Number(H[0])*60,re=re+Number(H[1])),Number(re)}})}(),u})})(eU);var whe=eU.exports;const Ohe={name:"Numeral",emits:["on-change"],props:{value:{type:[String,Number]},format:{type:String},prefix:{type:[String,Number]},suffix:{type:[String,Number]}},data(){return{currentValue:""}},watch:{value(){this.init()},format(){this.init()}},methods:{init(){if(this.value!==void 0){const c=whe(this.value);this.format?this.currentValue=c.format(this.format):this.currentValue=c.value(),this.$emit("on-change",this.currentValue)}},getValue(){return this.currentValue}},mounted(){this.init()}},She={class:"ivu-numeral"};function Che(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("span",She,[n.renderSlot(c.$slots,"prefix",{},()=>[n.createTextVNode(n.toDisplayString(m.prefix),1)]),n.createTextVNode(n.toDisplayString(b.currentValue),1),n.renderSlot(c.$slots,"suffix",{},()=>[n.createTextVNode(n.toDisplayString(m.suffix),1)])])}var tU=l(Ohe,[["render",Che]]);const The="ivu-select-group",Ahe={name:"OptionGroup",props:{label:{type:String,default:""}},provide(){return{OptionGroupInstance:this}},inject:["SelectInstance"],data(){return{prefixCls:The,hidden:!1,id:te(6),optionList:[]}},computed:{show(){return this.optionList.find(c=>c.proxy&&c.proxy.isShow)}}};function Ehe(c,u,m,S,b,v){return n.withDirectives((n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass([b.prefixCls+"-wrap"])},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-title"])},n.toDisplayString(m.label),3),n.createElementVNode("ul",null,[n.createElementVNode("li",{class:n.normalizeClass([b.prefixCls]),ref:"options"},[n.renderSlot(c.$slots,"default")],2)])],2)),[[n.vShow,v.show]])}var iU=l(Ahe,[["render",Ehe]]);const cM="ivu-page";function Mhe(c){return/^[1-9][0-9]*$/.test(c+"")}const khe={name:"PageOption",mixins:[Sn],components:{iSelect:lo,iOption:ds},emits:["on-size","on-page"],props:{pageSizeOpts:Array,showSizer:Boolean,showElevator:Boolean,current:Number,_current:Number,pageSize:Number,allPages:Number,isSmall:Boolean,placement:String,transfer:Boolean,disabled:Boolean,eventsEnabled:Boolean},data(){return{currentPageSize:this.pageSize}},watch:{pageSize(c){this.currentPageSize=c}},computed:{size(){return this.isSmall?"small":"default"},optsClasses(){return[`${cM}-options`]},sizerClasses(){return[`${cM}-options-sizer`]},ElevatorClasses(){return[`${cM}-options-elevator`]}},methods:{changeSize(){this.$emit("on-size",this.currentPageSize)},changePage(c){let u=c.target.value.trim(),m=0;if(Mhe(u)){if(u=Number(u),u!=this.current){const S=this.allPages;u>S?m=S:m=u}}else m=1;m&&(this.$emit("on-page",m),c.target.value=m)}}},Phe=["value","disabled"];function Ihe(c,u,m,S,b,v){const M=n.resolveComponent("i-option"),N=n.resolveComponent("i-select");return m.showSizer||m.showElevator?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.optsClasses)},[m.showSizer?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.sizerClasses)},[n.createVNode(N,{modelValue:b.currentPageSize,"onUpdate:modelValue":u[0]||(u[0]=X=>b.currentPageSize=X),size:v.size,placement:m.placement,transfer:m.transfer,disabled:m.disabled,eventsEnabled:m.eventsEnabled,onOnChange:v.changeSize},{default:n.withCtx(()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.pageSizeOpts,X=>(n.openBlock(),n.createBlock(M,{key:X,value:X,style:{"text-align":"center"}},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(X)+" "+n.toDisplayString(c.t("i.page.page")),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","size","placement","transfer","disabled","eventsEnabled","onOnChange"])],2)):n.createCommentVNode("",!0),m.showElevator?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass(v.ElevatorClasses)},[n.createTextVNode(n.toDisplayString(c.t("i.page.goto"))+" ",1),n.createElementVNode("input",{type:"text",value:m._current,autocomplete:"off",spellcheck:"false",disabled:m.disabled,onKeyup:u[1]||(u[1]=n.withKeys((...X)=>v.changePage&&v.changePage(...X),["enter"]))},null,40,Phe),n.createTextVNode(" "+n.toDisplayString(c.t("i.page.p")),1)],2)):n.createCommentVNode("",!0)],2)):n.createCommentVNode("",!0)}var Bhe=l(khe,[["render",Ihe]]);const zr="ivu-page",Rhe={name:"Page",mixins:[Sn],components:{Options:Bhe},emits:["update:modelValue","on-change","on-prev","on-next","on-page-size-change"],props:{modelValue:{type:Number,default:1},total:{type:Number,default:0},pageSize:{type:Number,default:10},pageSizeOpts:{type:Array,default(){return[10,20,30,40]}},placement:{validator(c){return T(c,["top","bottom"])},default:"bottom"},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},size:{validator(c){return T(c,["small","default"])}},simple:{type:Boolean,default:!1},showTotal:{type:Boolean,default:!1},showElevator:{type:Boolean,default:!1},showSizer:{type:Boolean,default:!1},className:{type:String},styles:{type:Object},prevText:{type:String,default:""},nextText:{type:String,default:""},disabled:{type:Boolean,default:!1},eventsEnabled:{type:Boolean,default:!1}},data(){return{prefixCls:zr,currentPage:this.modelValue,currentPageSize:this.pageSize}},watch:{total(c){let u=Math.ceil(c/this.currentPageSize);u<this.currentPage&&(this.currentPage=u===0?1:u)},modelValue(c){this.currentPage=c},pageSize(c){this.currentPageSize=c}},computed:{isSmall(){return this.size==="small"},allPages(){const c=Math.ceil(this.total/this.currentPageSize);return c===0?1:c},simpleWrapClasses(){return[`${zr}`,`${zr}-simple`,{[`${this.className}`]:!!this.className}]},simplePagerClasses(){return`${zr}-simple-pager`},wrapClasses(){return[`${zr}`,{[`${this.className}`]:!!this.className,[`${zr}-with-disabled`]:this.disabled,mini:this.size==="small"}]},prevClasses(){return[`${zr}-prev`,{[`${zr}-disabled`]:this.currentPage===1||this.disabled,[`${zr}-custom-text`]:this.prevText!==""}]},nextClasses(){return[`${zr}-next`,{[`${zr}-disabled`]:this.currentPage===this.allPages||this.disabled,[`${zr}-custom-text`]:this.nextText!==""}]},firstPageClasses(){return[`${zr}-item`,{[`${zr}-item-active`]:this.currentPage===1}]},lastPageClasses(){return[`${zr}-item`,{[`${zr}-item-active`]:this.currentPage===this.allPages}]}},methods:{changePage(c){this.disabled||this.currentPage!=c&&(this.currentPage=c,this.$emit("update:modelValue",c),this.$emit("on-change",c))},prev(){if(this.disabled)return;const c=this.currentPage;if(c<=1)return!1;this.changePage(c-1),this.$emit("on-prev",c-1)},next(){if(this.disabled)return;const c=this.currentPage;if(c>=this.allPages)return!1;this.changePage(c+1),this.$emit("on-next",c+1)},fastPrev(){if(this.disabled)return;const c=this.currentPage-5;c>0?this.changePage(c):this.changePage(1)},fastNext(){if(this.disabled)return;const c=this.currentPage+5;c>this.allPages?this.changePage(this.allPages):this.changePage(c)},onSize(c){this.disabled||(this.currentPageSize=c,this.$emit("on-page-size-change",c),this.changePage(1))},onPage(c){this.disabled||this.changePage(c)},keyDown(c){const u=c.keyCode;u>=48&&u<=57||u>=96&&u<=105||u===8||u===37||u===39||c.preventDefault()},keyUp(c){const u=c.keyCode,m=parseInt(c.target.value);if(u===38)this.prev();else if(u===40)this.next();else if(u===13){let S=1;m>this.allPages?S=this.allPages:m<=0||!m?S=1:S=m,c.target.value=S,this.changePage(S)}}}},Dhe=["title"],Lhe=[n.createElementVNode("a",null,[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-back"})],-1)],Nhe=["title"],Vhe=["value","disabled"],$he=n.createElementVNode("span",null,"/",-1),Uhe=["title"],Fhe=[n.createElementVNode("a",null,[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-forward"})],-1)],zhe=["title"],Xhe={key:1,class:"ivu-icon ivu-icon-ios-arrow-back"},Whe=[n.createElementVNode("a",null,"1",-1)],Hhe=["title"],Ghe=[n.createElementVNode("a",null,[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-back"}),n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-more"})],-1)],Qhe=["title"],Yhe=["title"],jhe=["title"],qhe=["title"],Zhe=["title"],Khe=["title"],Jhe=["title"],eue=["title"],tue=[n.createElementVNode("a",null,[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-forward"}),n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-more"})],-1)],iue=["title"],nue=["title"],sue={key:1,class:"ivu-icon ivu-icon-ios-arrow-forward"};function rue(c,u,m,S,b,v){const M=n.resolveComponent("Options");return m.simple?(n.openBlock(),n.createElementBlock("ul",{key:0,class:n.normalizeClass(v.simpleWrapClasses),style:n.normalizeStyle(m.styles)},[n.createElementVNode("li",{title:c.t("i.page.prev"),class:n.normalizeClass(v.prevClasses),onClick:u[0]||(u[0]=(...N)=>v.prev&&v.prev(...N))},Lhe,10,Dhe),n.createElementVNode("div",{class:n.normalizeClass(v.simplePagerClasses),title:b.currentPage+"/"+v.allPages},[n.createElementVNode("input",{type:"text",value:b.currentPage,autocomplete:"off",spellcheck:"false",disabled:m.disabled,onKeydown:u[1]||(u[1]=(...N)=>v.keyDown&&v.keyDown(...N)),onKeyup:u[2]||(u[2]=(...N)=>v.keyUp&&v.keyUp(...N)),onChange:u[3]||(u[3]=(...N)=>v.keyUp&&v.keyUp(...N))},null,40,Vhe),$he,n.createTextVNode(" "+n.toDisplayString(v.allPages),1)],10,Nhe),n.createElementVNode("li",{title:c.t("i.page.next"),class:n.normalizeClass(v.nextClasses),onClick:u[4]||(u[4]=(...N)=>v.next&&v.next(...N))},Fhe,10,Uhe)],6)):(n.openBlock(),n.createElementBlock("ul",{key:1,class:n.normalizeClass(v.wrapClasses),style:n.normalizeStyle(m.styles)},[m.showTotal?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass([b.prefixCls+"-total"])},[n.renderSlot(c.$slots,"default",{},()=>[n.createTextVNode(n.toDisplayString(c.t("i.page.total"))+" "+n.toDisplayString(m.total)+" ",1),m.total<=1?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createTextVNode(n.toDisplayString(c.t("i.page.item")),1)],64)):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createTextVNode(n.toDisplayString(c.t("i.page.items")),1)],64))])],2)):n.createCommentVNode("",!0),n.createElementVNode("li",{title:c.t("i.page.prev"),class:n.normalizeClass(v.prevClasses),onClick:u[5]||(u[5]=(...N)=>v.prev&&v.prev(...N))},[n.createElementVNode("a",null,[m.prevText!==""?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createTextVNode(n.toDisplayString(m.prevText),1)],64)):(n.openBlock(),n.createElementBlock("i",Xhe))])],10,zhe),n.createElementVNode("li",{title:"1",class:n.normalizeClass(v.firstPageClasses),onClick:u[6]||(u[6]=N=>v.changePage(1))},Whe,2),b.currentPage>5?(n.openBlock(),n.createElementBlock("li",{key:1,title:c.t("i.page.prev5"),class:n.normalizeClass([b.prefixCls+"-item-jump-prev"]),onClick:u[7]||(u[7]=(...N)=>v.fastPrev&&v.fastPrev(...N))},Ghe,10,Hhe)):n.createCommentVNode("",!0),b.currentPage===5?(n.openBlock(),n.createElementBlock("li",{key:2,title:b.currentPage-3,class:n.normalizeClass([b.prefixCls+"-item"]),onClick:u[8]||(u[8]=N=>v.changePage(b.currentPage-3))},[n.createElementVNode("a",null,n.toDisplayString(b.currentPage-3),1)],10,Qhe)):n.createCommentVNode("",!0),b.currentPage-2>1?(n.openBlock(),n.createElementBlock("li",{key:3,title:b.currentPage-2,class:n.normalizeClass([b.prefixCls+"-item"]),onClick:u[9]||(u[9]=N=>v.changePage(b.currentPage-2))},[n.createElementVNode("a",null,n.toDisplayString(b.currentPage-2),1)],10,Yhe)):n.createCommentVNode("",!0),b.currentPage-1>1?(n.openBlock(),n.createElementBlock("li",{key:4,title:b.currentPage-1,class:n.normalizeClass([b.prefixCls+"-item"]),onClick:u[10]||(u[10]=N=>v.changePage(b.currentPage-1))},[n.createElementVNode("a",null,n.toDisplayString(b.currentPage-1),1)],10,jhe)):n.createCommentVNode("",!0),b.currentPage!=1&&b.currentPage!=v.allPages?(n.openBlock(),n.createElementBlock("li",{key:5,title:b.currentPage,class:n.normalizeClass([b.prefixCls+"-item",b.prefixCls+"-item-active"])},[n.createElementVNode("a",null,n.toDisplayString(b.currentPage),1)],10,qhe)):n.createCommentVNode("",!0),b.currentPage+1<v.allPages?(n.openBlock(),n.createElementBlock("li",{key:6,title:b.currentPage+1,class:n.normalizeClass([b.prefixCls+"-item"]),onClick:u[11]||(u[11]=N=>v.changePage(b.currentPage+1))},[n.createElementVNode("a",null,n.toDisplayString(b.currentPage+1),1)],10,Zhe)):n.createCommentVNode("",!0),b.currentPage+2<v.allPages?(n.openBlock(),n.createElementBlock("li",{key:7,title:b.currentPage+2,class:n.normalizeClass([b.prefixCls+"-item"]),onClick:u[12]||(u[12]=N=>v.changePage(b.currentPage+2))},[n.createElementVNode("a",null,n.toDisplayString(b.currentPage+2),1)],10,Khe)):n.createCommentVNode("",!0),v.allPages-b.currentPage===4?(n.openBlock(),n.createElementBlock("li",{key:8,title:b.currentPage+3,class:n.normalizeClass([b.prefixCls+"-item"]),onClick:u[13]||(u[13]=N=>v.changePage(b.currentPage+3))},[n.createElementVNode("a",null,n.toDisplayString(b.currentPage+3),1)],10,Jhe)):n.createCommentVNode("",!0),v.allPages-b.currentPage>=5?(n.openBlock(),n.createElementBlock("li",{key:9,title:c.t("i.page.next5"),class:n.normalizeClass([b.prefixCls+"-item-jump-next"]),onClick:u[14]||(u[14]=(...N)=>v.fastNext&&v.fastNext(...N))},tue,10,eue)):n.createCommentVNode("",!0),v.allPages>1?(n.openBlock(),n.createElementBlock("li",{key:10,title:v.allPages,class:n.normalizeClass(v.lastPageClasses),onClick:u[15]||(u[15]=N=>v.changePage(v.allPages))},[n.createElementVNode("a",null,n.toDisplayString(v.allPages),1)],10,iue)):n.createCommentVNode("",!0),n.createElementVNode("li",{title:c.t("i.page.next"),class:n.normalizeClass(v.nextClasses),onClick:u[16]||(u[16]=(...N)=>v.next&&v.next(...N))},[n.createElementVNode("a",null,[m.nextText!==""?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createTextVNode(n.toDisplayString(m.nextText),1)],64)):(n.openBlock(),n.createElementBlock("i",sue))])],10,nue),n.createVNode(M,{"show-sizer":m.showSizer,"page-size":b.currentPageSize,"page-size-opts":m.pageSizeOpts,placement:m.placement,transfer:m.transfer,"show-elevator":m.showElevator,_current:b.currentPage,current:b.currentPage,disabled:m.disabled,"all-pages":v.allPages,"is-small":v.isSmall,eventsEnabled:m.eventsEnabled,onOnSize:v.onSize,onOnPage:v.onPage},null,8,["show-sizer","page-size","page-size-opts","placement","transfer","show-elevator","_current","current","disabled","all-pages","is-small","eventsEnabled","onOnSize","onOnPage"])],6))}var nU=l(Rhe,[["render",rue]]);const oue={name:"PageHeader",components:{Breadcrumb:vE,BreadcrumbItem:xE,Divider:yw,Icon:O,Tabs:Pw,TabPane:Bw},emits:["on-tab-change","on-back"],props:{title:{type:String},back:{type:Boolean,default:!1},logo:{type:String},action:{type:String},content:{type:String},extra:{type:String},breadcrumbList:{type:Array},hiddenBreadcrumb:{type:Boolean,default:!1},tabList:{type:Array},tabActiveKey:{type:String},wide:{type:Boolean,default:!1}},computed:{classes(){return{"ivu-page-header-wide":this.wide}}},methods:{handleTabChange(c){const u=this.tabList.find(m=>m.name===c);this.$emit("on-tab-change",JSON.parse(JSON.stringify(u)))},handleBack(){this.$emit("on-back")}}},aue={key:0,class:"ivu-page-header-breadcrumb"},lue={class:"ivu-page-header-detail"},cue={key:1,class:"ivu-page-header-logo"},hue=["src"],uue={class:"ivu-page-header-main"},due={class:"ivu-page-header-row"},fue={key:1,class:"ivu-page-header-title"},pue={key:2,class:"ivu-page-header-action"},mue={class:"ivu-page-header-row"},gue={key:0,class:"ivu-page-header-content"},yue={key:1,class:"ivu-page-header-extra"},vue={key:1,class:"ivu-page-header-tabs"};function xue(c,u,m,S,b,v){const M=n.resolveComponent("BreadcrumbItem"),N=n.resolveComponent("Breadcrumb"),X=n.resolveComponent("Icon"),U=n.resolveComponent("Divider"),H=n.resolveComponent("TabPane"),re=n.resolveComponent("Tabs");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["ivu-page-header",v.classes])},[c.$slots.breadcrumb||!m.hiddenBreadcrumb?(n.openBlock(),n.createElementBlock("div",aue,[n.renderSlot(c.$slots,"breadcrumb",{},()=>[n.createVNode(N,null,{default:n.withCtx(()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.breadcrumbList,(xe,ye)=>(n.openBlock(),n.createBlock(M,{key:ye,to:xe.to,replace:xe.replace,target:xe.target},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(xe.title),1)]),_:2},1032,["to","replace","target"]))),128))]),_:1})])])):n.createCommentVNode("",!0),n.createElementVNode("div",lue,[m.back||c.$slots.back?(n.openBlock(),n.createElementBlock("div",{key:0,class:"ivu-page-header-back",onClick:u[0]||(u[0]=(...xe)=>v.handleBack&&v.handleBack(...xe))},[n.renderSlot(c.$slots,"back",{},()=>[n.createVNode(X,{type:"md-arrow-back"})]),n.createVNode(U,{type:"vertical"})])):n.createCommentVNode("",!0),m.logo||c.$slots.logo?(n.openBlock(),n.createElementBlock("div",cue,[n.renderSlot(c.$slots,"logo",{},()=>[n.createElementVNode("img",{src:m.logo},null,8,hue)])])):n.createCommentVNode("",!0),n.createElementVNode("div",uue,[n.createElementVNode("div",due,[m.back||c.$slots.back?(n.openBlock(),n.createElementBlock("div",{key:0,class:"ivu-page-header-back",onClick:u[1]||(u[1]=(...xe)=>v.handleBack&&v.handleBack(...xe))},[n.renderSlot(c.$slots,"back",{},()=>[n.createVNode(X,{type:"md-arrow-back"})]),n.createVNode(U,{type:"vertical"})])):n.createCommentVNode("",!0),m.title||c.$slots.title?(n.openBlock(),n.createElementBlock("div",fue,[n.renderSlot(c.$slots,"title",{},()=>[n.createTextVNode(n.toDisplayString(m.title),1)])])):n.createCommentVNode("",!0),m.action||c.$slots.action?(n.openBlock(),n.createElementBlock("div",pue,[n.renderSlot(c.$slots,"action",{},()=>[n.createTextVNode(n.toDisplayString(m.action),1)])])):n.createCommentVNode("",!0)]),n.createElementVNode("div",mue,[m.content||c.$slots.content?(n.openBlock(),n.createElementBlock("div",gue,[n.renderSlot(c.$slots,"content",{},()=>[n.createTextVNode(n.toDisplayString(m.content),1)])])):n.createCommentVNode("",!0),m.extra||c.$slots.extra?(n.openBlock(),n.createElementBlock("div",yue,[n.renderSlot(c.$slots,"extra",{},()=>[n.createTextVNode(n.toDisplayString(m.extra),1)])])):n.createCommentVNode("",!0)])])]),m.tabList&&m.tabList.length?(n.openBlock(),n.createElementBlock("div",vue,[n.createVNode(re,{animated:!1,"model-value":m.tabActiveKey,onOnClick:v.handleTabChange},{default:n.withCtx(()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.tabList,(xe,ye)=>(n.openBlock(),n.createBlock(H,{key:ye,label:xe.label,name:xe.name},null,8,["label","name"]))),128))]),_:1},8,["model-value","onOnClick"])])):n.createCommentVNode("",!0)],2)}var sU=l(oue,[["render",xue]]);const _ue=n.defineComponent({name:"CollapseTransition",props:{ready:{type:Boolean,default:!0}},setup(c){return{on:{beforeEnter(u){!c.ready||(J(u,"collapse-transition"),u.dataset||(u.dataset={}),u.dataset.oldPaddingTop=u.style.paddingTop,u.dataset.oldPaddingBottom=u.style.paddingBottom,u.style.height="0",u.style.paddingTop=0,u.style.paddingBottom=0)},enter(u){!c.ready||(u.dataset.oldOverflow=u.style.overflow,u.scrollHeight!==0?(u.style.height=u.scrollHeight+"px",u.style.paddingTop=u.dataset.oldPaddingTop,u.style.paddingBottom=u.dataset.oldPaddingBottom):(u.style.height="",u.style.paddingTop=u.dataset.oldPaddingTop,u.style.paddingBottom=u.dataset.oldPaddingBottom),u.style.overflow="hidden")},afterEnter(u){!c.ready||(ue(u,"collapse-transition"),u.style.height="",u.style.overflow=u.dataset.oldOverflow)},beforeLeave(u){!c.ready||(u.dataset||(u.dataset={}),u.dataset.oldPaddingTop=u.style.paddingTop,u.dataset.oldPaddingBottom=u.style.paddingBottom,u.dataset.oldOverflow=u.style.overflow,u.style.height=u.scrollHeight+"px",u.style.overflow="hidden")},leave(u){!c.ready||u.scrollHeight!==0&&(J(u,"collapse-transition"),u.style.height=0,u.style.paddingTop=0,u.style.paddingBottom=0)},afterLeave(u){!c.ready||(ue(u,"collapse-transition"),u.style.height="",u.style.overflow=u.dataset.oldOverflow,u.style.paddingTop=u.dataset.oldPaddingTop,u.style.paddingBottom=u.dataset.oldPaddingBottom)}}}}});function bue(c,u,m,S,b,v){return n.openBlock(),n.createBlock(n.Transition,n.toHandlers(c.on),{default:n.withCtx(()=>[n.renderSlot(c.$slots,"default")]),_:3},16)}var hM=l(_ue,[["render",bue]]);const _v="ivu-collapse",wue={name:"Panel",components:{Icon:O,CollapseTransition:hM},inject:["CollapseInstance"],props:{name:{type:String},hideArrow:{type:Boolean,default:!1}},data(){return{index:0,mounted:!1}},computed:{itemClasses(){return[`${_v}-item`,{[`${_v}-item-active`]:this.isActive}]},headerClasses(){return`${_v}-header`},contentClasses(){return`${_v}-content`},boxClasses(){return`${_v}-content-box`},isActive(){const c=this.CollapseInstance.getActiveKey(),u=this.name||this.index.toString();return c.indexOf(u)>-1}},methods:{setIndex(){this.index=this.CollapseInstance.panelCount+1,this.CollapseInstance.panelCount=this.index},toggle(){this.CollapseInstance.toggle({name:this.name||this.index,isActive:this.isActive})}},mounted(){this.setIndex(),this.mounted=!0}};function Oue(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("collapse-transition");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.itemClasses)},[n.createElementVNode("div",{class:n.normalizeClass(v.headerClasses),onClick:u[0]||(u[0]=(...X)=>v.toggle&&v.toggle(...X))},[m.hideArrow?n.createCommentVNode("",!0):(n.openBlock(),n.createBlock(M,{key:0,type:"ios-arrow-forward"})),n.renderSlot(c.$slots,"default")],2),b.mounted?(n.openBlock(),n.createBlock(N,{key:0},{default:n.withCtx(()=>[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass(v.contentClasses)},[n.createElementVNode("div",{class:n.normalizeClass(v.boxClasses)},[n.renderSlot(c.$slots,"content")],2)],2),[[n.vShow,v.isActive]])]),_:3})):n.createCommentVNode("",!0)],2)}var rU=l(wue,[["render",Oue]]);const oU={name:"Paragraph",mixins:[uv],render(){return n.h(Aw,{...this.$props,component:"div",...this.commonEvents()},this.commonSlots())}},aU={name:"Password",mixins:[Zy],data(){return{className:"ivu-login-password",prefix:"ios-lock-outline",placeholder:"",type:"password"}}},Xu="ivu-poptip",Sue={name:"Poptip",mixins:[mN,Sn],emits:["on-ok","on-cancel"],directives:{clickOutside:ME},components:{iButton:co},props:{trigger:{validator(c){return T(c,["click","focus","hover"])},default:"click"},placement:{validator(c){return T(c,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"top"},title:{type:[String,Number]},content:{type:[String,Number],default:""},width:{type:[String,Number]},confirm:{type:Boolean,default:!1},okText:{type:String},cancelText:{type:String},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}},popperClass:{type:String},wordWrap:{type:Boolean,default:!1},padding:{type:String},disabled:{type:Boolean,default:!1},capture:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return c.$VIEWUI?c.$VIEWUI.capture:!1}},transferClassName:{type:String}},data(){return{prefixCls:Xu,showTitle:!0,isInput:!1,disableCloseUnderTransfer:!1,tIndex:this.handleGetIndex()}},computed:{classes(){return[`${Xu}`,{[`${Xu}-confirm`]:this.confirm}]},popperClasses(){return[`${Xu}-popper`,{[`${Xu}-confirm`]:this.transfer&&this.confirm,[`${this.popperClass}`]:!!this.popperClass,[Xu+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}]},styles(){let c={};return this.width&&(c.width=`${this.width}px`),this.transfer&&(c["z-index"]=1060+this.tIndex),c},localeOkText(){return this.okText===void 0?this.t("i.poptip.okText"):this.okText},localeCancelText(){return this.cancelText===void 0?this.t("i.poptip.cancelText"):this.cancelText},contentClasses(){return[`${Xu}-body-content`,{[`${Xu}-body-content-word-wrap`]:this.wordWrap}]},contentPaddingStyle(){const c={};return this.padding!==""&&(c.padding=this.padding),c}},methods:{handleClick(){if(!this.disabled){if(this.confirm)return this.visible=!this.visible,!0;if(this.trigger!=="click")return!1;this.visible=!this.visible}},handleTransferClick(){this.transfer&&(this.disableCloseUnderTransfer=!0)},handleClose(){if(this.disableCloseUnderTransfer)return this.disableCloseUnderTransfer=!1,!1;if(this.confirm)return this.visible=!1,!0;if(this.trigger!=="click")return!1;this.visible=!1},handleFocus(c=!0){if(!this.disabled){if(this.trigger!=="focus"||this.confirm||this.isInput&&!c)return!1;this.visible=!0}},handleBlur(c=!0){if(this.trigger!=="focus"||this.confirm||this.isInput&&!c)return!1;this.visible=!1},handleMouseenter(){if(!this.disabled){if(this.trigger!=="hover"||this.confirm)return!1;this.enterTimer&&clearTimeout(this.enterTimer),this.enterTimer=setTimeout(()=>{this.visible=!0},100)}},handleMouseleave(){if(this.trigger!=="hover"||this.confirm)return!1;this.enterTimer&&(clearTimeout(this.enterTimer),this.enterTimer=setTimeout(()=>{this.visible=!1},100))},cancel(){this.visible=!1,this.$emit("on-cancel")},ok(){this.visible=!1,this.$emit("on-ok")},getInputChildren(){const c=this.$refs.reference.querySelectorAll("input"),u=this.$refs.reference.querySelectorAll("textarea");let m=null;return c.length?m=c[0]:u.length&&(m=u[0]),m},handleGetIndex(){return je(),Oe},handleIndexIncrease(){this.tIndex=this.handleGetIndex()}},mounted(){this.confirm||(this.showTitle=this.$slots.title!==void 0||this.title),this.trigger==="focus"&&n.nextTick(()=>{const c=this.getInputChildren();c&&(this.isInput=!0,c.addEventListener("focus",this.handleFocus,!1),c.addEventListener("blur",this.handleBlur,!1))})},beforeUnmount(){const c=this.getInputChildren();c&&(c.removeEventListener("focus",this.handleFocus,!1),c.removeEventListener("blur",this.handleBlur,!1))}},Cue=n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-help-circle"},null,-1);function Tue(c,u,m,S,b,v){const M=n.resolveComponent("i-button"),N=n.resolveDirective("click-outside");return n.withDirectives((n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),onMouseenter:u[6]||(u[6]=(...X)=>v.handleMouseenter&&v.handleMouseenter(...X)),onMouseleave:u[7]||(u[7]=(...X)=>v.handleMouseleave&&v.handleMouseleave(...X))},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-rel"]),ref:"reference",onClick:u[0]||(u[0]=(...X)=>v.handleClick&&v.handleClick(...X)),onMousedown:u[1]||(u[1]=X=>v.handleFocus(!1)),onMouseup:u[2]||(u[2]=X=>v.handleBlur(!1))},[n.renderSlot(c.$slots,"default")],34),(n.openBlock(),n.createBlock(n.Teleport,{to:"body",disabled:!m.transfer},[n.createVNode(n.Transition,{name:"fade"},{default:n.withCtx(()=>[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass(v.popperClasses),style:n.normalizeStyle(v.styles),ref:"popper",onClick:u[3]||(u[3]=(...X)=>v.handleTransferClick&&v.handleTransferClick(...X)),onMouseenter:u[4]||(u[4]=(...X)=>v.handleMouseenter&&v.handleMouseenter(...X)),onMouseleave:u[5]||(u[5]=(...X)=>v.handleMouseleave&&v.handleMouseleave(...X))},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-content"])},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-arrow"])},null,2),m.confirm?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-inner"])},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body"])},[Cue,n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body-message"])},[n.renderSlot(c.$slots,"title",{},()=>[n.createTextVNode(n.toDisplayString(m.title),1)])],2)],2),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-footer"])},[n.createVNode(M,{type:"text",size:"small",onClick:v.cancel},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(v.localeCancelText),1)]),_:1},8,["onClick"]),n.createVNode(M,{type:"primary",size:"small",onClick:v.ok},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(v.localeOkText),1)]),_:1},8,["onClick"])],2)],2)):n.createCommentVNode("",!0),m.confirm?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass([b.prefixCls+"-inner"])},[b.showTitle?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-title"]),style:n.normalizeStyle(v.contentPaddingStyle),ref:"title"},[n.renderSlot(c.$slots,"title",{},()=>[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-title-inner"])},n.toDisplayString(m.title),3)])],6)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body"]),style:n.normalizeStyle(v.contentPaddingStyle)},[n.createElementVNode("div",{class:n.normalizeClass(v.contentClasses)},[n.renderSlot(c.$slots,"content",{},()=>[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body-content-inner"])},n.toDisplayString(m.content),3)])],2)],6)],2))],2)],38),[[n.vShow,c.visible]])]),_:3})],8,["disabled"]))],34)),[[N,v.handleClose]])}var uM=l(Sue,[["render",Tue]]);const vc="ivu-progress",Aue={name:"Progress",components:{Icon:O},props:{percent:{type:Number,default:0},successPercent:{type:Number,default:0},status:{validator(c){return T(c,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1},strokeColor:{type:[String,Array]},textInside:{type:Boolean,default:!1}},data(){return{currentStatus:this.status}},computed:{isStatus(){return this.currentStatus==="wrong"||this.currentStatus==="success"},statusIcon(){let c="";switch(this.currentStatus){case"wrong":c="ios-close-circle";break;case"success":c="ios-checkmark-circle";break}return c},bgStyle(){const c=this.vertical?{height:`${this.percent}%`,width:`${this.strokeWidth}px`}:{width:`${this.percent}%`,height:`${this.strokeWidth}px`};return this.strokeColor&&(typeof this.strokeColor=="string"?c["background-color"]=this.strokeColor:c["background-image"]=`linear-gradient(to right, ${this.strokeColor[0]} 0%, ${this.strokeColor[1]} 100%)`),c},successBgStyle(){return this.vertical?{height:`${this.successPercent}%`,width:`${this.strokeWidth}px`}:{width:`${this.successPercent}%`,height:`${this.strokeWidth}px`}},wrapClasses(){return[`${vc}`,`${vc}-${this.currentStatus}`,{[`${vc}-show-info`]:!this.hideInfo&&!this.textInside,[`${vc}-vertical`]:this.vertical}]},textClasses(){return`${vc}-text`},textInnerClasses(){return`${vc}-text-inner`},outerClasses(){return`${vc}-outer`},innerClasses(){return`${vc}-inner`},bgClasses(){return`${vc}-bg`},successBgClasses(){return`${vc}-success-bg`}},created(){this.handleStatus()},methods:{handleStatus(c){c?(this.currentStatus="normal",this.$emit("on-status-change","normal")):parseInt(this.percent,10)===100&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent(c,u){c<u?this.handleStatus(!0):this.handleStatus()},status(c){this.currentStatus=c}}},Eue={key:0,class:"ivu-progress-inner-text"};function Mue(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses)},[n.createElementVNode("div",{class:n.normalizeClass(v.outerClasses)},[n.createElementVNode("div",{class:n.normalizeClass(v.innerClasses)},[n.createElementVNode("div",{class:n.normalizeClass(v.bgClasses),style:n.normalizeStyle(v.bgStyle)},[m.textInside?(n.openBlock(),n.createElementBlock("div",Eue,n.toDisplayString(m.percent)+"%",1)):n.createCommentVNode("",!0)],6),n.createElementVNode("div",{class:n.normalizeClass(v.successBgClasses),style:n.normalizeStyle(v.successBgStyle)},null,6)],2)],2),!m.hideInfo&&!m.textInside?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(v.textClasses)},[n.renderSlot(c.$slots,"default",{},()=>[v.isStatus?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(v.textInnerClasses)},[n.createVNode(M,{type:v.statusIcon},null,8,["type"])],2)):(n.openBlock(),n.createElementBlock("span",{key:1,class:n.normalizeClass(v.textInnerClasses)},n.toDisplayString(m.percent)+"% ",3))])],2)):n.createCommentVNode("",!0)],2)}var Rw=l(Aue,[["render",Mue]]);const Wu="ivu-rate",kue={name:"Rate",mixins:[Sn,Li],emits:["update:modelValue","on-change"],props:{count:{type:Number,default:5},modelValue:{type:Number,default:0},allowHalf:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},showText:{type:Boolean,default:!1},name:{type:String},clearable:{type:Boolean,default:!1},character:{type:String,default:""},icon:{type:String,default:""},customIcon:{type:String,default:""}},data(){const c=this.modelValue||0;return{prefixCls:Wu,hoverIndex:-1,isHover:!1,isHalf:this.allowHalf&&c.toString().indexOf(".")>=0,currentValue:c}},computed:{classes(){return[`${Wu}`,{[`${Wu}-disabled`]:this.itemDisabled}]},iconClasses(){return["ivu-icon",{[`ivu-icon-${this.icon}`]:this.icon!=="",[`${this.customIcon}`]:this.customIcon!==""}]},showCharacter(){return this.character!==""||this.icon!==""||this.customIcon!==""}},watch:{modelValue(c){this.currentValue=c||0},currentValue(c){this.setHalf(c)}},methods:{starCls(c){const u=this.hoverIndex,m=this.isHover?u:this.currentValue;let S=!1,b=!1;return m>=c&&(S=!0),this.isHover?b=m===c:b=Math.ceil(this.currentValue)===c,[{[`${Wu}-star`]:!this.showCharacter,[`${Wu}-star-chart`]:this.showCharacter,[`${Wu}-star-full`]:!b&&S||b&&!this.isHalf,[`${Wu}-star-half`]:b&&this.isHalf,[`${Wu}-star-zero`]:!S}]},handleMousemove(c,u){if(!this.itemDisabled){if(this.isHover=!0,this.allowHalf){const m=u.target.getAttribute("type")||!1;this.isHalf=m==="half"}else this.isHalf=!1;this.hoverIndex=c}},handleMouseleave(){this.itemDisabled||(this.isHover=!1,this.setHalf(this.currentValue),this.hoverIndex=-1)},setHalf(c){this.isHalf=this.allowHalf&&c.toString().indexOf(".")>=0},handleClick(c){this.itemDisabled||(this.isHalf&&(c-=.5),this.clearable&&Math.abs(c-this.currentValue)<.01&&(c=0),this.currentValue=c,this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c))}}},Pue=["name","value"],Iue=["onMousemove","onClick"],Bue={key:0},Rue={key:1};function Due(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),onMouseleave:u[0]||(u[0]=(...M)=>v.handleMouseleave&&v.handleMouseleave(...M))},[n.createElementVNode("input",{type:"hidden",name:m.name,value:b.currentValue},null,8,Pue),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.count,M=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.starCls(M)),onMousemove:N=>v.handleMousemove(M,N),key:M,onClick:N=>v.handleClick(M)},[v.showCharacter?(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createElementVNode("span",{class:n.normalizeClass([b.prefixCls+"-star-first"]),type:"half"},[m.character!==""?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createTextVNode(n.toDisplayString(m.character),1)],64)):(n.openBlock(),n.createElementBlock("i",{key:1,class:n.normalizeClass(v.iconClasses),type:"half"},null,2))],2),n.createElementVNode("span",{class:n.normalizeClass([b.prefixCls+"-star-second"])},[m.character!==""?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createTextVNode(n.toDisplayString(m.character),1)],64)):(n.openBlock(),n.createElementBlock("i",{key:1,class:n.normalizeClass(v.iconClasses)},null,2))],2)],64)):(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass([b.prefixCls+"-star-content"]),type:"half"},null,2))],42,Iue))),128)),m.showText?n.withDirectives((n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-text"])},[n.renderSlot(c.$slots,"default",{},()=>[n.createElementVNode("span",null,n.toDisplayString(b.currentValue),1),n.createTextVNode(),b.currentValue<=1?(n.openBlock(),n.createElementBlock("span",Bue,n.toDisplayString(c.t("i.rate.star")),1)):(n.openBlock(),n.createElementBlock("span",Rue,n.toDisplayString(c.t("i.rate.stars")),1))])],2)),[[n.vShow,b.currentValue>0]]):n.createCommentVNode("",!0)],34)}var lU=l(kue,[["render",Due]]);const Lue={name:"Result",components:{Icon:O},props:{type:{validator(c){return T(c,["success","error","warning"])}},title:{type:String},desc:{type:String},extra:{type:String}},computed:{iconClasses(){return{"ivu-result-icon-success":this.type==="success","ivu-result-icon-error":this.type==="error","ivu-result-icon-warning":this.type==="warning"}}}},Nue={class:"ivu-result"},Vue={key:0,class:"ivu-result-title"},$ue={key:1,class:"ivu-result-desc"},Uue={key:2,class:"ivu-result-extra"},Fue={key:3,class:"ivu-result-actions"};function zue(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("div",Nue,[n.createElementVNode("div",{class:n.normalizeClass(["ivu-result-icon",v.iconClasses])},[m.type==="success"?(n.openBlock(),n.createBlock(M,{key:0,type:"ios-checkmark"})):n.createCommentVNode("",!0),m.type==="error"?(n.openBlock(),n.createBlock(M,{key:1,type:"ios-close"})):n.createCommentVNode("",!0),m.type==="warning"?(n.openBlock(),n.createBlock(M,{key:2,type:"ios-information"})):n.createCommentVNode("",!0)],2),m.title||c.$slots.title?(n.openBlock(),n.createElementBlock("div",Vue,[n.renderSlot(c.$slots,"title",{},()=>[n.createTextVNode(n.toDisplayString(m.title),1)])])):n.createCommentVNode("",!0),m.desc||c.$slots.desc?(n.openBlock(),n.createElementBlock("div",$ue,[n.renderSlot(c.$slots,"desc",{},()=>[n.createTextVNode(n.toDisplayString(m.desc),1)])])):n.createCommentVNode("",!0),m.extra||c.$slots.extra?(n.openBlock(),n.createElementBlock("div",Uue,[n.renderSlot(c.$slots,"extra",{},()=>[n.createTextVNode(n.toDisplayString(m.extra),1)])])):n.createCommentVNode("",!0),c.$slots.actions?(n.openBlock(),n.createElementBlock("div",Fue,[n.renderSlot(c.$slots,"actions")])):n.createCommentVNode("",!0)])}var cU=l(Lue,[["render",zue]]);const bv="ivu-scroll",Xue={props:["text","active","spinnerHeight"],components:{Spin:da,Icon:O},computed:{wrapperClasses(){return[`${bv}-loader-wrapper`,{[`${bv}-loader-wrapper-active`]:this.active}]},spinnerClasses(){return`${bv}-spinner`},iconClasses(){return`${bv}-spinner-icon`},textClasses(){return`${bv}-loader-text`}}};function Wue(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("Spin");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapperClasses)},[n.createElementVNode("div",{class:n.normalizeClass(v.spinnerClasses)},[n.createVNode(N,{fix:""},{default:n.withCtx(()=>[n.createVNode(M,{type:"ios-loading",size:"18",class:n.normalizeClass(v.iconClasses)},null,8,["class"]),m.text?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.textClasses)},n.toDisplayString(m.text),3)):n.createCommentVNode("",!0)]),_:1})],2)],2)}var Hue=l(Xue,[["render",Wue]]);const Km="ivu-scroll",hU={sensitivity:10,minimumStartDragOffset:5},dM=()=>Promise.resolve(),Gue={name:"Scroll",mixins:[Sn],components:{loader:Hue},props:{height:{type:[Number,String],default:300},onReachTop:{type:Function},onReachBottom:{type:Function},onReachEdge:{type:Function},loadingText:{type:String},distanceToEdge:[Number,Array],stopSlide:{type:Boolean,default:!1}},data(){const c=this.calculateProximityThreshold();return{showTopLoader:!1,showBottomLoader:!1,showBodyLoader:!1,lastScroll:0,reachedTopScrollLimit:!0,reachedBottomScrollLimit:!1,topRubberPadding:0,bottomRubberPadding:0,rubberRollBackTimeout:!1,isLoading:!1,pointerTouchDown:null,touchScroll:!1,handleScroll:()=>{},pointerUpHandler:()=>{},pointerMoveHandler:()=>{},topProximityThreshold:c[0],bottomProximityThreshold:c[1]}},computed:{wrapClasses(){return`${Km}-wrapper`},scrollContainerClasses(){return[`${Km}-container`,{[`${Km}-container-loading`]:this.showBodyLoader&&this.stopSlide}]},slotContainerClasses(){return[`${Km}-content`,{[`${Km}-content-loading`]:this.showBodyLoader}]},loaderClasses(){return`${Km}-loader`},wrapperPadding(){return{paddingTop:this.topRubberPadding+"px",paddingBottom:this.bottomRubberPadding+"px"}},localeLoadingText(){return this.loadingText===void 0?this.t("i.select.loading"):this.loadingText}},methods:{waitOneSecond(){return new Promise(c=>{setTimeout(c,1e3)})},calculateProximityThreshold(){const c=this.distanceToEdge;return typeof c>"u"?[20,20]:Array.isArray(c)?c:[c,c]},onCallback(c){if(this.isLoading=!0,this.showBodyLoader=!0,c>0)this.showTopLoader=!0,this.topRubberPadding=20;else{this.showBottomLoader=!0,this.bottomRubberPadding=20;let S=0;const b=this.$refs.scrollContainer,v=b.scrollTop;for(let M=0;M<20;M++)setTimeout(()=>{S=Math.max(S,this.$refs.bottomLoader.getBoundingClientRect().height),b.scrollTop=v+S},M*50)}const u=[this.waitOneSecond(),this.onReachEdge?this.onReachEdge(c):dM()];u.push(c>0?this.onReachTop?this.onReachTop():dM():this.onReachBottom?this.onReachBottom():dM());let m=setTimeout(()=>{this.reset()},5e3);Promise.all(u).then(()=>{clearTimeout(m),this.reset()})},reset(){["showTopLoader","showBottomLoader","showBodyLoader","isLoading","reachedTopScrollLimit","reachedBottomScrollLimit"].forEach(c=>this[c]=!1),this.lastScroll=0,this.topRubberPadding=0,this.bottomRubberPadding=0,clearInterval(this.rubberRollBackTimeout),this.touchScroll&&setTimeout(()=>{a(window,"touchend",this.pointerUpHandler),this.$refs.scrollContainer.removeEventListener("touchmove",this.pointerMoveHandler),this.touchScroll=!1},500)},onWheel(c){if(this.isLoading)return;const u=c.wheelDelta?c.wheelDelta:-(c.detail||c.deltaY);this.stretchEdge(u)},stretchEdge(c){if(clearTimeout(this.rubberRollBackTimeout),!this.onReachEdge){if(c>0){if(!this.onReachTop)return}else if(!this.onReachBottom)return}this.rubberRollBackTimeout=setTimeout(()=>{this.isLoading||this.reset()},250),c>0&&this.reachedTopScrollLimit?(this.topRubberPadding+=5-this.topRubberPadding/5,this.topRubberPadding>this.topProximityThreshold&&this.onCallback(1)):c<0&&this.reachedBottomScrollLimit?(this.bottomRubberPadding+=6-this.bottomRubberPadding/4,this.bottomRubberPadding>this.bottomProximityThreshold&&this.onCallback(-1)):this.onScroll()},onScroll(){const c=this.$refs.scrollContainer;if(this.isLoading||!c)return;const u=Math.sign(this.lastScroll-c.scrollTop),m=c.scrollHeight-c.clientHeight-c.scrollTop,S=this.topProximityThreshold<0?this.topProximityThreshold:0,b=this.bottomProximityThreshold<0?this.bottomProximityThreshold:0;u==-1&&m+b<=hU.sensitivity?this.reachedBottomScrollLimit=!0:u>=0&&c.scrollTop+S<=0?this.reachedTopScrollLimit=!0:(this.reachedTopScrollLimit=!1,this.reachedBottomScrollLimit=!1,this.lastScroll=c.scrollTop)},getTouchCoordinates(c){return{x:c.touches[0].pageX,y:c.touches[0].pageY}},onPointerDown(c){if(!this.isLoading){if(c.type=="touchstart"){const u=this.$refs.scrollContainer;this.reachedTopScrollLimit?u.scrollTop=5:this.reachedBottomScrollLimit&&(u.scrollTop-=5)}c.type=="touchstart"&&this.$refs.scrollContainer.scrollTop==0&&(this.$refs.scrollContainer.scrollTop=5),this.pointerTouchDown=this.getTouchCoordinates(c),o(window,"touchend",this.pointerUpHandler),this.$refs.scrollContainer.parentElement.addEventListener("touchmove",u=>{u.stopPropagation(),this.pointerMoveHandler(u)},{passive:!1,useCapture:!0})}},onPointerMove(c){if(!this.pointerTouchDown||this.isLoading)return;const u=this.getTouchCoordinates(c).y-this.pointerTouchDown.y;this.stretchEdge(u),this.touchScroll||Math.abs(u)>hU.minimumStartDragOffset&&(this.touchScroll=!0)},onPointerUp(){this.pointerTouchDown=null}},created(){this.handleScroll=Ow(this.onScroll,150,{leading:!1}),this.pointerUpHandler=this.onPointerUp.bind(this),this.pointerMoveHandler=Ow(this.onPointerMove,50,{leading:!1})}};function Que(c,u,m,S,b,v){const M=n.resolveComponent("loader");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses),style:{"touch-action":"none"}},[n.createElementVNode("div",{class:n.normalizeClass(v.scrollContainerClasses),style:n.normalizeStyle({height:m.height+"px"}),onScroll:u[0]||(u[0]=(...N)=>b.handleScroll&&b.handleScroll(...N)),onWheel:u[1]||(u[1]=(...N)=>v.onWheel&&v.onWheel(...N)),onTouchstart:u[2]||(u[2]=(...N)=>v.onPointerDown&&v.onPointerDown(...N)),ref:"scrollContainer"},[n.createElementVNode("div",{class:n.normalizeClass(v.loaderClasses),style:n.normalizeStyle({paddingTop:v.wrapperPadding.paddingTop}),ref:"toploader"},[n.createVNode(M,{text:v.localeLoadingText,active:b.showTopLoader},null,8,["text","active"])],6),n.createElementVNode("div",{class:n.normalizeClass(v.slotContainerClasses),ref:"scrollContent"},[n.renderSlot(c.$slots,"default")],2),n.createElementVNode("div",{class:n.normalizeClass(v.loaderClasses),style:n.normalizeStyle({paddingBottom:v.wrapperPadding.paddingBottom}),ref:"bottomLoader"},[n.createVNode(M,{text:v.localeLoadingText,active:b.showBottomLoader},null,8,["text","active"])],6)],38)],2)}var uU=l(Gue,[["render",Que]]);const Yue="COMPLETE",dU="CANCELED";function jue(c){if(r&&"requestAnimationFrame"in window)return window.requestAnimationFrame(c);setTimeout(c,16)}function fU(c,u,m){c===window?c.scrollTo(u,m):(c.scrollLeft=u,c.scrollTop=m)}function que(c,u,m){if(!r)return;let S=c.getBoundingClientRect(),b=null,v=null,M=null,N=null,X=null,U=null,H=null,re=m&&m.left!=null?m.left:.5,xe=m&&m.top!=null?m.top:.5,ye=m&&m.leftOffset!=null?m.leftOffset:0,me=m&&m.topOffset!=null?m.topOffset:0,ne=re,Te=xe;if(u===window)U=Math.min(S.width,window.innerWidth),H=Math.min(S.height,window.innerHeight),v=S.left+window.pageXOffset-window.innerWidth*ne+U*ne,M=S.top+window.pageYOffset-window.innerHeight*Te+H*Te,v-=ye,M-=me,N=v-window.pageXOffset,X=M-window.pageYOffset;else{U=S.width,H=S.height,b=u.getBoundingClientRect();let Xt=S.left-(b.left-u.scrollLeft),_t=S.top-(b.top-u.scrollTop);v=Xt+U*ne-u.clientWidth*ne,M=_t+H*Te-u.clientHeight*Te,v=Math.max(Math.min(v,u.scrollWidth-u.clientWidth),0),M=Math.max(Math.min(M,u.scrollHeight-u.clientHeight),0),v-=ye,M-=me,N=v-u.scrollLeft,X=M-u.scrollTop}return{x:v,y:M,differenceX:N,differenceY:X}}function pU(c){jue(function(){let u=c.scrollOption;if(!u)return;let m=que(u.target,c,u.align),S=Date.now()-u.startTime,b=Math.min(1/u.time*S,1);if(S>u.time+20)return fU(c,m.x,m.y),c.scrollOption=null,u.end(Yue);let v=1-u.ease(b);fU(c,m.x-m.differenceX*v,m.y-m.differenceY*v),pU(c)})}function Zue(c,u,m,S){let b=!u.scrollOption,v=u.scrollOption,M=Date.now(),N;v&&v.end(dU);function X(U){u.scrollOption=null,u.parentElement&&u.parentElement.scrollOption&&u.parentElement.scrollOption.end(U),S(U),u.removeEventListener("touchstart",N)}u.scrollOption={startTime:v?v.startTime:Date.now(),target:c,time:m.time+(v?M-v.startTime:0),ease:m.ease,align:m.align,end:X},N=X.bind(null,dU),u.addEventListener("touchstart",N),b&&pU(u)}function mU(c){if(r)return c===window||(c.scrollHeight!==c.clientHeight||c.scrollWidth!==c.clientWidth)&&getComputedStyle(c).overflow!=="hidden"}function Kue(){return!0}function fM(c,u,m){if(!c)return;typeof u=="function"&&(m=u,u=null),u||(u={}),u.time=isNaN(u.time)?1e3:u.time,u.ease=u.ease||function(X){return 1-Math.pow(1-X,X/2)};let S=c.parentElement,b=0;function v(X){b-=1,!b&&m&&m(X)}let M=u.validTarget||Kue,N=u.isScrollable;for(;S;){if(M(S,b)&&(N?N(S,mU):mU(S))&&(b+=1,Zue(c,S,u,v)),S=S.parentElement,!S)return;S.tagName==="BODY"&&(S=window)}}function Jue(c){if(r&&"requestAnimationFrame"in window)return window.requestAnimationFrame(c);setTimeout(c,16)}function pM(c,u,m){if(!c)return;typeof u=="function"&&(m=u,u=null),u||(u={}),u.time=isNaN(u.time)?500:u.time;const S=c.scrollTop,b=u.to||0,v=Math.abs(S-b),M=Math.ceil(v/u.time*50);function N(X,U,H){if(X===U){m&&m();return}let re=X+H>U?U:X+H;X>U&&(re=X-H<U?U:X-H),c.scrollTop=re,Jue(()=>N(re,U,H))}N(S,b,M)}const _h="ivu-layout-sider";pe();const ede={name:"Sider",emits:["on-collapse","update:modelValue"],props:{modelValue:{type:Boolean,default:!1},width:{type:[Number,String],default:200},collapsedWidth:{type:[Number,String],default:64},hideTrigger:{type:Boolean,default:!1},breakpoint:{type:String,validator(c){return T(c,["xs","sm","md","lg","xl","xxl"])}},collapsible:{type:Boolean,default:!1},defaultCollapsed:{type:Boolean,default:!1},reverseArrow:{type:Boolean,default:!1}},data(){return{prefixCls:_h,mediaMatched:!1}},computed:{wrapClasses(){return[`${_h}`,this.siderWidth?"":`${_h}-zero-width`,this.modelValue?`${_h}-collapsed`:""]},wrapStyles(){return{width:`${this.siderWidth}px`,minWidth:`${this.siderWidth}px`,maxWidth:`${this.siderWidth}px`,flex:`0 0 ${this.siderWidth}px`}},triggerClasses(){return[`${_h}-trigger`,this.modelValue?`${_h}-trigger-collapsed`:""]},childClasses(){return`${this.prefixCls}-children`},zeroWidthTriggerClasses(){return[`${_h}-zero-width-trigger`,this.reverseArrow?`${_h}-zero-width-trigger-left`:""]},triggerIconClasses(){return["ivu-icon",`ivu-icon-ios-arrow-${this.reverseArrow?"forward":"back"}`,`${_h}-trigger-icon`]},siderWidth(){return this.collapsible?this.modelValue?this.mediaMatched?0:parseInt(this.collapsedWidth):parseInt(this.width):this.width},showZeroTrigger(){return this.collapsible?this.mediaMatched&&!this.hideTrigger||parseInt(this.collapsedWidth)===0&&this.modelValue&&!this.hideTrigger:!1},showBottomTrigger(){return this.collapsible?!this.mediaMatched&&!this.hideTrigger:!1}},methods:{toggleCollapse(){let c=this.collapsible?!this.modelValue:!1;this.$emit("update:modelValue",c)},matchMedia(){if(!r)return;let c;window.matchMedia&&(c=window.matchMedia);let u=this.mediaMatched;this.mediaMatched=c(`(max-width: ${oe[this.breakpoint]})`).matches,this.mediaMatched!==u&&this.$emit("update:modelValue",this.mediaMatched)},onWindowResize(){this.matchMedia()}},watch:{modelValue(c){this.$emit("on-collapse",c)}},mounted(){this.defaultCollapsed&&this.$emit("update:modelValue",this.defaultCollapsed),this.breakpoint!==void 0&&(o(window,"resize",this.onWindowResize),this.matchMedia())},beforeUnmount(){this.breakpoint!==void 0&&a(window,"resize",this.onWindowResize)}},tde=[n.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-menu"},null,-1)];function ide(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses),style:n.normalizeStyle(v.wrapStyles)},[n.withDirectives(n.createElementVNode("span",{onClick:u[0]||(u[0]=(...M)=>v.toggleCollapse&&v.toggleCollapse(...M)),class:n.normalizeClass(v.zeroWidthTriggerClasses)},tde,2),[[n.vShow,v.showZeroTrigger]]),n.createElementVNode("div",{class:n.normalizeClass(v.childClasses)},[n.renderSlot(c.$slots,"default")],2),n.renderSlot(c.$slots,"trigger",{},()=>[n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass(v.triggerClasses),onClick:u[1]||(u[1]=(...M)=>v.toggleCollapse&&v.toggleCollapse(...M)),style:n.normalizeStyle({width:v.siderWidth+"px"})},[n.createElementVNode("i",{class:n.normalizeClass(v.triggerIconClasses)},null,2)],6),[[n.vShow,v.showBottomTrigger]])])],6)}var gU=l(ede,[["render",ide]]);const Hu="ivu-skeleton-item",nde={name:"SkeletonItem",components:{Icon:O},inject:{SkeletonInstance:{default:null}},props:{animated:{type:Boolean,default:!1},type:{validator(c){return T(c,["circle","square","rect","image"])},default:"rect"},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},width:{type:[String,Number]},height:{type:[String,Number]},block:{type:Boolean,default:!1},imgSrc:{type:String}},data(){return{prefixCls:Hu}},computed:{classes(){return[Hu,Hu+"-"+this.type,Hu+"-"+this.type+"-"+this.size,{[Hu+"-animated"]:this.animated||!!this.SkeletonInstance&&this.SkeletonInstance.animated,[Hu+"-inline"]:!this.block,[Hu+"-with-image"]:this.showImage,[Hu+"-round"]:!!this.SkeletonInstance&&this.SkeletonInstance.round}]},styles(){const c={};return["rect","image"].includes(this.type)&&(this.width&&(c.width=typeof this.width=="number"?`${this.width}px`:this.width),this.height&&(c.height=typeof this.height=="number"?`${this.height}px`:this.height),this.showImage&&(c.background=`no-repeat url(${this.imgSrc}) center center`,c.backgroundSize="contain")),c},showIcon(){return this.type==="image"&&!this.imgSrc},showImage(){return this.type==="image"&&!!this.imgSrc},iconSize(){let c=16;return this.size==="large"&&(c=32),this.size==="small"&&(c=10),c}}};function sde(c,u,m,S,b,v){const M=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(v.styles)},[v.showIcon?(n.openBlock(),n.createBlock(M,{key:0,class:n.normalizeClass(b.prefixCls+"-image-icon"),type:"ios-image",size:v.iconSize},null,8,["class","size"])):n.createCommentVNode("",!0)],6)}var mM=l(nde,[["render",sde]]);const Nf="ivu-skeleton",rde={name:"Skeleton",components:{SkeletonItem:mM,Row:Du,Col:pc},provide(){return{SkeletonInstance:this}},props:{animated:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},round:{type:Boolean,default:!1},paragraph:{validator(c){return typeof c=="number"?c>=1:typeof c.rows=="number"&&c.rows>=1},type:[Number,Object],default:3},title:{validator(c){return typeof c=="object"&&c.width?["number","string"].includes(typeof c.width):!0},type:[Boolean,Object],default:!0},avatar:{validator(c){if(typeof c=="object"){if(c.type)return T(c.type,["circle","square"]);if(c.size)return T(c.size,["small","large","default"])}return!0},type:[Boolean,Object],default:!1}},data(){return{prefixCls:Nf}},computed:{classes(){return[Nf,{[Nf+"-with-title"]:this.showTitle,[Nf+"-with-avatar"]:this.showAvatar}]},rows(){return typeof this.paragraph=="number"?this.paragraph:this.paragraph.rows},rowsCount(){return this.rows+Number(this.showTitle)},showTitle(){return!!this.title},titleWidth(){return typeof this.title=="object"&&this.title.width?typeof this.title.width=="string"?this.title.width:`${this.title.width}px`:""},showAvatar(){return!!this.avatar},avatarType(){return typeof this.avatar=="object"&&this.avatar.type?this.avatar.type:"circle"},avatarSize(){return typeof this.avatar=="object"&&this.avatar.size?this.avatar.size:!this.$VIEWUI||this.$VIEWUI.size===""?"default":this.$VIEWUI.size}},methods:{rowClasses(c){return[Nf+"-item-inner",{[Nf+"-item-round"]:this.round,[Nf+"-item-title"]:this.showTitle&&c===1}]},rowWidth(c){if(this.showTitle&&c===1)return this.titleWidth||"38%";if(typeof this.paragraph=="object"){if(typeof this.paragraph.width=="string")return this.paragraph.width;if(typeof this.paragraph.width=="number")return`${this.paragraph.width}px`;const u=c-1-Number(this.showTitle);if(Array.isArray(this.paragraph.width)&&this.paragraph.width[u])return typeof this.paragraph.width[u]=="number"?`${this.paragraph.width[u]}px`:this.paragraph.width[u]}return c===this.rowsCount?"62%":"100%"}}};function ode(c,u,m,S,b,v){const M=n.resolveComponent("SkeletonItem"),N=n.resolveComponent("Col"),X=n.resolveComponent("Row");return m.loading?(n.openBlock(),n.createElementBlock("div",n.mergeProps({key:0},c.$attrs,{class:v.classes}),[m.loading?n.renderSlot(c.$slots,"template",{key:0},()=>[n.createVNode(X,null,{default:n.withCtx(()=>[v.showAvatar?(n.openBlock(),n.createBlock(N,{key:0,flex:"0"},{default:n.withCtx(()=>[n.createVNode(M,{type:v.avatarType,size:v.avatarSize,animated:m.animated,class:n.normalizeClass(b.prefixCls+"-item-avatar")},null,8,["type","size","animated","class"])]),_:1})):n.createCommentVNode("",!0),n.createVNode(N,{flex:"1"},{default:n.withCtx(()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.rowsCount,U=>(n.openBlock(),n.createBlock(M,{key:U,class:n.normalizeClass(v.rowClasses(U)),animated:m.animated,width:v.rowWidth(U),block:""},null,8,["class","animated","width"]))),128))]),_:1})]),_:1})]):n.createCommentVNode("",!0)],16)):n.renderSlot(c.$slots,"default",n.normalizeProps(n.mergeProps({key:1},c.$attrs)))}var yU=l(rde,[["render",ode]]),ade={name:"SliderMarker",props:{mark:{type:[String,Object]}},render(){let c=typeof this.mark=="string"?this.mark:[this.mark.label];return n.h("div",{class:"ivu-slider-marks-item",style:this.mark.style||{}},c)}};const bh="ivu-slider",lde={name:"Slider",mixins:[Li],emits:["update:modelValue","on-input","on-change"],components:{InputNumber:eM,Tooltip:mh,SliderMarker:ade},inject:{ModalInstance:{default:null},DrawerInstance:{default:null}},props:{min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},range:{type:Boolean,default:!1},modelValue:{type:[Number,Array],default:0},disabled:{type:Boolean,default:!1},showInput:{type:Boolean,default:!1},inputSize:{type:String,default:"default",validator(c){return T(c,["small","large","default"])}},showStops:{type:Boolean,default:!1},tipFormat:{type:Function,default(c){return c}},showTip:{type:String,default:"hover",validator(c){return T(c,["hover","always","never"])}},name:{type:String},activeChange:{type:Boolean,default:!0},marks:{type:Object}},data(){let c=this.checkLimits(Array.isArray(this.modelValue)?this.modelValue:[this.modelValue]);return this.range&&this.modelValue===null&&(c=[0,0]),{prefixCls:bh,currentValue:c,dragging:!1,pointerDown:"",startX:0,currentX:0,startPos:0,oldValue:[...c],valueIndex:{min:0,max:1},sliderWidth:0,isValueNull:!1,id:te(6)}},watch:{modelValue(c){c===null&&(this.isValueNull=!0),c=this.checkLimits(Array.isArray(c)?c:[c]),!this.dragging&&(c[0]!==this.currentValue[0]||c[1]!==this.currentValue[1])&&(this.isValueNull&&this.range?this.currentValue=[0,0]:this.currentValue=c)},exportValue(c){n.nextTick(()=>{this.$refs.minTooltip.updatePopper(),this.range&&this.$refs.maxTooltip.updatePopper()});const u=this.range?c:c[0];this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",u),this.$emit("on-input",u)}},computed:{classes(){return[`${bh}`,{[`${bh}-input`]:this.showInput&&!this.range,[`${bh}-range`]:this.range,[`${bh}-disabled`]:this.itemDisabled}]},minButtonClasses(){return[`${bh}-button`,{[`${bh}-button-dragging`]:this.pointerDown==="min"}]},maxButtonClasses(){return[`${bh}-button`,{[`${bh}-button-dragging`]:this.pointerDown==="max"}]},exportValue(){const c=(String(this.step).split(".")[1]||"").length;return this.currentValue.map(u=>Number(u.toFixed(c)))},minPosition(){return(this.currentValue[0]-this.min)/this.valueRange*100},maxPosition:function(){return(this.currentValue[1]-this.min)/this.valueRange*100},barStyle(){const c={width:(this.currentValue[0]-this.min)/this.valueRange*100+"%"};return this.range&&(c.left=(this.currentValue[0]-this.min)/this.valueRange*100+"%",c.width=(this.currentValue[1]-this.currentValue[0])/this.valueRange*100+"%"),c},stops(){let c=this.valueRange/this.step,u=[],m=100*this.step/this.valueRange;for(let S=1;S<c;S++)u.push(S*m);return u},markList(){return this.marks?Object.keys(this.marks).map(parseFloat).sort((c,u)=>c-u).filter(c=>c<=this.max&&c>=this.min).map(c=>({point:c,position:(c-this.min)*100/(this.max-this.min),mark:this.marks[c]})):[]},tipDisabled(){return this.tipFormat(this.currentValue[0])===null||this.showTip==="never"},valueRange(){return this.max-this.min},firstPosition(){return this.currentValue[0]},secondPosition(){return this.currentValue[1]}},methods:{getPointerX(c){return c.type.indexOf("touch")!==-1?c.touches[0].clientX:c.clientX},checkLimits([c,u]){return c=Math.max(this.min,c),c=Math.min(this.max,c),u=Math.max(this.min,c,u),u=Math.min(this.max,u),[c,u]},getCurrentValue(c,u){if(this.itemDisabled)return;const m=this.valueIndex[u];if(typeof m<"u")return this.currentValue[m]},onKeyLeft(c,u){const m=this.getCurrentValue(c,u);Number.isFinite(m)&&this.changeButtonPosition(m-this.step,u)},onKeyRight(c,u){const m=this.getCurrentValue(c,u);Number.isFinite(m)&&this.changeButtonPosition(m+this.step,u)},onPointerDown(c,u){this.itemDisabled||(c.preventDefault(),this.pointerDown=u,this.onPointerDragStart(c),o(window,"mousemove",this.onPointerDrag),o(window,"touchmove",this.onPointerDrag),o(window,"mouseup",this.onPointerDragEnd),o(window,"touchend",this.onPointerDragEnd))},onPointerDragStart(c){this.dragging=!1,this.startX=this.getPointerX(c),this.startPos=this[`${this.pointerDown}Position`]*this.valueRange/100+this.min},onPointerDrag(c){this.dragging=!0,this.$refs[`${this.pointerDown}Tooltip`].visible=!0,this.currentX=this.getPointerX(c);const u=(this.currentX-this.startX)/this.sliderWidth*this.valueRange;this.changeButtonPosition(this.startPos+u)},onPointerDragEnd(){this.dragging&&(this.dragging=!1,this.$refs[`${this.pointerDown}Tooltip`].visible=!1,this.emitChange()),this.pointerDown="",a(window,"mousemove",this.onPointerDrag),a(window,"touchmove",this.onPointerDrag),a(window,"mouseup",this.onPointerDragEnd),a(window,"touchend",this.onPointerDragEnd)},changeButtonPosition(c,u){const m=u||this.pointerDown,S=m==="min"?0:1;m==="min"?c=this.checkLimits([c,this.max])[0]:c=this.checkLimits([this.min,c])[1];const b=this.handleDecimal(c,this.step),v=this.currentValue;v[S]=c-b,this.range&&(m==="min"&&v[0]>v[1]&&(v[1]=v[0]),m==="max"&&v[0]>v[1]&&(v[0]=v[1])),this.currentValue=[...v],this.dragging||this.currentValue[S]!==this.oldValue[S]&&(this.emitChange(),this.oldValue[S]=this.currentValue[S])},handleDecimal(c,u){if(u<1){let m=u.toString(),S=1,b;try{b=m.split(".")[1].length}catch{b=0}return S=Math.pow(10,b),c*S%(u*S)/S}else return c%u},emitChange(){const c=this.range?this.exportValue:this.exportValue[0];this.$emit("on-change",c),this.handleFormItemChange("change",c)},sliderClick(c){if(this.itemDisabled)return;const u=this.getPointerX(c),m=this.$refs.slider.getBoundingClientRect().left;let S=(u-m)/this.sliderWidth*this.valueRange+this.min,b=S/this.valueRange*100;!this.range||b<=this.minPosition?this.changeButtonPosition(S,"min"):b>=this.maxPosition?this.changeButtonPosition(S,"max"):this.changeButtonPosition(S,S-this.firstPosition<=this.secondPosition-S?"min":"max")},handleInputChange(c){this.currentValue=[c===0?0:c||this.min,this.currentValue[1]],this.emitChange()},handleFocus(c){this.$refs[`${c}Tooltip`].handleShowPopper()},handleBlur(c){this.$refs[`${c}Tooltip`].handleClosePopper()},handleSetSliderWidth(){this.sliderWidth=parseInt(k(this.$refs.slider,"width"),10)},handleOnVisibleChange(c){c&&this.showTip==="always"&&(this.$refs.minTooltip.doDestroy(),this.range&&this.$refs.maxTooltip.doDestroy(),n.nextTick(()=>{this.$refs.minTooltip.updatePopper(),this.range&&this.$refs.maxTooltip.updatePopper()}))},addSlider(c){const u=this[c];!u||(u.sliderList||(u.sliderList=[]),u.sliderList.push({id:this.id,slider:this}))},removeSlider(c){const u=this[c];if(!u||!u.sliderList)return;const m=u.sliderList.findIndex(S=>S.id===this.id);u.sliderList.splice(m,1)}},mounted(){this.addSlider("ModalInstance"),this.addSlider("DrawerInstance"),this.observer=qm(),this.observer.listenTo(this.$refs.slider,this.handleSetSliderWidth)},beforeUnmount(){this.removeSlider("ModalInstance"),this.removeSlider("DrawerInstance"),this.observer.removeListener(this.$refs.slider,this.handleSetSliderWidth)}},cde=["name","value"],hde={class:"ivu-slider-marks"};function ude(c,u,m,S,b,v){const M=n.resolveComponent("Input-number"),N=n.resolveComponent("SliderMarker"),X=n.resolveComponent("Tooltip");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[!m.range&&m.showInput?(n.openBlock(),n.createBlock(M,{key:0,min:m.min,size:m.inputSize,max:m.max,step:m.step,modelValue:v.exportValue[0],disabled:c.itemDisabled,"active-change":m.activeChange,onOnChange:v.handleInputChange},null,8,["min","size","max","step","modelValue","disabled","active-change","onOnChange"])):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-wrap"]),ref:"slider",onClick:u[19]||(u[19]=n.withModifiers((...U)=>v.sliderClick&&v.sliderClick(...U),["self"]))},[n.createElementVNode("input",{type:"hidden",name:m.name,value:v.exportValue},null,8,cde),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-bar"]),style:n.normalizeStyle(v.barStyle),onClick:u[0]||(u[0]=n.withModifiers((...U)=>v.sliderClick&&v.sliderClick(...U),["self"]))},null,6),m.showStops?(n.openBlock(!0),n.createElementBlock(n.Fragment,{key:0},n.renderList(v.stops,U=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([b.prefixCls+"-stop"]),key:U,style:n.normalizeStyle({left:U+"%"}),onClick:u[1]||(u[1]=n.withModifiers((...H)=>v.sliderClick&&v.sliderClick(...H),["self"]))},null,6))),128)):n.createCommentVNode("",!0),v.markList.length>0?(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.markList,(U,H)=>(n.openBlock(),n.createElementBlock("div",{key:H,class:n.normalizeClass([b.prefixCls+"-stop"]),style:n.normalizeStyle({left:U.position+"%"}),onClick:u[2]||(u[2]=n.withModifiers((...re)=>v.sliderClick&&v.sliderClick(...re),["self"]))},null,6))),128)),n.createElementVNode("div",hde,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.markList,(U,H)=>(n.openBlock(),n.createBlock(N,{key:H,mark:U.mark,style:n.normalizeStyle({left:U.position+"%"}),onClick:v.sliderClick},null,8,["mark","style","onClick"]))),128))])],64)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-button-wrap"]),style:n.normalizeStyle({left:v.minPosition+"%"}),onTouchstart:u[9]||(u[9]=U=>v.onPointerDown(U,"min")),onMousedown:u[10]||(u[10]=U=>v.onPointerDown(U,"min"))},[n.createVNode(X,{controlled:b.pointerDown==="min",placement:"top",content:m.tipFormat(v.exportValue[0]),disabled:v.tipDisabled,always:m.showTip==="always",ref:"minTooltip"},{default:n.withCtx(()=>[n.createElementVNode("div",{class:n.normalizeClass(v.minButtonClasses),tabindex:"0",onFocus:u[3]||(u[3]=U=>v.handleFocus("min")),onBlur:u[4]||(u[4]=U=>v.handleBlur("min")),onKeydown:[u[5]||(u[5]=n.withKeys(U=>v.onKeyLeft(U,"min"),["left"])),u[6]||(u[6]=n.withKeys(U=>v.onKeyLeft(U,"min"),["down"])),u[7]||(u[7]=n.withKeys(U=>v.onKeyRight(U,"min"),["right"])),u[8]||(u[8]=n.withKeys(U=>v.onKeyRight(U,"min"),["up"]))]},null,34)]),_:1},8,["controlled","content","disabled","always"])],38),m.range?(n.openBlock(),n.createElementBlock("div",{key:2,class:n.normalizeClass([b.prefixCls+"-button-wrap"]),style:n.normalizeStyle({left:v.maxPosition+"%"}),onTouchstart:u[17]||(u[17]=U=>v.onPointerDown(U,"max")),onMousedown:u[18]||(u[18]=U=>v.onPointerDown(U,"max"))},[n.createVNode(X,{controlled:b.pointerDown==="max",placement:"top",content:m.tipFormat(v.exportValue[1]),disabled:v.tipDisabled,always:m.showTip==="always",ref:"maxTooltip"},{default:n.withCtx(()=>[n.createElementVNode("div",{class:n.normalizeClass(v.maxButtonClasses),tabindex:"0",onFocus:u[11]||(u[11]=U=>v.handleFocus("max")),onBlur:u[12]||(u[12]=U=>v.handleBlur("max")),onKeydown:[u[13]||(u[13]=n.withKeys(U=>v.onKeyLeft(U,"max"),["left"])),u[14]||(u[14]=n.withKeys(U=>v.onKeyLeft(U,"max"),["down"])),u[15]||(u[15]=n.withKeys(U=>v.onKeyRight(U,"max"),["right"])),u[16]||(u[16]=n.withKeys(U=>v.onKeyRight(U,"max"),["up"]))]},null,34)]),_:1},8,["controlled","content","disabled","always"])],38)):n.createCommentVNode("",!0)],2)],2)}var vU=l(lde,[["render",ude]]);const dde={small:8,default:16,large:24},xU={name:"Space",props:{size:{type:[String,Number,Array],validator(c){const u=["small","large","default"];return typeof c=="string"?T(c,u):Array.isArray(c)?c.length>0&&c.every(m=>typeof m=="number"||T(m,u)):!0},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||!c.$VIEWUI.space||c.$VIEWUI.space.size===""?"small":c.$VIEWUI.space.size}},direction:{type:String,validator(c){return T(c,["horizontal","vertical"])},default:"horizontal"},align:{type:String,validator(c){return T(c,["start","end","center","baseline","stretch"])}},wrap:{type:Boolean,default:!1},split:{type:Boolean,default:!1},type:{type:String,validator(c){return T(c,["inline-flex","flex"])},default:"inline-flex"}},computed:{mergedAlign(){if(!this.align){if(this.direction==="horizontal")return"center";if(this.type==="flex")return"stretch"}return this.align},classes(){return["ivu-space",`ivu-space-${this.direction}`,{"ivu-space-flex":this.type==="flex","ivu-space-wrap":this.wrap,[`ivu-space-${this.mergedAlign}`]:this.mergedAlign}]},styles(){const c={};return["number","string"].includes(typeof this.size)&&(c.gap=this.getSize(this.size)),Array.isArray(this.size)&&(this.size.length===1?c.columnGap=this.getSize(this.size[0]):this.size.length>1&&(c.columnGap=this.getSize(this.size[0]),c.rowGap=this.getSize(this.size[1]))),c}},methods:{getSize(c){return`${typeof c=="string"?dde[c]:c||0}px`},filterEmpty(c=[]){const u=[];return c.forEach(m=>{Array.isArray(m)?u.push(...m):m.type===n.Fragment?u.push(...m.children):u.push(m)}),u.filter(m=>!this.isEmptyElement(m))},isEmptyElement(c){return c&&(c.type===n.Comment||c.type===n.Fragment&&c.children.length===0||c.type===n.Text&&c.children.trim()==="")}},render(){const c=this.filterEmpty(this.$slots.default?this.$slots.default():[]),u=c.length;if(u===0)return null;let m=null;return this.split&&!this.$slots.split?m=n.h(yw,{type:"vertical"}):this.$slots.split&&(m=this.$slots.split()),n.h("div",{class:this.classes,style:this.styles},c.map((S,b)=>{const v=n.h("div",{class:"ivu-space-item"},[S]);return m&&b+1<u?[v,n.h("div",{class:"ivu-space-split"},[m])]:v}))}},fde={name:"Trigger",props:{mode:String},data(){return{prefix:"ivu-split-trigger",initOffset:0}},computed:{isVertical(){return this.mode==="vertical"},classes(){return[this.prefix,this.isVertical?`${this.prefix}-vertical`:`${this.prefix}-horizontal`]},barConClasses(){return[`${this.prefix}-bar-con`,this.isVertical?"vertical":"horizontal"]}}};function pde(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.createElementVNode("div",{class:n.normalizeClass(v.barConClasses)},[u[0]||(n.setBlockTracking(-1),u[0]=(n.openBlock(),n.createElementBlock(n.Fragment,null,n.renderList(8,M=>n.createElementVNode("i",{class:n.normalizeClass(`${b.prefix}-bar`),key:`trigger-${M}`},null,2)),64)),n.setBlockTracking(1),u[0])],2)],2)}var mde=l(fde,[["render",pde]]);const gde={name:"Split",components:{Trigger:mde},emits:["update:modelValue","on-move-start","on-moving","on-move-end"],props:{modelValue:{type:[Number,String],default:.5},mode:{validator(c){return T(c,["horizontal","vertical"])},default:"horizontal"},min:{type:[Number,String],default:"40px"},max:{type:[Number,String],default:"40px"}},data(){return{prefix:"ivu-split",offset:0,oldOffset:0,isMoving:!1,computedMin:0,computedMax:0,currentValue:.5}},computed:{wrapperClasses(){return[`${this.prefix}-wrapper`,this.isMoving?"no-select":""]},paneClasses(){return[`${this.prefix}-pane`,{[`${this.prefix}-pane-moving`]:this.isMoving}]},isHorizontal(){return this.mode==="horizontal"},anotherOffset(){return 100-this.offset},valueIsPx(){return typeof this.modelValue=="string"},offsetSize(){return this.isHorizontal?"offsetWidth":"offsetHeight"}},methods:{px2percent(c,u){return parseFloat(c)/parseFloat(u)},getComputedThresholdValue(c){let u=this.$refs.outerWrapper[this.offsetSize];return this.valueIsPx?typeof this[c]=="string"?this[c]:u*this[c]:typeof this[c]=="string"?this.px2percent(this[c],u):this[c]},getMin(c,u){return this.valueIsPx?`${Math.min(parseFloat(c),parseFloat(u))}px`:Math.min(c,u)},getMax(c,u){return this.valueIsPx?`${Math.max(parseFloat(c),parseFloat(u))}px`:Math.max(c,u)},getAnotherOffset(c){let u=0;return this.valueIsPx?u=`${this.$refs.outerWrapper[this.offsetSize]-parseFloat(c)}px`:u=1-c,u},handleMove(c){let u=(this.isHorizontal?c.pageX:c.pageY)-this.initOffset,m=this.$refs.outerWrapper[this.offsetSize],S=this.valueIsPx?`${parseFloat(this.oldOffset)+u}px`:this.px2percent(m*this.oldOffset+u,m),b=this.getAnotherOffset(S);parseFloat(S)<=parseFloat(this.computedMin)&&(S=this.getMax(S,this.computedMin)),parseFloat(b)<=parseFloat(this.computedMax)&&(S=this.getAnotherOffset(this.getMax(b,this.computedMax))),c.atMin=this.modelValue===this.computedMin,c.atMax=this.valueIsPx?this.getAnotherOffset(this.modelValue)===this.computedMax:this.getAnotherOffset(this.modelValue).toFixed(5)===this.computedMax.toFixed(5),this.$emit("update:modelValue",S),this.$emit("on-moving",c)},handleUp(){this.isMoving=!1,a(document,"mousemove",this.handleMove),a(document,"mouseup",this.handleUp),this.$emit("on-move-end")},handleMousedown(c){this.initOffset=this.isHorizontal?c.pageX:c.pageY,this.oldOffset=this.modelValue,this.isMoving=!0,o(document,"mousemove",this.handleMove),o(document,"mouseup",this.handleUp),this.$emit("on-move-start")},computeOffset(){n.nextTick(()=>{this.computedMin=this.getComputedThresholdValue("min"),this.computedMax=this.getComputedThresholdValue("max"),this.offset=(this.valueIsPx?this.px2percent(this.modelValue,this.$refs.outerWrapper[this.offsetSize]):this.modelValue)*1e4/100})}},watch:{modelValue(c){c!==this.currentValue&&(this.currentValue=c,this.computeOffset())}},mounted(){n.nextTick(()=>{this.computeOffset()}),o(window,"resize",this.computeOffset)},beforeUnmount(){a(window,"resize",this.computeOffset)}};function yde(c,u,m,S,b,v){const M=n.resolveComponent("trigger");return n.openBlock(),n.createElementBlock("div",{ref:"outerWrapper",class:n.normalizeClass(v.wrapperClasses)},[v.isHorizontal?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(`${b.prefix}-horizontal`)},[n.createElementVNode("div",{style:n.normalizeStyle({right:`${v.anotherOffset}%`}),class:n.normalizeClass(["left-pane",v.paneClasses])},[n.renderSlot(c.$slots,"left")],6),n.createElementVNode("div",{class:n.normalizeClass(`${b.prefix}-trigger-con`),style:n.normalizeStyle({left:`${b.offset}%`}),onMousedown:u[0]||(u[0]=(...N)=>v.handleMousedown&&v.handleMousedown(...N))},[n.renderSlot(c.$slots,"trigger",{},()=>[n.createVNode(M,{mode:"vertical"})])],38),n.createElementVNode("div",{style:n.normalizeStyle({left:`${b.offset}%`}),class:n.normalizeClass(["right-pane",v.paneClasses])},[n.renderSlot(c.$slots,"right")],6)],2)):(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass(`${b.prefix}-vertical`)},[n.createElementVNode("div",{style:n.normalizeStyle({bottom:`${v.anotherOffset}%`}),class:n.normalizeClass(["top-pane",v.paneClasses])},[n.renderSlot(c.$slots,"top")],6),n.createElementVNode("div",{class:n.normalizeClass(`${b.prefix}-trigger-con`),style:n.normalizeStyle({top:`${b.offset}%`}),onMousedown:u[1]||(u[1]=(...N)=>v.handleMousedown&&v.handleMousedown(...N))},[n.renderSlot(c.$slots,"trigger",{},()=>[n.createVNode(M,{mode:"horizontal"})])],38),n.createElementVNode("div",{style:n.normalizeStyle({top:`${b.offset}%`}),class:n.normalizeClass(["bottom-pane",v.paneClasses])},[n.renderSlot(c.$slots,"bottom")],6)],2))],2)}var _U=l(gde,[["render",yde]]);const Jm="ivu-steps",bU="ivu-icon",vde={name:"Step",inject:["StepsInstance"],props:{status:{validator(c){return T(c,["wait","process","finish","error"])}},title:{type:String,default:""},content:{type:String},icon:{type:String}},data(){return{prefixCls:Jm,id:te(6)}},computed:{wrapClasses(){return[`${Jm}-item`,`${Jm}-status-${this.currentStatus}`,{[`${Jm}-custom`]:!!this.icon||!!this.$slots.icon,[`${Jm}-next-error`]:this.nextError}]},iconClasses(){let c="";return this.icon?c=this.icon:this.currentStatus==="finish"?c="ios-checkmark":this.currentStatus==="error"&&(c="ios-close"),[`${Jm}-icon`,`${bU}`,{[`${bU}-${c}`]:c!==""}]},stepNumber(){return this.StepsInstance.steps.findIndex(c=>c.id===this.id)+1},total(){return this.StepsInstance.direction==="horizontal"?this.StepsInstance.steps.length:1},currentStatus(){let c="";if(this.status)c=this.status;else{const u=this.StepsInstance,m=u.current,S=u.steps.findIndex(b=>b.id===this.id);S===m?u.status!=="error"?c="process":c="error":S<m?c="finish":c="wait"}return c},nextError(){let c=!1;const u=this.StepsInstance,m=u.steps.findIndex(S=>S.id===this.id);return m+1<u.steps.length&&u.steps[m+1].currentStatus==="error"&&(c=!0),c}},beforeMount(){this.StepsInstance.addStep(this.id,this)},beforeUnmount(){this.StepsInstance.removeStep(this.id)}},xde=[n.createElementVNode("i",null,null,-1)],_de={key:0},bde={key:1,class:"ivu-steps-icon"};function wde(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses)},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-tail"])},xde,2),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-head"])},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-head-inner"])},[!m.icon&&!c.$slots.icon&&v.currentStatus!=="finish"&&v.currentStatus!=="error"?(n.openBlock(),n.createElementBlock("span",_de,n.toDisplayString(v.stepNumber),1)):c.$slots.icon?(n.openBlock(),n.createElementBlock("span",bde,[n.renderSlot(c.$slots,"icon")])):(n.openBlock(),n.createElementBlock("span",{key:2,class:n.normalizeClass(v.iconClasses)},null,2))],2)],2),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-main"])},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-title"])},[n.renderSlot(c.$slots,"title",{},()=>[n.createTextVNode(n.toDisplayString(m.title),1)])],2),m.content||c.$slots.content?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-content"])},[n.renderSlot(c.$slots,"content",{},()=>[n.createTextVNode(n.toDisplayString(m.content),1)])],2)):n.createCommentVNode("",!0)],2)],2)}var wU=l(vde,[["render",wde]]);const gM="ivu-steps",Ode={name:"Steps",provide(){return{StepsInstance:this}},props:{current:{type:Number,default:0},status:{validator(c){return T(c,["wait","process","finish","error"])},default:"process"},size:{validator(c){return T(c,["small"])}},direction:{validator(c){return T(c,["horizontal","vertical"])},default:"horizontal"}},data(){return{steps:[]}},computed:{classes(){return[`${gM}`,`${gM}-${this.direction}`,{[`${gM}-${this.size}`]:!!this.size}]},children(){return this.steps.map(c=>c.step)}},methods:{addStep(c,u){this.steps.push({id:c,step:u})},removeStep(c){const u=this.steps.findIndex(m=>m.id===c);this.steps.splice(u,1)}}};function Sde(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes)},[n.renderSlot(c.$slots,"default")],2)}var OU=l(Ode,[["render",Sde]]);const Vf="ivu-menu",Cde={name:"Submenu",mixins:[rM,xl],components:{Icon:O,Drop:Ke,CollapseTransition:hM},provide(){return{SubmenuInstance:this}},props:{name:{type:[String,Number],required:!0},disabled:{type:Boolean,default:!1}},data(){return{prefixCls:Vf,active:!1,opened:!1,dropWidth:parseFloat(k(this.$el,"width")),id:te(6),childSubmenuList:[]}},computed:{classes(){return[`${Vf}-submenu`,{[`${Vf}-item-active`]:this.active&&!this.hasParentSubmenu,[`${Vf}-opened`]:this.opened,[`${Vf}-submenu-disabled`]:this.disabled,[`${Vf}-submenu-has-parent-submenu`]:this.hasParentSubmenu,[`${Vf}-child-item-active`]:this.active}]},accordion(){return this.menu.accordion},dropStyle(){let c={};return this.dropWidth&&(c.minWidth=`${this.dropWidth}px`),c},titleStyle(){return this.hasParentSubmenu&&this.mode!=="horizontal"?{paddingLeft:43+(this.parentSubmenuNum-1)*24+"px"}:{}},arrowType(){const c=this.globalConfig;let u="ios-arrow-down";return c&&(c.menu.customArrow?u="":c.menu.arrow&&(u=c.menu.arrow)),u},customArrowType(){const c=this.globalConfig;let u="";return c&&c.menu.customArrow&&(u=c.menu.customArrow),u},arrowSize(){const c=this.globalConfig;let u="";return c&&c.menu.arrowSize&&(u=c.menu.arrowSize),u}},methods:{handleMouseenter(){this.disabled||this.mode!=="vertical"&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.menu.updateOpenKeys(this.name),this.opened=!0},250))},handleMouseleave(){this.disabled||this.mode!=="vertical"&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.menu.updateOpenKeys(this.name),this.opened=!1},150))},handleClick(){if(this.disabled||this.mode==="horizontal")return;const c=this.opened;this.opened=!c,this.menu.updateOpenKeys(this.name)},addSubmenu(){const c=this.MenuInstance;c.submenuList||(c.submenuList=[]),c.submenuList.push({id:this.id,submenu:this});const u=F(this,"Submenu");u&&(u.childSubmenuList||(u.childSubmenuList=[]),u.childSubmenuList.push({id:this.id,submenu:this}))},removeSubmenu(){const c=this.MenuInstance;if(c.submenuList&&c.submenuList.length){const m=c.submenuList.findIndex(S=>S.id===this.id);c.submenuList.splice(m,1)}const u=F(this,"Submenu");if(u&&u.childSubmenuList&&u.childSubmenuList.length){const m=u.childSubmenuList.findIndex(S=>S.id===this.id);u.childSubmenuList.splice(m,1)}},handleMenuItemSelect(c){this.mode==="horizontal"&&(this.opened=!1),this.MenuInstance.handleMenuItemSelect(c)},handleUpdateActiveName(c){F(this,"Submenu")&&this.SubmenuInstance.handleUpdateActiveName(c),this.childSubmenuList&&this.childSubmenuList.length&&this.childSubmenuList.map(u=>u.submenu).forEach(u=>{u.active=!1}),this.active=c}},watch:{mode(c){c==="horizontal"&&this.$refs.drop.update()},opened(c){this.mode!=="vertical"&&(c?(this.dropWidth=parseFloat(k(this.$el,"width")),this.$refs.drop.update()):this.$refs.drop.destroy())}},mounted(){this.addSubmenu()},beforeUnmount(){this.removeSubmenu()}};function Tde(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("collapse-transition"),X=n.resolveComponent("Drop");return n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(v.classes),onMouseenter:u[1]||(u[1]=(...U)=>v.handleMouseenter&&v.handleMouseenter(...U)),onMouseleave:u[2]||(u[2]=(...U)=>v.handleMouseleave&&v.handleMouseleave(...U))},[n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-submenu-title"]),ref:"reference",onClick:u[0]||(u[0]=n.withModifiers((...U)=>v.handleClick&&v.handleClick(...U),["stop"])),style:n.normalizeStyle(v.titleStyle)},[n.renderSlot(c.$slots,"title"),n.createVNode(M,{type:v.arrowType,custom:v.customArrowType,size:v.arrowSize,class:n.normalizeClass([b.prefixCls+"-submenu-title-icon"])},null,8,["type","custom","size","class"])],6),c.mode==="vertical"?(n.openBlock(),n.createBlock(N,{key:0,ready:c.menu.ready},{default:n.withCtx(()=>[n.withDirectives(n.createElementVNode("ul",{class:n.normalizeClass([b.prefixCls])},[n.renderSlot(c.$slots,"default")],2),[[n.vShow,b.opened]])]),_:3},8,["ready"])):n.createCommentVNode("",!0),c.mode==="horizontal"?(n.openBlock(),n.createBlock(X,{key:1,ref:"drop",visible:b.opened,placement:"bottom","transition-name":"slide-up",styles:v.dropStyle},{default:n.withCtx(()=>[n.createElementVNode("ul",{class:n.normalizeClass([b.prefixCls+"-drop-list"])},[n.renderSlot(c.$slots,"default")],2)]),_:3},8,["visible","styles"])):n.createCommentVNode("",!0)],34)}var SU=l(Cde,[["render",Tde]]);const CU={name:"Submit",inject:["LoginInstance"],props:{},methods:{handleSubmit(){this.LoginInstance.handleSubmit()}},render(){const c=Object.assign({size:"large",type:"primary",long:!0},this.$attrs),u=n.h(co,{...c,onClick:this.handleSubmit},this.$slots.default||(()=>""));return n.h("div",{class:"ivu-login-submit"},[u])}},eg="ivu-switch",Ade={name:"iSwitch",mixins:[Li],emits:["update:modelValue","on-change"],props:{modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:!1},size:{validator(c){return T(c,["large","small","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},name:{type:String},loading:{type:Boolean,default:!1},trueColor:{type:String},falseColor:{type:String},beforeChange:Function},data(){return{currentValue:this.modelValue}},computed:{wrapClasses(){return[`${eg}`,{[`${eg}-checked`]:this.currentValue===this.trueValue,[`${eg}-disabled`]:this.itemDisabled,[`${eg}-${this.size}`]:!!this.size,[`${eg}-loading`]:this.loading}]},wrapStyles(){let c={};return this.trueColor&&this.currentValue===this.trueValue?(c["border-color"]=this.trueColor,c["background-color"]=this.trueColor):this.falseColor&&this.currentValue===this.falseValue&&(c["border-color"]=this.falseColor,c["background-color"]=this.falseColor),c},innerClasses(){return`${eg}-inner`}},methods:{handleToggle(){const c=this.currentValue===this.trueValue?this.falseValue:this.trueValue;this.currentValue=c,this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c)},toggle(c){if(c.preventDefault(),this.itemDisabled||this.loading)return!1;if(!this.beforeChange)return this.handleToggle();const u=this.beforeChange();u&&u.then?u.then(()=>{this.handleToggle()}):this.handleToggle()}},watch:{modelValue(c){if(c!==this.trueValue&&c!==this.falseValue&&c!==null)throw"Value should be trueValue or falseValue.";this.currentValue=c}}},Ede=["name","value"];function Mde(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("span",{tabindex:"0",class:n.normalizeClass(v.wrapClasses),style:n.normalizeStyle(v.wrapStyles),onClick:u[0]||(u[0]=(...M)=>v.toggle&&v.toggle(...M)),onKeydown:u[1]||(u[1]=n.withKeys((...M)=>v.toggle&&v.toggle(...M),["space"]))},[n.createElementVNode("input",{type:"hidden",name:m.name,value:b.currentValue},null,8,Ede),n.createElementVNode("span",{class:n.normalizeClass(v.innerClasses)},[b.currentValue===m.trueValue?n.renderSlot(c.$slots,"open",{key:0}):n.createCommentVNode("",!0),b.currentValue===m.falseValue?n.renderSlot(c.$slots,"close",{key:1}):n.createCommentVNode("",!0)],2)],38)}var yM=l(Ade,[["render",Mde]]),kde={name:"TableRenderHeader",props:{render:Function,column:Object,index:Number},render(){const c={column:this.column,index:this.index};return this.render(n.h,c)}},vM={methods:{alignCls(c,u={}){let m="";return u.cellClassName&&c.key&&u.cellClassName[c.key]&&(m=u.cellClassName[c.key]),[`${this.prefixCls}-column-${c.__id}`,{[`${m}`]:m,[`${c.className}`]:c.className,[`${this.prefixCls}-column-${c.align}`]:c.align,[`${this.prefixCls}-hidden`]:this.fixed==="left"&&c.fixed!=="left"||this.fixed==="right"&&c.fixed!=="right"||!this.fixed&&c.fixed&&(c.fixed==="left"||c.fixed==="right")}]},isPopperShow(c){return c.filters&&(!this.fixed&&!c.fixed||this.fixed==="left"&&c.fixed==="left"||this.fixed==="right"&&c.fixed==="right")},setCellWidth(c){let u="";return c.width?u=c.width:this.columnsWidth[c._index]&&(u=this.columnsWidth[c._index].width),u==="0"&&(u=""),u}}};const Pde={name:"TableHead",mixins:[vM,Sn],components:{CheckboxGroup:kE,Checkbox:Xm,Poptip:uM,iButton:co,renderHeader:kde},props:{prefixCls:String,styleObject:Object,columns:Array,objData:Object,data:Array,columnsWidth:Object,fixed:{type:[Boolean,String],default:!1},columnRows:Array,fixedColumnRows:Array},data(){return{draggingColumn:null,dragging:!1,dragState:{}}},computed:{styles(){const c=Object.assign({},this.styleObject),u=parseInt(this.styleObject.width);return c.width=`${u}px`,c},isSelectAll(){let c=!0;this.data.length||(c=!1);let u=!0;for(let m in this.objData){const S=this.objData[m];if(!S._isChecked&&!S._isDisabled){c=!1;break}else S.children&&S.children.length&&(c=this.isChildrenSelected(S,c));S._isDisabled&&!S._isChecked?S.children&&S.children.length&&(u=this.isChildrenAllDisabledAndUnSelected(S,u)):u=!1}return u&&(c=!1),c},headRows(){return this.columnRows.length>1?this.fixed?this.fixedColumnRows:this.columnRows:[this.columns]},isSelectDisabled(){let c=!0;if(this.data.length)for(let u in this.objData){const m=this.objData[u];m._isDisabled?m.children&&m.children.length&&(c=this.isChildrenDisabled(m,c)):c=!1}return c}},methods:{cellClasses(c){return[`${this.prefixCls}-cell`,{[`${this.prefixCls}-hidden`]:!this.fixed&&c.fixed&&(c.fixed==="left"||c.fixed==="right"),[`${this.prefixCls}-cell-with-selection`]:c.type==="selection"}]},scrollBarCellClass(){let c=!1;for(let u in this.headRows)for(let m in this.headRows[u]){if(this.headRows[u][m].fixed==="right"){c=!0;break}if(c)break}return[{[`${this.prefixCls}-hidden`]:c}]},itemClasses(c,u){return[`${this.prefixCls}-filter-select-item`,{[`${this.prefixCls}-filter-select-item-selected`]:c._filterChecked[0]===u.value}]},itemAllClasses(c){return[`${this.prefixCls}-filter-select-item`,{[`${this.prefixCls}-filter-select-item-selected`]:!c._filterChecked.length}]},selectAll(){const c=!this.isSelectAll;this.$parent.selectAll(c)},handleSort(c,u){const m=this.columns.find(b=>b._index===c),S=m._index;m._sortType===u&&(u="normal"),this.$parent.handleSort(S,u)},handleSortByHead(c){const u=this.columns.find(m=>m._index===c);if(u.sortable){const m=u._sortType;m==="normal"?this.handleSort(c,"asc"):m==="asc"?this.handleSort(c,"desc"):this.handleSort(c,"normal")}},handleFilter(c){this.$parent.handleFilter(c)},handleSelect(c,u){this.$parent.handleFilterSelect(c,u)},handleReset(c){this.$parent.handleFilterReset(c)},handleFilterHide(c){this.$parent.handleFilterHide(c)},getColumn(c,u){if(this.columnRows.length>1){const m=this.headRows[c][u].__id;return this.columns.filter(S=>S.__id===m)[0]}else return this.headRows[c][u]},handleMouseDown(c,u){if(!this.$isServer&&r&&this.draggingColumn){this.dragging=!0;const m=this.$parent,S=m.$el.getBoundingClientRect().left,b=this.$el.querySelector(`th.ivu-table-column-${c.__id}`).getBoundingClientRect(),v=b.left-S+30;m.showResizeLine=!0,this.dragState={startMouseLeft:u.clientX,startLeft:b.right-S,startColumnLeft:b.left-S,tableLeft:S};const M=m.$refs.resizeLine;M.style.left=this.dragState.startLeft+"px",document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const N=U=>{const H=U.clientX-this.dragState.startMouseLeft,re=this.dragState.startLeft+H;M.style.left=Math.max(v,re)+"px"},X=()=>{if(this.dragging){const{startColumnLeft:U,startLeft:H}=this.dragState,re=parseInt(M.style.left,10)-U,xe=m.allColumns.find(ye=>ye.__id===c.__id);xe&&(xe.width=re,c.width=re,m.handleResize()),m.$emit("on-column-width-resize",xe.width,H-U,c,u),r&&(document.body.style.cursor=""),this.dragging=!1,this.draggingColumn=null,this.dragState={},m.showResizeLine=!1}!r||(document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",X),document.onselectstart=null,document.ondragstart=null)};if(!r)return;document.addEventListener("mousemove",N),document.addEventListener("mouseup",X)}},handleMouseMove(c,u){let m=u.target;for(;m&&m.tagName!=="TH";)m=m.parentNode;if(!(!c||!c.resizable)&&r&&!this.dragging){let S=m.getBoundingClientRect();const b=document.body.style;S.width>12&&S.right-u.pageX<8?(b.cursor="col-resize",this.draggingColumn=c):this.dragging||(b.cursor="",this.draggingColumn=null)}},handleMouseOut(){this.$isServer||r&&(document.body.style.cursor="")},isChildrenSelected(c,u){let m=u;return c.children&&c.children.length&&c.children.forEach(S=>{!S._isChecked&&!S._isDisabled?m=!1:S.children&&S.children.length&&(m=this.isChildrenSelected(S,m))}),m},isChildrenAllDisabledAndUnSelected(c,u){let m=u;return c.children&&c.children.length&&c.children.forEach(S=>{S._isDisabled&&!S._isChecked?S.children&&S.children.length&&(m=this.isChildrenAllDisabledAndUnSelected(S,m)):m=!1}),m},isChildrenDisabled(c,u){let m=u;return c.children&&c.children.length&&c.children.forEach(S=>{S._isDisabled?S.children&&S.children.length&&(m=this.isChildrenDisabled(S,m)):m=!1}),m}}},Ide=["width"],Bde=["width"],Rde=["colspan","rowspan"],Dde={key:0},Lde=["onClick"],Nde=["onClick"],Vde=["onClick"],$de=["onMousedown","onMousemove"],Ude=["rowspan"];function Fde(c,u,m,S,b,v){const M=n.resolveComponent("render-header"),N=n.resolveComponent("Checkbox"),X=n.resolveComponent("checkbox"),U=n.resolveComponent("checkbox-group"),H=n.resolveComponent("i-button"),re=n.resolveComponent("Poptip");return n.openBlock(),n.createElementBlock("table",{cellspacing:"0",cellpadding:"0",border:"0",style:n.normalizeStyle(v.styles)},[n.createElementVNode("colgroup",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.columns,(xe,ye)=>(n.openBlock(),n.createElementBlock("col",{key:ye,width:c.setCellWidth(xe)},null,8,Ide))),128)),c.$parent.showVerticalScrollBar?(n.openBlock(),n.createElementBlock("col",{key:0,width:c.$parent.scrollBarWidth},null,8,Bde)):n.createCommentVNode("",!0)]),n.createElementVNode("thead",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.headRows,(xe,ye)=>(n.openBlock(),n.createElementBlock("tr",{key:ye},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(xe,(me,ne)=>(n.openBlock(),n.createElementBlock("th",{key:ne,colspan:me.colSpan,rowspan:me.rowSpan,class:n.normalizeClass(c.alignCls(me))},[n.createElementVNode("div",{class:n.normalizeClass(v.cellClasses(me))},[me.type==="expand"?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[me.renderHeader?(n.openBlock(),n.createBlock(M,{key:1,render:me.renderHeader,column:me,index:ne},null,8,["render","column","index"])):(n.openBlock(),n.createElementBlock("span",Dde,n.toDisplayString(me.title||""),1))],64)):me.type==="selection"?(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[me.hideSelectAll?n.createCommentVNode("",!0):(n.openBlock(),n.createBlock(N,{key:0,"model-value":v.isSelectAll,disabled:v.isSelectDisabled,onOnChange:v.selectAll},null,8,["model-value","disabled","onOnChange"]))],64)):(n.openBlock(),n.createElementBlock(n.Fragment,{key:2},[me.renderHeader?(n.openBlock(),n.createBlock(M,{key:1,render:me.renderHeader,column:me,index:ne},null,8,["render","column","index"])):(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass({[m.prefixCls+"-cell-sort"]:me.sortable}),onClick:Te=>me.sortable&&v.handleSortByHead(v.getColumn(ye,ne)._index)},n.toDisplayString(me.title||"#"),11,Lde)),me.sortable?(n.openBlock(),n.createElementBlock("span",{key:2,class:n.normalizeClass([m.prefixCls+"-sort"])},[n.createElementVNode("i",{class:n.normalizeClass(["ivu-icon ivu-icon-md-arrow-dropup",{on:v.getColumn(ye,ne)._sortType==="asc"}]),onClick:Te=>v.handleSort(v.getColumn(ye,ne)._index,"asc")},null,10,Nde),n.createElementVNode("i",{class:n.normalizeClass(["ivu-icon ivu-icon-md-arrow-dropdown",{on:v.getColumn(ye,ne)._sortType==="desc"}]),onClick:Te=>v.handleSort(v.getColumn(ye,ne)._index,"desc")},null,10,Vde)],2)):n.createCommentVNode("",!0),c.isPopperShow(me)?(n.openBlock(),n.createBlock(re,{key:3,modelValue:v.getColumn(ye,ne)._filterVisible,"onUpdate:modelValue":Te=>v.getColumn(ye,ne)._filterVisible=Te,placement:"bottom","popper-class":"ivu-table-popper",transfer:"",capture:!1,onOnPopperHide:Te=>v.handleFilterHide(v.getColumn(ye,ne)._index)},n.createSlots({default:n.withCtx(()=>[n.createElementVNode("span",{class:n.normalizeClass([m.prefixCls+"-filter"])},[n.createElementVNode("i",{class:n.normalizeClass(["ivu-icon ivu-icon-ios-funnel",{on:v.getColumn(ye,ne)._isFiltered}])},null,2)],2)]),_:2},[v.getColumn(ye,ne)._filterMultiple?{name:"content",fn:n.withCtx(()=>[n.createElementVNode("div",{class:n.normalizeClass([m.prefixCls+"-filter-list"])},[n.createElementVNode("div",{class:n.normalizeClass([m.prefixCls+"-filter-list-item"])},[n.createVNode(U,{modelValue:v.getColumn(ye,ne)._filterChecked,"onUpdate:modelValue":Te=>v.getColumn(ye,ne)._filterChecked=Te},{default:n.withCtx(()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(me.filters,(Te,Xt)=>(n.openBlock(),n.createBlock(X,{key:Xt,label:Te.value},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(Te.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],2),n.createElementVNode("div",{class:n.normalizeClass([m.prefixCls+"-filter-footer"])},[n.createVNode(H,{type:"text",size:"small",disabled:!v.getColumn(ye,ne)._filterChecked.length,onClick:Te=>v.handleFilter(v.getColumn(ye,ne)._index)},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(c.t("i.table.confirmFilter")),1)]),_:2},1032,["disabled","onClick"]),n.createVNode(H,{type:"text",size:"small",onClick:Te=>v.handleReset(v.getColumn(ye,ne)._index)},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(c.t("i.table.resetFilter")),1)]),_:2},1032,["onClick"])],2)],2)]),key:"0"}:{name:"content",fn:n.withCtx(()=>[n.createElementVNode("div",{class:n.normalizeClass([m.prefixCls+"-filter-list"])},[n.createElementVNode("ul",{class:n.normalizeClass([m.prefixCls+"-filter-list-single"])},[n.createElementVNode("li",{class:n.normalizeClass(v.itemAllClasses(v.getColumn(ye,ne))),onClick:Te=>v.handleReset(v.getColumn(ye,ne)._index)},n.toDisplayString(c.t("i.table.clearFilter")),11,["onClick"]),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(me.filters,Te=>(n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(v.itemClasses(v.getColumn(ye,ne),Te)),key:Te.value,onClick:Xt=>v.handleSelect(v.getColumn(ye,ne)._index,Te.value)},n.toDisplayString(Te.label),11,["onClick"]))),128))],2)],2)]),key:"1"}]),1032,["modelValue","onUpdate:modelValue","onOnPopperHide"])):n.createCommentVNode("",!0)],64))],2),me.resizable?(n.openBlock(),n.createElementBlock("div",{key:0,class:"ivu-table-header-resizable",onMousedown:Te=>v.handleMouseDown(me,Te),onMousemove:Te=>v.handleMouseMove(me,Te),onMouseout:u[0]||(u[0]=(...Te)=>v.handleMouseOut&&v.handleMouseOut(...Te))},null,40,$de)):n.createCommentVNode("",!0)],10,Rde))),128)),c.$parent.showVerticalScrollBar&&ye===0?(n.openBlock(),n.createElementBlock("th",{key:0,class:n.normalizeClass(v.scrollBarCellClass()),rowspan:v.headRows.length},null,10,Ude)):n.createCommentVNode("",!0)]))),128))])],4)}var zde=l(Pde,[["render",Fde]]);const Xde={props:{row:Object,prefixCls:String,draggable:Boolean,isChildren:Boolean},computed:{objData(){return this.$parent.objData}},methods:{onDrag(c,u){c.dataTransfer.setData("index",u)},onDrop(c,u){const m=c.dataTransfer.getData("index");this.$parent.$parent.dragAndDrop(m,u),c.preventDefault()},allowDrop(c){c.preventDefault()},rowClasses(c){const u=this.isChildren?this.$parent.$parent.getDataByRowKey(this.row._rowKey):this.objData[c];return[`${this.prefixCls}-row`,this.rowClsName(c),{[`${this.prefixCls}-row-highlight`]:u&&u._isHighlight,[`${this.prefixCls}-row-hover`]:u&&u._isHover}]},rowClsName(c){return this.$parent.$parent.rowClassName(this.objData[c],c)}}},Wde=["draggable"];function Hde(c,u,m,S,b,v){return m.draggable?(n.openBlock(),n.createElementBlock("tr",{key:0,class:n.normalizeClass(v.rowClasses(m.row._index)),draggable:m.draggable,onDragstart:u[0]||(u[0]=M=>v.onDrag(M,m.row._index)),onDrop:u[1]||(u[1]=M=>v.onDrop(M,m.row._index)),onDragover:u[2]||(u[2]=M=>v.allowDrop(M))},[n.renderSlot(c.$slots,"default")],42,Wde)):(n.openBlock(),n.createElementBlock("tr",{key:1,class:n.normalizeClass(v.rowClasses(m.row._index)),draggable:!1},[n.renderSlot(c.$slots,"default")],2))}var xM=l(Xde,[["render",Hde]]),_M={name:"TableExpand",props:{row:Object,render:Function,index:Number,column:{type:Object,default:null}},render(){const c={row:this.row,index:this.index};return this.column&&(c.column=this.column),this.render(n.h,c)}},Gde={name:"TableSlot",inject:["TableInstance"],props:{row:Object,index:Number,column:{type:Object,default:null},display:{type:String,default:"block"}},render(){return n.h("div",{class:{"ivu-table-cell-slot":!0,"ivu-table-cell-slot-inline":this.display==="inline","ivu-table-cell-slot-inline-block":this.display==="inline-block"}},this.TableInstance.$slots[this.column.slot]({row:this.row,column:this.column,index:this.index}))}};const Qde={name:"TableCell",components:{Icon:O,Checkbox:Xm,TableExpand:_M,TableSlot:Gde,Tooltip:mh},inject:["TableInstance"],props:{prefixCls:String,row:Object,column:Object,naturalIndex:Number,index:Number,checked:Boolean,disabled:Boolean,expanded:Boolean,fixed:{type:[Boolean,String],default:!1},treeNode:Boolean,treeLevel:{type:Number,default:0}},data(){return{renderType:"",uid:-1,context:this.$parent.$parent.$parent.currentContext,showTooltip:!1}},computed:{classes(){return[`${this.prefixCls}-cell`,{[`${this.prefixCls}-hidden`]:!this.fixed&&this.column.fixed&&(this.column.fixed==="left"||this.column.fixed==="right"),[`${this.prefixCls}-cell-ellipsis`]:this.column.ellipsis||!1,[`${this.prefixCls}-cell-with-expand`]:this.renderType==="expand",[`${this.prefixCls}-cell-with-selection`]:this.renderType==="selection"}]},expandCls(){return[`${this.prefixCls}-cell-expand`,{[`${this.prefixCls}-cell-expand-expanded`]:this.expanded}]},showChildren(){let c=!1;if(this.renderType==="html"||this.renderType==="normal"||this.renderType==="render"||this.renderType==="slot"){const u=this.row;(u.children&&u.children.length||"_loading"in u)&&this.column.tree&&(c=!0)}return c},showTreeNode(){let c=!1;return(this.renderType==="html"||this.renderType==="normal"||this.renderType==="render"||this.renderType==="slot")&&this.column.tree&&this.treeNode&&(c=!0),c},showLevel(){let c=!1;return(this.renderType==="html"||this.renderType==="normal"||this.renderType==="render"||this.renderType==="slot")&&this.column.tree&&this.treeNode&&(c=!0),c},treeLevelStyle(){return{"padding-left":this.treeLevel*this.TableInstance.indentSize+"px"}},childrenExpand(){return this.TableInstance.getDataByRowKey(this.row._rowKey)._isShowChildren},childrenLoading(){const c=this.TableInstance.getDataByRowKey(this.row._rowKey);return"_loading"in c&&c._loading}},methods:{toggleSelect(){this.treeNode?this.$parent.$parent.$parent.toggleSelect(this.index,this.row._rowKey):this.$parent.$parent.$parent.toggleSelect(this.index)},toggleExpand(){this.$parent.$parent.$parent.toggleExpand(this.index)},handleClick(){},handleTooltipIn(){if(!r)return;const c=this.$refs.content;let u=document.createRange();u.setStart(c,0),u.setEnd(c,c.childNodes.length);const m=u.getBoundingClientRect().width;this.showTooltip=m>c.offsetWidth,u=null},handleToggleTree(){this.$parent.$parent.$parent.toggleTree(this.row._rowKey)}},created(){this.column.type==="index"?this.renderType="index":this.column.type==="selection"?this.renderType="selection":this.column.type==="html"?this.renderType="html":this.column.type==="expand"?this.renderType="expand":this.column.render?this.renderType="render":this.column.slot?this.renderType="slot":this.renderType="normal"}},Yde={key:0},jde={key:4,class:"ivu-table-cell-tree ivu-table-cell-tree-empty"},qde=["innerHTML"],Zde={key:1};function Kde(c,u,m,S,b,v){const M=n.resolveComponent("Checkbox"),N=n.resolveComponent("Icon"),X=n.resolveComponent("Tooltip"),U=n.resolveComponent("table-expand"),H=n.resolveComponent("table-slot");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),ref:"cell"},[b.renderType==="index"?(n.openBlock(),n.createElementBlock("span",Yde,n.toDisplayString(m.column.indexMethod?m.column.indexMethod(m.row,m.naturalIndex):m.naturalIndex+1),1)):n.createCommentVNode("",!0),b.renderType==="selection"?(n.openBlock(),n.createBlock(M,{key:1,"model-value":m.checked,onClick:n.withModifiers(v.handleClick,["stop"]),onOnChange:v.toggleSelect,disabled:m.disabled},null,8,["model-value","onClick","onOnChange","disabled"])):n.createCommentVNode("",!0),v.showLevel?(n.openBlock(),n.createElementBlock("div",{key:2,class:"ivu-table-cell-tree-level",style:n.normalizeStyle(v.treeLevelStyle)},null,4)):n.createCommentVNode("",!0),v.showChildren?(n.openBlock(),n.createElementBlock("div",{key:3,class:n.normalizeClass(["ivu-table-cell-tree",{"ivu-table-cell-tree-loading":v.childrenLoading}]),onClick:u[0]||(u[0]=n.withModifiers((...re)=>v.handleToggleTree&&v.handleToggleTree(...re),["prevent","stop"]))},[v.childrenLoading?(n.openBlock(),n.createBlock(N,{key:0,type:"ios-loading",class:"ivu-load-loop"})):v.childrenExpand?(n.openBlock(),n.createBlock(N,{key:2,type:"ios-remove"})):(n.openBlock(),n.createBlock(N,{key:1,type:"ios-add"}))],2)):v.showTreeNode?(n.openBlock(),n.createElementBlock("div",jde)):n.createCommentVNode("",!0),b.renderType==="html"?(n.openBlock(),n.createElementBlock("span",{key:5,innerHTML:m.row[m.column.key]},null,8,qde)):n.createCommentVNode("",!0),b.renderType==="normal"?(n.openBlock(),n.createElementBlock(n.Fragment,{key:6},[m.column.tooltip?(n.openBlock(),n.createBlock(X,{key:0,transfer:"",content:m.row[m.column.key],theme:m.column.tooltipTheme?m.column.tooltipTheme:v.TableInstance.tooltipTheme,disabled:!b.showTooltip,"max-width":m.column.tooltipMaxWidth?m.column.tooltipMaxWidth:v.TableInstance.tooltipMaxWidth,class:"ivu-table-cell-tooltip"},{default:n.withCtx(()=>[n.createElementVNode("span",{ref:"content",onMouseenter:u[1]||(u[1]=(...re)=>v.handleTooltipIn&&v.handleTooltipIn(...re)),class:"ivu-table-cell-tooltip-content"},n.toDisplayString(m.row[m.column.key]),545)]),_:1},8,["content","theme","disabled","max-width"])):(n.openBlock(),n.createElementBlock("span",Zde,n.toDisplayString(m.row[m.column.key]),1))],64)):n.createCommentVNode("",!0),b.renderType==="expand"&&!m.row._disableExpand?(n.openBlock(),n.createElementBlock("div",{key:7,class:n.normalizeClass(v.expandCls),onClick:u[2]||(u[2]=(...re)=>v.toggleExpand&&v.toggleExpand(...re))},[n.createVNode(N,{type:"ios-arrow-forward"})],2)):n.createCommentVNode("",!0),b.renderType==="render"?(n.openBlock(),n.createBlock(U,{key:8,row:m.row,column:m.column,index:m.index,render:m.column.render},null,8,["row","column","index","render"])):n.createCommentVNode("",!0),b.renderType==="slot"?(n.openBlock(),n.createBlock(H,{key:9,row:m.row,column:m.column,display:m.column.display||"block",index:m.index},null,8,["row","column","display","index"])):n.createCommentVNode("",!0)],2)}var bM=l(Qde,[["render",Kde]]);const Jde={name:"TableBody",mixins:[vM],components:{TableCell:bM,Expand:_M,TableTr:xM},props:{prefixCls:String,styleObject:Object,columns:Array,data:Array,objData:Object,columnsWidth:Object,fixed:{type:[Boolean,String],default:!1},draggable:{type:Boolean,default:!1},rowKey:{type:[Boolean,String],default:!1}},computed:{expandRender(){let c=function(){return""};for(let u=0;u<this.columns.length;u++){const m=this.columns[u];m.type&&m.type==="expand"&&m.render&&(c=m.render)}return c}},methods:{rowChecked(c){return this.objData[c]&&this.objData[c]._isChecked},rowDisabled(c){return this.objData[c]&&this.objData[c]._isDisabled},rowExpanded(c){return this.objData[c]&&this.objData[c]._isExpanded},rowStatusByRowKey(c,u){return this.$parent.getDataByRowKey(u)[c]},handleMouseIn(c,u,m){u.stopPropagation(),this.$parent.handleMouseIn(c,m)},handleMouseOut(c,u,m){u.stopPropagation(),this.$parent.handleMouseOut(c,m)},clickCurrentRow(c,u,m){this.$parent.clickCurrentRow(c,m)},dblclickCurrentRow(c,u,m){u.stopPropagation(),this.$parent.dblclickCurrentRow(c,m)},clickCell(c,u,m,S){this.$parent.$emit("on-cell-click",c,u,c[m],S)},contextmenuCurrentRow(c,u,m){u.stopPropagation(),this.$parent.contextMenu&&u.preventDefault(),this.$parent.contextmenuCurrentRow(c,m,u)},selectStartCurrentRow(){this.$parent.contextMenu},getSpan(c,u,m,S){const b=this.$parent.spanMethod;if(typeof b=="function"){const v=b({row:c,column:u,rowIndex:m,columnIndex:S});let M=1,N=1;return Array.isArray(v)?(M=v[0],N=v[1]):typeof v=="object"&&(M=v.rowspan,N=v.colspan),{rowspan:M,colspan:N}}else return{}},showWithSpan(c,u,m,S){const b=this.getSpan(c,u,m,S);return!("rowspan"in b&&b.rowspan===0||"colspan"in b&&b.colspan===0)},isTrShow(c){let u=!0,m;for(let S in this.objData){const b=this.objData[S],v=b._isShowChildren;if(b._rowKey===c){u=u&&v;break}else if(b.children&&b.children.length&&(m=this.getTrStatus(c,b,u&&v),m[0]&&m[0]._rowKey===c))return m[1]}return u},getTrStatus(c,u,m){let S=m,b;if(u.children&&u.children.length)for(let v=0;v<u.children.length;v++){const M=u.children[v],N=M._isShowChildren;if(M._rowKey===c){b=M,S=S&&N;break}else if(M.children&&M.children.length){const X=this.getTrStatus(c,M,S&&N);if(X[0]&&X[0]._rowKey===c)return X}}return[b,S]},getLevel(c){let u,m;for(let S=0;S<this.data.length;S++){const b=this.data[S];if(b[this.rowKey]===c){u=0;break}else if(b.children&&b.children.length&&(m=this.getChildLevel(b,c,1),m[0]&&m[0][this.rowKey]===c))return m[1]}return u},getChildLevel(c,u,m){let S,b;if(c.children&&c.children.length)for(let v=0;v<c.children.length;v++){const M=c.children[v];if(M[this.rowKey]===u){b=M,S=m;break}else if(M.children&&M.children.length){const N=this.getChildLevel(M,u,m+1);if(N[0]&&N[0][this.rowKey]===u)return N}}return[b,S]},getChildNode(c,u,m){return u.children&&u.children.length&&u.children.forEach((S,b)=>{let v=[];this.columns.forEach((X,U)=>{if(this.showWithSpan(S,X,b,U)){const H=c(bM,{fixed:this.fixed,"prefix-cls":this.prefixCls,row:S,column:X,"natural-index":b,index:S._index,checked:this.rowStatusByRowKey("_isChecked",S._rowKey),disabled:this.rowStatusByRowKey("_isDisabled",S._rowKey),expanded:this.rowStatusByRowKey("_isExpanded",S._rowKey),treeNode:!0,treeLevel:this.getLevel(S._rowKey),key:X._columnKey}),re=c("td",{class:this.alignCls(X,S),...this.getSpan(S,X,b,U),onClick:xe=>this.clickCell(S,X,X.key,xe)},[H]);v.push(re)}});const M={};this.isTrShow(u._rowKey)||(M.display="none");const N=c(xM,{draggable:!1,row:S,"prefix-cls":this.prefixCls,isChildren:!0,style:M,key:this.rowKey?S._rowKey:b,onMouseenter:X=>this.handleMouseIn(S._index,X,S._rowKey),onMouseleave:X=>this.handleMouseOut(S._index,X,S._rowKey),onClick:X=>this.clickCurrentRow(S._index,X,S._rowKey),onDblclick:X=>this.dblclickCurrentRow(S._index,X,S._rowKey),onContextmenu:X=>this.contextmenuCurrentRow(S._index,X,S._rowKey),onSelectstart:X=>this.selectStartCurrentRow(S._index,X,S._rowKey)},()=>v);m.push(N),S.children&&S.children.length&&this.getChildNode(c,S,m)}),m}},render(){let c=[];this.columns.forEach(b=>{const v=n.h("col",{width:this.setCellWidth(b)});c.push(v)});const u=n.h("colgroup",{},c);let m=[];this.data.forEach((b,v)=>{let M=[];this.columns.forEach((X,U)=>{if(this.showWithSpan(b,X,v,U)){const H=n.h(bM,{fixed:this.fixed,"prefix-cls":this.prefixCls,row:b,column:X,"natural-index":v,index:b._index,checked:this.rowChecked(b._index),disabled:this.rowDisabled(b._index),expanded:this.rowExpanded(b._index),key:X._columnKey}),re=n.h("td",{class:this.alignCls(X,b),...this.getSpan(b,X,v,U),onClick:xe=>this.clickCell(b,X,X.key,xe)},[H]);M.push(re)}});const N=n.h(xM,{draggable:this.draggable,row:b,"prefix-cls":this.prefixCls,key:this.rowKey?b._rowKey:v,onMouseenter:X=>this.handleMouseIn(b._index,X),onMouseleave:X=>this.handleMouseOut(b._index,X),onClick:X=>this.clickCurrentRow(b._index,X),onDblclick:X=>this.dblclickCurrentRow(b._index,X),onContextmenu:X=>this.contextmenuCurrentRow(b._index,X),onSelectstart:X=>this.selectStartCurrentRow(b._index,X)},()=>M);if(m.push(N),this.rowExpanded(b._index)){const X=n.h(_M,{row:b,render:this.expandRender,index:b._index,key:this.rowKey?b._rowKey:v}),U=n.h("td",{colspan:this.columns.length,class:this.prefixCls+"-expanded-cell"},[X]),H=n.h("tr",{class:{[this.prefixCls+"-expanded-hidden"]:this.fixed}},[U]);m.push(H)}b.children&&b.children.length&&this.getChildNode(n.h,b,[]).forEach(X=>{m.push(X)})});const S=n.h("tbody",{class:this.prefixCls+"-tbody"},[m]);return n.h("table",{cellspacing:"0",cellpadding:"0",border:"0",style:this.styleObject},[u,S])}},efe={name:"TableSummary",mixins:[vM],props:{prefixCls:String,styleObject:Object,columns:Array,data:Object,columnsWidth:Object,fixed:{type:[Boolean,String],default:!1}},methods:{cellCls(c){return[{"ivu-table-hidden":this.fixed==="left"&&c.fixed!=="left"||this.fixed==="right"&&c.fixed!=="right"||!this.fixed&&c.fixed&&(c.fixed==="left"||c.fixed==="right")}]}}},tfe={style:{overflow:"hidden"}},ife=["width"],nfe={class:"ivu-table-row"};function sfe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("div",tfe,[n.createElementVNode("table",{class:"ivu-table-summary",cellspacing:"0",cellpadding:"0",border:"0",style:n.normalizeStyle(m.styleObject)},[n.createElementVNode("colgroup",null,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.columns,(M,N)=>(n.openBlock(),n.createElementBlock("col",{key:N,width:c.setCellWidth(M)},null,8,ife))),128))]),n.createElementVNode("tbody",{class:n.normalizeClass([m.prefixCls+"-tbody"])},[n.createElementVNode("tr",nfe,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.columns,(M,N)=>(n.openBlock(),n.createElementBlock("td",{key:N,class:n.normalizeClass(c.alignCls(M))},[n.createElementVNode("div",{class:n.normalizeClass(["ivu-table-cell",v.cellCls(M)])},[n.createElementVNode("span",null,n.toDisplayString(m.data[M.key].value),1)],2)],2))),128))])],2)],4)])}var rfe=l(efe,[["render",sfe]]);const ofe=`\r
`,wM=(c,u,{separator:m,quoted:S})=>{const b=u.map(v=>S?(v=typeof v=="string"?v.replace(/"/g,'"'):v,`"${v}"`):v);c.push(b.join(m))},afe={separator:",",quoted:!1};function lfe(c,u,m,S=!1){m=Object.assign({},afe,m);let b;const v=[],M=[];return c?(b=c.map(N=>typeof N=="string"?N:(S||M.push(typeof N.title<"u"?N.title:N.key),N.key)),M.length>0&&wM(v,M,m)):(b=[],u.forEach(N=>{Array.isArray(N)||(b=b.concat(Object.keys(N)))}),b.length>0&&(b=b.filter((N,X,U)=>U.indexOf(N)===X),S||wM(v,b,m))),Array.isArray(u)&&u.forEach(N=>{Array.isArray(N)||(N=b.map(X=>typeof N[X]<"u"?N[X]:"")),wM(v,N,m)}),v.join(ofe)}function OM(c){const u=navigator.userAgent;return u.indexOf("compatible")>-1&&u.indexOf("MSIE")>-1?(new RegExp("MSIE (\\d+\\.\\d+);").test(u),parseFloat(RegExp.$1)):!1}const cfe={_isIE11(){let c=0;const u=/MSIE (\d+\.\d+);/.test(navigator.userAgent),m=!!navigator.userAgent.match(/Trident\/7.0/),S=navigator.userAgent.indexOf("rv:11.0");return u&&(c=Number(RegExp.$1)),navigator.appVersion.indexOf("MSIE 10")!==-1&&(c=10),m&&S!==-1&&(c=11),c===11},_isEdge(){return/Edge/.test(navigator.userAgent)},_getDownloadUrl(c){const u="\uFEFF";if(r&&window.Blob&&window.URL&&window.URL.createObjectURL){const m=new Blob([u+c],{type:"text/csv"});return URL.createObjectURL(m)}else return"data:attachment/csv;charset=utf-8,"+u+encodeURIComponent(c)},download(c,u){if(r)if(OM()&&OM()<10){const m=window.top.open("about:blank","_blank");m.document.charset="utf-8",m.document.write(u),m.document.close(),m.document.execCommand("SaveAs",c),m.close()}else if(OM()===10||this._isIE11()||this._isEdge()){const m="\uFEFF",S=new Blob([m+u],{type:"text/csv"});navigator.msSaveBlob(S,c)}else{const m=document.createElement("a");m.download=c,m.href=this._getDownloadUrl(u),document.body.appendChild(m),m.click(),document.body.removeChild(m)}}},Dw=(c,u)=>{let m=[],S=[];return c.forEach(b=>{b.fixed&&b.fixed===u?m.push(b):S.push(b)}),m.concat(S)},wv=(c,u=!1)=>{const m=L(c),S=[];return m.forEach(b=>{b.children?(u&&S.push(b),S.push.apply(S,wv(b.children,u))):S.push(b)}),S},hfe=(c,u=!1)=>{const m=L(u?u==="left"?Dw(c,"left"):Dw(c,"right"):c);let S=1;const b=(M,N)=>{if(N&&(M.level=N.level+1,S<M.level&&(S=M.level)),M.children){let X=0;M.children.forEach(U=>{b(U,M),X+=U.colSpan}),M.colSpan=X}else M.colSpan=1};m.forEach(M=>{M.level=1,b(M)});const v=[];for(let M=0;M<S;M++)v.push([]);return wv(m,!0).forEach(M=>{M.children?M.rowSpan=1:M.rowSpan=S-M.level+1,v[M.level-1].push(M)}),v},ufe=function(c=32){const u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",m=u.length;let S="";for(let b=0;b<c;b++)S+=u.charAt(Math.floor(Math.random()*m));return S},pr="ivu-table";let TU=1,dfe=1;const ffe={name:"Table",mixins:[Sn],components:{tableHead:zde,tableBody:Jde,tableSummary:rfe,Spin:da,Dropdown:If,DropdownMenu:Bf},emits:["on-current-change","on-row-click","on-row-dblclick","on-contextmenu","on-select","on-select-cancel","on-selection-change","on-expand","on-expand-tree","on-select-all","on-select-all-cancel","on-sort-change","on-filter-change","on-drag-drop","on-cell-click","on-column-width-resize"],provide(){return{TableInstance:this}},inject:{TabsInstance:{default:null},ModalInstance:{default:null},DrawerInstance:{default:null}},props:{data:{type:Array,default(){return[]}},columns:{type:Array,default(){return[]}},size:{validator(c){return T(c,["small","large","default"])},default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.size===""?"default":c.$VIEWUI.size}},width:{type:[Number,String]},height:{type:[Number,String]},maxHeight:{type:[Number,String]},stripe:{type:Boolean,default:!1},border:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},highlightRow:{type:Boolean,default:!1},rowClassName:{type:Function,default(){return""}},context:{type:Object},noDataText:{type:String},noFilteredDataText:{type:String},disabledHover:{type:Boolean},loading:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},tooltipTheme:{validator(c){return T(c,["dark","light"])},default:"dark"},tooltipMaxWidth:{type:Number,default:300},rowKey:{type:[Boolean,String],default:!1},spanMethod:{type:Function},showSummary:{type:Boolean,default:!1},summaryMethod:{type:Function},sumText:{type:String},indentSize:{type:Number,default:16},loadData:{type:Function},updateShowChildren:{type:Boolean,default:!1},contextMenu:{type:Boolean,default:!1},showContextMenu:{type:Boolean,default:!1},fixedShadow:{validator(c){return T(c,["auto","show","hide"])},default:"show"},autoCloseContextmenu:{type:Boolean,default:!0}},data(){const c=this.makeColumnsId(this.columns);return{ready:!1,tableWidth:0,columnsWidth:{},prefixCls:pr,compiledUids:[],objData:this.makeObjData(),rebuildData:[],cloneColumns:this.makeColumns(c),columnRows:this.makeColumnRows(!1,c),leftFixedColumnRows:this.makeColumnRows("left",c),rightFixedColumnRows:this.makeColumnRows("right",c),allColumns:wv(c),showSlotHeader:!0,showSlotFooter:!0,bodyHeight:0,scrollBarWidth:A(),currentContext:this.context,cloneData:L(this.data),showVerticalScrollBar:!1,showHorizontalScrollBar:!1,headerWidth:0,headerHeight:0,showResizeLine:!1,contextMenuVisible:!1,contextMenuStyles:{top:0,left:0},scrollOnTheLeft:!1,scrollOnTheRight:!1,id:te(6)}},computed:{localeNoDataText(){return this.noDataText===void 0?this.t("i.table.noDataText"):this.noDataText},localeNoFilteredDataText(){return this.noFilteredDataText===void 0?this.t("i.table.noFilteredDataText"):this.noFilteredDataText},localeSumText(){return this.sumText===void 0?this.t("i.table.sumText"):this.sumText},wrapClasses(){return[`${pr}-wrapper`,{[`${pr}-hide`]:!this.ready,[`${pr}-with-header`]:this.showSlotHeader,[`${pr}-with-footer`]:this.showSlotFooter,[`${pr}-with-summary`]:this.showSummary,[`${pr}-wrapper-with-border`]:this.border}]},classes(){return[`${pr}`,{[`${pr}-${this.size}`]:!!this.size,[`${pr}-border`]:this.border,[`${pr}-stripe`]:this.stripe,[`${pr}-with-fixed-top`]:!!this.height}]},fixedTableClasses(){return[`${pr}-fixed`,{[`${pr}-fixed-shadow`]:this.fixedShadow==="show"||this.fixedShadow==="auto"&&!this.scrollOnTheLeft}]},fixedRightTableClasses(){return[`${pr}-fixed-right`,{[`${pr}-fixed-shadow`]:this.fixedShadow==="show"||this.fixedShadow==="auto"&&!this.scrollOnTheRight}]},fixedHeaderClasses(){return[`${pr}-fixed-header`,{[`${pr}-fixed-header-with-empty`]:!this.rebuildData.length}]},styles(){let c={},u=0;if(this.showSummary&&(this.size==="small"?u=40:this.size==="large"?u=60:u=48),this.height){let m=parseInt(this.height)+u;c.height=`${m}px`}if(this.maxHeight){const m=parseInt(this.maxHeight)+u;c.maxHeight=`${m}px`}return this.width&&(c.width=`${this.width}px`),c},tableStyle(){let c={};if(this.tableWidth!==0){let u="";this.bodyHeight===0?u=this.tableWidth:u=this.tableWidth-(this.showVerticalScrollBar?this.scrollBarWidth:0),c.width=`${u}px`}return c},tableHeaderStyle(){let c={};if(this.tableWidth!==0){let u="";u=this.tableWidth,c.width=`${u}px`}return c},fixedTableStyle(){let c={},u=0;return this.leftFixedColumns.forEach(m=>{m.fixed&&m.fixed==="left"&&(u+=m._width)}),c.width=`${u}px`,c},fixedRightTableStyle(){let c={},u=0;return this.rightFixedColumns.forEach(m=>{m.fixed&&m.fixed==="right"&&(u+=m._width)}),c.width=`${u}px`,c.right=`${this.showVerticalScrollBar?this.scrollBarWidth:0}px`,c},fixedRightHeaderStyle(){let c={},u=0,m=this.headerHeight+1;return this.showVerticalScrollBar&&(u=this.scrollBarWidth),c.width=`${u}px`,c.height=`${m}px`,c},bodyStyle(){let c={};if(this.bodyHeight!==0){const u=this.bodyHeight;this.height?c.height=`${u}px`:this.maxHeight&&(c.maxHeight=`${u}px`)}return c},fixedBodyStyle(){let c={};if(this.bodyHeight!==0){let u=this.bodyHeight-(this.showHorizontalScrollBar?this.scrollBarWidth:0);const m=this.showHorizontalScrollBar?`${u}px`:`${u-1}px`;this.height?c.height=m:this.maxHeight&&(c.maxHeight=m)}return c},leftFixedColumns(){return Dw(this.cloneColumns,"left")},rightFixedColumns(){return Dw(this.cloneColumns,"right")},isLeftFixed(){return this.columns.some(c=>c.fixed&&c.fixed==="left")},isRightFixed(){return this.columns.some(c=>c.fixed&&c.fixed==="right")},summaryData(){if(!this.showSummary)return{};let c={};return this.summaryMethod?c=this.summaryMethod({columns:this.cloneColumns,data:this.rebuildData}):this.cloneColumns.forEach((u,m)=>{const S=u.key;if(m===0){c[S]={key:u.key,value:this.localeSumText};return}const b=this.rebuildData.map(X=>Number(X[u.key])),v=[];let M=!0;b.forEach(X=>{if(!isNaN(X)){M=!1;let U=(""+X).split(".")[1];v.push(U?U.length:0)}});const N=Math.max.apply(null,v);if(M)c[S]={key:u.key,value:""};else{const X=b.reduce((U,H)=>{const re=Number(H);return isNaN(re)?U:parseFloat((U+H).toFixed(Math.min(N,20)))},0);c[S]={key:u.key,value:X}}}),c}},methods:{rowClsName(c){return this.rowClassName(this.data[c],c)},handleResize(){let c=this.$el.offsetWidth-1,u={},m=0,S=[],b=[],v=[];this.cloneColumns.forEach(H=>{H.width?S.push(H):(b.push(H),H.minWidth&&(m+=H.minWidth),H.maxWidth||v.push(H)),H._width=null});let M=S.map(H=>H.width).reduce((H,re)=>H+re,0),N=c-M-m-(this.showVerticalScrollBar?this.scrollBarWidth:0)-1,X=b.length,U=0;N>0&&X>0&&(U=parseInt(N/X));for(let H=0;H<this.cloneColumns.length;H++){const re=this.cloneColumns[H];let xe=U+(re.minWidth?re.minWidth:0);re.width?xe=re.width:re._width?xe=re._width:(re.minWidth>xe?xe=re.minWidth:re.maxWidth<xe&&(xe=re.maxWidth),N>0?(N-=xe-(re.minWidth?re.minWidth:0),X--,X>0?U=parseInt(N/X):U=0):U=0),re._width=xe,u[re._index]={width:xe}}if(N>0){X=v.length,U=parseInt(N/X);for(let H=0;H<v.length;H++){const re=v[H];let xe=re._width+U;X>1?(X--,N-=U,U=parseInt(N/X)):U=0,re._width=xe,u[re._index]={width:xe}}}this.tableWidth=this.cloneColumns.map(H=>H._width).reduce((H,re)=>H+re,0)+(this.showVerticalScrollBar?this.scrollBarWidth:0)+1,this.columnsWidth=u,this.fixedHeader(),this.fixedShadow==="auto"&&n.nextTick(()=>{const H=this.$refs.body;this.scrollOnTheLeft=H.scrollLeft===0,this.scrollOnTheRight=H.scrollWidth===H.scrollLeft+H.clientWidth})},handleMouseIn(c,u){if(this.disabledHover)return;const m=u?this.getDataByRowKey(u):this.objData[c];m._isHover||(m._isHover=!0)},handleMouseOut(c,u){if(this.disabledHover)return;const m=u?this.getDataByRowKey(u):this.objData[c];m._isHover=!1},handleCurrentRow(c,u,m){const S=m?this.getDataByRowKey(m):this.objData[u];let b=null,v=-1;for(let N in this.objData)if(this.objData[N]._isHighlight){v=parseInt(N),this.objData[N]._isHighlight=!1;break}else if(this.objData[N].children&&this.objData[N].children.length){const X=this.handleResetChildrenRow(this.objData[N]);X&&(b=JSON.parse(JSON.stringify(X)))}c==="highlight"&&(S._isHighlight=!0),v>=0&&(b=JSON.parse(JSON.stringify(this.cloneData[v])));const M=c==="highlight"?JSON.parse(JSON.stringify(m?this.getBaseDataByRowKey(m):this.cloneData[u])):null;this.$emit("on-current-change",M,b)},handleResetChildrenRow(c){let u=null;if(c.children&&c.children.length)for(let m=0;m<c.children.length;m++){const S=c.children[m];if(S._isHighlight){S._isHighlight=!1,u=S;break}else S.children&&S.children.length&&(u=this.handleResetChildrenRow(S))}return u},highlightCurrentRow(c,u){const m=u?this.getDataByRowKey(u):this.objData[c];!this.highlightRow||m._isHighlight||this.handleCurrentRow("highlight",c,u)},clearCurrentRow(){!this.highlightRow||this.handleCurrentRow("clear")},clickCurrentRow(c,u){this.highlightCurrentRow(c,u),u?this.$emit("on-row-click",JSON.parse(JSON.stringify(this.getBaseDataByRowKey(u)))):this.$emit("on-row-click",JSON.parse(JSON.stringify(this.cloneData[c])),c)},dblclickCurrentRow(c,u){this.highlightCurrentRow(c,u),u?this.$emit("on-row-dblclick",JSON.parse(JSON.stringify(this.getBaseDataByRowKey(u)))):this.$emit("on-row-dblclick",JSON.parse(JSON.stringify(this.cloneData[c])),c)},contextmenuCurrentRow(c,u,m){this.contextMenuVisible&&this.handleClickContextMenuOutside(),n.nextTick(()=>{const S=this.$refs.tableWrap.getBoundingClientRect(),b={left:`${m.clientX-S.left}px`,top:`${m.clientY-S.top}px`};this.contextMenuStyles=b,this.contextMenuVisible=!0,u?this.$emit("on-contextmenu",JSON.parse(JSON.stringify(this.getBaseDataByRowKey(u))),m,b):this.$emit("on-contextmenu",JSON.parse(JSON.stringify(this.cloneData[c])),m,b)})},getSelection(){let c=[],u=[];for(let S in this.objData){const b=this.objData[S];b._isChecked&&c.push(parseInt(S)),b.children&&b.children.length&&(u=u.concat(this.getSelectionChildrenRowKeys(b,u)))}u=[...new Set(u)];let m=[];return this.data.forEach((S,b)=>{c.indexOf(b)>-1&&(m=m.concat(S)),S.children&&S.children.length&&u.length&&(m=m.concat(this.getSelectionChildren(S,m,u)))}),m=[...new Set(m)],JSON.parse(JSON.stringify(m))},getSelectionChildrenRowKeys(c,u){return c.children&&c.children.length&&c.children.forEach(m=>{m._isChecked&&u.push(m._rowKey),m.children&&m.children.length&&(u=u.concat(this.getSelectionChildrenRowKeys(m,u)))}),u},getSelectionChildren(c,u,m){return c.children&&c.children.length&&c.children.forEach(S=>{m.indexOf(S[this.rowKey])>-1&&(u=u.concat(S)),S.children&&S.children.length&&(u=u.concat(this.getSelectionChildren(S,u,m)))}),u},toggleSelect(c,u){let m={};if(u)m=this.getDataByRowKey(u);else for(let M in this.objData)if(parseInt(M)===c){m=this.objData[M];break}const S=!m._isChecked;m._isChecked=S;const b=this.getSelection(),v=u?this.getBaseDataByRowKey(u,this.data):this.data[c];this.$emit(S?"on-select":"on-select-cancel",b,JSON.parse(JSON.stringify(v))),this.$emit("on-selection-change",b)},toggleExpand(c){let u={};for(let S in this.objData)if(parseInt(S)===c){u=this.objData[S];break}const m=!u._isExpanded;this.objData[c]._isExpanded=m,this.$emit("on-expand",JSON.parse(JSON.stringify(this.cloneData[c])),m),(this.height||this.maxHeight)&&n.nextTick(()=>this.fixedBody())},toggleTree(c){const u=this.getDataByRowKey(c);if(!("_loading"in u&&u._loading)){if("_loading"in u&&!u._loading&&u.children.length===0){const m=this.getBaseDataByRowKey(c,this.data);m._loading=!0,this.loadData(m,S=>{m._loading=!1,S.length&&(m.children=S,n.nextTick(()=>{const b=this.getDataByRowKey(c);b._isShowChildren=!b._isShowChildren,this.updateDataStatus(c,"_showChildren",b._isShowChildren)}))});return}u._isShowChildren=!u._isShowChildren,this.updateShowChildren&&this.updateDataStatus(c,"_showChildren",u._isShowChildren),this.$emit("on-expand-tree",c,u._isShowChildren)}},updateDataStatus(c,u,m){const S=this.getBaseDataByRowKey(c,this.data);S[u]=m},getDataByRowKey(c,u=this.objData){let m=null;for(let S in u){const b=u[S];if(b._rowKey===c){m=b;break}else if(b.children&&b.children.length&&(m=this.getChildrenByRowKey(c,b),m))break}return m},getChildrenByRowKey(c,u){let m=null;if(u.children&&u.children.length)for(let S=0;S<u.children.length;S++){const b=u.children[S];if(b._rowKey===c){m=b;break}else if(b.children&&b.children.length&&(m=this.getChildrenByRowKey(c,b),m))break}return m},getBaseDataByRowKey(c,u=this.cloneData){let m=null;for(let S=0;S<u.length;S++){const b=u[S];if(b[this.rowKey]===c){m=b;break}else if(b.children&&b.children.length&&(m=this.getChildrenDataByRowKey(c,b),m&&m[this.rowKey]===c))return m}return m},getChildrenDataByRowKey(c,u){let m=null;if(u.children&&u.children.length)for(let S=0;S<u.children.length;S++){const b=u.children[S];if(b[this.rowKey]===c){m=b;break}else if(b.children&&b.children.length&&(m=this.getChildrenDataByRowKey(c,b),m))break}return m},selectAll(c){for(const m of this.rebuildData){const S=this.objData[m._index];S._isDisabled||(S._isChecked=c),m.children&&m.children.length&&this.selectAllChildren(S,c)}const u=this.getSelection();c?this.$emit("on-select-all",u):this.$emit("on-select-all-cancel",u),this.$emit("on-selection-change",u)},selectAllChildren(c,u){c.children&&c.children.length&&c.children.map(m=>{m._isDisabled||(m._isChecked=u),m.children&&m.children.length&&this.selectAllChildren(m,u)})},fixedHeader(){this.height||this.maxHeight?n.nextTick(()=>{const c=parseInt(k(this.$refs.title,"height"))||0,u=parseInt(k(this.$refs.header,"height"))||0,m=parseInt(k(this.$refs.footer,"height"))||0;this.height?this.bodyHeight=this.height-c-u-m:this.maxHeight&&(this.bodyHeight=this.maxHeight-c-u-m),n.nextTick(()=>this.fixedBody())}):(this.bodyHeight=0,n.nextTick(()=>this.fixedBody()))},fixedBody(){if(this.$refs.header&&(this.headerWidth=this.$refs.header.children[0].offsetWidth,this.headerHeight=this.$refs.header.children[0].offsetHeight),!this.$refs.tbody||!this.data||this.data.length===0)this.showVerticalScrollBar=!1;else{let c=this.$refs.tbody.$el,u=c.parentElement,m=c.offsetHeight,S=u.offsetHeight;this.showHorizontalScrollBar=u.offsetWidth<c.offsetWidth+(this.showVerticalScrollBar?this.scrollBarWidth:0),this.showVerticalScrollBar=this.bodyHeight?S-(this.showHorizontalScrollBar?this.scrollBarWidth:0)<m:!1,this.showVerticalScrollBar?u.classList.add(this.prefixCls+"-overflowY"):u.classList.remove(this.prefixCls+"-overflowY"),this.showHorizontalScrollBar?u.classList.add(this.prefixCls+"-overflowX"):u.classList.remove(this.prefixCls+"-overflowX")}},hideColumnFilter(){this.cloneColumns.forEach(c=>c._filterVisible=!1)},handleBodyScroll(c){this.scrollOnTheLeft=c.target.scrollLeft===0,this.scrollOnTheRight=c.target.scrollWidth===c.target.scrollLeft+c.target.clientWidth,this.showHeader&&(this.$refs.header.scrollLeft=c.target.scrollLeft),this.isLeftFixed&&(this.$refs.fixedBody.scrollTop=c.target.scrollTop),this.isRightFixed&&(this.$refs.fixedRightBody.scrollTop=c.target.scrollTop),this.showSummary&&this.$refs.summary&&(this.$refs.summary.$el.scrollLeft=c.target.scrollLeft),this.hideColumnFilter()},handleFixedMousewheel(c){let u=c.deltaY;if(!u&&c.detail&&(u=c.detail*40),!u&&c.wheelDeltaY&&(u=-c.wheelDeltaY),!u&&c.wheelDelta&&(u=-c.wheelDelta),!u)return;const m=this.$refs.body,S=m.scrollTop;u<0&&S!==0&&c.preventDefault(),u>0&&m.scrollHeight-m.clientHeight>S&&c.preventDefault();let b=0,v=setInterval(()=>{b+=5,u>0?m.scrollTop+=2:m.scrollTop-=2,b>=Math.abs(u)&&clearInterval(v)},5)},handleMouseWheel(c){const u=c.deltaX,m=this.$refs.body;u>0?m.scrollLeft=m.scrollLeft+10:m.scrollLeft=m.scrollLeft-10},sortData(c,u,m){const S=this.cloneColumns[m].key;c.sort((b,v)=>{if(this.cloneColumns[m].sortMethod)return this.cloneColumns[m].sortMethod(b[S],v[S],u);if(u==="asc")return b[S]>v[S]?1:-1;if(u==="desc")return b[S]<v[S]?1:-1});for(let b=0;b<c.length;b++)c[b].children&&c[b].children.length&&(c[b].children=this.sortData(c[b].children,u,m));return c},handleSort(c,u){const m=this.GetOriginalIndex(c);this.cloneColumns.forEach(b=>b._sortType="normal");const S=this.cloneColumns[m].key;this.cloneColumns[m].sortable!=="custom"&&(u==="normal"?this.rebuildData=this.makeDataWithFilter():this.rebuildData=this.sortData(this.rebuildData,u,m)),this.cloneColumns[m]._sortType=u,this.$emit("on-sort-change",{column:JSON.parse(JSON.stringify(this.allColumns[this.cloneColumns[m]._index])),key:S,order:u})},handleFilterHide(c){this.cloneColumns[c]._isFiltered||(this.cloneColumns[c]._filterChecked=[])},filterData(c,u){return c.filter(m=>{if(typeof u.filterRemote=="function")return!0;let S=!u._filterChecked.length;for(let b=0;b<u._filterChecked.length&&(S=u.filterMethod(u._filterChecked[b],m),!S);b++);return S})},filterOtherData(c,u){let m=this.cloneColumns[u];return typeof m.filterRemote=="function"&&m.filterRemote.call(this.$parent,m._filterChecked,m.key,m),this.cloneColumns.forEach((S,b)=>{b!==u&&(c=this.filterData(c,S))}),c},handleFilter(c){const u=this.cloneColumns[c];let m=this.makeDataWithSort();m=this.filterOtherData(m,c),this.rebuildData=this.filterData(m,u),this.cloneColumns[c]._isFiltered=!0,this.cloneColumns[c]._filterVisible=!1,this.$emit("on-filter-change",u)},GetOriginalIndex(c){return this.cloneColumns.findIndex(u=>u._index===c)},handleFilterSelect(c,u){const m=this.GetOriginalIndex(c);this.cloneColumns[m]._filterChecked=[u],this.handleFilter(m)},handleFilterReset(c){const u=this.GetOriginalIndex(c);this.cloneColumns[u]._isFiltered=!1,this.cloneColumns[u]._filterVisible=!1,this.cloneColumns[u]._filterChecked=[];let m=this.makeDataWithSort();m=this.filterOtherData(m,u),this.rebuildData=m,this.$emit("on-filter-change",this.cloneColumns[u])},makeData(){let c=L(this.data);return c.forEach((u,m)=>{u._index=m,u._rowKey=typeof this.rowKey=="string"?u[this.rowKey]:TU++,u.children&&u.children.length&&(u.children=this.makeChildrenData(u))}),c},makeChildrenData(c){return c.children&&c.children.length?c.children.map((u,m)=>{const S=L(u);return S._index=m,S._rowKey=typeof this.rowKey=="string"?S[this.rowKey]:TU++,S.children&&S.children.length&&(S.children=this.makeChildrenData(S)),S}):c},makeDataWithSort(){let c=this.makeData(),u="normal",m=-1,S=!1;for(let b=0;b<this.cloneColumns.length;b++)if(this.cloneColumns[b]._sortType!=="normal"){u=this.cloneColumns[b]._sortType,m=b,S=this.cloneColumns[b].sortable==="custom";break}return u!=="normal"&&!S&&(c=this.sortData(c,u,m)),c},makeDataWithFilter(){let c=this.makeData();return this.cloneColumns.forEach(u=>c=this.filterData(c,u)),c},makeDataWithSortAndFilter(){let c=this.makeDataWithSort();return this.cloneColumns.forEach(u=>c=this.filterData(c,u)),c},makeObjBaseData(c){const u=L(c);return typeof this.rowKey=="string"&&(u._rowKey=u[this.rowKey]),u._isHover=!1,u._disabled?u._isDisabled=u._disabled:u._isDisabled=!1,u._checked?u._isChecked=u._checked:u._isChecked=!1,u._expanded?u._isExpanded=u._expanded:u._isExpanded=!1,u._highlight?u._isHighlight=u._highlight:u._isHighlight=!1,u},makeObjData(){let c={};return this.data.forEach((u,m)=>{const S=this.makeObjBaseData(u);S.children&&S.children.length&&(S._showChildren?S._isShowChildren=S._showChildren:S._isShowChildren=!1,S.children=this.makeChildrenObjData(S)),c[m]=S}),c},makeChildrenObjData(c){return c.children&&c.children.length?c.children.map(u=>{const m=this.makeObjBaseData(u);return m._showChildren?m._isShowChildren=m._showChildren:m._isShowChildren=!1,m.children&&m.children.length&&(m.children=this.makeChildrenObjData(m)),m}):c},makeColumnsId(c){return L(c).map(u=>("children"in u&&this.makeColumnsId(u.children),u.__id=ufe(6),u))},makeColumns(c){let u=L(wv(c)),m=[],S=[],b=[];return u.forEach((v,M)=>{v._index=M,v._columnKey=dfe++,v.width=parseInt(v.width),v._width=v.width?v.width:"",v._sortType="normal",v._filterVisible=!1,v._isFiltered=!1,v._filterChecked=[],"filterMultiple"in v?v._filterMultiple=v.filterMultiple:v._filterMultiple=!0,"filteredValue"in v&&(v._filterChecked=v.filteredValue,v._isFiltered=!0),"sortType"in v&&(v._sortType=v.sortType),v.fixed&&v.fixed==="left"?m.push(v):v.fixed&&v.fixed==="right"?S.push(v):b.push(v)}),m.concat(b).concat(S)},makeColumnRows(c,u){return hfe(u,c)},exportCsv(c){c.filename?c.filename.indexOf(".csv")===-1&&(c.filename+=".csv"):c.filename="table.csv";let u=[],m=[];c.columns&&c.data?(u=c.columns,m=c.data):(u=this.allColumns,"original"in c||(c.original=!0),m=c.original?this.data:this.rebuildData);let S=!1;"noHeader"in c&&(S=c.noHeader);const b=lfe(u,m,c,S);c.callback?c.callback(b):cfe.download(c.filename,b)},dragAndDrop(c,u){this.$emit("on-drag-drop",c,u)},handleClickContextMenuOutside(){this.contextMenuVisible=!1},handleOnVisibleChange(c){c&&n.nextTick(()=>{this.handleResize()})},addTable(c){const u=this[c];!u||(u.tableList||(u.tableList=[]),u.tableList.push({id:this.id,table:this}))},removeTable(c){const u=this[c];if(!u||!u.tableList)return;const m=u.tableList.findIndex(S=>S.id===this.id);u.tableList.splice(m,1)},closeContextMenu(){this.handleClickContextMenuOutside()},handleClickDropdownItem(){this.autoCloseContextmenu&&this.closeContextMenu()}},created(){this.context||(this.currentContext=this.$parent),this.showSlotHeader=this.$slots.header!==void 0,this.showSlotFooter=this.$slots.footer!==void 0,this.rebuildData=this.makeDataWithSortAndFilter()},mounted(){this.addTable("TabsInstance"),this.addTable("ModalInstance"),this.addTable("DrawerInstance"),this.handleResize(),n.nextTick(()=>this.ready=!0),o(window,"resize",this.handleResize),this.observer=qm(),this.observer.listenTo(this.$el,this.handleResize)},beforeUnmount(){this.removeTable("TabsInstance"),this.removeTable("ModalInstance"),this.removeTable("DrawerInstance"),a(window,"resize",this.handleResize),this.observer.removeAllListeners(this.$el),this.observer.uninstall(this.$el),this.observer=null},watch:{data:{handler(){const c=this.rebuildData.length;this.objData=this.makeObjData(),this.rebuildData=this.makeDataWithSortAndFilter(),this.handleResize(),c||this.fixedHeader(),setTimeout(()=>{this.cloneData=L(this.data)},0)},deep:!0},columns:{handler(){const c=this.makeColumnsId(this.columns);this.allColumns=wv(c),this.cloneColumns=this.makeColumns(c),this.columnRows=this.makeColumnRows(!1,c),this.leftFixedColumnRows=this.makeColumnRows("left",c),this.rightFixedColumnRows=this.makeColumnRows("right",c),this.rebuildData=this.makeDataWithSortAndFilter(),this.handleResize()},deep:!0},height(){this.handleResize()},maxHeight(){this.handleResize()},showHorizontalScrollBar(){this.handleResize()},showVerticalScrollBar(){this.handleResize()}}},pfe={cellspacing:"0",cellpadding:"0",border:"0"},mfe=["innerHTML"],gfe=["innerHTML"],yfe={class:"ivu-table-resize-line",ref:"resizeLine"};function vfe(c,u,m,S,b,v){const M=n.resolveComponent("table-head"),N=n.resolveComponent("table-body"),X=n.resolveComponent("table-summary"),U=n.resolveComponent("DropdownMenu"),H=n.resolveComponent("Dropdown"),re=n.resolveComponent("Spin");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.wrapClasses),style:n.normalizeStyle(v.styles),ref:"tableWrap"},[n.createElementVNode("div",{class:n.normalizeClass(v.classes)},[b.showSlotHeader?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-title"]),ref:"title"},[n.renderSlot(c.$slots,"header")],2)):n.createCommentVNode("",!0),m.showHeader?(n.openBlock(),n.createElementBlock("div",{key:1,class:n.normalizeClass([b.prefixCls+"-header"]),ref:"header",onMousewheel:u[0]||(u[0]=(...xe)=>v.handleMouseWheel&&v.handleMouseWheel(...xe))},[n.createVNode(M,{"prefix-cls":b.prefixCls,styleObject:v.tableHeaderStyle,columns:b.cloneColumns,"column-rows":b.columnRows,"obj-data":b.objData,"columns-width":b.columnsWidth,data:b.rebuildData},null,8,["prefix-cls","styleObject","columns","column-rows","obj-data","columns-width","data"])],34)):n.createCommentVNode("",!0),n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-body"]),style:n.normalizeStyle(v.bodyStyle),ref:"body",onScroll:u[1]||(u[1]=(...xe)=>v.handleBodyScroll&&v.handleBodyScroll(...xe))},[n.createVNode(N,{ref:"tbody",draggable:m.draggable,"prefix-cls":b.prefixCls,styleObject:v.tableStyle,columns:b.cloneColumns,data:b.rebuildData,"row-key":m.rowKey,"columns-width":b.columnsWidth,"obj-data":b.objData},null,8,["draggable","prefix-cls","styleObject","columns","data","row-key","columns-width","obj-data"])],38),[[n.vShow,!(v.localeNoDataText&&(!m.data||m.data.length===0)||v.localeNoFilteredDataText&&(!b.rebuildData||b.rebuildData.length===0))]]),m.showSummary&&m.data&&m.data.length?(n.openBlock(),n.createBlock(X,{key:2,ref:"summary","prefix-cls":b.prefixCls,styleObject:v.tableStyle,columns:b.cloneColumns,data:v.summaryData,"columns-width":b.columnsWidth},null,8,["prefix-cls","styleObject","columns","data","columns-width"])):n.createCommentVNode("",!0),n.withDirectives(n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-tip"]),style:n.normalizeStyle(v.bodyStyle),onScroll:u[2]||(u[2]=(...xe)=>v.handleBodyScroll&&v.handleBodyScroll(...xe))},[n.createElementVNode("table",pfe,[n.createElementVNode("tbody",null,[n.createElementVNode("tr",null,[n.createElementVNode("td",{style:n.normalizeStyle({height:v.bodyStyle.height,width:`${b.headerWidth}px`})},[!m.data||m.data.length===0?(n.openBlock(),n.createElementBlock("span",{key:0,innerHTML:v.localeNoDataText},null,8,mfe)):(n.openBlock(),n.createElementBlock("span",{key:1,innerHTML:v.localeNoFilteredDataText},null,8,gfe))],4)])])])],38),[[n.vShow,!!v.localeNoDataText&&(!m.data||m.data.length===0)||!!v.localeNoFilteredDataText&&(!b.rebuildData||b.rebuildData.length===0)]]),v.isLeftFixed?(n.openBlock(),n.createElementBlock("div",{key:3,class:n.normalizeClass(v.fixedTableClasses),style:n.normalizeStyle(v.fixedTableStyle)},[m.showHeader?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.fixedHeaderClasses)},[n.createVNode(M,{fixed:"left","prefix-cls":b.prefixCls,styleObject:v.fixedTableStyle,columns:v.leftFixedColumns,"column-rows":b.columnRows,"fixed-column-rows":b.leftFixedColumnRows,"obj-data":b.objData,"columns-width":b.columnsWidth,data:b.rebuildData},null,8,["prefix-cls","styleObject","columns","column-rows","fixed-column-rows","obj-data","columns-width","data"])],2)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-fixed-body"]),style:n.normalizeStyle(v.fixedBodyStyle),ref:"fixedBody",onMousewheel:u[3]||(u[3]=(...xe)=>v.handleFixedMousewheel&&v.handleFixedMousewheel(...xe)),"on:DOMMouseScroll":u[4]||(u[4]=(...xe)=>v.handleFixedMousewheel&&v.handleFixedMousewheel(...xe))},[n.createVNode(N,{fixed:"left",draggable:m.draggable,"prefix-cls":b.prefixCls,styleObject:v.fixedTableStyle,columns:v.leftFixedColumns,data:b.rebuildData,"row-key":m.rowKey,"columns-width":b.columnsWidth,"obj-data":b.objData},null,8,["draggable","prefix-cls","styleObject","columns","data","row-key","columns-width","obj-data"])],38),m.showSummary&&m.data&&m.data.length?(n.openBlock(),n.createBlock(X,{key:1,fixed:"left","prefix-cls":b.prefixCls,styleObject:v.fixedTableStyle,columns:v.leftFixedColumns,data:v.summaryData,"columns-width":b.columnsWidth,style:n.normalizeStyle({"margin-top":b.showHorizontalScrollBar?b.scrollBarWidth+"px":0})},null,8,["prefix-cls","styleObject","columns","data","columns-width","style"])):n.createCommentVNode("",!0)],6)):n.createCommentVNode("",!0),v.isRightFixed?(n.openBlock(),n.createElementBlock("div",{key:4,class:n.normalizeClass(v.fixedRightTableClasses),style:n.normalizeStyle(v.fixedRightTableStyle)},[m.showHeader?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(v.fixedHeaderClasses)},[n.createVNode(M,{fixed:"right","prefix-cls":b.prefixCls,styleObject:v.fixedRightTableStyle,columns:v.rightFixedColumns,"column-rows":b.columnRows,"fixed-column-rows":b.rightFixedColumnRows,"obj-data":b.objData,"columns-width":b.columnsWidth,data:b.rebuildData},null,8,["prefix-cls","styleObject","columns","column-rows","fixed-column-rows","obj-data","columns-width","data"])],2)):n.createCommentVNode("",!0),n.createElementVNode("div",{class:n.normalizeClass([b.prefixCls+"-fixed-body"]),style:n.normalizeStyle(v.fixedBodyStyle),ref:"fixedRightBody",onMousewheel:u[5]||(u[5]=(...xe)=>v.handleFixedMousewheel&&v.handleFixedMousewheel(...xe)),"on:DOMMouseScroll":u[6]||(u[6]=(...xe)=>v.handleFixedMousewheel&&v.handleFixedMousewheel(...xe))},[n.createVNode(N,{fixed:"right",draggable:m.draggable,"prefix-cls":b.prefixCls,styleObject:v.fixedRightTableStyle,columns:v.rightFixedColumns,data:b.rebuildData,"row-key":m.rowKey,"columns-width":b.columnsWidth,"obj-data":b.objData},null,8,["draggable","prefix-cls","styleObject","columns","data","row-key","columns-width","obj-data"])],38),m.showSummary&&m.data&&m.data.length?(n.openBlock(),n.createBlock(X,{key:1,fixed:"right","prefix-cls":b.prefixCls,styleObject:v.fixedRightTableStyle,columns:v.rightFixedColumns,data:v.summaryData,"columns-width":b.columnsWidth,style:n.normalizeStyle({"margin-top":b.showHorizontalScrollBar?b.scrollBarWidth+"px":0})},null,8,["prefix-cls","styleObject","columns","data","columns-width","style"])):n.createCommentVNode("",!0)],6)):n.createCommentVNode("",!0),v.isRightFixed?(n.openBlock(),n.createElementBlock("div",{key:5,class:n.normalizeClass([b.prefixCls+"-fixed-right-header"]),style:n.normalizeStyle(v.fixedRightHeaderStyle)},null,6)):n.createCommentVNode("",!0),b.showSlotFooter?(n.openBlock(),n.createElementBlock("div",{key:6,class:n.normalizeClass([b.prefixCls+"-footer"]),ref:"footer"},[n.renderSlot(c.$slots,"footer")],2)):n.createCommentVNode("",!0)],2),n.withDirectives(n.createElementVNode("div",yfe,null,512),[[n.vShow,b.showResizeLine]]),m.showContextMenu?(n.openBlock(),n.createElementBlock("div",{key:0,class:"ivu-table-context-menu",style:n.normalizeStyle(b.contextMenuStyles)},[n.createVNode(H,{trigger:"custom",visible:b.contextMenuVisible,transfer:"",onOnClick:v.handleClickDropdownItem,onOnClickoutside:v.handleClickContextMenuOutside},{list:n.withCtx(()=>[n.createVNode(U,null,{default:n.withCtx(()=>[n.renderSlot(c.$slots,"contextMenu")]),_:3})]),_:3},8,["visible","onOnClick","onOnClickoutside"])],4)):n.createCommentVNode("",!0),n.createVNode(re,{fix:"",size:"large",show:m.loading},{default:n.withCtx(()=>[n.renderSlot(c.$slots,"loading")]),_:3},8,["show"])],6)}var Lw=l(ffe,[["render",vfe]]);const xfe={name:"TablePaste",components:{Row:Du,Col:pc,Input:Xa,Table:Lw},emits:["on-change","on-error","on-success"],props:{value:{type:String},inputProps:{type:Object,default(){return{}}},tableProps:{type:Object,default(){return{}}},hideTable:{type:Boolean,default:!1}},data(){return{content:"",tableColumns:[],tableData:[]}},watch:{value:{handler(c){this.handleResolveContent(c)},immediate:!0}},methods:{handleContentChange(c){const u=c.target.value.trim();this.$emit("on-change",u),this.handleResolveContent(u)},handleResolveContent(c){let u=[];c!==""&&c!==void 0&&(u=c.split(/[\n\u0085\u2028\u2029]|\r\n?/g).map(b=>b.split("	")));const m=this.handleGetErrorIndex(u),S=this.contentToTable(u);this.tableColumns=S.columns,this.tableData=S.data,m.length?this.$emit("on-error",S,m):this.$emit("on-success",S)},handleGetErrorIndex(c){const u=L(c),m=[];if(u.length){const S=u[0].length;u.forEach((b,v)=>{b.length!==S&&m.push(v)})}return m},contentToTable(c){const u=L(c);let m=[],S=[];return u.length>1&&(m=u.shift().map((b,v)=>({title:b,key:`key${v}`})),S=u.map(b=>{const v={};return b.forEach((M,N)=>{v[`key${N}`]=M}),v})),{columns:m,data:S}}}},_fe={class:"ivu-table-paste"},bfe={key:0,class:"ivu-table-paste-input"},wfe={key:0,class:"ivu-table-paste-input"};function Ofe(c,u,m,S,b,v){const M=n.resolveComponent("Input"),N=n.resolveComponent("Col"),X=n.resolveComponent("Table"),U=n.resolveComponent("Row");return n.openBlock(),n.createElementBlock("div",_fe,[m.hideTable?(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[m.value!==void 0||!c.$slots.default?(n.openBlock(),n.createElementBlock("div",wfe,[n.renderSlot(c.$slots,"default",{},()=>[n.createVNode(M,n.mergeProps({modelValue:b.content,"onUpdate:modelValue":u[1]||(u[1]=H=>b.content=H),type:"textarea"},m.inputProps,{onOnChange:v.handleContentChange}),null,16,["modelValue","onOnChange"])])])):n.createCommentVNode("",!0)],64)):(n.openBlock(),n.createBlock(U,{key:0,gutter:32},{default:n.withCtx(()=>[n.createVNode(N,{span:"12"},{default:n.withCtx(()=>[m.value!==void 0||!c.$slots.default?(n.openBlock(),n.createElementBlock("div",bfe,[n.renderSlot(c.$slots,"default",{},()=>[n.createVNode(M,n.mergeProps({modelValue:b.content,"onUpdate:modelValue":u[0]||(u[0]=H=>b.content=H),type:"textarea"},m.inputProps,{onOnChange:v.handleContentChange}),null,16,["modelValue","onOnChange"])])])):n.createCommentVNode("",!0)]),_:3}),n.createVNode(N,{span:"12"},{default:n.withCtx(()=>[n.createVNode(X,n.mergeProps({columns:b.tableColumns,data:b.tableData},m.tableProps),null,16,["columns","data"])]),_:1})]),_:3}))])}var AU=l(xfe,[["render",Ofe]]);const Sfe={name:"TagSelect",mixins:[Li],components:{Tag:Wm,Icon:O},emits:["on-change","on-checked-all","update:modelValue"],provide(){return{TagSelectInstance:this}},props:{modelValue:{type:Array,default(){return[]}},expandable:{type:Boolean,default:!1},hideCheckAll:{type:Boolean,default:!1},locale:{type:Object,default(){return{collapseText:"",expandText:""}}}},data(){return{currentValue:this.modelValue,checkedAll:!1,expand:!1,tagSelectOptionList:[]}},computed:{classes(){return{"ivu-tag-select-with-expanded":this.expandable,"ivu-tag-select-expanded":this.expand}}},watch:{modelValue(c){this.currentValue=c,this.handleUpdateTags()}},methods:{handleUpdateTags(){let c=!0;this.tagSelectOptionList.map(u=>u.option).forEach(u=>{this.currentValue.indexOf(u.name)>=0?u.checked=!0:(u.checked=!1,c=!1)}),this.checkedAll=c},handleChangeTag(c){const u=[];let m=!0;this.tagSelectOptionList.map(S=>S.option).forEach(S=>{S.checked?u.push(S.name):m=!1}),this.currentValue=u,this.$emit("update:modelValue",u),this.$emit("on-change",[...u],c),this.handleFormItemChange("change",c),c&&(this.checkedAll=m)},handleCheckAll(c){this.checkedAll=c,this.tagSelectOptionList.map(u=>u.option).forEach(u=>{u.checked=c}),this.handleChangeTag(),this.$emit("on-checked-all",c)},handleToggleExpand(){this.expand=!this.expand}},mounted(){this.handleUpdateTags()}},Cfe={key:0,class:"ivu-tag-select-option"},Tfe={key:0},Afe={key:1};function Efe(c,u,m,S,b,v){const M=n.resolveComponent("Tag"),N=n.resolveComponent("Icon");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["ivu-tag-select",v.classes])},[m.hideCheckAll?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",Cfe,[n.createVNode(M,{checkable:"",checked:b.checkedAll,onOnChange:v.handleCheckAll,color:"primary"},{default:n.withCtx(()=>[n.createTextVNode("")]),_:1},8,["checked","onOnChange"])])),n.renderSlot(c.$slots,"default"),m.expandable?(n.openBlock(),n.createElementBlock("a",{key:1,class:"ivu-tag-select-expand-btn",onClick:u[0]||(u[0]=(...X)=>v.handleToggleExpand&&v.handleToggleExpand(...X))},[b.expand?(n.openBlock(),n.createElementBlock("span",Tfe,n.toDisplayString(m.locale.collapseText),1)):(n.openBlock(),n.createElementBlock("span",Afe,n.toDisplayString(m.locale.expandText),1)),b.expand?(n.openBlock(),n.createBlock(N,{key:2,type:"ios-arrow-up"})):(n.openBlock(),n.createBlock(N,{key:3,type:"ios-arrow-down"}))])):n.createCommentVNode("",!0)],2)}var EU=l(Sfe,[["render",Efe]]);const Mfe={name:"TagSelectOption",components:{Tag:Wm},inject:["TagSelectInstance"],props:{name:{type:[String,Number],required:!0},tagProps:{type:Object,default(){return{}}},color:{type:String,default:"primary"}},data(){return{checked:!1,id:te(6)}},methods:{handleChange(c){this.checked=c,this.TagSelectInstance.handleChangeTag(this.name)},addOption(){this.TagSelectInstance.tagSelectOptionList.push({id:this.id,option:this})},removeOption(){const c=this.TagSelectInstance,u=c.tagSelectOptionList.findIndex(m=>m.id===this.id);c.tagSelectOptionList.splice(u,1)}},mounted(){this.addOption()},beforeUnmount(){this.removeOption()}},kfe={class:"ivu-tag-select-option"};function Pfe(c,u,m,S,b,v){const M=n.resolveComponent("Tag");return n.openBlock(),n.createElementBlock("div",kfe,[n.createVNode(M,n.mergeProps({checkable:"",checked:b.checked,onOnChange:v.handleChange,color:m.color},m.tagProps),{default:n.withCtx(()=>[n.renderSlot(c.$slots,"default")]),_:3},16,["checked","onOnChange","color"])])}var MU=l(Mfe,[["render",Pfe]]);const kU={name:"Text",mixins:[uv],render(){return n.h(Aw,{...this.$props,component:"span",...this.commonEvents()},this.commonSlots())}},PU="ivu-timeline",Ife={name:"Timeline",props:{pending:{type:Boolean,default:!1}},computed:{classes(){return[`${PU}`,{[`${PU}-pending`]:this.pending}]}}};function Bfe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("ul",{class:n.normalizeClass(v.classes)},[n.renderSlot(c.$slots,"default")],2)}var IU=l(Ife,[["render",Bfe]]);const tg="ivu-timeline",Rfe={name:"TimelineItem",props:{color:{type:String,default:"blue"}},data(){return{dot:!1}},mounted(){this.dot=!!this.$refs.dot.innerHTML.length},computed:{itemClasses(){return`${tg}-item`},tailClasses(){return`${tg}-item-tail`},headClasses(){return[`${tg}-item-head`,{[`${tg}-item-head-custom`]:this.dot,[`${tg}-item-head-${this.color}`]:this.headColorShow}]},headColorShow(){return this.color==="blue"||this.color==="red"||this.color==="green"},customColor(){let c={};return this.color&&(this.headColorShow||(c={color:this.color,"border-color":this.color})),c},contentClasses(){return`${tg}-item-content`}}};function Dfe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("li",{class:n.normalizeClass(v.itemClasses)},[n.createElementVNode("div",{class:n.normalizeClass(v.tailClasses)},null,2),n.createElementVNode("div",{class:n.normalizeClass(v.headClasses),style:n.normalizeStyle(v.customColor),ref:"dot"},[n.renderSlot(c.$slots,"dot")],6),n.createElementVNode("div",{class:n.normalizeClass(v.contentClasses)},[n.renderSlot(c.$slots,"default")],2)],2)}var BU=l(Rfe,[["render",Dfe]]),RU={mixins:[SV,pw],components:{TimePickerPanel:VV,RangeTimePickerPanel:XV},props:{type:{validator(c){return T(c,["time","timerange"])},default:"time"}},computed:{panel(){return this.type==="timerange"?"RangeTimePickerPanel":"TimePickerPanel"},ownPickerProps(){return{disabledHours:this.disabledHours,disabledMinutes:this.disabledMinutes,disabledSeconds:this.disabledSeconds,hideDisabledOptions:this.hideDisabledOptions}}},watch:{visible(c){c&&n.nextTick(()=>{this.timeSpinnerList.map(u=>u.timeSpinner).forEach(u=>u.updateScroll())})}}};const DU={name:"Title",mixins:[uv],props:{level:{type:Number,validator(c){return T(c,[1,2,3,4,5,6])},default:1}},render(){return n.h(Aw,{...this.$props,component:`h${this.level}`,...this.commonEvents()},this.commonSlots())}},Lfe={name:"Search",components:{Input:Xa},emits:["on-query-change","on-query-clear"],props:{prefixCls:String,placeholder:String,query:String},data(){return{currentQuery:this.query}},watch:{query(c){this.currentQuery=c},currentQuery(c){this.$emit("on-query-change",c)}},computed:{icon(){return this.query===""?"ios-search":"ios-close-circle"}},methods:{handleClick(){this.currentQuery!==""&&(this.currentQuery="",this.$emit("on-query-clear"))}}};function Nfe(c,u,m,S,b,v){const M=n.resolveComponent("Input");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(m.prefixCls)},[n.createVNode(M,{modelValue:b.currentQuery,"onUpdate:modelValue":u[0]||(u[0]=N=>b.currentQuery=N),size:"small",icon:v.icon,placeholder:m.placeholder,onOnClick:v.handleClick},null,8,["modelValue","icon","placeholder","onOnClick"])],2)}var Vfe=l(Lfe,[["render",Nfe]]);const $fe={name:"TransferList",components:{Search:Vfe,Checkbox:Xm},inject:["TransferInstance"],emits:["on-checked-keys-change"],props:{prefixCls:String,data:Array,renderFormat:Function,checkedKeys:Array,listStyle:Object,title:[String,Number],filterable:Boolean,filterPlaceholder:String,filterMethod:Function,notFoundText:String,validKeysCount:Number},data(){return{showItems:[],query:"",showFooter:!0}},watch:{data(){this.updateFilteredData()}},computed:{classes(){return[`${this.prefixCls}`,{[`${this.prefixCls}-with-footer`]:this.showFooter}]},bodyClasses(){return[`${this.prefixCls}-body`,{[`${this.prefixCls}-body-with-search`]:this.filterable,[`${this.prefixCls}-body-with-footer`]:this.showFooter}]},count(){const c=this.validKeysCount;return(c>0?`${c}/`:"")+`${this.data.length}`},checkedAll(){return this.filterData.filter(c=>!c.disabled).length===this.validKeysCount&&this.validKeysCount!==0},checkedAllDisabled(){return this.filterData.filter(c=>!c.disabled).length<=0},filterData(){return this.showItems.filter(c=>this.filterMethod(c,this.query))}},methods:{itemClasses(c){return[`${this.prefixCls}-content-item`,{[`${this.prefixCls}-content-item-disabled`]:c.disabled}]},showLabel(c){return this.renderFormat(c)},isCheck(c){return this.checkedKeys.some(u=>u===c.key)},select(c){if(c.disabled)return;const u=this.checkedKeys.indexOf(c.key);u>-1?this.checkedKeys.splice(u,1):this.checkedKeys.push(c.key),this.TransferInstance.handleCheckedKeys()},updateFilteredData(){this.showItems=this.data},toggleSelectAll(c){const u=c?this.filterData.filter(m=>!m.disabled||this.checkedKeys.indexOf(m.key)>-1).map(m=>m.key):this.filterData.filter(m=>m.disabled&&this.checkedKeys.indexOf(m.key)>-1).map(m=>m.key);this.$emit("on-checked-keys-change",u)},handleQueryClear(){this.query=""},handleQueryChange(c){this.query=c}},created(){this.updateFilteredData()},mounted(){this.showFooter=this.$slots.default!==void 0}},Ufe=["onClick"],Ffe=["innerHTML"];function zfe(c,u,m,S,b,v){const M=n.resolveComponent("Checkbox"),N=n.resolveComponent("Search");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(v.classes),style:n.normalizeStyle(m.listStyle)},[n.createElementVNode("div",{class:n.normalizeClass(m.prefixCls+"-header")},[n.createVNode(M,{modelValue:v.checkedAll,disabled:v.checkedAllDisabled,"onUpdate:modelValue":v.toggleSelectAll},null,8,["modelValue","disabled","onUpdate:modelValue"]),n.createElementVNode("span",{class:n.normalizeClass(m.prefixCls+"-header-title"),onClick:u[0]||(u[0]=X=>v.toggleSelectAll(!v.checkedAll))},n.toDisplayString(m.title),3),n.createElementVNode("span",{class:n.normalizeClass(m.prefixCls+"-header-count")},n.toDisplayString(v.count),3)],2),n.createElementVNode("div",{class:n.normalizeClass(v.bodyClasses)},[m.filterable?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(m.prefixCls+"-body-search-wrapper")},[n.createVNode(N,{"prefix-cls":m.prefixCls+"-search",query:b.query,onOnQueryClear:v.handleQueryClear,onOnQueryChange:v.handleQueryChange,placeholder:m.filterPlaceholder},null,8,["prefix-cls","query","onOnQueryClear","onOnQueryChange","placeholder"])],2)):n.createCommentVNode("",!0),n.createElementVNode("ul",{class:n.normalizeClass(m.prefixCls+"-content")},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.filterData,(X,U)=>(n.openBlock(),n.createElementBlock("li",{key:U,class:n.normalizeClass(v.itemClasses(X)),onClick:n.withModifiers(H=>v.select(X),["prevent"])},[n.createVNode(M,{modelValue:v.isCheck(X),disabled:X.disabled},null,8,["modelValue","disabled"]),n.createElementVNode("span",{innerHTML:v.showLabel(X)},null,8,Ffe)],10,Ufe))),128)),n.createElementVNode("li",{class:n.normalizeClass(m.prefixCls+"-content-not-found")},n.toDisplayString(m.notFoundText),3)],2)],2),b.showFooter?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(m.prefixCls+"-footer")},[n.renderSlot(c.$slots,"default")],2)):n.createCommentVNode("",!0)],6)}var LU=l($fe,[["render",zfe]]);const Xfe={name:"Operation",components:{Button:co,Icon:O},inject:["TransferInstance"],props:{prefixCls:String,operations:Array,leftActive:Boolean,rightActive:Boolean,reverseOperation:Boolean},methods:{moveToLeft(){this.TransferInstance.moveTo("left")},moveToRight(){this.TransferInstance.moveTo("right")}}},Wfe={key:0},Hfe={key:0},Gfe={key:0},Qfe={key:0};function Yfe(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("Button");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(m.prefixCls+"-operation")},[m.reverseOperation?(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createVNode(N,{type:"primary",size:"small",disabled:!m.leftActive,onClick:v.moveToRight},{default:n.withCtx(()=>[m.operations[1]?(n.openBlock(),n.createElementBlock("span",Wfe,n.toDisplayString(m.operations[1]),1)):n.createCommentVNode("",!0),n.createVNode(M,{type:"ios-arrow-forward"})]),_:1},8,["disabled","onClick"]),n.createVNode(N,{type:"primary",size:"small",disabled:!m.rightActive,onClick:v.moveToLeft},{default:n.withCtx(()=>[n.createVNode(M,{type:"ios-arrow-back"}),m.operations[0]?(n.openBlock(),n.createElementBlock("span",Hfe,n.toDisplayString(m.operations[0]),1)):n.createCommentVNode("",!0)]),_:1},8,["disabled","onClick"])],64)):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.createVNode(N,{type:"primary",size:"small",disabled:!m.rightActive,onClick:v.moveToLeft},{default:n.withCtx(()=>[n.createVNode(M,{type:"ios-arrow-back"}),m.operations[0]?(n.openBlock(),n.createElementBlock("span",Gfe,n.toDisplayString(m.operations[0]),1)):n.createCommentVNode("",!0)]),_:1},8,["disabled","onClick"]),n.createVNode(N,{type:"primary",size:"small",disabled:!m.leftActive,onClick:v.moveToRight},{default:n.withCtx(()=>[m.operations[1]?(n.openBlock(),n.createElementBlock("span",Qfe,n.toDisplayString(m.operations[1]),1)):n.createCommentVNode("",!0),n.createVNode(M,{type:"ios-arrow-forward"})]),_:1},8,["disabled","onClick"])],64))],2)}var jfe=l(Xfe,[["render",Yfe]]);const NU="ivu-transfer",VU={name:"Transfer",mixins:[Sn,Li],emits:["on-change","on-selected-change"],provide(){return{TransferInstance:this}},render(){const c=this.$slots.default?this.$slots.default():"";return n.h("div",{class:this.classes},[n.h(LU,{ref:"left",prefixCls:this.prefixCls+"-list",data:this.leftData,renderFormat:this.renderFormat,checkedKeys:this.leftCheckedKeys,validKeysCount:this.leftValidKeysCount,listStyle:this.listStyle,title:this.localeTitles[0],filterable:this.filterable,filterPlaceholder:this.localeFilterPlaceholder,filterMethod:this.filterMethod,notFoundText:this.localeNotFoundText,"onOn-checked-keys-change":this.handleLeftCheckedKeysChange},()=>c),n.h(jfe,{prefixCls:this.prefixCls,operations:this.operations,leftActive:this.leftValidKeysCount>0,rightActive:this.rightValidKeysCount>0,reverseOperation:this.reverseOperation}),n.h(LU,{ref:"right",prefixCls:this.prefixCls+"-list",data:this.rightData,renderFormat:this.renderFormat,checkedKeys:this.rightCheckedKeys,validKeysCount:this.rightValidKeysCount,listStyle:this.listStyle,title:this.localeTitles[1],filterable:this.filterable,filterPlaceholder:this.localeFilterPlaceholder,filterMethod:this.filterMethod,notFoundText:this.localeNotFoundText,"onOn-checked-keys-change":this.handleRightCheckedKeysChange},()=>c)])},props:{data:{type:Array,default(){return[]}},renderFormat:{type:Function,default(c){return c.label||c.key}},targetKeys:{type:Array,default(){return[]}},selectedKeys:{type:Array,default(){return[]}},listStyle:{type:Object,default(){return{}}},titles:{type:Array},operations:{type:Array,default(){return[]}},filterable:{type:Boolean,default:!1},filterPlaceholder:{type:String},filterMethod:{type:Function,default(c,u){const m="label"in c?"label":"key";return c[m].indexOf(u)>-1}},notFoundText:{type:String},reverseOperation:{type:Boolean,default:!1}},data(){return{prefixCls:NU,leftData:[],rightData:[],leftCheckedKeys:[],rightCheckedKeys:[]}},computed:{classes(){return[`${NU}`]},leftValidKeysCount(){return this.getValidKeys("left").length},rightValidKeysCount(){return this.getValidKeys("right").length},localeFilterPlaceholder(){return this.filterPlaceholder===void 0?this.t("i.transfer.filterPlaceholder"):this.filterPlaceholder},localeNotFoundText(){return this.notFoundText===void 0?this.t("i.transfer.notFoundText"):this.notFoundText},localeTitles(){return this.titles===void 0?[this.t("i.transfer.titles.source"),this.t("i.transfer.titles.target")]:this.titles}},methods:{getValidKeys(c){return this[`${c}Data`].filter(u=>!u.disabled&&this[`${c}CheckedKeys`].indexOf(u.key)>-1).map(u=>u.key)},splitData(c=!1){this.leftData=[...this.data],this.rightData=[],this.targetKeys.length>0&&this.targetKeys.forEach(u=>{const m=this.leftData.filter((S,b)=>S.key===u?(this.leftData.splice(b,1),!0):!1);m&&m.length>0&&this.rightData.push(m[0])}),c&&this.splitSelectedKey()},splitSelectedKey(){const c=this.selectedKeys;c.length>0&&(this.leftCheckedKeys=this.leftData.filter(u=>c.indexOf(u.key)>-1).map(u=>u.key),this.rightCheckedKeys=this.rightData.filter(u=>c.indexOf(u.key)>-1).map(u=>u.key))},moveTo(c){const u=this.targetKeys,m=c==="left"?"right":"left",S=this.getValidKeys(m),b=c==="right"?S.concat(u):u.filter(v=>!S.some(M=>v===M));this.$refs[m].toggleSelectAll(!1),this.$emit("on-change",b,c,S),this.handleFormItemChange("change",{tarketKeys:b,direction:c,moveKeys:S})},handleLeftCheckedKeysChange(c){this.leftCheckedKeys=c},handleRightCheckedKeysChange(c){this.rightCheckedKeys=c},handleCheckedKeys(){const c=this.getValidKeys("left"),u=this.getValidKeys("right");this.$emit("on-selected-change",c,u)}},watch:{targetKeys(){this.splitData(!1)},data(){this.splitData(!1)}},mounted(){this.splitData(!0)}};var qfe={name:"RenderCell",props:{render:Function,data:Object,node:Array},render(){const c={root:this.node[0],node:this.node[1],data:this.data};return this.render(n.h,c)}};const Gu="ivu-tree",Zfe={name:"TreeNode",inject:["TreeInstance"],components:{Checkbox:Xm,Icon:O,CollapseTransition:hM,Render:qfe},props:{data:{type:Object,default:()=>{}},multiple:{type:Boolean,default:!1},childrenKey:{type:String,default:"children"},showCheckbox:{type:Boolean,default:!1},appear:{type:Boolean,default:!1}},data(){return{prefixCls:Gu,appearByClickArrow:!1,globalConfig:{}}},computed:{classes(){return[`${Gu}-children`]},selectedCls(){return[{[`${Gu}-node-selected`]:this.data.selected}]},arrowClasses(){return[`${Gu}-arrow`,{[`${Gu}-arrow-disabled`]:this.data.disabled,[`${Gu}-arrow-open`]:this.data.expand}]},titleClasses(){return[`${Gu}-title`,{[`${Gu}-title-selected`]:this.data.selected}]},showArrow(){return this.data[this.childrenKey]&&this.data[this.childrenKey].length||"loading"in this.data&&!this.data.loading},showLoading(){return"loading"in this.data&&this.data.loading},isParentRender(){const c=F(this,"Tree");return c&&c.render},parentRender(){const c=F(this,"Tree");return c&&c.render?c.render:null},node(){const c=F(this,"Tree");return c?[c.flatState,c.flatState.find(u=>u.nodeKey===this.data.nodeKey)]:[]},children(){return this.data[this.childrenKey]},arrowType(){const c=this.globalConfig;let u="ios-arrow-forward";return c&&(c.tree.customArrow?u="":c.tree.arrow&&(u=c.tree.arrow)),u},customArrowType(){const c=this.globalConfig;let u="";return c&&c.tree.customArrow&&(u=c.tree.customArrow),u},arrowSize(){const c=this.globalConfig;let u="";return c&&c.tree.arrowSize&&(u=c.tree.arrowSize),u}},methods:{handleExpand(){const c=this.data;if(this.appearByClickArrow=!0,c[this.childrenKey].length===0){const u=F(this,"Tree");if(u&&u.loadData){this.data.loading=!0,u.loadData(c,m=>{this.data.loading=!1,m.length&&(this.data[this.childrenKey]=m,n.nextTick(()=>this.handleExpand()))});return}}c[this.childrenKey]&&c[this.childrenKey].length&&(this.data.expand=!this.data.expand,this.TreeInstance.handleToggleExpand(this.data))},handleClickNode(){this.TreeInstance.expandNode?this.showArrow&&this.handleExpand():this.TreeInstance.selectNode&&this.handleSelect()},handleSelect(){this.data.disabled||(this.TreeInstance.showCheckbox&&this.TreeInstance.checkDirectly?this.handleCheck():this.TreeInstance.handleOnSelected(this.data.nodeKey))},handleCheck(){if(this.data.disabled)return;const c={checked:!this.data.checked&&!this.data.indeterminate,nodeKey:this.data.nodeKey};this.TreeInstance.handleOnCheck(c)},handleContextmenu(c,u){c.contextmenu&&(u.preventDefault(),this.TreeInstance.handleOnContextmenu({data:c,event:u}))},handlePreventSelect(c,u){c.contextmenu&&u.preventDefault()}},created(){const c=n.getCurrentInstance();this.globalConfig=c.appContext.config.globalProperties.$VIEWUI}},Kfe={key:0,class:"ivu-tree-expand"};function Jfe(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("Checkbox"),X=n.resolveComponent("Render"),U=n.resolveComponent("TreeNode"),H=n.resolveComponent("collapse-transition");return n.openBlock(),n.createElementBlock("ul",{class:n.normalizeClass(v.classes)},[n.createElementVNode("li",{onContextmenu:u[2]||(u[2]=n.withModifiers(re=>v.handleContextmenu(m.data,re),["stop"])),onSelectstart:u[3]||(u[3]=n.withModifiers(re=>v.handlePreventSelect(m.data,re),["stop"]))},[n.createElementVNode("span",{class:n.normalizeClass(v.arrowClasses),onClick:u[0]||(u[0]=(...re)=>v.handleExpand&&v.handleExpand(...re))},[v.showArrow?(n.openBlock(),n.createBlock(M,{key:0,type:v.arrowType,custom:v.customArrowType,size:v.arrowSize},null,8,["type","custom","size"])):n.createCommentVNode("",!0),v.showLoading?(n.openBlock(),n.createBlock(M,{key:1,type:"ios-loading",class:"ivu-load-loop"})):n.createCommentVNode("",!0)],2),m.showCheckbox?(n.openBlock(),n.createBlock(N,{key:0,"model-value":m.data.checked,indeterminate:m.data.indeterminate,disabled:m.data.disabled||m.data.disableCheckbox,onClick:n.withModifiers(v.handleCheck,["prevent"])},null,8,["model-value","indeterminate","disabled","onClick"])):n.createCommentVNode("",!0),n.createElementVNode("span",{class:n.normalizeClass(v.titleClasses),onClick:u[1]||(u[1]=(...re)=>v.handleClickNode&&v.handleClickNode(...re))},[m.data.render?(n.openBlock(),n.createBlock(X,{key:0,render:m.data.render,data:m.data,node:v.node},null,8,["render","data","node"])):v.isParentRender?(n.openBlock(),n.createBlock(X,{key:1,render:v.parentRender,data:m.data,node:v.node},null,8,["render","data","node"])):(n.openBlock(),n.createElementBlock(n.Fragment,{key:2},[n.createTextVNode(n.toDisplayString(m.data.title),1)],64))],2),n.createVNode(H,{appear:m.appear},{default:n.withCtx(()=>[m.data.expand?(n.openBlock(),n.createElementBlock("div",Kfe,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(v.children,(re,xe)=>(n.openBlock(),n.createBlock(U,{appear:b.appearByClickArrow,key:xe,data:re,multiple:m.multiple,"show-checkbox":m.showCheckbox,"children-key":m.childrenKey},null,8,["appear","data","multiple","show-checkbox","children-key"]))),128))])):n.createCommentVNode("",!0)]),_:1},8,["appear"])],32)],2)}var epe=l(Zfe,[["render",Jfe]]);const tpe="ivu-tree",ipe={name:"Tree",mixins:[Sn],components:{TreeNode:epe,Dropdown:If,DropdownMenu:Bf},emits:["on-select-change","on-check-change","on-contextmenu","on-toggle-expand"],provide(){return{TreeInstance:this}},props:{data:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!1},checkDirectly:{type:Boolean,default:!1},emptyText:{type:String},childrenKey:{type:String,default:"children"},loadData:{type:Function},render:{type:Function},selectNode:{type:Boolean,default:!0},expandNode:{type:Boolean,default:!1},autoCloseContextmenu:{type:Boolean,default:!0}},data(){return{prefixCls:tpe,stateTree:this.data,flatState:[],contextMenuVisible:!1,contextMenuStyles:{top:0,left:0}}},watch:{data:{deep:!0,handler(){this.stateTree=this.data,this.flatState=this.compileFlatState(),this.rebuildTree()}}},computed:{localeEmptyText(){return typeof this.emptyText>"u"?this.t("i.tree.emptyText"):this.emptyText}},methods:{compileFlatState(){let c=0,u=this.childrenKey;const m=[];function S(b,v){b.nodeKey=c++,m[b.nodeKey]={node:b,nodeKey:b.nodeKey},typeof v<"u"&&(m[b.nodeKey].parent=v.nodeKey,m[v.nodeKey][u].push(b.nodeKey)),b[u]&&(m[b.nodeKey][u]=[],b[u].forEach(M=>S(M,b)))}return this.stateTree.forEach(b=>{S(b)}),m},updateTreeUp(c){const u=this.flatState[c].parent;if(typeof u>"u"||this.checkStrictly)return;const m=this.flatState[c].node,S=this.flatState[u].node;m.checked==S.checked&&m.indeterminate==S.indeterminate||(m.checked==!0?(S.checked=S[this.childrenKey].every(b=>b.checked),S.indeterminate=!S.checked):(S.checked=!1,S.indeterminate=S[this.childrenKey].some(b=>b.checked||b.indeterminate)),this.updateTreeUp(u))},rebuildTree(){this.getCheckedNodes().forEach(c=>{this.updateTreeDown(c,{checked:!0});const u=this.flatState[c.nodeKey].parent;if(!u&&u!==0)return;const m=this.flatState[u].node;typeof c.checked<"u"&&c.checked&&m.checked!=c.checked&&this.updateTreeUp(c.nodeKey)})},getSelectedNodes(){return this.flatState.filter(c=>c.node.selected).map(c=>c.node)},getCheckedNodes(){return this.flatState.filter(c=>c.node.checked).map(c=>c.node)},getCheckedAndIndeterminateNodes(){return this.flatState.filter(c=>c.node.checked||c.node.indeterminate).map(c=>c.node)},updateTreeDown(c,u={}){if(!this.checkStrictly){for(let m in u)c[m]=u[m];c[this.childrenKey]&&c[this.childrenKey].forEach(m=>{this.updateTreeDown(m,u)})}},handleSelect(c){if(!this.flatState[c])return;const u=this.flatState[c].node;if(!this.multiple){const m=this.flatState.findIndex(S=>S.node.selected);m>=0&&m!==c&&(this.flatState[m].node.selected=!1)}u.selected=!u.selected,this.$emit("on-select-change",this.getSelectedNodes(),u)},handleCheck({checked:c,nodeKey:u}){if(!this.flatState[u])return;const m=this.flatState[u].node;m.checked=c,m.indeterminate=!1,this.updateTreeUp(u),this.updateTreeDown(m,{checked:c,indeterminate:!1}),this.$emit("on-check-change",this.getCheckedNodes(),m)},handleContextmenu({data:c,event:u}){this.contextMenuVisible&&this.handleClickContextMenuOutside(),n.nextTick(()=>{const m=this.$refs.treeWrap.getBoundingClientRect(),S={left:`${u.clientX-m.left}px`,top:`${u.clientY-m.top}px`};this.contextMenuStyles=S,this.contextMenuVisible=!0,this.$emit("on-contextmenu",c,u,S)})},handleClickContextMenuOutside(){this.contextMenuVisible=!1},handleOnCheck(c){this.handleCheck(c)},handleOnSelected(c){this.handleSelect(c)},handleToggleExpand(c){this.$emit("on-toggle-expand",c)},handleOnContextmenu(c){this.handleContextmenu(c)},closeContextMenu(){this.handleClickContextMenuOutside()},handleClickDropdownItem(){this.autoCloseContextmenu&&this.closeContextMenu()}},created(){this.flatState=this.compileFlatState(),this.rebuildTree()}};function npe(c,u,m,S,b,v){const M=n.resolveComponent("TreeNode"),N=n.resolveComponent("DropdownMenu"),X=n.resolveComponent("Dropdown");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(b.prefixCls),ref:"treeWrap"},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(b.stateTree,(U,H)=>(n.openBlock(),n.createBlock(M,{key:H,data:U,visible:"",multiple:m.multiple,"show-checkbox":m.showCheckbox,"children-key":m.childrenKey},null,8,["data","multiple","show-checkbox","children-key"]))),128)),b.stateTree.length?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass([b.prefixCls+"-empty"])},n.toDisplayString(v.localeEmptyText),3)),n.createElementVNode("div",{class:"ivu-tree-context-menu",style:n.normalizeStyle(b.contextMenuStyles)},[n.createVNode(X,{trigger:"custom",visible:b.contextMenuVisible,transfer:"",onOnClick:v.handleClickDropdownItem,onOnClickoutside:v.handleClickContextMenuOutside},{list:n.withCtx(()=>[n.createVNode(N,null,{default:n.withCtx(()=>[n.renderSlot(c.$slots,"contextMenu")]),_:3})]),_:3},8,["visible","onOnClick","onOnClickoutside"])],4)],2)}var SM=l(ipe,[["render",npe]]);const spe={name:"TreeSelect",components:{Select:lo,Tree:SM},emits:["on-change","update:modelValue","on-open-change"],mixins:[Li],props:{modelValue:{type:[String,Number,Array]},data:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},loadData:{type:Function},transfer:{type:Boolean,default(){const c=n.getCurrentInstance().appContext.config.globalProperties;return!c.$VIEWUI||c.$VIEWUI.transfer===""?!1:c.$VIEWUI.transfer}}},data(){let c=this.modelValue;return c===null&&(this.multiple?c=[]:c=""),{currentValue:c,isChangeValueInTree:!1,isValueChangeByTree:!1,isValueNull:!1}},watch:{modelValue(c){if(this.isChangeValueInTree)this.isChangeValueInTree=!1;else{let u=c;u===null&&(this.isValueNull=!0,this.multiple?u=[]:u=""),this.currentValue=u,this.$refs.select.reset(),this.handleUpdateTreeNodes(this.data,!0)}},data(){this.isChangeValueInTree?this.isChangeValueInTree=!1:(this.$refs.select.reset(),this.handleUpdateTreeNodes(this.data,!0))}},computed:{valueToArray(){return typeof this.currentValue=="object"?this.currentValue:[this.currentValue]},isCheckboxUsable(){return this.multiple&&this.showCheckbox},transferClassName(){return this.transfer?"ivu-tree-select-transfer":""},classes(){return{"ivu-tree-select-with-checkbox":this.showCheckbox}}},methods:{handleSelectNode(c,u){if(this.multiple)c.length?(this.currentValue=c.map(m=>m.value),this.handleUpdateSelectValue(u.value,u.title)):(this.currentValue=[],this.handleUpdateSelectValue("",""));else if(c.length){const m=c[0];this.currentValue=m.value,this.handleUpdateSelectValue(m.value,m.title)}else this.currentValue="",this.handleUpdateSelectValue("","");this.isChangeValueInTree=!0,this.$emit("update:modelValue",this.currentValue),this.$emit("on-change",this.currentValue),this.handleFormItemChange("change",this.currentValue)},handleUpdateTreeNodes(c,u=!1){c.forEach(m=>{this.valueToArray.indexOf(m.value)>=0?(this.isCheckboxUsable?m.checked=!0:m.selected=!0,this.handleUpdateSelectValue(m.value,m.title)):this.isCheckboxUsable?m.checked=!1:m.selected=!1,m.children&&m.children.length&&this.handleUpdateTreeNodes(m.children)}),u&&(this.$refs.select.isFocused=!1)},handleUpdateSelectValue(c,u){c===""?this.$refs.select.reset():(this.isValueChangeByTree=!0,this.$refs.select.onOptionClick({value:c,label:u}))},handleChange(c){this.isValueChangeByTree?this.isValueChangeByTree=!1:(this.currentValue=c,this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",c),this.$emit("on-change",c),this.handleFormItemChange("change",c),this.$refs.select.reset(),this.handleUpdateTreeNodes(this.data,!0),n.nextTick(()=>{this.isValueChangeByTree=!1}))},handleOpenChange(c){this.$emit("on-open-change",c)}},mounted(){this.handleUpdateTreeNodes(this.data,!0)}};function rpe(c,u,m,S,b,v){const M=n.resolveComponent("Tree"),N=n.resolveComponent("Select");return n.openBlock(),n.createBlock(N,n.mergeProps({ref:"select"},c.$attrs,{multiple:m.multiple,class:["ivu-tree-select",v.classes],"transfer-class-name":v.transferClassName,onOnChange:v.handleChange,onOnOpenChange:v.handleOpenChange,hideNotFound:"",transfer:m.transfer}),{default:n.withCtx(()=>[n.createVNode(M,{data:m.data,multiple:m.multiple,onOnSelectChange:v.handleSelectNode,onOnCheckChange:v.handleSelectNode,"check-strictly":"","show-checkbox":m.multiple&&m.showCheckbox,"check-directly":"","load-data":m.loadData},null,8,["data","multiple","onOnSelectChange","onOnCheckChange","show-checkbox","load-data"])]),_:1},16,["multiple","class","transfer-class-name","onOnChange","onOnOpenChange","transfer"])}var $U=l(spe,[["render",rpe]]);const ope={name:"Typography"},ape={class:"ivu-typography"};function lpe(c,u,m,S,b,v){return n.openBlock(),n.createElementBlock("article",ape,[n.renderSlot(c.$slots,"default")])}var UU=l(ope,[["render",lpe]]);const CM="ivu-upload",cpe={name:"UploadList",components:{Icon:O,iProgress:Rw},emits:["on-file-click","on-file-preview","on-file-remove"],props:{files:{type:Array,default(){return[]}}},data(){return{prefixCls:CM}},methods:{fileCls(c){return[`${CM}-list-file`,{[`${CM}-list-file-finish`]:c.status==="finished"}]},handleClick(c){this.$emit("on-file-click",c)},handlePreview(c){this.$emit("on-file-preview",c)},handleRemove(c){this.$emit("on-file-remove",c)},format(c){const u=c.name.split(".").pop().toLocaleLowerCase()||"";let m="ios-document-outline";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(u)>-1&&(m="ios-image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(u)>-1&&(m="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(u)>-1&&(m="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(u)>-1&&(m="md-document"),["numbers","csv","xls","xlsx"].indexOf(u)>-1&&(m="ios-stats"),["keynote","ppt","pptx"].indexOf(u)>-1&&(m="ios-videocam"),m},parsePercentage(c){return parseInt(c,10)}}},hpe=["onClick"],upe=["onClick"];function dpe(c,u,m,S,b,v){const M=n.resolveComponent("Icon"),N=n.resolveComponent("i-progress");return n.openBlock(),n.createElementBlock("ul",{class:n.normalizeClass([b.prefixCls+"-list"])},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(m.files,(X,U)=>(n.openBlock(),n.createElementBlock("li",{key:U,class:n.normalizeClass(v.fileCls(X)),onClick:H=>v.handleClick(X)},[n.createElementVNode("span",{onClick:H=>v.handlePreview(X)},[n.createVNode(M,{type:v.format(X)},null,8,["type"]),n.createTextVNode(" "+n.toDisplayString(X.name),1)],8,upe),n.withDirectives(n.createVNode(M,{type:"ios-close",class:n.normalizeClass([b.prefixCls+"-list-remove"]),onClick:H=>v.handleRemove(X)},null,8,["class","onClick"]),[[n.vShow,X.status==="finished"]]),n.createVNode(n.Transition,{name:"fade"},{default:n.withCtx(()=>[X.showProgress?(n.openBlock(),n.createBlock(N,{key:0,"stroke-width":2,percent:v.parsePercentage(X.percentage),status:X.status==="finished"&&X.showProgress?"success":"normal"},null,8,["percent","status"])):n.createCommentVNode("",!0)]),_:2},1024)],10,hpe))),128))],2)}var fpe=l(cpe,[["render",dpe]]);function ppe(c,u,m){const S=`fail to post ${c} ${m.status}'`,b=new Error(S);return b.status=m.status,b.method="post",b.url=c,b}function FU(c){const u=c.responseText||c.response;if(!u)return u;try{return JSON.parse(u)}catch{return u}}function mpe(c){if(typeof XMLHttpRequest>"u")return;const u=new XMLHttpRequest,m=c.action;u.upload&&(u.upload.onprogress=function(v){v.total>0&&(v.percent=v.loaded/v.total*100),c.onProgress(v)});const S=new FormData;c.data&&Object.keys(c.data).map(v=>{S.append(v,c.data[v])}),S.append(c.filename,c.file),u.onerror=function(v){c.onError(v)},u.onload=function(){if(u.status<200||u.status>=300)return c.onError(ppe(m,c,u),FU(u));c.onSuccess(FU(u))},u.open("post",m,!0),c.withCredentials&&"withCredentials"in u&&(u.withCredentials=!0);const b=c.headers||{};for(let v in b)b.hasOwnProperty(v)&&b[v]!==null&&u.setRequestHeader(v,b[v]);u.send(S)}const Ov="ivu-upload",gpe={name:"Upload",mixins:[Li],components:{UploadList:fpe},props:{action:{type:String,required:!0},headers:{type:Object,default(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator(c){return T(c,["select","drag"])},default:"select"},format:{type:Array,default(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default(){return{}}},onSuccess:{type:Function,default(){return{}}},onError:{type:Function,default(){return{}}},onRemove:{type:Function,default(){return{}}},onPreview:{type:Function,default(){return{}}},onExceededSize:{type:Function,default(){return{}}},onFormatError:{type:Function,default(){return{}}},defaultFileList:{type:Array,default(){return[]}},paste:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},webkitdirectory:{type:Boolean,default:!1}},data(){return{prefixCls:Ov,dragOver:!1,fileList:[],tempIndex:1}},computed:{classes(){return[`${Ov}`,{[`${Ov}-select`]:this.type==="select",[`${Ov}-drag`]:this.type==="drag",[`${Ov}-dragOver`]:this.type==="drag"&&this.dragOver}]}},methods:{handleClick(){this.itemDisabled||this.$refs.input.click()},handleChange(c){const u=c.target.files;!u||(this.uploadFiles(u),this.$refs.input.value=null)},onDrop(c){this.dragOver=!1,!this.itemDisabled&&this.uploadFiles(c.dataTransfer.files)},handlePaste(c){this.itemDisabled||this.paste&&this.uploadFiles(c.clipboardData.files)},uploadFiles(c){let u=Array.prototype.slice.call(c);this.multiple||(u=u.slice(0,1)),u.length!==0&&u.forEach(m=>{this.upload(m)})},upload(c){if(!this.beforeUpload)return this.post(c);const u=this.beforeUpload(c);u&&u.then?u.then(m=>{Object.prototype.toString.call(m)==="[object File]"?this.post(m):this.post(c)},()=>{}):u!==!1&&this.post(c)},post(c){if(this.format.length){const u=c.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(m=>m.toLocaleLowerCase()===u))return this.onFormatError(c,this.fileList),!1}if(this.maxSize&&c.size>this.maxSize*1024)return this.onExceededSize(c,this.fileList),!1;this.handleStart(c),new FormData().append(this.name,c),mpe({headers:this.headers,withCredentials:this.withCredentials,file:c,data:this.data,filename:this.name,action:this.action,onProgress:u=>{this.handleProgress(u,c)},onSuccess:u=>{this.handleSuccess(u,c)},onError:(u,m)=>{this.handleError(u,m,c)}})},handleStart(c){c.uid=Date.now()+this.tempIndex++;const u={status:"uploading",name:c.name,size:c.size,percentage:0,uid:c.uid,showProgress:!0};this.fileList.push(u)},getFile(c){const u=this.fileList;let m;return u.every(S=>(m=c.uid===S.uid?S:null,!m)),m},handleProgress(c,u){const m=this.getFile(u);this.onProgress(c,m,this.fileList),m.percentage=c.percent||0},handleSuccess(c,u){const m=this.getFile(u);m&&(m.status="finished",m.response=c,this.onSuccess(c,m,this.fileList),this.handleFormItemChange("change",m),setTimeout(()=>{m.showProgress=!1},1e3))},handleError(c,u,m){const S=this.getFile(m),b=this.fileList;S.status="fail",b.splice(b.indexOf(S),1),this.onError(c,u,m)},handleRemove(c){const u=this.fileList;u.splice(u.indexOf(c),1),this.onRemove(c,u)},handlePreview(c){c.status==="finished"&&this.onPreview(c)},clearFiles(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler(c){this.fileList=c.map(u=>(u.status="finished",u.percentage=100,u.uid=Date.now()+this.tempIndex++,u))}}}},ype=["multiple","webkitdirectory","accept"];function vpe(c,u,m,S,b,v){const M=n.resolveComponent("upload-list");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass([b.prefixCls])},[n.createElementVNode("div",{class:n.normalizeClass(v.classes),onClick:u[1]||(u[1]=(...N)=>v.handleClick&&v.handleClick(...N)),onDrop:u[2]||(u[2]=n.withModifiers((...N)=>v.onDrop&&v.onDrop(...N),["prevent"])),onPaste:u[3]||(u[3]=(...N)=>v.handlePaste&&v.handlePaste(...N)),onDragover:u[4]||(u[4]=n.withModifiers(N=>b.dragOver=!0,["prevent"])),onDragleave:u[5]||(u[5]=n.withModifiers(N=>b.dragOver=!1,["prevent"]))},[n.createElementVNode("input",{ref:"input",type:"file",class:n.normalizeClass([b.prefixCls+"-input"]),onChange:u[0]||(u[0]=(...N)=>v.handleChange&&v.handleChange(...N)),multiple:m.multiple,webkitdirectory:m.webkitdirectory,accept:m.accept},null,42,ype),n.renderSlot(c.$slots,"default")],34),n.renderSlot(c.$slots,"tip"),m.showUploadList?(n.openBlock(),n.createBlock(M,{key:0,files:b.fileList,onOnFileRemove:v.handleRemove,onOnFilePreview:v.handlePreview},null,8,["files","onOnFileRemove","onOnFilePreview"])):n.createCommentVNode("",!0)],2)}var zU=l(gpe,[["render",vpe]]);const XU={name:"UserName",mixins:[Zy],data(){return{className:"ivu-login-username",prefix:"ios-contact-outline",placeholder:"",type:"text",validateMessage:""}}},xpe={name:"WordCount",components:{Circle:sw},props:{value:{type:[String,Number],default:""},total:{type:Number,default:0},hideTotal:{type:Boolean,default:!1},overflow:{type:Boolean,default:!1},circle:{type:Boolean,default:!1},size:{type:[String,Number],default:14}},computed:{isOverflow(){return this.value.length>this.total},percent(){let c=this.value.length/this.total*100;return c>100&&(c=100),c},strokeColor(){return this.isOverflow?"#ed4014":"#2d8cf0"}}},_pe={class:"ivu-word-count"},bpe={key:0,class:"ivu-word-count-prefix"},wpe={key:1,class:"ivu-word-count-prefix ivu-word-count-overflow"},Ope={key:3,class:"ivu-word-count-overflow"},Spe={key:5,class:"ivu-word-count-suffix"},Cpe={key:6,class:"ivu-word-count-suffix ivu-word-count-overflow"};function Tpe(c,u,m,S,b,v){const M=n.resolveComponent("Circle");return n.openBlock(),n.createElementBlock("div",_pe,[m.circle?(n.openBlock(),n.createBlock(M,{key:0,percent:v.percent,size:m.size,"stroke-color":v.strokeColor},null,8,["percent","size","stroke-color"])):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[v.isOverflow?(n.openBlock(),n.createElementBlock("span",wpe,[n.renderSlot(c.$slots,"prefix-overflow")])):(n.openBlock(),n.createElementBlock("span",bpe,[n.renderSlot(c.$slots,"prefix")])),!v.isOverflow||!m.overflow?(n.openBlock(),n.createElementBlock("span",{key:2,class:n.normalizeClass({"ivu-word-count-overflow":v.isOverflow})},[n.renderSlot(c.$slots,"length",{length:m.value.length},()=>[n.createTextVNode(n.toDisplayString(m.value.length),1)])],2)):(n.openBlock(),n.createElementBlock("span",Ope,n.toDisplayString(m.value.length-m.total),1)),m.hideTotal?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock(n.Fragment,{key:4},[n.renderSlot(c.$slots,"separator",{},()=>[n.createTextVNode(" / ")]),n.renderSlot(c.$slots,"total",{total:m.total},()=>[n.createTextVNode(n.toDisplayString(m.total),1)])],64)),v.isOverflow?(n.openBlock(),n.createElementBlock("span",Cpe,[n.renderSlot(c.$slots,"suffix-overflow")])):(n.openBlock(),n.createElementBlock("span",Spe,[n.renderSlot(c.$slots,"suffix")]))],64))])}var WU=l(xpe,[["render",Tpe]]),HU=Object.freeze(Object.defineProperty({__proto__:null,Affix:y,Alert:De,Anchor:W,AnchorLink:le,Auth:Ee,AutoComplete:fN,Avatar:Hy,AvatarList:gN,BackTop:yN,Badge:Zb,Breadcrumb:vE,BreadcrumbItem:xE,Button:co,ButtonGroup:_E,Calendar:AN,Captcha:RN,Card:LN,Carousel:NN,CarouselItem:VN,Cascader:$N,Cell:UN,CellGroup:FN,Checkbox:Xm,CheckboxGroup:kE,Circle:sw,City:HN,Col:pc,Collapse:QN,ColorPicker:rV,Content:BE,Copy:hw,CountDown:dV,CountUp:fV,DatePicker:HV,Description:GV,DescriptionList:QV,Divider:yw,Drawer:YV,Dropdown:If,DropdownItem:jV,DropdownMenu:Bf,Ellipsis:qV,Email:ZV,Exception:KV,Footer:YE,FooterToolbar:JV,Form:bw,FormItem:nw,GlobalFooter:e$,Grid:f$,GridItem:p$,Header:JE,Icon:O,Image:m$,ImagePreview:zu,Input:Xa,InputNumber:eM,Layout:y$,Link:b$,List:C$,ListItem:T$,ListItemMeta:A$,LoadingBar:iM,Login:R$,Menu:sM,MenuGroup:D$,MenuItem:L$,Message:rv,Mobile:N$,Modal:Ha,Notice:oM,Notification:Y$,NotificationItem:Z$,NotificationTab:K$,NumberInfo:J$,Numeral:tU,Option:ds,OptionGroup:iU,Page:nU,PageHeader:sU,Panel:rU,Paragraph:oU,Password:aU,Poptip:uM,Progress:Rw,Radio:ew,RadioGroup:Jb,Rate:lU,Result:cU,Row:Du,Scroll:uU,ScrollIntoView:fM,ScrollTop:pM,Select:lo,Sider:gU,Skeleton:yU,SkeletonItem:mM,Slider:vU,Space:xU,Spin:da,Split:_U,Step:wU,Steps:OU,Submenu:SU,Submit:CU,Switch:yM,Table:Lw,TablePaste:AU,TabPane:Bw,Tabs:Pw,Tag:Wm,TagSelect:EU,TagSelectOption:MU,Text:kU,Time:Iw,Timeline:IU,TimelineItem:BU,TimePicker:RU,Title:DU,Tooltip:mh,Transfer:VU,Tree:SM,TreeSelect:$U,Trend:lM,Typography:UU,Upload:zU,UserName:XU,WordCount:WU},Symbol.toStringTag,{value:"Module"})),Ape={mounted(c,u){u.value&&(J(c,"ivu-line-clamp"),c.style["-webkit-line-clamp"]=u.value)},updated(c,u){u.value&&(c.style["-webkit-line-clamp"]=u.value)},unmounted(c){ue(c,"ivu-line-clamp"),c.style["-webkit-line-clamp"]=null}},Epe={mounted(c,u){function m(S){u.value(S)}c.__resizeHandler__=m,c.__observer__=qm(),c.__observer__.listenTo(c,m)},updated(){},unmounted(c,u){c.__observer__.removeListener(c,c.__resizeHandler__),delete c.__resizeHandler__,delete c.__observer__}};function Qu(c){return String(c).endsWith("%")?"":"px"}var Yu={display:{mounted(c,u){u.value&&(c.style.display=u.value)},updated(c,u){u.value&&(c.style.display=u.value)},unmounted(c){c.style.display=null}},width:{mounted(c,u){u.value&&(c.style.width=u.value+Qu(u.value))},updated(c,u){u.value&&(c.style.width=u.value+Qu(u.value))},unmounted(c){c.style.width=null}},height:{mounted(c,u){u.value&&(c.style.height=u.value+Qu(u.value))},updated(c,u){u.value&&(c.style.height=u.value+Qu(u.value))},unmounted(c){c.style.height=null}},margin:{mounted(c,u){u.value&&(c.style.margin=u.value+Qu(u.value))},updated(c,u){u.value&&(c.style.margin=u.value+Qu(u.value))},unmounted(c){c.style.margin=null}},padding:{mounted(c,u){u.value&&(c.style.padding=u.value+Qu(u.value))},updated(c,u){u.value&&(c.style.padding=u.value+Qu(u.value))},unmounted(c){c.style.padding=null}},font:{mounted(c,u){u&&u.value&&(c.style.fontSize=`${u.value}px`)},updated(c,u){u&&u.value&&(c.style.fontSize=`${u.value}px`)},unmounted(c){c.style.fontSize=null}},color:{mounted(c,u){u.value&&(c.style.color=u.value)},updated(c,u){u.value&&(c.style.color=u.value)},unmounted(c){c.style.color=null}},bgColor:{mounted(c,u){u.value&&(c.style.backgroundColor=u.value)},updated(c,u){u.value&&(c.style.backgroundColor=u.value)},unmounted(c){c.style.backgroundColor=null}}},Mpe={name:"view-ui-plus",version:"1.3.17",title:"ViewUIPlus",description:"A high quality UI components Library with Vue.js 3",homepage:"http://www.iviewui.com",keywords:["iview","vue","viewui","viewuiplus","vue.js","component","components","ui","framework"],main:"dist/viewuiplus.min.js",typings:"types/index.d.ts",files:["dist","src","types"],scripts:{dev:"vue-cli-service serve",build:"npm run build:prod && npm run build:style && npm run build:lang","build:style":"gulp --gulpfile build/build-style.js","build:prod":"vite build","build:lang":"vite build --config build/vite.lang.config.js",lint:"vue-cli-service lint --fix"},repository:{type:"git",url:"https://github.com/view-design/ViewUIPlus"},author:"Aresn",license:"MIT",bugs:{url:"https://github.com/view-design/ViewUIPlus/issues"},dependencies:{"async-validator":"^3.3.0","countup.js":"^1.9.3",dayjs:"^1.11.0",deepmerge:"^2.2.1","element-resize-detector":"^1.2.0","js-calendar":"^1.2.3","lodash.chunk":"^4.2.0","lodash.throttle":"^4.1.1",numeral:"^2.0.6","popper.js":"^1.14.6",select:"^1.1.2",tinycolor2:"^1.4.1","v-click-outside-x":"^3.7.1"},devDependencies:{"@vitejs/plugin-vue":"^1.9.3","@vue/cli-plugin-babel":"~4.5.0","@vue/cli-plugin-eslint":"~4.5.0","@vue/cli-service":"~4.5.0","@vue/compiler-sfc":"^3.0.0","babel-eslint":"^10.1.0","babel-plugin-import":"^1.13.3",chai:"^4.2.0","copy-webpack-plugin":"^6.4.1","cross-env":"^5.2.0",eslint:"^6.7.2","eslint-plugin-vue":"^7.0.0-0",gulp:"^4.0.2","gulp-autoprefixer":"^8.0.0","gulp-clean-css":"^4.3.0","gulp-less":"^4.0.1","gulp-rename":"^2.0.0",karma:"^2.0.5","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.1","karma-mocha":"^1.3.0","karma-sinon-chai":"^1.3.3","karma-sourcemap-loader":"^0.3.7","karma-spec-reporter":"^0.0.32","karma-webpack":"^2.0.13",less:"^2.7.3","less-loader":"^4.1.0","lint-staged":"^10.5.4",lolex:"^2.7.5",mocha:"^5.0.4",sinon:"^4.4.2","sinon-chai":"^3.3.0","style-loader":"^0.20.2",tslint:"^5.14.0",typescript:"^3.3.4000","uglifyjs-webpack-plugin":"^1.3.0","url-loader":"^1.1.2",vite:"^2.6.4",vue:"^3.2.47","vue-hot-reload-api":"^2.3.4","vue-html-loader":"^1.2.4","vue-loader":"^17.0.0","vue-router":"^4.0.14","vue-style-loader":"^4.1.3","vue-template-compiler":"^2.6.14"}};const GU={display:Yu.display,width:Yu.width,height:Yu.height,margin:Yu.margin,padding:Yu.padding,font:Yu.font,color:Yu.color,"bg-color":Yu.bgColor,resize:Epe,"line-clamp":Ape},QU={...HU,iButton:co,iCircle:sw,iCol:pc,iContent:BE,iForm:bw,iFooter:YE,iHeader:JE,iInput:Xa,iMenu:sM,iOption:ds,iProgress:Rw,iSelect:lo,iSwitch:yM,iTable:Lw,iTime:Iw},TM=function(c,u={}){TM.installed||(u.locale&&Iu.use(u.locale),u.i18n&&Iu.i18n(u.i18n),Object.keys(QU).forEach(m=>{c.component(m,QU[m])}),Object.keys(GU).forEach(m=>{c.directive(m,GU[m])}),c.config.globalProperties.$VIEWUI={size:u.size||"",capture:"capture"in u?u.capture:!0,transfer:"transfer"in u?u.transfer:"",cell:{arrow:u.cell&&u.cell.arrow?u.cell.arrow:"",customArrow:u.cell&&u.cell.customArrow?u.cell.customArrow:"",arrowSize:u.cell&&u.cell.arrowSize?u.cell.arrowSize:""},menu:{arrow:u.menu&&u.menu.arrow?u.menu.arrow:"",customArrow:u.menu&&u.menu.customArrow?u.menu.customArrow:"",arrowSize:u.menu&&u.menu.arrowSize?u.menu.arrowSize:""},modal:{maskClosable:u.modal&&"maskClosable"in u.modal?u.modal.maskClosable:""},tabs:{closeIcon:u.tabs&&u.tabs.closeIcon?u.tabs.closeIcon:"",customCloseIcon:u.tabs&&u.tabs.customCloseIcon?u.tabs.customCloseIcon:"",closeIconSize:u.tabs&&u.tabs.closeIconSize?u.tabs.closeIconSize:""},select:{arrow:u.select&&u.select.arrow?u.select.arrow:"",customArrow:u.select&&u.select.customArrow?u.select.customArrow:"",arrowSize:u.select&&u.select.arrowSize?u.select.arrowSize:""},colorPicker:{arrow:u.colorPicker&&u.colorPicker.arrow?u.colorPicker.arrow:"",customArrow:u.colorPicker&&u.colorPicker.customArrow?u.colorPicker.customArrow:"",arrowSize:u.colorPicker&&u.colorPicker.arrowSize?u.colorPicker.arrowSize:""},cascader:{arrow:u.cascader&&u.cascader.arrow?u.cascader.arrow:"",customArrow:u.cascader&&u.cascader.customArrow?u.cascader.customArrow:"",arrowSize:u.cascader&&u.cascader.arrowSize?u.cascader.arrowSize:"",itemArrow:u.cascader&&u.cascader.itemArrow?u.cascader.itemArrow:"",customItemArrow:u.cascader&&u.cascader.customItemArrow?u.cascader.customItemArrow:"",itemArrowSize:u.cascader&&u.cascader.itemArrowSize?u.cascader.itemArrowSize:""},tree:{arrow:u.tree&&u.tree.arrow?u.tree.arrow:"",customArrow:u.tree&&u.tree.customArrow?u.tree.customArrow:"",arrowSize:u.tree&&u.tree.arrowSize?u.tree.arrowSize:""},datePicker:{icon:u.datePicker&&u.datePicker.icon?u.datePicker.icon:"",customIcon:u.datePicker&&u.datePicker.customIcon?u.datePicker.customIcon:"",iconSize:u.datePicker&&u.datePicker.iconSize?u.datePicker.iconSize:""},timePicker:{icon:u.timePicker&&u.timePicker.icon?u.timePicker.icon:"",customIcon:u.timePicker&&u.timePicker.customIcon?u.timePicker.customIcon:"",iconSize:u.timePicker&&u.timePicker.iconSize?u.timePicker.iconSize:""},typography:{copyConfig:u.typography&&u.typography.copyConfig?u.typography.copyConfig:"",editConfig:u.typography&&u.typography.editConfig?u.typography.editConfig:"",ellipsisConfig:u.typography&&u.typography.ellipsisConfig?u.typography.ellipsisConfig:""},space:{size:u.space&&u.space.size?u.space.size:""},image:{toolbar:u.image&&u.image.toolbar?u.image.toolbar:""}},c.config.globalProperties.$Spin=da,c.config.globalProperties.$Loading=iM,c.config.globalProperties.$Message=rv,c.config.globalProperties.$Notice=oM,c.config.globalProperties.$Modal=Ha,c.config.globalProperties.$ImagePreview=zu,c.config.globalProperties.$Copy=hw,c.config.globalProperties.$ScrollIntoView=fM,c.config.globalProperties.$ScrollTop=pM,c.config.globalProperties.$Date=la)},YU=Mpe.version,jU=Iu.use,qU=Iu.i18n,ZU=c=>{const u=window["viewuiplus/locale"].default;c===u.i.locale?Iu.use(u):console.log(`The ${c} language pack is not loaded.`)},kpe={version:YU,locale:jU,i18n:qU,install:TM,lang:ZU,...HU};i.Affix=y,i.Alert=De,i.Anchor=W,i.AnchorLink=le,i.Auth=Ee,i.AutoComplete=fN,i.Avatar=Hy,i.AvatarList=gN,i.BackTop=yN,i.Badge=Zb,i.Breadcrumb=vE,i.BreadcrumbItem=xE,i.Button=co,i.ButtonGroup=_E,i.Calendar=AN,i.Captcha=RN,i.Card=LN,i.Carousel=NN,i.CarouselItem=VN,i.Cascader=$N,i.Cell=UN,i.CellGroup=FN,i.Checkbox=Xm,i.CheckboxGroup=kE,i.Circle=sw,i.City=HN,i.Col=pc,i.Collapse=QN,i.ColorPicker=rV,i.Content=BE,i.Copy=hw,i.CountDown=dV,i.CountUp=fV,i.DatePicker=HV,i.Description=GV,i.DescriptionList=QV,i.Divider=yw,i.Drawer=YV,i.Dropdown=If,i.DropdownItem=jV,i.DropdownMenu=Bf,i.Ellipsis=qV,i.Email=ZV,i.Exception=KV,i.Footer=YE,i.FooterToolbar=JV,i.Form=bw,i.FormItem=nw,i.GlobalFooter=e$,i.Grid=f$,i.GridItem=p$,i.Header=JE,i.Icon=O,i.Image=m$,i.ImagePreview=zu,i.Input=Xa,i.InputNumber=eM,i.Layout=y$,i.Link=b$,i.List=C$,i.ListItem=T$,i.ListItemMeta=A$,i.LoadingBar=iM,i.Login=R$,i.Menu=sM,i.MenuGroup=D$,i.MenuItem=L$,i.Message=rv,i.Mobile=N$,i.Modal=Ha,i.Notice=oM,i.Notification=Y$,i.NotificationItem=Z$,i.NotificationTab=K$,i.NumberInfo=J$,i.Numeral=tU,i.Option=ds,i.OptionGroup=iU,i.Page=nU,i.PageHeader=sU,i.Panel=rU,i.Paragraph=oU,i.Password=aU,i.Poptip=uM,i.Progress=Rw,i.Radio=ew,i.RadioGroup=Jb,i.Rate=lU,i.Result=cU,i.Row=Du,i.Scroll=uU,i.ScrollIntoView=fM,i.ScrollTop=pM,i.Select=lo,i.Sider=gU,i.Skeleton=yU,i.SkeletonItem=mM,i.Slider=vU,i.Space=xU,i.Spin=da,i.Split=_U,i.Step=wU,i.Steps=OU,i.Submenu=SU,i.Submit=CU,i.Switch=yM,i.TabPane=Bw,i.Table=Lw,i.TablePaste=AU,i.Tabs=Pw,i.Tag=Wm,i.TagSelect=EU,i.TagSelectOption=MU,i.Text=kU,i.Time=Iw,i.TimePicker=RU,i.Timeline=IU,i.TimelineItem=BU,i.Title=DU,i.Tooltip=mh,i.Transfer=VU,i.Tree=SM,i.TreeSelect=$U,i.Trend=lM,i.Typography=UU,i.Upload=zU,i.UserName=XU,i.WordCount=WU,i.default=kpe,i.i18n=qU,i.install=TM,i.lang=ZU,i.locale=jU,i.version=YU,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})})(HR,HR.exports);var x0=HR.exports;const lXe=TD(x0),ZJ=s=>(GT("data-v-455ca2b1"),s=s(),QT(),s),cXe={class:"split-image-container"},hXe=ZJ(()=>Kt("h1",null,"",-1)),uXe=ZJ(()=>Kt("p",null,"plistpngpng",-1)),dXe={key:0},fXe={__name:"SplitImage",setup(s){let e=gt(!1),i=null,n="",r=[],o=null,a=null,l=null;async function h(){window.cv||await new Promise(_=>{const w=document.createElement("script");w.src="https://cdn.jsdelivr.net/npm/opencv.js",w.async=!0,w.onload=()=>_(),document.body.appendChild(w)}),window.JSZip||await new Promise(_=>{const w=document.createElement("script");w.src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js",w.onload=()=>_(),document.body.appendChild(w)}),a=window.cv,l=window.JSZip}function d(){i&&(i.delete(),i=null),r=[],n=""}function f(_){function w(T){const C=_[T];for(let A=0;A<_.length;++A){if(T===A)continue;const B=_[A];if(C.x>=B.x&&C.y>=B.y&&C.x+C.width<=B.x+B.width&&C.y+C.height<=B.y+B.height)return!0}return!1}const O=[];for(let T=0;T<_.length;++T){const C=_[T];w(T)||C.width<3&&C.height<3||O.push(_[T])}return O}function p(_){d(),o&&_?(o.width=_.width,o.height=_.height):console.warn("canvas  eleSrc ");const w=a.imread(_);i=w.clone();const O=new a.MatVector;a.split(w,O);const T=O.get(3),C=new a.Mat;a.threshold(T,C,10,255,a.THRESH_BINARY);const A=new a.MatVector,B=new a.Mat;a.findContours(C,A,B,a.RETR_CCOMP,a.CHAIN_APPROX_SIMPLE);const I=new a.Scalar(255,0,0,255);a.copyMakeBorder(w,w,1,1,1,1,a.BORDER_CONSTANT,I);let R=[];for(let P=0;P<A.size();++P){let k=a.boundingRect(A.get(P));R.push(k)}r=f(R);for(let P=0;P<r.length;++P){let k=r[P],E=new a.Point(k.x,k.y),D=new a.Point(k.x+k.width,k.y+k.height);a.rectangle(w,E,D,new a.Scalar(0,255,0,255),1)}n=`${r.length}`,a.imshow(o,w),w.delete(),O.delete(),C.delete(),A.delete(),B.delete()}function g(_){if(!_)return;const w=new FileReader;w.readAsDataURL(_),w.onloadend=function(){const O=new window.Image;O.src=this.result,O.onload=function(){p(O)}}}function y(_){return g(_),!1}function x(){if(!i||!r.length)return;const _=new l;let w=0;for(let O=0;O<r.length;++O){const T=r[O],C={x:T.x,y:T.y,width:T.width,height:T.height},A=i.roi(C),B=`image${O+1}`,I=document.createElement("canvas");I.width=T.width,I.height=T.height,a.imshow(I,A),I.toBlob(function(R){_.file(B+".png",R),w++,w===r.length&&_.generateAsync({type:"blob"}).then(function(P){const k=document.createElement("a");k.href=URL.createObjectURL(P),k.download="images.zip",k.click()})}),A.delete()}}return io(async()=>{await h(),o=document.getElementById("mycanvas"),window.cv&&window.cv.onRuntimeInitialized?window.cv.onRuntimeInitialized=()=>{e.value=!0,n=""}:e.value=!0,o&&(o.width=512,o.height=512)}),(_,w)=>{const O=Bn("Upload"),T=Bn("Button"),C=Bn("Col"),A=Bn("Row");return di(),hn("div",cXe,[hXe,uXe,vt(A,null,{default:Zt(()=>[vt(C,null,{default:Zt(()=>[vt(O,{"before-upload":y,"show-upload-list":!1,disabled:!ni(e),accept:"image/*",action:""},{default:Zt(()=>[vt(ni(x0.Button),{type:"primary",disabled:!ni(e)},{default:Zt(()=>[As("")]),_:1},8,["disabled"])]),_:1},8,["disabled"]),vt(T,{type:"success",onClick:x,disabled:!ni(e)},{default:Zt(()=>[As("  ")]),_:1},8,["disabled"])]),_:1})]),_:1}),Kt("p",null,ea(ni(n)),1),Kt("div",null,[ni(e)?cm("",!0):(di(),hn("p",dXe,"...(20)")),Kt("canvas",{ref_key:"canvas",ref:o,id:"mycanvas"},null,512)])])}}},pXe=eA(fXe,[["__scopeId","data-v-455ca2b1"]]);var mXe={exports:{}};(function(s,e){/** @preserve SAT.js - Version 0.9.0 - Copyright 2012 - 2021 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */(function(i,n){s.exports=n()})(ou,function(){var i={};function n(k,E){this.x=k||0,this.y=E||0}i.Vector=n,i.V=n,n.prototype.copy=n.prototype.copy=function(k){return this.x=k.x,this.y=k.y,this},n.prototype.clone=n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.perp=n.prototype.perp=function(){var k=this.x;return this.x=this.y,this.y=-k,this},n.prototype.rotate=n.prototype.rotate=function(k){var E=this.x,D=this.y;return this.x=E*Math.cos(k)-D*Math.sin(k),this.y=E*Math.sin(k)+D*Math.cos(k),this},n.prototype.reverse=n.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},n.prototype.normalize=n.prototype.normalize=function(){var k=this.len();return k>0&&(this.x=this.x/k,this.y=this.y/k),this},n.prototype.add=n.prototype.add=function(k){return this.x+=k.x,this.y+=k.y,this},n.prototype.sub=n.prototype.sub=function(k){return this.x-=k.x,this.y-=k.y,this},n.prototype.scale=n.prototype.scale=function(k,E){return this.x*=k,this.y*=typeof E<"u"?E:k,this},n.prototype.project=n.prototype.project=function(k){var E=this.dot(k)/k.len2();return this.x=E*k.x,this.y=E*k.y,this},n.prototype.projectN=n.prototype.projectN=function(k){var E=this.dot(k);return this.x=E*k.x,this.y=E*k.y,this},n.prototype.reflect=n.prototype.reflect=function(k){var E=this.x,D=this.y;return this.project(k).scale(2),this.x-=E,this.y-=D,this},n.prototype.reflectN=n.prototype.reflectN=function(k){var E=this.x,D=this.y;return this.projectN(k).scale(2),this.x-=E,this.y-=D,this},n.prototype.dot=n.prototype.dot=function(k){return this.x*k.x+this.y*k.y},n.prototype.len2=n.prototype.len2=function(){return this.dot(this)},n.prototype.len=n.prototype.len=function(){return Math.sqrt(this.len2())};function r(k,E){this.pos=k||new n,this.r=E||0,this.offset=new n}i.Circle=r,r.prototype.getAABBAsBox=r.prototype.getAABBAsBox=function(){var k=this.r,E=this.pos.clone().add(this.offset).sub(new n(k,k));return new a(E,k*2,k*2)},r.prototype.getAABB=r.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},r.prototype.setOffset=r.prototype.setOffset=function(k){return this.offset=k,this};function o(k,E){this.pos=k||new n,this.angle=0,this.offset=new n,this.setPoints(E||[])}i.Polygon=o,o.prototype.setPoints=o.prototype.setPoints=function(k){var E=!this.points||this.points.length!==k.length;if(E){var D,L=this.calcPoints=[],V=this.edges=[],F=this.normals=[];for(D=0;D<k.length;D++){var j=k[D],Q=D<k.length-1?k[D+1]:k[0];if(j!==Q&&j.x===Q.x&&j.y===Q.y){k.splice(D,1),D-=1;continue}L.push(new n),V.push(new n),F.push(new n)}}return this.points=k,this._recalc(),this},o.prototype.setAngle=o.prototype.setAngle=function(k){return this.angle=k,this._recalc(),this},o.prototype.setOffset=o.prototype.setOffset=function(k){return this.offset=k,this._recalc(),this},o.prototype.rotate=o.prototype.rotate=function(k){for(var E=this.points,D=E.length,L=0;L<D;L++)E[L].rotate(k);return this._recalc(),this},o.prototype.translate=o.prototype.translate=function(k,E){for(var D=this.points,L=D.length,V=0;V<L;V++)D[V].x+=k,D[V].y+=E;return this._recalc(),this},o.prototype._recalc=function(){var k=this.calcPoints,E=this.edges,D=this.normals,L=this.points,V=this.offset,F=this.angle,j=L.length,Q;for(Q=0;Q<j;Q++){var ee=k[Q].copy(L[Q]);ee.x+=V.x,ee.y+=V.y,F!==0&&ee.rotate(F)}for(Q=0;Q<j;Q++){var J=k[Q],ue=Q<j-1?k[Q+1]:k[0],oe=E[Q].copy(ue).sub(J);D[Q].copy(oe).perp().normalize()}return this},o.prototype.getAABBAsBox=o.prototype.getAABBAsBox=function(){for(var k=this.calcPoints,E=k.length,D=k[0].x,L=k[0].y,V=k[0].x,F=k[0].y,j=1;j<E;j++){var Q=k[j];Q.x<D?D=Q.x:Q.x>V&&(V=Q.x),Q.y<L?L=Q.y:Q.y>F&&(F=Q.y)}return new a(this.pos.clone().add(new n(D,L)),V-D,F-L)},o.prototype.getAABB=o.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},o.prototype.getCentroid=o.prototype.getCentroid=function(){for(var k=this.calcPoints,E=k.length,D=0,L=0,V=0,F=0;F<E;F++){var j=k[F],Q=F===E-1?k[0]:k[F+1],ee=j.x*Q.y-Q.x*j.y;D+=(j.x+Q.x)*ee,L+=(j.y+Q.y)*ee,V+=ee}return V=V*3,D=D/V,L=L/V,new n(D,L)};function a(k,E,D){this.pos=k||new n,this.w=E||0,this.h=D||0}i.Box=a,a.prototype.toPolygon=a.prototype.toPolygon=function(){var k=this.pos,E=this.w,D=this.h;return new o(new n(k.x,k.y),[new n,new n(E,0),new n(E,D),new n(0,D)])};function l(){this.a=null,this.b=null,this.overlapN=new n,this.overlapV=new n,this.clear()}i.Response=l,l.prototype.clear=l.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var h=[],d=0;d<10;d++)h.push(new n);for(var f=[],d=0;d<5;d++)f.push([]);var p=new l,g=new a(new n,1e-6,1e-6).toPolygon();function y(k,E,D){for(var L=Number.MAX_VALUE,V=-Number.MAX_VALUE,F=k.length,j=0;j<F;j++){var Q=k[j].dot(E);Q<L&&(L=Q),Q>V&&(V=Q)}D[0]=L,D[1]=V}function x(k,E,D,L,V,F){var j=f.pop(),Q=f.pop(),ee=h.pop().copy(E).sub(k),J=ee.dot(V);if(y(D,V,j),y(L,V,Q),Q[0]+=J,Q[1]+=J,j[0]>Q[1]||Q[0]>j[1])return h.push(ee),f.push(j),f.push(Q),!0;if(F){var ue=0;if(j[0]<Q[0])if(F.aInB=!1,j[1]<Q[1])ue=j[1]-Q[0],F.bInA=!1;else{var oe=j[1]-Q[0],pe=Q[1]-j[0];ue=oe<pe?oe:-pe}else if(F.bInA=!1,j[1]>Q[1])ue=j[0]-Q[1],F.aInB=!1;else{var oe=j[1]-Q[0],pe=Q[1]-j[0];ue=oe<pe?oe:-pe}var Ue=Math.abs(ue);Ue<F.overlap&&(F.overlap=Ue,F.overlapN.copy(V),ue<0&&F.overlapN.reverse())}return h.push(ee),f.push(j),f.push(Q),!1}i.isSeparatingAxis=x;function _(k,E){var D=k.len2(),L=E.dot(k);return L<0?w:L>D?T:O}var w=-1,O=0,T=1;function C(k,E){var D=h.pop().copy(k).sub(E.pos).sub(E.offset),L=E.r*E.r,V=D.len2();return h.push(D),V<=L}i.pointInCircle=C;function A(k,E){g.pos.copy(k),p.clear();var D=P(g,E,p);return D&&(D=p.aInB),D}i.pointInPolygon=A;function B(k,E,D){var L=h.pop().copy(E.pos).add(E.offset).sub(k.pos).sub(k.offset),V=k.r+E.r,F=V*V,j=L.len2();if(j>F)return h.push(L),!1;if(D){var Q=Math.sqrt(j);D.a=k,D.b=E,D.overlap=V-Q,D.overlapN.copy(L.normalize()),D.overlapV.copy(L).scale(D.overlap),D.aInB=k.r<=E.r&&Q<=E.r-k.r,D.bInA=E.r<=k.r&&Q<=k.r-E.r}return h.push(L),!0}i.testCircleCircle=B;function I(k,E,D){for(var L=h.pop().copy(E.pos).add(E.offset).sub(k.pos),V=E.r,F=V*V,j=k.calcPoints,Q=j.length,ee=h.pop(),J=h.pop(),ue=0;ue<Q;ue++){var oe=ue===Q-1?0:ue+1,pe=ue===0?Q-1:ue-1,Ue=0,tt=null;ee.copy(k.edges[ue]),J.copy(L).sub(j[ue]),D&&J.len2()>F&&(D.aInB=!1);var ve=_(ee,J);if(ve===w){ee.copy(k.edges[pe]);var Re=h.pop().copy(L).sub(j[pe]);if(ve=_(ee,Re),ve===T){var Le=J.len();if(Le>V)return h.push(L),h.push(ee),h.push(J),h.push(Re),!1;D&&(D.bInA=!1,tt=J.normalize(),Ue=V-Le)}h.push(Re)}else if(ve===T){if(ee.copy(k.edges[oe]),J.copy(L).sub(j[oe]),ve=_(ee,J),ve===w){var Le=J.len();if(Le>V)return h.push(L),h.push(ee),h.push(J),!1;D&&(D.bInA=!1,tt=J.normalize(),Ue=V-Le)}}else{var De=ee.perp().normalize(),Le=J.dot(De),Se=Math.abs(Le);if(Le>0&&Se>V)return h.push(L),h.push(De),h.push(J),!1;D&&(tt=De,Ue=V-Le,(Le>=0||Ue<2*V)&&(D.bInA=!1))}tt&&D&&Math.abs(Ue)<Math.abs(D.overlap)&&(D.overlap=Ue,D.overlapN.copy(tt))}return D&&(D.a=k,D.b=E,D.overlapV.copy(D.overlapN).scale(D.overlap)),h.push(L),h.push(ee),h.push(J),!0}i.testPolygonCircle=I;function R(k,E,D){var L=I(E,k,D);if(L&&D){var V=D.a,F=D.aInB;D.overlapN.reverse(),D.overlapV.reverse(),D.a=D.b,D.b=V,D.aInB=D.bInA,D.bInA=F}return L}i.testCirclePolygon=R;function P(k,E,D){for(var L=k.calcPoints,V=L.length,F=E.calcPoints,j=F.length,Q=0;Q<V;Q++)if(x(k.pos,E.pos,L,F,k.normals[Q],D))return!1;for(var Q=0;Q<j;Q++)if(x(k.pos,E.pos,L,F,E.normals[Q],D))return!1;return D&&(D.a=k,D.b=E,D.overlapV.copy(D.overlapN).scale(D.overlap)),!0}return i.testPolygonPolygon=P,i})})(mXe);/**
 * Planck.js v1.3.0
 * @license The MIT license
 * @copyright Copyright (c) 2024 Erin Catto, Ali Shakiba
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var GR=function(s,e){return GR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},GR(s,e)};function oo(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");GR(s,e);function i(){this.constructor=s}s.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}var to=function(){return to=Object.assign||function(e){for(var i,n=1,r=arguments.length;n<r;n++){i=arguments[n];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},to.apply(this,arguments)},Fa=function(s,e){(s===null||typeof s>"u")&&(s={});var i=to({},s);for(var n in e)e.hasOwnProperty(n)&&typeof s[n]>"u"&&(i[n]=e[n]);if(typeof Object.getOwnPropertySymbols=="function")for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++){var a=r[o];e.propertyIsEnumerable(a)&&typeof s[a]>"u"&&(i[a]=e[a])}return i},gXe=Math.random,ta=1e-9,yXe=Number.isFinite;function vXe(s){return s|=s>>1,s|=s>>2,s|=s>>4,s|=s>>8,s|=s>>16,s+1}function xXe(s){return s>0&&(s&s-1)===0}function KJ(s,e,i){return typeof e>"u"?(i=1,e=0):typeof i>"u"&&(i=e,e=0),i>e?(s=(s-e)%(i-e),s+(s<0?i:e)):(s=(s-i)%(e-i),s+(s<=0?e:i))}function wr(s,e,i){return s<e?e:s>i?i:s}function _Xe(s,e){return typeof s>"u"?(e=1,s=0):typeof e>"u"&&(e=s,s=0),s===e?s:gXe()*(e-s)+s}var Dm=Object.create(Math);Dm.EPSILON=ta;Dm.isFinite=yXe;Dm.nextPowerOfTwo=vXe;Dm.isPowerOfTwo=xXe;Dm.mod=KJ;Dm.clamp=wr;Dm.random=_Xe;var KW=Math.abs,p2=Math.sqrt,JW=Math.max,e8=Math.min,$=function(){function s(e,i){if(!(this instanceof s))return new s(e,i);typeof e>"u"?(this.x=0,this.y=0):typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=i)}return s.prototype._serialize=function(){return{x:this.x,y:this.y}},s._deserialize=function(e){var i=Object.create(s.prototype);return i.x=e.x,i.y=e.y,i},s.zero=function(){var e=Object.create(s.prototype);return e.x=0,e.y=0,e},s.neo=function(e,i){var n=Object.create(s.prototype);return n.x=e,n.y=i,n},s.clone=function(e){return s.neo(e.x,e.y)},s.prototype.toString=function(){return JSON.stringify(this)},s.isValid=function(e){return e===null||typeof e>"u"?!1:Number.isFinite(e.x)&&Number.isFinite(e.y)},s.assert=function(e){},s.prototype.clone=function(){return s.clone(this)},s.prototype.setZero=function(){return this.x=0,this.y=0,this},s.prototype.set=function(e,i){return typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=i),this},s.prototype.setNum=function(e,i){return this.x=e,this.y=i,this},s.prototype.setVec2=function(e){return this.x=e.x,this.y=e.y,this},s.prototype.wSet=function(e,i,n,r){return typeof n<"u"||typeof r<"u"?this.setCombine(e,i,n,r):this.setMul(e,i)},s.prototype.setCombine=function(e,i,n,r){var o=e*i.x+n*r.x,a=e*i.y+n*r.y;return this.x=o,this.y=a,this},s.prototype.setMul=function(e,i){var n=e*i.x,r=e*i.y;return this.x=n,this.y=r,this},s.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},s.prototype.wAdd=function(e,i,n,r){return typeof n<"u"||typeof r<"u"?this.addCombine(e,i,n,r):this.addMul(e,i)},s.prototype.addCombine=function(e,i,n,r){var o=e*i.x+n*r.x,a=e*i.y+n*r.y;return this.x+=o,this.y+=a,this},s.prototype.addMul=function(e,i){var n=e*i.x,r=e*i.y;return this.x+=n,this.y+=r,this},s.prototype.wSub=function(e,i,n,r){return typeof n<"u"||typeof r<"u"?this.subCombine(e,i,n,r):this.subMul(e,i)},s.prototype.subCombine=function(e,i,n,r){var o=e*i.x+n*r.x,a=e*i.y+n*r.y;return this.x-=o,this.y-=a,this},s.prototype.subMul=function(e,i){var n=e*i.x,r=e*i.y;return this.x-=n,this.y-=r,this},s.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},s.prototype.mul=function(e){return this.x*=e,this.y*=e,this},s.prototype.length=function(){return s.lengthOf(this)},s.prototype.lengthSquared=function(){return s.lengthSquared(this)},s.prototype.normalize=function(){var e=this.length();if(e<ta)return 0;var i=1/e;return this.x*=i,this.y*=i,e},s.normalize=function(e){var i=s.lengthOf(e);if(i<ta)return s.zero();var n=1/i;return s.neo(e.x*n,e.y*n)},s.lengthOf=function(e){return p2(e.x*e.x+e.y*e.y)},s.lengthSquared=function(e){return e.x*e.x+e.y*e.y},s.distance=function(e,i){var n=e.x-i.x,r=e.y-i.y;return p2(n*n+r*r)},s.distanceSquared=function(e,i){var n=e.x-i.x,r=e.y-i.y;return n*n+r*r},s.areEqual=function(e,i){return e===i||typeof i=="object"&&i!==null&&e.x===i.x&&e.y===i.y},s.skew=function(e){return s.neo(-e.y,e.x)},s.dot=function(e,i){return e.x*i.x+e.y*i.y},s.cross=function(e,i){return typeof i=="number"?s.neo(i*e.y,-i*e.x):typeof e=="number"?s.neo(-e*i.y,e*i.x):e.x*i.y-e.y*i.x},s.crossVec2Vec2=function(e,i){return e.x*i.y-e.y*i.x},s.crossVec2Num=function(e,i){return s.neo(i*e.y,-i*e.x)},s.crossNumVec2=function(e,i){return s.neo(-e*i.y,e*i.x)},s.addCross=function(e,i,n){if(typeof n=="number")return s.neo(n*i.y+e.x,-n*i.x+e.y);if(typeof i=="number")return s.neo(-i*n.y+e.x,i*n.x+e.y)},s.addCrossVec2Num=function(e,i,n){return s.neo(n*i.y+e.x,-n*i.x+e.y)},s.addCrossNumVec2=function(e,i,n){return s.neo(-i*n.y+e.x,i*n.x+e.y)},s.add=function(e,i){return s.neo(e.x+i.x,e.y+i.y)},s.wAdd=function(e,i,n,r){return typeof n<"u"||typeof r<"u"?s.combine(e,i,n,r):s.mulNumVec2(e,i)},s.combine=function(e,i,n,r){return s.zero().setCombine(e,i,n,r)},s.sub=function(e,i){return s.neo(e.x-i.x,e.y-i.y)},s.mul=function(e,i){if(typeof e=="object")return s.neo(e.x*i,e.y*i);if(typeof i=="object")return s.neo(e*i.x,e*i.y)},s.mulVec2Num=function(e,i){return s.neo(e.x*i,e.y*i)},s.mulNumVec2=function(e,i){return s.neo(e*i.x,e*i.y)},s.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},s.neg=function(e){return s.neo(-e.x,-e.y)},s.abs=function(e){return s.neo(KW(e.x),KW(e.y))},s.mid=function(e,i){return s.neo((e.x+i.x)*.5,(e.y+i.y)*.5)},s.upper=function(e,i){return s.neo(JW(e.x,i.x),JW(e.y,i.y))},s.lower=function(e,i){return s.neo(e8(e.x,i.x),e8(e.y,i.y))},s.prototype.clamp=function(e){var i=this.x*this.x+this.y*this.y;if(i>e*e){var n=e/p2(i);this.x*=n,this.y*=n}return this},s.clamp=function(e,i){var n=s.neo(e.x,e.y);return n.clamp(i),n},s.clampVec2=function(e,i,n){return{x:wr(e.x,i==null?void 0:i.x,n==null?void 0:n.x),y:wr(e.y,i==null?void 0:i.y,n==null?void 0:n.y)}},s.scaleFn=function(e,i){return function(n){return s.neo(n.x*e,n.y*i)}},s.translateFn=function(e,i){return function(n){return s.neo(n.x+e,n.y+i)}},s}(),qa=Math.max,Dl=Math.min,vr=function(){function s(e,i){if(!(this instanceof s))return new s(e,i);this.lowerBound=$.zero(),this.upperBound=$.zero(),typeof e=="object"&&this.lowerBound.setVec2(e),typeof i=="object"?this.upperBound.setVec2(i):typeof e=="object"&&this.upperBound.setVec2(e)}return s.prototype.isValid=function(){return s.isValid(this)},s.isValid=function(e){return e===null||typeof e>"u"?!1:$.isValid(e.lowerBound)&&$.isValid(e.upperBound)&&$.sub(e.upperBound,e.lowerBound).lengthSquared()>=0},s.assert=function(e){},s.prototype.getCenter=function(){return $.neo((this.lowerBound.x+this.upperBound.x)*.5,(this.lowerBound.y+this.upperBound.y)*.5)},s.prototype.getExtents=function(){return $.neo((this.upperBound.x-this.lowerBound.x)*.5,(this.upperBound.y-this.lowerBound.y)*.5)},s.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},s.prototype.combine=function(e,i){i=i||this;var n=e.lowerBound,r=e.upperBound,o=i.lowerBound,a=i.upperBound,l=Dl(n.x,o.x),h=Dl(n.y,o.y),d=qa(a.x,r.x),f=qa(a.y,r.y);this.lowerBound.setNum(l,h),this.upperBound.setNum(d,f)},s.prototype.combinePoints=function(e,i){this.lowerBound.setNum(Dl(e.x,i.x),Dl(e.y,i.y)),this.upperBound.setNum(qa(e.x,i.x),qa(e.y,i.y))},s.prototype.set=function(e){this.lowerBound.setNum(e.lowerBound.x,e.lowerBound.y),this.upperBound.setNum(e.upperBound.x,e.upperBound.y)},s.prototype.contains=function(e){var i=!0;return i=i&&this.lowerBound.x<=e.lowerBound.x,i=i&&this.lowerBound.y<=e.lowerBound.y,i=i&&e.upperBound.x<=this.upperBound.x,i=i&&e.upperBound.y<=this.upperBound.y,i},s.prototype.extend=function(e){return s.extend(this,e),this},s.extend=function(e,i){return e.lowerBound.x-=i,e.lowerBound.y-=i,e.upperBound.x+=i,e.upperBound.y+=i,e},s.testOverlap=function(e,i){var n=i.lowerBound.x-e.upperBound.x,r=e.lowerBound.x-i.upperBound.x,o=i.lowerBound.y-e.upperBound.y,a=e.lowerBound.y-i.upperBound.y;return!(n>0||o>0||r>0||a>0)},s.areEqual=function(e,i){return $.areEqual(e.lowerBound,i.lowerBound)&&$.areEqual(e.upperBound,i.upperBound)},s.diff=function(e,i){var n=qa(0,Dl(e.upperBound.x,i.upperBound.x)-qa(i.lowerBound.x,e.lowerBound.x)),r=qa(0,Dl(e.upperBound.y,i.upperBound.y)-qa(i.lowerBound.y,e.lowerBound.y)),o=e.upperBound.x-e.lowerBound.x,a=e.upperBound.y-e.lowerBound.y,l=i.upperBound.x-i.lowerBound.x,h=i.upperBound.y-i.lowerBound.y;return o*a+l*h-n*r},s.prototype.rayCast=function(e,i){for(var n=-1/0,r=1/0,o=i.p1,a=$.sub(i.p2,i.p1),l=$.abs(a),h=$.zero(),d="x";d!==null;d=d==="x"?"y":null)if(l.x<ta){if(o[d]<this.lowerBound[d]||this.upperBound[d]<o[d])return!1}else{var f=1/a[d],p=(this.lowerBound[d]-o[d])*f,g=(this.upperBound[d]-o[d])*f,y=-1;if(p>g){var x=p;p=g,g=x,y=1}if(p>n&&(h.setZero(),h[d]=y,n=p),r=Dl(r,g),n>r)return!1}return n<0||i.maxFraction<n?!1:(e.fraction=n,e.normal=h,!0)},s.prototype.toString=function(){return JSON.stringify(this)},s.combinePoints=function(e,i,n){return e.lowerBound.x=Dl(i.x,n.x),e.lowerBound.y=Dl(i.y,n.y),e.upperBound.x=qa(i.x,n.x),e.upperBound.y=qa(i.y,n.y),e},s.combinedPerimeter=function(e,i){var n=Dl(e.lowerBound.x,i.lowerBound.x),r=Dl(e.lowerBound.y,i.lowerBound.y),o=qa(e.upperBound.x,i.upperBound.x),a=qa(e.upperBound.y,i.upperBound.y);return 2*(o-n+a-r)},s}(),ZO=Math.PI,Bi=function(){function s(){}return Object.defineProperty(s,"polygonRadius",{get:function(){return 2*s.linearSlop},enumerable:!1,configurable:!0}),s.lengthUnitsPerMeter=1,s.maxManifoldPoints=2,s.maxPolygonVertices=12,s.aabbExtension=.1,s.aabbMultiplier=2,s.linearSlop=.005,s.angularSlop=2/180*ZO,s.maxSubSteps=8,s.maxTOIContacts=32,s.maxTOIIterations=20,s.maxDistanceIterations=20,s.velocityThreshold=1,s.maxLinearCorrection=.2,s.maxAngularCorrection=8/180*ZO,s.maxTranslation=2,s.maxRotation=.5*ZO,s.baumgarte=.2,s.toiBaugarte=.75,s.timeToSleep=.5,s.linearSleepTolerance=.01,s.angularSleepTolerance=2/180*ZO,s}(),wt=function(){function s(){}return Object.defineProperty(s,"maxManifoldPoints",{get:function(){return Bi.maxManifoldPoints},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxPolygonVertices",{get:function(){return Bi.maxPolygonVertices},enumerable:!1,configurable:!0}),Object.defineProperty(s,"aabbExtension",{get:function(){return Bi.aabbExtension*Bi.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(s,"aabbMultiplier",{get:function(){return Bi.aabbMultiplier},enumerable:!1,configurable:!0}),Object.defineProperty(s,"linearSlop",{get:function(){return Bi.linearSlop*Bi.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(s,"linearSlopSquared",{get:function(){return Bi.linearSlop*Bi.lengthUnitsPerMeter*Bi.linearSlop*Bi.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(s,"angularSlop",{get:function(){return Bi.angularSlop},enumerable:!1,configurable:!0}),Object.defineProperty(s,"polygonRadius",{get:function(){return 2*Bi.linearSlop},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxSubSteps",{get:function(){return Bi.maxSubSteps},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxTOIContacts",{get:function(){return Bi.maxTOIContacts},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxTOIIterations",{get:function(){return Bi.maxTOIIterations},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxDistanceIterations",{get:function(){return Bi.maxDistanceIterations},enumerable:!1,configurable:!0}),Object.defineProperty(s,"velocityThreshold",{get:function(){return Bi.velocityThreshold*Bi.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxLinearCorrection",{get:function(){return Bi.maxLinearCorrection*Bi.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxAngularCorrection",{get:function(){return Bi.maxAngularCorrection},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxTranslation",{get:function(){return Bi.maxTranslation*Bi.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxTranslationSquared",{get:function(){return Bi.maxTranslation*Bi.lengthUnitsPerMeter*Bi.maxTranslation*Bi.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxRotation",{get:function(){return Bi.maxRotation},enumerable:!1,configurable:!0}),Object.defineProperty(s,"maxRotationSquared",{get:function(){return Bi.maxRotation*Bi.maxRotation},enumerable:!1,configurable:!0}),Object.defineProperty(s,"baumgarte",{get:function(){return Bi.baumgarte},enumerable:!1,configurable:!0}),Object.defineProperty(s,"toiBaugarte",{get:function(){return Bi.toiBaugarte},enumerable:!1,configurable:!0}),Object.defineProperty(s,"timeToSleep",{get:function(){return Bi.timeToSleep},enumerable:!1,configurable:!0}),Object.defineProperty(s,"linearSleepTolerance",{get:function(){return Bi.linearSleepTolerance*Bi.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(s,"linearSleepToleranceSqr",{get:function(){return Bi.linearSleepTolerance*Bi.lengthUnitsPerMeter*Bi.linearSleepTolerance*Bi.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(s,"angularSleepTolerance",{get:function(){return Bi.angularSleepTolerance},enumerable:!1,configurable:!0}),Object.defineProperty(s,"angularSleepToleranceSqr",{get:function(){return Bi.angularSleepTolerance*Bi.angularSleepTolerance},enumerable:!1,configurable:!0}),s}(),s_=function(){function s(e){this._list=[],this._max=1/0,this._hasCreateFn=!1,this._createCount=0,this._hasAllocateFn=!1,this._allocateCount=0,this._hasReleaseFn=!1,this._releaseCount=0,this._hasDisposeFn=!1,this._disposeCount=0,this._list=[],this._max=e.max||this._max,this._createFn=e.create,this._hasCreateFn=typeof this._createFn=="function",this._allocateFn=e.allocate,this._hasAllocateFn=typeof this._allocateFn=="function",this._releaseFn=e.release,this._hasReleaseFn=typeof this._releaseFn=="function",this._disposeFn=e.dispose,this._hasDisposeFn=typeof this._disposeFn=="function"}return s.prototype.max=function(e){return typeof e=="number"?(this._max=e,this):this._max},s.prototype.size=function(){return this._list.length},s.prototype.allocate=function(){var e;return this._list.length>0?e=this._list.shift():(this._createCount++,this._hasCreateFn?e=this._createFn():e={}),this._allocateCount++,this._hasAllocateFn&&this._allocateFn(e),e},s.prototype.release=function(e){this._list.length<this._max?(this._releaseCount++,this._hasReleaseFn&&this._releaseFn(e),this._list.push(e)):(this._disposeCount++,this._hasDisposeFn&&(e=this._disposeFn(e)))},s.prototype.toString=function(){return" +"+this._createCount+" >"+this._allocateCount+" <"+this._releaseCount+" -"+this._disposeCount+" ="+this._list.length+"/"+this._max},s}(),t8=Math.abs,xa=Math.max,bXe=function(){function s(e){this.aabb=new vr,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.id=e}return s.prototype.toString=function(){return this.id+": "+this.userData},s.prototype.isLeaf=function(){return this.child1==null},s}(),i8=new s_({create:function(){return new bXe},release:function(s){s.userData=null,s.parent=null,s.child1=null,s.child2=null,s.height=-1,s.id=void 0}}),wXe=function(){function s(){this.inputPool=new s_({create:function(){return{}},release:function(e){}}),this.stackPool=new s_({create:function(){return[]},release:function(e){e.length=0}}),this.iteratorPool=new s_({create:function(){return new OXe},release:function(e){e.close()}}),this.m_root=null,this.m_nodes={},this.m_lastProxyId=0}return s.prototype.getUserData=function(e){var i=this.m_nodes[e];return i.userData},s.prototype.getFatAABB=function(e){var i=this.m_nodes[e];return i.aabb},s.prototype.allocateNode=function(){var e=i8.allocate();return e.id=++this.m_lastProxyId,this.m_nodes[e.id]=e,e},s.prototype.freeNode=function(e){delete this.m_nodes[e.id],i8.release(e)},s.prototype.createProxy=function(e,i){var n=this.allocateNode();return n.aabb.set(e),vr.extend(n.aabb,wt.aabbExtension),n.userData=i,n.height=0,this.insertLeaf(n),n.id},s.prototype.destroyProxy=function(e){var i=this.m_nodes[e];this.removeLeaf(i),this.freeNode(i)},s.prototype.moveProxy=function(e,i,n){var r=this.m_nodes[e];return r.aabb.contains(i)?!1:(this.removeLeaf(r),r.aabb.set(i),i=r.aabb,vr.extend(i,wt.aabbExtension),n.x<0?i.lowerBound.x+=n.x*wt.aabbMultiplier:i.upperBound.x+=n.x*wt.aabbMultiplier,n.y<0?i.lowerBound.y+=n.y*wt.aabbMultiplier:i.upperBound.y+=n.y*wt.aabbMultiplier,this.insertLeaf(r),!0)},s.prototype.insertLeaf=function(e){if(this.m_root==null){this.m_root=e,this.m_root.parent=null;return}for(var i=e.aabb,n=this.m_root;!n.isLeaf();){var r=n.child1,o=n.child2,a=n.aabb.getPerimeter(),l=vr.combinedPerimeter(n.aabb,i),h=2*l,d=2*(l-a),f=vr.combinedPerimeter(i,r.aabb),p=f+d;if(!r.isLeaf()){var g=r.aabb.getPerimeter();p-=g}var y=vr.combinedPerimeter(i,o.aabb),x=y+d;if(!o.isLeaf()){var g=o.aabb.getPerimeter();x-=g}if(h<p&&h<x)break;p<x?n=r:n=o}var _=n,w=_.parent,O=this.allocateNode();for(O.parent=w,O.userData=null,O.aabb.combine(i,_.aabb),O.height=_.height+1,w!=null?(w.child1===_?w.child1=O:w.child2=O,O.child1=_,O.child2=e,_.parent=O,e.parent=O):(O.child1=_,O.child2=e,_.parent=O,e.parent=O,this.m_root=O),n=e.parent;n!=null;){n=this.balance(n);var r=n.child1,o=n.child2;n.height=1+xa(r.height,o.height),n.aabb.combine(r.aabb,o.aabb),n=n.parent}},s.prototype.removeLeaf=function(e){if(e===this.m_root){this.m_root=null;return}var i=e.parent,n=i.parent,r;if(i.child1===e?r=i.child2:r=i.child1,n!=null){n.child1===i?n.child1=r:n.child2=r,r.parent=n,this.freeNode(i);for(var o=n;o!=null;){o=this.balance(o);var a=o.child1,l=o.child2;o.aabb.combine(a.aabb,l.aabb),o.height=1+xa(a.height,l.height),o=o.parent}}else this.m_root=r,r.parent=null,this.freeNode(i)},s.prototype.balance=function(e){var i=e;if(i.isLeaf()||i.height<2)return e;var n=i.child1,r=i.child2,o=r.height-n.height;if(o>1){var a=r.child1,l=r.child2;return r.child1=i,r.parent=i.parent,i.parent=r,r.parent!=null?r.parent.child1===e?r.parent.child1=r:r.parent.child2=r:this.m_root=r,a.height>l.height?(r.child2=a,i.child2=l,l.parent=i,i.aabb.combine(n.aabb,l.aabb),r.aabb.combine(i.aabb,a.aabb),i.height=1+xa(n.height,l.height),r.height=1+xa(i.height,a.height)):(r.child2=l,i.child2=a,a.parent=i,i.aabb.combine(n.aabb,a.aabb),r.aabb.combine(i.aabb,l.aabb),i.height=1+xa(n.height,a.height),r.height=1+xa(i.height,l.height)),r}if(o<-1){var h=n.child1,d=n.child2;return n.child1=i,n.parent=i.parent,i.parent=n,n.parent!=null?n.parent.child1===i?n.parent.child1=n:n.parent.child2=n:this.m_root=n,h.height>d.height?(n.child2=h,i.child1=d,d.parent=i,i.aabb.combine(r.aabb,d.aabb),n.aabb.combine(i.aabb,h.aabb),i.height=1+xa(r.height,d.height),n.height=1+xa(i.height,h.height)):(n.child2=d,i.child1=h,h.parent=i,i.aabb.combine(r.aabb,h.aabb),n.aabb.combine(i.aabb,d.aabb),i.height=1+xa(r.height,h.height),n.height=1+xa(i.height,d.height)),n}return i},s.prototype.getHeight=function(){return this.m_root==null?0:this.m_root.height},s.prototype.getAreaRatio=function(){if(this.m_root==null)return 0;for(var e=this.m_root,i=e.aabb.getPerimeter(),n=0,r,o=this.iteratorPool.allocate().preorder(this.m_root);r=o.next();)r.height<0||(n+=r.aabb.getPerimeter());return this.iteratorPool.release(o),n/i},s.prototype.computeHeight=function(e){var i;if(typeof e<"u"?i=this.m_nodes[e]:i=this.m_root,i.isLeaf())return 0;var n=this.computeHeight(i.child1.id),r=this.computeHeight(i.child2.id);return 1+xa(n,r)},s.prototype.validateStructure=function(e){if(e!=null){this.m_root;var i=e.child1,n=e.child2;e.isLeaf()||(this.validateStructure(i),this.validateStructure(n))}},s.prototype.validateMetrics=function(e){if(e!=null){var i=e.child1,n=e.child2;if(!e.isLeaf()){i.height,n.height;var r=new vr;r.combine(i.aabb,n.aabb),this.validateMetrics(i),this.validateMetrics(n)}}},s.prototype.validate=function(){},s.prototype.getMaxBalance=function(){for(var e=0,i,n=this.iteratorPool.allocate().preorder(this.m_root);i=n.next();)if(!(i.height<=1)){var r=t8(i.child2.height-i.child1.height);e=xa(e,r)}return this.iteratorPool.release(n),e},s.prototype.rebuildBottomUp=function(){for(var e=[],i=0,n,r=this.iteratorPool.allocate().preorder(this.m_root);n=r.next();)n.height<0||(n.isLeaf()?(n.parent=null,e[i]=n,++i):this.freeNode(n));for(this.iteratorPool.release(r);i>1;){for(var o=1/0,a=-1,l=-1,h=0;h<i;++h)for(var d=e[h].aabb,f=h+1;f<i;++f){var p=e[f].aabb,g=vr.combinedPerimeter(d,p);g<o&&(a=h,l=f,o=g)}var y=e[a],x=e[l],_=this.allocateNode();_.child1=y,_.child2=x,_.height=1+xa(y.height,x.height),_.aabb.combine(y.aabb,x.aabb),_.parent=null,y.parent=_,x.parent=_,e[l]=e[i-1],e[a]=_,--i}this.m_root=e[0]},s.prototype.shiftOrigin=function(e){for(var i,n=this.iteratorPool.allocate().preorder(this.m_root);i=n.next();){var r=i.aabb;r.lowerBound.x-=e.x,r.lowerBound.y-=e.y,r.upperBound.x-=e.x,r.upperBound.y-=e.y}this.iteratorPool.release(n)},s.prototype.query=function(e,i){var n=this.stackPool.allocate();for(n.push(this.m_root);n.length>0;){var r=n.pop();if(r!=null&&vr.testOverlap(r.aabb,e))if(r.isLeaf()){var o=i(r.id);if(o===!1)return}else n.push(r.child1),n.push(r.child2)}this.stackPool.release(n)},s.prototype.rayCast=function(e,i){var n=e.p1,r=e.p2,o=$.sub(r,n);o.normalize();var a=$.crossNumVec2(1,o),l=$.abs(a),h=e.maxFraction,d=new vr,f=$.combine(1-h,n,h,r);d.combinePoints(n,f);var p=this.stackPool.allocate(),g=this.inputPool.allocate();for(p.push(this.m_root);p.length>0;){var y=p.pop();if(y!=null&&vr.testOverlap(y.aabb,d)!==!1){var x=y.aabb.getCenter(),_=y.aabb.getExtents(),w=t8($.dot(a,$.sub(n,x)))-$.dot(l,_);if(!(w>0))if(y.isLeaf()){g.p1=$.clone(e.p1),g.p2=$.clone(e.p2),g.maxFraction=h;var O=i(g,y.id);if(O===0)break;O>0&&(h=O,f=$.combine(1-h,n,h,r),d.combinePoints(n,f))}else p.push(y.child1),p.push(y.child2)}}this.stackPool.release(p),this.inputPool.release(g)},s}(),OXe=function(){function s(){this.parents=[],this.states=[]}return s.prototype.preorder=function(e){return this.parents.length=0,this.parents.push(e),this.states.length=0,this.states.push(0),this},s.prototype.next=function(){for(;this.parents.length>0;){var e=this.parents.length-1,i=this.parents[e];if(this.states[e]===0)return this.states[e]=1,i;if(this.states[e]===1&&(this.states[e]=2,i.child1))return this.parents.push(i.child1),this.states.push(1),i.child1;if(this.states[e]===2&&(this.states[e]=3,i.child2))return this.parents.push(i.child2),this.states.push(1),i.child2;this.parents.pop(),this.states.pop()}},s.prototype.close=function(){this.parents.length=0},s}(),SXe=Math.max,CXe=Math.min,TXe=function(){function s(){var e=this;this.m_tree=new wXe,this.m_moveBuffer=[],this.query=function(i,n){e.m_tree.query(i,n)},this.queryCallback=function(i){if(i===e.m_queryProxyId)return!0;var n=CXe(i,e.m_queryProxyId),r=SXe(i,e.m_queryProxyId),o=e.m_tree.getUserData(n),a=e.m_tree.getUserData(r);return e.m_callback(o,a),!0}}return s.prototype.getUserData=function(e){return this.m_tree.getUserData(e)},s.prototype.testOverlap=function(e,i){var n=this.m_tree.getFatAABB(e),r=this.m_tree.getFatAABB(i);return vr.testOverlap(n,r)},s.prototype.getFatAABB=function(e){return this.m_tree.getFatAABB(e)},s.prototype.getProxyCount=function(){return this.m_moveBuffer.length},s.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},s.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},s.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},s.prototype.rayCast=function(e,i){this.m_tree.rayCast(e,i)},s.prototype.shiftOrigin=function(e){this.m_tree.shiftOrigin(e)},s.prototype.createProxy=function(e,i){var n=this.m_tree.createProxy(e,i);return this.bufferMove(n),n},s.prototype.destroyProxy=function(e){this.unbufferMove(e),this.m_tree.destroyProxy(e)},s.prototype.moveProxy=function(e,i,n){var r=this.m_tree.moveProxy(e,i,n);r&&this.bufferMove(e)},s.prototype.touchProxy=function(e){this.bufferMove(e)},s.prototype.bufferMove=function(e){this.m_moveBuffer.push(e)},s.prototype.unbufferMove=function(e){for(var i=0;i<this.m_moveBuffer.length;++i)this.m_moveBuffer[i]===e&&(this.m_moveBuffer[i]=null)},s.prototype.updatePairs=function(e){for(this.m_callback=e;this.m_moveBuffer.length>0;)if(this.m_queryProxyId=this.m_moveBuffer.pop(),this.m_queryProxyId!==null){var i=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(i,this.queryCallback)}},s}(),JJ=Math.sin,eee=Math.cos,sN=Math.sqrt;function ze(s,e){return{x:s,y:e}}function AXe(s){return{s:JJ(s),c:eee(s)}}function br(s,e,i){return s.x=e,s.y=i,s}function Pe(s,e){return s.x=e.x,s.y=e.y,s}function oi(s){return s.x=0,s.y=0,s}function ab(s){return s.x=-s.x,s.y=-s.y,s}function nl(s,e){return s.x+=e.x,s.y+=e.y,s}function EXe(s,e,i){return s.x=e.x+i.x,s.y=e.x+i.y,s}function zh(s,e){return s.x-=e.x,s.y-=e.y,s}function wi(s,e,i){return s.x=e.x-i.x,s.y=e.y-i.y,s}function n8(s,e){return s.x*=e,s.y*=e,s}function ui(s,e,i){return s.x=e*i.x,s.y=e*i.y,s}function ql(s,e,i){return s.x+=e*i.x,s.y+=e*i.y,s}function Lx(s,e,i){return s.x-=e*i.x,s.y-=e*i.y,s}function qn(s,e,i,n,r){return s.x=e*i.x+n*r.x,s.y=e*i.y+n*r.y,s}function Lc(s,e,i,n,r,o,a){return s.x=e*i.x+n*r.x+o*a.x,s.y=e*i.y+n*r.y+o*a.y,s}function MXe(s){var e=sN(s.x*s.x+s.y*s.y);if(e!==0){var i=1/e;s.x*=i,s.y*=i}return e}function ec(s){var e=sN(s.x*s.x+s.y*s.y);if(e>0){var i=1/e;s.x*=i,s.y*=i}return s}function im(s,e,i){var n=i*e.y,r=-i*e.x;return s.x=n,s.y=r,s}function Oa(s,e,i){var n=-e*i.y,r=e*i.x;return s.x=n,s.y=r,s}function Ri(s,e){return s.x*e.y-s.y*e.x}function st(s,e){return s.x*e.x+s.y*e.y}function nm(s){return s.x*s.x+s.y*s.y}function tee(s,e){var i=s.x-e.x,n=s.y-e.y;return sN(i*i+n*n)}function sm(s,e){var i=s.x-e.x,n=s.y-e.y;return i*i+n*n}function kXe(s,e){return s.c=eee(e),s.s=JJ(e),s}function fl(s,e,i){return s.x=e.c*i.x-e.s*i.y,s.y=e.s*i.x+e.c*i.y,s}function _0(s,e,i){var n=e.c*i.x+e.s*i.y,r=-e.s*i.x+e.c*i.y;return s.x=n,s.y=r,s}function PXe(s,e,i,n){var r=e.c*n.x+e.s*n.y,o=-e.s*n.x+e.c*n.y,a=i.c*r-i.s*o,l=i.s*r+i.c*o;return s.x=a,s.y=l,s}function Lm(s,e,i){return{p:ze(s,e),q:AXe(i)}}function BT(s,e){return s.p.x=e.p.x,s.p.y=e.p.y,s.q.s=e.q.s,s.q.c=e.q.c,s}function bi(s,e,i){var n=e.q.c*i.x-e.q.s*i.y+e.p.x,r=e.q.s*i.x+e.q.c*i.y+e.p.y;return s.x=n,s.y=r,s}function rN(s,e,i){var n=i.x-e.p.x,r=i.y-e.p.y,o=e.q.c*n+e.q.s*r,a=-e.q.s*n+e.q.c*r;return s.x=o,s.y=a,s}function iee(s,e,i,n){var r=e.q.c*n.x-e.q.s*n.y+e.p.x,o=e.q.s*n.x+e.q.c*n.y+e.p.y,a=r-i.p.x,l=o-i.p.y,h=i.q.c*a+i.q.s*l,d=-i.q.s*a+i.q.c*l;return s.x=h,s.y=d,s}function nee(s,e,i){var n=e.q.c*i.q.c+e.q.s*i.q.s,r=e.q.c*i.q.s-e.q.s*i.q.c,o=e.q.c*(i.p.x-e.p.x)+e.q.s*(i.p.y-e.p.y),a=-e.q.s*(i.p.x-e.p.x)+e.q.c*(i.p.y-e.p.y);return s.q.c=n,s.q.s=r,s.p.x=o,s.p.y=a,s}var s8=Math.sin,r8=Math.cos,IXe=Math.atan2,Ye=function(){function s(e){if(!(this instanceof s))return new s(e);typeof e=="number"?this.setAngle(e):typeof e=="object"?this.setRot(e):this.setIdentity()}return s.neo=function(e){var i=Object.create(s.prototype);return i.setAngle(e),i},s.clone=function(e){var i=Object.create(s.prototype);return i.s=e.s,i.c=e.c,i},s.identity=function(){var e=Object.create(s.prototype);return e.s=0,e.c=1,e},s.isValid=function(e){return e===null||typeof e>"u"?!1:Number.isFinite(e.s)&&Number.isFinite(e.c)},s.assert=function(e){},s.prototype.setIdentity=function(){this.s=0,this.c=1},s.prototype.set=function(e){typeof e=="object"?(this.s=e.s,this.c=e.c):(this.s=s8(e),this.c=r8(e))},s.prototype.setRot=function(e){this.s=e.s,this.c=e.c},s.prototype.setAngle=function(e){this.s=s8(e),this.c=r8(e)},s.prototype.getAngle=function(){return IXe(this.s,this.c)},s.prototype.getXAxis=function(){return $.neo(this.c,this.s)},s.prototype.getYAxis=function(){return $.neo(-this.s,this.c)},s.mul=function(e,i){if("c"in i&&"s"in i){var n=s.identity();return n.s=e.s*i.c+e.c*i.s,n.c=e.c*i.c-e.s*i.s,n}else if("x"in i&&"y"in i)return $.neo(e.c*i.x-e.s*i.y,e.s*i.x+e.c*i.y)},s.mulRot=function(e,i){var n=s.identity();return n.s=e.s*i.c+e.c*i.s,n.c=e.c*i.c-e.s*i.s,n},s.mulVec2=function(e,i){return $.neo(e.c*i.x-e.s*i.y,e.s*i.x+e.c*i.y)},s.mulSub=function(e,i,n){var r=e.c*(i.x-n.x)-e.s*(i.y-n.y),o=e.s*(i.x-n.x)+e.c*(i.y-n.y);return $.neo(r,o)},s.mulT=function(e,i){if("c"in i&&"s"in i){var n=s.identity();return n.s=e.c*i.s-e.s*i.c,n.c=e.c*i.c+e.s*i.s,n}else if("x"in i&&"y"in i)return $.neo(e.c*i.x+e.s*i.y,-e.s*i.x+e.c*i.y)},s.mulTRot=function(e,i){var n=s.identity();return n.s=e.c*i.s-e.s*i.c,n.c=e.c*i.c+e.s*i.s,n},s.mulTVec2=function(e,i){return $.neo(e.c*i.x+e.s*i.y,-e.s*i.x+e.c*i.y)},s}(),BXe=Math.atan2,o8=Math.PI,sp=ze(0,0),Oy=function(){function s(){this.localCenter=$.zero(),this.c=$.zero(),this.a=0,this.alpha0=0,this.c0=$.zero(),this.a0=0}return s.prototype.recycle=function(){oi(this.localCenter),oi(this.c),this.a=0,this.alpha0=0,oi(this.c0),this.a0=0},s.prototype.setTransform=function(e){bi(sp,e,this.localCenter),Pe(this.c,sp),Pe(this.c0,sp),this.a=this.a0=BXe(e.q.s,e.q.c)},s.prototype.setLocalCenter=function(e,i){Pe(this.localCenter,e),bi(sp,i,this.localCenter),Pe(this.c,sp),Pe(this.c0,sp)},s.prototype.getTransform=function(e,i){i===void 0&&(i=0),kXe(e.q,(1-i)*this.a0+i*this.a),qn(e.p,1-i,this.c0,i,this.c),zh(e.p,fl(sp,e.q,this.localCenter))},s.prototype.advance=function(e){var i=(e-this.alpha0)/(1-this.alpha0);qn(this.c0,i,this.c,1-i,this.c0),this.a0=i*this.a+(1-i)*this.a0,this.alpha0=e},s.prototype.forward=function(){this.a0=this.a,Pe(this.c0,this.c)},s.prototype.normalize=function(){var e=KJ(this.a0,-o8,+o8);this.a-=this.a0-e,this.a0=e},s.prototype.set=function(e){Pe(this.localCenter,e.localCenter),Pe(this.c,e.c),this.a=e.a,this.alpha0=e.alpha0,Pe(this.c0,e.c0),this.a0=e.a0},s}(),tc=function(){function s(e,i){if(!(this instanceof s))return new s(e,i);this.p=$.zero(),this.q=Ye.identity(),typeof e<"u"&&this.p.setVec2(e),typeof i<"u"&&this.q.setAngle(i)}return s.clone=function(e){var i=Object.create(s.prototype);return i.p=$.clone(e.p),i.q=Ye.clone(e.q),i},s.neo=function(e,i){var n=Object.create(s.prototype);return n.p=$.clone(e),n.q=Ye.clone(i),n},s.identity=function(){var e=Object.create(s.prototype);return e.p=$.zero(),e.q=Ye.identity(),e},s.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},s.prototype.set=function(e,i){typeof i>"u"?(this.p.set(e.p),this.q.set(e.q)):(this.p.set(e),this.q.set(i))},s.prototype.setNum=function(e,i){this.p.setVec2(e),this.q.setAngle(i)},s.prototype.setTransform=function(e){this.p.setVec2(e.p),this.q.setRot(e.q)},s.isValid=function(e){return e===null||typeof e>"u"?!1:$.isValid(e.p)&&Ye.isValid(e.q)},s.assert=function(e){},s.mul=function(e,i){if(Array.isArray(i)){for(var n=[],r=0;r<i.length;r++)n[r]=s.mul(e,i[r]);return n}else{if("x"in i&&"y"in i)return s.mulVec2(e,i);if("p"in i&&"q"in i)return s.mulXf(e,i)}},s.mulAll=function(e,i){for(var n=[],r=0;r<i.length;r++)n[r]=s.mul(e,i[r]);return n},s.mulFn=function(e){return function(i){return s.mul(e,i)}},s.mulVec2=function(e,i){var n=e.q.c*i.x-e.q.s*i.y+e.p.x,r=e.q.s*i.x+e.q.c*i.y+e.p.y;return $.neo(n,r)},s.mulXf=function(e,i){var n=s.identity();return n.q=Ye.mulRot(e.q,i.q),n.p=$.add(Ye.mulVec2(e.q,i.p),e.p),n},s.mulT=function(e,i){if("x"in i&&"y"in i)return s.mulTVec2(e,i);if("p"in i&&"q"in i)return s.mulTXf(e,i)},s.mulTVec2=function(e,i){var n=i.x-e.p.x,r=i.y-e.p.y,o=e.q.c*n+e.q.s*r,a=-e.q.s*n+e.q.c*r;return $.neo(o,a)},s.mulTXf=function(e,i){var n=s.identity();return n.q.setRot(Ye.mulTRot(e.q,i.q)),n.p.setVec2(Ye.mulTVec2(e.q,$.sub(i.p,e.p))),n},s}(),RXe=function(){function s(){this.v=$.zero(),this.w=0}return s}(),see=Math.sin,ree=Math.cos,DXe=function(){function s(){this.c=$.zero(),this.a=0}return s.prototype.getTransform=function(e,i){return e.q.c=ree(this.a),e.q.s=see(this.a),e.p.x=this.c.x-(e.q.c*i.x-e.q.s*i.y),e.p.y=this.c.y-(e.q.s*i.x+e.q.c*i.y),e},s}();function KO(s,e,i,n){return s.q.c=ree(n),s.q.s=see(n),s.p.x=i.x-(s.q.c*e.x-s.q.s*e.y),s.p.y=i.y-(s.q.s*e.x+s.q.c*e.y),s}var Nm=function(){function s(){this.style={},this.appData={}}return s.isValid=function(e){return e===null||typeof e>"u"?!1:typeof e.m_type=="string"&&typeof e.m_radius=="number"},s}(),a8=new vr,l8=new vr,c8=ze(0,0),LXe={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535},h8=function(){function s(e,i){this.aabb=new vr,this.fixture=e,this.childIndex=i}return s}(),RT=function(){function s(e,i,n){this.style={},this.appData={},i.shape?(n=i,i=i.shape):typeof n=="number"&&(n={density:n}),n=Fa(n,LXe),this.m_body=e,this.m_friction=n.friction,this.m_restitution=n.restitution,this.m_density=n.density,this.m_isSensor=n.isSensor,this.m_filterGroupIndex=n.filterGroupIndex,this.m_filterCategoryBits=n.filterCategoryBits,this.m_filterMaskBits=n.filterMaskBits,this.m_shape=i,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0;for(var r=this.m_shape.getChildCount(),o=0;o<r;++o)this.m_proxies[o]=new h8(this,o);this.m_userData=n.userData,typeof n.style=="object"&&n.style!==null&&(this.style=n.style)}return s.prototype._reset=function(){var e=this.getBody(),i=e.m_world.m_broadPhase;this.destroyProxies(i),this.m_shape._reset&&this.m_shape._reset();for(var n=this.m_shape.getChildCount(),r=0;r<n;++r)this.m_proxies[r]=new h8(this,r);this.createProxies(i,e.m_xf),e.resetMassData()},s.prototype._serialize=function(){return{friction:this.m_friction,restitution:this.m_restitution,density:this.m_density,isSensor:this.m_isSensor,filterGroupIndex:this.m_filterGroupIndex,filterCategoryBits:this.m_filterCategoryBits,filterMaskBits:this.m_filterMaskBits,shape:this.m_shape}},s._deserialize=function(e,i,n){var r=n(Nm,e.shape),o=r&&new s(i,r,e);return o},s.prototype.getType=function(){return this.m_shape.m_type},s.prototype.getShape=function(){return this.m_shape},s.prototype.isSensor=function(){return this.m_isSensor},s.prototype.setSensor=function(e){e!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=e)},s.prototype.getUserData=function(){return this.m_userData},s.prototype.setUserData=function(e){this.m_userData=e},s.prototype.getBody=function(){return this.m_body},s.prototype.getNext=function(){return this.m_next},s.prototype.getDensity=function(){return this.m_density},s.prototype.setDensity=function(e){this.m_density=e},s.prototype.getFriction=function(){return this.m_friction},s.prototype.setFriction=function(e){this.m_friction=e},s.prototype.getRestitution=function(){return this.m_restitution},s.prototype.setRestitution=function(e){this.m_restitution=e},s.prototype.testPoint=function(e){return this.m_shape.testPoint(this.m_body.getTransform(),e)},s.prototype.rayCast=function(e,i,n){return this.m_shape.rayCast(e,i,this.m_body.getTransform(),n)},s.prototype.getMassData=function(e){this.m_shape.computeMass(e,this.m_density)},s.prototype.getAABB=function(e){return this.m_proxies[e].aabb},s.prototype.createProxies=function(e,i){this.m_proxyCount=this.m_shape.getChildCount();for(var n=0;n<this.m_proxyCount;++n){var r=this.m_proxies[n];this.m_shape.computeAABB(r.aabb,i,n),r.proxyId=e.createProxy(r.aabb,r)}},s.prototype.destroyProxies=function(e){for(var i=0;i<this.m_proxyCount;++i){var n=this.m_proxies[i];e.destroyProxy(n.proxyId),n.proxyId=null}this.m_proxyCount=0},s.prototype.synchronize=function(e,i,n){for(var r=0;r<this.m_proxyCount;++r){var o=this.m_proxies[r];this.m_shape.computeAABB(a8,i,o.childIndex),this.m_shape.computeAABB(l8,n,o.childIndex),o.aabb.combine(a8,l8),wi(c8,n.p,i.p),e.moveProxy(o.proxyId,o.aabb,c8)}},s.prototype.setFilterData=function(e){this.m_filterGroupIndex=e.groupIndex,this.m_filterCategoryBits=e.categoryBits,this.m_filterMaskBits=e.maskBits,this.refilter()},s.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},s.prototype.setFilterGroupIndex=function(e){this.m_filterGroupIndex=e,this.refilter()},s.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},s.prototype.setFilterCategoryBits=function(e){this.m_filterCategoryBits=e,this.refilter()},s.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},s.prototype.setFilterMaskBits=function(e){this.m_filterMaskBits=e,this.refilter()},s.prototype.refilter=function(){if(this.m_body!=null){for(var e=this.m_body.getContactList();e;){var i=e.contact,n=i.getFixtureA(),r=i.getFixtureB();(n==this||r==this)&&i.flagForFiltering(),e=e.next}var o=this.m_body.getWorld();if(o!=null)for(var a=o.m_broadPhase,l=0;l<this.m_proxyCount;++l)a.touchProxy(this.m_proxies[l].proxyId)}},s.prototype.shouldCollide=function(e){if(e.m_filterGroupIndex===this.m_filterGroupIndex&&e.m_filterGroupIndex!==0)return e.m_filterGroupIndex>0;var i=(e.m_filterMaskBits&this.m_filterCategoryBits)!==0,n=(e.m_filterCategoryBits&this.m_filterMaskBits)!==0,r=i&&n;return r},s}(),l0="static",u8="kinematic",Ll="dynamic",JO=ze(0,0),rp=ze(0,0),eS=ze(0,0),tS=ze(0,0),d8=Lm(0,0,0),NXe={type:l0,position:$.zero(),angle:0,linearVelocity:$.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null},pn=function(){function s(e,i){this.style={},this.appData={},i=Fa(i,NXe),this.m_world=e,this.m_awakeFlag=i.awake,this.m_autoSleepFlag=i.allowSleep,this.m_bulletFlag=i.bullet,this.m_fixedRotationFlag=i.fixedRotation,this.m_activeFlag=i.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_userData=i.userData,this.m_type=i.type,this.m_type==Ll?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_xf=tc.identity(),this.m_xf.p.setVec2(i.position),this.m_xf.q.setAngle(i.angle),this.m_sweep=new Oy,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new RXe,this.c_position=new DXe,this.m_force=$.zero(),this.m_torque=0,this.m_linearVelocity=$.clone(i.linearVelocity),this.m_angularVelocity=i.angularVelocity,this.m_linearDamping=i.linearDamping,this.m_angularDamping=i.angularDamping,this.m_gravityScale=i.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1,typeof i.style=="object"&&i.style!==null&&(this.style=i.style)}return s.prototype._serialize=function(){for(var e=[],i=this.m_fixtureList;i;i=i.m_next)e.push(i);return{type:this.m_type,bullet:this.m_bulletFlag,position:this.m_xf.p,angle:this.m_xf.q.getAngle(),linearVelocity:this.m_linearVelocity,angularVelocity:this.m_angularVelocity,fixtures:e}},s._deserialize=function(e,i,n){var r=new s(i,e);if(e.fixtures)for(var o=e.fixtures.length-1;o>=0;o--){var a=n(RT,e.fixtures[o],r);r._addFixture(a)}return r},s.prototype.isWorldLocked=function(){return!!(this.m_world&&this.m_world.isLocked())},s.prototype.getWorld=function(){return this.m_world},s.prototype.getNext=function(){return this.m_next},s.prototype.setUserData=function(e){this.m_userData=e},s.prototype.getUserData=function(){return this.m_userData},s.prototype.getFixtureList=function(){return this.m_fixtureList},s.prototype.getJointList=function(){return this.m_jointList},s.prototype.getContactList=function(){return this.m_contactList},s.prototype.isStatic=function(){return this.m_type==l0},s.prototype.isDynamic=function(){return this.m_type==Ll},s.prototype.isKinematic=function(){return this.m_type==u8},s.prototype.setStatic=function(){return this.setType(l0),this},s.prototype.setDynamic=function(){return this.setType(Ll),this},s.prototype.setKinematic=function(){return this.setType(u8),this},s.prototype.getType=function(){return this.m_type},s.prototype.setType=function(e){if(this.isWorldLocked()!=!0&&this.m_type!=e){this.m_type=e,this.resetMassData(),this.m_type==l0&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;for(var i=this.m_contactList;i;){var n=i;i=i.next,this.m_world.destroyContact(n.contact)}this.m_contactList=null;for(var r=this.m_world.m_broadPhase,o=this.m_fixtureList;o;o=o.m_next)for(var a=0;a<o.m_proxyCount;++a)r.touchProxy(o.m_proxies[a].proxyId)}},s.prototype.isBullet=function(){return this.m_bulletFlag},s.prototype.setBullet=function(e){this.m_bulletFlag=!!e},s.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},s.prototype.setSleepingAllowed=function(e){this.m_autoSleepFlag=!!e,this.m_autoSleepFlag==!1&&this.setAwake(!0)},s.prototype.isAwake=function(){return this.m_awakeFlag},s.prototype.setAwake=function(e){e?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},s.prototype.isActive=function(){return this.m_activeFlag},s.prototype.setActive=function(e){if(e!=this.m_activeFlag)if(this.m_activeFlag=!!e,this.m_activeFlag){for(var i=this.m_world.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.createProxies(i,this.m_xf);this.m_world.m_newFixture=!0}else{for(var i=this.m_world.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.destroyProxies(i);for(var r=this.m_contactList;r;){var o=r;r=r.next,this.m_world.destroyContact(o.contact)}this.m_contactList=null}},s.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},s.prototype.setFixedRotation=function(e){this.m_fixedRotationFlag!=e&&(this.m_fixedRotationFlag=!!e,this.m_angularVelocity=0,this.resetMassData())},s.prototype.getTransform=function(){return this.m_xf},s.prototype.setTransform=function(e,i){if(this.isWorldLocked()!=!0){typeof i=="number"?this.m_xf.setNum(e,i):this.m_xf.setTransform(e),this.m_sweep.setTransform(this.m_xf);for(var n=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.synchronize(n,this.m_xf,this.m_xf);this.setAwake(!0)}},s.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1)},s.prototype.synchronizeFixtures=function(){this.m_sweep.getTransform(d8,0);for(var e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.synchronize(e,d8,this.m_xf)},s.prototype.advance=function(e){this.m_sweep.advance(e),Pe(this.m_sweep.c,this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},s.prototype.getPosition=function(){return this.m_xf.p},s.prototype.setPosition=function(e){this.setTransform(e,this.m_sweep.a)},s.prototype.getAngle=function(){return this.m_sweep.a},s.prototype.setAngle=function(e){this.setTransform(this.m_xf.p,e)},s.prototype.getWorldCenter=function(){return this.m_sweep.c},s.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},s.prototype.getLinearVelocity=function(){return this.m_linearVelocity},s.prototype.getLinearVelocityFromWorldPoint=function(e){var i=$.sub(e,this.m_sweep.c);return $.add(this.m_linearVelocity,$.crossNumVec2(this.m_angularVelocity,i))},s.prototype.getLinearVelocityFromLocalPoint=function(e){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(e))},s.prototype.setLinearVelocity=function(e){this.m_type!=l0&&($.dot(e,e)>0&&this.setAwake(!0),this.m_linearVelocity.setVec2(e))},s.prototype.getAngularVelocity=function(){return this.m_angularVelocity},s.prototype.setAngularVelocity=function(e){this.m_type!=l0&&(e*e>0&&this.setAwake(!0),this.m_angularVelocity=e)},s.prototype.getLinearDamping=function(){return this.m_linearDamping},s.prototype.setLinearDamping=function(e){this.m_linearDamping=e},s.prototype.getAngularDamping=function(){return this.m_angularDamping},s.prototype.setAngularDamping=function(e){this.m_angularDamping=e},s.prototype.getGravityScale=function(){return this.m_gravityScale},s.prototype.setGravityScale=function(e){this.m_gravityScale=e},s.prototype.getMass=function(){return this.m_mass},s.prototype.getInertia=function(){return this.m_I+this.m_mass*$.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},s.prototype.getMassData=function(e){e.mass=this.m_mass,e.I=this.getInertia(),Pe(e.center,this.m_sweep.localCenter)},s.prototype.resetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,oi(this.m_sweep.localCenter),this.isStatic()||this.isKinematic()){Pe(this.m_sweep.c0,this.m_xf.p),Pe(this.m_sweep.c,this.m_xf.p),this.m_sweep.a0=this.m_sweep.a;return}oi(rp);for(var e=this.m_fixtureList;e;e=e.m_next)if(e.m_density!=0){var i={mass:0,center:ze(0,0),I:0};e.getMassData(i),this.m_mass+=i.mass,ql(rp,i.mass,i.center),this.m_I+=i.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,ui(rp,this.m_invMass,rp)):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&this.m_fixedRotationFlag==!1?(this.m_I-=this.m_mass*st(rp,rp),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0),Pe(JO,this.m_sweep.c),this.m_sweep.setLocalCenter(rp,this.m_xf),wi(eS,this.m_sweep.c,JO),Oa(tS,this.m_angularVelocity,eS),nl(this.m_linearVelocity,tS)},s.prototype.setMassData=function(e){this.isWorldLocked()!=!0&&this.m_type==Ll&&(this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&this.m_fixedRotationFlag==!1&&(this.m_I=e.I-this.m_mass*st(e.center,e.center),this.m_invI=1/this.m_I),Pe(JO,this.m_sweep.c),this.m_sweep.setLocalCenter(e.center,this.m_xf),wi(eS,this.m_sweep.c,JO),Oa(tS,this.m_angularVelocity,eS),nl(this.m_linearVelocity,tS))},s.prototype.applyForce=function(e,i,n){n===void 0&&(n=!0),this.m_type==Ll&&(n&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(e),this.m_torque+=$.crossVec2Vec2($.sub(i,this.m_sweep.c),e)))},s.prototype.applyForceToCenter=function(e,i){i===void 0&&(i=!0),this.m_type==Ll&&(i&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(e))},s.prototype.applyTorque=function(e,i){i===void 0&&(i=!0),this.m_type==Ll&&(i&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=e))},s.prototype.applyLinearImpulse=function(e,i,n){n===void 0&&(n=!0),this.m_type==Ll&&(n&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,e),this.m_angularVelocity+=this.m_invI*$.crossVec2Vec2($.sub(i,this.m_sweep.c),e)))},s.prototype.applyAngularImpulse=function(e,i){i===void 0&&(i=!0),this.m_type==Ll&&(i&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*e))},s.prototype.shouldCollide=function(e){if(this.m_type!=Ll&&e.m_type!=Ll)return!1;for(var i=this.m_jointList;i;i=i.next)if(i.other==e&&i.joint.m_collideConnected==!1)return!1;return!0},s.prototype._addFixture=function(e){if(this.isWorldLocked()==!0)return null;if(this.m_activeFlag){var i=this.m_world.m_broadPhase;e.createProxies(i,this.m_xf)}return e.m_next=this.m_fixtureList,this.m_fixtureList=e,e.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=!0,e},s.prototype.createFixture=function(e,i){if(this.isWorldLocked()==!0)return null;var n=new RT(this,e,i);return this._addFixture(n),n},s.prototype.destroyFixture=function(e){if(this.isWorldLocked()!=!0){if(this.m_fixtureList===e)this.m_fixtureList=e.m_next;else for(var i=this.m_fixtureList;i!=null;){if(i.m_next===e){i.m_next=e.m_next;break}i=i.m_next}for(var n=this.m_contactList;n;){var r=n.contact;n=n.next;var o=r.getFixtureA(),a=r.getFixtureB();(e==o||e==a)&&this.m_world.destroyContact(r)}if(this.m_activeFlag){var l=this.m_world.m_broadPhase;e.destroyProxies(l)}e.m_body=null,e.m_next=null,this.m_world.publish("remove-fixture",e),this.resetMassData()}},s.prototype.getWorldPoint=function(e){return tc.mulVec2(this.m_xf,e)},s.prototype.getWorldVector=function(e){return Ye.mulVec2(this.m_xf.q,e)},s.prototype.getLocalPoint=function(e){return tc.mulTVec2(this.m_xf,e)},s.prototype.getLocalVector=function(e){return Ye.mulTVec2(this.m_xf.q,e)},s.STATIC="static",s.KINEMATIC="kinematic",s.DYNAMIC="dynamic",s}(),f8=function(){function s(){this.other=null,this.joint=null,this.prev=null,this.next=null}return s}(),Kr=function(){function s(e,i,n){this.m_type="unknown-joint",this.m_prev=null,this.m_next=null,this.m_edgeA=new f8,this.m_edgeB=new f8,this.m_islandFlag=!1,this.style={},this.appData={},i="bodyA"in e?e.bodyA:i,n="bodyB"in e?e.bodyB:n,this.m_bodyA=i,this.m_bodyB=n,this.m_collideConnected=!!e.collideConnected,this.m_userData=e.userData,typeof e.style=="object"&&e.style!==null&&(this.style=e.style)}return s.prototype.isActive=function(){return this.m_bodyA.isActive()&&this.m_bodyB.isActive()},s.prototype.getType=function(){return this.m_type},s.prototype.getBodyA=function(){return this.m_bodyA},s.prototype.getBodyB=function(){return this.m_bodyB},s.prototype.getNext=function(){return this.m_next},s.prototype.getUserData=function(){return this.m_userData},s.prototype.setUserData=function(e){this.m_userData=e},s.prototype.getCollideConnected=function(){return this.m_collideConnected},s.prototype.shiftOrigin=function(e){},s.prototype._resetAnchors=function(e){return this._reset(e)},s}(),as={gjkCalls:0,gjkIters:0,gjkMaxIters:0,toiTime:0,toiMaxTime:0,toiCalls:0,toiIters:0,toiMaxIters:0,toiRootIters:0,toiMaxRootIters:0,toString:function(s){s=typeof s=="string"?s:`
`;var e="";for(var i in this)typeof this[i]!="function"&&typeof this[i]!="object"&&(e+=i+": "+this[i]+s);return e}},VXe=function(){return Date.now()},$Xe=function(s){return Date.now()-s};const p8={now:VXe,diff:$Xe};var UXe=Math.max,iS=ze(0,0),nS=ze(0,0),_a=ze(0,0),sS=ze(0,0),m2=ze(0,0),FXe=ze(0,0),zXe=ze(0,0);as.gjkCalls=0;as.gjkIters=0;as.gjkMaxIters=0;var oN=function(){function s(){this.proxyA=new Sm,this.proxyB=new Sm,this.transformA=tc.identity(),this.transformB=tc.identity(),this.useRadii=!1}return s.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.transformA.setIdentity(),this.transformB.setIdentity(),this.useRadii=!1},s}(),aN=function(){function s(){this.pointA=ze(0,0),this.pointB=ze(0,0),this.distance=0,this.iterations=0}return s.prototype.recycle=function(){oi(this.pointA),oi(this.pointB),this.distance=0,this.iterations=0},s}(),lN=function(){function s(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}return s.prototype.recycle=function(){this.metric=0,this.indexA.length=0,this.indexB.length=0,this.count=0},s}(),Vm=function(s,e,i){++as.gjkCalls;var n=i.proxyA,r=i.proxyB,o=i.transformA,a=i.transformB;Nl.recycle(),Nl.readCache(e,n,o,r,a);for(var l=Nl.m_v,h=wt.maxDistanceIterations,d=[],f=[],p=0,g=0;g<h;){p=Nl.m_count;for(var y=0;y<p;++y)d[y]=l[y].indexA,f[y]=l[y].indexB;if(Nl.solve(),Nl.m_count===3)break;var x=Nl.getSearchDirection();if(nm(x)<ta*ta)break;var _=l[Nl.m_count];_.indexA=n.getSupport(_0(iS,o.q,ui(iS,-1,x))),bi(_.wA,o,n.getVertex(_.indexA)),_.indexB=r.getSupport(_0(iS,a.q,x)),bi(_.wB,a,r.getVertex(_.indexB)),wi(_.w,_.wB,_.wA),++g,++as.gjkIters;for(var w=!1,y=0;y<p;++y)if(_.indexA===d[y]&&_.indexB===f[y]){w=!0;break}if(w)break;++Nl.m_count}if(as.gjkMaxIters=UXe(as.gjkMaxIters,g),Nl.getWitnessPoints(s.pointA,s.pointB),s.distance=tee(s.pointA,s.pointB),s.iterations=g,Nl.writeCache(e),i.useRadii){var O=n.m_radius,T=r.m_radius;if(s.distance>O+T&&s.distance>ta)s.distance-=O+T,wi(nS,s.pointB,s.pointA),ec(nS),ql(s.pointA,O,nS),Lx(s.pointB,T,nS);else{var C=wi(iS,s.pointA,s.pointB);Pe(s.pointA,C),Pe(s.pointB,C),s.distance=0}}},Sm=function(){function s(){this.m_vertices=[],this.m_count=0,this.m_radius=0}return s.prototype.recycle=function(){this.m_vertices.length=0,this.m_count=0,this.m_radius=0},s.prototype.getVertexCount=function(){return this.m_count},s.prototype.getVertex=function(e){return this.m_vertices[e]},s.prototype.getSupport=function(e){for(var i=-1,n=-1/0,r=0;r<this.m_count;++r){var o=st(this.m_vertices[r],e);o>n&&(i=r,n=o)}return i},s.prototype.getSupportVertex=function(e){return this.m_vertices[this.getSupport(e)]},s.prototype.set=function(e,i){e.computeDistanceProxy(this,i)},s.prototype.setVertices=function(e,i,n){this.m_vertices=e,this.m_count=i,this.m_radius=n},s}(),g2=function(){function s(){this.wA=ze(0,0),this.indexA=0,this.wB=ze(0,0),this.indexB=0,this.w=ze(0,0),this.a=0}return s.prototype.recycle=function(){this.indexA=0,this.indexB=0,oi(this.wA),oi(this.wB),oi(this.w),this.a=0},s.prototype.set=function(e){this.indexA=e.indexA,this.indexB=e.indexB,Pe(this.wA,e.wA),Pe(this.wB,e.wB),Pe(this.w,e.w),this.a=e.a},s}(),rS=ze(0,0),cx=ze(0,0),XXe=function(){function s(){this.m_v1=new g2,this.m_v2=new g2,this.m_v3=new g2,this.m_v=[this.m_v1,this.m_v2,this.m_v3]}return s.prototype.recycle=function(){this.m_v1.recycle(),this.m_v2.recycle(),this.m_v3.recycle(),this.m_count=0},s.prototype.toString=function(){return this.m_count===3?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():this.m_count===2?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():this.m_count===1?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},s.prototype.readCache=function(e,i,n,r,o){this.m_count=e.count;for(var a=0;a<this.m_count;++a){var l=this.m_v[a];l.indexA=e.indexA[a],l.indexB=e.indexB[a];var h=i.getVertex(l.indexA),d=r.getVertex(l.indexB);bi(l.wA,n,h),bi(l.wB,o,d),wi(l.w,l.wB,l.wA),l.a=0}if(this.m_count>1){var f=e.metric,p=this.getMetric();(p<.5*f||2*f<p||p<ta)&&(this.m_count=0)}if(this.m_count===0){var l=this.m_v[0];l.indexA=0,l.indexB=0;var h=i.getVertex(0),d=r.getVertex(0);bi(l.wA,n,h),bi(l.wB,o,d),wi(l.w,l.wB,l.wA),l.a=1,this.m_count=1}},s.prototype.writeCache=function(e){e.metric=this.getMetric(),e.count=this.m_count;for(var i=0;i<this.m_count;++i)e.indexA[i]=this.m_v[i].indexA,e.indexB[i]=this.m_v[i].indexB},s.prototype.getSearchDirection=function(){var e=this.m_v1,i=this.m_v2;switch(this.m_v3,this.m_count){case 1:return br(rS,-e.w.x,-e.w.y);case 2:{wi(_a,i.w,e.w);var n=-Ri(_a,e.w);return n>0?br(rS,-_a.y,_a.x):br(rS,_a.y,-_a.x)}default:return oi(rS)}},s.prototype.getClosestPoint=function(){var e=this.m_v1,i=this.m_v2;switch(this.m_v3,this.m_count){case 0:return oi(cx);case 1:return Pe(cx,e.w);case 2:return qn(cx,e.a,e.w,i.a,i.w);case 3:return oi(cx);default:return oi(cx)}},s.prototype.getWitnessPoints=function(e,i){var n=this.m_v1,r=this.m_v2,o=this.m_v3;switch(this.m_count){case 0:break;case 1:Pe(e,n.wA),Pe(i,n.wB);break;case 2:qn(e,n.a,n.wA,r.a,r.wA),qn(i,n.a,n.wB,r.a,r.wB);break;case 3:Lc(e,n.a,n.wA,r.a,r.wA,o.a,o.wA),Pe(i,e);break}},s.prototype.getMetric=function(){switch(this.m_count){case 0:return 0;case 1:return 0;case 2:return tee(this.m_v1.w,this.m_v2.w);case 3:return Ri(wi(FXe,this.m_v2.w,this.m_v1.w),wi(zXe,this.m_v3.w,this.m_v1.w));default:return 0}},s.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3();break}},s.prototype.solve2=function(){var e=this.m_v1.w,i=this.m_v2.w;wi(_a,i,e);var n=-st(e,_a);if(n<=0){this.m_v1.a=1,this.m_count=1;return}var r=st(i,_a);if(r<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.set(this.m_v2);return}var o=1/(r+n);this.m_v1.a=r*o,this.m_v2.a=n*o,this.m_count=2},s.prototype.solve3=function(){var e=this.m_v1.w,i=this.m_v2.w,n=this.m_v3.w;wi(_a,i,e);var r=st(e,_a),o=st(i,_a),a=o,l=-r;wi(sS,n,e);var h=st(e,sS),d=st(n,sS),f=d,p=-h;wi(m2,n,i);var g=st(i,m2),y=st(n,m2),x=y,_=-g,w=Ri(_a,sS),O=w*Ri(i,n),T=w*Ri(n,e),C=w*Ri(e,i);if(l<=0&&p<=0){this.m_v1.a=1,this.m_count=1;return}if(a>0&&l>0&&C<=0){var A=1/(a+l);this.m_v1.a=a*A,this.m_v2.a=l*A,this.m_count=2;return}if(f>0&&p>0&&T<=0){var B=1/(f+p);this.m_v1.a=f*B,this.m_v3.a=p*B,this.m_count=2,this.m_v2.set(this.m_v3);return}if(a<=0&&_<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.set(this.m_v2);return}if(f<=0&&x<=0){this.m_v3.a=1,this.m_count=1,this.m_v1.set(this.m_v3);return}if(x>0&&_>0&&O<=0){var I=1/(x+_);this.m_v2.a=x*I,this.m_v3.a=_*I,this.m_count=2,this.m_v1.set(this.m_v3);return}var R=1/(O+T+C);this.m_v1.a=O*R,this.m_v2.a=T*R,this.m_v3.a=C*R,this.m_count=3},s}(),Nl=new XXe,op=new oN,m8=new lN,y2=new aN,oee=function(s,e,i,n,r,o){return op.recycle(),op.proxyA.set(s,e),op.proxyB.set(i,n),BT(op.transformA,r),BT(op.transformB,o),op.useRadii=!0,y2.recycle(),m8.recycle(),Vm(y2,m8,op),y2.distance<10*ta};Vm.testOverlap=oee;Vm.Input=oN;Vm.Output=aN;Vm.Proxy=Sm;Vm.Cache=lN;(function(){function s(){this.proxyA=new Sm,this.proxyB=new Sm,this.transformA=tc.identity(),this.transformB=tc.identity(),this.translationB=$.zero()}return s.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.transformA.setIdentity(),this.transformB.setIdentity(),oi(this.translationB)},s})();var WXe=Math.abs,oS=Math.max,aee=function(){function s(){this.proxyA=new Sm,this.proxyB=new Sm,this.sweepA=new Oy,this.sweepB=new Oy}return s.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.sweepA.recycle(),this.sweepB.recycle(),this.tMax=-1},s}(),sl;(function(s){s[s.e_unset=-1]="e_unset",s[s.e_unknown=0]="e_unknown",s[s.e_failed=1]="e_failed",s[s.e_overlapped=2]="e_overlapped",s[s.e_touching=3]="e_touching",s[s.e_separated=4]="e_separated"})(sl||(sl={}));var lee=function(){function s(){this.state=sl.e_unset,this.t=-1}return s.prototype.recycle=function(){this.state=sl.e_unset,this.t=-1},s}();as.toiTime=0;as.toiMaxTime=0;as.toiCalls=0;as.toiIters=0;as.toiMaxIters=0;as.toiRootIters=0;as.toiMaxRootIters=0;var $g=new oN,v2=new aN,x2=new lN,Vo=Lm(0,0,0),$o=Lm(0,0,0),hx=ze(0,0),Sc=ze(0,0),Za=ze(0,0),Lo=ze(0,0),aS=ze(0,0),lS=ze(0,0),cS=ze(0,0),hS=ze(0,0),cN=function(s,e){var i=p8.now();++as.toiCalls,s.state=sl.e_unknown,s.t=e.tMax;var n=e.proxyA,r=e.proxyB,o=e.sweepA,a=e.sweepB;o.normalize(),a.normalize();var l=e.tMax,h=n.m_radius+r.m_radius,d=oS(wt.linearSlop,h-3*wt.linearSlop),f=.25*wt.linearSlop,p=0,g=wt.maxTOIIterations,y=0;for(x2.recycle(),$g.proxyA.setVertices(n.m_vertices,n.m_count,n.m_radius),$g.proxyB.setVertices(r.m_vertices,r.m_count,r.m_radius),$g.useRadii=!1;;){if(o.getTransform(Vo,p),a.getTransform($o,p),BT($g.transformA,Vo),BT($g.transformB,$o),Vm(v2,x2,$g),v2.distance<=0){s.state=sl.e_overlapped,s.t=0;break}if(v2.distance<d+f){s.state=sl.e_touching,s.t=p;break}ux.initialize(x2,n,o,r,a,p);for(var x=!1,_=l,w=0;;){var O=ux.findMinSeparation(_);if(O>d+f){s.state=sl.e_separated,s.t=l,x=!0;break}if(O>d-f){p=_;break}var T=ux.evaluate(p);if(T<d-f){s.state=sl.e_failed,s.t=p,x=!0;break}if(T<=d+f){s.state=sl.e_touching,s.t=p,x=!0;break}for(var C=0,A=p,B=_;;){var I=void 0;C&1?I=A+(d-T)*(B-A)/(O-T):I=.5*(A+B),++C,++as.toiRootIters;var R=ux.evaluate(I);if(WXe(R-d)<f){_=I;break}if(R>d?(A=I,T=R):(B=I,O=R),C===50)break}if(as.toiMaxRootIters=oS(as.toiMaxRootIters,C),++w,w===wt.maxPolygonVertices)break}if(++y,++as.toiIters,x)break;if(y===g){s.state=sl.e_failed,s.t=p;break}}as.toiMaxIters=oS(as.toiMaxIters,y);var P=p8.diff(i);as.toiMaxTime=oS(as.toiMaxTime,P),as.toiTime+=P,ux.recycle()},Nc;(function(s){s[s.e_unset=-1]="e_unset",s[s.e_points=1]="e_points",s[s.e_faceA=2]="e_faceA",s[s.e_faceB=3]="e_faceB"})(Nc||(Nc={}));var HXe=function(){function s(){this.m_proxyA=null,this.m_proxyB=null,this.m_sweepA=null,this.m_sweepB=null,this.m_type=Nc.e_unset,this.m_localPoint=ze(0,0),this.m_axis=ze(0,0),this.indexA=-1,this.indexB=-1}return s.prototype.recycle=function(){this.m_proxyA=null,this.m_proxyB=null,this.m_sweepA=null,this.m_sweepB=null,this.m_type=Nc.e_unset,oi(this.m_localPoint),oi(this.m_axis),this.indexA=-1,this.indexB=-1},s.prototype.initialize=function(e,i,n,r,o,a){var l=e.count;if(this.m_proxyA=i,this.m_proxyB=r,this.m_sweepA=n,this.m_sweepB=o,this.m_sweepA.getTransform(Vo,a),this.m_sweepB.getTransform($o,a),l===1){this.m_type=Nc.e_points;var h=this.m_proxyA.getVertex(e.indexA[0]),d=this.m_proxyB.getVertex(e.indexB[0]);bi(Sc,Vo,h),bi(Za,$o,d),wi(this.m_axis,Za,Sc);var f=MXe(this.m_axis);return f}else if(e.indexA[0]===e.indexA[1]){this.m_type=Nc.e_faceB;var p=r.getVertex(e.indexB[0]),g=r.getVertex(e.indexB[1]);im(this.m_axis,wi(hx,g,p),1),ec(this.m_axis),fl(Lo,$o.q,this.m_axis),qn(this.m_localPoint,.5,p,.5,g),bi(Za,$o,this.m_localPoint);var y=i.getVertex(e.indexA[0]),x=tc.mulVec2(Vo,y),f=st(x,Lo)-st(Za,Lo);return f<0&&(ab(this.m_axis),f=-f),f}else{this.m_type=Nc.e_faceA;var _=this.m_proxyA.getVertex(e.indexA[0]),w=this.m_proxyA.getVertex(e.indexA[1]);im(this.m_axis,wi(hx,w,_),1),ec(this.m_axis),fl(Lo,Vo.q,this.m_axis),qn(this.m_localPoint,.5,_,.5,w),bi(Sc,Vo,this.m_localPoint);var O=this.m_proxyB.getVertex(e.indexB[0]);bi(Za,$o,O);var f=st(Za,Lo)-st(Sc,Lo);return f<0&&(ab(this.m_axis),f=-f),f}},s.prototype.compute=function(e,i){switch(this.m_sweepA.getTransform(Vo,i),this.m_sweepB.getTransform($o,i),this.m_type){case Nc.e_points:{e&&(_0(aS,Vo.q,this.m_axis),_0(lS,$o.q,ui(hx,-1,this.m_axis)),this.indexA=this.m_proxyA.getSupport(aS),this.indexB=this.m_proxyB.getSupport(lS)),Pe(cS,this.m_proxyA.getVertex(this.indexA)),Pe(hS,this.m_proxyB.getVertex(this.indexB)),bi(Sc,Vo,cS),bi(Za,$o,hS);var n=st(Za,this.m_axis)-st(Sc,this.m_axis);return n}case Nc.e_faceA:{fl(Lo,Vo.q,this.m_axis),bi(Sc,Vo,this.m_localPoint),e&&(_0(lS,$o.q,ui(hx,-1,Lo)),this.indexA=-1,this.indexB=this.m_proxyB.getSupport(lS)),Pe(hS,this.m_proxyB.getVertex(this.indexB)),bi(Za,$o,hS);var n=st(Za,Lo)-st(Sc,Lo);return n}case Nc.e_faceB:{fl(Lo,$o.q,this.m_axis),bi(Za,$o,this.m_localPoint),e&&(_0(aS,Vo.q,ui(hx,-1,Lo)),this.indexB=-1,this.indexA=this.m_proxyA.getSupport(aS)),Pe(cS,this.m_proxyA.getVertex(this.indexA)),bi(Sc,Vo,cS);var n=st(Sc,Lo)-st(Za,Lo);return n}default:return e&&(this.indexA=-1,this.indexB=-1),0}},s.prototype.findMinSeparation=function(e){return this.compute(!0,e)},s.prototype.evaluate=function(e){return this.compute(!1,e)},s}(),ux=new HXe;cN.Input=aee;cN.Output=lee;var g8=Math.abs,y8=Math.sqrt,uS=Math.min,hN=function(){function s(){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}return s.prototype.reset=function(e){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=e,this.inv_dt=e==0?0:1/e,this.dtRatio=e*this.inv_dt0},s}(),Ug=new hN,Rh=ze(0,0),Tr=ze(0,0),dS=ze(0,0),Fg=new aee,_2=new lee,v8=new Oy,x8=new Oy,_8=new Oy,GXe=function(){function s(e){this.contact=e,this.normals=[],this.tangents=[]}return s.prototype.recycle=function(){this.normals.length=0,this.tangents.length=0},Object.defineProperty(s.prototype,"normalImpulses",{get:function(){var e=this.contact,i=this.normals;i.length=0;for(var n=0;n<e.v_points.length;++n)i.push(e.v_points[n].normalImpulse);return i},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"tangentImpulses",{get:function(){var e=this.contact,i=this.tangents;i.length=0;for(var n=0;n<e.v_points.length;++n)i.push(e.v_points[n].tangentImpulse);return i},enumerable:!1,configurable:!0}),s}(),cee=function(){function s(e){this.m_world=e,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}return s.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},s.prototype.addBody=function(e){this.m_bodies.push(e)},s.prototype.addContact=function(e){this.m_contacts.push(e)},s.prototype.addJoint=function(e){this.m_joints.push(e)},s.prototype.solveWorld=function(e){for(var i=this.m_world,n=i.m_bodyList;n;n=n.m_next)n.m_islandFlag=!1;for(var r=i.m_contactList;r;r=r.m_next)r.m_islandFlag=!1;for(var o=i.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(var a=this.m_stack,l=i.m_bodyList;l;l=l.m_next)if(!l.m_islandFlag&&!(l.isAwake()==!1||l.isActive()==!1)&&!l.isStatic()){for(this.clear(),a.push(l),l.m_islandFlag=!0;a.length>0;){var n=a.pop();if(this.addBody(n),n.m_awakeFlag=!0,!n.isStatic()){for(var h=n.m_contactList;h;h=h.next){var d=h.contact;if(!d.m_islandFlag&&!(d.isEnabled()==!1||d.isTouching()==!1)){var f=d.m_fixtureA.m_isSensor,p=d.m_fixtureB.m_isSensor;if(!(f||p)){this.addContact(d),d.m_islandFlag=!0;var g=h.other;g.m_islandFlag||(a.push(g),g.m_islandFlag=!0)}}}for(var y=n.m_jointList;y;y=y.next)if(y.joint.m_islandFlag!=!0){var g=y.other;g.isActive()!=!1&&(this.addJoint(y.joint),y.joint.m_islandFlag=!0,!g.m_islandFlag&&(a.push(g),g.m_islandFlag=!0))}}}this.solveIsland(e);for(var x=0;x<this.m_bodies.length;++x){var n=this.m_bodies[x];n.isStatic()&&(n.m_islandFlag=!1)}}},s.prototype.solveIsland=function(e){for(var i=this.m_world,n=i.m_gravity,r=i.m_allowSleep,o=e.dt,a=0;a<this.m_bodies.length;++a){var l=this.m_bodies[a];Pe(Rh,l.m_sweep.c);var h=l.m_sweep.a;Pe(Tr,l.m_linearVelocity);var d=l.m_angularVelocity;Pe(l.m_sweep.c0,l.m_sweep.c),l.m_sweep.a0=l.m_sweep.a,l.isDynamic()&&(ql(Tr,o*l.m_gravityScale,n),ql(Tr,o*l.m_invMass,l.m_force),d+=o*l.m_invI*l.m_torque,ui(Tr,1/(1+o*l.m_linearDamping),Tr),d*=1/(1+o*l.m_angularDamping)),Pe(l.c_position.c,Rh),l.c_position.a=h,Pe(l.c_velocity.v,Tr),l.c_velocity.w=d}for(var a=0;a<this.m_contacts.length;++a){var f=this.m_contacts[a];f.initConstraint(e)}for(var a=0;a<this.m_contacts.length;++a){var f=this.m_contacts[a];f.initVelocityConstraint(e)}if(e.warmStarting)for(var a=0;a<this.m_contacts.length;++a){var f=this.m_contacts[a];f.warmStartConstraint(e)}for(var a=0;a<this.m_joints.length;++a){var p=this.m_joints[a];p.initVelocityConstraints(e)}for(var a=0;a<e.velocityIterations;++a){for(var g=0;g<this.m_joints.length;++g){var p=this.m_joints[g];p.solveVelocityConstraints(e)}for(var g=0;g<this.m_contacts.length;++g){var f=this.m_contacts[g];f.solveVelocityConstraint(e)}}for(var a=0;a<this.m_contacts.length;++a){var f=this.m_contacts[a];f.storeConstraintImpulses(e)}for(var a=0;a<this.m_bodies.length;++a){var l=this.m_bodies[a];Pe(Rh,l.c_position.c);var h=l.c_position.a;Pe(Tr,l.c_velocity.v);var d=l.c_velocity.w;ui(dS,o,Tr);var y=nm(dS);if(y>wt.maxTranslationSquared){var x=wt.maxTranslation/y8(y);n8(Tr,x)}var _=o*d;if(_*_>wt.maxRotationSquared){var x=wt.maxRotation/g8(_);d*=x}ql(Rh,o,Tr),h+=o*d,Pe(l.c_position.c,Rh),l.c_position.a=h,Pe(l.c_velocity.v,Tr),l.c_velocity.w=d}for(var w=!1,a=0;a<e.positionIterations;++a){for(var O=0,g=0;g<this.m_contacts.length;++g){var f=this.m_contacts[g],T=f.solvePositionConstraint(e);O=uS(O,T)}for(var C=O>=-3*wt.linearSlop,A=!0,g=0;g<this.m_joints.length;++g){var p=this.m_joints[g],B=p.solvePositionConstraints(e);A=A&&B}if(C&&A){w=!0;break}}for(var a=0;a<this.m_bodies.length;++a){var l=this.m_bodies[a];Pe(l.m_sweep.c,l.c_position.c),l.m_sweep.a=l.c_position.a,Pe(l.m_linearVelocity,l.c_velocity.v),l.m_angularVelocity=l.c_velocity.w,l.synchronizeTransform()}if(this.postSolveIsland(),r){for(var I=1/0,R=wt.linearSleepToleranceSqr,P=wt.angularSleepToleranceSqr,a=0;a<this.m_bodies.length;++a){var l=this.m_bodies[a];l.isStatic()||(l.m_autoSleepFlag==!1||l.m_angularVelocity*l.m_angularVelocity>P||nm(l.m_linearVelocity)>R?(l.m_sleepTime=0,I=0):(l.m_sleepTime+=o,I=uS(I,l.m_sleepTime)))}if(I>=wt.timeToSleep&&w)for(var a=0;a<this.m_bodies.length;++a){var l=this.m_bodies[a];l.setAwake(!1)}}},s.prototype.solveWorldTOI=function(e){var i=this.m_world;if(i.m_stepComplete){for(var n=i.m_bodyList;n;n=n.m_next)n.m_islandFlag=!1,n.m_sweep.alpha0=0;for(var r=i.m_contactList;r;r=r.m_next)r.m_toiFlag=!1,r.m_islandFlag=!1,r.m_toiCount=0,r.m_toi=1}for(;;){for(var o=null,a=1,l=i.m_contactList;l;l=l.m_next)if(l.isEnabled()!=!1&&!(l.m_toiCount>wt.maxSubSteps)){var h=1;if(l.m_toiFlag)h=l.m_toi;else{var d=l.getFixtureA(),f=l.getFixtureB();if(d.isSensor()||f.isSensor())continue;var p=d.getBody(),g=f.getBody(),y=p.isAwake()&&!p.isStatic(),x=g.isAwake()&&!g.isStatic();if(y==!1&&x==!1)continue;var _=p.isBullet()||!p.isDynamic(),w=g.isBullet()||!g.isDynamic();if(_==!1&&w==!1)continue;var O=p.m_sweep.alpha0;p.m_sweep.alpha0<g.m_sweep.alpha0?(O=g.m_sweep.alpha0,p.m_sweep.advance(O)):g.m_sweep.alpha0<p.m_sweep.alpha0&&(O=p.m_sweep.alpha0,g.m_sweep.advance(O));var T=l.getChildIndexA(),C=l.getChildIndexB();p.m_sweep,g.m_sweep,Fg.proxyA.set(d.getShape(),T),Fg.proxyB.set(f.getShape(),C),Fg.sweepA.set(p.m_sweep),Fg.sweepB.set(g.m_sweep),Fg.tMax=1,cN(_2,Fg);var A=_2.t;_2.state==sl.e_touching?h=uS(O+(1-O)*A,1):h=1,l.m_toi=h,l.m_toiFlag=!0}h<a&&(o=l,a=h)}if(o==null||1-10*ta<a){i.m_stepComplete=!0;break}var B=o.getFixtureA(),I=o.getFixtureB(),R=B.getBody(),P=I.getBody();if(x8.set(R.m_sweep),_8.set(P.m_sweep),R.advance(a),P.advance(a),o.update(i),o.m_toiFlag=!1,++o.m_toiCount,o.isEnabled()==!1||o.isTouching()==!1){o.setEnabled(!1),R.m_sweep.set(x8),P.m_sweep.set(_8),R.synchronizeTransform(),P.synchronizeTransform();continue}R.setAwake(!0),P.setAwake(!0),this.clear(),this.addBody(R),this.addBody(P),this.addContact(o),R.m_islandFlag=!0,P.m_islandFlag=!0,o.m_islandFlag=!0;for(var k=[R,P],E=0;E<k.length;++E){var D=k[E];if(D.isDynamic())for(var L=D.m_contactList;L;L=L.next){var V=L.contact;if(!V.m_islandFlag){var F=L.other;if(!(F.isDynamic()&&!D.isBullet()&&!F.isBullet())){var j=V.m_fixtureA.m_isSensor,Q=V.m_fixtureB.m_isSensor;if(!(j||Q)){if(v8.set(F.m_sweep),F.m_islandFlag==!1&&F.advance(a),V.update(i),V.isEnabled()==!1||V.isTouching()==!1){F.m_sweep.set(v8),F.synchronizeTransform();continue}V.m_islandFlag=!0,this.addContact(V),!F.m_islandFlag&&(F.m_islandFlag=!0,F.isStatic()||F.setAwake(!0),this.addBody(F))}}}}}Ug.reset((1-a)*e.dt),Ug.dtRatio=1,Ug.positionIterations=20,Ug.velocityIterations=e.velocityIterations,Ug.warmStarting=!1,this.solveIslandTOI(Ug,R,P);for(var E=0;E<this.m_bodies.length;++E){var D=this.m_bodies[E];if(D.m_islandFlag=!1,!!D.isDynamic()){D.synchronizeFixtures();for(var L=D.m_contactList;L;L=L.next)L.contact.m_toiFlag=!1,L.contact.m_islandFlag=!1}}if(i.findNewContacts(),i.m_subStepping){i.m_stepComplete=!1;break}}},s.prototype.solveIslandTOI=function(e,i,n){for(var f=0;f<this.m_bodies.length;++f){var r=this.m_bodies[f];Pe(r.c_position.c,r.m_sweep.c),r.c_position.a=r.m_sweep.a,Pe(r.c_velocity.v,r.m_linearVelocity),r.c_velocity.w=r.m_angularVelocity}for(var f=0;f<this.m_contacts.length;++f){var o=this.m_contacts[f];o.initConstraint(e)}for(var f=0;f<e.positionIterations;++f){for(var a=0,l=0;l<this.m_contacts.length;++l){var o=this.m_contacts[l],h=o.solvePositionConstraintTOI(e,i,n);a=uS(a,h)}var d=a>=-1.5*wt.linearSlop;if(d)break}var f;Pe(i.m_sweep.c0,i.c_position.c),i.m_sweep.a0=i.c_position.a,Pe(n.m_sweep.c0,n.c_position.c),n.m_sweep.a0=n.c_position.a;for(var f=0;f<this.m_contacts.length;++f){var o=this.m_contacts[f];o.initVelocityConstraint(e)}for(var f=0;f<e.velocityIterations;++f)for(var l=0;l<this.m_contacts.length;++l){var o=this.m_contacts[l];o.solveVelocityConstraint(e)}for(var p=e.dt,f=0;f<this.m_bodies.length;++f){var r=this.m_bodies[f];Pe(Rh,r.c_position.c);var g=r.c_position.a;Pe(Tr,r.c_velocity.v);var y=r.c_velocity.w;ui(dS,p,Tr);var x=nm(dS);if(x>wt.maxTranslationSquared){var _=wt.maxTranslation/y8(x);n8(Tr,_)}var w=p*y;if(w*w>wt.maxRotationSquared){var _=wt.maxRotation/g8(w);y*=_}ql(Rh,p,Tr),g+=p*y,Pe(r.c_position.c,Rh),r.c_position.a=g,Pe(r.c_velocity.v,Tr),r.c_velocity.w=y,Pe(r.m_sweep.c,Rh),r.m_sweep.a=g,Pe(r.m_linearVelocity,Tr),r.m_angularVelocity=y,r.synchronizeTransform()}this.postSolveIsland()},s.prototype.postSolveIsland=function(){for(var e=0;e<this.m_contacts.length;++e){var i=this.m_contacts[e];this.m_world.postSolve(i,i.m_impulse)}},s}();cee.TimeStep=hN;var ic=function(){function s(e,i,n,r){typeof e=="object"&&e!==null?(this.ex=$.clone(e),this.ey=$.clone(i)):typeof e=="number"?(this.ex=$.neo(e,n),this.ey=$.neo(i,r)):(this.ex=$.zero(),this.ey=$.zero())}return s.prototype.toString=function(){return JSON.stringify(this)},s.isValid=function(e){return e===null||typeof e>"u"?!1:$.isValid(e.ex)&&$.isValid(e.ey)},s.assert=function(e){},s.prototype.set=function(e,i,n,r){typeof e=="number"&&typeof i=="number"&&typeof n=="number"&&typeof r=="number"?(this.ex.setNum(e,n),this.ey.setNum(i,r)):typeof e=="object"&&typeof i=="object"?(this.ex.setVec2(e),this.ey.setVec2(i)):typeof e=="object"&&(this.ex.setVec2(e.ex),this.ey.setVec2(e.ey))},s.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},s.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},s.prototype.getInverse=function(){var e=this.ex.x,i=this.ey.x,n=this.ex.y,r=this.ey.y,o=e*r-i*n;o!==0&&(o=1/o);var a=new s;return a.ex.x=o*r,a.ey.x=-o*i,a.ex.y=-o*n,a.ey.y=o*e,a},s.prototype.solve=function(e){var i=this.ex.x,n=this.ey.x,r=this.ex.y,o=this.ey.y,a=i*o-n*r;a!==0&&(a=1/a);var l=$.zero();return l.x=a*(o*e.x-n*e.y),l.y=a*(i*e.y-r*e.x),l},s.mul=function(e,i){if(i&&"x"in i&&"y"in i){var n=e.ex.x*i.x+e.ey.x*i.y,r=e.ex.y*i.x+e.ey.y*i.y;return $.neo(n,r)}else if(i&&"ex"in i&&"ey"in i){var o=e.ex.x*i.ex.x+e.ey.x*i.ex.y,a=e.ex.x*i.ey.x+e.ey.x*i.ey.y,l=e.ex.y*i.ex.x+e.ey.y*i.ex.y,h=e.ex.y*i.ey.x+e.ey.y*i.ey.y;return new s(o,a,l,h)}},s.mulVec2=function(e,i){var n=e.ex.x*i.x+e.ey.x*i.y,r=e.ex.y*i.x+e.ey.y*i.y;return $.neo(n,r)},s.mulMat22=function(e,i){var n=e.ex.x*i.ex.x+e.ey.x*i.ex.y,r=e.ex.x*i.ey.x+e.ey.x*i.ey.y,o=e.ex.y*i.ex.x+e.ey.y*i.ex.y,a=e.ex.y*i.ey.x+e.ey.y*i.ey.y;return new s(n,r,o,a)},s.mulT=function(e,i){if(i&&"x"in i&&"y"in i)return $.neo($.dot(i,e.ex),$.dot(i,e.ey));if(i&&"ex"in i&&"ey"in i){var n=$.neo($.dot(e.ex,i.ex),$.dot(e.ey,i.ex)),r=$.neo($.dot(e.ex,i.ey),$.dot(e.ey,i.ey));return new s(n,r)}},s.mulTVec2=function(e,i){return $.neo($.dot(i,e.ex),$.dot(i,e.ey))},s.mulTMat22=function(e,i){var n=$.neo($.dot(e.ex,i.ex),$.dot(e.ey,i.ex)),r=$.neo($.dot(e.ex,i.ey),$.dot(e.ey,i.ey));return new s(n,r)},s.abs=function(e){return new s($.abs(e.ex),$.abs(e.ey))},s.add=function(e,i){return new s($.add(e.ex,i.ex),$.add(e.ey,i.ey))},s}(),QXe=Math.sqrt,b2=ze(0,0),w2=ze(0,0),dx=ze(0,0),Dh=ze(0,0),Lh=ze(0,0),O2=ze(0,0),fS=ze(0,0),gd=ze(0,0),ys;(function(s){s[s.e_unset=-1]="e_unset",s[s.e_circles=0]="e_circles",s[s.e_faceA=1]="e_faceA",s[s.e_faceB=2]="e_faceB"})(ys||(ys={}));var nn;(function(s){s[s.e_unset=-1]="e_unset",s[s.e_vertex=0]="e_vertex",s[s.e_face=1]="e_face"})(nn||(nn={}));var zp;(function(s){s[s.nullState=0]="nullState",s[s.addState=1]="addState",s[s.persistState=2]="persistState",s[s.removeState=3]="removeState"})(zp||(zp={}));var $a=function(){function s(){this.v=ze(0,0),this.id=new uee}return s.prototype.set=function(e){Pe(this.v,e.v),this.id.set(e.id)},s.prototype.recycle=function(){oi(this.v),this.id.recycle()},s}(),hee=function(){function s(){this.localNormal=ze(0,0),this.localPoint=ze(0,0),this.points=[new b8,new b8],this.pointCount=0}return s.prototype.set=function(e){this.type=e.type,Pe(this.localNormal,e.localNormal),Pe(this.localPoint,e.localPoint),this.pointCount=e.pointCount,this.points[0].set(e.points[0]),this.points[1].set(e.points[1])},s.prototype.recycle=function(){this.type=ys.e_unset,oi(this.localNormal),oi(this.localPoint),this.pointCount=0,this.points[0].recycle(),this.points[1].recycle()},s.prototype.getWorldManifold=function(e,i,n,r,o){if(this.pointCount==0)return e;e=e||new dee,e.pointCount=this.pointCount;var a=e.normal,l=e.points,h=e.separations;switch(this.type){case ys.e_circles:{br(a,1,0);var d=this.points[0];bi(b2,i,this.localPoint),bi(w2,r,d.localPoint),wi(O2,w2,b2);var f=nm(O2);if(f>ta*ta){var p=QXe(f);ui(a,1/p,O2)}qn(Dh,1,b2,n,a),qn(Lh,1,w2,-o,a),qn(l[0],.5,Dh,.5,Lh),h[0]=st(wi(dx,Lh,Dh),a);break}case ys.e_faceA:{fl(a,i.q,this.localNormal),bi(fS,i,this.localPoint);for(var g=0;g<this.pointCount;++g){var d=this.points[g];bi(gd,r,d.localPoint),qn(Dh,1,gd,n-st(wi(dx,gd,fS),a),a),qn(Lh,1,gd,-o,a),qn(l[g],.5,Dh,.5,Lh),h[g]=st(wi(dx,Lh,Dh),a)}break}case ys.e_faceB:{fl(a,r.q,this.localNormal),bi(fS,r,this.localPoint);for(var g=0;g<this.pointCount;++g){var d=this.points[g];bi(gd,i,d.localPoint),qn(Lh,1,gd,o-st(wi(dx,gd,fS),a),a),qn(Dh,1,gd,-n,a),qn(l[g],.5,Dh,.5,Lh),h[g]=st(wi(dx,Dh,Lh),a)}ab(a);break}}return e},s.clipSegmentToLine=lb,s.ClipVertex=$a,s.getPointStates=YXe,s.PointState=zp,s}(),b8=function(){function s(){this.localPoint=ze(0,0),this.normalImpulse=0,this.tangentImpulse=0,this.id=new uee}return s.prototype.set=function(e){Pe(this.localPoint,e.localPoint),this.normalImpulse=e.normalImpulse,this.tangentImpulse=e.tangentImpulse,this.id.set(e.id)},s.prototype.recycle=function(){oi(this.localPoint),this.normalImpulse=0,this.tangentImpulse=0,this.id.recycle()},s}(),uee=function(){function s(){this.key=-1,this.indexA=-1,this.indexB=-1,this.typeA=nn.e_unset,this.typeB=nn.e_unset}return s.prototype.setFeatures=function(e,i,n,r){this.indexA=e,this.indexB=n,this.typeA=i,this.typeB=r,this.key=this.indexA+this.indexB*4+this.typeA*16+this.typeB*64},s.prototype.set=function(e){this.indexA=e.indexA,this.indexB=e.indexB,this.typeA=e.typeA,this.typeB=e.typeB,this.key=this.indexA+this.indexB*4+this.typeA*16+this.typeB*64},s.prototype.swapFeatures=function(){var e=this.indexA,i=this.indexB,n=this.typeA,r=this.typeB;this.indexA=i,this.indexB=e,this.typeA=r,this.typeB=n,this.key=this.indexA+this.indexB*4+this.typeA*16+this.typeB*64},s.prototype.recycle=function(){this.indexA=0,this.indexB=0,this.typeA=nn.e_unset,this.typeB=nn.e_unset,this.key=-1},s}(),dee=function(){function s(){this.normal=ze(0,0),this.points=[ze(0,0),ze(0,0)],this.separations=[0,0],this.pointCount=0}return s.prototype.recycle=function(){oi(this.normal),oi(this.points[0]),oi(this.points[1]),this.separations[0]=0,this.separations[1]=0,this.pointCount=0},s}();function YXe(s,e,i,n){for(var r=0;r<i.pointCount;++r){var o=i.points[r].id;s[r]=zp.removeState;for(var a=0;a<n.pointCount;++a)if(n.points[a].id.key===o.key){s[r]=zp.persistState;break}}for(var r=0;r<n.pointCount;++r){var o=n.points[r].id;e[r]=zp.addState;for(var a=0;a<i.pointCount;++a)if(i.points[a].id.key===o.key){e[r]=zp.persistState;break}}}function lb(s,e,i,n,r){var o=0,a=st(i,e[0].v)-n,l=st(i,e[1].v)-n;if(a<=0&&s[o++].set(e[0]),l<=0&&s[o++].set(e[1]),a*l<0){var h=a/(a-l);qn(s[o].v,1-h,e[0].v,h,e[1].v),s[o].id.setFeatures(r,nn.e_vertex,e[0].id.indexB,nn.e_face),++o}return o}var jXe=Math.sqrt,qXe=Math.max,ZXe=Math.min,w8=new s_({create:function(){return new ah},release:function(s){s.recycle()}}),zg=new hee,pS=new dee,O8=function(){function s(e){this.prev=null,this.next=null,this.other=null,this.contact=e}return s.prototype.recycle=function(){this.prev=null,this.next=null,this.other=null},s}();function S8(s,e){return jXe(s*e)}function C8(s,e){return s>e?s:e}var ap=[],T8=function(){function s(){this.rA=ze(0,0),this.rB=ze(0,0),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}return s.prototype.recycle=function(){oi(this.rA),oi(this.rB),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0},s}(),Nh=ze(0,0),Os=ze(0,0),Vh=ze(0,0),Ss=ze(0,0),yd=ze(0,0),lp=Lm(0,0,0),cp=Lm(0,0,0),mS=ze(0,0),gS=ze(0,0),Xg=ze(0,0),yS=ze(0,0),S2=ze(0,0),C2=ze(0,0),Vs=ze(0,0),bn=ze(0,0),fx=ze(0,0),Ka=ze(0,0),Wg=ze(0,0),Hg=ze(0,0),ba=ze(0,0),$h=ze(0,0),Vn=ze(0,0),Ja=ze(0,0),$s=ze(0,0),Us=ze(0,0),Cc=ze(0,0),ah=function(){function s(){this.m_nodeA=new O8(this),this.m_nodeB=new O8(this),this.m_fixtureA=null,this.m_fixtureB=null,this.m_indexA=-1,this.m_indexB=-1,this.m_evaluateFcn=null,this.m_manifold=new hee,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_impulse=new GXe(this),this.v_points=[new T8,new T8],this.v_normal=ze(0,0),this.v_normalMass=new ic,this.v_K=new ic,this.v_pointCount=0,this.v_tangentSpeed=0,this.v_friction=0,this.v_restitution=0,this.v_invMassA=0,this.v_invMassB=0,this.v_invIA=0,this.v_invIB=0,this.p_localPoints=[ze(0,0),ze(0,0)],this.p_localNormal=ze(0,0),this.p_localPoint=ze(0,0),this.p_localCenterA=ze(0,0),this.p_localCenterB=ze(0,0),this.p_type=ys.e_unset,this.p_radiusA=0,this.p_radiusB=0,this.p_pointCount=0,this.p_invMassA=0,this.p_invMassB=0,this.p_invIA=0,this.p_invIB=0}return s.prototype.initialize=function(e,i,n,r,o){this.m_fixtureA=e,this.m_fixtureB=n,this.m_indexA=i,this.m_indexB=r,this.m_evaluateFcn=o,this.m_friction=S8(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=C8(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},s.prototype.recycle=function(){this.m_nodeA.recycle(),this.m_nodeB.recycle(),this.m_fixtureA=null,this.m_fixtureB=null,this.m_indexA=-1,this.m_indexB=-1,this.m_evaluateFcn=null,this.m_manifold.recycle(),this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_impulse.recycle();for(var e=0,i=this.v_points;e<i.length;e++){var n=i[e];n.recycle()}oi(this.v_normal),this.v_normalMass.setZero(),this.v_K.setZero(),this.v_pointCount=0,this.v_tangentSpeed=0,this.v_friction=0,this.v_restitution=0,this.v_invMassA=0,this.v_invMassB=0,this.v_invIA=0,this.v_invIB=0;for(var r=0,o=this.p_localPoints;r<o.length;r++){var a=o[r];oi(a)}oi(this.p_localNormal),oi(this.p_localPoint),oi(this.p_localCenterA),oi(this.p_localCenterB),this.p_type=ys.e_unset,this.p_radiusA=0,this.p_radiusB=0,this.p_pointCount=0,this.p_invMassA=0,this.p_invMassB=0,this.p_invIA=0,this.p_invIB=0},s.prototype.initConstraint=function(e){var i=this.m_fixtureA,n=this.m_fixtureB;if(!(i===null||n===null)){var r=i.m_body,o=n.m_body;if(!(r===null||o===null)){var a=i.m_shape,l=n.m_shape;if(!(a===null||l===null)){var h=this.m_manifold,d=h.pointCount;this.v_invMassA=r.m_invMass,this.v_invMassB=o.m_invMass,this.v_invIA=r.m_invI,this.v_invIB=o.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=d,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=r.m_invMass,this.p_invMassB=o.m_invMass,this.p_invIA=r.m_invI,this.p_invIB=o.m_invI,Pe(this.p_localCenterA,r.m_sweep.localCenter),Pe(this.p_localCenterB,o.m_sweep.localCenter),this.p_radiusA=a.m_radius,this.p_radiusB=l.m_radius,this.p_type=h.type,Pe(this.p_localNormal,h.localNormal),Pe(this.p_localPoint,h.localPoint),this.p_pointCount=d;for(var f=0;f<wt.maxManifoldPoints;++f)this.v_points[f].recycle(),oi(this.p_localPoints[f]);for(var f=0;f<d;++f){var p=h.points[f],g=this.v_points[f];e.warmStarting&&(g.normalImpulse=e.dtRatio*p.normalImpulse,g.tangentImpulse=e.dtRatio*p.tangentImpulse),Pe(this.p_localPoints[f],p.localPoint)}}}}},s.prototype.getManifold=function(){return this.m_manifold},s.prototype.getWorldManifold=function(e){var i=this.m_fixtureA,n=this.m_fixtureB;if(!(i===null||n===null)){var r=i.m_body,o=n.m_body;if(!(r===null||o===null)){var a=i.m_shape,l=n.m_shape;if(!(a===null||l===null))return this.m_manifold.getWorldManifold(e,r.getTransform(),a.m_radius,o.getTransform(),l.m_radius)}}},s.prototype.setEnabled=function(e){this.m_enabledFlag=!!e},s.prototype.isEnabled=function(){return this.m_enabledFlag},s.prototype.isTouching=function(){return this.m_touchingFlag},s.prototype.getNext=function(){return this.m_next},s.prototype.getFixtureA=function(){return this.m_fixtureA},s.prototype.getFixtureB=function(){return this.m_fixtureB},s.prototype.getChildIndexA=function(){return this.m_indexA},s.prototype.getChildIndexB=function(){return this.m_indexB},s.prototype.flagForFiltering=function(){this.m_filterFlag=!0},s.prototype.setFriction=function(e){this.m_friction=e},s.prototype.getFriction=function(){return this.m_friction},s.prototype.resetFriction=function(){var e=this.m_fixtureA,i=this.m_fixtureB;e===null||i===null||(this.m_friction=S8(e.m_friction,i.m_friction))},s.prototype.setRestitution=function(e){this.m_restitution=e},s.prototype.getRestitution=function(){return this.m_restitution},s.prototype.resetRestitution=function(){var e=this.m_fixtureA,i=this.m_fixtureB;e===null||i===null||(this.m_restitution=C8(e.m_restitution,i.m_restitution))},s.prototype.setTangentSpeed=function(e){this.m_tangentSpeed=e},s.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},s.prototype.evaluate=function(e,i,n){var r=this.m_fixtureA,o=this.m_fixtureB;r===null||o===null||this.m_evaluateFcn(e,i,r,this.m_indexA,n,o,this.m_indexB)},s.prototype.update=function(e){var i=this.m_fixtureA,n=this.m_fixtureB;if(!(i===null||n===null)){var r=i.m_body,o=n.m_body;if(!(r===null||o===null)){var a=i.m_shape,l=n.m_shape;if(!(a===null||l===null)){this.m_enabledFlag=!0;var h=!1,d=this.m_touchingFlag,f=i.m_isSensor,p=n.m_isSensor,g=f||p,y=r.m_xf,x=o.m_xf;if(g)h=oee(a,this.m_indexA,l,this.m_indexB,y,x),this.m_manifold.pointCount=0;else{zg.recycle(),zg.set(this.m_manifold),this.m_manifold.recycle(),this.evaluate(this.m_manifold,y,x),h=this.m_manifold.pointCount>0;for(var _=0;_<this.m_manifold.pointCount;++_){var w=this.m_manifold.points[_];w.normalImpulse=0,w.tangentImpulse=0;for(var O=0;O<zg.pointCount;++O){var T=zg.points[O];if(T.id.key===w.id.key){w.normalImpulse=T.normalImpulse,w.tangentImpulse=T.tangentImpulse;break}}}h!==d&&(r.setAwake(!0),o.setAwake(!0))}this.m_touchingFlag=h;var C=typeof e=="object"&&e!==null;!d&&h&&C&&e.beginContact(this),d&&!h&&C&&e.endContact(this),!g&&h&&C&&zg&&e.preSolve(this,zg)}}}},s.prototype.solvePositionConstraint=function(e){return this._solvePositionConstraint(e,null,null)},s.prototype.solvePositionConstraintTOI=function(e,i,n){return this._solvePositionConstraint(e,i,n)},s.prototype._solvePositionConstraint=function(e,i,n){var r=i!==null&&n!==null,o=0,a=this.m_fixtureA,l=this.m_fixtureB;if(a===null||l===null)return o;var h=a.m_body,d=l.m_body;if(h===null||d===null)return o;h.c_velocity,d.c_velocity;var f=h.c_position,p=d.c_position,g=this.p_localCenterA,y=this.p_localCenterB,x=0,_=0;(!r||h===i||h===n)&&(x=this.p_invMassA,_=this.p_invIA);var w=0,O=0;(!r||d===i||d===n)&&(w=this.p_invMassB,O=this.p_invIB),Pe(Nh,f.c);var T=f.a;Pe(Vh,p.c);for(var C=p.a,A=0;A<this.p_pointCount;++A){KO(lp,g,Nh,T),KO(cp,y,Vh,C);var B=void 0;switch(this.p_type){case ys.e_circles:{bi(mS,lp,this.p_localPoint),bi(gS,cp,this.p_localPoints[0]),wi(bn,gS,mS),ec(bn),qn(fx,.5,mS,.5,gS),B=st(gS,bn)-st(mS,bn)-this.p_radiusA-this.p_radiusB;break}case ys.e_faceA:{fl(bn,lp.q,this.p_localNormal),bi(yS,lp,this.p_localPoint),bi(Xg,cp,this.p_localPoints[A]),B=st(Xg,bn)-st(yS,bn)-this.p_radiusA-this.p_radiusB,Pe(fx,Xg);break}case ys.e_faceB:{fl(bn,cp.q,this.p_localNormal),bi(yS,cp,this.p_localPoint),bi(Xg,lp,this.p_localPoints[A]),B=st(Xg,bn)-st(yS,bn)-this.p_radiusA-this.p_radiusB,Pe(fx,Xg),ab(bn);break}default:return o}wi(S2,fx,Nh),wi(C2,fx,Vh),o=ZXe(o,B);var I=r?wt.toiBaugarte:wt.baumgarte,R=wt.linearSlop,P=wt.maxLinearCorrection,k=wr(I*(B+R),-P,0),E=Ri(S2,bn),D=Ri(C2,bn),L=x+w+_*E*E+O*D*D,V=L>0?-k/L:0;ui(Vs,V,bn),Lx(Nh,x,Vs),T-=_*Ri(S2,Vs),ql(Vh,w,Vs),C+=O*Ri(C2,Vs)}return Pe(f.c,Nh),f.a=T,Pe(p.c,Vh),p.a=C,o},s.prototype.initVelocityConstraint=function(e){var i=this.m_fixtureA,n=this.m_fixtureB;if(!(i===null||n===null)){var r=i.m_body,o=n.m_body;if(!(r===null||o===null)){var a=r.c_velocity,l=o.c_velocity,h=r.c_position,d=o.c_position,f=this.p_radiusA,p=this.p_radiusB,g=this.m_manifold,y=this.v_invMassA,x=this.v_invMassB,_=this.v_invIA,w=this.v_invIB,O=this.p_localCenterA,T=this.p_localCenterB;Pe(Nh,h.c);var C=h.a;Pe(Os,a.v);var A=a.w;Pe(Vh,d.c);var B=d.a;Pe(Ss,l.v);var I=l.w;KO(lp,O,Nh,C),KO(cp,T,Vh,B),pS.recycle(),g.getWorldManifold(pS,lp,f,cp,p),Pe(this.v_normal,pS.normal);for(var R=0;R<this.v_pointCount;++R){var P=this.v_points[R],k=pS.points[R];wi(P.rA,k,Nh),wi(P.rB,k,Vh);var E=Ri(P.rA,this.v_normal),D=Ri(P.rB,this.v_normal),L=y+x+_*E*E+w*D*D;P.normalMass=L>0?1/L:0,im(yd,this.v_normal,1);var V=Ri(P.rA,yd),F=Ri(P.rB,yd),j=y+x+_*V*V+w*F*F;P.tangentMass=j>0?1/j:0,P.velocityBias=0;var Q=0;Q+=st(this.v_normal,Ss),Q+=st(this.v_normal,Oa(Cc,I,P.rB)),Q-=st(this.v_normal,Os),Q-=st(this.v_normal,Oa(Cc,A,P.rA)),Q<-wt.velocityThreshold&&(P.velocityBias=-this.v_restitution*Q)}if(this.v_pointCount==2&&e.blockSolve){var ee=this.v_points[0],J=this.v_points[1],ue=Ri(ee.rA,this.v_normal),oe=Ri(ee.rB,this.v_normal),pe=Ri(J.rA,this.v_normal),Ue=Ri(J.rB,this.v_normal),tt=y+x+_*ue*ue+w*oe*oe,ve=y+x+_*pe*pe+w*Ue*Ue,Re=y+x+_*ue*pe+w*oe*Ue,Le=1e3;if(tt*tt<Le*(tt*ve-Re*Re)){this.v_K.ex.setNum(tt,Re),this.v_K.ey.setNum(Re,ve);var De=this.v_K.ex.x,Se=this.v_K.ey.x,Y=this.v_K.ex.y,W=this.v_K.ey.y,te=De*W-Se*Y;te!==0&&(te=1/te),this.v_normalMass.ex.x=te*W,this.v_normalMass.ey.x=-te*Se,this.v_normalMass.ex.y=-te*Y,this.v_normalMass.ey.y=te*De}else this.v_pointCount=1}Pe(h.c,Nh),h.a=C,Pe(a.v,Os),a.w=A,Pe(d.c,Vh),d.a=B,Pe(l.v,Ss),l.w=I}}},s.prototype.warmStartConstraint=function(e){var i=this.m_fixtureA,n=this.m_fixtureB;if(!(i===null||n===null)){var r=i.m_body,o=n.m_body;if(!(r===null||o===null)){var a=r.c_velocity,l=o.c_velocity;r.c_position,o.c_position;var h=this.v_invMassA,d=this.v_invIA,f=this.v_invMassB,p=this.v_invIB;Pe(Os,a.v);var g=a.w;Pe(Ss,l.v);var y=l.w;Pe(bn,this.v_normal),im(yd,bn,1);for(var x=0;x<this.v_pointCount;++x){var _=this.v_points[x];qn(Vs,_.normalImpulse,bn,_.tangentImpulse,yd),g-=d*Ri(_.rA,Vs),Lx(Os,h,Vs),y+=p*Ri(_.rB,Vs),ql(Ss,f,Vs)}Pe(a.v,Os),a.w=g,Pe(l.v,Ss),l.w=y}}},s.prototype.storeConstraintImpulses=function(e){for(var i=this.m_manifold,n=0;n<this.v_pointCount;++n)i.points[n].normalImpulse=this.v_points[n].normalImpulse,i.points[n].tangentImpulse=this.v_points[n].tangentImpulse},s.prototype.solveVelocityConstraint=function(e){var i=this.m_fixtureA,n=this.m_fixtureB;if(!(i===null||n===null)){var r=i.m_body,o=n.m_body;if(!(r===null||o===null)){var a=r.c_velocity;r.c_position;var l=o.c_velocity;o.c_position;var h=this.v_invMassA,d=this.v_invIA,f=this.v_invMassB,p=this.v_invIB;Pe(Os,a.v);var g=a.w;Pe(Ss,l.v);var y=l.w;Pe(bn,this.v_normal),im(yd,bn,1);for(var x=this.v_friction,_=0;_<this.v_pointCount;++_){var w=this.v_points[_];oi(Ka),nl(Ka,Ss),nl(Ka,Oa(Cc,y,w.rB)),zh(Ka,Os),zh(Ka,Oa(Cc,g,w.rA));var O=st(Ka,yd)-this.v_tangentSpeed,T=w.tangentMass*-O,C=x*w.normalImpulse,A=wr(w.tangentImpulse+T,-C,C);T=A-w.tangentImpulse,w.tangentImpulse=A,ui(Vs,T,yd),Lx(Os,h,Vs),g-=d*Ri(w.rA,Vs),ql(Ss,f,Vs),y+=p*Ri(w.rB,Vs)}if(this.v_pointCount==1||e.blockSolve==!1)for(var B=0;B<this.v_pointCount;++B){var w=this.v_points[B];oi(Ka),nl(Ka,Ss),nl(Ka,Oa(Cc,y,w.rB)),zh(Ka,Os),zh(Ka,Oa(Cc,g,w.rA));var I=st(Ka,bn),T=-w.normalMass*(I-w.velocityBias),A=qXe(w.normalImpulse+T,0);T=A-w.normalImpulse,w.normalImpulse=A,ui(Vs,T,bn),Lx(Os,h,Vs),g-=d*Ri(w.rA,Vs),ql(Ss,f,Vs),y+=p*Ri(w.rB,Vs)}else{var R=this.v_points[0],P=this.v_points[1];br($h,R.normalImpulse,P.normalImpulse),oi(Wg),nl(Wg,Ss),nl(Wg,Oa(Cc,y,R.rB)),zh(Wg,Os),zh(Wg,Oa(Cc,g,R.rA)),oi(Hg),nl(Hg,Ss),nl(Hg,Oa(Cc,y,P.rB)),zh(Hg,Os),zh(Hg,Oa(Cc,g,P.rA));var k=st(Wg,bn),E=st(Hg,bn);for(br(ba,k-R.velocityBias,E-P.velocityBias),ba.x-=this.v_K.ex.x*$h.x+this.v_K.ey.x*$h.y,ba.y-=this.v_K.ex.y*$h.x+this.v_K.ey.y*$h.y;;){if(oi(Vn),Vn.x=-(this.v_normalMass.ex.x*ba.x+this.v_normalMass.ey.x*ba.y),Vn.y=-(this.v_normalMass.ex.y*ba.x+this.v_normalMass.ey.y*ba.y),Vn.x>=0&&Vn.y>=0){wi(Ja,Vn,$h),ui($s,Ja.x,bn),ui(Us,Ja.y,bn),Lc(Os,-h,$s,-h,Us,1,Os),g-=d*(Ri(R.rA,$s)+Ri(P.rA,Us)),Lc(Ss,f,$s,f,Us,1,Ss),y+=p*(Ri(R.rB,$s)+Ri(P.rB,Us)),R.normalImpulse=Vn.x,P.normalImpulse=Vn.y;break}if(Vn.x=-R.normalMass*ba.x,Vn.y=0,k=0,E=this.v_K.ex.y*Vn.x+ba.y,Vn.x>=0&&E>=0){wi(Ja,Vn,$h),ui($s,Ja.x,bn),ui(Us,Ja.y,bn),Lc(Os,-h,$s,-h,Us,1,Os),g-=d*(Ri(R.rA,$s)+Ri(P.rA,Us)),Lc(Ss,f,$s,f,Us,1,Ss),y+=p*(Ri(R.rB,$s)+Ri(P.rB,Us)),R.normalImpulse=Vn.x,P.normalImpulse=Vn.y;break}if(Vn.x=0,Vn.y=-P.normalMass*ba.y,k=this.v_K.ey.x*Vn.y+ba.x,E=0,Vn.y>=0&&k>=0){wi(Ja,Vn,$h),ui($s,Ja.x,bn),ui(Us,Ja.y,bn),Lc(Os,-h,$s,-h,Us,1,Os),g-=d*(Ri(R.rA,$s)+Ri(P.rA,Us)),Lc(Ss,f,$s,f,Us,1,Ss),y+=p*(Ri(R.rB,$s)+Ri(P.rB,Us)),R.normalImpulse=Vn.x,P.normalImpulse=Vn.y;break}if(Vn.x=0,Vn.y=0,k=ba.x,E=ba.y,k>=0&&E>=0){wi(Ja,Vn,$h),ui($s,Ja.x,bn),ui(Us,Ja.y,bn),Lc(Os,-h,$s,-h,Us,1,Os),g-=d*(Ri(R.rA,$s)+Ri(P.rA,Us)),Lc(Ss,f,$s,f,Us,1,Ss),y+=p*(Ri(R.rB,$s)+Ri(P.rB,Us)),R.normalImpulse=Vn.x,P.normalImpulse=Vn.y;break}break}}Pe(a.v,Os),a.w=g,Pe(l.v,Ss),l.w=y}}},s.addType=function(e,i,n){ap[e]=ap[e]||{},ap[e][i]=n},s.create=function(e,i,n,r){var o=e.m_shape.m_type,a=n.m_shape.m_type,l=w8.allocate(),h;if(h=ap[o]&&ap[o][a])l.initialize(e,i,n,r,h);else if(h=ap[a]&&ap[a][o])l.initialize(n,r,e,i,h);else return null;e=l.m_fixtureA,n=l.m_fixtureB,i=l.getChildIndexA(),r=l.getChildIndexB();var d=e.m_body,f=n.m_body;return l.m_nodeA.contact=l,l.m_nodeA.other=f,l.m_nodeA.prev=null,l.m_nodeA.next=d.m_contactList,d.m_contactList!=null&&(d.m_contactList.prev=l.m_nodeA),d.m_contactList=l.m_nodeA,l.m_nodeB.contact=l,l.m_nodeB.other=d,l.m_nodeB.prev=null,l.m_nodeB.next=f.m_contactList,f.m_contactList!=null&&(f.m_contactList.prev=l.m_nodeB),f.m_contactList=l.m_nodeB,e.isSensor()==!1&&n.isSensor()==!1&&(d.setAwake(!0),f.setAwake(!0)),l},s.destroy=function(e,i){var n=e.m_fixtureA,r=e.m_fixtureB;if(!(n===null||r===null)){var o=n.m_body,a=r.m_body;o===null||a===null||(e.isTouching()&&i.endContact(e),e.m_nodeA.prev&&(e.m_nodeA.prev.next=e.m_nodeA.next),e.m_nodeA.next&&(e.m_nodeA.next.prev=e.m_nodeA.prev),e.m_nodeA==o.m_contactList&&(o.m_contactList=e.m_nodeA.next),e.m_nodeB.prev&&(e.m_nodeB.prev.next=e.m_nodeB.next),e.m_nodeB.next&&(e.m_nodeB.next.prev=e.m_nodeB.prev),e.m_nodeB==a.m_contactList&&(a.m_contactList=e.m_nodeB.next),e.m_manifold.pointCount>0&&!n.m_isSensor&&!r.m_isSensor&&(o.setAwake(!0),a.setAwake(!0)),w8.release(e))}},s}(),KXe={gravity:$.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3},Yb=function(){function s(e){if(!(this instanceof s))return new s(e);this.s_step=new hN,e?$.isValid(e)&&(e={gravity:e}):e={},e=Fa(e,KXe),this.m_solver=new cee(this),this.m_broadPhase=new TXe,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=e.allowSleep,this.m_gravity=$.clone(e.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=e.warmStarting,this.m_continuousPhysics=e.continuousPhysics,this.m_subStepping=e.subStepping,this.m_blockSolve=e.blockSolve,this.m_velocityIterations=e.velocityIterations,this.m_positionIterations=e.positionIterations,this.m_t=0,this.m_step_callback=[]}return s.prototype._serialize=function(){for(var e=[],i=[],n=this.getBodyList();n;n=n.getNext())e.push(n);for(var r=this.getJointList();r;r=r.getNext())typeof r._serialize=="function"&&i.push(r);return{gravity:this.m_gravity,bodies:e,joints:i}},s._deserialize=function(e,i,n){if(!e)return new s;var r=new s(e.gravity);if(e.bodies)for(var o=e.bodies.length-1;o>=0;o-=1)r._addBody(n(pn,e.bodies[o],r));if(e.joints)for(var o=e.joints.length-1;o>=0;o--)r.createJoint(n(Kr,e.joints[o],r));return r},s.prototype.getBodyList=function(){return this.m_bodyList},s.prototype.getJointList=function(){return this.m_jointList},s.prototype.getContactList=function(){return this.m_contactList},s.prototype.getBodyCount=function(){return this.m_bodyCount},s.prototype.getJointCount=function(){return this.m_jointCount},s.prototype.getContactCount=function(){return this.m_contactCount},s.prototype.setGravity=function(e){this.m_gravity.set(e)},s.prototype.getGravity=function(){return this.m_gravity},s.prototype.isLocked=function(){return this.m_locked},s.prototype.setAllowSleeping=function(e){if(e!=this.m_allowSleep&&(this.m_allowSleep=e,this.m_allowSleep==!1))for(var i=this.m_bodyList;i;i=i.m_next)i.setAwake(!0)},s.prototype.getAllowSleeping=function(){return this.m_allowSleep},s.prototype.setWarmStarting=function(e){this.m_warmStarting=e},s.prototype.getWarmStarting=function(){return this.m_warmStarting},s.prototype.setContinuousPhysics=function(e){this.m_continuousPhysics=e},s.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},s.prototype.setSubStepping=function(e){this.m_subStepping=e},s.prototype.getSubStepping=function(){return this.m_subStepping},s.prototype.setAutoClearForces=function(e){this.m_clearForces=e},s.prototype.getAutoClearForces=function(){return this.m_clearForces},s.prototype.clearForces=function(){for(var e=this.m_bodyList;e;e=e.getNext())e.m_force.setZero(),e.m_torque=0},s.prototype.queryAABB=function(e,i){var n=this.m_broadPhase;this.m_broadPhase.query(e,function(r){var o=n.getUserData(r);return i(o.fixture)})},s.prototype.rayCast=function(e,i,n){var r=this.m_broadPhase;this.m_broadPhase.rayCast({maxFraction:1,p1:e,p2:i},function(o,a){var l=r.getUserData(a),h=l.fixture,d=l.childIndex,f={},p=h.rayCast(f,o,d);if(p){var g=f.fraction,y=$.add($.mulNumVec2(1-g,o.p1),$.mulNumVec2(g,o.p2));return n(h,y,f.normal,g)}return o.maxFraction})},s.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},s.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},s.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},s.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},s.prototype.shiftOrigin=function(e){if(!this.isLocked()){for(var i=this.m_bodyList;i;i=i.m_next)i.m_xf.p.sub(e),i.m_sweep.c0.sub(e),i.m_sweep.c.sub(e);for(var n=this.m_jointList;n;n=n.m_next)n.shiftOrigin(e);this.m_broadPhase.shiftOrigin(e)}},s.prototype._addBody=function(e){this.isLocked()||(e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount)},s.prototype.createBody=function(e,i){if(this.isLocked())return null;var n={};e&&($.isValid(e)?n={position:e,angle:i}:typeof e=="object"&&(n=e));var r=new pn(this,n);return this._addBody(r),r},s.prototype.createDynamicBody=function(e,i){var n={};return e&&($.isValid(e)?n={position:e,angle:i}:typeof e=="object"&&(n=e)),n.type="dynamic",this.createBody(n)},s.prototype.createKinematicBody=function(e,i){var n={};return e&&($.isValid(e)?n={position:e,angle:i}:typeof e=="object"&&(n=e)),n.type="kinematic",this.createBody(n)},s.prototype.destroyBody=function(e){if(!this.isLocked()){if(e.m_destroyed)return!1;for(var i=e.m_jointList;i;){var n=i;i=i.next,this.publish("remove-joint",n.joint),this.destroyJoint(n.joint),e.m_jointList=i}e.m_jointList=null;for(var r=e.m_contactList;r;){var o=r;r=r.next,this.destroyContact(o.contact),e.m_contactList=r}e.m_contactList=null;for(var a=e.m_fixtureList;a;){var l=a;a=a.m_next,this.publish("remove-fixture",l),l.destroyProxies(this.m_broadPhase),e.m_fixtureList=a}return e.m_fixtureList=null,e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e==this.m_bodyList&&(this.m_bodyList=e.m_next),e.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",e),!0}},s.prototype.createJoint=function(e){if(this.isLocked())return null;if(e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=null,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=null,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB,e.m_collideConnected==!1)for(var i=e.m_bodyB.getContactList();i;i=i.next)i.other==e.m_bodyA&&i.contact.flagForFiltering();return e},s.prototype.destroyJoint=function(e){if(!this.isLocked()){e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e==this.m_jointList&&(this.m_jointList=e.m_next);var i=e.m_bodyA,n=e.m_bodyB;if(i.setAwake(!0),n.setAwake(!0),e.m_edgeA.prev&&(e.m_edgeA.prev.next=e.m_edgeA.next),e.m_edgeA.next&&(e.m_edgeA.next.prev=e.m_edgeA.prev),e.m_edgeA==i.m_jointList&&(i.m_jointList=e.m_edgeA.next),e.m_edgeA.prev=null,e.m_edgeA.next=null,e.m_edgeB.prev&&(e.m_edgeB.prev.next=e.m_edgeB.next),e.m_edgeB.next&&(e.m_edgeB.next.prev=e.m_edgeB.prev),e.m_edgeB==n.m_jointList&&(n.m_jointList=e.m_edgeB.next),e.m_edgeB.prev=null,e.m_edgeB.next=null,--this.m_jointCount,e.m_collideConnected==!1)for(var r=n.getContactList();r;)r.other==i&&r.contact.flagForFiltering(),r=r.next;this.publish("remove-joint",e)}},s.prototype.step=function(e,i,n){if(this.publish("pre-step",e),(i|0)!==i&&(i=0),i=i||this.m_velocityIterations,n=n||this.m_positionIterations,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,this.s_step.reset(e),this.s_step.velocityIterations=i,this.s_step.positionIterations=n,this.s_step.warmStarting=this.m_warmStarting,this.s_step.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&e>0){this.m_solver.solveWorld(this.s_step);for(var r=this.m_bodyList;r;r=r.getNext())r.m_islandFlag!=!1&&(r.isStatic()||r.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&e>0&&this.m_solver.solveWorldTOI(this.s_step),this.m_clearForces&&this.clearForces(),this.m_locked=!1;for(var o;o=this.m_step_callback.shift();)o(this);this.publish("post-step",e)},s.prototype.queueUpdate=function(e){this.isLocked()?this.m_step_callback.push(e):e(this)},s.prototype.findNewContacts=function(){var e=this;this.m_broadPhase.updatePairs(function(i,n){return e.createContact(i,n)})},s.prototype.createContact=function(e,i){var n=e.fixture,r=i.fixture,o=e.childIndex,a=i.childIndex,l=n.getBody(),h=r.getBody();if(l!=h){for(var d=h.getContactList();d;){if(d.other==l){var f=d.contact.getFixtureA(),p=d.contact.getFixtureB(),g=d.contact.getChildIndexA(),y=d.contact.getChildIndexB();if(f==n&&p==r&&g==o&&y==a||f==r&&p==n&&g==a&&y==o)return}d=d.next}if(h.shouldCollide(l)!=!1&&r.shouldCollide(n)!=!1){var x=ah.create(n,o,r,a);x!=null&&(x.m_prev=null,this.m_contactList!=null&&(x.m_next=this.m_contactList,this.m_contactList.m_prev=x),this.m_contactList=x,++this.m_contactCount)}}},s.prototype.updateContacts=function(){for(var e,i=this.m_contactList;e=i;){i=e.getNext();var n=e.getFixtureA(),r=e.getFixtureB(),o=e.getChildIndexA(),a=e.getChildIndexB(),l=n.getBody(),h=r.getBody();if(e.m_filterFlag){if(h.shouldCollide(l)==!1){this.destroyContact(e);continue}if(r.shouldCollide(n)==!1){this.destroyContact(e);continue}e.m_filterFlag=!1}var d=l.isAwake()&&!l.isStatic(),f=h.isAwake()&&!h.isStatic();if(!(d==!1&&f==!1)){var p=n.m_proxies[o].proxyId,g=r.m_proxies[a].proxyId,y=this.m_broadPhase.testOverlap(p,g);if(y==!1){this.destroyContact(e);continue}e.update(this)}}},s.prototype.destroyContact=function(e){e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e==this.m_contactList&&(this.m_contactList=e.m_next),ah.destroy(e,this),--this.m_contactCount},s.prototype.on=function(e,i){return typeof e!="string"||typeof i!="function"?this:(this._listeners||(this._listeners={}),this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(i),this)},s.prototype.off=function(e,i){if(typeof e!="string"||typeof i!="function")return this;var n=this._listeners&&this._listeners[e];if(!n||!n.length)return this;var r=n.indexOf(i);return r>=0&&n.splice(r,1),this},s.prototype.publish=function(e,i,n,r){var o=this._listeners&&this._listeners[e];if(!o||!o.length)return 0;for(var a=0;a<o.length;a++)o[a].call(this,i,n,r);return o.length},s.prototype.beginContact=function(e){this.publish("begin-contact",e)},s.prototype.endContact=function(e){this.publish("end-contact",e)},s.prototype.preSolve=function(e,i){this.publish("pre-solve",e,i)},s.prototype.postSolve=function(e,i){this.publish("post-solve",e,i)},s}(),on=function(){function s(e,i,n){if(!(this instanceof s))return new s(e,i,n);typeof e>"u"?(this.x=0,this.y=0,this.z=0):typeof e=="object"?(this.x=e.x,this.y=e.y,this.z=e.z):(this.x=e,this.y=i,this.z=n)}return s.prototype._serialize=function(){return{x:this.x,y:this.y,z:this.z}},s._deserialize=function(e){var i=Object.create(s.prototype);return i.x=e.x,i.y=e.y,i.z=e.z,i},s.neo=function(e,i,n){var r=Object.create(s.prototype);return r.x=e,r.y=i,r.z=n,r},s.zero=function(){var e=Object.create(s.prototype);return e.x=0,e.y=0,e.z=0,e},s.clone=function(e){return s.neo(e.x,e.y,e.z)},s.prototype.toString=function(){return JSON.stringify(this)},s.isValid=function(e){return e===null||typeof e>"u"?!1:Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.z)},s.assert=function(e){},s.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},s.prototype.set=function(e,i,n){return this.x=e,this.y=i,this.z=n,this},s.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},s.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},s.prototype.mul=function(e){return this.x*=e,this.y*=e,this.z*=e,this},s.areEqual=function(e,i){return e===i||typeof e=="object"&&e!==null&&typeof i=="object"&&i!==null&&e.x===i.x&&e.y===i.y&&e.z===i.z},s.dot=function(e,i){return e.x*i.x+e.y*i.y+e.z*i.z},s.cross=function(e,i){return new s(e.y*i.z-e.z*i.y,e.z*i.x-e.x*i.z,e.x*i.y-e.y*i.x)},s.add=function(e,i){return new s(e.x+i.x,e.y+i.y,e.z+i.z)},s.sub=function(e,i){return new s(e.x-i.x,e.y-i.y,e.z-i.z)},s.mul=function(e,i){return new s(i*e.x,i*e.y,i*e.z)},s.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},s.neg=function(e){return new s(-e.x,-e.y,-e.z)},s}(),A8=ze(0,0),E8=ze(0,0),Tu=function(s){oo(e,s);function e(i,n){var r=this;return r instanceof e?(r=s.call(this)||this,r.m_type=e.TYPE,r.m_radius=wt.polygonRadius,r.m_vertex1=i?$.clone(i):$.zero(),r.m_vertex2=n?$.clone(n):$.zero(),r.m_vertex0=$.zero(),r.m_vertex3=$.zero(),r.m_hasVertex0=!1,r.m_hasVertex3=!1,r):new e(i,n)}return e.prototype._serialize=function(){return{type:this.m_type,vertex1:this.m_vertex1,vertex2:this.m_vertex2,vertex0:this.m_vertex0,vertex3:this.m_vertex3,hasVertex0:this.m_hasVertex0,hasVertex3:this.m_hasVertex3}},e._deserialize=function(i){var n=new e(i.vertex1,i.vertex2);return n.m_hasVertex0&&n.setPrevVertex(i.vertex0),n.m_hasVertex3&&n.setNextVertex(i.vertex3),n},e.prototype._reset=function(){},e.prototype.getRadius=function(){return this.m_radius},e.prototype.getType=function(){return this.m_type},e.prototype.setNext=function(i){return this.setNextVertex(i)},e.prototype.setNextVertex=function(i){return i?(this.m_vertex3.setVec2(i),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},e.prototype.getNextVertex=function(){return this.m_vertex3},e.prototype.setPrev=function(i){return this.setPrevVertex(i)},e.prototype.setPrevVertex=function(i){return i?(this.m_vertex0.setVec2(i),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},e.prototype.getPrevVertex=function(){return this.m_vertex0},e.prototype._set=function(i,n){return this.m_vertex1.setVec2(i),this.m_vertex2.setVec2(n),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},e.prototype._clone=function(){var i=new e;return i.m_type=this.m_type,i.m_radius=this.m_radius,i.m_vertex1.setVec2(this.m_vertex1),i.m_vertex2.setVec2(this.m_vertex2),i.m_vertex0.setVec2(this.m_vertex0),i.m_vertex3.setVec2(this.m_vertex3),i.m_hasVertex0=this.m_hasVertex0,i.m_hasVertex3=this.m_hasVertex3,i},e.prototype.getChildCount=function(){return 1},e.prototype.testPoint=function(i,n){return!1},e.prototype.rayCast=function(i,n,r,o){var a=Ye.mulTVec2(r.q,$.sub(n.p1,r.p)),l=Ye.mulTVec2(r.q,$.sub(n.p2,r.p)),h=$.sub(l,a),d=this.m_vertex1,f=this.m_vertex2,p=$.sub(f,d),g=$.neo(p.y,-p.x);g.normalize();var y=$.dot(g,$.sub(d,a)),x=$.dot(g,h);if(x==0)return!1;var _=y/x;if(_<0||n.maxFraction<_)return!1;var w=$.add(a,$.mulNumVec2(_,h)),O=$.sub(f,d),T=$.dot(O,O);if(T==0)return!1;var C=$.dot($.sub(w,d),O)/T;return C<0||1<C?!1:(i.fraction=_,y>0?i.normal=Ye.mulVec2(r.q,g).neg():i.normal=Ye.mulVec2(r.q,g),!0)},e.prototype.computeAABB=function(i,n,r){bi(A8,n,this.m_vertex1),bi(E8,n,this.m_vertex2),vr.combinePoints(i,A8,E8),vr.extend(i,this.m_radius)},e.prototype.computeMass=function(i,n){i.mass=0,qn(i.center,.5,this.m_vertex1,.5,this.m_vertex2),i.I=0},e.prototype.computeDistanceProxy=function(i){i.m_vertices[0]=this.m_vertex1,i.m_vertices[1]=this.m_vertex2,i.m_vertices.length=2,i.m_count=2,i.m_radius=this.m_radius},e.TYPE="edge",e}(Nm),vS=Tu,M8=ze(0,0),k8=ze(0,0),DT=function(s){oo(e,s);function e(i,n){var r=this;return r instanceof e?(r=s.call(this)||this,r.m_type=e.TYPE,r.m_radius=wt.polygonRadius,r.m_vertices=[],r.m_count=0,r.m_prevVertex=null,r.m_nextVertex=null,r.m_hasPrevVertex=!1,r.m_hasNextVertex=!1,r.m_isLoop=!!n,i&&i.length&&(n?r._createLoop(i):r._createChain(i)),r):new e(i,n)}return e.prototype._serialize=function(){var i={type:this.m_type,vertices:this.m_isLoop?this.m_vertices.slice(0,this.m_vertices.length-1):this.m_vertices,isLoop:this.m_isLoop,hasPrevVertex:this.m_hasPrevVertex,hasNextVertex:this.m_hasNextVertex,prevVertex:null,nextVertex:null};return this.m_prevVertex&&(i.prevVertex=this.m_prevVertex),this.m_nextVertex&&(i.nextVertex=this.m_nextVertex),i},e._deserialize=function(i,n,r){var o=[];if(i.vertices)for(var a=0;a<i.vertices.length;a++)o.push(r($,i.vertices[a]));var l=new e(o,i.isLoop);return i.prevVertex&&l.setPrevVertex(i.prevVertex),i.nextVertex&&l.setNextVertex(i.nextVertex),l},e.prototype.getType=function(){return this.m_type},e.prototype.getRadius=function(){return this.m_radius},e.prototype._createLoop=function(i){if(!(i.length<3)){for(var n=1;n<i.length;++n)i[n-1],i[n];this.m_vertices=[],this.m_count=i.length+1;for(var n=0;n<i.length;++n)this.m_vertices[n]=$.clone(i[n]);return this.m_vertices[i.length]=$.clone(i[0]),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this}},e.prototype._createChain=function(i){for(var n=1;n<i.length;++n)i[n-1],i[n];this.m_vertices=[],this.m_count=i.length;for(var n=0;n<i.length;++n)this.m_vertices[n]=$.clone(i[n]);return this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this},e.prototype._reset=function(){this.m_isLoop?this._createLoop(this.m_vertices.slice(0,this.m_vertices.length-1)):this._createChain(this.m_vertices)},e.prototype.setPrevVertex=function(i){this.m_prevVertex=i,this.m_hasPrevVertex=!0},e.prototype.getPrevVertex=function(){return this.m_prevVertex},e.prototype.setNextVertex=function(i){this.m_nextVertex=i,this.m_hasNextVertex=!0},e.prototype.getNextVertex=function(){return this.m_nextVertex},e.prototype._clone=function(){var i=new e;return i._createChain(this.m_vertices),i.m_type=this.m_type,i.m_radius=this.m_radius,i.m_prevVertex=this.m_prevVertex,i.m_nextVertex=this.m_nextVertex,i.m_hasPrevVertex=this.m_hasPrevVertex,i.m_hasNextVertex=this.m_hasNextVertex,i},e.prototype.getChildCount=function(){return this.m_count-1},e.prototype.getChildEdge=function(i,n){i.m_type=Tu.TYPE,i.m_radius=this.m_radius,i.m_vertex1=this.m_vertices[n],i.m_vertex2=this.m_vertices[n+1],n>0?(i.m_vertex0=this.m_vertices[n-1],i.m_hasVertex0=!0):(i.m_vertex0=this.m_prevVertex,i.m_hasVertex0=this.m_hasPrevVertex),n<this.m_count-2?(i.m_vertex3=this.m_vertices[n+2],i.m_hasVertex3=!0):(i.m_vertex3=this.m_nextVertex,i.m_hasVertex3=this.m_hasNextVertex)},e.prototype.getVertex=function(i){return i<this.m_count?this.m_vertices[i]:this.m_vertices[0]},e.prototype.isLoop=function(){return this.m_isLoop},e.prototype.testPoint=function(i,n){return!1},e.prototype.rayCast=function(i,n,r,o){var a=new Tu(this.getVertex(o),this.getVertex(o+1));return a.rayCast(i,n,r,0)},e.prototype.computeAABB=function(i,n,r){bi(M8,n,this.getVertex(r)),bi(k8,n,this.getVertex(r+1)),vr.combinePoints(i,M8,k8)},e.prototype.computeMass=function(i,n){i.mass=0,oi(i.center),i.I=0},e.prototype.computeDistanceProxy=function(i,n){i.m_vertices[0]=this.getVertex(n),i.m_vertices[1]=this.getVertex(n+1),i.m_count=2,i.m_radius=this.m_radius},e.TYPE="chain",e}(Nm),P8=Math.max,T2=Math.min,kp=ze(0,0),I8=ze(0,0),px=ze(0,0),Gg=ze(0,0),hp=ze(0,0),vd=ze(0,0),df=function(s){oo(e,s);function e(i){var n=this;return n instanceof e?(n=s.call(this)||this,n.m_type=e.TYPE,n.m_radius=wt.polygonRadius,n.m_centroid=$.zero(),n.m_vertices=[],n.m_normals=[],n.m_count=0,i&&i.length&&n._set(i),n):new e(i)}return e.prototype._serialize=function(){return{type:this.m_type,vertices:this.m_vertices}},e._deserialize=function(i,n,r){var o=[];if(i.vertices)for(var a=0;a<i.vertices.length;a++)o.push(r($,i.vertices[a]));var l=new e(o);return l},e.prototype.getType=function(){return this.m_type},e.prototype.getRadius=function(){return this.m_radius},e.prototype._clone=function(){var i=new e;i.m_type=this.m_type,i.m_radius=this.m_radius,i.m_count=this.m_count,i.m_centroid.setVec2(this.m_centroid);for(var n=0;n<this.m_count;n++)i.m_vertices.push(this.m_vertices[n].clone());for(var n=0;n<this.m_normals.length;n++)i.m_normals.push(this.m_normals[n].clone());return i},e.prototype.getChildCount=function(){return 1},e.prototype._reset=function(){this._set(this.m_vertices)},e.prototype._set=function(i){if(i.length<3){this._setAsBox(1,1);return}for(var n=T2(i.length,wt.maxPolygonVertices),r=[],o=0;o<n;++o){for(var a=i[o],l=!0,h=0;h<r.length;++h)if($.distanceSquared(a,r[h])<.25*wt.linearSlopSquared){l=!1;break}l&&r.push($.clone(a))}if(n=r.length,n<3){this._setAsBox(1,1);return}for(var d=0,f=r[0].x,o=1;o<n;++o){var p=r[o].x;(p>f||p===f&&r[o].y<r[d].y)&&(d=o,f=p)}for(var g=[],y=0,x=d;;){g[y]=x;for(var _=0,h=1;h<n;++h){if(_===x){_=h;continue}var w=$.sub(r[_],r[g[y]]),a=$.sub(r[h],r[g[y]]),O=$.crossVec2Vec2(w,a);O<0&&(_=h),O===0&&a.lengthSquared()>w.lengthSquared()&&(_=h)}if(++y,x=_,_===d)break}if(y<3){this._setAsBox(1,1);return}this.m_count=y,this.m_vertices=[];for(var o=0;o<y;++o)this.m_vertices[o]=r[g[o]];for(var o=0;o<y;++o){var T=o,C=o+1<y?o+1:0,A=$.sub(this.m_vertices[C],this.m_vertices[T]);this.m_normals[o]=$.crossVec2Num(A,1),this.m_normals[o].normalize()}this.m_centroid=JXe(this.m_vertices,y)},e.prototype._setAsBox=function(i,n,r,o){if(this.m_vertices[0]=$.neo(i,-n),this.m_vertices[1]=$.neo(i,n),this.m_vertices[2]=$.neo(-i,n),this.m_vertices[3]=$.neo(-i,-n),this.m_normals[0]=$.neo(1,0),this.m_normals[1]=$.neo(0,1),this.m_normals[2]=$.neo(-1,0),this.m_normals[3]=$.neo(0,-1),this.m_count=4,r&&$.isValid(r)){o=o||0,Pe(this.m_centroid,r);var a=tc.identity();a.p.setVec2(r),a.q.setAngle(o);for(var l=0;l<this.m_count;++l)this.m_vertices[l]=tc.mulVec2(a,this.m_vertices[l]),this.m_normals[l]=Ye.mulVec2(a.q,this.m_normals[l])}},e.prototype.testPoint=function(i,n){for(var r=rN(kp,i,n),o=0;o<this.m_count;++o){var a=st(this.m_normals[o],r)-st(this.m_normals[o],this.m_vertices[o]);if(a>0)return!1}return!0},e.prototype.rayCast=function(i,n,r,o){for(var a=Ye.mulTVec2(r.q,$.sub(n.p1,r.p)),l=Ye.mulTVec2(r.q,$.sub(n.p2,r.p)),h=$.sub(l,a),d=0,f=n.maxFraction,p=-1,g=0;g<this.m_count;++g){var y=$.dot(this.m_normals[g],$.sub(this.m_vertices[g],a)),x=$.dot(this.m_normals[g],h);if(x==0){if(y<0)return!1}else x<0&&y<d*x?(d=y/x,p=g):x>0&&y<f*x&&(f=y/x);if(f<d)return!1}return p>=0?(i.fraction=d,i.normal=Ye.mulVec2(r.q,this.m_normals[p]),!0):!1},e.prototype.computeAABB=function(i,n,r){for(var o=1/0,a=1/0,l=-1/0,h=-1/0,d=0;d<this.m_count;++d){var f=bi(kp,n,this.m_vertices[d]);o=T2(o,f.x),l=P8(l,f.x),a=T2(a,f.y),h=P8(h,f.y)}br(i.lowerBound,o-this.m_radius,a-this.m_radius),br(i.upperBound,l+this.m_radius,h+this.m_radius)},e.prototype.computeMass=function(i,n){oi(hp);var r=0,o=0;oi(vd);for(var a=0;a<this.m_count;++a)nl(vd,this.m_vertices[a]);ui(vd,1/this.m_count,vd);for(var l=1/3,a=0;a<this.m_count;++a){wi(px,this.m_vertices[a],vd),a+1<this.m_count?wi(Gg,this.m_vertices[a+1],vd):wi(Gg,this.m_vertices[0],vd);var h=Ri(px,Gg),d=.5*h;r+=d,qn(kp,d*l,px,d*l,Gg),nl(hp,kp);var f=px.x,p=px.y,g=Gg.x,y=Gg.y,x=f*f+g*f+g*g,_=p*p+y*p+y*y;o+=.25*l*h*(x+_)}i.mass=n*r,ui(hp,1/r,hp),EXe(i.center,hp,vd),i.I=n*o,i.I+=i.mass*(st(i.center,i.center)-st(hp,hp))},e.prototype.validate=function(){for(var i=0;i<this.m_count;++i){var n=i,r=i<this.m_count-1?n+1:0,o=this.m_vertices[n];wi(I8,this.m_vertices[r],o);for(var a=0;a<this.m_count;++a)if(!(a==n||a==r)){var l=Ri(I8,wi(kp,this.m_vertices[a],o));if(l<0)return!1}}return!0},e.prototype.computeDistanceProxy=function(i){for(var n=0;n<this.m_count;++n)i.m_vertices[n]=this.m_vertices[n];i.m_vertices.length=this.m_count,i.m_count=this.m_count,i.m_radius=this.m_radius},e.TYPE="polygon",e}(Nm);function JXe(s,e){for(var i=$.zero(),n=0,r=$.zero(),o,a=1/3,o=0;o<e;++o){var l=r,h=s[o],d=o+1<e?s[o+1]:s[0],f=$.sub(h,l),p=$.sub(d,l),g=$.crossVec2Vec2(f,p),y=.5*g;n+=y,Lc(kp,1,l,1,h,1,d),ql(i,y*a,kp)}return i.mul(1/n),i}var eWe=Math.sqrt,tWe=Math.PI,B8=ze(0,0),ff=function(s){oo(e,s);function e(i,n){var r=this;return r instanceof e?(r=s.call(this)||this,r.m_type=e.TYPE,r.m_p=$.zero(),r.m_radius=1,typeof i=="object"&&$.isValid(i)?(r.m_p.setVec2(i),typeof n=="number"&&(r.m_radius=n)):typeof i=="number"&&(r.m_radius=i),r):new e(i,n)}return e.prototype._serialize=function(){return{type:this.m_type,p:this.m_p,radius:this.m_radius}},e._deserialize=function(i){return new e(i.p,i.radius)},e.prototype._reset=function(){},e.prototype.getType=function(){return this.m_type},e.prototype.getRadius=function(){return this.m_radius},e.prototype.getCenter=function(){return this.m_p},e.prototype._clone=function(){var i=new e;return i.m_type=this.m_type,i.m_radius=this.m_radius,i.m_p=this.m_p.clone(),i},e.prototype.getChildCount=function(){return 1},e.prototype.testPoint=function(i,n){var r=bi(B8,i,this.m_p);return sm(n,r)<=this.m_radius*this.m_radius},e.prototype.rayCast=function(i,n,r,o){var a=$.add(r.p,Ye.mulVec2(r.q,this.m_p)),l=$.sub(n.p1,a),h=$.dot(l,l)-this.m_radius*this.m_radius,d=$.sub(n.p2,n.p1),f=$.dot(l,d),p=$.dot(d,d),g=f*f-p*h;if(g<0||p<ta)return!1;var y=-(f+eWe(g));return 0<=y&&y<=n.maxFraction*p?(y/=p,i.fraction=y,i.normal=$.add(l,$.mulNumVec2(y,d)),i.normal.normalize(),!0):!1},e.prototype.computeAABB=function(i,n,r){var o=bi(B8,n,this.m_p);br(i.lowerBound,o.x-this.m_radius,o.y-this.m_radius),br(i.upperBound,o.x+this.m_radius,o.y+this.m_radius)},e.prototype.computeMass=function(i,n){i.mass=n*tWe*this.m_radius*this.m_radius,Pe(i.center,this.m_p),i.I=i.mass*(.5*this.m_radius*this.m_radius+nm(this.m_p))},e.prototype.computeDistanceProxy=function(i){i.m_vertices[0]=this.m_p,i.m_vertices.length=1,i.m_count=1,i.m_radius=this.m_radius},e.TYPE="circle",e}(Nm),iWe=ff,nWe=Math.abs,sWe=Math.PI,rWe={frequencyHz:0,dampingRatio:0},QR=function(s){oo(e,s);function e(i,n,r,o,a){var l=this;if(!(l instanceof e))return new e(i,n,r,o,a);if(r&&o&&"m_type"in o&&"x"in r&&"y"in r){var h=r;r=o,o=h}return i=Fa(i,rWe),l=s.call(this,i,n,r)||this,n=l.m_bodyA,r=l.m_bodyB,l.m_type=e.TYPE,l.m_localAnchorA=$.clone(o?n.getLocalPoint(o):i.localAnchorA||$.zero()),l.m_localAnchorB=$.clone(a?r.getLocalPoint(a):i.localAnchorB||$.zero()),l.m_length=Number.isFinite(i.length)?i.length:$.distance(n.getWorldPoint(l.m_localAnchorA),r.getWorldPoint(l.m_localAnchorB)),l.m_frequencyHz=i.frequencyHz,l.m_dampingRatio=i.dampingRatio,l.m_impulse=0,l.m_gamma=0,l.m_bias=0,l}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,length:this.m_length,impulse:this.m_impulse,gamma:this.m_gamma,bias:this.m_bias}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n);var o=new e(i);return o},e.prototype._reset=function(i){i.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(i.anchorA)):i.localAnchorA&&this.m_localAnchorA.setVec2(i.localAnchorA),i.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(i.anchorB)):i.localAnchorB&&this.m_localAnchorB.setVec2(i.localAnchorB),i.length>0?this.m_length=+i.length:i.length<0||(i.anchorA||i.anchorA||i.anchorA||i.anchorA)&&(this.m_length=$.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB))),Number.isFinite(i.frequencyHz)&&(this.m_frequencyHz=i.frequencyHz),Number.isFinite(i.dampingRatio)&&(this.m_dampingRatio=i.dampingRatio)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.setLength=function(i){this.m_length=i},e.prototype.getLength=function(){return this.m_length},e.prototype.setFrequency=function(i){this.m_frequencyHz=i},e.prototype.getFrequency=function(){return this.m_frequencyHz},e.prototype.setDampingRatio=function(i){this.m_dampingRatio=i},e.prototype.getDampingRatio=function(){return this.m_dampingRatio},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.mulNumVec2(this.m_impulse,this.m_u).mul(i)},e.prototype.getReactionTorque=function(i){return 0},e.prototype.initVelocityConstraints=function(i){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,a=this.m_bodyA.c_velocity.w,l=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,d=this.m_bodyB.c_velocity.v,f=this.m_bodyB.c_velocity.w,p=Ye.neo(r),g=Ye.neo(h);this.m_rA=Ye.mulVec2(p,$.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Ye.mulVec2(g,$.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=$.sub($.add(l,this.m_rB),$.add(n,this.m_rA));var y=this.m_u.length();y>wt.linearSlop?this.m_u.mul(1/y):this.m_u.setNum(0,0);var x=$.crossVec2Vec2(this.m_rA,this.m_u),_=$.crossVec2Vec2(this.m_rB,this.m_u),w=this.m_invMassA+this.m_invIA*x*x+this.m_invMassB+this.m_invIB*_*_;if(this.m_mass=w!=0?1/w:0,this.m_frequencyHz>0){var O=y-this.m_length,T=2*sWe*this.m_frequencyHz,C=2*this.m_mass*this.m_dampingRatio*T,A=this.m_mass*T*T,B=i.dt;this.m_gamma=B*(C+B*A),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_bias=O*B*A*this.m_gamma,w+=this.m_gamma,this.m_mass=w!=0?1/w:0}else this.m_gamma=0,this.m_bias=0;if(i.warmStarting){this.m_impulse*=i.dtRatio;var I=$.mulNumVec2(this.m_impulse,this.m_u);o.subMul(this.m_invMassA,I),a-=this.m_invIA*$.crossVec2Vec2(this.m_rA,I),d.addMul(this.m_invMassB,I),f+=this.m_invIB*$.crossVec2Vec2(this.m_rB,I)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.setVec2(o),this.m_bodyA.c_velocity.w=a,this.m_bodyB.c_velocity.v.setVec2(d),this.m_bodyB.c_velocity.w=f},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,a=this.m_bodyB.c_velocity.w,l=$.add(n,$.crossNumVec2(r,this.m_rA)),h=$.add(o,$.crossNumVec2(a,this.m_rB)),d=$.dot(this.m_u,h)-$.dot(this.m_u,l),f=-this.m_mass*(d+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;var p=$.mulNumVec2(f,this.m_u);n.subMul(this.m_invMassA,p),r-=this.m_invIA*$.crossVec2Vec2(this.m_rA,p),o.addMul(this.m_invMassB,p),a+=this.m_invIB*$.crossVec2Vec2(this.m_rB,p),this.m_bodyA.c_velocity.v.setVec2(n),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.setVec2(o),this.m_bodyB.c_velocity.w=a},e.prototype.solvePositionConstraints=function(i){if(this.m_frequencyHz>0)return!0;var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,a=this.m_bodyB.c_position.a,l=Ye.neo(r),h=Ye.neo(a),d=Ye.mulSub(l,this.m_localAnchorA,this.m_localCenterA),f=Ye.mulSub(h,this.m_localAnchorB,this.m_localCenterB),p=$.sub($.add(o,f),$.add(n,d)),g=p.normalize(),y=wr(g-this.m_length,-wt.maxLinearCorrection,wt.maxLinearCorrection),x=-this.m_mass*y,_=$.mulNumVec2(x,p);return n.subMul(this.m_invMassA,_),r-=this.m_invIA*$.crossVec2Vec2(d,_),o.addMul(this.m_invMassB,_),a+=this.m_invIB*$.crossVec2Vec2(f,_),this.m_bodyA.c_position.c.setVec2(n),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=a,nWe(y)<wt.linearSlop},e.TYPE="distance-joint",e}(Kr),oWe={maxForce:0,maxTorque:0},R8=function(s){oo(e,s);function e(i,n,r,o){var a=this;return a instanceof e?(i=Fa(i,oWe),a=s.call(this,i,n,r)||this,n=a.m_bodyA,r=a.m_bodyB,a.m_type=e.TYPE,a.m_localAnchorA=$.clone(o?n.getLocalPoint(o):i.localAnchorA||$.zero()),a.m_localAnchorB=$.clone(o?r.getLocalPoint(o):i.localAnchorB||$.zero()),a.m_linearImpulse=$.zero(),a.m_angularImpulse=0,a.m_maxForce=i.maxForce,a.m_maxTorque=i.maxTorque,a):new e(i,n,r,o)}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n);var o=new e(i);return o},e.prototype._reset=function(i){i.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(i.anchorA)):i.localAnchorA&&this.m_localAnchorA.setVec2(i.localAnchorA),i.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(i.anchorB)):i.localAnchorB&&this.m_localAnchorB.setVec2(i.localAnchorB),Number.isFinite(i.maxForce)&&(this.m_maxForce=i.maxForce),Number.isFinite(i.maxTorque)&&(this.m_maxTorque=i.maxTorque)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.setMaxForce=function(i){this.m_maxForce=i},e.prototype.getMaxForce=function(){return this.m_maxForce},e.prototype.setMaxTorque=function(i){this.m_maxTorque=i},e.prototype.getMaxTorque=function(){return this.m_maxTorque},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.mulNumVec2(i,this.m_linearImpulse)},e.prototype.getReactionTorque=function(i){return i*this.m_angularImpulse},e.prototype.initVelocityConstraints=function(i){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,d=Ye.neo(n),f=Ye.neo(a);this.m_rA=Ye.mulVec2(d,$.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Ye.mulVec2(f,$.sub(this.m_localAnchorB,this.m_localCenterB));var p=this.m_invMassA,g=this.m_invMassB,y=this.m_invIA,x=this.m_invIB,_=new ic;if(_.ex.x=p+g+y*this.m_rA.y*this.m_rA.y+x*this.m_rB.y*this.m_rB.y,_.ex.y=-y*this.m_rA.x*this.m_rA.y-x*this.m_rB.x*this.m_rB.y,_.ey.x=_.ex.y,_.ey.y=p+g+y*this.m_rA.x*this.m_rA.x+x*this.m_rB.x*this.m_rB.x,this.m_linearMass=_.getInverse(),this.m_angularMass=y+x,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),i.warmStarting){this.m_linearImpulse.mul(i.dtRatio),this.m_angularImpulse*=i.dtRatio;var w=$.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);r.subMul(p,w),o-=y*($.crossVec2Vec2(this.m_rA,w)+this.m_angularImpulse),l.addMul(g,w),h+=x*($.crossVec2Vec2(this.m_rB,w)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=r,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=l,this.m_bodyB.c_velocity.w=h},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,a=this.m_bodyB.c_velocity.w,l=this.m_invMassA,h=this.m_invMassB,d=this.m_invIA,f=this.m_invIB,p=i.dt;{var g=a-r,y=-this.m_angularMass*g,x=this.m_angularImpulse,_=p*this.m_maxTorque;this.m_angularImpulse=wr(this.m_angularImpulse+y,-_,_),y=this.m_angularImpulse-x,r-=d*y,a+=f*y}{var g=$.sub($.add(o,$.crossNumVec2(a,this.m_rB)),$.add(n,$.crossNumVec2(r,this.m_rA))),y=$.neg(ic.mulVec2(this.m_linearMass,g)),x=this.m_linearImpulse;this.m_linearImpulse.add(y);var _=p*this.m_maxForce;this.m_linearImpulse.lengthSquared()>_*_&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(_)),y=$.sub(this.m_linearImpulse,x),n.subMul(l,y),r-=d*$.crossVec2Vec2(this.m_rA,y),o.addMul(h,y),a+=f*$.crossVec2Vec2(this.m_rB,y)}this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=a},e.prototype.solvePositionConstraints=function(i){return!0},e.TYPE="friction-joint",e}(Kr),Nd=function(){function s(e,i,n){typeof e=="object"&&e!==null?(this.ex=on.clone(e),this.ey=on.clone(i),this.ez=on.clone(n)):(this.ex=on.zero(),this.ey=on.zero(),this.ez=on.zero())}return s.prototype.toString=function(){return JSON.stringify(this)},s.isValid=function(e){return e===null||typeof e>"u"?!1:on.isValid(e.ex)&&on.isValid(e.ey)&&on.isValid(e.ez)},s.assert=function(e){},s.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},s.prototype.solve33=function(e){var i=this.ey.y*this.ez.z-this.ey.z*this.ez.y,n=this.ey.z*this.ez.x-this.ey.x*this.ez.z,r=this.ey.x*this.ez.y-this.ey.y*this.ez.x,o=this.ex.x*i+this.ex.y*n+this.ex.z*r;o!==0&&(o=1/o);var a=new on;return i=this.ey.y*this.ez.z-this.ey.z*this.ez.y,n=this.ey.z*this.ez.x-this.ey.x*this.ez.z,r=this.ey.x*this.ez.y-this.ey.y*this.ez.x,a.x=o*(e.x*i+e.y*n+e.z*r),i=e.y*this.ez.z-e.z*this.ez.y,n=e.z*this.ez.x-e.x*this.ez.z,r=e.x*this.ez.y-e.y*this.ez.x,a.y=o*(this.ex.x*i+this.ex.y*n+this.ex.z*r),i=this.ey.y*e.z-this.ey.z*e.y,n=this.ey.z*e.x-this.ey.x*e.z,r=this.ey.x*e.y-this.ey.y*e.x,a.z=o*(this.ex.x*i+this.ex.y*n+this.ex.z*r),a},s.prototype.solve22=function(e){var i=this.ex.x,n=this.ey.x,r=this.ex.y,o=this.ey.y,a=i*o-n*r;a!==0&&(a=1/a);var l=$.zero();return l.x=a*(o*e.x-n*e.y),l.y=a*(i*e.y-r*e.x),l},s.prototype.getInverse22=function(e){var i=this.ex.x,n=this.ey.x,r=this.ex.y,o=this.ey.y,a=i*o-n*r;a!==0&&(a=1/a),e.ex.x=a*o,e.ey.x=-a*n,e.ex.z=0,e.ex.y=-a*r,e.ey.y=a*i,e.ey.z=0,e.ez.x=0,e.ez.y=0,e.ez.z=0},s.prototype.getSymInverse33=function(e){var i=on.dot(this.ex,on.cross(this.ey,this.ez));i!==0&&(i=1/i);var n=this.ex.x,r=this.ey.x,o=this.ez.x,a=this.ey.y,l=this.ez.y,h=this.ez.z;e.ex.x=i*(a*h-l*l),e.ex.y=i*(o*l-r*h),e.ex.z=i*(r*l-o*a),e.ey.x=e.ex.y,e.ey.y=i*(n*h-o*o),e.ey.z=i*(o*r-n*l),e.ez.x=e.ex.z,e.ez.y=e.ey.z,e.ez.z=i*(n*a-r*r)},s.mul=function(e,i){if(i&&"z"in i&&"y"in i&&"x"in i){var n=e.ex.x*i.x+e.ey.x*i.y+e.ez.x*i.z,r=e.ex.y*i.x+e.ey.y*i.y+e.ez.y*i.z,o=e.ex.z*i.x+e.ey.z*i.y+e.ez.z*i.z;return new on(n,r,o)}else if(i&&"y"in i&&"x"in i){var n=e.ex.x*i.x+e.ey.x*i.y,r=e.ex.y*i.x+e.ey.y*i.y;return $.neo(n,r)}},s.mulVec3=function(e,i){var n=e.ex.x*i.x+e.ey.x*i.y+e.ez.x*i.z,r=e.ex.y*i.x+e.ey.y*i.y+e.ez.y*i.z,o=e.ex.z*i.x+e.ey.z*i.y+e.ez.z*i.z;return new on(n,r,o)},s.mulVec2=function(e,i){var n=e.ex.x*i.x+e.ey.x*i.y,r=e.ex.y*i.x+e.ey.y*i.y;return $.neo(n,r)},s.add=function(e,i){return new s(on.add(e.ex,i.ex),on.add(e.ey,i.ey),on.add(e.ez,i.ez))},s}(),D8=Math.abs,er;(function(s){s[s.inactiveLimit=0]="inactiveLimit",s[s.atLowerLimit=1]="atLowerLimit",s[s.atUpperLimit=2]="atUpperLimit",s[s.equalLimits=3]="equalLimits"})(er||(er={}));var Qg={lowerAngle:0,upperAngle:0,maxMotorTorque:0,motorSpeed:0,enableLimit:!1,enableMotor:!1},Id=function(s){oo(e,s);function e(i,n,r,o){var a=this,l,h,d,f,p,g;return a instanceof e?(i=i??{},a=s.call(this,i,n,r)||this,n=a.m_bodyA,r=a.m_bodyB,a.m_mass=new Nd,a.m_limitState=er.inactiveLimit,a.m_type=e.TYPE,$.isValid(o)?a.m_localAnchorA=n.getLocalPoint(o):$.isValid(i.localAnchorA)?a.m_localAnchorA=$.clone(i.localAnchorA):a.m_localAnchorA=$.zero(),$.isValid(o)?a.m_localAnchorB=r.getLocalPoint(o):$.isValid(i.localAnchorB)?a.m_localAnchorB=$.clone(i.localAnchorB):a.m_localAnchorB=$.zero(),Number.isFinite(i.referenceAngle)?a.m_referenceAngle=i.referenceAngle:a.m_referenceAngle=r.getAngle()-n.getAngle(),a.m_impulse=new on,a.m_motorImpulse=0,a.m_lowerAngle=(l=i.lowerAngle)!==null&&l!==void 0?l:Qg.lowerAngle,a.m_upperAngle=(h=i.upperAngle)!==null&&h!==void 0?h:Qg.upperAngle,a.m_maxMotorTorque=(d=i.maxMotorTorque)!==null&&d!==void 0?d:Qg.maxMotorTorque,a.m_motorSpeed=(f=i.motorSpeed)!==null&&f!==void 0?f:Qg.motorSpeed,a.m_enableLimit=(p=i.enableLimit)!==null&&p!==void 0?p:Qg.enableLimit,a.m_enableMotor=(g=i.enableMotor)!==null&&g!==void 0?g:Qg.enableMotor,a):new e(i,n,r,o)}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerAngle:this.m_lowerAngle,upperAngle:this.m_upperAngle,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n);var o=new e(i);return o},e.prototype._reset=function(i){i.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(i.anchorA)):i.localAnchorA&&this.m_localAnchorA.setVec2(i.localAnchorA),i.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(i.anchorB)):i.localAnchorB&&this.m_localAnchorB.setVec2(i.localAnchorB),Number.isFinite(i.referenceAngle)&&(this.m_referenceAngle=i.referenceAngle),i.enableLimit!==void 0&&(this.m_enableLimit=i.enableLimit),Number.isFinite(i.lowerAngle)&&(this.m_lowerAngle=i.lowerAngle),Number.isFinite(i.upperAngle)&&(this.m_upperAngle=i.upperAngle),Number.isFinite(i.maxMotorTorque)&&(this.m_maxMotorTorque=i.maxMotorTorque),Number.isFinite(i.motorSpeed)&&(this.m_motorSpeed=i.motorSpeed),i.enableMotor!==void 0&&(this.m_enableMotor=i.enableMotor)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.getReferenceAngle=function(){return this.m_referenceAngle},e.prototype.getJointAngle=function(){var i=this.m_bodyA,n=this.m_bodyB;return n.m_sweep.a-i.m_sweep.a-this.m_referenceAngle},e.prototype.getJointSpeed=function(){var i=this.m_bodyA,n=this.m_bodyB;return n.m_angularVelocity-i.m_angularVelocity},e.prototype.isMotorEnabled=function(){return this.m_enableMotor},e.prototype.enableMotor=function(i){i!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=i)},e.prototype.getMotorTorque=function(i){return i*this.m_motorImpulse},e.prototype.setMotorSpeed=function(i){i!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=i)},e.prototype.getMotorSpeed=function(){return this.m_motorSpeed},e.prototype.setMaxMotorTorque=function(i){i!=this.m_maxMotorTorque&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=i)},e.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},e.prototype.isLimitEnabled=function(){return this.m_enableLimit},e.prototype.enableLimit=function(i){i!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=i,this.m_impulse.z=0)},e.prototype.getLowerLimit=function(){return this.m_lowerAngle},e.prototype.getUpperLimit=function(){return this.m_upperAngle},e.prototype.setLimits=function(i,n){(i!=this.m_lowerAngle||n!=this.m_upperAngle)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=i,this.m_upperAngle=n)},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.neo(this.m_impulse.x,this.m_impulse.y).mul(i)},e.prototype.getReactionTorque=function(i){return i*this.m_impulse.z},e.prototype.initVelocityConstraints=function(i){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,d=Ye.neo(n),f=Ye.neo(a);this.m_rA=Ye.mulVec2(d,$.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Ye.mulVec2(f,$.sub(this.m_localAnchorB,this.m_localCenterB));var p=this.m_invMassA,g=this.m_invMassB,y=this.m_invIA,x=this.m_invIB,_=y+x===0;if(this.m_mass.ex.x=p+g+this.m_rA.y*this.m_rA.y*y+this.m_rB.y*this.m_rB.y*x,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*y-this.m_rB.y*this.m_rB.x*x,this.m_mass.ez.x=-this.m_rA.y*y-this.m_rB.y*x,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=p+g+this.m_rA.x*this.m_rA.x*y+this.m_rB.x*this.m_rB.x*x,this.m_mass.ez.y=this.m_rA.x*y+this.m_rB.x*x,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=y+x,this.m_motorMass=y+x,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(this.m_enableMotor==!1||_)&&(this.m_motorImpulse=0),this.m_enableLimit&&_==!1){var w=a-n-this.m_referenceAngle;D8(this.m_upperAngle-this.m_lowerAngle)<2*wt.angularSlop?this.m_limitState=er.equalLimits:w<=this.m_lowerAngle?(this.m_limitState!=er.atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=er.atLowerLimit):w>=this.m_upperAngle?(this.m_limitState!=er.atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=er.atUpperLimit):(this.m_limitState=er.inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=er.inactiveLimit;if(i.warmStarting){this.m_impulse.mul(i.dtRatio),this.m_motorImpulse*=i.dtRatio;var O=$.neo(this.m_impulse.x,this.m_impulse.y);r.subMul(p,O),o-=y*($.crossVec2Vec2(this.m_rA,O)+this.m_motorImpulse+this.m_impulse.z),l.addMul(g,O),h+=x*($.crossVec2Vec2(this.m_rB,O)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=r,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=l,this.m_bodyB.c_velocity.w=h},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,a=this.m_bodyB.c_velocity.w,l=this.m_invMassA,h=this.m_invMassB,d=this.m_invIA,f=this.m_invIB,p=d+f===0;if(this.m_enableMotor&&this.m_limitState!=er.equalLimits&&p==!1){var g=a-r-this.m_motorSpeed,y=-this.m_motorMass*g,x=this.m_motorImpulse,_=i.dt*this.m_maxMotorTorque;this.m_motorImpulse=wr(this.m_motorImpulse+y,-_,_),y=this.m_motorImpulse-x,r-=d*y,a+=f*y}if(this.m_enableLimit&&this.m_limitState!=er.inactiveLimit&&p==!1){var w=$.zero();w.addCombine(1,o,1,$.crossNumVec2(a,this.m_rB)),w.subCombine(1,n,1,$.crossNumVec2(r,this.m_rA));var O=a-r,g=new on(w.x,w.y,O),y=on.neg(this.m_mass.solve33(g));if(this.m_limitState==er.equalLimits)this.m_impulse.add(y);else if(this.m_limitState==er.atLowerLimit){var T=this.m_impulse.z+y.z;if(T<0){var C=$.combine(-1,w,this.m_impulse.z,$.neo(this.m_mass.ez.x,this.m_mass.ez.y)),A=this.m_mass.solve22(C);y.x=A.x,y.y=A.y,y.z=-this.m_impulse.z,this.m_impulse.x+=A.x,this.m_impulse.y+=A.y,this.m_impulse.z=0}else this.m_impulse.add(y)}else if(this.m_limitState==er.atUpperLimit){var T=this.m_impulse.z+y.z;if(T>0){var C=$.combine(-1,w,this.m_impulse.z,$.neo(this.m_mass.ez.x,this.m_mass.ez.y)),A=this.m_mass.solve22(C);y.x=A.x,y.y=A.y,y.z=-this.m_impulse.z,this.m_impulse.x+=A.x,this.m_impulse.y+=A.y,this.m_impulse.z=0}else this.m_impulse.add(y)}var B=$.neo(y.x,y.y);n.subMul(l,B),r-=d*($.crossVec2Vec2(this.m_rA,B)+y.z),o.addMul(h,B),a+=f*($.crossVec2Vec2(this.m_rB,B)+y.z)}else{var g=$.zero();g.addCombine(1,o,1,$.crossNumVec2(a,this.m_rB)),g.subCombine(1,n,1,$.crossNumVec2(r,this.m_rA));var y=this.m_mass.solve22($.neg(g));this.m_impulse.x+=y.x,this.m_impulse.y+=y.y,n.subMul(l,y),r-=d*$.crossVec2Vec2(this.m_rA,y),o.addMul(h,y),a+=f*$.crossVec2Vec2(this.m_rB,y)}this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=a},e.prototype.solvePositionConstraints=function(i){var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,a=this.m_bodyB.c_position.a,l=Ye.neo(r),h=Ye.neo(a),d=0,f=0,p=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&this.m_limitState!=er.inactiveLimit&&p==!1){var g=a-r-this.m_referenceAngle,y=0;if(this.m_limitState==er.equalLimits){var x=wr(g-this.m_lowerAngle,-wt.maxAngularCorrection,wt.maxAngularCorrection);y=-this.m_motorMass*x,d=D8(x)}else if(this.m_limitState==er.atLowerLimit){var x=g-this.m_lowerAngle;d=-x,x=wr(x+wt.angularSlop,-wt.maxAngularCorrection,0),y=-this.m_motorMass*x}else if(this.m_limitState==er.atUpperLimit){var x=g-this.m_upperAngle;d=x,x=wr(x-wt.angularSlop,0,wt.maxAngularCorrection),y=-this.m_motorMass*x}r-=this.m_invIA*y,a+=this.m_invIB*y}{l.setAngle(r),h.setAngle(a);var _=Ye.mulVec2(l,$.sub(this.m_localAnchorA,this.m_localCenterA)),w=Ye.mulVec2(h,$.sub(this.m_localAnchorB,this.m_localCenterB)),x=$.zero();x.addCombine(1,o,1,w),x.subCombine(1,n,1,_),f=x.length();var O=this.m_invMassA,T=this.m_invMassB,C=this.m_invIA,A=this.m_invIB,B=new ic;B.ex.x=O+T+C*_.y*_.y+A*w.y*w.y,B.ex.y=-C*_.x*_.y-A*w.x*w.y,B.ey.x=B.ex.y,B.ey.y=O+T+C*_.x*_.x+A*w.x*w.x;var I=$.neg(B.solve(x));n.subMul(O,I),r-=C*$.crossVec2Vec2(_,I),o.addMul(T,I),a+=A*$.crossVec2Vec2(w,I)}return this.m_bodyA.c_position.c.setVec2(n),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=a,f<=wt.linearSlop&&d<=wt.angularSlop},e.TYPE="revolute-joint",e}(Kr),mx=Math.abs,L8=Math.max,aWe=Math.min,Uo;(function(s){s[s.inactiveLimit=0]="inactiveLimit",s[s.atLowerLimit=1]="atLowerLimit",s[s.atUpperLimit=2]="atUpperLimit",s[s.equalLimits=3]="equalLimits"})(Uo||(Uo={}));var lWe={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:0,motorSpeed:0},N8=function(s){oo(e,s);function e(i,n,r,o,a){var l=this;return l instanceof e?(i=Fa(i,lWe),l=s.call(this,i,n,r)||this,n=l.m_bodyA,r=l.m_bodyB,l.m_type=e.TYPE,l.m_localAnchorA=$.clone(o?n.getLocalPoint(o):i.localAnchorA||$.zero()),l.m_localAnchorB=$.clone(o?r.getLocalPoint(o):i.localAnchorB||$.zero()),l.m_localXAxisA=$.clone(a?n.getLocalVector(a):i.localAxisA||$.neo(1,0)),l.m_localXAxisA.normalize(),l.m_localYAxisA=$.crossNumVec2(1,l.m_localXAxisA),l.m_referenceAngle=Number.isFinite(i.referenceAngle)?i.referenceAngle:r.getAngle()-n.getAngle(),l.m_impulse=new on,l.m_motorMass=0,l.m_motorImpulse=0,l.m_lowerTranslation=i.lowerTranslation,l.m_upperTranslation=i.upperTranslation,l.m_maxMotorForce=i.maxMotorForce,l.m_motorSpeed=i.motorSpeed,l.m_enableLimit=i.enableLimit,l.m_enableMotor=i.enableMotor,l.m_limitState=Uo.inactiveLimit,l.m_axis=$.zero(),l.m_perp=$.zero(),l.m_K=new Nd,l):new e(i,n,r,o,a)}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerTranslation:this.m_lowerTranslation,upperTranslation:this.m_upperTranslation,maxMotorForce:this.m_maxMotorForce,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA,referenceAngle:this.m_referenceAngle}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n),i.localAxisA=$.clone(i.localAxisA);var o=new e(i);return o},e.prototype._reset=function(i){i.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(i.anchorA)):i.localAnchorA&&this.m_localAnchorA.setVec2(i.localAnchorA),i.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(i.anchorB)):i.localAnchorB&&this.m_localAnchorB.setVec2(i.localAnchorB),i.localAxisA&&(this.m_localXAxisA.setVec2(i.localAxisA),this.m_localYAxisA.setVec2($.crossNumVec2(1,i.localAxisA))),Number.isFinite(i.referenceAngle)&&(this.m_referenceAngle=i.referenceAngle),typeof i.enableLimit<"u"&&(this.m_enableLimit=!!i.enableLimit),Number.isFinite(i.lowerTranslation)&&(this.m_lowerTranslation=i.lowerTranslation),Number.isFinite(i.upperTranslation)&&(this.m_upperTranslation=i.upperTranslation),typeof i.enableMotor<"u"&&(this.m_enableMotor=!!i.enableMotor),Number.isFinite(i.maxMotorForce)&&(this.m_maxMotorForce=i.maxMotorForce),Number.isFinite(i.motorSpeed)&&(this.m_motorSpeed=i.motorSpeed)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.getLocalAxisA=function(){return this.m_localXAxisA},e.prototype.getReferenceAngle=function(){return this.m_referenceAngle},e.prototype.getJointTranslation=function(){var i=this.m_bodyA.getWorldPoint(this.m_localAnchorA),n=this.m_bodyB.getWorldPoint(this.m_localAnchorB),r=$.sub(n,i),o=this.m_bodyA.getWorldVector(this.m_localXAxisA),a=$.dot(r,o);return a},e.prototype.getJointSpeed=function(){var i=this.m_bodyA,n=this.m_bodyB,r=Ye.mulVec2(i.m_xf.q,$.sub(this.m_localAnchorA,i.m_sweep.localCenter)),o=Ye.mulVec2(n.m_xf.q,$.sub(this.m_localAnchorB,n.m_sweep.localCenter)),a=$.add(i.m_sweep.c,r),l=$.add(n.m_sweep.c,o),h=$.sub(l,a),d=Ye.mulVec2(i.m_xf.q,this.m_localXAxisA),f=i.m_linearVelocity,p=n.m_linearVelocity,g=i.m_angularVelocity,y=n.m_angularVelocity,x=$.dot(h,$.crossNumVec2(g,d))+$.dot(d,$.sub($.addCrossNumVec2(p,y,o),$.addCrossNumVec2(f,g,r)));return x},e.prototype.isLimitEnabled=function(){return this.m_enableLimit},e.prototype.enableLimit=function(i){i!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=i,this.m_impulse.z=0)},e.prototype.getLowerLimit=function(){return this.m_lowerTranslation},e.prototype.getUpperLimit=function(){return this.m_upperTranslation},e.prototype.setLimits=function(i,n){(i!=this.m_lowerTranslation||n!=this.m_upperTranslation)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=i,this.m_upperTranslation=n,this.m_impulse.z=0)},e.prototype.isMotorEnabled=function(){return this.m_enableMotor},e.prototype.enableMotor=function(i){i!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=i)},e.prototype.setMotorSpeed=function(i){i!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=i)},e.prototype.setMaxMotorForce=function(i){i!=this.m_maxMotorForce&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=i)},e.prototype.getMaxMotorForce=function(){return this.m_maxMotorForce},e.prototype.getMotorSpeed=function(){return this.m_motorSpeed},e.prototype.getMotorForce=function(i){return i*this.m_motorImpulse},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(i)},e.prototype.getReactionTorque=function(i){return i*this.m_impulse.y},e.prototype.initVelocityConstraints=function(i){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,a=this.m_bodyA.c_velocity.w,l=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,d=this.m_bodyB.c_velocity.v,f=this.m_bodyB.c_velocity.w,p=Ye.neo(r),g=Ye.neo(h),y=Ye.mulVec2(p,$.sub(this.m_localAnchorA,this.m_localCenterA)),x=Ye.mulVec2(g,$.sub(this.m_localAnchorB,this.m_localCenterB)),_=$.zero();_.addCombine(1,l,1,x),_.subCombine(1,n,1,y);var w=this.m_invMassA,O=this.m_invMassB,T=this.m_invIA,C=this.m_invIB;this.m_axis=Ye.mulVec2(p,this.m_localXAxisA),this.m_a1=$.crossVec2Vec2($.add(_,y),this.m_axis),this.m_a2=$.crossVec2Vec2(x,this.m_axis),this.m_motorMass=w+O+T*this.m_a1*this.m_a1+C*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass);{this.m_perp=Ye.mulVec2(p,this.m_localYAxisA),this.m_s1=$.crossVec2Vec2($.add(_,y),this.m_perp),this.m_s2=$.crossVec2Vec2(x,this.m_perp),$.crossVec2Vec2(y,this.m_perp);var A=w+O+T*this.m_s1*this.m_s1+C*this.m_s2*this.m_s2,B=T*this.m_s1+C*this.m_s2,I=T*this.m_s1*this.m_a1+C*this.m_s2*this.m_a2,R=T+C;R==0&&(R=1);var P=T*this.m_a1+C*this.m_a2,k=w+O+T*this.m_a1*this.m_a1+C*this.m_a2*this.m_a2;this.m_K.ex.set(A,B,I),this.m_K.ey.set(B,R,P),this.m_K.ez.set(I,P,k)}if(this.m_enableLimit){var E=$.dot(this.m_axis,_);mx(this.m_upperTranslation-this.m_lowerTranslation)<2*wt.linearSlop?this.m_limitState=Uo.equalLimits:E<=this.m_lowerTranslation?this.m_limitState!=Uo.atLowerLimit&&(this.m_limitState=Uo.atLowerLimit,this.m_impulse.z=0):E>=this.m_upperTranslation?this.m_limitState!=Uo.atUpperLimit&&(this.m_limitState=Uo.atUpperLimit,this.m_impulse.z=0):(this.m_limitState=Uo.inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=Uo.inactiveLimit,this.m_impulse.z=0;if(this.m_enableMotor==!1&&(this.m_motorImpulse=0),i.warmStarting){this.m_impulse.mul(i.dtRatio),this.m_motorImpulse*=i.dtRatio;var D=$.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),L=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,V=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;o.subMul(w,D),a-=T*L,d.addMul(O,D),f+=C*V}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.setVec2(o),this.m_bodyA.c_velocity.w=a,this.m_bodyB.c_velocity.v.setVec2(d),this.m_bodyB.c_velocity.w=f},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,a=this.m_bodyB.c_velocity.w,l=this.m_invMassA,h=this.m_invMassB,d=this.m_invIA,f=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!=Uo.equalLimits){var p=$.dot(this.m_axis,$.sub(o,n))+this.m_a2*a-this.m_a1*r,g=this.m_motorMass*(this.m_motorSpeed-p),y=this.m_motorImpulse,x=i.dt*this.m_maxMotorForce;this.m_motorImpulse=wr(this.m_motorImpulse+g,-x,x),g=this.m_motorImpulse-y;var _=$.mulNumVec2(g,this.m_axis),w=g*this.m_a1,O=g*this.m_a2;n.subMul(l,_),r-=d*w,o.addMul(h,_),a+=f*O}var T=$.zero();if(T.x+=$.dot(this.m_perp,o)+this.m_s2*a,T.x-=$.dot(this.m_perp,n)+this.m_s1*r,T.y=a-r,this.m_enableLimit&&this.m_limitState!=Uo.inactiveLimit){var C=0;C+=$.dot(this.m_axis,o)+this.m_a2*a,C-=$.dot(this.m_axis,n)+this.m_a1*r;var p=new on(T.x,T.y,C),A=on.clone(this.m_impulse),B=this.m_K.solve33(on.neg(p));this.m_impulse.add(B),this.m_limitState==Uo.atLowerLimit?this.m_impulse.z=L8(this.m_impulse.z,0):this.m_limitState==Uo.atUpperLimit&&(this.m_impulse.z=aWe(this.m_impulse.z,0));var I=$.combine(-1,T,-(this.m_impulse.z-A.z),$.neo(this.m_K.ez.x,this.m_K.ez.y)),R=$.add(this.m_K.solve22(I),$.neo(A.x,A.y));this.m_impulse.x=R.x,this.m_impulse.y=R.y,B=on.sub(this.m_impulse,A);var _=$.combine(B.x,this.m_perp,B.z,this.m_axis),w=B.x*this.m_s1+B.y+B.z*this.m_a1,O=B.x*this.m_s2+B.y+B.z*this.m_a2;n.subMul(l,_),r-=d*w,o.addMul(h,_),a+=f*O}else{var B=this.m_K.solve22($.neg(T));this.m_impulse.x+=B.x,this.m_impulse.y+=B.y;var _=$.mulNumVec2(B.x,this.m_perp),w=B.x*this.m_s1+B.y,O=B.x*this.m_s2+B.y;n.subMul(l,_),r-=d*w,o.addMul(h,_),a+=f*O}this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=a},e.prototype.solvePositionConstraints=function(i){var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,a=this.m_bodyB.c_position.a,l=Ye.neo(r),h=Ye.neo(a),d=this.m_invMassA,f=this.m_invMassB,p=this.m_invIA,g=this.m_invIB,y=Ye.mulVec2(l,$.sub(this.m_localAnchorA,this.m_localCenterA)),x=Ye.mulVec2(h,$.sub(this.m_localAnchorB,this.m_localCenterB)),_=$.sub($.add(o,x),$.add(n,y)),w=Ye.mulVec2(l,this.m_localXAxisA),O=$.crossVec2Vec2($.add(_,y),w),T=$.crossVec2Vec2(x,w),C=Ye.mulVec2(l,this.m_localYAxisA),A=$.crossVec2Vec2($.add(_,y),C),B=$.crossVec2Vec2(x,C),I=new on,R=$.zero();R.x=$.dot(C,_),R.y=a-r-this.m_referenceAngle;var P=mx(R.x),k=mx(R.y),E=wt.linearSlop,D=wt.maxLinearCorrection,L=!1,V=0;if(this.m_enableLimit){var F=$.dot(w,_);mx(this.m_upperTranslation-this.m_lowerTranslation)<2*E?(V=wr(F,-D,D),P=L8(P,mx(F)),L=!0):F<=this.m_lowerTranslation?(V=wr(F-this.m_lowerTranslation+E,-D,0),P=Math.max(P,this.m_lowerTranslation-F),L=!0):F>=this.m_upperTranslation&&(V=wr(F-this.m_upperTranslation-E,0,D),P=Math.max(P,F-this.m_upperTranslation),L=!0)}if(L){var j=d+f+p*A*A+g*B*B,Q=p*A+g*B,ee=p*A*O+g*B*T,J=p+g;J==0&&(J=1);var ue=p*O+g*T,oe=d+f+p*O*O+g*T*T,pe=new Nd;pe.ex.set(j,Q,ee),pe.ey.set(Q,J,ue),pe.ez.set(ee,ue,oe);var Ue=new on;Ue.x=R.x,Ue.y=R.y,Ue.z=V,I=pe.solve33(on.neg(Ue))}else{var j=d+f+p*A*A+g*B*B,Q=p*A+g*B,J=p+g;J==0&&(J=1);var pe=new ic;pe.ex.setNum(j,Q),pe.ey.setNum(Q,J);var tt=pe.solve($.neg(R));I.x=tt.x,I.y=tt.y,I.z=0}var ve=$.combine(I.x,C,I.z,w),Re=I.x*A+I.y+I.z*O,Le=I.x*B+I.y+I.z*T;return n.subMul(d,ve),r-=p*Re,o.addMul(f,ve),a+=g*Le,this.m_bodyA.c_position.c=n,this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=a,P<=wt.linearSlop&&k<=wt.angularSlop},e.TYPE="prismatic-joint",e}(Kr),cWe={ratio:1},V8=function(s){oo(e,s);function e(i,n,r,o,a,l){var h=this;if(!(h instanceof e))return new e(i,n,r,o,a,l);i=Fa(i,cWe),h=s.call(this,i,n,r)||this,n=h.m_bodyA,r=h.m_bodyB,h.m_type=e.TYPE,h.m_joint1=o||i.joint1,h.m_joint2=a||i.joint2,h.m_ratio=Number.isFinite(l)?l:i.ratio,h.m_type1=h.m_joint1.getType(),h.m_type2=h.m_joint2.getType();var d,f;h.m_bodyC=h.m_joint1.getBodyA(),h.m_bodyA=h.m_joint1.getBodyB();var p=h.m_bodyA.m_xf,g=h.m_bodyA.m_sweep.a,y=h.m_bodyC.m_xf,x=h.m_bodyC.m_sweep.a;if(h.m_type1===Id.TYPE){var _=h.m_joint1;h.m_localAnchorC=_.m_localAnchorA,h.m_localAnchorA=_.m_localAnchorB,h.m_referenceAngleA=_.m_referenceAngle,h.m_localAxisC=$.zero(),d=g-x-h.m_referenceAngleA}else{var w=h.m_joint1;h.m_localAnchorC=w.m_localAnchorA,h.m_localAnchorA=w.m_localAnchorB,h.m_referenceAngleA=w.m_referenceAngle,h.m_localAxisC=w.m_localXAxisA;var O=h.m_localAnchorC,T=Ye.mulTVec2(y.q,$.add(Ye.mulVec2(p.q,h.m_localAnchorA),$.sub(p.p,y.p)));d=$.dot(T,h.m_localAxisC)-$.dot(O,h.m_localAxisC)}h.m_bodyD=h.m_joint2.getBodyA(),h.m_bodyB=h.m_joint2.getBodyB();var C=h.m_bodyB.m_xf,A=h.m_bodyB.m_sweep.a,B=h.m_bodyD.m_xf,I=h.m_bodyD.m_sweep.a;if(h.m_type2===Id.TYPE){var _=h.m_joint2;h.m_localAnchorD=_.m_localAnchorA,h.m_localAnchorB=_.m_localAnchorB,h.m_referenceAngleB=_.m_referenceAngle,h.m_localAxisD=$.zero(),f=A-I-h.m_referenceAngleB}else{var w=h.m_joint2;h.m_localAnchorD=w.m_localAnchorA,h.m_localAnchorB=w.m_localAnchorB,h.m_referenceAngleB=w.m_referenceAngle,h.m_localAxisD=w.m_localXAxisA;var R=h.m_localAnchorD,P=Ye.mulTVec2(B.q,$.add(Ye.mulVec2(C.q,h.m_localAnchorB),$.sub(C.p,B.p)));f=$.dot(P,h.m_localAxisD)-$.dot(R,h.m_localAxisD)}return h.m_constant=d+h.m_ratio*f,h.m_impulse=0,h}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,joint1:this.m_joint1,joint2:this.m_joint2,ratio:this.m_ratio}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n),i.joint1=r(Kr,i.joint1,n),i.joint2=r(Kr,i.joint2,n);var o=new e(i);return o},e.prototype._reset=function(i){Number.isFinite(i.ratio)&&(this.m_ratio=i.ratio)},e.prototype.getJoint1=function(){return this.m_joint1},e.prototype.getJoint2=function(){return this.m_joint2},e.prototype.setRatio=function(i){this.m_ratio=i},e.prototype.getRatio=function(){return this.m_ratio},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.mulNumVec2(this.m_impulse,this.m_JvAC).mul(i)},e.prototype.getReactionTorque=function(i){var n=this.m_impulse*this.m_JwA;return i*n},e.prototype.initVelocityConstraints=function(i){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var n=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,d=this.m_bodyC.c_position.a,f=this.m_bodyC.c_velocity.v,p=this.m_bodyC.c_velocity.w,g=this.m_bodyD.c_position.a,y=this.m_bodyD.c_velocity.v,x=this.m_bodyD.c_velocity.w,_=Ye.neo(n),w=Ye.neo(a),O=Ye.neo(d),T=Ye.neo(g);if(this.m_mass=0,this.m_type1==Id.TYPE)this.m_JvAC=$.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var C=Ye.mulVec2(O,this.m_localAxisC),A=Ye.mulSub(O,this.m_localAnchorC,this.m_lcC),B=Ye.mulSub(_,this.m_localAnchorA,this.m_lcA);this.m_JvAC=C,this.m_JwC=$.crossVec2Vec2(A,C),this.m_JwA=$.crossVec2Vec2(B,C),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==Id.TYPE)this.m_JvBD=$.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{var C=Ye.mulVec2(T,this.m_localAxisD),I=Ye.mulSub(T,this.m_localAnchorD,this.m_lcD),R=Ye.mulSub(w,this.m_localAnchorB,this.m_lcB);this.m_JvBD=$.mulNumVec2(this.m_ratio,C),this.m_JwD=this.m_ratio*$.crossVec2Vec2(I,C),this.m_JwB=this.m_ratio*$.crossVec2Vec2(R,C),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,i.warmStarting?(r.addMul(this.m_mA*this.m_impulse,this.m_JvAC),o+=this.m_iA*this.m_impulse*this.m_JwA,l.addMul(this.m_mB*this.m_impulse,this.m_JvBD),h+=this.m_iB*this.m_impulse*this.m_JwB,f.subMul(this.m_mC*this.m_impulse,this.m_JvAC),p-=this.m_iC*this.m_impulse*this.m_JwC,y.subMul(this.m_mD*this.m_impulse,this.m_JvBD),x-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.setVec2(r),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.setVec2(l),this.m_bodyB.c_velocity.w=h,this.m_bodyC.c_velocity.v.setVec2(f),this.m_bodyC.c_velocity.w=p,this.m_bodyD.c_velocity.v.setVec2(y),this.m_bodyD.c_velocity.w=x},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,a=this.m_bodyB.c_velocity.w,l=this.m_bodyC.c_velocity.v,h=this.m_bodyC.c_velocity.w,d=this.m_bodyD.c_velocity.v,f=this.m_bodyD.c_velocity.w,p=$.dot(this.m_JvAC,n)-$.dot(this.m_JvAC,l)+$.dot(this.m_JvBD,o)-$.dot(this.m_JvBD,d);p+=this.m_JwA*r-this.m_JwC*h+(this.m_JwB*a-this.m_JwD*f);var g=-this.m_mass*p;this.m_impulse+=g,n.addMul(this.m_mA*g,this.m_JvAC),r+=this.m_iA*g*this.m_JwA,o.addMul(this.m_mB*g,this.m_JvBD),a+=this.m_iB*g*this.m_JwB,l.subMul(this.m_mC*g,this.m_JvAC),h-=this.m_iC*g*this.m_JwC,d.subMul(this.m_mD*g,this.m_JvBD),f-=this.m_iD*g*this.m_JwD,this.m_bodyA.c_velocity.v.setVec2(n),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.setVec2(o),this.m_bodyB.c_velocity.w=a,this.m_bodyC.c_velocity.v.setVec2(l),this.m_bodyC.c_velocity.w=h,this.m_bodyD.c_velocity.v.setVec2(d),this.m_bodyD.c_velocity.w=f},e.prototype.solvePositionConstraints=function(i){var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,a=this.m_bodyB.c_position.a,l=this.m_bodyC.c_position.c,h=this.m_bodyC.c_position.a,d=this.m_bodyD.c_position.c,f=this.m_bodyD.c_position.a,p=Ye.neo(r),g=Ye.neo(a),y=Ye.neo(h),x=Ye.neo(f),_=0,w,O,T,C,A,B,I,R,P=0;if(this.m_type1==Id.TYPE)T=$.zero(),A=1,I=1,P+=this.m_iA+this.m_iC,w=r-h-this.m_referenceAngleA;else{var k=Ye.mulVec2(y,this.m_localAxisC),E=Ye.mulSub(y,this.m_localAnchorC,this.m_lcC),D=Ye.mulSub(p,this.m_localAnchorA,this.m_lcA);T=k,I=$.crossVec2Vec2(E,k),A=$.crossVec2Vec2(D,k),P+=this.m_mC+this.m_mA+this.m_iC*I*I+this.m_iA*A*A;var L=$.sub(this.m_localAnchorC,this.m_lcC),V=Ye.mulTVec2(y,$.add(D,$.sub(n,l)));w=$.dot($.sub(V,L),this.m_localAxisC)}if(this.m_type2==Id.TYPE)C=$.zero(),B=this.m_ratio,R=this.m_ratio,P+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),O=a-f-this.m_referenceAngleB;else{var k=Ye.mulVec2(x,this.m_localAxisD),F=Ye.mulSub(x,this.m_localAnchorD,this.m_lcD),j=Ye.mulSub(g,this.m_localAnchorB,this.m_lcB);C=$.mulNumVec2(this.m_ratio,k),R=this.m_ratio*$.crossVec2Vec2(F,k),B=this.m_ratio*$.crossVec2Vec2(j,k),P+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*R*R+this.m_iB*B*B;var Q=$.sub(this.m_localAnchorD,this.m_lcD),ee=Ye.mulTVec2(x,$.add(j,$.sub(o,d)));O=$.dot(ee,this.m_localAxisD)-$.dot(Q,this.m_localAxisD)}var J=w+this.m_ratio*O-this.m_constant,ue=0;return P>0&&(ue=-J/P),n.addMul(this.m_mA*ue,T),r+=this.m_iA*ue*A,o.addMul(this.m_mB*ue,C),a+=this.m_iB*ue*B,l.subMul(this.m_mC*ue,T),h-=this.m_iC*ue*I,d.subMul(this.m_mD*ue,C),f-=this.m_iD*ue*R,this.m_bodyA.c_position.c.setVec2(n),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=a,this.m_bodyC.c_position.c.setVec2(l),this.m_bodyC.c_position.a=h,this.m_bodyD.c_position.c.setVec2(d),this.m_bodyD.c_position.a=f,_<wt.linearSlop},e.TYPE="gear-joint",e}(Kr),hWe={maxForce:1,maxTorque:1,correctionFactor:.3},$8=function(s){oo(e,s);function e(i,n,r){var o=this;return o instanceof e?(i=Fa(i,hWe),o=s.call(this,i,n,r)||this,n=o.m_bodyA,r=o.m_bodyB,o.m_type=e.TYPE,o.m_linearOffset=$.isValid(i.linearOffset)?$.clone(i.linearOffset):n.getLocalPoint(r.getPosition()),o.m_angularOffset=Number.isFinite(i.angularOffset)?i.angularOffset:r.getAngle()-n.getAngle(),o.m_linearImpulse=$.zero(),o.m_angularImpulse=0,o.m_maxForce=i.maxForce,o.m_maxTorque=i.maxTorque,o.m_correctionFactor=i.correctionFactor,o):new e(i,n,r)}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,correctionFactor:this.m_correctionFactor,linearOffset:this.m_linearOffset,angularOffset:this.m_angularOffset}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n);var o=new e(i);return o},e.prototype._reset=function(i){Number.isFinite(i.angularOffset)&&(this.m_angularOffset=i.angularOffset),Number.isFinite(i.maxForce)&&(this.m_maxForce=i.maxForce),Number.isFinite(i.maxTorque)&&(this.m_maxTorque=i.maxTorque),Number.isFinite(i.correctionFactor)&&(this.m_correctionFactor=i.correctionFactor),$.isValid(i.linearOffset)&&this.m_linearOffset.set(i.linearOffset)},e.prototype.setMaxForce=function(i){this.m_maxForce=i},e.prototype.getMaxForce=function(){return this.m_maxForce},e.prototype.setMaxTorque=function(i){this.m_maxTorque=i},e.prototype.getMaxTorque=function(){return this.m_maxTorque},e.prototype.setCorrectionFactor=function(i){this.m_correctionFactor=i},e.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},e.prototype.setLinearOffset=function(i){(i.x!=this.m_linearOffset.x||i.y!=this.m_linearOffset.y)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset.set(i))},e.prototype.getLinearOffset=function(){return this.m_linearOffset},e.prototype.setAngularOffset=function(i){i!=this.m_angularOffset&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=i)},e.prototype.getAngularOffset=function(){return this.m_angularOffset},e.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},e.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},e.prototype.getReactionForce=function(i){return $.mulNumVec2(i,this.m_linearImpulse)},e.prototype.getReactionTorque=function(i){return i*this.m_angularImpulse},e.prototype.initVelocityConstraints=function(i){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,a=this.m_bodyA.c_velocity.w,l=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,d=this.m_bodyB.c_velocity.v,f=this.m_bodyB.c_velocity.w,p=Ye.neo(r),g=Ye.neo(h);this.m_rA=Ye.mulVec2(p,$.sub(this.m_linearOffset,this.m_localCenterA)),this.m_rB=Ye.mulVec2(g,$.neg(this.m_localCenterB));var y=this.m_invMassA,x=this.m_invMassB,_=this.m_invIA,w=this.m_invIB,O=new ic;if(O.ex.x=y+x+_*this.m_rA.y*this.m_rA.y+w*this.m_rB.y*this.m_rB.y,O.ex.y=-_*this.m_rA.x*this.m_rA.y-w*this.m_rB.x*this.m_rB.y,O.ey.x=O.ex.y,O.ey.y=y+x+_*this.m_rA.x*this.m_rA.x+w*this.m_rB.x*this.m_rB.x,this.m_linearMass=O.getInverse(),this.m_angularMass=_+w,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=$.zero(),this.m_linearError.addCombine(1,l,1,this.m_rB),this.m_linearError.subCombine(1,n,1,this.m_rA),this.m_angularError=h-r-this.m_angularOffset,i.warmStarting){this.m_linearImpulse.mul(i.dtRatio),this.m_angularImpulse*=i.dtRatio;var T=$.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);o.subMul(y,T),a-=_*($.crossVec2Vec2(this.m_rA,T)+this.m_angularImpulse),d.addMul(x,T),f+=w*($.crossVec2Vec2(this.m_rB,T)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=o,this.m_bodyA.c_velocity.w=a,this.m_bodyB.c_velocity.v=d,this.m_bodyB.c_velocity.w=f},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,a=this.m_bodyB.c_velocity.w,l=this.m_invMassA,h=this.m_invMassB,d=this.m_invIA,f=this.m_invIB,p=i.dt,g=i.inv_dt;{var y=a-r+g*this.m_correctionFactor*this.m_angularError,x=-this.m_angularMass*y,_=this.m_angularImpulse,w=p*this.m_maxTorque;this.m_angularImpulse=wr(this.m_angularImpulse+x,-w,w),x=this.m_angularImpulse-_,r-=d*x,a+=f*x}{var y=$.zero();y.addCombine(1,o,1,$.crossNumVec2(a,this.m_rB)),y.subCombine(1,n,1,$.crossNumVec2(r,this.m_rA)),y.addMul(g*this.m_correctionFactor,this.m_linearError);var x=$.neg(ic.mulVec2(this.m_linearMass,y)),_=$.clone(this.m_linearImpulse);this.m_linearImpulse.add(x);var w=p*this.m_maxForce;this.m_linearImpulse.clamp(w),x=$.sub(this.m_linearImpulse,_),n.subMul(l,x),r-=d*$.crossVec2Vec2(this.m_rA,x),o.addMul(h,x),a+=f*$.crossVec2Vec2(this.m_rB,x)}this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=a},e.prototype.solvePositionConstraints=function(i){return!0},e.TYPE="motor-joint",e}(Kr),uWe=Math.PI,dWe={maxForce:0,frequencyHz:5,dampingRatio:.7},U8=function(s){oo(e,s);function e(i,n,r,o){var a=this;return a instanceof e?(i=Fa(i,dWe),a=s.call(this,i,n,r)||this,n=a.m_bodyA,r=a.m_bodyB,a.m_type=e.TYPE,$.isValid(o)?a.m_targetA=$.clone(o):$.isValid(i.target)?a.m_targetA=$.clone(i.target):a.m_targetA=$.zero(),a.m_localAnchorB=tc.mulTVec2(r.getTransform(),a.m_targetA),a.m_maxForce=i.maxForce,a.m_impulse=$.zero(),a.m_frequencyHz=i.frequencyHz,a.m_dampingRatio=i.dampingRatio,a.m_beta=0,a.m_gamma=0,a.m_rB=$.zero(),a.m_localCenterB=$.zero(),a.m_invMassB=0,a.m_invIB=0,a.m_mass=new ic,a.m_C=$.zero(),a):new e(i,n,r,o)}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,target:this.m_targetA,maxForce:this.m_maxForce,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,_localAnchorB:this.m_localAnchorB}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n),i.target=$.clone(i.target);var o=new e(i);return i._localAnchorB&&(o.m_localAnchorB=i._localAnchorB),o},e.prototype._reset=function(i){Number.isFinite(i.maxForce)&&(this.m_maxForce=i.maxForce),Number.isFinite(i.frequencyHz)&&(this.m_frequencyHz=i.frequencyHz),Number.isFinite(i.dampingRatio)&&(this.m_dampingRatio=i.dampingRatio)},e.prototype.setTarget=function(i){$.areEqual(i,this.m_targetA)||(this.m_bodyB.setAwake(!0),this.m_targetA.set(i))},e.prototype.getTarget=function(){return this.m_targetA},e.prototype.setMaxForce=function(i){this.m_maxForce=i},e.prototype.getMaxForce=function(){return this.m_maxForce},e.prototype.setFrequency=function(i){this.m_frequencyHz=i},e.prototype.getFrequency=function(){return this.m_frequencyHz},e.prototype.setDampingRatio=function(i){this.m_dampingRatio=i},e.prototype.getDampingRatio=function(){return this.m_dampingRatio},e.prototype.getAnchorA=function(){return $.clone(this.m_targetA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.mulNumVec2(i,this.m_impulse)},e.prototype.getReactionTorque=function(i){return i*0},e.prototype.shiftOrigin=function(i){this.m_targetA.sub(i)},e.prototype.initVelocityConstraints=function(i){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_bodyB.c_position,r=this.m_bodyB.c_velocity,o=n.c,a=n.a,l=r.v,h=r.w,d=Ye.neo(a),f=this.m_bodyB.getMass(),p=2*uWe*this.m_frequencyHz,g=2*f*this.m_dampingRatio*p,y=f*(p*p),x=i.dt;this.m_gamma=x*(g+x*y),this.m_gamma!=0&&(this.m_gamma=1/this.m_gamma),this.m_beta=x*y*this.m_gamma,this.m_rB=Ye.mulVec2(d,$.sub(this.m_localAnchorB,this.m_localCenterB));var _=new ic;_.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,_.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,_.ey.x=_.ex.y,_.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=_.getInverse(),this.m_C.setVec2(o),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),h*=.98,i.warmStarting?(this.m_impulse.mul(i.dtRatio),l.addMul(this.m_invMassB,this.m_impulse),h+=this.m_invIB*$.crossVec2Vec2(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),r.v.setVec2(l),r.w=h},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyB.c_velocity,r=$.clone(n.v),o=n.w,a=$.crossNumVec2(o,this.m_rB);a.add(r),a.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),a.neg();var l=ic.mulVec2(this.m_mass,a),h=$.clone(this.m_impulse);this.m_impulse.add(l);var d=i.dt*this.m_maxForce;this.m_impulse.clamp(d),l=$.sub(this.m_impulse,h),r.addMul(this.m_invMassB,l),o+=this.m_invIB*$.crossVec2Vec2(this.m_rB,l),n.v.setVec2(r),n.w=o},e.prototype.solvePositionConstraints=function(i){return!0},e.TYPE="mouse-joint",e}(Kr),fWe=Math.abs,pWe={collideConnected:!0},F8=function(s){oo(e,s);function e(i,n,r,o,a,l,h,d){var f=this;return f instanceof e?(i=Fa(i,pWe),f=s.call(this,i,n,r)||this,n=f.m_bodyA,r=f.m_bodyB,f.m_type=e.TYPE,f.m_groundAnchorA=$.clone(o||i.groundAnchorA||$.neo(-1,1)),f.m_groundAnchorB=$.clone(a||i.groundAnchorB||$.neo(1,1)),f.m_localAnchorA=$.clone(l?n.getLocalPoint(l):i.localAnchorA||$.neo(-1,0)),f.m_localAnchorB=$.clone(h?r.getLocalPoint(h):i.localAnchorB||$.neo(1,0)),f.m_lengthA=Number.isFinite(i.lengthA)?i.lengthA:$.distance(l,o),f.m_lengthB=Number.isFinite(i.lengthB)?i.lengthB:$.distance(h,a),f.m_ratio=Number.isFinite(d)?d:i.ratio,f.m_constant=f.m_lengthA+f.m_ratio*f.m_lengthB,f.m_impulse=0,f):new e(i,n,r,o,a,l,h,d)}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,groundAnchorA:this.m_groundAnchorA,groundAnchorB:this.m_groundAnchorB,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,lengthA:this.m_lengthA,lengthB:this.m_lengthB,ratio:this.m_ratio}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n);var o=new e(i);return o},e.prototype._reset=function(i){$.isValid(i.groundAnchorA)&&this.m_groundAnchorA.set(i.groundAnchorA),$.isValid(i.groundAnchorB)&&this.m_groundAnchorB.set(i.groundAnchorB),$.isValid(i.localAnchorA)?this.m_localAnchorA.set(i.localAnchorA):$.isValid(i.anchorA)&&this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(i.anchorA)),$.isValid(i.localAnchorB)?this.m_localAnchorB.set(i.localAnchorB):$.isValid(i.anchorB)&&this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(i.anchorB)),Number.isFinite(i.lengthA)&&(this.m_lengthA=i.lengthA),Number.isFinite(i.lengthB)&&(this.m_lengthB=i.lengthB),Number.isFinite(i.ratio)&&(this.m_ratio=i.ratio)},e.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},e.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},e.prototype.getLengthA=function(){return this.m_lengthA},e.prototype.getLengthB=function(){return this.m_lengthB},e.prototype.getRatio=function(){return this.m_ratio},e.prototype.getCurrentLengthA=function(){var i=this.m_bodyA.getWorldPoint(this.m_localAnchorA),n=this.m_groundAnchorA;return $.distance(i,n)},e.prototype.getCurrentLengthB=function(){var i=this.m_bodyB.getWorldPoint(this.m_localAnchorB),n=this.m_groundAnchorB;return $.distance(i,n)},e.prototype.shiftOrigin=function(i){this.m_groundAnchorA.sub(i),this.m_groundAnchorB.sub(i)},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.mulNumVec2(this.m_impulse,this.m_uB).mul(i)},e.prototype.getReactionTorque=function(i){return 0},e.prototype.initVelocityConstraints=function(i){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,a=this.m_bodyA.c_velocity.w,l=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,d=this.m_bodyB.c_velocity.v,f=this.m_bodyB.c_velocity.w,p=Ye.neo(r),g=Ye.neo(h);this.m_rA=Ye.mulVec2(p,$.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Ye.mulVec2(g,$.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=$.sub($.add(n,this.m_rA),this.m_groundAnchorA),this.m_uB=$.sub($.add(l,this.m_rB),this.m_groundAnchorB);var y=this.m_uA.length(),x=this.m_uB.length();y>10*wt.linearSlop?this.m_uA.mul(1/y):this.m_uA.setZero(),x>10*wt.linearSlop?this.m_uB.mul(1/x):this.m_uB.setZero();var _=$.crossVec2Vec2(this.m_rA,this.m_uA),w=$.crossVec2Vec2(this.m_rB,this.m_uB),O=this.m_invMassA+this.m_invIA*_*_,T=this.m_invMassB+this.m_invIB*w*w;if(this.m_mass=O+this.m_ratio*this.m_ratio*T,this.m_mass>0&&(this.m_mass=1/this.m_mass),i.warmStarting){this.m_impulse*=i.dtRatio;var C=$.mulNumVec2(-this.m_impulse,this.m_uA),A=$.mulNumVec2(-this.m_ratio*this.m_impulse,this.m_uB);o.addMul(this.m_invMassA,C),a+=this.m_invIA*$.crossVec2Vec2(this.m_rA,C),d.addMul(this.m_invMassB,A),f+=this.m_invIB*$.crossVec2Vec2(this.m_rB,A)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=o,this.m_bodyA.c_velocity.w=a,this.m_bodyB.c_velocity.v=d,this.m_bodyB.c_velocity.w=f},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,a=this.m_bodyB.c_velocity.w,l=$.add(n,$.crossNumVec2(r,this.m_rA)),h=$.add(o,$.crossNumVec2(a,this.m_rB)),d=-$.dot(this.m_uA,l)-this.m_ratio*$.dot(this.m_uB,h),f=-this.m_mass*d;this.m_impulse+=f;var p=$.mulNumVec2(-f,this.m_uA),g=$.mulNumVec2(-this.m_ratio*f,this.m_uB);n.addMul(this.m_invMassA,p),r+=this.m_invIA*$.crossVec2Vec2(this.m_rA,p),o.addMul(this.m_invMassB,g),a+=this.m_invIB*$.crossVec2Vec2(this.m_rB,g),this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=a},e.prototype.solvePositionConstraints=function(i){var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,a=this.m_bodyB.c_position.a,l=Ye.neo(r),h=Ye.neo(a),d=Ye.mulVec2(l,$.sub(this.m_localAnchorA,this.m_localCenterA)),f=Ye.mulVec2(h,$.sub(this.m_localAnchorB,this.m_localCenterB)),p=$.sub($.add(n,this.m_rA),this.m_groundAnchorA),g=$.sub($.add(o,this.m_rB),this.m_groundAnchorB),y=p.length(),x=g.length();y>10*wt.linearSlop?p.mul(1/y):p.setZero(),x>10*wt.linearSlop?g.mul(1/x):g.setZero();var _=$.crossVec2Vec2(d,p),w=$.crossVec2Vec2(f,g),O=this.m_invMassA+this.m_invIA*_*_,T=this.m_invMassB+this.m_invIB*w*w,C=O+this.m_ratio*this.m_ratio*T;C>0&&(C=1/C);var A=this.m_constant-y-this.m_ratio*x,B=fWe(A),I=-C*A,R=$.mulNumVec2(-I,p),P=$.mulNumVec2(-this.m_ratio*I,g);return n.addMul(this.m_invMassA,R),r+=this.m_invIA*$.crossVec2Vec2(d,R),o.addMul(this.m_invMassB,P),a+=this.m_invIB*$.crossVec2Vec2(f,P),this.m_bodyA.c_position.c=n,this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=a,B<wt.linearSlop},e.TYPE="pulley-joint",e}(Kr),mWe=Math.min,r_;(function(s){s[s.inactiveLimit=0]="inactiveLimit",s[s.atLowerLimit=1]="atLowerLimit",s[s.atUpperLimit=2]="atUpperLimit",s[s.equalLimits=3]="equalLimits"})(r_||(r_={}));var gWe={maxLength:0},z8=function(s){oo(e,s);function e(i,n,r,o){var a=this;return a instanceof e?(i=Fa(i,gWe),a=s.call(this,i,n,r)||this,n=a.m_bodyA,r=a.m_bodyB,a.m_type=e.TYPE,a.m_localAnchorA=$.clone(o?n.getLocalPoint(o):i.localAnchorA||$.neo(-1,0)),a.m_localAnchorB=$.clone(o?r.getLocalPoint(o):i.localAnchorB||$.neo(1,0)),a.m_maxLength=i.maxLength,a.m_mass=0,a.m_impulse=0,a.m_length=0,a.m_state=r_.inactiveLimit,a):new e(i,n,r,o)}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,maxLength:this.m_maxLength}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n);var o=new e(i);return o},e.prototype._reset=function(i){Number.isFinite(i.maxLength)&&(this.m_maxLength=i.maxLength)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.setMaxLength=function(i){this.m_maxLength=i},e.prototype.getMaxLength=function(){return this.m_maxLength},e.prototype.getLimitState=function(){return this.m_state},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.mulNumVec2(this.m_impulse,this.m_u).mul(i)},e.prototype.getReactionTorque=function(i){return 0},e.prototype.initVelocityConstraints=function(i){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,a=this.m_bodyA.c_velocity.w,l=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,d=this.m_bodyB.c_velocity.v,f=this.m_bodyB.c_velocity.w,p=Ye.neo(r),g=Ye.neo(h);this.m_rA=Ye.mulSub(p,this.m_localAnchorA,this.m_localCenterA),this.m_rB=Ye.mulSub(g,this.m_localAnchorB,this.m_localCenterB),this.m_u=$.zero(),this.m_u.addCombine(1,l,1,this.m_rB),this.m_u.subCombine(1,n,1,this.m_rA),this.m_length=this.m_u.length();var y=this.m_length-this.m_maxLength;if(y>0?this.m_state=r_.atUpperLimit:this.m_state=r_.inactiveLimit,this.m_length>wt.linearSlop)this.m_u.mul(1/this.m_length);else{this.m_u.setZero(),this.m_mass=0,this.m_impulse=0;return}var x=$.crossVec2Vec2(this.m_rA,this.m_u),_=$.crossVec2Vec2(this.m_rB,this.m_u),w=this.m_invMassA+this.m_invIA*x*x+this.m_invMassB+this.m_invIB*_*_;if(this.m_mass=w!=0?1/w:0,i.warmStarting){this.m_impulse*=i.dtRatio;var O=$.mulNumVec2(this.m_impulse,this.m_u);o.subMul(this.m_invMassA,O),a-=this.m_invIA*$.crossVec2Vec2(this.m_rA,O),d.addMul(this.m_invMassB,O),f+=this.m_invIB*$.crossVec2Vec2(this.m_rB,O)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.setVec2(o),this.m_bodyA.c_velocity.w=a,this.m_bodyB.c_velocity.v.setVec2(d),this.m_bodyB.c_velocity.w=f},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,a=this.m_bodyB.c_velocity.w,l=$.addCrossNumVec2(n,r,this.m_rA),h=$.addCrossNumVec2(o,a,this.m_rB),d=this.m_length-this.m_maxLength,f=$.dot(this.m_u,$.sub(h,l));d<0&&(f+=i.inv_dt*d);var p=-this.m_mass*f,g=this.m_impulse;this.m_impulse=mWe(0,this.m_impulse+p),p=this.m_impulse-g;var y=$.mulNumVec2(p,this.m_u);n.subMul(this.m_invMassA,y),r-=this.m_invIA*$.crossVec2Vec2(this.m_rA,y),o.addMul(this.m_invMassB,y),a+=this.m_invIB*$.crossVec2Vec2(this.m_rB,y),this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=a},e.prototype.solvePositionConstraints=function(i){var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,a=this.m_bodyB.c_position.a,l=Ye.neo(r),h=Ye.neo(a),d=Ye.mulSub(l,this.m_localAnchorA,this.m_localCenterA),f=Ye.mulSub(h,this.m_localAnchorB,this.m_localCenterB),p=$.zero();p.addCombine(1,o,1,f),p.subCombine(1,n,1,d);var g=p.normalize(),y=g-this.m_maxLength;y=wr(y,0,wt.maxLinearCorrection);var x=-this.m_mass*y,_=$.mulNumVec2(x,p);return n.subMul(this.m_invMassA,_),r-=this.m_invIA*$.crossVec2Vec2(d,_),o.addMul(this.m_invMassB,_),a+=this.m_invIB*$.crossVec2Vec2(f,_),this.m_bodyA.c_position.c.setVec2(n),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=a,g-this.m_maxLength<wt.linearSlop},e.TYPE="rope-joint",e}(Kr),yWe=Math.abs,vWe=Math.PI,xWe={frequencyHz:0,dampingRatio:0},X8=function(s){oo(e,s);function e(i,n,r,o){var a=this;return a instanceof e?(i=Fa(i,xWe),a=s.call(this,i,n,r)||this,n=a.m_bodyA,r=a.m_bodyB,a.m_type=e.TYPE,a.m_localAnchorA=$.clone(o?n.getLocalPoint(o):i.localAnchorA||$.zero()),a.m_localAnchorB=$.clone(o?r.getLocalPoint(o):i.localAnchorB||$.zero()),a.m_referenceAngle=Number.isFinite(i.referenceAngle)?i.referenceAngle:r.getAngle()-n.getAngle(),a.m_frequencyHz=i.frequencyHz,a.m_dampingRatio=i.dampingRatio,a.m_impulse=new on,a.m_bias=0,a.m_gamma=0,a.m_mass=new Nd,a):new e(i,n,r,o)}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n);var o=new e(i);return o},e.prototype._reset=function(i){i.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(i.anchorA)):i.localAnchorA&&this.m_localAnchorA.setVec2(i.localAnchorA),i.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(i.anchorB)):i.localAnchorB&&this.m_localAnchorB.setVec2(i.localAnchorB),Number.isFinite(i.frequencyHz)&&(this.m_frequencyHz=i.frequencyHz),Number.isFinite(i.dampingRatio)&&(this.m_dampingRatio=i.dampingRatio)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.getReferenceAngle=function(){return this.m_referenceAngle},e.prototype.setFrequency=function(i){this.m_frequencyHz=i},e.prototype.getFrequency=function(){return this.m_frequencyHz},e.prototype.setDampingRatio=function(i){this.m_dampingRatio=i},e.prototype.getDampingRatio=function(){return this.m_dampingRatio},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.neo(this.m_impulse.x,this.m_impulse.y).mul(i)},e.prototype.getReactionTorque=function(i){return i*this.m_impulse.z},e.prototype.initVelocityConstraints=function(i){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,d=Ye.neo(n),f=Ye.neo(a);this.m_rA=Ye.mulVec2(d,$.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Ye.mulVec2(f,$.sub(this.m_localAnchorB,this.m_localCenterB));var p=this.m_invMassA,g=this.m_invMassB,y=this.m_invIA,x=this.m_invIB,_=new Nd;if(_.ex.x=p+g+this.m_rA.y*this.m_rA.y*y+this.m_rB.y*this.m_rB.y*x,_.ey.x=-this.m_rA.y*this.m_rA.x*y-this.m_rB.y*this.m_rB.x*x,_.ez.x=-this.m_rA.y*y-this.m_rB.y*x,_.ex.y=_.ey.x,_.ey.y=p+g+this.m_rA.x*this.m_rA.x*y+this.m_rB.x*this.m_rB.x*x,_.ez.y=this.m_rA.x*y+this.m_rB.x*x,_.ex.z=_.ez.x,_.ey.z=_.ez.y,_.ez.z=y+x,this.m_frequencyHz>0){_.getInverse22(this.m_mass);var w=y+x,O=w>0?1/w:0,T=a-n-this.m_referenceAngle,C=2*vWe*this.m_frequencyHz,A=2*O*this.m_dampingRatio*C,B=O*C*C,I=i.dt;this.m_gamma=I*(A+I*B),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_bias=T*I*B*this.m_gamma,w+=this.m_gamma,this.m_mass.ez.z=w!=0?1/w:0}else _.ez.z==0?(_.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(_.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(i.warmStarting){this.m_impulse.mul(i.dtRatio);var R=$.neo(this.m_impulse.x,this.m_impulse.y);r.subMul(p,R),o-=y*($.crossVec2Vec2(this.m_rA,R)+this.m_impulse.z),l.addMul(g,R),h+=x*($.crossVec2Vec2(this.m_rB,R)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=r,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=l,this.m_bodyB.c_velocity.w=h},e.prototype.solveVelocityConstraints=function(i){var n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,a=this.m_bodyB.c_velocity.w,l=this.m_invMassA,h=this.m_invMassB,d=this.m_invIA,f=this.m_invIB;if(this.m_frequencyHz>0){var p=a-r,g=-this.m_mass.ez.z*(p+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=g,r-=d*g,a+=f*g;var y=$.zero();y.addCombine(1,o,1,$.crossNumVec2(a,this.m_rB)),y.subCombine(1,n,1,$.crossNumVec2(r,this.m_rA));var x=$.neg(Nd.mulVec2(this.m_mass,y));this.m_impulse.x+=x.x,this.m_impulse.y+=x.y;var _=$.clone(x);n.subMul(l,_),r-=d*$.crossVec2Vec2(this.m_rA,_),o.addMul(h,_),a+=f*$.crossVec2Vec2(this.m_rB,_)}else{var y=$.zero();y.addCombine(1,o,1,$.crossNumVec2(a,this.m_rB)),y.subCombine(1,n,1,$.crossNumVec2(r,this.m_rA));var p=a-r,w=new on(y.x,y.y,p),O=on.neg(Nd.mulVec3(this.m_mass,w));this.m_impulse.add(O);var _=$.neo(O.x,O.y);n.subMul(l,_),r-=d*($.crossVec2Vec2(this.m_rA,_)+O.z),o.addMul(h,_),a+=f*($.crossVec2Vec2(this.m_rB,_)+O.z)}this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=a},e.prototype.solvePositionConstraints=function(i){var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,a=this.m_bodyB.c_position.a,l=Ye.neo(r),h=Ye.neo(a),d=this.m_invMassA,f=this.m_invMassB,p=this.m_invIA,g=this.m_invIB,y=Ye.mulVec2(l,$.sub(this.m_localAnchorA,this.m_localCenterA)),x=Ye.mulVec2(h,$.sub(this.m_localAnchorB,this.m_localCenterB)),_,w,O=new Nd;if(O.ex.x=d+f+y.y*y.y*p+x.y*x.y*g,O.ey.x=-y.y*y.x*p-x.y*x.x*g,O.ez.x=-y.y*p-x.y*g,O.ex.y=O.ey.x,O.ey.y=d+f+y.x*y.x*p+x.x*x.x*g,O.ez.y=y.x*p+x.x*g,O.ex.z=O.ez.x,O.ey.z=O.ez.y,O.ez.z=p+g,this.m_frequencyHz>0){var T=$.zero();T.addCombine(1,o,1,x),T.subCombine(1,n,1,y),_=T.length(),w=0;var C=$.neg(O.solve22(T));n.subMul(d,C),r-=p*$.crossVec2Vec2(y,C),o.addMul(f,C),a+=g*$.crossVec2Vec2(x,C)}else{var T=$.zero();T.addCombine(1,o,1,x),T.subCombine(1,n,1,y);var A=a-r-this.m_referenceAngle;_=T.length(),w=yWe(A);var B=new on(T.x,T.y,A),I=new on;if(O.ez.z>0)I=on.neg(O.solve33(B));else{var R=$.neg(O.solve22(T));I.set(R.x,R.y,0)}var C=$.neo(I.x,I.y);n.subMul(d,C),r-=p*($.crossVec2Vec2(y,C)+I.z),o.addMul(f,C),a+=g*($.crossVec2Vec2(x,C)+I.z)}return this.m_bodyA.c_position.c=n,this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=a,_<=wt.linearSlop&&w<=wt.angularSlop},e.TYPE="weld-joint",e}(Kr),_We=Math.abs,bWe=Math.PI,wWe={enableMotor:!1,maxMotorTorque:0,motorSpeed:0,frequencyHz:2,dampingRatio:.7},W8=function(s){oo(e,s);function e(i,n,r,o,a){var l=this;return l instanceof e?(i=Fa(i,wWe),l=s.call(this,i,n,r)||this,n=l.m_bodyA,r=l.m_bodyB,l.m_ax=$.zero(),l.m_ay=$.zero(),l.m_type=e.TYPE,l.m_localAnchorA=$.clone(o?n.getLocalPoint(o):i.localAnchorA||$.zero()),l.m_localAnchorB=$.clone(o?r.getLocalPoint(o):i.localAnchorB||$.zero()),$.isValid(a)?l.m_localXAxisA=n.getLocalVector(a):$.isValid(i.localAxisA)?l.m_localXAxisA=$.clone(i.localAxisA):$.isValid(i.localAxis)?l.m_localXAxisA=$.clone(i.localAxis):l.m_localXAxisA=$.neo(1,0),l.m_localYAxisA=$.crossNumVec2(1,l.m_localXAxisA),l.m_mass=0,l.m_impulse=0,l.m_motorMass=0,l.m_motorImpulse=0,l.m_springMass=0,l.m_springImpulse=0,l.m_maxMotorTorque=i.maxMotorTorque,l.m_motorSpeed=i.motorSpeed,l.m_enableMotor=i.enableMotor,l.m_frequencyHz=i.frequencyHz,l.m_dampingRatio=i.dampingRatio,l.m_bias=0,l.m_gamma=0,l):new e(i,n,r,o,a)}return e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,enableMotor:this.m_enableMotor,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA}},e._deserialize=function(i,n,r){i=to({},i),i.bodyA=r(pn,i.bodyA,n),i.bodyB=r(pn,i.bodyB,n);var o=new e(i);return o},e.prototype._reset=function(i){i.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(i.anchorA)):i.localAnchorA&&this.m_localAnchorA.setVec2(i.localAnchorA),i.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(i.anchorB)):i.localAnchorB&&this.m_localAnchorB.setVec2(i.localAnchorB),i.localAxisA&&(this.m_localXAxisA.setVec2(i.localAxisA),this.m_localYAxisA.setVec2($.crossNumVec2(1,i.localAxisA))),i.enableMotor!==void 0&&(this.m_enableMotor=i.enableMotor),Number.isFinite(i.maxMotorTorque)&&(this.m_maxMotorTorque=i.maxMotorTorque),Number.isFinite(i.motorSpeed)&&(this.m_motorSpeed=i.motorSpeed),Number.isFinite(i.frequencyHz)&&(this.m_frequencyHz=i.frequencyHz),Number.isFinite(i.dampingRatio)&&(this.m_dampingRatio=i.dampingRatio)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.getLocalAxisA=function(){return this.m_localXAxisA},e.prototype.getJointTranslation=function(){var i=this.m_bodyA,n=this.m_bodyB,r=i.getWorldPoint(this.m_localAnchorA),o=n.getWorldPoint(this.m_localAnchorB),a=$.sub(o,r),l=i.getWorldVector(this.m_localXAxisA),h=$.dot(a,l);return h},e.prototype.getJointSpeed=function(){var i=this.m_bodyA.m_angularVelocity,n=this.m_bodyB.m_angularVelocity;return n-i},e.prototype.isMotorEnabled=function(){return this.m_enableMotor},e.prototype.enableMotor=function(i){i!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=i)},e.prototype.setMotorSpeed=function(i){i!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=i)},e.prototype.getMotorSpeed=function(){return this.m_motorSpeed},e.prototype.setMaxMotorTorque=function(i){i!=this.m_maxMotorTorque&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=i)},e.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},e.prototype.getMotorTorque=function(i){return i*this.m_motorImpulse},e.prototype.setSpringFrequencyHz=function(i){this.m_frequencyHz=i},e.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},e.prototype.setSpringDampingRatio=function(i){this.m_dampingRatio=i},e.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(i){return $.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(i)},e.prototype.getReactionTorque=function(i){return i*this.m_motorImpulse},e.prototype.initVelocityConstraints=function(i){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var n=this.m_invMassA,r=this.m_invMassB,o=this.m_invIA,a=this.m_invIB,l=this.m_bodyA.c_position.c,h=this.m_bodyA.c_position.a,d=this.m_bodyA.c_velocity.v,f=this.m_bodyA.c_velocity.w,p=this.m_bodyB.c_position.c,g=this.m_bodyB.c_position.a,y=this.m_bodyB.c_velocity.v,x=this.m_bodyB.c_velocity.w,_=Ye.neo(h),w=Ye.neo(g),O=Ye.mulVec2(_,$.sub(this.m_localAnchorA,this.m_localCenterA)),T=Ye.mulVec2(w,$.sub(this.m_localAnchorB,this.m_localCenterB)),C=$.zero();if(C.addCombine(1,p,1,T),C.subCombine(1,l,1,O),this.m_ay=Ye.mulVec2(_,this.m_localYAxisA),this.m_sAy=$.crossVec2Vec2($.add(C,O),this.m_ay),this.m_sBy=$.crossVec2Vec2(T,this.m_ay),this.m_mass=n+r+o*this.m_sAy*this.m_sAy+a*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=Ye.mulVec2(_,this.m_localXAxisA),this.m_sAx=$.crossVec2Vec2($.add(C,O),this.m_ax),this.m_sBx=$.crossVec2Vec2(T,this.m_ax);var A=n+r+o*this.m_sAx*this.m_sAx+a*this.m_sBx*this.m_sBx;if(A>0){this.m_springMass=1/A;var B=$.dot(C,this.m_ax),I=2*bWe*this.m_frequencyHz,R=2*this.m_springMass*this.m_dampingRatio*I,P=this.m_springMass*I*I,k=i.dt;this.m_gamma=k*(R+k*P),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=B*k*P*this.m_gamma,this.m_springMass=A+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=o+a,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),i.warmStarting){this.m_impulse*=i.dtRatio,this.m_springImpulse*=i.dtRatio,this.m_motorImpulse*=i.dtRatio;var E=$.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),D=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,L=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;d.subMul(this.m_invMassA,E),f-=this.m_invIA*D,y.addMul(this.m_invMassB,E),x+=this.m_invIB*L}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.setVec2(d),this.m_bodyA.c_velocity.w=f,this.m_bodyB.c_velocity.v.setVec2(y),this.m_bodyB.c_velocity.w=x},e.prototype.solveVelocityConstraints=function(i){var n=this.m_invMassA,r=this.m_invMassB,o=this.m_invIA,a=this.m_invIB,l=this.m_bodyA.c_velocity.v,h=this.m_bodyA.c_velocity.w,d=this.m_bodyB.c_velocity.v,f=this.m_bodyB.c_velocity.w;{var p=$.dot(this.m_ax,d)-$.dot(this.m_ax,l)+this.m_sBx*f-this.m_sAx*h,g=-this.m_springMass*(p+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=g;var y=$.mulNumVec2(g,this.m_ax),x=g*this.m_sAx,_=g*this.m_sBx;l.subMul(n,y),h-=o*x,d.addMul(r,y),f+=a*_}{var p=f-h-this.m_motorSpeed,g=-this.m_motorMass*p,w=this.m_motorImpulse,O=i.dt*this.m_maxMotorTorque;this.m_motorImpulse=wr(this.m_motorImpulse+g,-O,O),g=this.m_motorImpulse-w,h-=o*g,f+=a*g}{var p=$.dot(this.m_ay,d)-$.dot(this.m_ay,l)+this.m_sBy*f-this.m_sAy*h,g=-this.m_mass*p;this.m_impulse+=g;var y=$.mulNumVec2(g,this.m_ay),x=g*this.m_sAy,_=g*this.m_sBy;l.subMul(n,y),h-=o*x,d.addMul(r,y),f+=a*_}this.m_bodyA.c_velocity.v.setVec2(l),this.m_bodyA.c_velocity.w=h,this.m_bodyB.c_velocity.v.setVec2(d),this.m_bodyB.c_velocity.w=f},e.prototype.solvePositionConstraints=function(i){var n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,a=this.m_bodyB.c_position.a,l=Ye.neo(r),h=Ye.neo(a),d=Ye.mulVec2(l,$.sub(this.m_localAnchorA,this.m_localCenterA)),f=Ye.mulVec2(h,$.sub(this.m_localAnchorB,this.m_localCenterB)),p=$.zero();p.addCombine(1,o,1,f),p.subCombine(1,n,1,d);var g=Ye.mulVec2(l,this.m_localYAxisA),y=$.crossVec2Vec2($.add(p,d),g),x=$.crossVec2Vec2(f,g),_=$.dot(p,g),w=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy,O=w!=0?-_/w:0,T=$.mulNumVec2(O,g),C=O*y,A=O*x;return n.subMul(this.m_invMassA,T),r-=this.m_invIA*C,o.addMul(this.m_invMassB,T),a+=this.m_invIB*A,this.m_bodyA.c_position.c.setVec2(n),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=a,_We(_)<=wt.linearSlop},e.TYPE="wheel-joint",e}(Kr),Fs,OWe=0,H8={World:Yb,Body:pn,Joint:Kr,Fixture:RT,Shape:Nm},G8={Vec2:$,Vec3:on,World:Yb,Body:pn,Joint:Kr,Fixture:RT,Shape:Nm},SWe=(Fs={},Fs[pn.STATIC]=pn,Fs[pn.DYNAMIC]=pn,Fs[pn.KINEMATIC]=pn,Fs[DT.TYPE]=DT,Fs[df.TYPE]=df,Fs[Tu.TYPE]=Tu,Fs[ff.TYPE]=ff,Fs[QR.TYPE]=QR,Fs[R8.TYPE]=R8,Fs[V8.TYPE]=V8,Fs[$8.TYPE]=$8,Fs[U8.TYPE]=U8,Fs[N8.TYPE]=N8,Fs[F8.TYPE]=F8,Fs[Id.TYPE]=Id,Fs[z8.TYPE]=z8,Fs[X8.TYPE]=X8,Fs[W8.TYPE]=W8,Fs),CWe={rootClass:Yb,preSerialize:function(s){return s},postSerialize:function(s,e){return s},preDeserialize:function(s){return s},postDeserialize:function(s,e){return s}},uN=function(){function s(e){var i=this;this.toJson=function(n){var r=i.options.preSerialize,o=i.options.postSerialize,a=[],l=[n],h={};function d(x,_){if(x.__sid=x.__sid||++OWe,!h[x.__sid]){l.push(x);var w=a.length+l.length,O={refIndex:w,refType:_};h[x.__sid]=O}return h[x.__sid]}function f(x){x=r(x);var _=x._serialize();return _=o(_,x),_}function p(x,_){if(_===void 0&&(_=!1),typeof x!="object"||x===null)return x;if(typeof x._serialize=="function"){if(!_){for(var w in H8)if(x instanceof H8[w])return d(x,w)}x=f(x)}if(Array.isArray(x)){for(var O=[],T=0;T<x.length;T++)O[T]=p(x[T]);x=O}else{var O={};for(var T in x)x.hasOwnProperty(T)&&(O[T]=p(x[T]));x=O}return x}for(;l.length;){var g=l.shift(),y=p(g,!0);a.push(y)}return a},this.fromJson=function(n){var r=i.options.preDeserialize,o=i.options.postDeserialize,a=i.options.rootClass,l={};function h(p,g,y){(!p||!p._deserialize)&&(p=SWe[g.type]);var x=p&&p._deserialize;if(x){g=r(g);var _=p._deserialize,w=_(g,y,d);return w=o(w,g),w}}function d(p,g,y){var x=g.refIndex&&g.refType;if(!x)return h(p,g,y);var _=g;G8[_.refType]&&(p=G8[_.refType]);var w=_.refIndex;if(!l[w]){var O=n[w],T=h(p,O,y);l[w]=T}return l[w]}var f=h(a,n[0],null);return f},this.options=to(to({},CWe),e)}return s}(),fee=new uN({rootClass:Yb});uN.fromJson=fee.fromJson;uN.toJson=fee.toJson;(function(){function s(){this.width=80,this.height=60,this.x=0,this.y=-10,this.scaleY=-1,this.hz=60,this.speed=1,this.background="#222222",this.activeKeys={},this.step=function(e,i){},this.keydown=function(e,i){},this.keyup=function(e,i){}}return s.mount=function(e){throw new Error("Not implemented")},s.start=function(e){var i=s.mount();return i.start(e),i},s.prototype.color=function(e,i,n){return e=e*256|0,i=i*256|0,n=n*256|0,"rgb("+e+", "+i+", "+n+")"},s})();(function(s){oo(e,s);function e(i,n,r,o){var a=this;return a instanceof e?(a=s.call(this)||this,a._setAsBox(i,n,r,o),a):new e(i,n,r,o)}return e.TYPE="polygon",e})(df);ah.addType(ff.TYPE,ff.TYPE,TWe);function TWe(s,e,i,n,r,o,a){AWe(s,i.getShape(),e,o.getShape(),r)}var Q8=ze(0,0),Y8=ze(0,0),AWe=function(s,e,i,n,r){s.pointCount=0,bi(Q8,i,e.m_p),bi(Y8,r,n.m_p);var o=sm(Y8,Q8),a=e.m_radius,l=n.m_radius,h=a+l;o>h*h||(s.type=ys.e_circles,Pe(s.localPoint,e.m_p),oi(s.localNormal),s.pointCount=1,Pe(s.points[0].localPoint,n.m_p),s.points[0].id.setFeatures(0,nn.e_vertex,0,nn.e_vertex))};ah.addType(Tu.TYPE,ff.TYPE,EWe);ah.addType(DT.TYPE,ff.TYPE,MWe);function EWe(s,e,i,n,r,o,a){var l=i.getShape(),h=o.getShape();pee(s,l,e,h,r)}function MWe(s,e,i,n,r,o,a){var l=i.getShape(),h=new Tu;l.getChildEdge(h,n);var d=h,f=o.getShape();pee(s,d,e,f,r)}var up=ze(0,0),A2=ze(0,0),E2=ze(0,0),Uh=ze(0,0),dp=ze(0,0),Yg=ze(0,0),pee=function(s,e,i,n,r){s.pointCount=0,iee(Uh,r,i,n.m_p);var o=e.m_vertex1,a=e.m_vertex2;wi(up,a,o);var l=st(up,a)-st(up,Uh),h=st(up,Uh)-st(up,o),d=e.m_radius+n.m_radius;if(h<=0){Pe(dp,o);var f=sm(Uh,o);if(f>d*d)return;if(e.m_hasVertex0){var p=e.m_vertex0,g=o;wi(A2,g,p);var y=st(A2,g)-st(A2,Uh);if(y>0)return}s.type=ys.e_circles,oi(s.localNormal),Pe(s.localPoint,dp),s.pointCount=1,Pe(s.points[0].localPoint,n.m_p),s.points[0].id.setFeatures(0,nn.e_vertex,0,nn.e_vertex);return}if(l<=0){Pe(dp,a);var x=sm(Uh,dp);if(x>d*d)return;if(e.m_hasVertex3){var _=e.m_vertex3,w=a;wi(E2,_,w);var O=st(E2,Uh)-st(E2,w);if(O>0)return}s.type=ys.e_circles,oi(s.localNormal),Pe(s.localPoint,dp),s.pointCount=1,Pe(s.points[0].localPoint,n.m_p),s.points[0].id.setFeatures(1,nn.e_vertex,0,nn.e_vertex);return}var T=nm(up);qn(dp,l/T,o,h/T,a);var C=sm(Uh,dp);C>d*d||(Oa(Yg,1,up),st(Yg,Uh)-st(Yg,o)<0&&ab(Yg),ec(Yg),s.type=ys.e_faceA,Pe(s.localNormal,Yg),Pe(s.localPoint,o),s.pointCount=1,Pe(s.points[0].localPoint,n.m_p),s.points[0].id.setFeatures(0,nn.e_face,0,nn.e_vertex))},xS=[new $a,new $a],_S=[new $a,new $a],fp=[new $a,new $a],bS=ze(0,0),j8=ze(0,0),M2=ze(0,0),k2=Lm(0,0,0),pp=ze(0,0),jg=ze(0,0),wS=ze(0,0),q8=ze(0,0),Z8=ze(0,0),xd=ze(0,0),P2=ze(0,0),K8=ze(0,0);ah.addType(df.TYPE,df.TYPE,kWe);function kWe(s,e,i,n,r,o,a){IWe(s,i.getShape(),e,o.getShape(),r)}function J8(s,e,i,n,r){var o=s.m_count,a=i.m_count,l=s.m_normals,h=s.m_vertices,d=i.m_vertices;nee(k2,n,e);for(var f=0,p=-1/0,g=0;g<o;++g){fl(M2,k2.q,l[g]),bi(j8,k2,h[g]);for(var y=1/0,x=0;x<a;++x){var _=st(M2,d[x])-st(M2,j8);_<y&&(y=_)}y>p&&(p=y,f=g)}r.maxSeparation=p,r.bestIndex=f}function PWe(s,e,i,n,r,o){var a=e.m_normals,l=r.m_count,h=r.m_vertices,d=r.m_normals;PXe(K8,o.q,i.q,a[n]);for(var f=0,p=1/0,g=0;g<l;++g){var y=st(K8,d[g]);y<p&&(p=y,f=g)}var x=f,_=x+1<l?x+1:0;bi(s[0].v,o,h[x]),s[0].id.setFeatures(n,nn.e_face,x,nn.e_vertex),bi(s[1].v,o,h[_]),s[1].id.setFeatures(n,nn.e_face,_,nn.e_vertex)}var qg={maxSeparation:0,bestIndex:0},IWe=function(s,e,i,n,r){s.pointCount=0;var o=e.m_radius+n.m_radius;J8(e,i,n,r,qg);var a=qg.bestIndex,l=qg.maxSeparation;if(!(l>o)){J8(n,r,e,i,qg);var h=qg.bestIndex,d=qg.maxSeparation;if(!(d>o)){var f,p,g,y,x,_,w=.1*wt.linearSlop;d>l+w?(f=n,p=e,g=r,y=i,x=h,s.type=ys.e_faceB,_=!0):(f=e,p=n,g=i,y=r,x=a,s.type=ys.e_faceA,_=!1),xS[0].recycle(),xS[1].recycle(),PWe(xS,f,g,x,p,y);var O=f.m_count,T=f.m_vertices,C=x,A=x+1<O?x+1:0;Pe(pp,T[C]),Pe(jg,T[A]),wi(wS,jg,pp),ec(wS),im(q8,wS,1),qn(Z8,.5,pp,.5,jg),fl(xd,g.q,wS),im(P2,xd,1),bi(pp,g,pp),bi(jg,g,jg);var B=st(P2,pp),I=-st(xd,pp)+o,R=st(xd,jg)+o;_S[0].recycle(),_S[1].recycle(),fp[0].recycle(),fp[1].recycle(),br(bS,-xd.x,-xd.y);var P=lb(_S,xS,bS,I,C);if(!(P<2)){br(bS,xd.x,xd.y);var k=lb(fp,_S,bS,R,A);if(!(k<2)){Pe(s.localNormal,q8),Pe(s.localPoint,Z8);for(var E=0,D=0;D<fp.length;++D){var L=st(P2,fp[D].v)-B;if(L<=o){var V=s.points[E];rN(V.localPoint,y,fp[D].v),V.id.set(fp[D].id),_&&V.id.swapFeatures(),++E}}s.pointCount=E}}}}};ah.addType(df.TYPE,ff.TYPE,BWe);function BWe(s,e,i,n,r,o,a){RWe(s,i.getShape(),e,o.getShape(),r)}var Vl=ze(0,0),I2=ze(0,0),RWe=function(s,e,i,n,r){s.pointCount=0,iee(Vl,r,i,n.m_p);for(var o=0,a=-1/0,l=e.m_radius+n.m_radius,h=e.m_count,d=e.m_vertices,f=e.m_normals,p=0;p<h;++p){var g=st(f[p],Vl)-st(f[p],d[p]);if(g>l)return;g>a&&(a=g,o=p)}var y=o,x=y+1<h?y+1:0,_=d[y],w=d[x];if(a<ta){s.pointCount=1,s.type=ys.e_faceA,Pe(s.localNormal,f[o]),qn(s.localPoint,.5,_,.5,w),Pe(s.points[0].localPoint,n.m_p),s.points[0].id.setFeatures(0,nn.e_vertex,0,nn.e_vertex);return}var O=st(Vl,w)-st(Vl,_)-st(_,w)+st(_,_),T=st(Vl,_)-st(Vl,w)-st(w,_)+st(w,w);if(O<=0){if(sm(Vl,_)>l*l)return;s.pointCount=1,s.type=ys.e_faceA,wi(s.localNormal,Vl,_),ec(s.localNormal),Pe(s.localPoint,_),Pe(s.points[0].localPoint,n.m_p),s.points[0].id.setFeatures(0,nn.e_vertex,0,nn.e_vertex)}else if(T<=0){if(sm(Vl,w)>l*l)return;s.pointCount=1,s.type=ys.e_faceA,wi(s.localNormal,Vl,w),ec(s.localNormal),Pe(s.localPoint,w),Pe(s.points[0].localPoint,n.m_p),s.points[0].id.setFeatures(0,nn.e_vertex,0,nn.e_vertex)}else{qn(I2,.5,_,.5,w);var C=st(Vl,f[y])-st(I2,f[y]);if(C>l)return;s.pointCount=1,s.type=ys.e_faceA,Pe(s.localNormal,f[y]),Pe(s.localPoint,I2),Pe(s.points[0].localPoint,n.m_p),s.points[0].id.setFeatures(0,nn.e_vertex,0,nn.e_vertex)}},DWe=Math.min;ah.addType(Tu.TYPE,df.TYPE,LWe);ah.addType(DT.TYPE,df.TYPE,NWe);function LWe(s,e,i,n,r,o,a){gee(s,i.getShape(),e,o.getShape(),r)}var eH=new Tu;function NWe(s,e,i,n,r,o,a){var l=i.getShape();l.getChildEdge(eH,n),gee(s,eH,e,o.getShape(),r)}var tl;(function(s){s[s.e_unknown=-1]="e_unknown",s[s.e_edgeA=1]="e_edgeA",s[s.e_edgeB=2]="e_edgeB"})(tl||(tl={}));var tH;(function(s){s[s.e_isolated=0]="e_isolated",s[s.e_concave=1]="e_concave",s[s.e_convex=2]="e_convex"})(tH||(tH={}));var mee=function(){function s(){}return s}(),VWe=function(){function s(){this.vertices=[],this.normals=[],this.count=0;for(var e=0;e<wt.maxPolygonVertices;e++)this.vertices.push(ze(0,0)),this.normals.push(ze(0,0))}return s}(),$We=function(){function s(){this.v1=ze(0,0),this.v2=ze(0,0),this.normal=ze(0,0),this.sideNormal1=ze(0,0),this.sideNormal2=ze(0,0)}return s.prototype.recycle=function(){oi(this.v1),oi(this.v2),oi(this.normal),oi(this.sideNormal1),oi(this.sideNormal2)},s}(),OS=[new $a,new $a],_d=[new $a,new $a],$l=[new $a,new $a],Tc=new mee,go=new mee,Js=new VWe,Ti=new $We,SS=ze(0,0),gx=ze(0,0),Zg=ze(0,0),yx=ze(0,0),vx=Lm(0,0,0),En=ze(0,0),Ac=ze(0,0),_i=ze(0,0),Ec=ze(0,0),zs=ze(0,0),Xs=ze(0,0),iH=ze(0,0),bd=ze(0,0),gee=function(s,e,i,n,r){nee(vx,i,r),bi(SS,vx,n.m_centroid);var o=e.m_vertex0,a=e.m_vertex1,l=e.m_vertex2,h=e.m_vertex3,d=e.m_hasVertex0,f=e.m_hasVertex3;wi(Zg,l,a),ec(Zg),br(_i,Zg.y,-Zg.x);var p=st(_i,SS)-st(_i,a),g=0,y=0,x=!1,_=!1;oi(Ac),oi(Ec),d&&(wi(gx,a,o),ec(gx),br(Ac,gx.y,-gx.x),x=Ri(gx,Zg)>=0,g=$.dot(Ac,SS)-$.dot(Ac,o)),f&&(wi(yx,h,l),ec(yx),br(Ec,yx.y,-yx.x),_=$.crossVec2Vec2(Zg,yx)>0,y=$.dot(Ec,SS)-$.dot(Ec,l));var w;oi(En),oi(zs),oi(Xs),d&&f?x&&_?(w=g>=0||p>=0||y>=0,w?(Pe(En,_i),Pe(zs,Ac),Pe(Xs,Ec)):(ui(En,-1,_i),ui(zs,-1,_i),ui(Xs,-1,_i))):x?(w=g>=0||p>=0&&y>=0,w?(Pe(En,_i),Pe(zs,Ac),Pe(Xs,_i)):(ui(En,-1,_i),ui(zs,-1,Ec),ui(Xs,-1,_i))):_?(w=y>=0||g>=0&&p>=0,w?(Pe(En,_i),Pe(zs,_i),Pe(Xs,Ec)):(ui(En,-1,_i),ui(zs,-1,_i),ui(Xs,-1,Ac))):(w=g>=0&&p>=0&&y>=0,w?(Pe(En,_i),Pe(zs,_i),Pe(Xs,_i)):(ui(En,-1,_i),ui(zs,-1,Ec),ui(Xs,-1,Ac))):d?x?(w=g>=0||p>=0,w?(Pe(En,_i),Pe(zs,Ac),ui(Xs,-1,_i)):(ui(En,-1,_i),Pe(zs,_i),ui(Xs,-1,_i))):(w=g>=0&&p>=0,w?(Pe(En,_i),Pe(zs,_i),ui(Xs,-1,_i)):(ui(En,-1,_i),Pe(zs,_i),ui(Xs,-1,Ac))):f?_?(w=p>=0||y>=0,w?(Pe(En,_i),ui(zs,-1,_i),Pe(Xs,Ec)):(ui(En,-1,_i),ui(zs,-1,_i),Pe(Xs,_i))):(w=p>=0&&y>=0,w?(Pe(En,_i),ui(zs,-1,_i),Pe(Xs,_i)):(ui(En,-1,_i),ui(zs,-1,Ec),Pe(Xs,_i))):(w=p>=0,w?(Pe(En,_i),ui(zs,-1,_i),ui(Xs,-1,_i)):(ui(En,-1,_i),Pe(zs,_i),Pe(Xs,_i))),Js.count=n.m_count;for(var O=0;O<n.m_count;++O)bi(Js.vertices[O],vx,n.m_vertices[O]),fl(Js.normals[O],vx.q,n.m_normals[O]);var T=n.m_radius+e.m_radius;s.pointCount=0;{Tc.type=tl.e_edgeA,Tc.index=w?0:1,Tc.separation=1/0;for(var O=0;O<Js.count;++O){var C=Js.vertices[O],A=st(En,C)-st(En,a);A<Tc.separation&&(Tc.separation=A)}}if(Tc.type!=tl.e_unknown&&!(Tc.separation>T)){{go.type=tl.e_unknown,go.index=-1,go.separation=-1/0,br(iH,-En.y,En.x);for(var O=0;O<Js.count;++O){ui(bd,-1,Js.normals[O]);var B=st(bd,Js.vertices[O])-st(bd,a),I=st(bd,Js.vertices[O])-st(bd,l),A=DWe(B,I);if(A>T){go.type=tl.e_edgeB,go.index=O,go.separation=A;break}if(st(bd,iH)>=0){if(st(bd,En)-st(Xs,En)<-wt.angularSlop)continue}else if(st(bd,En)-st(zs,En)<-wt.angularSlop)continue;A>go.separation&&(go.type=tl.e_edgeB,go.index=O,go.separation=A)}}if(!(go.type!=tl.e_unknown&&go.separation>T)){var R=.98,P=.001,k;if(go.type==tl.e_unknown?k=Tc:go.separation>R*Tc.separation+P?k=go:k=Tc,$l[0].recycle(),$l[1].recycle(),k.type==tl.e_edgeA){s.type=ys.e_faceA;for(var E=0,D=st(En,Js.normals[0]),O=1;O<Js.count;++O){var L=st(En,Js.normals[O]);L<D&&(D=L,E=O)}var V=E,F=V+1<Js.count?V+1:0;Pe($l[0].v,Js.vertices[V]),$l[0].id.setFeatures(0,nn.e_face,V,nn.e_vertex),Pe($l[1].v,Js.vertices[F]),$l[1].id.setFeatures(0,nn.e_face,F,nn.e_vertex),w?(Ti.i1=0,Ti.i2=1,Pe(Ti.v1,a),Pe(Ti.v2,l),Pe(Ti.normal,_i)):(Ti.i1=1,Ti.i2=0,Pe(Ti.v1,l),Pe(Ti.v2,a),ui(Ti.normal,-1,_i))}else s.type=ys.e_faceB,Pe($l[0].v,a),$l[0].id.setFeatures(0,nn.e_vertex,k.index,nn.e_face),Pe($l[1].v,l),$l[1].id.setFeatures(0,nn.e_vertex,k.index,nn.e_face),Ti.i1=k.index,Ti.i2=Ti.i1+1<Js.count?Ti.i1+1:0,Pe(Ti.v1,Js.vertices[Ti.i1]),Pe(Ti.v2,Js.vertices[Ti.i2]),Pe(Ti.normal,Js.normals[Ti.i1]);br(Ti.sideNormal1,Ti.normal.y,-Ti.normal.x),br(Ti.sideNormal2,-Ti.sideNormal1.x,-Ti.sideNormal1.y),Ti.sideOffset1=st(Ti.sideNormal1,Ti.v1),Ti.sideOffset2=st(Ti.sideNormal2,Ti.v2),OS[0].recycle(),OS[1].recycle(),_d[0].recycle(),_d[1].recycle();var j=lb(OS,$l,Ti.sideNormal1,Ti.sideOffset1,Ti.i1);if(!(j<wt.maxManifoldPoints)){var Q=lb(_d,OS,Ti.sideNormal2,Ti.sideOffset2,Ti.i2);if(!(Q<wt.maxManifoldPoints)){k.type==tl.e_edgeA?(Pe(s.localNormal,Ti.normal),Pe(s.localPoint,Ti.v1)):(Pe(s.localNormal,n.m_normals[Ti.i1]),Pe(s.localPoint,n.m_vertices[Ti.i1]));for(var ee=0,O=0;O<wt.maxManifoldPoints;++O){var J=st(Ti.normal,_d[O].v)-st(Ti.normal,Ti.v1);if(J<=T){var ue=s.points[ee];k.type==tl.e_edgeA?(rN(ue.localPoint,vx,_d[O].v),ue.id.set(_d[O].id)):(Pe(ue.localPoint,_d[O].v),ue.id.set(_d[O].id),ue.id.swapFeatures()),++ee}}s.pointCount=ee}}}}};(function(){function s(e,i){this._refMap={},this._map={},this._xmap={},this._data=[],this._entered=[],this._exited=[],this._key=e,this._listener=i}return s.prototype.update=function(e){if(!Array.isArray(e))throw"Invalid data: "+e;this._entered.length=0,this._exited.length=0,this._data.length=e.length;for(var i=0;i<e.length;i++)if(!(typeof e[i]!="object"||e[i]===null)){var n=e[i],r=this._key(n);this._map[r]?delete this._map[r]:this._entered.push(n),this._data[i]=n,this._xmap[r]=n}for(var r in this._map)this._exited.push(this._map[r]),delete this._map[r];var o=this._map;this._map=this._xmap,this._xmap=o;for(var i=0;i<this._exited.length;i++){var n=this._exited[i],a=this._key(n),l=this._refMap[a];this._listener.exit(n,l),delete this._refMap[a]}for(var i=0;i<this._entered.length;i++){var n=this._entered[i],a=this._key(n),l=this._listener.enter(n);l&&(this._refMap[a]=l)}for(var i=0;i<this._data.length;i++)if(!(typeof e[i]!="object"||e[i]===null)){var n=this._data[i],a=this._key(n),l=this._refMap[a];this._listener.update(n,l)}this._entered.length=0,this._exited.length=0,this._data.length=0},s.prototype.ref=function(e){return this._refMap[this._key(e)]},s})();class UWe{constructor(e){this.gameApp=e}playCellBreakAnim(e,i){if(!e||e.isDestroyed)return;const n=this.getCellCenter(e);this.createFlyingBubble(n,e,i);const r=this.createBubbles(n,e.color);this.animateBubbles(r),this.playScoreAnim(e,i.score)}getCellCenter(e){const i=e.getDisplayPoints();return i.length<3?{x:0,y:0}:{x:i.reduce((n,r)=>n+r.x,0)/i.length,y:i.reduce((n,r)=>n+r.y,0)/i.length}}createBubbles(e,i){const o=[];for(let a=0;a<12;a++){const l=this.createSingleBubble(e,50,a,12,i);o.push(l)}return o}createSingleBubble(e,i,n,r,o){const a=new ki;this.gameApp.effectGraphic.addChild(a);const l=n/r*Math.PI*2,h=e.x+Math.cos(l)*i,d=e.y+Math.sin(l)*i,f=Math.random()*8+4;return a.beginFill(o,.8),a.drawCircle(0,0,f),a.endFill(),a.position.set(h,d),Object.assign(a,{originalX:h,originalY:d,size:f,diffusionAngle:l,diffusionSpeed:Math.random()*.5+.5,alpha:1,scale:{x:1,y:1}}),a}animateBubbles(e){const n=Date.now(),r=()=>{const o=Date.now()-n,a=Math.min(o/500,1);e.forEach((l,h)=>{this.updateBubble(l,a,h)}),a<1?requestAnimationFrame(r):this.cleanupBubbles(e)};r()}updateBubble(e,i,n){if(i<=0){e.x=e.originalX,e.y=e.originalY,e.scale.set(1),e.alpha=1;return}const r=1-Math.pow(1-i,2),o=r*80*e.diffusionSpeed;e.x=e.originalX+Math.cos(e.diffusionAngle)*o,e.y=e.originalY+Math.sin(e.diffusionAngle)*o;const a=1+r*.8;e.scale.set(a),e.alpha=1-r}cleanupBubbles(e){e.forEach(i=>{i.parent&&i.parent.removeChild(i),i.destroy()})}playScoreAnim(e,i){const n=new Xi(`+${i}`,{fontFamily:"Arial",fontSize:72,fill:16777215,stroke:0,strokeThickness:3,align:"center"}),r=this.getCellCenter(e);n.position.set(r.x,r.y),n.anchor.set(.5,.5),this.gameApp.effectGraphic.addChild(n),this.animateScore(n,r.y)}animateScore(e,i){const r=Date.now(),o=()=>{const a=Date.now()-r,l=Math.min(a/1e3,1);e.y=i-l*50,e.alpha=1-l,l<1?requestAnimationFrame(o):(e.parent&&e.parent.removeChild(e),e.destroy())};o()}playExplosionAnim(e,i=16711680){const n=this.createExplosionParticles(e,i);this.animateExplosion(n)}createExplosionParticles(e,i){const r=[];for(let o=0;o<20;o++){const a=new ki;this.gameApp.effectGraphic.addChild(a);const l=Math.random()*6+3;a.beginFill(i,.9),a.drawCircle(0,0,l),a.endFill(),a.position.set(e.x,e.y),Object.assign(a,{velocity:{x:(Math.random()-.5)*200,y:(Math.random()-.5)*200},life:1,decay:Math.random()*.02+.01,size:l}),r.push(a)}return r}animateExplosion(e){const i=()=>{let n=!0;e.forEach(r=>{if(r.life>0){n=!1,r.x+=r.velocity.x*.016,r.y+=r.velocity.y*.016,r.velocity.x*=.98,r.velocity.y*=.98,r.life-=r.decay,r.alpha=r.life;const o=1+(1-r.life)*.5;r.scale.set(o)}}),n?this.cleanupParticles(e):requestAnimationFrame(i)};i()}cleanupParticles(e){e.forEach(i=>{i.parent&&i.parent.removeChild(i),i.destroy()})}createFlyingBubble(e,i,n){const r=n.colorIndex,o=this.getColorIndicatorPosition(r);if(!o)return;const a=new ki;this.gameApp.effectGraphic.addChild(a);const l=24;a.beginFill(i.color,.9),a.drawCircle(0,0,l),a.endFill(),a.position.set(e.x,e.y),this.animateFlyingBubble(a,e,o,n)}getColorIndicatorPosition(e){if(this.gameApp&&this.gameApp.uiManager&&this.gameApp.uiManager.levelColorIndicators){const i=this.gameApp.uiManager.levelColorIndicators[e];if(i){const n=i.toGlobal(new si(0,0));return{x:n.x,y:n.y}}}return null}animateFlyingBubble(e,i,n,r){const a=Date.now(),l=()=>{const h=Date.now()-a,d=Math.min(h/800,1),f=this.easeInOutQuad(d);e.x=i.x+(n.x-i.x)*f,e.y=i.y+(n.y-i.y)*f;const p=50;e.y-=Math.sin(d*Math.PI)*p;const g=1+d*.5;e.scale.set(g),d<1?requestAnimationFrame(l):(this.playColorIndicatorHitEffect(r),e.parent&&e.parent.removeChild(e),e.destroy())};l()}easeInOutQuad(e){return e<.5?2*e*e:-1+(4-2*e)*e}playColorIndicatorHitEffect(e){this.gameApp&&this.gameApp.uiManager&&this.gameApp.uiManager.playColorIndicatorHitEffect(e)}}const yee=[{id:1,name:"",description:"",targetScore:100,minMatchLength:3,colorIndex:[0,1],dropletCount:[3,3],collectCount:[3,3]},{id:2,name:"",description:"",targetScore:150,minMatchLength:3,colorIndex:[0,1,2],dropletCount:[4,4,4],collectCount:[4,4,4]},{id:3,name:"",description:"",targetScore:200,minMatchLength:3,colorIndex:[0,1,2,3],dropletCount:[5,5,5,5],collectCount:[5,5,5,5]},{id:4,name:"",description:"",targetScore:250,minMatchLength:4,colorIndex:[0,1,2,3,4],dropletCount:[6,6,6,6,6],collectCount:[6,6,6,6,6]},{id:5,name:"",description:"",targetScore:300,minMatchLength:4,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[8,8,8,8,8]},{id:6,name:"",description:"",targetScore:350,minMatchLength:4,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[10,10,10,10,10]},{id:7,name:"",description:"",targetScore:400,minMatchLength:5,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[12,12,12,12,12]},{id:8,name:"",description:"",targetScore:450,minMatchLength:5,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[15,15,15,15,15]},{id:9,name:"",description:"",targetScore:500,minMatchLength:5,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[18,18,18,18,18]},{id:10,name:"",description:"",targetScore:600,minMatchLength:5,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[20,20,20,20,20]}];function FWe(s){return yee.find(e=>e.id===s)||null}function zWe(){return yee}class XWe extends Qt{constructor(){super(),this.bodies=[],this.joints=[],this._colorIndex=0,this.ballSize=30,this.centerBody=null,this._isDestroyed=!1,this._highlighted=!1}setPoints(e){this.initBodies(e),this.initJoints()}getDisplayPoints(){if(this.bodies.length<3)return this.getBoundsForFewPoints();const e=this.bodies.reduce((r,o)=>r+o.getPosition().x,0)/this.bodies.length*os.PPM,i=this.bodies.reduce((r,o)=>r+o.getPosition().y,0)/this.bodies.length*os.PPM;let n=this.bodies.map(r=>{const o=r.getPosition(),a=o.x*os.PPM,l=o.y*os.PPM,h=a-e,d=l-i,f=Math.sqrt(h*h+d*d);if(f<.001)return{x:a,y:l+this.ballSize};const p=h/f,g=d/f;return{x:a+p*this.ballSize*1,y:l+g*this.ballSize*1}});return n.sort((r,o)=>{const a=Math.atan2(r.y-i,r.x-e),l=Math.atan2(o.y-i,o.x-e);return a-l}),n}distance(e,i){return Math.sqrt((i.x-e.x)**2+(i.y-e.y)**2)}getBoundsForFewPoints(){if(this.bodies.length===0)return[];if(this.bodies.length===1){const e=this.bodies[0].getPosition(),i={x:e.x*os.PPM,y:e.y*os.PPM},n=this.ballSize;return[{x:i.x-n,y:i.y-n},{x:i.x+n,y:i.y-n},{x:i.x+n,y:i.y+n},{x:i.x-n,y:i.y+n}]}if(this.bodies.length===2){const e=this.bodies[0].getPosition(),i=this.bodies[1].getPosition(),n={x:e.x*os.PPM,y:e.y*os.PPM},r={x:i.x*os.PPM,y:i.y*os.PPM},o=this.ballSize,a=r.x-n.x,l=r.y-n.y,h=Math.sqrt(a*a+l*l);if(h===0)return[{x:n.x-o,y:n.y-o},{x:n.x+o,y:n.y-o},{x:n.x+o,y:n.y+o},{x:n.x-o,y:n.y+o}];const d=-l/h,f=a/h;return[{x:n.x+d*o,y:n.y+f*o},{x:n.x-d*o,y:n.y-f*o},{x:r.x-d*o,y:r.y-f*o},{x:r.x+d*o,y:r.y+f*o}]}return[]}get colorIndex(){return this._colorIndex}set colorIndex(e){this._colorIndex=e}get color(){return os.colors[this.colorIndex]}setHighlight(e){this._highlighted=e}get highlighted(){return this._highlighted||!1}initBodies(e){this.cleanupBodies(),e.forEach(i=>{const n=os.physicsWorld.createBody({type:pn.DYNAMIC,position:new $(i.x/os.PPM,i.y/os.PPM)}),r=new iWe(this.ballSize/os.PPM);n.createFixture({shape:r,density:1,friction:.3,restitution:.5}),this.bodies.push(n)})}initJoints(){this.cleanupJoints();const e=this.bodies;if(!(e.length<2))for(let i=0;i<e.length;i++){const n=e[i],r=e[(i+1)%e.length],o=new QR({bodyA:n,bodyB:r,localAnchorA:new $(0,0),localAnchorB:new $(0,0),frequencyHz:5,dampingRatio:.7});os.physicsWorld.createJoint(o),this.joints.push(o)}}cleanupBodies(){this.bodies.forEach(e=>{e&&e.getWorld()&&e.getWorld().destroyBody(e)}),this.bodies=[]}cleanupJoints(){this.joints.forEach(e=>{e&&e.getWorld()&&e.getWorld().destroyJoint(e)}),this.joints=[]}destroy(){this.cleanupBodies(),this.cleanupJoints(),this._isDestroyed=!0}playBreakAnim(){os.animationManager&&os.animationManager.playCellBreakAnim(this)}get isDestroyed(){return this._isDestroyed}set isDestroyed(e){this._isDestroyed=e}}class WWe{constructor(e){this.gameApp=e,this.currentLevel=null,this.currentLevelConfig=null,this.colorPool={},this.cols=6,this.rows=6,this.preferedCellCount=this.cols*this.rows,this.levelState={currentScore:0,colorScores:{},timeRemaining:0,isCompleted:!1,isFailed:!1},this.scoreByColor={},this.isGameActive=!1,this.isLevelCompleted=!1,this.isGameEnded=!1}loadLevel(e){try{if(this.clearCurrentLevel(),this.currentLevelConfig=FWe(e),!this.currentLevelConfig)throw new Error(` ${e} `);this.currentLevelId=e,this.currentScore=0,this.countByColor={},this.scoreByColor={},this.isGameActive=!1,this.isLevelCompleted=!1,this.isGameEnded=!1,this.currentLevelConfig.colorIndex.forEach(i=>{this.countByColor[i]=0,this.scoreByColor[i]=0}),this.initColorPool(),this.checkAndGenerateCells(),this.startGame(),this.gameApp.uiManager&&this.gameApp.uiManager.initLevelInfoUI(),console.log(` ${e} `)}catch(i){console.error(":",i.message)}}clearCurrentLevel(){this.gameApp.cells&&this.gameApp.cells.children.concat([]).forEach(i=>{this.gameApp.removeCell(i)}),this.isGameActive=!1,this.isLevelCompleted=!1,this.isGameEnded=!1,this.currentLevelConfig=null,this.currentLevelId=null,this.colorPool=null}getColorPoolRemainCount(){return this.colorPool===null?null:Object.values(this.colorPool).reduce((e,i)=>e+i,0)}initColorPool(){const e=this.currentLevelConfig;e.dropletCount===null?this.colorPool=null:(this.colorPool={},e.colorIndex.forEach((i,n)=>{this.colorPool[i]=e.dropletCount[n]}))}generateCellsByCount(e){const i=this.gameApp.pixi.screen.width,n=this.gameApp.pixi.screen.height,r=150,o=Math.ceil(e/this.cols),l=Math.ceil(e/o)*r,h=o*r,d=(i-l)/2,f=(n-h)/2-50;for(let p=0;p<e;p++){const g=Math.floor(p/this.cols),y=p%this.cols,x=d+y*r+r/2,_=f+g*r+r/2,w=this.getRandomColorFromPool();if(w!==null){const O=[],T=Math.floor(r*.4),C=6;for(let B=0;B<C;B++){const I=B/C*Math.PI*2,R=x+Math.cos(I)*T,P=_+Math.sin(I)*T;O.push({x:R,y:P})}const A=new XWe;A.colorIndex=w,A.setPoints(O),this.gameApp.addCell(A)}}}getRandomColorFromPool(){if(this.colorPool===null){const r=this.currentLevelConfig.colorIndex,o=Math.floor(Math.random()*r.length);return r[o]}const e=Object.keys(this.colorPool).filter(r=>this.colorPool[r]>0);if(e.length===0)return null;const i=Math.floor(Math.random()*e.length),n=parseInt(e[i]);return this.colorPool[n]--,n}startGame(){this.isGameActive=!0}updateScore(e,i){if(!this.isGameActive||!this.currentLevelConfig||this.isLevelCompleted)return null;this.countByColor[i]||(this.countByColor[i]=0),this.countByColor[i]+=1,this.scoreByColor[i]||(this.scoreByColor[i]=0),this.scoreByColor[i]+=e,this.currentScore+=e;const n=this.checkLevelCompletion();return n&&!this.isLevelCompleted&&(this.isLevelCompleted=!0,this.isGameActive=!1,console.log("...")),{score:e,colorIndex:i,count:this.countByColor[i],currentScore:this.currentScore,levelCompleted:n,scoreByColor:{...this.scoreByColor}}}checkLevelCompletion(){if(!this.currentLevelConfig)return!1;const e=this.currentLevelConfig;let i=!0;return e.colorIndex.forEach((n,r)=>{const o=this.countByColor[n]||0,a=e.collectCount[r];o<a&&(i=!1)}),i}isLevelFinished(){return this.isLevelCompleted}isGameFinished(){return this.isGameEnded}canAcceptInput(){return this.isGameActive&&!this.isLevelCompleted&&!this.isGameEnded}endGame(e){if(this.isGameEnded)return;this.isGameEnded=!0,this.isGameActive=!1,this.isLevelCompleted=!0;const i={isWin:e,levelId:this.currentLevelId,levelName:this.currentLevelConfig.name,levelConfig:this.currentLevelConfig,currentScore:this.currentScore,targetScore:this.currentLevelConfig.targetScore,countByColor:{...this.countByColor},scoreByColor:{...this.scoreByColor},targetCounts:{...this.currentLevelConfig.collectCount}};this.gameApp.settlementManager.showSettlement(i),console.log(e?` ${this.currentLevelId} `:` ${this.currentLevelId} `)}getCurrentLevelInfo(){return this.currentLevelConfig?{id:this.currentLevelId,name:this.currentLevelConfig.name,description:this.currentLevelConfig.description,currentScore:this.currentScore,targetScore:this.currentLevelConfig.targetScore,countByColor:this.countByColor,isGameActive:this.isGameActive}:null}destroy(){this.clearCurrentLevel(),this.isGameActive=!1}checkAndGenerateCells(){const e=this.gameApp.cells.children.length,i=this.preferedCellCount-e;if(i<=0)return;let n=0;this.colorPool===null?n=i:n=Math.min(i,this.getColorPoolRemainCount()),n>0&&this.generateCellsByCount(n)}generateHexagonalGridLayout(){}calculateMaxScreenCapacity(){return this.cols*this.rows}}class HWe{constructor(e){this.gameApp=e,this.isDragging=!1,this.currentDragCell=null,this.dragCellQueue=[],this.initDragSystem()}initDragSystem(){this.gameApp.cells.eventMode="static",this.gameApp.cells.hitArea=new Pi(0,0,this.gameApp.pixi.screen.width,this.gameApp.pixi.screen.height),this.gameApp.cells.on("pointerdown",this.startDrag.bind(this)),this.gameApp.cells.on("pointermove",this.updateDrag.bind(this)),this.gameApp.cells.on("pointerup",this.endDrag.bind(this)),this.gameApp.cells.on("pointerupoutside",this.endDrag.bind(this))}startDrag(e){if(!this.gameApp.levelManager.canAcceptInput())return;const i=e.global;this.isDragging=!0,this.currentDragCell=null,this.dragCellQueue=[],this.currentDragCell=this.findCellAtPoint(i),this.currentDragCell&&(this.dragCellQueue.push(this.currentDragCell),this.currentDragCell.setHighlight(!0))}updateDrag(e){if(!this.gameApp.levelManager.canAcceptInput())return;const i=e.global;if(!this.isDragging)return;const n=this.currentDragCell;if(this.currentDragCell=this.findCellAtPoint(i),this.currentDragCell&&this.currentDragCell!==n){const r=this.dragCellQueue.length>0?this.dragCellQueue[this.dragCellQueue.length-1]:null;r&&this.currentDragCell.colorIndex===r.colorIndex?this.dragCellQueue.includes(this.currentDragCell)||(this.dragCellQueue.push(this.currentDragCell),this.currentDragCell.setHighlight(!0)):(!r||this.currentDragCell&&!this.dragCellQueue.includes(this.currentDragCell))&&(this.clearDragQueue(),this.dragCellQueue.push(this.currentDragCell),this.currentDragCell.setHighlight(!0))}}endDrag(e){if(!this.isDragging||(this.isDragging=!1,this.currentDragCell=null,this.dragCellQueue.length===0))return;const i=this.dragCellQueue[0],n=this.countRemainingCellsOfColor(i.colorIndex);this.dragCellQueue.length>=3||n<3?this.processDragMatch():this.clearDragQueue()}clearDragQueue(){this.dragCellQueue.forEach(e=>{e&&!e.isDestroyed&&e.setHighlight(!1)}),this.dragCellQueue=[]}findCellAtPoint(e){for(let i=this.gameApp.cells.children.length-1;i>=0;i--){const n=this.gameApp.cells.children[i],r=n.getDisplayPoints();if(!n.isDestroyed&&this.isPointInPolygon([e.x,e.y],r.map(o=>[o.x,o.y])))return n}return null}isPointInPolygon(e,i){let n=!1;const r=e[0],o=e[1];for(let a=0,l=i.length-1;a<i.length;l=a++){const h=i[a][0],d=i[a][1],f=i[l][0],p=i[l][1];d>o!=p>o&&r<(f-h)*(o-d)/(p-d)+h&&(n=!n)}return n}processDragMatch(){this.dragCellQueue.forEach(i=>{i&&!i.isDestroyed&&(i.isRemoved=!0,i.setHighlight(!1))});let e=!1;this.dragCellQueue.forEach((i,n)=>{const r=n+1;setTimeout(()=>{if(i&&!i.isDestroyed&&i.isRemoved){const o=this.gameApp.levelManager.updateScore(r,i.colorIndex);o&&o.levelCompleted&&(e=!0),this.gameApp.animationManager.playCellBreakAnim(i,o),this.gameApp.removeCell(i)}},n*150)}),this.dragCellQueue=[],setTimeout(e?()=>{this.gameApp.levelManager.endGame(!0)}:()=>{this.gameApp.levelManager.checkAndGenerateCells()},500)}countRemainingCellsOfColor(e){let i=0;for(let n=0;n<this.gameApp.cells.children.length;n++){const r=this.gameApp.cells.children[n];!r.isDestroyed&&r.colorIndex===e&&i++}return i}destroy(){this.gameApp.cells&&(this.gameApp.cells.off("pointerdown",this.startDrag.bind(this)),this.gameApp.cells.off("pointermove",this.updateDrag.bind(this)),this.gameApp.cells.off("pointerup",this.endDrag.bind(this)),this.gameApp.cells.off("pointerupoutside",this.endDrag.bind(this)))}}class GWe extends Qt{constructor(e,i){super(),this.color=e,this.collectCount=i,this.currentProgress=0,this.background=new ki,this.background.beginFill(e),this.background.drawCircle(0,0,60),this.background.endFill(),this.addChild(this.background),this.progressText=new Xi("0/0",{fontFamily:"Arial",fontSize:40,fill:16777215,align:"center"}),this.progressText.anchor.set(.5,.5),this.addChild(this.progressText),this.updateProgress(0)}updateProgress(e){this.currentProgress=Math.min(e,this.collectCount),this.progressText.text=`${this.currentProgress}/${this.collectCount}`}playHitEffect(e){this.scale.set(1*.9);const n=new ki;n.beginFill(this.color,.5),n.drawCircle(0,0,70),n.endFill(),this.addChild(n),setTimeout(()=>{this.scale.set(1),this.children.includes(n)&&this.removeChild(n),console.log("playHitEffect",e),e.levelCompleted&&os.levelManager.endGame(!0)},100),this.updateProgress(e.count)}}class QWe{constructor(e){this.gameApp=e,this.levelInfoUI=null,this.levelInfoStaticText=null,this.levelColorIndicators=[]}initLevelInfoUI(){if(!this.gameApp.levelManager||!this.gameApp.levelManager.currentLevelConfig)return;const e=this.gameApp.levelManager.currentLevelConfig;this.levelInfoUI&&this.gameApp.ui.removeChild(this.levelInfoUI),this.levelInfoUI=new Qt,this.gameApp.ui.addChild(this.levelInfoUI),this.levelInfoStaticText=new Xi(`${e.id}`,{fontFamily:"Arial",fontSize:66,fill:16777215,align:"center"}),this.levelInfoStaticText.x=0,this.levelInfoStaticText.y=0,this.levelInfoStaticText.anchor.set(.5,.5),this.levelInfoUI.addChild(this.levelInfoStaticText),this.levelColorIndicators=[];const i=120,n=30,o=-(e.colorIndex.length*i+(e.colorIndex.length-1)*n)/2;e.colorIndex.forEach((a,l)=>{const h=new GWe(this.gameApp.colors[a],e.collectCount[l]);h.x=o+l*(i+n)+i/2,h.y=120,this.levelInfoUI.addChild(h),this.levelColorIndicators.push(h)}),this.initLevelProgressUI(),this.levelInfoUI.x=this.gameApp.pixi.screen.width/2,this.levelInfoUI.y=120}initLevelProgressUI(){if(!this.levelInfoUI||!this.gameApp.levelManager||!this.gameApp.levelManager.currentLevelConfig)return;const e=this.gameApp.levelManager.currentLevelConfig,i=this.gameApp.levelManager.countByColor||{};e.colorIndex.forEach((n,r)=>{const o=i[n]||0;this.levelColorIndicators[r]&&this.levelColorIndicators[r].updateProgress(o)})}playColorIndicatorHitEffect(e){this.levelColorIndicators[e.colorIndex]&&this.levelColorIndicators[e.colorIndex].playHitEffect(e)}destroy(){this.levelInfoUI&&(this.gameApp.ui.removeChild(this.levelInfoUI),this.levelInfoUI=null),this.levelColorIndicators=[]}}class YWe{constructor(e){this.gameApp=e}clearCellGraphics(){this.gameApp.normalCellGraphic&&this.gameApp.normalCellGraphic.clear(),this.gameApp.highlightBorderGraphic&&this.gameApp.highlightBorderGraphic.clear(),this.gameApp.highlightCellGraphic&&this.gameApp.highlightCellGraphic.clear(),this.gameApp.effectGraphic&&this.gameApp.effectGraphic.clear()}drawAllCellGraphics(){this.gameApp.normalCellGraphic.clear(),this.gameApp.highlightBorderGraphic.clear(),this.gameApp.highlightCellGraphic.clear(),this.gameApp.cells.children.forEach(e=>{e.isDestroyed||this.drawCell(e)})}drawCell(e){const i=e.getDisplayPoints();if(i.length<3)return;const n="catmull";e.highlighted?(this.gameApp.highlightCellGraphic.lineStyle(0),this.gameApp.highlightCellGraphic.beginFill(e.color),this.drawPath(this.gameApp.highlightCellGraphic,i,n),this.gameApp.highlightCellGraphic.closePath(),this.gameApp.highlightCellGraphic.endFill(),this.gameApp.highlightBorderGraphic.lineStyle(20,16777215,1),this.gameApp.highlightBorderGraphic.beginFill(16777215,.1),this.drawPath(this.gameApp.highlightBorderGraphic,i,n),this.gameApp.highlightBorderGraphic.closePath(),this.gameApp.highlightBorderGraphic.endFill()):(this.gameApp.normalCellGraphic.lineStyle(0),this.gameApp.normalCellGraphic.beginFill(e.color),this.drawPath(this.gameApp.normalCellGraphic,i,n),this.gameApp.normalCellGraphic.closePath(),this.gameApp.normalCellGraphic.endFill())}drawPath(e,i,n){switch(n){case"line":this.drawLinePath(e,i);break;case"quadratic":this.drawQuadraticPath(e,i);break;case"cubic":this.drawCubicPath(e,i);break;case"smooth":this.drawSmoothPath(e,i);break;case"catmull":default:this.drawCatmullPath(e,i);break}}drawLinePath(e,i){e.moveTo(i[0].x,i[0].y);for(let n=1;n<i.length;n++)e.lineTo(i[n].x,i[n].y)}drawQuadraticPath(e,i){const n=i,r=n.length;if(r<3){this.drawLinePath(e,i);return}e.moveTo(n[0].x,n[0].y);for(let o=0;o<r;o++){const a=n[o],l=n[(o+1)%r];n[(o+2)%r];const h=(a.x+l.x)/2,d=(a.y+l.y)/2;e.quadraticCurveTo(h,d,l.x,l.y)}}drawCubicPath(e,i){const n=i,r=n.length;if(r<4){this.drawQuadraticPath(e,i);return}e.moveTo(n[0].x,n[0].y);for(let o=0;o<r;o++){const a=n[o],l=n[(o+1)%r],h=n[(o+2)%r];n[(o+3)%r];const d=a.x+(l.x-a.x)*.5,f=a.y+(l.y-a.y)*.5,p=l.x+(h.x-l.x)*.5,g=l.y+(h.y-l.y)*.5;e.bezierCurveTo(d,f,p,g,l.x,l.y)}}drawSmoothPath(e,i){const n=i,r=n.length;e.moveTo(n[0].x,n[0].y);for(let o=1;o<r;o++){const a=n[o-1],l=n[o],h=n[(o+1)%r],d=.3,f=a.x+(l.x-a.x)*(1-d),p=a.y+(l.y-a.y)*(1-d),g=l.x+(h.x-l.x)*d,y=l.y+(h.y-l.y)*d;e.bezierCurveTo(f,p,g,y,l.x,l.y)}}drawCatmullPath(e,i){const n=i,r=n.length;e.moveTo(n[0].x,n[0].y);const o=10;for(let a=0;a<r;a++){const l=n[(a-1+r)%r],h=n[a],d=n[(a+1)%r],f=n[(a+2)%r];for(let p=1;p<=o;p++){const g=p/o,y=g*g,x=y*g,_=.5*(2*h.x+(-l.x+d.x)*g+(2*l.x-5*h.x+4*d.x-f.x)*y+(-l.x+3*h.x-3*d.x+f.x)*x),w=.5*(2*h.y+(-l.y+d.y)*g+(2*l.y-5*h.y+4*d.y-f.y)*y+(-l.y+3*h.y-3*d.y+f.y)*x);e.lineTo(_,w)}}}destroy(){}}class jWe{constructor(e){this.gameApp=e,this.container=null,this.isVisible=!1,this.settlementData=null,this.initSettlementContainer()}initSettlementContainer(){this.container=new Qt,this.container.visible=!1,this.container.zIndex=1e3,this.gameApp.pixi.stage.addChild(this.container)}showSettlement(e){this.settlementData=e,this.isVisible=!0,this.clearSettlement(),this.createSettlementUI(),this.container.visible=!0,this.playShowAnimation()}hideSettlement(){this.isVisible=!1,this.container.visible=!1,this.clearSettlement()}clearSettlement(){for(;this.container.children.length>0;)this.container.removeChildAt(0)}createSettlementUI(){const e=this.gameApp.pixi.screen.width,i=this.gameApp.pixi.screen.height;this.calculateElementPositions(e,i),this.createBackgroundMask(e,i),this.createMainPanel(),this.createTitle(),this.createResultInfo(),this.createButtons(),this.playAnimationSequence()}calculateElementPositions(e,i){const n=this.settlementData.levelConfig.colorIndex.length,r=600,l=n*(90+20),h=r+l;this.panelConfig={width:Math.max(800,600+n*50),height:Math.max(1e3,h),x:(e-Math.max(800,600+n*50))/2,y:(i-Math.max(1e3,h))/2},this.fontConfig={title:Math.max(72,96-(n-2)*8),levelInfo:Math.max(36,48-(n-2)*4),score:Math.max(48,64-(n-2)*6),colorTitle:Math.max(40,52-(n-2)*4),colorCount:Math.max(36,48-(n-2)*4),colorScore:Math.max(32,44-(n-2)*4),button:Math.max(28,36-(n-2)*2),colorIndicator:Math.max(20,30-(n-2)*2),buttonWidth:Math.max(240,280-(n-2)*10),buttonHeight:Math.max(70,90-(n-2)*5)},this.titleConfig={x:this.panelConfig.x+this.panelConfig.width/2,y:this.panelConfig.y+50},this.infoContainerConfig={x:this.panelConfig.x+this.panelConfig.width/2,y:this.titleConfig.y+120},this.levelInfoConfig={y:0},this.scoreInfoConfig={y:80},this.colorCollectionConfig={y:180},this.calculateColorItemPositions(),this.calculateButtonPositions(e,i)}calculateColorItemPositions(){const e=this.settlementData.levelConfig.colorIndex.length;this.colorItemConfigs=[];const o=Math.max(70,Math.min(120,90-(e-2)*5));let a=100;for(let l=0;l<e;l++){const h=-220-(e>3?(e-3)*20:0),d=-60-(e>3?(e-3)*10:0),f=140+(e>3?(e-3)*10:0);this.colorItemConfigs.push({y:a,colorIndicator:{x:h,y:a},collectText:{x:d,y:a},scoreText:{x:f,y:a}}),a+=o}}calculateButtonPositions(e,i){this.settlementData.levelConfig.colorIndex.length;const o=this.panelConfig.y+this.panelConfig.height-150-120,a=this.fontConfig.buttonWidth+40;this.buttonConfig={x:this.panelConfig.x+this.panelConfig.width/2,y:o,restartButton:{x:-a/2},nextButton:{x:a/2}}}createBackgroundMask(e,i){const n=new ki;n.beginFill(0,.7),n.drawRect(0,0,e,i),n.endFill(),n.eventMode="static",n.on("pointerdown",()=>{}),this.container.addChild(n)}createMainPanel(){const e=new ki;e.beginFill(2899536,.95),e.lineStyle(4,3447003,1),e.drawRoundedRect(this.panelConfig.x,this.panelConfig.y,this.panelConfig.width,this.panelConfig.height,20),e.endFill();const i=new ki;i.beginFill(3447003,.3),i.drawRoundedRect(this.panelConfig.x+10,this.panelConfig.y+10,this.panelConfig.width-20,80,15),i.endFill(),this.container.addChild(e),this.container.addChild(i)}createTitle(){const e=this.settlementData.isWin?"":"",i=this.settlementData.isWin?3066993:15158332,n=new Xi(e,{fontFamily:"Arial",fontSize:this.fontConfig.title,fontWeight:"bold",fill:i,stroke:16777215,strokeThickness:3,align:"center"});n.anchor.set(.5,0),n.x=this.titleConfig.x,n.y=this.titleConfig.y,this.container.addChild(n)}createResultInfo(){const e=new Qt;e.x=this.infoContainerConfig.x,e.y=this.infoContainerConfig.y;const i=new Xi(` ${this.settlementData.levelId}: ${this.settlementData.levelName}`,{fontFamily:"Arial",fontSize:this.fontConfig.levelInfo,fill:16777215,align:"center"});i.anchor.set(.5,0),i.y=this.levelInfoConfig.y,e.addChild(i);const n=new Xi(`: ${this.settlementData.currentScore}`,{fontFamily:"Arial",fontSize:this.fontConfig.score,fontWeight:"bold",fill:15965202,align:"center"});n.anchor.set(.5,0),n.y=this.scoreInfoConfig.y,n.alpha=0,e.addChild(n);const r=this.createColorCollectionInfo();r.alpha=0,e.addChild(r),this.animationElements={scoreText:n,colorContainer:r},this.container.addChild(e)}createColorCollectionInfo(){const e=new Qt;e.y=this.colorCollectionConfig.y;const i=new Xi(":",{fontFamily:"Arial",fontSize:this.fontConfig.colorTitle,fontWeight:"bold",fill:16777215,align:"center"});i.anchor.set(.5,0),e.addChild(i);const n=this.gameApp.colors;return this.colorElements=[],this.settlementData.levelConfig.colorIndex.forEach((r,o)=>{const a=n[r],l=this.settlementData.countByColor[r]||0,h=this.settlementData.targetCounts[o],d=this.settlementData.scoreByColor[r]||0,f=this.colorItemConfigs[o],p=new Qt;p.alpha=0;const g=new ki;g.beginFill(a),g.drawCircle(0,0,this.fontConfig.colorIndicator),g.endFill(),g.x=f.colorIndicator.x,g.y=f.colorIndicator.y;const y=new Xi(`${l}/${h}`,{fontFamily:"Arial",fontSize:this.fontConfig.colorCount,fill:l>=h?3066993:16777215,align:"center"});y.anchor.set(.5,.5),y.x=f.collectText.x,y.y=f.collectText.y;const x=new Xi(`+${d}`,{fontFamily:"Arial",fontSize:this.fontConfig.colorScore,fill:15965202,align:"center"});x.anchor.set(.5,.5),x.x=f.scoreText.x,x.y=f.scoreText.y,p.addChild(g),p.addChild(y),p.addChild(x),e.addChild(p),this.colorElements.push(p)}),e}createButtons(){const e=new Qt;e.x=this.buttonConfig.x,e.y=this.buttonConfig.y,e.alpha=0;const i=this.createButton("",15158332,()=>{this.onRestartClick()});i.x=this.buttonConfig.restartButton.x,e.addChild(i);const n=zWe().length;if(this.settlementData.isWin&&this.settlementData.levelId<n){const r=this.createButton("",3066993,()=>{this.onNextLevelClick()});r.x=this.buttonConfig.nextButton.x,e.addChild(r)}this.buttonContainer=e,this.container.addChild(e)}createButton(e,i,n){const r=new Qt;r.eventMode="static";const o=new ki;o.beginFill(i),o.lineStyle(3,16777215,1),o.drawRoundedRect(-this.fontConfig.buttonWidth/2,-this.fontConfig.buttonHeight/2,this.fontConfig.buttonWidth,this.fontConfig.buttonHeight,20),o.endFill();const a=new Xi(e,{fontFamily:"Arial",fontSize:this.fontConfig.button,fontWeight:"bold",fill:16777215,align:"center"});return a.anchor.set(.5,.5),r.addChild(o),r.addChild(a),r.on("pointerdown",n),r.on("pointerover",()=>{o.tint=13421772}),r.on("pointerout",()=>{o.tint=16777215}),r}playAnimationSequence(){this.playShowAnimation(()=>{this.playColorAnimations(()=>{this.playTotalAnimations(()=>{this.showButtons()})})})}playShowAnimation(e){this.container.alpha=0,this.container.scale.set(.8);let i=0;const n=()=>{i+=.08,i>=1&&(i=1,this.gameApp.pixi.ticker.remove(n),e&&e());const r=1-Math.pow(1-i,3);this.container.alpha=r,this.container.scale.set(.8+(1-.8)*r)};this.gameApp.pixi.ticker.add(n)}playColorAnimations(e){let i=0;const n=()=>{if(i>=this.colorElements.length){e&&e();return}const r=this.colorElements[i];r.alpha=0,r.scale.set(.5);let o=0;const a=()=>{o+=.15,o>=1&&(o=1,this.gameApp.pixi.ticker.remove(a),i++,setTimeout(n,100));const l=1-Math.pow(1-o,2);r.alpha=l,r.scale.set(.5+(1-.5)*l)};this.gameApp.pixi.ticker.add(a)};n()}playTotalAnimations(e){if(this.animationElements.scoreText){this.animationElements.scoreText.alpha=0,this.animationElements.scoreText.scale.set(.8);let i=0;const n=()=>{if(i+=.12,i>=1){i=1,this.gameApp.pixi.ticker.remove(n),this.animationElements.colorContainer.alpha=0,this.animationElements.colorContainer.scale.set(.8);let o=0;const a=()=>{o+=.12,o>=1&&(o=1,this.gameApp.pixi.ticker.remove(a),e&&e());const l=1-Math.pow(1-o,2);this.animationElements.colorContainer.alpha=l,this.animationElements.colorContainer.scale.set(.8+(1-.8)*l)};this.gameApp.pixi.ticker.add(a)}const r=1-Math.pow(1-i,2);this.animationElements.scoreText.alpha=r,this.animationElements.scoreText.scale.set(.8+(1-.8)*r)};this.gameApp.pixi.ticker.add(n)}else e&&e()}showButtons(){if(this.buttonContainer){this.buttonContainer.alpha=0,this.buttonContainer.scale.set(.8);let e=0;const i=()=>{e+=.12,e>=1&&(e=1,this.gameApp.pixi.ticker.remove(i));const n=1-Math.pow(1-e,2);this.buttonContainer.alpha=n,this.buttonContainer.scale.set(.8+(1-.8)*n)};this.gameApp.pixi.ticker.add(i)}}onRestartClick(){this.hideSettlement(),this.gameApp.levelManager.loadLevel(this.settlementData.levelId)}onNextLevelClick(){this.hideSettlement();const e=this.settlementData.levelId+1;this.gameApp.levelManager.loadLevel(e)}destroy(){this.hideSettlement(),this.container&&this.container.parent&&this.container.parent.removeChild(this.container),this.container=null}}class qWe{constructor(){cn(this,"pixi",null);cn(this,"cells",null);cn(this,"physicsWorld",null);cn(this,"timeStep",1/60);cn(this,"velocityIterations",8);cn(this,"positionIterations",3);cn(this,"PPM",50);cn(this,"colors",[4886754,8311585,16098851,15158332,10181046,1752220,15105570,3447003,3066993,15965202,15277667,48340]);cn(this,"animationManager",null);cn(this,"levelManager",null);cn(this,"dragManager",null);cn(this,"uiManager",null);cn(this,"renderManager",null);cn(this,"settlementManager",null);cn(this,"normalCellGraphic",null);cn(this,"highlightBorderGraphic",null);cn(this,"highlightCellGraphic",null);cn(this,"effectGraphic",null);cn(this,"ui",null)}init(e){this.pixi=new uA({width:e.clientWidth,height:e.clientHeight,view:e}),this.initRenderLayers(),this.initPlanck(),this.initBounds(),this.pixi.ticker.add(this.updatePhysics.bind(this)),this.renderManager=new YWe(this),this.animationManager=new UWe(this),this.levelManager=new WWe(this),this.dragManager=new HWe(this),this.uiManager=new QWe(this),this.settlementManager=new jWe(this)}initRenderLayers(){this.cells=new Qt,this.pixi.stage.addChild(this.cells),this.normalCellGraphic=new ki,this.pixi.stage.addChild(this.normalCellGraphic),this.highlightBorderGraphic=new ki,this.pixi.stage.addChild(this.highlightBorderGraphic),this.highlightCellGraphic=new ki,this.pixi.stage.addChild(this.highlightCellGraphic),this.effectGraphic=new ki,this.pixi.stage.addChild(this.effectGraphic),this.ui=new Qt,this.pixi.stage.addChild(this.ui)}initPlanck(){this.physicsWorld=new Yb({gravity:new $(0,9.8)})}updatePhysics(){this.physicsWorld.step(1/60,1,0),this.renderManager.drawAllCellGraphics()}initBounds(){const e=this.pixi.screen.width,i=this.pixi.screen.height,n=this.physicsWorld.createBody();n.createFixture(new vS(new $(0,0),new $(e/this.PPM,0))),n.createFixture(new vS(new $(0,i/this.PPM),new $(e/this.PPM,i/this.PPM))),n.createFixture(new vS(new $(0,0),new $(0,i/this.PPM))),n.createFixture(new vS(new $(e/this.PPM,0),new $(e/this.PPM,i/this.PPM))),this.bounds=n}getBounds(){return this.bounds}isInBounds(e){if(!this.bounds||!e)return!0;const i=e.getPosition(),n=this.pixi.screen.width,r=this.pixi.screen.height;return i.x*this.PPM>=0&&i.x*this.PPM<=n&&i.y*this.PPM>=0&&i.y*this.PPM<=r}addBody(e){return e}removeBody(e){e&&e.getWorld()&&e.getWorld().destroyBody(e)}addJoint(e){return e}removeJoint(e){e&&e.getWorld()&&e.getWorld().destroyJoint(e)}addConstraint(e){return this.addJoint(e)}removeConstraint(e){return this.removeJoint(e)}addCell(e){e&&this.cells.addChild(e)}removeCell(e){!e||e.isDestroyed||(e.isDestroyed=!0,e.bodies.forEach(i=>{this.physicsWorld.destroyBody(i)}),e.joints.forEach(i=>{this.physicsWorld.destroyJoint(i)}),this.cells.removeChild(e))}findAndRemoveMatches(e){if(!e)return;const i=this.cells.children.concat([]),n=[e],r=[e],o=new Set([e]);for(;n.length>0;){const a=n.pop();for(const l of i)o.has(l)||this.areCellsConnected(a,l)&&a.colorIndex===l.colorIndex&&(o.add(l),r.push(l),n.push(l))}r.length>=2&&r.forEach(a=>this.removeCell(a))}areCellsConnected(e,i){const n=e.bodies,r=i.bodies;for(const o of n)for(const a of r)if(o===a)return!0;return!1}initDom(e,i={}){mA(e,i)}destroy(){this.pixi&&this.pixi.ticker&&this.pixi.ticker.remove(this.updatePhysics),this.dragManager&&this.dragManager.destroy(),this.uiManager&&this.uiManager.destroy(),this.renderManager&&this.renderManager.destroy(),this.settlementManager&&this.settlementManager.destroy(),this.cells&&(this.cells.destroy(),this.cells=null),this.ui&&(this.ui.destroy(),this.ui=null),this.normalCellGraphic&&(this.normalCellGraphic.destroy(),this.normalCellGraphic=null),this.highlightBorderGraphic&&(this.highlightBorderGraphic.destroy(),this.highlightBorderGraphic=null),this.highlightCellGraphic&&(this.highlightCellGraphic.destroy(),this.highlightCellGraphic=null),this.effectGraphic&&(this.effectGraphic.destroy(),this.effectGraphic=null),this.physicsWorld&&(this.physicsWorld=null),this.bounds&&(this.bounds&&this.bounds.getWorld()&&this.bounds.getWorld().destroyBody(this.bounds),this.bounds=null),this.pixi&&(this.pixi.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.pixi=null)}}const ZWe=new qWe,os=ZWe,KWe={class:"game-container"},JWe={__name:"GameMatch",setup(s){const e=gt(null);io(()=>{i(),os.levelManager.loadLevel(1)});function i(){window.gameApp=os;const n={designWidth:1080,designHeight:1920};os.initDom(e.value,n),os.init(e.value)}return ra(()=>{os.destroy()}),(n,r)=>(di(),hn("div",KWe,[Kt("canvas",{ref_key:"pixiContainer",ref:e},null,512)]))}},e8e=Kt("div",{class:"loading"},"...",-1),t8e={key:1,style:{padding:"24px"}},i8e={style:{"margin-bottom":"16px"}},n8e={style:{"text-align":"center",width:"100%"}},s8e={style:{"font-size":"18px","font-weight":"500","margin-bottom":"8px"}},r8e=["src"],o8e={__name:"App",setup(s){const e=[{name:"",children:[{id:"CoinKnight",title:"",comp:Dk,link:"CoinKnight/index.html",img:"preview/CoinKnight.png"},{id:"FarmMine",title:"",comp:Dk,link:"FarmMine/index.html",img:"preview/FarmMine.png"},{id:"jigsaw",title:"",comp:Dk,link:"jigsaw/index.html",img:"preview/jigsaw.png"},{id:"BallGame",title:"",comp:S5e,img:"preview/BallGame.png"},{id:"GameMatch",title:"GameMatch",comp:JWe,img:"preview/GameMatch.png"},{id:"Game2048",title:"Game2048",comp:oXe,img:"preview/Game2048.png"},{id:"TankGame",title:"",comp:CSe,img:"preview/TankMain.png"}]},{name:"",children:[{id:"TrigoCalc",title:"",comp:MSe,img:"preview/TrigoCalc.png"},{id:"SplitImage",title:"SplitImage",comp:pXe,img:"preview/SplitImage.png"}]},{name:"Blender",children:[{id:"d-puzzle",title:"",comp:l2,link:"video/puzzle.mp4"},{id:"d-ice",title:"",comp:l2,link:"video/ice.mp4"},{id:"d-door",title:"",comp:l2,link:"video/door.mp4"}]},{name:"shader",children:[{id:"ShaderFragBase",title:"Shader-",comp:h5e},{id:"ShaderImageBase",title:"Shader-",comp:m5e}]},{name:"",children:[{id:"CurveRope",title:"(Three)",comp:L5e},{id:"CurveRopePixi",title:"(Pixi)",comp:Y5e}]},{name:"",children:[{id:"ThreeHello",title:"ThreeHello",comp:M5e}]}],i=gt(window.location.hash.slice(1));window.addEventListener("hashchange",()=>{i.value=window.location.hash.slice(1),document.title="Project:"+i.value});const n=[...e.flatMap(l=>l.children)],r=Es(()=>n.find(l=>l.id===i.value)),o=Es(()=>{var l;return(l=r.value)==null?void 0:l.comp});function a(l){window.location.hash=l.id}return(l,h)=>o.value?(di(),Ir(NH,{key:0},{default:Zt(()=>[(di(),Ir(DH(o.value),aH(_D(r.value.link?{link:r.value.link}:{})),null,16))]),fallback:Zt(()=>[e8e]),_:1})):(di(),hn("div",t8e,[(di(),hn(Un,null,th(e,d=>Kt("div",{key:d.name,style:{"margin-top":"32px"}},[Kt("h2",i8e,ea(d.name),1),vt(ni(x0.Row),{gutter:16},{default:Zt(()=>[(di(!0),hn(Un,null,th(d.children,f=>(di(),Ir(ni(x0.Col),{key:f.id,span:4,xs:12,sm:8,md:6,lg:4,xl:4},{default:Zt(()=>[f.img?(di(),Ir(ni(x0.Card),{key:0,bordered:!1,style:{"margin-bottom":"24px",cursor:"pointer","min-height":"220px",padding:"0",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center","box-sizing":"border-box"},onClick:p=>a(f)},{default:Zt(()=>[Kt("div",n8e,[Kt("div",s8e,ea(f.title),1),f.img?(di(),hn("img",{key:0,src:f.img,alt:"",style:{width:"100%",height:"auto","object-fit":"contain","margin-bottom":"0",border:"2px solid #e5e6eb","border-radius":"16px","box-sizing":"border-box",background:"#fafbfc"}},null,8,r8e)):cm("",!0)])]),_:2},1032,["onClick"])):(di(),Ir(ni(x0.Button),{key:1,long:"",onClick:p=>a(f),style:{"margin-bottom":"24px","font-size":"16px","min-height":"60px"}},{default:Zt(()=>[As(ea(f.title),1)]),_:2},1032,["onClick"]))]),_:2},1024))),128))]),_:2},1024)])),64))]))}};var dN=qG(o8e);dN.use(lXe);dN.use(HIe);dN.mount("#app")});export default a8e();
